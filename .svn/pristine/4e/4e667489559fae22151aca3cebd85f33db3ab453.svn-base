<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FMM00240V" onkeydown="fn_FormKeyDown" onload="form_onload" titletext="영양성분 분석표" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Div id="div_cmnBtn" anchor="left top right" taborder="5" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Grid autoenter="select" binddataset="ds_ListDtl" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="gd_listDtl" useinputpanel="false" onheadclick="gd_list_OnHeadClick" taborder="7" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 230 1237 710" selecttype="row" anchor="all">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30"/>
                <Column size="58"/>
                <Column size="120"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
                <Row size="24" band="summ"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="식단" wordwrap="word"/>
                <Cell col="2" rowspan="2" displaytype="text" text="레시피명" wordwrap="word"/>
                <Cell col="3" rowspan="2" displaytype="text" text="1인량&#10;(g)" wordwrap="word"/>
                <Cell col="4" rowspan="2" displaytype="text" text="원가" wordwrap="word"/>
                <Cell col="5" rowspan="2" displaytype="text" text="에너지&#10;(kcal)" wordwrap="word"/>
                <Cell col="6" rowspan="2" displaytype="text" text="수분&#10;(%)" wordwrap="word"/>
                <Cell col="7" rowspan="2" displaytype="text" text="단백질&#10;(g)" wordwrap="word"/>
                <Cell col="8" rowspan="2" displaytype="text" text="지질&#10;(g)" wordwrap="word"/>
                <Cell col="9" rowspan="2" displaytype="text" text="당질&#10;(g)" wordwrap="word"/>
                <Cell col="10" rowspan="2" displaytype="text" text="섬유소&#10;(g)" wordwrap="word"/>
                <Cell col="11" rowspan="2" displaytype="text" text="회분&#10;(g)" wordwrap="word"/>
                <Cell col="12" rowspan="2" displaytype="text" text="칼슘&#10;(mg)" wordwrap="word"/>
                <Cell col="13" rowspan="2" displaytype="text" text="인(mg)" wordwrap="word"/>
                <Cell col="14" rowspan="2" displaytype="text" text="철&#10;(mg)" wordwrap="word"/>
                <Cell col="15" rowspan="2" displaytype="text" text="나트륨&#10;(mg)" wordwrap="word"/>
                <Cell col="16" rowspan="2" displaytype="text" text="칼륨&#10;(mg)" wordwrap="word"/>
                <Cell col="17" rowspan="2" displaytype="text" text="비타민A&#10;(mg)" wordwrap="word"/>
                <Cell col="18" rowspan="2" displaytype="text" text="레티놀&#10;(mg)" wordwrap="word"/>
                <Cell col="19" rowspan="2" displaytype="text" text="베타카로틴&#10;(mg)" wordwrap="word"/>
                <Cell col="20" rowspan="2" displaytype="text" text="비타민B1&#10;(mg)" wordwrap="word"/>
                <Cell col="21" rowspan="2" displaytype="text" text="비타민B2&#10;(mg)" wordwrap="word"/>
                <Cell col="22" rowspan="2" displaytype="text" text="나미아신&#10;(mg)" wordwrap="word"/>
                <Cell col="23" rowspan="2" displaytype="text" text="비타민C&#10;(mg)" wordwrap="word"/>
                <Cell col="24" rowspan="2" displaytype="text" text="콜레스테롤&#10;(mg)" wordwrap="word"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:right;padding:0 6 0 6;background:white;background2:white;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;padding:0 6 0 6;background:white;background2:white;" text="bind:MEAL_CORNER" subsumtext="expr:getColumn(currow-1,&quot;MEAL_CORNER&quot;)" suppress="1"/>
                <Cell col="2" displaytype="text" style="align:expr:decode(GetRowType(ds_ListDtl,currow), &quot;logical&quot;, &quot;center&quot;, &quot;left&quot;);padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:RECIPE_NAME" subsumtext="합    계" suppress="0"/>
                <Cell col="3" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:NEED_QTY" mask="###,##0.00"/>
                <Cell col="4" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:ITEM_COST" mask="#,##0"/>
                <Cell col="5" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:CAL" mask="###,##0.00"/>
                <Cell col="6" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:WATER" mask="###,##0.00"/>
                <Cell col="7" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:PROT" mask="###,##0.00"/>
                <Cell col="8" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:FAT" mask="###,##0.00"/>
                <Cell col="9" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:CARBO" mask="###,##0.00"/>
                <Cell col="10" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:FIBER" mask="###,##0.00"/>
                <Cell col="11" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:ASH" mask="###,##0.00"/>
                <Cell col="12" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:CA" mask="###,##0.00"/>
                <Cell col="13" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:P" mask="###,##0.00"/>
                <Cell col="14" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:FE" mask="###,##0.00"/>
                <Cell col="15" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:NA" mask="###,##0.00"/>
                <Cell col="16" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:K" mask="###,##0.00"/>
                <Cell col="17" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:VITA_A" mask="###,##0.00"/>
                <Cell col="18" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:RETIN" mask="###,##0.00"/>
                <Cell col="19" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:B_CAROT" mask="###,##0.00"/>
                <Cell col="20" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:THIA" mask="###,##0.00"/>
                <Cell col="21" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:RIBO" mask="###,##0.00"/>
                <Cell col="22" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:NIACIN" mask="###,##0.00"/>
                <Cell col="23" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:VITA_C" mask="###,##0.00"/>
                <Cell col="24" displaytype="number" style="padding:0 6 0 6;background:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));background2:EXPR(decode(getRowLevel(currow),1,'#ffefb5ff',&quot;&quot;));" text="bind:CHOLE" mask="###,##0.00"/>
              </Band>
              <Band id="summary">
                <Cell colspan="3" displaytype="text" style="align:center;" class="grd_WF_SummaryBody2" text="총        계"/>
                <Cell col="3" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('NEED_QTY')" mask="###,##0.00"/>
                <Cell col="4" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('ITEM_COST')" mask="###,##0.00"/>
                <Cell col="5" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('CAL')" mask="###,##0.00"/>
                <Cell col="6" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('WATER')" mask="###,##0.00"/>
                <Cell col="7" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('PROT')" mask="###,##0.00"/>
                <Cell col="8" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('FAT')" mask="###,##0.00"/>
                <Cell col="9" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('CARBO')" mask="###,##0.00"/>
                <Cell col="10" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('FIBER')" mask="###,##0.00"/>
                <Cell col="11" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('ASH')" mask="###,##0.00"/>
                <Cell col="12" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('CA')" mask="###,##0.00"/>
                <Cell col="13" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('P')" mask="###,##0.00"/>
                <Cell col="14" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('FE')" mask="###,##0.00"/>
                <Cell col="15" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('NA')" mask="###,##0.00"/>
                <Cell col="16" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('K')" mask="###,##0.00"/>
                <Cell col="17" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('VITA_A')" mask="###,##0.00"/>
                <Cell col="18" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('RETIN')" mask="###,##0.00"/>
                <Cell col="19" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('B_CAROT')" mask="###,##0.00"/>
                <Cell col="20" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('THIA')" mask="###,##0.00"/>
                <Cell col="21" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('RIBO')" mask="###,##0.00"/>
                <Cell col="22" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('NIACIN')" mask="###,##0.00"/>
                <Cell col="23" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('VITA_C')" mask="###,##0.00"/>
                <Cell col="24" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('CHOLE')" mask="###,##0.00"/>
                <Cell row="1" colspan="3" displaytype="text" style="align:center;" class="grd_WF_SummaryBody1" text="끼니  평균"/>
                <Cell row="1" col="3" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('NEED_QTY'))" mask="#,##0.00"/>
                <Cell row="1" col="4" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('ITEM_COST'))" mask="#,##0.00"/>
                <Cell row="1" col="5" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('CAL'))" mask="#,##0.00"/>
                <Cell row="1" col="6" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('WATER'))" mask="###,##0.00"/>
                <Cell row="1" col="7" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('PROT'))" mask="###,##0.00"/>
                <Cell row="1" col="8" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('FAT'))" mask="###,##0.00"/>
                <Cell row="1" col="9" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('CARBO'))" mask="###,##0.00"/>
                <Cell row="1" col="10" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('FIBER'))" mask="###,##0.00"/>
                <Cell row="1" col="11" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('ASH'))" mask="###,##0.00"/>
                <Cell row="1" col="12" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('CA'))" mask="###,##0.00"/>
                <Cell row="1" col="13" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('P'))" mask="###,##0.00"/>
                <Cell row="1" col="14" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('FE'))" mask="###,##0.00"/>
                <Cell row="1" col="15" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('NA'))" mask="###,##0.00"/>
                <Cell row="1" col="16" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('K'))" mask="###,##0.00"/>
                <Cell row="1" col="17" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('VITA_A'))" mask="###,##0.00"/>
                <Cell row="1" col="18" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('RETIN'))" mask="###,##0.00"/>
                <Cell row="1" col="19" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('B_CAROT'))" mask="###,##0.00"/>
                <Cell row="1" col="20" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('THIA'))" mask="###,##0.00"/>
                <Cell row="1" col="21" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('RIBO'))" mask="###,##0.00"/>
                <Cell row="1" col="22" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('NIACIN'))" mask="###,##0.00"/>
                <Cell row="1" col="23" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('VITA_C'))" mask="###,##0.00"/>
                <Cell row="1" col="24" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:fn_clearNaN(getAvg('CHOLE'))" mask="###,##0.00"/>
                <Cell row="2" colspan="3" displaytype="text" style="align:center;" text="에너지 구성 비율"/>
                <Cell row="2" col="3" displaytype="text" style="align:left;"/>
                <Cell row="2" col="4" displaytype="text" style="align:left;"/>
                <Cell row="2" col="5" displaytype="text" style="align:left;"/>
                <Cell row="2" col="6" displaytype="text" style="align:left;"/>
                <Cell row="2" col="7" displaytype="text" style="align:right;" expr="expr:fn_CPF(&quot;PROT&quot;)"/>
                <Cell row="2" col="8" displaytype="text" style="align:right;" expr="expr:fn_CPF(&quot;FAT&quot;)"/>
                <Cell row="2" col="9" displaytype="text" style="align:right;" expr="expr:fn_CPF(&quot;CARBO&quot;)"/>
                <Cell row="2" col="10" displaytype="text" style="align:left;"/>
                <Cell row="2" col="11" displaytype="text" style="align:left;"/>
                <Cell row="2" col="12" displaytype="text" style="align:left;"/>
                <Cell row="2" col="13" displaytype="text" style="align:left;"/>
                <Cell row="2" col="14" displaytype="text" style="align:left;"/>
                <Cell row="2" col="15" displaytype="text" style="align:left;"/>
                <Cell row="2" col="16" displaytype="text" style="align:left;"/>
                <Cell row="2" col="17" displaytype="text" style="align:left;"/>
                <Cell row="2" col="18" displaytype="text" style="align:left;"/>
                <Cell row="2" col="19" displaytype="text" style="align:left;"/>
                <Cell row="2" col="20" displaytype="text" style="align:left;"/>
                <Cell row="2" col="21" displaytype="text" style="align:left;"/>
                <Cell row="2" col="22" displaytype="text" style="align:left;"/>
                <Cell row="2" col="23" displaytype="text" style="align:left;"/>
                <Cell row="2" col="24" displaytype="text" style="align:left;"/>
              </Band>
            </Format>
            <Format id="Default0">
              <Columns>
                <Column size="30"/>
                <Column size="58"/>
                <Column size="120"/>
                <Column size="168"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="78"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
                <Row size="24" band="summ"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="식단" wordwrap="word"/>
                <Cell col="2" rowspan="2" displaytype="text" text="레시피명" wordwrap="word"/>
                <Cell col="3" rowspan="2" displaytype="text" text="상품명" wordwrap="word"/>
                <Cell col="4" rowspan="2" displaytype="text" text="1인량&#10;(g)" wordwrap="word"/>
                <Cell col="5" rowspan="2" displaytype="text" text="가식부&#10;량(kg)" wordwrap="word"/>
                <Cell col="6" rowspan="2" displaytype="text" text="원가" wordwrap="word"/>
                <Cell col="7" rowspan="2" displaytype="text" text="폐기율&#10;(%)" wordwrap="word"/>
                <Cell col="8" rowspan="2" displaytype="text" text="에너지&#10;(kcal)" wordwrap="word"/>
                <Cell col="9" rowspan="2" displaytype="text" text="수분&#10;(%)" wordwrap="word"/>
                <Cell col="10" rowspan="2" displaytype="text" text="단백질&#10;(g)" wordwrap="word"/>
                <Cell col="11" rowspan="2" displaytype="text" text="지질&#10;(g)" wordwrap="word"/>
                <Cell col="12" rowspan="2" displaytype="text" text="당질&#10;(g)" wordwrap="word"/>
                <Cell col="13" rowspan="2" displaytype="text" text="섬유소&#10;(g)" wordwrap="word"/>
                <Cell col="14" rowspan="2" displaytype="text" text="회분&#10;(g)" wordwrap="word"/>
                <Cell col="15" rowspan="2" displaytype="text" text="칼슘&#10;(mg)" wordwrap="word"/>
                <Cell col="16" rowspan="2" displaytype="text" text="인&#10;(mg)" wordwrap="word"/>
                <Cell col="17" rowspan="2" displaytype="text" text="철&#10;(mg)" wordwrap="word"/>
                <Cell col="18" rowspan="2" displaytype="text" text="나트륨&#10;(mg)" wordwrap="word"/>
                <Cell col="19" rowspan="2" displaytype="text" text="칼륨&#10;(mg)" wordwrap="word"/>
                <Cell col="20" rowspan="2" displaytype="text" text="비타민A&#10;(R.E)" wordwrap="word"/>
                <Cell col="21" rowspan="2" displaytype="text" text="레티놀&#10;(mg)" wordwrap="word"/>
                <Cell col="22" rowspan="2" displaytype="text" text="베타카로틴&#10;(mg)" wordwrap="word"/>
                <Cell col="23" rowspan="2" displaytype="text" text="비타민B1&#10;(mg)" wordwrap="word"/>
                <Cell col="24" rowspan="2" displaytype="text" text="비타민B2&#10;(mg)" wordwrap="word"/>
                <Cell col="25" rowspan="2" displaytype="text" text="나이아신&#10;(mg)" wordwrap="word"/>
                <Cell col="26" rowspan="2" displaytype="text" text="비타민C&#10;(mg)" wordwrap="word"/>
                <Cell col="27" rowspan="2" displaytype="text" text="콜레스테롤&#10;(mg)" wordwrap="word"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:right;padding:0 6 0 6;background:white;background2:white;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;padding:0 6 0 6;background:white;background2:white;" text="bind:MEAL_CORNER" subsumtext="expr:getColumn(currow-getRowLevel(currow),'MEAL_CORNER')" suppress="1"/>
                <Cell col="2" displaytype="text" style="align:expr:decode(GetRowType(ds_ListDtl,currow), &quot;logical&quot;, &quot;center&quot;, &quot;left&quot;);background:EXPR(getRowLevel(currow)==2?'#daeaf5ff':'white');background2:EXPR(getRowLevel(currow)==2?'#cef6e5ff':'white');" text="bind:RECIPE_NAME" subsumtext="expr:getRowLevel(currow)==1?getColumn(currow-1,'RECIPE_NAME'):'합  계'" suppress="2"/>
                <Cell col="3" displaytype="text" style="align:expr:decode(GetRowType(ds_ListDtl,currow), &quot;logical&quot;, &quot;center&quot;, &quot;left&quot;);background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:ITEM_NAME" subsumtext="expr:getRowLevel(currow)==1?'소  계':getColumn(currow-2,'ITEM_NAME')"/>
                <Cell col="4" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:NEED_QTY" mask="###,##0.00"/>
                <Cell col="5" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:EDIBLE_QTY" mask="###,##0.00"/>
                <Cell col="6" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:ITEM_COST" mask="#,##0"/>
                <Cell col="7" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:DISUSE_RATE" mask="###,##0.00"/>
                <Cell col="8" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:CAL" mask="###,##0.00"/>
                <Cell col="9" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:WATER" mask="###,##0.00"/>
                <Cell col="10" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:PROT" mask="###,##0.00"/>
                <Cell col="11" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:FAT" mask="###,##0.00"/>
                <Cell col="12" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:CARBO" mask="###,##0.00"/>
                <Cell col="13" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:FIBER" mask="###,##0.00"/>
                <Cell col="14" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:ASH" mask="###,##0.00"/>
                <Cell col="15" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:CA" mask="###,##0.00"/>
                <Cell col="16" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:P" mask="###,##0.00"/>
                <Cell col="17" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:FE" mask="###,##0.00"/>
                <Cell col="18" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:NA" mask="###,##0.00"/>
                <Cell col="19" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:K" mask="###,##0.00"/>
                <Cell col="20" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:VITA_A" mask="###,##0.00"/>
                <Cell col="21" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:RETIN" mask="###,##0.00"/>
                <Cell col="22" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:B_CAROT" mask="###,##0.00"/>
                <Cell col="23" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:THIA" mask="###,##0.00"/>
                <Cell col="24" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:RIBO" mask="###,##0.00"/>
                <Cell col="25" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:NIACIN" mask="###,##0.00"/>
                <Cell col="26" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:VITA_C" mask="###,##0.00"/>
                <Cell col="27" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow)==1?'#e0fcd4ff':getRowLevel(currow)==2?'#daeaf5ff':'');background2:EXPR(getRowLevel(currow)==1?'#fddcc9ff':getRowLevel(currow)==2?'#cef6e5ff':'');" text="bind:CHOLE" mask="###,##0.00"/>
              </Band>
              <Band id="summary">
                <Cell colspan="4" displaytype="text" style="align:center;" class="grd_WF_SummaryBody2" text="총        계"/>
                <Cell col="4" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('NEED_QTY')" mask="###,##0.00"/>
                <Cell col="5" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('EDIBLE_QTY')" mask="###,##0.00"/>
                <Cell col="6" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="-" expr="expr:getSum('ITEM_COST')" mask="###,##0.00"/>
                <Cell col="7" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="-" expr="expr:getSum('DISUSE_RATE')" mask="###,##0.00"/>
                <Cell col="8" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('CAL')" mask="###,##0.00"/>
                <Cell col="9" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('WATER')" mask="###,##0.00"/>
                <Cell col="10" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('PROT')" mask="###,##0.00"/>
                <Cell col="11" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('FAT')" mask="###,##0.00"/>
                <Cell col="12" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('CARBO')" mask="###,##0.00"/>
                <Cell col="13" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('FIBER')" mask="###,##0.00"/>
                <Cell col="14" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('ASH')" mask="###,##0.00"/>
                <Cell col="15" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('CA')" mask="###,##0.00"/>
                <Cell col="16" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('P')" mask="###,##0.00"/>
                <Cell col="17" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('FE')" mask="###,##0.00"/>
                <Cell col="18" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('NA')" mask="###,##0.00"/>
                <Cell col="19" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('K')" mask="###,##0.00"/>
                <Cell col="20" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('VITA_A')" mask="###,##0.00"/>
                <Cell col="21" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('RETIN')" mask="###,##0.00"/>
                <Cell col="22" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('B_CAROT')" mask="###,##0.00"/>
                <Cell col="23" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('THIA')" mask="###,##0.00"/>
                <Cell col="24" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('RIBO')" mask="###,##0.00"/>
                <Cell col="25" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('NIACIN')" mask="###,##0.00"/>
                <Cell col="26" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('VITA_C')" mask="###,##0.00"/>
                <Cell col="27" displaytype="number" style="align:right;" class="grd_WF_SummaryBody2" text="expr:getSum('CHOLE')" mask="###,##0.00"/>
                <Cell row="1" colspan="4" displaytype="text" style="align:center;" class="grd_WF_SummaryBody1" text="평        균"/>
                <Cell row="1" col="4" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('NEED_QTY')=='Infinity'?'':getAvg('NEED_QTY')" mask="###,##0.00"/>
                <Cell row="1" col="5" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('EDIBLE_QTY')=='Infinity'?'':getAvg('EDIBLE_QTY')" mask="###,##0.00"/>
                <Cell row="1" col="6" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('ITEM_COST')=='Infinity'?'':getAvg('ITEM_COST')" mask="###,##0.00"/>
                <Cell row="1" col="7" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('DISUSE_RATE')=='Infinity'?'':getAvg('DISUSE_RATE')" mask="###,##0.00"/>
                <Cell row="1" col="8" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('CAL')=='Infinity'?'':getAvg('CAL')" mask="###,##0.00"/>
                <Cell row="1" col="9" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('WATER')=='Infinity'?'':getAvg('WATER')" mask="###,##0.00"/>
                <Cell row="1" col="10" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('PROT')=='Infinity'?'':getAvg('PROT')" mask="###,##0.00"/>
                <Cell row="1" col="11" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('FAT')=='Infinity'?'':getAvg('FAT')" mask="###,##0.00"/>
                <Cell row="1" col="12" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('CARBO')=='Infinity'?'':getAvg('CARBO')" mask="###,##0.00"/>
                <Cell row="1" col="13" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('FIBER')=='Infinity'?'':getAvg('FIBER')" mask="###,##0.00"/>
                <Cell row="1" col="14" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('ASH')=='Infinity'?'':getAvg('ASH')" mask="###,##0.00"/>
                <Cell row="1" col="15" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('CA')=='Infinity'?'':getAvg('CA')" mask="###,##0.00"/>
                <Cell row="1" col="16" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('P')=='Infinity'?'':getAvg('P')" mask="###,##0.00"/>
                <Cell row="1" col="17" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('FE')=='Infinity'?'':getAvg('FE')" mask="###,##0.00"/>
                <Cell row="1" col="18" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('NA')=='Infinity'?'':getAvg('NA')" mask="###,##0.00"/>
                <Cell row="1" col="19" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('K')=='Infinity'?'':getAvg('K')" mask="###,##0.00"/>
                <Cell row="1" col="20" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('VITA_A')=='Infinity'?'':getAvg('VITA_A')" mask="###,##0.00"/>
                <Cell row="1" col="21" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('RETIN')=='Infinity'?'':getAvg('RETIN')" mask="###,##0.00"/>
                <Cell row="1" col="22" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('B_CAROT')=='Infinity'?'':getAvg('B_CAROT')" mask="###,##0.00"/>
                <Cell row="1" col="23" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('THIA')=='Infinity'?'':getAvg('THIA')" mask="###,##0.00"/>
                <Cell row="1" col="24" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('RIBO')=='Infinity'?'':getAvg('RIBO')" mask="###,##0.00"/>
                <Cell row="1" col="25" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('NIACIN')=='Infinity'?'':getAvg('NIACIN')" mask="###,##0.00"/>
                <Cell row="1" col="26" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('VITA_C')=='Infinity'?'':getAvg('VITA_C')" mask="###,##0.00"/>
                <Cell row="1" col="27" displaytype="number" style="align:right;" class="grd_WF_SummaryBody1" text="expr:getAvg('CHOLE')=='Infinity'?'':getAvg('CHOLE')" mask="###,##0.00"/>
                <Cell row="2" colspan="4" displaytype="text" style="align:center;" text="에너지 구성 비율"/>
                <Cell row="2" col="4" displaytype="text" style="align:left;"/>
                <Cell row="2" col="5" displaytype="text" style="align:left;"/>
                <Cell row="2" col="6" displaytype="text" style="align:left;"/>
                <Cell row="2" col="7" displaytype="text" style="align:left;"/>
                <Cell row="2" col="8" displaytype="text" style="align:left;"/>
                <Cell row="2" col="9" displaytype="text" style="align:left;"/>
                <Cell row="2" col="10" displaytype="text" style="align:right;" expr="expr:fn_CPF(&quot;PROT&quot;)"/>
                <Cell row="2" col="11" displaytype="text" style="align:right;" expr="expr:fn_CPF(&quot;FAT&quot;)"/>
                <Cell row="2" col="12" displaytype="text" style="align:right;" expr="expr:fn_CPF(&quot;CARBO&quot;)"/>
                <Cell row="2" col="13" displaytype="text" style="align:left;"/>
                <Cell row="2" col="14" displaytype="text" style="align:left;"/>
                <Cell row="2" col="15" displaytype="text" style="align:left;"/>
                <Cell row="2" col="16" displaytype="text" style="align:left;"/>
                <Cell row="2" col="17" displaytype="text" style="align:left;"/>
                <Cell row="2" col="18" displaytype="text" style="align:left;"/>
                <Cell row="2" col="19" displaytype="text" style="align:left;"/>
                <Cell row="2" col="20" displaytype="text" style="align:left;"/>
                <Cell row="2" col="21" displaytype="text" style="align:left;"/>
                <Cell row="2" col="22" displaytype="text" style="align:left;"/>
                <Cell row="2" col="23" displaytype="text" style="align:left;"/>
                <Cell row="2" col="24" displaytype="text" style="align:left;"/>
                <Cell row="2" col="25" displaytype="text" style="align:left;"/>
                <Cell row="2" col="26" displaytype="text" style="align:left;"/>
                <Cell row="2" col="27" displaytype="text" style="align:left;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid autoenter="select" binddataset="ds_List" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="gd_list" useinputpanel="false" selecttype="row" onheadclick="gd_list_OnHeadClick" taborder="6" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 86 1237 225" autofittype="col" anchor="left top right">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="170"/>
                <Column size="826"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="40"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" text="식단"/>
                <Cell col="1" displaytype="text" text="제공메뉴"/>
                <Cell col="2" displaytype="text" text="식단가"/>
                <Cell col="3" displaytype="text" text="예상식수"/>
                <Cell col="4" displaytype="checkbox" edittype="checkbox"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" text="bind:MEAL_CORNER"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:MENU_DISP"/>
                <Cell col="2" displaytype="number" style="align:right;" text="bind:SALE_PRICE" mask="###,##0"/>
                <Cell col="3" displaytype="number" style="align:right;" text="bind:EXPECT_MEAL_QTY" mask="###,##0"/>
                <Cell col="4" displaytype="checkbox" edittype="checkbox" style="align: ;" text="bind:CHK"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 713" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1245 725" anchor="left bottom"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 1053 40"/>
        <Static id="Static01" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 1053 71"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 64 40 74 61"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 244 40 274 61"/>
        <Static id="Static12" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 345 40 355 61"/>
        <Static id="Static13" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 550 40 580 61"/>
        <Static id="Static14" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 627 40 637 61"/>
        <Static id="Static17" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 71 450 86"/>
        <Button id="btn_Upjang" onclick="fn_edBtn_OnClick" taborder="8" tabstop="false" text="" position="absolute 223 40 244 61" class="btn_WF_popSearch" image=""/>
        <Edit autoselect="true" id="ed_Upjang" imemode="native" onkeydown="fn_edBtn_OnKeyDown" readonly="true" taborder="0" position="absolute 74 40 224 61"/>
        <Static id="st_Upjang" text="사업장" userdata="strQuery_FMUpjang" position="absolute 17 40 73 61" class="sta_WFSA_label"/>
        <Combo codecolumn="SUBINV_CODE" datacolumn="SUBINV_NAME" displayrowcount="10" id="cbo_Subinv" imemode="none" innerdataset="ds_Subinv" onitemchanged="cbo_Subinv_OnChanged" taborder="1" position="absolute 355 40 550 61"/>
        <Static id="Static6" text="식당(창고)" position="absolute 275 40 350 61" class="sta_WFSA_label"/>
        <Static id="Static8" text="제공일" position="absolute 582 40 636 61" class="sta_WFSA_label"/>
        <MaskEdit id="me_Date" mask="####-##-##" taborder="2" type="string" position="absolute 637 40 716 61" onkillfocus="Date_OnKillFocus" style="padding:0 0 0 0;align:center;" autoselect="true"/>
        <Button id="btn_Date" onclick="CalButton_OnClick" taborder="9" tabstop="false" text="" userdata="me_Date" position="absolute 715 40 736 61" class="btn_WF_cal" image=""/>
        <CheckBox id="chk_Item" onclick="chk_Item_OnClick" taborder="3" tabstop="false" text="상품별" value="false" position="absolute 766 40 821 61" truevalue="1" falsevalue="0"/>
        <CheckBox id="chk_Rate" taborder="4" tabstop="false" text="폐기율 적용" value="false" position="absolute 835 40 918 61" truevalue="1" falsevalue="0"/>
        <Static id="Static00" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 736 40 766 61"/>
        <Static id="Static02" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 225 834 230"/>
        <TextArea id="ta_Sql" readonly="true" taborder="10" tabstop="false" position="absolute 473 0 627 38" visible="false"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_Subinv">
        <ColumnInfo>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="SUBINV_NAME_DISP" size="100" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Cond">
        <ColumnInfo>
          <Column id="UPJANG" size="22" type="INT"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="MENU_DATE" size="8" type="STRING"/>
          <Column id="MENU_LIST" size="100" type="STRING"/>
          <Column id="ITEM_FLAG" size="1" type="STRING"/>
          <Column id="RATE_FLAG" size="1" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List">
        <ColumnInfo>
          <Column id="UPJANG" size="22" type="BIGDECIMAL"/>
          <Column id="MENU_CD" size="50" type="STRING"/>
          <Column id="MEAL_CORNER" size="200" type="STRING"/>
          <Column id="MENU_NAME" size="50" type="STRING"/>
          <Column id="MENU_DISP" size="4000" type="STRING"/>
          <Column id="SALE_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="EXPECT_MEAL_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="CHK" size="1" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ListDtl" keystring="G:MEAL_CORNER">
        <ColumnInfo>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="SUBINV_CODE" type="STRING" size="256"/>
          <Column id="MENU_DATE" type="STRING" size="256"/>
          <Column id="RECIPE_NAME" type="STRING" size="256"/>
          <Column id="MEAL_CORNER" type="STRING" size="256"/>
          <Column id="NEED_QTY" type="BIGDECIMAL" size="20"/>
          <Column id="ITEM_COST" type="BIGDECIMAL" size="20"/>
          <Column id="CAL" type="BIGDECIMAL" size="20"/>
          <Column id="WATER" type="BIGDECIMAL" size="20"/>
          <Column id="PROT" type="BIGDECIMAL" size="20"/>
          <Column id="FAT" type="BIGDECIMAL" size="20"/>
          <Column id="CARBO" type="BIGDECIMAL" size="20"/>
          <Column id="FIBER" type="BIGDECIMAL" size="20"/>
          <Column id="ASH" type="BIGDECIMAL" size="20"/>
          <Column id="CA" type="BIGDECIMAL" size="20"/>
          <Column id="P" type="BIGDECIMAL" size="20"/>
          <Column id="FE" type="BIGDECIMAL" size="20"/>
          <Column id="NA" type="BIGDECIMAL" size="20"/>
          <Column id="K" type="BIGDECIMAL" size="20"/>
          <Column id="VITA_A" type="BIGDECIMAL" size="20"/>
          <Column id="RETIN" type="BIGDECIMAL" size="20"/>
          <Column id="B_CAROT" type="BIGDECIMAL" size="20"/>
          <Column id="THIA" type="BIGDECIMAL" size="20"/>
          <Column id="RIBO" type="BIGDECIMAL" size="20"/>
          <Column id="NIACIN" type="BIGDECIMAL" size="20"/>
          <Column id="VITA_C" type="BIGDECIMAL" size="20"/>
          <Column id="CHOLE" type="BIGDECIMAL" size="20"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256" sumtext="조회"/>
          <Column id="insYn" type="STRING" size="256" sumtext="추가"/>
          <Column id="delYn" type="STRING" size="256" sumtext="삭제"/>
          <Column id="savYn" type="STRING" size="256" sumtext="저장"/>
          <Column id="prtYn" type="STRING" size="256" sumtext="출력"/>
          <Column id="exlYn" type="STRING" size="256" sumtext="엑셀"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">0</Col>
            <Col id="delYn">0</Col>
            <Col id="savYn">0</Col>
            <Col id="prtYn">1</Col>
            <Col id="exlYn">0</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind/>
    <Script type="xscript4.0"><![CDATA[/*
 ******************************************************************************************
 * 시스템구분   : 식재영업/현황관리
 * 프로그램명   : FMM00240V
 * 기      능   : 영양성분분석표
 * 작  성  자   : 박은규
 * 작성  일자   : 2008-04-07
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
*/
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
include "U_lib::lib_conversionCom.xjs";
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"				// 시스템 공통
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"		//JAVA 코딩시
//@@컨버터에서 주석처리 #include "LIB::tit_comm_0001.js"		// X-Framework Lib
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"		// 공통팝업
//@@컨버터에서 주석처리 #include "lib::fm_common.js"			// FM공통
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var fa_Sql;
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	//초기화
   	fsp_init(this);
   	//v_ds_check = "ds_List";
   	ta_Sql.visible = (application.g_EmpNo == gfmsAdmin);

	ed_Upjang.userdata = application.g_Upjang;
	ed_Upjang.value     = application.g_UpjangNm;
	me_Date.value      = fn_CurrDateWeek();
	
	//창고세팅
	fn_SetSubinv();
	//상단 자동조회
	fn_SearchHdr();

	if (ed_Upjang.enable) ed_Upjang.setFocus();
	else me_Date.setFocus();
}

function fn_FormKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);

	/*
	if ( (e.keycode == 13) && (e.fromreferenceobject == me_Date) ) 
	{
		fn_search();
	}
	*/
}
//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*------------------------------------------------------------(60)
	1. Function ID : fn_Search()
	2. 개       요 : 업무프로세스에 따른 조회작업
	3. 기       능 : 검색조건에 해당하는 정보를 조회
	4. 인 수 설 명 : 
*/
function fn_search()
{
	//필수항목 
	if (fn_ChkManNull()) return;
	if(ds_List.rowcount < 1)
	{
		g_Message("EE", "해당 식단정보가 없습니다.");
		me_Date.setFocus();
		return;
	}
	if( ds_List.findRowExpr("CHK=='1'") < 0 ) {
		g_Message("EE", "상세조회 할 식단을 선택해 주세요.");
		gd_list.setFocus();
		gd_list.setCellPos(5);
		return;
	}
	// 초기화
	ds_Cond.clearData();
	ds_ListDtl.clearData();
	ds_Cond.addRow();
	ds_Cond.setColumn(0, "UPJANG",         gfn_nvl(ed_Upjang.userdata));
	ds_Cond.setColumn(0, "SUBINV_CODE",    gfn_nvl(cbo_Subinv.value));
	ds_Cond.setColumn(0, "MENU_DATE",      gfn_nvl(me_Date.value));
	ds_Cond.setColumn(0, "MENU_LIST",      gfn_nvl(fn_GetMenuList()));
	ds_Cond.setColumn(0, "ITEM_FLAG",      gfn_nvl(chk_Item.value));
	ds_Cond.setColumn(0, "RATE_FLAG",      gfn_nvl(chk_Rate.value));
	// 조회
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMM00240V_T002";
	strURL   = "U_svc::" + "fm/fmm/FMM00240V_T002.jsp";
	// 데이터셋 설정
	strInDatasets  = "ds_Cond=ds_Cond";
	strOutDatasets = "ds_ListDtl=ds_List";
	// 파라메터 설정
	strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
	// 콜백함수 지정
	strCallbackFunc = "fn_CallBack_Search";
	// 서버 호출 
	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, false);
}

/*------------------------------------------------------------
	1. Function ID : fn_Insert()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_insert()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Delete()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_delete()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Save()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_save()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Print()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_print()
{
	//필수항목 
	if (fn_ChkManNull()) return;
	if(ds_List.rowcount < 1)
	{
		g_Message("EE", "해당 식단정보가 없습니다.");
		me_Date.setFocus();
		return;
	}
	if( ds_List.findRowExpr("CHK=='1'") < 0 ) {
		g_Message("EE", "상세조회 할 식단을 선택해 주세요.");
		gd_list.setFocus();
		gd_list.setCellPos(5);
		return;
	}
	//레포트에 전달할 파라메터 생성
	var arrParams	= SCReport.newParams ();
	
	//--------------------------------------------------
	//방법1)서버에서 Query에 의해 처리하는 경우 예
	//(필수) 레포트명

	if (chk_Item.value == "1") {
		SCReport.setParams (arrParams, SCReport.RPT_NAME, "/FICS/FICS_FMM00240V_R02.ozr");
	}
		//strParam += "&url=FICS/FICS_영양성분분석표_자재.ozr";
	else {
		SCReport.setParams (arrParams, SCReport.RPT_NAME, "/FICS/FICS_FMM00240V_R01.ozr");
	}	
		//strParam += "&url=FICS/FICS_영양성분분석표.ozr";
	

	//출력 옵션 설정
	//-창 타이틀 (디폴트는 "ReportViewer")
	SCReport.setParams (arrParams, SCReport.RPT_TITLE, "영양성분분석표");
	
	//레포트에 맞게 전달되는 개발자 정의 파라미터
	SCReport.setParams (arrParams, "PARAM1", ed_Upjang.userdata);// 
	SCReport.setParams (arrParams, "PARAM2", me_Date.value);	// 
	SCReport.setParams (arrParams, "PARAM3", cbo_Subinv.value);// 
	SCReport.setParams (arrParams, "PARAM4", fn_GetMenuList());// 
	SCReport.setParams (arrParams, "PARAM5", chk_Rate.value);// 
	SCReport.setParams (arrParams, "PARAM6", chk_Item.value);// 
	
	SCReport.setParams (arrParams, "zoom", 120);
	//--------------------------------------------------
	SCReport.viewReport (this, arrParams, false);	
}

/*------------------------------------------------------------
	1. Function ID : fn_close()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_close()
{
	return true;
}

/*------------------------------------------------------------
	1. Function ID : fn_Help()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_help()
{
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*------------------------------------------------------------
	1. Function ID : fn_AlertMsg(cd)
	2. 개       요 : 메세지 처리
	3. 기       능 : 화면에 나타나는 메시지 코드및 텍스트 리턴
	4. 인 수 설 명 : cd : 원하는 메시지 코드
*/
function fn_AlertMsg(cd)
{
	var v_Msg="";
	switch(cd)
	{
		case "000":
			v_Msg= "이(가) 저장되었습니다.";
			break;
		case "001":
			v_Msg= "버튼이 정의 되어 있지않습니다.";
			break;
		case "002":
			v_Msg="서비스 오류:시스템 관리자에게 문의하십시오";
			break;
		case "003":
			v_Msg="필수항목은 반드시 선택하시기 바랍니다.";
			break;	
		case "004":
			v_Msg="작업대상 본사를 선택하세요.";
			break;
		case "005":
			v_Msg="을(를) 입력하세요";
			break;
		case "006":
			v_Msg="삭제할 데이터가 없습니다.";
			break;
		case "007":
			v_Msg="변경된 데이터가 없습니다.";
			break;
		case "008":
			v_Msg="시스템ID가 없습니다.";
			break;			
/*			
		case "":
			v_Msg="";
			break;
*/			
		default:
			break;			
	}
	return v_Msg;
}

//콜백
function fn_CallBack_Search(errCode, errMsg)
{
ta_Sql.value = fa_Sql;
	if (errCode == 0)
	{
		if (ds_List.rowcount < 1)
			g_Message("EE","조회된 자료가 없습니다.");
		else
			gd_listDtl.setFocus();
	}
	else
		g_Message("EE",fn_AlertMsg("002"));
}

function fn_ChkManNull()
{
	if (ffn_ChkNull(ed_Upjang.userdata))
	{
		g_Message("EE", "사업장" + fn_AlertMsg("005"));
		if (ed_Upjang.enable) ed_Upjang.setFocus();
		return true;
	}
	if (ffn_ChkNull(cbo_Subinv.value))
	{
		g_Message("EE", "식당을 선택하세요.");
		if (cbo_Subinv.enable) cbo_Subinv.setFocus();
		return true;
	}
	if ( ffn_ChkNull(me_Date.value) || (gfn_length(me_Date.value)< 8) )
	{
		g_Message("EE", "메뉴 제공일을 정확하게 입력하세요.");
		me_Date.setFocus();
		return true;
	}
	//
	return false;
}

// function fn_FormKeyDown(obj:Form, e:KeyEventInfo)
// {
// 	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
// 	//입고구분에서 엔터시 조회
// 	if ( (e.keycode == 13) && (e.fromreferenceobject == chk_Rate) ) fn_Search();
// }	

function fn_edBtn_OnClick(obj:Button, e:ClickEventInfo)
{
	var sAddWhere = "";
	
	switch(obj.name)
	{
		case "btn_Upjang":
			//sAddWhere = " AND A.USE_YN = 'Y'";
			//본사인 경우 해당 사업장 조회
			if (application.g_UserKind == '본사')
				sAddWhere += " AND A.MAIN_UPJANG = " + application.g_Main_Upjang;
			//사업장인 경우 관리업장만 조회
			else if (application.g_UserKind == '사업장')
				sAddWhere += " AND ( A.UPJANG = " + application.g_Upjang + " OR EXISTS (SELECT 1 FROM FMS_USER_UPJANG B WHERE B.USE_YN = 'Y' AND B.UPJANG = A.UPJANG AND B.SABUN = '" + application.g_EmpNo + "') )";

			break;

		default:
			break;
	}
	//fm공통 팝업클릭 호출
	if (ffn_btn_OnClick(obj, sAddWhere)) fn_Trigger_edBtn(eval("ed_" + gfn_subStr(obj.name, 4)));
}

function fn_edBtn_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if (ffn_ed_OnKeyDown(obj,e.keycode)) fn_Trigger_edBtn(obj);
}

function fn_Trigger_edBtn(obj)
{
	switch(obj.name)
	{
		case "ed_Upjang":
			
			if (! ffn_ChkNull(obj.userdata))
			{
				//창고세팅
				fn_SetSubinv();
			}else{
				ds_List.clearData();
				ds_ListDtl.clearData();
			}
			
			break;
			
		default:

			break;
	}
	obj.setFocus();
}

function fn_SearchHdr()
{
	//필수항목 
	if (fn_ChkManNull()) return;
	// 초기화
	ds_Cond.clearData();
	ds_List.clearData();
	ds_ListDtl.clearData();
	ds_Cond.addRow();
	ds_Cond.setColumn(0, "UPJANG",         gfn_nvl(ed_Upjang.userdata));
	ds_Cond.setColumn(0, "SUBINV_CODE",    gfn_nvl(cbo_Subinv.value));
	ds_Cond.setColumn(0, "MENU_DATE",      gfn_nvl(me_Date.value));
	// 조회
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMM00240V_T001";
	strURL   = "U_svc::" + "fm/fmm/FMM00240V_T001.jsp";
	// 데이터셋 설정
	strInDatasets  = "ds_Cond=ds_Cond";
	strOutDatasets = "ds_List=ds_List";
	// 파라메터 설정
	strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
	// 콜백함수 지정
	strCallbackFunc = "";
	// 서버 호출 
	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
	ta_Sql.value = fa_Sql;
	
	if (ds_List.rowcount > 0)
	{
		gd_list.setFocus();
		gd_list.setCellPos(5);
	}
	else
		me_Date.setFocus();
}

function fn_SetSubinv()
{
	// 초기화
	ds_Subinv.clearData();
	if (ffn_ChkNull(ed_Upjang.userdata)) return;
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_Subinv=ds_List";
    otherArg	= "UPJANG=" + wrapQuote(gfn_nvl(ed_Upjang.userdata));
    callBackFnc = "fn_CallBack_Subinv";
    
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_PO_SUBINV_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
}

function fn_CallBack_Subinv()
{
	//기본창고지정
	if (ds_Subinv.rowcount > 0)
	{
		cbo_Subinv.index = 0;
		fn_SearchHdr();
	}
}

function fn_GetMenuList()
{
	var sMenuList = "";
	for (var i=0; i<ds_List.rowcount; i++)
	{
		if (ds_List.getColumn(i, "CHK") == "1")
		{
			if (ffn_ChkNull(sMenuList))
				sMenuList = "'" + ds_List.getColumn(i, "MENU_CD") + "'";
			else
				sMenuList += ",'" + ds_List.getColumn(i, "MENU_CD") + "'";
		}
	}
	return sMenuList;
}

function fn_CPF(strColumnId)
{
	// CARBO : 당질
	// PROT : 단백질
	// FAT : 지질
	if (ds_ListDtl.rowcount < 1 ) return "-";

	//var v_temp = ds_ListDtl.Avg(quote(strColumnId)) * 4;
	var v_temp = 0;
	switch(strColumnId)
	{
		case "CARBO" :
			v_temp = ds_ListDtl.getAvg("CARBO") * 4;
			break;
		case "PROT" :
			v_temp = ds_ListDtl.getAvg("PROT") * 4;
			break;
		case "FAT" :
			v_temp = ds_ListDtl.getAvg("FAT") * 9;
			break;
		default :
			return "-";
	}
	if (v_temp == 0)
		return "-";
	else
		return numFormat((v_temp / ((ds_ListDtl.getAvg("CARBO") * 4) + (ds_ListDtl.getAvg("PROT") * 4) + (ds_ListDtl.getAvg("FAT") * 9))) * 100, 2)+ "%";
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
function gd_list_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	switch(e.cell)
	{
		case 0:
			gfn_exportExcel(obj, "sheet1");
			break;
		default:
			gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
			break;
	}
}

function cbo_Subinv_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	if(e.preindex != e.postindex) fn_SearchHdr();
}

function me_Date_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{
	if ( gfn_length(gfn_trim(me_Date.value)) == 8 ) fn_SearchHdr();
}

function chk_Item_OnClick(obj:CheckBox, e:ClickEventInfo)
{
	if(obj.isChecked())
	{
		ds_ListDtl.clear();
		ds_ListDtl.keystring = "G:MEAL_CORNER,RECIPE_CD";
		gd_listDtl.formatid  = "Default0";
	}
	else
	{
		ds_ListDtl.clear();
		ds_ListDtl.keystring = "G:MEAL_CORNER";
		gd_listDtl.formatid  = "Default";
	}
}

/************************************************************************************
날짜필드(MaskEdit + Button) 내부사용을 위해 공통에서 함수를 빼옴 이 아래로

MaskEdit 는 setfocus가 먹다 안먹다 해서 속성의 autoselect 로 조절함
MaskEdit 는 Date_OnKillFocus() 함수를 사용해서 날짜를 조합함
Button 은 CalButton_OnClick() 함수를 사용해서 달력을 출력하고 값을 리턴
me_Date_canchange() 는 달출력 한후 실행하는 트리거 같은 함수
************************************************************************************/
function Date_OnKillFocus(obj)
{
	var currday  = gfn_today();
	var currleng = gfn_length(gfn_trim(obj.value));
	var objValue = gfn_trim(obj.value);

	if (obj.mask == "####-##-##" ) 
	{
		switch(currleng)
		{
			case 1:
				obj.value = gfn_subStr(currday,0,6)+"0"+objValue;
				break;
			case 2:
				obj.value = gfn_subStr(currday,0,6)+objValue;
				break;
			case 3:
				obj.value = gfn_subStr(currday,0,4)+"0"+objValue;
				break;
			case 4:
				obj.value = gfn_subStr(currday,0,4)+objValue;
				break;
			case 5:
				obj.value = gfn_subStr(currday,0,3)+objValue;
				break;
			case 6:
				obj.value = gfn_subStr(currday,0,2)+objValue;
				break;
			case 7:
				obj.value = gfn_subStr(currday,0,1)+objValue;
				break;			
		}

		if ( gfn_length(gfn_trim(obj.value))== 0 ) return;
	
		if ( G_fn_IsDateYMD(obj.value) == -1 ) {
			obj.value = "";
			obj.setFocus();
		}	
	}
	else {
		switch(currleng)
		{
			case 1:
				obj.value = gfn_subStr(currday,0,4)+"0"+objValue;
				break;
			case 2:
				obj.value = gfn_subStr(currday,0,4)+objValue;
				break;
			case 3:
				obj.value = gfn_subStr(currday,0,3)+objValue;
				break;
			case 4:
				obj.value = gfn_subStr(currday,0,2)+objValue;
				break;
			case 5:
				obj.value = gfn_subStr(currday,0,1)+objValue;
				break;
		}
		
		if ( gfn_length(gfn_trim(obj.value))== 0 ) return;
		
		if ( gfn_subStr(obj.value,4,2)< "01" || gfn_subStr(obj.value,4,2)> "12" ) {
			obj.value = "";
			obj.setFocus();
		}		
	}
	
	//헤더 조회
	fn_SearchHdr();
}

function CalButton_OnClick(obj:Button,  e:ClickEventInfo)
{
	var sOldDate = eval(obj.userdata).value;
	
	// 달력
	if ( eval(obj.userdata).mask == "####-##-##" )
	{
		// 과거 달력 팝업
		//eval(obj.userdata).value = gfn_dialog("", "U_SCC::SCC_CALENDAR.xfdl","fa_Date="+eval(obj.userdata).value,-1,-1,"",-1,-1,false,false);
			
		// 신규 달력 div
		var nX = system.clientToScreenX(obj, 0) + obj.position.width  - 167;
		var nY = system.clientToScreenY(obj, 0) + obj.position.height - 1;
		var strDate = gfn_callCalendarPop(obj, eval(obj.userdata).value, nX, nY);
		if(gfn_isNull(strDate)) return;
		eval(obj.userdata).value = strDate;
	}
	// 월력
	else {
		// 과거 월력 팝업
		//eval(obj.userdata).value = gfn_dialog("", "U_SCC::SCC_CALMONTH.xfdl","fa_Date="+eval(obj.userdata).value,-1,-1,"",-1,-1,false,false);	
			
		// 신규 월력 div
		var nX = system.clientToScreenX(obj, 0) - 168 + obj.position.width;
		var nY = system.clientToScreenY(obj, 0) + obj.position.height;
		var strDate = gfn_callMonthPop(obj, eval(obj.userdata).value, nX, nY);
		if(gfn_isNull(strDate)) return;
		eval(obj.userdata).value = strDate;
	}
	//기존 값과 달라진 경우 Change이벤트 발생시킴
	//if (sOldDate <> object(obj.UserData).Value)	eval(obj.UserData + "_OnChanged(" + obj.UserData + ", " + object(obj.UserData).Value + ")");
	
	
	//trace("sOldDate :" + sOldDate);
	//trace("sNewDate :" + eval(obj.userdata).value);
	
	if (sOldDate <> eval(obj.userdata).value) 
	{
		//trace("obj.userdata : " + obj.userdata);
		eval(gfn_replace(obj.userdata,".","_")+ "_trigger()");
		//온체인지를 캔체인지로 바꿈 엑스플렛폼이기때문에
	}
}

function me_Date_trigger()
{
	//헤더 조회
	fn_SearchHdr();
}]]></Script>
  </Form>
</FDL>

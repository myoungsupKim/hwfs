<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FMM00200V" onload="form_onload" titletext="식단등록" position="absolute 0 0 979 464" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static10" class="sta_WFDA_Labelbg" position="absolute 528 427 969 454" anchor="right bottom"/>
        <Static id="Static08" class="sta_WFDA_Labelbg" position="absolute 10 10 530 37"/>
        <Static id="st_pyoTitle" text="식단평가 - 주재료군/주간/두류" position="absolute 548 32 929 46" class="sta_WF_Redhelp" style="color:crimson;align:right middle;" anchor="top right"/>
        <Grid enable="true" id="Grid1" useinputpanel="false" taborder="4" tabstop="true" usecontextmenu="true" useselcolor="true" visible="false" wheelscrollrow="1" position="absolute 16 720 863 1019" readonly="true" selecttype="row">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column band="left" size="75"/>
                <Column size="20"/>
                <Column size="100"/>
                <Column size="36"/>
                <Column size="20"/>
                <Column size="100"/>
                <Column size="36"/>
                <Column size="20"/>
                <Column size="100"/>
                <Column size="36"/>
                <Column size="20"/>
                <Column size="100"/>
                <Column size="36"/>
                <Column size="20"/>
                <Column size="100"/>
                <Column size="36"/>
                <Column size="20"/>
                <Column size="100"/>
                <Column size="36"/>
                <Column size="20"/>
                <Column size="100"/>
                <Column size="36"/>
              </Columns>
              <Rows>
                <Row size="18" band="head"/>
                <Row size="18" band="head"/>
                <Row size="18"/>
                <Row size="18" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell col="0" displaytype="text" text="일자"/>
                <Cell col="0" displaytype="text" row="1" text="일정"/>
                <Cell col="1" colspan="2" displaytype="text" text="9/17(월) 맑음"/>
                <Cell col="3" displaytype="text" rowspan="2"/>
                <Cell col="1" colspan="2" displaytype="text" row="1" text="체육대회"/>
                <Cell col="4" colspan="2" displaytype="text" text="9/18(화) 구름조금"/>
                <Cell col="6" displaytype="text" rowspan="2"/>
                <Cell col="4" colspan="2" displaytype="text" row="1"/>
                <Cell col="7" colspan="2" displaytype="text" text="9/19(수) 구름많음"/>
                <Cell col="9" displaytype="text" rowspan="2"/>
                <Cell col="7" colspan="2" displaytype="text" row="1" text="유급휴일/공장현.."/>
                <Cell col="10" colspan="2" displaytype="text" text="9/20(목) 비와 천둥"/>
                <Cell col="12" displaytype="text" rowspan="2"/>
                <Cell col="10" colspan="2" displaytype="text" row="1"/>
                <Cell col="13" colspan="2" displaytype="text" text="9/21(금) 비"/>
                <Cell col="15" displaytype="text" rowspan="2"/>
                <Cell col="13" colspan="2" displaytype="text" row="1" text="소풍/운영없음"/>
                <Cell col="16" colspan="2" displaytype="text" text="9/22(토) 안개"/>
                <Cell col="18" displaytype="text" rowspan="2"/>
                <Cell col="16" colspan="2" displaytype="text" row="1" text="운영없음"/>
                <Cell col="19" colspan="2" displaytype="text" text="9/23(일) 천둥비"/>
                <Cell col="21" displaytype="text" rowspan="2"/>
                <Cell col="19" colspan="2" displaytype="text" row="1" text="운영없음"/>
              </Band>
              <Band id="body">
                <Cell col="0" displaytype="text" expr="expr:iif(cgbn_cd=='0', sgbn_nm+cgbn, sgbn_nm+cgbn+'&#10;('+cgbn_nm+')')" suppress="1" style="align:center;background:EXPR(iif(toNumber(toNumber(sgbn_no)/2) == parseInt(toNumber(sgbn_no)/2), 'white', '#E3F3FF'));"/>
                <Cell col="1" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#DDFCDB',iif(toNumber(toNumber(sgbn_no)/2) == parseInt(toNumber(sgbn_no)/2), 'white', '#E3F3FF')));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(dup_sta_0917=='Y','■','')" style="backgroundimage:EXPR(iif(t_gbn=='99', 'img_Delete',''));color:EXPR(dup_color_0917);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0917" displaytype="text" style="backgroundimage:EXPR(iif(tot_gbn=='99' &amp;&amp; gfn_length(s_nm)&gt;0, 'img_Delete', ''));font:EXPR(iif(sseq_0917=='99', '굴림,9', '굴림,9'));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0917" displaytype="number" expr="expr:iif(tot_gbn=='99','',sd_won_0917)" style="align:right;"/>
                </Cell>
                <Cell col="4" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#DDFCDB','white'));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(gfn_length(dup_sta_0918)=='Y', '●', '')" style="color:EXPR(dup_color_0918);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0918" displaytype="text" style="font:EXPR(iif(sseq_0918=='99', '굴림,9', '굴림,9'));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0918" displaytype="number" style="align:right;"/>
                </Cell>
                <Cell col="7" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#DDFCDB','white'));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(gfn_length(dup_sta_0919)=='Y', '●', '')" style="color:EXPR(dup_color_0919);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0919" displaytype="text" style="font:EXPR(iif(sseq_0919=='99', '굴림,9', '굴림,9'));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0919" displaytype="number" style="align:right;"/>
                </Cell>
                <Cell col="10" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#DDFCDB','white'));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(gfn_length(dup_sta_0920)=='Y', '●', '')" style="color:EXPR(dup_color_0920);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0920" displaytype="text" style="font:EXPR(iif(sseq_0920=='99', '굴림,9', '굴림,9'));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0920" displaytype="number" style="align:right;"/>
                </Cell>
                <Cell col="13" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#DDFCDB','white'));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(gfn_length(dup_sta_0921)=='Y', '●', '')" style="color:EXPR(dup_color_0921);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0921" displaytype="text" style="font:EXPR(iif(sseq_0921=='99', '굴림,9', '굴림,9'));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0921" displaytype="number" style="align:right;"/>
                </Cell>
                <Cell col="16" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#DDFCDB','white'));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(gfn_length(dup_sta_0922)=='Y', '●', '')" style="color:EXPR(dup_color_0922);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0922" displaytype="text" style="font:EXPR(iif(sseq_0922=='99', '굴림,9', '굴림,9'));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0922" displaytype="number" style="align:right;"/>
                </Cell>
                <Cell col="19" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#DDFCDB','white'));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(gfn_length(dup_sta_0923)=='Y', '●', '')" style="color:EXPR(dup_color_0923);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0923" displaytype="text" style="font:EXPR(iif(sseq_0923=='99', '굴림,9', '굴림,9'));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0923" displaytype="number" style="align:right;"/>
                </Cell>
              </Band>
              <Band id="summary">
                <Cell col="0" displaytype="text" text="일평균원가" style="align:left;"/>
                <Cell col="1" colspan="3" displaytype="text" text="1" style="align:center;"/>
                <Cell col="4" colspan="3" displaytype="text" text="2" style="align:center;"/>
                <Cell col="7" colspan="3" displaytype="text" text="3" style="align:center;"/>
                <Cell col="10" colspan="3" displaytype="text" text="4" style="align:center;"/>
                <Cell col="13" colspan="3" displaytype="text" text="5" style="align:center;"/>
                <Cell col="16" colspan="3" displaytype="text" text="6" style="align:center;"/>
                <Cell col="19" colspan="3" displaytype="text" text="7" style="align:center;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_fcopy" onclick="btn_fcopy_OnClick" taborder="5" text="식단복사" position="absolute 542 10 617 31" class="btn_WF_Custom" image="" anchor="top right"/>
        <Button id="btn_recipe" onclick="btn_recipe_OnClick" taborder="6" text="MY레시피구성" position="absolute 618 10 729 31" class="btn_WF_Custom" image="" anchor="top right"/>
        <Button id="btn_pyo" onclick="btn_pyo_OnClick" taborder="7" text="식단평가" position="absolute 894 10 969 31" class="btn_WF_Custom" image="" anchor="top right"/>
        <Button id="btn_rut" onclick="btn_rut_OnClick" taborder="8" text="영양분석" position="absolute 730 10 805 31" class="btn_WF_Custom" image="" anchor="top right"/>
        <Button id="btn_ExcelPrint" onclick="btn_ExcelPrint_OnClick" taborder="9" text="Excel출력" position="absolute 806 10 893 31" class="btn_WF_Custom" image="" anchor="top right"/>
        <Static id="Static00" text="%  " position="absolute 151 13 256 35"/>
        <Static id="Static01" text="주간식단목표 식재료율" position="absolute 10 10 146 37" class="sta_WFDA_Label01"/>
        <MaskEdit id="me_sikrate" mask="#,##0.0" readonly="true" taborder="12" position="absolute 148 13 197 34"/>
        <ImageViewer id="Image1" image="URL('theme://convertImages/img_FlagGreen.png')" taborder="17" position="absolute 17 427 33 454" style="border:1 none #cacacaff ;" anchor="left bottom"/>
        <Static id="Static2" text="마우스 버튼클릭 : 오른쪽 버튼-&gt;MY레시피등록, 왼쪽 버튼-&gt;레시피검색 및 등록/수정" position="absolute 36 427 516 454" class="sta_WF_Bluehelp" anchor="left bottom"/>
        <ImageViewer id="img_open_close" image="URL('theme://images/new/btn_WFDA_Open.png')" transparenthittest="false" taborder="19" position="absolute 937 32 969 46" anchor="top right" onclick="img_open_close_onclick"/>
        <Button id="Button03" onclick="Button03_OnClick" taborder="21" text="   상품게시판" position="absolute 805 430 889 452" class="btn_WF_Custom" image="" style="align:left;" anchor="right bottom"/>
        <Button id="Button04" onclick="Button04_OnClick" taborder="22" text=" 식단발주" position="absolute 891 430 966 452" class="btn_WF_Custom" image="" anchor="right bottom"/>
        <Static id="Static3" text="%" position="absolute 403 13 414 37"/>
        <Static id="Static4" text="식당 예상식재료율" position="absolute 231 10 350 37" class="sta_WFDA_Label01"/>
        <MaskEdit id="me_bSikRate" mask="#,##0.0" readonly="true" taborder="25" position="absolute 352 13 401 34"/>
        <Static id="st_memo" position="absolute 420 13 524 34" class="sta_WFDA_Labelbg" style="background:transparent;border:0 none #c3c3c3ff ;"/>
        <Button id="btn_RSave" onclick="btn_RSave_OnClick" taborder="27" tabstop="false" text="원가갱신" position="absolute 726 430 803 452" class="btn_WF_Custom" image="" anchor="right bottom"/>
        <MaskEdit id="me_Sdate" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="28" type="string" position="absolute 614 430 693 451" anchor="right bottom"/>
        <Static id="Static6" text="원가 갱신일" position="absolute 528 427 611 454" class="sta_WFDA_Label01" anchor="right bottom"/>
        <Button id="btn_Sdate" onclick="g_CalButton_OnClick" taborder="29" tabstop="false" text="" userdata="me_Sdate" position="absolute 692 430 713 451" class="btn_WF_cal" image="" anchor="right bottom"/>
        <Grid selecttype="row" cellsizingtype="both" enable="true" id="grd_lst" useinputpanel="false" oncellclick="grd_lst_OnCellClick" onmouseleave="grd_lst_OnMouseOut" onmousemove="grd_lst_OnMouseOver" onrbuttondown="grd_lst_OnRButtonDown" taborder="32" tabstop="true" usecontextmenu="true" useselcolor="false" visible="true" wheelscrollrow="1" position="absolute 10 47 970 422" readonly="true" anchor="all" autofittype="col">
          <Formats/>
        </Grid>
        <Div id="div_pyo" taborder="18" url="U_FMM::FMM00209P.xfdl" visible="false" position="absolute 528 47 973 425" scrollbars="none" anchor="top right" style="border:2 solid darkgray ;"/>
        <Static id="Static60" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 979 10" anchor="left top"/>
        <Static id="Static07" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 10 10 460"/>
        <Static id="Static05" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 969 10 979 455"/>
        <Static id="Static35" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 10 454 978 464" anchor="left top"/>
        <Static id="Static09" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 8 37 539 47" anchor="left top"/>
        <Static id="Static19" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 4 422 974 427"/>
        <Grid id="Grid00" taborder="33" wheelscrollrow="1" readonly="true" useinputpanel="false" visible="false" position="absolute 16 496 863 667" autofittype="col">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="100" band="left"/>
                <Column size="17"/>
                <Column size="108"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="108"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="108"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="108"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="108"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="108"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="108"/>
                <Column size="36"/>
              </Columns>
              <Rows>
                <Row size="48" band="head"/>
                <Row size="24"/>
                <Row size="48" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" text="끼니&#10;(코너명)"/>
                <Cell col="1" colspan="2" displaytype="text" style="color:#FFFFFF;" text="01/19(월)"/>
                <Cell col="3" displaytype="image"/>
                <Cell col="4" colspan="2" displaytype="text" style="color:#FFFFFF;" text="01/20(화)"/>
                <Cell col="6" displaytype="image"/>
                <Cell col="7" colspan="2" displaytype="text" style="color:#FFFFFF;" text="01/21(수)"/>
                <Cell col="9" displaytype="image"/>
                <Cell col="10" colspan="2" displaytype="text" style="color:#FFFFFF;" text="01/22(목)"/>
                <Cell col="12" displaytype="image"/>
                <Cell col="13" colspan="2" displaytype="text" style="color:#FFFFFF;" text="01/23(금)"/>
                <Cell col="15" displaytype="image"/>
                <Cell col="16" colspan="2" displaytype="text" style="color:#99CCFF;" text="01/24(토)"/>
                <Cell col="18" displaytype="image"/>
                <Cell col="19" colspan="2" displaytype="text" style="color:#FFCC00;" text="01/25(일)"/>
                <Cell col="21" displaytype="image"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;background:azure;background2:azure;font:굴림,10,bold;linetype:onlyvert;" expr="expr:iif(gfn_length(CGBN_NM) == 0, gfn_nvl(SGBN_NM)+gfn_nvl(CGBN), gfn_nvl(SGBN_NM)+gfn_nvl(CGBN)+'('+gfn_nvl(CGBN_NM)+')')" suppress="1" suppressalign="middle"/>
                <Cell col="1" colspan="3" style="linetype:onlyvert;background:expr(TOT_GBN=='99'?'#FFEFB5':'azure');background2:expr(TOT_GBN=='99'?'#FFEFB5':'azure');font: ;">
                  <Cell displaytype="expr:TOT_GBN=='99'?'image':gfn_length(SD_NM_0119)&gt;0)?'text':''" style="align:center middle;" text="expr:TOT_GBN=='99'?&quot;URL('theme://images/new/grd_WF_ExpandImageX.png')&quot;:(DUP_STA_0119=='Y')?'■':''"/>
                  <Cell col="1" displaytype="text" style="font:expr(iif(TOT_GBN=='99', '굴림,9,bold', '굴림,9'));align:left;" text="bind:SD_NM_0119"/>
                  <Cell col="2" displaytype="number" style="align:right;" expr="expr:iif(TOT_GBN=='99',gfn_nvl(''),gfn_nvl(SD_WON_0119))"/>
                </Cell>
                <Cell col="4" colspan="3" style="background:expr(TOT_GBN=='99'?'#FFEFB5':'azure');background2:expr(TOT_GBN=='99'?'#FFEFB5':'azure');linetype:onlyvert; ">
                  <Cell displaytype="expr:TOT_GBN=='99'?'image':gfn_length(SD_NM_0120)&gt;0)?'text':''" style="align:center middle;" text="expr:TOT_GBN=='99'?&quot;URL('theme://images/new/grd_WF_ExpandImageX.png')&quot;:(DUP_STA_0120=='Y')?'■':''"/>
                  <Cell col="1" displaytype="text" style="font:expr(iif(TOT_GBN=='99', '굴림,9,bold', '굴림,9'));align:left;" text="bind:SD_NM_0120"/>
                  <Cell col="2" displaytype="number" style="align:right;" expr="expr:iif(TOT_GBN=='99',gfn_nvl(''),gfn_nvl(SD_WON_0120))"/>
                </Cell>
                <Cell col="7" colspan="3" style="background:expr(TOT_GBN=='99'?'#FFEFB5':'azure');background2:expr(TOT_GBN=='99'?'#FFEFB5':'azure');linetype:onlyvert; ">
                  <Cell displaytype="expr:TOT_GBN=='99'?'image':gfn_length(SD_NM_0121)&gt;0)?'text':''" style="align:center middle;" text="expr:TOT_GBN=='99'?&quot;URL('theme://images/new/grd_WF_ExpandImageX.png')&quot;:(DUP_STA_0121=='Y')?'■':''"/>
                  <Cell col="1" displaytype="text" style="font:expr(iif(TOT_GBN=='99', '굴림,9,bold', '굴림,9'));align:left;" text="bind:SD_NM_0121"/>
                  <Cell col="2" displaytype="number" style="align:right;" expr="expr:iif(TOT_GBN=='99',gfn_nvl(''),gfn_nvl(SD_WON_0121))"/>
                </Cell>
                <Cell col="10" colspan="3" style="background:expr(TOT_GBN=='99'?'#FFEFB5':'azure');background2:expr(TOT_GBN=='99'?'#FFEFB5':'azure');linetype:onlyvert; ">
                  <Cell displaytype="expr:TOT_GBN=='99'?'image':gfn_length(SD_NM_0122)&gt;0)?'text':''" style="align:center middle;" text="expr:TOT_GBN=='99'?&quot;URL('theme://images/new/grd_WF_ExpandImageX.png')&quot;:(DUP_STA_0122=='Y')?'■':''"/>
                  <Cell col="1" displaytype="text" style="font:expr(iif(TOT_GBN=='99', '굴림,9,bold', '굴림,9'));align:left;" text="bind:SD_NM_0122"/>
                  <Cell col="2" displaytype="number" style="align:right;" expr="expr:iif(TOT_GBN=='99',gfn_nvl(''),gfn_nvl(SD_WON_0122))"/>
                </Cell>
                <Cell col="13" colspan="3" style="background:expr(TOT_GBN=='99'?'#FFEFB5':'azure');background2:expr(TOT_GBN=='99'?'#FFEFB5':'azure');linetype:onlyvert; ">
                  <Cell displaytype="expr:TOT_GBN=='99'?'image':gfn_length(SD_NM_0123)&gt;0)?'text':''" style="align:center middle;" text="expr:TOT_GBN=='99'?&quot;URL('theme://images/new/grd_WF_ExpandImageX.png')&quot;:(DUP_STA_0123=='Y')?'■':''"/>
                  <Cell col="1" displaytype="text" style="font:expr(iif(TOT_GBN=='99', '굴림,9,bold', '굴림,9'));align:left;" text="bind:SD_NM_0123"/>
                  <Cell col="2" displaytype="number" style="align:right;" expr="expr:iif(TOT_GBN=='99',gfn_nvl(''),gfn_nvl(SD_WON_0123))"/>
                </Cell>
                <Cell col="16" colspan="3" style="background:expr(TOT_GBN=='99'?'#FFEFB5':'azure');background2:expr(TOT_GBN=='99'?'#FFEFB5':'azure');linetype:onlyvert; ">
                  <Cell displaytype="expr:TOT_GBN=='99'?'image':gfn_length(SD_NM_0124)&gt;0)?'text':''" style="align:center middle;" text="expr:TOT_GBN=='99'?&quot;URL('theme://images/new/grd_WF_ExpandImageX.png')&quot;:(DUP_STA_0124=='Y')?'■':''"/>
                  <Cell col="1" displaytype="text" style="font:expr(iif(TOT_GBN=='99', '굴림,9,bold', '굴림,9'));align:left;" text="bind:SD_NM_0124"/>
                  <Cell col="2" displaytype="number" style="align:right;" expr="expr:iif(TOT_GBN=='99',gfn_nvl(''),gfn_nvl(SD_WON_0124))"/>
                </Cell>
                <Cell col="19" colspan="3" style="background:expr(TOT_GBN=='99'?'#FFEFB5':'azure');background2:expr(TOT_GBN=='99'?'#FFEFB5':'azure');linetype:onlyvert; ">
                  <Cell displaytype="expr:TOT_GBN=='99'?'image':gfn_length(SD_NM_0125)&gt;0)?'text':''" style="align:center middle;" text="expr:TOT_GBN=='99'?&quot;URL('theme://images/new/grd_WF_ExpandImageX.png')&quot;:(DUP_STA_0125=='Y')?'■':''"/>
                  <Cell col="1" displaytype="text" style="font:expr(iif(TOT_GBN=='99', '굴림,9,bold', '굴림,9'));align:left;" text="bind:SD_NM_0125"/>
                  <Cell col="2" displaytype="number" style="align:right;" expr="expr:iif(TOT_GBN=='99',gfn_nvl(''),gfn_nvl(SD_WON_0125))"/>
                </Cell>
              </Band>
              <Band id="summary">
                <Cell displaytype="text" style="align:center middle;" class="grd_WF_SummaryBody1" text="일평균원가"/>
                <Cell col="1" colspan="3" displaytype="text" style="align:right middle;" class="grd_WF_SummaryBody1"/>
                <Cell col="4" colspan="3" displaytype="text" style="align:right middle;" class="grd_WF_SummaryBody1"/>
                <Cell col="7" colspan="3" displaytype="text" style="align:right middle;" class="grd_WF_SummaryBody1"/>
                <Cell col="10" colspan="3" displaytype="text" style="align:right middle;" class="grd_WF_SummaryBody1"/>
                <Cell col="13" colspan="3" displaytype="text" style="align:right middle;" class="grd_WF_SummaryBody1"/>
                <Cell col="16" colspan="3" displaytype="text" style="align:right middle;" class="grd_WF_SummaryBody1"/>
                <Cell col="19" colspan="3" displaytype="text" style="align:right middle;" class="grd_WF_SummaryBody1"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static11" text="%" position="absolute 199 13 210 37"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="DS_menu"/>
      <Dataset id="DS_head">
        <ColumnInfo>
          <Column id="FDAY" size="256" type="STRING"/>
          <Column id="WE" size="256" type="STRING"/>
          <Column id="WE_COLOR" size="256" type="STRING"/>
          <Column id="WCD" size="256" type="STRING"/>
          <Column id="WNM" size="256" type="STRING"/>
          <Column id="WIMG" size="256" type="STRING"/>
          <Column id="REM" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_body">
        <ColumnInfo>
          <Column id="FDAY" size="256" type="STRING"/>
          <Column id="SGBN" size="256" type="STRING"/>
          <Column id="SGBN_NM" size="256" type="STRING"/>
          <Column id="CGBN" size="256" type="STRING"/>
          <Column id="CGBN_NM" size="256" type="STRING"/>
          <Column id="CGBN_CD" size="256" type="STRING"/>
          <Column id="DUP_STA" size="256" type="STRING"/>
          <Column id="DUP_COLOR" size="256" type="STRING"/>
          <Column id="SSEQ" size="256" type="STRING"/>
          <Column id="SD_CD" size="256" type="STRING"/>
          <Column id="SD_NM" size="256" type="STRING"/>
          <Column id="SD_WON" size="256" type="STRING"/>
          <Column id="MEAL_PRICE" size="256" type="STRING"/>
          <Column id="RECIPE_COST_RATE" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_body_f">
        <ColumnInfo>
          <Column id="CGBN" size="100" type="STRING"/>
          <Column id="CGBN_CD" size="20" type="STRING"/>
          <Column id="CGBN_NM" size="50" type="STRING"/>
          <Column id="DUP_COLOR" size="3" type="STRING"/>
          <Column id="DUP_STA" size="1" type="STRING"/>
          <Column id="FDAY" size="8" type="STRING"/>
          <Column id="MEAL_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_COST_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="SD_CD" size="20" type="STRING"/>
          <Column id="SD_NM" size="50" type="STRING"/>
          <Column id="SD_WON" size="22" type="BIGDECIMAL"/>
          <Column id="SGBN" size="20" type="STRING"/>
          <Column id="SGBN_NM" size="100" type="STRING"/>
          <Column id="SSEQ" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR">RED</Col>
            <Col id="DUP_STA">Y</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR">RED</Col>
            <Col id="DUP_STA">Y</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR">RED</Col>
            <Col id="DUP_STA">Y</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR">RED</Col>
            <Col id="DUP_STA">Y</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="DS_body_c" keystring="fday:sgbn:cgbn:cgbn_cd:sgbn_nm:cgbn_nm">
        <ColumnInfo>
          <Column id="column0" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_sgbn">
        <ColumnInfo>
          <Column id="SGBN" size="256" type="STRING"/>
          <Column id="SGBN_NM" size="256" type="STRING"/>
          <Column id="CGBN" size="256" type="STRING"/>
          <Column id="CGBN_NM" size="256" type="STRING"/>
          <Column id="CGBN_CD" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_menu2"/>
      <Dataset id="ds_list">
        <ColumnInfo>
          <Column id="CD" size="50" type="STRING"/>
          <Column id="CNT" size="22" type="BIGDECIMAL"/>
          <Column id="INFO" size="4000" type="STRING"/>
          <Column id="NM" size="50" type="STRING"/>
          <Column id="TEXTCOLOR" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_out"/>
      <Dataset id="ds_input2">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="SDATE" size="256" type="STRING"/>
          <Column id="O_RTN" size="256" type="STRING"/>
          <Column id="O_RTNMSG" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_return">
        <ColumnInfo>
          <Column id="O_RTN" size="256" type="STRING"/>
          <Column id="O_RTNMSG" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="O_RTN"/>
            <Col id="O_RTNMSG"/>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/**
====================================================================================================(100)
 1. 시    스    템	: 	식재영업
 2. 서브    시스템 	:   주간식단표조회
 3. 프로그램  개요 	: 	
 4. 작    성    자 	:  	
 5. 작    성    일 	: 	
====================================================================================================
 6. 수정자/수정일   : 
 7. 수정사유/내역   : 
====================================================================================================
**/
//===========================================================================================(90)
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//******************************************************************************************
include "U_lib::lib_conversionCom.xjs";
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::fm_common.js"			// FM공통

//******************************************************************************************
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//******************************************************************************************
var	il_cnt		= 0;	// 기간에 해당되는 일수를 산정
var def_cha		= 2;	// 차감 col pointer
var open_win1	= 0;	// 차감 col pointer
var fa_gbn		= "";	// 팝업 구분

var v_sale_sum  = 0;    // 식당예상식재료율 계산용
var v_wonga_sum = 0;    // 식당예상식재료율 계산용
var v_form_load = false;

var v_grd_lst_formats = "";
//******************************************************************************************
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//******************************************************************************************
function form_onload(obj:Form, e:LoadEventInfo)
{
	if ( v_form_load ) {
		return;
	} else {
		v_form_load = true;
	}
	
	gfn_formOnLoad(obj, false);

	// X-Framework : Action 정보 생성 
	fsp_init(this);
	me_Sdate.value = gfn_addDate(gfn_today(),1);	
	
	v_grd_lst_formats = '<Formats><Format id="default"></Format></Formats>';
}

//******************************************************************************************
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//******************************************************************************************

/*------------------------------------------------------------(60)
	1. Function ID : fn_Search()
	2. 개       요 : 업무프로세스에 따른 조회작업
	3. 기       능 : 검색조건에 해당하는 정보를 조회
	4. 인 수 설 명 : 
*/
function fn_searchMain()
{
	grd_lst.formats = v_grd_lst_formats;

	if (fn_Search_chk() == false) {
		return false;
	}
	
	il_cnt = parent.parent.il_cnt;
//trace("il_cnt===="+il_cnt);

	// Grid Head : 주간 일정 [Local Data를 DataSet으로 전환--> 향후 서비스로 대체]
	fn_Sel_DS_head();
	if (DS_head.rowcount == 0) {
		g_Message("EE",	"주간일정 정보가 없습니다.");
		return true;
	}

	// DS_sgbn : 식구분 [Local Data를 DataSet으로 전환--> 향후 서비스로 대체]
	fn_Sel_DS_sgbn();
//trace(DS_sgbn.saveXML());
//trace("DS_sgbn.rowcount==="+DS_sgbn.rowcount);
	if (DS_sgbn.rowcount == 0) {
		g_Message("EE",	"식,끼니 정보가 없습니다.");
		return true;
	}

	// Grid Body : 주간식단표 [Local Data를 DataSet으로 전환--> 향후 서비스로 대체]
	fn_Sel_DS_body();

	//alert("DS loading OK !!");

	// 작업용 DataSet 마련 - Grid용 DataSet 작성 작업용 (Filter 용)
	//DS_body_f.Clear();
	//DS_body_f.Copy("DS_body");

	return true;
}

/*------------------------------------------------------------
	1. Function ID : fn_Insert()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_insert()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Save()
	2. 개       요 : 업무프로세스에 따른 정보 저장작업
	3. 기       능 : 저장버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_save()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Delete()
	2. 개       요 : 업무프로세스에 따른 정보 삭제작업
	3. 기       능 : 삭제버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_delete()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Print()
	2. 개       요 : 업무프로세스에 따른 선별된 정보를 출력지로 인쇄
	3. 기       능 : 인쇄버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_print()
{
}

//******************************************************************************************
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//******************************************************************************************
/*
 ******************************************************************************************
	1. Function ID : fn_call_back_body(svc_id, cd, err_msg)
	2. 개       요 : CallBack Process
	3. 기       능 : 
	4. 인 수 설 명 : 
 ******************************************************************************************
 */
//function fn_call_back(cd, err_msg)
function fn_call_back_body(cd, err_msg)
{
	if(cd!=0){
		g_Message("EE",	"서비스 오류:시스템 관리자에게 문의하십시오\n\n"+svc_id+"\n"+err_msg);
		return;
	} else {
		DS_body_f.copyData(DS_body);
		
		// Grid에 사용할 DataSet을 작성합니다.
		grd_lst.enableredraw = false;
		grd_lst.binddataset = "";
		fn_make_DS_menu();
		
		// Grid Format을 작성합니다.
		grd_lst.binddataset = "";
		fn_make_grdlst();
		grd_lst.binddataset = "DS_menu";
		grd_lst.enableredraw = true;

		// 주간식당목표 식재료율 LOAD
		this.parent.parent.fn_sikrateSearch();
		fn_me_bSikRate();

		// 식단평가에 기초셋팅을 한다.
		div_pyo.fn_Init();
		st_pyoTitle.text = "";
	}
}

function fn_afterSearch(errCode, errMsg)
{
	if(errCode!=0)
	{
		g_Message("EE",	"서비스 오류:시스템 관리자에게 문의하십시오");
	}
}

/*
 ******************************************************************************************
	1. Function ID : fn_Sel_DS_head()
	2. 개       요 : 식단표의 Head 구성요소를 작성한다.
	3. 기       능 : 제공일에 해당하는 주의 기준 Head Data를 작성한다.
	4. 인 수 설 명 : 
 ******************************************************************************************
 */
function fn_Sel_DS_head()
{
	// 초기화
	DS_head.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "ds_input=ds_input";
	outData			= "DS_head=DS_head";
	callBackFnc		= "fn_afterSearch";
	
	fsp_clear(this); 
    fsp_addSearch(this, "fm/fmm:FMM00052E_S002");									// 조회 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
	http.Sync = false;

}

/*
 ******************************************************************************************
	1. Function ID : fn_Sel_DS_sgbn()
	2. 개       요 : 식단표의 좌측 기준정보(식,끼니)를 작성한다.
	3. 기       능 : 제공일에 해당하는 주의 좌측 기준정보(식,끼니)를 작성한다.
	4. 인 수 설 명 : 
 ******************************************************************************************
 */
function fn_Sel_DS_sgbn()
{
	// 초기화
	DS_sgbn.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "ds_input=ds_input";
	outData			= "DS_sgbn=DS_sgbn";
	callBackFnc		= "fn_afterSearch";
	
	fsp_clear(this); 
    fsp_addSearch(this, "fm/fmm:FMM00160E_S003");									// 조회 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
	http.Sync = false;

}

/*
 ******************************************************************************************
	1. Function ID : fn_Sel_DS_body()
	2. 개       요 : 메뉴정보를 불러온다.
	3. 기       능 : 제공일에 해당하는 주의 메뉴정보를 불러온다.
	4. 인 수 설 명 : 
 ******************************************************************************************
 */
function fn_Sel_DS_body()
{
	// 초기화
	DS_body.clearData();
	
	// 조회
	/* X-FrameWork 사용 시
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "ds_input=ds_input";
	outData			= "DS_body=DS_body DS_body_f=DS_body";
	callBackFnc		= "fn_afterSearch";
	
	tit_clearActionInfo(this); 
    tit_addSearchActionInfo(this, "fm/fmm:FMM00200V_S001");									// 조회 
	http.Sync = true;
    tit_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
	http.Sync = false;
	*/
	// JSP 사용 시
	var ActionVal	= "";
	var OutDS		= "";
	var InDS		= "";
	var V_callback	= "fn_call_back_body";
	
	ActionVal    +="UPJANG="		+ wrapQuote(ds_input.getColumn(0, "UPJANG"));
	ActionVal    +=" SUBINV_CODE="	+ wrapQuote(ds_input.getColumn(0, "SUBINV_CODE"));
	ActionVal    +=" MENU_SDATE="	+ wrapQuote(ds_input.getColumn(0, "MENU_SDATE"));

	OutDS ="DS_body=DS_body";	
	//alert(ActionVal);
	jsp_transaction(this, "FMM00200V_S001","U_svc::" + "fm/fmm/FMM00200V_S001.jsp",InDS,OutDS,ActionVal,V_callback,false,false,true);
}

/*------------------------------------------------------------
	1. Function ID : fn_make_DS_menu()
	2. 개       요 : Grid body에 해당하는 DataSet을 작성
	3. 기       능 : Grid body Format에 맞게 DS_menu DataSet의 Format을 작성하고 DataSet Format에 맞게
	                 Data를 Loading 시킨다.
	4. 인 수 설 명 : 
*/
function fn_make_DS_menu()
{
//trace("fn_make_DS_menu>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>");
//trace(DS_sgbn.saveXML());
	DS_menu.enableevent = false;
	
	DS_menu.clear();  
	
	// DataSet format을 작성합니다.
	DS_menu.addColumn('SGBN'   , 'STRING', 256);
	DS_menu.addColumn('SGBN_NM', 'STRING', 256);
	DS_menu.addColumn('CGBN'   , 'STRING', 256);
	DS_menu.addColumn('CGBN_NM', 'STRING', 256);
	DS_menu.addColumn('CGBN_CD', 'STRING', 256);
	DS_menu.addColumn('SGBN_NO', 'STRING', 256);
	DS_menu.addColumn('TOT_GBN', 'STRING', 256);

	//G_debug("DS_head");
	for(var ii = 0; ii < il_cnt; ii++)
	{
		DS_menu.addColumn('PHF_'             + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('DUP_STA_'         + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('DUP_COLOR_'       + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('SSEQ_'            + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('SD_CD_'           + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('SD_NM_'           + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('SD_WON_'          + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('MEAL_PRICE_'      + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		
		DS_menu.addColumn('SALE_PRICE_'      + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('EXPECT_QTY_'      + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		
		DS_menu.addColumn('RECIPE_COST_RATE_'+ gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('MAIN_ITEM_CODE1_' + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('CUISINE_TYPE_'    + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
	}

	// Data를 작성합니다. [ DS_body -> DS_menu Create ]
	var set_row 		= -1;
	var	cnt_ds_total 	= 0;
	var set_col 		= "";

	for(var ii = 0; ii < DS_sgbn.getRowCount(); ii++) {
		DS_body_f.filter("");

		var fil_cond = "SGBN == '"+DS_sgbn.getColumn(ii, "SGBN")+"' && CGBN == '"+DS_sgbn.getColumn(ii, "CGBN")+"' && CGBN_CD == '"+DS_sgbn.getColumn(ii, "CGBN_CD")+"'";
		DS_body_f.filter(fil_cond);
		CopyF(DS_body_c,DS_body_f);
		
		// DS_menu DataSet에 Row를 생성
		max_row = toNumber(fn_clearNaN(DS_body_c.getMax("SSEQ"))) + 1;		//logical Row포함
		// DS_menu DataSet에 Row를 생성
		for(var jj = 0; jj < max_row; jj++) {
			set_row = DS_menu.addRow();

			DS_menu.setColumn(set_row, "SGBN", 		DS_sgbn.getColumn(ii, "SGBN"));
			DS_menu.setColumn(set_row, "SGBN_NM", 	DS_sgbn.getColumn(ii, "SGBN_NM"));
			DS_menu.setColumn(set_row, "CGBN", 		DS_sgbn.getColumn(ii, "CGBN"));
			DS_menu.setColumn(set_row, "CGBN_NM", 	DS_sgbn.getColumn(ii, "CGBN_NM"));
			DS_menu.setColumn(set_row, "CGBN_CD", 	DS_sgbn.getColumn(ii, "CGBN_CD"));
			DS_menu.setColumn(set_row, "SGBN_NO", 	(ii+1));
			DS_menu.setColumn(set_row, "TOT_GBN",   (ii%2));
		}
		
		//Group : logical자료생성
		DS_body_c.keystring = "G:+SGBN+CGBN+CGBN_CD+FDAY";
		
		// 생성된 Row에 Data를 setup 한다
		for(var kk = 0; kk < DS_body_c.rowcount; kk++) {
			if (GetRowType(DS_body_c,kk)== "logical") {
				set_row = cnt_ds_total + max_row - 1;
				set_col = gfn_subStr(DS_body_c.getColumn(kk-1, "FDAY"),4,4);
				//trace("logical set_col==="+set_col);
				DS_menu.setColumn(set_row, "TOT_GBN","99");
				//DS_menu.setColumn(set_row, "SSEQ"   ,"99");
				
				var	v_case			= "FDAY=='"+DS_body_c.getColumn(kk-1, "FDAY")+"'";	//summary조건				
				var	v_price 		= DS_body_c.getCaseSum(v_case, "SD_WON");				
				var	v_meal_price 	= fn_clearNaN(DS_body_c.getCaseAvg(v_case, "MEAL_PRICE"));	
				var	v_sale_price 	= fn_clearNaN(DS_body_c.getCaseAvg(v_case, "SALE_PRICE"));
				var	v_expect_qty 	= fn_clearNaN(DS_body_c.getCaseAvg(v_case, "EXPECT_MEAL_QTY"));		
				var	v_cost_rate 	= fn_clearNaN(DS_body_c.getCaseAvg(v_case, "RECIPE_COST_RATE"));

				DS_menu.setColumn(set_row, "SD_NM_"				+set_col, 	gfn_numFormat(v_price, 0)+"원 " + v_expect_qty + "명"+"("+gfn_numFormat(Math.round((toNumber(v_price)/toNumber(v_sale_price))*100,1), 1)+"%)");
				DS_menu.setColumn(set_row, "SD_WON_"			+set_col, 	v_price);
				DS_menu.setColumn(set_row, "MEAL_PRICE_"		+set_col, 	v_meal_price);
				
				DS_menu.setColumn(set_row, "SALE_PRICE_"		+set_col, 	v_sale_price);
				DS_menu.setColumn(set_row, "EXPECT_QTY_"		+set_col, 	v_expect_qty);
				
				DS_menu.setColumn(set_row, "RECIPE_COST_RATE_"	+set_col, 	v_cost_rate);
				DS_menu.setColumn(set_row, "PHF_"				+set_col, 	"");
				DS_menu.setColumn(set_row, "MAIN_ITEM_CODE1_"	+set_col, 	"");
				DS_menu.setColumn(set_row, "CUISINE_TYPE_"		+set_col, 	"");
			}
			else {
				set_row = cnt_ds_total + toNumber(DS_body_c.getColumn(kk, "SSEQ")) - 1;
				set_col = gfn_subStr(DS_body_c.getColumn(kk, "FDAY"),4,4);
// trace("	FDAY==="+	set_col);		
// trace("DUP_STA==="+DS_body_c.getColumn(kk, "DUP_STA"));
// trace("DUP_COLOR==="+DS_body_c.getColumn(kk, "DUP_COLOR"));
				DS_menu.setColumn(set_row, "DUP_STA_"	+set_col, 	DS_body_c.getColumn(kk, "DUP_STA"));
				DS_menu.setColumn(set_row, "DUP_COLOR_"	+set_col, 	DS_body_c.getColumn(kk, "DUP_COLOR"));
				DS_menu.setColumn(set_row, "SSEQ_"		+set_col, 	DS_body_c.getColumn(kk, "SSEQ"));
				DS_menu.setColumn(set_row, "SD_CD_"		+set_col, 	DS_body_c.getColumn(kk, "SD_CD"));
				
				//DS_menu.setColumn(set_row, "TOT_GBN", ""); 
				//DS_menu.setColumn(set_row, "SSEQ"   , "");
			
				DS_menu.setColumn(set_row, "SD_NM_"				+set_col, 	DS_body_c.getColumn(kk, "SD_NM"));
				DS_menu.setColumn(set_row, "SD_WON_"			+set_col, 	DS_body_c.getColumn(kk, "SD_WON"));
				DS_menu.setColumn(set_row, "MEAL_PRICE_"		+set_col, 	DS_body_c.getColumn(kk, "MEAL_PRICE"));
				
				DS_menu.setColumn(set_row, "SALE_PRICE_"		+set_col, 	DS_body_c.getColumn(kk, "SALE_PRICE"));
				DS_menu.setColumn(set_row, "EXPECT_QTY_"		+set_col, 	DS_body_c.getColumn(kk, "EXPECT_MEAL_QTY"));
				
				DS_menu.setColumn(set_row, "RECIPE_COST_RATE_"	+set_col, 	DS_body_c.getColumn(kk, "RECIPE_COST_RATE"));
				DS_menu.setColumn(set_row, "PHF_"				+set_col, 	DS_body_c.getColumn(kk, "PHF"));
				DS_menu.setColumn(set_row, "MAIN_ITEM_CODE1_"	+set_col, 	DS_body_c.getColumn(kk, "MAIN_ITEM_CODE1"));
				DS_menu.setColumn(set_row, "CUISINE_TYPE_"		+set_col, 	DS_body_c.getColumn(kk, "CUISINE_TYPE"));
			}
		}
		// DS_menu Row 위치를 산정하기 위한 누적값
		cnt_ds_total = cnt_ds_total + max_row;
		
		DS_body_c.keystring = "";
	}

	DS_menu.rowposition = 0;
	DS_menu.applyChange();
	
	// 식당예상 식재료율을 구하기 위한 dataset을 생성
	DS_menu.filter("TOT_GBN=='99'");
	CopyF(DS_menu2,DS_menu);
	DS_menu.filter("");

	DS_menu.enableevent = true;
	//G_debug("DS_menu2");
}

/*------------------------------------------------------------
	1. Function ID : fn_make_grdlst()
	2. 개       요 : 조건에 맞는 Grid Format을 작성
	3. 기       능 : 검색조건 기간이 유동적으로 구성되므로 조건에 해당하는 정보를 화면으로
	                 출력하기 위해 Grid를 재구성한다.
	4. 인 수 설 명 : 
-----------------------------------------------------------*/
function fn_make_grdlst()
{
//trace(DS_menu.saveXML());
	objGrid = grd_lst;
	
	// GRID 작성
	var Contents_grd_lst	 = "";
	var Contents_grd_column  = "";
	var Contents_grd_rows    = "";
	var Contents_grd_head    = "";
	var Contents_grd_body    = "";
	var Contents_grd_body1    = "";
	var Contents_grd_summary = "";
	// 
	// Grid를 작성합니다.
	//
	Contents_grd_lst	 = '<Formats>' + '\n';
	Contents_grd_lst    += '<Format id="default">' + '\n';
	
	// Grid columns를 작성합니다.
	Contents_grd_column  = ' <Columns>' + '\n';
	Contents_grd_column	+= ' <Column size="100" band="left" />' + '\n';
	
	for(var ii = 0; ii < il_cnt; ii++)
	{
		Contents_grd_column	+= ' <Column size="18" />' + '\n';
		Contents_grd_column	+= ' <Column size="110"  />' + '\n';
		Contents_grd_column	+= ' <Column size="36"  />' + '\n';
	}
	Contents_grd_column += ' </Columns>' + '\n'; 

	// Grid rows를 작성합니다.
	Contents_grd_rows  = ' <Rows>' + '\n';
  	Contents_grd_rows += ' <Row size="48" band="head" />' + '\n';
  	Contents_grd_rows += ' <Row size="24" />'             + '\n';
  	Contents_grd_rows += ' <Row size="48" band="summ" />' + '\n';
	Contents_grd_rows += ' </Rows>' + '\n';
	
	// Grid head를 작성합니다.
	Contents_grd_head	 = '  <Band id="head">' + '\n';
	Contents_grd_head	+= '   <cell col="0" displaytype="text" text="끼니&#10;(코너명)"  /> ' + '\n';

	var	v_col1 = -2;
	var	v_col2 = 0;
	var	v_day  = "";

	for(var ii = 0; ii < il_cnt; ii++)
	{
		v_col1 	= v_col1 + 3;
		v_col2 	= v_col2 + 3;
		
		v_day	= gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,2) + "/" + gfn_subStr(DS_head.getColumn(ii, "FDAY"),6,2) + "(" + DS_head.getColumn(ii, "WE") + ")";
		if ( gfn_isNull(DS_head.getColumn(ii,"WIMG")) ) {
			v_wImg = "";
		} else {
			v_wImg = "URL(&apos;theme://convertImages/" + DS_head.getColumn(ii,"WIMG") + ".png&apos;)";
		}

		Contents_grd_head	+= '    <cell col="'+ v_col1 + '" style="color:#'+DS_head.getColumn(ii, "WE_COLOR")+';" colspan="2" displaytype="text" text="'+v_day+'" />' + '\n';
		Contents_grd_head	+= '    <cell col="'+ v_col2 + '" style="" displaytype="image" text="'+v_wImg+'" />' + '\n';
	}
	Contents_grd_head	+= '  </Band>' + '\n';
	
  	// Grid body를 작성합니다.
  	Contents_grd_body	= '  <Band id="body">' + '\n';
    Contents_grd_body	+= ' <cell style="background:expr(toNumber(SGBN_NO,0)%2==0?&apos;#f8f8f8ff&apos;:&apos;white&apos;);background2:expr(toNumber(SGBN_NO,0)%2==0?&apos;#f8f8f8ff&apos;:&apos;white&apos;);align:center;font:굴림,10,bold;linetype:onlyvert;" displaytype="text" expr="expr:iif(gfn_length(CGBN_NM)&#32;==&#32;0,&#32;gfn_nvl(SGBN_NM)+gfn_nvl(CGBN),&#32;gfn_nvl(SGBN_NM)+gfn_nvl(CGBN)+&apos;(&apos;+gfn_nvl(CGBN_NM)+&apos;)&apos;)" suppress="1" suppressalign="middle"/>' + '\n';
	var	v_col3 = 0;
	var	v_seq  = "";
	
	for(var ii = 0; ii < il_cnt; ii++)
	{
		v_col3 = (ii * 3) + 1;
		v_seq  = gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4);
		
		Contents_grd_body	+= '  <cell col="'+ v_col3 + '" colspan="3" style="background:expr(TOT_GBN==&apos;99&apos;?&apos;#ffefb5ff&apos;:TOT_GBN==&apos;0&apos;?&apos;white&apos;:&apos;#f8f8f8ff&apos;);background2:expr(TOT_GBN==&apos;99&apos;?&apos;#ffefb5ff&apos;:TOT_GBN==&apos;0&apos;?&apos;white&apos;:&apos;#f8f8f8ff&apos;);linetype:onlyvert; ">' + '\n'; 
		Contents_grd_body	+= '   <cell col="0" displaytype="expr:TOT_GBN==&apos;99&apos;?&apos;image&apos;:&apos;text&apos;" style="align:center middle;color:expr(DUP_COLOR_'+v_seq+');color2:expr(DUP_COLOR_'+v_seq+');background:expr(TOT_GBN==&apos;99&apos;?&apos;#ffefb5ff&apos;:TOT_GBN==&apos;0&apos;?&apos;white&apos;:&apos;#f8f8f8ff&apos;);background2:expr(TOT_GBN==&apos;99&apos;?&apos;#ffefb5ff&apos;:TOT_GBN==&apos;0&apos;?&apos;white&apos;:&apos;#f8f8f8ff&apos;);" text="expr:(TOT_GBN==&apos;99&apos;&#32;&amp;&amp;&#32;gfn_length(SD_NM_' + v_seq + ')&gt;0)?&quot;URL(&apos;theme://images/new/grd_WF_ExpandImageX.png&apos;)&quot;:(DUP_STA_'+v_seq+'==&apos;Y&apos;)?&apos;■&apos;:&apos;&apos;" />' + '\n';
 		Contents_grd_body	+= '   <cell col="1" displaytype="text" style="font:돋움,8;align:left;background:expr(TOT_GBN==&apos;99&apos;?&apos;#ffefb5ff&apos;:TOT_GBN==&apos;0&apos;?&apos;white&apos;:&apos;#f8f8f8ff&apos;);background2:expr(TOT_GBN==&apos;99&apos;?&apos;#ffefb5ff&apos;:TOT_GBN==&apos;0&apos;?&apos;white&apos;:&apos;#f8f8f8ff&apos;);" text="bind:SD_NM_' + v_seq + '"/>' + '\n';
 		Contents_grd_body	+= '   <cell col="2" displaytype="number" style="font:돋움,8;align:right;background:expr(TOT_GBN==&apos;99&apos;?&apos;#ffefb5ff&apos;:TOT_GBN==&apos;0&apos;?&apos;white&apos;:&apos;#f8f8f8ff&apos;);background2:expr(TOT_GBN==&apos;99&apos;?&apos;#ffefb5ff&apos;:TOT_GBN==&apos;0&apos;?&apos;white&apos;:&apos;#f8f8f8ff&apos;);" expr="expr:iif(TOT_GBN==&apos;99&apos;,gfn_nvl(&apos;&apos;),gfn_nvl(SD_WON_' + v_seq + '))"/>' + '\n';

 		Contents_grd_body	+= '  </cell>' + '\n'; 
    }
 	Contents_grd_body	+= '  </Band>' + '\n'; 

	// Grid Summary를 작성합니다.
  	Contents_grd_summary	 = '  <Band id="summary">' + '\n';
  	Contents_grd_summary	+= '    <cell col="0" style="align:center middle;" class="grd_WF_SummaryBody1" displaytype="text" text="일평균원가"/>' + '\n'; 
  	
	var v_col3 = 0;
	v_seq  = "";
	
	//form변수
	v_sale_sum  = 0;
	v_wonga_sum = 0;
		
	for(var ii = 0; ii < il_cnt; ii++)
	{
		v_col3 = (ii * 3) + 1;
		v_seq  = gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4);
		
		var v_sale        = 0;
		var v_wonga       = 0;
		var v_expect_qty  = 0;
		
		for(var jj = 0; jj < DS_menu.rowcount; jj++) {
			if ( DS_menu.getColumn(jj, "TOT_GBN") == "99") {
// trace(	"SALE_PRICE_==="+toNumber(DS_menu.getColumn(jj, "SALE_PRICE_"+v_seq)));
// trace(	"SD_WON_==="+toNumber(DS_menu.getColumn(jj, "SD_WON_"+v_seq)));
// trace(	"EXPECT_QTY_==="+toNumber(DS_menu.getColumn(jj, "EXPECT_QTY_"+v_seq)));
				v_sale	+= ( fn_clearNaN(toNumber(DS_menu.getColumn(jj, "SALE_PRICE_"+v_seq))) * fn_clearNaN(toNumber(DS_menu.getColumn(jj, "EXPECT_QTY_"+v_seq))) );
				v_wonga	+= ( fn_clearNaN(toNumber(DS_menu.getColumn(jj, "SD_WON_"+v_seq)))     * fn_clearNaN(toNumber(DS_menu.getColumn(jj, "EXPECT_QTY_"+v_seq))) );	
				v_expect_qty += fn_clearNaN(toNumber(DS_menu.getColumn(jj, "EXPECT_QTY_"+v_seq)));

				v_sale_sum	+= ( fn_clearNaN(toNumber(DS_menu.getColumn(jj, "SALE_PRICE_"+v_seq))) * fn_clearNaN(toNumber(DS_menu.getColumn(jj, "EXPECT_QTY_"+v_seq))) );
				v_wonga_sum	+= ( fn_clearNaN(toNumber(DS_menu.getColumn(jj, "SD_WON_"+v_seq)))     * fn_clearNaN(toNumber(DS_menu.getColumn(jj, "EXPECT_QTY_"+v_seq))) );	
			}
		}		
		var v_cnt	= fn_clearNaN(toNumber(DS_menu.getCaseCount("TOT_GBN=='99' && SD_WON_"+v_seq+">0"),0));
		if (v_cnt > 0) {
//trace(	"v_sale==="+v_sale+"::::v_wonga==="+v_wonga+"::::v_expect_qty==="+v_expect_qty);
//trace(	"v_sale_sum==="+v_sale_sum+"::::v_wonga_sum==="+v_wonga_sum);

			var sPerWonga = sSaleWonga = 0;
			if ( v_expect_qty == 0 ) {
				sPerWonga = 0;
			} else {
				sPerWonga = gfn_numFormat(v_wonga/v_expect_qty, 0);
			}
			
			if ( v_sale == 0 ) {
				sSaleWonga = 0;
			} else {
				sSaleWonga = gfn_numFormat((v_wonga/v_sale)*100, 1);
			}
			Contents_grd_summary	+= '    <cell col="'+ v_col3 +'" colspan="3" style="align:right middle;" class="grd_WF_SummaryBody1" displaytype="text" text="'+sPerWonga+'원('+sSaleWonga+'%)'+'"/>' + '\n'; 
		}
		else {
			Contents_grd_summary	+= '    <cell col="'+ v_col3 +'" colspan="3" style="align:right middle;" class="grd_WF_SummaryBody1" displaytype="text" text="" />' + '\n'; 
		}		  	
	}
	Contents_grd_summary	+= '  </Band>' + '\n'; 

 	Contents_grd_lst	+= Contents_grd_column + Contents_grd_rows + Contents_grd_head + Contents_grd_body + Contents_grd_summary + '</Format>' + '\n' + '</Formats>';
//trace(Contents_grd_lst);
	objGrid.formats  = Contents_grd_lst;
 	objGrid.formatid = "default"; 	
	objGrid.nodataimage = gv_noData;
		
	// 식당예상 식재료율을 계산합니다.
	// 

	//fn_me_bSikRate();
	
}


function fn_me_bSikRate() // 식당예상 식재료율
{
//trace("v_wonga_sum===="+v_wonga_sum+":::v_sale_sum==="+v_sale_sum);
	var	v_bSikRate 	= 0;
	
	if (v_sale_sum == 0) {
		v_bSikRate		= 0;
	}
	else {
		v_bSikRate		= Math.round(v_wonga_sum / v_sale_sum * 100, 1);
	}	

	me_bSikRate.value = v_bSikRate;
	
	if (Math.round(v_bSikRate - toNumber(me_sikrate.value), 1) > 0) {
		st_memo.text = "(↑ "+Math.abs(Math.round(toNumber(v_bSikRate) - toNumber(me_sikrate.value), 1))+"%P)";
		st_memo.style.color = "red";
	}
	else {
		st_memo.text = "(↓ "+Math.abs(Math.round(toNumber(v_bSikRate) - toNumber(me_sikrate.value), 1))+"%P)";
		st_memo.style.color = "blue";
	}
/*	
	var	n_sik_won = 0;
	var n_sale	  = 0;

	for(var ii = 0; ii < DS_menu2.RowCount(); ii++) {
	
		var	fil_cond	= "sgbn=='"+DS_menu2.GetColumn(ii, "sgbn")+"'&&cgbn=='"+DS_menu2.GetColumn(ii, "cgbn")+"'&&cgbn_cd=='"+DS_menu2.GetColumn(ii, "cgbn_cd")+"'";
		var	m1_row		= tab_Main.tab00.DS_menu1.SearchRow(fil_cond);
		
		for(var kk = 0; kk < DS_head.RowCount(); kk++) {
		
			var set_col 	= Mid(DS_head.GetColumn(kk, "fday"),4,4);
			var m1_col		= "expect_meal_qty_"+set_col;
			var m2_col		= "sd_won_"+set_col;
			// 예상 식재료비 원가 sale_price_
			n_sik_won 	= n_sik_won + (DS_menu2.GetColumn(ii, m2_col) * tab_Main.tab00.DS_menu1.GetColumn(m1_row, m1_col));
			// 예상 매출액
			n_sale 		= n_sale 	+ (tab_Main.tab00.DS_menu1.GetColumn(m1_row, "expect_meal_qty_"+set_col) * tab_Main.tab00.DS_menu1.GetColumn(m1_row, m1_col));
			
		}
	}
	
	// alert(n_sik_won);
	// alert(n_sale);
	
	var	v_bSikRate 	= 0;
	
	if (n_sale == 0) {
		v_bSikRate		= 0;
	}
	else {
		v_bSikRate		= round(n_sik_won / n_sale, 1);
	}
	me_bSikRate.Value = v_bSikRate;
*/	
}

// dataset의 변경유무를 검토하여 저장할 것인지를 검증한다.
function fn_dsUpdateSearch()
{
	if (gfn_dsIsUpdated(DS_menu)== true) {
		var msg = "저장되지 않은 정보가 있습니다.\n\n데이터를 저장하시겠습니까?";
		if (g_Confirm("02",	msg) == true) {
			gfn_alert("처리");
			// fn_save();
			g_Message("04", "");
		}
		else {
			g_Message("EE", "데이타 저장 작업을 취소하였습니다.");
			return;
		}
	}
}

// 식단평가에서 duble Click 시
// fa_com : 선택된 콤보 index (0,1,2,3)
// fa_date : 선택된 일자(YYYYMMDD) or 주간(ALL)
// fa_row : ds_list에서 선택된 row
// fa_tit : 선택된 내용에 대한 설명
function fn_dup_color(fa_com, fa_date, fa_row, fa_tit)
{
	//trace("fa_com==="+fa_com+"::::fa_date==="+fa_date+":::fa_row==="+fa_row+":::fa_tit==="+fa_tit);
	st_pyoTitle.text = "식단평가 : " + fa_tit;

	if (ds_list.getRowCount() == 0) {
		g_Message("EE", "평가 내용이 없습니다.");
		return;
	}
	// return;
	// fa_com -> 평가항목 combo ( 0 : 레시피명 중복횟수 )
	// fa_com -> 평가항목 combo ( 1 : 주재료군 중복횟수 )
	// fa_com -> 평가항목 combo ( 2 : 조리법 중복횟수 )
	// fa_com -> 평가항목 combo ( 3 : PHF 중복횟수 )
	
	// fa_date -> 주간 ( ALL ), 일자버튼 선택시 ( YYYYMMDD )
	// fa_row -> 조회된 내용 중 더블클릭으로 선택한 row (ds_list)
	// fa_tit -> 처리해야될 내용을 타이틀로 표시한다.
	
	var if_col = ""; // 컬러를 적용할 조건 컬럼
	var v_case = ""; // fillter 할 조건
	
	// 색을 적용할 조건 컬럼을 셋팅
	switch(fa_com){
		case 0:
			if_col = "SD_NM";
			break;
		case 1:
			if_col = "MAIN_ITEM_CODE1";	
			break;
		case 2:
			if_col = "CUISINE_TYPE";	
			break;
		case 3:
			if_col = "PHF";	
			break;
        default :
            break;
	}

	// case 조건을 생성
	if (if_col == "PHF") {
		v_case	+= "PHF=='Y'";
	}
	else {
		if (fa_row > -1) {
			v_case	+= if_col+"=='"+ds_list.getColumn(fa_row, "CD")+"'";
			//alert("fa_row선택:/"+ds_list.GetColumn(fa_row, "CD")+"/");
		}
		else {
			v_case += "(";
			for (var ii=0; ii < ds_list.getRowCount(); ii++)
			{
				if (ii <> 0) {
					v_case += " || ";
				}
				v_case += if_col+"=='"+ds_list.getColumn(ii, "CD")+"'";
			}
			v_case += ")";
		}
	}

	// 특정일을 선택시
	if (gfn_length(fa_date)==8) { // 일자 선택 시
		v_case	+= " && FDAY=='"+fa_date+"'";
	}
	//
	// alert(v_case);
	// DS_body 상세 정보에서 평가정보를 추출한다.
	Copy(DS_body_f,DS_body);
	DS_body_f.filter(v_case);

	var f_row = 0;
	
	for (var jj=0; jj < DS_body_f.getRowCount(); jj++)
	{
		if (if_col == "PHF") {
			f_row = 0;
		}
		else {
			// alert("CD='"+DS_body_f.GetColumn(jj, if_col)+"'");
			f_row = ds_list.findRowExpr("CD=='"+DS_body_f.getColumn(jj, if_col)+"'");
		}
		//
		//alert(f_row+"/"+ds_list.GetColumn(f_row, "TEXTCOLOR"));

		DS_body_f.setColumn(jj, "DUP_COLOR", ds_list.getColumn(f_row, "TEXTCOLOR"));
		DS_body_f.setColumn(jj, "DUP_STA", "Y");
	}
//trace(	DS_body_f.saveXML());
	//
	DS_body_f.filter("");
	
	grd_lst.enableredraw = false;
	grd_lst.binddataset = "";
	
	// DS_menu Dataset을 다시 작성한다.
	fn_make_DS_menu();
//trace(	DS_menu.saveXML());
	grd_lst.binddataset = "DS_menu";
	grd_lst.enableredraw = true;

}
//******************************************************************************************
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//******************************************************************************************

function btn_ExcelPrint_OnClick(obj:Button, e:ClickEventInfo)
{
	//DS_menu.AddRow();
	if (DS_menu.getRowCount() == 0) {
		g_Message("EE",	"출력할 메뉴정보가 없습니다.");
		return;
	}
	gfn_exportExcel(grd_lst, "식재영업_주간식단표","","","","","cellline");
	//alert(DS_menu.row);
	
}

function grd_lst_OnMouseOver(obj:Grid, e:GridMouseEventInfo)
{
return;	
	//----------------------------------
	// Tooltip 설명 처리부
	//----------------------------------
	// Head 부 처리
	var	srow 	= 0.0;
	var	int_srow= 0;
	var	v_seq  	= "";

	if (e.row == -1 && e.cell > 3) {
		srow = toNumber((e.cell-1)/3);
		int_srow = parseInt(srow);
		
		if (gfn_length(DS_head.getColumn((int_srow-1), "REM"))> 8 && int_srow == srow) {
			grd_lst.tooltiptext = "☞ 일정 : "+DS_head.getColumn((int_srow-1), "REM")+" ";
			return;
		} else { 
			grd_lst.tooltiptext = ""; 
		}
	} else { 
		grd_lst.tooltiptext = ""; 
	}
	// Body 부 처리
	//grd_lst.ToolTipText = "nRow :"+nRow+"\nnCell :"+nCell+"\nnPosX :"+nPosX+"\nnPosY :"+nPosY;
	v_seq  = gfn_subStr(DS_head.getColumn((e.cell-1), "FDAY"),4,4);


} 

function grd_lst_OnMouseOut(obj:Grid, e:MouseEventInfo)
{
	//Div_pop.visible = false;
}

// 레시피 등록
function grd_lst_OnRButtonDown(obj:Grid, e:GridMouseEventInfo)
{
	if (e.cell < 1 || e.row < 0 || DS_menu.getColumn(e.row, "TOT_GBN") == "99") {
		return;
	}
	//alert(nRow);
	//alert(nCell);
	var msg = DS_head.getColumn(e.cell-1, "FDAY")+":"+DS_menu.getColumn(e.row, "SGBN_NM")+DS_menu.getColumn(e.row, "CGBN")+"의\n\nMY레시피 등록 작업을 하시겠습니까?";

	if (g_Confirm("04",	msg) == true) {
		// MY레시피 등록
		var	v_arg	= new Array();
		var	v_open	= "";
		var	v_rtn	= "";
		var	v_width	= -1;
		var	v_height= -1;
		var	leftPx	= -1;
		var	topPx	= -1;

		var	v_menu_cd	= DS_head.getColumn(e.cell-1, "FDAY")+"-"+ds_input.getColumn(0, "SUBINV_CODE")+DS_menu.getColumn(e.row, "SGBN")+DS_menu.getColumn(e.row, "CGBN_CD");
		
		v_arg["fa_upjang"] 		= ds_input.getColumn(0, "UPJANG");
		v_arg["fa_subinv_code"] = ds_input.getColumn(0, "SUBINV_CODE");
		v_arg["fa_meal"] 		= DS_menu.getColumn(e.row, "SGBN");
		v_arg["fa_corner"] 		= DS_menu.getColumn(e.row, "CGBN_CD");
		v_arg["fa_menu_date"] 	= DS_head.getColumn(e.cell-1, "FDAY");
		v_arg["fa_menu_cd"] 	= v_menu_cd;
		
		//v_open	 	= "TitleBar=false Status=false AutoSize=false Resize=false NoMove=false";
		//v_rtn 		= gfn_dialog("", "U_FSM::FSM00060E.xml", v_arg, v_width, v_height, v_open, leftPx, topPx);
		v_rtn 		= gfn_dialog("", "U_FMM::FMM00204E.xfdl", v_arg);
		
		parent.parent.fn_search();
	}
}

function grd_lst_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	if (e.row < 0 || e.cell < 1) {
		return;
	}
	
	// [ 변경전 ] if (DS_menu.GetColumn(nRow, "tot_gbn") == "99" && DS_menu.GetColumn(nRow, "sd_won_"+substr(DS_head.GetColumn(nCell-1, "fday"),4,4)) > 0) {
	if (DS_menu.getColumn(e.row, "TOT_GBN") == "99" && gfn_length(DS_menu.getColumn(e.row, "SD_NM_"+gfn_subStr(DS_head.getColumn(e.cell-1, "FDAY"),4,4)))> 0) {
		var	v_menu_cd = DS_head.getColumn(e.cell-1, "FDAY")+"-"+ds_input.getColumn(0, "SUBINV_CODE")+DS_menu.getColumn(e.row, "SGBN")+DS_menu.getColumn(e.row, "CGBN_CD");
		var msg = DS_head.getColumn(e.cell-1, "FDAY")+":"+DS_menu.getColumn(e.row, "SGBN_NM")+DS_menu.getColumn(e.row, "CGBN")+" 을 삭제하시겠습니까?\n\n";
		msg    += "[ "+v_menu_cd+" ]";

		// 삭제여부 CHECK
		var set_col		= gfn_subStr(DS_head.getColumn(e.cell-1, "FDAY"),4,4);
		var fil_cond	= "FDAY=='"+DS_head.getColumn(e.cell-1, "FDAY")+"'&&SGBN=='"+DS_menu.getColumn(e.row, "SGBN")+"'&&CGBN=='"+DS_menu.getColumn(e.row, "CGBN")+"'&&CGBN_CD=='"+DS_menu.getColumn(e.row, "CGBN_CD")+"'";
		//var n_row		= tab_Main.tab00.DS_body1.SearchRow(fil_cond);
		
		// if (tab_Main.tab00.DS_body.GetColumn(nRow, "ORDER_YN") == "Y") {
			// g_Message("EE",	"식자재가 발주되었습니다.\n\n메뉴를 삭제할수 없습니다.");
			// return;
		// }
		
		//if (n_row < 0) {
		//		g_Message("EE",	"예상식수 정보가 없습니다.\n\n식수정보를 확인 후 처리하세요.");
		//		return;
		//}
		//else {
		//	if (tab_Main.tab00.DS_body1.GetColumn(n_row, "ORDER_YN") == "Y") {
		//		g_Message("EE",	"식자재가 발주되었습니다.\n\n메뉴를 삭제할수 없습니다.");
		//		return;
		//	}
		//}

		if (g_Confirm("01",	msg) == true) { // 삭제 적용
			var actionName, cmdName, inData, outData, otherArg, callBackFnc;
			
			inData			= "";
			outData			= "ds_out=ds_out";
			otherArg		= "UPJANG="+wrapQuote(ds_input.getColumn(0, "UPJANG"))+" MENU_CD="+wrapQuote(v_menu_cd);
			callBackFnc		= "fn_afterDelete";
			
			fsp_clear(this); 
			fsp_addSearch(this, "fm/fmm:FMM00200E_D001");		
			http.Sync = true;
			fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		
			http.Sync = false;
		}
		else {
			return;
		}
	}
	else {
		var msg = DS_head.getColumn(e.cell-1, "FDAY")+":"+DS_menu.getColumn(e.row, "SGBN_NM")+DS_menu.getColumn(e.row, "CGBN")+" 에 대한\n\n레시피 검색 및 등록/수정 작업을\n\n하시겠습니까?";

		if (g_Confirm("04",	msg) == true) {
			// MY레시피 검색 및 등록
			var	v_arg	= new Array();
			var	v_open	= "";
			var	v_rtn	= "";
			var	v_width	= -1;
			var	v_height= -1;
			var	leftPx	= -1;
			var	topPx	= -1;
			
			v_arg["fa_UPJANG"] = ds_input.getColumn(0, "UPJANG");
			v_arg["fa_SUBINV_CODE"] = ds_input.getColumn(0, "SUBINV_CODE");
			v_arg["fa_FROM_DT"] = ds_input.getColumn(0, "MENU_SDATE");
			v_arg["fa_TO_DT"] = ds_input.getColumn(0, "MENU_EDATE");
			v_arg["fa_MEAL"] = DS_menu.getColumn(e.row, "SGBN");
			v_arg["fa_CORNER"] = DS_menu.getColumn(e.row, "CGBN_CD");
			v_arg["fa_MENU_DATE"] = DS_head.getColumn(e.cell-1, "FDAY");
			
			//v_open	 	= "TitleBar=false Status=false AutoSize=false Resize=false NoMove=false";
			//v_rtn 		= gfn_dialog("", "U_FSM::FSM00060E.xml", v_arg, v_width, v_height, v_open, leftPx, topPx);
			v_rtn 		= gfn_dialog("", "U_FMM::FMM00210E.xfdl", v_arg, 1224, 774);
			
			parent.parent.fn_search();
		}
	}
}

// NY 레시피 구성
function btn_recipe_OnClick(obj:Button, e:ClickEventInfo)
{
	var	v_arg	= new Array();
	var	v_open	= "";
	var	v_rtn	= "";
	var	v_width	= -1;
	var	v_height= -1;
	var	leftPx	= -1;
	var	topPx	= -1;
	
	v_arg["fa_UPJANG"] 		= ds_input.getColumn(0, "UPJANG");
	v_arg["fa_UPJANG_NM"]	= ds_input.getColumn(0, "UPJANG_NM");
	v_arg["fa_SUBINV_CODE"]	= ds_input.getColumn(0, "SUBINV_CODE");
	v_arg["fa_SUBINV_NAME"]	= parent.parent.cbo_SUBINV.text;
	v_arg["fa_MENU_DATE"]	= ds_input.getColumn(0, "MENU_DATE");
	
	//v_open	 	= "TitleBar=false Status=false AutoSize=false Resize=false NoMove=false";
	//v_rtn 		= gfn_dialog("", "U_FSM::FSM00060E.xml", v_arg, v_width, v_height, v_open, leftPx, topPx);
	v_rtn 		= gfn_dialog("", "U_FMM::FMM00201E.xfdl", v_arg);
	
	// Parent.fn_Search();
	
}

// 식단복사
function btn_fcopy_OnClick(obj:Button, e:ClickEventInfo)
{
	var	v_arg	= new Array();
	var	v_open	= "";
	var	v_rtn	= "";
	var	v_width	= -1;
	var	v_height= -1;
	var	leftPx	= -1;
	var	topPx	= -1;
	
	v_arg["fa_UPJANG"] 		= ds_input.getColumn(0, "UPJANG");
	v_arg["fa_UPJANG_NM"]	= ds_input.getColumn(0, "UPJANG_NM");
	v_arg["fa_SUBINV_CODE"]	= ds_input.getColumn(0, "SUBINV_CODE");
	v_arg["fa_SUBINV_NAME"]	= parent.parent.cbo_SUBINV.text;
	v_arg["fa_FROM_DT"]		= ds_input.getColumn(0, "MENU_SDATE");
	v_arg["fa_TO_DT"]		= ds_input.getColumn(0, "MENU_EDATE");
// trace(	"fa_UPJANG===="+v_arg["fa_UPJANG"]);
// trace(	"fa_UPJANG_NM===="+v_arg["fa_UPJANG_NM"]);
// trace(	"fa_SUBINV_CODE===="+v_arg["fa_SUBINV_CODE"]);
// trace(	"fa_SUBINV_NAME===="+v_arg["fa_SUBINV_NAME"]);
// trace(	"fa_FROM_DT===="+v_arg["fa_FROM_DT"]);
// trace(	"fa_TO_DT===="+v_arg["fa_TO_DT"]);
	//v_open	 	= "TitleBar=false Status=false AutoSize=false Resize=false NoMove=false";
	//v_rtn 		= gfn_dialog("", "U_FSM::FSM00060E.xml", v_arg, v_width, v_height, v_open, leftPx, topPx);
	v_rtn 		= gfn_dialog("", "U_FMM::FMM00207E.xfdl", v_arg);
	
	parent.parent.fn_search();
	
}

// 식단평가
function btn_pyo_OnClick(obj:Button, e:ClickEventInfo)
{
	
	if (btn_pyo.userdata == "img_close") {
		btn_pyo.userdata = "img_open";
		//img_open_close.image = "URL('theme://convertImages/img_OpenBottom.png')";
		img_open_close.image = "URL('theme://images/new/btn_WFDA_Open.png')";
		div_pyo.visible = false;
	}
	else {
		btn_pyo.userdata = "img_close";
		//img_open_close.image = "URL('theme://convertImages/img_CloseBottom.png')";
		img_open_close.image = "URL('theme://images/new/btn_WFDA_Close.png')";
		div_pyo.visible = true;
	}
	
}

function img_open_close_onclick(obj:ImageViewer,  e:ClickEventInfo)
{
	btn_pyo.click();
}



// 영양분석
function btn_rut_OnClick(obj:Button, e:ClickEventInfo)
{
//
	var	v_arg	= new Array();
	var	v_open	= "";
	var	v_rtn	= "";
	var	v_width	= -1;
	var	v_height= -1;
	var	leftPx	= -1;
	var	topPx	= -1;
	
	v_arg["fa_UPJANG"]			= ds_input.getColumn(0, "UPJANG");
	v_arg["fa_SUBINV_CODE"]		= ds_input.getColumn(0, "SUBINV_CODE");
	v_arg["fa_FROM_MENU_DATE"]	= ds_input.getColumn(0, "MENU_SDATE");
	v_arg["fa_TO_MENU_DATE"]	= ds_input.getColumn(0, "MENU_EDATE");
	v_arg["fa_gbn"]				= fa_gbn;
	
	//v_open	 	= "TitleBar=false Status=false AutoSize=false Resize=false NoMove=false";
	//v_rtn 		= gfn_dialog("", "U_FSM::FSM00060E.xml", v_arg, v_width, v_height, v_open, leftPx, topPx);
	v_rtn 		= gfn_dialog("", "U_FMM::FMM00205P.xfdl", v_arg);
	
	//Parent.fn_Search();	
}

// 식단발주 화면 실행
function Button04_OnClick(obj:Button, e:ClickEventInfo)
{
    var arrParam = new Array();
    arrParam[0] = gfn_nvl(parent.parent.ed_Upjang.value);
    arrParam[1] = gfn_nvl(parent.parent.ed_Upjang.userdata);
    arrParam[2] = gfn_nvl(parent.parent.cbo_SUBINV.text);
    arrParam[3] = gfn_nvl(parent.parent.cbo_SUBINV.userdata);
    	
	gfn_openMenuForm(  "FMP00130E.xfdl"		// pgm_id, 
					  ,"U_FMP"				// path,
					  ,arrParam				// v_call_param,
					  ,"식단발주");		// v_pgm_text		
}
// 상품게시판 화면 실행
function Button03_OnClick(obj:Button, e:ClickEventInfo)
{
    var arrParam = new Array();
    arrParam[0] = "81";
    
	gfn_openMenuForm(  "SCC80040V.xfdl"		// pgm_id, 
					  ,"U_SCC"				// path,
					  ,arrParam					// v_call_param,
				  	  ,"상품게시판"
				  	  , "1235");			// v_pgm_text								
}

function fn_afterDelete()
{
	// 식단삭제 정상 및 오류 처리
	if (ds_out.getColumn(0,"O_RTN") == "FALSE") {
		g_Message("EE",	"식단삭제 오류: "+ ds_out.getColumn(0,"O_RTNMSG"));
	}
	else {
		parent.parent.fn_search();
	}
}

// 2009-03-16(월) 원가 재 생성 추가 수정 사항. 변경자 : 노규완 
function btn_RSave_OnClick(obj:Button, e:ClickEventInfo)
{
	if ( me_Sdate.value < gfn_addDate(gfn_today(),1)){
		g_Message("EE",	"갱신일 지정 오류!!\n\n 당일 또는 과거 날짜는 갱신 할 수 없습니다.");
		return;
	  }	  
	
	if (! g_Confirm("02","원가 갱신 작업을 하시겠습니까?!")) return;
	fn_Reflash_AMT();
}

// 2009-03-16(월) 원가 재 생성 추가 수정 사항. 변경자 : 노규완 
function  fn_Reflash_AMT()
{
	var t_timeout;
	
	// action 정보 초기화
	fsp_clear(this);
	
	// 데이타체크
	ds_input2.clearData();
	ds_input2.addRow();
	ds_input2.setColumn(0,"SDATE" ,me_Sdate.value);
	ds_input2.setColumn(0,"UPJANG",parent.parent.ed_Upjang.userdata);
	
	if (gfn_length(ds_input2.getColumn(0,"UPJANG"))== 0) {
		g_Message("EE",	"업장정보 오류!!\n\n 업장정보를 입력하세요.");
		return;
	  }	  
	
	if (gfn_length(ds_input2.getColumn(0,"SDATE"))== 0) {
		g_Message("EE",	"갱신일 오류!!\n\n갱신일을 입력하세요.");
		return;
	  }
	  	  
	    http.Sync = true;
		//http.TimeOut = 600;
		//DB.CommandTimeOut = 700;
		t_timeout = application.httptimeout;
		application.httptimeout=2000; //1800초
	

		fsp_addSingle(this, "fm/fmm:FMM00200E_I001");
		fsp_callService(this, "", "", "ds_input2=ds_input2:A", "ds_return=ds_return",  "", "fn_Out_Msg");
		//http.TimeOut = 30;
		application.httptimeout=t_timeout; //60초
		http.Sync = false;
}

// 2009-03-16(월) 원가 재 생성 추가 수정 사항. 변경자 : 노규완 
function fn_Out_Msg(cd,errmsg)
{
	if(cd==-1)
	{
		g_Message("EE","서비스 에러");
	}
	else
	{
		//gfn_alert('결과:' + ds_return.getColumn(0,"O_RTN"));
		if ((ds_return.getColumn(0,"O_RTN")) == 'TRUE'){	
			g_Message("04",ds_return.getColumn(0,"O_RTNMSG"));
			v_SearchCNT = 1;
			
			parent.parent.fn_search();
			}
		else{
			g_Message("EE","갱신 도중 오류가 발생 하였습니다. \n\n " + ds_return.getColumn(0,"O_RTNMSG"));
		}
		//releaseCapture();	//setWaitCursor(false,true);
	}
}
]]></Script>
  </Form>
</FDL>

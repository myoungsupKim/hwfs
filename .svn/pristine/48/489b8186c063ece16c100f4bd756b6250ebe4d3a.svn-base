<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="CmmnCalMonthPop" classname="frmCalMonth" left="0" top="0" width="417" height="569" titletext="월력" onload="CmmnCalMonthPop_onload">
    <Layouts>
      <Layout>
        <Static id="staFormSize" taborder="4" left="0" top="0" cssclass="sta_POP_Bg" width="417" height="567"/>
        <Static id="Static00" taborder="7" text="Calendar" cssclass="sta_POP_TitleBg" left="0" top="0" height="70" width="417"/>
        <Button id="btnClose" taborder="5" onclick="btnClose_onclick" cssclass="btn_POP_XBtn" left="347" top="0" width="70" height="70"/>
        <Static id="Static01" taborder="8" text="h10" cssclass="sta_GUIDE_Area" visible="false" left="342" top="70" width="102" height="10" style="align:right middle;"/>
        <Static id="Static04" taborder="9" text="w10" cssclass="sta_GUIDE_Area" visible="false" left="407" top="488" width="10" height="100" style="align:left bottom;"/>
        <Static id="Static02" taborder="10" left="10" top="80" cssclass="sta_WF_MonthCalBg" width="397" height="477"/>
        <Static id="Static03" taborder="11" text="h10" cssclass="sta_GUIDE_Area" visible="false" left="342" top="559" width="102" height="10" style="align:right middle;"/>
        <Static id="Static05" taborder="12" text="w10" cssclass="sta_GUIDE_Area" visible="false" left="0" top="488" width="10" height="100" style="align:left bottom;"/>
        <Static id="staYear" taborder="1" left="11" top="81" width="395" height="65" text="2014" cssclass="sta_WF_MonthCalTitle"/>
        <Button id="btnNext" taborder="2" left="325" top="81" width="81" height="65" onclick="btnNext_onclick" cssclass="btn_WF_MonthCalNextBtn"/>
        <Button id="btnPrev" taborder="3" left="11" top="81" onclick="btnPrev_onclick" cssclass="btn_WF_MonthCalPreBtn" width="81" height="65"/>
        <Grid id="grdCal" taborder="0" useinputpanel="false" left="20" top="156" width="382" height="397" binddataset="dsMonth" autofittype="col" selecttype="cell" oncellclick="grdCal_oncellclick" scrollbars="none" cssclass="grd_WF_MonthCal">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="95"/>
                <Column size="95"/>
                <Column size="95"/>
                <Column size="95"/>
              </Columns>
              <Rows>
                <Row size="67"/>
                <Row size="65"/>
              </Rows>
              <Band id="body">
                <Cell rowspan="2" style="background:URL('HWImage::grd_WF_MonthCalBg.png') stretch 6,6;background2:URL('HWImage::grd_WF_MonthCalBg.png') stretch 6,6;selectbackground:URL('HWImage::grd_WF_MonthCalBgS.png') stretch 6,6;">
                  <Cell style="align: ;" text="bind:MN01"/>
                  <Cell row="1" style="align:center top;color:#999999ff;color2:#999999ff;font:antialias 17 Droid Sans;selectcolor:#999999ff;selectfont:antialias 17 Droid Sans;" text="bind:MS01"/>
                </Cell>
                <Cell col="1" rowspan="2" style="background:URL('HWImage::grd_WF_MonthCalBg.png') stretch 6,6;background2:URL('HWImage::grd_WF_MonthCalBg.png') stretch 6,6;selectbackground:URL('HWImage::grd_WF_MonthCalBgS.png') stretch 6,6;">
                  <Cell style="align: ;" text="bind:MN02"/>
                  <Cell row="1" style="align:center top;color:#999999ff;color2:#999999ff;font:antialias 17 Droid Sans;selectcolor:#999999ff;selectfont:antialias 17 Droid Sans;" text="bind:MS02"/>
                </Cell>
                <Cell col="2" rowspan="2" style="background:URL('HWImage::grd_WF_MonthCalBg.png') stretch 6,6;background2:URL('HWImage::grd_WF_MonthCalBg.png') stretch 6,6;selectbackground:URL('HWImage::grd_WF_MonthCalBgS.png') stretch 6,6;">
                  <Cell style="align: ;" text="bind:MN03"/>
                  <Cell row="1" style="align:center top;color:#999999ff;color2:#999999ff;font:antialias 17 Droid Sans;selectcolor:#999999ff;selectfont:antialias 17 Droid Sans;" text="bind:MS03"/>
                </Cell>
                <Cell col="3" rowspan="2" style="background:URL('HWImage::grd_WF_MonthCalBg.png') stretch 6,6;background2:URL('HWImage::grd_WF_MonthCalBg.png') stretch 6,6;selectbackground:URL('HWImage::grd_WF_MonthCalBgS.png') stretch 6,6;">
                  <Cell style="align: ;" text="bind:MN04"/>
                  <Cell row="1" style="align:center top;color:#999999ff;color2:#999999ff;font:antialias 17 Droid Sans;selectcolor:#999999ff;selectfont:antialias 17 Droid Sans;" text="bind:MS04"/>
                </Cell>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static06" taborder="13" text="h10" cssclass="sta_GUIDE_Area" visible="false" left="158" top="146" width="102" height="10" style="align:center middle;"/>
        <Static id="Static07" taborder="14" text="h05" cssclass="sta_GUIDE_Area" visible="false" left="158" top="552" width="102" height="5" style="align:middle;"/>
        <Static id="Static08" taborder="15" text="w10" cssclass="sta_GUIDE_Area" visible="false" left="10" top="298" width="10" height="100" style="align:center middle;"/>
        <Static id="Static09" taborder="16" text="w05" cssclass="sta_GUIDE_Area" visible="false" left="402" top="298" width="5" height="100" style="align:center middle;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="dsMonth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="MN01" type="STRING" size="256"/>
          <Column id="MS01" type="STRING" size="256"/>
          <Column id="MN02" type="STRING" size="256"/>
          <Column id="MS02" type="STRING" size="256"/>
          <Column id="MN03" type="STRING" size="256"/>
          <Column id="MS03" type="STRING" size="256"/>
          <Column id="MN04" type="STRING" size="256"/>
          <Column id="MS04" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="MN01">1</Col>
            <Col id="MN02">2</Col>
            <Col id="MN03">3</Col>
            <Col id="MN04">4</Col>
            <Col id="MS01">JAN</Col>
            <Col id="MS02">FEB</Col>
            <Col id="MS03">MAR</Col>
            <Col id="MS04">APR</Col>
          </Row>
          <Row>
            <Col id="MN01">5</Col>
            <Col id="MN02">6</Col>
            <Col id="MN03">7</Col>
            <Col id="MN04">8</Col>
            <Col id="MS01">MAY</Col>
            <Col id="MS02">JUN</Col>
            <Col id="MS03">JUL</Col>
            <Col id="MS04">AUG</Col>
          </Row>
          <Row>
            <Col id="MN04">12</Col>
            <Col id="MN03">11</Col>
            <Col id="MN02">10</Col>
            <Col id="MN01">9</Col>
            <Col id="MS01">SEP</Col>
            <Col id="MS02">OCT</Col>
            <Col id="MS03">NOV</Col>
            <Col id="MS04">DEC</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Script type="xscript5.0"><![CDATA[include "lib::lib_Date.xjs"
include "lib::lib_String.xjs"

this.preMonth = undefined;

this.CmmnCalMonthPop_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{
	var sYear;
	var sMonth;
	var nMonth;
	var nRow, nCol;
	
	this.preMonth = application.goMain.gfn_POP_getArg();	

	if (application.gfn_IsNull(this.preMonth))
	{
		this.preMonth = this.gfn_Today().toString().substr(0, 6);
	}
	
	sYear = this.preMonth.toString().substr(0, 4);
	sMonth = this.preMonth.toString().substr(4, 2);
	nMonth = nexacro.toNumber(sMonth);
	
	this.staYear.set_text(sYear);
	
	nRow = (nMonth - 1) / 4;
	nCol = ((nMonth - 1) % 4);

	this.dsMonth.set_rowposition(nRow);
	this.grdCal.setCellPos(nCol);
	
	application.goMain.gfn_POP_resize(this);
}

this.btnNext_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var nYear;
	
	nYear = nexacro.toNumber(this.staYear.text);
	++nYear;
	
	this.staYear.set_text(nYear);
}

this.btnPrev_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	var nYear;
	
	nYear = nexacro.toNumber(this.staYear.text);
	--nYear;
	
	this.staYear.set_text(nYear);
}

this.grdCal_oncellclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	var sRtn;
	var sMonth;

	sMonth = this.dsMonth.getColumn(e.row, e.col * 2).toString().padLeft(2, "0");
	sRtn = this.staYear.text + sMonth;
	
	application.goMain.gfn_POP_close(this, sRtn);
}

this.btnClose_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	application.goMain.gfn_POP_close(this, "CLOSEONLY");
}

this.staClose_onclick = function(obj:Static,  e:nexacro.ClickEventInfo)
{
	application.goMain.gfn_POP_close(this, "CLOSEONLY");
}
]]></Script>
  </Form>
</FDL>

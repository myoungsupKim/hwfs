<?xml version="1.0" encoding="euc-kr"?>
<query>
	<type>select</type>
	<description><![CDATA[품질평가 조회]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>1</result-count>
	<statement>
<![CDATA[
SELECT T1.RECIPE_CD, T1.RECIPE_NAME,
       NVL(T2.CNT,0) AS MAIN_ITEM_CNT,
       CASE WHEN T2.CNT >= 2 THEN MAIN_ITEM_NAME1 ELSE '' END MAIN_ITEM_VAL,
       NVL(T3.CNT,0) AS CUISINE_TYPE_CNT,
       CASE WHEN T3.CNT >= 2 THEN CUISINE_TYPE_NAME ELSE '' END CUISINE_TYPE_VAL,
       T1.RECIPE_RGB_COLOR,
       NVL(T4.CNT,0) AS RECIPE_TASTE_CNT,
	   CASE WHEN T4.CNT >= 2 THEN RECIPE_TASTE_NAME ELSE '' END RECIPE_TASTE_VAL,
       NVL(T5.CNT,0) AS RECIPE_SHAPE_CNT,
	   CASE WHEN T5.CNT >= 2 THEN RECIPE_SHAPE_NAME ELSE '' END RECIPE_SHAPE_VAL,
       NVL(T6.CNT,0) AS RECIPE_FEEL_CNT,
	   CASE WHEN T6.CNT >= 2 THEN RECIPE_FEEL_NAME ELSE '' END RECIPE_FEEL_VAL
  FROM (SELECT B.RECIPE_CD, B.RECIPE_NAME,
               B.MAIN_ITEM_CODE1, (SELECT CODE_NAME FROM SCC_COMMON_CODE WHERE GROUP_CODE = 'FS0006' AND CODE = B.MAIN_ITEM_CODE1) AS MAIN_ITEM_NAME1,
	           B.CUISINE_TYPE, (SELECT CODE_NAME FROM SCC_COMMON_CODE WHERE GROUP_CODE = 'FS0003' AND CODE = B.CUISINE_TYPE) AS CUISINE_TYPE_NAME,
	           B.RECIPE_COLOR, (SELECT SET1 FROM SCC_COMMON_CODE WHERE GROUP_CODE = 'FS0007' AND CODE = B.RECIPE_COLOR) AS RECIPE_RGB_COLOR,
	           B.RECIPE_TASTE, (SELECT CODE_NAME FROM SCC_COMMON_CODE WHERE GROUP_CODE = 'FS0009' AND CODE = B.RECIPE_TASTE) AS RECIPE_TASTE_NAME,
	           B.RECIPE_SHAPE, (SELECT CODE_NAME FROM SCC_COMMON_CODE WHERE GROUP_CODE = 'FS0008' AND CODE = B.RECIPE_SHAPE) AS RECIPE_SHAPE_NAME,
	           B.RECIPE_FEEL, (SELECT CODE_NAME FROM SCC_COMMON_CODE WHERE GROUP_CODE = 'FS0010' AND CODE = B.RECIPE_FEEL) AS RECIPE_FEEL_NAME
          FROM FSH_CYCLE_MENU_MST A, --KEY : UPJANG, MENU_CD
               FSH_CYCLE_RECIPE_MST B 
         WHERE A.UPJANG = #UPJANG#
           AND A.MENU_DATE = #MENU_DATE#
           AND A.HALL_CD = #HALL_CD#
           AND A.MEAL = #MEAL#
           AND A.CORNER = #CORNER#
           AND A.UPJANG = B.UPJANG
           AND A.MENU_CD = B.MENU_CD ) T1,
       (SELECT B.MAIN_ITEM_CODE1, COUNT(B.MAIN_ITEM_CODE1) AS CNT
          FROM FSH_CYCLE_MENU_MST A, --KEY : UPJANG, MENU_CD
               FSH_CYCLE_RECIPE_MST B 
         WHERE A.UPJANG = #UPJANG#
           AND A.MENU_DATE = #MENU_DATE#
           AND A.HALL_CD = #HALL_CD#
           AND A.MEAL = #MEAL#
           AND A.CORNER = #CORNER#
           AND A.UPJANG = B.UPJANG
           AND A.MENU_CD = B.MENU_CD
         GROUP BY B.MAIN_ITEM_CODE1 )T2, -- 주재료군
       (SELECT B.CUISINE_TYPE, COUNT(B.CUISINE_TYPE) AS CNT
          FROM FSH_CYCLE_MENU_MST A, --KEY : UPJANG, MENU_CD
               FSH_CYCLE_RECIPE_MST B 
         WHERE A.UPJANG = #UPJANG#
           AND A.MENU_DATE = #MENU_DATE#
           AND A.HALL_CD = #HALL_CD#
           AND A.MEAL = #MEAL#
           AND A.CORNER = #CORNER#
           AND A.UPJANG = B.UPJANG
           AND A.MENU_CD = B.MENU_CD
         GROUP BY B.CUISINE_TYPE )T3, -- 조리법유형
       (SELECT B.RECIPE_TASTE, COUNT(B.RECIPE_TASTE) AS CNT
          FROM FSH_CYCLE_MENU_MST A, --KEY : UPJANG, MENU_CD
               FSH_CYCLE_RECIPE_MST B 
         WHERE A.UPJANG = #UPJANG#
           AND A.MENU_DATE = #MENU_DATE#
           AND A.HALL_CD = #HALL_CD#
           AND A.MEAL = #MEAL#
           AND A.CORNER = #CORNER#
           AND A.UPJANG = B.UPJANG
           AND A.MENU_CD = B.MENU_CD
         GROUP BY B.RECIPE_TASTE )T4, -- 맛
       (SELECT B.RECIPE_SHAPE, COUNT(B.RECIPE_SHAPE) AS CNT
          FROM FSH_CYCLE_MENU_MST A, --KEY : UPJANG, MENU_CD
               FSH_CYCLE_RECIPE_MST B 
         WHERE A.UPJANG = #UPJANG#
           AND A.MENU_DATE = #MENU_DATE#
           AND A.HALL_CD = #HALL_CD#
           AND A.MEAL = #MEAL#
           AND A.CORNER = #CORNER#
           AND A.UPJANG = B.UPJANG
           AND A.MENU_CD = B.MENU_CD
         GROUP BY B.RECIPE_SHAPE )T5, -- 모양
       (SELECT B.RECIPE_FEEL, COUNT(B.RECIPE_FEEL) AS CNT
          FROM FSH_CYCLE_MENU_MST A, --KEY : UPJANG, MENU_CD
               FSH_CYCLE_RECIPE_MST B 
         WHERE A.UPJANG = #UPJANG#
           AND A.MENU_DATE = #MENU_DATE#
           AND A.HALL_CD = #HALL_CD#
           AND A.MEAL = #MEAL#
           AND A.CORNER = #CORNER#
           AND A.UPJANG = B.UPJANG
           AND A.MENU_CD = B.MENU_CD
         GROUP BY B.RECIPE_FEEL )T6 -- 질감
 WHERE T1.MAIN_ITEM_CODE1 = T2.MAIN_ITEM_CODE1(+)
   AND T1.CUISINE_TYPE = T3.CUISINE_TYPE(+)
   AND T1.RECIPE_TASTE = T4.RECIPE_TASTE(+)
   AND T1.RECIPE_SHAPE = T5.RECIPE_SHAPE(+)
   AND T1.RECIPE_FEEL = T6.RECIPE_FEEL(+)
 ORDER BY T1.RECIPE_CD	]]></statement>
	<input default-name="ds_List">
	</input>
	<output default-name="ds_List">
	</output>
</query>

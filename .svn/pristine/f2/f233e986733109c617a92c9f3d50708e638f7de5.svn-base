<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FMM00180E" onload="form_onload" titletext="표준식단등록" position="absolute 0 0 1252 725" scrollbars="none" onkeydown="fn_form_OnKeyDown">
    <Layouts>
      <Layout>
        <Static id="Static35" class="sta_WFDA_Labelbg" position="absolute 796 360 1237 387" anchor="left top right"/>
        <Static id="Static36" class="sta_WFDA_Labelbg" position="absolute 796 386 1237 413" anchor="left top right"/>
        <Static id="Static11" class="sta_WFDA_Labelbg" position="absolute 95 334 674 361" visible="true"/>
        <Static id="Static31" class="sta_WFDA_Labelbg" position="absolute 95 360 674 387"/>
        <Static id="Static32" class="sta_WFDA_Labelbg" position="absolute 95 386 674 413"/>
        <Static id="Static1" text="레시피구분" position="absolute 0 334 96 361" class="sta_WFDA_Label01" visible="true"/>
        <Static id="Static2" text="레시피분류" position="absolute 0 360 96 387" class="sta_WFDA_Label01"/>
        <Static id="Static3" text="레 시 피 명" position="absolute 0 386 96 413" class="sta_WFDA_Label01"/>
        <Static id="Static9" text="식   단   명" position="absolute 705 386 797 413" class="sta_WFDA_Label01"/>
        <Static id="Static10" text="식 단 코 드" position="absolute 705 360 797 387" class="sta_WFDA_Label01"/>
        <Static id="Static8" text="식 단 분 류" position="absolute 967 360 1058 387" class="sta_WFDA_Label01"/>
        <Static id="Static15" text="식 단 원 가" position="absolute 967 386 1058 413" class="sta_WFDA_Label01"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" id="cbo_Class" index="0" innerdataset="ds_Menu_Class" onitemchanged="cbo_Class_OnChanged" type="NOTFILTERED" taborder="11" position="absolute 1060 363 1234 384" displayrowcount="15"/>
        <Static id="Static16" text="레시피유형" position="absolute 325 360 421 387" class="sta_WFDA_Label01"/>
        <Edit id="ed_ReciNM" imemode="none" onkeydown="goNext_OnKeyDown" taborder="9" position="absolute 98 389 671 410"/>
        <Button id="btn_subSearch" onclick="Common_Btn_common_OnClick" taborder="37" text="검색" position="absolute 619 337 671 357" class="btn_WF_Function" image=""/>
        <Grid binddataset="ds_subList" cellmovingtype="col" cellsizingtype="both" enable="true" id="Grid0" useinputpanel="false" oncellclick="Grid0_OnCellClick" oncelldblclick="Grid0_OnCellDblClick" onheadclick="Grid0_OnHeadClick" taborder="38" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 418 674 694" readonly="true" selecttype="row" autofittype="col" anchor="left top bottom">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30"/>
                <Column size="40"/>
                <Column size="85"/>
                <Column size="70"/>
                <Column size="220"/>
                <Column size="150"/>
                <Column size="53"/>
                <Column size="25"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" displaytype="text" text="구분"/>
                <Cell col="2" displaytype="text" text="레시피분류"/>
                <Cell col="3" displaytype="text" text="레시피코드"/>
                <Cell col="4" displaytype="text" text="레시피명"/>
                <Cell col="5" displaytype="text" text="연관어"/>
                <Cell col="6" displaytype="text" text="원가"/>
                <Cell col="7" displaytype="text" text="상세"/>
              </Band>
              <Band id="body">
                <Cell style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="combo" style="align:center;" text="bind:GUBUN" combodataset="ds_gbn" combocodecol="CD" combodatacol="NM"/>
                <Cell col="2" displaytype="combo" style="align:left;" text="bind:RECIPE_CLASS" combodataset="ds_RecipeClass" combocodecol="CD" combodatacol="NM"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:RECIPE_CD"/>
                <Cell col="4" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:SAME_WORD"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:RECIPE_COST"/>
                <Cell col="7" displaytype="image" style="align: ;" text="URL('theme://images/new/grd_WF_ExpandImage.png')"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid binddataset="ds_RecipeList" cellmovingtype="col" cellsizingtype="both" enable="true" id="Grid1" useinputpanel="false" oncellclick="Grid1_OnCellClick" onheadclick="Grid1_OnHeadClick" taborder="39" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 705 418 1237 710" readonly="true" selecttype="row" autofittype="col" anchor="all">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30"/>
                <Column size="80"/>
                <Column size="20"/>
                <Column size="166"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="60"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="number" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="레시피코드"/>
                <Cell col="2" colspan="2" displaytype="text" text="레시피명"/>
                <Cell col="4" displaytype="text" text="원가"/>
                <Cell col="5" displaytype="text" text="Kcal"/>
                <Cell col="6" displaytype="text" text="구분"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:RECIPE_CD" suppress="1"/>
                <Cell col="2" displaytype="image" style="align: ;" text="URL('theme://images/new/grd_WF_ExpandImageX.png')"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                <Cell col="4" displaytype="number" style="align:right;" text="bind:OP_PRICE"/>
                <Cell col="5" displaytype="number" style="align:right;" text="bind:CAL_CALC"/>
                <Cell col="6" displaytype="combo" style="align:center;" text="bind:ORI_TYPE" combodataset="ds_RecipeGbn" combocodecol="CD" combodatacol="NM"/>
              </Band>
              <Band id="summary">
                <Cell colspan="4" style="align:center;" text="합계" taborder="undefined"/>
                <Cell col="4" displaytype="number" expr="expr:getSum('OP_PRICE')"/>
                <Cell col="5" displaytype="number" expr="expr:getSum('CAL_CALC')"/>
                <Cell col="6"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Radio codecolumn="CD" datacolumn="NM" id="rdo_gbn" innerdataset="ds_rdo" onkeydown="goNext_OnKeyDown" taborder="6" position="absolute 101 339 377 360" index="0" value="0" rowcount="-1" columncount="-1" visible="true"/>
        <Edit id="ed_MenuCD" readonly="true" taborder="10" position="absolute 799 363 965 384"/>
        <Edit id="ed_MenuNM" taborder="12" position="absolute 799 389 965 410"/>
        <MaskEdit id="me_Menu_Cost" readonly="true" taborder="13" position="absolute 1060 389 1234 410" mask="#,###"/>
        <Static id="Static18" text="※  레시피내 상품중 거래하지 않는 품목은 원가에서 제외 됩니다." position="absolute 4 696 394 714" anchor="left bottom"/>
        <Grid autoenter="select" binddataset="ds_list" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="grd_list" useinputpanel="false" oncellclick="grd_list_OnCellClick" oncelldblclick="grd_list_OnCellDblClick" onheadclick="grd_list_OnHeadClick" taborder="41" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 86 1237 303" selecttype="row" anchor="left top right" autofittype="col">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30" band="left"/>
                <Column size="89"/>
                <Column size="99"/>
                <Column size="184"/>
                <Column size="83"/>
                <Column size="735"/>
                <Column size="0"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" displaytype="text" text="식단코드"/>
                <Cell col="2" displaytype="text" text="분류"/>
                <Cell col="3" displaytype="text" text="식단명"/>
                <Cell col="4" displaytype="text" text="식단원가"/>
                <Cell col="5" displaytype="text" text="레시피구성"/>
                <Cell col="6" displaytype="text" text="사진"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:MENU_CD"/>
                <Cell col="2" displaytype="combo" style="align:left;" text="bind:MENU_CLASS" combodataset="ds_Menu_Class" combocodecol="CODE" combodatacol="CODE_NAME"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:MENU_NAME"/>
                <Cell col="4" displaytype="number" style="align: ;" text="bind:RECIPE_COST"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:RECIPE_NAMES"/>
                <Cell col="6" displaytype="button" style="align:left;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Combo codecolumn="CD" datacolumn="NM" id="cbo_RecipeClass" index="0" innerdataset="ds_RecipeClass" onkeydown="goNext_OnKeyDown" type="filter" taborder="7" position="absolute 98 363 323 384" displayrowcount="15"/>
        <Combo codecolumn="CD" datacolumn="NM" id="cbo_RecipeType" index="0" innerdataset="ds_RecipeType" onkeydown="goNext_OnKeyDown" type="filter" taborder="8" position="absolute 424 363 671 384" displayrowcount="15"/>
        <Grid binddataset="ds_subList" enable="true" id="grd_Excel" useinputpanel="false" taborder="43" tabstop="true" usecontextmenu="true" useselcolor="true" visible="false" wheelscrollrow="1" position="absolute 19 747 482 856" readonly="true" selecttype="row">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30"/>
                <Column size="40"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="150"/>
                <Column size="53"/>
                <Column size="30"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" displaytype="text" text="구분"/>
                <Cell col="2" displaytype="text" text="레시피분류"/>
                <Cell col="3" displaytype="text" text="레시피코드"/>
                <Cell col="4" displaytype="text" text="레시피명"/>
                <Cell col="5" displaytype="text" text="원가"/>
                <Cell col="6" displaytype="text" text="상세"/>
              </Band>
              <Band id="body">
                <Cell style="align:right;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="combo" style="align:center;" text="bind:GUBUN" combodataset="ds_gbn" combocodecol="CD" combodatacol="NM"/>
                <Cell col="2" displaytype="combo" style="align:left;" text="bind:RECIPE_CLASS" combodataset="ds_RecipeClass" combocodecol="CD" combodatacol="NM"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:RECIPE_CD"/>
                <Cell col="4" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                <Cell col="5" displaytype="number" style="align:right;" text="bind:RECIPE_COST"/>
                <Cell col="6" displaytype="button" edittype="button" style="align:left;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid binddataset="ds_RecipeList" enable="true" id="grd_Excel1" useinputpanel="false" taborder="44" tabstop="true" usecontextmenu="true" useselcolor="true" visible="false" wheelscrollrow="1" position="absolute 504 748 967 854" readonly="true" selecttype="row">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30"/>
                <Column size="80"/>
                <Column size="130"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="60"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="number" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="레시피코드"/>
                <Cell col="2" displaytype="text" text="레시피명"/>
                <Cell col="3" displaytype="text" text="원가"/>
                <Cell col="4" displaytype="text" text="Kcal"/>
                <Cell col="5" displaytype="text" text="구분"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:right;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:RECIPE_CD"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                <Cell col="3" displaytype="number" style="align:right;" text="bind:OP_PRICE"/>
                <Cell col="4" displaytype="number" style="align:right;" text="bind:CAL_CALC"/>
                <Cell col="5" displaytype="combo" style="align:center;" text="bind:ORI_TYPE" combodataset="ds_RecipeGbn" combocodecol="CD" combodatacol="NM"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static19" text="레시피조회" position="absolute 0 316 133 334" class="sta_WF_Title01"/>
        <Static id="Static20" text="표준식단구성" position="absolute 705 316 852 336" class="sta_WF_Title01"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="51" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 713" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1245 725" anchor="left bottom"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 941 40"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61"/>
        <Static id="Static00" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 100 40 110 61"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 233 40 263 61"/>
        <Static id="Static22" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 451 40 481 61"/>
        <Static id="Static23" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 318 40 328 61"/>
        <Static id="Static25" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 556 40 566 61"/>
        <Static id="Static14" text="레 시 피 명" position="absolute 764 40 839 61" class="sta_WFSA_label"/>
        <MaskEdit id="med_T_MENU_COST" taborder="3" position="absolute 657 40 732 61"/>
        <Static id="Static4" text="~" position="absolute 644 40 653 61"/>
        <MaskEdit id="med_F_MENU_COST" taborder="2" position="absolute 566 40 641 61"/>
        <Static id="Static13" text="식 단 원 가" position="absolute 482 40 557 61" class="sta_WFSA_label"/>
        <Edit id="ed_S_MENU_NAME" taborder="1" position="absolute 328 40 451 61"/>
        <Static id="Static12" text="식 단 명" position="absolute 264 40 336 61" class="sta_WFSA_label"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" id="cbo_S_MENU_CLASS" index="0" innerdataset="@ds_Menu_Class" type="NOTFILTERED" taborder="0" position="absolute 110 40 233 61" displayrowcount="15"/>
        <Static id="Static02" text="개별식단분류" position="absolute 16 40 102 61" class="sta_WFSA_label"/>
        <Edit id="ed_RecipeNM" taborder="4" position="absolute 847 40 965 61"/>
        <Static id="Static01" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 941 71"/>
        <Static id="Static05" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 732 40 762 61"/>
        <Static id="Static17" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 837 40 847 61"/>
        <Static id="Static21" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 965 40 980 61"/>
        <Static id="Static24" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 71 450 86"/>
        <Static id="Static28" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 303 986 316"/>
        <Static id="Static29" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 329 978 334"/>
        <Static id="Static33" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 413 474 418"/>
        <Static id="Static34" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 706 413 1180 418"/>
        <Button id="btn_Nut" taborder="52" tabstop="false" class="btn_WF_rightMove" position="absolute 679 527 700 548" onclick="btn_Nut_onclick"/>
        <Static id="Static26" text="w05" class="Guide01_AreaRed" visible="false" position="absolute 674 520 679 557"/>
        <Static id="Static27" text="w05" class="Guide01_AreaRed" visible="false" position="absolute 700 520 705 557"/>
        <Static id="Static30" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 694 474 699"/>
        <Static id="Static37" class="sta_WFDA_Labelbg" visible="true" position="absolute 705 334 1237 361" anchor="left top right"/>
        <Button id="btn_insert" onclick="Common_Btn_common_OnClick" taborder="28" text="초기화" position="absolute 1073 337 1125 357" class="btn_WF_Function" image="" anchor="top right"/>
        <Button id="btn_save" onclick="Common_Btn_common_OnClick" taborder="29" text="저장" position="absolute 1127 337 1179 357" class="btn_WF_Function" image="" anchor="top right"/>
        <Button id="btn_delete" onclick="Common_Btn_common_OnClick" taborder="30" text="삭제" position="absolute 1181 337 1233 357" class="btn_WF_Function" image="" anchor="top right"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_rdo">
        <ColumnInfo>
          <Column id="CD" size="256" type="STRING"/>
          <Column id="NM" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CD">0</Col>
            <Col id="NM">전체  </Col>
          </Row>
          <Row>
            <Col id="CD">1</Col>
            <Col id="NM">한화표준레시피  </Col>
          </Row>
          <Row>
            <Col id="CD">2</Col>
            <Col id="NM">본사표준레시피</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list"/>
      <Dataset id="ds_Menu_Class">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_input"/>
      <Dataset id="ds_Menu">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="INT"/>
          <Column id="MENU_CD" size="256" type="STRING"/>
          <Column id="MENU_NAME" size="256" type="STRING"/>
          <Column id="MENU_CLASS" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_RecipeGbn">
        <ColumnInfo>
          <Column id="CD" size="256" type="STRING"/>
          <Column id="NM" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CD">FM</Col>
            <Col id="NM">본사</Col>
          </Row>
          <Row>
            <Col id="CD">FS</Col>
            <Col id="NM">한화</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_RecipeList">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="INT"/>
          <Column id="MENU_CD" size="256" type="STRING"/>
          <Column id="RECIPE_CD" size="256" type="STRING"/>
          <Column id="RECIPE_NAME" size="256" type="STRING"/>
          <Column id="ORI_TYPE" size="256" type="STRING"/>
          <Column id="OP_PRICE" size="256" type="INT"/>
          <Column id="CAL" size="256" type="BIGDECIMAL"/>
          <Column id="CAL_CALC" size="256" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_RecipeType"/>
      <Dataset id="ds_RecipeClass"/>
      <Dataset id="ds_subList"/>
      <Dataset id="ds_gbn">
        <ColumnInfo>
          <Column id="CD" size="256" type="STRING"/>
          <Column id="NM" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CD">0</Col>
            <Col id="NM">한화</Col>
          </Row>
          <Row>
            <Col id="CD">1</Col>
            <Col id="NM">본사</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Excel"/>
      <Dataset id="ds_seq"/>
    </Objects>
    <Bind>
      <BindItem id="cbo_Class_value" compid="cbo_Class" propid="value" datasetid="ds_Menu" columnid="MENU_CLASS"/>
      <BindItem id="ed_MenuCD_value" compid="ed_MenuCD" propid="value" datasetid="ds_Menu" columnid="MENU_CD"/>
      <BindItem id="ed_MenuNM_value" compid="ed_MenuNM" propid="value" datasetid="ds_Menu" columnid="MENU_NAME"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
 ******************************************************************************************
 * 시스템구분   : 메뉴관리/식단관리/표준식단등록
 * 프로그램명   : FMM00180E
 * 기      능   : 표준식단등록
 * 작  성  자   : 윤상
 * 작성  일자   : 20080131
 * 비      고   : 
//=========================================================================================
*/
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
include "U_lib::lib_conversionCom.xjs";
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"		// X-Framework Lib
////@@컨버터에서 주석처리 #include "LIB::fm_common.js"			// 사업장팝업용 Lib
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var serverSaveDir1 = "FSM_SINGLE_MENU_MST";		// 파일패스 - 본부
var serverSaveUrl1;								// 파일패스URL - 본부
var serverSaveDir2 = "";						// 파일패스 - 본사
var serverSaveUrl2;								// 파일패스URL - 본사
var fstrSerchGbn = "1";								// 본부(1),본사(2)
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, true);

	// X-Framework : Action 정보 생성 
	fsp_init(this);

	http.Sync = true;
	fsp_clear(this);
	// 레시피분류
	ds_RecipeClass.clearData();
	fsp_addSearch(this,"fm/fmr:FMR00010E_S002");
	fsp_callService(this,"","","","ds_RecipeClass=ds_RecipeClass","","fn_Call_Class","",true);
	http.Sync = false;

	http.Sync = true;
	fsp_clear(this);
	// 레시피유형
	ds_RecipeType.clearData();
	fsp_addSearch(this,"fm/fmr:FMR00010E_S003");
	fsp_callService(this,"","","","ds_RecipeType=ds_RecipeType","","fn_Call_Type","",true);	
	http.Sync = false;

	//공통코드조회
	var v_fil_cond;
	var v_ds = fn_common_code("'FS0028'","","","non","Y");

	// 개별식단분류(ds_Menu_Class, GROUP_CODE : 'FS0028')
	v_fil_cond = "GROUP_CODE == 'FS0028'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_Menu_Class,v_ds.name);
	ds_Menu_Class.insertRow(0);
	ds_Menu_Class.setColumn(0,"CODE","");
	ds_Menu_Class.setColumn(0,"CODE_NAME","전체");
	cbo_S_MENU_CLASS.index=0;
	
	cbo_RecipeClass.index = 0;
	cbo_RecipeType.index = 0;
	//본사만 조회되게
	rdo_gbn.value = 2;
}
function fn_Call_Class(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
		ds_RecipeClass.filter("CD!='H'");
	}
}
function fn_Call_Type(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
		ds_RecipeType.filter("SET1!='Y'");
	}
}
//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_search()
{
	if(gfn_dsIsUpdated(ds_Menu)==true || gfn_dsIsUpdated(ds_RecipeList)==true )
	{
		if(g_Confirm("02",fn_AlertMsg("007")))
		{
			fn_save();
			return;
		}
	}
	ds_Menu.clearData();
	ds_RecipeList.clearData();
	me_Menu_Cost.value="";
	// 조회조건체크
	// 전체 추가 되어서 아래 로직 주석
	// if (cbo_S_MENU_CLASS.Index==-1 || length(trim(cbo_S_MENU_CLASS.Value))==0)
	// {
		// g_Message("EE", fn_AlertMsg("001"));
		// cbo_S_MENU_CLASS.SetFocus();
		// return;
	// }
	// ds_input.Clear();
	// ds_input.AddColumn("MENU_CLASS","STRING"	);
	// ds_input.AddColumn("MENU_NAME","STRING"	);
	// ds_input.AddColumn("FROM_COST","STRING"	);
	// ds_input.AddColumn("TO_COST","STRING"	);
	// ds_input.AddColumn("RECIPE_NAME","STRING");
	// ds_input.AddRow();
	// ds_input.SetColumn(0,"MENU_CLASS"	,trim(cbo_S_MENU_CLASS.Value)	);
	// ds_input.SetColumn(0,"MENU_NAME"	,trim(ed_S_MENU_NAME.value)		);
	// ds_input.SetColumn(0,"FROM_COST"	,trim(med_F_MENU_COST.Value)	);
	// ds_input.SetColumn(0,"TO_COST"		,trim(med_T_MENU_COST.Value)	);
	// ds_input.SetColumn(0,"RECIPE_NAME"	,trim(ed_RecipeNM.value)			);
	//조회
	// var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	//속도 문제로 jsp로 교체
	// inData			= "ds_input=ds_input";
	// outData			= "ds_list=ds_list";
	// callBackFnc		= "";
	// ds_list.ClearData();
	// tit_clearActionInfo(this); 
    // tit_addSearchActionInfo(this, "fm/fmm:FMM00180E_S001");				// 조회 
    // tit_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
    
    var arg	="MENU_CLASS="		+wrapQuote(gfn_trim(gfn_nvl(cbo_S_MENU_CLASS.value)))
			+" MENU_NAME="		+wrapQuote(gfn_trim(gfn_nvl(ed_S_MENU_NAME.value)))
			+" FROM_COST="		+wrapQuote(gfn_trim(gfn_nvl(med_F_MENU_COST.value)))
			+" TO_COST="		+wrapQuote(gfn_trim(gfn_nvl(med_T_MENU_COST.value)))
			+" RECIPE_NAME="	+wrapQuote(gfn_trim(gfn_nvl(ed_RecipeNM.value)))
			+" g_Upjang="		+wrapQuote(gfn_trim(gfn_nvl(g_Upjang)));
			
    var OutDS="ds_list=ds_list";
    ds_list.clearData();
    Transaction("ds_list","U_svc::" + "fm/fmm/FMM00180E_S001.jsp","",OutDS,arg,"fn_call_back");
}
function fn_call_back(svcid,cd,errmsg)
{
	if(cd!=0)
	{
		g_Message("EE","시스템 오류!\n\n전산 담당자에게 연락하세요.");
		return;
	}
	else
	{
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Insert()
 * 기      능   : [입력버튼] 입력 시 처리되는 작업
 * 비      고	: 팝업사용
 ******************************************************************************************
 */
function fn_insert()
{
	if(gfn_dsIsUpdated(ds_Menu)==true || gfn_dsIsUpdated(ds_RecipeList)==true)
	{
		if(g_Confirm("02",fn_AlertMsg("007")))
		{
			fn_save();
		}
		else
		{
			ds_Menu.clearData();
			ds_RecipeList.clearData();
		}
	}
	else
	{
		ds_Menu.clearData();
		ds_RecipeList.clearData();
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Save()
 * 기      능   : [저장버튼] 저장 시 처리되는 작업
 ******************************************************************************************
 */
function fn_save()
{
	if(gfn_dsIsUpdated(ds_Menu)==false && gfn_dsIsUpdated(ds_RecipeList)==false )
	{
		g_Message("EE","갱신된 정보가 없습니다.");
		return;
	}
	if(ds_Menu.getRowCount()>0)
	{
		if(gfn_length(gfn_trim(ds_Menu.getColumn(0,"MENU_NAME")))==0)
		{
			g_Message("EE","식단명을 입력하세요.");
			return;
		}
	}
	me_Menu_Cost.value="";
	var actionName, cmdName, inData, outData, Arg, callBackFnc;
	var searchsql,insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql;
	var searchsql,insertSql2, updateSql2, deleteSql2;
	var searchsql,insertSql3, updateSql3, deleteSql3;
	var arg;
	
	fsp_clear(this);
	ds_seq.clearData();
	
	inData		= "ds_Menu=ds_Menu:U ds_RecipeList=ds_RecipeList:U";
	outData		= "ds_Menu=ds_Menu ds_RecipeList=ds_RecipeList ds_seq=ds_seq";
	callBackFnc="fn_Call_Msg";
	
	insertSql1 	= "fm/fmm:FMM00180E_I001";
	insertSql2 	= "fm/fmm:FMM00180E_I002";
	
	updateSql1 	= "fm/fmm:FMM00180E_U001";
	updateSql2 	= "fm/fmm:FMM00180E_U002";	
	
	deleteSql1 	= "fm/fmm:FMM00180E_D001";
	deleteSql2 	= "fm/fmm:FMM00180E_D002";	
	
	keyIncrement= -1;
	callbackSql	= "";
	if(GetRowType(ds_Menu,0)=="insert")
	{
		fsp_addSearch(this,"fm/fmm:FMM00180E_S005",true);
		arg="";
	}
	else
	{
		arg="iMENU_CD="+wrapQuote(gfn_trim(gfn_nvl(ed_MenuCD.value)));
	}
	fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
	fsp_addSave(this, insertSql2, updateSql2, deleteSql2,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
	fsp_addSearch(this,"fm/fmm:FMM00180E_S007");
	 
//	tit_addSearchActionInfo(this,"fm/fmm:FMM00180E_S006");	// <=====속도 문제로 하단 jsp로 교체 sync해제 하지 마세요
	http.Sync=true;
	fsp_callService(this, actionName, cmdName, inData, outData, arg, callBackFnc);
	http.Sync=false;
//===========================

	// outData		= "ds_Menu=ds_Menu";
	// ds_Menu.ClearData();
	// ds_RecipeList.ClearData();
	// tit_addSearchActionInfo(this,"fm/fmm:FMM00180E_S008");
	// http.Sync=true;
	// tit_callService(this, "", "", "", outData, arg, "");
	// http.Sync=false;
	
	arg	="MENU_CD="+	wrapQuote(ds_Menu.getColumn(0,"MENU_CD"))	// ed_MenuCD.value		ds_Menu.GetColumn(0,"MENU_CD"));	//(ed_MenuCD.Text)
		+" g_Upjang="+	wrapQuote(g_Upjang);    

    var OutDS="ds_RecipeList=ds_RecipeList";

    http.Sync=true;
    Transaction("ds_RecipeList","U_svc::" + "fm/fmm/FMM00180E_S003.jsp","",OutDS,arg,"");
    http.Sync=false;	
	
	
//================	
	var v_sum=ds_RecipeList.getSum("OP_PRICE");
	me_Menu_Cost.value=v_sum;
}
function fn_Call_Msg(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
		g_Message("EE","저장 되었습니다.");
		return;
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Delete()
 * 기      능   : [삭제버튼] 삭제 시 처리되는 작업
 ******************************************************************************************
 */
function fn_delete()
{
	if(ds_Menu.getRowCount()==0)
	{
		return;
	}
	// if(g_Confirm("01",fn_AlertMsg("006")))
	// {
		// ds_Menu.DeleteAll();
		// ds_RecipeList.DeleteAll();
	// }
	// fn_Save();
	
	// 20080416 팝업없이 개별 전체 삭제하고 저장버튼 눌러서 반영한다고 요청하여 변경함
	ds_Menu.deleteAll();
	ds_RecipeList.deleteAll();	
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Print()
 * 기      능   : [출력버튼] 출력 시 처리되는 작업
 ******************************************************************************************
 */
function fn_print()
{
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Excel()
 * 기      능   : [엑셀버튼] 엑셀 시 처리되는 작업
 ******************************************************************************************
 */
function fn_Excel()
{

}
/*
 ******************************************************************************************
 * 함  수  명   : fn_close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function fn_close()
{
	if(gfn_dsIsUpdated(ds_Menu)==true || gfn_dsIsUpdated(ds_RecipeList)==true )
	{
		if(g_Confirm("02",fn_AlertMsg("007")))
		{
			fn_save();
			return false;
		}
	}	
	return true;
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Help()
 * 기      능   : [도움말버튼] 도움말
 ******************************************************************************************
 */
function fn_help()
{
	var strFileURL = g_ServerURL+"help/FMM00180E.ppt";
	system.execBrowser(strFileURL);
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
 /******************************************************************************************
 * 함  수  명   : fn_AlertMsg
 * 기      능   : 공통 메시지 처리
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20080131
 ******************************************************************************************
 */
function fn_AlertMsg(cd)
{
	var v_Msg="";
	switch(cd)
	{
		case "001":
			v_Msg= "개별 식단 분류가 없거나 선택하지 않았습니다.";
			break;
		case "002":
			v_Msg="본사만 다운로드 가능합니다.";
			break;			
		case "003":
			v_Msg="표준식단 구성에 추가 하시겠습니까.";
			break;	
		case "004":
			v_Msg="이미 등록된 레시피 입니다.";
			break;			
		case "005":
			v_Msg="레시피를 삭제하시겠습니까?";
			break;	
		case "006":
			v_Msg="다음 식단을 삭제하시겠습니까?";
			break;
		case "007":
			v_Msg="변경된 데이타가 있습니다.\n\n저장 하시겠습니까?";
			break;								
/*			
		case "":
			v_Msg="";
			break;
*/			
		default:
			break;			
	}
	return v_Msg;
}
 /******************************************************************************************
 * 함  수  명   : fn_call_back_CallRecipeList
 * 기      능   : 콜백--fn_Call_Recipe 호출
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20080131
 ******************************************************************************************
 */
function fn_call_back_CallRecipeList(cd,errmsg)
{
	if(cd!=0)
	{
		return;
	}
	else
	{
		fn_Call_Recipe();	// 표준식단 구성 레시피목록 조회
	}
}
 /******************************************************************************************
 * 함  수  명   : fn_Call_Recipe
 * 기      능   : 본사 표준 식단 조회
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20080131
 ******************************************************************************************
 */
function fn_Call_Recipe()
{
	//var actionName, cmdName, inData, outData, arg, callBackFnc;
	
	arg	="MENU_CD="	+wrapQuote(gfn_nvl(ds_list.getColumn(ds_list.rowposition,"MENU_CD")))
		+" g_Upjang="+	wrapQuote(gfn_nvl(g_Upjang));
	// 속도문제로 jsp교체
	// inData			= "";
	// outData			= "ds_RecipeList=ds_RecipeList";
	// callBackFnc		= "";
	// ds_RecipeList.ClearData();
    // http.Sync=true;
	// tit_clearActionInfo(this); 
    // tit_addSearchActionInfo(this, "fm/fmm:FMM00180E_S003");				// 조회 
    // tit_callService(this, actionName, cmdName, inData, outData, arg, callBackFnc);
    // http.Sync=false;
    
    
    var OutDS="ds_RecipeList=ds_RecipeList";
    ds_RecipeList.clearData();
    http.Sync=true;
    Transaction("ds_RecipeList","U_svc::" + "fm/fmm/FMM00180E_S003.jsp","",OutDS,arg,"");
    http.Sync=false;
        
	var v_sum=0;
	v_sum=ds_RecipeList.getSum("OP_PRICE");
	me_Menu_Cost.value=v_sum;    
}
 /******************************************************************************************
 * 함  수  명   : fn_subSearch
 * 기      능   : 한화 본사 표준 레시피 조회
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20080131
 ******************************************************************************************
 */
function fn_subSearch()
{
	var chk_Std=0;
	var chk_Upjang=0;

	switch(rdo_gbn.value)
	{
		case "0":
			chk_Std			=1 ;
			chk_Upjang		=1 ;		
			break;
		case "1":
			chk_Std			=1 ;
			chk_Upjang		=0 ;		
			break;
		case "2":
			chk_Std			=0 ;
			chk_Upjang		=1 ;	
			break;
        default :
            break;
	}
	
	var ActionVal=""; 
	ActionVal 	="STD_CHK="					+	wrapQuote(gfn_trim(gfn_nvl(chk_Std)))
				+" UPJANG_CHK="				+	wrapQuote(gfn_trim(gfn_nvl(chk_Upjang)))
				+" RECIPE_NAME="			+	wrapQuote(gfn_trim(gfn_nvl(ed_ReciNM.value)))
				+" RECIPE_CLASS="			+	wrapQuote(gfn_trim(gfn_nvl(cbo_RecipeClass.value)))
				+" RECIPE_TYPE="			+	wrapQuote(gfn_trim(gfn_nvl(cbo_RecipeType.value)))
				+" UPJANG="					+	wrapQuote(gfn_trim(gfn_nvl(g_Upjang)));
	//속도문제로 jsp로 교체			
	// tit_ClearActionInfo(this);
	// ds_subList.ClearData();
	// tit_addSearchActionInfo(this,"fm/fmm:FMM00180E_S004");
	// tit_CallService(this,"","","","ds_subList=ds_List",ActionVal,"");
	
	
	var OutDS="ds_subList=ds_subList";
	ds_subList.clearData();
	Transaction("ds_subList","U_svc::" + "fm/fmm/FMM00180E_S004.jsp","",OutDS,ActionVal,"");
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
 /******************************************************************************************
 * 함  수  명   : Common_Btn_common_OnClick
 * 기      능   : 버튼 처리
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20080131
 ******************************************************************************************
 */
function Common_Btn_common_OnClick(obj:Button, e:ClickEventInfo)
{
	switch(obj.name)
	{
		case "btn_subSearch":
			fn_subSearch();	// 한화 및 본사 표준 레시피 조회
			break;
			
		case "btn_insert":
			fn_insert();	// 식단 신규 생성 --표준식단 구성 화면부분 초기화만 함
			break;
		case "btn_save":
			fn_save();		// 식단 코드 및 식단 생성
			break;
		case "btn_delete":
			fn_delete();	// 식단 삭제
			break;
		default :
			break;
	}
}
 /******************************************************************************************
 * 함  수  명   : grd_list_OnCellDblClick
 * 기      능   : 표준식단 구성조회
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20080131
 ******************************************************************************************
 */
function grd_list_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
	if(gfn_dsIsUpdated(ds_Menu)==true || gfn_dsIsUpdated(ds_RecipeList)==true )
	{
		if(g_Confirm("02",fn_AlertMsg("007")))
		{
			fn_save();
			return;
		}
	}
	var actionName, cmdName, inData, outData, arg, callBackFnc;
	
	arg	="MENU_CD="	+wrapQuote(gfn_nvl(ds_list.getColumn(e.row,"MENU_CD")));
	
	inData			= "";
	outData			= "ds_Menu=ds_Menu";
	callBackFnc		= "fn_call_back_CallRecipeList";
	ds_Menu.clearData();
	fsp_clear(this); 
    fsp_addSearch(this, "fm/fmm:FMM00180E_S002");				// 조회 
    fsp_callService(this, actionName, cmdName, inData, outData, arg, callBackFnc);	
}

 /******************************************************************************************
 * 함  수  명   : grd_list_OnCellClick
 * 기      능   : 사진등록및 조회 팝업
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20080131
 ******************************************************************************************
 */
function grd_list_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	if(e.cell==6)	// 사진 팝업
	{
	
	}
	else
	{
		return;
	}
}
 /******************************************************************************************
 * 함  수  명   : Grid0_OnCellClick
 * 기      능   : 레시피 상세조회
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20080131
 ******************************************************************************************
 */
function Grid0_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	ds_subList.rowposition=e.row;
	
	switch(e.cell)
	{
		case 7:	// 레시피 상세 조회
			var v_arg	= {RECIPE:ds_subList.getColumn(e.row,"RECIPE_CD")
						  ,RECIPENM:ds_subList.getColumn(e.row,"RECIPE_NAME")
						  ,gbn:"0"	// 팝조회
						  ,gbn1:ds_subList.getColumn(e.row,"GUBUN")};	// 한화 0 본사 1 구분
			gfn_dialog("", "U_FMM::FMM00181P.xfdl",v_arg, 990, 740);
			break;
        default :
            break;
	}
}
 /******************************************************************************************
 * 함  수  명   : Grid0_OnHeadClick
 * 기      능   : 본사만 엑셀출력
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20080131
 ******************************************************************************************
 */
function Grid0_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{	
	switch(e.cell)
	{
		case 0:
			g_Message("04",fn_AlertMsg("002"));
			ds_Excel.clear();
			Copy(ds_Excel,obj.binddataset);
			ds_Excel.filter("GUBUN!=0");
			grd_Excel.binddataset="ds_Excel";
			gfn_exportExcel(grd_Excel, "sheet1");			
			break;
		default:
			gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
			break;
	}
}
 /******************************************************************************************
 * 함  수  명   : Grid1_OnHeadClick
 * 기      능   : 본사만 엑셀출력
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20080131
 ******************************************************************************************
 */
function Grid1_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	switch(e.cell)
	{
		case 0:
			g_Message("04",fn_AlertMsg("002"));
			ds_Excel.clear();
			Copy(ds_Excel,obj.binddataset);
			ds_Excel.filter("ORI_TYPE!='FS'");
			grd_Excel1.binddataset="ds_Excel";
			gfn_exportExcel(grd_Excel1, "sheet1");			
			break;
		case 2:
			if(Grid1.userdata)
			{
				Grid1.userdata=false;
			}
			else
			{
				Grid1.userdata=true;
			}
			Sort(ds_RecipeList,"RECIPE_NAME",Grid1.userdata);
			break;
		default:
			gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
			break;
	}
}

function grd_list_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	switch(e.cell)
	{
		case 0:
			gfn_exportExcel(grd_list, "sheet1");			
			break;
		default:
			gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
			break;
	}	
}
 /******************************************************************************************
 * 함  수  명   : Grid1_OnCellClick
 * 기      능   : 레시피 삭제
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20080131
 ******************************************************************************************
 */
function Grid1_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	switch(e.cell)
	{
		case 2:	// 레시피 삭제
				if(GetRowType(ds_RecipeList,e.row)=="insert")
				{
					ds_RecipeList.deleteRow(e.row);
				}
				else
				{
					ds_RecipeList.deleteRow(e.row);
					
				}
			// 팝업없이 삭제후 저장버튼으로 반영하겠다 요청함
/*			if(g_Confirm("01",fn_AlertMsg("005")))
			{
				if(ds_RecipeList.GetRowType(nRow)=="insert")
				{
					ds_RecipeList.DeleteRow(nRow);
				}
				else
				{
					ds_RecipeList.DeleteRow(nRow);
					
				}
				if(ds_RecipeList.GetUpdate()==true)
				{
					fn_Save();
				}
			}
			else
			{
				return;
			}					*/
			break;
        default :
            break;
	}
}
 /******************************************************************************************
 * 함  수  명   : Grid0_OnCellDblClick
 * 기      능   : 레싶피 추가
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20080131
 ******************************************************************************************
 */
function Grid0_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
	fn_moveData(e.row);
}

function fn_moveData(nRow)
{
	if(ds_Menu.getRowCount()==0)
	{
		ds_Menu.addRow();
		ds_Menu.setColumn(0,"UPJANG",g_Upjang);
		cbo_Class.index=1;
	}
	if(ds_RecipeList.findRow("RECIPE_CD",ds_subList.getColumn(nRow,"RECIPE_CD"))!=-1)
	{
		g_Message("EE",fn_AlertMsg("004"));
		return;
	}
	//var v_upjang=ds_subList.GetColumn(nRow,"UPJANG");
	//var v_menu_cd=ds_subList.GetColumn(nRow,"MENU_CD");
	var v_menu_cd=gfn_trim(ed_MenuCD.value);
	var v_recipe_cd=ds_subList.getColumn(nRow,"RECIPE_CD");
	var v_recipe_name=ds_subList.getColumn(nRow,"RECIPE_NAME");
	var v_cost=ds_subList.getColumn(nRow,"RECIPE_COST");
	var v_CAL=ds_subList.getColumn(nRow,"CAL_CALC");
	var v_ori_type="";
	if(ds_subList.getColumn(nRow,"GUBUN")==0)
	{
		v_ori_type="FS";
	}
	else
	{
		v_ori_type="FM";
	}

	ds_RecipeList.addRow();
	ds_RecipeList.setColumn(ds_RecipeList.rowposition,"UPJANG",gfn_nvl(g_Upjang));
	ds_RecipeList.setColumn(ds_RecipeList.rowposition,"MENU_CD",gfn_nvl(v_menu_cd));
	ds_RecipeList.setColumn(ds_RecipeList.rowposition,"RECIPE_CD",gfn_nvl(v_recipe_cd));
	ds_RecipeList.setColumn(ds_RecipeList.rowposition,"RECIPE_NAME",gfn_nvl(v_recipe_name));
	ds_RecipeList.setColumn(ds_RecipeList.rowposition,"ORI_TYPE",gfn_nvl(v_ori_type));
	ds_RecipeList.setColumn(ds_RecipeList.rowposition,"OP_PRICE",v_cost);
	ds_RecipeList.setColumn(ds_RecipeList.rowposition,"CAL_CALC",v_CAL);
	// ds_RecipeList.SetColumn(ds_RecipeList.row,"CAL",);
	// ds_RecipeList.SetColumn(ds_RecipeList.row,"CAL_CALC",);
	var v_sum=ds_RecipeList.getSum("OP_PRICE");
	me_Menu_Cost.value=v_sum;
}
 /******************************************************************************************
 * 함  수  명   : ed_ReciNM_OnKeyDown
 * 기      능   : 조회함수 호출
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20080131
 ******************************************************************************************
 */
function ed_ReciNM_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar==13)
	{
		fn_subSearch();
	}
}

function goNext_OnKeyDown(obj, e:KeyEventInfo)
{
	switch(e.keycode)
	{
		case 13:	// Enter
			switch(obj.name)
			{
				case "ed_RecipeNM":
					fn_search();
					break;
				case "ed_ReciNM":
					fn_subSearch();
					break;
			}
			var v_nComp=GetNextComponent(null);
			v_nComp.setFocus();
			break;
        default :
            break;
	}	
}

function cbo_Class_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	if(e.postindex==-1 || e.postindex==0 || gfn_length(gfn_trim(e.postvalue))==0)
	{
		g_Message("EE","필수 선택사항입니다.");
		cbo_Class.index=e.preindex;
	}
}

function btn_Nut_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_moveData(ds_subList.rowposition);
}

function fn_form_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e);
	if ( (e.keycode == 13) && (e.fromreferenceobject == ed_RecipeNM) ) fn_search();
}
]]></Script>
  </Form>
</FDL>

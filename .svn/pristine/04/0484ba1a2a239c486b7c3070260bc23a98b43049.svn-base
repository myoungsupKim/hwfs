<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSP00030E" onkeydown="FSP00030E_OnKeyDown" onload="form_onload" titletext="구매신청" position="absolute 0 0 1252 725" scrollbars="none" onsize="FSP00030E_onsize">
    <Layouts>
      <Layout>
        <Grid selecttype="row" autoenter="select" binddataset="ds_master" cellsizingtype="col" readonly="false" enable="true" id="grd_mst" useinputpanel="false" oncelldblclick="grd_mst_OnCellDblClick" onheadclick="grd_OnHeadClick" taborder="18" tabstop="false" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 128 1237 407" autofittype="col" anchor="left top right" oncellclick="grd_mst_oncellclick" class="grd_WF_LineNone">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30" band="left"/>
                <Column size="22" band="left"/>
                <Column size="25" band="left"/>
                <Column size="107"/>
                <Column size="80"/>
                <Column size="150"/>
                <Column size="130"/>
                <Column size="200"/>
                <Column size="150"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="23"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" colspan="2" text="구분"/>
                <Cell col="3" displaytype="text" text="구매신청번호"/>
                <Cell col="4" displaytype="text" text="신청일자"/>
                <Cell col="5" displaytype="text" text="신청부서"/>
                <Cell col="6" displaytype="text" text="창고"/>
                <Cell col="7" displaytype="text" text="제목"/>
                <Cell col="8" displaytype="text" text="구매유형"/>
                <Cell col="9" displaytype="text" text="구매금액"/>
                <Cell col="10" displaytype="text" text="부가세"/>
                <Cell col="11" displaytype="text" text="구매총액"/>
                <Cell col="12" displaytype="text" text="진행상황"/>
                <Cell col="13" displaytype="text" text="입고예정일"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;background:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');background2:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');color:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" expr="expr:currow+1" tooltiptype="top,right"/>
                <Cell col="1" displaytype="button" style="padding:5 5 5 5;linetype:onlyhorz;background:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');background2:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');color:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');controlbackground:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ?  'tomato' : '#7bd7a3ff');controlborder:1 none #808080ff ;controlbordertype:round 10 10 ;" tooltiptype="top,right"/>
                <Cell col="2" displaytype="image" style="align:center;background:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');background2:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');color:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');font:나눔고딕,9,bold;" text="expr:MOBILE_GUBUN == 'M' ? 'theme://Images/new/grd_WF_M.png' : 'theme://Images/new/grd_WF_P.png'" tooltiptype="top,right"/>
                <Cell col="3" displaytype="text" edittype="none" style="align:center;padding:1 1 1 1;background:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');background2:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');color:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:PR_NUM" tooltiptype="right" tooltiptext="expr:CLOSE_YN == 'Y' ? '마감시간이 초과된 신청입니다.' : ''"/>
                <Cell col="4" displaytype="date" style="align:center;background:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');background2:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');color:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:PR_DATE" calendardisplaynulltype="none" tooltiptype="top,right"/>
                <Cell col="5" displaytype="text" style="align:left;padding:0 0 0 5;background:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');background2:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');color:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:CC_NM" tooltiptype="top,right"/>
                <Cell col="6" displaytype="text" style="align:left;padding:0 0 0 5;background:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');background2:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');color:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:SUBINV_NAME" tooltiptype="top,right"/>
                <Cell col="7" displaytype="text" edittype="none" style="align:left;padding:0 0 0 5;background:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');background2:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');color:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:ITEM_TITLE" tooltiptype="top,right"/>
                <Cell col="8" displaytype="text" style="align:left;padding:0 0 0 5;background:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');background2:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');color:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:TYPE_NAME" tooltiptype="top,right"/>
                <Cell col="9" displaytype="number" style="align:right;padding:0 5 0 0;background:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');background2:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');color:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:AMT" tooltiptype="top,right"/>
                <Cell col="10" displaytype="number" style="align:right;padding:0 5 0 0;background:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');background2:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');color:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:VAT" tooltiptype="top,right"/>
                <Cell col="11" displaytype="number" style="align:right;padding:0 5 0 0;background:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');background2:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');color:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:TOT" tooltiptype="top,right"/>
                <Cell col="12" displaytype="combo" style="align:center;background:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');background2:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');color:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:LINE_STATUS" combodataset="ds_line_status" combocodecol="CODE" combodatacol="CODE_NAME" tooltiptype="top,right"/>
                <Cell col="13" displaytype="date" style="align:center;background:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');background2:EXPR(LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' || CLOSE_YN == 'Y' ? '#a9a9a932' : LINE_STATUS == '003' || LINE_STATUS == 'PD' ? '#ff63471e': 'default');color:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR(CLOSE_YN == 'Y' || LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:NEED_DATE" calendardisplaynulltype="none" tooltiptype="top,right"/>
              </Band>
              <Band id="summary">
                <Cell displaytype="text" style="align:center;linetype:onlyhorz;" taborder="undefined"/>
                <Cell col="1" displaytype="text" style="align:center;linetype:onlyhorz;" taborder="undefined"/>
                <Cell col="2" displaytype="text" style="align:center;linetype:onlyhorz;" taborder="undefined"/>
                <Cell col="3" colspan="6" displaytype="text" style="align:center;linetype: ;" text="합계" taborder="undefined"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="getSum('AMT')"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="getSum('VAT')"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="getSum('TOT')"/>
                <Cell col="12" colspan="2" displaytype="text" style="align:left;">
                  <Cell displaytype="text" style="align:left;"/>
                  <Cell col="1" displaytype="text" style="align:left;"/>
                </Cell>
              </Band>
            </Format>
            <Format id="cust_list">
              <Columns>
                <Column size="30" band="left"/>
                <Column size="22" band="left"/>
                <Column size="25" band="left"/>
                <Column size="150"/>
                <Column size="80"/>
                <Column size="150"/>
                <Column size="125"/>
                <Column size="200"/>
                <Column size="150"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" colspan="2" text="구분"/>
                <Cell col="3" displaytype="text" text="거래처"/>
                <Cell col="4" displaytype="text" text="신청일자"/>
                <Cell col="5" displaytype="text" text="신청부서"/>
                <Cell col="6" displaytype="text" text="창고"/>
                <Cell col="7" displaytype="text" text="제목"/>
                <Cell col="8" displaytype="text" text="구매유형"/>
                <Cell col="9" displaytype="text" text="구매금액"/>
                <Cell col="10" displaytype="text" text="부가세"/>
                <Cell col="11" displaytype="text" text="구매총액"/>
                <Cell col="12" displaytype="text" text="진행상황"/>
                <Cell col="13" displaytype="text" text="입고예정일"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;background:white;background2:white;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="button" style="padding:5 5 5 5;linetype:onlyhorz;background:white;background2:white;controlbackground:EXPR(LINE_STATUS == '003' ? 'tomato' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : '#7bd7a3ff');controlborder:1 none #808080ff ;controlbordertype:round 10 10 ;"/>
                <Cell col="2" style="background:white;background2:white;" text="bind:MOBILE_GUBUN"/>
                <Cell col="3" displaytype="text" style="align:left;padding:0 0 0 5;background:white;background2:white;" text="bind:CUSTNM"/>
                <Cell col="4" displaytype="date" style="align:center;background:white;background2:white;" text="bind:PR_DATE" calendardisplaynulltype="none"/>
                <Cell col="5" displaytype="text" style="align:left;padding:0 0 0 5;background:white;background2:white;" text="bind:CC_NM"/>
                <Cell col="6" displaytype="text" style="align:left;padding:0 0 0 5;background:white;background2:white;" text="bind:SUBINV_NAME"/>
                <Cell col="7" displaytype="text" style="align:left;padding:0 0 0 5;background:white;background2:white;" text="bind:ITEM_TITLE"/>
                <Cell col="8" displaytype="text" style="align:left;padding:0 0 0 5;background:white;background2:white;" text="bind:TYPE_NAME"/>
                <Cell col="9" displaytype="number" style="align:right;padding:0 5 0 0;background:white;background2:white;" text="bind:AMT"/>
                <Cell col="10" displaytype="number" style="align:right;padding:0 5 0 0;background:white;background2:white;" text="bind:VAT"/>
                <Cell col="11" displaytype="number" style="align:right;padding:0 5 0 0;background:white;background2:white;" text="bind:TOT"/>
                <Cell col="12" displaytype="combo" style="align:center;background:white;background2:white;" text="bind:LINE_STATUS" combodataset="ds_line_status" combocodecol="CODE" combodatacol="CODE_NAME"/>
                <Cell col="13" displaytype="date" style="align:center;background:white;background2:white;" text="bind:NEED_DATE" calendardisplaynulltype="none"/>
              </Band>
              <Band id="summary">
                <Cell colspan="3" displaytype="text" style="align:center;linetype:onlyhorz;" taborder="undefined"/>
                <Cell col="3" colspan="6" displaytype="text" style="align:center;" text="합 계" taborder="undefined"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="getSum('AMT')"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="getSum('VAT')"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="getSum('TOT')"/>
                <Cell col="12" colspan="2" displaytype="text" style="align:left;">
                  <Cell displaytype="text" style="align:left;"/>
                  <Cell col="1" displaytype="text" style="align:left;"/>
                </Cell>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static29" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 97" anchor="left top right"/>
        <Static id="Static34" text="W10" visible="false" position="absolute 147 40 157 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static43" text="W10" visible="false" position="absolute 14 30 1229 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static44" text="W10" visible="false" position="absolute 14 87 1229 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static45" text="W15" visible="false" position="absolute 0 30 14 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static51" text="W05." visible="false" position="absolute 14 61 1199 66" style="background:#ff000055;align:center middle;"/>
        <Static id="Static24" text="구매유형" class="sta_WFSA_label" position="absolute 716 40 786 61" anchor="left top"/>
        <Button id="btn_print2" taborder="68" text="신청서(일별)" onclick="fn_Btn_OnclickEvant" class="btn_WF_Print" position="absolute 1141 102 1237 123" anchor="top right" tabstop="false"/>
        <Button id="btn_print1" taborder="69" text="신청서(건별)" onclick="fn_Btn_OnclickEvant" class="btn_WF_Print" position="absolute 1043 102 1139 123" anchor="top right" tabstop="false"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Radio id="rdo_dtType" index="0" taborder="4" position="absolute 14 67 149 88" codecolumn="codecolumn" datacolumn="datacolumn" columncount="2">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">0</Col>
                <Col id="datacolumn">신청일</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1</Col>
                <Col id="datacolumn">입고일</Col>
              </Row>
            </Rows>
          </Dataset>
        </Radio>
        <CheckBox falsevalue="N" id="chk_cust" taborder="10" tabstop="false" text="거래처별 조회" truevalue="Y" value="false" position="absolute 716 67 813 88"/>
        <CheckBox falsevalue="N" id="chk_dept" taborder="11" tabstop="false" text="검수부서별 조회" truevalue="Y" value="false" position="absolute 819 67 924 88"/>
        <CheckBox falsevalue="N" id="chk_status" taborder="12" tabstop="false" text="진행상황별 조회" truevalue="Y" value="false" position="absolute 931 67 1038 88"/>
        <MaskEdit id="msk_start_date" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="5" type="string" position="absolute 157 66 231 87" class="msk_WF_EssentialCal" tooltiptext="시작일자" autoselect="true"/>
        <Button id="btn_start_date" onclick="g_CalButton_OnClick" taborder="8" tabstop="false" userdata="msk_start_date" position="absolute 230 66 251 87" class="btn_WF_calEssential" text="" image=""/>
        <MaskEdit id="msk_end_date" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="6" type="string" position="absolute 269 66 343 87" class="msk_WF_EssentialCal" tooltiptext="종료일자" autoselect="true"/>
        <Button id="btn_end_date" onclick="g_CalButton_OnClick" taborder="9" tabstop="false" userdata="msk_end_date" position="absolute 342 66 363 87" class="btn_WF_calEssential" text="" image=""/>
        <Static id="Static2" text="~" position="absolute 256 70 264 83"/>
        <Combo codecolumn="PO_TYPE" datacolumn="PO_TYPE_NM" id="cbo_potype" imemode="native" index="0" innerdataset="@ds_cbo_potype" type="filter" taborder="3" position="absolute 783 40 955 61" displayrowcount="15" tooltiptext="구매유형" onitemchanged="cbo_potype_onitemchanged"/>
        <Button id="btn_INFO" onclick="btn_INFO_OnClick" taborder="13" tabstop="false" text="유형설명" position="absolute 957 40 1008 62" class="btn_WF_Custom" image=""/>
        <Static id="Static22" text="구매신청집계" class="sta_WF_Title01" position="absolute 0 110 98 128"/>
        <Static id="Static10" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 123 1237 128"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="70" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Button id="btn_new" taborder="71" text="구매신청" class="btn_WF_CRUD" position="absolute 976 102 1041 123" anchor="top right" onclick="fn_Btn_OnclickEvant" tabstop="false"/>
        <Splitter id="sp_line" min="153" max="590" type="vertical" class="spt_WF_2" position="absolute 0 412 1237 422" anchor="left top right">
          <Formats>
            <Format id="default">
              <SplitterItems id="items">
                <SplitterItem id="item00" bindtype="resize" position="leftortop" offset="5" componentid="grd_mst"/>
                <SplitterItem id="item01" bindtype="resize" position="rightorbottom" offset="5" componentid="div_detail"/>
              </SplitterItems>
            </Format>
          </Formats>
        </Splitter>
        <Div id="div_detail" anchor="all" taborder="72" text="Div00" scrollbars="none" position="absolute 0 427 1237 710" tabstop="false">
          <Layouts>
            <Layout>
              <Edit id="edt_lineStaus" taborder="9" tabstop="false" enable="false" position="absolute 1003 10 1140 32"/>
              <Static id="Static00" class="sta_WFDA_Labelbg" position="absolute 0 0 1237 41" anchor="left top right"/>
              <Static id="Static01" text="신청번호" class="sta_WFSA_label" position="absolute 15 10 90 31" anchor="left top"/>
              <Static id="Static14" text="구매유형" class="sta_WFSA_label" position="absolute 214 10 289 31" anchor="left top"/>
              <Static id="Static17" text="신청일" class="sta_WFSA_label" position="absolute 453 10 528 31" anchor="left top"/>
              <Static id="Static18" text="신청자" class="sta_WFSA_label" position="absolute 643 10 718 31" anchor="left top"/>
              <Static id="Static04" text="W10" visible="false" position="absolute 73 10 83 31" anchor="left top" style="background:#ff000055;align:center middle;"/>
              <Static id="Static08" text="W30" visible="false" position="absolute 184 10 214 31" anchor="left top" style="background:#ff000055;align:center middle;"/>
              <Static id="Static09" text="W10" visible="false" position="absolute 271 10 281 31" anchor="left top" style="background:#ff000055;align:center middle;"/>
              <Static id="Static19" text="W30" visible="false" position="absolute 423 10 453 31" anchor="left top" style="background:#ff000055;align:center middle;"/>
              <Static id="Static20" text="W10" visible="false" position="absolute 489 10 499 31" anchor="left top" style="background:#ff000055;align:center middle;"/>
              <Static id="Static21" text="W30" visible="false" position="absolute 613 10 643 31" anchor="left top" style="background:#ff000055;align:center middle;"/>
              <Static id="Static23" text="W10" visible="false" position="absolute 689 10 699 31" anchor="left top" style="background:#ff000055;align:center middle;"/>
              <Static id="Static25" text="W10" visible="false" position="absolute 15 0 1230 10" style="background:#ff000055;align:center middle;" anchor="default"/>
              <Static id="Static27" text="W10" visible="false" position="absolute 15 31 1230 41" style="background:#ff000055;align:center middle;" anchor="default"/>
              <Static id="Static28" text="W15" visible="false" position="absolute 0 10 15 31" anchor="left top" style="background:#ff000055;align:center middle;"/>
              <Edit id="edt_prNum" taborder="1" tabstop="false" enable="true" position="absolute 83 10 184 32" style=":disabled {align:left middle;}" anchor="default" readonly="true"/>
              <Edit id="edt_poTypeNm" taborder="2" tabstop="false" enable="false" position="absolute 281 10 423 32" anchor="default"/>
              <Static id="Static30" text="신청금액" class="sta_WFSA_label" position="absolute 850 10 925 31" anchor="left top"/>
              <Static id="Static31" text="W30" visible="false" position="absolute 820 10 850 31" anchor="left top" style="background:#ff000055;align:center middle;"/>
              <Static id="Static32" text="W10" visible="false" position="absolute 907 10 917 31" anchor="left top" style="background:#ff000055;align:center middle;"/>
              <Edit id="edt_applNm" taborder="4" tabstop="false" enable="false" position="absolute 699 10 820 32" anchor="default"/>
              <MaskEdit id="msk_applAmt" taborder="5" tabstop="false" mask="#,###.#" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" oneditclick="g_Date_OnFocus" enable="false" position="absolute 917 10 1003 32" anchor="default"/>
              <Button id="btn_update" taborder="6" tabstop="false" text="  신청서수정" onclick="fn_Btn_OnclickEvant" class="btn_WF_Add" position="absolute 1123 10 1222 31" anchor="top right" userdata="" visible="true" enable="false"/>
              <Button id="btn_delete" taborder="7" tabstop="false" text="  신청서삭제" onclick="fn_Btn_OnclickEvant" class="btn_WF_Delete" position="absolute 1022 10 1121 31" anchor="top right" userdata="" enable="false"/>
              <Static id="Static33" text="W15" visible="false" position="absolute 1222 10 1237 31" anchor="left top" style="background:#ff000055;align:center middle;"/>
              <Static id="Static40" text="구매신청상세" class="sta_WF_Title01" position="absolute 0 46 98 64"/>
              <Grid id="Grid0" taborder="8" binddataset="ds_detail" wheelscrollrow="1" autoenter="select" useinputpanel="false" cellsizingtype="col" autofittype="col" onheadclick="grd_OnHeadClick" position="absolute 0 63 1237 283" anchor="all" tabstop="false" class="grd_WF_LineNone" oncelldblclick="div_detail_Grid0_oncelldblclick" selecttype="row" onexpandup="div_detail_Grid0_onexpandup">
                <Formats>
                  <Format id="Default">
                    <Columns>
                      <Column size="30" band="left"/>
                      <Column size="22" band="left"/>
                      <Column size="70" band="left"/>
                      <Column size="186"/>
                      <Column size="70"/>
                      <Column size="145"/>
                      <Column size="49"/>
                      <Column size="37"/>
                      <Column size="64"/>
                      <Column size="67"/>
                      <Column size="67"/>
                      <Column size="74"/>
                      <Column size="56"/>
                      <Column size="60"/>
                      <Column size="120"/>
                      <Column size="61"/>
                      <Column size="138"/>
                      <Column size="0"/>
                    </Columns>
                    <Rows>
                      <Row size="26" band="head"/>
                      <Row size="23"/>
                      <Row size="24" band="summ"/>
                    </Rows>
                    <Band id="head">
                      <Cell displaytype="text" class="head_Excel"/>
                      <Cell col="1" colspan="2" displaytype="text" text="자재코드" taborder="undefined"/>
                      <Cell col="3" displaytype="text" text="자재명"/>
                      <Cell col="4" displaytype="normal" text="특성"/>
                      <Cell col="5" displaytype="text" text="규격"/>
                      <Cell col="6" text="D_Day"/>
                      <Cell col="7" displaytype="text" text="단위"/>
                      <Cell col="8" displaytype="text" text="단가"/>
                      <Cell col="9" displaytype="text" text="신청수량"/>
                      <Cell col="10" text="발주수량"/>
                      <Cell col="11" displaytype="text" text="신청금액"/>
                      <Cell col="12" displaytype="text" text="과/면세"/>
                      <Cell col="13" displaytype="text" text="진행상황"/>
                      <Cell col="14" text="납품업체"/>
                      <Cell col="15" text="담당MD"/>
                      <Cell col="16" displaytype="text" text="비고"/>
                      <Cell col="17" displaytype="text" text="수정불가사유"/>
                    </Band>
                    <Band id="body">
                      <Cell displaytype="text" style="align:center;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" expr="expr:currow+1"/>
                      <Cell col="1" displaytype="button" style="padding:5 5 5 5;linetype:onlyhorz;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');controlbackground:EXPR(LINE_STATUS == '003' || LINE_STATUS == 'PD'? 'tomato' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : '#7bd7a3ff');controlborder:1 none #808080ff ;controlbordertype:round 10 10 ;"/>
                      <Cell col="2" style="align:center middle;linetype:nocross;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:ITEM_CODE"/>
                      <Cell col="3" displaytype="text" edittype="expr:IMG_YN == 'Y' ? 'expand' : 'none'" style="align:left;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');backgroundimage: ;" text="bind:ITEM_NAME" expandshow="expr:IMG_YN == 'Y' ? 'show' : 'hide'" expandsize="24" expandimage="URL('theme://Images/new/grd_WF_Camerabtn.png')"/>
                      <Cell col="4" displaytype="image" style="align:center;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:FEATURE_NAME"/>
                      <Cell col="5" displaytype="text" style="align:left;padding:0 0 0 5;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:ITEM_SIZE"/>
                      <Cell col="6" displaytype="text" style="align:center;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR(EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default'));color2:EXPR(EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default'));" text="bind:D_DAY"/>
                      <Cell col="7" style="align:center;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:PO_UOM"/>
                      <Cell col="8" displaytype="number" style="align:right;padding:0 5 0 0;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:MARGIN_PRICE"/>
                      <Cell col="9" displaytype="number" style="align:right;padding:0 5 0 0;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:PR_QTY"/>
                      <Cell col="10" displaytype="number" style="padding:0 5 0 0;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:PO_QTY"/>
                      <Cell col="11" displaytype="number" style="align:right;padding:0 5 0 0;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:PR_AMT"/>
                      <Cell col="12" displaytype="combo" style="align:center;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:TAX_CODE" combodataset="ds_tax" combocodecol="CODE" combodatacol="CODE_NAME"/>
                      <Cell col="13" displaytype="combo" style="align:center middle;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:LINE_STATUS" combodataset="ds_line_status" combocodecol="CODE" combodatacol="CODE_NAME"/>
                      <Cell col="14" displaytype="text" style="align:left;padding:0 0 0 10;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:CUSTNM"/>
                      <Cell col="15" displaytype="text" style="align:center;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:MD_NAME"/>
                      <Cell col="16" displaytype="text" style="align:left;padding:0 0 0 5;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:PR_REMARK"/>
                      <Cell col="17" displaytype="text" style="align:left;padding:0 0 0 5;background:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');background2:EXPR(LINE_STATUS == 'PR' || LINE_STATUS == 'PD' || LINE_STATUS == '003' ? '#ff63471e' : LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? '#a9a9a932' : 'default');color:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');color2:EXPR( LINE_STATUS == 'DL' || LINE_STATUS == 'GC' || LINE_STATUS == 'IV' ? 'gray' : 'default');" text="bind:LT_REMARK"/>
                    </Band>
                    <Band id="summary">
                      <Cell displaytype="text" style="align:center;linetype:onlyhorz;"/>
                      <Cell col="1" displaytype="text" style="align:center;linetype:onlyhorz;"/>
                      <Cell col="2" displaytype="text" style="align:center;linetype:onlyhorz;"/>
                      <Cell col="3" colspan="6" displaytype="text" style="align:center;" text="합 계" taborder="undefined"/>
                      <Cell col="9" displaytype="number" style="align:right;" expr="getSum('PR_QTY')"/>
                      <Cell col="10" displaytype="number" expr="expr:getSum('PO_QTY')"/>
                      <Cell col="11" displaytype="number" style="align:right;" expr="getSum('PR_AMT')"/>
                      <Cell col="12" colspan="5" displaytype="text" style="align:left;"/>
                      <Cell col="17" displaytype="text" style="align:left;"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Static id="sta_info" text="신청번호별로 작업이 가능합니다. ▲" class="sta_WF_DiscInfoN" visible="false" position="absolute 1015 47 1231 63" anchor="top right" style="color:#46578eff;font:Dotum,9,bold;"/>
              <Calendar id="msk_prDate" taborder="10" position="absolute 507 10 613 32" readonly="true" enable="false"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static25" text="사업부" class="sta_WFSA_label" position="absolute 15 41 85 62"/>
        <MuSearchComponent id="cbo_mu" titletext="사업부 선택 Component" taborder="0" text="MuSearchComponent00" class="cmb_WF_Essential" position="absolute 69 40 183 61" bindDataset="ds_condi" bindMuCdColumn="MU_CD" appendText="" onItemChangedEvent="fn_muChange"/>
        <Static id="Static04" text="팀" class="sta_WFSA_label" position="absolute 213 40 233 61"/>
        <TmSearchComponent id="edt_tm" titletext="팀 검색용 Component" taborder="1" text="TmSearchComponent00" position="absolute 241 40 363 61" bindDataset="ds_condi" bindTmCdColumn="TM_CD" bindTmNmColumn="" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tmChange" eventBeforeTrigger=""/>
        <Static id="st_UPJANG" text="사업장" class="sta_WFSA_label" position="absolute 393 40 466 61" anchor="left top" userdata=""/>
        <UpjangSearchComponent id="edt_upjang" titletext="업장 검색용 Component" taborder="2" text="UpjangSearchComponent00" position="absolute 462 40 683 61" tooltiptext="입고업장" bindDataset="ds_condi" bindUpjangCodeColumn="RC_UPJANG" bindUpjangNameColumn="RC_UPJANG_NM" eventBeforeTrigger="" eventAfterTrigger="" roleSetId=""/>
        <Static id="Static12" text="W30" visible="false" position="absolute 363 40 393 87" style="background:#ff000055;align:center middle;"/>
        <Static id="Static01" text="신청취소" position="absolute 264 107 337 128" style="align:left middle;" anchor="left top"/>
        <Static id="Static5" text="구매취소가능" position="absolute 144 107 221 128" style="align:left middle;" anchor="left top"/>
        <PopupDiv id="pdiv_INFO" oncloseup="pdiv_INFO_OnCloseUp" taborder="47" tabstop="false" position="absolute 1252 92 1707 183" scrollbars="none" visible="false" class="pdiv_WF_Pop">
          <Layouts>
            <Layout>
              <Static id="sta_detail00" class="sta_WFDA_Labelbg" position="absolute 97 55 447 82" anchor="default"/>
              <Static id="sta_detail07" class="sta_WFDA_Labelbg" position="absolute 97 27 447 54" anchor="default"/>
              <Static id="Static3" text="제한시기" position="absolute 4 27 98 54" class="sta_WFDA_Label01" anchor="default"/>
              <Static id="Static0" text="유형설명" position="absolute 4 55 98 82" class="sta_WFDA_Label01" anchor="default"/>
              <Edit enable="false" id="ed_D_DAYS" taborder="8" position="absolute 100 30 444 51" anchor="default"/>
              <Edit enable="false" id="ed_CONTRACT_FLAG" taborder="9" position="absolute 100 58 444 79" anchor="default"/>
              <Static id="Static22" text="구매유형" class="sta_WF_Title01" position="absolute 6 7 104 25" anchor="default"/>
            </Layout>
          </Layouts>
        </PopupDiv>
        <Button id="Button00" taborder="73" position="absolute 245 111 257 123" style="background:tomato;border:0 none #808080ff #ffffffff;padding:5 5 5 5;bordertype:round 10 10 ;shadow:drop 2,2 1 #d6d6d6ff;" anchor="left top" tabstop="false" enable="false"/>
        <Button id="Button01" taborder="74" position="absolute 124 111 136 123" style="background:#7bd7a3ff;border:0 none #808080ff #ffffffff;padding:5 5 5 5;bordertype:round 10 10 ;shadow:drop 2,2 1 #d6d6d6ff; :disabled {background:#7bd7a3ff;}" anchor="left top" tabstop="false" enable="false"/>
        <Button id="Button02" taborder="75" position="absolute 342 111 354 123" style="background:gray;border:0 none #808080ff #ffffffff;padding:5 5 5 5;bordertype:round 10 10 ;shadow:drop 2,2 1 #d6d6d6ff;" anchor="left top" tabstop="false" enable="false"/>
        <Static id="Static00" text="수정불가" position="absolute 362 107 435 128" anchor="left top" style="align:left middle;"/>
        <Combo id="cbo_line_status" taborder="7" position="absolute 462 66 683 87" index="-1" innerdataset="@ds_line_status" codecolumn="CODE" datacolumn="CODE_NAME" onkeydown="cbo_line_status_onkeydown"/>
        <Static id="st_UPJANG00" text="진행상황" class="sta_WFSA_label" position="absolute 393 67 466 88" anchor="left top" userdata=""/>
        <Static id="Static03" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 97 1237 102"/>
        <Static id="Static07" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 485 1237 490"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_condi" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_condi_oncolumnchanged">
        <ColumnInfo>
          <Column id="MU_CD" type="STRING" size="256"/>
          <Column id="TM_CD" type="STRING" size="256"/>
          <Column id="DATE_TYPE" type="STRING" size="256"/>
          <Column id="DT_FR" type="STRING" size="256"/>
          <Column id="DT_TO" type="STRING" size="256"/>
          <Column id="PO_TYPE" type="STRING" size="256"/>
          <Column id="PR_UPJANG" type="STRING" size="256"/>
          <Column id="PR_SABUN" type="STRING" size="256"/>
          <Column id="PR_DEPT_ID" type="STRING" size="256"/>
          <Column id="RC_UPJANG" type="STRING" size="256"/>
          <Column id="RC_UPJANG_NM" type="STRING" size="256"/>
          <Column id="GROUP_CODE" type="STRING" size="256"/>
          <Column id="CHK_CUST" type="STRING" size="256"/>
          <Column id="CHK_DEPT" type="STRING" size="256"/>
          <Column id="CHK_STATUS" type="STRING" size="256"/>
          <Column id="LINE_STATUS" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="DATE_TYPE">0</Col>
            <Col id="LINE_STATUS"> </Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_condi_detail" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PR_NUM" type="STRING" size="256"/>
          <Column id="DATE_TYPE" type="STRING" size="256"/>
          <Column id="DT_FR" type="STRING" size="256"/>
          <Column id="DT_TO" type="STRING" size="256"/>
          <Column id="CUSTCD" type="STRING" size="256"/>
          <Column id="SUBINV_CODE" type="STRING" size="256"/>
          <Column id="RC_DEPT_ID" type="STRING" size="256"/>
          <Column id="LINE_STATUS" type="STRING" size="256"/>
          <Column id="GROUP_CODE" type="STRING" size="256"/>
          <Column id="CHK_CUST" type="STRING" size="256"/>
          <Column id="CHK_DEPT" type="STRING" size="256"/>
          <Column id="CHK_STATUS" type="STRING" size="256"/>
          <Column id="CNT" type="BIGDECIMAL" size="256"/>
          <Column id="NEED_DATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_master">
        <ColumnInfo>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="PR_NUM" size="256" type="STRING"/>
          <Column id="CUSTCD" type="STRING" size="256"/>
          <Column id="CUSTNM" size="256" type="STRING"/>
          <Column id="PR_DATE" size="256" type="STRING"/>
          <Column id="CC_NM" size="256" type="STRING"/>
          <Column id="SUBINV_CODE" size="256" type="STRING"/>
          <Column id="SUBINV_NAME" size="256" type="STRING"/>
          <Column id="ITEM_TITLE" size="256" type="STRING"/>
          <Column id="TYPE_NAME" size="256" type="STRING"/>
          <Column id="AMT" size="22" type="BIGDECIMAL"/>
          <Column id="VAT" size="22" type="BIGDECIMAL"/>
          <Column id="TOT" size="22" type="BIGDECIMAL"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
          <Column id="LINE_STATUS" size="256" type="STRING"/>
          <Column id="PR_SABUN" size="256" type="STRING"/>
          <Column id="PR_APPROVE_FLAG" size="256" type="STRING"/>
          <Column id="PO_TYPE" size="256" type="STRING"/>
          <Column id="NEED_DATE" size="256" type="STRING"/>
          <Column id="PR_DEPT_ID" size="256" type="STRING"/>
          <Column id="RC_UPJANG" size="256" type="BIGDECIMAL"/>
          <Column id="CLOSE_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_detail">
        <ColumnInfo>
          <Column id="ITEM_CODE" size="256" type="STRING"/>
          <Column id="ITEM_NAME" size="256" type="STRING"/>
          <Column id="ITEM_SIZE" size="256" type="STRING"/>
          <Column id="PR_SABUN" type="STRING" size="256"/>
          <Column id="PO_UOM" size="256" type="STRING"/>
          <Column id="TAX_CODE" size="256" type="STRING"/>
          <Column id="PR_REMARK" size="256" type="STRING"/>
          <Column id="NEED_DATE" size="256" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="PR_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="PO_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="PR_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="256" type="STRING"/>
          <Column id="SUBINV_NAME" size="256" type="STRING"/>
          <Column id="CC_NM" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
          <Column id="PR_ID" size="256" type="STRING"/>
          <Column id="PR_DATE" size="256" type="STRING"/>
          <Column id="PO_TYPE" size="256" type="STRING"/>
          <Column id="DML" size="256" type="STRING"/>
          <Column id="LINE_STATUS" size="256" type="STRING"/>
          <Column id="CUSTNM" size="256" type="STRING"/>
          <Column id="SCHOOL_YN" size="1" type="STRING"/>
          <Column id="PR_NUM" size="256" type="STRING"/>
          <Column id="ORG_PR_NUM" type="STRING" size="256"/>
          <Column id="APPROVE_NUM" type="STRING" size="256"/>
          <Column id="RC_UPJANG" size="22" type="BIGDECIMAL"/>
          <Column id="RC_UPJANG_NM" type="STRING" size="256"/>
          <Column id="CONTRACT_TABLE" size="256" type="STRING"/>
          <Column id="MAX_LINE_STATUS" type="STRING" size="256"/>
          <Column id="IMG_YN" type="STRING" size="256"/>
          <Column id="D_DAY" type="STRING" size="256"/>
          <Column id="MD_NAME" type="STRING" size="256"/>
          <Column id="LT_REMARK" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cbo_potype">
        <ColumnInfo>
          <Column id="PO_TYPE" type="STRING" size="18"/>
          <Column id="PO_TYPE_NM" type="STRING" size="100"/>
          <Column id="D_DAY" type="STRING" size="83"/>
          <Column id="D_DAYS" type="BIGDECIMAL" size="5"/>
          <Column id="D_TIMES" type="BIGDECIMAL" size="5"/>
          <Column id="REMARK" type="STRING" size="100"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_expt_upjang_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="GROUP_NAME" type="STRING" size="100"/>
          <Column id="GROUP_CODE" type="STRING" size="50"/>
          <Column id="CODE" type="STRING" size="50"/>
          <Column id="CODE_NAME" type="STRING" size="500"/>
          <Column id="CONTENTS" type="STRING" size="300"/>
          <Column id="SORT_SEQ" type="BIGDECIMAL" size="39"/>
          <Column id="SYSTEM_YN" type="STRING" size="1"/>
          <Column id="SET1" type="STRING" size="100"/>
          <Column id="SET2" type="STRING" size="100"/>
          <Column id="SET3" type="STRING" size="100"/>
          <Column id="SET4" type="STRING" size="100"/>
          <Column id="SET5" type="STRING" size="100"/>
          <Column id="REMARK" type="STRING" size="300"/>
          <Column id="USE_YN" type="STRING" size="1"/>
          <Column id="ATTR01" type="STRING" size="300"/>
          <Column id="ATTR02" type="STRING" size="300"/>
          <Column id="ATTR03" type="STRING" size="300"/>
          <Column id="ATTR04" type="STRING" size="300"/>
          <Column id="ATTR05" type="STRING" size="300"/>
          <Column id="ATTR06" type="STRING" size="300"/>
          <Column id="ATTR07" type="STRING" size="300"/>
          <Column id="ATTR08" type="STRING" size="300"/>
          <Column id="ATTR09" type="STRING" size="300"/>
          <Column id="ATTR10" type="STRING" size="300"/>
          <Column id="CUSER" type="STRING" size="20"/>
          <Column id="CDATE" type="DATETIME" size="7"/>
          <Column id="UUSER" type="STRING" size="20"/>
          <Column id="UDATE" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_line_status" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="GROUP_NAME" type="STRING" size="100"/>
          <Column id="GROUP_CODE" type="STRING" size="50"/>
          <Column id="CODE" type="STRING" size="50"/>
          <Column id="CODE_NAME" type="STRING" size="500"/>
          <Column id="CONTENTS" type="STRING" size="300"/>
          <Column id="SORT_SEQ" type="BIGDECIMAL" size="39"/>
          <Column id="SYSTEM_YN" type="STRING" size="1"/>
          <Column id="SET1" type="STRING" size="100"/>
          <Column id="SET2" type="STRING" size="100"/>
          <Column id="SET3" type="STRING" size="100"/>
          <Column id="SET4" type="STRING" size="100"/>
          <Column id="SET5" type="STRING" size="100"/>
          <Column id="REMARK" type="STRING" size="300"/>
          <Column id="USE_YN" type="STRING" size="1"/>
          <Column id="ATTR01" type="STRING" size="300"/>
          <Column id="ATTR02" type="STRING" size="300"/>
          <Column id="ATTR03" type="STRING" size="300"/>
          <Column id="ATTR04" type="STRING" size="300"/>
          <Column id="ATTR05" type="STRING" size="300"/>
          <Column id="ATTR06" type="STRING" size="300"/>
          <Column id="ATTR07" type="STRING" size="300"/>
          <Column id="ATTR08" type="STRING" size="300"/>
          <Column id="ATTR09" type="STRING" size="300"/>
          <Column id="ATTR10" type="STRING" size="300"/>
          <Column id="CUSER" type="STRING" size="20"/>
          <Column id="CDATE" type="DATETIME" size="7"/>
          <Column id="UUSER" type="STRING" size="20"/>
          <Column id="UDATE" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_popup_param" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="EXPT_UPJANG_YN" type="STRING" size="256"/>
          <Column id="APPROV_YN" type="STRING" size="256"/>
          <Column id="TYPE" type="STRING" size="256"/>
          <Column id="PR_SABUN" type="STRING" size="256"/>
          <Column id="PR_DEPT_ID" type="STRING" size="256"/>
          <Column id="PO_TYPE" type="STRING" size="256"/>
          <Column id="PO_TYPE_NM" type="STRING" size="256"/>
          <Column id="PR_UPJANG" type="STRING" size="256"/>
          <Column id="PR_UPJANG_NM" type="STRING" size="256"/>
          <Column id="RC_UPJANG" type="STRING" size="256"/>
          <Column id="RC_UPJANG_NM" type="STRING" size="256"/>
          <Column id="D_DAYS" type="BIGDECIMAL" size="128"/>
          <Column id="D_TIMES" type="BIGDECIMAL" size="128"/>
          <Column id="PR_NUM" type="STRING" size="256"/>
          <Column id="APPROVE_NUM" type="STRING" size="256"/>
          <Column id="PR_DATE" type="STRING" size="256"/>
          <Column id="NEED_DATE" type="STRING" size="256"/>
          <Column id="SUBINV_CODE" type="STRING" size="256"/>
          <Column id="SORT_TYPE" type="STRING" size="256"/>
          <Column id="STATUS" type="STRING" size="256"/>
          <Column id="LINE_STATUS" type="STRING" size="256"/>
          <Column id="REASON_CD" type="STRING" size="256"/>
          <Column id="PR_REASON" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_tax">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">100</Col>
            <Col id="CODE_NAME">과세</Col>
          </Row>
          <Row>
            <Col id="CODE">210</Col>
            <Col id="CODE_NAME">면세</Col>
          </Row>
          <Row>
            <Col id="CODE">220</Col>
            <Col id="CODE_NAME">영세</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_common">
        <ColumnInfo>
          <Column id="code" size="256" type="STRING"/>
          <Column id="codename" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="pdiv_INFO_ed_D_DAYS_value" compid="pdiv_INFO.ed_D_DAYS" propid="value" datasetid="ds_cbo_potype" columnid="D_DAY"/>
      <BindItem id="pdiv_INFO_ed_CONTRACT_FLAG_value" compid="pdiv_INFO.ed_CONTRACT_FLAG" propid="value" datasetid="ds_cbo_potype" columnid="REMARK"/>
      <BindItem id="item7" compid="pdiv_INFO.sta_detail07" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item0" compid="pdiv_INFO.sta_detail00" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item5" compid="chk_cust" propid="value" datasetid="ds_condi" columnid="CHK_CUST"/>
      <BindItem id="item6" compid="chk_dept" propid="value" datasetid="ds_condi" columnid="CHK_DEPT"/>
      <BindItem id="item8" compid="chk_status" propid="value" datasetid="ds_condi" columnid="CHK_STATUS"/>
      <BindItem id="item9" compid="rdo_dtType" propid="value" datasetid="ds_condi" columnid="DATE_TYPE"/>
      <BindItem id="item10" compid="msk_start_date" propid="value" datasetid="ds_condi" columnid="DT_FR"/>
      <BindItem id="item11" compid="msk_end_date" propid="value" datasetid="ds_condi" columnid="DT_TO"/>
      <BindItem id="item12" compid="cbo_potype" propid="value" datasetid="ds_condi" columnid="PO_TYPE"/>
      <BindItem id="item1" compid="cbo_line_status" propid="value" datasetid="ds_condi" columnid="LINE_STATUS"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
 ******************************************************************************************
 * 시스템구분   : 구매관리 / 신청관리 / 구매신청
 * 프로그램명   : FSP00030E
 * 기      능   : 구매신청
 * 작  성  자   : 정영철
 * 작성  일자   : 2015-06-04
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
 
/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/ 
include "U_lib::lib_conversionCom.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/ 
var bTypeOpenYN 		= false;
var fv_prFlag			="";
var fv_poClosingFlag	="";
var fv_type = "";
var fv_addApprovYn = "";	//추가구매승인여부
/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 로드시 이벤트
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{
	
	gfn_formOnLoad(this);

	//alert('10');
	fsp_init(this);
	
	//alert('11');
	fn_PoCommon(); 
	//alert('12');
	
	fn_init();
}

function fn_init()
{
	// 날짜 셋팅
    var f_CurrDate 	= fn_CurrDateWeek();
	msk_start_date.value  = f_CurrDate;			
	msk_end_date.value  = f_CurrDate;
	
	edt_tm.applyAuthLevel(cbo_mu);
	edt_upjang.applyAuthLevel(edt_tm);
			
	grd_mst.setFormatColProperty(2,"size",0);
	//pdiv_INFO.position.left = 424; pdiv_INFO.position.top = 63;
	
	// 공통코드
	v_ds = fn_common_code("'FS0125','FM0037'","","","all", "Y");
		
	// 추가구매승인예외 사업장코드
	v_fil_cond = "GROUP_CODE == 'FS0125'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_expt_upjang_list,v_ds.name);
	
	
	// 진행상태코드
	v_fil_cond = "GROUP_CODE == 'FM0037' && (SET1 == 'FS' || CODE_NAME == '전체')";
	v_ds.filter(v_fil_cond);
	CopyF(ds_line_status,v_ds.name);
	
	
	ds_condi.setColumn(0, "PR_UPJANG"	, g_Upjang);
	ds_condi.setColumn(0, "PR_SABUN"	, g_EmpNo);
	ds_condi.setColumn(0, "PR_DEPT_ID"	, g_Deptid);
	ds_condi.setColumn(0, "GROUP_CODE"	, "FM0037");
	cbo_line_status.index = 0;
	
	grd_mst.formatid = "Default"
		
	//초기 포커스 셋팅
	cbo_mu.setFocus();
	
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 메인 조회
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{	
	var sSvcID;			// 서비스 ID
	var sUrl;			// jsp 경로
	var sInDs;			// 입력 데이터셋
	var sOutDs;			// 출력 데이터셋
	var sArg;			// 추가 파라미터
	var sCallFunc;		// 콜백함수명
	
	fsp_clear(this);	// Action 호출 정보 초기화하기
	
	// 입력 데이터셋 셋팅
	sSvcID		= "SEARCH";
	sUrl		= "U_svc::" + "fs/fsp/FSP00030E_T001.jsp";
	sInDs		= "ds_condi=ds_condi";
	sOutDs		= "ds_master=ds_master";
	sCallFunc 	= "fn_transation_callback";
	
	sArg        = " g_Mu_Cd="         + wrapQuote(g_Mu_Cd);
	
	// 유효성 체크
	if(!fn_transation_validation(sSvcID)){return false;}
	
	// 데이터셋 초기화
	ds_master.clearData();
	ds_detail.clearData();
	
	// 버튼 초기화
	div_detail.btn_delete.enable = false;
	div_detail.btn_update.enable = false;
	
	// 상세 초기화
	div_detail.edt_prNum.value      = "";	// 신청번호
	div_detail.edt_poTypeNm.value   = "";	// 구매유형
	div_detail.msk_prDate.value     = "";	// 신청일
	div_detail.edt_applNm.value     = "";	// 신청자
	div_detail.msk_applAmt.value    = "";	// 신청금액
	div_detail.edt_lineStaus.value  = "";	// 진행상태
	
	// 트랜잭션
	jsp_transaction(this, sSvcID, sUrl, sInDs, sOutDs, sArg, sCallFunc, true, false, false);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 구매내역 상세 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchDetail()
{	
	var sSvcID;			// 서비스 ID
	var sUrl;			// jsp 경로
	var sInDs;			// 입력 데이터셋
	var sOutDs;			// 출력 데이터셋
	var sArg;			// 추가 파라미터
	var sCallFunc;		// 콜백함수명
	
	var nRow;
	ds_condi_detail.clearData();
	nRow = ds_condi_detail.addRow();
	
	// 경로 설정
	sSvcID = "DETAIL";
	sUrl   = "U_svc::" + "fs/fsp/FSP00030E_T002.jsp";
	
	// 데이터셋 설정
	sInDs  = "ds_condi_detail=ds_condi_detail";
	sOutDs = "ds_detail=ds_detail";
	
	// 조회 조건값 설정
	ds_condi_detail.setColumn(nRow, "PR_NUM"		, ds_master.getColumn(ds_master.rowposition, "PR_NUM")	);		// 신청번호
	ds_condi_detail.setColumn(nRow, "DATE_TYPE"		, rdo_dtType.value										);		// 날짜구분
	ds_condi_detail.setColumn(nRow, "DT_FR"			, msk_start_date.value									);		// 시작일자
	ds_condi_detail.setColumn(nRow, "DT_TO"			, msk_end_date.value									);		// 종료일자
	ds_condi_detail.setColumn(nRow, "CUSTCD"		, ds_master.getColumn(ds_master.rowposition, "CUSTCD"		));		// 거래처코드
	ds_condi_detail.setColumn(nRow, "LINE_STATUS"	, ds_master.getColumn(ds_master.rowposition, "LINE_STATUS"	));		// 진행상황 
	ds_condi_detail.setColumn(nRow, "SUBINV_CODE"	, ds_master.getColumn(ds_master.rowposition, "SUBINV_CODE"	));
	ds_condi_detail.setColumn(nRow, "GROUP_CODE"	, "FM0037"								);		// 공통그룹코드
	ds_condi_detail.setColumn(nRow, "CHK_CUST"		, chk_cust.value						);		// 신청번호
	ds_condi_detail.setColumn(nRow, "CHK_DEPT"		, chk_dept.value						);		// 신청번호
	ds_condi_detail.setColumn(nRow, "CHK_STATUS"	, chk_status.value						);		// 신청번호
	ds_condi_detail.setColumn(nRow, "NEED_DATE"		, ds_master.getColumn(ds_master.rowposition, "NEED_DATE"));		// 입고일자
	//ds_condi_detail.setColumn(nRow, "CNT"		    , ds_detail.rowcount);// 자재건수
	
	if(chk_dept.value == "Y"){
		ds_condi_detail.setColumn(nRow, "RC_DEPT_ID"	, ds_master.getColumn(ds_master.rowposition, "RC_DEPT_ID"));		// 입고부서아이디
	}
	
	if(!fn_transation_validation(sSvcID)){return false;}
		
	// 콜백함수 지정
	sCallFunc = "fn_transation_callback";

	jsp_transaction(this, sSvcID, sUrl, sInDs, sOutDs, sArg, sCallFunc, false, false, false);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 구매유형코드 조회
 *---------------------------------------------------------------------------------------------*/
function fn_search_potype()
{
	fsp_clear(this);
	
	var sSvcID;			// 서비스 ID
	var sUrl;			// jsp 경로
	var sInDs;			// 입력 데이터셋
	var sOutDs;			// 출력 데이터셋
	var sArg;			// 추가 파라미터
	var sCallFunc;		// 콜백함수명
	
	sSvcID    = "PO_TYPE_SEARCH";
	sUrl      = "U_svc::" + "fs/fsp/FSP00030E_T004.jsp";
	sInDs     = "";
	sOutDs    = "ds_cbo_potype=ds_out";
	sCallFunc = "fn_transation_callback";
	
	sArg = "MU_CD="+ cbo_mu.getMuCode();
	
	// 유효성 체크
	if(!fn_transation_validation(sSvcID)){return false;}
	
	ds_cbo_potype.clearData();
	// 트랜잭션
	jsp_transaction(this, sSvcID, sUrl, sInDs, sOutDs, sArg, sCallFunc, false, false, true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 추가구매승인여부체크
 *---------------------------------------------------------------------------------------------*/
function fn_search_approve(sUpjang)
{
	var sSvcID;			// 서비스 ID
	var sUrl;			// jsp 경로
	var sInDs;			// 입력 데이터셋
	var sOutDs;			// 출력 데이터셋
	var sArg;			// 추가 파라미터
	var sCallFunc;		// 콜백함수명
	
	sSvcID    = "APPROVE_YN";
	sUrl      = "U_svc::" + "fs/fsp/FSP00030E_S001.jsp";
	sInDs     = "";
	sOutDs    = "ds_cbo_potype=ds_out";
	sCallFunc = "fn_transation_callback";
	
	sArg = "UPJANG="+ sUpjang;
	
	// 트랜잭션
	jsp_transaction(this, sSvcID, sUrl, sInDs, sOutDs, sArg, sCallFunc, false, false, true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신청서 삭제
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{	
	var sSvcID;			// 서비스 ID
	var sUrl;			// jsp 경로
	var sInDs;			// 입력 데이터셋
	var sOutDs;			// 출력 데이터셋
	var sArg;			// 추가 파라미터
	var sCallFunc;		// 콜백함수명
	
	// 경로 설정
	sSvcID = "DELETE";
	sUrl   = "U_svc::" + "fs/fsp/FSP00030E_T008.jsp";
	
	// 데이터셋 설정
	//sInDs  = "dsPoType=dsPoType dsPoLineStatus=dsPoLineStatus";
	sInDs  = "";
	sOutDs = "";
	
	// 파라메터 설정
	sArg  = "p_PrNum="          + wrapQuote(div_detail.edt_prNum.value);
	sArg += " p_PoType="        + wrapQuote(ds_detail.getColumn(0, "PO_TYPE"));
	sArg += " p_NeedDate="      + wrapQuote(ds_detail.getColumn(0, "NEED_DATE"));
	sArg += " p_SubinvCode="    + wrapQuote(ds_detail.getColumn(0, "SUBINV_CODE"));
	sArg += " g_EmpNo="         + wrapQuote(g_EmpNo);
	sArg += " p_RcUpjang="      + wrapQuote(ds_detail.getColumn(0, "RC_UPJANG"));
	sArg += " p_LineStatus="    + wrapQuote(div_detail.edt_lineStaus.value);
	sCallFunc = "fn_transation_callback";
	
	if(!fn_transation_validation(sSvcID)) return;

	jsp_transaction(this, sSvcID, sUrl, sInDs, sOutDs, sArg, sCallFunc, false, false, false);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 콜백함수
 *---------------------------------------------------------------------------------------------*/
function fn_transation_callback(nErrorCode, sErrorMag, sSvcID)
{
	var sResult = "";
	var sMsg    = "";
	if(nErrorCode != 0) {return ;}
	
	switch(sSvcID){
		
		case "PO_TYPE_SEARCH" :	// 구매유형
			var nRow = ds_cbo_potype.insertRow(0);
			ds_cbo_potype.setColumn(nRow, "PO_TYPE", "%");
			ds_cbo_potype.setColumn(nRow, "PO_TYPE_NM", "전체");
			cbo_potype.index = 0;
			break;
			
		case "SEARCH" :	// 메인조회
			if(chk_dept.value == "Y"){
				grd_mst.setCellProperty('Head',4,"text","검수부서");
			}else{
				grd_mst.setCellProperty('Head',4,"text","신청부서");
			}
			
			if(chk_cust.value == "Y"){
				grd_mst.formatid = "cust_list";
			}else{
				grd_mst.formatid = "Default";
			}
			
			if(chk_dept.value == "Y" || chk_cust.value == "Y" || rdo_dtType.value == "1"){
				div_detail.sta_info.visible = true;
			}else{
				div_detail.sta_info.visible = false;
			}
			
			if (ds_master.rowcount < 1){
				g_Message("EE","조회된 자료가 없습니다.");
			}
			
			// 구매신청 상태
			fv_type = "";
			break;
			
		case "DETAIL" : 
			
			var sLineStatus = div_detail.edt_lineStaus.value;
			var s_cnt = ds_detail.rowcount;
			var s_cnt2 = 0;
			
			
			//배송중일 경우 배송중인 건수 확인 2017.11.13 추가 김호석
			for (i=0;i<s_cnt;i++) {
				if (ds_detail.getColumn(i, "LINE_STATUS") == "DL") {
					s_cnt2 += 1;
				}
			}
			
			if(ds_master.getColumn(ds_master.rowposition, "CLOSE_YN") == "N")
			{
				if(sLineStatus == "003" || sLineStatus == "PD"){
					div_detail.btn_update.text   = "  취소재작성";
					div_detail.btn_delete.enable = false;
					div_detail.btn_update.enable = true;
					fv_type = "CANCEL_UPDATE";
				}else if(sLineStatus == "001"){
					div_detail.btn_update.text   = "  신청서수정";
					div_detail.btn_delete.enable = true;
					div_detail.btn_update.enable = true;
					fv_type = "TEMP_UPDATE";
				}else if(sLineStatus == "002" || sLineStatus == "PC"){
					div_detail.btn_update.text   = "  신청서수정";
					div_detail.btn_delete.enable = true;
					div_detail.btn_update.enable = true;
					fv_type = "UPDATE";
				}else{					
					//배송중일 경우 2017.11.13 추가 김호석
					if(sLineStatus == "DL") {
						//주문내역 전체가 배송중일 경우 2017.11.13 추가 김호석(취소/수정 모두 불가)
						if(s_cnt == s_cnt2) {
							div_detail.btn_delete.enable = false;
							div_detail.btn_update.enable = false;
					    //주문내역 중 일부가 배송중일경우 2017.11.13 추가 김호석(수정은 가능)
						} else {
						div_detail.btn_update.text   = "  신청서수정";
							div_detail.btn_delete.enable = false;
							div_detail.btn_update.enable = true;
							fv_type = "UPDATE";
						}						
					} else {
						div_detail.btn_delete.enable = false;
						div_detail.btn_update.enable = false;
						//div_detail.btn_update.enable = true;
					}
				}
			}
			else
			{
				div_detail.btn_delete.enable = false;
				div_detail.btn_update.enable = false;
			}
			
			//주문내역 중 배송중이 있는 경우 2017.11.13 추가 김호석(취소/수정 모두 불가)
			if(s_cnt2 > 0) {
				//주문내역 전체가 배송중일 경우 2017.11.13 추가 김호석(취소/수정 모두 불가)
				if(s_cnt == s_cnt2) {
					div_detail.btn_delete.enable = false;
					div_detail.btn_update.enable = false;
				//주문내역 중 일부가 배송중일경우 2017.11.13 추가 김호석(수정은 가능)
				} else {
					//alert("일부가 배송중");
					div_detail.btn_update.text   = "  신청서수정";
					div_detail.btn_delete.enable = false;
					div_detail.btn_update.enable = true;
					fv_type = "UPDATE";
				}						
			}
			
			//테스트용
			//div_detail.btn_update.text   = "  신청서수정";
			//div_detail.btn_delete.enable = true;
			//div_detail.btn_update.enable = true;
			//fv_type = "UPDATE";
			//테스트용

			break;
			
		case "DELETE" :
			if(nErrorCode == 0){
				g_Message("02","정상적으로 취소되었습니다.");
				fn_search();
			}else{
				g_Message("EE","저장 중 오류가 발생했습니다.\n 에러메세지:" + sErrorMag);
			}
			break;
		
		case "UPDATE" :
			break;
			
		case "APPROVE_YN" :	// 추가구매승인여부
			ds_popup_param.setColumn(0, "APPROV_YN", fv_addApprovYn); 		
			break;
		
	}
}

/*----------------------------------------------------------------------------------------------
 * 함  수  명   : fn_transation_validation()
 * 기      능   : 조회 전 유효성체크
*----------------------------------------------------------------------------------------------*/
function fn_transation_validation(sSvcID)
{
	switch(sSvcID)
	{
		case "PO_TYPE_SEARCH" :	// 구매유형 유효성 체크
			break;
			
		case "SEARCH" :		// 메인조회 유효성 체크			
			
			if(!mfn_Chk_Obj_MustInput(msk_start_date)) 	return false;  	// 시작일 	
			if(!mfn_Chk_Obj_MustInput(msk_end_date)) 	return false; 	// 종료일
			if(!fn_dateBetweenCheck(msk_start_date, msk_end_date)) {	// 시작일 종료일 체크
				return false;
			}
			if (G_fn_CalcMonth(msk_start_date.value, msk_end_date.value) > 2){
				g_Message("EE", "※ 동일월 내에서만 조회가 가능합니다.");
				msk_end_date.setFocus();
				return false;
			}
			break;
		case "NEW" :
		
			mfn_GetSystemWorkCheck("PO");
			if (ds_common.getColumn(0, 0) == "Y")
			{
				g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
				return false; 
			}					
		
			if(cbo_potype.value == "%" ){
				g_Message("04"," ※ 구매유형을 선택하세요.");
				cbo_potype.class = "cmb_WF_Error";
				cbo_potype.setFocus();
				return false;
			}
			cbo_potype.class = "";
			break;
			
		case "PRINT" :
			if(!mfn_Chk_Obj_MustInput(msk_start_date)) 	return false;  	// 시작일 	
			if(!mfn_Chk_Obj_MustInput(msk_end_date)) 	return false; 	// 종료일
			if(!fn_dateBetweenCheck(msk_start_date, msk_end_date)) 			// 시작일 종료일 체크
			
			if(ds_detail.rowcount < 1){
				g_Message("04"," ※ 구매신청 상세내역을 조회후 출력하세요!");
				return false;
			}
			break;
			
		case "DELETE" :
			
			mfn_GetSystemWorkCheck("PO");
			if (ds_common.getColumn(0, 0) == "Y")
			{
				g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
				return false; 
			}			
						
			var nIdx = ds_cbo_potype.findRowExpr("PO_TYPE=='" + ds_detail.getColumn(ds_detail.rowposition,"PO_TYPE")+"'");
		
			// 신청서 재작성&수정시 수정가능한 시간 체크
			if(!fn_CheckDateTime(nIdx, "DELETE")) return;
			
			//결의 이상의 작업이 진행되었는지 확인
			if(!fn_CheckPoYN(ds_detail.getColumn(ds_detail.rowposition, "ORG_PR_NUM"))) return false;
			break;
			
		case "DETAIL" :
			if(gfn_isNull(ds_condi_detail.getColumn(0, "PR_NUM"))) return false;
			//if(gfn_isNull(ds_condi_detail.getColumn(0, "CUSTCD"))) return false;
			if(gfn_isNull(ds_condi_detail.getColumn(0, "SUBINV_CODE"))) return false;
			if(gfn_isNull(ds_condi_detail.getColumn(0, "LINE_STATUS")))
			{
				g_Message("04"," ※ 유효하지 않은 구매신청내역 입니다.");
				return false;
			}
			
			break;
	}

    return true;
}

/************************************************************************************************
 * 공통 버튼 별 클릭 이벤트
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 함  수  명   : fn_Help()
 * 기      능   : [도움말버튼] 도움말
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
	var pArr1 = gfn_split(this.name,"::");
	var pArr2 = gfn_split(pArr1[1],".");
	var strFileURL = g_ServerURL + "help/" + pArr2[0] + ".ppt";
	system.execBrowser(strFileURL);
}

function fn_Close()
{
	this.close();
}

/************************************************************************************************
 * 화면 버튼 별 클릭 이벤트
************************************************************************************************/
function fn_Btn_OnclickEvant(obj:Button,  e:ClickEventInfo)
{
	var sEvntNm = obj.name;
	var sResult = "";
	
	switch(sEvntNm)
	{
		case "btn_new" :	// 신규
			if(!fn_transation_validation("NEW")) return;
			
			mfn_GetSystemWorkCheck("PO");
			if (ds_common.getColumn(0, 0) == "Y")
			{
				g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
				return false; 
			}			
			//alert(ds_condi.getColumn(0,"PR_UPJANG"));
			//alert(ds_condi.getColumn(0,"RC_UPJANG"));
			
			fn_OpenFSP00030V("NEW");
			break;
		
		case "btn_print1" :	// 신청서(건벌)
			fn_Print1();
			break;
			
		case "btn_print2" :	// 신청서(일별)
			fn_Print2();
			break;
			
		case "btn_delete"   :	//t신청서 삭제
		
			mfn_GetSystemWorkCheck("PO");
			if (ds_common.getColumn(0, 0) == "Y")
			{
				g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
				return false; 
			}	
					
			if(ds_detail.getColumn(ds_detail.rowposition,"NEED_DATE") < "20080701"){
				g_Message("EE","2008년7월1일 이전 신청데이터는 IFIS에서 삭제할 수 없습니다.");
				return false;
			}
			
			if(g_Upjang != ds_detail.getColumn(0, "RC_UPJANG"))
			{
				g_Message("EE", "구매신청한 업장계정이 아니라 삭제가 불가합니다.\n전산관리자 문의해 주세요.");
				return false;
			}
			
			var nIdx = ds_cbo_potype.findRowExpr("PO_TYPE=='" + ds_detail.getColumn(ds_detail.rowposition,"PO_TYPE")+"'");
			
			// 신청서 재작성&수정시 수정가능한 시간 체크
			if(!fn_CheckDateTime(nIdx, "")) return;
			
			sResult = g_Confirm("04", "취소된 신청서는 복원되지 않습니다. \n\n" +" 작업을 계속하시겠습니까?" );
			if (!sResult){
				return;
			}else{
				fn_delete();
			}
			
			break;
			
		case "btn_update"	:	// 신청서 수정

			mfn_GetSystemWorkCheck("PO");
			if (ds_common.getColumn(0, 0) == "Y")
			{
				g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
				return false; 
			}				
			
			if(ds_detail.getColumn(ds_detail.rowposition,"NEED_DATE") < "20080701"){
				g_Message("EE","2008년7월1일 이전 신청데이터는 IFIS에서 수정할 수 없습니다.");
				return;
			}
			
			fn_OpenFSP00030V(fv_type);
			break;
	}

}

/************************************************************************************************
 * 화면 컴퍼넌트 이벤트 영역
************************************************************************************************/

/*----------------------------------------------------------------------------------------------
 * 설명      : 메인 그리드 셀 더블 클릭시 이벤트
 *---------------------------------------------------------------------------------------------*/
function grd_mst_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
	if(ds_master.rowcount < 1) return;
	if(gfn_length(ds_master.getColumn(ds_master.rowposition,"PR_NUM"))== 0) return;
	
	div_detail.edt_prNum.value      = ds_master.getColumn(e.row, "PR_NUM");			// 신청번호
	div_detail.edt_poTypeNm.value   = ds_master.getColumn(e.row, "TYPE_NAME");		// 구매유형
	div_detail.msk_prDate.value     = ds_master.getColumn(e.row, "PR_DATE");		// 신청일
	div_detail.edt_applNm.value     = ds_master.getColumn(e.row, "PR_SABUN");		// 신청자
	div_detail.msk_applAmt.value    = ds_master.getColumn(e.row, "AMT");			// 신청금액
	div_detail.edt_lineStaus.value  = ds_master.getColumn(e.row, "LINE_STATUS");	// 진행상태
	
	fn_searchDetail();
}

/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
	1. Function    : fn_dateBetweenCheck
	2. Description : 기간 달력 시작일 종료일 체크
	3. Arguments   : objFr-시작일 컴퍼넌트, objTo-종료일 컴퍼넌트
	4. History     : 2008. 02. 04 - 최초작성
	                 2015. 06. 03 - 고도화
 *---------------------------------------------------------------------------------------------*/
function fn_dateBetweenCheck(objFr, objTo)
{
	var sDtFr = objFr.value;	// 시작일
	var sDtTo = objTo.value;	// 종료일
	
	if(sDtFr > sDtTo){
		gfn_alert("msg.err.validator.date.great", "");
		objTo.value = objFr.value;
		objFr.setFocus();
		return false;
	}
	return true;
}


/*
 ******************************************************************************************
 * 함  수  명   : fn_CheckPoYN()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 신청서 수정 중 결의 여부 점검
 * 작  성  자   : 김동표
 * 작성  일자   : 2008-01-31
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
*/
var v_ItemName;
function fn_CheckPoYN(strPrNum)
{
	var strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc;
	
	// 경로 설정
	strSvcID = "CHECK_PO";
	strURL   = "U_svc::" + "fs/fsp/FSP00032E_T008.jsp";
	
	// 데이터셋 설정
	strInDatasets = "dsPoLineStatus=dsPoLineStatus";
	strOutDatasets = "";
	
	// 파라메터 설정
	strArgument  = "p_PrNum=" + wrapQuote(strPrNum);
	
	// 콜백함수 지정
	strCallbackFunc = "";

	http.Sync = true;
	Transaction(strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc); 
	http.Sync = false;
	
	var strMsg;
	
	if(gfn_length(v_ItemName)!= 0)
	{
		strMsg = " ※ 작업 불가!! 작업이 불가한 자재가 포함되어 있습니다.\n";
		strMsg+= "    불가 자재명 : " + v_ItemName;
		g_Message("EE",strMsg);
		return false;
	}
	
	return true;
}

// 신규& 수정 버튼 이벤트
function fn_OpenFSP00030V(sType)
{
	var sRet;
	var sPoType = cbo_potype.value;
	var nRow = ds_cbo_potype.findRowExpr("PO_TYPE=='"+sPoType+"'");
	
	if(nRow < 0){
		g_Message("EE","구매유형정보 오류! 전산관리자 문의."); return;		
	}
	ds_cbo_potype.rowposition = nRow; 
	cbo_potype.value = sPoType;
	
	ds_popup_param.clearData();
	ds_popup_param.addRow();
	
	fn_expt_upjang_check();
	
	if(sType == "NEW")
	{
		ds_popup_param.setColumn(0, "TYPE"			, sType);
		ds_popup_param.setColumn(0, "PO_TYPE"		, ds_cbo_potype.getColumn(ds_cbo_potype.rowposition,"PO_TYPE"  	));
		ds_popup_param.setColumn(0, "PO_TYPE_NM"	, ds_cbo_potype.getColumn(ds_cbo_potype.rowposition,"PO_TYPE_NM"));
		ds_popup_param.setColumn(0, "PR_SABUN"		, g_EmpNo);
		ds_popup_param.setColumn(0, "PR_DEPT_ID"	, g_Deptid);
		ds_popup_param.setColumn(0, "PR_UPJANG"		, g_Upjang);
		ds_popup_param.setColumn(0, "PR_UPJANG_NM"		, g_UpjangNm);
		ds_popup_param.setColumn(0, "RC_UPJANG"		, ds_condi.getColumn(0, "RC_UPJANG"));
		ds_popup_param.setColumn(0, "RC_UPJANG_NM"	, ds_condi.getColumn(0, "RC_UPJANG_NM"));
		ds_popup_param.setColumn(0, "D_DAYS"		, ds_cbo_potype.getColumn(ds_cbo_potype.rowposition,"D_DAYS"   ));
		ds_popup_param.setColumn(0, "D_TIMES"		, ds_cbo_potype.getColumn(ds_cbo_potype.rowposition,"D_TIMES"  ));
		ds_popup_param.setColumn(0, "PR_NUM"		, "");
	}
	else
	{
		if(sType == "CANCEL_UPDATE")	//003
		{
			if(ds_detail.getColumn(ds_detail.rowposition,"PO_TYPE") == "04")
			{
				g_Message("01","식단에 의한 구매신청의 경우 취소 후 '신규'로 동일 식단을 신청한 이력이 있을 경우 '취소재작성'시 중복 발주될 수 있습니다.\n신청이력을 확인해서 중복 여부를 판단 후\n작업하시기 바랍니다.");
			}
		}

		if(g_Upjang != ds_detail.getColumn(0, "RC_UPJANG"))
		{
			g_Message("EE", "구매신청한 업장계정이 아니라 수정이 불가합니다.\n전산관리자 문의해 주세요.");
			return false;
		}
		
		var nIdx = ds_cbo_potype.findRowExpr("PO_TYPE=='" + ds_detail.getColumn(ds_detail.rowposition,"PO_TYPE")+"'");
		
		// 신청서 재작성&수정시 수정가능한 시간 체크
		if(!fn_CheckDateTime(nIdx, sType)) return;
		
		//결의 이상의 작업이 진행되었는지 확인
		if(!fn_CheckPoYN(ds_detail.getColumn(ds_detail.rowposition, "ORG_PR_NUM"))) return false;
		
		ds_popup_param.setColumn(0, "TYPE"			, sType);
		ds_popup_param.setColumn(0, "PO_TYPE"		, ds_cbo_potype.getColumn(nIdx,"PO_TYPE"));		// 상세조회의 구매유형
		ds_popup_param.setColumn(0, "PO_TYPE_NM"	, ds_cbo_potype.getColumn(nIdx,"PO_TYPE_NM"));	// 상세조회의 구매유형명
		
		ds_popup_param.setColumn(0, "D_DAYS"		, ds_cbo_potype.getColumn(nIdx,"D_DAYS"));							// 구매유형의 D_DAYS
		ds_popup_param.setColumn(0, "D_TIMES"		, ds_cbo_potype.getColumn(nIdx,"D_TIMES"));							// 구매유형의 D_TIMES
		ds_popup_param.setColumn(0, "PR_SABUN"		, g_EmpNo);
		ds_popup_param.setColumn(0, "PR_DEPT_ID"	, g_Deptid);
		ds_popup_param.setColumn(0, "PR_UPJANG"		, g_Upjang);
		ds_popup_param.setColumn(0, "PR_UPJANG_NM"	, g_UpjangNm);
		ds_popup_param.setColumn(0, "PR_NUM"		, div_detail.edt_prNum.value);				                        // 상세조회의 구매번호
		ds_popup_param.setColumn(0, "APPROVE_NUM"	, ds_detail.getColumn(ds_detail.rowposition,"APPROVE_NUM"));		// 상세조회의 구매승인번호
		ds_popup_param.setColumn(0, "RC_UPJANG"		, ds_detail.getColumn(ds_detail.rowposition,"RC_UPJANG"));			// 상세조회의 구매업장
		ds_popup_param.setColumn(0, "RC_UPJANG_NM"	, ds_detail.getColumn(ds_detail.rowposition,"RC_UPJANG_NM"));		// 상세조회의 업장명
		if(sType == "CANCEL_UPDATE") {
			//취소재작성인 경우 신청일자를 현재날짜로 변경(최초 신청일로 되는 오류 수정) 2017.03.14 김호석 CH201703_00494
			ds_popup_param.setColumn(0, "PR_DATE"		, fn_CurrDateWeek());			// 상세조회의 신청일자
		} else {		
			ds_popup_param.setColumn(0, "PR_DATE"		, ds_detail.getColumn(ds_detail.rowposition,"PR_DATE"));			// 상세조회의 신청일자
		}
		//alert(fn_CurrDateWeek());
		ds_popup_param.setColumn(0, "NEED_DATE"		, ds_detail.getColumn(ds_detail.rowposition,"NEED_DATE"));			// 상세조회의 입고일자
		ds_popup_param.setColumn(0, "SUBINV_CODE"	, ds_detail.getColumn(ds_detail.rowposition,"SUBINV_CODE"));		// 상세조회의 창고코드 
		ds_popup_param.setColumn(0, "LINE_STATUS"	, div_detail.edt_lineStaus.value);		// 진행상태
	}
	
	sRet = gfn_dialog(sType, "U_FSP::FSP00031E.xfdl", "", "", "", "", "", "", "", "", "", false);
		
	if(sRet == "OK") fn_search();
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 신청서 재작성&수정시 수정가능한 시간 체크
 *---------------------------------------------------------------------------------------------*/
function fn_CheckDateTime(nIdx, sType)
{
	var sMsg 		= "";
	var sToday 		= fn_CurrDateWeek("ymdtm");
	var nDday 		= ds_cbo_potype.getColumn(nIdx,"D_DAYS");
	var nTime 		= ds_cbo_potype.getColumn(nIdx,"D_TIMES");
	var sNeedDate 	= ds_detail.getColumn(ds_detail.rowposition,"NEED_DATE");
	var sDateTime   = dateTime(gfn_addDate(gfn_subStr(sToday,0,8),toNumber(nDday)));
	var sPoName     = ds_cbo_potype.getColumn(nIdx,"PO_TYPE_NM");
	//alert(sNeedDate);
	//alert(sDateTime);
	
	if(nDday == "0") return true;
	
	if(dateTime(sNeedDate) < sDateTime)
	{
		if(sType = "DELETE"){
			sMsg  = " ※ 마감시간이 지난 신청서는 삭제가 불가합니다. \n\n";
		}else{
			sMsg  = " ※ 현재 입고일로는 신청서 수정이 불가합니다. \n\n";
		}
		
		sMsg += "    구 매  유 형 : " + sPoName + "\n";
		sMsg += "    현 재  시 간 : " + fn_FormatDateTime(sToday) + "\n";
		sMsg += "    신청가능일자 : " + fn_FormatDateTime(gfn_addDate(gfn_subStr(sToday,0,8),-1 * toNumber(nDday))) + " (D_DAY=" + nDday + "일" + nTime + "시) \n";
		g_Message("EE",sMsg);
		return false;
	}
	
	if(dateTime(sNeedDate) == dateTime(gfn_addDate(gfn_subStr(sToday,0,8),toNumber(nDday))))
	{
		if(toNumber(nTime) == 0) return true;
		
		if( toNumber(gfn_subStr(sToday,8,2)) >= toNumber(nTime))
		{
			if(sType = "DELETE"){
				sMsg  = " ※ 마감시간이 지난 신청서는 삭제가 불가합니다. \n\n";
			}else{
				sMsg  = " ※ 현재 시간은 신청서 수정이 불가합니다. \n\n";
			}
			sMsg  = " ※ 현재 시간은 신청서 수정이 불가합니다. \n\n";
			sMsg += "    구 매  유 형 : " + sPoName + "\n";
			sMsg += "    현 재  시 간 : " + fn_FormatDateTime(sToday) + "\n";
			sMsg += "    신청가능일시 : " + fn_FormatDateTime(gfn_addDate(gfn_subStr(sToday,0,8),-1 * toNumber(nDday))) + " " + nTime + "시 (D_DAY=" + nDday + "일" + nTime + "시) \n";
			g_Message("EE",sMsg);
			return false;
		}
	}
	
	return true;
}
 /*
 ******************************************************************************************
 * 함  수  명   : fn_Print1
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 신청서(건별)
 * 작  성  자   : 김동표
 * 작성  일자   : 2008-01-08
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
 function fn_Print1()
 {
 
	if(ds_detail.getCountNF() <= 0)
	{
		g_Message("04"," ※ 구매신청 상세내역을 조회후 출력하세요!");
		return;
	}
	
	//레포트에 전달할 파라메터 생성
	var arrParams	= SCReport.newParams ();
	
	if( gfn_subStr(div_detail.edt_prNum.value,0,2) == "PO" ){
 		// 비식자재 구매신청서(건별) 출력
 		SCReport.setParams (arrParams, SCReport.RPT_NAME, "/IFIS/FSP00090V_R02.ozr");
 	} else 	{
		// 식자재 구매신청서(건별) 출력
		SCReport.setParams (arrParams, SCReport.RPT_NAME, "/IFIS/FSP00090V_R01.ozr");
	}
	
	//출력 옵션 설정
	//-창 타이틀 (디폴트는 "ReportViewer")
	SCReport.setParams (arrParams, SCReport.RPT_TITLE, "구매신청서");

	//레포트에 맞게 전달되는 개발자 정의 파라미터
	SCReport.setParams (arrParams, "PARAM1", div_detail.edt_prNum.value);
	
	SCReport.setParams (arrParams, "zoom", 150);
	//--------------------------------------------------
	SCReport.viewReport (this, arrParams);
 }
 
 /*
 ******************************************************************************************
 * 함  수  명   : fn_Print2
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 신청서(일별)
 * 작  성  자   : 김동표
 * 작성  일자   : 2008-01-08
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
 function fn_Print2()
 {
	if(ds_detail.getCountNF() <= 0)
	{
		g_Message("04"," ※ 구매신청 상세내역을 조회후 출력하세요!");
		return;
	}

	//레포트에 전달할 파라메터 생성
	var arrParams	= SCReport.newParams ();
	
	if( gfn_subStr(div_detail.edt_prNum.value,0,2) == "PO" ){
 		// 비식자재 구매신청서(일별) 출력
 		SCReport.setParams (arrParams, SCReport.RPT_NAME, "/IFIS/FSP00090V_R04.ozr");
 	} else 	{
		// 식자재 구매신청서(일별) 출력
		SCReport.setParams (arrParams, SCReport.RPT_NAME, "/IFIS/FSP00090V_R03.ozr");
	}
	
	//출력 옵션 설정
	//-창 타이틀 (디폴트는 "ReportViewer")
	SCReport.setParams (arrParams, SCReport.RPT_TITLE, "구매신청서");

	//레포트에 맞게 전달되는 개발자 정의 파라미터
	SCReport.setParams (arrParams, "PARAM1", div_detail.edt_prNum.value);
	
	SCReport.setParams (arrParams, "zoom", 150);
	//--------------------------------------------------
	SCReport.viewReport (this, arrParams);
 }

/*
 ******************************************************************************************
 * 함  수  명   : fn_OpenPopupDiv()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 구매유형 팝업 오픈
 * 작  성  자   : 김동표
 * 작성  일자   : 2008-01-14
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
 function fn_OpenPopupDiv()
 {
	var nX = system.clientToScreenX(cbo_potype,0); // Popup Button의 화면상의 X좌표 얻어오기
	var nY = system.clientToScreenY(cbo_potype,cbo_potype.position.height);	// Popup Button의 화면상의 Y좌표 얻어오기	
	
	pdiv_INFO.trackPopup(nX, nY+3);
 }

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
function grd_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);	
}

function btn_INFO_OnClick(obj:Button, e:ClickEventInfo)
{
	if(bTypeOpenYN == false)
	{
		if(gfn_length(cbo_potype.value) > 0)
		{
			ds_cbo_potype.rowposition = cbo_potype.index;
			bTypeOpenYN = true;
			fn_OpenPopupDiv();
		}
	}
	else
	{
		pdiv_INFO.closePopup();
		bTypeOpenYN = false;
	}
}

/* 지원하지 않는 이벤트입니다.*/
function pdiv_INFO_OnCloseUp(obj,varReturn,bSelOk)
{
	bTypeOpenYN = false;
}

function FSP00030E_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e);
	//if ( (e.keycode == 13) && (e.fromreferenceobject == cbo_line_status)) fn_search();
}

function cbo_line_status_onkeydown(obj:Combo, e:KeyEventInfo)
{
	if (e.keycode == 13) fn_search();
}

function ds_condi_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	switch(e.columnid)
	{
		case "MU_CD" :
			fn_search_potype();
			break;
			
		case "TM_CD" :
			break;
		
		case "RC_UPJANG" :
			
			break;
			
		case "LINE_STATUS" :
			// 진행상활별 필터 적용
			if(gfn_isNull(e.newvalue))
			{
				ds_master.filter("");
			}
			else
			{
				ds_master.filter("LINE_STATUS == '"+ e.newvalue +"'");
			}
			break;
			
		
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 추가구매제외업장체크
 *---------------------------------------------------------------------------------------------*/
function fn_expt_upjang_check()
{
	var nCnt = 0;
	var sUpjang = g_Upjang;
		
	// 업장이 없으면 리턴
	if(gfn_isNull(sUpjang)) return;
	
	nCnt = ds_expt_upjang_list.getCaseCount("CODE == '" + sUpjang + "'");

	if(nCnt == 0)
	{
		fn_search_approve(sUpjang);	// 추가구매승인여부 조회
	}
	else
	{
		ds_popup_param.setColumn(0, "EXPT_UPJANG_YN", "Y");
	}
}


function fn_muChange(obj, event)
{
	edt_tm.setTmCode("");
	edt_upjang.setUpjangCode("");
}

function fn_tmChange(obj, data)
{
	edt_upjang.setUpjangCode("");
}

// 화면 사이즈 변경시 스플리터 최대값 최소값 변경
function FSP00030E_onsize(obj:Form, e:SizeEventInfo)
{
	var nSpt  = sp_line.position.y;
	var nForm = this.position.bottom;
	
	if(nForm -35 <  nSpt && nSpt > 153)
	{
		sp_line.position.y = nForm -35;
	}
	sp_line.max = this.position.bottom - 35;
	sp_line.min = 133;
}

// 구매시스템자재상세팝업
function div_detail_Grid0_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	SCSysIf.eprocPopup (SCSysIf.EPROC_ITEM_POPUP, ds_detail.getColumn(e.row, "ITEM_CODE"));
}

// 자재사진보기
function div_detail_Grid0_onexpandup(obj:Grid, e:GridMouseEventInfo)
{
	var sColumn = gfn_getCellColId(obj, e.col);
	
	if(sColumn == "ITEM_NAME")
	{
		gfn_dialog("", "U_FSP::FSP00000P.xfdl",{fv_itemCode: eval(obj.binddataset).getColumn(e.row, "ITEM_CODE")}, "", "", "", "", "", "", "", "", true);
	}
}

function cbo_potype_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	
	if ( e.postvalue == "96" ) {
		obj.style.color = "red";
	} else {
		obj.style.color = "#444444ff";
	}
}
]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="form" onload="form_onload" titletext="레시피관리 디비젼" position="absolute 0 0 1237 628" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static43" class="sta_WFDA_Labelbg" position="absolute 224 52 1222 105" anchor="left top right"/>
        <Static id="Static14" class="sta_WFDA_Labelbg" position="absolute 224 52 1222 79" anchor="left top right"/>
        <Static id="Static08" class="sta_WFDA_Labelbg" position="absolute 267 26 1222 53"/>
        <Static id="Static05" class="sta_WFDA_Labelbg" position="absolute 267 0 1222 27"/>
        <Div id="div_Material" taborder="22" url="U_FSR::FSR00024E.xfdl" asyncmode="false" scrollbars="none" anchor="left top right" position="absolute 0 358 1222 628" positiontype="position"/>
        <Static id="Static13" text="예상판매량" position="absolute 948 110 1014 131" anchor="top right"/>
        <Static id="Static16" text="판매가" position="absolute 1100 110 1138 131" anchor="top right"/>
        <MaskEdit enable="false" id="ed_EXPECT_SALE_QTY" mask="#,##0" taborder="18" value="MaskEdit0" position="absolute 1011 110 1091 131" anchor="top right"/>
        <MaskEdit enable="false" id="ed_SALE_PRICE" mask="#,##0" taborder="19" value="MaskEdit0" position="absolute 1142 110 1222 131" anchor="top right"/>
        <Button id="btn_RecipeElement" onclick="btn_RecipeElement_OnClick" taborder="23" position="absolute 1 337 113 358" class="btn_WF_Custom" image="" text="레시피영양성분"/>
        <Button id="btn_ratio" onclick="btn_ratio_OnClick" taborder="24" position="absolute 114 337 249 358" class="btn_WF_Custom" image="" text="레시피비율일괄변경"/>
        <ImageViewer stretch="fit" id="Image0" image="URL('theme://convertImages/img_NoImageBig.png')" onloaderror="Image0_OnLoadError" taborder="38" position="absolute 0 0 125 94"/>
        <Div id="divFSR00026E" taborder="26" text="Div0" url="U_FSR::FSR00026E.xfdl" visible="false" position="absolute 1021 337 1140 358" scrollbars="none"/>
        <Static id="Static03" text="기본&#10;정보" position="absolute 128 0 176 53" class="sta_WFDA_Label03"/>
        <Static id="Static04" text="레시피코드/명" position="absolute 175 0 268 27" class="sta_WFDA_Label01"/>
        <Static id="Static06" text="조 리 법 유 형" position="absolute 175 26 268 53" class="sta_WFDA_Label01"/>
        <Static id="Static12" text="레 시 피 분 류" position="absolute 590 0 694 27" class="sta_WFDA_Label01"/>
        <Static id="Static15" text="대표 영양성분" position="absolute 590 26 694 53" class="sta_WFDA_Label01"/>
        <Static id="Static31" text="레 시 피 유 형" position="absolute 916 0 1006 27" class="sta_WFDA_Label01"/>
        <Static id="Static33" text="주  재  료  군" position="absolute 916 26 1006 53" class="sta_WFDA_Label01"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="Combo8" innerdataset="ds_recipe_class" taborder="0" position="absolute 697 3 914 24"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="Combo0" innerdataset="ds_recipe_type" taborder="1" position="absolute 1009 3 1122 24"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="Combo5" innerdataset="ds_main_item_code1" taborder="4" position="absolute 1009 29 1122 50"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="Combo1" innerdataset="ds_resp_nut1" taborder="3" position="absolute 697 29 914 50"/>
        <Edit id="ed_MODE" taborder="32" tooltiptext="저장옵션(표준신규:표준수정:업장수정)" position="absolute 584 111 758 131" visible="false"/>
        <Edit id="ed_HALL_CLASS" taborder="30" tooltiptext="식당군" visible="false" position="absolute 328 30 342 50"/>
        <Edit id="ed_UPJANG" taborder="29" tooltiptext="업장" visible="false" position="absolute 309 30 323 50"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="Combo2" innerdataset="ds_cuisine_type" taborder="2" position="absolute 270 29 588 50"/>
        <Button id="btn_Hide_Search" onclick="btn_Hide_Search_OnClick" taborder="5" tabstop="false" text="조회조건&#10;보이기" position="absolute 1127 3 1219 49"/>
        <Static id="Static17" text="모양" position="absolute 175 52 268 79" class="sta_WFDA_Label01"/>
        <Static id="Static36" text="질감" position="absolute 175 78 268 105" class="sta_WFDA_Label01"/>
        <Static id="Static37" text="품질&#10;정보" position="absolute 128 52 176 105" class="sta_WFDA_Label03"/>
        <Static id="Static38" text="맛" position="absolute 423 52 457 79" class="sta_WFDA_Label01"/>
        <Static id="Static39" text="색" position="absolute 423 78 457 105" class="sta_WFDA_Label01"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="Combo9" innerdataset="ds_recipe_shape" taborder="6" position="absolute 270 55 421 76"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="Combo3" innerdataset="ds_recipe_taste" taborder="7" position="absolute 459 55 588 76"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="Combo7" innerdataset="ds_recipe_color" taborder="11" position="absolute 459 81 588 102"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="Combo4" innerdataset="ds_recipe_feel" taborder="10" position="absolute 270 81 421 102"/>
        <Static id="Static40" text="제공&#10;정보" position="absolute 590 52 630 105" class="sta_WFDA_Label03"/>
        <Static id="Static41" text="제공온도" position="absolute 629 52 694 79" class="sta_WFDA_Label01"/>
        <Static id="Static42" text="추천계절" position="absolute 629 78 694 105" class="sta_WFDA_Label01"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="Combo10" innerdataset="ds_recipe_temper" taborder="8" position="absolute 697 55 914 76"/>
        <Static id="Static44" text="중심온도체크" position="absolute 916 52 1007 79" class="sta_WFDA_Label01"/>
        <Static enable="false" id="Static6" position="absolute 1009 55 1068 76" class="sta_WFDA_Labelbg"/>
        <Static id="Static45" text="PHF" position="absolute 916 78 1007 105" class="sta_WFDA_Label01"/>
        <Static enable="false" id="Static35" position="absolute 1009 81 1068 102" class="sta_WFDA_Labelbg"/>
        <Static id="Static46" text="선호도" position="absolute 1070 78 1125 105" class="sta_WFDA_Label01"/>
        <Static id="Static47" text="찬   기" position="absolute 1070 52 1125 79" class="sta_WFDA_Label01"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" id="Combo12" innerdataset="ds_use_tool" type="filter" taborder="9" position="absolute 1127 55 1219 76"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" id="Combo6" innerdataset="ds_preper" type="filter" taborder="16" position="absolute 1127 81 1219 102"/>
        <Edit id="ed_ratio" maxlength="3" inputtype="number" taborder="25" visible="false" position="absolute 255 337 326 358" style="align:right;"/>
        <Static id="st_Ratio" text="(%)" visible="false" position="absolute 328 337 356 358"/>
        <Button id="btn_add" onclick="btn_add_OnClick" taborder="27" text="자재추가" position="absolute 1147 337 1222 358" class="btn_WF_Custom" image="" anchor="top right"/>
        <Grid autoenter="select" binddataset="ds_recipe_item" cellsizingtype="both" readonly="false" enable="true" id="grd_jajea" useinputpanel="false" oncellclick="grd_jajea_OnCellClick" oncelldblclick="grd_jajea_OnCellDblClick" onheadclick="grd_jajea_OnHeadClick" onkeydown="grd_jajea_OnKeyDown" onmousemove="grd_jajea_OnMouseOver" taborder="20" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 136 1222 332" selecttype="row" anchor="left top right" autofittype="col">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30"/>
                <Column size="0"/>
                <Column size="24"/>
                <Column size="90"/>
                <Column size="26"/>
                <Column size="367"/>
                <Column size="150"/>
                <Column size="40"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="133"/>
                <Column size="26"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="금&#10;지" wordwrap="word"/>
                <Cell col="2" rowspan="2" colspan="3" displaytype="text" text="자재코드"/>
                <Cell col="5" rowspan="2" displaytype="text" text="자재명"/>
                <Cell col="6" rowspan="2" displaytype="text" text="규격"/>
                <Cell col="7" rowspan="2" displaytype="text" text="구매&#10;단위"/>
                <Cell col="8" rowspan="2" displaytype="text" text="자재&#10;특성"/>
                <Cell col="9" rowspan="2" displaytype="text" text="1인소요량&#10;(g)"/>
                <Cell col="10" rowspan="2" displaytype="text" text="가식부량&#10;(g)"/>
                <Cell col="11" rowspan="2" displaytype="text" text="1인원가&#10;(원)"/>
                <Cell col="12" rowspan="2" colspan="2" displaytype="text" text="커팅규격"/>
                <Cell col="14" rowspan="2" displaytype="text" text="에너지&#10;(kcal)"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:left;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:RESTRICT_YN"/>
                <Cell col="2" displaytype="image" style="align: ;" text="URL('theme://images/new/grd_WF_ExpandImageX.png')"/>
                <Cell col="3" displaytype="text" style="align:left;background:EXPR(decode(RESTRICT_YN,'Y','#ffaa9cff',''));background2:EXPR(decode(RESTRICT_YN,'Y','#ffaa9cff',''));" text="bind:ITEM_CODE"/>
                <Cell col="4" displaytype="image" style="align:center;" text="expr:getRowType(currow)==2?&quot;URL('theme://Images/new/grd_WF_ExpandImage.png')&quot;:&quot;&quot;"/>
                <Cell col="5" displaytype="text" style="align:left;background:EXPR(decode(RESTRICT_YN,'Y','#ffaa9cff',''));background2:EXPR(decode(RESTRICT_YN,'Y','#ffaa9cff',''));" text="bind:ITEM_NAME"/>
                <Cell col="6" displaytype="text" style="align:left;" text="bind:ITEM_SIZE"/>
                <Cell col="7" displaytype="text" style="align:left;" text="bind:PO_UOM"/>
                <Cell col="8" displaytype="text" style="align:left;" text="bind:FEATURE_NAME"/>
                <Cell col="9" displaytype="number" edittype="text" editfilter="number" style="align:right;" text="bind:NEED_QTY" mask="#,##0.00"/>
                <Cell col="10" displaytype="number" style="align:right;" text="bind:EDIBLE_QTY"/>
                <Cell col="11" displaytype="number" style="align:right;" text="bind:PERSON_PRICE"/>
                <Cell col="12" displaytype="combo" edittype="combo" style="align:left;" text="bind:CUT_SPEC" combodataset="ds_recipe_cut_spec" combocodecol="CODE" combodatacol="CODE_NAME"/>
                <Cell col="13" displaytype="image" edittype="none" style="align:center;" text="URL('theme://Images\new\grd_WF_ExpandImage.png')"/>
                <Cell col="14" displaytype="number" style="align:right;" text="bind:CAL_CALC"/>
              </Band>
              <Band id="summary">
                <Cell colspan="9" displaytype="text" style="align:center;" text="합계"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:getSum('NEED_QTY')"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="expr:getSum('EDIBLE_QTY')"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:getSum('PERSON_PRICE')"/>
                <Cell col="12" displaytype="text" style="align:left;"/>
                <Cell col="13" displaytype="text" style="align:left;"/>
                <Cell col="14" displaytype="number" style="align:right;" expr="expr:getSum('CAL_CALC')"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="st_Display" position="absolute 18 99 105 112" style="color:#ffaa9cff;align:center middle;"/>
        <Static id="Static0" text="*원가는 조회 시점의 사업장 원가입니다." position="absolute 363 113 585 135" style="color:blue;"/>
        <Static id="Static2" text="최종수정일" position="absolute 800 110 866 131" anchor="top right"/>
        <MaskEdit enable="false" id="MaskEdit0" mask="@@@@-@@-@@" taborder="17" type="string" position="absolute 863 110 943 131" anchor="top right"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1222 0 1237 630" anchor="top right"/>
        <Static id="Static10" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 332 1208 337"/>
        <Static id="Static00" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 757 131 1207 136"/>
        <Static id="Static09" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 131 450 136"/>
        <Radio id="rdo_Detail" taborder="21" columncount="3" rowcount="0" index="0" innerdataset="ds_SubRadio" codecolumn="CD" datacolumn="NM" value="0" onitemchanged="rdo_Detail_OnChanged" position="absolute 102 115 312 136"/>
        <Static id="sta_WF_Title01" text="재료구성" class="sta_WF_Title01" position="absolute 0 118 90 136"/>
        <Static id="Static11" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 105 450 118" anchor="left top"/>
        <CheckBox id="chk_Dtlyn" taborder="12" text="봄" value="N" truevalue="Y" falsevalue="N" position="absolute 698 81 735 102" enable="false"/>
        <CheckBox id="Checkbox0" taborder="13" text="여름" value="N" truevalue="Y" falsevalue="N" position="absolute 746 81 790 102" enable="false"/>
        <CheckBox id="Checkbox1" taborder="14" text="가을" value="N" truevalue="Y" falsevalue="N" position="absolute 799 81 843 102" enable="false"/>
        <CheckBox id="Checkbox2" taborder="15" text="겨울" value="N" truevalue="Y" falsevalue="N" position="absolute 852 81 895 102" enable="false"/>
        <Static id="st_RECIPE_CD" position="absolute 270 3 340 24" class="sta_WFDA_Labelbg" style="color:red;"/>
        <Static id="st_RECIPE_NAME" class="sta_WFDA_Labelbg" position="absolute 342 3 588 24" style="color:red;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_recipe_mst">
        <ColumnInfo>
          <Column id="UPJANG" size="22" type="BIGDECIMAL"/>
          <Column id="HALL_CLASS" size="20" type="STRING"/>
          <Column id="RECIPE_CD" size="20" type="STRING"/>
          <Column id="RECIPE_NAME" size="50" type="STRING"/>
          <Column id="RECIPE_CLASS" size="20" type="STRING"/>
          <Column id="RECIPE_TYPE" size="20" type="STRING"/>
          <Column id="CUISINE_TYPE" size="20" type="STRING"/>
          <Column id="MAIN_ITEM_CODE1" size="12" type="STRING"/>
          <Column id="MAIN_ITEM_CODE2" size="12" type="STRING"/>
          <Column id="COOK_TOOL1" size="20" type="STRING"/>
          <Column id="COOK_TOOL2" size="20" type="STRING"/>
          <Column id="RECIPE_COLOR" size="20" type="STRING"/>
          <Column id="RECIPE_SHAPE" size="20" type="STRING"/>
          <Column id="RECIPE_TASTE" size="20" type="STRING"/>
          <Column id="RECIPE_FEEL" size="20" type="STRING"/>
          <Column id="RECIPE_TEMPER" size="20" type="STRING"/>
          <Column id="SPRING_YN" size="1" type="STRING"/>
          <Column id="SUMMER_YN" size="1" type="STRING"/>
          <Column id="AUTUMN_YN" size="1" type="STRING"/>
          <Column id="WINTER_YN" size="1" type="STRING"/>
          <Column id="RESP_NUT1" size="20" type="STRING"/>
          <Column id="RESP_NUT2" size="20" type="STRING"/>
          <Column id="USE_TOOL" size="20" type="STRING"/>
          <Column id="VALID_TIME" size="4" type="STRING"/>
          <Column id="DISPLAY_METHOD" size="20" type="STRING"/>
          <Column id="SALE_UOM" size="20" type="STRING"/>
          <Column id="SALE_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="COST_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="EXPECT_SALE_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="CORE_TEMPER_YN" size="1" type="STRING"/>
          <Column id="GOODS_FEATURE" size="200" type="STRING"/>
          <Column id="PHF_MGMT_YN" size="1" type="STRING"/>
          <Column id="PHF_MGMT1" size="1" type="STRING"/>
          <Column id="PHF_MGMT2" size="1" type="STRING"/>
          <Column id="PHF_MGMT3" size="1" type="STRING"/>
          <Column id="PHF_MGMT4" size="1" type="STRING"/>
          <Column id="PHF_MGMT5" size="1" type="STRING"/>
          <Column id="COOK_OPRN" size="100" type="STRING"/>
          <Column id="PHOTO_PATH" size="200" type="STRING"/>
          <Column id="PREFER" size="20" type="STRING"/>
          <Column id="USE_YN" size="1" type="STRING"/>
          <Column id="ATTR01" size="200" type="STRING"/>
          <Column id="ATTR02" size="200" type="STRING"/>
          <Column id="ATTR03" size="200" type="STRING"/>
          <Column id="ATTR04" size="200" type="STRING"/>
          <Column id="ATTR05" size="200" type="STRING"/>
          <Column id="ATTR06" size="22" type="BIGDECIMAL"/>
          <Column id="ATTR07" size="22" type="BIGDECIMAL"/>
          <Column id="ATTR08" size="22" type="BIGDECIMAL"/>
          <Column id="ATTR09" size="22" type="BIGDECIMAL"/>
          <Column id="ATTR10" size="22" type="BIGDECIMAL"/>
          <Column id="CUSER" size="9" type="STRING"/>
          <Column id="CDATE" size="7" type="DATE"/>
          <Column id="UUSER" size="9" type="STRING"/>
          <Column id="UDATE" size="7" type="DATE"/>
          <Column id="SPHOTO_PATH" size="200" type="STRING"/>
          <Column id="PHF" size="1" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cuisine_type"/>
      <Dataset id="ds_recipe_type"/>
      <Dataset id="ds_upjang_recipe_class">
        <ColumnInfo>
          <Column id="RECIPE_CLASS" size="256" type="STRING"/>
          <Column id="RECIPE_CLASS_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_main_item_code1">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_resp_nut1">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_recipe_color">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_recipe_shape">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_recipe_taste">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_recipe_feel">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_recipe_temper">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_preper">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_use_tool">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_recipe_class">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SubRadio">
        <ColumnInfo>
          <Column id="CD" size="256" type="STRING"/>
          <Column id="NM" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CD">0</Col>
            <Col id="NM">조리법</Col>
          </Row>
          <Row>
            <Col id="CD">1</Col>
            <Col id="NM">PHF관리</Col>
          </Row>
          <Row>
            <Col id="CD">2</Col>
            <Col id="NM">조리공정</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_recipe_cut_spec">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_recipe_item" oncolumnchanged="ds_recipe_item_OnColumnChanged">
        <ColumnInfo>
          <Column id="ITEM_CODE" size="12" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="FEATURE_NAME" size="100" type="STRING"/>
          <Column id="NEED_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="EDIBLE_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="PERSON_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="CUT_SPEC_NAME" size="100" type="STRING"/>
          <Column id="CAL_CALC" size="22" type="BIGDECIMAL"/>
          <Column id="RESTRICT_YN" size="1" type="STRING"/>
          <Column id="ITEM_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="KG_CONVERT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="G_ITEM_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="DISUSE_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="PERSON_CAL" size="22" type="BIGDECIMAL"/>
          <Column id="USE_YN" size="22" type="STRING"/>
          <Column id="CUT_SPEC" size="22" type="STRING"/>
          <Column id="ITEM_SEQ" size="22" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_recipe_cuisine"/>
      <Dataset id="ds_recipe_phf" oncolumnchanged="ds_recipe_phf_OnColumnChanged"/>
      <Dataset id="ds_recipe_cook_orpn"/>
      <Dataset id="ds_recipe_phf_update" oncolumnchanged="ds_recipe_phf_OnColumnChanged">
        <ColumnInfo>
          <Column id="UPJANG" size="22" type="BIGDECIMAL"/>
          <Column id="HALL_CLASS" size="256" type="STRING"/>
          <Column id="RECIPE_CD" size="256" type="STRING"/>
          <Column id="PHF_MGMT1" size="256" type="STRING"/>
          <Column id="PHF_MGMT2" size="256" type="STRING"/>
          <Column id="PHF_MGMT3" size="256" type="STRING"/>
          <Column id="PHF_MGMT4" size="256" type="STRING"/>
          <Column id="PHF_MGMT5" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="HALL_CLASS"/>
            <Col id="PHF_MGMT1"/>
            <Col id="PHF_MGMT2"/>
            <Col id="PHF_MGMT3"/>
            <Col id="PHF_MGMT4"/>
            <Col id="PHF_MGMT5"/>
            <Col id="RECIPE_CD"/>
            <Col id="UPJANG"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_CookMethod"/>
      <Dataset id="ds_CutList"/>
      <Dataset id="ds_recipe_delete">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="HALL_CLASS" size="256" type="STRING"/>
          <Column id="RECIPE_CD" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="HALL_CLASS"/>
            <Col id="RECIPE_CD"/>
            <Col id="UPJANG"/>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="st_RECIPE_NAME_value" compid="st_RECIPE_NAME" propid="value" datasetid="ds_recipe_mst" columnid="RECIPE_NAME"/>
      <BindItem id="ed_EXPECT_SALE_QTY_value" compid="ed_EXPECT_SALE_QTY" propid="value" datasetid="ds_recipe_mst" columnid="EXPECT_SALE_QTY"/>
      <BindItem id="ed_SALE_PRICE_value" compid="ed_SALE_PRICE" propid="value" datasetid="ds_recipe_mst" columnid="SALE_PRICE"/>
      <BindItem id="st_RECIPE_CD_value" compid="st_RECIPE_CD" propid="value" datasetid="ds_recipe_mst" columnid="RECIPE_CD"/>
      <BindItem id="Combo8_value" compid="Combo8" propid="value" datasetid="ds_recipe_mst" columnid="RECIPE_CLASS"/>
      <BindItem id="Combo0_value" compid="Combo0" propid="value" datasetid="ds_recipe_mst" columnid="RECIPE_TYPE"/>
      <BindItem id="Combo5_value" compid="Combo5" propid="value" datasetid="ds_recipe_mst" columnid="MAIN_ITEM_CODE1"/>
      <BindItem id="Combo1_value" compid="Combo1" propid="value" datasetid="ds_recipe_mst" columnid="RESP_NUT1"/>
      <BindItem id="Combo2_value" compid="Combo2" propid="value" datasetid="ds_recipe_mst" columnid="CUISINE_TYPE"/>
      <BindItem id="Combo9_value" compid="Combo9" propid="value" datasetid="ds_recipe_mst" columnid="RECIPE_SHAPE"/>
      <BindItem id="Combo3_value" compid="Combo3" propid="value" datasetid="ds_recipe_mst" columnid="RECIPE_TASTE"/>
      <BindItem id="Combo7_value" compid="Combo7" propid="value" datasetid="ds_recipe_mst" columnid="RECIPE_COLOR"/>
      <BindItem id="Combo4_value" compid="Combo4" propid="value" datasetid="ds_recipe_mst" columnid="RECIPE_FEEL"/>
      <BindItem id="Combo10_value" compid="Combo10" propid="value" datasetid="ds_recipe_mst" columnid="RECIPE_TEMPER"/>
      <BindItem id="Static6_value" compid="Static6" propid="value" datasetid="ds_recipe_mst" columnid="CORE_TEMPER_YN"/>
      <BindItem id="Static35_value" compid="Static35" propid="value" datasetid="ds_recipe_mst" columnid="PHF"/>
      <BindItem id="Combo12_value" compid="Combo12" propid="value" datasetid="ds_recipe_mst" columnid="USE_TOOL"/>
      <BindItem id="Combo6_value" compid="Combo6" propid="value" datasetid="ds_recipe_mst" columnid="PREFER"/>
      <BindItem id="MaskEdit0_value" compid="MaskEdit0" propid="value" datasetid="ds_recipe_mst" columnid="UDATE"/>
      <BindItem id="chk_Dtlyn_value" compid="chk_Dtlyn" propid="value" datasetid="ds_recipe_mst" columnid="SPRING_YN"/>
      <BindItem id="Checkbox0_value" compid="Checkbox0" propid="value" datasetid="ds_recipe_mst" columnid="SUMMER_YN"/>
      <BindItem id="Checkbox1_value" compid="Checkbox1" propid="value" datasetid="ds_recipe_mst" columnid="AUTUMN_YN"/>
      <BindItem id="Checkbox2_value" compid="Checkbox2" propid="value" datasetid="ds_recipe_mst" columnid="WINTER_YN"/>
      <BindItem id="item0" compid="Static35" propid="text" datasetid="ds_recipe_mst" columnid="PHF"/>
      <BindItem id="item1" compid="Static6" propid="text" datasetid="ds_recipe_mst" columnid="CORE_TEMPER_YN"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
 ******************************************************************************************
 * 시스템구분: IFIS/레시피관리/업장표준레시피관리
 * 프로그램명: FSR00023E.XML
 * 기ㅡㅡㅡ능: 업장표준레시피 관리-레시피관리디비젼
 * 작ㅡ성ㅡ자: 한화S&C 박종세
 * 작성ㅡ일자: 2008-05-13
 * ----------------------------------------------------------------------------------------
 * HISTORY  :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//========================================================================================= 
include "U_lib::lib_conversionCom.xjs";
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::fs_common.js"

var v_currDate;
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================

//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

		// 업데이트 DS
		v_ds_check = "ds_recipe_mst;ds_recipe_item";
		
	   //폼 초기화
		fn_InitForm(obj);
		
		v_currDate = fn_CurrDateWeek();
}

//폼 초기화
function fn_InitForm(obj)
{
	// action 정보 생성 초기화 
	fsp_init(this);		
	
	div_Material.url="U_FSR::FSR00024E.xfdl";
	div_Material.position.height = 270;

	// 폼 데이터 초기화
	fn_InitData(false);
}

// 폼데이터 초기화 
function fn_InitData(blnAllClear)
{

    //----------------------------------------------
	// 공통코드 DataSet create 
	//----------------------------------------------
	var v_ds;
	var v_fil_cond;
	
	v_ds = fn_common_code("'FS0001','FS0002','FS0003','FS0004','FS0006','FS0007','FS0008','FS0009','FS0010','FS0011','FS0013','FS0017','FS0020'","","","blk","Y");
    
    //FS0001: RECIPE_CLASSS
	v_fil_cond = "GROUP_CODE == 'FS0001'";
	v_ds.filter(v_fil_cond); 
    CopyF(ds_recipe_class,v_ds.name);

	//FS0002 : RECIPE_TYPE
	v_fil_cond = "GROUP_CODE == 'FS0002'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_recipe_type,v_ds.name);	

	//FS0003 : CUISINE_TYPE
	v_fil_cond = "GROUP_CODE == 'FS0003'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_cuisine_type,v_ds.name);	

    //FS0004 : 대표영양성분
    v_fil_cond = "GROUP_CODE == 'FS0004'";
	v_ds.filter(v_fil_cond);
    CopyF(ds_resp_nut1,v_ds.name);
    
    //FS0006: 주재료군
    v_fil_cond = "GROUP_CODE == 'FS0006'";
	v_ds.filter(v_fil_cond);
    CopyF(ds_main_item_code1,v_ds.name);
    
    //FS0007: 색
    v_fil_cond = "GROUP_CODE == 'FS0007'";
	v_ds.filter(v_fil_cond);
    CopyF(ds_recipe_color,v_ds.name);
    
    //FS0008: 모양
    v_fil_cond = "GROUP_CODE == 'FS0008'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_recipe_shape,v_ds.name);	    
    
    //FS0009: 맛
    v_fil_cond = "GROUP_CODE == 'FS0009'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_recipe_taste,v_ds.name);
    
    //FS0010: 질감
    v_fil_cond = "GROUP_CODE == 'FS0010'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_recipe_feel,v_ds.name);
    
    //FS0011: 제공온도
    v_fil_cond = "GROUP_CODE == 'FS0011'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_recipe_temper,v_ds.name);
    
    //FS0013: 찬기
    v_fil_cond = "GROUP_CODE == 'FS0013'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_use_tool,v_ds.name);
    
    //FS0017: 커팅규격
    v_fil_cond = "GROUP_CODE == 'FS0017'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_recipe_cut_spec,v_ds.name);
    
    //FS0020:선호도
    v_fil_cond = "GROUP_CODE == 'FS0020'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_preper,v_ds.name);

	//레시피 이미지 초기화
	Image0.text = "이미지가 없습니다.";
	Image0.name = "img_NoImageBig";
}

//초기화 콜백함수
function fn_After_InitData()
{
	
}







//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================


/*****************************************************************************************************
    업장표준레시피 조회
------------------------------------------------------------
	0. Function ID : fn_Search_Upjang_Recipe() 
	   Function NM : 업장표준레시 조회()	
------------------------------------------------------------
*****************************************************************************************************/
function fn_Search_Upjang_Recipe()
{
	  //필수 입력사항 체크-----------------------------------------------------------------------
	   if (!fn_Chk_SearchKey_Upjang_Recipe()) return false;
	   
	  //1.업장표준레시 마스터조회()	
	  fn_Search_Upjang_Recipe_Mst();
	  	  
	  //2.업장표준레시 자재 조회()	
	  fn_Search_Upjang_Recipe_Item();
	  
	  //3.업장표준레시 조리법 조회()	
	  fn_Search_Upjang_Recipe_Cuisine();
	  
	  //4.업장표준레시 PHF 조회()	
	  fn_Search_Upjang_Recipe_Phf();
	  
}


// 조회 조건 검색
function fn_Chk_SearchKey_Upjang_Recipe()
{
   //체크로직- 틀리면 return false;    
   //레시피 코드
   if (!mfn_Chk_Obj_MustInput(st_RECIPE_CD)) return false;
   return true;
}

/*------------------------------------------------------------
	 1.Function ID : fn_Search_Upjang_Recipe_Mst() 
	   Function NM : 업장표준레시 마스터 조회()	
*------------------------------------------------------------*/
function fn_Search_Upjang_Recipe_Mst()
{
	   //조회 조건만들기-----------------------------------------------------------------------
	   // action 정보 삭제 초기화 
	   fsp_clear(this);
	   // 서버에서 조회할 정보 추가 
	   fsp_addSearch(this, "fs/fsr:FSR00023E_S001");
	  // 서버 호출 
	   fsp_callService(this, "", "", "", "ds_recipe_mst=ds_recipe_mst" , "UPJANG="+ wrapQuote(ed_UPJANG.userdata) + " HALL_CLASS=" + wrapQuote(ed_HALL_CLASS.value) + " RECIPE_CD="+ wrapQuote(st_RECIPE_CD.text) + " GUBUN='UPJANG'", "fn_After_Search_Upjang_Recipe_Mst");	
}

// 조회 후 콜백 함수 
function fn_After_Search_Upjang_Recipe_Mst()
{
   // 데이터셋 플래그 클리어
	ds_recipe_mst.applyChange();
   // 업장 표준 레시피 이미지 가져오기->>업장표준도 표준레시피의 이미지를 그대로 사용한다.
   fn_Get_Recipe_Mst_Image("FSR_STD_RECIPE_MST");
   
   
   if(this.rdo_Detail.value=="2")
   {
	   // 조리공정 이미지 가져오기==>>업장표준도 표준 레시피의 조리공정 이미지를 그대로 사용한다.
		div_Material.fn_Get_Recipe_Cuisine_Orpn_Image(Combo2.value);
   }
     
   //업장이다. 라고 표시..
   st_Display.text="업장";
}


/*------------------------------------------------------------
	 2.Function ID : fn_Search_Upjang_Recipe_Item() 
	   Function NM : 업장표준레시 자재 조회()	
*------------------------------------------------------------*/
function fn_Search_Upjang_Recipe_Item()
{
	  // action 정보 삭제 초기화 
	  fsp_clear(this);
	  // 서버에서 조회할 정보 추가 
	  fsp_addSearch(this, "fs/fsr:FSR00023E_S002");
	  // 서버 호출 
      fsp_callService(this, "", "", "", "ds_recipe_item=ds_recipe_item" , "UPJANG="+ wrapQuote(ed_UPJANG.userdata) + " HALL_CLASS=" + wrapQuote(ed_HALL_CLASS.value) + " RECIPE_CD="+ wrapQuote(st_RECIPE_CD.text) + " GUBUN='UPJANG'", "fn_After_Search_Upjang_Recipe_Item");	
}
// 조회 후 콜백 함수 
function fn_After_Search_Upjang_Recipe_Item()
{
   // 데이터셋 플래그 클리어
	ds_recipe_item.applyChange();
}


/*------------------------------------------------------------
	 3.Function ID : fn_Search_Upjang_Recipe_Cuisine() 
	   Function NM : 업장표준레시 조리법 조회()	
*------------------------------------------------------------*/
function fn_Search_Upjang_Recipe_Cuisine()
{
	  // action 정보 삭제 초기화 
	   fsp_clear(this);
	  // 서버에서 조회할 정보 추가 
	  fsp_addSearch(this, "fs/fsr:FSR00024E_S001");
	  // 서버 호출 
	  fsp_callService(this, "", "", "", "ds_recipe_cuisine=ds_recipe_cuisine" , "UPJANG="+ wrapQuote(ed_UPJANG.userdata) + " HALL_CLASS=" + wrapQuote(ed_HALL_CLASS.value) + " RECIPE_CD="+ wrapQuote(st_RECIPE_CD.text) + " GUBUN='UPJANG'", "fn_After_Search_Upjang_Recipe_Cuisine");	
}
// 조회 후 콜백 함수 
function fn_After_Search_Upjang_Recipe_Cuisine()
{
   // 데이터셋 플래그 클리어
	ds_recipe_cuisine.applyChange();
}

/*------------------------------------------------------------
	 4.Function ID : fn_Search_Upjang_Recipe_Phf() 
	   Function NM : 업장표준레시 PHF 조회()	
*------------------------------------------------------------*/
function fn_Search_Upjang_Recipe_Phf()
{
	  // action 정보 삭제 초기화 
	   fsp_clear(this);
	  // 서버에서 조회할 정보 추가 
	   fsp_addSearch(this, "fs/fsr:FSR00025E_S001");
	  // 서버 호출 
	  fsp_callService(this, "", "", "", "ds_recipe_phf=ds_recipe_phf" , "UPJANG="+ wrapQuote(ed_UPJANG.userdata) + " HALL_CLASS=" + wrapQuote(ed_HALL_CLASS.value) + " RECIPE_CD="+ wrapQuote(st_RECIPE_CD.text) + " GUBUN='UPJANG'", "fn_After_Search_Upjang_Recipe_Phf");	
}
// 조회 후 콜백 함수 
function fn_After_Search_Upjang_Recipe_Phf()
{
   // 데이터셋 플래그 클리어
	ds_recipe_phf.applyChange();
}














/*****************************************************************************************************
/*------------------------------------------------------------
	1. Function ID : fn_Search_Upjang_Recipe()
	2. 개       요 : 업무프로세스에 따른 조회작업
	3. 기       능 : 검색버튼 입력 시 처리되는 작업
	4. 인 수 설 명:
*------------------------------------------------------------*
*****************************************************************************************************/

function fn_Search_STD_Recipe()
{
		//필수 입력사항 체크-----------------------------------------------------------------------
	   if (!fn_Chk_SearchKey_STD_Recipe()) return false;
	   
	  //1.표준레시피 마스터조회()	
	  fn_Search_STD_Recipe_Mst();
	  
	  //2.표준레시피 자재 조회()	
	  fn_Search_STD_Recipe_Item();
	  
	  //3.표준레시피 조리법 조회()	
	  fn_Search_STD_Recipe_Cuisine();
	  
	  //4.표준레시피 PHF 조회()	
	  fn_Search_STD_Recipe_Phf();

}

// 조회 조건 검색
function fn_Chk_SearchKey_STD_Recipe()
{
   //체크로직- 틀리면 return false;    
   //레시피 코드
   if (!mfn_Chk_Obj_MustInput(st_RECIPE_CD)) return false;
   return true;
}

/*------------------------------------------------------------
	 1.Function ID : fn_Search_STD_Recipe_Mst() 
	   Function NM : 표준레시피 마스터 조회()	
*------------------------------------------------------------*/
function fn_Search_STD_Recipe_Mst()
{
	  //필수 입력사항 체크-----------------------------------------------------------------------
	   //if (!fn_Chk_SearchKey()) return false;
	
	  //조회 조건만들기-----------------------------------------------------------------------

	  // action 정보 삭제 초기화 
	  fsp_clear(this);
	   // 서버에서 조회할 정보 추가 
	   fsp_addSearch(this, "fs/fsr:FSR00023E_S001");
		
	  // 서버 호출 
	   fsp_callService(this, "", "", "", "ds_recipe_mst=ds_recipe_mst" , "UPJANG="+ wrapQuote(ed_UPJANG.userdata) + " HALL_CLASS=" + wrapQuote(ed_HALL_CLASS.value) + " RECIPE_CD="+ wrapQuote(st_RECIPE_CD.text) + " GUBUN='STD'" , "fn_After_Search_Std_Recipe_Mst");	
	  //조회 실행-----------------------------------------------------------------------------
}

// 조회 후 콜백 함수 
function fn_After_Search_Std_Recipe_Mst()
{
    // 데이터셋 플래그 클리어
    ds_recipe_mst.applyChange();
    //  표준 레시피 이미지 가져오기
    fn_Get_Recipe_Mst_Image("FSR_STD_RECIPE_MST");
   
    if(this.rdo_Detail.value=="2")
    {
	   // 조리공정 이미지 가져오기==>>업장표준도 표준 레시피의 조리공정 이미지를 그대로 사용한다.
		div_Material.fn_Get_Recipe_Cuisine_Orpn_Image(Combo2.value);
	}

    st_Display.text="표준";

}


/*------------------------------------------------------------
	 2.Function ID : fn_Search_STD_Recipe_Item() 
	   Function NM : 표준레시피 자재 조회()	
*------------------------------------------------------------*/
function fn_Search_STD_Recipe_Item()
{
	  // action 정보 삭제 초기화 
	  fsp_clear(this);
		
	  // 서버에서 조회할 정보 추가 
	  fsp_addSearch(this, "fs/fsr:FSR00023E_S002");
		
	  // 서버 호출 
	  fsp_callService(this, "", "", "", "ds_recipe_item=ds_recipe_item" ,  "UPJANG="+ wrapQuote(ed_UPJANG.userdata) + " HALL_CLASS=" + wrapQuote(ed_HALL_CLASS.value) + " RECIPE_CD="+ wrapQuote(st_RECIPE_CD.text) + " GUBUN='STD'"  , "fn_After_Search_STD_Recipe_Item");	
}

// 조회 후 콜백 함수 
function fn_After_Search_STD_Recipe_Item()
{
	//데이터셋클리어
	ds_recipe_item.applyChange();
}


/*------------------------------------------------------------
	 3.Function ID : fn_Search_Upjang_Recipe_Cuisine() 
	   Function NM : 업장표준레시 조리법 조회()	
*------------------------------------------------------------*/
function fn_Search_STD_Recipe_Cuisine()
{
	  // action 정보 삭제 초기화 
	  fsp_clear(this);
		
	  // 서버에서 조회할 정보 추가 
	  fsp_addSearch(this, "fs/fsr:FSR00024E_S001");
		
	  // 서버 호출 
	  fsp_callService(this, "", "", "", "ds_recipe_cuisine=ds_recipe_cuisine" ,  "UPJANG="+ wrapQuote(ed_UPJANG.userdata) + " HALL_CLASS=" + wrapQuote(ed_HALL_CLASS.value) + " RECIPE_CD="+ wrapQuote(st_RECIPE_CD.text) + " GUBUN='STD'" , "fn_After_STD_Upjang_Recipe_Cuisine");	
}

// 조회 후 콜백 함수 
function fn_After_STD_Upjang_Recipe_Cuisine()
{
   // 데이터셋 플래그 클리어
	ds_recipe_cuisine.applyChange();
}


/*------------------------------------------------------------
	 4.Function ID : fn_Search_STD_Recipe_Phf() 
	   Function NM : 표준레시피 PHF 조회()	
*------------------------------------------------------------*/
function fn_Search_STD_Recipe_Phf()
{
	   // action 정보 삭제 초기화 
	  fsp_clear(this);
		
	  // 서버에서 조회할 정보 추가 
	  fsp_addSearch(this, "fs/fsr:FSR00025E_S001");
		
	  // 서버 호출 
	  fsp_callService(this, "", "", "", "ds_recipe_phf=ds_recipe_phf" ,  "UPJANG="+ wrapQuote(ed_UPJANG.userdata) + " HALL_CLASS=" + wrapQuote(ed_HALL_CLASS.value) + " RECIPE_CD="+ wrapQuote(st_RECIPE_CD.text) + " GUBUN='STD'" , "fn_After_Search_STD_Recip_Phf");	
}

// 조회 후 콜백 함수 
function fn_After_Search_STD_Recip_Phf()
{
   // 데이터셋 플래그 클리어
	ds_recipe_phf.applyChange();
}







/*****************************************************************************************************/
/*------------------------------------------------------------
	1. Function ID : fn_Delete()
	2. 개       요 : 업무프로세스에 따른 정보 삭제작업
	3. 기       능 : 삭제버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*------------------------------------------------------------*/
/*****************************************************************************************************/
function fn_delete()
{
    // 삭제 확인메세지 호출
	if (!mfn_Call_DeleteMsg()){ return false; }	
	 
	 
	// 삭제 데이터 확인
	if (gfn_length(st_RECIPE_CD.text)==0)
	{
		gfn_alert("선택하신 레시피가 없습니다.\n\n레시피를 선택하여 주십시요.");
		return false;
	}
	 
	 
	 //기존의 업장 레시피 삭제
	  ds_recipe_delete.setColumn(0,"UPJANG",       ed_UPJANG.userdata);
	  ds_recipe_delete.setColumn(0,"HALL_CLASS",   ed_HALL_CLASS.value);
	  ds_recipe_delete.setColumn(0,"RECIPE_CD",    st_RECIPE_CD.text);
		
				
	  // action 정보 초기화 
	  fsp_clear(this);
	  // 레시피 마스터 삭제
	  fsp_addMulti(this, "fs/fsr:FSR00023E_D001");
	  // 레시피 자재 삭제
	  fsp_addMulti(this, "fs/fsr:FSR00023E_D002");
	  // 레시피 조리법 삭제
	  fsp_addMulti(this, "fs/fsr:FSR00023E_D003");
	  
	  http.Sync=true;
	  fsp_callService(this, "", "", "ds_recipe_mst_delete=ds_recipe_delete ds_recipe_item=ds_recipe_delete ds_recipe_cuisine_delete=ds_recipe_delete ",  "UPJANG="+ wrapQuote(ed_UPJANG.userdata) + " HALL_CLASS=" + wrapQuote(ed_HALL_CLASS.value) + " RECIPE_CD="+ wrapQuote(st_RECIPE_CD.text), "", "fn_After_Delete()");
	  //임시입력값 삭제
	  http.Sync=false;
}

function fn_After_Delete()
{
	ds_recipe_mst.clearData();
	ds_recipe_item.clearData();
	ds_recipe_cuisine.clearData();
	ds_recipe_phf.clearData();
	ds_recipe_phf_update.clearData();

	fn_search();
}
        
/****************************************************************************************************/
/*------------------------------------------------------------
	1. Function ID : fn_Save()
	2. 개       요 : 업무프로세스에 따른 정보 저장작업
	3. 기       능 : 저장버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*------------------------------------------------------------*/
/****************************************************************************************************/
function fn_save()
{

 	// 데이터 유효성 검사 --> 조리법 SEQUENCE 생성
	 if (!fn_DataValidation()){	return false; }
			
	//기존 업장 데이터 삭제 조건	
	 ds_recipe_delete.setColumn(0,"UPJANG",       ed_UPJANG.userdata);
	 ds_recipe_delete.setColumn(0,"HALL_CLASS",   ed_HALL_CLASS.value);
	 ds_recipe_delete.setColumn(0,"RECIPE_CD",    st_RECIPE_CD.text);


	//1) 표준레시피가 업장으로 INSERT 될 때 2) 표준레시피가 업장으로 UPDATE 될 때
	//---> 데이터를 ISNERT 한다.
	if ((ed_MODE.value=="STD_INSERT") || (ed_MODE.value=="STD_UPDATE"))
	{		
//trace("ed_MODE.value==="+ed_MODE.value);
		if(ed_MODE.value=="STD_UPDATE")
		{
//trace("STD_UPDATE");
			//기존의 업장 레시피 삭제
			  ds_recipe_delete.setColumn(0,"UPJANG",       ed_UPJANG.userdata);
			  ds_recipe_delete.setColumn(0,"HALL_CLASS",   ed_HALL_CLASS.value);
			  ds_recipe_delete.setColumn(0,"RECIPE_CD",    st_RECIPE_CD.text);
				
						
			  // action 정보 초기화 
			  fsp_clear(this);
			  // 레시피 마스터 삭제
			  fsp_addMulti(this, "fs/fsr:FSR00023E_D001");
			  // 레시피 자재 삭제
			  fsp_addMulti(this, "fs/fsr:FSR00023E_D002");
			  // 레시피 조리법 삭제
			  fsp_addMulti(this, "fs/fsr:FSR00023E_D003");
			  
			  http.Sync=true;
			  fsp_callService(this, "", "", "ds_recipe_mst_delete=ds_recipe_delete ds_recipe_item=ds_recipe_delete ds_recipe_cuisine_delete=ds_recipe_delete ",  "UPJANG="+ wrapQuote(ed_UPJANG.userdata) + " HALL_CLASS=" + wrapQuote(ed_HALL_CLASS.value) + " RECIPE_CD="+ wrapQuote(st_RECIPE_CD.text), "", "");
			  //임시입력값 삭제
			  http.Sync=false;		 
		}
			
		// action 정보 초기화 
		fsp_clear(this);		
		// 레시피 마스터 저장
		fsp_addMulti(this, "fs/fsr:FSR00023E_I001");	
			
		//g_Debug("ds_recipe_item");
		
		if(ds_recipe_item.rowcount>0)
		{
		// 레시피 자재 저장
		fsp_addMulti(this, "fs/fsr:FSR00023E_I002");
		}
		
		if(ds_recipe_cuisine.rowcount>0)
		{		
		// 레시피 조리법 저장
		fsp_addMulti(this, "fs/fsr:FSR00023E_I003");				
		}
		
		//레시피 PHF 저장 --> 실재는 레시피 마스터 쪽 PHF 항목을 UPDATE 한다.
		fsp_addSave(this
				, ""
				, "fs/fsr:FSR00023E_U004"
				, ""
				, "", "", "", "");		
		
		// 서버 호출 후 조회 
		fsp_callService(this, "", "", "ds_recipe_mst=ds_recipe_mst:A ds_recipe_item=ds_recipe_item:A ds_recipe_cuisine=ds_recipe_cuisine:A ds_recipe_phf_update=ds_recipe_phf_update:U ",  "UPJANG="+ wrapQuote(ed_UPJANG.userdata) + " HALL_CLASS=" + wrapQuote(ed_HALL_CLASS.value) + " RECIPE_CD="+ wrapQuote(st_RECIPE_CD.text), "", "fn_After_Save()");
		// 트랜잭션 종료 
		
	}

			
	//3) 업장표준레시피를 수정할 때 --> 수정
	//---->> 데이터를 UPDATE 한다.	
	if (ed_MODE.value=="UPJANG_UPDATE")
	{	
//trace("UPJANG_UPDATE");
		// action 정보 초기화 
		fsp_clear(this);
		// 레시피 마스터 저장	
		ds_recipe_mst.setColumn(ds_recipe_mst.rowposition, "UDATE", v_currDate);
		fsp_addSave(this
				, ""
				, "fs/fsr:FSR00023E_U001"
				, ""
				, "", "", "", "");		
		
		// 레시피 자재 저장
		fsp_addSave(this
				, "fs/fsr:FSR00023E_I002"
				, "fs/fsr:FSR00023E_U002"
				, "fs/fsr:FSR00023E_D002"
				, "", "", "", "");			
				
				
		// 레시피 조리법 저장
	    // 1______레시피 조리법 삭제:전체삭제...===>D0003 무조건 삭제
  	    fsp_addMulti(this, "fs/fsr:FSR00023E_D003");  	 
  	   
  	   // 2______레시피 조리법 입력:모두입력..
  	    if(ds_recipe_cuisine.rowcount>0)
  	    {
	    fsp_addMulti(this, "fs/fsr:FSR00023E_I003");
  	    }
  	    
		// 레시피 php 저장
		fsp_addSave(this
				, ""
				, "fs/fsr:FSR00023E_U004"
				, ""
				, "", "", "", "");			
//trace("UPJANG="+ wrapQuote(ed_UPJANG.userdata) + " HALL_CLASS=" + wrapQuote(ed_HALL_CLASS.value) + " RECIPE_CD="+ wrapQuote(st_RECIPE_CD.text));
		// 서버 호출 후 조회 
		fsp_callService(this, "", "", "ds_recipe_mst=ds_recipe_mst:U ds_recipe_item=ds_recipe_item:U ds_recipe_cuisine_delete=ds_recipe_delete ds_recipe_cuisine=ds_recipe_cuisine ds_recipe_phf_update=ds_recipe_phf_update:U ",  "UPJANG="+ wrapQuote(ed_UPJANG.userdata) + " HALL_CLASS=" + wrapQuote(ed_HALL_CLASS.value) + " RECIPE_CD="+ wrapQuote(st_RECIPE_CD.text), "", "fn_After_Save()");
		// 트랜잭션 종료 

     }						
}

//저장 후 콜백 함수 
function fn_After_Save()
{
	ds_recipe_mst.applyChange();
	ds_recipe_item.applyChange();
	ds_recipe_cuisine.applyChange();
	ds_recipe_phf.applyChange();
	ds_recipe_phf_update.applyChange();
	
	//레시피 목록을 다시 조회한다.
	//Parent.divFSR00021V.fn_Search();
		
	//저장이 완료되면 업장레시피 업데이트 모드로 변경시킨다.
	ed_MODE.value="UPJANG_UPDATE";
	//위처럼 변경을 하지 않으면 표준--> 업장 INSERT 후 데이터 수정하면 다시 INSERT를 하려고 해서 PK에러발생
		
	//업장레시피를 다시 조회한다.
	fn_Search_Upjang_Recipe();
}

//데이터 유효성검사
function fn_DataValidation()
{
    //체크로직- 틀리면 return false;
   
   //레시피 코드
   if (!mfn_Chk_Obj_MustInput(ed_MODE)) return false;
   
   //자재가 없으면 무조건 에러
   if(!ds_recipe_item.getRowCount()>0)
    {
		g_Message("EE","레시피를 저장할 수 없습니다.\n적어도 하나이상의 자재가 필요합니다.");
		return false;
    }  
   	
    //저장하기전 자재코드가 없는 자재가 있을 경우 에러 발생
    if(ds_recipe_item.findRowExpr("gfn_length(ITEM_CODE)==0") > 0)
    {
    	g_Message("EE","레시피를 저장할 수 없습니다.\n자재코드가 없는 데이터가 있습니다.\n자재를 선택하여 주십시요.");
		return false;
    }
    
   	
   	
   	//저장하기전에 조리법 SEQUENCE 생성		
	fn_MakeSequence_Recipe_Cuisine();
   return true;
}

//조리법 fequence 생성
function fn_MakeSequence_Recipe_Cuisine()
{
	var i, j;
	for(j=0; j<ds_recipe_cuisine.rowcount; j++)
	{
		ds_recipe_cuisine.setColumn(j, "CUISINE_SEQ", j+1);
	}
}












/*------------------------------------------------------------
	1. Function ID : fn_Print()
	2. 개       요 : 업무프로세스에 따른 인쇄 처리
	3. 기       능 : 인쇄버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*------------------------------------------------------------*/
function fn_print()
{
}






/*------------------------------------------------------------
	1. Function ID : fn_close()
	2. 개       요 : 업무프로세스에 따른 폼 종료 
	3. 기       능 : 닫기버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*------------------------------------------------------------*/
function fn_close()
{
	return true;
}







/*------------------------------------------------------------
	1. Function ID : fn_Help()
	2. 개       요 : 업무프로세스에 따른 도움말 
	3. 기       능 : 도움말버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*------------------------------------------------------------*/
function fn_help()
{
}






//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================










//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
function grd_jajea_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	fn_grd_jajea_OnCellClick(obj, e.row, e.cell);
}

function fn_grd_jajea_OnCellClick(obj, nRow, nCell)
{
	var ActionVal="";
	var v_rtn="";
	var v_result="";
	ds_recipe_item.rowposition=nRow;
	switch(nCell)
	{
		case 2:
			ds_recipe_item.deleteRow(ds_recipe_item.rowposition);
			break;
		case 4:
			if(GetRowType(ds_recipe_item,nRow)!="insert")
			{
				return;
			}
			v_rtn=gfn_dialog("", "U_FSR::FSR00023P.xfdl",{param_UPJANG:ed_UPJANG.userdata});
			if(gfn_length(gfn_trim(v_rtn))==0 || gfn_trim(v_rtn)==null )
			{
				return;
			}
			// 0 자재코드 ,1 자재명, 2 규격, 3 단위 ,4 금지, 5 100g에너지, 6 폐기율, 7 g당단가, 8 자재특성 9 1인소요량
			v_result=gfn_split(v_rtn,";");
			if(ds_recipe_item.findRow("ITEM_CODE",v_result[0])!=-1)
			{
				//alert(fn_AlertMsg("012"));
				g_Message("EE", fn_AlertMsg("012"));
				return;
			}
			ds_recipe_item.setColumn(nRow,"ITEM_CODE",v_result[0]);
			ds_recipe_item.setColumn(nRow,"ITEM_NAME",v_result[1]);
			ds_recipe_item.setColumn(nRow,"ITEM_SIZE",v_result[2]);
			ds_recipe_item.setColumn(nRow,"PO_UOM",v_result[3]);
			ds_recipe_item.setColumn(nRow,"RESTRICT_YN",v_result[4]);			
			ds_recipe_item.setColumn(nRow,"CAL",v_result[5]);
			ds_recipe_item.setColumn(nRow,"DISUSE_RATE",v_result[6]);
			ds_recipe_item.setColumn(nRow,"G_ITEM_PRICE",v_result[7]);
			ds_recipe_item.setColumn(nRow,"FEATURE_NAME",v_result[8]);
			ds_recipe_item.setColumn(nRow,"NEED_QTY",v_result[9]);
			ds_recipe_item.setColumn(nRow,"USE_YN", "Y"); //use_yn 은 Y
		
			//item_sequence 새로 생성
			var i=0;
			for(i=0;i<ds_recipe_item.getRowCount();i++)
			{
				ds_recipe_item.setColumn(i,"ITEM_SEQ",i+1);
			}			
			
			break;
		case 13:
			v_rtn=gfn_dialog("", "U_FSR::FSR00015P.xfdl","");
			if(gfn_length(gfn_trim(v_rtn))==0 || gfn_trim(v_rtn)==null )
			{
				return;
			}			
			v_result=gfn_split(v_rtn,";");	// 0 그룹코드 1 그룹명 2 상세코드 3 상세코드명
			ds_recipe_item.setColumn(nRow,"CUT_SPEC",v_result[2]);
			//ds_recipe_item.setColumn(nRow,"CUT_SPEC_NAME",v_result[3]);	
			break;
        default :
            break;
			
	}	
}

function grd_jajea_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{

	//TRACE(nCell);
	switch(e.cell)
	{
		case 0:
			gfn_exportExcel(grd_jajea, "sheet1");
			break;
		case 2:
			if(obj.userdata==true)
			{
				obj.userdata=false;
			}
			else
			{
				obj.userdata=true;
			}
			Sort(eval(obj.binddataset),"ITEM_CODE",obj.userdata);
			break;
		case 10:
			if(obj.userdata==true)
			{
				obj.userdata=false;
			}
			else
			{
				obj.userdata=true;
			}
			Sort(eval(obj.binddataset),"CUT_SPEC",obj.userdata);
			break;
		default:
			gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
			break;
	}

}


function grd_jajea_OnKeyDown(obj:Grid, e:KeyEventInfo)
{
	if(e.keycode==13 && grd_jajea.getCellPos()!=9)
	{
		fn_addItem();
	}
	else if(e.keycode==13 && grd_jajea.getCellPos()==9)
	{
		grd_jajea.moveToNextCell();
	}
}

function fn_addItem()
{
	if(ds_recipe_mst.getRowCount()==0)
	{
		return;
	}
	
	if(ds_recipe_item.findRowExpr("gfn_length(gfn_trim(ITEM_CODE))==0 || gfn_trim(ITEM_CODE)==null")!=-1)
	{
		return;
	}
	
	ds_recipe_item.addRow();
	
	ds_recipe_item.setColumn(ds_recipe_item.rowposition,"UPJANG",ds_recipe_mst.getColumn(0,"UPJANG"));
	ds_recipe_item.setColumn(ds_recipe_item.rowposition,"HALL_CLASS",ds_recipe_mst.getColumn(0,"HALL_CLASS"));
	ds_recipe_item.setColumn(ds_recipe_item.rowposition,"RECIPE_CD",ds_recipe_mst.getColumn(0,"RECIPE_CD"));
	
	
	/* 자재추가시 자동 자재추가 팝업 호출 */
	fn_grd_jajea_OnCellClick(grd_jajea, ds_recipe_item.rowposition, 4);
}

function grd_jajea_OnMouseOver(obj:Grid, e:GridMouseEventInfo)
{
	if(e.row>=0)
	{
		if(ds_recipe_item.getColumn(e.row,"RESTRICT_YN")=="Y")
		{
			grd_jajea.tooltiptext="금지기간:" + ds_recipe_item.getColumn(e.row,"RESTRICT_START")+"~"+ds_recipe_item.getColumn(e.row,"RESTRICT_END")+"\n"+ "금지사유:" +ds_recipe_item.getColumn(e.row,"RESTRICT_REASON");
		}
		else
		{
			grd_jajea.tooltiptext="";
		}
	}
	else
	{
		grd_jajea.tooltiptext="";
	}
}

//-----------------------------------------------------------------------


function rdo_Detail_OnChanged(obj:Radio, e:ItemChangeEventInfo)
{
	//trace("e.postindex==="+e.postindex);
	switch(e.postindex)
	{
		case 0:  //조리법   --> 입력, 수정, 삭제
			div_Material.url="U_FSR::FSR00024E.xfdl";
			div_Material.position.height = 270;
			parent.divFSR00023E.resetScroll();
			break;
		case 1:  //PHF 관리 --> 입력,수정,삭제
			div_Material.url="U_FSR::FSR00025E.xfdl";
			div_Material.position.height = 270;
			parent.divFSR00023E.resetScroll();
			break;
		case 2:  //조리공정 --> 조회
			div_Material.url="U_FSR::FSR00026E.xfdl";
			div_Material.position.height = 800;
			parent.divFSR00023E.resetScroll();
			
			div_Material.fn_Get_Recipe_Cuisine_Orpn_Image(Combo2.value);
			//조리공정 이미지 가져오기 
			break;
        default :
            break;
	}	
}


//PHF 데이터 변경시 입력데이터 조작
function ds_recipe_phf_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if(e.columnid=="PHF")
	{	
		//1번이 Y이고   2     N ===> Y
		//1번이 Y이고   3,4,5 Y ===> Y
		//2번이 N이고   3,4,5 Y ===> Y
		
		ds_recipe_mst.setColumn(0,"PHF","N");
			
		//1번이 Y이고 
		if(ds_recipe_phf.getColumn(0,"PHF")=="Y")
		{		
			//2번이 N이면 
			if(ds_recipe_phf.getColumn(1,"PHF")=="N")
			{
				ds_recipe_mst.setColumn(0,"PHF","Y");
			}
		
		
			//3,4,5번이 Y이면
			if((ds_recipe_phf.getColumn(2,"PHF")=="Y")||(ds_recipe_phf.getColumn(3,"PHF")=="Y")||(ds_recipe_phf.getColumn(4,"PHF")=="Y"))
			{
				ds_recipe_mst.setColumn(0,"PHF","Y");
			}
		}
		
		
		//2번이 N이고
		if(ds_recipe_phf.getColumn(1,"PHF")=="N")
		{
		
			//3,4,5번이 Y이면
			if((ds_recipe_phf.getColumn(2,"PHF")=="Y")||(ds_recipe_phf.getColumn(3,"PHF")=="Y")||(ds_recipe_phf.getColumn(4,"PHF")=="Y"))
			{
				ds_recipe_mst.setColumn(0,"PHF","Y");
			}
		}

	
		ds_recipe_phf_update.updatecontrol = false;
		SetRowType(ds_recipe_phf_update,0, "Update");
		
		ds_recipe_phf_update.setColumn(0,"UPJANG",     ds_recipe_mst.getColumn(0,"UPJANG"));
		ds_recipe_phf_update.setColumn(0,"HALL_CLASS", ds_recipe_mst.getColumn(0,"HALL_CLASS"));
		ds_recipe_phf_update.setColumn(0,"RECIPE_CD",  ds_recipe_mst.getColumn(0,"RECIPE_CD"));
		ds_recipe_phf_update.setColumn(0,"PHF_MGMT1",  ds_recipe_phf.getColumn(0,"PHF") );
		ds_recipe_phf_update.setColumn(0,"PHF_MGMT2",  ds_recipe_phf.getColumn(1,"PHF"));
		ds_recipe_phf_update.setColumn(0,"PHF_MGMT3",  ds_recipe_phf.getColumn(2,"PHF"));
		ds_recipe_phf_update.setColumn(0,"PHF_MGMT4",  ds_recipe_phf.getColumn(3,"PHF"));
		ds_recipe_phf_update.setColumn(0,"PHF_MGMT5",  ds_recipe_phf.getColumn(4,"PHF"));
	}	
}

//숨기기 버튼이벤트
function btn_Hide_Search_OnClick(obj:Button, e:ClickEventInfo)
{
    if (this.parent.divFSR00023E.position.top > 200) return;
    //크기복원
	this.parent.divFSR00023E.position.top=261;
    divFSR00021V.position.height=221;
	//this.parent.divFSR00023E.position.height=this.parent.divFSR00023E.position.height-this.parent.divFSR00021V.position.height;	
}


//레시피 영양성분 --->>>> 표준레시피 관리화면을 사용한다.또는 업장표준레시피관리화면사용.
function btn_RecipeElement_OnClick(obj:Button, e:ClickEventInfo)
{	
	if(ds_recipe_mst.getRowCount()==0)
	{
		return;
	}

		
	//1) 표준레시피가 업장으로 INSERT 될 때 2) 표준레시피가 업장으로 UPDATE 될 때
	//---> 데이터를 ISNERT 한다.
	if ((ed_MODE.value=="STD_INSERT") || (ed_MODE.value=="STD_UPDATE"))
	{
		var v_arg = {gbn:"0",IN_RECIPE_CD:ds_recipe_mst.getColumn(0,"RECIPE_CD")};
		gfn_dialog("", "U_FSR::FSR00012P.xfdl",v_arg);
	}
	
	//3) 업장표준레시피를 수정할 때 --> 수정
	//---->> 데이터를 UPDATE 한다.	
	if (ed_MODE.value=="UPJANG_UPDATE")
	{
		var v_arg = {IN_RECIPE_CD:ds_recipe_mst.getColumn(0,"RECIPE_CD")
		            ,IN_UPJANG:ed_UPJANG.userdata
		            ,IN_HALL_CLASS:ed_HALL_CLASS.value };
		gfn_dialog("", "U_FSR::FSR00022P.xfdl",v_arg);
	}
}


///레시피 비율 일괄 변경 
function btn_ratio_OnClick(obj:Button, e:ClickEventInfo)
{
	if(ds_recipe_mst.getRowCount()==0)
	{
		return;
	}
	var v_NQ=0;
	if(ed_ratio.visible==true)
	{
		//화면에서 가리고 반영하기
		ed_ratio.visible=false;
		st_Ratio.visible=false;
		if(gfn_length(gfn_trim(ed_ratio.value))==0 || gfn_trim(ed_ratio.value)==null )
		{
			return;
		}
		for(i=0;i<ds_recipe_item.getRowCount();i++)
		{
			v_NQ=Math.round((toNumber(ds_recipe_item.getColumn(i,"NEED_QTY"))*toNumber(ed_ratio.value))/100,2);
			ds_recipe_item.setColumn(i,"NEED_QTY",v_NQ);
		}
	}
	else
	{
		ed_ratio.visible=true;
		st_Ratio.visible=true;
	}
}


//레시피 마스터 이미지 가져오기
function fn_Get_Recipe_Mst_Image(serverSaveDir)
{
/*
	if(fsp_getServerDir(serverSaveDir,ds_recipe_mst.GetColumn(0,"SPHOTO_PATH")).trim().length()==0 || fsp_getServerDir(serverSaveDir,ds_recipe_mst.GetColumn(0,"SPHOTO_PATH")).trim()==null )
		{
			Image0.ImageID="";
			Image0.Text="이미지가 없습니다.";			
		}
	else
		{
			Image0.Text="";
			Image0.ImageID=fsp_getServerDir(serverSaveDir,ds_recipe_mst.GetColumn(0,"SPHOTO_PATH"));
		}
*/
	//if(length(ds_recipe_mst.GetColumn(0,"RECIPE_CD")) > 0)
	if(gfn_length(ds_recipe_mst.getColumn(0,"SPHOTO_PATH"))> 0)
	{
		Image0.text="";
		//Image0.ImageID=GF_FILE_SERVER_URL + "upload/fs/std/recipe/" + ds_recipe_mst.GetColumn(0,"RECIPE_CD") + ".jpg";
		Image0.image=GF_FILE_SERVER_URL + "upload/fs/std/recipe/" + ds_recipe_mst.getColumn(0,"SPHOTO_PATH");
	}
	else
	{
		Image0.image="URL('theme://convertImages/img_NoImageBig.png')";
		Image0.text="이미지가 없습니다.";
	}
}


//이미지 로드에러....
/* 지원하지 않는 이벤트입니다.*/
function Image0_OnLoadError(obj,nErrorCode,strErrorMsg)
{
		Image0.text="이미지 로드에\n\n실패했습니다.";
}



//가식부량 1인원가 ...구하기..
function ds_recipe_item_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	var v_EQ=0;	// EDIBLE_QTY		가식부량 1인소요량*폐기율==>NEED_QTY*(100-disuse_rate)
	var v_PP=0; // PERSON_PRICE 	인원가	자재g당단가*1인소요량==>GRAM_PRICE*NEED_QTY
	var v_CC=0; // CAL_CALC			에너지    100g:기본에너지=가식부량:계산할에너지==>CAL_CALC=(CAL*EDIBLE_QTY)/100

	switch(e.columnid)
	{
		// case "PERSON_PRICE":	
			// ed_wonga.value=ds_recipe_item.Sum("PERSON_PRICE");
			// break;
		// case "EDIBLE_QTY":
			// v_CC=round((ds_recipe_item.GetColumn(ds_recipe_item.row,"CAL")*ds_recipe_item.GetColumn(ds_recipe_item.row,"NEED_QTY")*((100-ds_recipe_item.GetColumn(ds_recipe_item.row,"disuse_rate"))/100))/100,2);
			// ds_recipe_item.SetColumn(ds_recipe_item.row,"CAL_CALC",v_CC);			
			// break;
		// case "NEED_QTY":	// 1인소요량
			// v_PP=round(ds_recipe_item.GetColumn(ds_recipe_item.row,"GRAM_PRICE")*ds_recipe_item.GetColumn(ds_recipe_item.row,"NEED_QTY"),2);
			// ds_recipe_item.SetColumn(ds_recipe_item.row,"PERSON_PRICE",v_PP);
			// v_EQ=round(ds_recipe_item.GetColumn(ds_recipe_item.row,"NEED_QTY")*((100-ds_recipe_item.GetColumn(ds_recipe_item.row,"disuse_rate"))/100),2);
			// ds_recipe_item.SetColumn(ds_recipe_item.row,"EDIBLE_QTY",v_EQ);			
			// break;
		case "PERSON_PRICE":	
			//ed_wonga.value=ds_RECIPE_ITEM.Sum("PERSON_PRICE");
			break;
		case "EDIBLE_QTY":
			v_CC=Math.round((ds_recipe_item.getColumn(e.row,"CAL")*ds_recipe_item.getColumn(e.row,"NEED_QTY")*((100-ds_recipe_item.getColumn(e.row,"DISUSE_RATE"))/100))/100,2);
			ds_recipe_item.setColumn(e.row,"CAL_CALC",v_CC);			
			break;
		case "NEED_QTY":	// 1인소요량
			//alert(ds_RECIPE_ITEM.GetColumn(nRow,"G_ITEM_PRICE"));
			//alert(ds_RECIPE_ITEM.GetColumn(nRow,"NEED_QTY"));
		
			v_PP=Math.round(ds_recipe_item.getColumn(e.row,"G_ITEM_PRICE")*ds_recipe_item.getColumn(e.row,"NEED_QTY"),0);
			ds_recipe_item.setColumn(e.row,"PERSON_PRICE",v_PP);
			
			//alert(v_PP);
			
			v_EQ=Math.round(ds_recipe_item.getColumn(e.row,"NEED_QTY")*((100-ds_recipe_item.getColumn(e.row,"DISUSE_RATE"))/100),2);
			ds_recipe_item.setColumn(e.row,"EDIBLE_QTY",v_EQ);		
			//EDIBLE_QTY변경시 같이 변경(setColumn으로 같은 이벤트 실행 안함)
			v_CC=Math.round((ds_recipe_item.getColumn(e.row,"CAL")*ds_recipe_item.getColumn(e.row,"NEED_QTY")*((100-ds_recipe_item.getColumn(e.row,"DISUSE_RATE"))/100))/100,2);
			ds_recipe_item.setColumn(e.row,"CAL_CALC",v_CC);	
			break;	
        default :
            break;
	}

}

//////////////////////////////
//추가사항
///////////////////////////////
function btn_add_OnClick(obj:Button, e:ClickEventInfo)
{
	fn_addItem();
}


////////////////////////////////////////
//// 자재대체
////////////////////////////////////////
function grd_jajea_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
	//업장 표준레시피 인지 확인
	if(st_Display.text<>"업장")
	{
		return;
	}

	var v_args = {UPJANG:ed_UPJANG.userdata
	             ,HALL_CLASS:ed_HALL_CLASS.value
	             ,RECIPE_CD:st_RECIPE_CD.text
	             ,ITEM_CODE:ds_recipe_item.getColumn(e.row, "ITEM_CODE")
	             ,ITEM_NAME:ds_recipe_item.getColumn(e.row, "ITEM_NAME") };

	v_rtn=gfn_dialog("", "U_FSR::FSR00024P.xfdl", v_args);

	if(gfn_length(gfn_trim(v_rtn))==0 || gfn_trim(v_rtn)==null )
	{
		return;
	}
	
	// OK ===> 자재를 새로 조회합니다.
	if(v_rtn=="OK")
	{
		///////////////////////////
		fn_Search_Upjang_Recipe_Item();
	
	}
	else //NO ==> 그대로 둡니다.
	{
		return;
	}

}]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="ReturnOrderBySales" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="반환/교환/증정주문-영업사원" scrollbars="autoboth" onload="form_onload" onkeydown="fn_FormKeyDown" ondeactivate="ReturnOrderBySales_ondeactivate" ontimer="ReturnOrderBySales_ontimer" onactivate="ReturnOrderBySales_onactivate">
    <Layouts>
      <Layout>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Combo id="cbo_Subinv" taborder="1" innerdataset="ds_Subinv" codecolumn="SUBINV_CODE" datacolumn="SUBINV_NAME" type="filter" displayrowcount="10" position="absolute 390 40 606 61" canitemchange="cbo_Subinv_canitemchange" onitemchanged="cbo_Subinv_OnChanged"/>
        <Static id="st_upjang" text="사업장" class="sta_WFSA_label" position="absolute 15 40 68 61" userdata="strQuery_FMUpjang"/>
        <Static id="Static6" text="식당(창고)" class="sta_WFSA_label" position="absolute 310 40 387 61"/>
        <Static id="sta_NeedDate" text="반환회수일" class="sta_WFSA_label" position="absolute 636 40 709 61"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="4" url="cmn::CmnBtn.xfdl" text="Div0" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static19" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 754 84"/>
        <Tab id="tab_list" anchor="all" taborder="5" tabindex="0" scrollbars="autoboth" position="absolute 0 84 1237 710" style="showextrabutton:false;cursor:arrow;" onchanged="tab_list_onchanged" canchange="tab_list_canchange">
          <Tabpages>
            <Tabpage id="tab1" text="반환" style="anchor:default;">
              <Layouts>
                <Layout>
                  <Static id="Static04" class="sta_WFSA_Labelbg01" position="absolute 10 31 1225 67" anchor="left top right"/>
                  <Grid id="gd_list1" taborder="6" binddataset="ds_List1" autoenter="select" useinputpanel="false" cellsizingtype="both" position="absolute 10 69 1225 282" anchor="left top right" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" autofittype="col" cellmovingtype="col" wheelscrollrow="1" autofitminwidth="959" oncellclick="gd_list_OnCellClick" oncelldblclick="gd_list_OnCellDblClick" onheadclick="gd_list_OnHeadClick" onkeydown="tab_list_tab1_gd_list_OnKeyDown">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="26"/>
                          <Column size="85"/>
                          <Column size="100"/>
                          <Column size="220"/>
                          <Column size="120"/>
                          <Column size="70"/>
                          <Column size="70"/>
                          <Column size="100"/>
                          <Column size="70"/>
                          <Column size="70"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="60"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="상품코드"/>
                          <Cell col="2" displaytype="text" text="바코드"/>
                          <Cell col="3" displaytype="text" text="상품명"/>
                          <Cell col="4" displaytype="text" text="규격"/>
                          <Cell col="5" displaytype="text" text="단위"/>
                          <Cell col="6" displaytype="text" text="보관"/>
                          <Cell col="7" displaytype="text" text="단가"/>
                          <Cell col="8" displaytype="text" text="과/면세"/>
                          <Cell col="9" displaytype="text" text="마감일"/>
                          <Cell col="10" displaytype="text" text="g당단가"/>
                          <Cell col="11" displaytype="text" text="상품정보"/>
                          <Cell col="12" displaytype="text" text="공급업체"/>
                          <Cell col="13" displaytype="text" text="사진"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="image" style="background2: ;" text="expr:fn_SetRowImg(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS,EXCEPTION_ORDER)"/>
                          <Cell col="1" displaytype="text" style="align:center;background2: ;" text="bind:ITEM_CODE"/>
                          <Cell col="2" displaytype="text" style="align:center;background2: ;" text="bind:WIN_ITEM_CD"/>
                          <Cell col="3" displaytype="text" style="align:left;background2: ;backgroundimage:EXPR(gfn_isNull(FEATURE_ICON) ? &quot;&quot; : FEATURE_ICON);" text="bind:ITEM_NAME" expr="expr:gfn_isNull(FEATURE_ICON) ? ITEM_NAME : &quot; &quot;.padLeft(11, &quot; &quot;)   +  ITEM_NAME"/>
                          <Cell col="4" displaytype="text" style="align:left;background2: ;" text="bind:ITEM_SIZE"/>
                          <Cell col="5" displaytype="text" style="align:center;background2: ;" text="bind:PO_UOM"/>
                          <Cell col="6" displaytype="text" style="align:center middle;" text="bind:KEEPING_TYPE"/>
                          <Cell col="7" displaytype="number" style="background2: ;" text="bind:OP_PRICE_TAX" mask="#,##0"/>
                          <Cell col="8" displaytype="text" style="align:center;background2: ;" text="bind:TAX_CODE" expr="expr:decode(TAX_CODE, &quot;100&quot;, &quot;과세&quot;, &quot;210&quot;, &quot;면세&quot;, &quot;영세&quot;)"/>
                          <Cell col="9" displaytype="text" style="align:center;background2: ;" text="bind:D_DAY_DISP"/>
                          <Cell col="10" displaytype="number" style="background2: ;" text="bind:G_PRICE" mask="#,##0.0"/>
                          <Cell col="11" displaytype="text" style="align:left;background2: ;" text="bind:FEATURE_NAME"/>
                          <Cell col="12" displaytype="text" style="align:left;background2: ;" text="bind:OTCUSTNM"/>
                          <Cell col="13" displaytype="text" style="align:center;background2: ;" text="bind:IMAGE_YN"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Edit id="ed_Item" taborder="7" imemode="hangul" autoselect="true" onkeydown="ed_Item_OnKeyDown" class="edt_WF_Essential" position="absolute 110 38 296 61" tooltiptype="inplace,mouseleave" style="padding:1 20 0 5;"/>
                  <Combo id="cbo_Gbn" taborder="8" tabstop="false" value="88code" text="드바코" codecolumn="codecolumn" datacolumn="datacolumn" index="0" displayrowcount="10" class="cmb_WF_Essential" position="absolute 16 38 100 61" innerdataset="@ds_searchGbn" onitemchanged="tab_list_cbo_Gbn_onitemchanged"/>
                  <Button id="btn_search" taborder="9" tabstop="false" text="검색" onclick="btn_search_OnClick" onkeydown="btn_search_OnKeyDown" class="btn_WF_Find" position="absolute 306 38 361 61"/>
                  <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1235 15" anchor="left top"/>
                  <Static id="Static10" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 100 39 110 60" anchor="left top"/>
                  <Static id="Static00" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 296 41 306 62" anchor="left top"/>
                  <Static id="Static18" text="반환상품검색" class="sta_WF_Title01" position="absolute 10 15 121 33" anchor="left top"/>
                  <Static id="Static62" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 8 282 458 297" anchor="left top"/>
                  <Static id="Static01" text="발주내역" class="sta_WF_Title01" position="absolute 10 298 97 316" anchor="left top"/>
                  <Static id="Static02" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 13 326 463 331" anchor="left top"/>
                  <Grid id="gd_listb1" taborder="10" binddataset="ds_Listb1" wheelscrollrow="1" autoenter="select" useinputpanel="false" cellsizingtype="both" cellmovingtype="col" autofitminwidth="981" onkeydown="gd_list_onkeydown" oncellclick="gd_list_oncellclick" onheadclick="gd_list_OnHeadClick1" onselectchanged="gd_list_OnCellPosChanged" position="absolute 8 316 1227 588" anchor="all" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="200"/>
                          <Column size="100"/>
                          <Column size="0"/>
                          <Column size="50"/>
                          <Column size="50"/>
                          <Column size="80"/>
                          <Column size="70"/>
                          <Column size="70"/>
                          <Column size="70"/>
                          <Column size="0"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="120"/>
                          <Column size="80"/>
                          <Column size="70"/>
                          <Column size="80"/>
                          <Column size="85"/>
                          <Column size="140"/>
                          <Column size="100"/>
                          <Column size="120"/>
                          <Column size="100"/>
                          <Column size="0"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                          <Row size="22" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="상품코드"/>
                          <Cell col="2" text="바코드"/>
                          <Cell col="3" displaytype="text" text="상품명"/>
                          <Cell col="4" displaytype="text" text="규격"/>
                          <Cell col="5" displaytype="text" text="원산지"/>
                          <Cell col="6" displaytype="text" text="단위"/>
                          <Cell col="7" displaytype="text" text="보관"/>
                          <Cell col="8" displaytype="text" text="단가"/>
                          <Cell col="9" text="박스수량"/>
                          <Cell col="10" text="낱개수량"/>
                          <Cell col="11" displaytype="text" text="수량총계"/>
                          <Cell col="12" text="총중량(㎏)"/>
                          <Cell col="13" displaytype="text" text="금액"/>
                          <Cell col="14" displaytype="text" text="부가세"/>
                          <Cell col="15" displaytype="text" text="합계"/>
                          <Cell col="16" text="총중량(㎏)"/>
                          <Cell col="17" class="grd_WF_Essential" text="반환유형"/>
                          <Cell col="18" displaytype="text" text="비고(50자)"/>
                          <Cell col="19" displaytype="text" text="발주상태"/>
                          <Cell col="20" displaytype="text" text="마감"/>
                          <Cell col="21" displaytype="text" text="마감일"/>
                          <Cell col="22" text="업체직송여부"/>
                          <Cell col="23" displaytype="text" text="주문번호"/>
                          <Cell col="24" displaytype="text" text="발주구분"/>
                          <Cell col="25" text="발주시간"/>
                          <Cell col="26" displaytype="text" text="최종변경자"/>
                          <Cell col="27" text="등록자"/>
                        </Band>
                        <Band id="body">
                          <Cell celltype="head" displaytype="text" style="align:right;backgroundimage:EXPR(expr_GetRowTypeImg(currow));" expr="expr:currow + 1"/>
                          <Cell col="1" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:itemCode"/>
                          <Cell col="2" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:winItemCd"/>
                          <Cell col="3" displaytype="text" style="align:left;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));color:EXPR(iif(itemStatus == &quot;E&quot;,&quot;red&quot;,&quot;default&quot;));color2:EXPR(iif(itemStatus == &quot;E&quot;,&quot;red&quot;,&quot;default&quot;));" text="bind:itemName"/>
                          <Cell col="4" displaytype="text" style="align:left;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:itemSize"/>
                          <Cell col="5" displaytype="text" style="align:left;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:originType"/>
                          <Cell col="6" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:poUom"/>
                          <Cell col="7" displaytype="text" style="align:center middle;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:keepingType"/>
                          <Cell col="8" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:opPriceTax" mask="#,##0"/>
                          <Cell col="9" displaytype="number" edittype="expr:setEditExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;masknumber&quot;))" editfilter="expr:setfilterExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;integer&quot;))" style="align:right;background:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));background2:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));" text="bind:prBoxQty" mask="#,##0" editautoselect="true"/>
                          <Cell col="10" displaytype="number" edittype="expr:setEditExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;number&quot;))" style="align:right;background:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));background2:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));" text="bind:prPcQty" mask="#,##0.0" editautoselect="true"/>
                          <Cell col="11" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));color:EXPR(iif(prQty&lt;minOrdQty,&quot;red&quot;,&quot;default&quot;));color2:EXPR(iif(prQty&lt;minOrdQty,&quot;red&quot;,&quot;default&quot;));" text="bind:prQty" mask="#,##0.0"/>
                          <Cell col="12" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));color2: ;" text="bind:totWght" mask="#,##0.0"/>
                          <Cell col="13" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:opAmount" mask="#,##0"/>
                          <Cell col="14" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" expr="expr:Math.round(iif(taxCode==&quot;100&quot;,0.1,0)* opAmount)" mask="#,##0"/>
                          <Cell col="15" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" expr="expr:Math.round(iif(taxCode==&quot;100&quot;,1.1,1)* opAmount)" mask="#,##0"/>
                          <Cell col="16" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:totWght" mask="#,##0.0#"/>
                          <Cell col="17" displaytype="combo" edittype="expr:setEditExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;combo&quot;))" style="background:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));background2:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));" text="bind:rtnOrdType" combodataset="ds_rtnOrdType" combocodecol="code" combodatacol="codeName"/>
                          <Cell col="18" displaytype="text" edittype="expr:setEditExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;normal&quot;))" editfilter="expr:setfilterExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;normal&quot;))" style="align:left;background:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));background2:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));" text="bind:prRemark" editlimit="100" editimemode="native" editautoselect="true"/>
                          <Cell col="19" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:poLineStatus"/>
                          <Cell col="20" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:clsStatus"/>
                          <Cell col="21" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:dDayDisp"/>
                          <Cell col="22" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:vcYn"/>
                          <Cell col="23" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:prNum"/>
                          <Cell col="24" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:docuSource"/>
                          <Cell col="25" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:approveTime"/>
                          <Cell col="26" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));color:EXPR(iif(itemStatus == &quot;E&quot;,&quot;red&quot;,&quot;default&quot;));color2:EXPR(iif(itemStatus == &quot;E&quot;,&quot;red&quot;,&quot;default&quot;));" text="bind:updateByNm"/>
                          <Cell col="27" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:createBy"/>
                        </Band>
                        <Band id="summary">
                          <Cell displaytype="text" style="align:left;"/>
                          <Cell col="1" displaytype="text" style="align:center;" text="합  계"/>
                          <Cell col="2"/>
                          <Cell col="3" displaytype="number" style="align: ;" expr="expr:getCaseCount(&quot;prQty&gt;0&quot;)" mask="#,##0"/>
                          <Cell col="4" displaytype="text" style="align:left;" text="건"/>
                          <Cell col="5" displaytype="text" style="align:left;"/>
                          <Cell col="6" displaytype="text" style="align:left;"/>
                          <Cell col="7" displaytype="text" style="align:left;"/>
                          <Cell col="8" displaytype="number" style="align:right middle;" expr="expr:getSum(&quot;opPriceTax&quot;)" mask="#,##0"/>
                          <Cell col="9" displaytype="number" expr="expr:getSum(&quot;prBoxQty&quot;)" mask="#,##0"/>
                          <Cell col="10" displaytype="number" expr="expr:getSum(&quot;prPcQty&quot;)" mask="#,##0.0"/>
                          <Cell col="11" displaytype="number" style="align: ;" expr="expr:getSum(&quot;prQty&quot;)" mask="#,##0.0"/>
                          <Cell col="12" displaytype="number" expr="expr:getSum(&quot;totWght&quot;)" mask="#,##0.0"/>
                          <Cell col="13" displaytype="number" style="align: ;" expr="expr:getSum(&quot;opAmount&quot;)" mask="#,##0"/>
                          <Cell col="14" displaytype="number" style="align: ;" expr="expr:getCaseSum(&quot;taxCode=='100'&quot;,&quot;Math.round(opAmount/10)&quot;)" mask="#,##0"/>
                          <Cell col="15" displaytype="number" style="align: ;" expr="expr:getSum(&quot;Math.round(iif(taxCode=='100',1.1,1)* opAmount)&quot;)" mask="#,##0"/>
                          <Cell col="16"/>
                          <Cell col="17"/>
                          <Cell col="18" displaytype="text" style="align:left;"/>
                          <Cell col="19" displaytype="text" style="align:left;"/>
                          <Cell col="20" displaytype="text" style="align:left;"/>
                          <Cell col="21" displaytype="text" style="align:left;"/>
                          <Cell col="22"/>
                          <Cell col="23" displaytype="text" style="align:left;"/>
                          <Cell col="24" displaytype="text" style="align:left;"/>
                          <Cell col="25"/>
                          <Cell col="26"/>
                          <Cell col="27"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static61" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1225 9 1235 599"/>
                  <Static id="Static58" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 15 10 573"/>
                  <Static id="Static64" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 11 699 1226 709"/>
                  <Static id="Static59" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 11 588 1226 598"/>
                  <Static id="Static03" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 5 311 455 316" anchor="left top"/>
                  <CheckBox id="chk_autoList" taborder="11" tabstop="false" text="자동등록" value="1" truevalue="1" falsevalue="0" position="absolute 390 38 476 62"/>
                  <CheckBox id="chk_Only" taborder="10" tabstop="false" text="주문가능 상품" value="1" truevalue="1" falsevalue="0" position="absolute 479 39 588 63" visible="false"/>
                  <Splitter id="sp_line1" type="vertical" class="spt_WF_2" position="absolute 0 281 1237 292" anchor="left top right" onmove="sp_line_onmove">
                    <Formats>
                      <Format id="default">
                        <SplitterItems id="items">
                          <SplitterItem id="item00" position="leftortop" bindtype="resize" componentid="gd_list1"/>
                          <SplitterItem id="item01" bindtype="move" position="rightorbottom" offset="4" componentid="Static01"/>
                          <SplitterItem id="item02" bindtype="resize" position="rightorbottom" offset="20" componentid="gd_listb1"/>
                          <SplitterItem id="item03" bindtype="move" position="rightorbottom" offset="4" componentid="sta_rtnOrdType"/>
                          <SplitterItem id="item04" bindtype="move" position="rightorbottom" offset="0" componentid="cbo_rtnOrdType"/>
                          <SplitterItem id="item05" bindtype="move" position="rightorbottom" offset="0" componentid="btn_rtnOrdTypeAllChg"/>
                        </SplitterItems>
                      </Format>
                    </Formats>
                  </Splitter>
                  <Static id="sta_rtnOrdType" text="반환유형" class="sta_WFSA_label" position="absolute 979 297 1039 309" anchor="top right" visible="true"/>
                  <Combo id="cbo_rtnOrdType" taborder="8" innerdataset="@ds_rtnOrdTypeAllChg" codecolumn="code" datacolumn="codeName" displayrowcount="10" position="absolute 1045 292 1165 312" anchor="top right" visible="true"/>
                  <Button id="btn_rtnOrdTypeAllChg" taborder="9" text="일괄적용" onclick="btn_rtnOrdTypeAllChg_onclick" position="absolute 1169 292 1226 312" anchor="top right" visible="true" class="btn_WF_Custom"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tab2" text="교환">
              <Layouts>
                <Layout>
                  <Static id="Static04" class="sta_WFSA_Labelbg01" position="absolute 10 31 1225 67" anchor="left top right"/>
                  <Grid id="gd_list2" taborder="1" binddataset="ds_List2" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 69 1225 282" anchor="left top right" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" autofittype="col" oncellclick="gd_list_OnCellClick" onkeydown="tab_list_tab2_gd_list_OnKeyDown" oncelldblclick="gd_list_OnCellDblClick" onheadclick="gd_list_OnHeadClick">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="26"/>
                          <Column size="85"/>
                          <Column size="100"/>
                          <Column size="220"/>
                          <Column size="120"/>
                          <Column size="70"/>
                          <Column size="70"/>
                          <Column size="100"/>
                          <Column size="70"/>
                          <Column size="70"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="60"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="상품코드"/>
                          <Cell col="2" displaytype="text" text="바코드"/>
                          <Cell col="3" displaytype="text" text="상품명"/>
                          <Cell col="4" displaytype="text" text="규격"/>
                          <Cell col="5" displaytype="text" text="단위"/>
                          <Cell col="6" displaytype="text" text="보관"/>
                          <Cell col="7" displaytype="text" text="단가"/>
                          <Cell col="8" displaytype="text" text="과/면세"/>
                          <Cell col="9" displaytype="text" text="마감일"/>
                          <Cell col="10" displaytype="text" text="g당단가"/>
                          <Cell col="11" displaytype="text" text="상품정보"/>
                          <Cell col="12" displaytype="text" text="공급업체"/>
                          <Cell col="13" displaytype="text" text="사진"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="image" style="background2: ;" text="expr:fn_SetRowImg(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS,EXCEPTION_ORDER)"/>
                          <Cell col="1" displaytype="text" style="align:center;background2: ;" text="bind:ITEM_CODE"/>
                          <Cell col="2" displaytype="text" style="align:center;background2: ;" text="bind:WIN_ITEM_CD"/>
                          <Cell col="3" displaytype="text" style="align:left;background2: ;backgroundimage:EXPR(gfn_isNull(FEATURE_ICON) ? &quot;&quot; : FEATURE_ICON);" text="bind:ITEM_NAME" expr="expr:gfn_isNull(FEATURE_ICON) ? ITEM_NAME : &quot; &quot;.padLeft(11, &quot; &quot;)   +  ITEM_NAME"/>
                          <Cell col="4" displaytype="text" style="align:left;background2: ;" text="bind:ITEM_SIZE"/>
                          <Cell col="5" displaytype="text" style="align:center;background2: ;" text="bind:PO_UOM"/>
                          <Cell col="6" displaytype="text" style="align:center middle;" text="bind:KEEPING_TYPE"/>
                          <Cell col="7" displaytype="number" style="background2: ;" text="bind:OP_PRICE_TAX" mask="#,##0"/>
                          <Cell col="8" displaytype="text" style="align:center;background2: ;" text="bind:TAX_CODE" expr="expr:decode(TAX_CODE, &quot;100&quot;, &quot;과세&quot;, &quot;210&quot;, &quot;면세&quot;, &quot;영세&quot;)"/>
                          <Cell col="9" displaytype="text" style="align:center;background2: ;" text="bind:D_DAY_DISP"/>
                          <Cell col="10" displaytype="number" style="background2: ;" text="bind:G_PRICE" mask="#,##0.0"/>
                          <Cell col="11" displaytype="text" style="align:left;background2: ;" text="bind:FEATURE_NAME"/>
                          <Cell col="12" displaytype="text" style="align:left;background2: ;" text="bind:OTCUSTNM"/>
                          <Cell col="13" displaytype="text" style="align:center;background2: ;" text="bind:IMAGE_YN"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Edit id="ed_Item" taborder="2" imemode="hangul" autoselect="true" onkeydown="ed_Item_OnKeyDown" class="edt_WF_Essential" position="absolute 110 38 296 61" tooltiptype="inplace,mouseleave" style="padding:1 20 0 5;"/>
                  <Combo id="cbo_Gbn" taborder="3" tabstop="false" value="88code" text="드바코" codecolumn="codecolumn" datacolumn="datacolumn" index="0" displayrowcount="10" class="cmb_WF_Essential" position="absolute 16 38 100 61" innerdataset="@ds_searchGbn" onitemchanged="tab_list_cbo_Gbn_onitemchanged"/>
                  <Button id="btn_search" taborder="4" tabstop="false" text="검색" onclick="btn_search_OnClick" onkeydown="btn_search_OnKeyDown" class="btn_WF_Find" position="absolute 306 38 361 61"/>
                  <Static id="Static10" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 100 39 110 60" anchor="left top"/>
                  <Static id="Static00" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 296 41 306 62" anchor="left top"/>
                  <Static id="Static18" text="교환상품검색" class="sta_WF_Title01" position="absolute 10 15 121 33" anchor="left top"/>
                  <Static id="Static62" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 8 282 458 297" anchor="left top"/>
                  <Static id="Static01" text="발주내역" class="sta_WF_Title01" position="absolute 10 298 97 316" anchor="left top"/>
                  <Static id="Static02" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 13 326 463 331" anchor="left top"/>
                  <Grid id="gd_listb2" taborder="5" binddataset="ds_Listb2" wheelscrollrow="1" autoenter="select" useinputpanel="false" cellsizingtype="both" cellmovingtype="col" autofitminwidth="981" onkeydown="gd_list_onkeydown" oncellclick="gd_list_oncellclick" onheadclick="gd_list_OnHeadClick1" onselectchanged="gd_list_OnCellPosChanged" position="absolute 8 316 1227 588" anchor="all" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="200"/>
                          <Column size="100"/>
                          <Column size="0"/>
                          <Column size="50"/>
                          <Column size="50"/>
                          <Column size="80"/>
                          <Column size="70"/>
                          <Column size="70"/>
                          <Column size="70"/>
                          <Column size="0"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="120"/>
                          <Column size="80"/>
                          <Column size="70"/>
                          <Column size="80"/>
                          <Column size="85"/>
                          <Column size="140"/>
                          <Column size="100"/>
                          <Column size="120"/>
                          <Column size="100"/>
                          <Column size="0"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                          <Row size="22" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="상품코드"/>
                          <Cell col="2" text="바코드"/>
                          <Cell col="3" displaytype="text" text="상품명"/>
                          <Cell col="4" displaytype="text" text="규격"/>
                          <Cell col="5" displaytype="text" text="원산지"/>
                          <Cell col="6" displaytype="text" text="단위"/>
                          <Cell col="7" displaytype="text" text="보관"/>
                          <Cell col="8" displaytype="text" text="단가"/>
                          <Cell col="9" text="박스수량"/>
                          <Cell col="10" text="낱개수량"/>
                          <Cell col="11" displaytype="text" text="수량총계"/>
                          <Cell col="12" text="총중량(㎏)"/>
                          <Cell col="13" displaytype="text" text="금액"/>
                          <Cell col="14" displaytype="text" text="부가세"/>
                          <Cell col="15" displaytype="text" text="합계"/>
                          <Cell col="16" text="총중량(㎏)"/>
                          <Cell col="17" class="grd_WF_Essential" text="교환유형"/>
                          <Cell col="18" displaytype="text" text="비고(50자)"/>
                          <Cell col="19" displaytype="text" text="발주상태"/>
                          <Cell col="20" displaytype="text" text="마감"/>
                          <Cell col="21" displaytype="text" text="마감일"/>
                          <Cell col="22" text="업체직송여부"/>
                          <Cell col="23" displaytype="text" text="주문번호"/>
                          <Cell col="24" displaytype="text" text="발주구분"/>
                          <Cell col="25" text="발주시간"/>
                          <Cell col="26" displaytype="text" text="최종변경자"/>
                          <Cell col="27" text="등록자"/>
                        </Band>
                        <Band id="body">
                          <Cell celltype="head" displaytype="text" style="align:right;backgroundimage:EXPR(expr_GetRowTypeImg(currow));" expr="expr:currow + 1"/>
                          <Cell col="1" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:itemCode"/>
                          <Cell col="2" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:winItemCd"/>
                          <Cell col="3" displaytype="text" style="align:left;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));color:EXPR(iif(itemStatus == &quot;E&quot;,&quot;red&quot;,&quot;default&quot;));color2:EXPR(iif(itemStatus == &quot;E&quot;,&quot;red&quot;,&quot;default&quot;));" text="bind:itemName"/>
                          <Cell col="4" displaytype="text" style="align:left;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:itemSize"/>
                          <Cell col="5" displaytype="text" style="align:left;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:originType"/>
                          <Cell col="6" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:poUom"/>
                          <Cell col="7" displaytype="text" style="align:center middle;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:keepingType"/>
                          <Cell col="8" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:opPriceTax" mask="#,##0"/>
                          <Cell col="9" displaytype="number" edittype="expr:setEditExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;masknumber&quot;))" editfilter="expr:setfilterExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;integer&quot;))" style="align:right;background:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));background2:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));" text="bind:prBoxQty" mask="#,##0" editautoselect="true"/>
                          <Cell col="10" displaytype="number" edittype="expr:setEditExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;number&quot;))" style="align:right;background:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));background2:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));" text="bind:prPcQty" mask="#,##0.0" editautoselect="true"/>
                          <Cell col="11" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));color:EXPR(iif(prQty&lt;minOrdQty,&quot;red&quot;,&quot;default&quot;));color2:EXPR(iif(prQty&lt;minOrdQty,&quot;red&quot;,&quot;default&quot;));" text="bind:prQty" mask="#,##0.0"/>
                          <Cell col="12" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));color2: ;" text="bind:totWght" mask="#,##0.0"/>
                          <Cell col="13" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:opAmount" mask="#,##0"/>
                          <Cell col="14" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" expr="expr:Math.round(iif(taxCode==&quot;100&quot;,0.1,0)* opAmount)" mask="#,##0"/>
                          <Cell col="15" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" expr="expr:Math.round(iif(taxCode==&quot;100&quot;,1.1,1)* opAmount)" mask="#,##0"/>
                          <Cell col="16" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:totWght" mask="#,##0.0#"/>
                          <Cell col="17" displaytype="combo" edittype="expr:setEditExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;combo&quot;))" style="background:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));background2:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));" text="bind:rtnOrdType" combodataset="ds_rtnOrdType" combocodecol="code" combodatacol="codeName"/>
                          <Cell col="18" displaytype="text" edittype="expr:setEditExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;normal&quot;))" editfilter="expr:setfilterExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;normal&quot;))" style="align:left;background:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));background2:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));" text="bind:prRemark" editlimit="100" editimemode="native" editautoselect="true"/>
                          <Cell col="19" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:poLineStatus"/>
                          <Cell col="20" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:clsStatus"/>
                          <Cell col="21" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:dDayDisp"/>
                          <Cell col="22" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:vcYn"/>
                          <Cell col="23" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:prNum"/>
                          <Cell col="24" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:docuSource"/>
                          <Cell col="25" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:approveTime"/>
                          <Cell col="26" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));color:EXPR(iif(itemStatus == &quot;E&quot;,&quot;red&quot;,&quot;default&quot;));color2:EXPR(iif(itemStatus == &quot;E&quot;,&quot;red&quot;,&quot;default&quot;));" text="bind:updateByNm"/>
                          <Cell col="27" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:createBy"/>
                        </Band>
                        <Band id="summary">
                          <Cell displaytype="text" style="align:left;"/>
                          <Cell col="1" displaytype="text" style="align:center;" text="합  계"/>
                          <Cell col="2"/>
                          <Cell col="3" displaytype="number" style="align: ;" expr="expr:getCaseCount(&quot;prQty&gt;0&quot;)" mask="#,##0"/>
                          <Cell col="4" displaytype="text" style="align:left;" text="건"/>
                          <Cell col="5" displaytype="text" style="align:left;"/>
                          <Cell col="6" displaytype="text" style="align:left;"/>
                          <Cell col="7" displaytype="text" style="align:left;"/>
                          <Cell col="8" displaytype="number" style="align:right middle;" expr="expr:getSum(&quot;opPriceTax&quot;)" mask="#,##0"/>
                          <Cell col="9" displaytype="number" expr="expr:getSum(&quot;prBoxQty&quot;)" mask="#,##0"/>
                          <Cell col="10" displaytype="number" expr="expr:getSum(&quot;prPcQty&quot;)" mask="#,##0.0"/>
                          <Cell col="11" displaytype="number" style="align: ;" expr="expr:getSum(&quot;prQty&quot;)" mask="#,##0.0"/>
                          <Cell col="12" displaytype="number" expr="expr:getSum(&quot;totWght&quot;)" mask="#,##0.0"/>
                          <Cell col="13" displaytype="number" style="align: ;" expr="expr:getSum(&quot;opAmount&quot;)" mask="#,##0"/>
                          <Cell col="14" displaytype="number" style="align: ;" expr="expr:getCaseSum(&quot;taxCode=='100'&quot;,&quot;Math.round(opAmount/10)&quot;)" mask="#,##0"/>
                          <Cell col="15" displaytype="number" style="align: ;" expr="expr:getSum(&quot;Math.round(iif(taxCode=='100',1.1,1)* opAmount)&quot;)" mask="#,##0"/>
                          <Cell col="16"/>
                          <Cell col="17"/>
                          <Cell col="18" displaytype="text" style="align:left;"/>
                          <Cell col="19" displaytype="text" style="align:left;"/>
                          <Cell col="20" displaytype="text" style="align:left;"/>
                          <Cell col="21" displaytype="text" style="align:left;"/>
                          <Cell col="22"/>
                          <Cell col="23" displaytype="text" style="align:left;"/>
                          <Cell col="24" displaytype="text" style="align:left;"/>
                          <Cell col="25"/>
                          <Cell col="26"/>
                          <Cell col="27"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static58" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 15 10 573"/>
                  <Static id="Static03" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 5 311 455 316" anchor="left top"/>
                  <CheckBox id="chk_autoList" taborder="6" tabstop="false" text="자동등록" value="1" truevalue="1" falsevalue="0" position="absolute 390 38 476 62"/>
                  <CheckBox id="chk_Only" taborder="10" tabstop="false" text="주문가능 상품" value="1" truevalue="1" falsevalue="0" position="absolute 479 39 588 63" visible="false"/>
                  <Splitter id="sp_line2" type="vertical" class="spt_WF_2" position="absolute 0 281 1237 292" anchor="left top right" onmove="sp_line_onmove">
                    <Formats>
                      <Format id="default">
                        <SplitterItems id="items">
                          <SplitterItem id="item00" position="leftortop" bindtype="resize" componentid="gd_list2"/>
                          <SplitterItem id="item01" bindtype="move" position="rightorbottom" offset="4" componentid="Static01"/>
                          <SplitterItem id="item02" bindtype="resize" position="rightorbottom" offset="20" componentid="gd_listb2"/>
                          <SplitterItem id="item03" bindtype="move" position="rightorbottom" offset="4" componentid="sta_rtnOrdType"/>
                          <SplitterItem id="item04" bindtype="move" position="rightorbottom" offset="0" componentid="cbo_rtnOrdType"/>
                          <SplitterItem id="item05" bindtype="move" position="rightorbottom" offset="0" componentid="btn_rtnOrdTypeAllChg"/>
                        </SplitterItems>
                      </Format>
                    </Formats>
                  </Splitter>
                  <Static id="sta_rtnOrdType" text="교환유형" class="sta_WFSA_label" position="absolute 979 297 1039 309" anchor="top right" visible="true"/>
                  <Combo id="cbo_rtnOrdType" taborder="8" innerdataset="@ds_rtnOrdTypeAllChg" codecolumn="code" datacolumn="codeName" displayrowcount="10" position="absolute 1045 292 1165 312" anchor="top right" visible="true"/>
                  <Button id="btn_rtnOrdTypeAllChg" taborder="9" text="일괄적용" onclick="btn_rtnOrdTypeAllChg_onclick" position="absolute 1169 292 1226 312" anchor="top right" visible="true" class="btn_WF_Custom"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tab3" text="증정">
              <Layouts>
                <Layout>
                  <Static id="Static04" class="sta_WFSA_Labelbg01" position="absolute 10 31 1225 67" anchor="left top right"/>
                  <Grid id="gd_list3" taborder="1" binddataset="ds_List3" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 69 1225 282" anchor="left top right" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" autofittype="col" oncellclick="gd_list_OnCellClick" onkeydown="tab_list_tab3_gd_list_OnKeyDown" oncelldblclick="gd_list_OnCellDblClick" onheadclick="gd_list_OnHeadClick">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="26"/>
                          <Column size="85"/>
                          <Column size="100"/>
                          <Column size="220"/>
                          <Column size="120"/>
                          <Column size="70"/>
                          <Column size="70"/>
                          <Column size="100"/>
                          <Column size="70"/>
                          <Column size="70"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="60"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="상품코드"/>
                          <Cell col="2" displaytype="text" text="바코드"/>
                          <Cell col="3" displaytype="text" text="상품명"/>
                          <Cell col="4" displaytype="text" text="규격"/>
                          <Cell col="5" displaytype="text" text="단위"/>
                          <Cell col="6" displaytype="text" text="보관"/>
                          <Cell col="7" displaytype="text" text="단가"/>
                          <Cell col="8" displaytype="text" text="과/면세"/>
                          <Cell col="9" displaytype="text" text="마감일"/>
                          <Cell col="10" displaytype="text" text="g당단가"/>
                          <Cell col="11" displaytype="text" text="상품정보"/>
                          <Cell col="12" displaytype="text" text="공급업체"/>
                          <Cell col="13" displaytype="text" text="사진"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="image" style="background2: ;" text="expr:fn_SetRowImg(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS,EXCEPTION_ORDER)"/>
                          <Cell col="1" displaytype="text" style="align:center;background2: ;" text="bind:ITEM_CODE"/>
                          <Cell col="2" displaytype="text" style="align:center;background2: ;" text="bind:WIN_ITEM_CD"/>
                          <Cell col="3" displaytype="text" style="align:left;background2: ;backgroundimage:EXPR(gfn_isNull(FEATURE_ICON) ? &quot;&quot; : FEATURE_ICON);" text="bind:ITEM_NAME" expr="expr:gfn_isNull(FEATURE_ICON) ? ITEM_NAME : &quot; &quot;.padLeft(11, &quot; &quot;)   +  ITEM_NAME"/>
                          <Cell col="4" displaytype="text" style="align:left;background2: ;" text="bind:ITEM_SIZE"/>
                          <Cell col="5" displaytype="text" style="align:center;background2: ;" text="bind:PO_UOM"/>
                          <Cell col="6" displaytype="text" style="align:center middle;" text="bind:KEEPING_TYPE"/>
                          <Cell col="7" displaytype="number" style="background2: ;" text="bind:OP_PRICE_TAX" mask="#,##0"/>
                          <Cell col="8" displaytype="text" style="align:center;background2: ;" text="bind:TAX_CODE" expr="expr:decode(TAX_CODE, &quot;100&quot;, &quot;과세&quot;, &quot;210&quot;, &quot;면세&quot;, &quot;영세&quot;)"/>
                          <Cell col="9" displaytype="text" style="align:center;background2: ;" text="bind:D_DAY_DISP"/>
                          <Cell col="10" displaytype="number" style="background2: ;" text="bind:G_PRICE" mask="#,##0.0"/>
                          <Cell col="11" displaytype="text" style="align:left;background2: ;" text="bind:FEATURE_NAME"/>
                          <Cell col="12" displaytype="text" style="align:left;background2: ;" text="bind:OTCUSTNM"/>
                          <Cell col="13" displaytype="text" style="align:center;background2: ;" text="bind:IMAGE_YN"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Edit id="ed_Item" taborder="2" imemode="hangul" autoselect="true" onkeydown="ed_Item_OnKeyDown" class="edt_WF_Essential" position="absolute 110 38 296 61" tooltiptype="inplace,mouseleave" style="padding:1 20 0 5;"/>
                  <Combo id="cbo_Gbn" taborder="3" tabstop="false" value="88code" text="드바코" codecolumn="codecolumn" datacolumn="datacolumn" index="0" displayrowcount="10" class="cmb_WF_Essential" position="absolute 16 38 100 61" innerdataset="@ds_searchGbn" onitemchanged="tab_list_cbo_Gbn_onitemchanged"/>
                  <Button id="btn_search" taborder="4" tabstop="false" text="검색" onclick="btn_search_OnClick" onkeydown="btn_search_OnKeyDown" class="btn_WF_Find" position="absolute 306 38 361 61"/>
                  <Static id="Static10" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 100 39 110 60" anchor="left top"/>
                  <Static id="Static00" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 296 41 306 62" anchor="left top"/>
                  <Static id="Static18" text="증정상품검색" class="sta_WF_Title01" position="absolute 10 15 120 33" anchor="left top"/>
                  <Static id="Static62" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 8 282 458 297" anchor="left top"/>
                  <Static id="Static01" text="발주내역" class="sta_WF_Title01" position="absolute 10 298 97 316" anchor="left top"/>
                  <Static id="Static02" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 13 326 463 331" anchor="left top"/>
                  <Grid id="gd_listb3" taborder="5" binddataset="ds_Listb3" wheelscrollrow="1" autoenter="select" useinputpanel="false" cellsizingtype="both" cellmovingtype="col" autofitminwidth="981" position="absolute 8 316 1227 588" anchor="all" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" oncellclick="gd_list_oncellclick" onheadclick="gd_list_OnHeadClick1" onkeydown="gd_list_onkeydown" onselectchanged="gd_list_OnCellPosChanged">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="200"/>
                          <Column size="100"/>
                          <Column size="0"/>
                          <Column size="50"/>
                          <Column size="50"/>
                          <Column size="80"/>
                          <Column size="70"/>
                          <Column size="70"/>
                          <Column size="70"/>
                          <Column size="0"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="120"/>
                          <Column size="80"/>
                          <Column size="70"/>
                          <Column size="80"/>
                          <Column size="85"/>
                          <Column size="140"/>
                          <Column size="100"/>
                          <Column size="120"/>
                          <Column size="100"/>
                          <Column size="0"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                          <Row size="22" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="상품코드"/>
                          <Cell col="2" text="바코드"/>
                          <Cell col="3" displaytype="text" text="상품명"/>
                          <Cell col="4" displaytype="text" text="규격"/>
                          <Cell col="5" displaytype="text" text="원산지"/>
                          <Cell col="6" displaytype="text" text="단위"/>
                          <Cell col="7" displaytype="text" text="보관"/>
                          <Cell col="8" displaytype="text" text="단가"/>
                          <Cell col="9" text="박스수량"/>
                          <Cell col="10" text="낱개수량"/>
                          <Cell col="11" displaytype="text" text="수량총계"/>
                          <Cell col="12" text="총중량(㎏)"/>
                          <Cell col="13" displaytype="text" text="금액"/>
                          <Cell col="14" displaytype="text" text="부가세"/>
                          <Cell col="15" displaytype="text" text="합계"/>
                          <Cell col="16" text="총중량(㎏)"/>
                          <Cell col="17" displaytype="text" style="background:#566572ff URL('theme://images/new/grd_WF_Essential.png') left top;" class="grd_WF_Essential" text="증정유형"/>
                          <Cell col="18" displaytype="text" text="비고(50자)"/>
                          <Cell col="19" displaytype="text" text="발주상태"/>
                          <Cell col="20" displaytype="text" text="마감"/>
                          <Cell col="21" displaytype="text" text="마감일"/>
                          <Cell col="22" text="업체직송여부"/>
                          <Cell col="23" displaytype="text" text="주문번호"/>
                          <Cell col="24" displaytype="text" text="발주구분"/>
                          <Cell col="25" text="발주시간"/>
                          <Cell col="26" displaytype="text" text="최종변경자"/>
                          <Cell col="27" text="등록자"/>
                        </Band>
                        <Band id="body">
                          <Cell celltype="head" displaytype="text" style="align:right;backgroundimage:EXPR(expr_GetRowTypeImg(currow));" expr="expr:currow + 1"/>
                          <Cell col="1" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:itemCode"/>
                          <Cell col="2" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:winItemCd"/>
                          <Cell col="3" displaytype="text" style="align:left;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));color:EXPR(iif(itemStatus == &quot;E&quot;,&quot;red&quot;,&quot;default&quot;));color2:EXPR(iif(itemStatus == &quot;E&quot;,&quot;red&quot;,&quot;default&quot;));" text="bind:itemName"/>
                          <Cell col="4" displaytype="text" style="align:left;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:itemSize"/>
                          <Cell col="5" displaytype="text" style="align:left;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:originType"/>
                          <Cell col="6" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:poUom"/>
                          <Cell col="7" displaytype="text" style="align:center middle;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:keepingType"/>
                          <Cell col="8" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:opPriceTax" mask="#,##0"/>
                          <Cell col="9" displaytype="number" edittype="expr:setEditExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;masknumber&quot;))" editfilter="expr:setfilterExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;integer&quot;))" style="align:right;background:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));background2:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));" text="bind:prBoxQty" mask="#,##0" editautoselect="true"/>
                          <Cell col="10" displaytype="number" edittype="expr:setEditExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;number&quot;))" style="align:right;background:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));background2:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));" text="bind:prPcQty" mask="#,##0.0" editautoselect="true"/>
                          <Cell col="11" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));color:EXPR(iif(prQty&lt;minOrdQty,&quot;red&quot;,&quot;default&quot;));color2:EXPR(iif(prQty&lt;minOrdQty,&quot;red&quot;,&quot;default&quot;));" text="bind:prQty" mask="#,##0.0"/>
                          <Cell col="12" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));color2: ;" text="bind:totWght" mask="#,##0.0"/>
                          <Cell col="13" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:opAmount" mask="#,##0"/>
                          <Cell col="14" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" expr="expr:Math.round(iif(taxCode==&quot;100&quot;,0.1,0)* opAmount)" mask="#,##0"/>
                          <Cell col="15" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" expr="expr:Math.round(iif(taxCode==&quot;100&quot;,1.1,1)* opAmount)" mask="#,##0"/>
                          <Cell col="16" displaytype="number" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:totWght" mask="#,##0.0#"/>
                          <Cell col="17" displaytype="combo" edittype="expr:setEditExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;combo&quot;))" style="background:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));background2:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));" text="bind:rtnOrdType" combodataset="ds_rtnOrdType" combocodecol="code" combodatacol="codeName"/>
                          <Cell col="18" displaytype="text" edittype="expr:setEditExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;normal&quot;))" editfilter="expr:setfilterExpr(iif((clsStatus=='마감' || itemStatus=='E'),&quot;none&quot;,&quot;normal&quot;))" style="align:left;background:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));background2:EXPR(iif(clsStatus=='마감',&quot;thistle&quot;,iif(itemStatus=='E',&quot;white&quot;,&quot;lightyellow&quot;)));" text="bind:prRemark" editlimit="100" editimemode="native" editautoselect="true"/>
                          <Cell col="19" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:poLineStatus"/>
                          <Cell col="20" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:clsStatus"/>
                          <Cell col="21" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:dDayDisp"/>
                          <Cell col="22" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:vcYn"/>
                          <Cell col="23" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:prNum"/>
                          <Cell col="24" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:docuSource"/>
                          <Cell col="25" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:approveTime"/>
                          <Cell col="26" displaytype="text" style="align:center;background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));color:EXPR(iif(itemStatus == &quot;E&quot;,&quot;red&quot;,&quot;default&quot;));color2:EXPR(iif(itemStatus == &quot;E&quot;,&quot;red&quot;,&quot;default&quot;));" text="bind:updateByNm"/>
                          <Cell col="27" style="background:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(clsStatus==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:createBy"/>
                        </Band>
                        <Band id="summary">
                          <Cell displaytype="text" style="align:left;"/>
                          <Cell col="1" displaytype="text" style="align:center;" text="합  계"/>
                          <Cell col="2"/>
                          <Cell col="3" displaytype="number" style="align: ;" expr="expr:getCaseCount(&quot;prQty&gt;0&quot;)" mask="#,##0"/>
                          <Cell col="4" displaytype="text" style="align:left;" text="건"/>
                          <Cell col="5" displaytype="text" style="align:left;"/>
                          <Cell col="6" displaytype="text" style="align:left;"/>
                          <Cell col="7" displaytype="text" style="align:left;"/>
                          <Cell col="8" displaytype="number" style="align:right middle;" expr="expr:getSum(&quot;opPriceTax&quot;)" mask="#,##0"/>
                          <Cell col="9" displaytype="number" expr="expr:getSum(&quot;prBoxQty&quot;)" mask="#,##0"/>
                          <Cell col="10" displaytype="number" expr="expr:getSum(&quot;prPcQty&quot;)" mask="#,##0.0"/>
                          <Cell col="11" displaytype="number" style="align: ;" expr="expr:getSum(&quot;prQty&quot;)" mask="#,##0.0"/>
                          <Cell col="12" displaytype="number" expr="expr:getSum(&quot;totWght&quot;)" mask="#,##0.0"/>
                          <Cell col="13" displaytype="number" style="align: ;" expr="expr:getSum(&quot;opAmount&quot;)" mask="#,##0"/>
                          <Cell col="14" displaytype="number" style="align: ;" expr="expr:getCaseSum(&quot;taxCode=='100'&quot;,&quot;Math.round(opAmount/10)&quot;)" mask="#,##0"/>
                          <Cell col="15" displaytype="number" style="align: ;" expr="expr:getSum(&quot;Math.round(iif(taxCode=='100',1.1,1)* opAmount)&quot;)" mask="#,##0"/>
                          <Cell col="16"/>
                          <Cell col="17"/>
                          <Cell col="18" displaytype="text" style="align:left;"/>
                          <Cell col="19" displaytype="text" style="align:left;"/>
                          <Cell col="20" displaytype="text" style="align:left;"/>
                          <Cell col="21" displaytype="text" style="align:left;"/>
                          <Cell col="22"/>
                          <Cell col="23" displaytype="text" style="align:left;"/>
                          <Cell col="24" displaytype="text" style="align:left;"/>
                          <Cell col="25"/>
                          <Cell col="26"/>
                          <Cell col="27"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static58" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 15 10 573"/>
                  <Static id="Static03" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 5 311 455 316" anchor="left top"/>
                  <CheckBox id="chk_autoList" taborder="6" tabstop="false" text="자동등록" value="1" truevalue="1" falsevalue="0" position="absolute 390 38 476 62"/>
                  <CheckBox id="chk_Only" taborder="10" tabstop="false" text="주문가능 상품" value="1" truevalue="1" falsevalue="0" position="absolute 479 39 588 63" visible="false"/>
                  <Splitter id="sp_line3" type="vertical" class="spt_WF_2" position="absolute 0 281 1237 292" anchor="left top right" onmove="sp_line_onmove">
                    <Formats>
                      <Format id="default">
                        <SplitterItems id="items">
                          <SplitterItem id="item00" position="leftortop" bindtype="resize" componentid="gd_list3"/>
                          <SplitterItem id="item01" bindtype="move" position="rightorbottom" offset="4" componentid="Static01"/>
                          <SplitterItem id="item02" bindtype="resize" position="rightorbottom" offset="20" componentid="gd_listb3"/>
                          <SplitterItem id="item03" bindtype="move" position="rightorbottom" offset="4" componentid="sta_rtnOrdType"/>
                          <SplitterItem id="item04" bindtype="move" position="rightorbottom" offset="0" componentid="cbo_rtnOrdType"/>
                          <SplitterItem id="item05" bindtype="move" position="rightorbottom" offset="0" componentid="btn_rtnOrdTypeAllChg"/>
                        </SplitterItems>
                      </Format>
                    </Formats>
                  </Splitter>
                  <Static id="sta_rtnOrdType" text="증정유형" class="sta_WFSA_label" position="absolute 979 297 1039 309" anchor="top right" visible="true"/>
                  <Combo id="cbo_rtnOrdType" taborder="8" innerdataset="@ds_rtnOrdTypeAllChg" codecolumn="code" datacolumn="codeName" displayrowcount="10" position="absolute 1045 292 1165 312" anchor="top right" visible="true"/>
                  <Button id="btn_rtnOrdTypeAllChg" taborder="9" text="일괄적용" onclick="btn_rtnOrdTypeAllChg_onclick" position="absolute 1169 292 1226 312" anchor="top right" visible="true" class="btn_WF_Custom"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Static id="st_Days" text="(발주 마감 : D-0 00시)" position="absolute 875 41 1032 62" style="font:Gulim,9, bold;"/>
        <Static id="st_Timer" text="마감시간 : 00일 00시간 00분 전" class="sta_WF_RedhelpB" position="absolute 963 94 1236 106" anchor="top right" style="color:red;align:right middle;font:굴림,9,bold;"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 5 710 1257 725" anchor="left bottom"/>
        <Static id="Static00" text="#. 초기 설정&#13;&#10;    반환회수일 : sysdate + 1&#13;&#10;    발주마감시간 표시 : 반환회수일 기준&#13;&#10;    반환/교환 주문유형 : 공통코드(RTN_ORD_TYPE@SCC_COMMON_CODE)" position="absolute 1277 12 1751 128" style="linespace:10;background:antiquewhite;padding:20 20 20 20;align:left top;" visible="false"/>
        <Static id="Static01" text="#. 조회조건&#13;&#10;    - 사업장 : 브랜드유통사업장중 RTN_YN@FMS_UPJANG = 'Y'인 업장만 조회가능기능 추가&#13;&#10;( 연결팝업화면 : /hwfs_QA/WebContent/xui/form/fm/fms/BrandUpjangSearchPop.xfdl )&#13;&#10;    - 식당(창고) : FMZ_PO_SUBINV_S001.xml ( 사업장 변경시, 재조회 )&#13;&#10;    - 반환회수일 : 반환/교환/증정 tab 이동에 따라 label 변경 [ 반환회수일 /  교환주문일 / 증정주문일 ]&#13;&#10;    - 반환/교환/증정 D-1기준 발주 마감 시간 설정 정보(공통코드 GROUP_CODE = 'SYS_PROPERTY' AND CODE = 'SO_PR_RTN')&#13;&#10;&#9;  &#13;&#10;    - 상품검색 : default 바코드, 바코드조회 - like %keyword&#13;&#10;    - 바코드/F자재코드/자재명 변경시, 검색keyword 초기화&#13;&#10;    - hwfs_QA/WebContent/hwfs_svc/fm/fmp/FMP00082E_T001.jsp 활용하여 상품검색&#13;&#10;&#13;&#10;    - 발주내역에 상품코드 또는 바코드 붙여 넣기시 상품정보 표시(수량은 0으로)&#13;&#10;    - 자동등록 : 검색결과 단일항목인 경우 자동으로 발주내역으로 추가(default : 사용)" position="absolute 1279 140 2098 472" style="linespace:10;background:antiquewhite;padding:20 20 20 20;align:left top;" visible="false"/>
        <Static id="Static03" text="#. 저장 (FCUS.SO_PR_RTN)    &#13;&#10;    - tab전환시, 조회조건 초기화&#13;&#10;      , 저장하지 않은 데이터 존재시 Confirm MSG('저장하지 않은 발주 정보가 존재합니다. {before tab} 발주내용을 저장하고 {after tab}으로 전환하시겠습니까?')&#13;&#10;    - 반환tab(PO_TYPE : 52)&#13;&#10;        사업장 / 일자 선택시, 해당 동일 정보로 정상발주 내역이 있는지 확인 후(SO_PR/RC_UPJANG, NEED_DATE),&#13;&#10;        없는 경우 Alert MSG('{upjangName}사업장은 {needDate}에 정상 발주 정보가 존재하지 않습니다.')&#13;&#10;    - 교환tab(PO_TYPE : 62)&#13;&#10;      일반발주와 동일하게&#13;&#10;    - 증정tab(PO_TYPE : 72)&#13;&#10;      일반발주와 동일하게&#13;&#10;&#9;&#9;&#9;&#13;&#10;    - 동일업장/동일창고/동일주문일자/동일주문유형 = 동일 PR_NUM(Server Side에서 채번/grouping)&#13;&#10;&#13;&#10;    - 일반주문 [/hwfs_QA/WebContent/xui/mform/fm/fmp/FMP00080E.xfdl]" position="absolute 1279 483 2290 794" style="linespace:10;background:antiquewhite;padding:20 20 20 20;align:left top;" visible="false"/>
        <Static id="Static09" text="#. etc&#13;&#10;    - 상품코드(F/88) 클릭시 상품정보 팝업[ U_FMP::FMP00010P.xfdl ]" position="absolute 1280 814 1754 930" style="linespace:10;background:antiquewhite;padding:20 20 20 20;align:left top;" visible="false"/>
        <UpjangSearchComponent id="comp_upjang" titletext="업장 검색용 Component" taborder="0" text="UpjangSearchComponent" position="absolute 70 40 280 61" bindDataset="" bindUpjangCodeColumn="" bindUpjangNameColumn="" eventBeforeTrigger="fn_Trigger_bef" eventAfterTrigger="fn_Trigger_aft" roleSetId="" isUpjangControl=""/>
        <ObjCalendar id="cal_needDt" anchor="left top" titletext="캘린더" taborder="3" class="cal_WF_Essential" position="absolute 717 40 829 61" style="align:center middle;" visible="false"/>
        <Button id="btn_NeedDate" taborder="6" tabstop="false" onclick="g_CalButton_OnClick" class="btn_WF_cal" position="absolute 808 40 829 61" userdata="me_NeedDate"/>
        <MaskEdit id="me_NeedDate" taborder="2" type="string" mask="####-##-##" onsetfocus="g_Date_OnFocus" onkillfocus="me_NeedDate_onkillfocus" onkeydown="me_NeedDate_onkeydown" oneditclick="g_Date_OnFocus" canchange="me_NeedDate_canchange" ontextchanged="me_NeedDate_ontextchanged" class="msk_WF_Cal" position="absolute 717 40 809 61"/>
        <ProgressBar id="pgb_order" taborder="7" text="처리중..( 65% )" max="100" min="0" pos="65" blockgap="0" visible="false" position="absolute 1072 810 1248 828"/>
        <Static id="st_Week" text="(월)" position="absolute 838 41 866 62" style="font:Gulim,9,bold;"/>
        <!--<Static id="sta_rtnOrdType" text="반환유형" class="sta_WFSA_label" position="absolute 979 410 1039 422" anchor="top right" visible="true"/>
        <Combo id="cbo_rtnOrdType" taborder="8" innerdataset="@ds_rtnOrdTypeAllChg" codecolumn="code" datacolumn="codeName" displayrowcount="10" position="absolute 1045 405 1165 425" anchor="top right" visible="true"/>
        <Button id="btn_rtnOrdTypeAllChg" taborder="9" text="일괄적용" onclick="btn_rtnOrdTypeAllChg_onclick" position="absolute 1169 405 1226 425" anchor="top right" visible="true" class="btn_WF_Custom"/>
      -->
      </Layout>
    </Layouts>
    <Bind/>
    <Objects>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schNeedDt" type="STRING" size="256"/>
          <Column id="schMainUpjang" type="STRING" size="256"/>
          <Column id="schMainUpjangNm" type="STRING" size="256"/>
          <Column id="Column2" type="STRING" size="256"/>
          <Column id="Column3" type="STRING" size="256"/>
          <Column id="Column0" type="STRING" size="256"/>
          <Column id="Column1" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_List1" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="CENTER_FLAG" size="1" type="STRING"/>
          <Column id="CLS_STATUS" size="50" type="STRING"/>
          <Column id="CUSTCD" size="22" type="INT"/>
          <Column id="INVAT_FLAG" size="1" type="STRING"/>
          <Column id="ITEM_CODE" size="50" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="LINE_STATUS" size="50" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="OTCUSTCD" size="50" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" type="STRING"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="POINT_FLAG" size="1" type="STRING"/>
          <Column id="PR_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" type="STRING"/>
          <Column id="PR_UPJANG" size="22" type="INT"/>
          <Column id="RC_UPJANG" size="22" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="TAX_CODE" size="3" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="G_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" type="INT"/>
          <Column id="D_DAY_DISP" size="50" type="STRING"/>
          <Column id="D_TIMES" size="4" type="INT"/>
          <Column id="OTCUSTNM" size="100" type="STRING"/>
          <Column id="KG_CONVERT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="FEATURE_NAME" size="100" type="STRING"/>
          <Column id="IMAGE_PATH" size="200" type="STRING"/>
          <Column id="LIMIT_ITEM" size="50" type="STRING"/>
          <Column id="LIMIT_REASON" size="300" type="STRING"/>
          <Column id="WEEK_ITEM_CODE" size="300" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="IMAGE_YN" size="2" type="STRING"/>
          <Column id="KEEPING_TYPE" type="STRING" size="256"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="ORIGIN_TYPE" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
          <Column id="UNUSE_YN" type="STRING" size="256"/>
          <Column id="VAL_STP_YN" type="STRING" size="256"/>
          <Column id="WIN_ITEM_CD" type="STRING" size="256"/>
          <Column id="OP_PRICE_TAX" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Listb1" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" cancolumnchange="ds_List_CanColumnChange" oncolumnchanged="ds_List_OnColumnChanged">
        <ColumnInfo>
          <Column id="centerCode" size="22" prop="default" type="INT"/>
          <Column id="centerFlag" size="1" prop="default" type="STRING"/>
          <Column id="clsStatus" size="50" prop="default" type="STRING"/>
          <Column id="custcd" size="22" prop="default" type="INT"/>
          <Column id="invatFlag" size="1" prop="default" type="STRING"/>
          <Column id="itemCode" size="50" prop="default" type="STRING"/>
          <Column id="itemName" size="200" prop="default" type="STRING"/>
          <Column id="itemSize" size="100" prop="default" type="STRING"/>
          <Column id="lineStatus" size="50" prop="default" type="STRING"/>
          <Column id="marginPrice" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="minOrdQty" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="maxOrdQty" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="multiplierQty" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="needDate" size="8" prop="default" type="STRING"/>
          <Column id="otcustcd" size="50" prop="default" type="STRING"/>
          <Column id="outvatFlag" size="1" prop="default" type="STRING"/>
          <Column id="poUom" size="10" prop="default" type="STRING"/>
          <Column id="pointFlag" size="1" prop="default" type="STRING"/>
          <Column id="prId" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="prNum" size="50" prop="default" type="STRING"/>
          <Column id="prQty" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="prRemark" size="300" prop="default" type="STRING"/>
          <Column id="prUpjang" size="22" prop="default" type="INT"/>
          <Column id="rcUpjang" size="22" prop="default" type="INT"/>
          <Column id="saleAmount" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="salePrice" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="subinvCode" size="8" prop="default" type="STRING"/>
          <Column id="taxCode" size="3" prop="default" type="STRING"/>
          <Column id="unitPrice" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="opPrice" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="opAmount" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="dDays" size="4" prop="default" type="BIGDECIMAL"/>
          <Column id="dTimes" size="4" prop="default" type="BIGDECIMAL"/>
          <Column id="dDayDisp" size="200" prop="default" type="STRING"/>
          <Column id="imagePath" size="200" prop="default" type="STRING"/>
          <Column id="opAmountOld" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="docuSource" size="256" prop="default" type="STRING"/>
          <Column id="keepingType" type="STRING" size="256"/>
          <Column id="applySd" type="STRING" size="256"/>
          <Column id="vdSn" type="STRING" size="256"/>
          <Column id="mobileGubun" type="STRING" size="256"/>
          <Column id="originType" type="STRING" size="256"/>
          <Column id="maxSoQty" type="STRING" size="256"/>
          <Column id="upjangGrp" type="STRING" size="256"/>
          <Column id="poLineStatus" type="STRING" size="256"/>
          <Column id="opRate" type="STRING" size="256"/>
          <Column id="approveTime" type="STRING" size="256"/>
          <Column id="createBy" type="STRING" size="256"/>
          <Column id="prRemarkRecent" type="STRING" size="256"/>
          <Column id="tOrder" type="STRING" size="256"/>
          <Column id="kgConvertRate" type="STRING" size="256"/>
          <Column id="uomConvertRate" type="STRING" size="256"/>
          <Column id="totWght" type="STRING" size="256"/>
          <Column id="vcYn" type="STRING" size="256"/>
          <Column id="winItemCd" type="STRING" size="256"/>
          <Column id="prBoxQty" type="BIGDECIMAL" size="256"/>
          <Column id="prPcQty" type="BIGDECIMAL" size="256"/>
          <Column id="eventId" type="BIGDECIMAL" size="256"/>
          <Column id="boxQty" type="BIGDECIMAL" size="256"/>
          <Column id="inputType" type="STRING" size="256"/>
          <Column id="itemStatus" type="STRING" size="256"/>
          <Column id="weekItemCode" type="STRING" size="256"/>
          <Column id="limitItem" type="STRING" size="256"/>
          <Column id="limitReason" type="STRING" size="256"/>
          <Column id="unuseYn" type="STRING" size="256"/>
          <Column id="valStpYn" type="STRING" size="256"/>
          <Column id="dangaweekStatus" type="STRING" size="256"/>
          <Column id="consumYn" type="STRING" size="256"/>
          <Column id="approveNum" type="STRING" size="256"/>
          <Column id="opPriceS" type="STRING" size="256"/>
          <Column id="rtnOrdType" type="STRING" size="256"/>
          <Column id="sNeedDate" type="STRING" size="256"/>
          <Column id="gUpjang" type="STRING" size="256"/>
          <Column id="tabName" type="STRING" size="256"/>
          <Column id="updateByNm" type="STRING" size="256"/>
          <Column id="opPriceTax" size="22" prop="default" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="CENTER_FLAG" size="1" type="STRING"/>
          <Column id="CLS_STATUS" size="50" type="STRING"/>
          <Column id="CUSTCD" size="22" type="INT"/>
          <Column id="INVAT_FLAG" size="1" type="STRING"/>
          <Column id="ITEM_CODE" size="50" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="LINE_STATUS" size="50" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="OTCUSTCD" size="50" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" type="STRING"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="POINT_FLAG" size="1" type="STRING"/>
          <Column id="PR_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" type="STRING"/>
          <Column id="PR_UPJANG" size="22" type="INT"/>
          <Column id="RC_UPJANG" size="22" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="TAX_CODE" size="3" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="G_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" type="INT"/>
          <Column id="D_DAY_DISP" size="50" type="STRING"/>
          <Column id="D_TIMES" size="4" type="INT"/>
          <Column id="OTCUSTNM" size="100" type="STRING"/>
          <Column id="KG_CONVERT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="FEATURE_NAME" size="100" type="STRING"/>
          <Column id="IMAGE_PATH" size="200" type="STRING"/>
          <Column id="LIMIT_ITEM" size="50" type="STRING"/>
          <Column id="LIMIT_REASON" size="300" type="STRING"/>
          <Column id="WEEK_ITEM_CODE" size="300" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="IMAGE_YN" size="2" type="STRING"/>
          <Column id="KEEPING_TYPE" type="STRING" size="256"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="ORIGIN_TYPE" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
          <Column id="UNUSE_YN" type="STRING" size="256"/>
          <Column id="VAL_STP_YN" type="STRING" size="256"/>
          <Column id="WIN_ITEM_CD" type="STRING" size="256"/>
          <Column id="OP_PRICE_TAX" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Listb2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_List_OnColumnChanged" cancolumnchange="ds_List_CanColumnChange">
        <ColumnInfo>
          <Column id="centerCode" size="22" prop="default" type="INT"/>
          <Column id="centerFlag" size="1" prop="default" type="STRING"/>
          <Column id="clsStatus" size="50" prop="default" type="STRING"/>
          <Column id="custcd" size="22" prop="default" type="INT"/>
          <Column id="invatFlag" size="1" prop="default" type="STRING"/>
          <Column id="itemCode" size="50" prop="default" type="STRING"/>
          <Column id="itemName" size="200" prop="default" type="STRING"/>
          <Column id="itemSize" size="100" prop="default" type="STRING"/>
          <Column id="lineStatus" size="50" prop="default" type="STRING"/>
          <Column id="marginPrice" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="minOrdQty" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="maxOrdQty" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="multiplierQty" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="needDate" size="8" prop="default" type="STRING"/>
          <Column id="otcustcd" size="50" prop="default" type="STRING"/>
          <Column id="outvatFlag" size="1" prop="default" type="STRING"/>
          <Column id="poUom" size="10" prop="default" type="STRING"/>
          <Column id="pointFlag" size="1" prop="default" type="STRING"/>
          <Column id="prId" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="prNum" size="50" prop="default" type="STRING"/>
          <Column id="prQty" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="prRemark" size="300" prop="default" type="STRING"/>
          <Column id="prUpjang" size="22" prop="default" type="INT"/>
          <Column id="rcUpjang" size="22" prop="default" type="INT"/>
          <Column id="saleAmount" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="salePrice" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="subinvCode" size="8" prop="default" type="STRING"/>
          <Column id="taxCode" size="3" prop="default" type="STRING"/>
          <Column id="unitPrice" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="opPrice" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="opAmount" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="dDays" size="4" prop="default" type="BIGDECIMAL"/>
          <Column id="dTimes" size="4" prop="default" type="BIGDECIMAL"/>
          <Column id="dDayDisp" size="200" prop="default" type="STRING"/>
          <Column id="imagePath" size="200" prop="default" type="STRING"/>
          <Column id="opAmountOld" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="docuSource" size="256" prop="default" type="STRING"/>
          <Column id="keepingType" type="STRING" size="256"/>
          <Column id="applySd" type="STRING" size="256"/>
          <Column id="vdSn" type="STRING" size="256"/>
          <Column id="mobileGubun" type="STRING" size="256"/>
          <Column id="originType" type="STRING" size="256"/>
          <Column id="maxSoQty" type="STRING" size="256"/>
          <Column id="upjangGrp" type="STRING" size="256"/>
          <Column id="poLineStatus" type="STRING" size="256"/>
          <Column id="opRate" type="STRING" size="256"/>
          <Column id="approveTime" type="STRING" size="256"/>
          <Column id="createBy" type="STRING" size="256"/>
          <Column id="prRemarkRecent" type="STRING" size="256"/>
          <Column id="tOrder" type="STRING" size="256"/>
          <Column id="kgConvertRate" type="STRING" size="256"/>
          <Column id="uomConvertRate" type="STRING" size="256"/>
          <Column id="totWght" type="STRING" size="256"/>
          <Column id="vcYn" type="STRING" size="256"/>
          <Column id="winItemCd" type="STRING" size="256"/>
          <Column id="prBoxQty" type="BIGDECIMAL" size="256"/>
          <Column id="prPcQty" type="BIGDECIMAL" size="256"/>
          <Column id="eventId" type="BIGDECIMAL" size="256"/>
          <Column id="boxQty" type="BIGDECIMAL" size="256"/>
          <Column id="inputType" type="STRING" size="256"/>
          <Column id="itemStatus" type="STRING" size="256"/>
          <Column id="weekItemCode" type="STRING" size="256"/>
          <Column id="limitItem" type="STRING" size="256"/>
          <Column id="limitReason" type="STRING" size="256"/>
          <Column id="unuseYn" type="STRING" size="256"/>
          <Column id="valStpYn" type="STRING" size="256"/>
          <Column id="dangaweekStatus" type="STRING" size="256"/>
          <Column id="consumYn" type="STRING" size="256"/>
          <Column id="rtnOrdType" type="STRING" size="256"/>
          <Column id="approveNum" type="STRING" size="256"/>
          <Column id="opPriceS" type="STRING" size="256"/>
          <Column id="sNeedDate" type="STRING" size="256"/>
          <Column id="gUpjang" type="STRING" size="256"/>
          <Column id="tabName" type="STRING" size="256"/>
          <Column id="updateByNm" type="STRING" size="256"/>
          <Column id="opPriceTax" size="22" prop="default" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List3" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="CENTER_FLAG" size="1" type="STRING"/>
          <Column id="CLS_STATUS" size="50" type="STRING"/>
          <Column id="CUSTCD" size="22" type="INT"/>
          <Column id="INVAT_FLAG" size="1" type="STRING"/>
          <Column id="ITEM_CODE" size="50" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="LINE_STATUS" size="50" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="OTCUSTCD" size="50" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" type="STRING"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="POINT_FLAG" size="1" type="STRING"/>
          <Column id="PR_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" type="STRING"/>
          <Column id="PR_UPJANG" size="22" type="INT"/>
          <Column id="RC_UPJANG" size="22" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="TAX_CODE" size="3" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="G_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" type="INT"/>
          <Column id="D_DAY_DISP" size="50" type="STRING"/>
          <Column id="D_TIMES" size="4" type="INT"/>
          <Column id="OTCUSTNM" size="100" type="STRING"/>
          <Column id="KG_CONVERT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="FEATURE_NAME" size="100" type="STRING"/>
          <Column id="IMAGE_PATH" size="200" type="STRING"/>
          <Column id="LIMIT_ITEM" size="50" type="STRING"/>
          <Column id="LIMIT_REASON" size="300" type="STRING"/>
          <Column id="WEEK_ITEM_CODE" size="300" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="IMAGE_YN" size="2" type="STRING"/>
          <Column id="KEEPING_TYPE" type="STRING" size="256"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="ORIGIN_TYPE" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
          <Column id="UNUSE_YN" type="STRING" size="256"/>
          <Column id="VAL_STP_YN" type="STRING" size="256"/>
          <Column id="WIN_ITEM_CD" type="STRING" size="256"/>
          <Column id="OP_PRICE_TAX" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Listb3" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_List_OnColumnChanged" cancolumnchange="ds_List_CanColumnChange">
        <ColumnInfo>
          <Column id="centerCode" size="22" prop="default" type="INT"/>
          <Column id="centerFlag" size="1" prop="default" type="STRING"/>
          <Column id="clsStatus" size="50" prop="default" type="STRING"/>
          <Column id="custcd" size="22" prop="default" type="INT"/>
          <Column id="invatFlag" size="1" prop="default" type="STRING"/>
          <Column id="itemCode" size="50" prop="default" type="STRING"/>
          <Column id="itemName" size="200" prop="default" type="STRING"/>
          <Column id="itemSize" size="100" prop="default" type="STRING"/>
          <Column id="lineStatus" size="50" prop="default" type="STRING"/>
          <Column id="marginPrice" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="minOrdQty" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="maxOrdQty" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="multiplierQty" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="needDate" size="8" prop="default" type="STRING"/>
          <Column id="otcustcd" size="50" prop="default" type="STRING"/>
          <Column id="outvatFlag" size="1" prop="default" type="STRING"/>
          <Column id="poUom" size="10" prop="default" type="STRING"/>
          <Column id="pointFlag" size="1" prop="default" type="STRING"/>
          <Column id="prId" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="prNum" size="50" prop="default" type="STRING"/>
          <Column id="prQty" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="prRemark" size="300" prop="default" type="STRING"/>
          <Column id="prUpjang" size="22" prop="default" type="INT"/>
          <Column id="rcUpjang" size="22" prop="default" type="INT"/>
          <Column id="saleAmount" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="salePrice" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="subinvCode" size="8" prop="default" type="STRING"/>
          <Column id="taxCode" size="3" prop="default" type="STRING"/>
          <Column id="unitPrice" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="opPrice" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="opAmount" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="dDays" size="4" prop="default" type="BIGDECIMAL"/>
          <Column id="dTimes" size="4" prop="default" type="BIGDECIMAL"/>
          <Column id="dDayDisp" size="200" prop="default" type="STRING"/>
          <Column id="imagePath" size="200" prop="default" type="STRING"/>
          <Column id="opAmountOld" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="docuSource" size="256" prop="default" type="STRING"/>
          <Column id="keepingType" type="STRING" size="256"/>
          <Column id="applySd" type="STRING" size="256"/>
          <Column id="vdSn" type="STRING" size="256"/>
          <Column id="mobileGubun" type="STRING" size="256"/>
          <Column id="originType" type="STRING" size="256"/>
          <Column id="maxSoQty" type="STRING" size="256"/>
          <Column id="upjangGrp" type="STRING" size="256"/>
          <Column id="poLineStatus" type="STRING" size="256"/>
          <Column id="opRate" type="STRING" size="256"/>
          <Column id="approveTime" type="STRING" size="256"/>
          <Column id="createBy" type="STRING" size="256"/>
          <Column id="prRemarkRecent" type="STRING" size="256"/>
          <Column id="tOrder" type="STRING" size="256"/>
          <Column id="kgConvertRate" type="STRING" size="256"/>
          <Column id="uomConvertRate" type="STRING" size="256"/>
          <Column id="totWght" type="STRING" size="256"/>
          <Column id="vcYn" type="STRING" size="256"/>
          <Column id="winItemCd" type="STRING" size="256"/>
          <Column id="prBoxQty" type="BIGDECIMAL" size="256"/>
          <Column id="prPcQty" type="BIGDECIMAL" size="256"/>
          <Column id="eventId" type="BIGDECIMAL" size="256"/>
          <Column id="boxQty" type="BIGDECIMAL" size="256"/>
          <Column id="inputType" type="STRING" size="256"/>
          <Column id="itemStatus" type="STRING" size="256"/>
          <Column id="weekItemCode" type="STRING" size="256"/>
          <Column id="limitItem" type="STRING" size="256"/>
          <Column id="limitReason" type="STRING" size="256"/>
          <Column id="unuseYn" type="STRING" size="256"/>
          <Column id="valStpYn" type="STRING" size="256"/>
          <Column id="dangaweekStatus" type="STRING" size="256"/>
          <Column id="consumYn" type="STRING" size="256"/>
          <Column id="rtnOrdType" type="STRING" size="256"/>
          <Column id="approveNum" type="STRING" size="256"/>
          <Column id="opPriceS" type="STRING" size="256"/>
          <Column id="sNeedDate" type="STRING" size="256"/>
          <Column id="gUpjang" type="STRING" size="256"/>
          <Column id="tabName" type="STRING" size="256"/>
          <Column id="updateByNm" type="STRING" size="256"/>
          <Column id="opPriceTax" size="22" prop="default" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Cond">
        <ColumnInfo>
          <Column id="ITEM_NAME" size="100" type="STRING"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="UPJANG" size="22" type="INT"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="QTY_CONTROL_YN" size="1" type="STRING"/>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="AP_UNITPRICE_UPJANG" size="22" type="INT"/>
          <Column id="OTCUST_PRICE_UPJANG" size="22" type="INT"/>
          <Column id="FAVOR_GROUP" size="50" type="STRING"/>
          <Column id="NEED_DATEP" size="8" type="STRING"/>
          <Column id="UPJANGP" size="22" type="INT"/>
          <Column id="SUBINV_CODEP" size="8" type="STRING"/>
          <Column id="ITEM_CLASS2" size="8" type="STRING"/>
          <Column id="ITEM_CLASS3" size="8" type="STRING"/>
          <Column id="ITEM_CLASS4" size="8" type="STRING"/>
          <Column id="ITEM_CODE" size="256" type="STRING"/>
          <Column id="NEED_DATET" type="STRING" size="256"/>
          <Column id="UPJANGT" type="STRING" size="256"/>
          <Column id="SUBINV_CODET" type="STRING" size="256"/>
          <Column id="GBN" type="STRING" size="256"/>
          <Column id="TAB_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Subinv">
        <ColumnInfo>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="SUBINV_NAME_DISP" size="100" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_searchGbn" useclientlayout="true">
        <ColumnInfo>
          <Column id="codecolumn" type="STRING" size="255"/>
          <Column id="datacolumn" type="STRING" size="255"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="codecolumn">88</Col>
            <Col id="datacolumn">바코드</Col>
          </Row>
          <Row>
            <Col id="datacolumn">상품코드</Col>
            <Col id="codecolumn">ITEM_CODE</Col>
          </Row>
          <Row>
            <Col id="datacolumn">상품명</Col>
            <Col id="codecolumn">ITEM_NAME</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Days">
        <ColumnInfo>
          <Column id="D_DAYS" size="22" type="INT"/>
          <Column id="D_TIMES" size="4" type="STRING"/>
          <Column id="DAYS" size="50" type="STRING"/>
          <Column id="D_OVER_DAYS" size="22" type="INT"/>
          <Column id="QTY_CONTROL_YN" size="1" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CtUpj">
        <ColumnInfo>
          <Column id="AP_UNITPRICE_UPJANG" size="22" type="INT"/>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="OTCUST_PRICE_UPJANG" size="22" type="INT"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_OrdCtrl">
        <ColumnInfo>
          <Column id="CTRL_TYPE" size="50" type="STRING"/>
          <Column id="FRI" size="1" type="STRING"/>
          <Column id="ITEM_TYPE" size="50" type="STRING"/>
          <Column id="MON" size="1" type="STRING"/>
          <Column id="SAT" size="1" type="STRING"/>
          <Column id="SUN" size="1" type="STRING"/>
          <Column id="THU" size="1" type="STRING"/>
          <Column id="TUE" size="1" type="STRING"/>
          <Column id="WED" size="1" type="STRING"/>
          <Column id="CHK_TYPE" size="100" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ListCheck" cancolumnchange="ds_List_CanColumnChange" oncolumnchanged="ds_List_OnColumnChanged">
        <ColumnInfo>
          <Column id="CENTER_CODE" size="22" prop="default" type="INT"/>
          <Column id="CENTER_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="CLS_STATUS" size="50" prop="default" type="STRING"/>
          <Column id="CUSTCD" size="22" prop="default" type="INT"/>
          <Column id="INVAT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="ITEM_CODE" size="50" prop="default" type="STRING"/>
          <Column id="ITEM_NAME" size="200" prop="default" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" prop="default" type="STRING"/>
          <Column id="LINE_STATUS" size="50" prop="default" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" prop="default" type="STRING"/>
          <Column id="OTCUSTCD" size="50" prop="default" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="PO_UOM" size="10" prop="default" type="STRING"/>
          <Column id="POINT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="PR_ID" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="PR_NUM" size="50" prop="default" type="STRING"/>
          <Column id="PR_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" prop="default" type="STRING"/>
          <Column id="PR_UPJANG" size="22" prop="default" type="INT"/>
          <Column id="RC_UPJANG" size="22" prop="default" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" prop="default" type="STRING"/>
          <Column id="TAX_CODE" size="3" prop="default" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" prop="default" type="BIGDECIMAL"/>
          <Column id="D_TIMES" size="4" prop="default" type="BIGDECIMAL"/>
          <Column id="D_DAY_DISP" size="200" prop="default" type="STRING"/>
          <Column id="IMAGE_PATH" size="200" prop="default" type="STRING"/>
          <Column id="OP_AMOUNT_OLD" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="DOCU_SOURCE" size="256" prop="default" type="STRING"/>
          <Column id="KEEPING_TYPE" type="STRING" size="256"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="ORIGIN_TYPE" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="PO_LINE_STATUS" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
          <Column id="APPROVE_TIME" type="STRING" size="256"/>
          <Column id="CREATE_BY" type="STRING" size="256"/>
          <Column id="PR_REMARK_RECENT" type="STRING" size="256"/>
          <Column id="T_ORDER" type="STRING" size="256"/>
          <Column id="OP_PRICE_TAX" size="22" prop="default" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_BarcodeCond">
        <ColumnInfo>
          <Column id="ITEM_NAME" size="100" type="STRING"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="UPJANG" size="22" type="INT"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="QTY_CONTROL_YN" size="1" type="STRING"/>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="AP_UNITPRICE_UPJANG" size="22" type="INT"/>
          <Column id="OTCUST_PRICE_UPJANG" size="22" type="INT"/>
          <Column id="FAVOR_GROUP" size="50" type="STRING"/>
          <Column id="NEED_DATEP" size="8" type="STRING"/>
          <Column id="UPJANGP" size="22" type="INT"/>
          <Column id="SUBINV_CODEP" size="8" type="STRING"/>
          <Column id="ITEM_CLASS2" size="8" type="STRING"/>
          <Column id="ITEM_CLASS3" size="8" type="STRING"/>
          <Column id="ITEM_CLASS4" size="8" type="STRING"/>
          <Column id="ITEM_CODE" size="256" type="STRING"/>
          <Column id="NEED_DATET" type="STRING" size="256"/>
          <Column id="UPJANGT" type="STRING" size="256"/>
          <Column id="SUBINV_CODET" type="STRING" size="256"/>
          <Column id="GBN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Barcode" useclientlayout="true">
        <ColumnInfo>
          <Column id="BARCODE" type="STRING" size="256"/>
          <Column id="ITEM_STATUS" type="STRING" size="256"/>
          <Column id="ROW" type="INT" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_BarcodeResult">
        <ColumnInfo>
          <Column id="ITEM_CODE" type="STRING" size="50"/>
          <Column id="ITEM_NAME" type="STRING" size="1202"/>
          <Column id="ITEM_SIZE" type="STRING" size="2000"/>
          <Column id="PO_UOM" type="STRING" size="36"/>
          <Column id="UNIT_PRICE" type="BIGDECIMAL" size="22"/>
          <Column id="MARGIN_PRICE" type="BIGDECIMAL" size="22"/>
          <Column id="SALE_PRICE" type="BIGDECIMAL" size="22"/>
          <Column id="PR_QTY" type="BIGDECIMAL" size="39"/>
          <Column id="SALE_AMOUNT" type="BIGDECIMAL" size="39"/>
          <Column id="LINE_STATUS" type="STRING" size="3"/>
          <Column id="CLS_STATUS" type="STRING" size="6"/>
          <Column id="PR_REMARK" type="STRING" size="255"/>
          <Column id="SUBINV_CODE" type="STRING" size="32"/>
          <Column id="NEED_DATE" type="STRING" size="32"/>
          <Column id="PRE_NEED_DATE" type="STRING" size="255"/>
          <Column id="TAX_CODE" type="STRING" size="3"/>
          <Column id="CUSTCD" type="BIGDECIMAL" size="39"/>
          <Column id="CENTER_FLAG" type="STRING" size="10"/>
          <Column id="CENTER_CODE" type="STRING" size="6"/>
          <Column id="POINT_FLAG" type="STRING" size="1"/>
          <Column id="PR_UPJANG" type="STRING" size="32"/>
          <Column id="RC_UPJANG" type="STRING" size="32"/>
          <Column id="INVAT_FLAG" type="STRING" size="1"/>
          <Column id="OUTVAT_FLAG" type="STRING" size="1"/>
          <Column id="MIN_ORD_QTY" type="BIGDECIMAL" size="39"/>
          <Column id="MAX_ORD_QTY" type="BIGDECIMAL" size="39"/>
          <Column id="MULTIPLIER_QTY" type="BIGDECIMAL" size="39"/>
          <Column id="OTCUSTCD" type="STRING" size="50"/>
          <Column id="OP_RATE" type="BIGDECIMAL" size="39"/>
          <Column id="OP_AMOUNT_OLD" type="BIGDECIMAL" size="39"/>
          <Column id="D_DAYS" type="BIGDECIMAL" size="39"/>
          <Column id="D_TIMES" type="BIGDECIMAL" size="39"/>
          <Column id="D_DAY_DISP" type="STRING" size="42"/>
          <Column id="OTCUSTNM" type="STRING" size="100"/>
          <Column id="KG_CONVERT_RATE" type="BIGDECIMAL" size="39"/>
          <Column id="FEATURE_NAME_CHK" type="STRING" size="255"/>
          <Column id="IMAGE_PATH" type="STRING" size="1512"/>
          <Column id="IMAGE_YN" type="STRING" size="1"/>
          <Column id="CONSUM_YN" type="STRING" size="1"/>
          <Column id="PR_ID" type="STRING" size="255"/>
          <Column id="KEEPING_TYPE" type="STRING" size="120"/>
          <Column id="APPLY_SD" type="STRING" size="8"/>
          <Column id="VD_SN" type="STRING" size="50"/>
          <Column id="ORIGIN_TYPE" type="STRING" size="120"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="1"/>
          <Column id="UPJANG_GRP" type="STRING" size="18"/>
          <Column id="PO_STATUS" type="STRING" size="4000"/>
          <Column id="UNUSE_YN" type="STRING" size="4000"/>
          <Column id="VAL_STP_YN" type="STRING" size="4000"/>
          <Column id="FMP_STATUS" type="STRING" size="4000"/>
          <Column id="PO_WEEK_STATUS" type="STRING" size="4000"/>
          <Column id="DANGA_ITEM_CODE" type="STRING" size="255"/>
          <Column id="UOM_CONVERT_RATE" type="BIGDECIMAL" size="39"/>
          <Column id="TOT_WGHT" type="STRING" size="255"/>
          <Column id="FAVOR_GROUP_FLAG" type="STRING" size="50"/>
          <Column id="WIN_ITEM_CD" type="STRING" size="60"/>
          <Column id="EVENT_PRICE" type="BIGDECIMAL" size="39"/>
          <Column id="MAX_SO_QTY" type="BIGDECIMAL" size="39"/>
          <Column id="TOT_SO_AMT" type="BIGDECIMAL" size="39"/>
          <Column id="WEEK_ITEM_CODE" type="STRING" size="50"/>
          <Column id="DANGAWEEK_STATUS" type="STRING" size="2"/>
          <Column id="BOX_QTY" type="BIGDECIMAL" size="39"/>
          <Column id="OP_PRICE" type="BIGDECIMAL" size="39"/>
          <Column id="OP_AMOUNT" type="BIGDECIMAL" size="39"/>
          <Column id="G_PRICE" type="BIGDECIMAL" size="39"/>
          <Column id="EVENT_ID" type="BIGDECIMAL" size="39"/>
          <Column id="FEATURE_ICON" type="STRING" size="36"/>
          <Column id="FEATURE_NAME" type="STRING" size="8"/>
          <Column id="OP_PRICE_TAX" type="BIGDECIMAL" size="39"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_delListb" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="centerCode" size="22" prop="default" type="INT"/>
          <Column id="centerFlag" size="1" prop="default" type="STRING"/>
          <Column id="clsStatus" size="50" prop="default" type="STRING"/>
          <Column id="custcd" size="22" prop="default" type="INT"/>
          <Column id="invatFlag" size="1" prop="default" type="STRING"/>
          <Column id="itemCode" size="50" prop="default" type="STRING"/>
          <Column id="itemName" size="200" prop="default" type="STRING"/>
          <Column id="itemSize" size="100" prop="default" type="STRING"/>
          <Column id="lineStatus" size="50" prop="default" type="STRING"/>
          <Column id="marginPrice" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="minOrdQty" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="maxOrdQty" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="multiplierQty" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="needDate" size="8" prop="default" type="STRING"/>
          <Column id="otcustcd" size="50" prop="default" type="STRING"/>
          <Column id="outvatFlag" size="1" prop="default" type="STRING"/>
          <Column id="poUom" size="10" prop="default" type="STRING"/>
          <Column id="pointFlag" size="1" prop="default" type="STRING"/>
          <Column id="prId" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="prNum" size="50" prop="default" type="STRING"/>
          <Column id="prQty" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="prRemark" size="300" prop="default" type="STRING"/>
          <Column id="prUpjang" size="22" prop="default" type="INT"/>
          <Column id="rcUpjang" size="22" prop="default" type="INT"/>
          <Column id="saleAmount" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="salePrice" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="subinvCode" size="8" prop="default" type="STRING"/>
          <Column id="taxCode" size="3" prop="default" type="STRING"/>
          <Column id="unitPrice" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="opPrice" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="opAmount" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="dDays" size="4" prop="default" type="BIGDECIMAL"/>
          <Column id="dTimes" size="4" prop="default" type="BIGDECIMAL"/>
          <Column id="dDayDisp" size="200" prop="default" type="STRING"/>
          <Column id="imagePath" size="200" prop="default" type="STRING"/>
          <Column id="opAmountOld" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="docuSource" size="256" prop="default" type="STRING"/>
          <Column id="keepingType" type="STRING" size="256"/>
          <Column id="applySd" type="STRING" size="256"/>
          <Column id="vdSn" type="STRING" size="256"/>
          <Column id="mobileGubun" type="STRING" size="256"/>
          <Column id="originType" type="STRING" size="256"/>
          <Column id="maxSoQty" type="STRING" size="256"/>
          <Column id="upjangGrp" type="STRING" size="256"/>
          <Column id="poLineStatus" type="STRING" size="256"/>
          <Column id="opRate" type="STRING" size="256"/>
          <Column id="approveTime" type="STRING" size="256"/>
          <Column id="createBy" type="STRING" size="256"/>
          <Column id="prRemarkRecent" type="STRING" size="256"/>
          <Column id="tOrder" type="STRING" size="256"/>
          <Column id="kgConvertRate" type="STRING" size="256"/>
          <Column id="uomConvertRate" type="STRING" size="256"/>
          <Column id="totWght" type="STRING" size="256"/>
          <Column id="vcYn" type="STRING" size="256"/>
          <Column id="winItemCd" type="STRING" size="256"/>
          <Column id="prBoxQty" type="BIGDECIMAL" size="256"/>
          <Column id="prPcQty" type="BIGDECIMAL" size="256"/>
          <Column id="eventId" type="BIGDECIMAL" size="256"/>
          <Column id="boxQty" type="BIGDECIMAL" size="256"/>
          <Column id="inputType" type="STRING" size="256"/>
          <Column id="itemStatus" type="STRING" size="256"/>
          <Column id="weekItemCode" type="STRING" size="256"/>
          <Column id="limitItem" type="STRING" size="256"/>
          <Column id="limitReason" type="STRING" size="256"/>
          <Column id="unuseYn" type="STRING" size="256"/>
          <Column id="valStpYn" type="STRING" size="256"/>
          <Column id="dangaweekStatus" type="STRING" size="256"/>
          <Column id="consumYn" type="STRING" size="256"/>
          <Column id="approveNum" type="STRING" size="256"/>
          <Column id="opPriceS" type="STRING" size="256"/>
          <Column id="rtnOrdType" type="STRING" size="256"/>
          <Column id="sNeedDate" type="STRING" size="256"/>
          <Column id="gUpjang" type="STRING" size="256"/>
          <Column id="tabName" type="STRING" size="256"/>
          <Column id="opPriceTax" size="22" prop="default" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_rtnOrdType" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_rtnOrderYn" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="orderCnt" type="STRING" size="256"/>
          <Column id="rtnOrderYn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_WeekendTime">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="SET1" type="STRING" size="256"/>
          <Column id="SET2" type="STRING" size="256"/>
          <Column id="SET3" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codename" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_msg" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="NO" type="STRING" size="256"/>
          <Column id="TYPE" type="STRING" size="256"/>
          <Column id="MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_save_out" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="ITEM_CODE" type="STRING" size="256"/>
          <Column id="ITEM_NAME" type="STRING" size="256"/>
          <Column id="ITEM_VAL" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_msg_out" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="NO" type="STRING" size="256"/>
          <Column id="TYPE" type="STRING" size="256"/>
          <Column id="MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ListbValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" cancolumnchange="ds_List_CanColumnChange" oncolumnchanged="ds_List_OnColumnChanged">
        <ColumnInfo>
          <Column id="rtnOrdType" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="rtnOrdType">title:반환유형,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_rtnOrdTypeAllChg" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : ReturnOrderBySales
  파 일 명 : ReturnOrderBySales.xfdl
  기    능 : 반환/교환/증정발주

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2021.08.06   Jaey   최초 생성
  
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "U_lib::lib_conversionCom.xjs";
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"			// 시스템 공통
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"		//JAVA 코딩시
//@@컨버터에서 주석처리 #include "LIB::tit_comm_0001.js"		// X-Framework Lib
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"		// 공통팝업
//@@컨버터에서 주석처리 #include "lib::fm_common.js"			// FM공통
//=========================================================================================
// [ PART 2 ]    
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var fa_Sql;
var fa_sDay;
//var fa_DocSrc = '07 FM(상품)';
//var fa_DocSrc1 = '07 FM';             //구 푸드엠 주문내용  ---> 상품발주로 간주
//var fa_DocSrc2 = '01 BO';             //통합영업 주문내용   ---> 상품발주로 간주
//var fa_DocSrc3 = '07 FM(모바일)';    //모바일 주문내용
var pre_need_date = gfn_addDate(gfn_today(),1);  				  //날짜 변경전 이전 날짜 기억
var fa_weekendTimeCheck = "N"; // 주말 발주 통제 여부
var fa_startTime; // 통제시작시간
var fa_endTime; // 통제종료시간

var fv_objColInfo;				//데이터셋 컬럼정보

//최초등록시 주문번호 채번, 이후에는 같은 주문번호로 발주되도록 함
//var fn_gubunNewOrOld = "NEW";
//var fn_maxPrNum = "";
//var fn_maxApproveNum = "";
//var fn_maxBefApproveNum = "";
var fn_dsListbCnt = 0;
var pre_need_date_temp = ""; //달력 컴포넌트 날짜 변경 전 이전 날짜 기억 2017.10.13 김호석 추가
var fv_chkMsg = "";

//[PJT]주문채널통합
var fv_isCopyPaste = false;     //ctrl + v 작업중인지 확인하는 flag
var fv_searchBarcodeRowCnt = 3; //바코드 처리를 위한 row값(PAGING)
var fv_searchBarcodeRowIdx = 0; //바코드 처리를 위한 row값 저장변수 (설정 X)
//copyrow 변환값
var fv_copyColumInfo = "itemCode=ITEM_CODE,itemName=ITEM_NAME,itemSize=ITEM_SIZE,poUom=PO_UOM,unitPrice=UNIT_PRICE,marginPrice=MARGIN_PRICE,salePrice=SALE_PRICE,prQty=PR_QTY,saleAmount=SALE_AMOUNT,lineStatus=LINE_STATUS,clsStatus=CLS_STATUS,prRemark=PR_REMARK,subinvCode=SUBINV_CODE,needDate=NEED_DATE,preNeedDate=PRE_NEED_DATE,taxCode=TAX_CODE,custcd=CUSTCD,centerFlag=CENTER_FLAG,centerCode=CENTER_CODE,pointFlag=POINT_FLAG,prUpjang=PR_UPJANG,rcUpjang=RC_UPJANG,invatFlag=INVAT_FLAG,outvatFlag=OUTVAT_FLAG,minOrdQty=MIN_ORD_QTY,maxOrdQty=MAX_ORD_QTY,multiplierQty=MULTIPLIER_QTY,otcustcd=OTCUSTCD,opPrice=OP_PRICE,opPriceTax=OP_PRICE_TAX,opRate=OP_RATE,opAmount=OP_AMOUNT,gPrice=G_PRICE,opAmountOld=OP_AMOUNT_OLD,dDays=D_DAYS,dTimes=D_TIMES,dDayDisp=D_DAY_DISP,otcustnm=OTCUSTNM,kgConvertRate=KG_CONVERT_RATE,featureNameChk=FEATURE_NAME_CHK,imagePath=IMAGE_PATH,imageYn=IMAGE_YN,consumYn=CONSUM_YN,prId=PR_ID,keepingType=KEEPING_TYPE,applySd=APPLY_SD,vdSn=VD_SN,originType=ORIGIN_TYPE,mobileGubun=MOBILE_GUBUN,upjangGrp=UPJANG_GRP,poStatus=PO_STATUS,unuseYn=UNUSE_YN,valStpYn=VAL_STP_YN,fmpStatus=FMP_STATUS,poWeekStatus=PO_WEEK_STATUS,dangaItemCode=DANGA_ITEM_CODE,uomConvertRate=UOM_CONVERT_RATE,totWght=TOT_WGHT,favorGroupFlag=FAVOR_GROUP_FLAG,winItemCd=WIN_ITEM_CD,eventId=EVENT_ID,eventPrice=EVENT_PRICE,maxSoQty=MAX_SO_QTY,totSoAmt=TOT_SO_AMT,featureName=FEATURE_NAME,featureIcon=FEATURE_ICON,weekItemCode=WEEK_ITEM_CODE,dangaweekStatus=DANGAWEEK_STATUS,boxQty=BOX_QTY,prBoxQty=PR_BOX_QTY,prPcQty=PR_PC_QTY";
var fv_rtnYn = "Y"; //반환가능업장YN

var copyYn = true; //예외품목 copy&paste 가능여부
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);
	//gfn_formOnLoad(this);
	
	//간혹..onactivate의 setTimer가 안먹히는 경우 발생..load시 먼저 해준다.
	setTimer(777,30000); //일단 30초 세팅
	
	//초기화
	fsp_init(this);
	
	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	v_ds_check = "ds_Listb1;ds_Listb2;ds_Listb3";

	// 공통코드 조회
	//trace(application.g_EmpNo+" : "+application.g_Name+" , "+application.gv_upjang+" : "+application.gv_upjangnm);	
	var v_dsS;
	SCDataset.bind(this, "ComCode", "v_dsS", {groupCode:"PRESENT_ORD", useYn:"Y", code:application.g_EmpNo}, "fn_afterUserInfo");
	//SCDataset.bind(this, "ComCode", "v_dsS", {groupCode:"PRESENT_ORD", useYn:"Y", code:"201907397"}, "fn_afterUserInfo");

	//반환/교환/증정 유형코드 ( 공통코드 )
	SCDataset.bind(this, "ComCode", "ds_rtnOrdType", {groupCode:"RTN_ORD_TYPE", useYn:"Y"}, "fn_callbakRtnOrdType");
	
	//마감시간
	var v_dsT;
	SCDataset.bind(this, "ComCode", "v_dsT", {groupCode:"SYS_PROPERTY", useYn:"Y", code:"SO_PR_RTN"});
	
	comp_upjang.setRoleSetId("BrandUpjang");	// 브랜드 유통사업장 roleSetId
	comp_upjang.setUpjangCode("");
	comp_upjang.setUpjangName("");
	comp_upjang.isUpjangControl = true; //반환의경우 RTN_YN == Y 
	
	//초기화
	fn_ResetData();
	
	//Init 조회 서비스(속도 개선 async 통신으로 변경) 
	//load 시 바로 업장세팅이 된다면 필요!
    fn_InitService();
}


function fn_InitService()
{
   	////////// 1. 센터단가업장정보 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc, trId;
	trId  = "searchCtUpj";
    outData		= "ds_CtUpj=ds_List";
    otherArg	= "UPJANG=" + gfn_nvl(wrapQuote(comp_upjang.getUpjangCode()),"");
    callBackFnc = "fn_CallbakInitService";
	fsp_clear(this); 
	fsp_addSearch(this, "fm/fmz:FMZ_GET_CTUPJ_S001");
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc, "", "", "", trId);
}

function fn_CallbakInitService(errCode, errMsg, svcId)
{	
	if (errCode == 0)
	{	    
	    switch(svcId)
		{
			case "searchCtUpj":
				
				if (ds_CtUpj.rowcount <= 0)
				{
					//g_Message("EE","업장기초정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
					return;
				}
				
				////////// 2. 창고 조회
				ds_Subinv.clearData();
				var actionName, cmdName, inData, outData, otherArg, callBackFnc, trId;
				trId  = "searchSubinv";
				outData		= "ds_Subinv=ds_List";
				otherArg	= "UPJANG=" + gfn_nvl(wrapQuote(comp_upjang.getUpjangCode()),"");
				callBackFnc = "fn_CallbakInitService";				
				fsp_clear(this); 
				fsp_addSearch(this, "fm/fmz:FMZ_PO_SUBINV_S001");
				fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc, true, "", "", trId);
	            
				break;
			
			case "searchSubinv":
				//기본창고지정
	            if (ds_Subinv.rowcount > 0) cbo_Subinv.index = 0;
	            
	            ////////// 3. 디데이 조회
				ds_Days.clearData();
				var actionName, cmdName, inData, outData, otherArg, callBackFnc, trId;
				trId  = "searchDays";
				outData		= "ds_Days=ds_List";
				otherArg	= "UPJANG=" + gfn_nvl(wrapQuote(comp_upjang.getUpjangCode()),"") + " SUBINV_CODE=" + wrapQuote(cbo_Subinv.value) + " NEED_DATE=" + wrapQuote(me_NeedDate.value);
				callBackFnc = "fn_CallbakInitService";
				fsp_clear(this); 
				fsp_addSearch(this, "fm/fmz:FMZ_GETDAYS_S001");
				fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc, "", "", "", trId);
				
				////////// 4. 주문통제 조회
				ds_OrdCtrl.clearData();
				var actionName, cmdName, inData, outData, otherArg, callBackFnc, trId;
				trId  = "searchOrdCtrl";
				outData		= "ds_OrdCtrl=ds_List";
				otherArg	= "UPJANG=" + gfn_nvl(wrapQuote(comp_upjang.getUpjangCode()),"");
				callBackFnc = "fn_CallbakInitService";
				fsp_clear(this); 
				fsp_addSearch(this, "fm/fmz:FMZ_ORD_CTRL_S001");
				fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc, "", "", "", trId);
				
				//자동조회
				fn_search();

				break;
				
			case "searchDays":
				
				//디데이 표시				
				if (ds_Days.rowcount > 0) {
					var set1 = v_dsT.getColumn(0, "set1");
					var set2 = v_dsT.getColumn(0, "set2");
					var attr01 = v_dsT.getColumn(0, "attr01");
					var attr02 = v_dsT.getColumn(0, "attr02");		
					if(set1 <= me_NeedDate.value && set2 >= me_NeedDate.value){		
						ds_Days.setColumn(0,"D_TIMES" ,attr01);		
						ds_Days.setColumn(0,"DAYS", "D-"+ds_Days.getColumn(0,"D_DAYS")+" "+attr01.substr(0,2)+":"+attr01.substr(2,2));		
					} else {		
						ds_Days.setColumn(0,"D_TIMES" ,attr02);		
						ds_Days.setColumn(0,"DAYS", "D-"+ds_Days.getColumn(0,"D_DAYS")+" "+attr02.substr(0,2)+":"+attr02.substr(2,2));		
					}
					st_Days.text = "(발주 마감 : " + ds_Days.getColumn(0,"DAYS") + ")";
				} else {
					g_Message("EE","발주마감정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
				}
	            
				break;	
				
			default:
				break;
		}
	    
	} else {
		g_Message("EE",fn_AlertMsg("002"));
	}
}


//=========================================================================================
// [ PART 4 ] 
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*------------------------------------------------------------(60)
	1. Function ID : fn_Search()
	2. 개       요 : 업무프로세스에 따른 조회작업
	3. 기       능 : 검색조건에 해당하는 정보를 조회
	4. 인 수 설 명 : 
*/
function fn_search(isSave)
{

	// 발주저장전 발주상태 재확인
	if ( gfn_isNull(isSave) ) {
		isSave = false;
	}
		
	//필수항목 
	if (fn_ChkManNull()) return;
	
	//입고통제일 체크 
	if (fn_NeedDateCheck()) 
	{
	    g_Message("EE","해당일자는 입고통제일 입니다.");
	    eval("ds_List" + gfn_toString(tab_list.tabindex+1)).clearData();
	    eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).clearData();
	    st_Timer.text = "마감시간 : 00일 00시간 00분 전";
		
		return;
	}	
	
	//2017.10.13 김호석 추가 입고일자 변경 전으로 되돌림
	pre_need_date_temp = me_NeedDate.value;
		
	fn_SetTimer();
	//최종발주정보
	
	//fn_GetLastOrd();
	//fn_getBudgetInfo();
	// 초기화
	ds_Cond.clearData();
	
	//st_ctrlAmt.visible = false;
	
	if ( !isSave ) {
		eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).clearData();
	}
	
	//alert(tab_list.tabpages[tab_list.tabindex].name);			
	ds_Cond.addRow();	
	ds_Cond.setColumn(0, "TAB_NAME",    tab_list.tabpages[tab_list.tabindex].name);
	ds_Cond.setColumn(0, "SUBINV_CODE",    cbo_Subinv.value);
	ds_Cond.setColumn(0, "NEED_DATE",      me_NeedDate.value);
	ds_Cond.setColumn(0, "QTY_CONTROL_YN", ds_Days.getColumn(0,"QTY_CONTROL_YN"));
	
	// 조회
// 	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
// 	
// 	// 파라미터셋팅
//     inData		= "ds_Cond=ds_Cond";
//     
//     if ( isSave ) {
// 		outData		= "ds_ListCheck=ds_List";
// 		callBackFnc	= "";
//     } else {					  
// 		outData		= "ds_Listb" + gfn_toString(tab_list.tabindex+1)+ "=ds_List";
// 		callBackFnc	= "fn_CallBack_Search";
//     }
//     
//     
// 	otherArg    = "DocSrc=" + wrapQuote(fa_DocSrc);
// 	otherArg   += " DocSrc1=" + wrapQuote(fa_DocSrc1);
// 	otherArg   += " DocSrc2=" + wrapQuote(fa_DocSrc2);
// 	otherArg   += " DocSrc3=" + wrapQuote(fa_DocSrc3);
// 	//action 정보 초기화 
// 	fsp_clear(this); 
//     // 서버에서 조회할 정보 추가 
// 	fsp_addSearch(this, "fm/fmp:FMP00161E_S002"); //[PJT]주문채널통합
// 	// 서버 호출 
// 	http.Sync = true;
//     fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
//     http.Sync = false;
//     
//  
    //서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장 
	fv_objColInfo = gfn_getDatasetInfo (eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)));
    
    if ( isSave ) {
		var strOutDs	= "ds_ListCheck=ds_List";
		var strCallback	= "";
    } else {					  
		var strOutDs	= "ds_Listb" + gfn_toString(tab_list.tabindex+1)+ "=ds_List";
		var strCallback	= "fn_CallBack_Search";
    }
    
    var strSvcID    = "search";
    var strURL      = "fm/fms/returnOrderBySales/selectReturnOrderBySalesList.xdo";
    var strInDs     = "ds_Cond=ds_Cond:A";
    //var strOutDs    = "ds_Listb" + gfn_toString(tab_list.tabindex+1)+ "=ds_List";
    var strArg      = "";
    //var strCallback = "fn_CallBack_Search";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
    
    
    //trace(ds_ListCheck.saveXML());
    if ( isSave ) {
		
		//fn_getOrderCtrlList();
		
		// save check 로직에서 dateset 확인
		return ds_ListCheck;
    }
    
    /*
    if (ed_Green.visible == true)
    {
		//보조금 금액 재 계산 프로시져 호출     
		fn_Create_Green_Amt();
		
		//보조금 사용 후 잔액 조회
		//fn_Green_Amt();    
    } 
    */
}
function fn_NeedDateCheck()
{
	//ds임시생성
	var dsObjin, dsObjot;
		
	create("Dataset", "ds_Dummyin");
	create("Dataset", "ds_Dummyot");
	
	dsObjin = eval("ds_Dummyin");
	dsObjin.addColumn("UPJANG", "INT", 22);
	dsObjin.addColumn("NEED_DATE", "STRING", 8);
	dsObjot = eval("ds_Dummyot");
	dsObjot.addColumn("CNT", "INT", 22);
	
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 초기화
	ds_Dummyin.clearData();
	ds_Dummyot.clearData();
	ds_Dummyin.addRow();
	ds_Dummyin.setColumn(0, "UPJANG",         comp_upjang.getUpjangCode());
	ds_Dummyin.setColumn(0, "NEED_DATE",      me_NeedDate.value);
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    inData		= "ds_Cond=ds_Dummyin";
    outData		= "ds_Dummyot=ds_List";
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_ORD_CTRL_S002");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	var bYn = (ds_Dummyot.getColumn(0, "CNT") > 0);
	//ds임시생성 해제
	Destroy("ds_Dummyin");
	Destroy("ds_Dummyot");
	
	return bYn;
}

function fn_SearchItem()
{
	if ( ffn_ChkNull(eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.value) ) { //&& ffn_ChkNull(tab_list.tab1.cbo_Class4.value) ) {
		//g_Message("EE", "세분류 또는 상품검색어를 입력하세요.");
		g_Message("EE", "상품검색어를 입력하세요.");
		eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.setFocus();
		//return false;
	}
	
	var gbn = eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).cbo_Gbn.value;
	var itemName = eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.text;

	//바코드 의 입력값의 길이는 6 이상이어야 합니다.
	if(gbn == "88" && !ffn_ChkNull(itemName) && itemName.length < 6){
		g_Message("EE", "바코드의 입력값의 길이는 6 이상이어야 합니다.");
		eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.setFocus();
		return false;
	}

	//필수항목 
	if (fn_ChkManNull()) return;
	
	//발주가능 체크
	if (! fn_OrdChk())
	{
		btn_NeedDate.setFocus();
		return;
	}
/*
	//입고통제일 체크 
	if (fn_NeedDateCheck()) 
	{
	    g_Message("EE","해당일자는 입고통제일 입니다.");
		return;
	}	
*/
	// 초기화
	ds_Cond.clearData();
	eval("ds_List" + gfn_toString(tab_list.tabindex+1)).clearData();
	
	ds_Cond.addRow();
	ds_Cond.setColumn(0, "UPJANG",        comp_upjang.getUpjangCode());
	ds_Cond.setColumn(0, "SUBINV_CODE",   cbo_Subinv.value);
	ds_Cond.setColumn(0, "NEED_DATE",     me_NeedDate.value);
	ds_Cond.setColumn(0, "CONSUM_YN",     ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN"));
	ds_Cond.setColumn(0, "QTY_CONTROL_YN",ds_Days.getColumn(0,"QTY_CONTROL_YN"));
	ds_Cond.setColumn(0, "CENTER_CODE",   			ds_CtUpj.getColumn(0,"CENTER_CODE"));
	ds_Cond.setColumn(0, "AP_UNITPRICE_UPJANG",     ds_CtUpj.getColumn(0,"AP_UNITPRICE_UPJANG"));
	ds_Cond.setColumn(0, "OTCUST_PRICE_UPJANG",     ds_CtUpj.getColumn(0,"OTCUST_PRICE_UPJANG"));
	ds_Cond.setColumn(0, "ITEM_NAME",     itemName);
	ds_Cond.setColumn(0, "GBN",           gbn); //[PJT]주문채널통합
// 	if (tab_list.tabindex == 1)
// 		ds_Cond.setColumn(0, "FAVOR_GROUP",   tab_list.tab2.cbo_Fav.value);
// 		
// 	else if (tab_list.tabindex == 0) // 2008.12.11 추가(분류별 상품 조회 기능)
// 	{
// 		ds_Cond.setColumn(0, "ITEM_CLASS2", tab_list.tab1.cbo_Class2.value);    //중분류
// 		ds_Cond.setColumn(0, "ITEM_CLASS3", tab_list.tab1.cbo_Class3.value);	//소분류
// 		ds_Cond.setColumn(0, "ITEM_CLASS4", tab_list.tab1.cbo_Class4.value);	//세분류
// 	}
// 	else if (tab_list.tabindex == 3)
// 	{
// 		if (ffn_ChkNull(tab_list.tab4.me_NeedDateP.value))
// 		{
// 			g_Message("EE", "복사대상 일자를 선택하세요."); tab_list.tab4.me_NeedDateP.setFocus(); return;
// 		}
// 		if (ffn_ChkNull(tab_list.tab4.ed_UpjangP.userdata))
// 		{
// 			g_Message("EE", "복사대상 업장을 선택하세요."); tab_list.tab4.ed_UpjangP.setFocus(); return;
// 		}
// 		if (ffn_ChkNull(tab_list.tab4.cbo_SubinvP.value))
// 		{
// 			g_Message("EE", "복사대상 식당을 선택하세요."); tab_list.tab4.cbo_SubinvP.setFocus(); return;
// 		}
// 		ds_Cond.setColumn(0, "NEED_DATEP",    tab_list.tab4.me_NeedDateP.value);
// 		ds_Cond.setColumn(0, "UPJANGP",       tab_list.tab4.ed_UpjangP.userdata);
// 		ds_Cond.setColumn(0, "SUBINV_CODEP",  tab_list.tab4.cbo_SubinvP.value);
// 	}
	
	// 조회
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMP00082E_T002"; //[PJT]주문채널통합
	
	/*
	if(tab_list.tabindex == 0)	//상품조회 일 때는 바인드 된 jsp를 호출 하게 한다. 2016-09-02 박용대
	{
		strURL   = "U_svc::" + "fm/fmp/FMP00082E_T001_bind.jsp";
	}
	else
	{
		strURL   = "U_svc::" + "fm/fmp/FMP00082E_T001.jsp";
	}
	*/
//	strURL   = "U_svc::" + "fm/fmp/FMP00082E_T002.jsp";	// renwebind ㅜㅜ //[PJT]주문채널통합
	strURL   = "hwfs_svc/fm/fmp/FMP00082E_T002.jsp";	// renwebind ㅜㅜ //[PJT]주문채널통합
	
	// 데이터셋 설정
	strInDatasets  = "ds_Cond=ds_Cond";
	strOutDatasets = "ds_List" + gfn_toString(tab_list.tabindex+1)+ "=ds_List";
	
	// 파라메터 설정
	strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
	strArgument += " Holiday_YN=" + wrapQuote(application.g_HOLIDAY_CHK_YN);	
//	strArgument += " strIndex=" + wrapQuote(gfn_toString(tab_list.tabindex+1));	 //반환가능품목등록에 등록된 상품만..
	strArgument += " strIndex=''";
	strArgument += " strTabIndex=" + wrapQuote(tab_list.tabindex);
	strArgument += " strWeekendTimeCheck=" + wrapQuote(fa_weekendTimeCheck);
	
    //if (eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).chk_Only.value == "1") {
		strArgument += " strOnly='TRUE'"; //주문가능상품만..
    //} else {
	//	strArgument += " strOnly='FALSE'";
    //}
	
	/*
	if (tab_list.tab1.chk_ThreeMonth.value == "1") {
		strArgument += " strThreeMonth='TRUE'";
    } else {
		strArgument += " strThreeMonth='FALSE'";
    }
	*/
	// 최근 n개월
	strArgument += " nMonth=0"//+wrapQuote(tab_list.tab1.cbo_month.value);
	
// 	if(tab_list.tabpages[tab_list.tabindex].name == "tab1"){
// 		strArgument += " sType=''" // 반환
// 	} else {
		strArgument += " sType='DC'" // 교환/증정
//	}
	
	// 콜백함수 지정
	strCallbackFunc = "fn_CallBack_SearchItem";
	// 서버 호출 
	//Transaction(strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc);
	//jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true); 
	
	
	
	gfn_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, true, true); 

	//trace("즐겨찾기 발주 조회 테스트");
	//trace(strOutDatasets);	//ds_List4
	//trace(ds_List4.saveXML());
	//trace(ta_Sql.value);
}


//바코드로 상품조회
function fn_SearchItemBarcode()
{

	if(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount <= fv_searchBarcodeRowIdx) {
		pgb_order.visible = false;
		fn_checkTempItem(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1))); //조회결과 check
		return;
	}

	// 초기화
	ds_BarcodeCond.clearData();   //바코드 조회조건1
	ds_Barcode.clearData();       //바코드 조회조건2
	ds_BarcodeResult.clearData(); //바코드 조회결과
	
	ds_BarcodeCond.addRow();
	ds_BarcodeCond.setColumn(0, "UPJANG",                  comp_upjang.getUpjangCode());
	ds_BarcodeCond.setColumn(0, "SUBINV_CODE",             cbo_Subinv.value);
	ds_BarcodeCond.setColumn(0, "NEED_DATE",               me_NeedDate.value);
	ds_BarcodeCond.setColumn(0, "CONSUM_YN",               ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN"));
	ds_BarcodeCond.setColumn(0, "QTY_CONTROL_YN",          ds_Days.getColumn(0,"QTY_CONTROL_YN"));
	ds_BarcodeCond.setColumn(0, "CENTER_CODE",   		   ds_CtUpj.getColumn(0,"CENTER_CODE"));
	ds_BarcodeCond.setColumn(0, "AP_UNITPRICE_UPJANG",     ds_CtUpj.getColumn(0,"AP_UNITPRICE_UPJANG"));
	ds_BarcodeCond.setColumn(0, "OTCUST_PRICE_UPJANG",     ds_CtUpj.getColumn(0,"OTCUST_PRICE_UPJANG"));
	ds_BarcodeCond.setColumn(0, "ITEM_NAME"          ,     "");
	ds_BarcodeCond.setColumn(0, "GBN",                     "BARCODE");
	
	var tempRowCnt = ((eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount - fv_searchBarcodeRowIdx));
	var maxRow =  Math.min(tempRowCnt, fv_searchBarcodeRowCnt); //(tempRowCnt > fv_searchBarcodeRowCnt ? fv_searchBarcodeRowCnt : tempRowCnt) + fv_searchBarcodeRowIdx;
	
	//trace("maxRow : " + maxRow);
	//trace("tempRowCnt : " + tempRowCnt);
	//trace("fv_searchBarcodeRowCnt : " + fv_searchBarcodeRowCnt);
	
	for(var i = 0; i < maxRow; i++){
		//trace("index : " + (fv_searchBarcodeRowIdx));
		if(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(fv_searchBarcodeRowIdx, "itemStatus") == "N"){
			var nRow = ds_Barcode.addRow();
			ds_Barcode.setColumn(nRow, "BARCODE", eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(fv_searchBarcodeRowIdx, "winItemCd"));
			ds_Barcode.setColumn(nRow, "ROW", fv_searchBarcodeRowIdx);
		}

		fv_searchBarcodeRowIdx++;
	}
	
	//var traceArr = new Array();
	//for(var i = 0; i< ds_Barcode.rowcount; i++){
	//	 traceArr.push(ds_Barcode.getColumn(i, "BARCODE"));
	//}
	
	//trace("ds_Barcode.rowcount : [" + ds_Barcode.rowcount + "] >>>> [" + traceArr.join(",") + "]");
	var nCnt = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getCaseCount("inputType == 'P' ");
	var nStartRow = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).findRowExpr("inputType == 'P' ");
	var nPos =  parseInt((fv_searchBarcodeRowIdx - nStartRow) / nCnt * 100, 10);

	pgb_order.pos = nPos;
	pgb_order.text = (nPos < 100 ? "처리중.." : "처리완료") + "( " + nPos + "% )";
	//trace("pgb_order.text " + pgb_order.text);

	//검색할 바코드가 없으면 다시 호출
	if(ds_Barcode.rowcount == 0){
		fn_SearchItemBarcode();
		return;
	}

	
	// 조회
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMP00082E_T002"; //[PJT]주문채널통합
	strURL   = "hwfs_svc/fm/fmp/FMP00082E_T002.jsp";	// renwebind ㅜㅜ //[PJT]주문채널통합
	
	// 데이터셋 설정
	strInDatasets  = "ds_Cond=ds_BarcodeCond:A ds_Barcode=ds_Barcode:A";
	strOutDatasets = "ds_BarcodeResult=ds_List";
	// 파라메터 설정
	strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
	strArgument += " Holiday_YN=" + wrapQuote(application.g_HOLIDAY_CHK_YN);	
	//strArgument += " strIndex=" + wrapQuote(gfn_toString(tab_list.tabindex+1));
	strArgument += " strIndex=''";
	strArgument += " strTabIndex=" + wrapQuote(tab_list.tabindex);
	strArgument += " strWeekendTimeCheck=" + wrapQuote(fa_weekendTimeCheck);
	
    if (eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).chk_Only.value == "1") {
		strArgument += " strOnly='TRUE'";
    } else {
		strArgument += " strOnly='FALSE'";
    }
	

	// 최근 n개월
	strArgument += " nMonth=0"//+wrapQuote(tab_list.tab1.cbo_month.value);
	
	//if(tab_list.tabpages[tab_list.tabindex].name == "tab1"){
	//	strArgument += " sType=''" // 반환
	//} else {
		strArgument += " sType='DC'" // 교환/증정
	//}
	
	// 콜백함수 지정
	strCallbackFunc = "fn_CallBack_SearchItemBarcode";
	// 서버 호출 
	//jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true); //동기
	//jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, true, false, true); //비동기
	gfn_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, true, false, true); //비동기

}


/*------------------------------------------------------------
	1. Function ID : fn_Insert()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_insert()
{
}
/*------------------------------------------------------------
	1. Function ID : fn_Delete()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_delete()
{
	
	if (eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount < 1)
	{
		g_Message("EE", fn_AlertMsg("006"));
		return;
	}
	
	if (eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition < 0  || eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getSelect(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition) == false)
	{
		g_Message("EE", "삭제할 상품을 선택하세요.");
		return;
	}
	
	//실제 Table자료 삭제 시 Table에서 즉시 삭제처리
	//필수항목 
	if (fn_ChkManNull()) return;
	
	//if (eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).GetColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).row,"LINE_STATUS") <> "004")
	if (eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition,"clsStatus") == "마감")
	{
		g_Message("EE", "해당상품은 마감이 완료되어 삭제가 불가합니다.");
		return;
	}
	//발주가능 체크
	if (! fn_OrdChk()) return;
	//기존 자료인 경우 디데이 체크
	if (GetRowType(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)),eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition)<> 'insert')
	{
		if (fn_GetDayStatus(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition,"dDays"), eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition,"dTimes")) == "0")
		{
			g_Message("EE","해당 상품은 마감시간(D-Days)이 초과되어 삭제가 불가합니다.");
			return;
		}
	}
	
	var checkDs = fn_search(true);
	
	if (! g_Confirm("01", '선택하신 주문상품을 삭제하시겠습니까?!')) return;
	
	if (GetRowType(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)),eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition)== 'insert')
	{
		eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).deleteRow(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition);
		return;
	}
	
	var rtnCheckMsg = fn_checkLineStatus("delete", checkDs);
	if ( !gfn_isNull(rtnCheckMsg) ) {
		g_Message("EE", rtnCheckMsg);
		fn_search();
		return;
	}
	
	//삭제행만 처리...
	ds_delListb.clearData();
	ds_delListb.addRow();
	ds_delListb.copyRow(0, eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)), eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition);
	ds_delListb.setRowType(0, 8);	
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).updatecontrol = false;
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).deleteRow(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition);
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).updatecontrol = true;
	
// 	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
// 	// 경로 설정
// 	strSvcID = "FMP00160E_T003";
// 	strURL   = "hwfs_svc/fm/fmp/FMP00160E_T003.jsp";
// 	// 데이터셋 설정U
// 	strInDatasets  = "";
// 	strOutDatasets = "";
// 	
// 	strInDatasets += "ds_msg=ds_msg:U";
// 	strOutDatasets += "ds_msg_out=ds_msg_out";
// 		
// 	// 파라메터 설정
// 	strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
// 	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
// 	//strArgument += " sDocSrc=" + wrapQuote(fa_DocSrc);
// 	strArgument += " sPrID=" + wrapQuote(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition,"prId"));
// 	strArgument += " sPrNum=" + wrapQuote(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition,"prNum"));
// 	strArgument += " sOtcustCD=" + wrapQuote(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition,"otcustcd"));
// 	strArgument += " sMenuFlag=" + wrapQuote("N");
// 	strArgument += " sUpjang=" + wrapQuote(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition,"rcUpjang"));
// 	strArgument += " sMenuCD=" + wrapQuote(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition,"needDate") + "-" + eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition,"subinvCode"));
// 	strArgument += " sItemCode=" + wrapQuote(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition,"itemCode"));
// 	strArgument += " sPrUpjang=" + wrapQuote(comp_upjang.getUpjangCode());
// 	strArgument += " sPrSabun=" + wrapQuote(g_EmpNo);
// // [속도개선 Project 시작] 2017. 8. 4. 최범주 여신금액 집계 프로시저 추가
//     strArgument += " sSubinv=" + wrapQuote(cbo_Subinv.value);     // 식당(창고)
//     strArgument += " sNeedDate=" + wrapQuote(me_NeedDate.value);  // 입고예정일
// 	strArgument += " scrnId=" + wrapQuote("FMP00080E");           // 화면ID
// 	strArgument += " scrnName=" + wrapQuote("상품발주");          // 화면명
// // [속도개선 Project   끝] 2017. 8. 4. 최범주	
// 	// 콜백함수 지정
// 	strCallbackFunc = "fn_CallBack_Delete";
// 	// 서버 호출 
// 	//Transaction(strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc);
// 	//jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
// 	gfn_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
	
    var strSvcID    = "deleteReturnOrderBySalesInfo";
    var strURL      = "fm/fms/returnOrderBySales/saveReturnOrderBySalesInfo.xdo";    
    //var strInDs     = "ds_IUD=ds_Listb"+ gfn_toString(tab_list.tabindex+1) +":U";// ds_msg=ds_msg:U";
    var strInDs     = "ds_IUD=ds_delListb:U";// ds_msg=ds_msg:U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_CallBack_Delete";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);	
}
/*------------------------------------------------------------
	1. Function ID : fn_Save(confirmYn)
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : confirmYn = null 이면 저장하시겠습니까라는 창을 띄움
	                 confirmYn = 1 이면 저장하시겠습니까라는 창을 안띄움
*/
function fn_save(confirmYn)
{
	//저장 버튼 누른 후 팝업 상태에서 마감시간 이후 저장 체크를 위한 변경
	//[HISTORY] : 수정일 > 2009/01/19
	//            수정자 > 노규완
	//            수정 내용 > 저장 Confirm 팝업 메시지를 제일 먼저 띄어 줌.
	
/*
	//입고통제일 체크 
	if (fn_NeedDateCheck()) 
	{
	    g_Message("EE","해당일자는 입고통제일 입니다.");
		return;
	}	
*/
	
	//변경여부 확인
// 	if ( (! gfn_dsIsUpdated(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)))) )
// 	{		
// 		return g_Message("EE", fn_AlertMsg("007"));
// 	}

	//필수항목 
	if (fn_ChkManNull()) return;

	// 구멍 매꾸기
	if ( div_cmnBtn.btn_save.enable == false || div_cmnBtn.btn_save.visible == false ) {
		g_Message("EE","발주 정보를 저장할 권한이 없습니다.");
		return;
	}
	
	//[PJT]주문채널통합
	var nErrRow = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).findRowExpr(" itemStatus == 'E' ");
	if (nErrRow > -1){
		eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition = nErrRow;
		g_Message("EE","오류가 있는 발주내역을 삭제 하세요.");
		return;
	}
	
	/*시스템 통제 시간 체크 - 특정일자에 사용을 할 수 없게 한다.*/
	mfn_GetSystemWorkCheck("PO");		
	if (ds_common.getColumn(0, 0) == "Y")
	{
		g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
		return false; 
	}

// [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
// 	if (ed_Credit.value == "여신정보갱신중")
// 	{
// 		alert("여신정보갱신중입니다. 조금만 기다려주세요");
// 		return;
// 	}
// [속도개선 Project   끝] 2017. 8. 21. 최범주

	//입고예정일 변경 확인 2017.10.18 김호석(하단 주문내역 그리드의 입고예정일과 검색조건 입고예정일 비교) 시작
	//그리드의 입고예정일은 검색조건의 입고예정일로 조회 후 표시또는 추가되므로 조회 시(fn_search함수) 이전 입고예정일 저장(pre_need_date_temp)	
	var from_need_date = "";
	var to_need_date = "";
	from_need_date = pre_need_date_temp;
	to_need_date = me_NeedDate.value;
	
	if (from_need_date.length  == 8) 
	{
		from_need_date = from_need_date.slice(0,4) + "-" + from_need_date.slice(4,6) + "-" + from_need_date.slice(6,8);
	}
	if (to_need_date.length  == 8) 
	{
		to_need_date = to_need_date.slice(0,4) + "-" + to_need_date.slice(4,6) + "-" + to_need_date.slice(6,8);
	}

// 스크립트 존재가 무의미..빼는게 맞음.
// 	if (pre_need_date_temp != me_NeedDate.value) {
// 		
// 		// 저장 전 사용자 메세지 전달
// 		//if (g_Confirm("02", "입고예정일이 " + from_need_date + "에서 " + to_need_date + "로 변경되었습니다. \n입고예정일 " + from_need_date + "로 주문내역을 저장하시겠습니까? "))
// 		if (g_Confirm("02", sta_NeedDate.text+" " + from_need_date + "에서 " + to_need_date + "로 변경되었습니다. \n"+sta_NeedDate.text+" " + from_need_date + "로 주문내역을 저장하시겠습니까? "))
// 		//g_Message("EE","변경된 내역이 있습니다. 저장해 주십시요");
// 		{ 	
// 			me_NeedDate.value = pre_need_date_temp;			
// 		} else {
// 			me_NeedDate.value = pre_need_date_temp;
// 			//g_Message("EE","입고예정일이 " + from_need_date + "에서 " + to_need_date + "로 변경되었습니다.");
// 			g_Message("EE",sta_NeedDate.text+" " + from_need_date + "에서 " + to_need_date + "로 변경되었습니다.");
// 			return;		
// 		}
// 		
// 	}
	//입고예정일 변경 확인 2017.10.18 김호석(하단 주문내역 그리드의 입고예정일과 검색조건 입고예정일 비교) 끝
	
	
	// 통제 창고인 경우
// 	eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)+".gd_listb" + gfn_toString(tab_list.tabindex+1)).updateToDataset();
// 	if ( ds_ctrlList.lookup("subinvCode", cbo_Subinv.value, "controlYn") == "Y" ) {
// 		var bMix = true;
// 		//if ( eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount == eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getCaseCount("D_DAYS == '1' && PR_QTY >= 0") ) {
// 		if ( eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getCaseCount("PR_QTY > 0") == eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getCaseCount("D_DAYS == '1' && PR_QTY > 0") ) {
// 			bMix = false;
// 		} else {
// 			bMix = true;
// 		}
// 		
// 		//trace(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getCaseCount("PR_QTY > 0") +"=="+ eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getCaseCount("D_DAYS == '1' && PR_QTY >= 0"));
// 		var rtnAmt = fn_getOrderStatus("recheck");
// 		
// 		if ( (eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getCaseCount("D_DAYS == '1' && PR_QTY > 0") > 0) && (rtnAmt.ctrlAmt > rtnAmt.poAmt) ) {
// 		
// 			var  strMsg = "최소발주금액[" + gfn_numFormat(ds_ctrlList.lookup("subinvCode", cbo_Subinv.value, "controlAmt")) + "]원보다";
// 				 strMsg += " [" + gfn_numFormat(rtnAmt.ctrlAmt - rtnAmt.poAmt) + "]원 부족합니다.\r\n\r\n";
// 			
// 			if ( !bMix ) {
// 				strMsg += "발주금액을 확인하시기 바랍니다.";
// 				
// 			} else {
// 				strMsg += "D-2상품은 금액과 상관없이 주문가능하나, D-1상품은 저장할 수 없습니다.";
// 				
// 				/*
// 				strMsg += "D-2상품은 금액과 상관없이 주문가능하며,\r\n\D-1상품은 삭제됩니다.\r\n\D-2상품만 주문하시겠습니까?";
// 				
// 				if ( g_Confirm("01", strMsg) ) {
// 					for ( var z=eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount; z>=0; z-- ) {
// 						if ( (eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getRowType(z) == Dataset.ROWTYPE_INSERT) && eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(z, "D_DAYS") == "1" ) {
// 							eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).deleteRow(z);
// 						}
// 					}
// 				} else {
// 					return;
// 				}
// 				*/
// 			}
// 	
// 			g_Message("EE", strMsg);
// 	
// 			if ( g_EmpNo.substr(0,2) <> "CS" && g_EmpNo.substr(0,2) <> "FM" ) {
// 				// 내부지원 skip
// 			} else {	// 고객
// 				return;
// 			}
// 		}
// 	}

	//if(gfn_toString(tab_list.tabindex+1) != 3){
		ds_ListbValid.clearData();
		ds_ListbValid.addRow();
		if(gfn_toString(tab_list.tabindex+1) == 1){
			ds_ListbValid.setColumn(0, "rtnOrdType", "title:반환유형,required:true");
		} else if(gfn_toString(tab_list.tabindex+1) == 2){
			ds_ListbValid.setColumn(0, "rtnOrdType", "title:교환유형,required:true");
		} else {
			ds_ListbValid.setColumn(0, "rtnOrdType", "title:증정유형,required:true");
		}
		// Validation Check
		if(!gfn_validCheck(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)), ds_ListbValid, true)) return;
	//}	
	
	//반환의 경우
	if(gfn_toString(tab_list.tabindex+1) == 1){		
		if(!ffn_ChkNull(comp_upjang.getUpjangCode())){
			fn_searchRtnOrderYn();
		}
	}
	
	var checkDs = fn_search(true);
		
	// 저장 전 사용자 메세지 전달
	if (! g_Confirm("", "주문내역을 저장하시겠습니까?"))
	{
		return;
	}
	
	//발주량 0상품 확인
	var nRow;
	nRow = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).findRowExpr("prQty==0");
	if (nRow >= 0)
	{	
		if (! g_Confirm("02", "발주량이 0인 상품이 있습니다.\n\n그대로 저장하시겠습니까?"))
		{
			eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition = nRow;
			eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)+".gd_listb" + gfn_toString(tab_list.tabindex+1)).setFocus();
			eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)+".gd_listb" + gfn_toString(tab_list.tabindex+1)).setCellPos(ffn_Get_HeaderTitleColIdx(eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)+".gd_listb" + gfn_toString(tab_list.tabindex+1)),"수량"));
			return;
		}
	}
	
	//현재시간 초기화. 
	//발주가능, 데이타체크에서 현재시간을 통해 계산하기때문에
	fn_SetTimer();
	
	//발주가능 체크(창고)
	if (! fn_OrdChk()) return;
	
	// 데이타체크(여신및 상품별 디데이체크) //여신부분 제거..
	var sRtn = fn_ChkData(checkDs);
	
	if (sRtn != null)
	{
		g_Message("EE", sRtn);
		return;
	}
	
/*
   	// action 정보 초기화 
    tit_clearActionInfo(this);
	// 초기화
	ds_Cond.ClearData();
	ds_Cond.AddRow();
	ds_Cond.SetColumn(0, "SUBINV_CODE",    cbo_Subinv.Value);
	ds_Cond.SetColumn(0, "NEED_DATE",      me_NeedDate.Value);
    // 서비스셋팅
    var actionName, cmdName, inData, outData, otherArg, callBackFnc;
    var singleSql, insertSql, updateSql, deleteSql, saveFlagColumn, keySqlName, keyIncrement, callbackSql;
    inData		= "ds_IUD=ds_List:U ds_Cond=ds_Cond";
    outData		= "ds_List=ds_List";
    callBackFnc	= "fn_CallBack_Save";
	// 파라미터셋팅
    insertSql	= "fm/fmp:FMP00160E_I001";
    updateSql	= "fm/fmp:FMP00160E_U001";
    deleteSql	= "fm/fmp:FMP00160E_D001";
//    keySqlName	= "fm/fmz:FMZ_PR_NUM_S002";
//    keyIncrement= 0;
    callbackSql	= "fm/fmp:FMP00160E_S002";
	// 서버에서 작업할 정보 추가
	tit_addSearchActionInfo(this, "fm/fmz:FMZ_PR_NUM_S002", true);
	tit_addSaveActionInfo(this, insertSql, updateSql, deleteSql, saveFlagColumn, keySqlName, keyIncrement, callbackSql);
	// 서버 호출
	tit_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
*/

/*//asis
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMP00161E_T001"; //[PJT]주문채널통합
	strURL   = "hwfs_svc/fm/fmp/FMP00161E_T001.jsp"; //[PJT]주문채널통합
	// 데이터셋 설정U
	strInDatasets  = "ds_IUD=ds_Listb"+ gfn_toString(tab_list.tabindex+1) +":U";
	strInDatasets += " ds_msg=ds_msg:U";
	strOutDatasets = "ds_save_out=ds_save_out";
	strOutDatasets += " ds_msg_out=ds_msg_out";
	
	// 파라메터 설정
//	strArgument  = "sSubinv=" + wrapQuote(cbo_Subinv.value);
	strArgument += " sNeedDate=" + wrapQuote(me_NeedDate.value);
	strArgument += " g_Upjang=" + wrapQuote(g_Upjang);
	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
//	strArgument += " sDocSrc=" + wrapQuote(fa_DocSrc);
//	strArgument += " sPrUpjang=" + wrapQuote(comp_upjang.getUpjangCode());
//	strArgument += " sPrSabun=" + wrapQuote(g_EmpNo);
	// 신규일경우 기존대로 새로운 주문번호 생성:NEW , 동일업장, 창고 및 입고일자에 주문건수가 있을경우 상품추가시  주문번호를 새로 생성하지 않는다:OLD
	//strArgument += " sGubunNewOrOld=" + wrapQuote(fn_gubunNewOrOld);
//	strArgument += " sMaxPrNum=" + wrapQuote(fn_maxPrNum);
//	strArgument += " sMaxApproveNum=" + wrapQuote(fn_maxApproveNum);
// [속도개선 Project 시작] 2017. 8. 4. 최범주 여신금액 집계 프로시저 추가
//	strArgument += " scrnId=" + wrapQuote("FMP00082E");   // 화면ID //[PJT]주문채널통합
//	strArgument += " scrnName=" + wrapQuote("상품발주(브랜드)");  // 화면명 //[PJT]주문채널통합
// [속도개선 Project   끝] 2017. 8. 4. 최범주
	//trace(ds_msg.saveXML());	
	// 콜백함수 지정
	strCallbackFunc = "fn_CallBack_Save";
	//바이너리 통신 설정
	//http.Compress = true;
	//http.CompressMethod = "ZLIB";
	////http.XmlFormat = false;
	//바이너리 통신 설정	
	// 서버 호출 
	//Transaction(strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc);
	//jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
	gfn_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
*/	
	
    var strSvcID    = "saveReturnOrderBySalesInfo";
    var strURL      = "fm/fms/returnOrderBySales/saveReturnOrderBySalesInfo.xdo";    
    var strInDs     = "ds_IUD=ds_Listb"+ gfn_toString(tab_list.tabindex+1) +":U";// ds_msg=ds_msg:U";
    var strOutDs    = "ds_save_out=ds_save_out";// ds_msg_out=ds_msg_out";
    var strArg      = "";
    var strCallback = "fn_CallBack_Save";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);	
}
/*------------------------------------------------------------
	1. Function ID : fn_Print()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_print()
{
	//gd_listE.ExportExcelEx("단가표");
}
/*------------------------------------------------------------
	1. Function ID : fn_Close()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_Close()
{
	This.close();
}
/*------------------------------------------------------------
	1. Function ID : fn_Help()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_help()
{
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*------------------------------------------------------------
	1. Function ID : fn_AlertMsg(cd)
	2. 개       요 : 메세지 처리
	3. 기       능 : 화면에 나타나는 메시지 코드및 텍스트 리턴
	4. 인 수 설 명 : cd : 원하는 메시지 코드
*/
function fn_AlertMsg(cd)
{
	var v_Msg="";
	switch(cd)
	{
		case "000":
			v_Msg= "이(가) 저장되었습니다.";
			break;
		case "001":
			v_Msg= "버튼이 정의 되어 있지않습니다.";
			break;
		case "002":
			v_Msg="서비스 오류:시스템 관리자에게 문의하십시오";
			break;
		case "003":
			v_Msg="필수항목은 반드시 선택하시기 바랍니다.";
			break;	
		case "004":
			v_Msg="작업대상 본사를 선택하세요.";
			break;
		case "005":
			v_Msg="을(를) 입력하세요";
			break;
		case "006":
			v_Msg="삭제할 데이터가 없습니다.";
			break;
		case "007":
			v_Msg="변경된 데이터가 없습니다.";
			break;
		case "008":
			v_Msg="시스템ID가 없습니다.";
			break;			
/*			
		case "":
			v_Msg="";
			break;
*/			
		default:
			break;			
	}
	return v_Msg;
}
//콜백
//function fn_CallBack_Search(errCode, errMsg)
function fn_CallBack_Search(SvcID, errCode, errMsg)
{
//alert("SvcID:"+SvcID+" errCode:"+errCode+" errMsg:"+errMsg);
	if (errCode == 0)
	{
		if (eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount < 1)
		{
			g_Message("EE","주문등록한 상품이 없습니다.");
			
			//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
			gfn_loadDatasetInfo (eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)), fv_objColInfo);
            
			
		} else {
			fn_CLS_STATUS_Setting();
		}
		
		//최초등록시 주문번호 채번, 이후에는 같은 주문번호로 발주
		//ds_List.filter("OTCUSTCD=='0000'");
		eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).filter("otcustcd=='0000'");
		fn_dsListbCnt = 0;
		fn_dsListbCnt = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount;
		eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).filter("");
		
		
		//fn_getOrderCtrlList();
		
		eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.setFocus();
		
		//타입filter 적용
		if( tab_list.tabpages[tab_list.tabindex].name == "tab3" ){	//증정		
			ds_rtnOrdType.filter("(code == 'G01' || code == 'H01' || code == 'I01') && attr01 <= '"+me_NeedDate.value+"' && attr02 >= '"+me_NeedDate.value+"'");		
		} else {
			ds_rtnOrdType.filter("code != 'G01' && code != 'H01' && code != 'I01' && attr01 <= '"+me_NeedDate.value+"' && attr02 >= '"+me_NeedDate.value+"'");		
		}
		
		ds_rtnOrdTypeAllChg.copyData(ds_rtnOrdType, true);
		
		eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).cbo_rtnOrdType.index = 0;
		
		//trace(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).saveXML());				
	}
	else
		g_Message("EE",fn_AlertMsg("002"));
}
//function fn_CallBack_SearchItem(errCode, errMsg)
function fn_CallBack_SearchItem(SvcID, errCode, errMsg)
{
//trace("fn_CallBack_SearchItem===>"+eval("ds_List" + gfn_toString(tab_list.tabindex+1)).saveXML());
//ta_Sql.value = fa_Sql;
	if (errCode == 0)
	{
	//trace(ds_List1.saveXML());
		if (eval("ds_List" + gfn_toString(tab_list.tabindex+1)).rowcount < 1)
		{
			g_Message("EE","검색된 상품이 없습니다.");
			eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.setFocus();
		}
		else
		{
			//eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).gd_list.setFocus();			
			eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)+".gd_list" + gfn_toString(tab_list.tabindex+1)).setFocus();
			
			/*
			if (tab_list.tabindex < 3)
				Sort(eval("ds_List" + gfn_toString(tab_list.tabindex+1)),"ITEM_CODE");
			else
				Sort(eval("ds_List" + gfn_toString(tab_list.tabindex+1)),"PR_ID");
			*/	
			
			
			//eval("ds_List" + gfn_toString(tab_list.tabindex+1)).rowposition = 0;
			var dsObj = eval("ds_List" + gfn_toString(tab_list.tabindex+1));//.rowposition = 0;
			dsObj.rowposition = 0;
			//[PJT]주문채널통합 
			//자동등록 체크 & dataset 1건이면 등록 처리
 			if (dsObj.rowcount == 1 && eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).chk_autoList.isChecked())
 			{
				fn_CopyRow(dsObj, dsObj.rowposition, "S");
 			}
 			
//  			if (dsObj.rowcount == 1 && eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).chk_autoList.isChecked())
//  			{
// 				var gbn = eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).cbo_Gbn.value;
// 				var itemName = eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.text;
// 				if(gbn == "88" && itemName.length >= 6){
// 					fn_CopyRow(dsObj, dsObj.rowposition, "S");
// 				}
//  			}
		}
	}
	else
		g_Message("EE","주문상품 조회하는 중에 오류가 발생하였습니다! \n 관리자에게 문의하세요.");
}


//바코드 상품 조회
//function fn_CallBack_SearchItemBarcode(errCode, errMsg)
function fn_CallBack_SearchItemBarcode(SvcID, errCode, errMsg)
{
//trace("fn_CallBack_SearchItemBarcode===>"+ds_BarcodeResult.saveXML());
	if (errCode == 0)
	{
		//trace("=====================================");
		
		//var traceArr = new Array();
		//for(var i = 0; i< ds_BarcodeResult.rowcount; i++){
		//	 traceArr.push(ds_BarcodeResult.getColumn(i, "WIN_ITEM_CD"));
		//}
		//trace("ds_BarcodeResult.rowcount : [" + ds_BarcodeResult.rowcount + "] >>>> [" + traceArr.join(",") + "]");
	
		
		//조회조건 만큼 loop
		for(var i = 0; i < ds_Barcode.rowcount; i++){
			var sCode = ds_Barcode.getColumn(i, "BARCODE");
			var nRow  = ds_Barcode.getColumn(i, "ROW");
			var nCnt  = ds_BarcodeResult.getCaseCount( " WIN_ITEM_CD == '" + sCode + "'");
			var nChk  = ds_BarcodeResult.getColumn(i, "EXCEPTION_ORDER");
			
			if(nCnt == 0){
				// 검색결과 바코드가 매칭되는 데이터가 없는 경우 발주불가 또는 미존재 바코드 정보. 표시
				eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nRow, "itemName",   "미존재 바코드 정보");
				eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nRow, "itemStatus", "E");
			} else if(nCnt > 1){
				// 검색결과 바코드가 1:N으로 매칭되지 경우 :  상품코드와 매칭된 바코드 정보가 올바르지 않습니다. 표시
				eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nRow, "itemName",   "상품코드와 매칭된 바코드 정보가 올바르지 않습니다");
				eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nRow, "itemStatus", "E");
			} else if(nCnt == 1){
				//정상
				var nFindRow = ds_BarcodeResult.findRowExpr( " WIN_ITEM_CD == '" + sCode + "'");
				
				//반환이 아닌경우만..
				if(gfn_toString(tab_list.tabindex+1) != 1 && ds_BarcodeResult.getColumn(nFindRow, "EXCEPTION_ORDER") == "N"){
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nRow, "itemName",   "발주통제 상품입니다.");
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nRow, "itemStatus", "E");
				}else {
					fn_CopyRowPaste(ds_BarcodeResult, nRow, nFindRow, "P");
				}
		
			}
		}//end for
		
		if(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount <= fv_searchBarcodeRowIdx) {
			pgb_order.visible = false;
			fn_checkTempItem(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)));//조회결과 check
			return;
		}
		fn_SearchItemBarcode(); //남은 건수 재조회
	}
	else {
		g_Message("EE","바코드 상품 조회하는 중에 오류가 발생하였습니다! \n 관리자에게 문의하세요.");
	}
}


//function fn_CallBack_Delete(errCode, errMsg)
function fn_CallBack_Delete(SvcID, errCode, errMsg)
{
//ta_Sql.value = fa_Sql;
	if (errCode == 0)
	{
		//신규추가부분 
		ds_msg_out.clearData();
		ds_msg_out.copyData(ds_msg);

		if ( ds_msg_out.rowcount != 0 )  {
			var strMsg ="";
			for ( var q=0; q<ds_msg_out.rowcount; q++ ) {
				if ( ds_msg_out.getColumn(q, "TYPE") == "I" ) {
					strMsg += ds_msg_out.getColumn(q, "MSG")+"\r\n";
				}
			}
			
			if ( !gfn_isNull(strMsg) ) { 
				g_Message("", strMsg);
				fn_search();
			}
			
			var rowPos = ds_msg_out.findRow("TYPE", "N");
			if ( rowPos != -1 ) {
				g_Message("", ds_msg_out.getColumn(rowPos, "MSG"));
				
				//trace("MENU_ID=="+this.parent._fv_menuId);
				application.afrm_Bottom.form.fn_reOpenMenu(this.parent._fv_menuId);
				this.getOwnerFrame().form.close();
				return;
			}
			
			ds_msg_out.clearData();
		}
		
		
// 		//PR_ID를 (-)으로 설정하여 저장 시 다시 삭제하는 일이 없도록 한다.
// 		eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition,"prId","-1");
// 		eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).deleteRow(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition);
// 		//삭제자료만 존재한다면 데이타셑의 row type을 초기화 하여 삭제상태를 초기화 한다.
// 		//if (eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getCaseCount("rowtype='insert'||rowtype='update'") <= 0) eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).applyChange();
// 		
// 		if ( (! gfn_dsIsUpdated(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)))) ) {
// 			eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).applyChange();
// 		}
// 		
// 		//최초등록시 주문번호 채번, 이후에는 같은 주문번호로 발주
// 		//ds_List.filter("OTCUSTCD=='0000'");
// 		eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).filter("otcustcd=='0000'");
// 		if (eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount == 0)
// 		{
// 			fn_dsListbCnt = 0;
// 		}
// 		else
// 		{
// 			fn_dsListbCnt = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount;
// 		}
// 		eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).filter("");
// 		
// // [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
// //		if ( !fn_GetCredit() ) return; // 여신정보 조회
// // [속도개선 Project   끝] 2017. 8. 21. 최범주
	}
	else
		g_Message("EE",fn_AlertMsg("002"));
}
function fn_CallBack_Save(SvcID, errCode, errMsg)
//function fn_CallBack_Save(errCode, errMsg)
{
	if (errCode == 0)
	{
// [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
//		if ( !fn_GetCredit() ) return; // 여신정보 조회
// [속도개선 Project   끝] 2017. 8. 21. 최범주
		//fn_search();
		g_Message("02","주문자료" + fn_AlertMsg("000"));
		
		//trace(ds_msg_out.saveXML());
		
		//신규추가부분 
		ds_msg_out.clearData();
		ds_msg_out.copyData(ds_msg);

		if ( ds_msg_out.rowcount != 0 )  {
			var strMsg ="";
			for ( var q=0; q<ds_msg_out.rowcount; q++ ) {
				if ( ds_msg_out.getColumn(q, "TYPE") == "I" ) {
					strMsg += ds_msg_out.getColumn(q, "MSG")+"\r\n";
				}
			}
			
			if ( !gfn_isNull(strMsg) ) {
				g_Message("", strMsg);
			}
			
			var rowPos = ds_msg_out.findRow("TYPE", "N");
			if ( rowPos != -1 ) {
				g_Message("", ds_msg_out.getColumn(rowPos, "MSG"));
				
				//trace("MENU_ID=="+this.parent._fv_menuId);
				application.afrm_Bottom.form.fn_reOpenMenu(this.parent._fv_menuId);
				this.getOwnerFrame().form.close();
				return;
			}
			
			ds_msg_out.clearData();
		}
		
		fn_search();	// 재조회
		
	} else if(errCode == -100){
		
		var flag = errMsg.substr(0,1);
		var errMsgOut = errMsg.substr(1);
		
		if(flag == "1"){
			g_Message("EE","발주 불가 자재가 존재합니다.");
		} else {
			g_Message("EE","구매신청 불가 자재가 존재합니다.");
		}
		
		var objArr1 = errMsgOut.split("@#@");		
		var objArr2;
		var dsout = "";
		ds_save_out.clearData();
		for(i = 0 ; i < objArr1.length ; i++){
			objArr2 = objArr1[i].split("@$@");
			ds_save_out.addRow();
			ds_save_out.setColumn(i, "ITEM_CODE", objArr2[0].replace("ITEM_CODE=",""));
			ds_save_out.setColumn(i, "ITEM_NAME", objArr2[1].replace("ITEM_NAME=",""));
			ds_save_out.setColumn(i, "ITEM_VAL", objArr2[2].replace("ITEM_VAL=",""));
		}
		
		if(ds_save_out.rowcount > 0){
			// 자재유효성체크에서 걸린 리스트
			var sRet = gfn_dialog("", "U_FMP::FMP00030P.xfdl", "", "", "", "", "", "", "", "", "", false);
			return;
		}
		
	} else {
		g_Message("EE",fn_AlertMsg("002"));
	}
	
		
}
function fn_ChkManNull()
{
	if (ffn_ChkNull(comp_upjang.getUpjangCode()))
	{
		g_Message("EE", "사업장" + fn_AlertMsg("005"));
		if (comp_upjang.enable) comp_upjang.setFocus();
		return true;
	}
	if (ffn_ChkNull(cbo_Subinv.value))
	{
		g_Message("EE", "식당을 선택하세요.");
		if (cbo_Subinv.enable) cbo_Subinv.setFocus();
		return true;
	}
	if ( ffn_ChkNull(me_NeedDate.value) || (gfn_length(me_NeedDate.value)< 8) )
	{
		g_Message("EE", sta_NeedDate.text+"을 정확하게 입력하세요.");
		me_NeedDate.setFocus();
		return true;
	}

	//
	return false;
}
function fn_ChkData(checkDs)
{
	//변경여부 확인
	if ( (! gfn_dsIsUpdated(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)))) )
	{
		return fn_AlertMsg("007");
	}
// [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
//	if ( !fn_GetCredit() ) return; // 여신정보 조회
// [속도개선 Project   끝] 2017. 8. 21. 최범주
	//여신한도초과여부
	//if (ed_Credit.Text != "무 제 한")
// 	if (ds_CrdInfo.rowcount > 0)
// 	{
// 		//여신금액
// 		if (ds_CrdInfo.getColumn(0,"CREDIT_AMOUNT_CONTROL_YN") == "Y")
// 		{
// 			var nAmt = 0;
// 			
// 			for (i=0; i<eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount; i++) {
// 				nAmt += Math.round((toNumber(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"OP_AMOUNT")) - toNumber(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"OP_AMOUNT_OLD"))) * iif(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"TAX_CODE")=="100",1.1,1));
// 			}
// 				
// 			if ( nAmt > toNumber(ds_CrdInfo.getColumn(0,"CREDIT_AVAIL_AMT")) && eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getSum("OP_AMOUNT") != eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getSum("OP_AMOUNT_OLD") )
// 			{
// 				return "주문가능한 여신한도를 초과하여 주문이 불가합니다.";
// 			}
// 		}
// 		//여신회전일
// 		if (ds_CrdInfo.getColumn(0,"CREDIT_TURN_CONTROL_YN") == "Y")
// 		{
// 			if (toNumber(ds_CrdInfo.getColumn(0,"LAST_TURN_CNT")) >= 0)
// 			{
// 				if (toNumber(ds_CrdInfo.getColumn(0,"LAST_TURN_CNT")) > toNumber(ds_CrdInfo.getColumn(0,"CREDIT_TURN_DAYS_TOT")))
// 				{
// 					return ds_CrdInfo.getColumn(0,"L_BILL_DATE_DISP") + "에 매출채권이 존재하여 주문이 불가합니다.";
// 				}
// 			}
// 		}
// 	}
	//상품별 디데이 체크
	for (i=0; i<eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount; i++)
	{
		if (GetRowType(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)),i)<> 'normal')
		{
			//수량 0인건 어차피 지울꺼니 패스...
			//if ( NumFormat(ds_List.GetColumn(i,"PR_QTY"),1) == "0.0" ) continue;
			if (( GetRowType(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)),i)== 'insert' ) && ( gfn_numFormat(gfn_trim(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"prQty")),1)== "0" )) continue;
			//기존자료이거나 무통제면 패스...
			if ( numFormat(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"dDays"))== "0" ) continue;
			//디데이체크
/*			
			if ( addDate(gds_currdate.GetColumn(0,"YMD"),ds_List.GetColumn(i,"D_DAYS")) > me_NeedDate.Value )
			{
				ds_List.row = i;
				return ("[" + ds_List.GetColumn(i,"ITEM_NAME") + "]상품은 주문일자(D-" + ds_List.GetColumn(i,"D_DAYS") + ")를 초과하여 주문이 불가합니다.");
			}
			else if ( addDate(gds_currdate.GetColumn(0,"YMD"),ds_List.GetColumn(i,"D_DAYS")) = me_NeedDate.Value )
			{
				//디타임체크
				if ( substr(gds_currdate.GetColumn(0, "YMD_TM"),8,4) > ds_List.GetColumn(i,"D_TIMES") )
				{
					ds_List.row = i;
					return ("[" + ds_List.GetColumn(i,"ITEM_NAME") + "]상품은 주문시간(" + right("0"+ds_List.GetColumn(i,"D_TIMES"),4) + ")을 초과하여 주문이 불가합니다.");
				}
			}
*/
			if (fn_GetDayStatus(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"dDays"), eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"dTimes")) == "0")
			{
				eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition = i;
				return ("[" + eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"itemName") + "]상품은 마감시간(D-Days)을 초과하여 주문이 불가합니다.");
			}
		}
        //-----------------------------------------------------------------------------------
		//--- 체크로직 추가 
		//    수정일    : 2010/10/28 BY 노규완
		//    수정내용  : 상품 수량 입력 시 기존에는 라인별로 최대발주량 체크 하였으나,
		//                추가 상품으로 동일 상품을 등록 한 다음 최대 발주량만 넘지 않으면 
		//                추가로 상품이 저장 되는 문제가 발생하여, 입고 예정일 기준으로 
		//                동일 상품의 총 합계를 체크 하여 최대 발주량을 넘는지 체크 한다.
		//    수정일    : 2013/08/01 BY 박용대
		//    수정내용  : 상품을 저장할때 아이리스에서 취소한 목록들이 발주내역에 올라오게되는데
		//                이것들이 최대 발주량계산에 포함되어 있어 발주상태가 003,005인 항목을
		//                제외하고 CASESUM 하는 부분을 추가.
		//-----------------------------------------------------------------------------------
		if ((eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"maxOrdQty") > 0) && ( eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getCaseSum("itemCode=='"+eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"itemCode")+"'&& (lineStatus <> '001' && lineStatus <> '003' && lineStatus <> '004')","prQty") > eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"maxOrdQty")))  
		{   
		    if (toNumber(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"prNum")) <> 0)
		    {
		        //동일상품의 다른 주문날짜일 경우 합산은 최대발주량을 넘어도 상관없다.
		        if ( eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getCaseSum("prNum=='"+eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"prNum")+"'","prQty") <= eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"maxOrdQty"))
		            continue;
		    }
       	    eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition = i;
		    return ("[" + eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"itemName") + "] 상품이 최대 발주량" + eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"maxOrdQty") + ")를 초과하여 주문이 불가합니다.");
		}		
	}
	//수량 0인거 제거...
// 	for (i=ds_List.rowcount-1; i>=0; i--)
// 	{
// 		if ( gfn_numFormat(gfn_trim(ds_List.getColumn(i,"PR_QTY")),1)== "0" ) ds_List.deleteRow(i);
// 	}

	// 발주 저장직전 발주리스트내용 재확인(ds_List <=> ds_ListCheck)
	/*
	fv_chkMsg = "";
	ds_msg.clearData();
	var checkDs = fn_search(true);
	for ( var k=0; k<ds_List.rowcount; k++ ) {
		var nRowType = ds_List.getRowType(k);
		var strExpr = "PR_ID == '" + ds_List.getColumn(k, "PR_ID")+ "'";
			strExpr += " && PR_NUM == '" + ds_List.getColumn(k, "PR_NUM") + "'";
			strExpr += " && ITEM_CODE == '" + ds_List.getColumn(k, "ITEM_CODE") + "'";
		var nRow1 = ds_List.findRowExpr(strExpr);
		var nRow2 = checkDs.findRowExpr(strExpr);
		
		var sLine1 = ds_List.getColumn(nRow1, "LINE_STATUS");
		var sLine2 = checkDs.getColumn(nRow2, "LINE_STATUS");
		//trace(strExpr);
		trace(nRow1+"||"+nRow2+"||"+sLine1+"||"+sLine2);
		//if ( nRowType == Dataset.ROWTYPE_UPDATE ) {
			if ( nRow1 != -1 && nRow2 != -1 ) {
				if ( sLine1 != sLine2 ) {
					ds_List.updatecontrol = false;
					ds_List.setRowType(nRow1, Dataset.ROWTYPE_NORMAL);	// for skip save
					//return ("["+ds_List.getColumn(nRow1, "ITEM_NAME")+"] 상품의 발주상태가 " + checkDs.getColumn(nRow2, "PO_LINE_STATUS") +"로 변경되어 해당 내용을 수정할 수 없습니다.");
					fv_chkMsg = "["+ds_List.getColumn(nRow1, "ITEM_CODE")+":"+ds_List.getColumn(nRow1, "ITEM_NAME")+"] 상품의 발주상태가 " + checkDs.getColumn(nRow2, "PO_LINE_STATUS") +"로 변경되어 해당 내용을 수정할 수 없습니다.";
					var nRow = ds_msg.addRow();
					ds_msg.setColumn(nRow, "NO", nRow);
					ds_msg.setColumn(nRow, "MSG", fv_chkMsg);
					ds_List.updatecontrol = true;
				}
			}
		//}
	}
	
	if ( !gfn_dsIsUpdated(ds_List) ) {
		return "주문한 자재의 발주상태가 변경되어 수정할 수 없습니다.\r\n발주내역을 다시 조회하여 상태를 확인하시기바랍니다.";
	}
	*/
	
	var rtnCheckMsg = fn_checkLineStatus(null, checkDs);
	if ( !gfn_isNull(rtnCheckMsg) ) {
		return rtnCheckMsg;
	}
	
	// 저장 시 수량이 0 이거나 NULL 인 자재 삭제 처리
	for( var i = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getRowCount()-1; i >= 0; i-- ) {		
		if( eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i, "prQty") == 0 || gfn_length(gfn_trim(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i, "prQty"))) == 0 ) {
			eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).deleteRow(i);
		}		
	}
}
function fn_FormKeyDown(obj:Form, e:KeyEventInfo)
{
	if(e.ctrlKey == true && e.keycode == 86) {
		//'true'를 반환하면 상위 컴포넌트에서 onkeydown 이벤트가 발생하지 않습니다.
		return true;
	}
	
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
	
	
	
	//입고예정일에서 엔터시 조회
	//if ( (nChar == 13) && (objSenderObj == me_NeedDate) ) fn_Search();
	//임시로...'F12'입력시 타이머 작동중지
	if (e.keycode == 123) killTimer(777);
}	

function fn_Trigger_bef(o, c) {
   	
   	if(gfn_dsIsUpdated(ds_Listb1) || gfn_dsIsUpdated(ds_Listb2) || gfn_dsIsUpdated(ds_Listb3))
   	{
		if(g_Confirm("02","변경된 내역이 있습니다. 변경된 내역을 저장하시겠습니까?"))
		{
			fn_save(1);			
		} 
	}
	
	return true;
}

function fn_Trigger_aft(obj, arrRtn)
{
// 	switch(obj.name)
// 	{
// 		case "comp_upjang":						
			//초기화
			fn_ResetData();

			if (! ffn_ChkNull(comp_upjang.getUpjangCode()))
			{
				//센터단가업장정보
				if(!fn_SetCtUpj()) return;
				
				//창고세팅
				fn_SetSubinv(ds_Subinv);
				
				//디데이
				fn_GetDays();
				
				//반환의 경우				
				if(gfn_toString(tab_list.tabindex+1) == 1){		
					if(!ffn_ChkNull(comp_upjang.getUpjangCode())){
						fn_searchRtnOrderYn();
					}
				}
				
				//반환가능업장YN
				fv_rtnYn = arrRtn.rtnYn;				
				
				//자동조회				
				fn_search();
			}
// 			break;
// 
// 		default:
// 			break;
// 	}
}
function fn_ResetData()
{
	ds_rtnOrdTypeAllChg.clearData();
	ds_Subinv.clearData();	
	st_Days.text = "(발주 마감 : - -)";
	st_Timer.text = "";	
	cbo_Subinv.value = ""; 	
	fv_rtnYn = "Y";
 	eval("ds_List" + gfn_toString(tab_list.tabindex+1)).clearData();
 	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).clearData(); 	
 	//me_NeedDate.value  = gfn_addDate(gds_currdate.getColumn(0, "YMD"),1);
	var strCurrent = fn_CurrDateWeek();
	// 시스템 오픈
	if(gfn_addDate(strCurrent,1) < 20220110){
		me_NeedDate.value = null;
	} else {
		me_NeedDate.value  = gfn_addDate(strCurrent,1); //addDate(today(),1);
 		//날자 셋팅 후 일자도 변경
		st_Week.text = "(" + ffn_DayToWeek(me_NeedDate.value) + ")";
		if (st_Week.text == "(토)")
			st_Week.style.color = "blue";
		else if (st_Week.text == "(일)")
			st_Week.style.color = "red";
		else
			st_Week.style.color = "black";
		//공휴일색변경	
		if(gfn_length(fn_isHoliday(me_NeedDate.value))>0)
		{
			st_Week.style.color = "red";
		}
	}

}
function fn_SetSubinv(ds_Obj)
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 초기화
	ds_Obj.clearData();
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= ds_Obj.name + "=ds_List";
//    if (ds_Obj == ds_Subinv)
//    {
		otherArg	= "UPJANG=" + gfn_nvl(wrapQuote(comp_upjang.getUpjangCode()),"");
//    } 
//    else if (ds_Obj == ds_SubinvP) {
//		otherArg	= "UPJANG=" + wrapQuote(tab_list.tab4.ed_UpjangP.userdata);
//    } 
		
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_PO_SUBINV_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	//기본창고지정
//    if (ds_Obj == ds_Subinv)
//    {
		if (ds_Obj.rowcount > 0) cbo_Subinv.index = 0;
//	}
//	else if (ds_Obj == ds_SubinvP)
//	{
//		if (ds_Obj.rowcount > 0) tab_list.tab4.cbo_SubinvP.index = 0;
//	}
	
	//fn_getBudgetInfo();
}
function fn_GetDays()
{
	// 초기화(디데이)
	ds_Days.clearData();
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_Days=ds_List";
    otherArg	= "UPJANG=" + gfn_nvl(wrapQuote(comp_upjang.getUpjangCode()),"") + " SUBINV_CODE=" + wrapQuote(cbo_Subinv.value) + " NEED_DATE=" + wrapQuote(me_NeedDate.value);
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_GETDAYS_S001");
	// 서버 호출 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	http.Sync = false;
	//디데이 표시
	if (ds_Days.rowcount > 0){	
		var set1 = v_dsT.getColumn(0, "set1");
		var set2 = v_dsT.getColumn(0, "set2");		
		var attr01 = v_dsT.getColumn(0, "attr01");
		var attr02 = v_dsT.getColumn(0, "attr02");				
		if(set1 <= me_NeedDate.value && set2 >= me_NeedDate.value){		
			ds_Days.setColumn(0,"D_TIMES" ,attr01);		
			ds_Days.setColumn(0,"DAYS", "D-"+ds_Days.getColumn(0,"D_DAYS")+" "+attr01.substr(0,2)+":"+attr01.substr(2,2));		
		} else {		
			ds_Days.setColumn(0,"D_TIMES" ,attr02);		
			ds_Days.setColumn(0,"DAYS", "D-"+ds_Days.getColumn(0,"D_DAYS")+" "+attr02.substr(0,2)+":"+attr02.substr(2,2));		
		}
		
		st_Days.text = "(발주 마감 : " + ds_Days.getColumn(0,"DAYS") + ")";
	}
	else
	{
		g_Message("EE","발주마감정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
		//close();
	}
	// 초기화(주문통제)
	ds_OrdCtrl.clearData();
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_OrdCtrl=ds_List";
    otherArg	= "UPJANG=" + gfn_nvl(wrapQuote(comp_upjang.getUpjangCode()),"");
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_ORD_CTRL_S001");
	// 서버 호출 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	http.Sync = false;
}
// [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
/*----------------------------------------------------------------------------------------------
 * 설명      : 여신정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_GetCredit() {
// 	var rtnValue = false;
// 	
// 	////////////////////////////////////////////////////////////////////////////////////////////////////////
// 	// 초기화
// 	////////////////////////////////////////////////////////////////////////////////////////////////////////
// 	ds_Cond.clearData();
// 	ds_CrdInfo.clearData();
// 
// 	////////////////////////////////////////////////////////////////////////////////////////////////////////
// 	// 여신정보 조회 조건 셋팅
// 	////////////////////////////////////////////////////////////////////////////////////////////////////////
// 	var iRow = ds_Cond.addRow();
// 	ds_Cond.setColumn(iRow, "UPJANG", comp_upjang.getUpjangCode());    // 업장코드
// 	ds_Cond.setColumn(iRow, "NEED_DATE", me_NeedDate.value);  // 입고예정일
// 	
// 	////////////////////////////////////////////////////////////////////////////////////////////////////////
// 	// 서버단 호출
// 	////////////////////////////////////////////////////////////////////////////////////////////////////////
// 	var svcID, svcUrl, inData, outData, otherArg, callBackFnc, isErrorNotCall, isNotShow, isSync;
// 	svcID          = "FMZ_CREDIT_INFO_T003";                         // 서비스 ID
// 	svcUrl         = "U_svc::" + "fm/fmz/FMZ_CREDIT_INFO_T003.jsp";  // 서비스 URL
// 	inData         = "ds_Cond=ds_Cond";                              // 서버로 전송할 DataSet 객체 Str
// 	outData        = "ds_CrdInfo=ds_CrdInfo";                        // 서버로부터 전송 받을  DataSet 객체 String
// 	otherArg       = "";                                             // 서버로 전송할 기타 Argument 정보 String
// 	callBackFnc    = "";                                             // 서버에서 처리가 완료된 후 Callback 받을 Function 명
// 	isErrorNotCall = false;                                          // 에러 발생 시 Callback 함수 호출 여부
// 	isNotShow      = false;                                          // 처리중입니다. 메시지 창 보여줄지 여부 설정하기
// 	isSync         = true;                                           // 동기식으로 설정할지 여부
// 	jsp_transaction(this, svcID, svcUrl, inData, outData, otherArg, callBackFnc, isErrorNotCall, isNotShow, isSync);
// 
// 	////////////////////////////////////////////////////////////////////////////////////////////////////////
// 	// 여신정보 셋팅
// 	////////////////////////////////////////////////////////////////////////////////////////////////////////
// 	//ta_Sql.value = fa_Sql;
// 	
// 	if ( ds_CrdInfo.getRowCount() == 0 ) {
// 		g_Message("EE", "업장여신정보를 확인할 수 없습니다.\n\n관리자에게 문의하십시오.");
// 		
// 	} else {
// 		rtnValue = true;
// 		
// 		// 여신금액통제일 경우
// 		if ( ds_CrdInfo.getColumn(0,"CREDIT_AMOUNT_CONTROL_YN") == "Y" ) {
// 			ed_Credit.value      = gfn_numFormat(ds_CrdInfo.getColumn(0,"CREDIT_RMN_AMT")) + " 원";    // 가용여신
// 			ed_Bond.value        = gfn_numFormat(ds_CrdInfo.getColumn(0,"BOND_AMT")) + " 원";          // 채권잔액
// 		} else {
// 			ed_Credit.value      = "해당없음";
// 			ed_Bond.value        = "";
// 		}
// 	}
// 	
// 	return rtnValue;
}
// [속도개선 Project   끝] 2017. 8. 21. 최범주

// [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
// function fn_GetCredit_callback(errCode, errMsg)
// {
// ta_Sql.value = fa_Sql;
// 		if (errCode == 0)
// 	{
// 		//여신 표시
// 		if (ds_CrdInfo.rowcount > 0) 
// 		{
// 			if (ds_CrdInfo.getColumn(0,"CREDIT_AMOUNT_CONTROL_YN") == "Y")
// 			{
// 				ed_Credit.value = gfn_numFormat(ds_CrdInfo.getColumn(0,"CREDIT_RMN_AMT"))+ " 원";
// 				ed_Bond.value = gfn_numFormat(ds_CrdInfo.getColumn(0,"BOND_AMT"))+ " 원";
// 			}
// 			else
// 				//ed_Credit.value = "무 제 한";
// 				ed_Credit.value = "해당없음";
// 		}
// 		else
// 		{
// 			//g_Message("EE","업장여신정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
// 			//close();
// 		}
// 	}
// 	else
// 		g_Message("EE",fn_AlertMsg("002"));	
// }
// [속도개선 Project   끝] 2017. 8. 21. 최범주

function fn_GetCrdYn()
{
// 	// fn_checkExceptCredit = true [ 예외(ex.예림푸드) ]
// 	if ( fn_checkExceptCredit() ) {
// 		return false;
// 	}
// 	
// 	//ds임시생성
// 	var dsObjin, dsObjot;
// 	
// 	create("Dataset", "ds_Dummyin");
// 	create("Dataset", "ds_Dummyot");
// 	
// 	dsObjin = eval("ds_Dummyin");
// 	dsObjin.addColumn("UPJANG", "INT", 22);
// 	dsObjin.addColumn("NEED_DATE", "STRING", 8);
// 	dsObjot = eval("ds_Dummyot");
// 	dsObjot.addColumn("CRD_YN", "STRING", 1);
// 	
// 	/*-------------*/
// 	http.Sync = true;
// 	/*-------------*/
// 	// 초기화
// 	ds_Dummyin.clearData();
// 	ds_Dummyot.clearData();
// 	ds_Dummyin.addRow();
// 	ds_Dummyin.setColumn(0, "UPJANG",         comp_upjang.getUpjangCode());
// 	ds_Dummyin.setColumn(0, "NEED_DATE",      me_NeedDate.value);
// 	// 조회
// 	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
// 	// 파라미터셋팅
//     inData		= "ds_Cond=ds_Dummyin";
//     outData		= "ds_Dummyot=ds_List";
// 	//action 정보 초기화 
// 	fsp_clear(this); 
//     // 서버에서 조회할 정보 추가 
// 	fsp_addSearch(this, "fm/fmz:FMZ_CREDIT_CHKYN_S001");
// 	// 서버 호출 
//     fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
// 	/*-------------*/
// 	http.Sync = false;
// 	/*-------------*/
// 	var bYn = (ds_Dummyot.rowcount > 0);
// 	//ds임시생성 해제
// 	Destroy("ds_Dummyin");
// 	Destroy("ds_Dummyot");
// 	return  bYn;
}
function fn_GetLastOrd()
{
// 	//ds임시생성
// 	var dsObjin, dsObjot;
// 		
// 	create("Dataset", "ds_Dummyin");
// 	create("Dataset", "ds_Dummyot");
// 	
// 	dsObjin = eval("ds_Dummyin");
// 	dsObjin.addColumn("SUBINV_CODE", "STRING", 8);
// 	dsObjin.addColumn("NEED_DATE", "STRING", 8);
// 	dsObjin.addColumn("DOCU_SOURCE", "STRING", 50);
// 	dsObjot = eval("ds_Dummyot");
// 	dsObjot.addColumn("NEED_DATE", "STRING", 8);
// 	dsObjot.addColumn("CNT", "DECIMAL", 22);
// 	dsObjot.addColumn("AMT", "DECIMAL", 22);
// 	
// 	// 초기화
// 	dsObjin.clearData();
// 	dsObjot.clearData();
// 	dsObjin.addRow();
// 	dsObjin.setColumn(0, "SUBINV_CODE",    cbo_Subinv.value);
// 	dsObjin.setColumn(0, "NEED_DATE",      me_NeedDate.value);
// 	dsObjin.setColumn(0, "DOCU_SOURCE",    fa_DocSrc);
// 	// 조회
// 	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
// 	// 파라미터셋팅
//     inData		= "ds_Cond=ds_Dummyin";
//     outData		= "ds_Dummyot=ds_List";
// 	otherArg    = "DocSrc1=" + wrapQuote(fa_DocSrc1);
// 	otherArg   += " DocSrc2=" + wrapQuote(fa_DocSrc2);
// 	callBackFnc = "fn_GetLastOrd_callback";
// 	//action 정보 초기화 
// 	fsp_clear(this); 
//     // 서버에서 조회할 정보 추가 
// 	fsp_addSearch(this, "fm/fmp:FMP00160E_S001");
// 	// 서버 호출 
//     fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 

}

function fn_GetLastOrd_callback(errCode, errMsg)
{
// 	if (errCode == 0)
// 	{
// 		//최근 발주 표시
// 		if (ds_Dummyot.rowcount > 0)
// 		{
// 			//trace(ds_Dummyot.saveXML());
// 			me_Pdate.value = ds_Dummyot.getColumn(ds_Dummyot.rowcount-1,"NEED_DATE");
// 			ed_Pcnt.value = '총 (' + gfn_numFormat(ds_Dummyot.getColumn(ds_Dummyot.rowcount-1,"CNT"))+ ') 건';
// 			ed_Pamt.value = gfn_numFormat(ds_Dummyot.getColumn(ds_Dummyot.rowcount-1,"AMT"))+ ' 원';
// 		}
// 		else
// 		{
// 			me_Pdate.value = "";
// 			ed_Pcnt.value = "";
// 			ed_Pamt.value = "";
// 		}
// 		//ds임시생성 해제
// 		Destroy("ds_Dummyin");
// 		Destroy("ds_Dummyot");
// 	}
// 	else
// 		g_Message("EE",fn_AlertMsg("002"));
}

function fn_OrdChk()
{
	fn_GetDays();
	fn_CurrDateWeek();

	//입고통제일 체크 
	if (fn_NeedDateCheck()) 
	{
	    g_Message("EE","해당일자는 입고통제일 입니다.");
   	    eval("ds_List" + gfn_toString(tab_list.tabindex+1)).clearData();
	    eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).clearData();
		st_Timer.text = "마감시간 : 00일 00시간 00분 전";
		return false;
	}

	//발주통제일자
	if (toNumber(ds_Days.getColumn(0,"D_OVER_DAYS")) > 0)
	{
		if (me_NeedDate.value > gfn_addDate(gds_currdate.getColumn(0, "YMD"),toNumber(ds_Days.getColumn(0,"D_OVER_DAYS"))))
		{
			g_Message("EE", ds_Days.getColumn(0,"D_OVER_DAYS") + "일을 초과하여 "+sta_NeedDate.text+"을 지정할 수 없습니다.");
			return false;
		}
	}
	//발주제한일자
	if (toNumber(ds_Days.getColumn(0,"D_DAYS")) > 0)
	{
		if (me_NeedDate.value < gfn_addDate(gds_currdate.getColumn(0, "YMD"),toNumber(ds_Days.getColumn(0,"D_DAYS"))))
		{
			g_Message("EE", "발주마감은 " + ds_Days.getColumn(0,"DAYS") + "입니다.");
			return false;
		}
		if (me_NeedDate.value == gfn_addDate(gds_currdate.getColumn(0, "YMD"),toNumber(ds_Days.getColumn(0,"D_DAYS"))))
		{
			if (gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,6)> ds_Days.getColumn(0,"D_TIMES"))
			{
				g_Message("EE", "발주마감은 " + ds_Days.getColumn(0,"DAYS") + "입니다.");
				return false;
			}
		}
	}
	//창고가 식재 또는 소모품 전용창고인 경우 주문통제 점검
	if (! ffn_ChkNull(ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN")))
	{
		//주문통제(주문일자)
		var nRow;
		nRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='주문'&&ITEM_TYPE==decode('" + ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN") + "','Y','소모품','식자재')");
		if (nRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(nRow,ToUpper(gds_currdate.getColumn(0, "WEEK_ENG"))) == "Y")
			{
				g_Message("EE", gds_currdate.getColumn(0, "WEEK_KOR") + "요일은 주문불가 요일입니다.");
				return false;
			}
		}
		//주문통제(입고일자)
		nRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE==decode('" + ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN") + "','Y','소모품','식자재')");
		if (nRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(nRow,ToUpper(ffn_DayToWeek(me_NeedDate.value,"1"))) == "Y")
			{
				g_Message("EE", ffn_DayToWeek(me_NeedDate.value) + "요일은 입고불가 요일입니다." + "\n\n" + sta_NeedDate.text+"을 변경하세요.");
				return false;
			}
		}
	}else{
		//주문통제(입고일자)
		nRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE=='공통'");
		if (nRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(nRow,ToUpper(ffn_DayToWeek(me_NeedDate.value,"1"))) == "Y")
			{
				g_Message("EE", ffn_DayToWeek(me_NeedDate.value) + "요일은 입고불가 요일입니다." + "\n\n" + sta_NeedDate.text+"을 변경하세요.");
				return false;
			}
		}	
	}
	//
	return true;
}
function fn_SetFav()
{
// 	/*-------------*/
// 	http.Sync = true;
// 	/*-------------*/
// 	// 조회
// 	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
// 	// 파라미터셋팅
//     outData		= "ds_Fav=ds_List";
//     otherArg	= "UPJANG=" + wrapQuote(comp_upjang.getUpjangCode());
// 	//action 정보 초기화 
// 	fsp_clear(this); 
//     // 서버에서 조회할 정보 추가 
// 	fsp_addSearch(this, "fm/fmz:FMZ_FAVORITE_GROUP_S001");
// 	// 서버 호출 
//     fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
// 	/*-------------*/
// 	http.Sync = false;
// 	/*-------------*/
// 	if (ds_Fav.rowcount > 0) tab_list.tab2.cbo_Fav.index = 0;
}
function fn_SetCtUpj()
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_CtUpj=ds_List";
    otherArg	= "UPJANG=" + gfn_nvl(wrapQuote(comp_upjang.getUpjangCode()),"");
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_GET_CTUPJ_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	if (ds_CtUpj.rowcount <= 0)
	{
		g_Message("EE","업장기초정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
		return false;
	}
	return true;
}

//[PJT]주문채널통합
function fn_CopyRow(obj,nRow, sInputType)
{

	if(gfn_isNull(sInputType)) sInputType = "S";
	
	if ( eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).findRowExpr("itemCode=="+wrapQuote(obj.getColumn(nRow,"ITEM_CODE"))) >= 0 )
	{
		if (! g_Confirm("01", '이미 주문등록한 상품입니다.\n\n추가주문 하시겠습니까?!')) return;
	}
	//trace(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).saveXML());
	var nAddRow = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).addRow();
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).copyRow(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition, obj, nRow, fv_copyColumInfo);
	//기본적으로 신청수량은 기본 0으로 설정한다.
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition, "prQty", 0);   //수량
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition, "opAmount", 0); //금액

	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition, "sNeedDate", me_NeedDate.value); //ds처리
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition, "gUpjang", g_Upjang); //ds처리
	//eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition, "gEmpNo", g_EmpNo); //ds처리
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition, "tabName", tab_list.tabpages[tab_list.tabindex].name); //ds처리

	//반환/교환일경우만 기본세팅값
// 	if(gfn_toString(tab_list.tabindex+1) != 3){
// 		eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition, "rtnOrdType", "A01"); 
// 	}
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition, "inputType", sInputType);
	
	// for only 화성네트웍스-상지대학교부속한방병원[162851]
	if ( obj.getColumn(obj.rowposition, "RC_UPJANG") == "162851" ) {
		eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition, "prRemark", obj.getColumn(obj.rowposition, "PR_REMARK_RECENT"));
	}
	//obj.DeleteRow(nRow);
}

//[PJT]주문채널통합
function fn_CopyRowPaste(obj, nSetRow, nRow, sInputType)
{
	if(gfn_isNull(sInputType)) sInputType = "S";
 
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).addColumn( "EXCEPTION_ORDER", "string" );
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).copyRow(nSetRow, obj, nRow, fv_copyColumInfo);
	//기본적으로 신청수량은 기본 0으로 설정한다.
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nSetRow, "prQty", 0);
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nSetRow, "inputType", sInputType);
	
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nSetRow, "EXCEPTION_ORDER", obj.getColumn(nRow,"EXCEPTION_ORDER"));
	
	//반환/교환일경우만 기본세팅값
// 	if(gfn_toString(tab_list.tabindex+1) != 3){
// 		eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nSetRow, "rtnOrdType", "A01"); 		
// 	}
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nSetRow, "sNeedDate", me_NeedDate.value);	//ds처리
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nSetRow, "gUpjang", g_Upjang);	//ds처리
	//eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nSetRow, "gEmpNo", g_EmpNo);	//ds처리
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nSetRow, "tabName", tab_list.tabpages[tab_list.tabindex].name);	//ds처리

}


function fn_SetRowImg(nDdays,nDtimes,sWeekItemCode,sUnuseYn,sValSptYn,sPoStatus,sDangaWeekStatus,sExceptionOrder)
{	
	//품목별 D-Day설정과 전체 D-Day설정을 비교하여 빠른것을 기준으로 한다.
	var nDdays1 = greatest(toNumber(nDdays), toNumber(ds_Days.getColumn(0,"D_DAYS")));
	
	var nDtimes1;
	if ( toNumber(nDdays) > toNumber(ds_Days.getColumn(0,"D_DAYS")) )
		nDtimes1 = nDtimes;
	else if ( toNumber(nDdays) == toNumber(ds_Days.getColumn(0,"D_DAYS")) )
		nDtimes1 = least(nDtimes,ds_Days.getColumn(0,"D_TIMES"));
	else if ( toNumber(nDdays) < toNumber(ds_Days.getColumn(0,"D_DAYS")) )
		nDtimes1 = ds_Days.getColumn(0,"D_TIMES");
	
	if (sExceptionOrder != "Y" && (sUnuseYn=="UK" || sValSptYn=="TK" || sPoStatus =="HE" || sDangaWeekStatus =="FE" || sExceptionOrder == "N")) //구매불용, 구매중지, 수발주스케쥴, 단가업장 수발주 스케쥴, 예외관리 품목
	{	
		return "theme://convertImages\\img_RC.png";
	} else if (sExceptionOrder == "Y") //예외품목 관리화면 상 발주가능 자재
	{
		return "theme://convertImages\\img_GC.png";
	} else{
		return decode(fn_GetDayStatus(nDdays,nDtimes,sWeekItemCode),"0","theme://convertImages\\img_RC.png","1","theme://convertImages\\img_YC.png","2","theme://convertImages\\img_GC.png","");
	}
}

function fn_SetRowColor(nDdays,nDtimes,sWeekItemCode,sUnuseYn,sValSptYn,sPoStatus,sDangaWeekStatus)
{
	var bDayStatus;
	
	if(fn_GetDayStatus(nDdays,nDtimes,sWeekItemCode) == "0")
	{
		bDayStatus = true;
	}else{
		bDayStatus = false;
	}
	
	if(sUnuseYn=="UK" || sValSptYn=="TK" || bDayStatus || sPoStatus =="HE" || sDangaWeekStatus =="FE") //구매불용, 구매중지, 수발주스케쥴, 단가업장 수발주 스케쥴 
	{
		return "thistle";
	}else{
		return "white";
	}
}

function fn_GetDayStatus(nDdays,nDtimes,sWeekItemCode)
{
	//리조트 물류스케주울 체크
	if (! ffn_ChkNull(sWeekItemCode)) return "0";
	//무통제면 패스...
	if ( numFormat(nDdays)== "0" )	return "2";
	//디데이체크
	if ( gfn_addDate(gds_currdate.getColumn(0,"YMD"),nDdays)> me_NeedDate.value )
		return "0";
	else if ( gfn_addDate(gds_currdate.getColumn(0,"YMD"),nDdays)== me_NeedDate.value )
	{
		//디타임체크
		if ( gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4)> nDtimes )
			return "0";
		else if ( G_fn_GapTime(0, gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4), nDtimes, "") <= "0030" )
			return "1";
		else
			return "2";
	}
	else
		return "2";
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
function gd_list_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	var strHeadClass = obj.getCellProperty("head", e.col,"class");
    //if(strHeadClass == "head_Excel")
    //{
		// 출력용 그리드
		//gfn_exportExcel(tab_list.tabpages["tab"+parseInt(tab_list.tabindex+1)].gd_list);
		//return;
    //} else {
		gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
	//}
}

// 발주내역 그리드
function gd_list_OnHeadClick1(obj:Grid, e:GridClickEventInfo)
{
	gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
}

function cbo_Subinv_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	//데이타셑 위치변경
	eval(obj.innerdataset).rowposition = e.postindex;
	//초기화
	if (obj == cbo_Subinv)
	{
		//me_Pdate.value = "";
		ed_Pcnt.value = "";
		ed_Pamt.value = "";
		eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).clearData();
		eval("ds_List" + gfn_toString(tab_list.tabindex+1)).clearData();		
		//최종 발주정보
		//fn_GetLastOrd();
		//디데이
		fn_GetDays();
		
		//fn_getBudgetInfo();
		
		//자동조회
		fn_search();
	} 
// 	else if (obj == tab_list.tab2.cbo_Fav) {
// 		ds_List2.clearData();
// 	} else if (obj == tab_list.tab4.cbo_SubinvP) {
// 		ds_List4.clearData();
// 	} 
}

function cbo_Subinv_canitemchange(obj:Combo, e:ItemChangeEventInfo)
{
	if(gfn_dsIsUpdated(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)))==true)
	{
		if(g_Confirm("02","변경된 내역이 있습니다. 변경된 내역을 저장하시겠습니까?"))
		{	
			fn_save(1);
			return true;
		}   else {
			return false;
		}
	} else {
		return true;
	}
}

function me_NeedDate_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{
	//변경되면 포커스를 잃고 글로벌 함수 실행(여기서 글자수를 체크하여 제대로 된 데이터 넘김)
	//g_Date_OnKillFocus(obj);
	
	//변경된 사항이 있는지 확인
	if(gfn_dsIsUpdated(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)))==true)
	{
		g_Message("EE","변경된 내역이 있습니다. 저장해 주십시요");
		//시스템 오픈
		if(pre_need_date < '20220110'){
			me_NeedDate.value = null;
		} else {
			me_NeedDate.value = pre_need_date;	//변경전의 날짜를 되돌림
		}
//		me_NeedDate.value = pre_need_date;	//변경전의 날짜를 되돌림
		return;
	}else{
	
		//발주가능 체크
		if (! fn_OrdChk())
		{
			btn_NeedDate.setFocus();
			return;
		}
		
		// 상단그리드 초기화
		fn_setInitForm();
		
		fn_search();
	}
	
}



function ds_List_CanColumnChange(obj:Dataset, e:DSColChangeEventInfo)
{
	//[PJT]주문채널통합
	if(fv_isCopyPaste == true){
		//trace("copy and paste CanColumnChange return");
		return true;
	}

	//[PJT]주문채널통합
	//박스수량 OR 낱개수량 변경
	if (e.columnid == "prBoxQty" || e.columnid == "prPcQty")
	{
		var nPrQty = e.columnid == "prBoxQty" 
		                 ? (toNumber(e.newvalue, 0) * toNumber(obj.getColumn(e.row, "boxQty"), 0)) + toNumber(obj.getColumn(e.row, "prPcQty"), 0)
		                 : (toNumber(obj.getColumn(e.row, "prBoxQty"), 0) * toNumber(obj.getColumn(e.row, "boxQty"), 0)) + toNumber(e.newvalue, 0);
		//(-)발주여부
		if ( toNumber(nPrQty) < 0 )
		{
			g_Message("EE","(-)발주는 불가합니다.");
			return false;
		}
		//발주마감체크
		fn_CurrDateWeek();
		if (fn_GetDayStatus(obj.getColumn(e.row,"dDays"), obj.getColumn(e.row,"dTimes")) == "0")
		{
			g_Message("EE","해당 상품은 마감시간(D-Days)이 초과되어 수정이 불가합니다.");
			return false;
		}
		//수량통제 안하는 업장의 경우 이하 패스...
		//if (ds_Days.GetColumn(0,"QTY_CONTROL_YN") = "N") return;
		//
		//수량통제 안하는 업장의 경우 소숫점발주가 Y이면 무조건 최소발주량/발주승수량을 무조건 0.1로 세팅하여 조회
		if ( toNumber(nPrQty) > 0 )
		{
			//trace("발주수량 " + obj.getColumn(e.row,"MIN_ORD_QTY") + " >= " + nPrQty + "(" + obj.getColumn(e.row,"BOX_QTY") + ") <= " + obj.getColumn(e.row,"MAX_ORD_QTY"));
			//최소발주량 체크
			if ( (toNumber(obj.getColumn(e.row,"minOrdQty")) > 0) && (toNumber(obj.getColumn(e.row,"minOrdQty")) > toNumber(nPrQty)) && obj.getColumn(e.row, "keepingType") != "냉동" )
			{
				g_Message("EE","해당 상품은 최소발주량이 " + obj.getColumn(e.row,"minOrdQty") + "입니다.");
				return false;
			}
			
			//최대발주량 체크
			/**
			if ( (toNumber(obj.getColumn(e.row,"MAX_ORD_QTY")) > 0) && (toNumber(obj.getColumn(e.row,"MAX_ORD_QTY")) < toNumber(nPrQty)) )
			{
				g_Message("EE","해당 상품은 최대발주량이 " + obj.getColumn(e.row,"MAX_ORD_QTY") + "입니다.");
				return false;
			}
			**/
			// canColumnChange Event에서 obj.getCaseSum()의 올바른 연산을 위해 함수로 대체
			if ( fn_isOverQty(obj, e, nPrQty) ) {
				g_Message("EE","해당 상품은 최대발주량이 " + obj.getColumn(e.row,"maxOrdQty") + "입니다.");
				// 고객인 경우만 제한
				if( g_EmpNo.substr(0,2) == "CS" ) {
					return false;
				}
			}
			
			//소숫점발주여부
			if ( (obj.getColumn(e.row,"pointFlag") != "Y") && (Math.ceil(toNumber(nPrQty)) != toNumber(nPrQty)) )
			{
				g_Message("EE","해당 상품은 소숫점발주가 불가합니다.");
				return false;
			}
			//발주승수량		
			trace("nPrQty " + nPrQty);
			if ( (toNumber(obj.getColumn(e.row,"multiplierQty")) > 0) && ((Math.round(toNumber(nPrQty) * 1000) % Math.round(toNumber(obj.getColumn(e.row,"multiplierQty")) * 1000)) <> 0) )
			{
				g_Message("EE","해당 상품은 발주승수량이 " + obj.getColumn(e.row,"multiplierQty") + "입니다.");
				return false;
			}
		}
		
		//alert(obj.getRowType(e.row) +" : "+ toNumber(nPrQty));
		
// ◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆
// [PJT]주문채널통합
// copy & paste 기능 구현 중 return 처리 없는 case에서 오류발생으로 주석 처리
// grid onkeydown event(ctrl + v)  보다 dataset cancolumnchange event가 선행으로 발생하는 문제
// 		//3개월치 최대발주량 초과시 알람
// 		if ( toNumber(nPrQty) >  toNumber(obj.getColumn(e.row,"MAX_SO_QTY")) )
// 		{
// 			g_Message("EE","해당 상품은 최근 3개월 최대발주량 " + obj.getColumn(e.row,"MAX_SO_QTY") + " 을 초과 하였습니다. ");
// 		}
// ◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆		
		
	} 
	if ( e.columnid == "prRemark" ) {
		if ( gfn_lengthByte(e.newvalue) > 100 ) {
			g_Message("EE","최대 입력 길이(100byte)를 초과 하였습니다.");
			return false;
		} 
	}
	
	return true;
}
function ds_List_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	//[PJT]주문채널통합
	if(fv_isCopyPaste == true){
		//trace("copy and paste CanColumnChange return");
		return true;
	}
	
	//박스수량 OR 낱개수량 변경
	if (e.columnid == "prBoxQty" || e.columnid == "prPcQty"){

		// 입수량이 0일경우 경고창 
		if(e.columnid == "prBoxQty" && toNumber(obj.getColumn(e.row, "boxQty"), 0) == 0) {
			g_Message("EE", obj.getColumn(e.row, "itemName")+ " 자재의 입수량이 0입니다.");
			obj.setColumn(e.row, "prBoxQty", 0);
		} 
		
		var nPrQty = (toNumber(obj.getColumn(e.row, "prBoxQty"), 0) * toNumber(obj.getColumn(e.row, "boxQty"), 0)) + toNumber(obj.getColumn(e.row, "prPcQty"), 0);
		obj.setColumn(e.row, "prQty", nPrQty);
		
		
		//금액계산
		var nAmt = Math.round(toNumber(obj.getColumn(e.row,"salePrice")) * toNumber(nPrQty));
		obj.setColumn(e.row, "saleAmount", nAmt);
		nAmt = Math.round(toNumber(obj.getColumn(e.row,"opPrice")) * toNumber(nPrQty));
		obj.setColumn(e.row, "opAmount", nAmt);
		
		//var nTotWght = Math.round(toNumber(obj.getColumn(e.row, "KG_CONVERT_RATE")) * toNumber(obj.getColumn(e.row, "UOM_CONVERT_RATE")) * toNumber(e.newvalue));
		//var nTotWght = Math.round(toNumber(obj.getColumn(e.row, "KG_CONVERT_RATE")) * toNumber(e.newvalue));
		var nTotWght = Math.round(toNumber(obj.getColumn(e.row, "kgConvertRate")) * toNumber(nPrQty), 3);
		obj.setColumn(e.row, "totWght", nTotWght);
	}
	
	
	
// 	var rtnAmt = fn_getOrderStatus("recheck");	
// 	if ( (obj.getCaseCount("PR_QTY > 0") > 0) && (rtnAmt.ctrlAmt > rtnAmt.poAmt) ) {
// 		st_ctrlAmt.text = " 발주가능금액 " + gfn_numFormat(rtnAmt.ctrlAmt - rtnAmt.poAmt) + "원 부족";
// 		st_ctrlAmt.visible = true;
// 	} else {
// 		st_ctrlAmt.text = "";
// 		st_ctrlAmt.visible = false;
// 	}
}
function ReturnOrderBySales_ontimer(obj:Form, e:TimerEventInfo)
{
	if (e.timerid == 777) {
		fn_SetTimer();
	}
}
function fn_SetTimer()
{
	//입고통제일 체크 
	if (fn_NeedDateCheck()) 
	{
		st_Timer.text = "마감시간 : 00일 00시간 00분 전";
		return;
	}

	fn_CurrDateWeek();
	
	// FICS 발주제한요일, 시간 설정 	
	//fn_setWeekendTime();
		
	var sChkDate, sDay, sTime;
	if ( gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4)>= gfn_trim(ds_Days.getColumn(0,"D_TIMES")) )
	{
		sChkDate = gfn_addDate(me_NeedDate.value, (-1 * (toNumber(gfn_trim(ds_Days.getColumn(0,"D_DAYS"))) + 1)));	
		sTime = G_fn_GapTime("1", gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4), toNumber(gfn_trim(ds_Days.getColumn(0,"D_TIMES"))), "");	
	}
	else
	{
		sChkDate = gfn_addDate(me_NeedDate.value, (-1 * toNumber(gfn_trim(ds_Days.getColumn(0,"D_DAYS")))));
		sTime = G_fn_GapTime("0", gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4), gfn_trim(ds_Days.getColumn(0,"D_TIMES")), "");
	}
	
	if (parseInt(gds_currdate.getColumn(0, "YMD")) <= parseInt(sChkDate))
		sDay = G_fn_CalcDay(gds_currdate.getColumn(0, "YMD"), sChkDate);		
	else
		sDay = G_fn_CalcDay(sChkDate, gds_currdate.getColumn(0, "YMD")) * (-1);		
		
	if ((toNumber(sDay) >= 0) && (toNumber(sDay) < 10)) sDay = "0" + sDay;	
	st_Timer.text = "마감시간 : " + sDay + "일 " + gfn_left(sTime,2)+ "시간 " + gfn_right(sTime,2)+ "분 전";
	
	
	st_Week.text = "(" + ffn_DayToWeek(me_NeedDate.value) + ")";
	if (st_Week.text == "(토)")
		st_Week.style.color = "blue";
	else if (st_Week.text == "(일)")
		st_Week.style.color = "red";
	else
		st_Week.style.color = "black";
	//공휴일색변경	
	if(gfn_length(fn_isHoliday(me_NeedDate.value))>0)
	{
		st_Week.style.color = "red";
	}
	
		
	fa_sDay = sDay;	
	if (toNumber(sDay) < 0) fn_CLS_STATUS_Setting(); 	
}

function fn_CLS_STATUS_Setting()
{	
    if (fa_sDay >= 0) return;
    
    eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).updatecontrol = false;
	for (i=0; i<eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount; i++)
	{		
		if (eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i, "otcustcd") != "0000")
		{		
			eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(i, "clsStatus", "마감");
			eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setRowType(i, Dataset.ROWTYPE_NORMAL);
		}
	}
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).updatecontrol = true;	
}
function ed_Item_OnKeyDown(obj, e)
{
	if ( e.keycode == 13 ) fn_SearchItem();
}
function btn_search_OnClick(obj:Button, e:ClickEventInfo)
{
	fn_SearchItem();
}
function btn_search_OnKeyDown(obj:Button, e:KeyEventInfo)
{
	if ( e.keycode == 13 ) btn_search_OnClick(obj);
}
function gd_list_OnCellDblClick(obj:Grid, e)
{
	/*
	  주문시점의 업장, 창고, 입고일자를 저장한다.
	  왜냐하면 주문을 하고 발주내역에 등록이 된 뒤에
	  날짜를 변경하면 발주된된 데이터에 대해서 
	  변경을 하겠습니까? 라고 확인메세지를 주는데
	  여기서 아니오라고 해도 업장과 창고 입고일자는 
	  바뀌어 버리기 때문에(공통함수라서) 
	  아니오 일때는 주문시점의 데이터를 다시 불러와야함
	*/
	pre_need_date = me_NeedDate.value;


	//if (obj == gd_list) return;
	if (eval(obj.binddataset).rowcount < 1) return;
	if (e.row < 0) return;
	
	//반환이 아닌경우만..
	if(gfn_toString(tab_list.tabindex+1) != 1){
		//마트/브랜드 전자구매 수발주제어 예외관리 적용 2022.05.06
		if (  eval(obj.binddataset).getColumn(e.row,"EXCEPTION_ORDER") == "Y" || eval(obj.binddataset).getColumn(e.row,"EXCEPTION_ORDER") == "N")
		{
			if(eval(obj.binddataset).getColumn(e.row,"EXCEPTION_ORDER") == "Y" )
			{ //발주가능
			}
			else if(eval(obj.binddataset).getColumn(e.row,"EXCEPTION_ORDER") == "N" )
			{ //발주불가
				g_Message("EE","해당 상품은 발주통제 상품입니다!");
				return;
			}
		}
		else {
			//리조트 물류스케주울 체크
			if (! ffn_ChkNull(eval(obj.binddataset).getColumn(e.row,"WEEK_ITEM_CODE")))
			{
				g_Message("EE","해당 상품은 요일통제 상품입니다!");
				return;
			}
			//주문통제체크	
			if (!ffn_ChkNull(eval(obj.binddataset).getColumnInfo("LIMIT_ITEM"))) {	
				if (! ffn_ChkNull(eval(obj.binddataset).getColumn(e.row,"LIMIT_ITEM")))
				{
					g_Message("EE","해당 상품은 주문통제 상품입니다!" + "\n\n" + "통제내용:" + eval(obj.binddataset).getColumn(e.row,"LIMIT_REASON"));
					return;
				}
			}

			if (eval(obj.binddataset).getColumn(eval(obj.binddataset).rowposition,"UNUSE_YN") == "UK" || eval(obj.binddataset).getColumn(eval(obj.binddataset).rowposition,"VAL_STP_YN") == "TK" ) 
			{	
				g_Message("EE","해당 상품은 주문불가 상품입니다!");
				return;
			}	
			
			//단가업장 수발주 요일 제한 상품 체크
			if (eval(obj.binddataset).getColumn(eval(obj.binddataset).rowposition,"DANGAWEEK_STATUS") == "FE")
			{
				g_Message("EE","해당 상품은 단가업장 수발주 요일 제한 상품입니다!");
				return;
			}	
		}	
	}
	
// 	if(tab_list.tabindex == 1)	//즐겨찾기상품
// 	{
// 		//금지자재 및 불용자재 체크	
// 		//trace(ds_List2.getColumn(ds_List2.rowposition,"UNUSE_YN"));
// 		//trace(ds_List2.getColumn(ds_List2.rowposition,"VAL_STP_YN"));
// 
// 		if (ds_List2.getColumn(ds_List2.rowposition,"UNUSE_YN") == "UK" || ds_List2.getColumn(ds_List2.rowposition,"VAL_STP_YN") == "TK" ) 
// 		{	
// 			g_Message("EE","해당 상품은 주문불가 상품입니다!");
// 			return;
// 		}	
// 		
// 		//단가업장 수발주 요일 제한 상품 체크
// 		if (ds_List2.getColumn(ds_List2.rowposition,"DANGAWEEK_STATUS") == "FE")
// 		{
// 			g_Message("EE","해당 상품은 단가업장 수발주 요일 제한 상품입니다!");
// 			return;
// 		}	
// 	}

	//발주마감체크
	if (fn_GetDayStatus(eval(obj.binddataset).getColumn(e.row,"D_DAYS"), eval(obj.binddataset).getColumn(e.row,"D_TIMES")) == "0")
	{
		//g_Message("EE","마감시간이 초과되어 주문이 불가합니다.");
		return;
	}
	//창고가 식재/소모품 통합창고인 경우 주문통제 점검
	if (ffn_ChkNull(ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN")))
	{
		//주문통제(주문일자)
		var jRow;
		jRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='주문'&&ITEM_TYPE==iif('" + eval(obj.binddataset).getColumn(e.row,"CONSUM_YN") + "','Y','소모품','식자재')");
		if (jRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(jRow,ToUpper(gds_currdate.getColumn(0, "WEEK_ENG"))) == "Y")
			{
				g_Message("EE", gds_currdate.getColumn(0, "WEEK_KOR") + "요일은 " + ds_OrdCtrl.getColumn(jRow,"ITEM_TYPE") + " 주문불가 요일입니다.");
				return;
			}
		}
		//주문통제(입고일자)
		jRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE==iif('" + eval(obj.binddataset).getColumn(e.row,"CONSUM_YN") + "','Y','소모품','식자재')");
		if (jRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(jRow,ToUpper(ffn_DayToWeek(me_NeedDate.value,"1"))) == "Y")
			{
				g_Message("EE", ffn_DayToWeek(me_NeedDate.value) + "요일은 " + ds_OrdCtrl.getColumn(jRow,"ITEM_TYPE") + " 입고불가 요일입니다." + "\n\n" + sta_NeedDate.text +"을 변경하세요.");
				return;
			}
		}
	}else{
		//주문통제(입고일자)
		jRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE=='공통'");
		if (jRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(jRow,ToUpper(ffn_DayToWeek(me_NeedDate.value,"1"))) == "Y")
			{
				g_Message("EE", ffn_DayToWeek(me_NeedDate.value) + "요일은 " + ds_OrdCtrl.getColumn(jRow,"ITEM_TYPE") + " 입고불가 요일입니다." + "\n\n" + sta_NeedDate.text +"을 변경하세요.");
				return;
			}
		}	
	}
	
	// 최초등록시 주문번호 채번, 이후에는 같은 주문번호가 나오도록 함
	// 조회건수가 1건이라도 있을경우
	//ds_List.filter("OTCUSTCD=='0000'");	
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).filter("otcustcd=='0000'");
	
// 	if (fn_dsListbCnt > 0)
// 	{
// 		for (i=0; i<eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount; i++)
// 		{
// 			fn_gubunNewOrOld = "OLD";	
// 			
// 			if(!gfn_isNull(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i, "prNum")) && eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i, "otcustcd") == "0000")
// 			{
// 				fn_maxPrNum = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i, "prNum");
// 			}
// 			
// 			if(!gfn_isNull(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i, "approveNum")))
// 			{
// 				fn_maxApproveNum = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i, "approveNum");	
// 			}			
// 		}
// 	}
// 	else
// 	{
// 		fn_maxPrNum = "";
// 		fn_maxApproveNum = "";
// 		fn_gubunNewOrOld = "NEW";
// 	}
	
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).filter("");
	
	//라인복사
	fn_CopyRow(eval(obj.binddataset), e.row, "S");
	
	//obj.SetFocus();
	
	eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)+".gd_listb" + gfn_toString(tab_list.tabindex+1)).setFocus();
	eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)+".gd_listb" + gfn_toString(tab_list.tabindex+1)).setCellPos(9); //[PJT]주문채널통합
	
}

function tab_list_tab1_gd_list_OnEnterDown(obj,nRow,nCell,strVal,nPivotIndex)
{
	//2007버젼의 CyGridU.dll에 있는 오류를 수정하기 위해 온 엔터 다운코드를 제거함.
	//오류내용 : 1번째 그리드를 선택하고 엔터를 누르면 2번째 레코드 nRow가 넘어가는 현상
	//때문에 keyDown 함수에 구현함.
}


// function tab_list_OnChanged(obj:Tab, e:TabIndexChangeEventInfo)
// {
// 	eval("tab_list.tab" + gfn_toString(e.postindex + 1)).ed_Item.setFocus();
// 	
// 	if(e.postindex == '1')
// 	{
// 		//즐겨찾기그룹
// 		fn_SetFav();
// 	};
// }
function gd_list_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	
// 	if(tab_list.tabindex=='0') //상품추가 탭에서
// 	{
// 		//즐겨찾기 추가 버튼을 누를 때
// 		if(e.cell == 15)//[PJT]주문채널통합
// 		{
// 		
// 			if ( !gfn_isNull(eval(obj.binddataset).getColumn(e.row, "FAVOR_GROUP_FLAG")) ) {
// 			
// 				//삭제확인
// 			if (! g_Confirm("01", '선택하신 즐겨찾기 상품을 삭제하시겠습니까?!')) return;
// 				//fn_deleteFav(e.row);
// 				var strParam = {};
// 				strParam["fa_ItemCode"] = eval(obj.binddataset).getColumn(e.row, "ITEM_CODE");
// 				strParam["fa_ItemName"] = eval(obj.binddataset).getColumn(e.row, "ITEM_NAME");
// 				strParam["fa_Upjang"] = comp_upjang.getUpjangCode();
// 				strParam["fa_Mode"] = "D";
// 								
// 				gfn_dialog("", "U_FMP::FMP00080P.xfdl", strParam);
// 			} else {
// 				//alert(obj +"|"+ nRow +"|"+ nCell +"|"+ nX +"|"+ nY +"|"+ nPivotIndex);
// 				var strParam = {};
// 				strParam["fa_ItemCode"] = eval(obj.binddataset).getColumn(e.row, "ITEM_CODE");
// 				strParam["fa_ItemName"] = eval(obj.binddataset).getColumn(e.row, "ITEM_NAME");
// 				strParam["fa_Upjang"] = comp_upjang.getUpjangCode();
// 				strParam["fa_Mode"] = "I";
// 				
// 				gfn_dialog("", "U_FMP::FMP00080P.xfdl", strParam);
// 				
// 			}
// 			fn_SearchItem();
// 		}
// 	}else if(tab_list.tabindex=='1') //즐겨찾기 탭에서
// 	{
// 		//즐겨찾기 삭제 버튼을 누를 때
// 		if(e.cell == 15)//[PJT]주문채널통합
// 		{
// 			//삭제확인
// 			if (! g_Confirm("01", '선택하신 즐겨찾기 상품을 삭제하시겠습니까?!')) return;
// 			fn_deleteFav(e.row);
// 		}
// 	}
	
	//2010/03/22 수량 입력 클릭 시 공백 처리 == by Noh Kyu Wan ==
// 	if (e.cell == 9)//[PJT]주문채널통합
// 	{
// 	    if (ds_List.getColumn(e.row,"PR_QTY") <> 0)
// 	    {}
// 	    else	    
// 		ds_List.setColumn(e.row,"PR_QTY","");		
//      }			
// 	
 	if (eval(obj.binddataset).rowcount < 1) return;
 	if (e.row < 0) return;
 	if (e.cell <> 1) return;
	
	//상품이미지
/*
	if (object(obj.BindDataset).GetColumn(nRow, "OTCUSTCD") = "0000")
		gfn_dialog("", "U_SCC::SCC91000P.xml","fa_Image="+quote(gfmsImgPathH + object(obj.BindDataset).GetColumn(nRow, "IMAGE_PATH")));
	else
		gfn_dialog("", "U_SCC::SCC91000P.xml","fa_Image="+quote(gfmsImgPathO + object(obj.BindDataset).GetColumn(nRow, "IMAGE_PATH")));
*/
	
	/******************* 구매 자재팝업으로 변경*/
// 	var strParam = {};
// 	strParam["fa_CenterCode"] = gfn_trim(eval(obj.binddataset).getColumn(e.row, "CENTER_CODE"));
// 	strParam["fa_Custcd"] = gfn_trim(eval(obj.binddataset).getColumn(e.row, "CUSTCD"));
// 	strParam["fa_ItemCode"] = gfn_trim(eval(obj.binddataset).getColumn(e.row, "ITEM_CODE"));
// 	if (gfn_length(eval(obj.binddataset).getColumn(e.row, "IMAGE_PATH"))<= 0)
// 		strParam["fa_Image"] = '';
// 	else
// 	{
// 		if (eval(obj.binddataset).getColumn(e.row, "OTCUSTCD") == "0000")
// 		{
// 			strParam["fa_Image"] = gfn_trim(gfmsImgPathH + eval(obj.binddataset).getColumn(e.row, "IMAGE_PATH"));
// 		}
// 		else
// 		{
// 			//기존에 쓰던 서버가 바뀌어서 강제로 변경함.
// 			var ImgPath = "http://203.233.82.50/hwfs/upload/fm/item/";
// 			strParam["fa_Image"] = gfn_trim(ImgPath + eval(obj.binddataset).getColumn(e.row, "IMAGE_PATH"));
// 			//trace("pppppp : " + strParam);
// 		}
// 	}
	var arrParam = new Array();
	
	arrParam[0] = eval(obj.binddataset).getColumn(e.row, "ITEM_CODE");
	
	var rtnVal = gfn_dialog("FMP00010P"			// dialogId
				   , "U_FMP::FMP00010P.xfdl"		// Url
				   , {fv_Contents:arrParam}					// 배열
				   , null, null, null, null, null, false, true, -1);
				   
	//strParam["fa_ItemPrice"] = eval(obj.binddataset).getColumn(e.row, "OP_PRICE");
// 	strParam["fa_ItemCode"] = eval(obj.binddataset).getColumn(e.row, "ITEM_CODE");
// 	gfn_dialog("", "U_FMP::FMP00010P.xfdl", strParam);
	/********************/
	
	//20150824 구매자재팝업 사용 X
	//자재상세팝업 호출 : 두번째 파라미터는 아이템코드 
	//SCSysIf.eprocPopup(SCSysIf.EPROC_ITEM_POPUP, gfn_trim(eval(obj.binddataset).getColumn(e.row, "ITEM_CODE")));
}
function ReturnOrderBySales_onactivate(obj:Form, e:ActivateEventInfo)
{
	//fn_searchItemUpMemory();
	
	//화면 액트브시 타이머 재설정	
	fn_SetTimer();
	setTimer(777,30000); //일단 30초 세팅
	
}
function ReturnOrderBySales_ondeactivate(obj:Form, e:ActivateEventInfo)
{
	//타이머 종료...(타이머 발생으로 쿼리 수행하여 결과값 가져오면 화면이 앞으로 올라온다.
	killTimer(777);
}

// 2008.12.11 추가 (조회 분류 OnChanged 추가) by Noh Kyu Wan
function cbo_Class2_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
// 	//trace(ds_Class3.saveXML());
// 	//trace(e.postvalue);
// 	//trace(obj);
// 	
// 	if(gfn_isNull(e.postvalue))
// 	{
// 		trace("null");
// 	}
// 	
// 	if (obj == tab_list.tab1.cbo_Class2)
// 	{
// 		if(gfn_isNull(e.postvalue))	//전체일경우 필터해제
// 		{
// 			ds_Class3.filter("");
// 			ds_Class4.filter("");
// 			tab_list.tab1.cbo_Class3.index = 0;
// 			tab_list.tab1.cbo_Class4.index = 0;
// 		}
// 		else
// 		{
// 			// 소분류 데이터셋 필터
// 			ds_Class3.filter("gfn_left(CLASS_CODE,3)=="+wrapQuote(gfn_left(e.postvalue,3))+"||CLASS_CODE==''");
// 			tab_list.tab1.cbo_Class3.index = 0;
// 			// 세분류 데이터셋 필터
// 			ds_Class4.filter("gfn_left(CLASS_CODE,3)=="+wrapQuote(gfn_left(e.postvalue,3))+"||CLASS_CODE==''");
// 			tab_list.tab1.cbo_Class4.index = 0;
// 		}
// 	}
// 	else if (obj == tab_list.tab1.cbo_Class3)
// 	{
// 		if(gfn_isNull(e.postvalue))	//전체일경우 필터해제
// 		{
// 			ds_Class4.filter("");
// 			tab_list.tab1.cbo_Class4.index = 0;
// 		}
// 		else
// 		{
// 			ds_Class4.filter("gfn_left(CLASS_CODE,5)=="+wrapQuote(gfn_left(e.postvalue,5))+"||CLASS_CODE==''");
// 			tab_list.tab1.cbo_Class4.index=0;
// 		}
// 	}	
}
function cbo_Class2_OnKeyDown(obj:Combo, e:KeyEventInfo)
{
//	ffn_SetComboNull(obj, e.keycode);	
}
function gd_list_OnEnterDown(obj:Grid, e:GridEditEventInfo)
{	
	//********************************************************************************************
	// 기능 추가 : CSR Number <26200> 
	// 변 경 자  : 노규완
	// 수정 일자 : 2009-04-10 
	// 수정 내역 : 기존 상품 조회 추가 시 마우스 포커스 이동이 수량 -> 비고.
	//             그리드에 등록 된 마지막 Row의 비고란에서 Enter값이 들어 오면 
	//             마우스 포커스가 상품검색란으로 이동 시켜 준다.
	//********************************************************************************************	
	//trace(ds_List.getCountNF() +"::"+ (ds_List.rowposition + 1) + "::" + gd_list.getCellPos());

// 	if ( obj == gd_list );	
// 	{
// 		if ( (eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getCountNF() == eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition + 1) && (gd_list.getCellPos() == 10) ) //[PJT]주문채널통합 10 > 15
// 		{
// 		  if (tab_list.tabindex == 0)  tab_list.tab1.ed_Item.setFocus();
// 		  if (tab_list.tabindex == 1)  tab_list.tab2.ed_Item.setFocus();
// 		  if (tab_list.tabindex == 2)  tab_list.tab3.ed_Item.setFocus();
// 		  if (tab_list.tabindex == 3)  tab_list.tab4.ed_Item.setFocus();
// 		}	
// 	}	
}

//gd_list_OnEnterDown을 대체함.
function gd_list_onkeydown(obj:Grid, e:KeyEventInfo)
{
	if (e.keycode == 13) {		
		if ((eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getCountNF() == eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition + 1) && (eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)+".gd_listb" + gfn_toString(tab_list.tabindex+1)).getCellPos() == 18)) { //18
			//trace(ds_List.getCountNF() +"::"+ (ds_List.rowposition + 1) + "::" + gd_list.getCellPos());
			
			eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.setFocus();
			
			return true; //Focus 이상으로 추가함.
		}	
	}
	
	//[PJT]주문채널통합
	// Ctrl + V	: Paste
	else if(e.ctrlKey == true && e.keycode == 86) {
			var sClip = new String(system.getClipboard("CF_UNICODETEXT"));
			
			if(gfn_isNull(gfn_trim(sClip, ""))){
				g_Message("EE", "붙여넣기 할 데이터가 없습니다.");
				return true;
			}
			
			//필수항목 
			if (fn_ChkManNull()) return true;
			
			//입고통제일 체크 
			if (fn_NeedDateCheck()) 
			{
				g_Message("EE","해당일자는 입고통제일 입니다.");
				eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).clearData();
				eval("ds_List" + gfn_toString(tab_list.tabindex+1)).clearData();
				st_Timer.text = "마감시간 : 00일 00시간 00분 전";
				return true;
			}

			fv_isCopyPaste = true;
			
			// 최초등록시 주문번호 채번, 이후에는 같은 주문번호가 나오도록 함
			// 조회건수가 1건이라도 있을경우
			//ds_List.filter("OTCUSTCD=='0000'");
			
	// 		if (fn_dsListbCnt > 0)
	// 		{
	// 			for (i=0; i<eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount; i++)
	// 			{
	// 				fn_gubunNewOrOld = "OLD";	
	// 				
	// 				if(!gfn_isNull(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i, "prNum")) && eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i, "otcustcd") == "0000")
	// 				{
	// 					fn_maxPrNum = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i, "prNum");
	// 				}
	// 				
	// 				if(!gfn_isNull(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i, "approveNum")))
	// 				{
	// 					fn_maxApproveNum = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i, "approveNum");	
	// 				}			
	// 			}
	// 		}
	// 		else
	// 		{
	// 			fn_maxPrNum = "";
	// 			fn_maxApproveNum = "";
	// 			fn_gubunNewOrOld = "NEW";
	// 		}
			
			//ds_List.filter("");
		
			
			var nCellPos = Math.max(0, eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)+".gd_listb" + gfn_toString(tab_list.tabindex+1)).getCellPos());
			var sColumn  = gfn_replace( gfn_toString(eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)+".gd_listb" + gfn_toString(tab_list.tabindex+1)).getCellProperty("body", nCellPos, "text")), "bind:", "");
			var nRowPos  = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowposition;
			var sDataArr = sClip.split("\r\n");
			var bNum     = false; 

			//ctrl + v 제외 처리 T_ORDER 실발주자, PR_REMARK 비고
			//if(sColumn == "T_ORDER" ||  sColumn == "prRemark") {					
			if(sColumn == "prRemark") {					
				fv_isCopyPaste = false;
				return true;
			}		
			
			//PR_BOX_QTY 박스수량, PR_PC_QTY 낱개수량, PR_REMARK 비고
			else if(sColumn != "prBoxQty" && sColumn != "prPcQty"){
				//입력가능한  컬럼이 아니면 바코드로 설정
				sColumn = "winItemCd";
			}
			//trace("sColumn :: " + sColumn);
			//숫자만 입력 컬럼
			if(sColumn == "prBoxQty" || sColumn == "prPcQty"){
				bNum = true;
			}
			
			//마지막 빈값이면 배열에서 제거함. >> 뒤부터 빈값이면 제거
			for(var i = sDataArr.length-1; i >= 0; i--){
				if(gfn_isNull(gfn_trim(sDataArr[i]))){
					sDataArr.pop();
				} else {
					break;
				}
			}
			
			//붙여넣기 row find
			var nFindRow = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).findRowExpr("inputType == 'P'"); //P : PASTE(발주내역 그리드 붙여넣기), S : SELECT(상품검색 그리드 더블클릭), N : NOMAL(조회)
			if(sColumn == "winItemCd"){

				if(nFindRow > -1 && gfn_confirm("이전에 붙여넣기된 데이터가 사라집니다.\n계속 진행 하시겠습니까?") == false){
					fv_isCopyPaste = false;			
					return true;
				}
				
				//삭제 처리
				if(nFindRow > -1){
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).enableevent = false;
					for(var i = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount-1; i >= 0; i--){
						if(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i, "inputType") == "P"){
							eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).deleteRow(i);
						}
					}
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).enableevent = true;
				}
				nRowPos  = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount-1;

				//바코드는 temp dataset에 입력 & 상품조회.
				eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).enableevent = false;
				for(var i = 0; i < sDataArr.length; i++){
					
					var sItemStatus = "N";
					var sItemName = "바코드 상품 조회중";
					var nAddRow = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).addRow();
					var sValue = gfn_trim(sDataArr[i]);
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nAddRow, sColumn, sValue);
					
					if(!gfn_isDigit(sValue)){
						sItemStatus = "E";
						sItemName = "올바른 바코드 형식이 아닙니다.";
					}
					
					//기본값 설정
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nAddRow, "itemName"  , sItemName);//상품명
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nAddRow, "opPrice"   , 0);//단가
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nAddRow, "opPriceTax"   , 0);//단가
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nAddRow, "minOrdQty", 0);//박스수량
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nAddRow, "prBoxQty" , 0);//최소단위주문수량
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nAddRow, "prPcQty"  , 0);//낱개수량
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nAddRow, "prQty"     , 0);//수량총계
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nAddRow, "opAmount"  , 0);//금액
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nAddRow, "totWght"   , 0);//총중량
					
					//상태값
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nAddRow, "inputType" , "P");
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nAddRow, "itemStatus", sItemStatus);

				}
				eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).enableevent = true;

				//바코드 처리를 위한 row값 저장변수
				fv_searchBarcodeRowIdx = nRowPos+1;
				
				//바코드로 상품코드 조회 시작
				var nX = parseInt(this.position.width/2, 10) - parseInt(pgb_order.position.width/2, 10) ;
				var nY = parseInt(this.position.height/2, 10) - parseInt(pgb_order.position.height/2, 10);		
				pgb_order.move(nX, nY);
				pgb_order.visible = true;
				fn_SearchItemBarcode();
				
			} // end if(sColumn == "WIN_ITEM_CD")
			else {
			
				var nForCnt = Math.min((eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount - nRowPos ), sDataArr.length);
				
				//단건이면 pass
				if(nForCnt == 1){
					fv_isCopyPaste = false;			
					return true;
				}
				
				//발주마감체크
				fn_CurrDateWeek(); // 일자조회???
				
				eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)+".gd_listb" + gfn_toString(tab_list.tabindex+1)).setCellPos(0);// 다른 cell로 이동하지 않으면 첫 row에 이상한 값이 들어온다.
				var validMsgArr = new Array(); //validation
				eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).enableevent = false;
				
				var boxQtyZeroIndex = 0;
				var boxQtyZeroMsg = "";
				
				
				for(var i = 0; i < nForCnt ; i++){
				
					var nCurRow = nRowPos+i;
					var sValue = gfn_trim(sDataArr[i]);
								
					//붙여넣기 Row만 처리
					if(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(nCurRow, "inputType") != "P"){
						continue;
					}
					//상품검색 오류 Row pass
					if(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(nCurRow, "itemStatus") == "E"){
						continue;
					}
					//nLastRow = nCurRow;
					
					if(bNum == true){
						// ,등이 들어올 수 있으니 replace 처리					
						sValue = gfn_nvl(sValue.replace(/[^0-9\. ]/g,""),0);					
					}
					
					
					// 박스입수량이 0인데 입력한숫자가 0보다 크다면 alert 후 0으로 값 변경
					if(sColumn == "prBoxQty") { 
						if( eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(nCurRow, "boxQty") == 0 && (sValue > 0) ) {
							if(boxQtyZeroMsg==""){ boxQtyZeroMsg += eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(nCurRow, "itemName");}
							boxQtyZeroIndex++;
							sValue=0;
						}
						//trace(boxQtyZeroMsg + " 외 " + (boxQtyZeroIndex-1) + " 개의 입수량이 0입니다.");
					}
					
					
					
					var objOldValue = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(nCurRow, sColumn); // 이전값 저장
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nCurRow, sColumn, sValue);
					
					var sWinItemCd = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(nCurRow, "winItemCd");
					if(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(nCurRow, "itemStatus") == "E"){
						eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nCurRow, sColumn, objOldValue); // 값 원복
						validMsgArr.push("[" + sWinItemCd + "] 오류로 발주 정보를 등록 할 수 없습니다.");
						continue;
					}
					
					
					// 유효성 검사 시작
					var validMsg = fn_checkTempData(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)), nCurRow, sColumn);
					var bSum     = false; //합계, 계산 등 처리 여부
					if(!gfn_isNull(validMsg)){
						validMsgArr.push(validMsg);
						
						if(validMsg.indexOf("해당 상품은 최대발주량이") > -1){
							
							// 고객인 경우만 제한
							if( g_EmpNo.substr(0,2) == "CS" ) {
								eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nCurRow, sColumn, objOldValue);
							} else {
								bSum = true; //본사 합계처리함.
							}
						} else {
							eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nCurRow, sColumn, objOldValue);
						}

					} else {
						bSum = true; //정상 합계처리함.
					}
					
					//임시데이터 합계처리
					if(bSum == true && bNum == true){
						fn_sumTempData(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)), nCurRow, sColumn);
					}
					
				} // end for
				eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).enableevent = true;
				
				// 입수량0의 경우 경고창
				if(boxQtyZeroMsg != "") {
					if(boxQtyZeroIndex == 1) { 
						g_Message("EE",boxQtyZeroMsg + " 자재의 입수량이 0입니다.");
					} else {
						g_Message("EE",boxQtyZeroMsg + " 자재 외 " + (boxQtyZeroIndex-1) + " 개의 입수량이 0입니다.");
					}
					
				}
				
				if(validMsgArr.length > 0){
					g_Message("EE",validMsgArr.join("\n"));
				}

				fv_isCopyPaste = false;
				return true; //종료
				
			} // end else
			fv_isCopyPaste = false;
		
	} // end if e.keycode

}



function gd_list_OnCellPosChanged(obj:Grid, e:GridSelectEventInfo)
{
	//2010/03/22 수량 입력 클릭 시 공백 처리 == by Noh Kyu Wan ==
	if (e.cell == 8)
	{
	    if (eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(e.row,"prQty") <> 0)
	    {}
	    else	    
		eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(e.row,"prQty","");		
     }	
}

function div_Error_btn_Hidden_OnClick(obj:Button, e:ClickEventInfo)
{
	div_Error.visible = false;
}
//*************************************************************
// 2010-08-05  보조금 관련 추가 ( 사업장 보조금 관리 유무조회)
//*************************************************************
function fn_Green_Upjang()
{
// 	/*-------------*/
// 	http.Sync = true;
// 	/*-------------*/
// 	// 조회
// 	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
// 	// 파라미터셋팅
//     outData		= "ds_Green=ds_Green";
//     otherArg	= "UPJANG=" + wrapQuote(comp_upjang.getUpjangCode());	
// 	//action 정보 초기화 
// 	fsp_clear(this); 
//     // 서버에서 조회할 정보 추가 
// 	fsp_addSearch(this, "sc/scc:SCC_GREEN_USER");
// 	// 서버 호출 
//     fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
// 	/*-------------*/
// 	http.Sync = false;
// 	/*-------------*/	
// 	
// 	//*********************************************************************
// 	//	me_Pdate   Width : 160  --> 80
// 	//	Static28  : Width : 95  , Left : 268     --> Left : 190
// 	//	ed_Pcnt : Width 110 , Left : 365  -->   Width 90  , Left :  287
// 	//	ed_Pamt : Width : 224 , Left : 477   -> Width : 130 , Left : 378	
// 	//*********************************************************************
// 	if (ds_Green.getColumn(0,"USE_YN") == 'Y')
// 	{
// 		me_Pdate.position.width = 80;                      //최종발주일자 edit 사이즈 변경
// 		Static28.position.left = 190;                       //최종발주정보 Static 위치 변경
// 		ed_Pcnt.position.width = 90;  ed_Pcnt.position.left = 287;   //최종발주 카운터 사이즈 및 위치 변경
// 		ed_Pamt.position.width = 130; ed_Pamt.position.left = 378;   //최종발주 금액 사이즈 및 위치 변경
// 		Sta_Green.visible = true;                  //보조금 잔액 Static 화면 보이기
// 		ed_Green.visible = true;				   //보조금 잔액 금액 표시 화면 보이기.
// 	}
}
//*************************************************************
// 2010-08-05  보조금 관련 추가 ( 사업장 보조금 잔액 조회)
//*************************************************************
function fn_Green_Amt()
{
// 	/*-------------*/
// 	http.Sync = true;
// 	/*-------------*/
// 	// 조회
// 	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
// 	// 파라미터셋팅
//     outData		= "ds_Green=ds_Green";
//     otherArg	= "UPJANG=" + wrapQuote(comp_upjang.getUpjangCode());
// 	otherArg	+=" NEED_DATE="+ wrapQuote(gfn_trim(me_NeedDate.value));        	
// 	//action 정보 초기화 
// 	fsp_clear(this); 
//     // 서버에서 조회할 정보 추가 
// 	fsp_addSearch(this, "sc/scc:SCC_GREEN_AMT");
// 	// 서버 호출 
//     fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
// 	/*-------------*/
// 	http.Sync = false;
// 	/*-------------*/	
// 	ed_Green.value = numFormat(ds_Green.getColumn(0,"BALANCE_AMT"))+ " 원";	
}
//*****************************************************************************
// 2010-08-05  보조금 관련 추가 (로그인 사업장 보조금 재 생성 프로시져 호출)
//*****************************************************************************
function  fn_Create_Green_Amt()
{
// 	var t_timeout;
// 	// action 정보 초기화
// 	fsp_clear(this);	
// 
// 	// 데이타체크
// 	ds_Green_Proc.clearData();	
// 	ds_Green_Proc.addRow();				
// 
// 	ds_Green_Proc.setColumn(0,"UPJANG",comp_upjang.getUpjangCode());				
// 	ds_Green_Proc.setColumn(0,"NEED_DATE",me_NeedDate.value);
// 	ds_Green_Proc.setColumn(0,"CUSER", g_EmpNo);		
// 	http.Sync = true;			
// 
// 	t_timeout = application.httptimeout;
// 	application.httptimeout=2000; //1800초 
// 
// 	//setCapture();
// 
// 	fsp_addSingle(this, "sc/scc:SCC_GREEN_PROC");
// 	fsp_callService(this, "", "", "ds_Green_Proc=ds_Green_Proc:A", "",  "", "");
// 
// 	application.httptimeout=t_timeout; //60초
// 
// 	http.Sync = false;
}

function btn_RcpConf_OnClick(obj:Button, e:ClickEventInfo)
{
//	dv_RcpConf.visible = (! dv_RcpConf.visible);
}

function dv_RcpConf_me_RcpDateT_onkillfocus(obj:MaskEdit, e:KillFocusEventInfo)
{
//	dv_RcpConf.me_RcpDateF.value = gfn_addDate(obj.value,-1);
}

function dv_MultiUpj_btn_Hidden_OnClick(obj:Button, e:ClickEventInfo)
{
// 	if (ffn_ChkNull(comp_upjang.getUpjangCode()))
// 	{
// 		g_Message("EE", "사업장을 선택하세요!");
// 		return;
// 	}
// 	if (ffn_ChkNull(dv_RcpConf.me_RcpDateF.value))
// 	{
// 		g_Message("EE", "입금확인일자를 지정하세요!");
// 		return;
// 	}
// 	if (ffn_ChkNull(dv_RcpConf.me_RcpDateT.value))
// 	{
// 		g_Message("EE", "입금확인일자를 지정하세요!");
// 		return;
// 	}
	/*
	//ds임시생성
	var dsObjin;
	create("Dataset", "ds_Dummyin");
	dsObjin = eval("ds_Dummyin");
	dsObjin.addColumn("RCP_DATEF", "STRING", 8);
	dsObjin.addColumn("RCP_DATET", "STRING", 8);
	dsObjin.addColumn("UPJANG", "STRING", 6);
	// 초기화
	ds_Dummyin.clearData();
	ds_Dummyin.addRow();
	ds_Dummyin.setColumn(0, "RCP_DATEF",  dv_RcpConf.me_RcpDateF.value);
	ds_Dummyin.setColumn(0, "RCP_DATET",  dv_RcpConf.me_RcpDateT.value);
	ds_Dummyin.setColumn(0, "UPJANG",    comp_upjang.getUpjangCode());
	// 트랜잭션 호출
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMZ_CREDIT_INFO_T002";
	strURL   = "U_svc::" + "fm/fmz/FMZ_CREDIT_INFO_T002.jsp";
	// 데이터셋 설정
	strInDatasets  = "ds_Cond=ds_Dummyin";
	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
	//ds임시생성 해제
	Destroy("ds_Dummyin");
	*/
	//과거에는 아이리스 인터페이스 프로시져를 통해 입금 여부를 실시간으로 가져왔으나
	//지금은 SAP와 연동되어서 바로 받아오기 때문에 그냥 여신을 다시 한번 재조회 하면 됨.
	
// [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
//	if ( !fn_GetCredit() ) return; // 여신정보 조회
// [속도개선 Project   끝] 2017. 8. 21. 최범주
//	dv_RcpConf.visible = false;
//	g_Message("01","실시간 입금확인이 완료되었습니다.");
}

// [PJT]주문채널통합
// 미사용으로 주석처리함
// function fn_searchItemUpMemory() {
// 	
// 	ds_Cond.clearData();
// 	ds_Cond.addRow();
// 	ds_Cond.setColumn(0, "UPJANG",        comp_upjang.getUpjangCode());
// 	ds_Cond.setColumn(0, "SUBINV_CODE",   cbo_Subinv.value);
// 	ds_Cond.setColumn(0, "NEED_DATE",     me_NeedDate.value);
// 	ds_Cond.setColumn(0, "CONSUM_YN",     ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN"));
// 	ds_Cond.setColumn(0, "QTY_CONTROL_YN",ds_Days.getColumn(0,"QTY_CONTROL_YN"));
// 	ds_Cond.setColumn(0, "CENTER_CODE",   			ds_CtUpj.getColumn(0,"CENTER_CODE"));
// 	ds_Cond.setColumn(0, "AP_UNITPRICE_UPJANG",     ds_CtUpj.getColumn(0,"AP_UNITPRICE_UPJANG"));
// 	ds_Cond.setColumn(0, "OTCUST_PRICE_UPJANG",     ds_CtUpj.getColumn(0,"OTCUST_PRICE_UPJANG"));
// 	//ds_Cond.setColumn(0, "ITEM_NAME",     eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.text);
// 	ds_Cond.setColumn(0, "ITEM_NAME",     "계란");
// 	if (tab_list.tabindex == 1)
// 		ds_Cond.setColumn(0, "FAVOR_GROUP",   tab_list.tab2.cbo_Fav.value);
// 		
// 	else if (tab_list.tabindex == 0) // 2008.12.11 추가(분류별 상품 조회 기능)
// 	{
// 		ds_Cond.setColumn(0, "ITEM_CLASS2", tab_list.tab1.cbo_Class2.value);    //중분류
// 		ds_Cond.setColumn(0, "ITEM_CLASS3", tab_list.tab1.cbo_Class3.value);	//소분류
// 		ds_Cond.setColumn(0, "ITEM_CLASS4", tab_list.tab1.cbo_Class4.value);	//세분류
// 	}
// 	else if (tab_list.tabindex == 3)
// 	{
// 		/**
// 		if (ffn_ChkNull(tab_list.tab4.me_NeedDateP.value))
// 		{
// 			g_Message("EE", "복사대상 일자를 선택하세요."); tab_list.tab4.me_NeedDateP.setFocus(); return;
// 		}
// 		if (ffn_ChkNull(tab_list.tab4.ed_UpjangP.userdata))
// 		{
// 			g_Message("EE", "복사대상 업장을 선택하세요."); tab_list.tab4.ed_UpjangP.setFocus(); return;
// 		}
// 		if (ffn_ChkNull(tab_list.tab4.cbo_SubinvP.value))
// 		{
// 			g_Message("EE", "복사대상 식당을 선택하세요."); tab_list.tab4.cbo_SubinvP.setFocus(); return;
// 		}
// 		**/
// 		ds_Cond.setColumn(0, "NEED_DATEP",    tab_list.tab4.me_NeedDateP.value);
// 		ds_Cond.setColumn(0, "UPJANGP",       tab_list.tab4.ed_UpjangP.userdata);
// 		ds_Cond.setColumn(0, "SUBINV_CODEP",  tab_list.tab4.cbo_SubinvP.value);
// 	}
// 	
// 	// 조회
// 	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
// 	// 경로 설정
// 	strSvcID = "FMP00082E_T001"; //[PJT]주문채널통합
// 	strURL   = "U_svc::" + "fm/fmp/FMP00082E_T001.jsp";	// FMP00082E_T001.jsp 동일 //[PJT]주문채널통합
// 	
// 	// 데이터셋 설정
// 	strInDatasets  = "ds_Cond=ds_Cond";
// 	strOutDatasets = "ds_temp=ds_List";
// 	strOutDatasets = "";
// 	// 파라메터 설정
// 	strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
// 	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
// 	strArgument += " Holiday_YN=" + wrapQuote(application.g_HOLIDAY_CHK_YN);	
// 	strArgument += " strIndex=" + wrapQuote(gfn_toString(tab_list.tabindex+1));
// 	strArgument += " strWeekendTimeCheck=" + wrapQuote(fa_weekendTimeCheck);
// 	
//     if (eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).chk_Only.value == "1") {
// 		strArgument += " strOnly='TRUE'";
//     } else {
// 		strArgument += " strOnly='FALSE'";
//     }
// 	
// 	// 최근 n개월
// 	strArgument += " nMonth="+wrapQuote(tab_list.tab1.cbo_month.value);
// 	strArgument += " sType=" + wrapQuote(cbo_Type.value);
// 	
// 	// 콜백함수 지정
// 	strCallbackFunc = "";
// 	// 서버 호출 
// 	jsp_transaction_async(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, false);
// }


function tab_list_tab1_gd_list_OnKeyDown(obj:Grid, e:KeyEventInfo)
{
	var nRow = ds_List1.rowposition;
	var nCell = '0';
	var nPivotIndex = '-1';
	
	//엔터키일때 입력
	if(e.keycode == '13')
	{
		var e = new EventInfo();
		e.row = this[obj.binddataset].rowposition;	
		gd_list_OnCellDblClick(obj,e);		
		return true; //Form의 onkeydown 이벤트를 발생시키지 않는다
	}
	
}

function tab_list_tab2_gd_list_OnKeyDown(obj:Grid, e:KeyEventInfo)
{
	var nRow = ds_List2.rowposition;
	var nCell = '0';
	var nPivotIndex = '-1';
	
	//엔터키일때 입력
	if(e.keycode == '13')
	{
		var e = new EventInfo();
		e.row = this[obj.binddataset].rowposition;
		gd_list_OnCellDblClick(obj,e);
		return true; //Form의 onkeydown 이벤트를 발생시키지 않는다
	}
	
}

function tab_list_tab3_gd_list_OnKeyDown(obj:Grid, e:KeyEventInfo)
{
	var nRow = ds_List3.rowposition;
	var nCell = '0';
	var nPivotIndex = '-1';
	
	//엔터키일때 입력
	if(e.keycode == '13')
	{
		var e = new EventInfo();
		e.row = this[obj.binddataset].rowposition;	
		gd_list_OnCellDblClick(obj,e);
		return true; //Form의 onkeydown 이벤트를 발생시키지 않는다
	}

}

//즐겨찾기 삭제 함수
function fn_deleteFav(nRow)
{
// 	var fa_Upjang		= comp_upjang.getUpjangCode();
// 	var favorGroupCode  = null;
// 	var itemCode		= null;
// 	if ( tab_list.tabindex == 0 ) {
// 		favorGroupCode	= ds_List1.getColumn(nRow,"FAVOR_GROUP_FLAG");
// 		itemCode 		= ds_List1.getColumn(nRow,"ITEM_CODE");
// 		
// 	} else {
// 		favorGroupCode	= ds_Fav.getColumn(ds_Fav.rowposition,"FAVOR_GROUP");
// 		itemCode 		= ds_List2.getColumn(nRow,"ITEM_CODE");
// 		
// 		//trace(upjang +"/"+ group +"/"+ itemCode);
// 		
// 		ds_List2.deleteRow(nRow);
// 	}
// 	ds_Cond.clearData();
// 	ds_Cond.addRow();
// 	ds_Cond.setColumn(0,"UPJANG",fa_Upjang);
// 	ds_Cond.setColumn(0,"FAVOR_GROUP",favorGroupCode);
// 	ds_Cond.setColumn(0,"ITEM_CODE",itemCode);
// 		
// 	//Transaction 설정
// 	var formObj			= this;
// 	var strSvcID		= "FMP00080P_T003";
// 	var strURL			= "U_svc::" + "fm/fmp/FMP00080P_T004.jsp";
// 	var strInDatasets	= "ds_Cond=ds_Cond:A";
// 	var strOutDatasets	= "";
// 	var strArgument = "";	//= "name1=park name2=yongdae";
// 	//var strCallbackFunc	= "fn_Add_callback"; //없는함수임.
// 	var strCallbackFunc	= "";
// 	var isErrorNotCall	= false;
// 	var isNotShow		= false;	//false 메세지 보여줌 --> sync일때 표현 안됨.
// 	var isSync			= true;		//true 다실행하고 실행됨.(async)
// 
// 	//서버호출
// 	jsp_transaction(formObj, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, isErrorNotCall, isNotShow, isSync);
// 	
// 	// 삭재 후 재조회
// 	if ( tab_list.tabindex == 0 ) {
// 		tab_list.tab1.btn_search.click();
// 	}
}



function fn_setInitForm()
{
//	if (tab_list.tabindex == 0){
		//cbo_Type.index = 1;
		
		eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).cbo_Gbn.index = 0;//[PJT]주문채널통합
		eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.value = ""; 
		eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).chk_Only.value = "1";
		//tab_list.tab1.cbo_Class2.index = 0;
		//tab_list.tab1.cbo_Class3.index = 0;
		//tab_list.tab1.cbo_Class4.index = 0;
		eval("ds_List" + gfn_toString(tab_list.tabindex+1)).clearData();
		eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.setFocus();
// 	}else if (tab_list.tabindex == 1){
// 		cbo_Type.index = 1;
// 		tab_list.tab2.cbo_Gbn.index = 0;//[PJT]주문채널통합
// 		tab_list.tab2.ed_Item.value = ""; 
// 		tab_list.tab2.chk_Only.value = "1";
// 		tab_list.tab2.cbo_Fav.index = 0;
// 		ds_List2.clearData();
// 		tab_list.tab2.ed_Item.setFocus();
// 	}else if (tab_list.tabindex == 2){
// 		cbo_Type.index = 1;
// 		tab_list.tab3.cbo_Gbn.index = 0;//[PJT]주문채널통합
// 		tab_list.tab3.ed_Item.value = ""; 
// 		tab_list.tab3.chk_Only.value = "1";
// 		ds_List3.clearData();
// 		tab_list.tab3.ed_Item.setFocus();
// 	}else if (tab_list.tabindex == 3){
// 		cbo_Type.index = 1;
// 		tab_list.tab4.cbo_Gbn.index = 0;//[PJT]주문채널통합
// 		tab_list.tab4.ed_Item.value = ""; 
// 		ds_List4.clearData();
// 		tab_list.tab4.ed_Item.setFocus();
// 	}
}

// FICS 발주제한요일, 시간 설정 조회
function fn_getWeekendTime()
{
	fn_CurrDateWeek();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_WeekendTime=ds_List";
    callBackFnc = "callBackWeekendTime"
    //action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	//fsp_addSearch(this, "fm/fmz:FMZ_GET_WEEKENDTIME_S001");
	fsp_addSearch(this, "fm/fmz:FMZ_GET_WEEKENDTIME_S001");
	
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
}

function callBackWeekendTime(errCode, errMsg)
{
	if (errCode == 0)
	{
	    fn_setWeekendTime();
	} else {
		g_Message("EE",fn_AlertMsg("002"));
	}
}

// FICS 발주제한요일, 시간 설정에 따른 화면 제어 	
function fn_setWeekendTime()
{
	var sCurWeekCd = gds_currdate.getColumn(0, "WEEK_CD");
	var sCurTm = gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4);
	var nRow = ds_WeekendTime.findRow("CODE", sCurWeekCd);
	
	if ( nRow > -1 ) {
		
		fa_startTime = ds_WeekendTime.getColumn(nRow, "SET2");
		fa_endTime = ds_WeekendTime.getColumn(nRow, "SET3");
		
		if ( sCurTm >= fa_startTime && sCurTm <= fa_endTime ) {
			
			// 발주 통제 함
			fa_weekendTimeCheck = "Y"; 
			
			//tab_list.tab2.enable = false;
			//tab_list.tab3.enable = false;
			//tab_list.tab4.enable = false;
			
		} else {
		    // 발주 통제 안함
			fa_weekendTimeCheck = "N"; 
			
			//tab_list.tab2.enable = true;
			//tab_list.tab3.enable = true;
			//tab_list.tab4.enable = true;
		}
		
		//trace("fn_setWeekendTime 상품발주: "+fa_weekendTimeCheck);
	}
}



function gd_list_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	//발주상태
	//if ( e.cell == 1 ) {
	if ( e.cell == 1 ) { //[PJT]주문채널통합 - 자재정보 팝업
		var arrParam = new Array();
		arrParam[0] = eval(obj.binddataset).getColumn(e.row, "itemCode");
		
		//바코드 조회로 상품코드가 없는 경우 팝업 처리 안함.
		if(!gfn_isNull(arrParam[0])){
			var rtnVal = gfn_dialog("FMP00010P"			// dialogId
						   , "U_FMP::FMP00010P.xfdl"		// Url
						   , {fv_Contents:arrParam}					// 배열
						   , null, null, null, null, null, false, true, -1);
		}//바코드 조회로 상품코드가 없는 경우 팝업 처리 안함.
	}
	
}




//요일별 창고별 발주 통제 관리 - 개발중
function fn_OrdWeek()
{
// 	ds_Cond.clearData();
// 	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).clearData();
// 	ds_Cond.addRow();
//     ds_Cond.setColumn(0, "SUBINV_CODE", cbo_Subinv.value);
// 	ds_Cond.setColumn(0, "UPJANG",      comp_upjang.getUpjangCode());
// 	
// 	// 조회	
// 	
// 	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
// 	// 경로 설정
// 	strSvcID = "FMP00031E_T001";
// 	strURL   = "U_svc::" + "fm/fmp/FMP00080E_T005.jsp";
// 	// 데이터셋 설정
// 	strInDatasets  = "ds_Cond=ds_Cond";
// 	strOutDatasets = "ds_List"+ gfn_toString(tab_list.tabindex+1) +"=ds_List";
// 	// 파라메터 설정
// 	strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
// 	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
// 	// 콜백함수 지정
// 	strCallbackFunc = "fn_CallBack_Search";
// 	// 서버 호출 
// 	//Transaction(strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc);
}

function Button00_onclick(obj:Button,  e:ClickEventInfo)
{
//	fn_OrdWeek();
}

function me_NeedDate_ontextchanged(obj:MaskEdit,  e:TextChangedEventInfo)
{
	
}



function fn_isHoliday(sDate)
{
	var i;
	var aHolidays;
	
	aHolidays = gfn_getHolidays(parseInt(gfn_today().substr(0,4), 10));

	for( i = 0 ; i < aHolidays.length ; i++ )
	{
		if( aHolidays[i].substr(0,8) == sDate )
			return aHolidays[i].substr(8);
	}

	return "";	
}

/*
       <달력 포커스 및 조회 총정리>     2015.12.19 박용대

1. 숫자 입력 후 탭이동 : me_NeedDate_canchange -> me_NeedDate_onkillfocus
                           (fn_search())            (fn_search()) 
                           (색적용)

2. 숫자 입력 후 엔터   : me_NeedDate_onkeydown -> me_NeedDate_onkillfocus
						   (색적용)      			(fn_search()) 

3. 달력컴포넌트를 사용 : me_NeedDate_canchange
						   (fn_search())
						   (색적용)
						   
※ 구조상 탭이동은 조회가 두번 겹칠수 밖에 없음. 2,3번의 케이스가 훨신 많기 때문에 1번은 무시함
※ mi->xplatform으로 바뀌면서 onchanged 이벤트가 canchange 이벤트로 바뀌면서 obj를 제대로 못가져옴. 강제셋팅
*/

function me_NeedDate_onkeydown(obj:MaskEdit, e:KeyEventInfo)
{
	if (e.keycode == 13) 
	{
		//trace("me_NeedDate_onkeydown");
		g_Date_OnKillFocus(obj); 
	
		//초기화
		//	me_Pdate.Value = "";
		//	ed_Pcnt.Text = "";
		//	ed_Pamt.Text = "";
		eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).clearData();
		//최종 발주정보
		//fn_GetLastOrd();
		//디데이
		fn_GetDays();
		//날짜변경
		st_Week.text = "(" + ffn_DayToWeek(me_NeedDate.value) + ")";
		
		//날짜색변경
		if (st_Week.text == "(토)")
			st_Week.style.color = "blue";
		else if (st_Week.text == "(일)")
			st_Week.style.color = "red";
		else
			st_Week.style.color = "black";
		//공휴일색변경	
		if(gfn_length(fn_isHoliday(me_NeedDate.value))>0)
		{
			st_Week.style.color = "red";
		}
	}
}


function me_NeedDate_onkillfocus(obj:MaskEdit, e:KillFocusEventInfo)
{
	//trace("me_NeedDate_onkillfocus");
	//변경되면 포커스를 잃고 글로벌 함수 실행(여기서 글자수를 체크하여 제대로 된 데이터 넘김)
	g_Date_OnKillFocus(obj);

	// 시스템 오픈
	if(gfn_nvl(me_NeedDate.value,0)<20220110){
		alert("해당일자 선택불가!!");
		me_NeedDate.value = null;
		return;
	}
	
	//변경된 사항이 있는지 확인
	if(gfn_dsIsUpdated(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)))==true)
	{
		g_Message("EE","변경된 내역이 있습니다. 저장해 주십시요");
		//me_NeedDate.value = pre_need_date;	//변경전의 날짜를 되돌림
		return;
	}else{
		// 상단그리드 초기화
		fn_setInitForm();
		fn_search();
	}
}


function me_NeedDate_canchange(obj:MaskEdit,  e:ChangeEventInfo)
{
	//trace("me_NeedDate_canchange");
	
	// 시스템 오픈
	if(gfn_nvl(me_NeedDate.value,0)<20220110){
		alert("해당일자 선택불가!!");
		me_NeedDate.value = null;
		return;
	}
	
	//날짜변경
	st_Week.text = "(" + ffn_DayToWeek(me_NeedDate.value) + ")";
	//날짜색변경

	if (st_Week.text == "(토)")
		st_Week.style.color = "blue";
	else if (st_Week.text == "(일)")
		st_Week.style.color = "red";
	else
		st_Week.style.color = "black";
	//공휴일색변경	
	if(gfn_length(fn_isHoliday(me_NeedDate.value))>0)
	{
		st_Week.style.color = "red";
	}
	
	//변경되면 포커스를 잃고 글로벌 함수 실행(여기서 글자수를 체크하여 제대로 된 데이터 넘김)
	//g_Date_OnKillFocus(me_NeedDate);
		
	//변경된 사항이 있는지 확인
	if(gfn_dsIsUpdated(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)))==true)
	{
		//g_Message("EE","변경된 내역이 있습니다. 저장해 주십시요");
		var retValue = gfn_confirm("confirm.before.search");	// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
 		if (retValue == true) {		
			fn_setInitForm();
			fn_search();
			
			//반환의 경우
			//if (!fn_NeedDateCheck()){ //입고통제일이 아닐경우만..			
				if(gfn_toString(tab_list.tabindex+1) == 1){		
					if(!ffn_ChkNull(comp_upjang.getUpjangCode())){
						fn_searchRtnOrderYn();
					}
				}
			//}
			
			return true;
 		} else {			
			//2017.10.13 김호석 추가 입고일자 변경 전으로 되돌림
			me_NeedDate.value = pre_need_date_temp;	//변경전의 날짜를 되돌림
			//날짜변경
			st_Week.text = "(" + ffn_DayToWeek(me_NeedDate.value) + ")";
			//날짜색변경

			if (st_Week.text == "(토)")
				st_Week.style.color = "blue";
			else if (st_Week.text == "(일)")
				st_Week.style.color = "red";
			else
				st_Week.style.color = "black";
			//공휴일색변경	
			if(gfn_length(fn_isHoliday(me_NeedDate.value))>0)
			{
				st_Week.style.color = "red";
			}
			return false;
 		}
 		//날짜변경
		st_Week.text = "(" + ffn_DayToWeek(me_NeedDate.value) + ")";
		//날짜색변경

		if (st_Week.text == "(토)")
			st_Week.style.color = "blue";
		else if (st_Week.text == "(일)")
			st_Week.style.color = "red";
		else
			st_Week.style.color = "black";
		//공휴일색변경	
		if(gfn_length(fn_isHoliday(me_NeedDate.value))>0)
		{
			st_Week.style.color = "red";
		}
		me_NeedDate.value = pre_need_date_temp;	//변경전의 날짜를 되돌림
		return false;
	}else{
		// 상단그리드 초기화	
		fn_setInitForm();
		fn_search();

		//반환의 경우
		//if (!fn_NeedDateCheck()){ //입고통제일이 아닐경우만..		
			if(gfn_toString(tab_list.tabindex+1) == 1){		
				if(!ffn_ChkNull(comp_upjang.getUpjangCode())){
					fn_searchRtnOrderYn();
				}
			}
		//}	
		return true;
	}

}

//반환 주문유형의 주문일자 선택시 정상주문 유형여부 확인
function fn_searchRtnOrderYn()
{
	// 초기화
	ds_Cond.clearData();

	ds_Cond.addRow();	
	ds_Cond.setColumn(0, "UPJANG",    comp_upjang.getUpjangCode());
	ds_Cond.setColumn(0, "NEED_DATE", me_NeedDate.value);
		
    var strSvcID    = "search";
    var strURL      = "fm/fms/returnOrderBySales/selectRtnOrderYn.xdo";
    var strInDs     = "ds_Cond=ds_Cond:A";
    var strOutDs    = "ds_rtnOrderYn=ds_List";
    var strArg      = "";
    var strCallback = "fn_CallBack_searchRtnOrderYn";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);

}

function fn_CallBack_searchRtnOrderYn(SvcID, errCode, errMsg)
{
	if (errCode == 0)
	{
		if(ds_rtnOrderYn.getColumn(0, "rtnOrderYn") == "N"){
			g_Message("EE", me_NeedDate.text +" 일자에는 정상발주 내역이 존재하지 않습니다.");	
		}
	}
	else
	{
		g_Message("EE",fn_AlertMsg("002"));
	}
}


function fn_isOverQty(obj:Dataset, e:DSColChangeEventInfo, nPrQty) {
	var maxQty = toNumber(obj.getColumn(e.row, "maxOrdQty"));
	if ( maxQty == 0 ) {	// MAX_ORD_QTY == 0 이면 발주수량제한 없음
		return false;
	}
	var itemCd = obj.getColumn(e.row, "itemCode");
	var nSum = toNumber(obj.getCaseSum("itemCode == '" + itemCd + "' && rowidx != " + e.row , "prQty"));//현재 행을 제외한 합계
	var nReal = nSum+toNumber(nPrQty);
	//trace("fn_isOverQty.nReal : " + nReal);
	return (maxQty < nReal);
}


// fn_checkExceptCredit = true [ 예외(ex.예림푸드) ]
function fn_checkExceptCredit() {
// 
// 	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
// 	
// 	if ( gfn_isNull(comp_upjang.getUpjangCode()) ) {
// 		g_Message("EE","업장정보가 없습니다.");
// 		return;
// 	}
// 	
// 	strSvcID = "FMP00080E_T003_2";
// 	strURL   = "hwfs_svc/fm/fmp/FMP00080E_T003_2.jsp";
// 	strOutDatasets = "ds_checkExceptCredit=ds_checkExceptCredit"
// 	strArgument  = "upjang=" + wrapQuote(comp_upjang.getUpjangCode());
// 	
// 	//jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
// 	gfn_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
// 	
// 	if ( ds_checkExceptCredit.rowcount == 0 ) {
// 		return false;
// 	} else {
// 		return (ds_checkExceptCredit.getColumn(0, "EXCEPT_YN") == "Y");
// 	}
}

function fn_checkResource(sResource) {
	/*
	var rtn = application.afrm_Bottom.form.fn_isSameResource(sResource, true);
	for ( var p in rtn ) {
		trace(p+"="+rtn[p]);
	}
	*/
	return (application.afrm_Bottom.form.fn_isSameResource(sResource, true).result);
}

function fn_checkLineStatus(flag, checkDs) {

	fv_chkMsg = "";
	ds_msg.clearData();
	//var checkDs = fn_search(true);
	for ( var k=0; k<eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).rowcount; k++ ) {
		var nRowType = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getRowType(k);
		var strExpr = "prId == '" + eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(k, "prId")+ "'";
			strExpr += " && prNum == '" + eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(k, "prNum") + "'";
			strExpr += " && itemCode == '" + eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(k, "itemCode") + "'";
		var nRow1 = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).findRowExpr(strExpr);
		var nRow2 = checkDs.findRowExpr(strExpr);
		
		var sLine1 = eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(nRow1, "poLineStatus");
		var sLine2 = checkDs.getColumn(nRow2, "poLineStatus");

//alert(strExpr+" sLine1 : "+nRow1+" "+sLine1+ ", sLine2 : "+nRow2+" "+sLine2);
//trace(checkDs.saveXML());
		//trace(strExpr);
		//trace(nRow1+"||"+nRow2+"||"+sLine1+"||"+sLine2);
		//if ( nRowType == Dataset.ROWTYPE_UPDATE ) {
			if ( nRow1 != -1 && nRow2 != -1 ) {
				if ( sLine1 != sLine2 ) {
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).updatecontrol = false;
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nRow1, "prQty", eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getOrgColumn(nRow1, "prQty"));
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nRow1, "prRemark", eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getOrgColumn(nRow1, "prRemark"));
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nRow1, "poLineStatus", checkDs.getColumn(nRow2, "poLineStatus"));
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(nRow1, "clsStatus", "마감");
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setRowType(nRow1, Dataset.ROWTYPE_NORMAL);	// for skip save
					//return ("["+ds_List.getColumn(nRow1, "ITEM_NAME")+"] 상품의 발주상태가 " + checkDs.getColumn(nRow2, "PO_LINE_STATUS") +"로 변경되어 해당 내용을 수정할 수 없습니다.");
					fv_chkMsg = "["+eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(nRow1, "itemCode")+":"+eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(nRow1, "itemName")+"] 상품의 발주상태가 [" + checkDs.getColumn(nRow2, "poLineStatus") +"]로 변경되어 해당 내용을 수정할 수 없습니다.";
					var nRow = ds_msg.addRow();
					ds_msg.setColumn(nRow, "NO", nRow);
					ds_msg.setColumn(nRow, "TYPE", "I");
					ds_msg.setColumn(nRow, "MSG", fv_chkMsg);
					eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).updatecontrol = true;
				}
			}
		//}
	}

	// cache check
	/******
	if ( fn_checkResource("xui/mform/fm/fmp/FMP00080E.xfdl") == false ) {
		var nRow2 = ds_msg.addRow();
		ds_msg.setColumn(nRow2, "NO", nRow2);
		ds_msg.setColumn(nRow2, "TYPE", "N");
		ds_msg.setColumn(nRow2, "MSG", "상품발주 프로그램이 업데이트되었습니다. \r\n업데이트 내용을 적용하기 위해 해당 화면을 자동으로 재시작합니다.");
	}
	*****/
	
	if ( !gfn_dsIsUpdated(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1))) ) {
		if ( !gfn_isNull(flag) ) {
			if ( flag == "delete" ) {
				return fv_chkMsg;
			} else {
				return "주문한 자재의 발주상태가 변경되어 수정할 수 없습니다.\r\n발주내역을 다시 조회하여 상태를 확인하시기바랍니다.";
			}
		} else {
			return "주문한 자재의 발주상태가 변경되어 수정할 수 없습니다.\r\n발주내역을 다시 조회하여 상태를 확인하시기바랍니다.";
		}
	}
}

function fn_getBudgetInfo() {
	/*
	ds_search.setColumn(0, "schMainUpjang", "");
	ds_search.setColumn(0, "schUpjang", comp_upjang.getUpjangCode());
	ds_search.setColumn(0, "schTotYn", "0");
	ds_search.setColumn(0, "schStdDt", me_NeedDate.value);
	
	var strSvcID    = "searchBudget";
    var strURL      = "hwfs_svc/fm/fmo/FMO00420E_T001.jsp";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_budget=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
    */
    
// 	var strSvcID    = "searchBudget";
// 	var strURL      = "sc/cmn/introFrame/selectBudgetList.xdo";
// 	var strInDs     = "";
// 	var strOutDs    = "ds_budget=ds_budgetList";
// 	var strArg      = "upjang=" + g_Upjang;
// 		strArg		+= " mainUpjang=" + g_Main_Upjang;
// 		strArg		+= " uKey=" + gfn_encProc(g_Upjang+gfn_today());
// 	var strCallback = "fn_callBack";
// 	var bAsync      = true;
// 	
// 	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

function fn_callBack(strSvcID, nErrorCode, strErrorMsg) {
	if ( nErrorCode < 0 ) {
		return;
	}
	
//     switch ( strSvcID ) {
// 		case "searchBudget" :
// 			if ( ds_budget.rowcount > 0 ) {
// 				if ( st_Bond.visible && !st_Credit.visible) {
// 					st_budget.position.x = st_Credit.position.x;
// 					ed_budget.position.x = ed_Credit.position.x;
// 				} else if ( !st_Bond.visible && st_Credit.visible ) {
// 					st_budget.position.x = st_Bond.position.x;
// 					ed_budget.position.x = ed_Bond.position.x;
// 				} else if ( !st_Bond.visible && !st_Credit.visible ) {
// 					st_budget.position.x = st_Credit.position.x;
// 					ed_budget.position.x = ed_Credit.position.x;
// 				} else {
// 					
// 				}
// 				
// 				st_budget.visible = true;
// 				ed_budget.visible = true;
// 			} else {
// 				st_budget.visible = false;
// 				ed_budget.visible = false;
// 			}
// 			
// 			var budget = ds_budget.lookup("subinvCode", cbo_Subinv.value ,"amt");
// 				budget = gfn_isNull(budget) ? '' :  gfn_numFormat(budget) + " 원";
// 			ed_budget.value = budget;	
// 			break;
// 			
// 		case "searchCtrlList" :
			//trace(ds_ctrlList.saveXML());
			
			/*
			if ( ds_ctrlList.lookup("subinvCode", cbo_Subinv.value, "controlYn") == "Y" ) {
				if ( ds_ctrlList.rowcount != 0 ) {
					stc_ctrlAmt.text = "( 전체창고 발주금액 : " + gfn_numFormat(ds_ctrlList.getSum("poAmt")) + "원 )";
				}
				switch ( ds_ctrlList.lookup("subinvCode", cbo_Subinv.value, "chkSave") ) {
					case "Y" :
						stc_ctrlAmt.style.color = "#444444ff";
						stc_ctrlAmt.visible = true;
						break;
						
					case "N" :
						stc_ctrlAmt.style.color = "red";
						stc_ctrlAmt.visible = true;
						break;
						
					default : 
						stc_ctrlAmt.visible = false;
						break;
					
				}
				break;
			}
			*/
// 			stc_ctrlAmt.visible = false;
// 			if ( ds_ctrlList.rowcount != 0 && ds_ctrlList.getCaseCount("controlYn == 'Y'") > 0 ) {
// 				stc_ctrlAmt.text = "( 전체창고 발주금액 : " + gfn_numFormat(ds_ctrlList.getSum("subinvAmt")) + "원 )";
// 				 
// 				switch ( ds_ctrlList.lookup("subinvCode", cbo_Subinv.value, "chkSave") ) {
// 					case "Y" :
// 						stc_ctrlAmt.style.color = "#444444ff";
// 						stc_ctrlAmt.visible = true;
// 						break;
// 						
// 					case "N" :
// 						stc_ctrlAmt.style.color = "red";
// 						stc_ctrlAmt.visible = true;
// 						break;
// 						
// 					default : 
// 						stc_ctrlAmt.visible = false;
// 						break;
// 					
// 				}
				
// 				var rtnAmt = fn_getOrderStatus();	
// 				if ( rtnAmt.ctrlAmt > rtnAmt.poAmt ) {
// 					st_ctrlAmt.text = " 발주가능금액 " + gfn_numFormat(rtnAmt.ctrlAmt - rtnAmt.poAmt) + "원 부족";
// 					st_ctrlAmt.visible = true;
// 				}
// 			}
// 				
// 		default :
// 			break;
//     }
}
// 
// function st_budget_onclick(obj:Static,  e:ClickEventInfo) {
// 	fn_getBudgetInfo();
// 	var menuId = "";
// 	switch ( gv_runMode ) {
// 		case "L" :
// 		case "D" :
// 			menuId = "3249";
// 			break;
// 		case "S" :
// 			menuId = "3252";
// 			break;
// 		default :
// 			menuId = "3252";
// 			break;
// 	}
// 	gfn_openMenu(menuId, "");
// }


function fn_getOrderCtrlList() {
	
// 	var strSvcID    = "searchCtrlList";
// 	var strURL      = "fm/fms/smallOrderCtrlMgnt/selectCtrlList.xdo";
// 	var strInDs     = "";
// 	var strOutDs    = "ds_ctrlList=ds_ctrlList";
// 	var strArg      = "upjang=" + comp_upjang.getUpjangCode();
// 		strArg		+= " needDate=" + me_NeedDate.value;
// 		strArg		+= " uKey=" + gfn_encProc(g_Upjang+gfn_today());
// 	var strCallback = "fn_callBack";
// 	var bAsync      = true;
// 	
// 	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

function fn_getOrderStatus(pSource) {
	
// 	switch ( ds_ctrlList.lookup("subinvCode", cbo_Subinv.value, "chkSave") ) {
// 		case "Y" :
// 			if ( pSource != "recheck" ) {
// 				return {'poAmt': 0, 'ctrlAmt' : -1};
// 			}
// 			break;
// 			
// 		case "N" :
// 				//return {'poAmt': 0, 'ctrlAmt' : -1};
// 			break;
// 			
// 		default : 
// 			break;
// 			
// 	}
// 	
// 	var poAmt = toNumber(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getCaseSum("PR_QTY > 0 && TAX_CODE == '100'", "OP_AMOUNT")) * 1.1
// 				+ toNumber(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getCaseSum("PR_QTY > 0 && TAX_CODE != '100'", "OP_AMOUNT")) * 1
// 				//+ toNumber(ds_ctrlList.getSum("subinvAmt"))
// 				+ toNumber(ds_ctrlList.getCaseSum("subinvCode != '" + cbo_Subinv.value + "'", "subinvAmt" ))
// 				//+ toNumber(ds_ctrlList.lookup("subinvCode", cbo_Subinv.value, "nonCtrlAmt"));
// 	var ctrlAmt = toNumber(ds_ctrlList.lookup("subinvCode", cbo_Subinv.value, "controlAmt"));
// 	
// 	return {'poAmt': Math.round(poAmt), 'ctrlAmt' : ctrlAmt};
}

function fn_Excel_Import(obj:Button,  e:ClickEventInfo) {

// 	//필수항목 
// 	if (fn_ChkManNull()) return;
// 	
// 	//발주가능 체크
// 	if (! fn_OrdChk())
// 	{
// 		btn_NeedDate.setFocus();
// 		return;
// 	}
// 	
// 	//변경된 사항이 있는지 확인
// 	if(gfn_dsIsUpdated(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)))==true)
// 	{
// 		g_Message("EE","변경된 내역이 있습니다. 저장해 주십시요");
// 		return;
// 	}
// 	
// 	ds_ExcelParam.clearData();
// 	ds_ExcelParam.addRow();
// 	ds_ExcelParam.setColumn(0, "schType",         "07");
// 	ds_ExcelParam.setColumn(0, "schSabun",        g_EmpNo);
// 	ds_ExcelParam.setColumn(0, "schSubinvCode",   cbo_Subinv.value);
// 	ds_ExcelParam.setColumn(0, "schPrDate",       gfn_today());
// 	ds_ExcelParam.setColumn(0, "schNeedDate",     me_NeedDate.value);
// 	ds_ExcelParam.setColumn(0, "schQtyControlYn", ds_Days.getColumn(0,"QTY_CONTROL_YN"));
// 
// 	//trace(ds_ExcelParam.saveXML());
// 	
// 	
// 	var strId       = "OrderRequestUpload2_brand";
// 	var strURL      = "X_FMO::OrderRequestUpload2_brand.xfdl";
// 	var objArgument = {
// 		P_DATASET : ds_ExcelParam
// 	};
// 	var nWidth      = 1155;
// 	var nHeight     = 735;
// 	var strStyle    = "";
// 	var nLeft       = -1;
// 	var nTop        = -1;
// 	var isModeless  = false;
// 	var bShowTitle  = true;
// 	var strAlign    = "-1";
// 	
// 	// 리턴값을 배열로 받을 경우	
//  	var rtnVal = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
//  	
// 	if (typeof rtnVal != "undefined" && rtnVal != null) 
// 	{
// 		if (rtnVal[0] == "OK")
// 		{
// 			fn_search();
// 		} 
// 	}
}




// 상품에 대한 오류 check
// 바코드로 발주 상품 조회 완료 후 check
function fn_checkTempItem(objDs:Dataset){
	
	var nRow = objDs.findRowExpr("inputType == 'P' && itemStatus == 'N'"); //붙여넣기한 정상건만 check
	if(nRow < 0) return;
	
	var validMsgArr = new Array(); //validation
	objDs.enableevent = false;
	for(var i = nRow; i < objDs.rowcount; i++){
		
		if(objDs.getColumn(i, "inputType") != "P" || objDs.getColumn(i, "itemStatus") != "N"){
			continue;
		}

		// 유효성 검사 시작
		var validMsg = fn_checkTempItemRow(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)), i);
		
		if(!gfn_isNull(validMsg)){
			validMsgArr.push(validMsg);
			objDs.setColumn(i, "itemStatus", "E");	//발주 못하도록 에러로 처리함.
		}
		
	} // end for
	objDs.enableevent = true;
	
	if(validMsgArr.length > 0){
		g_Message("EE",validMsgArr.join("\n"));
	}
}

function fn_checkTempItemRow(objDs:Dataset, nRow){

	var sWinItemCd = objDs.getColumn(nRow, "winItemCd");

	//반환이 아닌경우만..
	if(gfn_toString(tab_list.tabindex+1) != 1){
		
		if(objDs.getColumn(nRow, "EXCEPTION_ORDER") != "Y") { //발주가능 예외품목 체크
			//리조트 물류스케주울 체크
			if (! ffn_ChkNull(objDs.getColumn(nRow,"weekItemCode")))
			{
				return ("[" + sWinItemCd + "] 해당 상품은 요일통제 상품입니다!");
			}
			
			//주문통제체크	
			if (!ffn_ChkNull(objDs.getColumnInfo("limitItem"))) {	
				if (! ffn_ChkNull(objDs.getColumn(nRow,"limitItem")))
				{
					return ("[" + sWinItemCd + "] 해당 상품은 주문통제 상품입니다!" + "-" + "통제내용:" + objDs.getColumn(nRow,"limitReason"));
				}
			}
		}

		//상품조회
		if (objDs.getColumn(nRow,"unuseYn") == "UK" || objDs.getColumn(nRow,"valStpYn") == "TK" ) 
		{	
			return ("[" + sWinItemCd + "] 해당 상품은 주문불가 상품입니다!");
		}	
		
		//단가업장 수발주 요일 제한 상품 체크
		if (objDs.getColumn(nRow,"dangaweekStatus") == "FE")
		{
			return ("[" + sWinItemCd + "] 해당 상품은 단가업장 수발주 요일 제한 상품입니다!");
		}	
	}


	//발주마감체크
	if (fn_GetDayStatus(objDs.getColumn(nRow,"dDays"), objDs.getColumn(nRow,"dTimes")) == "0")
	{
		return ("[" + sWinItemCd + "] 마감시간이 초과되어 주문이 불가합니다.");
	}
	
	//창고가 식재/소모품 통합창고인 경우 주문통제 점검	
	if (ffn_ChkNull(ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN")))
	{
		//주문통제(주문일자)
		var jRow;
		jRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='주문'&&ITEM_TYPE==iif('" + objDs.getColumn(nRow,"consumYn") + "','Y','소모품','식자재')");
		if (jRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(jRow,ToUpper(gds_currdate.getColumn(0, "WEEK_ENG"))) == "Y")
			{
				return ("[" + sWinItemCd + "] " + gds_currdate.getColumn(0, "WEEK_KOR") + "요일은 " + ds_OrdCtrl.getColumn(jRow,"ITEM_TYPE") + " 주문불가 요일입니다.");
			}
		}
		
		//주문통제(입고일자)
		jRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE==iif('" + objDs.getColumn(nRow,"consumYn") + "','Y','소모품','식자재')");
		if (jRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(jRow,ToUpper(ffn_DayToWeek(me_NeedDate.value,"1"))) == "Y")
			{
				return ("[" + sWinItemCd + "] " + ffn_DayToWeek(me_NeedDate.value) + "요일은 " + ds_OrdCtrl.getColumn(jRow,"ITEM_TYPE") + " 입고불가 요일입니다." + "\n\n" + sta_NeedDate.text+ "을 변경하세요.");
			}
		}
	}else{
		//주문통제(입고일자)
		jRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE=='공통'");
		if (jRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(jRow,ToUpper(ffn_DayToWeek(me_NeedDate.value,"1"))) == "Y")
			{
				return ("[" + sWinItemCd + "] " + ffn_DayToWeek(me_NeedDate.value) + "요일은 " + ds_OrdCtrl.getColumn(jRow,"ITEM_TYPE") + " 입고불가 요일입니다." + "\n\n" + sta_NeedDate.text+"을 변경하세요.");

			}
		}	
	}
}


//임시 data 유효성 검사
function fn_checkTempData(obj:Dataset, nCurRow, sColumn){

	var sWinItemCd = obj.getColumn(nCurRow, "winItemCd");
// 	if(obj.getColumn(nCurRow, "ITEM_STATUS") == "E"){
// 		return ("[" + sWinItemCd + "] 오류로 발주 정보를 등록 할 수 없습니다.");
// 	}
	
	if(sColumn == "prRemark"){
		if ( gfn_lengthByte(obj.getColumn(nCurRow, sColumn)) > 100 ) {
			return ("[" + sWinItemCd + "] 최대 입력 길이(100byte)를 초과 하였습니다.");
		}
	} else {
		var nPrQty = (toNumber(obj.getColumn(nCurRow, "prBoxQty"), 0) * toNumber(obj.getColumn(nCurRow, "boxQty"), 0)) + toNumber(obj.getColumn(nCurRow, "prPcQty"), 0);

		//(-)발주여부
		if ( toNumber(nPrQty) < 0 )
		{
			return ("[" + sWinItemCd + "] (-)발주는 불가합니다.");
		}
		
		if (fn_GetDayStatus(obj.getColumn(nCurRow,"dDays"), obj.getColumn(nCurRow,"dTimes")) == "0")
		{
			return ("[" + sWinItemCd + "] 해당 상품은 마감시간(D-Days)이 초과되어 수정이 불가합니다.");
		}
		
		if ( toNumber(nPrQty) > 0 )
		{
			//최소발주량 체크
			if ( (toNumber(obj.getColumn(nCurRow,"minOrdQty")) > 0) && (toNumber(obj.getColumn(nCurRow,"minOrdQty")) > toNumber(nPrQty)) && obj.getColumn(nCurRow, "keepingType") != "냉동" )
			{
				return ("[" + sWinItemCd + "] 해당 상품은 최소발주량이 " + obj.getColumn(nCurRow,"minOrdQty") + "입니다.");
			}
			
			// canColumnChange Event에서 obj.getCaseSum()의 올바른 연산을 위해 함수로 대체
			if ( toNumber(obj.getColumn(nCurRow,"maxOrdQty")) != 0 && toNumber(nPrQty) > toNumber(obj.getColumn(nCurRow,"maxOrdQty")) ) {
				return ("[" + sWinItemCd + "] 해당 상품은 최대발주량이 " + obj.getColumn(nCurRow,"maxOrdQty") + "입니다.");
			}
			
			//소숫점발주여부
			if ( (obj.getColumn(nCurRow,"pointFlag") != "Y") && (Math.ceil(toNumber(nPrQty)) != toNumber(nPrQty)) )
			{
				return ("[" + sWinItemCd + "] 해당 상품은 소숫점발주가 불가합니다.");
			}
			//발주승수량
			if ( (toNumber(obj.getColumn(nCurRow,"multiplierQty")) > 0) && ((Math.round(toNumber(nPrQty) * 1000) % Math.round(toNumber(obj.getColumn(nCurRow,"multiplierQty")) * 1000)) <> 0) )
			{
				return ("[" + sWinItemCd + "] 해당 상품은 발주승수량이 " + obj.getColumn(nCurRow,"multiplierQty") + "입니다.");
			}
		}

// ◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆
// [PJT]주문채널통합
// copy & paste 기능 구현 중 return 처리 없는 case에서 오류발생으로 주석 처리
// grid onkeydown event(ctrl + v)  보다 dataset cancolumnchange event가 선행으로 발생하는 문제
// 		//3개월치 최대발주량 초과시 알람
// 		if ( toNumber(nPrQty) >  toNumber(obj.getColumn(nCurRow,"MAX_SO_QTY")) )
// 		{
// 			return ("[" + sWinItemCd + "] 해당 상품은 최근 3개월 최대발주량 " + obj.getColumn(nCurRow,"MAX_SO_QTY") + " 을 초과 하였습니다. ");
// 		}
// ◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆◆		

	}
	
	return ""; //정상
}

//임시 data 합계처리
function fn_sumTempData(obj:Dataset, nCurRow, sColumn){

	var nPrQty = (toNumber(obj.getColumn(nCurRow, "prBoxQty"), 0) * toNumber(obj.getColumn(nCurRow, "boxQty"), 0)) + toNumber(obj.getColumn(nCurRow, "prPcQty"), 0);
					
	//합계처리
	obj.setColumn(nCurRow, "prQty", nPrQty); 
		
	//금액계산
	var nAmt = Math.round(toNumber(obj.getColumn(nCurRow,"salePrice")) * toNumber(nPrQty));
	obj.setColumn(nCurRow, "saleAmount", nAmt);
	nAmt = Math.round(toNumber(obj.getColumn(nCurRow,"opPrice")) * toNumber(nPrQty));
	obj.setColumn(nCurRow, "opAmount", nAmt);
	
	//무게계산
	var nTotWght = Math.round(toNumber(obj.getColumn(nCurRow, "kgConvertRate")) * toNumber(nPrQty), 3);
	obj.setColumn(nCurRow, "totWght", nTotWght);
	
// 	var rtnAmt = fn_getOrderStatus("recheck");
// 	if ( (obj.getCaseCount("PR_QTY > 0") > 0) && (rtnAmt.ctrlAmt > rtnAmt.poAmt) ) {
// 		st_ctrlAmt.text = " 발주가능금액 " + gfn_numFormat(rtnAmt.ctrlAmt - rtnAmt.poAmt) + "원 부족";
// 		st_ctrlAmt.visible = true;
// 	} else {
// 		st_ctrlAmt.text = "";
// 		st_ctrlAmt.visible = false;
// 	}
}

// 발주제한에 따른 탭페이지 제어
function tab_list_canchange(obj:Tab, e:TabIndexChangeEventInfo)
{
	if ( fv_rtnYn != "Y" && tab_list.tabpages[e.postindex].name == "tab1"){				
		g_Message("EE","반환주문이 불가능한 업장입니다.");
			return false;		
    }

	var pre = eval("tab_list.tab" + gfn_toString(e.preindex+1)).text +"탭";
	var post = eval("tab_list.tab" + gfn_toString(e.postindex+1)).text +"탭";
	
	if ( gfn_dsIsUpdated(eval("ds_Listb" + gfn_toString(tab_list.tabindex+1))) ){			
		if(!gfn_confirm(post+"으로 전환 시 "+pre+"의 저장하지 않은 발주 정보가 사라집니다. 전환하시겠습니까?")){
			return false;
		} 
    }
    
    eval("ds_List" + gfn_toString(tab_list.tabindex+1)).clearData();
 	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).clearData();
    eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).cbo_Gbn.index = 0;//[PJT]주문채널통합
	eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.value = ""; 			
	eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.setFocus();
		
 	//comp_upjang.setUpjangCode("");
 	//comp_upjang.setUpjangName("");
	//fn_ResetData();
	//fn_setInitForm();
}

//tab변경
function tab_list_onchanged(obj:Tab, e:TabIndexChangeEventInfo)
{	
	if(obj.tabindex == 0){	
		sta_NeedDate.text = "반환회수일";
		//sta_rtnOrdType.text = "반환유형"
		comp_upjang.isUpjangControl = true;
	} else if(obj.tabindex == 1) {	
		sta_NeedDate.text = "교환주문일";
		//sta_rtnOrdType.text = "교환유형"
		comp_upjang.isUpjangControl = false;
	} else if(obj.tabindex == 2) {	
		sta_NeedDate.text = "증정주문일";
		//sta_rtnOrdType.text = "증정유형"
		comp_upjang.isUpjangControl = false;
	}
	
	fn_search();
	eval("tab_list.tab" + gfn_toString(e.postindex + 1)).ed_Item.setFocus();	
}

//반환타입 (증정타입제외 및 attr01~02 기간 적용)
function fn_callbakRtnOrdType(){
	ds_rtnOrdType.filter("code != 'G01' && code != 'H01' && code != 'I01' && attr01 <= '"+me_NeedDate.value+"' && attr02 >= '"+me_NeedDate.value+"'");	
}


//증정탭 삭제 처리(사번 우선순위1)
function fn_afterUserInfo(){	
	if(v_dsS.getColumn(0, "attr01") == "N"){
		tab_list.removeTabpage(2); //증정탭 삭제
	} else if(gfn_isNull(v_dsS.getColumn(0, "attr01"))){
		var v_dsU;
		SCDataset.bind(this, "ComCode", "v_dsU", {groupCode:"PRESENT_ORD", useYn:"Y", code:application.gv_upjang}, "fn_afterUpjangInfo");
		//SCDataset.bind(this, "ComCode", "v_dsU", {groupCode:"PRESENT_ORD", useYn:"Y", code:"191038"}, "fn_afterUpjangInfo");
	}
}

//증정탭 삭제 처리(업장 우선순위2)
function fn_afterUpjangInfo(){	
	if( v_dsU.getColumn(0, "attr01") == "N" || gfn_isNull(v_dsU.getColumn(0, "attr01")) ){
		tab_list.removeTabpage(2); //증정탭 삭제
	}
}

//반환/교환/증정 유형 일괄적용
function btn_rtnOrdTypeAllChg_onclick(obj:Button,  e:ClickEventInfo)
{
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).enableevent = false;
	for(var i = 0 ; i < eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getRowCount() ; i++){
		if(! (eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i, "clsStatus") == "마감" || eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).getColumn(i, "itemStatus") == "E") ){
			eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).setColumn(i ,"rtnOrdType", eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).cbo_rtnOrdType.value);
		}
	}	
	eval("ds_Listb" + gfn_toString(tab_list.tabindex+1)).enableevent = true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 구분 변경 이벤트
 *---------------------------------------------------------------------------------------------*/
function tab_list_cbo_Gbn_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	 //구분정보 변경시 keyword reset
	 eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.value = "";
}


]]></Script>
  </Form>
</FDL>

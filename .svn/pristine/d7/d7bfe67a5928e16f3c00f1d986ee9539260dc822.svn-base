<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FMM00400E" onload="form_onload" titletext="레시피검색및 등록(추천식단)" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="sta_detail00" class="sta_WFDA_Labelbg" position="absolute 15 217 611 244"/>
        <Static id="sta_detail05" class="sta_WFDA_Labelbg" position="absolute 15 191 611 218" style="background:#f8f8f8ff;"/>
        <Static id="Static28" class="div_WFSA_Labelbg01" position="absolute 15 151 611 192" style="background:#f8f8f8ff;border:1 solid #c3c3c3ff ;"/>
        <Static id="Static02" position="absolute 15 40 1237 107" class="sta_WFSA_Labelbg"/>
        <Tab id="tab_main" onchanged="tab_main_OnChanged" taborder="12" position="absolute 15 438 1237 712" showextrabutton="false">
          <Tabpages>
            <Tabpage id="tab0" taborder="65" text="레시피수정" url="U_FMM::FMM00401E.xfdl" position="absolute 2 24 973 298" scrollbars="none"/>
            <Tabpage id="tab1" taborder="65" text="조리법" url="U_FMM::FMM00402E.xfdl" position="absolute 2 24 973 298" scrollbars="none"/>
            <Tabpage id="tab3" taborder="65" text="조리공정" position="absolute 2 24 973 298" scrollbars="none">
              <Layouts>
                <Layout width="1220" height="281">
                  <Div id="div_ImgLoadUrl" scrollbars="autoboth" taborder="1" text="Div0" url="U_FMM::FMM00434E.xfdl" position="absolute -4 0 1216 265"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <ImageViewer id="img_Weather" taborder="18" position="absolute 15 108 43 133" style="background:transparent;border:1 none #cacacaff ;"/>
        <Static id="st_weather" position="absolute 50 113 621 138"/>
        <Grid autoenter="select" binddataset="ds_Menu" cellmovingtype="col" selecttype="row" cellsizingtype="both" readonly="false" enable="true" id="grd_RealRecipe" useinputpanel="false" oncellclick="grd_RealRecipe_OnCellClick" onheadclick="grd_RealRecipe_OnHeadClick" onmousemove="grd_RealRecipe_OnMouseOver" taborder="25" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 643 138 1237 408">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="25" band="left"/>
                <Column size="30" band="left"/>
                <Column size="21" band="left"/>
                <Column size="50" band="left"/>
                <Column size="120" band="left"/>
                <Column size="50"/>
                <Column size="50"/>
                <Column size="25"/>
                <Column size="60"/>
                <Column size="55"/>
                <Column size="55"/>
                <Column size="55"/>
                <Column size="55"/>
                <Column size="55"/>
                <Column size="55"/>
                <Column size="55"/>
                <Column size="55"/>
                <Column size="55"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" style="align:center;" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="순서"/>
                <Cell col="2" rowspan="2" colspan="2" displaytype="text" text="레시피코드"/>
                <Cell col="4" rowspan="2" displaytype="text" text="레시피명"/>
                <Cell col="5" rowspan="2" displaytype="text" expr="expr:'구성\n요소'"/>
                <Cell col="6" rowspan="2" displaytype="text" expr="expr:'원가\n(원)'"/>
                <Cell col="7" rowspan="2" displaytype="text" text="색"/>
                <Cell col="8" rowspan="2" displaytype="text" text="레시피분류" expr="expr:'에너지\n(kcal)'"/>
                <Cell col="9" rowspan="2" displaytype="text" text="레시피유형" expr="expr:'당질\n(g)'"/>
                <Cell col="10" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'단백질\n(g)'"/>
                <Cell col="11" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'지질\n(g)'"/>
                <Cell col="12" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민A\n(R.E)'"/>
                <Cell col="13" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민B1\n(mg)'"/>
                <Cell col="14" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민B2\n(mg)'"/>
                <Cell col="15" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민C\n(mg)'"/>
                <Cell col="16" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'칼슘\n(mg)'"/>
                <Cell col="17" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'철\n(mg)'"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:right;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="number" edittype="text" editfilter="number" style="align:right;" text="bind:RECIPE_SEQ"/>
                <Cell col="2" displaytype="image" text="theme://images/new/grd_WF_ExpandImageX.png"/>
                <Cell col="3" displaytype="text" style="align:center;" text="bind:RECIPE_CD"/>
                <Cell col="4" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                <Cell col="5" displaytype="combo" edittype="combo" style="align:left;" text="bind:DISH_INFO" combodataset="ds_Const" combocodecol="CD" combodatacol="NM"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:RECIPE_COST"/>
                <Cell col="7" displaytype="image" text="expr:fn_getColorImage(RECIPE_COLOR)"/>
                <Cell col="8" displaytype="number" style="align:right;" text="bind:CAL"/>
                <Cell col="9" displaytype="number" style="align:right;" text="bind:CARBO"/>
                <Cell col="10" displaytype="number" style="align:right;" text="bind:PROT"/>
                <Cell col="11" displaytype="number" style="align:right;" text="bind:FAT"/>
                <Cell col="12" displaytype="number" style="align:right;" text="bind:VITA_A"/>
                <Cell col="13" displaytype="number" style="align:right;" text="bind:THIA"/>
                <Cell col="14" displaytype="number" style="align:right;" text="bind:RIBO"/>
                <Cell col="15" displaytype="number" style="align:right;" text="bind:VITA_C"/>
                <Cell col="16" displaytype="number" style="align:right;" text="bind:CA"/>
                <Cell col="17" displaytype="number" style="align:right;" text="bind:FE"/>
              </Band>
              <Band id="summary">
                <Cell colspan="5" displaytype="text" style="align:center;" text="합계"/>
                <Cell col="5" displaytype="text" style="align:left;"/>
                <Cell col="6" displaytype="number" style="align:right;" expr="expr:getSum('RECIPE_COST')"/>
                <Cell col="7" displaytype="text" style="align:left;"/>
                <Cell col="8" displaytype="number" style="align:right;" expr="expr:getSum('CAL')"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:getSum('CARBO')"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="expr:getSum('PROT')"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:getSum('FAT')"/>
                <Cell col="12" displaytype="number" style="align:right;" expr="expr:getSum('VITA_A')"/>
                <Cell col="13" displaytype="number" style="align:right;" expr="expr:getSum('THIA')"/>
                <Cell col="14" displaytype="number" style="align:right;" expr="expr:getSum('RIBO')"/>
                <Cell col="15" displaytype="number" style="align:right;" expr="expr:getSum('VITA_C')"/>
                <Cell col="16" displaytype="number" style="align:right;" expr="expr:getSum('CA')"/>
                <Cell col="17" displaytype="number" style="align:right;" expr="expr:getSum('FE')"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_Qality" onclick="btn_Qality_OnClick" taborder="16" text="품질평가" position="absolute 1162 112 1237 134" class="btn_WF_Custom" image=""/>
        <Button id="btn_leftMoveData" onclick="btn_leftMoveData_OnClick" taborder="15" text="" position="absolute 617 243 639 265" class="btn_WF_rightMove" image=""/>
        <Div id="div_extend" taborder="26" text="Div1" position="absolute 15 246 616 428" scrollbars="none">
          <Layouts>
            <Layout width="597" height="171">
              <Static id="Static00" position="absolute 0 13 596 182" style="background:white;border:1 solid #808080ff ;color:white;bordertype:normal 1 1 ;" anchor="default"/>
              <Grid binddataset="ds_List" cellmovingtype="col" cellsizingtype="both" enable="true" id="grd_List" useinputpanel="false" oncelldblclick="div_extend_grd_List_OnCellDblClick" onheadclick="div_extend_grd_List_OnHeadClick" onkillfocus="div_extend_grd_List_OnKillFocus" taborder="1" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 13 596 182" readonly="true" selecttype="row" anchor="default" autofittype="col">
                <Formats>
                  <Format id="Default">
                    <Columns>
                      <Column size="25" band="left"/>
                      <Column size="79" band="left"/>
                      <Column size="17" band="left"/>
                      <Column size="140" band="left"/>
                      <Column size="60"/>
                      <Column size="80"/>
                      <Column size="80"/>
                      <Column size="80"/>
                    </Columns>
                    <Rows>
                      <Row size="26" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell displaytype="text" class="head_Excel"/>
                      <Cell col="1" displaytype="text" text="레시피코드"/>
                      <Cell col="2" colspan="2" displaytype="text" text="레시피명"/>
                      <Cell col="4" displaytype="text" text="원가"/>
                      <Cell col="5" displaytype="text" text="레시피분류"/>
                      <Cell col="6" displaytype="text" text="레시피유형"/>
                      <Cell col="7" displaytype="text" text="조리법유형"/>
                    </Band>
                    <Band id="body">
                      <Cell displaytype="text" style="align:right;" expr="expr:currow+1"/>
                      <Cell col="1" displaytype="text" style="align:right;backgroundimage:EXPR(fn_getBackImage(&quot;DI_MON&quot;, DI_MON));" text="bind:RECIPE_CD"/>
                      <Cell col="2" colspan="2" displaytype="text" style="align:left;backgroundimage:EXPR(fn_getBackImage1(&quot;PHF&quot;, PHF));">
                        <Cell displaytype="text" style="backgroundimage:EXPR(iif(PHF=='Y','URL(\'theme://convertImages/ico_P.bmp\')',''));align:left;"/>
                        <Cell col="1" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                      </Cell>
                      <Cell col="4" displaytype="number" style="align:right;" text="bind:RECIPE_COST"/>
                      <Cell col="5" displaytype="combo" style="align:left;" text="bind:RECIPE_CLASS" combodataset="ds_RecipeClass" combocodecol="CD" combodatacol="NM"/>
                      <Cell col="6" displaytype="combo" style="align:left;" text="bind:RECIPE_TYPE" combodataset="ds_RecipeType" combocodecol="CD" combodatacol="NM"/>
                      <Cell col="7" displaytype="combo" style="align:left;" text="bind:CUISINE_TYPE" combodataset="ds_CookClass" combocodecol="CD" combodatacol="NM"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Static id="st_bar" position="absolute 0 0 592 13" anchor="default" style="color:white;"/>
              <Button id="btn_open_close" taborder="3" onclick="div_extend_img_open_OnClick" class="btn_WFDA_Open" position="absolute 2 -1 34 13" anchor="top right"/>
            </Layout>
          </Layouts>
        </Div>
        <Button id="btn_GiveCal" onclick="btn_GiveCal_OnClick" taborder="3" text="" position="absolute 406 76 426 97" class="btn_WF_cal" image="" userdata="me_GiveDay"/>
        <Static id="Static10" text="제공일" position="absolute 262 75 331 101" class="sta_WFSA_label"/>
        <Static id="Static1" text="끼니" position="absolute 632 48 701 74" class="sta_WFSA_label"/>
        <Static id="Static2" text="코너" position="absolute 30 75 98 101" class="sta_WFSA_label"/>
        <Static id="Static3" text="추천식단분류" position="absolute 30 47 121 73" class="sta_WFSA_label" onclick="Static3_onclick"/>
        <Static id="Static4" text="원가유형" position="absolute 262 47 331 73" class="sta_WFSA_label"/>
        <Static id="Static6" text="식단유형" position="absolute 447 47 516 73" class="sta_WFSA_label"/>
        <MaskEdit id="me_GiveDay" mask="####-##-##" ontextchanged="me_GiveDay_OnChanged" taborder="2" trimtype="both" type="string" position="absolute 329 76 407 97" oneditclick="me_GiveDay_oneditclick" style="align:center middle;"/>
        <Combo codecolumn="MEAL" datacolumn="MEAL_NAME" displayrowcount="10" id="cbo_DinGbn" index="0" innerdataset="ds_Meal" onitemchanged="cbo_DinGbn_OnChanged" taborder="13" position="absolute 673 51 746 72" enable="false"/>
        <Combo codecolumn="CORNER" datacolumn="CORNER_NAME" displayrowcount="10" id="cbo_CornGbn" index="0" innerdataset="ds_Corner" onitemchanged="cbo_CornGbn_OnChanged" taborder="1" position="absolute 124 76 232 97"/>
        <Static id="Static21" text="레시피명" position="absolute 30 160 99 184" class="sta_WFSA_label"/>
        <Combo codecolumn="CD" datacolumn="NM" id="cbo_Item" index="0" innerdataset="ds_Material" onkeydown="common_OnKeyDown" type="filter" taborder="8" position="absolute 19 220 146 241" imemode="hangul,full" autoselect="true" onsetfocus="cbo_RecipeNM_onsetfocus" displayrowcount="10"/>
        <Combo codecolumn="CD" datacolumn="NM" id="cbo_Element" index="0" innerdataset="ds_Element" onkeydown="common_OnKeyDown" type="filter" taborder="9" position="absolute 148 220 270 241" onitemchanged="cbo_Element_onitemchanged" imemode="hangul,full" autoselect="true" onsetfocus="cbo_RecipeNM_onsetfocus" displayrowcount="10"/>
        <Static id="Static41" text="원가" position="absolute 300 219 336 246" class="sta_WFSA_label"/>
        <MaskEdit id="me_UnitPfrom" onkeydown="common_OnKeyDown" taborder="10" position="absolute 343 220 408 240"/>
        <Static id="Static12" text="~" position="absolute 411 229 420 234"/>
        <MaskEdit id="me_UnitPto" onkeydown="common_OnKeyDown" taborder="11" position="absolute 423 220 488 240"/>
        <Combo codecolumn="CD" datacolumn="NM" id="cbo_RecipeType" index="0" innerdataset="ds_RecipeType" onitemchanged="cbo_RecipeType_OnChanged" onkeydown="common_OnKeyDown" type="filter" taborder="6" position="absolute 176 194 331 215" imemode="hangul,full" autoselect="true" onsetfocus="cbo_RecipeNM_onsetfocus" displayrowcount="10"/>
        <Combo codecolumn="CD" datacolumn="NM" id="cbo_RecipeClass" index="0" innerdataset="ds_RecipeClass" onkeydown="common_OnKeyDown" type="filter" taborder="5" position="absolute 19 194 174 215" onitemchanged="cbo_RecipeClass_onitemchanged" imemode="hangul,full" autoselect="true" onsetfocus="cbo_RecipeNM_onsetfocus" displayrowcount="10"/>
        <Combo codecolumn="CD" datacolumn="NM" displayrowcount="10" id="cbo_MenuClass" index="0" innerdataset="ds_MenuClass" taborder="40" position="absolute 124 50 232 71"/>
        <Combo codecolumn="CD" datacolumn="NM" displayrowcount="10" id="cbo_CostType" index="0" innerdataset="ds_CostType" taborder="41" position="absolute 329 50 417 71"/>
        <Combo codecolumn="CD" datacolumn="NM" displayrowcount="10" enable="true" id="cbo_MenuType" index="0" innerdataset="ds_MenuType" taborder="42" position="absolute 514 50 602 71"/>
        <Combo codecolumn="CD" datacolumn="NM" id="cbo_CuisineClass" innerdataset="ds_CookClass" onkeydown="common_OnKeyDown" type="filter" taborder="7" position="absolute 333 194 488 215" onitemchanged="cbo_CuisineClass_onitemchanged" index="-1" imemode="hangul,full" autoselect="true" onsetfocus="cbo_RecipeNM_onsetfocus" displayrowcount="10"/>
        <Button id="btn_SubSearch" onclick="btn_SubSearch_OnClick" taborder="14" text="조회" position="absolute 545 161 596 181" class="btn_WF_Custom" image=""/>
        <Button id="btn_ImgPop" onclick="btn_ImgPop_OnClick" taborder="44" position="absolute 644 410 665 427" class="btn_WF_Camera" image="" style="image:URL('theme://convertImages\new\btn_WF_cameraN.png');"/>
        <Button id="btn_Pop_Save" onclick="Com_Btn_common_OnClick" taborder="46" text="저장" position="absolute 1080 10 1131 35" class="btn_WF_Custom" image="" visible="true"/>
        <Button id="btn_Pop_Delete" onclick="fn_Pop_Delete" taborder="47" text="삭제" position="absolute 1133 10 1184 35" class="btn_WF_Custom" image="" visible="true"/>
        <Button id="btn_Pop_Close" onclick="fn_Pop_Close" taborder="48" text="닫기" position="absolute 1186 10 1237 35" class="btn_WF_Custom" image=""/>
        <Static id="Static09" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 990 10"/>
        <Static id="Static22" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 728 35 975 40"/>
        <Static id="Static11" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 725"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 15 640"/>
        <Static id="Static23" text="W15" visible="false" position="absolute 15 50 30 71" style="background:#ff000055;align:center middle;"/>
        <Static id="Static18" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 114 50 124 71"/>
        <Static id="Static20" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 232 50 262 71"/>
        <Static id="Static01" text="h06" onclick="Static12_onclick" class="Guide01_AreaRed" visible="false" position="absolute 1076 107 1237 113" anchor="top right"/>
        <Static id="Static13" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 1076 133 1237 138"/>
        <Static id="Static14" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 15 133 975 138" onclick="Static14_onclick"/>
        <Static id="sta_WF_TitleLev01" text="레시피검색" class="sta_WF_Title01" position="absolute 15 135 110 153"/>
        <Static id="Static04" text="h15" onclick="Static04_onclick" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725"/>
        <Button id="btn_Pop_Search" taborder="49" text="조회" onclick="Com_Btn_common_OnClick" class="btn_WF_searchCm" visible="true" anchor="default" position="absolute 1019 10 1078 35" positiontype="position"/>
        <Static id="Static16" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 417 50 447 71"/>
        <Static id="Static19" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 504 50 514 71"/>
        <Static id="Static26" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 602 50 632 71"/>
        <Static id="Static27" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 664 50 674 71"/>
        <Static id="Static30" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 232 76 262 97"/>
        <Static id="Static24" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 319 50 329 71"/>
        <Static id="Static51" text="W05." visible="false" position="absolute 15 71 975 76" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 15 97 975 107" anchor="left top"/>
        <Static id="Static00" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 15 40 975 50" anchor="left top"/>
        <Static id="Static29" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 15 151 495 161"/>
        <Static id="Static31" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 248 186 495 191"/>
        <Static id="Static32" text="W15" visible="false" position="absolute 15 161 30 182" style="background:#ff000055;align:center middle;"/>
        <Static id="Static33" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 87 161 97 182"/>
        <Static id="Static34" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 15 181 612 191" onclick="Static34_onclick"/>
        <Static id="sta_WF_TitleLev00" text="식단구성" class="sta_WF_Title01" position="absolute 644 122 739 140"/>
        <Static id="Static08" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 270 220 300 241"/>
        <Static id="Static15" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 333 221 343 242"/>
        <Static id="Static25" text="W15" visible="false" position="absolute 596 161 611 182" style="background:#ff000055;align:center middle;"/>
        <Combo id="cbo_RecipeNM" taborder="50" innerdataset="ds_RecipeNM" codecolumn="NM" datacolumn="NM" type="filter" displayrowcount="10" ontextchanged="cbo_RecipeNM_ontextchanged" onitemchanged="cbo_RecipeNM_onitemchanged" onkillfocus="cbo_RecipeNM_OnKillFocus" onkeydown="cbo_RecipeNM_onkeydown" position="absolute 97 161 257 182" userchange="0" imemode="hangul,full"/>
        <Button id="btn_AddItem" taborder="51" text="상품추가" onclick="btn_AddItem_OnClick" class="btn_WF_Custom" position="absolute 1173 438 1237 459"/>
        <Static id="Static17" text="h5" onclick="Static17_onclick" class="Guide01_AreaRed" visible="false" position="absolute 274 459 1237 464" anchor="left top"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_mType"/>
      <Dataset id="ds_List"/>
      <Dataset id="ds_input"/>
      <Dataset id="ds_weather"/>
      <Dataset id="ds_RecipeNM"/>
      <Dataset id="ds_RecipeClass"/>
      <Dataset id="ds_RecipeType"/>
      <Dataset id="ds_CookClass"/>
      <Dataset id="ds_Material"/>
      <Dataset id="ds_Element"/>
      <Dataset id="ds_CutList"/>
      <Dataset id="ds_Corner"/>
      <Dataset id="ds_Meal"/>
      <Dataset id="ds_Menu">
        <ColumnInfo>
          <Column id="TERM_MENU_CD" type="STRING" size="20"/>
          <Column id="RECIPE_CD" type="STRING" size="20"/>
          <Column id="DISH_INFO" type="STRING" size="20"/>
          <Column id="RECIPE_SEQ" type="BIGDECIMAL" size="39"/>
          <Column id="RECIPE_NAME" type="STRING" size="50"/>
          <Column id="RECIPE_COLOR" type="STRING" size="100"/>
          <Column id="RECIPE_COST" type="BIGDECIMAL" size="39"/>
          <Column id="CAL" type="BIGDECIMAL" size="39"/>
          <Column id="WATER" type="BIGDECIMAL" size="39"/>
          <Column id="PROT" type="BIGDECIMAL" size="39"/>
          <Column id="FAT" type="BIGDECIMAL" size="39"/>
          <Column id="CARBO" type="BIGDECIMAL" size="39"/>
          <Column id="FIBER" type="BIGDECIMAL" size="39"/>
          <Column id="ASH" type="BIGDECIMAL" size="39"/>
          <Column id="CA" type="BIGDECIMAL" size="39"/>
          <Column id="P" type="BIGDECIMAL" size="39"/>
          <Column id="FE" type="BIGDECIMAL" size="39"/>
          <Column id="NA" type="BIGDECIMAL" size="39"/>
          <Column id="K" type="BIGDECIMAL" size="39"/>
          <Column id="VITA_A" type="BIGDECIMAL" size="39"/>
          <Column id="RETIN" type="BIGDECIMAL" size="39"/>
          <Column id="B_CAROT" type="BIGDECIMAL" size="39"/>
          <Column id="THIA" type="BIGDECIMAL" size="39"/>
          <Column id="RIBO" type="BIGDECIMAL" size="39"/>
          <Column id="NIACIN" type="BIGDECIMAL" size="39"/>
          <Column id="VITA_C" type="BIGDECIMAL" size="39"/>
          <Column id="CHOLE" type="BIGDECIMAL" size="39"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Const"/>
      <Dataset id="ds_Recipe"/>
      <Dataset id="ds_CookMethod"/>
      <Dataset id="ds_cond"/>
      <Dataset id="ds_phf" oncolumnchanged="ds_phf_OnColumnChanged"/>
      <Dataset id="ds_Item" onrowposchanged="ds_Item_OnRowPosChanged" oncolumnchanged="ds_Item_oncolumnchanged"/>
      <Dataset id="ds_RecipePhf"/>
      <Dataset id="ds_Chk"/>
      <Dataset id="ds_MenuClass"/>
      <Dataset id="ds_CostType"/>
      <Dataset id="ds_MenuType"/>
      <Dataset id="ds_MenuCD"/>
      <Dataset id="ds_cnt"/>
      <Dataset id="ds_in"/>
      <Dataset id="ds_GetDate"/>
    </Objects>
    <Bind>
      <BindItem id="st_weather_value" compid="st_weather" propid="value" datasetid="ds_weather" columnid="W_INFO"/>
      <BindItem id="item5" compid="sta_detail05" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item0" compid="sta_detail00" propid="text" datasetid="ds_view" columnid="D_1"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 메뉴관리>식단관리>식단등록>레시피검색및 등록
 * 프로그램명   : FMM00430E.XML
 * 기      능   : 레시피검색및 등록
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071226 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 사용자가 선택한 매뉴를 신규생성하는 로직 추가
 ******************************************************************************************
 */
//******************************************************************************************(90)
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//******************************************************************************************
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"		
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"		
//******************************************************************************************
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//******************************************************************************************
/*

<레시피검색및 등록> 기간 표준식단
	FROM_DT, 	TO_DT				(시작일,종료일)
	MEAL,		CORNER,  	MENU_DATE     	(끼니,코너,제공일)
	MENU_CLASS, 	COST_TYPE, 	MENU_TYPE	(추천식단분류,원가유형,메뉴유형)

*/

// var	fa_FROM_DT="";
// var	fa_TO_DT="";
// var	fa_MEAL="";
// var	fa_CORNER="";
// var	fa_MENU_DATE="";
// var	fa_MENU_CLASS="";
// var	fa_COST_TYPE="";
// var	fa_MENU_TYPE="";

var v_gbn=1;
var v_CurRecipenm="";
var v_CurRecipecd="";
var v_CurCuisineType="";
//******************************************************************************************
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//******************************************************************************************
function fn_make_chk(str)
{
	var arg="";
	if(str!="ONLOAD")
	{
		arg	="fa_MEAL="			+ wrapQuote(cbo_DinGbn.value)
			+" fa_CORNER="		+ wrapQuote(cbo_CornGbn.value)
			+" fa_MENU_DATE="	+ wrapQuote(me_GiveDay.value)
			+" fa_MENU_CLASS="	+ wrapQuote(cbo_MenuClass.value)
			+" fa_COST_TYPE="	+ wrapQuote(cbo_CostType.value)
			+" fa_MENU_TYPE="	+ wrapQuote(cbo_MenuType.value); 
	}
	else
	{
		arg	="fa_MEAL="			+ wrapQuote(cbo_DinGbn.value)
			+" fa_CORNER="		+ wrapQuote(cbo_CornGbn.value)
			+" fa_MENU_DATE="	+ wrapQuote(me_GiveDay.value)
			+" fa_MENU_CLASS="	+ wrapQuote(cbo_MenuClass.value)
			+" fa_COST_TYPE="	+ wrapQuote(cbo_CostType.value)
			+" fa_MENU_TYPE="	+ wrapQuote(cbo_MenuType.value); 
	}
	fsp_clear(this);
	fsp_addSearch(this,"fm/fmm:FMM00400E_S014");
	ds_cnt.clearData();
	http.Sync=true;
	fsp_callService(this,"","",
					"",
					"ds_cnt=ds_cnt",
					arg,
					"",
					"",
					true);
	http.Sync=false;
	if(ds_cnt.getRowCount()==0)
	{
		fsp_clear(this);
		fsp_addSingle(this,"fm/fmm:FMM00400E_I002");
		http.Sync=true;
		fsp_callService(this, "", "", "", "", arg, "","",true);	
		http.Sync=false;	
	}
}

function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, true);

	fsp_init(this); 

	fsp_clear(this);
	fsp_addSearch(this,"fm/fmm:FMM00400E_S015");
	ds_mType.clearData();
	http.Sync=true;
	fsp_callService(this,"","",
					"",
					"ds_mType=ds_mType",
					"",
					"",
					"",
					true);
	http.Sync=false;	
	
	// fa_FROM_DT="20071118";
	// fa_TO_DT="20071124";
	// fa_MEAL="001";
	// fa_CORNER="001";
	// fa_MENU_DATE="20071120";
	// fa_MENU_CLASS="001";
	// fa_COST_TYPE="001";
	// fa_MENU_TYPE="001";
	// fa_MENU_CD="20071120002";	// 기간표준식단 메뉴 코드 구성 : 제공일+3자리 순번
	
 
	// tit_ClearActionInfo(this);
	//	//오늘 날짜
	// ds_GetDate.ClearData();
	// tit_addSearchActionInfo(this,"sc/scc:SCC_TODAY");
	// tit_CallService(this,"","","","ds_GetDate=ds_GetDate","","fn_call_back","",true);

 
	fsp_clear(this);
	// 레시피분류
	ds_RecipeClass.clearData();
	fsp_addSearch(this,"fm/fmr:FMR00010E_S002");
	fsp_callService(this,"","","","ds_RecipeClass=ds_RecipeClass","","fn_call_back_class","",true);  

	fsp_clear(this);
	// 레시피유형
	ds_RecipeType.clearData();
	fsp_addSearch(this,"fm/fmr:FMR00010E_S003");
	fsp_callService(this,"","","","ds_RecipeType=ds_RecipeType","","fn_call_back_type","",true); 
	
	fsp_clear(this);  
	// 조리법유형
	ds_CookClass.clearData();
	fsp_addSearch(this,"fm/fmr:FMR00010E_S004");
	fsp_callService(this,"","","","ds_CookClass=ds_CookClass","","fn_call_back_CookClass","",true); 
	
	fsp_clear(this);
	// 주재료군
	ds_Material.clearData();
	fsp_addSearch(this,"fm/fmr:FMR00010E_S005");
	fsp_callService(this,"","","","ds_Material=ds_Material","","fn_call_back_Material","",true);	
	
	ds_Material.setColumn(0,'CD','');
	

	fsp_clear(this);
	// 대표영양성분
	ds_Element.clearData();
	fsp_addSearch(this,"fm/fmr:FMR00010E_S006");
	fsp_callService(this,"","","","ds_Element=ds_Element","","fn_call_back_Element","",true); 

	fsp_clear(this);
	// 커팅규격
	ds_CutList.clearData();
	fsp_addSearch(this,"fm/fmr:FMR00010E_S022");
	fsp_callService(this,"","","","ds_CutList=ds_CuttingList","","fn_call_back_CuttingList","",true); 
	
	http.Sync=true;
	fsp_clear(this);
	// 병원구성요소(식단구성)
	ds_Const.clearData();
	fsp_addSearch(this,"fm/fmm:FMM00430E_S007");
	fsp_callService(this,"","","","ds_Const=ds_Const","","fn_call_back_Const","",true);
	http.Sync=false; 
	
	http.Sync=true;
	fsp_clear(this);
	// 추천식단 분류
	ds_MenuClass.clearData();
	fsp_addSearch(this,"fm/fmm:FMM00400E_S001");
	fsp_callService(this,"","","","ds_MenuClass=ds_MenuClass","","fn_call_back_MenuClass","",true);
	http.Sync=false;
	
	http.Sync=true;
	fsp_clear(this);
	// 원가 유형
	ds_CostType.clearData();
	fsp_addSearch(this,"fm/fmm:FMM00400E_S002");
	fsp_callService(this,"","","","ds_CostType=ds_CostType","","fn_call_back_CostType","",true);
	http.Sync=false;
	
	http.Sync=true;
	fsp_clear(this);
	// 식단 유형
	ds_MenuType.clearData();
	fsp_addSearch(this,"fm/fmm:FMM00400E_S003");
	fsp_callService(this,"","","","ds_MenuType=ds_MenuType","","fn_call_back_MenuType","",true);
	http.Sync=false;
	 
	 fsp_clear(this);
	// 레시피명
	ds_RecipeNM.clearData();
	fsp_addSearch(this,"fm/fmr:FMR00010E_S001");
	fsp_callService(this,"","","","ds_RecipeNM=ds_RecipeNM","","fn_call_back_RecipeNM","",true); 
 
	if(gfn_length(gfn_trim(fa_FROM_DT))==0)
	{
		g_Message("EE",fn_AlertMsg("027"));
		return;
	}
	if(gfn_length(gfn_trim(fa_TO_DT))==0)
	{
		g_Message("EE",fn_AlertMsg("027"));
		return;
	}
	if(gfn_length(gfn_trim(fa_MEAL))==0)
	{
		g_Message("EE",fn_AlertMsg("014"));
		return;
	}
	if(gfn_length(gfn_trim(fa_CORNER))==0)
	{
		g_Message("EE",fn_AlertMsg("015"));
		return;
	}
	if(gfn_length(gfn_trim(fa_MENU_DATE))==0)
	{
		g_Message("EE",fn_AlertMsg("013"));
		return;
	}
	else
	{
		me_GiveDay.value=fa_MENU_DATE;
	}
	//-----------
	if(gfn_length(gfn_trim(fa_MENU_CLASS))==0)
	{
		g_Message("EE",fn_AlertMsg("029"));
		return;
	}
	if(gfn_length(gfn_trim(fa_COST_TYPE))==0)
	{
		g_Message("EE",fn_AlertMsg("030"));
		return;
	}	
	if(gfn_length(gfn_trim(fa_MENU_TYPE))==0)
	{
		g_Message("EE",fn_AlertMsg("031"));
		return;
	} 

	ds_input.clear();
	ds_input.addColumn("CUR_DATE",'STRING',256);
	var nRow = ds_input.addRow(); 
	
	ds_input.setColumn(nRow,"CUR_DATE",me_GiveDay.value);	
	 
	http.Sync=true;
	fsp_clear(this);
	ds_GetDate.clearData();
	ds_weather.clearData();
	fsp_addSearch(this,"sc/scc:SCC_TODAY");		// 당일 날짜
	fsp_addSearch(this,"fm/fmm:FMM00400E_S006");  // 날씨정보	무조건 서울을 보여줍니다.
	
	fsp_callService(this,"","",
					"ds_input=ds_input",
					"ds_GetDate=ds_GetDate ds_weather=ds_weather",
					"",
					"fn_Call_back_weather",
					"",
					true);
	http.Sync=false; 
	
	//img_Weather.image=ds_weather.getColumn(0,"W_IMAGE"); 
	
	
	fn_Meal();
	fn_Corner();
	http.Sync=true;
	fn_make_chk();
	http.Sync=false; 


    //trace(ds_Menu.saveXML());

}

function fn_call_back_CuttingList(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{ 
	}
}

function fn_call_back_CookClass(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
		cbo_CuisineClass.index = 0;
	}
}


function fn_call_back_Material(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
		cbo_Item.index = 0;
	}
}

function fn_call_back_Element(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
		cbo_Element.index = 0;
	}
}

function fn_call_back_MenuType(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
		cbo_MenuType.index = 0;
	}
}

function fn_call_back_CostType(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
		cbo_CostType.index = 0;
	}
}

function fn_call_back_MenuClass(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
		cbo_MenuClass.index = 0;
	}
}

function fn_call_back_Const(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{ 
	}
}

function fn_call_back_RecipeNM(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
	  cbo_RecipeNM.index = 0;
	
	}
}

function fn_call_back_class(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
		ds_RecipeClass.filter("CD!='H'");
		
		cbo_RecipeClass.index = 0;
	}
}

function fn_call_back_type(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
		ds_RecipeType.filter("SET1!='Y'");
		
		cbo_RecipeType.index = 0;
	}
}

function fn_Call_back(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
		 
	}
}
function fn_Call_back_meal(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
		cbo_MenuClass.value=fa_MENU_CLASS;
		cbo_CostType.value=fa_COST_TYPE;
		cbo_MenuType.value=fa_MENU_TYPE;	
		// if(ds_Meal.RowCount()>0)
		// {	//끼니 조회후 코너 조회
			if(v_gbn==1)
			{
				cbo_DinGbn.value=fa_MEAL;
			}
			//fn_Corner();
		// }		
	}
}
function fn_Call_back_corner(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{	
		if(v_gbn==1)
		{
			cbo_CornGbn.value=fa_CORNER;
			//trace(fa_CORNER);
			if(fa_CORNER=="001")
			{
				cbo_CornGbn.index=0; 
			}
			else
			{
				cbo_CornGbn.index=1; 
			}
			v_gbn=0;
		}
//		cbo_CornGbn_OnChanged();
		fn_Pop_Search("load");
	}
//===========================================>
	// if(cbo_MenuType.Index==1)
	// {
		// cbo_CornGbn.InnerDataset="";
		// cbo_CornGbn.InnerDataset="ds_mType";
		// cbo_CornGbn.Index=-1;
	// }
}
//콜백 프로세스 처리
function fn_call_back(cd,errmsg)
{
	if(cd!=0) 
	{
		return;
	}
	else
	{
	 
	
	}	
}

function fn_Call_back_weather(cd,errmsg)
{
	if(cd!=0)
	{
	

	
	}
	else
	{
		//trace(ds_weather.saveXML());
		
		iW = "URL('theme://convertImages/" + ds_weather.getColumn(0,"W_IMAGE") + ".png";
		
		img_Weather.image=iW; 
		
		st_weather.text = gfn_nvl(ds_weather.getColumn(0,"W_INFO"));
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Pop_Search()
 * 입      력   : 검색조건
 * 반      환   : 없음
 * 기      능   : 사용자 등록정보
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071226
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function fn_Pop_Search(str)
{
	if(gfn_dsIsUpdated(ds_Menu)==true || gfn_dsIsUpdated(ds_Item)==true)
	{
		if(g_Confirm("02","변경된 데이타가 있습니다.\n\n저장하시겠습니까?"))
		{
			fn_Pop_Save("BTN_SAVE");
			return;
		}
	}
	
	fn_make_chk();
	tab_main.tabindex=0;
	ds_Menu.clearData();
	ds_Item.clearData();
	ds_RecipePhf.clearData();
	ds_phf.clearData();
	if(str!="load")
	{
		if(gfn_length(gfn_trim(cbo_DinGbn.value))==0)
		{
			g_Message("EE",fn_AlertMsg("014"));
			return;
		}
		if(gfn_length(gfn_trim(cbo_CornGbn.value))==0)
		{
			g_Message("EE",fn_AlertMsg("015"));
			return;
		}
		if(gfn_length(gfn_trim(me_GiveDay.value))==0)
		{
			g_Message("EE",fn_AlertMsg("013"));
			return;
		}
		if(gfn_length(gfn_trim(cbo_MenuClass.value))==0)
		{
			g_Message("EE",fn_AlertMsg("029"));
			return;
		}
		if(gfn_length(gfn_trim(cbo_CostType.value))==0)
		{
			g_Message("EE",fn_AlertMsg("030"));
			return;
		}	
		if(gfn_length(gfn_trim(cbo_MenuType.value))==0)
		{
			g_Message("EE",fn_AlertMsg("031"));
			return;
		}							
	}
	else
	{
		if(gfn_length(gfn_trim(cbo_DinGbn.value))==0)
		{
			//g_Message("EE",fn_AlertMsg("014"));
			return;
		}
		if(gfn_length(gfn_trim(cbo_CornGbn.value))==0)
		{
			//g_Message("EE",fn_AlertMsg("015"));
			return;
		}
		if(gfn_length(gfn_trim(me_GiveDay.value))==0)
		{
			//g_Message("EE",fn_AlertMsg("013"));
			return;
		}
		if(gfn_length(gfn_trim(cbo_MenuClass.value))==0)
		{
			//g_Message("EE",fn_AlertMsg("029"));
			return;
		}
		if(gfn_length(gfn_trim(cbo_CostType.value))==0)
		{
			//g_Message("EE",fn_AlertMsg("030"));
			return;
		}	
		if(gfn_length(gfn_trim(cbo_MenuType.value))==0)
		{
			//g_Message("EE",fn_AlertMsg("031"));
			return;
		}	
	}
	var arg="";
	
	arg		="MEAL="			+wrapQuote(cbo_DinGbn.value)
			+" CORNER="			+wrapQuote(cbo_CornGbn.value)
			+" MENU_DATE="		+wrapQuote(me_GiveDay.value)
			+" MENU_CLASS="		+wrapQuote(cbo_MenuClass.value)
			+" COST_TYPE="		+wrapQuote(cbo_CostType.value)
			+" MENU_TYPE="		+wrapQuote(cbo_MenuType.value); 
	
	fsp_clear(this);
	fsp_addSearch(this,"fm/fmm:FMM00400E_S008");
	http.Sync=true;
	fsp_callService(this,"","","","ds_Menu=ds_Menu",arg,"fn_call_back","",true);
	http.Sync=false;
	if(ds_Menu.getRowCount()>0)
	{
		tab_main.tab0.fn_T1_Search();
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Pop_Save()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 저장
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071226
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
 
function fn_Pop_Save(str)
{
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	var searchsql,insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql;
	var searchsql,insertSql2, updateSql2, deleteSql2;
	var searchsql,insertSql3, updateSql3, deleteSql3;
	
	switch(str)
	{
		case "ICO_RECIPE_DEL":	// x아이콘 레시피 : 추천식단레시피 상세정보(FMM_TERM_MENU_RECIPE_ITEM) 모두 삭제 함
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_Menu=ds_Menu:U";
			outData		= "";
			callBackFnc	= "fn_callbackRecipeDelete";
			insertSql1 	= "";
			insertSql2 	= "";
			insertSql3 	= "";			
			updateSql1	= "";
			updateSql2	= "";			
			updateSql3	= "";
			deleteSql1	= "fm/fmm:FMM00400E_D001";
			deleteSql3	= "fm/fmm:FMM00400E_D003";		// 추천식단 레시피 상세정보 삭제
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			fsp_addSave(this, insertSql3, updateSql3, deleteSql3,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);
		
			//fn_Pop_Search();
			break;
		case "ICO_ITEM_DEL":	// x아이콘 자제
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			// 레시피의 아이템 정보가 더이상 없을 경우 => 레시피의 정보도 삭제 함...
			var v_recipe = ds_Menu.getColumn(ds_Menu.rowposition,"RECIPE_CD");
			var iCnt = 0;
			
			 for(i=0;i<ds_Item.getRowCount();i++)
			 {
				 if(ds_Item.getRowType(i) != Dataset.ROWTYPE_DELETE) 
				 {
					if (ds_Item.getColumn(i, "RECIPE_CD") == v_recipe)
					{
						iCnt++;	
					}	
				 }
			 }
			
			inData		= "ds_Item=ds_Item:U";
			outData		= "";
			//callBackFnc	= "fn_callbackItemDelete";
			callBackFnc	= "fn_callbackDelete";
			insertSql1 	= "";
			updateSql1	= "";
			deleteSql1	= "fm/fmm:FMM00400E_D004";
			if (iCnt == 0) {	
				insertSql2 	= "";
				updateSql2	= "";
				deleteSql2	= "fm/fmm:FMM00400E_D005";	// 레시피 정보 삭제
			}	
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			if (iCnt == 0) {	
				fsp_addSave(this, insertSql2, updateSql2, deleteSql2,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			}
			http.Sync=true;
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);
			http.Sync=false;
			fn_Pop_Search();
			break;
		case "COOK":	// 조리법저장
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_CookMethod=ds_CookMethod:U";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "fm/fmm:FMM00430E_I001";			
			updateSql1	= "fm/fmm:FMM00430E_U001";
			deleteSql1	= "fm/fmm:FMM00430E_D004";
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);		
			break;	
		case "PHF":	// PHF관리 업데이트
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_RecipePhf=ds_RecipePhf:U";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "";			
			updateSql1	= "fm/fmm:FMM00430E_U002";
			deleteSql1	= "";
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);		
			break;								
		case "BTN_DEL":	// 삭제 버튼(식단 삭제), 모두 삭제 함
			fsp_clear(this);
			ds_cond.clear();
			ds_cond.addColumn("TERM_MENU_CD","STRING",256);
			ds_cond.addRow(); 
			ds_cond.setColumn(0,"TERM_MENU_CD",ds_Menu.getColumn(0,"TERM_MENU_CD"));

			inData		= "ds_cond=ds_cond";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "";
			updateSql1	= "";
			deleteSql1	= "fm/fmm:FMM00400E_D002";
			insertSql2 	= "";
			updateSql2	= "";
			deleteSql2	= "fm/fmm:FMM00400E_D006";		// FMM_TERM_MENU_RECIPE_ITEM 전체 삭제
			
			
			keyIncrement= -1;
			callbackSql	= "";
			fsp_addMulti(this,deleteSql1);			
			fsp_addMulti(this,deleteSql2);
			http.Sync=true;
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);	
			http.Sync=false;
			fn_Pop_Search();
			break;	
		case "BTN_SAVE":	// 저장 버튼 : 레시피상세(하단 그리드) 부분도 수정이 가능하게 변경 : 2015-10-28
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_Menu=ds_Menu:U ds_Item=ds_Item:U";
			outData		= "";
			callBackFnc	= "fn_callbackAllSave";
			insertSql1 	= "";
			insertSql2 	= "";
			updateSql1	= "fm/fmm:FMM00400E_U001";
			updateSql2	= "fm/fmm:FMM00400E_U002";
			deleteSql1	= "";
			deleteSql2	= "";
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);		
			fsp_addSave(this, insertSql2, updateSql2, deleteSql2,saveFlagColumn, keySqlName, keyIncrement, callbackSql);		
			http.Sync=true;
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);
			http.Sync=false;

			break;
		case "BTN_CREATE":	// 신규레시피추가 생성
			break;								
		case "CREATE_REAL":	// 레시피 추가 후 레시피에 해당하는 상세정보(아이템별)를 일괄로 복사함
			var arg	="";
			arg		="MEAL="			+wrapQuote(cbo_DinGbn.value)
					+" CORNER="			+wrapQuote(cbo_CornGbn.value)
					+" MENU_DATE="		+wrapQuote(me_GiveDay.value)
					+" MENU_CLASS="		+wrapQuote(cbo_MenuClass.value)
					+" COST_TYPE="		+wrapQuote(cbo_CostType.value)
					+" MENU_TYPE="		+wrapQuote(cbo_MenuType.value)
					+" RECIPE_CD="		+wrapQuote(ds_List.getColumn(ds_List.rowposition,"RECIPE_CD")); 
			
			http.Sync=true;
			Transaction("FMM00400E","U_svc::" + "fm/fmm/FMM00400E_T001.jsp","","",arg,"");
			http.Sync=false;
			
			fsp_clear(this);
			ds_MenuCD.clearData();
			inData		= ""; 
			outData		= "ds_MenuCD=ds_MenuCD";
			callBackFnc	= "";
			searchsql	= "fm/fmm:FMM00400E_S013";
			insertSql 	= "fm/fmm:FMM00400E_I001";
			// 표준레시피아이템 -> 추천식단레시피 아이템으로 복사
			insertSql2 	= "fm/fmm:FMM00400E_I003";
			keyIncrement= -1;
			callbackSql	= "";
			fsp_addSearch(this, searchsql,true);
			fsp_addMulti(this, insertSql);
			fsp_addMulti(this, insertSql2);
			http.Sync=true;
			fsp_callService(this, actionName, cmdName, inData, outData, arg, callBackFnc);
			http.Sync=false;
			//trace(SaveXML(ds_MenuCD,null));
			fn_Pop_Search();			
			break;
	}

}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Pop_Delete()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 삭제
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071226
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function fn_Pop_Delete()
{
	if(ds_Menu.getRowCount()==0)
	{
		return;
	}
	if(g_Confirm("01",fn_AlertMsg("025"))==true)
	{
		fn_Pop_Save("BTN_DEL");
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Pop_Close()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 화면닫기
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071226
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function fn_Pop_Close()
{
	if(gfn_dsIsUpdated(ds_Menu)==true)
	{
		if(g_Confirm("02","변경된 데이타가 있습니다.\n\n저장하시겠습니까?"))
		{
			fn_Pop_Save("BTN_SAVE");
			return;
		}
	}
	this.close();
}
/******************************************************************************************
 * 함  수  명   : fn_AlertMsg(cd)
 * 입      력   : 메시지 코드
 * 반      환   : 메세지 텍스트
 * 기      능   : 메시지 처리
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071226
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */

function fn_Meal()
{
//	*********업장정보 받아가기***********
	ds_input.clear();
	ds_input.addColumn("MENU_DATE"	,'STRING', 256);
	ds_input.addColumn("MENU_CLASS"	,'STRING', 256);
	ds_input.addColumn("COST_TYPE"	,'STRING', 256);
	ds_input.addColumn("MENU_TYPE"	,'STRING', 256);
	ds_input.addColumn("MEAL"		,'STRING', 256);
	ds_input.addRow();
	ds_input.setColumn(0,"MENU_DATE"	,gfn_trim(me_GiveDay.value));//제공일
	ds_input.setColumn(0,"MENU_CLASS"	,fa_MENU_CLASS 			);
	ds_input.setColumn(0,"COST_TYPE"	,fa_COST_TYPE 			);	
	ds_input.setColumn(0,"MENU_TYPE"	,fa_MENU_TYPE 			);
	ds_input.setColumn(0,"MEAL"			,""						);
// ***************************************	
	http.Sync=true;
	fsp_clear(this);
	ds_Meal.clearData();
//	tit_addSearchActionInfo(this,"fm/fmm:FMM00400E_S004");	// 끼니 조회 ds_Meal
	fsp_addSearch(this,"fm/fmm:FMM00400E_S016");	// 무조건 메뉴생성으로 변경 모두 끼니를 포함한 데이타 셋으로 변경
	fsp_callService(this,"","",
					"ds_input=ds_input",
					"ds_Meal=ds_Meal",
					"",
					"fn_Call_back_meal",
					"",
					true);
	http.Sync=false;
}
function fn_Corner()
{
//	*********업장정보 받아가기***********
	ds_input.clear();
	ds_input.addColumn("MENU_DATE"	,'STRING', 256);
	ds_input.addColumn("MENU_CLASS"	,'STRING', 256);
	ds_input.addColumn("COST_TYPE"	,'STRING', 256);
	ds_input.addColumn("MENU_TYPE"	,'STRING', 256);
	ds_input.addColumn("MEAL"		,'STRING', 256);
	ds_input.addRow();
	ds_input.setColumn(0,"MENU_DATE"	,gfn_trim(me_GiveDay.value));//제공일
	ds_input.setColumn(0,"MENU_CLASS"	,fa_MENU_CLASS 			);
	ds_input.setColumn(0,"COST_TYPE"	,fa_COST_TYPE 			);	
	ds_input.setColumn(0,"MENU_TYPE"	,fa_MENU_TYPE 			);
	ds_input.setColumn(0,"MEAL"			,cbo_DinGbn.value		);
// ***************************************	
	http.Sync=true;
	fsp_clear(this);
	ds_Corner.clearData();
//	tit_addSearchActionInfo(this,"fm/fmm:FMM00400E_S005");	// 코너
	fsp_addSearch(this,"fm/fmm:FMM00400E_S017");	// 무조건 메뉴생성으로 해당코너 자동로딩 데이타 셋으로 변경
	
	fsp_callService(this,"","",
					"ds_input=ds_input",
					"ds_Corner=ds_Corner",
					"",
					"fn_Call_back_corner",
					"",
					true);
	http.Sync=false;	
	
}
function fn_AlertMsg(cd)
{
	var v_Msg="";
	switch(cd)
	{
		case "001":
			v_Msg= "버튼이 정의 되어 있지않습니다.";
			break;
		case "002":
			v_Msg="서비스 오류:시스템 관리자에게 문의하십시오.";
			break;
		case "003":
			v_Msg="조회된 데이타가 없습니다.";
			break;														
		case "004":
			v_Msg="변경된 데이타가 있습니다.\n\n저장하시겠습니까?";
			break;
		case "005":
			v_Msg="날짜를 입력하셔야 합니다.";
			break;
		case "006":
			v_Msg="날짜 형식을 확인하세요.";
			break;			
		case "007":
			v_Msg="월이 잘못되었습니다.";
			break;			
		case "008":
			v_Msg="일자가 잘못되었습니다.";
			break;	
		case "009":
			v_Msg="조회 기간을 벗어났습니다.";
			break;					
		case "010":
			v_Msg="업장정보가 없습니다.";
			break;
		case "011":
			v_Msg="식당정보가 없습니다.";
			break;
		case "012":
			v_Msg="식당군정보가 없습니다.";
			break;
		case "013":
			v_Msg="제공일정보가 없습니다.";
			break;
		case "014":
			v_Msg="끼니정보가 없습니다.";
			break;
		case "015":
			v_Msg="코너정보가 없습니다.";
			break;	
		case "016":
			v_Msg="예상식수가 없습니다.";
			break;										
		case "017":
			v_Msg="입고 예정일이 잘못되었습니다.\n\n다시 선택하세요.";
			break;
		case "018":
			v_Msg="발주된 상품가 있습니다.\n\n삭제할 수 없습니다.";
			break;	
		case "019":
			v_Msg="레시피별 하나의 상품만 선택대체 할 수 있습니다.";
			break;	
		case "020":
			v_Msg="레시피별 하나의 상품만 선택대체 할 수 있습니다.";
			break;
		case "021":
			v_Msg="조리법이 비어있는 라인이 있습니다.비어있는 라인을 입력하세요.";
			break;	
		case "022":
			v_Msg="변경된 데이타가 있습니다.\n\n먼저 저장하신후 작업하세요.";
			break;	
		case "023":
			v_Msg="제공일을 넘을수 없습니다.";
			break;	
		case "024":
			v_Msg="적용할 입고 예정일을 입력하세요.";
			break;
		case "025":
			v_Msg="식단을 삭제 하시겠습니까?";
			break;
		case "026":
			v_Msg="이미 등록된 레시피 입니다.";
			break;	
		case "027":
			v_Msg="조회기간 정보가 없습니다.";
			break;					
		case "028":
			v_Msg="갱신된 정보가 있습니다.저장 후 작업하시겠습니까?";
			break;					
		case "029":
			v_Msg="추천식단분류정보가 없습니다.";
			break;					
		case "030":
			v_Msg="원가유형정보가 없습니다.";
			break;					
		case "031":
			v_Msg="식단유형정보가 없습니다.";
			break;	
		case "032":
			v_Msg="레시피를 추가 하시겠습니까?";
			break;							
/*			
		case "":
			v_Msg="";
			break;
*/			
		default:
			break;			
	}
	return v_Msg;
}
/******************************************************************************************
 * 함  수  명   : Common_Btn_common_OnClick
 * 입      력   : 화면공통버튼 
 * 반      환   : 없음
 * 기      능   : 화면공통버튼이벤트처리 :함수호출
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function Com_Btn_common_OnClick(obj:Button, e:ClickEventInfo)
{
	switch(obj.name)
	{
		case "btn_Pop_Search":
			fn_Pop_Search();
			break;
		case "btn_Pop_Save":
			if(!gfn_dsIsUpdated(ds_Menu)==true && !gfn_dsIsUpdated(ds_Item)==true) {
				g_Message("EE","변경된 정보가 없습니다.");
				return;
			}
			fn_Pop_Save("BTN_SAVE");
			break;
		case "btn_Pop_Delete":
			fn_Pop_Delete();
			break;
		case "btn_Pop_Close":
			fn_Pop_Close();
			break;
	}
}
/******************************************************************************************
 * 함  수  명   : div_extend_img_open_OnClick
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 조회단 그리드 싸이즈 늘이기및 줄이기
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function div_extend_img_open_OnClick(obj:Button,  e:ClickEventInfo)
{

    var cImg = "URL('theme://convertImages/img_CloseBottom.png')";

	if(obj.class == "btn_WFDA_Close")
	{
		//div_extend.img_open.image="URL('theme://convertImages/img_OpenBottom.png')";
		obj.class = "btn_WFDA_Open";
		div_extend.position.height=182;
	//	div_extend.st_bar.position.top=167;
	//	div_extend.img_open.position.top=167;
		div_extend.grd_List.position.height=169;
		div_extend.Static00.position.height=169; 
	}
	else
	{
		//div_extend.img_open.image="URL('theme://convertImages/img_CloseBottom.png')";
		
		obj.class = "btn_WFDA_Close";
		div_extend.position.height=414;
	//	div_extend.st_bar.position.top=375;
	//	div_extend.img_open.position.top=375;
		div_extend.grd_List.position.height=380;
		div_extend.Static00.position.height=380;
	}

}
/******************************************************************************************
 * 함  수  명   : div_extend_grd_List_OnKillFocus
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 조회 그리드 싸이즈 줄이기
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function div_extend_grd_List_OnKillFocus(obj:Grid, e:KillFocusEventInfo)
{
	if(div_extend.img_open.image=="img_closeBottom")
	{
		div_extend.img_open.image="URL('theme://convertImages/img_OpenBottom.png')";
		div_extend.position.height=171;
		div_extend.st_bar.position.top=158;
		div_extend.img_open.position.top=158;
		div_extend.grd_List.position.height=152;
	}	
}
/******************************************************************************************
 * 함  수  명   : btn_GiveCal_OnClick
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 날짜 조회 팝업
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function btn_GiveCal_OnClick(obj:Button, e:ClickEventInfo)
{
	//var v_ret=gfn_dialog("", "U_SCC::SCC_CALENDAR.xfdl","fa_Date="+wrapQuote(me_GiveDay.value),-1,-1,"Title=false Status=false AutoSize=true Resize=false");

    var v_ret=g_CalButton_OnClick(obj);

	if(gfn_trim(me_GiveDay.value)<fa_FROM_DT || gfn_trim(me_GiveDay.value)>fa_TO_DT)
	{
		g_Message("EE",fn_AlertMsg("009"));
		return;
	}
	if(gfn_length(gfn_trim(me_GiveDay.value))==8)
	{
	//	me_GiveDay.value=v_ret;
		
		fn_Meal();
		
		ds_input.clear();
		ds_input.addColumn("CUR_DATE","STRING",256);
		ds_input.addRow();
		ds_input.setColumn(0,"CUR_DATE",me_GiveDay.value);
		fsp_clear(this);
		ds_weather.clearData();
		fsp_addSearch(this,"fm/fmm:FMM00400E_S006");  // 날씨정보
		
		http.Sync=true;
		fsp_callService(this,"","",
						"ds_input=ds_input",
						"ds_weather=ds_weather",
						"",
						"fn_Call_back_weather",
						"",
						true);
		http.Sync=false;
		//+++
		//img_Weather.image=ds_weather.getColumn(0,"W_IMAGE");
	}
	else
	{
		return;
		// if(me_GiveDay.Value.Trim().length()!=8)
		// {
			// me_GiveDay.Value=ds_GetDate.GetColumn(0,"TODAY");
			// fn_Meal();
		// }
	}
	
}
/******************************************************************************************
 * 함  수  명   : me_GiveDay_OnKillFocus
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 날짜 유효성체크
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
// function me_GiveDay_OnKillFocus(obj)
// {
	// fn_IsDate(me_GiveDay.Value);
// }

function fn_IsDate(sYmd)
{
 	if(  gfn_length(gfn_trim(sYmd))< 1) {
		g_Message("EE",fn_AlertMsg("005"));
    	return false;
  	}
  	
    // 숫자 확인
    if(gfn_IsNumber(sYmd) == -1) {
    	g_Message("EE",fn_AlertMsg("006"));
    	me_GiveDay.value="";
    	return false;
  	}
  	
  	// 길이 확인
  	if(gfn_length(sYmd)== 8) {
  	} else {
	    g_Message("EE",fn_AlertMsg("006"));
    	return false;
  	}
  	
  	var iYear	= toNumber(gfn_subStr(sYmd,0,4));		//년도입력(YYYY)
  	var iMonth	= toNumber(gfn_subStr(sYmd,4,2));		//월입력(MM)
  	var iDay	= toNumber(gfn_subStr(sYmd,6,2));		//일자입력(DD)
  	
  	if((iMonth < 1) ||(iMonth >12)) {
	    g_Message("EE",fn_AlertMsg("007"));
	    me_GiveDay.setSelect(5,7);
	    me_GiveDay.setFocus();
        return false;
  	}
  	
  	// 날짜의 존재 여부를 확인
  	if(gfn_getDay(sYmd)< 0 ) {
	    g_Message("EE",fn_AlertMsg("008"));
	    me_GiveDay.value=gfn_subStr(sYmd,0,6);
	    me_GiveDay.setFocus();
		me_GiveDay.setSelect(8,10);
    	return ;
  	}
  	return true;
}
/******************************************************************************************
 * 함  수  명   : cbo_DinGbn_OnChanged
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 끼니 선택시 코너 조회
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function cbo_DinGbn_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	fn_Corner();
}
/******************************************************************************************
 * 함  수  명   : cbo_CornGbn_OnChanged
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 코너 선택시 헤디라인 나머지값 채우기
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function cbo_CornGbn_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	http.Sync=true;
	fn_make_chk("ONLOAD");
	http.Sync=false;
	fn_Pop_Search();
}
/******************************************************************************************
 * 함  수  명   : me_GiveDay_OnChanged
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 제공일 변경시 끼니 다시 조회
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function me_GiveDay_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{
	//fn_IsDate(me_GiveDay.value);
	// if(cbo_MenuType.Index==1)
	// {
		// cbo_CornGbn.InnerDataset="";
		// cbo_CornGbn.InnerDataset="ds_mType";
		// cbo_CornGbn.Index=-1;
	// }
//	fn_Meal();
	fn_make_chk("ONLOAD");
}
/******************************************************************************************
 * 함  수  명   : btn_SubSearch_OnClick
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 표준및 업장 표준레시피 조회
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function btn_SubSearch_OnClick(obj:Button, e:ClickEventInfo)
{		
	var ActionVal="";
	ActionVal 	="RECIPE_NAME="				+	wrapQuote(gfn_trim(gfn_replace(cbo_RecipeNM.text,'==레시피명==','')))
				+" RECIPE_CLASS="			+	wrapQuote(gfn_trim(cbo_RecipeClass.value))
				+" RECIPE_TYPE="			+	wrapQuote(gfn_trim(cbo_RecipeType.value))
				+" CUISINE_TYPE="			+	wrapQuote(gfn_trim(cbo_CuisineClass.value))
				+" MAIN_ITEM_CODE1="		+	wrapQuote(gfn_trim(cbo_Item.value))
				+" RESP_NUT1="				+	wrapQuote(gfn_trim(cbo_Element.value))
				+" FROM_COST="				+	wrapQuote(gfn_trim(me_UnitPfrom.value))
				+" TO_COST="				+	wrapQuote(gfn_trim(me_UnitPto.value));			

	// tit_ClearActionInfo(this);
	// ds_List.ClearData();
	// tit_addSearchActionInfo(this,"fm/fmm:FMM00400E_S007");
	// tit_CallService(this,"","","","ds_List=ds_List",ActionVal,"fn_call_back","",true);

	var OutDS="ds_List=ds_List";
	ds_List.clearData();
	Transaction("ds_List","U_svc::" + "fm/fmm/FMM00400E_S007.jsp","",OutDS,ActionVal,"fn_call_back_S007");
	
//     fsp_clear(this); 
// 	fsp_addSearch(this,"fm/fmm/FMM00400E_S007.jsp");
// 	fsp_callService(this,"","",ActionVal,OutDS,"","fn_call_back_S007","",true);
// 	//fsp_CallService(this,"","","","ds_List=ds_List",ActionVal,"fn_call_back_S007","",true);
	
}
function fn_call_back_S007(outDs, errCode, errMsg)
{
 
   //  trace(errCode + ' = ' + errMsg);

	if(errCode!=0)
	{
		g_Message("EE","시스템 오류!\n\n전산 담당자에게 문의하세요.");
		return;
	}
	else
	{
	 // trace(ds_List.saveXML());
	}	
}
/******************************************************************************************
 * 함  수  명   : chk_RecipeGbn_OnClick
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 표준및 업장 표준레시피 체크 선택(두개중에 하나는 반드시 선택되도록 이벤트 처리)
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function div_extend_grd_List_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
	var chkGbn="";
	var arg="";
	// 표준레시피
	chkGbn="STD2";
	var v_GUBUN	      = gfn_trim(chkGbn);
	var v_RECIPE_CD	  = gfn_trim(ds_List.getColumn(e.row,"RECIPE_CD"));
	var v_RECIPE_NAME = gfn_trim(ds_List.getColumn(e.row,"RECIPE_NAME"));
	var v_UPJANG	  = "";
	var v_HALL_CLASS  = "";
	var v_HALL_CD     = "";
	var v_MENU_DATE	  = gfn_trim(me_GiveDay.value);
	
	var bOpen = false;
	
// 	var nCount = /*  AllWindows 객체를 지원하지 않습니다. Count은 지원되지 않는 속성입니다.*/ application.AllWindows.Count;
// 	
// 	for( var i=0; i<nCount; i++ ) {
// 		if( /* AllWindows 객체를 지원하지 않습니다.*/ application.AllWindows[i].name == "FMM00438P" ) {
// 			//이미 실행되어 있는 경우에는 fn_call이라는 함수를 호출 (fn_call은 변경할 수 있습니다.)
// 			/* Windows 객체를 지원하지 않습니다.*/ application.Windows[i].fn_ReTransport(v_GUBUN, v_RECIPE_CD, v_RECIPE_NAME, v_UPJANG, v_HALL_CLASS, v_MENU_DATE, v_HALL_CD);
// 			bOpen = true;
// 		}
// 	}
	
	if( bOpen ) {
		bOpen = false;
	} else {
	
		arg	={GUBUN:v_GUBUN
			,RECIPE_CD:v_RECIPE_CD
			,RECIPE_NAME:v_RECIPE_NAME
			,UPJANG:""
			,HALL_CLASS:""
			,HALL_CD:""
			,MENU_DATE:v_MENU_DATE};
		
		gfn_dialog("","U_FMM::FMM00438P.xfdl",arg);
	}
}

function btn_ImgPop_OnClick(obj:Button, e:ClickEventInfo)
{
	if(ds_Menu.getRowCount()==0)
	{
		return;
	}
// 	var arg="";
  	arg ={TERM_MENU_CD:ds_Menu.getColumn(0,"TERM_MENU_CD"),ds_pList:ds_List};

//    arg		= {MENU_DATE:ds_Menu.getColumn(0,"MENU_DATE")
// 			,MEAL:ds_Menu.getColumn(0,"MEAL")
// 			,UPJANG:ds_Menu.getColumn(0,"UPJANG")
// 			,HALL_CD:ds_Menu.getColumn(0,"HALL_CD")
// 			,CORNER:ds_Menu.getColumn(0,"CORNER")
/*			,ds_pList:ds_List}; */
	
	gfn_dialog("", "U_FMM::FMM00402P.xfdl",arg);
}

function btn_Qality_OnClick(obj:Button, e:ClickEventInfo)
{
	if(ds_Menu.getRowCount()==0)
	{
		return;
	}
	var arg="";
	arg	 = {fa_TERM_MENU_CD:ds_Menu.getColumn(0,"TERM_MENU_CD")};
	gfn_dialog("", "U_FMM::FMM00401P.xfdl",arg);	
}

function btn_leftMoveData_OnClick(obj:Button, e:ClickEventInfo)
{
	if(ds_List.getRowCount()==0)
	{
		return;
	}
	if(gfn_length(gfn_trim(me_GiveDay.value))==0 || gfn_trim(me_GiveDay.value)==null )
	{
		g_Message("EE",fn_AlertMsg("005"));
		return;
	}
	if(gfn_length(gfn_trim(cbo_DinGbn.value))==0 || gfn_trim(cbo_DinGbn.value)==null )
	{
		g_Message("EE",fn_AlertMsg("014"));
		return;
	}
	if(gfn_length(gfn_trim(cbo_CornGbn.value))==0 || gfn_trim(cbo_CornGbn.value)==null )
	{
		g_Message("EE",fn_AlertMsg("015"));
		return;
	}
	if(gfn_length(gfn_trim(cbo_MenuClass.value))==0)
	{
		g_Message("EE",fn_AlertMsg("029"));
		return;
	}
	if(gfn_length(gfn_trim(cbo_CostType.value))==0)
	{
		g_Message("EE",fn_AlertMsg("030"));
		return;
	}	
	if(gfn_length(gfn_trim(cbo_MenuType.value))==0)
	{
		g_Message("EE",fn_AlertMsg("031"));
		return;
	}
	if(ds_Menu.getRowCount()==0)
	{
		fn_Pop_Search();
	}		
	var v_Recipe=ds_List.getColumn(ds_List.rowposition,"RECIPE_CD");
	if(ds_Menu.findRow("RECIPE_CD",gfn_trim(v_Recipe))!=-1)
	{
		g_Message("EE",fn_AlertMsg("026"));
		return;
	}
	// if(g_Confirm("02",fn_AlertMsg("032"))==false)
	// {
		// return;
	// }	
	if(gfn_dsIsUpdated(ds_Menu)==true )
	{
		if(g_Confirm("02",fn_AlertMsg("028"))==true)
		{
			fn_Pop_Save("BTN_SAVE");
		}
	}
	fn_Pop_Save("CREATE_REAL");
}

function ds_Item_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{	
	SetWaitCursor(true);
	
	var v_EQ=0;	// EDIBLE_QTY		가식부량 1인소요량*폐기율==>NEED_QTY*(100-disuse_rate)
	var v_PP=0; // PERSON_PRICE 	1인원가	상품g당단가*1인소요량==>GRAM_PRICE*NEED_QTY
//	var v_CC=0; // CAL_CALC			에너지    100g:기본에너지=가식부량:계산할에너지==>CAL_CALC=(CAL*EDIBLE_QTY)/100
	var v_TQ=0; //	1인소요량* 예상식수/1000 = 총소요량  
	var v_Price=0;
	var v_Row="";
	var v_nut="";
	var v_rtn="";
	var v_col="";	
	switch(strColumnID)
	{
		case "NEED_QTY":	// 1인소요량
			v_PP	=	Math.round(ds_Item.getColumn(nRow,"G_ITEM_PRICE")*ds_Item.getColumn(nRow,"NEED_QTY"),0);
			ds_Item.setColumn(nRow,"CUR_PRICE",v_PP);	// 1인원가 
			
			v_EQ	=	Math.round(ds_Item.getColumn(nRow,"NEED_QTY")*((100-ds_Item.getColumn(nRow,"DISUSE_RATE"))/100),2);
			ds_Item.setColumn(nRow,"EDIBLE_QTY",v_EQ);			// 가식부량	
			
			v_TQ	=	Math.round((ds_Item.getColumn(nRow,"NEED_QTY")*ds_Item.getColumn(nRow,"EXPECT_MEAL_QTY"))/1000,2);
			ds_Item.setColumn(nRow,"TOT_QTY",v_TQ);			// 총소요량
			
			break;	
		case "EDIBLE_QTY":	// 가식부량
			// CAL WATER PROT FAT CARBO FIBER ASH CA P FE NA K VITA_A RETIN B_CAROT THIA RIBO NIACIN VITA_C CHOLE 
			v_rtn="CAL;WATER;PROT;FAT;CARBO;FIBER;ASH;CA;P;FE;NA;K;VITA_A;RETIN;B_CAROT;THIA;RIBO;NIACIN;VITA_C;CHOLE";
			v_nut=gfn_split(v_rtn,";");
			for(i=0;i<20;i++)
			{	
				// 영양가 계산(1 폐기율 적용영양소 계산 2 폐기율 미적용영양소 계산)
				// 1 폐기율 적용영양소 계산
				//trace(v_nut[i]);
				v_col="S_"+v_nut[i];
				v_Price	= 	ds_Item.getCaseSum("RECIPE_CD=="+wrapQuote(ds_Item.getColumn(nRow,"RECIPE_CD")),"NEED_QTY");	// 레시피별 1인량합
				v_Row	=	ds_Menu.findRow("RECIPE_CD",ds_Item.getColumn(nRow,"RECIPE_CD"));
				ds_Menu.setColumn(v_Row, v_col , Math.round(v_Price * ds_Menu.getColumn(v_Row,v_nut[i]),2) );			
				//trace(v_col);
				// 2 폐기율 미적용영양소 계산
				v_col="SS_"+v_nut[i];
				v_Price	= 	ds_Item.getCaseSum("RECIPE_CD=="+wrapQuote(ds_Item.getColumn(nRow,"RECIPE_CD")),"EDIBLE_QTY");	// 레시피별 가식부량
				v_Row	=	ds_Menu.findRow("RECIPE_CD",ds_Item.getColumn(nRow,"RECIPE_CD"));
				ds_Menu.setColumn(v_Row, v_col , Math.round(v_Price * ds_Menu.getColumn(v_Row,v_nut[i]),2) );					
				//trace(v_col);
			}

			break;			
		case "CUR_PRICE":	// 1인원가 식단레시피 마스터그리드 반영
			v_Price	= 	ds_Item.getCaseSum("RECIPE_CD=="+wrapQuote(ds_Item.getColumn(nRow,"RECIPE_CD")),"CUR_PRICE");
			v_Row	=	ds_Menu.findRow("RECIPE_CD",ds_Item.getColumn(nRow,"RECIPE_CD"));
			ds_Menu.setColumn(v_Row,"RECIPE_COST",v_Price);
			break;					
	}
	SetWaitCursor(false);	
}

function tab_main_OnChanged(obj:Tab, e:TabIndexChangeEventInfo)
{
	if (e.postindex == 0) btn_AddItem.visible = true;
	else btn_AddItem.visible = false;

	if(e.postindex==3)
	{
		 tab_main.tab3.div_ImgLoadUrl.img_JoryMethod.image=GF_FILE_SERVER_URL+"upload/img/cook_ctrl/"+v_CurCuisineType+".jpg";
	  	
	}
}

function ds_Item_OnRowPosChanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	v_CurRecipenm=ds_Item.getColumn(e.newrow,"RECIPE_NAME");
	v_CurRecipecd=ds_Item.getColumn(e.newrow,"RECIPE_CD");
	v_CurCuisineType=ds_Item.getColumn(e.newrow,"CUISINE_TYPE");	
}

function tab_main_OnChanging(obj,nOldIndex,nNewIndex)
{
	if(ds_Item.getRowCount()==0 || ds_Menu.getRowCount()==0)
	{
		return false;
	}
	switch(nOldIndex)
	{
		case 0:	// 레시피수정
			break;
		case 1:	// 조리법
			if(gfn_dsIsUpdated(ds_CookMethod)==false)
			{
				return;
			}
			else
			{
				if(g_Confirm("02",fn_AlertMsg("028"))==true)
				{
					if(ds_CookMethod.findRowExpr("gfn_length(gfn_trim(CUISINE_DESC))==0 || gfn_trim(CUISINE_DESC)==null")!=-1)
					{
						//alert(fn_AlertMsg("016"));
						g_Message("EE", fn_AlertMsg("021"));
						return false;
					}
					var v_max=ds_CookMethod.getMax("CUISINE_SEQ");
					if( gfn_trim(v_max)==null || gfn_length(gfn_trim(v_max))==0 )
					{
						v_max=0;
					}
					for(i=0;i<ds_CookMethod.getRowCount();i++)
					{
						if(gfn_length(gfn_trim(ds_CookMethod.getColumn(i,"CUISINE_SEQ")))==0
								|| gfn_trim(ds_CookMethod.getColumn(i,"CUISINE_SEQ"))==null )
						{
							v_max=v_max+1;
							ds_CookMethod.setColumn(i,"CUISINE_SEQ",v_max);
						}
						
					}					
					fn_Pop_Save("COOK");
					return;
				}
			}
			break;
		case 2:	// PHF
			// ds_RecipePhf
			if(gfn_dsIsUpdated(ds_RecipePhf)==false)
			{
				return;
			}
			else
			{
				if(g_Confirm("02",fn_AlertMsg("028"))==true)
				{				
					fn_Pop_Save("PHF");
					return;
				}
			}			
			break;
	}
}

function ds_phf_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	switch(e.row)
	{
		case 0:
			if(e.columnid=="PHF")
			{
				ds_RecipePhf.setColumn(0,"PHF_MGMT1",e.newvalue);
			}
			break;
		case 1:
			if(e.columnid=="PHF")
			{
				ds_RecipePhf.setColumn(0,"PHF_MGMT2",e.newvalue);
			}
			break;
		case 2:
			if(e.columnid=="PHF")
			{			
				ds_RecipePhf.setColumn(0,"PHF_MGMT3",e.newvalue);
			}
			break;
		case 3:
			if(e.columnid=="PHF")
			{			
				ds_RecipePhf.setColumn(0,"PHF_MGMT4",e.newvalue);
			}
			break;
		case 4:
			if(e.columnid=="PHF")
			{		
				ds_RecipePhf.setColumn(0,"PHF_MGMT5",e.newvalue);
			}
			break;
	}
	var v_1=ds_RecipePhf.getColumn(0,"PHF_MGMT1");
	var v_2=ds_RecipePhf.getColumn(0,"PHF_MGMT2");
	var v_3=ds_RecipePhf.getColumn(0,"PHF_MGMT3");
	var v_4=ds_RecipePhf.getColumn(0,"PHF_MGMT4");
	var v_5=ds_RecipePhf.getColumn(0,"PHF_MGMT5");
	
	if( v_1=='Y' && v_2=='N')
	{
		ds_RecipePhf.setColumn(0,"PHF","Y");
	}
	else
	{
		if(v_1=='Y' || v_2=='N')
		{
			if(v_3=='Y' || v_4=='Y' || v_5=='Y')
			{
				ds_RecipePhf.setColumn(0,"PHF","Y");
			}
			else
			{
				ds_RecipePhf.setColumn(0,"PHF","N");
			}
		}
		else
		{
			ds_RecipePhf.setColumn(0,"PHF","N");
		}
	}
}

function grd_RealRecipe_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	var v_row;
	var v_cnt;
	ds_Item.rowposition=ds_Item.findRow("RECIPE_CD",ds_Menu.getColumn(e.row,"RECIPE_CD"));
	switch(e.cell)
	{
		alert('삭제함');
		case 2:
			 if(g_Confirm("01")==false)
			 {
				 return;
			 }
			ds_Menu.deleteRow(e.row);
			
			fn_Pop_Save("ICO_RECIPE_DEL");
			break;		
	}
}

function div_extend_grd_List_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	switch(e.cell)
	{
		case 0:
			gfn_exportExcel(div_extend.grd_List, "Sheet1");
			break;
		case 1:
			if(div_extend.grd_List.userdata)
			{
				div_extend.grd_List.userdata=false;
			}
			else
			{
				div_extend.grd_List.userdata=true;
			}
			Sort(ds_List,"RECIPE_CD",div_extend.grd_List.userdata);
			break;
		case 2:
			if(div_extend.grd_List.userdata)
			{
				div_extend.grd_List.userdata=false;
			}
			else
			{
				div_extend.grd_List.userdata=true;
			}		
			Sort(ds_List,"RECIPE_NAME",div_extend.grd_List.userdata);
			break;
		case 3:
			if(div_extend.grd_List.userdata)
			{
				div_extend.grd_List.userdata=false;
			}
			else
			{
				div_extend.grd_List.userdata=true;
			}		
			Sort(ds_List,"RECIPE_COST",div_extend.grd_List.userdata);
			break;
		case 4:
			if(div_extend.grd_List.userdata)
			{
				div_extend.grd_List.userdata=false;
			}
			else
			{
				div_extend.grd_List.userdata=true;
			}			
			Sort(ds_List,"RECIPE_CLASS",div_extend.grd_List.userdata);
			break;
		case 5:
			if(div_extend.grd_List.userdata)
			{
				div_extend.grd_List.userdata=false;
			}
			else
			{
				div_extend.grd_List.userdata=true;
			}				
			Sort(ds_List,"RECIPE_TYPE",div_extend.grd_List.userdata);
			break;
		case 6:
			if(div_extend.grd_List.userdata)
			{
				div_extend.grd_List.userdata=false;
			}
			else
			{
				div_extend.grd_List.userdata=true;
			}
			Sort(ds_List,"CUISINE_TYPE",div_extend.grd_List.userdata);
			break;
		default:
			//G_GridSort(object(obj.BindDataset), obj, nCell);
			// 가로 머지가 중복으로 소트 정렬이 정상적이지 않아 적용하지 않음
			break;
		// case :
			// break;			
	}	
}

function grd_RealRecipe_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	switch(e.cell)
	{
		case 0:
			gfn_exportExcel(grd_RealRecipe, "Sheet1");
			break;
		case 1:
			if(grd_RealRecipe.userdata)
			{
				grd_RealRecipe.userdata=false;
			}
			else
			{
				grd_RealRecipe.userdata=true;
			}
			Sort(ds_Menu,"RECIPE_SEQ",grd_RealRecipe.userdata);
			break;
		case 2:
			if(grd_RealRecipe.userdata)
			{
				grd_RealRecipe.userdata=false;
			}
			else
			{
				grd_RealRecipe.userdata=true;
			}		
			Sort(ds_Menu,"RECIPE_CD",grd_RealRecipe.userdata);
			break;
		case 3:
			if(grd_RealRecipe.userdata)
			{
				grd_RealRecipe.userdata=false;
			}
			else
			{
				grd_RealRecipe.userdata=true;
			}		
			Sort(ds_Menu,"RECIPE_NAME",grd_RealRecipe.userdata);
			break;
		case 4:
			if(grd_RealRecipe.userdata)
			{
				grd_RealRecipe.userdata=false;
			}
			else
			{
				grd_RealRecipe.userdata=true;
			}			
			Sort(ds_Menu,"DISH_INFO",grd_RealRecipe.userdata);
			break;
		case 5:
			if(grd_RealRecipe.userdata)
			{
				grd_RealRecipe.userdata=false;
			}
			else
			{
				grd_RealRecipe.userdata=true;
			}				
			Sort(ds_Menu,"RECIPE_COST",grd_RealRecipe.userdata);
			break;
		case 6:
			if(grd_RealRecipe.userdata)
			{
				grd_RealRecipe.userdata=false;
			}
			else
			{
				grd_RealRecipe.userdata=true;
			}
			Sort(ds_Menu,"RECIPE_COLOR",grd_RealRecipe.userdata);
			break;
		case 7:
			if(grd_RealRecipe.userdata)
			{
				grd_RealRecipe.userdata=false;
			}
			else
			{
				grd_RealRecipe.userdata=true;
			}
			Sort(ds_Menu,"CAL",grd_RealRecipe.userdata);
			break;
		case 8:
			if(grd_RealRecipe.userdata)
			{
				grd_RealRecipe.userdata=false;
			}
			else
			{
				grd_RealRecipe.userdata=true;
			}
			Sort(ds_Menu,"CARBO",grd_RealRecipe.userdata);
			break;
		case 9:
			if(grd_RealRecipe.userdata)
			{
				grd_RealRecipe.userdata=false;
			}
			else
			{
				grd_RealRecipe.userdata=true;
			}
			Sort(ds_Menu,"PROT",grd_RealRecipe.userdata);
			break;
		case 10:
			if(grd_RealRecipe.userdata)
			{
				grd_RealRecipe.userdata=false;
			}
			else
			{
				grd_RealRecipe.userdata=true;
			}
			Sort(ds_Menu,"FAT",grd_RealRecipe.userdata);
			break;
		case 11:
			if(grd_RealRecipe.userdata)
			{
				grd_RealRecipe.userdata=false;
			}
			else
			{
				grd_RealRecipe.userdata=true;
			}
			Sort(ds_Menu,"VITA_A",grd_RealRecipe.userdata);
			break;
		case 12:
			if(grd_RealRecipe.userdata)
			{
				grd_RealRecipe.userdata=false;
			}
			else
			{
				grd_RealRecipe.userdata=true;
			}
			Sort(ds_Menu,"THIA",grd_RealRecipe.userdata);
			break;
		case 13:
			if(grd_RealRecipe.userdata)
			{
				grd_RealRecipe.userdata=false;
			}
			else
			{
				grd_RealRecipe.userdata=true;
			}
			Sort(ds_Menu,"RIBO",grd_RealRecipe.userdata);
			break;
		case 14:
			if(grd_RealRecipe.userdata)
			{
				grd_RealRecipe.userdata=false;
			}
			else
			{
				grd_RealRecipe.userdata=true;
			}
			Sort(ds_Menu,"VITA_C",grd_RealRecipe.userdata);
			break;
		case 15:
			if(grd_RealRecipe.userdata)
			{
				grd_RealRecipe.userdata=false;
			}
			else
			{
				grd_RealRecipe.userdata=true;
			}
			Sort(ds_Menu,"CA",grd_RealRecipe.userdata);
			break;
		case 16:
			if(grd_RealRecipe.userdata)
			{
				grd_RealRecipe.userdata=false;
			}
			else
			{
				grd_RealRecipe.userdata=true;
			}
			Sort(ds_Menu,"FE",grd_RealRecipe.userdata);
			break;
		default:
			//G_GridSort(object(obj.BindDataset), obj, nCell);
			// 머지셀로 이상동작
			break;
		// case :
			// break;			
	}	
}

function cbo_RecipeType_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	if(e.postindex==0)
	{
		ds_CookClass.filter("");
	}
	else
	{
		ds_CookClass.filter("gfn_length(gfn_trim(SET1))==0 || SET1=='"+e.postvalue+"'");
	}
}

function cbo_RecipeNM_OnChar(obj:Combo, e:CharEventInfo)
{
	/* 변경 전 */
	//obj.UserData = trim(strPostText);
	
	/* 변경 후 */
	if (e.chartext == 13) {
		btn_SubSearch.setFocus();
		btn_SubSearch.click();
		cbo_RecipeNM.setFocus();
	} else {
		obj.userdata = e.posttext;
	}
}

function common_OnKeyDown(obj:Combo, e:KeyEventInfo)
{
	switch(e.keycode)
	{
		case 13:	// Enter
			switch(obj.name)
			{
				case "cbo_RecipeNM":
					var objDS=eval(obj.innerdataset);
					if(e.keycode==13)
					{
						if(gfn_length(gfn_trim(obj.userdata))!= 0 )
						{
							if(objDS.findRow("NM",gfn_trim(obj.userdata))==-1)
							{
								objDS.addRow();
								objDS.setColumn(objDS.rowposition,"NM",gfn_trim(obj.userdata));
								//div_Reci.cbo_RecipeNM.Value=trim(div_Reci.cbo_RecipeNM.UserData);
								var v_index=objDS.findRow("NM",obj.userdata);
								obj.index=v_index;
								/* Idle은 지원되지 않는 메서드입니다.*/ Idle();
							}
						}
						btn_SubSearch.click();
						obj.userdata="";
					}
					break;
				default :
					break;
			}
			var v_nComp=GetNextComponent(null);
			v_nComp.setFocus();			
			break;
		case 46:	// del
			if(GetType(obj)=="Combo")
			{
				obj.index=-1;
				cbo_RecipeType_OnChanged(obj,"","","",0);				
			}
			else
			{
				obj.text="";
				obj.value="";
			}
			break;
	}
}

function grd_RealRecipe_OnMouseOver(obj:Grid, e:GridMouseEventInfo)
{
	if(e.row>=0 && e.cell==4)
	{
		if(gfn_length(gfn_trim(ds_Menu.getColumn(e.row,"RECIPE_NAME")))>7)
		{
			grd_RealRecipe.tooltiptext=ds_Menu.getColumn(e.row,"RECIPE_NAME");
		}
		else
		{
			grd_RealRecipe.tooltiptext="";
		}
	}
	else if(e.row>=0 && e.cell==2)
	{
		grd_RealRecipe.tooltiptext="삭제";
	}
	else
	{
		grd_RealRecipe.tooltiptext="";
	}
}

function cbo_RecipeClass_OnKillFocus(obj)
{
	/* 변경 후 */
	var strValue,nFRow,objDs,strDataColumn;
	
	strValue 		= obj.userdata;
	objDs			= obj.innerdataset;
	strDataColumn	= obj.datacolumn;
	
	if (gfn_length(strValue)==0) return;
	
	nFRow = eval(objDs).findRow(strDataColumn,strValue);
	
	if (nFRow == -1)
	{
		var nRow = eval(objDs).addRow();
		eval(objDs).setColumn(nRow,strDataColumn,strValue);
		obj.value = strValue;
	}
}

function cbo_RecipeNM_OnKillFocus(obj:Combo, e:KillFocusEventInfo)
{
    var strValue,nFRow,objDs,strDataColumn;
	
	strValue 		= obj.userdata;
	objDs			= eval(obj.innerdataset);
	strDataColumn	= obj.datacolumn;
	
	if (gfn_length(strValue) > 0) {
		nFRow = objDs.findRow(strDataColumn,strValue);
		
		if (nFRow == -1)
		{
			var nRow = objDs.addRow();
			objDs.setColumn(nRow,strDataColumn,strValue);
			obj.value = strValue;
		} else {
			obj.value = strValue;
		}
	} else {
		obj.index 		= 0;
	}
} 
  
function cbo_RecipeNM_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	//trace("obj.userchange=="+obj.userchange+":::::e.pretext=="+e.pretext+"::::::e.posttext=="+e.posttext);
	if ( obj.userchange == "2" ) {
		obj.userchange = "0";
		obj.userdata   = e.posttext;
		
		btn_SubSearch.setFocus();
		btn_SubSearch.click();
		cbo_RecipeNM.setFocus();
	} else {
		obj.userchange = "1";
		obj.userdata = e.posttext;
	}
}

function cbo_RecipeNM_onkeydown(obj:Combo, e:KeyEventInfo)
{
if (e.keycode == 13 && obj.userchange == "1") {
		var strValue,nFRow,objDs,strDataColumn;
		
		strValue 		= obj.userdata;
		objDs			= eval(obj.innerdataset);
		strDataColumn	= obj.datacolumn;
		
		if (gfn_length(strValue)>0) {
			nFRow = objDs.findRow(strDataColumn,strValue);
			
			if (nFRow == -1)
			{
				var nRow = objDs.addRow();
				objDs.setColumn(nRow,strDataColumn,strValue);
				obj.index = nRow;
			} else {
				obj.index = nFRow;
			}
		}
		btn_SubSearch.setFocus();
		btn_SubSearch.click();
		cbo_RecipeNM.setFocus();
		
	} else if (e.keycode == 38 || e.keycode == 40) {
		if ( obj.isDropdown() ) {
			obj.userchange = "2";
		} else {
			obj.userchange = "1";
		}
	}
}

function cbo_RecipeNM_ontextchanged(obj:Combo, e:TextChangedEventInfo)
{
	obj.userdata   = e.posttext;
	obj.userchange = "1";
}


function fn_getColorImage(COLOR) {


var ImagePath = "URL('theme://convertImages/"+COLOR+".bmp')";

//trace(ImagePath);

return ImagePath;

}

function fn_getBackImage(COND,VAL) {

    var BackImg = '';
    if(COND == 'DI_MON') {
		if(VAL == 1) {
		
		   BackImg = "URL('theme://images/new/grd_WF_N.png')";
		
		} else {
		   BackImg = '';
		}
		
	 //   trace(BackImg);
	} 
	
	//trace(ds_List.saveXML());
    
    return BackImg;

}

function fn_getBackImage1(COND,VAL) {

    var BackImg1 = '';
    if (COND == 'PHF') {
	      if(VAL == 'Y') {
	      
	           BackImg1 = "URL('theme://images/new/grd_WF_P.png')";
		
	      } else {
		       BackImg1 = '';
		  }
    }
    
    return BackImg1;

}  

function fn_callbackDelete(){
	g_Message("EE","삭제되었습니다.");
		return;
}

// 레시피 상세 아이템 삭제
function fn_callbackItemDelete(errCode, errMsg){
	if( errCode != 0 ) {
		return;
	} else {
		g_Message("EE","삭제되었습니다.");
		// 재조회
		tab_main.tab0.fn_T1_Search();
	}
}


// 레시피 삭제 후 CallBack 처리
function fn_callbackRecipeDelete(errCode, errMsg)
{	
	if( errCode != 0 ) {
		return;
	} else {
		g_Message("EE","삭제되었습니다.");
		// 재조회
		tab_main.tab0.fn_T1_Search();
	}
}




function fn_callbackSave(){
	g_Message("EE","저장되었습니다.");
		return;
}

// 저장 후 재조회
function fn_callbackAllSave(){
	var arg="";

	//g_Message("EE","저장되었습니다.");
	
	arg		="MEAL="			+wrapQuote(cbo_DinGbn.value)
			+" CORNER="			+wrapQuote(cbo_CornGbn.value)
			+" MENU_DATE="		+wrapQuote(me_GiveDay.value)
			+" MENU_CLASS="		+wrapQuote(cbo_MenuClass.value)
			+" COST_TYPE="		+wrapQuote(cbo_CostType.value)
			+" MENU_TYPE="		+wrapQuote(cbo_MenuType.value); 
	
	fsp_clear(this);
	fsp_addSearch(this,"fm/fmm:FMM00400E_S008");
	http.Sync=true;
	fsp_callService(this,"","","","ds_Menu=ds_Menu",arg,"fn_call_back","",true);
	http.Sync=false;
	if(ds_Menu.getRowCount()>0)
	{
		tab_main.tab0.fn_T1_Search();
	}
}






//  상품추가 버튼 클릭
function btn_AddItem_OnClick(obj:Button,  e:ClickEventInfo)
{
	if(ds_Item.getRowCount()==0)
	{
		return;
	}

	var v_re="";
	var v_cnt="";
	for(i=0;i<ds_Item.getRowCount();i++)
	{
		if(ds_Item.getSelect(i)==true)
		{
			v_cnt=ds_Item.findRow("RECIPE_CD", ds_Item.getColumn(i,"RECIPE_CD"));
			ds_Item.clearSelect();
			ds_Item.selectRow(v_cnt, true);		
		}
	}	
	
	
	var arg	= {GUBUN:"ADD"	//자재추가 구분  --버튼 구분입니다.
	          ,RECIPE_CD:ds_Item.getColumn(ds_Item.rowposition,"RECIPE_CD")
	          ,TERM_MENU_CD:ds_Item.getColumn(ds_Item.rowposition,"TERM_MENU_CD")
	          ,RECIPE_NAME:ds_Item.getColumn(ds_Item.rowposition,"RECIPE_NAME")
	          ,ITEM_CODE:ds_Item.getColumn(ds_Item.rowposition,"ITEM_CODE")
	          ,ITEM_NAME:ds_Item.getColumn(ds_Item.rowposition,"ITEM_NAME")
	          ,OBJ_DS_ITEM:ds_Item
	          ,OBJ_DS_MENU:ds_Menu
	          };
	          
	//trace(arg);
	var rtn=gfn_dialog("", "U_FMM::FMM00400P.xfdl",arg);
	rtn=gfn_split(rtn,";");
	//trace("rtn="+rtn[0]);
	if(rtn[0]==1)
	{
		//fn_Pop_Search();
	}
	
	
	
}


// 아이템 변경 시
function ds_Item_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	var v_Qty;
	
    switch(e.columnid)
    {
		case "NEED_QTY" :		// 1인 G
			if (toNumber(ds_Item.getColumn(e.row,"DISUSE_RATE") == 0)) v_Qty = ds_Item.getColumn(e.row, "NEED_QTY");
			else v_Qty = gfn_round(toNumber(ds_Item.getColumn(e.row, "NEED_QTY")) * (100.0 - toNumber(ds_Item.getColumn(e.row,"DISUSE_RATE"))) ,2);
			ds_Item.setColumn(e.row,"EDIBLE_QTY",v_Qty);
			break;
			
	}	
}
]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="form" onload="form_onload" titletext="보존식TAG조회" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static29" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 97" anchor="left top right"/>
        <Combo codecolumn="HALL_CD" datacolumn="HALL_NAME" id="cbo_upjang_hall" index="0" innerdataset="ds_upjang_hall" onitemchanged="cbo_upjang_hall_OnChanged" taborder="3" tooltiptext="식당명" position="absolute 352 40 508 61"/>
        <Static id="st10" text="사업장" position="absolute 15 41 89 62" class="sta_WFSA_label"/>
        <Static id="Static1" text="식당명" position="absolute 298 41 372 62" class="sta_WFSA_label"/>
        <Static id="Static2" text="제공일" position="absolute 838 41 904 62" class="sta_WFSA_label"/>
        <Static id="Static0" text="코너" position="absolute 688 41 754 62" class="sta_WFSA_label"/>
        <Combo codecolumn="CORNER" datacolumn="CORNER_NAME" id="cbo_upjang_hall_corner" index="0" innerdataset="ds_upjang_hall_corner" taborder="5" tooltiptext="코너" position="absolute 729 40 808 61"/>
        <Combo codecolumn="MEAL" datacolumn="MEAL_NAME" id="cbo_upjang_hall_meal" index="0" innerdataset="ds_upjang_hall_meal" onitemchanged="cbo_upjang_hall_meal_OnChanged" taborder="4" position="absolute 579 40 658 61"/>
        <Static id="Static6" text="끼니" position="absolute 538 41 608 62" class="sta_WFSA_label"/>
        <Static id="Static4" text="담당자 일괄등록" position="absolute 15 68 129 89" class="sta_WFSA_label"/>
        <Edit id="ed_MAIN_USER" taborder="6" tooltiptext="담당자" position="absolute 128 66 268 87" imemode="hangul"/>
        <Static id="Static7" text="폐기일 자동세팅 시 휴무일등으로 인해 정보가 정확하지 않을 수 있으니 확인바랍니다." position="absolute 592 69 1154 90" class="sta_WF_DiscPoint" anchor="top right" style="border:1 none transparent ;"/>
        <Button id="btn_Excel" onclick="btn_Excel_OnClick" taborder="18" text="Excel" position="absolute 1159 66 1220 87" class="btn_WF_Custom" image="" anchor="top right"/>
        <MaskEdit id="cal_START_DATE" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkeydown="ed_pop_OnKeyDown" onkillfocus="g_Date_OnKillFocus" taborder="19" type="string" userdata="btn_START_DATE" position="absolute 892 40 971 61" canchange="cal_START_DATE_OnChanged"/>
        <Button id="btn_START_DATE" onclick="g_CalButton_OnClick" taborder="20" userdata="cal_START_DATE" position="absolute 970 40 992 61" class="btn_WF_cal" text="" image=""/>
        <MaskEdit id="cal_END_DATE" mask="####-##-##" ontextchanged="cal_END_DATE_OnChanged" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkeydown="ed_pop_OnKeyDown" onkillfocus="g_Date_OnKillFocus" taborder="21" type="string" userdata="btn_END_DATE" position="absolute 1008 40 1087 61"/>
        <Button id="btn_END_DATE" onclick="g_CalButton_OnClick" taborder="22" userdata="cal_END_DATE" position="absolute 1086 40 1108 61" class="btn_WF_cal" text="" image=""/>
        <Static id="Static8" text="~" position="absolute 995 42 1004 63"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="25" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 1 97 451 110"/>
        <Static id="Static34" text="W10" visible="false" position="absolute 61 30 71 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static35" text="W30" visible="false" position="absolute 268 40 298 87" style="background:#ff000055;align:center middle;"/>
        <Static id="Static43" text="W10" visible="false" position="absolute 0 30 1237 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static44" text="W10" visible="false" position="absolute 0 87 1237 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static45" text="W15" visible="false" position="absolute 0 30 15 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static51" text="W05." visible="false" position="absolute 0 61 1237 66" style="background:#ff000055;align:center middle;"/>
        <Static id="Static14" text="W10" visible="false" position="absolute 342 30 352 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static17" text="W30" visible="false" position="absolute 508 40 538 87" style="background:#ff000055;align:center middle;"/>
        <Static id="Static18" text="W10" visible="false" position="absolute 569 30 579 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static19" text="W30" visible="false" position="absolute 658 40 688 87" style="background:#ff000055;align:center middle;"/>
        <Static id="Static20" text="W10" visible="false" position="absolute 719 30 729 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static21" text="W30" visible="false" position="absolute 808 40 838 87" style="background:#ff000055;align:center middle;"/>
        <Static id="Static23" text="W10" visible="false" position="absolute 882 30 892 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static03" text="W10" visible="false" position="absolute 118 30 128 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static05" text="W10" visible="false" position="absolute 1220 30 1237 97" style="background:#ff000055;align:center middle;"/>
        <Grid id="grd_list_Pivot" taborder="26" tabstop="false" binddataset="ds_list_pivot" scrollbars="alwayshorz" wheelscrollrow="1" autoenter="select" useinputpanel="false" position="absolute 0 110 1237 710" anchor="all" selecttype="cell" style="padding:5 0 5 0;" autofittype="none">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="178"/>
              </Columns>
              <Rows>
                <Row size="22" band="head"/>
                <Row size="18"/>
                <Row size="18"/>
                <Row size="18"/>
                <Row size="18"/>
                <Row size="18"/>
                <Row size="18"/>
              </Rows>
              <Band id="head">
                <Cell expr="expr:gfn_subStr(MENU_DATE,6,2)+ &quot;일&quot;"/>
              </Band>
              <Band id="body">
                <Cell style="align:EXPR(iff(MENU_DATE == '보존TAG', 'center','left'));line: ;background:EXPR(iff(MENU_DATE == '보존TAG', 'black','white'));color:EXPR(iif(MENU_DATE == '보존TAG', 'white','black'));font:arial,9,bold;" text="보존식TAG"/>
                <Cell row="1" edittype="normal" style="align:left;line: ;" text="bind:MAIN_USER"/>
                <Cell row="2" style="align:left;line: ;" text="bind:GUBUN"/>
                <Cell row="3" edittype="normal" style="align:left;line: ;" text="bind:START_TIME"/>
                <Cell row="4" displaytype="text" edittype="normal" style="align:left;line: ;" text="bind:RECIPE_INFO" wordwrap="both"/>
                <Cell row="5" edittype="normal" style="align:left;line: ;" text="bind:DISUSE_TIME"/>
              </Band>
            </Format>
            <Format id="B">
              <Columns>
                <Column band="left" size="71"/>
                <Column size="105"/>
                <Column size="35"/>
              </Columns>
              <Rows>
                <Row size="22" band="head"/>
                <Row size="18"/>
              </Rows>
              <Band id="head">
                <Cell col="0" displaytype="text" class="head_Excel"/>
                <Cell col="1" displaytype="text" expr="expr:gfn_subStr(MENU_DATE,6,2)+ &quot;일&quot;"/>
                <Cell col="2" text="Kcal"/>
              </Band>
              <Band id="body">
                <Cell col="0" displaytype="text" expr="expr:MEAL_NAME+CORNER_NAME" suppress="1" style="align:center;"/>
                <Cell col="1" text="bind:RECIPE_NAME" displaytype="text" subsumtext="*****" style="align:expr:iif(getRowLevel(currow)==1,'right');"/>
                <Cell col="2" text="bind:RECIPE_CAL" displaytype="number" style="align:right;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Spin id="sp_disuseDt" taborder="27" position="absolute 409 66 508 87" value="6" style="align:right middle;" max="30" min="1"/>
        <Static id="Static09" text="폐기일 자동세팅" class="sta_WFSA_label" position="absolute 298 66 404 87"/>
        <UpjangSearchComponent id="ed_UPJANG_NM" titletext="업장 검색용 Component" taborder="28" text="UpjangSearchComponent00" position="absolute 71 40 268 61" tooltiptext="입고업장" bindDataset="ds_input" bindUpjangCodeColumn="UPJANG" bindUpjangNameColumn="UPJANG_NM" eventBeforeTrigger="" eventAfterTrigger="fn_upjang_chang" roleSetId="ScoAuthLevel01"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_upjang_hall"/>
      <Dataset id="ds_input" oncolumnchanged="ds_input_oncolumnchanged">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="UPJANG_NM" size="256" type="STRING"/>
          <Column id="HALL_CD" size="256" type="STRING"/>
          <Column id="MEAL" size="256" type="STRING"/>
          <Column id="CORNER" size="256" type="STRING"/>
          <Column id="MENU_DATE" size="256" type="STRING"/>
          <Column id="MENU_SDATE" size="256" type="STRING"/>
          <Column id="MENU_EDATE" size="256" type="STRING"/>
          <Column id="MAIN_USER" size="256" type="STRING"/>
          <Column id="DISUSE_DATE" size="8" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CORNER"/>
            <Col id="HALL_CD"/>
            <Col id="MAIN_USER"/>
            <Col id="MEAL"/>
            <Col id="MENU_DATE"/>
            <Col id="MENU_EDATE"/>
            <Col id="MENU_SDATE"/>
            <Col id="UPJANG"/>
            <Col id="UPJANG_NM"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_upjang_hall_corner">
        <ColumnInfo>
          <Column id="CORNER" size="256" type="STRING"/>
          <Column id="CORNER_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CORNER"/>
            <Col id="CORNER_NAME"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_upjang_hall_meal">
        <ColumnInfo>
          <Column id="MEAL" size="256" type="STRING"/>
          <Column id="MEAL_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="MEAL"/>
            <Col id="MEAL_NAME"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list">
        <ColumnInfo>
          <Column id="TEMP_GROUP_KEY" size="8" type="STRING"/>
          <Column id="MENU_DATE" size="8" type="STRING"/>
          <Column id="PDATE" type="STRING" size="256"/>
          <Column id="MENU_CD" size="20" type="STRING"/>
          <Column id="MEAL" size="20" type="STRING"/>
          <Column id="CORNER" size="20" type="STRING"/>
          <Column id="MAIN_USER" size="13" type="STRING"/>
          <Column id="GUBUN" size="217" type="STRING"/>
          <Column id="GUBUN2" type="STRING" size="256"/>
          <Column id="START_TIME" size="27" type="STRING"/>
          <Column id="START_TIME2" type="STRING" size="256"/>
          <Column id="RECIPE_INFO" size="4000" type="STRING"/>
          <Column id="DISUSE_TIME" size="27" type="STRING"/>
          <Column id="DISUSE_TIME2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_pivot" keystring="TEMP_GROUP_KEY:MEAL:CORNER"/>
      <Dataset id="ds_head">
        <ColumnInfo>
          <Column id="MENU_DATE" size="8" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_date">
        <ColumnInfo>
          <Column id="MENU_DATE" size="8" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_pivot_reverse">
        <ColumnInfo>
          <Column id="PDATE" type="STRING" size="256"/>
          <Column id="GUBUN" type="STRING" size="256"/>
          <Column id="RECIPE_INFO" type="STRING" size="256"/>
          <Column id="NM_KOR" type="STRING" size="256"/>
          <Column id="START_TIME" type="STRING" size="256"/>
          <Column id="DISUSE_TIME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="cbo_upjang_hall_value" compid="cbo_upjang_hall" propid="value" datasetid="ds_input" columnid="HALL_CD"/>
      <BindItem id="cbo_upjang_hall_corner_value" compid="cbo_upjang_hall_corner" propid="value" datasetid="ds_input" columnid="CORNER"/>
      <BindItem id="cbo_upjang_hall_meal_value" compid="cbo_upjang_hall_meal" propid="value" datasetid="ds_input" columnid="MEAL"/>
      <BindItem id="ed_MAIN_USER_value" compid="ed_MAIN_USER" propid="value" datasetid="ds_input" columnid="MAIN_USER"/>
      <BindItem id="cal_START_DATE_value" compid="cal_START_DATE" propid="value" datasetid="ds_input" columnid="MENU_SDATE"/>
      <BindItem id="cal_END_DATE_value" compid="cal_END_DATE" propid="value" datasetid="ds_input" columnid="MENU_EDATE"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : IFIS/식단관리/식단표조회  
 * 프로그램명   : 단체급식 - 식단표조회
 * 기      능   : 보존식 TAG 조회
 * 작  성  자   : 한화 S&C SI 사업부 프로젝트 팀 박종세
 * 작성  일자   : 2008-02-25
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//========================================================================================= 
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"		// 사업장팝업용 Lib
//@@컨버터에서 주석처리 #include "lib::fs_common.js"

//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	   //폼 초기화
		fn_InitForm(obj);
}

//폼 초기화
function fn_InitForm(obj)
{
	// action 정보 생성 초기화 
	fsp_init(this);	
	
	// 폼 데이터 초기화
	fn_InitData(false);
}

// 폼데이터 초기화 
function fn_InitData(blnAllClear)
{
	this.cal_START_DATE.value=gfn_today();
	this.cal_END_DATE.value=gfn_addDate(gfn_today(),6);
	
// 	//로그인한 사용자 업장 셋팅
// 	ds_input.setColumn(0,"UPJANG",g_Upjang);	
// 	ds_input.setColumn(0,"UPJANG_NM",g_UpjangNm);	
	fn_upjang_chang();
		
	//초기화 후
//	fn_After_InitData();
}

//초기화 콜백함수
function fn_After_InitData()
{
    //식당조회
	fn_Upjang_HallSearch();
}

//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*------------------------------------------------------------
	1. Function ID : fn_Search()
	2. 개       요 : 업무프로세스에 따른 조회작업
	3. 기       능 : 검색버튼 입력 시 처리되는 작업
	4. 인 수 설 명:
*------------------------------------------------------------*/
function fn_search()
{

	  //필수 입력사항 체크-----------------------------------------------------------------------
	   if (!fn_Chk_SearchKey()) return false;

	   
	  //조회 조건만들기-----------------------------------------------------------------------
	   var otherArg;
	   otherArg		= otherArg + " UPJANG="+gfn_nvl(ds_input.getColumn(0,"UPJANG"));
	   otherArg		= otherArg + " HALL_CD="+gfn_nvl(cbo_upjang_hall.value);
	   otherArg		= otherArg + " HALL_NAME="+gfn_nvl(cbo_upjang_hall.text);
	   otherArg		= otherArg + " MAIN_USER="+gfn_nvl(ed_MAIN_USER.value);
	   otherArg		= otherArg + " MEAL="+gfn_nvl(cbo_upjang_hall_meal.value);
	   otherArg		= otherArg + " CORNER="+gfn_nvl(cbo_upjang_hall_corner.value);
	   otherArg		= otherArg + " START_DATE="+gfn_nvl(cal_START_DATE.value);
	   otherArg		= otherArg + " END_DATE="+gfn_nvl(cal_END_DATE.value);
	   otherArg		= otherArg + " ADD_DISUSE_DATE="+sp_disuseDt.value;

	  // action 정보 삭제 초기화 
	   fsp_clear(this);

	  // 서버에서 조회할 정보 추가 ->>>>메뉴 레시피원가(chk_SEARCH_ALL가 UNCHECK이면 원가 조회안함.)
	  fsp_addSearch(this, "fs/fsm:FSM00332R_S001");
		
	  ds_list.clearData();
	  
	  /*
	  if ( this.isValidObject(objPivotHeadDs) ) {
		//ds_list_PivotHead.clearData();
		objPivotHeadDs.clearData();
	  }
	  */
	  
	  ds_list_pivot.clearData();
	  ds_list_pivot_reverse.clearData();
	  
	  //trace(otherArg);

	  // 서버 호출 
	  http.Sync = true;
	  fsp_callService(this, "", "", "", "ds_list=ds_list" , otherArg, "fn_After_Search");	
	  //조회 실행-----------------------------------------------------------------------------
	  http.Sync = false;
	  
	
}

// 조회 후 콜백 함수 
function fn_After_Search(errCode, errMsg)
{
	if( errCode != 0 ) {
		return;
	} else { 
	  ds_list.applyChange();	  
	  fn_crossTab(ds_list, grd_list_Pivot);
	}
}

// 조회 조건 검색
function fn_Chk_SearchKey()
{
   //체크로직- 틀리면 return false;    
   return true;
} 


/*------------------------------------------------------------
	1. Function ID : fn_Print()
	2. 개       요 : 업무프로세스에 따른 인쇄 처리
	3. 기       능 : 인쇄버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*------------------------------------------------------------*/
function fn_print()
{
	if(ds_list.getRowCount() == 0){
		g_Message("EE","출력할 데이터가 없습니다!");
		return;
	}	
	  
	fn_reverse_pivot_date();
	//trace(ds_list_pivot_reverse.saveXML());
	//trace(SCReport.makeReportXml (ds_list_pivot_reverse));
	
	//레포트에 전달할 파라메터 생성
	var arrParams	= SCReport.newParams ();
	SCReport.setParams (arrParams, SCReport.RPT_NAME	, "/IFIS/FSM00332R_R01.ozr");
	SCReport.setParams (arrParams, SCReport.RPT_TITLE	, "보존식TAG");
	SCReport.setParams (arrParams, SCReport.RPT_ODINAME	, "FSM00332R_R01");
	SCReport.setParams (arrParams, "zoom", 150);
	
	
	//클라이언트 바인딩 설정
	var strData = SCReport.makeReportXml (ds_list_pivot_reverse);
	//trace(ds_list_pivot_reverse.saveXML());
	//trace(SCReport.makeReportXml (ds_list_pivot_reverse));
	
	SCReport.setClientBind (arrParams, strData);
	SCReport.viewReport (this, arrParams);
}

function fn_reverse_pivot_date()
{
	var nRow=0;
	
	ds_list_pivot_reverse.clearData();
	//this.ds_list_PivotHead.clearData();
	
	//trace(ds_list_PivotHead.saveXML());
	//trace(ds_list_Pivot.saveXML());
	
	for(var i=0; i < this.ds_list_PivotHead.getColCount(); i++)
	{		
		for(var j=0; j < this.ds_list_Pivot.rowcount/6; j ++)
		{
			nRow = ds_list_pivot_reverse.addRow();
			
			var sDay = gfn_replace(this.ds_list_PivotHead.getColumn(0, i), "_", "-");
			sDay = gfn_subStr(sDay, 0, 10) +" ("+ gfn_subStr(sDay, 10, 2) + ")";
			//trace("sDay:"+gfn_subStr(sDay, sDay.length-3,sDay.length-2));
			
 			ds_list_pivot_reverse.setColumn(nRow, "PDATE", sDay);
 			//요일별 배경색구분 추가 20181228 김호석
// 			ds_list_pivot_reverse.setColumn(nRow, "PDAY", gfn_subStr(sDay, sDay.length-3,sDay.length-2)); 			
 			ds_list_pivot_reverse.setColumn(nRow, "NM_KOR"		, this.ds_list_Pivot.getColumn(1 + (6 * j), i));
 			//trace("NM_KOR : " +this.ds_list_Pivot.getColumn(1 + (6 * j), i));
 			
 			ds_list_pivot_reverse.setColumn(nRow, "GUBUN"		, gfn_replace(this.ds_list_Pivot.getColumn(2 + (6 * j), i), cbo_upjang_hall.text, ""));
 			
 			var sTime = this.ds_list_Pivot.getColumn(3 + (6 * j), i);
			sTime = gfn_subStr(sTime, 11, 5);
			ds_list_pivot_reverse.setColumn(nRow, "START_TIME"	, sTime);
			
 			ds_list_pivot_reverse.setColumn(nRow, "RECIPE_INFO"	, this.ds_list_Pivot.getColumn(4 + (6 * j), i));
 			
 			var sDisuse = this.ds_list_Pivot.getColumn(5 + (6 * j), i)
			sDisuse = gfn_subStr(sDisuse, 0, 10) + "(" + gfn_subStr(sDisuse, 11, 1) + ")" + gfn_subStr(sDisuse, 12, 9);
			ds_list_pivot_reverse.setColumn(nRow, "DISUSE_TIME"	, sDisuse);
		}
	}
}

/*------------------------------------------------------------
	1. Function ID : fn_Close()
	2. 개       요 : 업무프로세스에 따른 폼 종료 
	3. 기       능 : 닫기버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*------------------------------------------------------------*/
function fn_Close()
{
	this.close();
}

/*------------------------------------------------------------
	1. Function ID : fn_Help()
	2. 개       요 : 업무프로세스에 따른 도움말 
	3. 기       능 : 도움말버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*------------------------------------------------------------*/
function fn_help()
{
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================


/*
 ******************************************************************************************
 * 함  수  명   : btn_UPJANG_OnClick(obj)
 * 기      능   : 사업장 조회
 * 작  성  자   : 박종세
 * 작성  일자   : 2007-12-03  
 ******************************************************************************************
 */
// function btn_UPJANG_OnClick(obj:Button, e:ClickEventInfo)
// {
// 	fn_sql_common_setup(fn_MakeUpjangSQL(), 
// 						strMAQuery_UpjangKeyField, 
// 						strMAQuery_UpjangValueField, 
// 						strMAQuery_UpjangKeyFieldNM, 
// 						strMAQuery_UpjangValueFieldNM, 
// 						"", 
// 						"",
// 						"",   // 팀 비교
// 						strMAQuery_UpjangCaption,
// 						"UPJANG;UPJANGNM");
// 		
//     if (gds_sql_common.getColumn(0, "ret_code") != "")
//     {
// 		ds_input.setColumn(0,"UPJANG",gds_sql_common.getColumn(0, "ret_code"));
// 		ds_input.setColumn(0,"UPJANG_NM",gds_sql_common.getColumn(0, "ret_name"));
// 		
// 		//업장의 식당을 찾는다.
// 		fn_Upjang_HallSearch();
// 
// 		//ds_upjang_hall.Filter("UPJANG=" + quote(gds_sql_common.GetColumn(0, "ret_code")));
// 		//cbo_upjang_hall.Index = 0;
// 		cbo_upjang_hall.setFocus();
//     }
//     else
//     {
//     	ds_input.setColumn(0,"UPJANG","");
// 		ds_input.setColumn(0,"UPJANG_NM","");
// 		ds_upjang_hall.filter("");
//     }
// }

// function ed_UPJANG_NM_OnKeyDown(obj:Edit, e:KeyEventInfo)
// {
// 	if(e.keycode == "13") {
// 		btn_UPJANG.click();
// 		return;
// 	}	
// }

// function ed_UPJANG_NM_OnChanged(obj:Edit, e:TextChangedEventInfo)
// {
// 	
// }

function fn_upjang_chang()
{
	fn_Upjang_HallSearch();
}
 

/*
 ******************************************************************************************
 * 함  수  명   : fn_Upjang_HallSearch()
 * 기      능   : 식당 정보를 콤보에 연결
 * 작  성  자   : 박종세
 * 작성  일자   : 2007-12-20 
 ******************************************************************************************
 */
function fn_Upjang_HallSearch()
{
	// 식당 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "";
	outData			= "ds_upjang_hall=gds_Csqlout";
	callBackFnc		= "fn_Upjang_HallSearch_After";
	otherArg		= "UPJANG="+wrapQuote(ds_input.getColumn(0,"UPJANG"));

	fsp_clear(this); 
    fsp_addSearch(this, "fs/fsc:FSA_HALL_MST_S001");								// 조회 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
	http.Sync = false;
	
	// 초기값 셋팅
	cbo_upjang_hall.index = 0;
	
	// 끼니조회
	fn_Upjang_Hall_MealSearch();
}

//조회 후 이벤트
function fn_Upjang_HallSearch_After(errCode, errMsg)
{
	if(errCode!=0)
	{
		g_Message("EE",	"서비스 오류:시스템 관리자에게 문의하십시오");
		return;
	}
	
	//행사식당은 제외한다. Filter사용.
	ds_upjang_hall.filter("gfn_subStr(HALL_CD,0,3)<>'010'");
	
}

////////////////////식당 변경시 이벤트///////////////////////
function cbo_upjang_hall_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{

	// 끼니조회
	fn_Upjang_Hall_MealSearch();
	
}


/*
 ******************************************************************************************
 * 함  수  명   : fn_Upjang_CornerSearch()
 * 기      능   : 업장의 끼니 조회
 * 작  성  자   : 박종세
 * 작성  일자   : 2007-12-20 
 ******************************************************************************************
 */
//끼니 정의
function fn_Upjang_Hall_MealSearch()
{
	// 식당 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "";
	outData			= "ds_upjang_hall_meal=ds_upjang_hall_meal";
	callBackFnc		= "";
	otherArg		= "UPJANG="+wrapQuote(ds_input.getColumn(0,"UPJANG"));
	otherArg		= otherArg + " HALL_CD="+wrapQuote(cbo_upjang_hall.value);
	//otherArg		= otherArg + " CORNER="+quote(cbo_upjang_hall_corner.Value);
	otherArg		= otherArg + " BLANK='A'";
	
	fsp_clear(this); 
    fsp_addSearch(this, "fs/fsc:FSC_UPJANG_HALL_MEAL_S001");						// 조회 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
	http.Sync = false;
	
	// 초기값 셋팅
	cbo_upjang_hall_meal.index = 0;
	
	
	// 코너조회
	fn_Upjang_CornerSearch();
}


////////////////////끼니  변경시 이벤트///////////////////////
function cbo_upjang_hall_meal_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
		
	// 코너조회
	fn_Upjang_CornerSearch();
}



/*
 ******************************************************************************************
 * 함  수  명   : fn_Upjang_CornerSearch()
 * 기      능   : 업장의 코너 조회
 * 작  성  자   : 박종세
 * 작성  일자   : 2007-12-20 
 ******************************************************************************************
 */
//코너 정의
function fn_Upjang_CornerSearch()
{
	// 식당 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "";
	outData			= "ds_upjang_hall_corner=ds_upjang_hall_corner";
	callBackFnc		= "";
	otherArg		= "UPJANG="+wrapQuote(ds_input.getColumn(0,"UPJANG"));
	otherArg		= otherArg + " HALL_CD="+wrapQuote(cbo_upjang_hall.value);
	otherArg		= otherArg + " MEAL="+wrapQuote(cbo_upjang_hall_meal.value);
	otherArg		= otherArg + " BLANK='A'";
	
	fsp_clear(this); 
    fsp_addSearch(this, "fs/fsc:FSC_UPJANG_HALL_CORNER_S001");								// 조회 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
	http.Sync = false;
	
	// 초기값 셋팅
	cbo_upjang_hall_corner.index = 0;	
}

/////////////////////
//보존식 TAG 엑셀 출력
/////////////////////
function btn_Excel_OnClick(obj:Button, e:ClickEventInfo)
{
	gfn_exportExcel(grd_list_Pivot, this.titletext);
}

function cal_END_DATE_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{
	//cal_START_DATE.value=gfn_addDate(cal_END_DATE.value,-6);
}

function fn_crossTab(objDs,objGrid)
{
	//Dataset생성
 	var objPivotHeadDs = fn_makeHeadDs(objDs);	
    var objPivotBodyDs = fn_makeBodyDs(objDs, objPivotHeadDs);
    //trace(objPivotHeadDs.saveXML());
    
  	fn_crossTabGrid(objGrid,objDs,objPivotHeadDs,objPivotBodyDs);
}

function fn_makeHeadDs(objDs)
{

	var sPivotHeadDs = objDs.name + "_PivotHead";
	var objPivotHeadDs;
	
	var sCurrDate = '';
	var sPrevDate = '';
	
	var dRow = 0;
	
	if ( this.isValidObject(sPivotHeadDs) ) {
		objPivotHeadDs = eval(sPivotHeadDs);
	} else {
		objPivotHeadDs = new Dataset();
		objPivotHeadDs.name = sPivotHeadDs;
		this.addChild(objPivotHeadDs.name,objPivotHeadDs);
	}

    var j=0;
    
	// 초기화
	//objPivotHeadDs.clearData();
	objPivotHeadDs.clear();	
	
    dCnt = objDs.rowcount;
    //trace("HeadDs:"+dCnt);
    //trace("HeadDs:"+objPivotHeadDs.saveXML());
    
    ds_date.clearData();
    
    for(i=0;i<dCnt;i++){
        sCurrDate = objDs.getColumn(i,"MENU_DATE"); 
		//trace("sCurrDate:"+sCurrDate);
		//trace("sPrevDate:"+sPrevDate);
		
		if ( sPrevDate != sCurrDate)
		{
		    dRow = ds_date.addRow();
		    
		    ds_date.setColumn(dRow, "MENU_DATE", objDs.getColumn(i,"MENU_DATE"));
		}
		  
		sPrevDate = sCurrDate;
    }
      
	il_cnt = ds_date.rowcount;
	//trace("il_cnt:"+il_cnt);
    for(i=0;i<il_cnt;i++) {
		 //trace(" i : " + ds_date.getColumn(i,"MENU_DATE"));
	     objPivotHeadDs.addColumn("MENU_DATE"+ds_date.getColumn(i,"MENU_DATE"),"STRING", 256); 
	     
    }
    
    objPivotHeadDs.addRow();
    
    for(i=0;i<il_cnt;i++) {
	     objPivotHeadDs.setColumn(0,"MENU_DATE"+ds_date.getColumn(i,"MENU_DATE"), ds_date.getColumn(i,"MENU_DATE")); 
    }
    //trace("HeadDs:"+objPivotHeadDs.saveXML());
    return objPivotHeadDs;
}

//Pivot Dataset생성
function fn_makeBodyDs(objDs,objPivotHeadDs)
{
	var sPivotDs = objDs.name + "_Pivot";
	var objPivotDs;
	if ( this.isValidObject(sPivotDs) ) {
		objPivotDs = eval(sPivotDs);
	} else {
		objPivotDs = new Dataset();
		objPivotDs.name = sPivotDs;
		this.addChild(objPivotDs.name,objPivotDs);
	}
	objPivotDs.clear(); 
	this.ds_list_Pivot.clearData();
	
	//Pivot컬럼 추가
    for(i=0;i<il_cnt;i++) {       
		objPivotDs.addColumn("MENU_DATE"+ds_date.getColumn(i,"MENU_DATE")    ,"STRING", 256);     
    } 
	
	//Data생성
	objDs.keystring = "S:TEMP_GROUP_KEY+MENU_DATE+MENU_CD";
	var nRowCnt 	= objDs.rowcount;
	var sPreKey 	  = "";
	var sPreGroupKey  = "";
	var sCurrKey 	  = "";
	var sCurrGroupKey = "";
	var nAddRow;
	var nAddRow0;
	var nAddRow1;
	var nAddRow2;
	var nAddRow3;
    var nAddRow4;
    var nAddRow5;
	
	var nSum = 0;
	var i = 0;
	var j = 0;
	var k = 0;
	var l = 0;
	
	var x = 0;
	var y = 0;
	var z = 0;
	
	var nMaxCnt   = 0;
	var nDate_seq = 0;
	var nCol_seq  = 0; 
	
	objDs.addColumn("DATE_SEQ", "BIGDECIMAL", 15);
	objDs.addColumn("COL_SEQ", "BIGDECIMAL", 15);
	
	//max row * column * item ==> seq
	sPrevDate = '';
	
	//Max Row
	for(i=0;i<nRowCnt;i++) { 
	
	    for(j=0;j<il_cnt;j++) {
	    
	        if(objDs.getColumn(i, "MENU_DATE") == ds_date.getColumn(j, "MENU_DATE")) {
	        
	            objDs.setColumn(i, "DATE_SEQ", j);	        
	        }	    
	    }
	}
	
	for(i=0;i<nRowCnt;i++) { 
	
        sCurrDate = objDs.getColumn(i,"MENU_DATE"); 
		
		if ( sPrevDate != sCurrDate)
		{
		   k=0;
		   
		   objDs.setColumn(i, "COL_SEQ", k);	
		     
		} else {
		   k+=1;
		   
		   objDs.setColumn(i, "COL_SEQ", k);
		}
		  
		sPrevDate = sCurrDate;
	}
    
    nMaxCnt = objDs.getMax("COL_SEQ") + 1;
    
    for(i=0;i<nMaxCnt*6;i++) {
    
       objPivotDs.addRow();
    }
        

    for(i=0;i<nRowCnt;i++){
    
       x = objDs.getColumn(i,"DATE_SEQ");
       y = objDs.getColumn(i,"COL_SEQ");
       
       z = 6 * y;
       
       objPivotDs.setColumn(z+0, "MENU_DATE" + ds_date.getColumn(x, "MENU_DATE"), "보존TAG");  
       objPivotDs.setColumn(z+1, "MENU_DATE" + ds_date.getColumn(x, "MENU_DATE"), objDs.getColumn(i, "MAIN_USER")); 
       objPivotDs.setColumn(z+2, "MENU_DATE" + ds_date.getColumn(x, "MENU_DATE"), cbo_upjang_hall.text + " " +objDs.getColumn(i, "GUBUN"));  
       objPivotDs.setColumn(z+3, "MENU_DATE" + ds_date.getColumn(x, "MENU_DATE"), objDs.getColumn(i, "START_TIME") + " 분");  
       objPivotDs.setColumn(z+4, "MENU_DATE" + ds_date.getColumn(x, "MENU_DATE"), objDs.getColumn(i, "RECIPE_INFO"));  
       objPivotDs.setColumn(z+5, "MENU_DATE" + ds_date.getColumn(x, "MENU_DATE"), objDs.getColumn(i, "DISUSE_TIME"));  
        
    
    }
     
	return objPivotDs;
}
// 
//Pivot 그리드포맷생성
function fn_crossTabGrid(objGrid,objDs,objPivotHeadDs,objPivotBodyDs)
{
	// GRID 작성
	var Contents_grd_lst	 = "";
	var Contents_grd_column  = "";
	var Contents_grd_rows    = "";
	var Contents_grd_head    = "";
	var Contents_grd_body    = "";
	var Contents_grd_summary = ""; 
	// 
	// Grid를 작성합니다.
	//
	Contents_grd_lst  = '<Formats>' + '\n';
	Contents_grd_lst  += '<Format id="Default">' + '\n';
	
	// Grid columns를 작성합니다.
	Contents_grd_column  = ' <Columns>' + '\n';
 
    il_cnt = ds_date.rowcount;
    //trace(il_cnt);
 
	for(var i=0;i<il_cnt;i++) {
         Contents_grd_column  += ' <Column size="178" />' + '\n';
	} 

	Contents_grd_column  += ' </Columns>' + '\n';

	Contents_grd_rows = ' <Rows>' + '\n';
    Contents_grd_rows += ' <Row size="26" band="head" />' + '\n';
    Contents_grd_rows += ' <Row size="24" />' + '\n';
	Contents_grd_rows += ' </Rows>' + '\n';

	Contents_grd_head = ' <Band id="head">' + '\n';   
	
	for(i=0;i<il_cnt;i++){
       Contents_grd_head += ' <Cell col="' + i + '" text="' + gfn_subStr(objPivotHeadDs.getColumn(0,"MENU_DATE"+ds_date.getColumn(i,"MENU_DATE")),8,2)+'일' + '"/>' + '\n'; 
    }
	
	Contents_grd_head += ' </Band>' + '\n';
	
 
	// 	  Grid body를 작성합니다.
	Contents_grd_body = ' <Band id="body">' + '\n';
	for(i=0;i<il_cnt;i++){
        Contents_grd_body += ' <Cell col="' + i + '" edittype="normal" style="align:EXPR(iif(MENU_DATE' + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;center&apos;,&apos;left&apos;));';
        //Contents_grd_body += ' background:EXPR(MENU_DAY==&#32;&apos;월&apos; ?  &#32;&apos;red&apos; : &#32;&apos;green&apos; );';
        //Contents_grd_body += ' background2:EXPR(MENU_DAY==&#32;&apos;월&apos; ?  &#32;&apos;red&apos; : &#32;&apos;green&apos; );';
        //Contents_grd_body += ' background:EXPR(iif(MENU_DATE' + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;&apos;,iff(MENU_DAY==&#32;&apos;월&apos;,&#32;&apos;red&apos;,&#32;&apos;yellow&apos;),&apos;white&apos;));';
        //Contents_grd_body += ' background2:EXPR(iif(MENU_DATE' + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;&apos;,iff(MENU_DAY==&#32;&apos;월&apos;,&#32;&apos;red&apos;,&#32;&apos;yellow&apos;),&apos;white&apos;));';
        //Contents_grd_body += ' background2:EXPR(iif(MENU_DATE' + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,iff(MENU_DAY==&#32;&apos;월&apos;,&#32;&apos;red&apos;,iff(MENU_DAY==&#32;&apos;화&apos;,&#32;&apos;orange&apos;,iff(MENU_DAY==&#32;&apos;수&apos;,&#32;&apos;yellow&apos;,iff(MENU_DAY==&#32;,&apos;목&apos;,&#32;&apos;green&apos;,iff(MENU_DAY==&#32;&apos;금&apos;,&#32;&apos;blue&apos;,iff(MENU_DAY==&#32;&apos;토&apos;,&#32;&apos;darkblue&apos;,iff(MENU_DAY==&#32;&apos;일&apos;,&#32;&apos;purple&apos;,&#32;&apos;yellow&apos;))))))),&apos;white&apos;));';
        //Contents_grd_body += ' background:EXPR(iif(MENU_DATE'  + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,iff(MENU_DAY==&#32;&apos;월&apos; &#32;&apos;red&apos;,iff(MENU_DAY==&#32;&apos;화&apos; &#32;&apos;orange&apos;,iff(MENU_DAY==&#32;&apos;수&apos;         &#32;&apos;yellow&apos;,iff(MENU_DAY==&#32;&apos;목&apos; &#32;&apos;green&apos;,iff(MENU_DAY==&#32;&apos;금&apos; &#32;&apos;blue&apos;,iff(MENU_DAY==&#32;&apos;토&apos; &#32;&apos;dark blue&apos;,iff(MENU_DAY==&#32;&apos;일&apos; &#32;&apos;purple&apos;,&#32;&apos;white&apos;))))))),&apos;white&apos;));';
        //Contents_grd_body += ' background2:EXPR(iif(MENU_DATE'  + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,iff(MENU_DAY==&#32;&apos;월&apos; &#32;&apos;red&apos;,iff(MENU_DAY==&#32;&apos;화&apos; &#32;&apos;orange&apos;,iff(MENU_DAY==&#32;&apos;수&apos;         &#32;&apos;yellow&apos;,iff(MENU_DAY==&#32;&apos;목&apos; &#32;&apos;green&apos;,iff(MENU_DAY==&#32;&apos;금&apos; &#32;&apos;blue&apos;,iff(MENU_DAY==&#32;&apos;토&apos; &#32;&apos;dark blue&apos;,iff(MENU_DAY==&#32;&apos;일&apos; &#32;&apos;purple&apos;,&#32;&apos;white&apos;))))))),&apos;white&apos;));';
        //&#32;&apos;lightsteelblue&apos;
        //alert(ds_date.getColumn(i,"MENU_DATE").substring(ds_date.getColumn(i,"MENU_DATE").length-1, ds_date.getColumn(i,"MENU_DATE").length));
        
 		//요일별 배경색구분 추가 20181228 김호석
        if (ds_date.getColumn(i,"MENU_DATE").substring(ds_date.getColumn(i,"MENU_DATE").length-1, ds_date.getColumn(i,"MENU_DATE").length) == "월") {
			Contents_grd_body += ' background:EXPR(iif(MENU_DATE' + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;red&apos;,&apos;white&apos;));';
			Contents_grd_body += ' color:EXPR(iif(MENU_DATE' 	   + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;white&apos;,&apos;black&apos;));';
        } else if (ds_date.getColumn(i,"MENU_DATE").substring(ds_date.getColumn(i,"MENU_DATE").length-1, ds_date.getColumn(i,"MENU_DATE").length) == "화") {
			Contents_grd_body += ' background:EXPR(iif(MENU_DATE' + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;#F39B21&apos;,&apos;white&apos;));';
			Contents_grd_body += ' color:EXPR(iif(MENU_DATE' 	   + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;white&apos;,&apos;black&apos;));';
        } else if (ds_date.getColumn(i,"MENU_DATE").substring(ds_date.getColumn(i,"MENU_DATE").length-1, ds_date.getColumn(i,"MENU_DATE").length) == "수") {
			Contents_grd_body += ' background:EXPR(iif(MENU_DATE' + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;yellow&apos;,&apos;white&apos;));';
			Contents_grd_body += ' color:EXPR(iif(MENU_DATE' 	   + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;black&apos;,&apos;black&apos;));';
        } else if (ds_date.getColumn(i,"MENU_DATE").substring(ds_date.getColumn(i,"MENU_DATE").length-1, ds_date.getColumn(i,"MENU_DATE").length) == "목") {
			Contents_grd_body += ' background:EXPR(iif(MENU_DATE' + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;green&apos;,&apos;white&apos;));';
			Contents_grd_body += ' color:EXPR(iif(MENU_DATE' 	   + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;white&apos;,&apos;black&apos;));';
        } else if (ds_date.getColumn(i,"MENU_DATE").substring(ds_date.getColumn(i,"MENU_DATE").length-1, ds_date.getColumn(i,"MENU_DATE").length) == "금") {
			Contents_grd_body += ' background:EXPR(iif(MENU_DATE' + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;#0099FF&apos;,&apos;white&apos;));';
			Contents_grd_body += ' color:EXPR(iif(MENU_DATE' 	   + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;white&apos;,&apos;black&apos;));';
        } else if (ds_date.getColumn(i,"MENU_DATE").substring(ds_date.getColumn(i,"MENU_DATE").length-1, ds_date.getColumn(i,"MENU_DATE").length) == "토") {
			Contents_grd_body += ' background:EXPR(iif(MENU_DATE' + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;darkblue&apos;,&apos;white&apos;));';
			Contents_grd_body += ' color:EXPR(iif(MENU_DATE' 	   + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;white&apos;,&apos;black&apos;));';
        } else if (ds_date.getColumn(i,"MENU_DATE").substring(ds_date.getColumn(i,"MENU_DATE").length-1, ds_date.getColumn(i,"MENU_DATE").length) == "일") {
			Contents_grd_body += ' background:EXPR(iif(MENU_DATE' + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;purple&apos;,&apos;white&apos;));';
			Contents_grd_body += ' color:EXPR(iif(MENU_DATE' 	   + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;white&apos;,&apos;black&apos;));';
        } else {
			Contents_grd_body += ' background:EXPR(iif(MENU_DATE' + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;lightsteelblue&apos;,&apos;white&apos;));';
			Contents_grd_body += ' color:EXPR(iif(MENU_DATE' 	   + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;white&apos;,&apos;black&apos;));';
        }
        Contents_grd_body += ' background2:EXPR(iif(MENU_DATE' + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;lightsteelblue&apos;,&apos;white&apos;));';
        Contents_grd_body += ' color2:EXPR(iif(MENU_DATE'      + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;white&apos;,&apos;black&apos;));';
        //Contents_grd_body += ' color:EXPR(iif(MENU_DATE' 	   + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,MENU_DAY==&#32;&apos;월&apos;?&apos;red&apos;:&apos;green&apos;,&apos;black&apos;));';
        //Contents_grd_body += ' color2:EXPR(iif(MENU_DATE'      + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,MENU_DAY==&#32;&apos;월&apos;?&apos;red&apos;:&apos;green&apos;,&apos;black&apos;));';
        Contents_grd_body += ' font:EXPR(iif(MENU_DATE'        + ds_date.getColumn(i,"MENU_DATE") + '&#32;==&#32;&apos;보존TAG&apos;,&#32;&apos;굴림,9,bold&apos;,&apos;굴림,9&apos;));';
        Contents_grd_body += '" text="bind:MENU_DATE'          + ds_date.getColumn(i,"MENU_DATE") + '"/>' + '\n';
    }
	
	Contents_grd_body	+= ' </Band>' + '\n'; 
	//trace(Contents_grd_body);
    Contents_grd_lst += Contents_grd_column + Contents_grd_rows + Contents_grd_head + Contents_grd_body  + '</Format>' + '\n' + '</Formats>';
		
	trace(Contents_grd_lst);
	
	objGrid.enableredraw = false;	
	objGrid.formats      = Contents_grd_lst;
 	objGrid.formatid     = "Default"; 	
	objGrid.nodataimage  = gv_noData;	
	objGrid.binddataset  = objPivotBodyDs.name;
	//objGrid.autofittype   = "col";
	objGrid.scrollbars   = "autoboth";
	
	objGrid.enableredraw = true;
	
	/*
	for(i=0<ds_list_pivot.rowcount-1;i++){
		if (ds_list_pivot.getColumn(i,"
	
	}
	*/
	
	objPivotBodyDs.rowposition = 0;
}


function ds_input_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if(e.columnid == 'MENU_SDATE')
	{
		cal_END_DATE.value=gfn_addDate(e.newvalue,6);
	}
}
]]></Script>
  </Form>
</FDL>

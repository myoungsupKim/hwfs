<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="BuySaleSum" classname="sam_MasterDetail" position="absolute 0 0 1252 725" titletext="매입매출집계" onload="form_onload">
    <Layouts>
      <Layout>
        <cmpPageObj id="cmpPageObj" titletext="cmpPageObj" taborder="1" scrollbars="none" class="sta_paging_Bg" position="absolute 0 439 1017 463" anchor="left top right"/>
        <Static id="Static06" text="w15" visible="false" position="absolute 1237 0 1252 710" class="Guide01_AreaRed" anchor="top right"/>
        <Static id="Static71" visible="false" position="absolute 0 710 1252 725" class="Guide01_AreaRed" text="h15" anchor="left bottom"/>
        <Div id="div_cmnBtn" taborder="21" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" anchor="left top right" position="absolute 0 0 1237 30" positiontype="position"/>
        <Static id="Static29" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 123" anchor="left top right"/>
        <Static id="Static43" text="W10" visible="false" position="absolute 14 30 277 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static45" text="W15" visible="false" position="absolute 0 30 14 118" style="background:#ff000055;align:center middle;"/>
        <Static id="Static28" text="관리부서" class="sta_WFSA_label" position="absolute 15 40 77 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 74 40 84 61" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 538 41 568 62" anchor="left top"/>
        <Static id="Static51" text="W05." visible="false" position="absolute 0 61 538 66" style="background:#ff000055;align:center middle;"/>
        <Static id="Static03" text="물류센터" class="sta_WFSA_label" position="absolute 569 42 631 63" anchor="left top"/>
        <Static id="Static00" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 628 41 638 62" anchor="left top"/>
        <Static id="Static01" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 787 40 817 61" anchor="left top"/>
        <Static id="Static02" text="본     사" class="sta_WFSA_label" position="absolute 14 66 76 87" anchor="left top"/>
        <Static id="Static04" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 73 66 83 87" anchor="left top"/>
        <Static id="Static05" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 255 66 285 87" anchor="left top"/>
        <Static id="Static07" text="사업장" class="sta_WFSA_label" position="absolute 285 66 347 87" anchor="left top"/>
        <Static id="Static08" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 344 66 354 87" anchor="left top"/>
        <Static id="Static10" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 538 66 568 87" anchor="left top"/>
        <Static id="Static12" text="납품업체" class="sta_WFSA_label" position="absolute 568 66 630 87" anchor="left top"/>
        <Static id="Static13" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 628 66 638 87" anchor="left top"/>
        <Static id="Static14" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 787 66 817 87" anchor="left top"/>
        <Static id="Static85" text="~" class="sta_WF_Dash" position="absolute 1109 40 1125 61"/>
        <Static id="Static17" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 996 41 1006 62" anchor="left top"/>
        <Tab id="Tab_BuySale" anchor="all" taborder="18" tabindex="0" scrollbars="autoboth" position="absolute 0 138 1237 710" style="showextrabutton:false;" onchanged="Tab_BuySale_onchanged">
          <Tabpages>
            <Tabpage id="tabpage1" text="일자별집계" style="anchor:default;">
              <Layouts>
                <Layout>
                  <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1235 15" anchor="left top"/>
                  <Static id="Static07" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 15 10 596"/>
                  <Static id="Static01" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1225 15 1235 560"/>
                  <Static id="Static35" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 10 560 1245 570" anchor="left top"/>
                  <Grid id="grd_list" taborder="1" binddataset="ds_list0" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 9 5 1224 527" anchor="all" autofittype="none">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="22"/>
                          <Column size="88"/>
                          <Column size="94"/>
                          <Column size="159"/>
                          <Column size="138"/>
                          <Column size="63"/>
                          <Column size="104"/>
                          <Column size="96"/>
                          <Column size="91"/>
                          <Column size="105"/>
                          <Column size="109"/>
                          <Column size="103"/>
                          <Column size="88"/>
                          <Column size="98"/>
                          <Column size="115"/>
                          <Column size="69"/>
                          <Column size="0"/>
                          <Column size="0"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" text="일자"/>
                          <Cell col="2" text="자재코드"/>
                          <Cell col="3" text="자재명"/>
                          <Cell col="4" text="규격"/>
                          <Cell col="5" text="단위"/>
                          <Cell col="6" text="매입단가"/>
                          <Cell col="7" text="매입금액"/>
                          <Cell col="8" text="매입부가세"/>
                          <Cell col="9" text="매입합계"/>
                          <Cell col="10" text="매출단가"/>
                          <Cell col="11" text="매출금액"/>
                          <Cell col="12" text="매출부가세"/>
                          <Cell col="13" text="매출합계"/>
                          <Cell col="14" text="이익액(VAT별도)"/>
                          <Cell col="15" text="이익율"/>
                          <Cell col="16" text="담당MD"/>
                          <Cell col="17" text="공급업체명"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:NO" expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:center;" text="bind:transDate"/>
                          <Cell col="2" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                          <Cell col="3" displaytype="normal" edittype="none" style="align:left middle;" text="bind:itemName"/>
                          <Cell col="4" style="align:left middle;" text="bind:itemSize"/>
                          <Cell col="5" style="align:center middle;" text="bind:transUom"/>
                          <Cell col="6" style="align:right middle;" text="bind:transPrice"/>
                          <Cell col="7" style="align:right middle;" text="bind:transAmount"/>
                          <Cell col="8" style="align:right middle;" text="bind:transVat"/>
                          <Cell col="9" style="align:right middle;" text="bind:transSum"/>
                          <Cell col="10" style="align:right middle;" text="bind:salePrice"/>
                          <Cell col="11" style="align:right middle;" text="bind:saleAmt"/>
                          <Cell col="12" style="align:right middle;" text="bind:saleVat"/>
                          <Cell col="13" style="align:right middle;" text="bind:saleSum"/>
                          <Cell col="14" displaytype="number" text="bind:marginAmt"/>
                          <Cell col="15" displaytype="number" text="bind:marginRatio"/>
                          <Cell col="16" style="align:center middle;" text="bind:mdName"/>
                          <Cell col="17" style="align:left;padding:0 0 0 6;" text="bind:vendorName"/>
                        </Band>
                        <Band id="summary">
                          <Cell/>
                          <Cell col="1" colspan="6" style="align:right middle;" text="합   계 :" taborder="undefined"/>
                          <Cell col="7" displaytype="number" style="align:right middle;" expr="expr:getSumNF('transAmount')"/>
                          <Cell col="8" displaytype="number" style="align:right middle;" expr="expr:getSumNF('transVat')"/>
                          <Cell col="9" displaytype="number" style="align:right middle;" expr="expr:getSumNF('transSum')"/>
                          <Cell col="10"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleAmt')"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleVat')"/>
                          <Cell col="13" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleSum')"/>
                          <Cell col="14" displaytype="number" expr="expr:getSumNF('marginAmt')"/>
                          <Cell col="15" displaytype="number" text="expr:gfn_round(gfn_parseFloat((ds_list0.getSum(&quot;marginAmt&quot;)/ds_list0.getSum(&quot;saleAmt&quot;)) * 100),2)" mask="#,##0.#0"/>
                          <Cell col="16"/>
                          <Cell col="17"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Grid id="Grid00" taborder="2" useinputpanel="false" position="absolute 108 343 728 436" binddataset="ds_search" visible="false">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                        </Columns>
                        <Rows>
                          <Row band="head" size="24"/>
                          <Row band="body" size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell col="0" disptype="normal" text="schCenter"/>
                          <Cell col="1" disptype="normal" text="schToDate"/>
                          <Cell col="2" disptype="normal" text="schFromDate"/>
                          <Cell col="3" disptype="normal" text="schMu"/>
                          <Cell col="4" disptype="normal" text="schTm"/>
                          <Cell col="5" disptype="normal" text="schCc"/>
                          <Cell col="6" disptype="normal" text="schCcNm"/>
                          <Cell col="7" disptype="normal" text="schMainUpjang"/>
                          <Cell col="8" disptype="normal" text="schUpjang"/>
                          <Cell col="9" disptype="normal" text="schCustCd"/>
                          <Cell col="10" disptype="normal" text="tabIndex"/>
                          <Cell col="11" disptype="normal" text="schCustNm"/>
                          <Cell col="12" disptype="normal" text="schUpjangNm"/>
                          <Cell col="13" disptype="normal" text="schMainUpjangNm"/>
                          <Cell col="14" disptype="normal" text="schTmNm"/>
                          <Cell col="15" disptype="normal" text="schCenterName"/>
                          <Cell col="16" disptype="normal" text="schView"/>
                          <Cell col="17" disptype="normal" text="schChk1"/>
                          <Cell col="18" disptype="normal" text="schChk2"/>
                          <Cell col="19" disptype="normal" text="schChk3"/>
                          <Cell col="20" disptype="normal" text="schGubun"/>
                          <Cell col="21" disptype="normal" text="schPrice"/>
                          <Cell col="22" disptype="normal" text="schSabun"/>
                          <Cell col="23" disptype="normal" text="schSabunNm"/>
                          <Cell col="24" disptype="normal" text="schBizDetail"/>
                        </Band>
                        <Band id="body">
                          <Cell col="0" disptype="normal" text="bind:schCenter"/>
                          <Cell col="1" disptype="normal" text="bind:schToDate"/>
                          <Cell col="2" disptype="normal" text="bind:schFromDate"/>
                          <Cell col="3" disptype="normal" text="bind:schMu"/>
                          <Cell col="4" disptype="normal" text="bind:schTm"/>
                          <Cell col="5" disptype="normal" text="bind:schCc"/>
                          <Cell col="6" disptype="normal" text="bind:schCcNm"/>
                          <Cell col="7" disptype="normal" text="bind:schMainUpjang"/>
                          <Cell col="8" disptype="normal" text="bind:schUpjang"/>
                          <Cell col="9" disptype="normal" text="bind:schCustCd"/>
                          <Cell col="10" disptype="normal" text="bind:tabIndex"/>
                          <Cell col="11" disptype="normal" text="bind:schCustNm"/>
                          <Cell col="12" disptype="normal" text="bind:schUpjangNm"/>
                          <Cell col="13" disptype="normal" text="bind:schMainUpjangNm"/>
                          <Cell col="14" disptype="normal" text="bind:schTmNm"/>
                          <Cell col="15" disptype="normal" text="bind:schCenterName"/>
                          <Cell col="16" disptype="normal" text="bind:schView"/>
                          <Cell col="17" disptype="normal" text="bind:schChk1"/>
                          <Cell col="18" disptype="normal" text="bind:schChk2"/>
                          <Cell col="19" disptype="normal" text="bind:schChk3"/>
                          <Cell col="20" disptype="normal" text="bind:schGubun"/>
                          <Cell col="21" disptype="normal" text="bind:schPrice"/>
                          <Cell col="22" disptype="normal" text="bind:schSabun"/>
                          <Cell col="23" disptype="normal" text="bind:schSabunNm"/>
                          <Cell col="24" disptype="normal" text="bind:schBizDetail"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage2" text="인도처별집계">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" taborder="0" binddataset="ds_list1" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 15 1225 537" anchor="all" autofittype="none">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="68"/>
                          <Column size="120"/>
                          <Column size="75"/>
                          <Column size="120"/>
                          <Column size="82"/>
                          <Column size="148"/>
                          <Column size="99"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="123"/>
                          <Column size="80"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="121"/>
                          <Column size="114"/>
                          <Column size="114"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                          <Cell col="1" text="본사"/>
                          <Cell col="2" text="본사명"/>
                          <Cell col="3" text="사업장"/>
                          <Cell col="4" text="사업장명"/>
                          <Cell col="5" text="창고"/>
                          <Cell col="6" text="창고명"/>
                          <Cell col="7" text="세부직군"/>
                          <Cell col="8" text="매입금액"/>
                          <Cell col="9" text="매입부가세"/>
                          <Cell col="10" text="매입합계"/>
                          <Cell col="11" text="매출금액"/>
                          <Cell col="12" text="매출부가세"/>
                          <Cell col="13" text="매출합계"/>
                          <Cell col="14" text="이익액(VAT별도)"/>
                          <Cell col="15" text="이익율"/>
                          <Cell col="16" text="매입차감단가"/>
                          <Cell col="17" text="매입차감합계"/>
                          <Cell col="18" text="매입합계(차감반영)"/>
                          <Cell col="19" text="이익액(차감반영)"/>
                          <Cell col="20" text="이익율(차감반영)"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:center middle;" text="bind:mainUpjang"/>
                          <Cell col="2" displaytype="text" style="align:left middle;" text="bind:mainUpjangnmDisp"/>
                          <Cell col="3" displaytype="text" style="align:center middle;" text="bind:upjang"/>
                          <Cell col="4" style="align:left middle;" text="bind:upjangnm"/>
                          <Cell col="5" style="align:center middle;" text="bind:subinvCode"/>
                          <Cell col="6" style="align:left middle;" text="bind:subinvNameDisp"/>
                          <Cell col="7" displaytype="text" text="bind:bizDetailName"/>
                          <Cell col="8" style="align:right middle;" text="bind:transAmount"/>
                          <Cell col="9" style="align:right middle;" text="bind:transVat"/>
                          <Cell col="10" style="align:right middle;" text="bind:transSum"/>
                          <Cell col="11" style="align:right middle;" text="bind:saleAmount"/>
                          <Cell col="12" style="align:right middle;" text="bind:saleVat"/>
                          <Cell col="13" style="align:right middle;" text="bind:saleSum"/>
                          <Cell col="14" displaytype="number" text="bind:marginAmt"/>
                          <Cell col="15" displaytype="number" text="bind:marginRatio"/>
                          <Cell col="16" style="align:right middle;" text="bind:incomePrice"/>
                          <Cell col="17" style="align:right middle;" displaytype="number" expr="expr:gfn_round(incomeSum)"/>
                          <Cell col="18" style="align:right middle;" displaytype="number" expr="expr:gfn_round(incomeTransSum)"/>
                          <Cell col="19" style="align:right middle;" displaytype="number" expr="expr:gfn_round(incomeMarginAmt)"/>
                          <Cell col="20" style="align:right middle;" text="bind:incomeMarginRatio"/>
                        </Band>
                        <Band id="summary">
                          <Cell/>
                          <Cell col="1" colspan="6" style="align:right middle;" text="합   계 :" taborder="undefined"/>
                          <Cell col="7"/>
                          <Cell col="8" displaytype="number" style="align:right middle;" expr="expr:getSumNF('transAmount')"/>
                          <Cell col="9" displaytype="number" style="align:right middle;" expr="expr:getSumNF('transVat')"/>
                          <Cell col="10" displaytype="number" style="align:right middle;" expr="expr:getSumNF('transSum')"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleAmount')"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleVat')"/>
                          <Cell col="13" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleSum')"/>
                          <Cell col="14" displaytype="number" expr="expr:getSumNF('marginAmt')"/>
                          <Cell col="15" displaytype="number" text="expr:gfn_round(gfn_parseFloat((ds_list1.getSum(&quot;marginAmt&quot;)/ds_list1.getSum(&quot;saleAmount&quot;)) * 100),2)" mask="#,##0.#0"/>
                          <Cell col="16" style="align:right middle;"/>
                          <Cell col="17" displaytype="number" style="align:right middle;" expr="expr:gfn_round(getSumNF('incomeSum'))"/>
                          <Cell col="18" displaytype="number" style="align:right middle;" expr="expr:gfn_round(getSumNF('incomeTransSum'))"/>
                          <Cell col="19" displaytype="number" expr="expr:gfn_round(getSumNF('incomeMarginAmt'))"/>
                          <Cell col="20" displaytype="number" expr="expr:gfn_round(gfn_parseFloat((ds_list1.getSum(&quot;incomeMarginAmt&quot;)/ds_list1.getSum(&quot;saleAmount&quot;)) * 100),2)" mask="#,##0.#0"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage3" text="자재별집계">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" taborder="0" binddataset="ds_list2" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 15 1225 537" anchor="all" autofittype="none">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="22"/>
                          <Column size="114"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="94"/>
                          <Column size="159"/>
                          <Column size="88"/>
                          <Column size="40"/>
                          <Column size="101"/>
                          <Column size="86"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="114"/>
                          <Column size="80"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="121"/>
                          <Column size="114"/>
                          <Column size="114"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" text="관리부서"/>
                          <Cell col="2" text="중분류"/>
                          <Cell col="3" text="소분류"/>
                          <Cell col="4" text="세분류"/>
                          <Cell col="5" text="자재코드"/>
                          <Cell col="6" text="자재명"/>
                          <Cell col="7" text="규격"/>
                          <Cell col="8" text="단위"/>
                          <Cell col="9" text="매입단가"/>
                          <Cell col="10" text="발주수량"/>
                          <Cell col="11" text="매입금액"/>
                          <Cell col="12" text="매입부가세"/>
                          <Cell col="13" text="매입합계"/>
                          <Cell col="14" text="매출단가"/>
                          <Cell col="15" text="매출금액"/>
                          <Cell col="16" text="매출부가세"/>
                          <Cell col="17" text="매출합계"/>
                          <Cell col="18" text="이익액(VAT별도)"/>
                          <Cell col="19" text="이익율"/>
                          <Cell col="20" text="담당MD"/>
                          <Cell col="21" text="공급업체명"/>
                          <Cell col="22" text="매입차감단가"/>
                          <Cell col="23" text="매입차감합계"/>
                          <Cell col="24" text="매입합계(차감반영)"/>
                          <Cell col="25" text="이익액(차감반영)"/>
                          <Cell col="26" text="이익율(차감반영)"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:NO" expr="currow+1"/>
                          <Cell col="1" displaytype="text" text="bind:ccNm"/>
                          <Cell col="2" displaytype="text" text="bind:classM"/>
                          <Cell col="3" displaytype="text" text="bind:classS"/>
                          <Cell col="4" displaytype="text" text="bind:classD"/>
                          <Cell col="5" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                          <Cell col="6" displaytype="text" edittype="none" text="bind:itemName"/>
                          <Cell col="7" displaytype="text" text="bind:itemSize"/>
                          <Cell col="8" text="bind:transUom"/>
                          <Cell col="9" style="align:right middle;" text="bind:transMprice"/>
                          <Cell col="10" style="align:right middle;" text="bind:transQty"/>
                          <Cell col="11" style="align:right middle;" text="bind:transAmount"/>
                          <Cell col="12" style="align:right middle;" text="bind:transVat"/>
                          <Cell col="13" style="align:right middle;" text="bind:transSum"/>
                          <Cell col="14" style="align:right middle;" text="bind:salePrice"/>
                          <Cell col="15" style="align:right middle;" text="bind:saleAmount"/>
                          <Cell col="16" style="align:right middle;" text="bind:saleVat"/>
                          <Cell col="17" style="align:right middle;" text="bind:saleSum"/>
                          <Cell col="18" displaytype="number" text="bind:marginAmt"/>
                          <Cell col="19" displaytype="number" text="bind:marginRatio"/>
                          <Cell col="20" text="bind:mdName"/>
                          <Cell col="21" style="align:left middle;" text="bind:vendorName"/>
                          <Cell col="22" style="align:right middle;" text="bind:incomePrice"/>
                          <Cell col="23" style="align:right middle;" displaytype="number" expr="expr:gfn_round(incomeSum)"/>
                          <Cell col="24" style="align:right middle;" displaytype="number" expr="expr:gfn_round(incomeTransSum)"/>
                          <Cell col="25" style="align:right middle;" displaytype="number" expr="expr:gfn_round(incomeMarginAmt)"/>
                          <Cell col="26" style="align:right middle;" text="bind:incomeMarginRatio"/>
                        </Band>
                        <Band id="summary">
                          <Cell/>
                          <Cell col="1" colspan="9" style="align:right;" text="합   계 :" taborder="undefined"/>
                          <Cell col="10"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" expr="expr:getSumNF('transAmount')"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" expr="expr:getSumNF('transVat')"/>
                          <Cell col="13" displaytype="number" style="align:right middle;" expr="expr:getSumNF('transSum')"/>
                          <Cell col="14" style="align:right middle;"/>
                          <Cell col="15" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleAmount')"/>
                          <Cell col="16" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleVat')"/>
                          <Cell col="17" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleSum')"/>
                          <Cell col="18" displaytype="number" expr="expr:getSumNF('marginAmt')"/>
                          <Cell col="19" displaytype="number" expr="expr:gfn_round(gfn_parseFloat((ds_list2.getSum(&quot;marginAmt&quot;)/ds_list2.getSum(&quot;saleAmount&quot;)) * 100),2)" mask="#,##0.#0"/>
                          <Cell col="20"/>
                          <Cell col="21"/>
                          <Cell col="22" style="align:right middle;"/>
                          <Cell col="23" displaytype="number" style="align:right middle;" expr="expr:gfn_round(getSumNF('incomeSum'))"/>
                          <Cell col="24" displaytype="number" style="align:right middle;" expr="expr:gfn_round(getSumNF('incomeTransSum'))"/>
                          <Cell col="25" displaytype="number" expr="expr:gfn_round(getSumNF('incomeMarginAmt'))"/>
                          <Cell col="26" displaytype="number" expr="expr:gfn_round(gfn_parseFloat((ds_list2.getSum(&quot;incomeMarginAmt&quot;)/ds_list2.getSum(&quot;saleAmount&quot;)) * 100),2)" mask="#,##0.#0"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage4" text="자재분류별집계">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" taborder="0" binddataset="ds_list3" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 25 1225 537" anchor="all" autofittype="none">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="92"/>
                          <Column size="80"/>
                          <Column size="116"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="99"/>
                          <Column size="101"/>
                          <Column size="108"/>
                          <Column size="113"/>
                        </Columns>
                        <Rows>
                          <Row size="34" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                          <Cell col="1" text="관리부서"/>
                          <Cell col="2" text="업장코드"/>
                          <Cell col="3" text="본사"/>
                          <Cell col="4" text="양곡&#13;&#10;(매입)"/>
                          <Cell col="5" text="양곡&#13;&#10;(매출)"/>
                          <Cell col="6" text="야채&#13;&#10;(매입)"/>
                          <Cell col="7" text="야채&#13;&#10;(매출)"/>
                          <Cell col="8" text="수산&#13;&#10;(매입)"/>
                          <Cell col="9" text="수산&#13;&#10;(매출)"/>
                          <Cell col="10" text="축산&#13;&#10;(매입)"/>
                          <Cell col="11" text="축산&#13;&#10;(매출)"/>
                          <Cell col="12" text="김치&#13;&#10;(매입)"/>
                          <Cell col="13" text="김치&#13;&#10;(매출)"/>
                          <Cell col="14" text="공산&#13;&#10;(매입)"/>
                          <Cell col="15" text="공산&#13;&#10;(매출)"/>
                          <Cell col="16" text="소모품&#13;&#10;(매입)"/>
                          <Cell col="17" text="소모품&#13;&#10;(매출)"/>
                          <Cell col="18" text="보정분&#13;&#10;(매입)"/>
                          <Cell col="19" text="보정분&#13;&#10;(매출)"/>
                          <Cell col="20" text="합계(매입)"/>
                          <Cell col="21" text="합계(매출)"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" displaytype="text" text="bind:ccNm"/>
                          <Cell col="2" displaytype="text" style="align:center middle;" text="bind:upjang"/>
                          <Cell col="3" displaytype="text" text="bind:upjangnmDisp"/>
                          <Cell col="4" displaytype="number" style="align:right middle;" text="bind:a0101"/>
                          <Cell col="5" displaytype="number" style="align:right middle;" text="bind:b0101"/>
                          <Cell col="6" displaytype="number" style="align:right middle;" text="bind:a0102"/>
                          <Cell col="7" displaytype="number" style="align:right middle;" text="bind:b0102"/>
                          <Cell col="8" displaytype="number" style="align:right middle;" text="bind:a0103"/>
                          <Cell col="9" displaytype="number" style="align:right middle;" text="bind:b0103"/>
                          <Cell col="10" displaytype="number" style="align:right middle;" text="bind:a0104"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" text="bind:b0104"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" text="bind:a0105"/>
                          <Cell col="13" displaytype="number" style="align:right middle;" text="bind:b0105"/>
                          <Cell col="14" displaytype="number" style="align:right middle;" text="bind:a0107"/>
                          <Cell col="15" displaytype="number" style="align:right middle;" text="bind:b0107"/>
                          <Cell col="16" displaytype="number" style="align:right middle;" text="bind:a0108"/>
                          <Cell col="17" displaytype="number" style="align:right middle;" text="bind:b0108"/>
                          <Cell col="18" displaytype="number" text="bind:a0109"/>
                          <Cell col="19" displaytype="number" text="bind:b0109"/>
                          <Cell col="20" displaytype="number" text="expr:a0101+a0102+a0103+a0104+a0105+a0107+a0108+a0109"/>
                          <Cell col="21" displaytype="number" text="expr:b0101+b0102+b0103+b0104+b0105+b0107+b0108+b0109"/>
                        </Band>
                        <Band id="summary">
                          <Cell colspan="4" style="align:right;" text="합   계 :" taborder="undefined"/>
                          <Cell col="4" displaytype="number" style="align:right middle;" expr="expr:getSumNF('a0101')"/>
                          <Cell col="5" displaytype="number" style="align:right middle;" expr="expr:getSumNF('b0101')"/>
                          <Cell col="6" displaytype="number" style="align:right middle;" expr="expr:getSumNF('a0102')"/>
                          <Cell col="7" displaytype="number" style="align:right middle;" expr="expr:getSumNF('b0102')"/>
                          <Cell col="8" displaytype="number" style="align:right middle;" expr="expr:getSumNF('a0103')"/>
                          <Cell col="9" displaytype="number" style="align:right middle;" expr="expr:getSumNF('b0103')"/>
                          <Cell col="10" displaytype="number" style="align:right middle;" expr="expr:getSumNF('a0104')"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" expr="expr:getSumNF('b0104')"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" expr="expr:getSumNF('a0105')"/>
                          <Cell col="13" displaytype="number" style="align:right middle;" expr="expr:getSumNF('b0105')"/>
                          <Cell col="14" displaytype="number" style="align:right middle;" expr="expr:getSumNF('a0107')"/>
                          <Cell col="15" displaytype="number" style="align:right middle;" expr="expr:getSumNF('b0107')"/>
                          <Cell col="16" displaytype="number" style="align:right middle;" expr="expr:getSumNF('a0108')"/>
                          <Cell col="17" displaytype="number" style="align:right middle;" expr="expr:getSumNF('b0108')"/>
                          <Cell col="18" displaytype="number" text="expr:getSumNF('a0109')"/>
                          <Cell col="19" displaytype="number" text="expr:getSumNF('b0109')"/>
                          <Cell col="20" displaytype="number" text="expr:getSumNF('a0101')+getSumNF('a0102')+getSumNF('a0103')+getSumNF('a0104')+getSumNF('a0105')+getSumNF('a0107')+getSumNF('a0108')+getSumNF('a0109')"/>
                          <Cell col="21" displaytype="number" text="expr:getSumNF('b0101')+getSumNF('b0102')+getSumNF('b0103')+getSumNF('b0104')+getSumNF('b0105')+getSumNF('b0107')+getSumNF('b0108')+getSumNF('b0109')"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static00" text="※ 자재분류별집계는 부가세 금액이 제외된 금액입니다." position="absolute 12 3 474 24"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage5" text="일자별요약집계">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" taborder="0" binddataset="ds_list4" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 15 1225 537" anchor="all" autofittype="none">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="92"/>
                          <Column size="116"/>
                          <Column size="116"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="105"/>
                          <Column size="105"/>
                          <Column size="105"/>
                          <Column size="96"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell rowspan="2" style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                          <Cell col="1" rowspan="2" text="일자"/>
                          <Cell col="2" colspan="6" text="매입" taborder="undefined"/>
                          <Cell col="8" colspan="5" text="매출" taborder="undefined"/>
                          <Cell col="13" colspan="3" text="이익액" taborder="undefined"/>
                          <Cell col="16" rowspan="2" text="이익율" taborder="undefined"/>
                          <Cell row="1" col="2" text="순수매입액"/>
                          <Cell row="1" col="3" text="면과세합계"/>
                          <Cell row="1" col="4" text="면세"/>
                          <Cell row="1" col="5" text="과세"/>
                          <Cell row="1" col="6" text="부가세"/>
                          <Cell row="1" col="7" text="총합계"/>
                          <Cell row="1" col="8" text="면과세합계"/>
                          <Cell row="1" col="9" text="면세"/>
                          <Cell row="1" col="10" text="과세"/>
                          <Cell row="1" col="11" text="부가세"/>
                          <Cell row="1" col="12" text="총합계"/>
                          <Cell row="1" col="13" text="순수이익액"/>
                          <Cell row="1" col="14" text="순수이익율"/>
                          <Cell row="1" col="15" text="(부가세별도)"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" displaytype="date" text="bind:transDate"/>
                          <Cell col="2" style="align:right middle;" text="bind:unitSum"/>
                          <Cell col="3" style="align:right middle;" text="bind:taxall1"/>
                          <Cell col="4" style="align:right middle;" text="bind:notax1"/>
                          <Cell col="5" style="align:right middle;" text="bind:tax1"/>
                          <Cell col="6" style="align:right middle;" text="bind:vat1"/>
                          <Cell col="7" style="align:right middle;" text="bind:all1"/>
                          <Cell col="8" style="align:right middle;" text="bind:taxall2"/>
                          <Cell col="9" style="align:right middle;" text="bind:notax2"/>
                          <Cell col="10" style="align:right middle;" text="bind:tax2"/>
                          <Cell col="11" style="align:right middle;" text="bind:vat2"/>
                          <Cell col="12" style="align:right middle;" text="bind:all2"/>
                          <Cell col="13" displaytype="number" text="bind:marginSum"/>
                          <Cell col="14" displaytype="number" text="expr:fn_marginSumSet1(currow)"/>
                          <Cell col="15" displaytype="number" text="bind:marginAmt"/>
                          <Cell col="16" displaytype="number" text="bind:marginRatio"/>
                        </Band>
                        <Band id="summary">
                          <Cell colspan="2" style="align:right middle;" text="합   계 :" taborder="undefined"/>
                          <Cell col="2" displaytype="number" style="align:right middle;" expr="expr:getSumNF('unitSum')"/>
                          <Cell col="3" displaytype="number" style="align:right middle;" expr="expr:getSumNF('taxall1')"/>
                          <Cell col="4" displaytype="number" style="align:right middle;" expr="expr:getSumNF('notax1')"/>
                          <Cell col="5" displaytype="number" style="align:right middle;" expr="expr:getSumNF('tax1')"/>
                          <Cell col="6" displaytype="number" style="align:right middle;" expr="expr:getSumNF('vat1')"/>
                          <Cell col="7" displaytype="number" style="align:right middle;" expr="expr:getSumNF('all1')"/>
                          <Cell col="8" displaytype="number" style="align:right middle;" expr="expr:getSumNF('taxall2')"/>
                          <Cell col="9" displaytype="number" style="align:right middle;" expr="expr:getSumNF('notax2')"/>
                          <Cell col="10" displaytype="number" style="align:right middle;" expr="expr:getSumNF('tax2')"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" expr="expr:getSumNF('vat2')"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" expr="expr:getSumNF('all2')"/>
                          <Cell col="13" displaytype="number" expr="expr:getSumNF('marginSum')"/>
                          <Cell col="14" displaytype="number" expr="expr:gfn_round(gfn_parseFloat((ds_list4.getSum(&quot;marginSum&quot;)/ds_list4.getSum(&quot;taxall2&quot;)) * 100),2)" mask="#,##0.#0"/>
                          <Cell col="15" displaytype="number" expr="expr:getSumNF('marginAmt')"/>
                          <Cell col="16" displaytype="number" expr="expr:gfn_round(gfn_parseFloat((ds_list4.getSum(&quot;marginAmt&quot;)/ds_list4.getSum(&quot;taxall2&quot;)) * 100),2)" mask="#,##0.#0"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage6" text="매입/매출집계">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" taborder="0" binddataset="ds_list5" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 15 1225 537" anchor="all" autofittype="none">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="81"/>
                          <Column size="81"/>
                          <Column size="167"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="120"/>
                          <Column size="120"/>
                          <Column size="112"/>
                          <Column size="117"/>
                          <Column size="115"/>
                          <Column size="117"/>
                          <Column size="121"/>
                          <Column size="126"/>
                          <Column size="128"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="110"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="120"/>
                          <Column size="120"/>
                          <Column size="120"/>
                          <Column size="112"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell rowspan="2" class="head_Excel" taborder="undefined"/>
                          <Cell col="1" rowspan="2" text="관리부서" taborder="undefined"/>
                          <Cell col="2" rowspan="2" text="본사" taborder="undefined"/>
                          <Cell col="3" rowspan="2" text="본사명" taborder="undefined"/>
                          <Cell col="4" rowspan="2" text="사업장" taborder="undefined"/>
                          <Cell col="5" rowspan="2" text="사업장명" taborder="undefined"/>
                          <Cell col="6" rowspan="2" text="영업사원" taborder="undefined"/>
                          <Cell col="7" colspan="4" text="매입" taborder="undefined"/>
                          <Cell col="11" colspan="5" text="매출" taborder="undefined"/>
                          <Cell col="16" colspan="9" text="이익" taborder="undefined"/>
                          <Cell col="25" rowspan="2" text="세부직군" taborder="undefined"/>
                          <Cell col="26" rowspan="2" text="계약시작일" taborder="undefined"/>
                          <Cell col="27" rowspan="2" text="LV0 구분" taborder="undefined"/>
                          <Cell col="28" rowspan="2" text="LV1 운영형태" taborder="undefined"/>
                          <Cell col="29" rowspan="2" text="LV2 업태구분" taborder="undefined"/>
                          <Cell col="30" rowspan="2" text="LV3 세부업태" taborder="undefined"/>
                          <Cell col="31" rowspan="2" text="LV4 유저/상품" taborder="undefined"/>
                          <Cell row="1" col="7" text="순수매입액"/>
                          <Cell row="1" col="8" text="매입액(VAT별도)"/>
                          <Cell row="1" col="9" text="매입부가세"/>
                          <Cell row="1" col="10" text="매입합계"/>
                          <Cell row="1" col="11" text="매출액(면세)"/>
                          <Cell row="1" col="12" text="매출액(과세)"/>
                          <Cell row="1" col="13" text="매출액(VAT)"/>
                          <Cell row="1" col="14" text="매출합(VAT제외)"/>
                          <Cell row="1" col="15" text="매출합(VAT포함)"/>
                          <Cell row="1" col="16" text="순수이익액"/>
                          <Cell row="1" col="17" text="순수이익율"/>
                          <Cell row="1" col="18" text="이익액(VAT별도)"/>
                          <Cell row="1" col="19" text="이익율"/>
                          <Cell row="1" col="20" text="매입차감단가"/>
                          <Cell row="1" col="21" text="매입차감합계"/>
                          <Cell row="1" col="22" text="매입합계(차감반영)"/>
                          <Cell row="1" col="23" text="이익액(차감반영)"/>
                          <Cell row="1" col="24" text="이익율(차감반영)"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:left;" text="bind:ccNm"/>
                          <Cell col="2" displaytype="text" style="align:center middle;" text="bind:mainUpjang"/>
                          <Cell col="3" displaytype="text" style="align:left;" text="bind:mainUpjangnm"/>
                          <Cell col="4" displaytype="text" style="align:center middle;" text="bind:upjang"/>
                          <Cell col="5" displaytype="text" text="bind:upjangnm"/>
                          <Cell col="6" displaytype="text" style="align:left;" text="bind:salesMan"/>
                          <Cell col="7" displaytype="number" style="align:right middle;" text="bind:unitSum"/>
                          <Cell col="8" displaytype="number" style="align:right middle;" text="bind:transSum"/>
                          <Cell col="9" displaytype="number" style="align:right middle;" text="bind:transVat"/>
                          <Cell col="10" displaytype="number" style="align:right middle;" text="bind:transTot"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" text="bind:saleNotax"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" text="bind:saleTax"/>
                          <Cell col="13" displaytype="number" style="align:right middle;" text="bind:saleVat"/>
                          <Cell col="14" displaytype="number" style="align:right middle;" text="bind:saleTot"/>
                          <Cell col="15" displaytype="number" style="align:right middle;" text="bind:saleAll"/>
                          <Cell col="16" displaytype="number" style="align:right middle;" text="bind:marginSum"/>
                          <Cell col="17" displaytype="number" text="expr:fn_marginSumSet(currow)"/>
                          <Cell col="18" displaytype="number" style="align:right middle;" text="bind:margin"/>
                          <Cell col="19" displaytype="number" text="expr:fn_marginSet(currow)"/>
                          <Cell col="20" displaytype="number" text="bind:incomePrice"/>
                          <Cell col="21" displaytype="number" text="bind:incomeSum"/>
                          <Cell col="22" displaytype="number" text="bind:incomeTransSum"/>
                          <Cell col="23" displaytype="number" text="bind:incomeMarginAmt"/>
                          <Cell col="24" displaytype="number" text="expr:fn_marginSetIncome(currow)"/>
                          <Cell col="25" displaytype="text" text="bind:bizDetailName"/>
                          <Cell col="26" displaytype="text" style="align:center middle;" text="bind:contractTerm" mask="@@@@-@@-@@"/>
                          <Cell col="27" displaytype="text" text="bind:masterclass0"/>
                          <Cell col="28" displaytype="text" text="bind:masterclass1"/>
                          <Cell col="29" displaytype="text" text="bind:masterclass2"/>
                          <Cell col="30" displaytype="text" text="bind:masterclass3"/>
                          <Cell col="31" displaytype="text" text="bind:masterclass4"/>
                        </Band>
                        <Band id="summary">
                          <Cell colspan="4" style="align:right middle;" text="합   계 :" taborder="undefined"/>
                          <Cell col="4"/>
                          <Cell col="5"/>
                          <Cell col="6"/>
                          <Cell col="7" displaytype="number" style="align:right middle;" expr="expr:getSumNF('unitSum')"/>
                          <Cell col="8" displaytype="number" style="align:right middle;" expr="expr:getSumNF('transSum')"/>
                          <Cell col="9" displaytype="number" style="align:right middle;" expr="expr:getSumNF('transVat')"/>
                          <Cell col="10" displaytype="number" style="align:right middle;" expr="expr:getSumNF('transTot')"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleNotax')"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleTax')"/>
                          <Cell col="13" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleVat')"/>
                          <Cell col="14" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleTot')"/>
                          <Cell col="15" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleAll')"/>
                          <Cell col="16" displaytype="number" style="align:right middle;" expr="expr:getSumNF('marginSum')"/>
                          <Cell col="17" displaytype="number" expr="expr:gfn_round(gfn_parseFloat((ds_list5.getSum(&quot;marginSum&quot;)/ds_list5.getSum(&quot;saleTot&quot;)) * 100),2)" mask="#,##0.#0"/>
                          <Cell col="18" displaytype="number" style="align:right middle;" expr="expr:getSumNF('margin')"/>
                          <Cell col="19" displaytype="number" style="align:right middle;" expr="expr:gfn_round(gfn_parseFloat((ds_list5.getSum(&quot;margin&quot;)/ds_list5.getSum(&quot;saleTot&quot;)) * 100),2)" mask="#,##0.#0"/>
                          <Cell col="20" displaytype="number" expr="expr:getSumNF('incomePrice')"/>
                          <Cell col="21" displaytype="number" expr="expr:getSumNF('incomeSum')"/>
                          <Cell col="22" displaytype="number" expr="expr:getSumNF('incomeTransSum')"/>
                          <Cell col="23" displaytype="number" expr="expr:getSumNF('incomeMarginAmt')"/>
                          <Cell col="24" displaytype="number" style="align:right middle;" expr="expr:gfn_round(gfn_parseFloat((ds_list5.getSum(&quot;incomeMarginAmt&quot;)/ds_list5.getSum(&quot;saleTot&quot;)) * 100),2)" mask="#,##0.#0"/>
                          <Cell col="25"/>
                          <Cell col="26"/>
                          <Cell col="27"/>
                          <Cell col="28"/>
                          <Cell col="29"/>
                          <Cell col="30"/>
                          <Cell col="31"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage7" text="매입결과보고자료">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" taborder="0" binddataset="ds_list6" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 15 1225 537" anchor="all" autofittype="none">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="120"/>
                          <Column size="120"/>
                          <Column size="120"/>
                          <Column size="119"/>
                          <Column size="120"/>
                          <Column size="120"/>
                          <Column size="120"/>
                          <Column size="115"/>
                          <Column size="90"/>
                          <Column size="109"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                          <Cell col="1" text="매출처"/>
                          <Cell col="2" text="매입처"/>
                          <Cell col="3" text="품목"/>
                          <Cell col="4" text="매입액(VAT별도)"/>
                          <Cell col="5" text="매입부가세"/>
                          <Cell col="6" text="매출액(VAT별도)"/>
                          <Cell col="7" text="매출액(VAT포함)"/>
                          <Cell col="8" text="이익액(VAT별도)"/>
                          <Cell col="9" text="이익율"/>
                          <Cell col="10" text="차인지급액"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" displaytype="text" text="bind:upjangnm"/>
                          <Cell col="2" displaytype="text" text="bind:custnm"/>
                          <Cell col="3" displaytype="text" style="color:EXPR(className=='보정분'?'red':'');color2:EXPR(className=='보정분'?'red':'');" text="bind:className"/>
                          <Cell col="4" displaytype="number" text="bind:transAmt"/>
                          <Cell col="5" displaytype="number" text="bind:tramsVat"/>
                          <Cell col="6" style="align:right middle;" text="bind:saleAmt"/>
                          <Cell col="7" style="align:right middle;" text="bind:saleSum"/>
                          <Cell col="8" style="align:right middle;" text="bind:elAmt"/>
                          <Cell col="9" displaytype="number" style="align:right middle;" text="expr:fn_elRateSet(currow)"/>
                          <Cell col="10" style="align:right middle;" text="bind:difAmt"/>
                        </Band>
                        <Band id="summary">
                          <Cell colspan="4" style="align:right middle;" text="합   계 :" taborder="undefined"/>
                          <Cell col="4" displaytype="number" text="expr:getSumNF('transAmt')"/>
                          <Cell col="5" displaytype="number" expr="expr:getSumNF('tramsVat')"/>
                          <Cell col="6" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleAmt')"/>
                          <Cell col="7" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleSum')"/>
                          <Cell col="8" displaytype="number" style="align:right middle;" expr="expr:getSumNF('elAmt')"/>
                          <Cell col="9" displaytype="number" style="align:right middle;" expr="expr:gfn_round(gfn_parseFloat((ds_list6.getSum(&quot;elAmt&quot;)/ds_list6.getSum(&quot;saleAmt&quot;)) * 100),2)" mask="#,##0.#0"/>
                          <Cell col="10" displaytype="number" style="align:right middle;" expr="expr:getSumNF('difAmt')"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage8" text="채권잔액현황">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" taborder="0" binddataset="ds_list7" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 15 1225 537" anchor="all" autofittype="col">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="30"/>
                          <Column size="251"/>
                          <Column size="104"/>
                          <Column size="151"/>
                          <Column size="119"/>
                          <Column size="124"/>
                          <Column size="123"/>
                          <Column size="225"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                          <Cell col="1" text="사업장"/>
                          <Cell col="2" text="매출일자"/>
                          <Cell col="3" text="매출채권번호"/>
                          <Cell col="4" text="채권액"/>
                          <Cell col="5" text="대체액"/>
                          <Cell col="6" text="대체잔액"/>
                          <Cell col="7" text="비고"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" displaytype="text" text="bind:upjang"/>
                          <Cell col="2" displaytype="text" style="align:center;" text="bind:occurDate"/>
                          <Cell col="3" style="align:left;" text="bind:arNum"/>
                          <Cell col="4" style="align:right middle;" text="bind:arAmt"/>
                          <Cell col="5" style="align:right middle;" text="bind:receiveAmt"/>
                          <Cell col="6" style="align:right middle;" text="bind:arBalAmt"/>
                          <Cell col="7" displaytype="text" style="align:left;" text="bind:remark"/>
                        </Band>
                        <Band id="summary">
                          <Cell colspan="4" style="align:right;" text="합   계 :" taborder="undefined"/>
                          <Cell col="4" displaytype="number" style="align:right middle;" expr="expr:getSumNF('arAmt')"/>
                          <Cell col="5" displaytype="number" style="align:right middle;" expr="expr:getSumNF('receiveAmt')"/>
                          <Cell col="6" displaytype="number" style="align:right middle;" expr="expr:getSumNF('arBalAmt')"/>
                          <Cell col="7"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage9" text="영업사원 매출집계">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" taborder="0" binddataset="ds_list8" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 15 1225 537" anchor="all" autofittype="none">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="80"/>
                          <Column size="140"/>
                          <Column size="137"/>
                          <Column size="85"/>
                          <Column size="199"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="80"/>
                          <Column size="116"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="119"/>
                          <Column size="101"/>
                          <Column size="109"/>
                          <Column size="109"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                          <Cell col="1"/>
                          <Cell col="2" text="관리부서"/>
                          <Cell col="3" text="영업사원"/>
                          <Cell col="4" text="본사"/>
                          <Cell col="5" text="본사명"/>
                          <Cell col="6" text="사업장"/>
                          <Cell col="7" text="사업장명"/>
                          <Cell col="8" text="구분"/>
                          <Cell col="9" text="매출합(VAT제외)"/>
                          <Cell col="10" text="순수이익액"/>
                          <Cell col="11" text="순수이익율"/>
                          <Cell col="12" text="이익액(VAT별도)"/>
                          <Cell col="13" text="이익율"/>
                          <Cell col="14" text="순수이익액"/>
                          <Cell col="15" text="순수이익율"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:left middle;" text="bind:lineName"/>
                          <Cell col="2" displaytype="text" text="bind:ccNm"/>
                          <Cell col="3" style="align:left;" text="bind:partSalesSabun"/>
                          <Cell col="4" displaytype="text" style="align:center;" text="bind:mainUpjang"/>
                          <Cell col="5" style="align:left;" text="bind:mainUpjangnm"/>
                          <Cell col="6" displaytype="text" style="align:center;" text="bind:upjang"/>
                          <Cell col="7" displaytype="text" style="align:left middle;" text="bind:upjangnm"/>
                          <Cell col="8" style="align:center;" text="bind:gubun"/>
                          <Cell col="9" displaytype="number" style="align:right;" text="bind:saleSum"/>
                          <Cell col="10" displaytype="number" text="bind:marginSum2"/>
                          <Cell col="11" displaytype="number" text="expr:fn_marginSet2(currow)"/>
                          <Cell col="12" displaytype="number" text="bind:marginSum"/>
                          <Cell col="13" displaytype="number" text="bind:marginRatio"/>
                          <Cell col="14" displaytype="number" text="bind:marginSum2"/>
                          <Cell col="15" displaytype="number" text="bind:marginRatio2"/>
                        </Band>
                        <Band id="summary">
                          <Cell colspan="9" style="align:right middle;" text="합   계 :" taborder="undefined"/>
                          <Cell col="9" displaytype="number" style="align:right middle;" expr="expr:getCaseSum(&quot;lineName==''&quot;,&quot;saleSum&quot;)"/>
                          <Cell col="10" displaytype="number" expr="expr:getCaseSum(&quot;lineName==''&quot;,&quot;marginSum2&quot;)"/>
                          <Cell col="11" displaytype="number" expr="expr:gfn_round(gfn_parseFloat((ds_list8.getSum(&quot;marginSum2&quot;)/ds_list8.getSum(&quot;saleSum&quot;)) * 100),2)" mask="#,##0.#0"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" expr="expr:getCaseSum(&quot;lineName==''&quot;,&quot;marginSum&quot;)"/>
                          <Cell col="13" displaytype="number" expr="expr:gfn_round(gfn_parseFloat((ds_list8.getCaseSum(&quot;lineName==''&quot;,&quot;marginSum&quot;)/ds_list8.getCaseSum(&quot;lineName==''&quot;,&quot;saleSum&quot;)) * 100),2)" mask="#,##0.#0"/>
                          <Cell col="14" displaytype="number" expr="expr:getCaseSum(&quot;lineName==''&quot;,&quot;marginSum2&quot;)"/>
                          <Cell col="15" displaytype="number" expr="expr:gfn_round(gfn_parseFloat((ds_list8.getCaseSum(&quot;lineName==''&quot;,&quot;marginSum2&quot;)/ds_list8.getCaseSum(&quot;lineName==''&quot;,&quot;saleSum&quot;)) * 100),2)" mask="#,##0.#0"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage10" text="CS 매출집계">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" taborder="0" binddataset="ds_list9" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 9 15 1225 537" anchor="all" autofittype="none">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="80"/>
                          <Column size="140"/>
                          <Column size="137"/>
                          <Column size="85"/>
                          <Column size="199"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="80"/>
                          <Column size="116"/>
                          <Column size="119"/>
                          <Column size="101"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                          <Cell col="1"/>
                          <Cell col="2" text="관리부서"/>
                          <Cell col="3" text="CS사원"/>
                          <Cell col="4" text="본사"/>
                          <Cell col="5" text="본사명"/>
                          <Cell col="6" text="사업장"/>
                          <Cell col="7" text="사업장명"/>
                          <Cell col="8" text="구분"/>
                          <Cell col="9" text="매출합(VAT제외)"/>
                          <Cell col="10" text="이익액(VAT별도)"/>
                          <Cell col="11" text="이익율"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:left middle;" text="bind:lineName"/>
                          <Cell col="2" displaytype="text" text="bind:ccNm"/>
                          <Cell col="3" style="align:left;" text="bind:csSabun"/>
                          <Cell col="4" displaytype="text" style="align:center;" text="bind:mainUpjang"/>
                          <Cell col="5" style="align:left;" text="bind:mainUpjangnm"/>
                          <Cell col="6" displaytype="text" style="align:center;" text="bind:upjang"/>
                          <Cell col="7" displaytype="text" style="align:left;" text="bind:upjangnm"/>
                          <Cell col="8" displaytype="text" style="align:center;" text="bind:gubun"/>
                          <Cell col="9" displaytype="number" style="align:right;" text="bind:saleSum"/>
                          <Cell col="10" displaytype="number" text="bind:marginSum"/>
                          <Cell col="11" displaytype="number" text="bind:marginRatio"/>
                        </Band>
                        <Band id="summary">
                          <Cell colspan="9" style="align:right middle;" text="합   계 :" taborder="undefined"/>
                          <Cell col="9" displaytype="number" style="align:right middle;" expr="expr:getCaseSum(&quot;lineName==''&quot;,&quot;saleSum&quot;)"/>
                          <Cell col="10" displaytype="number" style="align:right middle;" expr="expr:getCaseSum(&quot;lineName==''&quot;,&quot;marginSum&quot;)"/>
                          <Cell col="11" displaytype="number" expr="expr:gfn_round(gfn_parseFloat((ds_list9.getCaseSum(&quot;lineName==''&quot;,&quot;marginSum&quot;)/ds_list9.getCaseSum(&quot;lineName==''&quot;,&quot;saleSum&quot;)) * 100),2)" mask="#,##0.#0"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage11" text="선택자재매출조회">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" taborder="0" binddataset="ds_list10" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 15 1225 537" anchor="all">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="81"/>
                          <Column size="81"/>
                          <Column size="154"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="81"/>
                          <Column size="154"/>
                          <Column size="154"/>
                          <Column size="117"/>
                          <Column size="117"/>
                          <Column size="117"/>
                          <Column size="117"/>
                          <Column size="117"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel" taborder="undefined"/>
                          <Cell col="1" text="관리부서" taborder="undefined"/>
                          <Cell col="2" text="본사" taborder="undefined"/>
                          <Cell col="3" text="본사명" taborder="undefined"/>
                          <Cell col="4" text="사업장" taborder="undefined"/>
                          <Cell col="5" text="사업장명" taborder="undefined"/>
                          <Cell col="6" text="영업사원" taborder="undefined"/>
                          <Cell col="7" text="사업장"/>
                          <Cell col="8" text="사업장명"/>
                          <Cell col="9" text="영업사원"/>
                          <Cell col="10" text="발주수량"/>
                          <Cell col="11" text="매입액"/>
                          <Cell col="12" text="매출액"/>
                          <Cell col="13" text="이익액"/>
                          <Cell col="14" text="이익율"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:left;" text="bind:ccNm"/>
                          <Cell col="2" displaytype="text" style="align:center middle;" text="bind:mainUpjang"/>
                          <Cell col="3" displaytype="text" style="align:left;" text="bind:mainUpjangnm"/>
                          <Cell col="4" displaytype="text" style="align:center middle;" text="bind:upjang"/>
                          <Cell col="5" displaytype="text" text="bind:upjangnm"/>
                          <Cell col="6" displaytype="text" style="align:left;" text="bind:salesMan"/>
                          <Cell col="7" displaytype="text" text="bind:upjang"/>
                          <Cell col="8" displaytype="text" text="bind:upjangnm"/>
                          <Cell col="9" displaytype="text" text="bind:salesMan"/>
                          <Cell col="10" displaytype="number" style="align:right middle;" text="bind:itemQty"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" text="bind:transSum"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" text="bind:saleTot"/>
                          <Cell col="13" displaytype="number" style="align:right middle;" text="bind:margin"/>
                          <Cell col="14" displaytype="number" style="align:right middle;" text="expr:fn_marginSet11(currow)"/>
                        </Band>
                        <Band id="summary">
                          <Cell colspan="4" style="align:right middle;" text="합   계 :" taborder="undefined"/>
                          <Cell col="4"/>
                          <Cell col="5"/>
                          <Cell col="6"/>
                          <Cell col="7"/>
                          <Cell col="8"/>
                          <Cell col="9"/>
                          <Cell col="10" displaytype="number" style="align:right middle;" expr="expr:getSumNF('itemQty')"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" expr="bind:transSum"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" expr="bind:saleTot"/>
                          <Cell col="13" displaytype="number" style="align:right middle;" expr="expr:getSumNF('margin')"/>
                          <Cell col="14" displaytype="number" style="align:right middle;" expr="expr:gfn_round(gfn_parseFloat((ds_list10.getSum(&quot;margin&quot;)/ds_list10.getSum(&quot;saleTot&quot;)) * 100),2)" mask="#,##0.#0"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Static id="Static15" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 1 123 1236 138" anchor="left top"/>
        <Static id="Static19" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1 154 11 717"/>
        <Static id="Static20" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1226 154 1236 699"/>
        <Static id="Static35" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 11 699 1246 709" anchor="left top"/>
        <ObjCalendar id="cal_FDate" titletext="캘린더" taborder="5" onkeydown="cal_saleDate_onkeydown" text="20150101" scrollbars="none" position="absolute 1006 41 1106 62"/>
        <ObjCalendar id="cal_TDate" titletext="캘린더" taborder="6" onkeydown="cal_saleDate_onkeydown" text="20150101" scrollbars="none" position="absolute 1122 41 1222 62"/>
        <Combo id="cbo_centerCode" taborder="3" innerdataset="ds_center" codecolumn="centerCode" datacolumn="centerName" class="cmb_WF_Essential" position="absolute 638 40 786 61" anchor="left top" enable="true" onitemchanged="cbo_centerCode_onitemchanged" tabstop="false"/>
        <TmSearchComponent id="comp_tm" titletext="팀 검색용 Component" taborder="0" text="TmSearchComponent00" position="absolute 84 40 257 61" bindDataset="ds_search" bindTmCdColumn="schTm" bindTmNmColumn="schTmNm" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tm" eventBeforeTrigger="" onkeydown="comp_tm_onkeydown"/>
        <UpjangSearchComponent id="comp_mainUpjang" titletext="업장 검색용 Component" taborder="7" onkeydown="comp_mainUpjang_onkeydown" text="UpjangSearchComponent00" position="absolute 83 66 256 87" bindDataset="ds_search" bindUpjangCodeColumn="schMainUpjang" bindUpjangNameColumn="schMainUpjangNm" eventBeforeTrigger="" eventAfterTrigger="fn_mainUpjang" roleSetId="FmsMainUpjang"/>
        <UpjangSearchComponent id="comp_upjang" titletext="업장 검색용 Component" taborder="8" text="UpjangSearchComponent03" position="absolute 353 66 538 87" bindDataset="ds_search" bindUpjangCodeColumn="schUpjang" bindUpjangNameColumn="schUpjangNm" eventBeforeTrigger="" eventAfterTrigger="" roleSetId="FmsUpjang"/>
        <Edit id="edt_cust" taborder="9" readonly="true" onkeydown="edt_cust_onkeydown" position="absolute 638 66 767 87" style=":disabled {cursor:arrowwait;}" userdata="" oneditclick="edt_cust_oneditclick"/>
        <Button id="btn_cust" taborder="10" tabstop="false" onclick="fn_edBtn_OnClick" class="btn_WF_popSearch" position="absolute 766 66 787 87"/>
        <MuSearchComponent id="comp_mu" titletext="사업부 선택 Component" taborder="20" text="MuSearchComponent00" class="cmb_WF_Essential" position="absolute 1265 154 1367 175" bindDataset="ds_search" bindMuCdColumn="schMu" appendText="NOT" onItemChangedEvent="" visible="false"/>
        <Static id="Static21" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 254 40 284 61" anchor="left top"/>
        <Static id="Static22" text="CC" class="sta_WFSA_label" position="absolute 285 41 347 62" anchor="left top" visible="true"/>
        <Static id="Static23" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 344 42 354 63" anchor="left top"/>
        <Edit id="edt_ccCd" taborder="1" readonly="true" position="absolute 353 41 519 62" anchor="left top" onkeydown="edt_ccCd_onkeydown" visible="true"/>
        <Button id="btn_ccCd" taborder="2" class="btn_WF_popSearch" position="absolute 517 41 538 62" visible="true" onclick="btn_ccCd_onclick"/>
        <CheckBox id="chk_1" taborder="15" text="ck물류비제외" truevalue="1" position="absolute 828 91 918 112" userdata="001" onclick="chk_1_onclick"/>
        <CheckBox id="chk_2" taborder="16" text="지급수수료제외" truevalue="1" position="absolute 942 91 1049 112" userdata="001" onclick="chk_2_onclick"/>
        <CheckBox id="chk_3" taborder="17" text="장려금제외" truevalue="1" position="absolute 1066 91 1145 112" userdata="001" onclick="chk_3_onclick"/>
        <Radio id="rdo_view" taborder="19" columncount="-1" rowcount="-1" position="absolute 1172 145 1363 161" codecolumn="codecolumn" datacolumn="datacolumn" style="textpadding:0 8 0 5;" index="-1" visible="false" onitemchanged="rdo_view_onitemchanged" onitemclick="rdo_view_onitemclick">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">1</Col>
                <Col id="datacolumn">본사별집계</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2</Col>
                <Col id="datacolumn">업장별집계</Col>
              </Row>
            </Rows>
          </Dataset>
        </Radio>
        <Combo id="cbo_gubun" taborder="4" codecolumn="codecolumn" datacolumn="datacolumn" index="0" position="absolute 880 40 997 61" anchor="left top" value="1" text="거래명세서기준">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">1</Col>
                <Col id="datacolumn">거래명세서기준</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2</Col>
                <Col id="datacolumn">회계수정일기준</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Combo id="cbo_price" taborder="11" codecolumn="codecolumn" datacolumn="datacolumn" index="0" position="absolute 880 66 997 87" anchor="left top" visible="true" value="1" text="매입단가기준" enable="false" style=":disabled {background:white;}">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">1</Col>
                <Col id="datacolumn">매입단가기준</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2</Col>
                <Col id="datacolumn">매입원가기준</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Edit id="edt_ORD_SABUNQuery" taborder="12" readonly="true" autoselect="true" position="absolute 83 92 239 113" onkeydown="edt_sabun_onkeydown"/>
        <Button id="edtBtn_ORD_SABUNQuery" taborder="13" tabstop="false" class="btn_WF_popSearch" position="absolute 236 92 256 113" onclick="edtBtn_ORD_SABUNQuery_onclick"/>
        <Static id="st_ORD_SABUNQuery" text="영업담당" class="sta_WFSA_label" position="absolute 14 92 89 113" userdata="strMAQuery_SABUN"/>
        <Static id="Static16" text="W10" visible="false" position="absolute 13 112 276 122" style="background:#ff000055;align:center middle;"/>
        <Static id="Static18" text="W05." visible="false" position="absolute 8 87 546 92" style="background:#ff000055;align:center middle;"/>
        <Static id="Static24" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 73 92 83 113" anchor="left top"/>
        <Static id="Static25" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 255 91 285 112" anchor="left top"/>
        <Static id="Static26" text="조회기간" class="sta_WFSA_label" position="absolute 817 42 879 63" anchor="left top"/>
        <Static id="Static27" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 875 41 885 62" anchor="left top"/>
        <Static id="Static30" text="단가구분" class="sta_WFSA_label" position="absolute 817 66 879 87" anchor="left top"/>
        <Static id="Static31" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 875 65 885 86" anchor="left top"/>
        <Static id="Static32" text="세부직군" class="sta_WFSA_label" position="absolute 286 92 348 113" anchor="left top"/>
        <Static id="Static33" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 344 92 354 113" anchor="left top"/>
        <Combo id="cbo_bizDetail" taborder="14" displayrowcount="10" position="absolute 353 92 538 113"/>
        <Static id="Static34" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 538 91 568 112" anchor="left top"/>
        <Static id="stc_cust" text="공급업체" class="sta_WFSA_label" position="absolute 1009 66 1071 87" anchor="left top" visible="true"/>
        <Combo id="cbo_custYn" taborder="22" codecolumn="codecolumn" datacolumn="datacolumn" index="0" enable="true" position="absolute 1076 66 1145 87" anchor="left top" style=":disabled {background:white;}" value="1" text="미포함" visible="true" onitemchanged="cbo_custYn_onitemchanged">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">미포함</Col>
              </Row>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">포함</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="Static36" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 1066 65 1076 86" anchor="left top"/>
        <Static id="Static37" text="자재/분류" class="sta_WFSA_label" position="absolute 562 92 629 113" anchor="left top" onclick="Static37_onclick"/>
        <Static id="Static38" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 628 92 638 113" anchor="left top"/>
        <Edit id="edt_item" taborder="23" readonly="true" onkeydown="edt_item_onkeydown" oneditclick="edt_item_oneditclick" position="absolute 638 92 767 113" style=":disabled {cursor:arrowwait;}" userdata=""/>
        <Button id="btn_item" taborder="24" tabstop="false" onclick="fn_btn_item_onclick" class="btn_WF_popSearch" position="absolute 766 92 787 113"/>
        <Static id="Static39" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 787 92 817 113" anchor="left top"/>
        <Edit id="edt_item_cd" taborder="25" readonly="true" onkeydown="edt_item_onkeydown" oneditclick="edt_item_oneditclick" position="absolute 1261 97 1349 118" style=":disabled {cursor:arrowwait;}" userdata="" visible="false"/>
        <Edit id="schSelGubun" taborder="27" readonly="true" visible="false" position="absolute 1261 65 1338 86" style=":disabled {cursor:arrowwait;}" userdata=""/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_list0" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="transDate" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="transUom" type="STRING" size="256"/>
          <Column id="transUprice" type="STRING" size="256"/>
          <Column id="transVat" type="STRING" size="256"/>
          <Column id="transSum" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="saleAmt" type="STRING" size="256"/>
          <Column id="saleVat" type="STRING" size="256"/>
          <Column id="saleSum" type="STRING" size="256"/>
          <Column id="transUamount" type="STRING" size="256"/>
          <Column id="marginAmt" type="STRING" size="256"/>
          <Column id="marginRatio" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_center" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="centerName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schCenter" type="STRING" size="256"/>
          <Column id="schToDate" type="STRING" size="256"/>
          <Column id="schFromDate" type="STRING" size="256"/>
          <Column id="schMu" type="STRING" size="256"/>
          <Column id="schTm" type="STRING" size="256"/>
          <Column id="schCc" type="STRING" size="256"/>
          <Column id="schCcNm" type="STRING" size="256"/>
          <Column id="schMainUpjang" type="STRING" size="256"/>
          <Column id="schUpjang" type="STRING" size="256"/>
          <Column id="schCustCd" type="STRING" size="256"/>
          <Column id="tabIndex" type="STRING" size="256"/>
          <Column id="schCustNm" type="STRING" size="256"/>
          <Column id="schUpjangNm" type="STRING" size="256"/>
          <Column id="schMainUpjangNm" type="STRING" size="256"/>
          <Column id="schTmNm" type="STRING" size="256"/>
          <Column id="schCenterName" type="STRING" size="256"/>
          <Column id="schView" type="STRING" size="256"/>
          <Column id="schChk1" type="STRING" size="256"/>
          <Column id="schChk2" type="STRING" size="256"/>
          <Column id="schChk3" type="STRING" size="256"/>
          <Column id="schGubun" type="STRING" size="256"/>
          <Column id="schPrice" type="STRING" size="256"/>
          <Column id="schSabun" type="STRING" size="256"/>
          <Column id="schSabunNm" type="STRING" size="256"/>
          <Column id="schBizDetail" type="STRING" size="256"/>
          <Column id="mCloseYn" type="STRING" size="256"/>
          <Column id="schCustYn" type="STRING" size="256"/>
          <Column id="edt_item" type="STRING" size="256"/>
          <Column id="edt_item_cd" type="STRING" size="256"/>
          <Column id="schSelGubun" type="STRING" size="256"/>
          <Column id="newGubun" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list1" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="mainUpjangnmDisp" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="upjangnm" type="STRING" size="256"/>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="subinvNameDisp" type="STRING" size="256"/>
          <Column id="bizDetailName" type="STRING" size="256"/>
          <Column id="saleAmount" type="STRING" size="256"/>
          <Column id="saleVat" type="STRING" size="256"/>
          <Column id="saleSum" type="STRING" size="256"/>
          <Column id="transAmount" type="STRING" size="256"/>
          <Column id="transVat" type="STRING" size="256"/>
          <Column id="transSum" type="STRING" size="256"/>
          <Column id="marginAmt" type="STRING" size="256"/>
          <Column id="marginRatio" type="STRING" size="256"/>
          <Column id="incomePrice" type="STRING" size="256"/>
          <Column id="incomeSum" type="STRING" size="256"/>
          <Column id="incomeTransSum" type="STRING" size="256"/>
          <Column id="incomeMarginAmt" type="STRING" size="256"/>
          <Column id="incomeMarginRatio" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="classM" type="STRING" size="256"/>
          <Column id="classS" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="transUom" type="STRING" size="256"/>
          <Column id="transMprice" type="STRING" size="256"/>
          <Column id="transAmount" type="STRING" size="256"/>
          <Column id="transVat" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="saleAmount" type="STRING" size="256"/>
          <Column id="saleVat" type="STRING" size="256"/>
          <Column id="saleSum" type="STRING" size="256"/>
          <Column id="transSum" type="STRING" size="256"/>
          <Column id="marginAmt" type="STRING" size="256"/>
          <Column id="marginRatio" type="STRING" size="256"/>
          <Column id="transQty" type="STRING" size="256"/>
          <Column id="incomePrice" type="STRING" size="256"/>
          <Column id="incomeSum" type="STRING" size="256"/>
          <Column id="incomeTransSum" type="STRING" size="256"/>
          <Column id="incomeMarginAmt" type="STRING" size="256"/>
          <Column id="incomeMarginRatio" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list3" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="upjangnmDisp" type="STRING" size="256"/>
          <Column id="a0101" type="BIGDECIMAL" size="256"/>
          <Column id="a0102" type="BIGDECIMAL" size="256"/>
          <Column id="a0103" type="BIGDECIMAL" size="256"/>
          <Column id="a0104" type="BIGDECIMAL" size="256"/>
          <Column id="a0105" type="BIGDECIMAL" size="256"/>
          <Column id="a0106" type="BIGDECIMAL" size="256"/>
          <Column id="a0107" type="BIGDECIMAL" size="256"/>
          <Column id="a0108" type="BIGDECIMAL" size="256"/>
          <Column id="a0109" type="BIGDECIMAL" size="256"/>
          <Column id="b0101" type="BIGDECIMAL" size="256"/>
          <Column id="b0102" type="BIGDECIMAL" size="256"/>
          <Column id="b0103" type="BIGDECIMAL" size="256"/>
          <Column id="b0104" type="BIGDECIMAL" size="256"/>
          <Column id="b0105" type="BIGDECIMAL" size="256"/>
          <Column id="b0106" type="BIGDECIMAL" size="256"/>
          <Column id="b0107" type="BIGDECIMAL" size="256"/>
          <Column id="b0108" type="BIGDECIMAL" size="256"/>
          <Column id="b0109" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list4" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="transDate" type="STRING" size="256"/>
          <Column id="taxall1" type="STRING" size="256"/>
          <Column id="notax1" type="STRING" size="256"/>
          <Column id="tax1" type="STRING" size="256"/>
          <Column id="vat1" type="STRING" size="256"/>
          <Column id="all1" type="STRING" size="256"/>
          <Column id="taxall2" type="STRING" size="256"/>
          <Column id="notax2" type="STRING" size="256"/>
          <Column id="tax2" type="STRING" size="256"/>
          <Column id="vat2" type="STRING" size="256"/>
          <Column id="all2" type="STRING" size="256"/>
          <Column id="marginAmt" type="STRING" size="256"/>
          <Column id="marginRatio" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list5" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="mainUpjangnm" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="upjangnm" type="STRING" size="256"/>
          <Column id="salesMan" type="STRING" size="256"/>
          <Column id="transSum" type="STRING" size="256"/>
          <Column id="transVat" type="STRING" size="256"/>
          <Column id="transTot" type="STRING" size="256"/>
          <Column id="saleNotax" type="STRING" size="256"/>
          <Column id="saleTax" type="STRING" size="256"/>
          <Column id="saleVat" type="STRING" size="256"/>
          <Column id="saleTot" type="STRING" size="256"/>
          <Column id="saleAll" type="STRING" size="256"/>
          <Column id="margin" type="STRING" size="256"/>
          <Column id="marginRatio" type="STRING" size="256"/>
          <Column id="opSum" type="STRING" size="256"/>
          <Column id="opVat" type="STRING" size="256"/>
          <Column id="opTot" type="STRING" size="256"/>
          <Column id="bizDetailName" size="256" type="STRING"/>
          <Column id="contractTerm" type="STRING" size="256"/>
          <Column id="masterclass0" type="STRING" size="256"/>
          <Column id="masterclass1" type="STRING" size="256"/>
          <Column id="masterclass2" type="STRING" size="256"/>
          <Column id="masterclass3" type="STRING" size="256"/>
          <Column id="masterclass4" type="STRING" size="256"/>
          <Column id="incomePrice" type="STRING" size="256"/>
          <Column id="incomeSum" type="STRING" size="256"/>
          <Column id="incomeTransSum" type="STRING" size="256"/>
          <Column id="incomeMarginAmt" type="STRING" size="256"/>
          <Column id="incomeMarginRatio" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list6" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="upjangnm" type="STRING" size="256"/>
          <Column id="custnm" type="STRING" size="256"/>
          <Column id="className" type="STRING" size="256"/>
          <Column id="transAmt" type="STRING" size="256"/>
          <Column id="tramsVat" type="STRING" size="256"/>
          <Column id="saleAmt" type="STRING" size="256"/>
          <Column id="saleSum" type="STRING" size="256"/>
          <Column id="elAmt" type="STRING" size="256"/>
          <Column id="elRate" type="STRING" size="256"/>
          <Column id="formnm" type="STRING" size="256"/>
          <Column id="difAmt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list7" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="occurDate" type="STRING" size="256"/>
          <Column id="arNum" type="STRING" size="256"/>
          <Column id="arAmt" type="STRING" size="256"/>
          <Column id="receiveAmt" type="STRING" size="256"/>
          <Column id="saleAmt" type="STRING" size="256"/>
          <Column id="note" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list8" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="lineName" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="partSalesSabun" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="mainUpjangnm" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="upjangnm" type="STRING" size="256"/>
          <Column id="gubun" type="STRING" size="256"/>
          <Column id="saleSum" type="STRING" size="256"/>
          <Column id="marginSum" type="STRING" size="256"/>
          <Column id="marginRatio" type="STRING" size="256"/>
          <Column id="marginSum2" type="STRING" size="256"/>
          <Column id="marginRatio2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list9" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="lineName" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="csSabun" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="mainUpjangnm" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="upjangnm" type="STRING" size="256"/>
          <Column id="gubun" type="STRING" size="256"/>
          <Column id="saleSum" type="STRING" size="256"/>
          <Column id="marginSum" type="STRING" size="256"/>
          <Column id="marginRatio" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">0</Col>
            <Col id="delYn">0</Col>
            <Col id="savYn">0</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">0</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_searchValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schGubun" type="STRING" size="256"/>
          <Column id="schFromDate" type="STRING" size="256"/>
          <Column id="schToDate" type="STRING" size="256"/>
          <Column id="schCenter" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="schGubun">title:조회구분,required:true</Col>
            <Col id="schFromDate">title:기간[시작일],required:true</Col>
            <Col id="schToDate">title:기간[종료일],required:true</Col>
            <Col id="schCenter">title:물류센터,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_saleTtzInfo" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_list10" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="upjangnm" type="STRING" size="256"/>
          <Column id="custnm" type="STRING" size="256"/>
          <Column id="className" type="STRING" size="256"/>
          <Column id="transSum" type="STRING" size="256"/>
          <Column id="transAmt" type="STRING" size="256"/>
          <Column id="tramsVat" type="STRING" size="256"/>
          <Column id="saleTot" type="STRING" size="256"/>
          <Column id="saleAmt" type="STRING" size="256"/>
          <Column id="saleSum" type="STRING" size="256"/>
          <Column id="elAmt" type="STRING" size="256"/>
          <Column id="elRate" type="STRING" size="256"/>
          <Column id="formnm" type="STRING" size="256"/>
          <Column id="difAmt" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="salesMan" type="STRING" size="256"/>
          <Column id="itemQty" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item1" compid="edt_cust" propid="userdata" datasetid="ds_search" columnid="schCust"/>
      <BindItem id="item3" compid="edt_cust" propid="UserData" datasetid="ds_search" columnid="GUBUN"/>
      <BindItem id="item0" compid="edt_cust" propid="value" datasetid="ds_search" columnid="schCustNm"/>
      <BindItem id="item2" compid="cbo_centerCode" propid="value" datasetid="ds_search" columnid="schCenter"/>
      <BindItem id="item4" compid="cbo_centerCode" propid="text" datasetid="ds_search" columnid="schCenterName"/>
      <BindItem id="item5" compid="edt_ccCd" propid="value" datasetid="ds_search" columnid="schCcNm"/>
      <BindItem id="item6" compid="rdo_view" propid="value" datasetid="ds_search" columnid="schView"/>
      <BindItem id="item7" compid="chk_1" propid="value" datasetid="ds_search" columnid="schChk1"/>
      <BindItem id="item8" compid="chk_2" propid="value" datasetid="ds_search" columnid="schChk2"/>
      <BindItem id="item9" compid="chk_3" propid="value" datasetid="ds_search" columnid="schChk3"/>
      <BindItem id="item10" compid="cbo_gubun" propid="value" datasetid="ds_search" columnid="schGubun"/>
      <BindItem id="item11" compid="cbo_price" propid="value" datasetid="ds_search" columnid="schPrice"/>
      <BindItem id="item12" compid="edt_ORD_SABUNQuery" propid="value" datasetid="ds_search" columnid="schSabunNm"/>
      <BindItem id="cbo_BizDetail_value" compid="cbo_bizDetail" propid="value" datasetid="ds_search" columnid="schBizDetail"/>
      <BindItem id="item13" compid="cbo_custYn" propid="value" datasetid="ds_search" columnid="schCustYn"/>
      <BindItem id="item14" compid="edt_item" propid="userdata" datasetid="ds_search" columnid="schCust"/>
      <BindItem id="item15" compid="edt_item" propid="UserData" datasetid="ds_search" columnid="GUBUN"/>
      <BindItem id="item16" compid="edt_item" propid="value" datasetid="ds_search" columnid="edt_item"/>
      <BindItem id="item17" compid="edt_item_cd" propid="userdata" datasetid="ds_search" columnid="schCust"/>
      <BindItem id="item18" compid="edt_item_cd" propid="UserData" datasetid="ds_search" columnid="GUBUN"/>
      <BindItem id="item19" compid="edt_item_cd" propid="value" datasetid="ds_search" columnid="edt_item_cd"/>
      <BindItem id="item20" compid="schSelGubun" propid="userdata" datasetid="ds_search" columnid="schCust"/>
      <BindItem id="item21" compid="schSelGubun" propid="UserData" datasetid="ds_search" columnid="GUBUN"/>
      <BindItem id="item22" compid="schSelGubun" propid="value" datasetid="ds_search" columnid="schSelGubun"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : BuySaleSum
  파 일 명 : BuySaleSum.xfdl
  기    능 : 식재영업 > 매입매출집계

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------

1) 기타
- 매입매출집계 탭의 운영율 계산 : 그리드 합계 부분
=> OLD : ds_list5.rowcount<1 ? 0 : getCaseAvg("iif(saleTot==0,0,Math.round(100*((opSum/saleTot)-1))) > 0", "iif(saleTot==0,0,Math.round(100*((opSum/saleTot)-1)))")
현재 : iif(getSumNF('saleTot')==0,0,Math.round(100*((getSumNF('opSum')/getSumNF('saleTot'))-1)))
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수) 
************************************************************************************************/
include "U_lib::lib_conversionCom.xjs";  
include "lib::lib_com.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();
var tabIndex = 0;
var fv_orgHto = application.httptimeout;
/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();

	//2020.02.21 김명섭 조회분기처리 구분값 설정
	var rtnParam = gfn_getScreenParams();
	
	if(rtnParam[0] == "NEW")
	{
		ds_search.setColumn(0,"newGubun","Y");
	}
	else
	{
		ds_search.setColumn(0,"newGubun","N");
	}

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{	
	fn_searchCenter();
	ds_search.addRow();
	ds_search.setColumn(0,"tabIndex",tabIndex);
	cal_FDate.fn_initMonthCal(this, gfn_today(), "", ds_search, "schFromDate", "Y");		//검색 시작 일
	cal_TDate.fn_initMonthCal(this, gfn_today(), "", ds_search, "schToDate", "Y");		//검색 종료 일

	ds_search.setColumn(0,"schView","1");		// 본사
	ds_search.setColumn(0,"schGubun", "1");		// 조회일자구분

	// 기본적으로 단가기준은 관리단가
	ds_search.setColumn(0,"schPrice", "1");		// 단가구분
	ds_search.setColumn(0,"schCustYn", "N");		// 단가구분

	comp_mu.setMuCode('2004')
	// 팀 초기화
	comp_tm.applyAuthLevel(comp_mu);
	// 본사
	comp_mainUpjang.applyAuthLevel(comp_tm);
	comp_mainUpjang.setMainUpjang(true);
	// 사업장(식재사업)
	comp_upjang.applyAuthLevel(comp_tm);
	comp_upjang.applyMainUpjang(comp_mainUpjang);
	
	SCPopup.bind(this, "CcCode", "edt_ccCd", "btn_ccCd", null, {muCd:"", tmCd:""}, {before:"fn_ccBeforeEvent", after:"fn_ccAfterEvent"});
	
	// 최초화면표시시 조회조건 숨김처리
	Static37.visible = false;
	edt_item.visible = false;
	btn_item.visible = false;	
	
	// 공통코드(DATA_SET) 정의 : 구매매입단가조회권한 SET
	SCDataset.bind(this, "ComCode", "ds_dataSet", {groupCode:"FMS_PRICE_VIEW", code:g_EmpNo, useYn:"Y"}, "fn_priceView");
	
	// 세부직군 COMBO 초기화
	SCCombo.bind(this, "ComCode", "cbo_bizDetail", null, {groupCode:"FM0021", useYn:"Y"}, SCCombo.ALL);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{
	// 변경사항 체크(입력 프로그램일때 변경되는 Dataset 전체 기술)
// 	if (gfn_dsIsUpdated(ds_list) == true) 
// 	{
// 		// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
//         if (!gfn_confirm("confirm.before.movepage")) return false;
//     }
//     
    // 조회프로그램에도 Return true; 기술해 주세요!
	return true;
}


/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
	//application.httptimeout = 0;
	// 변경사항 체크
	//if (gfn_dsIsUpdated(ds_list) == true) 
	//{
	//	var retValue = gfn_confirm("confirm.before.search");	// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
	//	if (retValue == false) return;
	//}

	// 조회시 Validation Check
	if (gfn_validCheck(ds_search, ds_searchValid, true) == false) return;
	
	
	// 기간 CHECK
	if (cal_FDate.text > cal_TDate.text) {
 		gfn_alert("msg.err.validator.date.great");	// 종료일이 시작일보다 빠릅니다.
 		cal_FDate.setFocus();
		return;
	}
	
// [속도개선 Project 시작] 2017. 8. 24. 최범주 매출집계정보조회 기능 추가
	////////////////////////////////////////////////////////////////////////////////////////////////////////
	// 매출집계정보 조회
	fn_searchSaleTtzInfo();
	
	// 매출집계정보가 없을 경우
	if ( ds_search.getColumn(0, "mCloseYn") == "N" ) {
		// 동일한 월에 대해서만 조회가능
		if (gfn_subStr(cal_FDate.text, 0, 6) != gfn_subStr(cal_TDate.text, 0, 6))
		{
			if ( gfn_getDiffDay(cal_FDate.text, cal_TDate.text) <= 6 ) {
				// ok
			} else if ( gfn_getDiffDay(cal_FDate.text, cal_TDate.text) > 6  ) {
				gfn_alert("동일한 월이 아닌 경우 최대 조회 기간은 7일 이하로 지정하여 주십시요.");
				cal_TDate.setFocus();
				return;
			} else {
				gfn_alert("기간은 동일한 월을 지정하여 주십시요.");
				cal_FDate.setFocus();
				return;
			}
		}	
	}
	
	if((tabIndex == 10)&&(gfn_length(edt_item_cd.value)==0)){
		gfn_alert("자재/분류를 선택하여 주십시요.");
        edt_item.setFocus();
		return;
	}
// [속도개선 Project   끝] 2017. 8. 24. 최범주

    // Grid sort 표시 초기화(필수)
    if(tabIndex == 0)gfn_clearSortMark(Tab_BuySale.tabpage1.grd_list);
    else if(tabIndex == 1)gfn_clearSortMark(Tab_BuySale.tabpage2.grd_list);
    else if(tabIndex == 2)gfn_clearSortMark(Tab_BuySale.tabpage3.grd_list);
    else if(tabIndex == 3)gfn_clearSortMark(Tab_BuySale.tabpage4.grd_list);
    else if(tabIndex == 4)gfn_clearSortMark(Tab_BuySale.tabpage5.grd_list);
    else if(tabIndex == 5)gfn_clearSortMark(Tab_BuySale.tabpage6.grd_list);
    else if(tabIndex == 6)gfn_clearSortMark(Tab_BuySale.tabpage7.grd_list);
    else if(tabIndex == 7)gfn_clearSortMark(Tab_BuySale.tabpage8.grd_list);
    else if(tabIndex == 8)gfn_clearSortMark(Tab_BuySale.tabpage9.grd_list);
    else if(tabIndex == 9)gfn_clearSortMark(Tab_BuySale.tabpage10.grd_list);
    else if(tabIndex == 10)gfn_clearSortMark(Tab_BuySale.tabpage11.grd_list);
    
    // CH201702_00021
    application.httptimeout = 0;	// 60분
    
	// 조건 : 영업담당
	if (ffn_ChkNull(ds_search.getColumn(ds_search.rowposition, "schSabunNm")))
		ds_search.setColumn(ds_search.rowposition,"schSabun","");
	else
		ds_search.setColumn(ds_search.rowposition,"schSabun",edt_ORD_SABUNQuery.userdata);

	var strSvcID    = "search";
	var strURL      =  "fm/fmf/buySaleSum/selectList.xdo";
    var strInDs     = "ds_search=ds_search";
    var strOutDs    = "ds_list"+tabIndex+"=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
	
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	
	application.httptimeout = fv_orgHto;
	
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {
        case "search" :    		// 코드분류 조회
            //trace(ds_list2.saveXML());
            if ( (Tab_BuySale.tabindex == 0) ) {
				if (ds_search.getColumn(0, "schCustYn") == "Y") {
					Tab_BuySale.tabpages[Tab_BuySale.tabindex].grd_list.setFormatColProperty(16, "size", 80);
					Tab_BuySale.tabpages[Tab_BuySale.tabindex].grd_list.setFormatColProperty(17, "size", 300);
				} else {
					Tab_BuySale.tabpages[Tab_BuySale.tabindex].grd_list.setFormatColProperty(16, "size", 0);
					Tab_BuySale.tabpages[Tab_BuySale.tabindex].grd_list.setFormatColProperty(17, "size", 0);
				}
			} else if ( (Tab_BuySale.tabindex == 2) ) {
				if (ds_search.getColumn(0, "schCustYn") == "Y") {
					Tab_BuySale.tabpages[Tab_BuySale.tabindex].grd_list.setFormatColProperty(20, "size", 80);
					Tab_BuySale.tabpages[Tab_BuySale.tabindex].grd_list.setFormatColProperty(21, "size", 300);
				} else {
					Tab_BuySale.tabpages[Tab_BuySale.tabindex].grd_list.setFormatColProperty(20, "size", 0);
					Tab_BuySale.tabpages[Tab_BuySale.tabindex].grd_list.setFormatColProperty(21, "size", 0);
				}
			}
			
			
			
            break;
            		
        case "save" :			// 저장
			gfn_alert("msg.save.success");	// 저장 되었습니다.
            break;    
		// 센터 조회
        case "searchCenter" :
            //trace(ds_center.saveXML());
            fn_center_init();
            break;            
// [속도개선 Project 시작] 2017. 8. 24. 최범주 매출집계정보조회 기능 추가 mCloseYn
		case "searchSaleTtzInfo" :
			ds_search.setColumn( 0, "mCloseYn", ds_saleTtzInfo.getColumn(0, "saleTtzInfoEstYn") );
		break;
// [속도개선 Project   끝] 2017. 8. 24. 최범주
    }
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/

/*----------------------------------------------------------------------------------------------
 * 설명      : 단가조회용 권한
 *---------------------------------------------------------------------------------------------*/
function fn_priceView(p, ds)
{
	if (p.oid == "ds_dataSet")
	{
		if (ds.getRowCount() > 0) {
			cbo_price.enable = true;
		}
	}
}



/*----------------------------------------------------------------------------------------------
 * 설명      : CC 조회 이벤트 before, after
 *---------------------------------------------------------------------------------------------*/
function fn_ccBeforeEvent(p)
{
	p.option.muCd = ds_search.getColumn(0, "schMu");
	p.option.tmCd = ds_search.getColumn(0, "schTm");
	return true;
}

function fn_ccAfterEvent(p)
{
	ds_search.setColumn(0, "schCc", edt_ccCd.userdata);
	ds_search.setColumn(0, "schCcNm", edt_ccCd.value);
	return true;
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 센터정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchCenter()
{
    var strSvcID    = "searchCenter";
    var strURL      = "fm/fms/upriceContractUpjangSet/selectCenter.xdo";
    var strInDs     = "";
    var strOutDs    = "ds_center=ds_center";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 센터 COMBO 초기화 
 *---------------------------------------------------------------------------------------------*/
function fn_center_init()
{
	var defVal = "";
	//ds_center.filter("centerCode != '*'");
	// COMBO 에 첫번째 Row에 기본값을 SET
	if (ds_center.getRowCount() > 0) {
		defVal = ds_center.getColumn(0, "centerCode");
	}
	cbo_centerCode.value = defVal;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 협력업체 검색 팝업 이벤트  
 *---------------------------------------------------------------------------------------------*/
function fn_edBtn_OnClick(obj:Button,  e:ClickEventInfo)
{

	// 팝업창을 호출한다	
	var strId       = "SaleCustSearch";
	var strURL      = "X_FMS::SalePriceCustSearchPop.xfdl";
	var objArgument = {
		P_DATASET : ds_search
	};
	
	var nWidth      = 513;
	var nHeight     = 495;
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	
	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
	
	if (arrRtn instanceof Object)
	{
		edt_cust.value    = arrRtn["custNm"];
		edt_cust.userdata = arrRtn["custCd"];
		ds_search.setColumn(0,"schCustCd",arrRtn["custCd"]);
		obj.userdata       = arrRtn["custNm"];
	}
}
 
/*----------------------------------------------------------------------------------------------
 * 설명      : 메인업장 변경시 업장 값 초기화
 *---------------------------------------------------------------------------------------------*/
function fn_mainUpjang()
{
	comp_upjang.setUpjangCode("");
	comp_upjang.setUpjangName("");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 메인업장, 업장 값 초기화
 *---------------------------------------------------------------------------------------------*/
function fn_upjangDelete()
{
	fn_mainUpjang();
	comp_mainUpjang.setUpjangCode("");
	comp_mainUpjang.setUpjangName("");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 자재/분류 값 초기화
 *---------------------------------------------------------------------------------------------*/
function fn_itemDelete()
{ 
	edt_item.value = "";
	schSelGubun.value = "";
	edt_item_cd.value = "";
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 
 *---------------------------------------------------------------------------------------------*/
function fn_tm()
{
	//fn_upjangDelete();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 매입매출 집계 - 이익율 계산
 *---------------------------------------------------------------------------------------------*/
function fn_marginSet(row)
{
	var v_saleTot = 0; 	// 매출금액
	var v_margin = 0;	// 이익액	
	var v_calcRate = 0;
	
	v_saleTot = ds_list5.getColumn(row, "saleTot");
	v_margin = ds_list5.getColumn(row, "margin");
	

	if (v_saleTot == "0") return 0;
	
	v_calcRate = (v_margin / v_saleTot) * 100;
	v_calcRate = gfn_round(v_calcRate, 2);
	
	return v_calcRate;
}

function fn_marginSet2(row)
{
	var v_saleTot = 0; 	// 매출금액
	var v_margin = 0;	// 이익액	
	var v_calcRate = 0;
	
	v_saleTot = ds_list8.getColumn(row, "saleSum");
	v_margin = ds_list8.getColumn(row, "marginSum2");
	

	if (v_saleTot == "0") return 0;
	
	v_calcRate = (v_margin / v_saleTot) * 100;
	v_calcRate = gfn_round(v_calcRate, 2);
	
	return v_calcRate;
}

function fn_marginSetIncome(row)
{
	var v_saleTot = 0; 	// 매출금액
	var v_margin = 0;	// 이익액(차감반영)
	var v_calcRate = 0;
	
	v_saleTot = ds_list5.getColumn(row, "saleTot");
	v_margin = ds_list5.getColumn(row, "incomeMarginAmt");
	
	if (v_saleTot == "0") return 0;
	
	v_calcRate = (v_margin / v_saleTot) * 100;
	v_calcRate = gfn_round(v_calcRate, 2);
	
	return v_calcRate;
}

function fn_marginSet11(row)
{
	var v_saleTot = 0; 	// 매출금액
	var v_margin = 0;	// 이익액	
	var v_calcRate = 0;
	
	v_saleTot = ds_list10.getColumn(row, "saleTot");
	v_margin = ds_list10.getColumn(row, "margin");
	

	if (v_saleTot == "0") return 0;
	
	v_calcRate = (v_margin / v_saleTot) * 100;
	v_calcRate = gfn_round(v_calcRate, 2);
	
	return v_calcRate;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 매입매출 집계 - 순수이익율 계산
 *---------------------------------------------------------------------------------------------*/
function fn_marginSumSet(row)
{
	var v_saleTot = 0; 		// 매출금액
	var v_marginSum = 0;	// 순수이익액	
	var v_calcRate = 0;

	v_saleTot = ds_list5.getColumn(row, "saleTot");
	v_marginSum = ds_list5.getColumn(row, "marginSum");
	//장려금 제외시 금액 잘못 나와서 추가
	v_unitSum = ds_list5.getColumn(row, "unitSum");
	

	if (v_saleTot == "0") return 0;
	
	//v_calcRate = (v_marginSum / v_saleTot) * 100;
	v_calcRate = ((v_saleTot - v_unitSum)  / v_saleTot) * 100;
	v_calcRate = gfn_round(v_calcRate, 2);
	
	return v_calcRate;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 일자별요약집계 - 순수이익율 계산
 *---------------------------------------------------------------------------------------------*/
function fn_marginSumSet1(row)
{
	var v_saleTot = 0; 		// 매출금액
	var v_marginSum = 0;	// 순수이익액	
	var v_calcRate = 0;

	v_saleTot = ds_list4.getColumn(row, "taxall2");
	v_marginSum = ds_list4.getColumn(row, "marginSum");
	

	if (v_saleTot == "0") return 0;
	
	v_calcRate = (v_marginSum / v_saleTot) * 100;
	v_calcRate = gfn_round(v_calcRate, 2);
	
	return v_calcRate;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 매입결과보고자료 - 이익율 계산
 *---------------------------------------------------------------------------------------------*/
function fn_elRateSet(row)
{
	var v_saleAmt = 0; 	// 매출금액(부가세 제외)
	var v_elAmt = 0; 	// 이익액(부가세 제외)
	var v_calcRate = 0;
	
	v_saleAmt = ds_list6.getColumn(row, "saleAmt");
	v_elAmt = ds_list6.getColumn(row, "elAmt");
	
	if (v_saleAmt == "0") return 0;
	
	//if (ds_list6.getColumn(row, "transAmt") == "0") return 0;
	
	v_calcRate = (v_elAmt / v_saleAmt) * 100;
	v_calcRate = gfn_round(v_calcRate, 2);
	
	return v_calcRate;
}

// [속도개선 Project 시작] 2017. 8. 24. 최범주 매출집계정보조회 기능 추가
/*----------------------------------------------------------------------------------------------
 * 설명      : 매출집계정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchSaleTtzInfo() {
	////////////////////////////////////////////////////////////////////////////////////////////////////////
	// 초기화
	ds_saleTtzInfo.clearData();
	ds_search.setColumn(0, "mCloseYn", "N");
	
	var strSvcID    = "searchSaleTtzInfo";
	var strURL      = "fm/fmf/buySaleSum/selectSaleTtzInfo.xdo";
    var strInDs     = "ds_search=ds_search";
    var strOutDs    = "ds_saleTtzInfo=ds_saleTtzInfo";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = false;
    var bProgress   = false;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync, bProgress);
  //  alert(ds_search.getColumn(0, "mCloseYn"));
}
// [속도개선 Project   끝] 2017. 8. 24. 최범주

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : form에서 Key Down시 단축키들 지정(공통에서 자동생성, 화면에 스크립트 작성시 화면 스크립트만 실행됨)
 *---------------------------------------------------------------------------------------------*/
// function form_onkeydown(obj:Form, e:KeyEventInfo)
// {
// 	gfn_formKeyDown(obj, e);
// }

/*----------------------------------------------------------------------------------------------
 * 설명      : Grid Header Click시 정렬(공통에서 자동생성, 화면에 스크립트 작성시 화면 스크립트만 실행됨)
 *---------------------------------------------------------------------------------------------*/
// function grd_list_onheadclick(obj:Grid, e:GridClickEventInfo)
// {
// 	gfn_gridSort(obj, e);
// }

/*----------------------------------------------------------------------------------------------
 * 설명      : 분류코드 팝업 버튼 Click시
 *---------------------------------------------------------------------------------------------*/
function btn_gubun_onclick(obj:Button,  e:ClickEventInfo)
{
	var arrArg = new Array();
	arrArg[0] = "ccc";
	arrArg[1] = "ddd";
	
	var strId       = "popUpTemplate";
	var strURL      = "sample::TemplatePop.xfdl";
	var objArgument = {arg1:"aaa",arg2:"bbb",arg3:arrArg,arg4:ds_list};
	//var objArgument = "arg1=aaa    arg2=bbb";	// 기존 Miplatform 방식
	var nWidth      = -1;
	var nHeight     = -1;
	var strStyle    = "";	
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";

	// 리턴값을 배열로 받을 경우	
	//var arrRtn = gfn_dialog("popUpTemplate", "sample::TemplatePop.xfdl", {arg1:"aaa",arg2:"bbb",arg3:arrArg,arg4:ds_gubunList});
	var arrRtn = gfn_dialog(strId, strURL, objArgument);
			
	if ( arrRtn instanceof Object )
	{
		edt_gubun.value    = arrRtn["NAME"];
		edt_gubun.userdata = arrRtn["CODE"];
		
		obj.userdata       = arrRtn["NAME"];
	}

	// 리턴값을  Dataset으로 받을 경우
// 	var dsRtn = new Dataset();
// 	var dsObj = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
// 
// 	dsRtn.copyData(dsObj);
// 	
// 	if(dsRtn.rowcount > 0) {
// 		trace(dsRtn.saveXML());
// 	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 코드 key Down시
 *---------------------------------------------------------------------------------------------*/
function edt_gubun_onkeydown(obj:Edit, e:KeyEventInfo)
{
	//trace("edt_gubun_onkeydown : e.altKey : " + e.altKey + " / e.ctrlKey : " + e.ctrlKey + " / e.keycode : " + e.keycode);
	// function fs_fn_edt_OnKeyDown(obj, nChar, strTabObj) 함수와 동일

	gfn_edtKeyDown(obj, e);
	
	// Enter 키 시 추가 기능
	if(e.keycode == 13) 
	{
		// 조회
		//fn_search();
		//return true;		// gfn_formKeyDown 실행 안함
	}
}


function Tab_BuySale_onchanged(obj:Tab, e:TabIndexChangeEventInfo)
{
	tabIndex =e.postindex;//선택된 탭 인덱스 저장
	ds_search.setColumn(0,"tabIndex",e.postindex);
	
// 	if (tabIndex == 7) {
// 		notice.text = "영업회계정보 기준 조회";
// 	} else {
// 		notice.text = "구매수불정보 기준 조회";
// 	}
	
	
	if (tabIndex == 3 || tabIndex == 5) {
		rdo_view.visible = true;
	} else {
		rdo_view.visible = false;
	}
	
	if ( tabIndex == 0 || tabIndex == 2 ) {
		stc_cust.visible = true;
		cbo_custYn.visible = true;
	} else {
		stc_cust.visible = false;
		cbo_custYn.visible = false;
	}
	
	if (tabIndex == 10) {
		Static37.visible = true;
		edt_item.visible = true;
		btn_item.visible = true;
	} else {
		Static37.visible = false;
		edt_item.visible = false;
		btn_item.visible = false;
	}
}

function edt_cust_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 13){
		fn_search();
	}
	if(e.keycode == 46){
		obj.value = "";
		obj.userData = "";
		ds_search.setColumn(0,"schCustCd","");
		ds_search.setColumn(0,"schCustNm","");
	}
}


function comp_mainUpjang_onkeydown(obj:UpjangSearchComponent, e:KeyEventInfo)
{
	if(e.keycode == 46){
		fn_upjangDelete();	// 메인업장, 업장 초기화
	}
}

function comp_tm_onkeydown(obj:TmSearchComponent, e:KeyEventInfo)
{
	if(e.keycode == 46){
		//fn_upjangDelete();	// 메인업장, 업장 초기화 : 제외
		comp_tm.setTmCode("");
		comp_tm.setTmName("");
	}
}

function edt_ccCd_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 46){
		fn_upjangDelete();	// 메인업장, 업장 초기화
		ds_search.setColumn(0, "schCc", "");
		ds_search.setColumn(0, "schCcNm", "");
	}
}

function edt_item_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 46){
		fn_itemDelete();	// 자재/분류 초기화
	}
}

// 자재분류별 집계, 매입매출집계 HEAD 타이틀 변경
function rdo_view_onitemchanged(obj:Radio, e:ItemChangeEventInfo)
{
	var v_view = ds_search.getColumn(0, "schView");
	
 	if (v_view == "1") {	
 		Tab_BuySale.tabpage4.grd_list.setCellProperty("head", 2, "text", "본사");
 		Tab_BuySale.tabpage6.grd_list.setFormatColProperty(4,"size",0);
 		Tab_BuySale.tabpage6.grd_list.setFormatColProperty(5,"size",0);
 		Tab_BuySale.tabpage6.grd_list.setFormatColProperty(6,"size",0);
 	} else {
 		Tab_BuySale.tabpage4.grd_list.setCellProperty("head", 2, "text", "사업장");
 		Tab_BuySale.tabpage6.grd_list.setFormatColProperty(4,"size",80);
 		Tab_BuySale.tabpage6.grd_list.setFormatColProperty(5,"size",160);
 		Tab_BuySale.tabpage6.grd_list.setFormatColProperty(6,"size",110);
 	}
	
}

function chk_1_onclick(obj:CheckBox,  e:ClickEventInfo)
{
	if (chk_1.value) ds_search.setColumn(0, "schChk1", "1");
	else ds_search.setColumn(0, "schChk1", "");
}

function chk_2_onclick(obj:CheckBox,  e:ClickEventInfo)
{
	if (chk_2.value) ds_search.setColumn(0, "schChk2", "1");
	else ds_search.setColumn(0, "schChk2", "");
}

function chk_3_onclick(obj:CheckBox,  e:ClickEventInfo)
{
	if (chk_3.value) ds_search.setColumn(0, "schChk3", "1");
	else ds_search.setColumn(0, "schChk3", "");
}

// 영업담당 이벤트
function edt_sabun_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 13){
		fn_search();
	}
	if(e.keycode == 46){
		edt_ORD_SABUNQuery.value = "";
		edt_ORD_SABUNQuery.userData = "";
		ds_search.setColumn(0,"schSabun","");
		ds_search.setColumn(0,"schSabunNm","");
	}
	
}

// 영업담당 팝업처리
function edtBtn_ORD_SABUNQuery_onclick(obj:Button,  e:ClickEventInfo)
{
	var str_Where = "";
	var str_DeptId = "";

	if (obj.name == "edtBtn_ORD_SABUNQuery") {
		str_Where += "  AND (V.SABUN IN (SELECT PART_SALES_SABUN FROM FMS_UPJANG " + str_DeptId + ")) ";
		
	}
	
	fn_edtBtn_OnClick(obj, str_Where);
}

function cbo_custYn_onitemchanged(obj:Combo, e:ItemChangeEventInfo) {
	
	var ds = Tab_BuySale.tabpages[Tab_BuySale.tabindex].grd_list.binddataset;
	this.objects[ds].clearData();
	switch ( Tab_BuySale.tabindex ) {
		case 0 :
			Tab_BuySale.tabpages[Tab_BuySale.tabindex].grd_list.setFormatColProperty(16, "size", (e.postvalue == 'Y' ? 80 : 0) );
			Tab_BuySale.tabpages[Tab_BuySale.tabindex].grd_list.setFormatColProperty(17, "size", (e.postvalue == 'Y' ? 300 : 0) );
			break;
			
		case 2 :
			Tab_BuySale.tabpages[Tab_BuySale.tabindex].grd_list.setFormatColProperty(20, "size", (e.postvalue == 'Y' ? 80 : 0) );
			Tab_BuySale.tabpages[Tab_BuySale.tabindex].grd_list.setFormatColProperty(21, "size", (e.postvalue == 'Y' ? 300 : 0) );
			break;
	}
	
}

// 선택자재코드 팝업처리
function fn_btn_item_onclick(obj:Button,  e:ClickEventInfo)
{
	var v_rtn = gfn_dialog("", "U_FSI::FSI00035P.xfdl","");
	
	if(!gfn_isNull(v_rtn))
	{
		var v_result = v_rtn.split(";");
		
		if(v_result[0] == "ITEM") {
		    schSelGubun.value = v_result[0];
			edt_item_cd.value = v_result[1].trim(" ") ;
			edt_item.value = v_result[2] ;
		}
		else if(v_result[0] == "CLASS4") {
		    schSelGubun.value = v_result[0];
			edt_item_cd.value = v_result[1].trim(" ") ;
			edt_item.value = v_result[2] ;
		}
	}
}
 
]]></Script>
  </Form>
</FDL>

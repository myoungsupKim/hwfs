<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSC00070V" onkeydown="frm_OnKeyDown" onload="form_onload" titletext="사업장별 점검결과 조회" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static05" class="sta_WFDA_Labelbg" position="absolute 0 102 1237 129" anchor="left top right"/>
        <Static id="Static04" position="absolute 0 76 1237 103" class="sta_WFDA_Labelbg" anchor="left top right"/>
        <Static id="Static01" position="absolute 0 30 1237 71" class="sta_WFSA_Labelbg" anchor="left top right"/>
        <Static id="Static02" text="점검표" position="absolute 15 40 66 61" class="sta_WFSA_label"/>
        <Grid autoenter="select" binddataset="ds_list" cellsizingtype="both" readonly="false" enable="true" id="grd_list" useinputpanel="false" oncellclick="grd_list_OnCellClick" oncelldblclick="grd_list_OnCellDblClick" onheadclick="grd_List_OnHeadClick" taborder="27" tabstop="true" tooltiptype="hover" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 157 1237 687" selecttype="row" anchor="all" class="grd_WF_LineNone">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="40"/>
                <Column size="90"/>
                <Column size="80"/>
                <Column size="50"/>
                <Column size="80"/>
                <Column size="110"/>
                <Column size="75"/>
                <Column size="45"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="80"/>
                <Column size="90"/>
                <Column size="70"/>
                <Column size="124"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="82"/>
                <Column size="20"/>
                <Column size="77"/>
                <Column size="20"/>
              </Columns>
              <Rows>
                <Row size="48" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="image" class="head_Excel"/>
                <Cell col="1" displaytype="text" style="background2: ;" text="사업부"/>
                <Cell col="2" displaytype="text" text="운영부서"/>
                <Cell col="3" displaytype="text" text="직군"/>
                <Cell col="4" displaytype="text" text="상세직군"/>
                <Cell col="5" displaytype="text" text="사업장"/>
                <Cell col="6" displaytype="text" text="사업장구분"/>
                <Cell col="7" displaytype="text" text="점검&#10;횟수"/>
                <Cell col="8" displaytype="text" text="평균&#10;일식수"/>
                <Cell col="9" displaytype="text" text="제공&#10;끼니수"/>
                <Cell col="10" displaytype="text" text="제공&#10;식단수"/>
                <Cell col="11" displaytype="text" text="배식형태"/>
                <Cell col="12" displaytype="text" text="점검일"/>
                <Cell col="13" displaytype="text" text="점검자"/>
                <Cell col="14" displaytype="text" text="수검자"/>
                <Cell col="15" displaytype="text" text="대팀장"/>
                <Cell col="16" displaytype="text" text="소팀장"/>
                <Cell col="17" text="책임자1"/>
                <Cell col="18" text="책임자2"/>
                <Cell col="19" text="책임자3"/>
                <Cell col="20" displaytype="text" text="점검&#10;구분"/>
                <Cell col="21" displaytype="text" text="점수"/>
                <Cell col="22" displaytype="text" text="패트롤&#10;가점"/>
                <Cell col="23" displaytype="text" text="패트롤&#10;점수"/>
                <Cell col="24" displaytype="text" text="점수"/>
                <Cell col="25" displaytype="text" text="등급"/>
                <Cell col="26" displaytype="text" text="부적합&#10;점수"/>
                <Cell col="27" displaytype="text" text="개선&#10;계획"/>
                <Cell col="28" colspan="2" displaytype="text" style="align:center;" text="개선계획&#10;작성확인일자"/>
                <Cell col="30" colspan="2" displaytype="text" text="확인자"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;background2: ;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="background2: ;" text="bind:MU_NM" suppress="1"/>
                <Cell col="2" displaytype="text" style="background2: ;" text="bind:TM_NM" suppress="2"/>
                <Cell col="3" displaytype="text" style="background2: ;" text="bind:JOB_NAME" suppress="3"/>
                <Cell col="4" displaytype="text" style="background2: ;" text="bind:SUB_JOB_NAME" suppress="4"/>
                <Cell col="5" displaytype="text" style="background2: ;" text="bind:UPJANGNM" suppress="5"/>
                <Cell col="6" displaytype="text" style="background2: ;" text="bind:TABLE_TYPE_NM" suppress="6"/>
                <Cell col="7" displaytype="number" style="align: ;" text="bind:CNT" suppress="7"/>
                <Cell col="8" displaytype="number" style="align: ;" text="bind:AVG_MEAL_QTY" suppress="8"/>
                <Cell col="9" displaytype="number" style="align: ;" text="bind:MEAL_CNT" suppress="9"/>
                <Cell col="10" displaytype="number" style="align: ;" text="bind:MENU_CNT" suppress="10"/>
                <Cell col="11" displaytype="text" style="align:center middle;" text="bind:DIST_TYPE_NM" suppress="11"/>
                <Cell col="12" displaytype="expr:iif(gfn_isNull(CHECK_DATE), 'none', 'date')" style="align: ;" text="bind:CHECK_DATE"/>
                <Cell col="13" displaytype="text" style="align:center middle;" text="bind:CHECK_SABUN_NM"/>
                <Cell col="14" displaytype="text" style="align:left middle;" text="bind:CHARGE_NM"/>
                <Cell col="15" displaytype="text" style="align:center middle;" text="bind:TEAM_MST_NM"/>
                <Cell col="16" displaytype="text" style="align:center middle;" text="bind:SUBTEAM_MST_NM"/>
                <Cell col="17" text="bind:RESP_SABUN1_NM"/>
                <Cell col="18" text="bind:RESP_SABUN2_NM"/>
                <Cell col="19" text="bind:RESP_SABUN3_NM"/>
                <Cell col="20" displaytype="text" style="align:center middle;" text="bind:CHECK_TYPE_NM"/>
                <Cell col="21" displaytype="number" style="align: ;" text="bind:SCORE"/>
                <Cell col="22" displaytype="number" style="align: ;" text="bind:PATROL"/>
                <Cell col="23" displaytype="number" style="align: ;" text="bind:PATROL_100"/>
                <Cell col="24" displaytype="number" style="align: ;" text="bind:PATROL_AVG"/>
                <Cell col="25" displaytype="text" style="align:center middle;" text="bind:GRADE"/>
                <Cell col="26" displaytype="text" style="align:center middle;" text="bind:NOT_FIT"/>
                <Cell col="27" displaytype="text" style="align:center middle;cursor:expr:iif(WRITE_YN=='Y','hand','arrow');" text="bind:WRITE_YN"/>
                <Cell col="28" displaytype="expr:expr:iif(gfn_isNull(IMPROV_CONFIRM_DATE), 'none', 'date')" edittype="mask" style="align: ;" text="bind:IMPROV_CONFIRM_DATE" mask="@@@@-@@-@@"/>
                <Cell col="29" style="background:transparent URL('theme://Images\new\cal_WF_IconN.png') center middle;background2:transparent URL('theme://Images\new\cal_WF_IconN.png') center middle;selectbackground:transparent URL('theme://Images\new\cal_WF_IconN.png') center middle;"/>
                <Cell col="30" displaytype="text" edittype="normal" style="align:center middle;" text="bind:CONFIRM_SABUN_NM"/>
                <Cell col="31" style="background:#e4e4e4ff URL('theme://convertImages/new/btn_WF_popSearchN.png') center middle;background2:#e4e4e4ff URL('theme://convertImages/new/btn_WF_popSearchN.png') center middle;selectbackground:#e4e4e4ff URL('theme://convertImages/new/btn_WF_popSearchN.png') center middle;"/>
              </Band>
              <Band id="summary">
                <Cell colspan="7" style="align:center;" text="합계" taborder="undefined"/>
                <Cell col="7" displaytype="number"/>
                <Cell col="8"/>
                <Cell col="9"/>
                <Cell col="10"/>
                <Cell col="11"/>
                <Cell col="12"/>
                <Cell col="13"/>
                <Cell col="14"/>
                <Cell col="15"/>
                <Cell col="16"/>
                <Cell col="17"/>
                <Cell col="18"/>
                <Cell col="19"/>
                <Cell col="20"/>
                <Cell col="21" displaytype="number"/>
                <Cell col="22"/>
                <Cell col="23"/>
                <Cell col="24" displaytype="number" expr="expr:getAvg(&quot;gfn_parseFloat(PATROL_AVG)&quot;)" mask="+#0.##"/>
                <Cell col="25"/>
                <Cell col="26" displaytype="number" expr="expr:getSum(&quot;gfn_parseFloat(NOT_FIT)&quot;)"/>
                <Cell col="27"/>
                <Cell col="28"/>
                <Cell col="29"/>
                <Cell col="30"/>
                <Cell col="31"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <MaskEdit id="me_FROM_DT" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="1" type="string" userdata="btn_FROM_DT" position="absolute 235 40 315 61" class="msk_WF_EssentialCal"/>
        <Button id="btn_FROM_DT" onclick="g_CalButton_OnClick" taborder="28" userdata="me_FROM_DT" position="absolute 314 40 335 61" class="btn_WF_calEssential" text="" image=""/>
        <Static id="Static7" text="~" position="absolute 343 40 351 61"/>
        <MaskEdit id="me_TO_DT" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="2" type="string" userdata="btn_TO_DT" position="absolute 359 40 439 61" class="msk_WF_EssentialCal"/>
        <Button id="btn_TO_DT" onclick="g_CalButton_OnClick" taborder="29" userdata="me_TO_DT" position="absolute 438 40 459 61" class="btn_WF_calEssential" text="" image=""/>
        <Static id="Static14" text="기 간" position="absolute 188 40 228 61" class="sta_WFSA_label"/>
        <Div id="div_cmnBtn" taborder="31" text="Div0" url="cmn::CmnBtn.xfdl" position="absolute 0 0 1237 30" anchor="left top right" scrollbars="none"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" id="cbo_S_TABLE_TYPE" imemode="none" index="0" innerdataset="ds_TABLE_TYPE" type="NOTFILTERED" taborder="0" position="absolute 69 40 158 61" class="cmb_WF_Essential"/>
        <Static id="Static0" text="점검구분" position="absolute 489 40 550 61" class="sta_WFSA_label"/>
        <CheckBox id="chk_CHECK_TYPE1" onclick="common_chk_OnClick" taborder="3" text="정기" userdata="001" position="absolute 557 40 599 61" class="chk_WF_Essential" value="true"/>
        <CheckBox id="chk_CHECK_TYPE2" onclick="common_chk_OnClick" taborder="4" text="보정" userdata="003" position="absolute 608 40 650 61" class="chk_WF_Essential" value="true"/>
        <CheckBox id="chk_CHECK_TYPE3" onclick="common_chk_OnClick" taborder="5" text="지도" userdata="002" position="absolute 659 40 701 61" class="chk_WF_Essential" value="false"/>
        <Static id="Static1" text="직     군" position="absolute 868 76 940 103" class="sta_WFDA_Label01"/>
        <Combo id="cbo_JOB" index="0" innerdataset="ds_JOB" type="NOTFILTERED" taborder="12" position="absolute 942 79 1050 100"/>
        <Static id="Static2" text="상세직군" position="absolute 1052 76 1124 103" class="sta_WFDA_Label01"/>
        <Combo id="cbo_SubJob" index="0" innerdataset="ds_SUB_JOB" type="NOTFILTERED" taborder="13" position="absolute 1126 79 1234 100"/>
        <Static id="st10" text="사 업 장" position="absolute 462 76 534 103" class="sta_WFDA_Label01"/>
        <Static id="Static10" text="평가점수" position="absolute 868 102 940 129" class="sta_WFDA_Label01"/>
        <Static id="Static4" text="평균일식수" position="absolute 0 102 72 129" class="sta_WFDA_Label01"/>
        <MaskEdit id="me_FROM_SCORE" taborder="16" value="MaskEdit0" position="absolute 942 105 988 126"/>
        <Static id="Static6" text="~" position="absolute 992 105 1000 126"/>
        <MaskEdit id="me_TO_SCORE" taborder="17" value="MaskEdit0" position="absolute 1004 105 1050 126"/>
        <MaskEdit id="me_FROM_AVG_MEAL_QTY" taborder="18" value="MaskEdit0" position="absolute 74 105 144 126"/>
        <Static id="Static8" text="~" position="absolute 147 105 155 126"/>
        <MaskEdit id="me_TO_AVG_MEAL_QTY" taborder="19" value="MaskEdit0" position="absolute 159 105 229 126"/>
        <Static id="Static9" text="제공끼니수" position="absolute 231 102 303 129" class="sta_WFDA_Label01"/>
        <MaskEdit id="me_FROM_MEAL_CNT" taborder="20" value="MaskEdit0" position="absolute 305 105 375 126"/>
        <Static id="Static11" text="~" position="absolute 378 105 386 126"/>
        <MaskEdit id="me_TO_MEAL_CNT" taborder="21" value="MaskEdit0" position="absolute 390 105 460 126"/>
        <Static id="Static12" text="제공식단수" position="absolute 462 102 534 129" class="sta_WFDA_Label01"/>
        <MaskEdit id="me_FROM_MENU_CNT" taborder="22" value="MaskEdit0" position="absolute 536 105 606 126"/>
        <Static id="Static13" text="~" position="absolute 610 105 618 126"/>
        <MaskEdit id="me_TO_MENU_CNT" taborder="23" value="MaskEdit0" position="absolute 622 105 692 126"/>
        <Static id="Static15" text="배식형태" position="absolute 694 102 766 129" class="sta_WFDA_Label01"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" id="cbo_DIST_TYPE" index="0" innerdataset="ds_DIST_TYPE" type="NOTFILTERED" taborder="24" position="absolute 768 105 866 126"/>
        <Static id="Static16" text="행을 더블클릭 시 점검결과보고서 조회가능, 개선계획 열을 클릭 시 개선계획보고서 조회 가능." position="absolute 0 695 700 710" class="sta_WF_DiscInfo" anchor="left bottom"/>
        <CheckBox falsevalue="N" id="chk_All" onclick="common_chk_OnClick" taborder="8" tabstop="false" text="전체사업장" truevalue="Y" value="false" position="absolute 889 40 971 61"/>
        <Static id="Static17" text="점검횟수" position="absolute 1052 102 1124 129" class="sta_WFDA_Label01"/>
        <MaskEdit id="me_FROM_CNT" taborder="25" value="MaskEdit0" position="absolute 1126 105 1172 126"/>
        <Static id="Static18" text="~" position="absolute 1176 105 1184 126"/>
        <MaskEdit id="me_TO_CNT" taborder="26" value="MaskEdit0" position="absolute 1188 105 1234 126"/>
        <CheckBox falsevalue="N" id="chk_Exc" onclick="common_chk_OnClick" taborder="9" tabstop="false" text="폐점업장 제외" truevalue="Y" value="false" position="absolute 998 40 1096 61"/>
        <CheckBox id="chk_CHECK_TYPE4" onclick="common_chk_OnClick" taborder="6" text="특별" userdata="004" position="absolute 711 40 753 61" class="chk_WF_Essential" value="false"/>
        <CheckBox falsevalue="N" id="chk_patrol" onclick="common_patrol_OnClick" taborder="7" tabstop="false" text="패트롤보기" truevalue="Y" value="false" position="absolute 782 40 864 61"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Static id="Static36" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 59 40 69 61" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 158 40 188 61" anchor="left top"/>
        <Static id="Static19" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 225 40 235 61" anchor="left top"/>
        <Static id="Static20" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 459 40 489 61" anchor="left top"/>
        <Static id="Static03" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 547 40 557 61" anchor="left top"/>
        <Static id="Static21" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 598 40 608 61" anchor="left top"/>
        <Static id="Static22" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 649 40 659 61" anchor="left top"/>
        <Static id="Static23" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 701 40 711 61" anchor="left top"/>
        <Static id="Static40" text="h5" class="Guide01_AreaRed" visible="false" position="absolute 232 71 682 76" anchor="left top"/>
        <Static id="Static45" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 129 611 139"/>
        <Static id="Static24" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 687 1252 695" anchor="left bottom"/>
        <Static id="Static25" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 752 40 782 61" anchor="left top"/>
        <Static id="Static26" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 859 40 889 61" anchor="left top"/>
        <Static id="Static27" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 968 40 998 61" anchor="left top"/>
        <Static id="Static28" text="사업부" class="sta_WFDA_Label01" position="absolute 0 76 72 103"/>
        <MuSearchComponent id="cbo_mu" titletext="사업부 선택 Component" taborder="32" text="MuSearchComponent00" position="absolute 74 79 229 100" bindDataset="ds_input" bindMuCdColumn="MU_CD" appendText="" onItemChangedEvent="fn_muChange"/>
        <Static id="Static3" text="운영부서" class="sta_WFDA_Label01" position="absolute 231 76 303 103"/>
        <TmSearchComponent id="edt_tm" titletext="팀 검색용 Component" taborder="33" text="TmSearchComponent00" position="absolute 305 79 460 100" bindDataset="ds_input" bindTmCdColumn="TM_CD" bindTmNmColumn="TM_NM" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tmChange" eventBeforeTrigger=""/>
        <UpjangSearchComponent id="edt_upjang" titletext="업장 검색용 Component" taborder="34" text="UpjangSearchComponent00" position="absolute 536 79 692 100" bindDataset="ds_input" bindUpjangCodeColumn="UPJANG" bindUpjangNameColumn="UPJANG_NM" eventBeforeTrigger="" eventAfterTrigger="" roleSetId=""/>
        <Static id="Static29" text="점검자" class="sta_WFDA_Label01" position="absolute 694 76 766 103"/>
        <Combo id="cbo_CHECK_SABUN" taborder="35" innerdataset="ds_CHECK_SABUN" codecolumn="CHECK_SABUN" datacolumn="CHECK_SABUN_NM" position="absolute 768 79 865 100" userdata=""/>
        <Static id="Static30" text="사업장별 점검결과 목록" class="sta_WF_Title01" position="absolute 0 139 280 157" anchor="left top"/>
        <Static id="Static31" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 152 242 157" anchor="left top"/>
        <Static id="Static68" text="수검자, 대팀장, 소팀장, 책임자 정보를 더블클릭 하시면 개인 점검이력을 확인하실 수 있습니다." class="sta_WF_DiscInfo" position="absolute 646 139 1238 154" anchor="top right"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_list" oncolumnchanged="ds_list_OnColumnChanged"/>
      <Dataset id="ds_input" oncolumnchanged="ds_input_OnColumnChanged">
        <ColumnInfo>
          <Column id="FROM_DT" size="256" type="STRING"/>
          <Column id="TO_DT" size="256" type="STRING"/>
          <Column id="TABLE_TYPE" size="256" type="STRING"/>
          <Column id="CHECK_TYPE" size="256" type="STRING"/>
          <Column id="CHECK_ALL" size="256" type="STRING"/>
          <Column id="CHECK_EXC" size="256" type="STRING"/>
          <Column id="JOB" size="256" type="STRING"/>
          <Column id="SUB_JOB" size="256" type="STRING"/>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="UPJANG_NM" size="256" type="STRING"/>
          <Column id="MU_CD" type="STRING" size="256"/>
          <Column id="MU_NM" type="STRING" size="256"/>
          <Column id="TM_CD" size="256" type="STRING"/>
          <Column id="TM_NM" size="256" type="STRING"/>
          <Column id="DIST_TYPE" size="256" type="STRING"/>
          <Column id="FROM_SCORE" size="256" type="STRING"/>
          <Column id="TO_SCORE" size="256" type="STRING"/>
          <Column id="FROM_AVG_MEAL_QTY" size="256" type="STRING"/>
          <Column id="TO_AVG_MEAL_QTY" size="256" type="STRING"/>
          <Column id="FROM_MEAL_CNT" size="256" type="STRING"/>
          <Column id="TO_MEAL_CNT" size="256" type="STRING"/>
          <Column id="FROM_MENU_CNT" size="256" type="STRING"/>
          <Column id="TO_MENU_CNT" size="256" type="STRING"/>
          <Column id="CHK_SUB_YN" size="256" type="STRING"/>
          <Column id="FROM_CNT" size="256" type="STRING"/>
          <Column id="TO_CNT" size="256" type="STRING"/>
          <Column id="CHECK_SABUN" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CHECK_ALL"/>
            <Col id="CHECK_TYPE"/>
            <Col id="CHK_SUB_YN"/>
            <Col id="DIST_TYPE"/>
            <Col id="FROM_AVG_MEAL_QTY"/>
            <Col id="FROM_CNT"/>
            <Col id="FROM_DT"/>
            <Col id="FROM_MEAL_CNT"/>
            <Col id="FROM_MENU_CNT"/>
            <Col id="FROM_SCORE"/>
            <Col id="JOB"/>
            <Col id="SUB_JOB"/>
            <Col id="TABLE_TYPE"/>
            <Col id="TM_CD"/>
            <Col id="TM_NM"/>
            <Col id="TO_AVG_MEAL_QTY"/>
            <Col id="TO_CNT"/>
            <Col id="TO_DT"/>
            <Col id="TO_MEAL_CNT"/>
            <Col id="TO_MENU_CNT"/>
            <Col id="TO_SCORE"/>
            <Col id="UPJANG"/>
            <Col id="UPJANG_NM"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_TABLE_TYPE">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_JOB"/>
      <Dataset id="ds_SUB_JOB"/>
      <Dataset id="ds_SUB_JOB1"/>
      <Dataset id="ds_DIST_TYPE">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CHECK_SABUN">
        <ColumnInfo>
          <Column id="CHECK_SABUN" size="256" type="STRING"/>
          <Column id="CHECK_SABUN_NM" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="me_FROM_DT_value" compid="me_FROM_DT" propid="value" datasetid="ds_input" columnid="FROM_DT"/>
      <BindItem id="me_TO_DT_value" compid="me_TO_DT" propid="value" datasetid="ds_input" columnid="TO_DT"/>
      <BindItem id="cbo_S_TABLE_TYPE_value" compid="cbo_S_TABLE_TYPE" propid="value" datasetid="ds_input" columnid="TABLE_TYPE"/>
      <BindItem id="cbo_JOB_value" compid="cbo_JOB" propid="value" datasetid="ds_input" columnid="JOB"/>
      <BindItem id="cbo_SubJob_value" compid="cbo_SubJob" propid="value" datasetid="ds_input" columnid="SUB_JOB"/>
      <BindItem id="me_FROM_SCORE_value" compid="me_FROM_SCORE" propid="value" datasetid="ds_input" columnid="FROM_SCORE"/>
      <BindItem id="me_TO_SCORE_value" compid="me_TO_SCORE" propid="value" datasetid="ds_input" columnid="TO_SCORE"/>
      <BindItem id="me_FROM_AVG_MEAL_QTY_value" compid="me_FROM_AVG_MEAL_QTY" propid="value" datasetid="ds_input" columnid="FROM_AVG_MEAL_QTY"/>
      <BindItem id="me_TO_AVG_MEAL_QTY_value" compid="me_TO_AVG_MEAL_QTY" propid="value" datasetid="ds_input" columnid="TO_AVG_MEAL_QTY"/>
      <BindItem id="me_FROM_MEAL_CNT_value" compid="me_FROM_MEAL_CNT" propid="value" datasetid="ds_input" columnid="FROM_MEAL_CNT"/>
      <BindItem id="me_TO_MEAL_CNT_value" compid="me_TO_MEAL_CNT" propid="value" datasetid="ds_input" columnid="TO_MEAL_CNT"/>
      <BindItem id="me_FROM_MENU_CNT_value" compid="me_FROM_MENU_CNT" propid="value" datasetid="ds_input" columnid="FROM_MENU_CNT"/>
      <BindItem id="me_TO_MENU_CNT_value" compid="me_TO_MENU_CNT" propid="value" datasetid="ds_input" columnid="TO_MENU_CNT"/>
      <BindItem id="cbo_DIST_TYPE_value" compid="cbo_DIST_TYPE" propid="value" datasetid="ds_input" columnid="DIST_TYPE"/>
      <BindItem id="chk_All_value" compid="chk_All" propid="value" datasetid="ds_input" columnid="CHECK_ALL"/>
      <BindItem id="me_FROM_CNT_value" compid="me_FROM_CNT" propid="value" datasetid="ds_input" columnid="FROM_CNT"/>
      <BindItem id="me_TO_CNT_value" compid="me_TO_CNT" propid="value" datasetid="ds_input" columnid="TO_CNT"/>
      <BindItem id="chk_Exc_value" compid="chk_Exc" propid="value" datasetid="ds_input" columnid="CHECK_EXC"/>
      <BindItem id="item2" compid="edt_upjang" propid="value" datasetid="ds_cond" columnid="UPJANGNM"/>
      <BindItem id="item0" compid="cbo_CHECK_SABUN" propid="value" datasetid="ds_input" columnid="CHECK_SABUN"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 메뉴관리/위생관리/사업장별 점검결과 조회
 * 프로그램명   : FSC90060V.XML
 * 기      능   : 사업장별 점검결과 조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-18
 * 비      고   : 
 *		- ds_input				: [input DS] 조회조건 파라미터 DS
 * ----------------------------------------------------------------------------------------
 * HISTORY    : 박은규 2009-01-14 CSR#(23819) 요청자:이명희(건강관리센터)
 *              폐점업장 제외 추가 및 식재업장 조회제외.
              : 박은규 2012-04-16 CSR#(SR201204_09204) 요청자:김희선(건강관리센터)
                특별점검 구분 추가 : 결과조회/출력에서 평균점수에서 제외
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"		// X-Framework Lib
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"
//@@컨버터에서 주석처리 #include "lib::fs_common.js"
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var serverSaveDir = "FSC_SAFE_RESULT_PHOTO";		// 파일패스
var serverSaveUrl;							// 파일패스URL
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(this);

	// 업데이트 DS
	v_ds_check = "";
	
	// X-Framework : Action 정보 생성 
	fsp_init(this);
	
	// 권한처리
	edt_tm.applyAuthLevel(cbo_mu);
	edt_upjang.applyAuthLevel(edt_tm);
	
	fn_InitSearch();
	
	// 초기값 셋팅
	var strDt = fn_CurrDateWeek();
	
	serverSaveUrl = fsp_getServerDir(serverSaveDir) + "/";
	
	ds_input.setColumn(0,"FROM_DT",gfn_left(strDt,6)+"01");				// 일자
	ds_input.setColumn(0,"TO_DT",strDt);							// 일자
	ds_input.setColumn(0,"CHECK_TYPE","'001','003'");
	
	// 팀장,사업장 자기사번 셋팅
	if (g_AuthLevel <= g_Leader_AuthLevel)		// 사업장
	{
		//fn_SetAuth2("", "", "ed_UPJANG_NM", "btn_upjang", "ds_input", "", "", "UPJANG", "UPJANG_NM");
		//ed_UPJANG_NM.enable = false;
		//btn_upjang.enable  = false;
		edt_upjang.enable = false;
	}
	else if (g_AuthLevel <= 16)
	{
		//fn_SetAuth2("ed_TM_NM", "btn_pop2", "", "", "ds_input", "TM_CD", "TM_NM", "", "");
	}
	
	fsp_clear(this);
	fsp_addSearch(this,"fs/fsc:FSC90080V_S001");
	fsp_callService(this,"","","ds_input=ds_input","ds_CHECK_SABUN=ds_list","","fn_callBackSearch");
		
	cbo_S_TABLE_TYPE.index = 0;
	cbo_S_TABLE_TYPE.setFocus();
	grd_list.setFormatColProperty(22, "size", 0);
	grd_list.setFormatColProperty(23, "size", 0);
	grd_list.setFormatColProperty(24, "size", 0);
	
	cbo_mu.setMuCode(' ');
	edt_tm.setTmCode('');
	edt_upjang.setUpjangCode('');
	
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_callBackSearch()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 점검자 리스트 조회
 * 작  성  자   : 지승훈
 * 작성  일자   : 2015-05-27 
 ******************************************************************************************
 */
function fn_callBackSearch(errCode, errMsg) 
{
	if ( errCode != 0 ) {
		g_Message("EE", errMsg);
		return;
	}
	
	// 점검자 콤보에 선택 추가
	ds_CHECK_SABUN.insertRow(0);
	ds_CHECK_SABUN.setColumn(0, "CHECK_SABUN", "");
	ds_CHECK_SABUN.setColumn(0, "CHECK_SABUN_NM", "- 선택 -");

	cbo_CHECK_SABUN.index = 0;
}

function frm_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
}
//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_search()
{
	if (!fn_SearchCheck())		// 조회조건체크
	{
		return;
	}
	// 초기화
	ds_list.clearData();
	ds_input.setColumn(0,"CHK_SUB_YN",iif(gfn_length(gfn_trim(me_FROM_CNT.value)+ gfn_trim(me_TO_CNT.value))==0,"N","Y"));
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;

	actionName		= "FSC90070V_T001";
	cmdName			= "U_svc::" + "fs/fsc/FSC90070V_T001.jsp";
	inData			= "ds_input=ds_input";
	outData			= "ds_list=ds_list";
	callBackFnc		= "fn_afterSearchList";
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc,true,false,false);
	
	ds_CHECK_SABUN.clearData();
	fsp_clear(this);
	fsp_addSearch(this,"fs/fsc:FSC90080V_S001");
	fsp_callService(this,"","","ds_input=ds_input","ds_CHECK_SABUN=ds_list","","fn_callBackSearch");
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Save()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 저장버튼
 * 작  성  자   : 김장욱
 * 작성  일자   : 2014-01-11
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_save()
{
	var uptCnt = 0;
	if(!g_Confirm("02", "저장하시겠습니까?"))
		return;
	//var v_Param = "g_EmpNo=" + Quote(g_EmpNo);
	fsp_clear(this);	
	fsp_addSave(this
        //, "fs/fsi:FSI00070E_I001"
        , ""
        , "fs/fsc:FSC90070V_U001"
        , ""
        , ""
        , ""
        , ""
        , ""
        );
		
	// 서버 호출 
	fsp_callService(this
		, ""
		, ""
		, "ds_in=ds_list:U"
		, ""
		, ""
		, "fn_CallBack"
		, ""
		, ""
		, true);
		

}

 /*
 ******************************************************************************************
 * 함  수  명   : fn_CallBack()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : CallBack 함수
 * 작  성  자   : 김장욱
 * 작성  일자   : 2013-01-11
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_CallBack(errCode, errMsg)
{
	if (errCode != 0){
		return;
	}
	gfn_alert("저장되었습니다.");
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Print()
 * 기      능   : [출력버튼] 출력 시 처리되는 작업
 ******************************************************************************************
 */
function fn_print()
{
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Excel()
 * 기      능   : [엑셀버튼] 엑셀 시 처리되는 작업
 ******************************************************************************************
 */
function fn_Excel()
{
	gfn_exportExcel(grd_list, "Sheet1");
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function fn_Close()
{
	this.close();
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Help()
 * 기      능   : [도움말버튼] 도움말
 ******************************************************************************************
 */
function fn_help()
{
	// tit_addSearchActionInfo(this, "fs/fsm:SCC_MENU_SELECT");
	// tit_callService(this, "", "", "ds_cond=ds_cond", "ds_Menu=ds_list", "", "");	
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_SearchCheck()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 조회시 필수조회조건 체크
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-10  
 ******************************************************************************************
 */
function fn_SearchCheck()
{
/*
	if (length(ds_input.GetColumn(0,"TABLE_TYPE")) == 0)
	{
		g_Message("EE", "점검표를 선택하세요.");
		cbo_S_TABLE_TYPE.SetFocus();
		return false;
	}
*/
	if (gfn_length(ds_input.getColumn(0,"FROM_DT"))== 0)
	{
		g_Message("EE", "날짜를 입력하세요");
		me_FROM_DT.setFocus();
		return false;
	}

	if (gfn_length(ds_input.getColumn(0,"TO_DT"))== 0)
	{
		g_Message("EE", "날짜를 입력하세요");
		me_TO_DT.setFocus();
		return false;
	}

	if (ds_input.getColumn(0,"FROM_DT") > ds_input.getColumn(0,"TO_DT"))
	{
		g_Message("EE", "검색기간을 확인해 주십시오.");
		me_FROM_DT.setFocus();
		return false;
	}
	
	if (gfn_length(ds_input.getColumn(0,"CHECK_TYPE"))== 0)
	{
		g_Message("EE", "점검구분을 선택하세요.");
		chk_CHECK_TYPE1.setFocus();
		return false;
	}
	
    return true;
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_InitSearch()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 초기 공통코드조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-15
 ******************************************************************************************
 */
function fn_InitSearch()
{
	//직군코드
	fn_sql_common("C", strMAQuery_MAJOB,"","ORDER BY JOB_CD","",cbo_JOB,-1,ds_JOB);
	ds_JOB.insertRow(0);
	ds_JOB.setColumn(0,"JOB_CD","");
	ds_JOB.setColumn(0,"JOB_NAME","전체");
	cbo_JOB.index = 0;
	
	//SUB 직군코드
	fn_sql_common("C", strMAQuery_MASUBJOB,"","ORDER BY SUB_JOB_CD","",cbo_SubJob,-1,ds_SUB_JOB);
	ds_SUB_JOB.insertRow(0);
	ds_SUB_JOB.setColumn(0,"SUB_JOB_CD","");
	ds_SUB_JOB.setColumn(0,"SUB_JOB_NAME","전체");
	Copy(ds_SUB_JOB1,ds_SUB_JOB);
	cbo_SubJob.index = 0;
	
	//공통코드조회
	var v_fil_cond;
	var v_ds = fn_common_code("'FS9041','MA0005'","","","all","Y");

	// 정검표구분(ds_TABLE_TYPE, GROUP_CODE : 'FS9041')
	//v_fil_cond = "GROUP_CODE == 'FS0041' && length(CODE)>0";
	v_fil_cond = "GROUP_CODE == 'FS9041'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_TABLE_TYPE,v_ds.name);
	
	
	// 배식형태(ds_DIST_TYPE, GROUP_CODE : 'MA0005')
	v_fil_cond = "GROUP_CODE == 'MA0005'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_DIST_TYPE,v_ds.name);	
	cbo_DIST_TYPE.index = 0;
	
	
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSearchList()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 개별 표준 식단 조회 후 실행 함수
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-18  
 ******************************************************************************************
 */
function fn_afterSearchList(errCode, errMsg)
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오");
		return;
	}
	
	ds_list.filter("CNT > 0");
	grd_list.setCellProperty("summ", 1, "text", ds_list.getRowCount());
	ds_list.filter("");
	
	ds_list.filter("CHECK_TYPE <> '004'");
	grd_list.setCellProperty("summ", 15, "text", gfn_round(ds_list.getAvg('SCORE'), 0));
	ds_list.filter("");
}


//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
 /******************************************************************************************
 * 함  수  명   : grd_List_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
 * 기      능   : 그리드헤드 더블클릭시 Sort
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-18  
 ******************************************************************************************
 */
function grd_List_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
}

/*
 ******************************************************************************************
 * 함  수  명   : ds_input_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
 * 기      능   : 조회조건 변경시 조회조건 셋팅
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-02-14  
 ******************************************************************************************
 */
function ds_input_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if (e.columnid == "JOB")	// 직군변경시
	{
		if (gfn_length(e.newvalue)==0)
		{
			Copy(ds_SUB_JOB,ds_SUB_JOB1);
			cbo_SubJob.index = 0;
		}
		else
		{
			//SUB 직군코드
			fn_sql_common("C", strMAQuery_MASUBJOB,"","AND JOB_CD = '" + e.newvalue + "'ORDER BY SUB_JOB_CD","",cbo_SubJob,-1,ds_SUB_JOB);			
			ds_SUB_JOB.insertRow(0);
			ds_SUB_JOB.setColumn(0,"SUB_JOB_NAME","전체");
			ds_SUB_JOB.setColumn(0,"SUB_JOB_CD","");
			cbo_SubJob.index = 0;			
		}
	}

}

/*
 ******************************************************************************************
 * 함  수  명   : btn_Date_OnClick(obj,nX,nY)
 * 기      능   : 달력
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-02-04  
 ******************************************************************************************
 */
function btn_Date_OnClick(obj:Button, e:ClickEventInfo)
{
	var objme = eval(obj.userdata);
	
	var retDate = gfn_dialog("", "U_SCC::SCC_CALENDAR.xfdl","fa_Date="+wrapQuote(objme.value),-1,-1,"Title=false Status=false");

	objme.value  = retDate;
}

/*
 ******************************************************************************************
 * 함  수  명   : btn_pop1_OnClick(obj)
 * 기      능   : 팝업버튼 클릭 -> 사업장 조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-03  
 ******************************************************************************************
 */
function btn_pop2_OnClick(obj:Button, e:ClickEventInfo)
{
	fn_TeamPopup();
}

function ed_TM_NM_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if(nChar == 13) fn_TeamPopup();
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_TeamPopup
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 업장조회 팝업
 * 작  성  자   : 김동표
 * 작성  일자   : 2007-11-27
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_TeamPopup()
{
	fn_sql_common_setup( strMAQuery_Team
						,strMAQuery_TeamKeyField
						,strMAQuery_TeamValueField
						,strMAQuery_TeamKeyFieldNM
						,strMAQuery_TeamValueFieldNM
						,""
						,""
						,"AND FS_UPJANG = 'Y'"
						,strMAQuery_TeamCaption
						,strMAQuery_TeamAllField
						);
						
	ds_input.setColumn(0,"TM_NM",gds_sql_common.getColumn(0, "ret_name"));
	ds_input.setColumn(0,"TM_CD",gds_sql_common.getColumn(0, "ret_code"));
}

/*
 ******************************************************************************************
 * 함  수  명   : btn_upjang_OnClick(obj)
 * 기      능   : 팝업버튼 클릭 -> 사업장 조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-03  
 ******************************************************************************************
 */
function btn_upjang_OnClick(obj:Button, e:ClickEventInfo)
{
	var strWhere;

	// 운영부서
	if (gfn_length(ds_input.getColumn(0,"TM_CD"))> 0)
	{
		strWhere = "  AND TM_CD ='" + ds_input.getColumn(0,"TM_CD") + "'";
	}
	// 직군
	if (gfn_length(cbo_JOB.value)>0)
	{
		strWhere += "  AND JOB_CD='" + cbo_JOB.value + "'";
	}
	// 상세직군
	if (gfn_length(cbo_SubJob.value)>0)
	{
		strWhere += "  AND SUB_JOB_CD='" + cbo_SubJob.value + "'";
	}
		
	fn_sql_common_setup( fn_MakeUpjangSQL()	//"SELECT UPJANG, UPJANGNM FROM MAC_UPJANG_V WHERE (1=1)"
						,strMAQuery_UpjangKeyField
						,strMAQuery_UpjangValueField
						,strMAQuery_UpjangKeyFieldNM
						,strMAQuery_UpjangValueFieldNM
						,""
						,"" //ed_UPJANG_NM.Text
						,strWhere
						,strMAQuery_UpjangCaption
						,strMAQuery_UpjangAllField
						);
						
	ds_input.setColumn(0,"UPJANG_NM",gds_sql_common.getColumn(0, "ret_name"));
	ds_input.setColumn(0,"UPJANG",gds_sql_common.getColumn(0, "ret_code"));
}

/*
 ******************************************************************************************
 * 함  수  명   : ed_pop_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
 * 기      능   : 팝업edit키입력시
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-03  
 ******************************************************************************************
 */
function ed_pop_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if( e.keycode == 13 ) {
		if( gfn_length(gfn_trim(obj.value))== 0 ) {
			var objme = eval(obj.userdata);
			objme.click();
		}
	} else if( e.keycode == 46 ) {
		switch(obj.name) {
			case "ed_TM_NM" :
				ds_input.setColumn(0, "TM_CD", "");
				ds_input.setColumn(0, "TM_NM", "");
				break;
			case "ed_UPJANG_NM" :
				ds_input.setColumn(0, "UPJANG",    "");
				ds_input.setColumn(0, "UPJANG_NM", "");
				break;
			default :
				break;
		}
	}
}

/*
 ******************************************************************************************
 * 함  수  명   : common_chk_OnClick(obj,strValue)
 * 기      능   : 점검구분선택
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-26  
 ******************************************************************************************
 */
function common_chk_OnClick(obj:CheckBox, e:ClickEventInfo)
{
	var strCheckType = "";
	for(i = 1; i<= 4 ; i++)
	{
		if (eval("chk_CHECK_TYPE" + i).value)
		{
			strCheckType += " '" + eval("chk_CHECK_TYPE" + i).userdata + "' ";
		}
	}
	
	ds_input.setColumn(0,"CHECK_TYPE",gfn_replace(strCheckType,"'  '","','"));
}

/*
 ******************************************************************************************
 * 함  수  명   : grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
 * 기      능   : 점검결과보고서
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-04-22  
 ******************************************************************************************
 */
function grd_list_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
	if (e.row < 0)
	{
		g_Message("EE", "출력오류 : 출력 할 내역이 없습니다.");
		return;
	}
	
	if (e.cell != 23 && e.cell != 14 && e.cell != 15 && e.cell != 16 && e.cell != 17 && e.cell != 18 && e.cell != 19)		//	안전점검보고서
	{
		nRow = ds_list.rowposition;
		
		//레포트에 전달할 파라메터 생성
		var arrParams	= SCReport.newParams ();
		
		//--------------------------------------------------
		//방법1)서버에서 Query에 의해 처리하는 경우 예
		//(필수) 레포트명
		SCReport.setParams (arrParams, SCReport.RPT_NAME, "/IFIS/FSC90020E_R01.ozr");

		//출력 옵션 설정
		//-창 타이틀 (디폴트는 "ReportViewer")
		SCReport.setParams (arrParams, SCReport.RPT_TITLE, "위생안전점검보고서");
		
		//레포트에 맞게 전달되는 개발자 정의 파라미터
		SCReport.setParams (arrParams, "PARAM1", ds_list.getColumn(nRow,"TABLE_TYPE"));// 
		SCReport.setParams (arrParams, "PARAM2", ds_list.getColumn(nRow,"FORM_CD"));	// 
		SCReport.setParams (arrParams, "PARAM3", ds_list.getColumn(nRow,"UPJANG"));// 
		SCReport.setParams (arrParams, "PARAM4", ds_list.getColumn(nRow,"CHECK_DATE"));// 
		SCReport.setParams (arrParams, "PARAM5", ds_list.getColumn(nRow,"UPJANGNM"));// 
		SCReport.setParams (arrParams, "PARAM6", serverSaveUrl);// 
		SCReport.setParams (arrParams, "PARAM7", ds_list.getColumn(nRow,"CHARGE_SABUN"));// 
		//SCReport.setParams (arrParams, "PARAM8", g_OzAlias[g_OzFsus]);// 
		
		SCReport.setParams (arrParams, "zoom", 150);		
		//--------------------------------------------------
		SCReport.viewReport (this, arrParams);
		
// 		var nRow,p1,p2,p3,p4,p5,p6,p7;
// 		
// 		nRow = ds_list.rowposition;
// 		
// 		p1 = ds_list.getColumn(nRow,"TABLE_TYPE");
// 		p2 = ds_list.getColumn(nRow,"FORM_CD");
// 		p3 = ds_list.getColumn(nRow,"UPJANG");
// 		p4 = ds_list.getColumn(nRow,"CHECK_DATE");
// 		p5 = ds_list.getColumn(nRow,"UPJANGNM");
// 		p6 = serverSaveUrl;
// 		p7 = ds_list.getColumn(nRow,"CHARGE_SABUN");
// 	
// 		strParam = "IFIS/oz.asp?title=위생안전점검보고서";			// Page Title
// 		strParam += "&url=IFIS/FSC90020E_위생안전점검보고서.ozr";	// OZ Report File Name
// 		strParam += "&cnt=7";										// Parameters Count
// 		strParam += "&p1=" + p1;									// 점검표구분
// 		strParam += "&p2=" + p2;									// 양식
// 		strParam += "&p3=" + p3;									// 업장코드
// 		strParam += "&p4=" + p4;									// 점검일자
// 		strParam += "&p5=" + p5;									// 업장명
// 		strParam += "&p6=" + p6;									// 이미지URL
// 		strParam += "&p7=" + p7;									// 점장사번
// 		strParam += "&zoom=150";									// 화면 출력 크기
// 		
// 		var sParam = {fstrParam:strParam};
// 		strReturn = gfn_dialog("", "U_SCC::SCCOZREPORT1.xfdl",sParam);
	}

	if (e.cell == 14)		// 점장
	{
		var v_arg = {};
		v_arg["fa_SABUN_GUBUN"]      = "CHARGE";
		v_arg["fa_SABUN"]            = gfn_trim(ds_list.getColumn(e.row, "CHARGE_SABUN"));
		v_arg["fa_SABUN_NM"]         = gfn_trim(ds_list.getColumn(e.row, "CHARGE_NM"));
		v_arg["fa_START_DATE"]       = gfn_trim(ds_input.getColumn(0, "FROM_DT"));
		v_arg["fa_END_DATE"]         = gfn_trim(ds_input.getColumn(0, "TO_DT"));

		gfn_dialog("", "U_FSC::FSC90071P.xfdl", v_arg);	
	}
	
	if (e.cell == 15)		// 대팀장
	{
		var v_arg = {};
		v_arg["fa_SABUN_GUBUN"]      = "TEAM";
		v_arg["fa_SABUN"]            = gfn_trim(ds_list.getColumn(e.row, "TEAM_MST_SABUN"));
		v_arg["fa_SABUN_NM"]         = gfn_trim(ds_list.getColumn(e.row, "TEAM_MST_NM"));
		v_arg["fa_START_DATE"]       = gfn_trim(ds_input.getColumn(0, "FROM_DT"));
		v_arg["fa_END_DATE"]         = gfn_trim(ds_input.getColumn(0, "TO_DT"));

		gfn_dialog("", "U_FSC::FSC90071P.xfdl", v_arg);	
	}

	if (e.cell == 16)		// 소팀장
	{
		var v_arg = {};
		v_arg["fa_SABUN_GUBUN"]      = "SUBTEAM";
		v_arg["fa_SABUN"]            = gfn_trim(ds_list.getColumn(e.row, "SUBTEAM_MST_SABUN"));
		v_arg["fa_SABUN_NM"]         = gfn_trim(ds_list.getColumn(e.row, "SUBTEAM_MST_NM"));
		v_arg["fa_START_DATE"]       = gfn_trim(ds_input.getColumn(0, "FROM_DT"));
		v_arg["fa_END_DATE"]         = gfn_trim(ds_input.getColumn(0, "TO_DT"));

		gfn_dialog("", "U_FSC::FSC90071P.xfdl", v_arg);	
	}

	if (e.cell == 17) 		// 책임자1
	{
		var v_arg = {};
		v_arg["fa_SABUN_GUBUN"]      = "RESP";
		v_arg["fa_SABUN"]            = gfn_trim(ds_list.getColumn(e.row, "RESP_SABUN1"));
		v_arg["fa_SABUN_NM"]         = gfn_trim(ds_list.getColumn(e.row, "RESP_SABUN1_NM"));
		v_arg["fa_START_DATE"]       = gfn_trim(ds_input.getColumn(0, "FROM_DT"));
		v_arg["fa_END_DATE"]         = gfn_trim(ds_input.getColumn(0, "TO_DT"));

		gfn_dialog("", "U_FSC::FSC90071P.xfdl", v_arg);	
	}

	if (e.cell == 18) 		// 책임자2
	{
		var v_arg = {};
		v_arg["fa_SABUN_GUBUN"]      = "RESP";
		v_arg["fa_SABUN"]            = gfn_trim(ds_list.getColumn(e.row, "RESP_SABUN2"));
		v_arg["fa_SABUN_NM"]         = gfn_trim(ds_list.getColumn(e.row, "RESP_SABUN2_NM"));
		v_arg["fa_START_DATE"]       = gfn_trim(ds_input.getColumn(0, "FROM_DT"));
		v_arg["fa_END_DATE"]         = gfn_trim(ds_input.getColumn(0, "TO_DT"));

		gfn_dialog("", "U_FSC::FSC90071P.xfdl", v_arg);	
	}

	if (e.cell == 19) 		// 책임자3
	{
		var v_arg = {};
		v_arg["fa_SABUN_GUBUN"]      = "RESP";
		v_arg["fa_SABUN"]            = gfn_trim(ds_list.getColumn(e.row, "RESP_SABUN3"));
		v_arg["fa_SABUN_NM"]         = gfn_trim(ds_list.getColumn(e.row, "RESP_SABUN3_NM"));
		v_arg["fa_START_DATE"]       = gfn_trim(ds_input.getColumn(0, "FROM_DT"));
		v_arg["fa_END_DATE"]         = gfn_trim(ds_input.getColumn(0, "TO_DT"));

		gfn_dialog("", "U_FSC::FSC90071P.xfdl", v_arg);	
	}
	
}

function grd_list_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	if (e.row < 0)
	{
		g_Message("EE", "출력오류 : 출력 할 내역이 없습니다.");
		return;
	}
	/*==================================================================== 
	 *  수 정 자 : 2014-01-13 김장욱 추가 시작
	 *  요 청 자 : 식품연구소 박정현 요청NO.(SR201401_00979)
	 *  수정내용 : 가. ① 개선계획작성확인날짜 : 날짜 팝업 불러오기하여 클릭으로 날짜 지정 
     *             나. ② 확인자 : 식품연구소 인원 팝업 불러오기하여 클릭으로 확인자 지정 
     *             다. ① 개선계획작성확인날짜, ② 확인자 지정 후 상단의 저장버튼 눌러 저장확인
	 *====================================================================*/  
	if (e.cell == 29)		// 개선계획 작성확인일자
	{
		var v_Date = "";
		if( gfn_length(gfn_trim(ds_list.getColumn(e.row, "IMPROV_CONFIRM_DATE")))!= 8 ) {
			v_Date = gfn_today();
		} else {
			v_Date = ds_list.getColumn(e.row, "IMPROV_CONFIRM_DATE");
		}
		ds_list.rowposition = e.row;
		//var retDate = gfn_dialog("", "U_SCC::SCC_CALENDAR.xfdl","fa_Date="+wrapQuote(v_Date),-1,-1,"Title=false Status=false");
		var nCellRect  = obj.getCellRect(e.row, e.cell); //left,right,top,bottom
		var nX = system.clientToScreenX(obj, nCellRect.left)
		var nY = system.clientToScreenY(obj, nCellRect.top);
		var retDate = gfn_callCalendarPopDiv(v_Date, nX, nY+24);
		
		if(!gfn_isNull(retDate))
		ds_list.setColumn(e.row, "IMPROV_CONFIRM_DATE", retDate);
	}
	
	if (e.cell == 31)		// 확인자
	{
		/*
		var v_rtn=gfn_dialog("", "U_SCC::SCC00041P.xml","");
		
		var v_result=v_rtn.split(";");
		
		if( v_rtn.trim().length()==0 || v_rtn.trim()==null )
		{
			return;
		}
	
		ds_List.SetColumn(nRow,"CONFIRM_SABUN",    v_result[0]);	// 사번
		ds_List.SetColumn(nRow,"CONFIRM_SABUN_NM", v_result[1]);	// 이름
		*/
			fn_sql_common_setup( strMAQuery_SABUN
						,strMAQuery_SABUNKeyField
						,strMAQuery_SABUNValueField
						,strMAQuery_SABUNKeyFieldNM
						,strMAQuery_SABUNValueFieldNM
						,""
						,""
						,""
						,strMAQuery_SABUNCaption
						,strMAQuery_SABUNAllField
						);
						
	ds_list.setColumn(e.row,"CONFIRM_SABUN",    gds_sql_common.getColumn(0, "ret_code"));
	ds_list.setColumn(e.row,"CONFIRM_SABUN_NM", gds_sql_common.getColumn(0, "ret_name"));						
	/*==================================================================== 
	 * 2014-01-13 김장욱 추가 종료
	 *====================================================================*/  	
	}
	if (e.cell == 27)		// 계선계획보고서
	{
		if (ds_list.getColumn(e.row,"WRITE_YN") == "N")
		{
			g_Message("EE", "계선계획 데이터가 없습니다.");
			return;
		}
		
		nRow = e.row;
		
		//레포트에 전달할 파라메터 생성
		var arrParams	= SCReport.newParams ();
		
		//--------------------------------------------------
		//방법1)서버에서 Query에 의해 처리하는 경우 예
		//(필수) 레포트명
		SCReport.setParams (arrParams, SCReport.RPT_NAME, "/IFIS/FSC90030E_R02.ozr");

		//출력 옵션 설정
		//-창 타이틀 (디폴트는 "ReportViewer")
		SCReport.setParams (arrParams, SCReport.RPT_TITLE, "개선조치보고서");
		
		//레포트에 맞게 전달되는 개발자 정의 파라미터
		SCReport.setParams (arrParams, "PARAM1", ds_list.getColumn(nRow,"TABLE_TYPE"));// 
		SCReport.setParams (arrParams, "PARAM2", ds_list.getColumn(nRow,"FORM_CD"));	// 
		SCReport.setParams (arrParams, "PARAM3", ds_list.getColumn(nRow,"UPJANG"));// 
		SCReport.setParams (arrParams, "PARAM4", ds_list.getColumn(nRow,"CHECK_DATE"));// 
		SCReport.setParams (arrParams, "PARAM5", ds_list.getColumn(nRow,"UPJANGNM"));// 
		SCReport.setParams (arrParams, "PARAM6", serverSaveUrl);// 
		//SCReport.setParams (arrParams, "PARAM7", ds_list.getColumn(nRow,"CHARGE_SABUN"));// 
		//SCReport.setParams (arrParams, "PARAM8", g_OzAlias[g_OzFsus]);// 
		
		SCReport.setParams (arrParams, "zoom", 150);		
		//--------------------------------------------------
		SCReport.viewReport (this, arrParams);
		
// 		var p1,p2,p3,p4,p5,p6;
// 	
// 		p1 = ds_list.getColumn(e.row,"TABLE_TYPE");
// 		p2 = ds_list.getColumn(e.row,"FORM_CD");
// 		p3 = ds_list.getColumn(e.row,"UPJANG");
// 		p4 = ds_list.getColumn(e.row,"CHECK_DATE");
// 		p5 = ds_list.getColumn(e.row,"UPJANGNM");
// 		p6 = serverSaveUrl;
// 	
// 		strParam = "IFIS/oz.asp?title=개선조치보고서";				// Page Title
// 		strParam += "&url=IFIS/FSC90030E_개선조치보고서2.ozr";		// OZ Report File Name
// 		strParam += "&cnt=6";										// Parameters Count
// 		strParam += "&p1=" + p1;									// 점검표구분
// 		strParam += "&p2=" + p2;									// 양식
// 		strParam += "&p3=" + p3;									// 업장코드
// 		strParam += "&p4=" + p4;									// 점검일자
// 		strParam += "&p5=" + p5;									// 업장명
// 		strParam += "&p6=" + p6;									// 이미지URL
// 		strParam += "&zoom=150";									// 화면 출력 크기
// 		
// 		var sParam = {fstrParam:strParam};
// 		strReturn = gfn_dialog("", "U_SCC::SCCOZREPORT1.xfdl",sParam);
	}
}
//============================================
// DataSet change Event
//============================================
function ds_list_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if(e.columnid == "CONFIRM_SABUN_NM"){	// 확인자
		
		if(gfn_length(gfn_trim(ds_list.getColumn(e.row, "CONFIRM_SABUN_NM")))== 0){
			// 초기화
			ds_list.setColumn(e.row, "CONFIRM_SABUN",    "");
		}
	}
}

function common_patrol_OnClick(obj:CheckBox, e:ClickEventInfo)
{
	
	if(obj.value == "Y")
	{
		grd_list.setFormatColProperty(3, "size", 0);
		grd_list.setFormatColProperty(4, "size", 0);
		grd_list.setFormatColProperty(6, "size", 0);
 		grd_list.setFormatColProperty(9, "size", 0);
 		grd_list.setFormatColProperty(10, "size", 0);
 		grd_list.setFormatColProperty(11, "size", 0);
	
 		grd_list.setFormatColProperty(22, "size", 60);
		grd_list.setFormatColProperty(23, "size", 60);
 		grd_list.setFormatColProperty(24, "size", 60);
 		
 		grd_list.setFormatColProperty(28, "size", 0);
 		grd_list.setFormatColProperty(29, "size", 0);
 		grd_list.setFormatColProperty(30, "size", 0);
 		grd_list.setFormatColProperty(31, "size", 0);
		
	}
	else
	{
		grd_list.setFormatColProperty(3, "size", 50);
		grd_list.setFormatColProperty(4, "size", 80);
		grd_list.setFormatColProperty(6, "size", 75);
		grd_list.setFormatColProperty(9, "size", 60);
		grd_list.setFormatColProperty(10, "size", 60);
		grd_list.setFormatColProperty(11, "size", 80);
		
		grd_list.setFormatColProperty(22, "size", 0);
		grd_list.setFormatColProperty(23, "size", 0);
		grd_list.setFormatColProperty(24, "size", 0);
		
		grd_list.setFormatColProperty(28, "size", 82);
		grd_list.setFormatColProperty(29, "size", 20);
		grd_list.setFormatColProperty(30, "size", 77);
		grd_list.setFormatColProperty(31, "size", 20);
	}
	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_muChange(obj, event)
 * 기ㅡㅡㅡ능 : 사업부 변경시 운영부서, 사업장 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function fn_muChange(obj, event)
{
	edt_tm.setTmCode("");
	cbo_JOB.value = "";
    cbo_SubJob.value = "";
    edt_upjang.setUpjangCode("");
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_tmChange(obj, data)
 * 기ㅡㅡㅡ능 : 운영부서 변경시 사업장 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function fn_tmChange(obj, data)
{
    cbo_JOB.value = "";
    cbo_SubJob.value = "";
    edt_upjang.setUpjangCode("");
}]]></Script>
  </Form>
</FDL>

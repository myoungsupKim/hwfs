<?xml version="1.0" encoding="euc-kr"?>
<query>
	<type>select</type>
	<description><![CDATA[월 경영실적 조회]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>1</result-count>
	<statement>
<![CDATA[
SELECT UPJANG, LINE_NAME,
       (ACT_AMT1 + ACT_AMT2 + ACT_AMT3 + ACT_AMT4 + ACT_AMT5 + ACT_AMT6 + ACT_AMT7 + ACT_AMT8 + ACT_AMT9 + ACT_AMT10 + ACT_AMT11 + ACT_AMT12) AS SUM_ACT_AMT,
       CASE (DENOMINATOR_ACT_AMT1 + DENOMINATOR_ACT_AMT2 + DENOMINATOR_ACT_AMT3 + DENOMINATOR_ACT_AMT4 + DENOMINATOR_ACT_AMT5 + DENOMINATOR_ACT_AMT6
             + DENOMINATOR_ACT_AMT7 + DENOMINATOR_ACT_AMT8 + DENOMINATOR_ACT_AMT9 + DENOMINATOR_ACT_AMT10 + DENOMINATOR_ACT_AMT11 + DENOMINATOR_ACT_AMT12)
       WHEN 0 THEN 0
       ELSE ROUND( ( (NUMERATOR_ACT_AMT1 + NUMERATOR_ACT_AMT2 + NUMERATOR_ACT_AMT3 + NUMERATOR_ACT_AMT4 + NUMERATOR_ACT_AMT5 + NUMERATOR_ACT_AMT6
                      + NUMERATOR_ACT_AMT7 + NUMERATOR_ACT_AMT8 + NUMERATOR_ACT_AMT9 + NUMERATOR_ACT_AMT10 + NUMERATOR_ACT_AMT11 + NUMERATOR_ACT_AMT12) /
                     (DENOMINATOR_ACT_AMT1 + DENOMINATOR_ACT_AMT2 + DENOMINATOR_ACT_AMT3 + DENOMINATOR_ACT_AMT4 + DENOMINATOR_ACT_AMT5 + DENOMINATOR_ACT_AMT6
                      + DENOMINATOR_ACT_AMT7 + DENOMINATOR_ACT_AMT8 + DENOMINATOR_ACT_AMT9 + DENOMINATOR_ACT_AMT10 + DENOMINATOR_ACT_AMT11 + DENOMINATOR_ACT_AMT12) ) * 100 ,1)
       END AS SUM_ACT_PER,
       ACT_AMT1, ROUND(DECODE(DENOMINATOR_ACT_AMT1, 0, 0, (NUMERATOR_ACT_AMT1 / DENOMINATOR_ACT_AMT1) * 100 ),1) AS ACT_PER1,
       ACT_AMT2, ROUND(DECODE(DENOMINATOR_ACT_AMT2, 0, 0, (NUMERATOR_ACT_AMT2 / DENOMINATOR_ACT_AMT2) * 100 ),1) AS ACT_PER2,
       ACT_AMT3, ROUND(DECODE(DENOMINATOR_ACT_AMT3, 0, 0, (NUMERATOR_ACT_AMT3 / DENOMINATOR_ACT_AMT3) * 100 ),1) AS ACT_PER3,
       ACT_AMT4, ROUND(DECODE(DENOMINATOR_ACT_AMT4, 0, 0, (NUMERATOR_ACT_AMT4 / DENOMINATOR_ACT_AMT4) * 100 ),1) AS ACT_PER4,
       ACT_AMT5, ROUND(DECODE(DENOMINATOR_ACT_AMT5, 0, 0, (NUMERATOR_ACT_AMT5 / DENOMINATOR_ACT_AMT5) * 100 ),1) AS ACT_PER5,
       ACT_AMT6, ROUND(DECODE(DENOMINATOR_ACT_AMT6, 0, 0, (NUMERATOR_ACT_AMT6 / DENOMINATOR_ACT_AMT6) * 100 ),1) AS ACT_PER6,
       ACT_AMT7, ROUND(DECODE(DENOMINATOR_ACT_AMT7, 0, 0, (NUMERATOR_ACT_AMT7 / DENOMINATOR_ACT_AMT7) * 100 ),1) AS ACT_PER7,
       ACT_AMT8, ROUND(DECODE(DENOMINATOR_ACT_AMT8, 0, 0, (NUMERATOR_ACT_AMT8 / DENOMINATOR_ACT_AMT8) * 100 ),1) AS ACT_PER8,
       ACT_AMT9, ROUND(DECODE(DENOMINATOR_ACT_AMT9, 0, 0, (NUMERATOR_ACT_AMT9 / DENOMINATOR_ACT_AMT9) * 100 ),1) AS ACT_PER9,
       ACT_AMT10, ROUND(DECODE(DENOMINATOR_ACT_AMT10, 0, 0, (NUMERATOR_ACT_AMT10 / DENOMINATOR_ACT_AMT10) * 100 ),1) AS ACT_PER10,
       ACT_AMT11, ROUND(DECODE(DENOMINATOR_ACT_AMT11, 0, 0, (NUMERATOR_ACT_AMT11 / DENOMINATOR_ACT_AMT11) * 100 ),1) AS ACT_PER11,
       ACT_AMT12, ROUND(DECODE(DENOMINATOR_ACT_AMT12, 0, 0, (NUMERATOR_ACT_AMT12 / DENOMINATOR_ACT_AMT12) * 100 ),1) AS ACT_PER12
  FROM (
        SELECT #UPJANG# AS UPJANG, LINE_ID, SORT_SEQ, LINE_NAME, NUMERATOR, DENOMINATOR,
               -- 기준달 
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, LINE_ID, #MONTH1#, #MONTH1#, '1') AS ACT_AMT1, -- 경영실적
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, NUMERATOR, #MONTH1#, #MONTH1#, '1') AS NUMERATOR_ACT_AMT1, -- 구성비(분자)	
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, DENOMINATOR, #MONTH1#, #MONTH1#, '1') AS DENOMINATOR_ACT_AMT1, -- 구성비(분모)
               -- 기준달 + 1
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, LINE_ID, #MONTH2#, #MONTH2#, '1') AS ACT_AMT2, -- 경영실적
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, NUMERATOR, #MONTH2#, #MONTH2#, '1') AS NUMERATOR_ACT_AMT2, -- 구성비(분자)	
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, DENOMINATOR, #MONTH2#, #MONTH2#, '1') AS DENOMINATOR_ACT_AMT2, -- 구성비(분모)
               -- 기준달 + 2
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, LINE_ID, #MONTH3#, #MONTH3#, '1') AS ACT_AMT3, -- 경영실적
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, NUMERATOR, #MONTH3#, #MONTH3#, '1') AS NUMERATOR_ACT_AMT3, -- 구성비(분자)	
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, DENOMINATOR, #MONTH3#, #MONTH3#, '1') AS DENOMINATOR_ACT_AMT3, -- 구성비(분모)
               -- 기준달 + 3
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, LINE_ID, #MONTH4#, #MONTH4#, '1') AS ACT_AMT4, -- 경영실적
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, NUMERATOR, #MONTH4#, #MONTH4#, '1') AS NUMERATOR_ACT_AMT4, -- 구성비(분자)	
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, DENOMINATOR, #MONTH4#, #MONTH4#, '1') AS DENOMINATOR_ACT_AMT4, -- 구성비(분모)
               -- 기준달 + 4
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, LINE_ID, #MONTH5#, #MONTH5#, '1') AS ACT_AMT5, -- 경영실적
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, NUMERATOR, #MONTH5#, #MONTH5#, '1') AS NUMERATOR_ACT_AMT5, -- 구성비(분자)	
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, DENOMINATOR, #MONTH5#, #MONTH5#, '1') AS DENOMINATOR_ACT_AMT5, -- 구성비(분모)
               -- 기준달 + 5
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, LINE_ID, #MONTH6#, #MONTH6#, '1') AS ACT_AMT6, -- 경영실적
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, NUMERATOR, #MONTH6#, #MONTH6#, '1') AS NUMERATOR_ACT_AMT6, -- 구성비(분자)	
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, DENOMINATOR, #MONTH6#, #MONTH6#, '1') AS DENOMINATOR_ACT_AMT6, -- 구성비(분모)
               -- 기준달 + 6
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, LINE_ID, #MONTH7#, #MONTH7#, '1') AS ACT_AMT7, -- 경영실적
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, NUMERATOR, #MONTH7#, #MONTH7#, '1') AS NUMERATOR_ACT_AMT7, -- 구성비(분자)	
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, DENOMINATOR, #MONTH7#, #MONTH7#, '1') AS DENOMINATOR_ACT_AMT7, -- 구성비(분모)
               -- 기준달 + 7
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, LINE_ID, #MONTH8#, #MONTH8#, '1') AS ACT_AMT8, -- 경영실적
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, NUMERATOR, #MONTH8#, #MONTH8#, '1') AS NUMERATOR_ACT_AMT8, -- 구성비(분자)	
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, DENOMINATOR, #MONTH8#, #MONTH8#, '1') AS DENOMINATOR_ACT_AMT8, -- 구성비(분모)
               -- 기준달 + 8
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, LINE_ID, #MONTH9#, #MONTH9#, '1') AS ACT_AMT9, -- 경영실적
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, NUMERATOR, #MONTH9#, #MONTH9#, '1') AS NUMERATOR_ACT_AMT9, -- 구성비(분자)	
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, DENOMINATOR, #MONTH9#, #MONTH9#, '1') AS DENOMINATOR_ACT_AMT9, -- 구성비(분모)
               -- 기준달 + 9
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, LINE_ID, #MONTH10#, #MONTH10#, '1') AS ACT_AMT10, -- 경영실적
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, NUMERATOR, #MONTH10#, #MONTH10#, '1') AS NUMERATOR_ACT_AMT10, -- 구성비(분자)	
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, DENOMINATOR, #MONTH10#, #MONTH10#, '1') AS DENOMINATOR_ACT_AMT10, -- 구성비(분모)
               -- 기준달 + 10
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, LINE_ID, #MONTH11#, #MONTH11#, '1') AS ACT_AMT11, -- 경영실적
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, NUMERATOR, #MONTH11#, #MONTH11#, '1') AS NUMERATOR_ACT_AMT11, -- 구성비(분자)	
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, DENOMINATOR, #MONTH11#, #MONTH11#, '1') AS DENOMINATOR_ACT_AMT11, -- 구성비(분모)
               -- 기준달 + 11
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, LINE_ID, #MONTH12#, #MONTH12#, '1') AS ACT_AMT12, -- 경영실적
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, NUMERATOR, #MONTH12#, #MONTH12#, '1') AS NUMERATOR_ACT_AMT12, -- 구성비(분자)	
               FMO_PL_LINE_FUN(UPJANG, #UPJANG#, DENOMINATOR, #MONTH12#, #MONTH12#, '1') AS DENOMINATOR_ACT_AMT12 -- 구성비(분모)
          FROM FMO_PL_LINE
         WHERE UPJANG = #MAIN_UPJANG# -- 본사코드(필수 검색조건)
         ORDER BY SORT_SEQ )	]]></statement>
	<input default-name="ds_Input">
	</input>
	<output default-name="ds_List">
	</output>
</query>

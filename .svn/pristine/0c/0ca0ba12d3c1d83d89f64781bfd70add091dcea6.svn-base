<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="form" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 848" titletext="계약 관리" scrollbars="autoboth" onload="form_onload" enable="true">
    <Layouts>
      <Layout>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute -2 833 1250 848" anchor="left bottom"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Grid id="grd_list" taborder="5" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 0 94 497 828" anchor="left top" binddataset="ds_contract" autofittype="col" oncellclick="grd_list_oncellclick" oncelldblclick="grd_list_oncelldblclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="31"/>
                <Column size="77"/>
                <Column size="0"/>
                <Column size="180"/>
                <Column size="75"/>
                <Column size="62"/>
                <Column size="75"/>
                <Column size="83"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="상태"/>
                <Cell col="2" text="계약번호"/>
                <Cell col="3" text="계약명"/>
                <Cell col="4" text="거래처명"/>
                <Cell col="5" text="계약분류"/>
                <Cell col="6" text="계약시작일"/>
                <Cell col="7" text="계약종료일"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" text="bind:contractProgressNm"/>
                <Cell col="2" displaytype="text" edittype="none" style="align:center middle;" text="bind:contractCd"/>
                <Cell col="3" style="align:left middle;" text="bind:contractName"/>
                <Cell col="4" text="bind:custNm"/>
                <Cell col="5" text="expr:cntrtCategory=='1' ? '신규' : '연장'"/>
                <Cell col="6" text="bind:startDate"/>
                <Cell col="7" text="bind:endDate"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1250 847" anchor="top right"/>
        <Static id="Static22" text="계약 목록" class="sta_WF_Title01" position="absolute 0 76 450 94" anchor="left top"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 89 1237 94" anchor="left top"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 1237 40" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 1237 71" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 386 40 396 61" anchor="left top"/>
        <Edit id="edt_s_contractNm" taborder="2" position="absolute 392 40 564 61" anchor="left top" onkeydown="edt_s_custnm_onkeydown" imemode="hangul"/>
        <Static id="Static19" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 308 40 328 61" anchor="left top"/>
        <Static id="Static01" text="계약명" class="sta_WFSA_label" position="absolute 330 40 390 61" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 564 40 584 61" anchor="left top"/>
        <Static id="Static10" text="진행상태" class="sta_WFSA_label" position="absolute 871 40 931 61" anchor="left top"/>
        <Combo id="cbo_s_contractStats" taborder="4" position="absolute 940 40 1029 61" value="Y" text="사용" index="1"/>
        <Static id="Static13" text="계약 상세" class="sta_WF_Title01" position="absolute 500 76 950 94" anchor="left top"/>
        <Div id="div_psnl" anchor="all" taborder="15" style="border:0 solid #808080ff ;" position="absolute 2015 102 2766 720">
          <Layouts>
            <Layout/>
          </Layouts>
        </Div>
        <Static id="Static00" text="사업자번호" class="sta_WFSA_label" position="absolute 1046 40 1120 61" anchor="left top" visible="false"/>
        <MaskEdit id="msk_s_bsnNo" taborder="3" type="string" mask="###-##-#####" autoselect="true" position="absolute 1128 40 1214 61" style="padding:1 5 0 5;align:center middle;" onkeydown="msk_s_bsnNo_onkeydown" visible="false"/>
        <Static id="Static29" text="※ " class="sta_WF_DiscPointN" position="absolute 579 77 946 95" anchor="left top" visible="false"/>
        <Static id="sta_detail12" class="sta_WFDA_Labelbg" position="absolute 606 250 1220 279"/>
        <Static id="sta_detail07" class="sta_WFDA_Labelbg" position="absolute 606 383 1220 576"/>
        <Static id="sta_detail05" class="sta_WFDA_Labelbg" position="absolute 606 94 1220 121"/>
        <Static id="sta_detail00" class="sta_WFDA_Labelbg" position="absolute 606 146 1220 173"/>
        <Static id="Static17" text="계 약 명" class="sta_WFDA_Label01" position="absolute 501 94 607 121"/>
        <Static id="Static65" text="계 약 번 호" class="sta_WFDA_Label01" position="absolute 873 95 969 119"/>
        <Edit id="ed_contractName" taborder="20" class="edt_WF_Essential" position="absolute 611 97 871 118" enable="true"/>
        <Static id="Static18" text="귀 속 부 서" class="sta_WFDA_Label01" position="absolute 873 146 969 173"/>
        <Static id="Static20" text="거 래 처" class="sta_WFDA_Label01" position="absolute 501 146 607 173"/>
        <Edit id="ed_CustCd" taborder="22" readonly="true" onkeydown="ed_pop_OnKeyDown" oneditclick="ed_MAIN_UPJANG_oneditclick" class="edt_WF_Essential" position="absolute 611 149 678 170" userdata="btn_pop1" enable="true"/>
        <Static id="sta_detail02" class="sta_WFDA_Labelbg" position="absolute 606 172 1220 199"/>
        <Static id="Static21" text="임차자산특성" class="sta_WFDA_Label01" position="absolute 501 172 607 199" tooltiptext="기준: 대상자산을 계약시점에 특정 또는 사용하는 시점에 특정가능"/>
        <Static id="sta_detail03" class="sta_WFDA_Labelbg" position="absolute 606 198 1220 225"/>
        <Static id="Static23" text="사용수익권" class="sta_WFDA_Label01" position="absolute 501 198 607 225" tooltiptext="기준: 대상자산을 사용함으로 생기는 경제적 효익을 이용자가 갖는다."/>
        <Radio id="rdo_LENT_ASSET_YN" taborder="23" innerdataset="@ds_yn" codecolumn="CODE" datacolumn="CODE_NAME" position="absolute 621 177 788 198" style="textpadding:0 12 0 5;" index="-1" rowcount="-1" columncount="-1"/>
        <Radio id="rdo_USUFRUCT_YN" taborder="24" innerdataset="@ds_yn" codecolumn="CODE" datacolumn="CODE_NAME" onitemclick="rdo_CUST_TYPE_onitemclick" position="absolute 621 202 787 223" style="textpadding:0 12 0 5;" columncount="-1" index="-1" rowcount="-1"/>
        <Static id="sta_detail04" class="sta_WFDA_Labelbg" position="absolute 606 223 1220 252"/>
        <Static id="Static24" text="사용지시권" class="sta_WFDA_Label01" position="absolute 873 197 969 224" tooltiptext="기준1: 회사가 대상자산의 사용목적과 방법을 지시할 권리 보유?&#13;&#10;기준2: 계약에 미리 사용목적과 방법이 정해졌다면 대상자산을 운용할 권리 보유하는가?&#13;&#10;기준3:회사가 운용할 권리가 없다면 회사가 대상자산을 설계하였는가?"/>
        <Radio id="rdo_ORDER_YN" taborder="25" innerdataset="@ds_yn" codecolumn="CODE" datacolumn="CODE_NAME" onitemclick="rdo_CUST_TYPE_onitemclick" position="absolute 983 202 1120 223" style="textpadding:0 12 0 5;" columncount="-1" index="-1" rowcount="-1"/>
        <Static id="sta_detail06" class="sta_WFDA_Labelbg" position="absolute 606 278 1220 384"/>
        <Static id="Static25" text="소액자산여부" class="sta_WFDA_Label01" position="absolute 873 172 969 199" tooltiptext="기준: 새 것일 때 기준으로 5백만원 이하의 대상자산"/>
        <Static id="Static26" text="계약기간 - 기본" class="sta_WFDA_Label01" position="absolute 501 223 607 252"/>
        <Static id="Static75" text="~" position="absolute 722 230 731 248"/>
        <Edit id="ed_contractPrd" taborder="26" readonly="true" onkeydown="ed_pop_OnKeyDown" oneditclick="ed_MAIN_UPJANG_oneditclick" class="edt_WF_Essential" position="absolute 847 228 881 249" userdata="btn_pop1"/>
        <Static id="Static27" text="개월" position="absolute 887 229 948 249"/>
        <Static id="Static28" text="계약기간 - 판단" class="sta_WFDA_Label01" position="absolute 501 278 607 384"/>
        <CheckBox id="periodGb01" taborder="27" text="연장선택권(이용자) - 연장선택권 행사확률 50% 이상" value="N" truevalue="Y" falsevalue="N" position="absolute 615 280 1019 305" tooltiptext="리스이용자만 단독 보유한 연장선택권의 행사 가능성이 50% 이상" tooltiptype="default"/>
        <CheckBox id="periodGb02" taborder="28" text="종료선택권(이용자) - 종료선택권 행사확률 50% 이상" value="N" truevalue="Y" falsevalue="N" position="absolute 615 305 1039 330" tooltiptext="리스이용자만 단독 보유한 종료선택권의 행사 가능성이 50% 이상"/>
        <CheckBox id="periodGb03" taborder="29" text="종료선택권을 쌍방 모두 보유하며, 종료선택시 Penalty 중요하지 않음" value="N" truevalue="Y" falsevalue="N" position="absolute 615 329 1035 354" tooltiptext="종료선택권을 쌍방 모두 보유하며, 페널티는 중요하지 않음. 패널티 = 직접해지원가 + 간접해지원가가 1개월 임차료 이하"/>
        <Static id="Static30" text="    월단위 입력 :" position="absolute 1047 282 1155 302"/>
        <Static id="Static31" text="종료시 잔여월수 :" position="absolute 1040 306 1145 326"/>
        <Static id="Static32" text="    사전통보기간 :" position="absolute 1040 330 1150 350"/>
        <Edit id="ed_PERIOD01" taborder="30" onkeydown="ed_pop_OnKeyDown" oneditclick="ed_MAIN_UPJANG_oneditclick" ontextchanged="ed_PERIOD01_ontextchanged" class="edt_WF_Essential" position="absolute 1147 282 1181 303" userdata="btn_pop1"/>
        <Static id="Static33" text="개월" position="absolute 1187 283 1248 303"/>
        <Edit id="ed_PERIOD02" taborder="31" onkeydown="ed_pop_OnKeyDown" oneditclick="ed_MAIN_UPJANG_oneditclick" ontextchanged="ed_PERIOD02_ontextchanged" class="edt_WF_Essential" position="absolute 1147 305 1181 326" userdata="btn_pop1"/>
        <Static id="Static34" text="개월" position="absolute 1187 306 1248 326"/>
        <Edit id="ed_PERIOD03" taborder="32" onkeydown="ed_pop_OnKeyDown" oneditclick="ed_MAIN_UPJANG_oneditclick" ontextchanged="ed_PERIOD03_ontextchanged" class="edt_WF_Essential" position="absolute 1147 328 1181 349" userdata="btn_pop1"/>
        <Static id="Static35" text="개월" position="absolute 1187 329 1248 349"/>
        <Edit id="ed_NC_PERIOD" taborder="33" readonly="true" onkeydown="ed_pop_OnKeyDown" oneditclick="ed_MAIN_UPJANG_oneditclick" ontextchanged="ed_NC_PERIOD_ontextchanged" class="edt_WF_Essential" position="absolute 737 358 771 379" userdata="btn_pop1"/>
        <Static id="Static36" text="※ 해지불능기간" position="absolute 627 359 735 379" style="border:0 none #808080ff ;font:Gulim,9,bold;"/>
        <Static id="Static37" text="개월  + " position="absolute 779 359 826 379"/>
        <Static id="Static38" text="개월  = " position="absolute 944 358 991 378"/>
        <Edit id="ed_RO_PERIOD" taborder="34" readonly="true" onkeydown="ed_pop_OnKeyDown" oneditclick="ed_MAIN_UPJANG_oneditclick" class="edt_WF_Essential" position="absolute 902 357 936 378" userdata="btn_pop1"/>
        <Static id="Static39" text="선택권기간" position="absolute 829 359 914 379" style="border:0 solid #808080ff ;font:Gulim,9,bold;"/>
        <Static id="Static40" text="리스기간" position="absolute 993 358 1078 378" style="border:0 solid #808080ff ;font:Gulim,9,bold;"/>
        <Edit id="ed_LS_PERIOD" taborder="35" readonly="true" onkeydown="ed_pop_OnKeyDown" oneditclick="ed_MAIN_UPJANG_oneditclick" class="edt_WF_Essential" position="absolute 1058 357 1092 378" userdata="btn_pop1"/>
        <Static id="Static41" text="개월" position="absolute 1100 358 1147 378"/>
        <CheckBox id="fdYn" taborder="36" text="고정리스료" value="N" truevalue="Y" falsevalue="N" position="absolute 616 415 766 435" tooltiptext="월 고정적으로 나가는 임차료"/>
        <CheckBox id="vaYn" taborder="37" text="변동리스료" value="N" truevalue="Y" falsevalue="N" position="absolute 616 442 766 462" tooltiptext="물가지수연동, 시장대여율 연동, 금리연동 등으로 회계팀 문의 바람"/>
        <CheckBox id="gtMinN" taborder="38" text="매출연동리스료(최소보장 없음)" value="N" truevalue="Y" falsevalue="N" position="absolute 616 469 844 489" tooltiptext="최저보장없는 매출연동리스료는 리스부채 대상에서 제외"/>
        <CheckBox id="gtMinY" taborder="39" text="매출연동리스료(최소보장 있음)" value="N" truevalue="Y" falsevalue="N" position="absolute 616 496 812 516" tooltiptext="최저보장있을 시 월 최저보장리스료를 기본리스료로 한다."/>
        <CheckBox id="lwBuyYn" taborder="40" text="염가매수청구권" value="N" truevalue="Y" falsevalue="N" position="absolute 616 523 766 543" tooltiptext="염가로 매수할 수 있는 선택권이 있을 경우 그 행사가격을 기재"/>
        <CheckBox id="gvYn" taborder="41" text="잔존보증가치" value="N" truevalue="Y" falsevalue="N" position="absolute 616 550 766 570" tooltiptext="계약기간 만료시 잔존가치 보증시 그 금액"/>
        <Static id="Static50" text="    월 고정금액 :" position="absolute 867 414 975 434"/>
        <Static id="Static51" text="    월 추정금액 :" position="absolute 867 442 975 462"/>
        <Static id="Static52" text="    월 최소보장 금액 :" position="absolute 842 496 975 516"/>
        <Static id="Static53" text="    행사가격 :" position="absolute 885 522 993 542"/>
        <Static id="Static54" text=" 잔존보증가격  :" position="absolute 869 550 977 570"/>
        <Static id="Static42" text="보 증 금" class="sta_WFDA_Label01" position="absolute 501 571 607 605"/>
        <Static id="sta_detail08" class="sta_WFDA_Labelbg" position="absolute 606 574 1220 603"/>
        <MaskEdit id="ed_DT_AMT" taborder="42" mask="#,###" class="cmb_WF_Essential" position="absolute 728 579 867 599"/>
        <Static id="Static43" text="복 구 의 무" class="sta_WFDA_Label01" position="absolute 501 630 607 659"/>
        <Static id="sta_detail09" class="sta_WFDA_Labelbg" position="absolute 606 630 1220 659"/>
        <MaskEdit id="ed_RECOV_EXP_AMT" taborder="43" value="MaskEdit0" mask="#,###" class="cmb_WF_Essential" position="absolute 728 634 867 654" enable="false"/>
        <Static id="Static44" text="월리스료 등" class="sta_WFDA_Label01" position="absolute 501 383 607 575"/>
        <Static id="Static45" text="복구의무 추정금액 :" position="absolute 615 634 744 654"/>
        <Static id="Static46" text="매출거래처 특약" class="sta_WFDA_Label01" position="absolute 501 709 608 801"/>
        <Static id="sta_detail10" class="sta_WFDA_Labelbg" position="absolute 606 701 1220 802"/>
        <CheckBox id="scObYn" taborder="44" text="기물제공" value="N" truevalue="Y" falsevalue="N" position="absolute 615 716 765 736"/>
        <CheckBox id="scPvYn" taborder="45" text="방역 등 서비스 제공" value="N" truevalue="Y" falsevalue="N" position="absolute 615 743 765 763"/>
        <CheckBox id="scInYn" taborder="46" text="당사 서비스 제공" value="N" truevalue="Y" falsevalue="N" position="absolute 615 770 843 790"/>
        <Static id="Static47" text="약정금액 :" position="absolute 767 715 843 735"/>
        <Static id="Static48" text="약정기간 :" position="absolute 948 715 1009 735"/>
        <MaskEdit id="ed_SC_OB_AMT" taborder="47" value="MaskEdit0" readonly="false" mask="#,###" class="cmb_WF_Essential" position="absolute 827 714 940 734"/>
        <Static id="Static49" text="보증금 금액 :" position="absolute 615 579 723 599"/>
        <Static id="Static55" text="약정금액 :" position="absolute 767 743 843 763"/>
        <Static id="Static56" text="약정기간 :" position="absolute 948 743 1009 763"/>
        <MaskEdit id="ed_SC_PV_AMT" taborder="48" value="MaskEdit0" readonly="false" mask="#,###" class="cmb_WF_Essential" position="absolute 827 742 940 762"/>
        <Static id="Static57" text="약정금액 :" position="absolute 767 770 843 790"/>
        <Static id="Static58" text="약정기간 :" position="absolute 948 770 1009 790"/>
        <MaskEdit id="ed_SC_IN_AMT" taborder="49" value="MaskEdit0" readonly="false" mask="#,###" class="cmb_WF_Essential" position="absolute 827 769 940 789"/>
        <CustSearchComponent id="CustSearchComponent00" titletext="거래처 검색용 Component" taborder="50" text="CustSearchComponent00" class="edt_WF_Essential" position="absolute 682 149 870 172" bindDataset="ds_contract" eventBeforeTrigger="" eventAfterTrigger="fn_custAfter" bindCustCodeColumn="custCd" bindCustNameColumn="custNm"/>
        <MaskEdit id="ed_FD_AMT" taborder="51" mask="#,###" class="cmb_WF_Essential" position="absolute 964 414 1127 434"/>
        <MaskEdit id="ed_GT_MIN_AMT" taborder="52" mask="#,###" class="cmb_WF_Essential" position="absolute 964 496 1127 516"/>
        <MaskEdit id="ed_VA_AMT" taborder="53" mask="#,###" class="cmb_WF_Essential" position="absolute 964 442 1127 462"/>
        <MaskEdit id="ed_LW_BUY_AMT" taborder="54" mask="#,###" class="cmb_WF_Essential" position="absolute 964 522 1127 542"/>
        <MaskEdit id="ed_GV_AMT" taborder="55" mask="#,###" class="cmb_WF_Essential" position="absolute 964 550 1127 570"/>
        <Radio id="rdo_SMALL_ASSET_YN" taborder="56" innerdataset="@ds_yn" codecolumn="CODE" datacolumn="CODE_NAME" onitemclick="rdo_CUST_TYPE_onitemclick" position="absolute 983 177 1139 198" style="textpadding:0 12 0 5;" columncount="-1" index="-1" rowcount="-1"/>
        <ObjCalendar id="cal_CONTRACT_SDATE" titletext="캘린더" taborder="57" scrollbars="none" class="cal_WF_Essential" position="absolute 615 227 716 248"/>
        <ObjCalendar id="cal_CONTRACT_EDATE" titletext="캘린더" taborder="58" scrollbars="none" class="cal_WF_Essential" position="absolute 738 227 839 248"/>
        <ObjCalendar id="cal_SC_OB_PD_S" titletext="캘린더" taborder="59" scrollbars="none" class="cal_WF_Essential" position="absolute 1010 713 1103 734"/>
        <ObjCalendar id="cal_SC_OB_PD_E" titletext="캘린더" taborder="60" scrollbars="none" class="cal_WF_Essential" position="absolute 1119 713 1215 734"/>
        <Static id="Static59" text="~" position="absolute 1107 715 1116 733"/>
        <ObjCalendar id="cal_SC_PV_PD_S" titletext="캘린더" taborder="61" scrollbars="none" class="cal_WF_Essential" position="absolute 1010 741 1103 762"/>
        <ObjCalendar id="cal_SC_PV_PD_E" titletext="캘린더" taborder="62" scrollbars="none" class="cal_WF_Essential" position="absolute 1119 741 1215 762"/>
        <Static id="Static60" text="~" position="absolute 1107 743 1116 761"/>
        <ObjCalendar id="cal_SC_IN_PD_S" titletext="캘린더" taborder="63" scrollbars="none" class="cal_WF_Essential" position="absolute 1010 768 1103 789"/>
        <ObjCalendar id="cal_SC_IN_PD_E" titletext="캘린더" taborder="64" scrollbars="none" class="cal_WF_Essential" position="absolute 1119 768 1215 789"/>
        <Static id="Static61" text="~" position="absolute 1107 770 1116 788"/>
        <Static id="sta_detail11" class="sta_WFDA_Labelbg" position="absolute 595 801 1220 828"/>
        <Static id="Static62" text="종 료 여 부" class="sta_WFDA_Label01" position="absolute 501 801 607 828"/>
        <Static id="sta_detail01" class="sta_WFDA_Labelbg" position="absolute 606 120 1220 147"/>
        <Static id="Static63" text="계 약 구 분" class="sta_WFDA_Label01" position="absolute 501 120 607 147"/>
        <Combo id="cbo_CONTRACT_GB" taborder="65" innerdataset="ds_contractGb" codecolumn="CODE" datacolumn="code_name" onitemchanged="Div00_cbo_USE_YN_onitemchanged" class="cmb_WF_Essential" position="absolute 611 122 871 143"/>
        <Static id="Static64" text="계 약 분 류" class="sta_WFDA_Label01" position="absolute 873 120 969 147"/>
        <Radio id="rdo_END_YN" taborder="67" columncount="2" rowcount="1" index="0" innerdataset="ds_closeyn" codecolumn="CODE" datacolumn="CODE_NAME" value="N" onitemclick="rdo_CUST_TYPE_onitemclick" position="absolute 618 804 727 825" style="textpadding:0 12 0 5;"/>
        <Static id="Static66" text="담 보 가 치" class="sta_WFDA_Label01" position="absolute 501 250 607 279" tooltiptext="회사 조달가능 이자율에 담보능력을 가감하도록 위함 --&gt; 이에 따라 할인율 결정"/>
        <Static id="Static67" text="( 적용할인율: " position="absolute 768 255 861 275"/>
        <Radio id="rdo_callVal" taborder="68" columncount="2" rowcount="1" innerdataset="@ds_callVal" codecolumn="CODE" datacolumn="CODE_NAME" value="1" onitemclick="rdo_CUST_TYPE_onitemclick" position="absolute 621 254 731 275" style="textpadding:0 12 0 5;" index="-1"/>
        <Edit id="ed_DIS_RATE" taborder="69" readonly="true" onkeydown="ed_pop_OnKeyDown" oneditclick="ed_MAIN_UPJANG_oneditclick" position="absolute 847 255 881 276" userdata="btn_pop1"/>
        <Static id="Static68" text=" %," position="absolute 881 256 942 276"/>
        <Static id="Static76" text="인 수 조 건" class="sta_WFDA_Label01" position="absolute 501 602 607 631"/>
        <Static id="sta_detail13" class="sta_WFDA_Labelbg" position="absolute 606 602 1220 631"/>
        <MaskEdit id="ed_EP_TO_AMT" taborder="70" mask="#,###" class="cmb_WF_Essential" position="absolute 728 606 867 626"/>
        <Static id="Static77" text="예상 인수금액 :" position="absolute 615 606 723 626"/>
        <Static id="Static78" text="보증금 현재가치할인차금 금액 :" position="absolute 879 579 1073 599"/>
        <MaskEdit id="ed_DT_REAL_AMT" taborder="71" mask="#,###" class="cmb_WF_Essential" position="absolute 1074 579 1211 599"/>
        <Static id="Static79" text="복구충당부채 :" position="absolute 881 634 973 654"/>
        <MaskEdit id="ed_RECOV_DEB_AMT" taborder="72" value="MaskEdit0" mask="#,###" class="cmb_WF_Essential" position="absolute 1010 634 1165 654" enable="false"/>
        <Static id="Static80" text="최종 값&#13;&#10;(저장 시 계산)" class="sta_WFDA_Label01" position="absolute 501 658 607 710"/>
        <Static id="sta_detail14" class="sta_WFDA_Labelbg" position="absolute 606 658 1220 710"/>
        <MaskEdit id="ed_USE_RGHT_ASSET_AMT" taborder="73" value="MaskEdit0" readonly="true" mask="#,###" class="cmb_WF_Essential" position="absolute 728 662 867 682"/>
        <Static id="Static81" text="사용권자산 계산" position="absolute 615 662 744 682" style="color:blue;font:Gulim,9, bold;"/>
        <Static id="Static82" text="리스부채 계산(총액)" position="absolute 880 662 1008 682" style="color:blue;font:Gulim,9,bold;"/>
        <MaskEdit id="ed_LEASE_DEB_AMT" taborder="74" value="MaskEdit0" readonly="true" mask="#,###" class="cmb_WF_Essential" position="absolute 1010 662 1165 682"/>
        <Edit id="edt_ccNm" taborder="75" tabstop="false" readonly="true" autoselect="true" onkeydown="fn_edBtn_OnKeyDown" enable="false" position="absolute 1043 149 1216 170"/>
        <Button id="btn_ccCdDtl" taborder="76" class="btn_WF_popSearch" position="absolute 1020 149 1041 170" anchor="left top"/>
        <Edit id="edt_ccCd" taborder="77" readonly="true" class="edt_WF_Essential" position="absolute 971 149 1021 170"/>
        <CheckBox id="leYn" taborder="78" text="전세계약(월리스료 없음)" value="N" truevalue="Y" falsevalue="N" position="absolute 616 387 800 407"/>
        <Static id="Static83" text="리스부채 현할차" position="absolute 880 687 982 707" style="color:blue;font:Gulim,9,bold;"/>
        <MaskEdit id="ed_LEASE_DEB_REAL_BAL" taborder="79" value="MaskEdit0" readonly="true" mask="#,###" class="cmb_WF_Essential" position="absolute 1010 687 1165 707"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="82" tabstop="false" url="cmn::CmnBtn.xfdl" scrollbars="none" position="absolute 0 0 1237 30" text="Div00"/>
        <Button id="btn_gwDraft" taborder="85" text="결재상신" position="absolute 754 0 824 26" class="btn_WF_CRUD" anchor="top right" onclick="btn_gwDraft_onclick"/>
        <Button id="btn_gwDetail" taborder="86" text="결재상세" class="btn_WF_CRUD" position="absolute 826 0 896 26" anchor="top right" onclick="btn_gwDetail_onclick"/>
        <Static id="Static70" text="계약기간" class="sta_WFSA_label" position="absolute 15 40 75 61" anchor="left top"/>
        <ObjCalendar id="cal_startDate" titletext="캘린더" taborder="88" scrollbars="none" class="cal_WF_Essential" position="absolute 83 40 182 61"/>
        <Static id="Static72" text="~" position="absolute 190 43 199 61"/>
        <ObjCalendar id="cal_endDate" titletext="캘린더" taborder="89" scrollbars="none" class="cal_WF_Essential" position="absolute 211 40 307 61"/>
        <Static id="Static14" text="거래처" class="sta_WFSA_label" position="absolute 589 40 648 61" anchor="left top"/>
        <CustSearchComponent id="CustSearchComponent01" titletext="거래처 검색용 Component" taborder="90" text="CustSearchComponent01" position="absolute 650 40 844 61" bindDataset="" eventBeforeTrigger="" eventAfterTrigger="" bindCustCodeColumn="" bindCustNameColumn=""/>
        <Static id="Static02" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 845 40 865 61" anchor="left top"/>
        <Static id="Static03" text=" %)" position="absolute 1028 256 1089 276"/>
        <Static id="Static12" text="가중평균이자율: " position="absolute 902 255 995 275"/>
        <Edit id="ed_AVG_RATE" taborder="91" readonly="true" onkeydown="ed_pop_OnKeyDown" oneditclick="ed_MAIN_UPJANG_oneditclick" position="absolute 995 255 1029 276" userdata="btn_pop1"/>
        <Edit id="ed_contractCd" taborder="92" class="edt_WF_Essential" position="absolute 971 97 1216 118" displaynulltext="자동생성" enable="false"/>
        <Combo id="cbo_cntrtCategory" taborder="94" innerdataset="@ds_extYn" codecolumn="CODE" datacolumn="code_name" class="cmb_WF_Essential" position="absolute 971 123 1041 144"/>
        <Button id="btn_extend" taborder="95" text="계약연장" class="btn_WF_CRUD" position="absolute 1043 123 1113 144" onclick="btn_extend_onclick"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item2" compid="edt_s_contractNm" propid="value" datasetid="ds_search" columnid="contractNm"/>
      <BindItem id="item66" compid="cbo_s_contractStats" propid="value" datasetid="ds_search" columnid="contractStats"/>
      <BindItem id="item54" compid="msk_s_bsnNo" propid="value" datasetid="ds_search" columnid="bsnNo"/>
      <BindItem id="item22" compid="sta_detail12" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item51" compid="sta_detail07" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item5" compid="sta_detail05" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item3" compid="sta_detail00" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="ed_UPJANG_value" compid="ed_contractName" propid="value" datasetid="ds_contract" columnid="contractName"/>
      <BindItem id="item6" compid="ed_CustCd" propid="value" datasetid="ds_contract" columnid="custCd"/>
      <BindItem id="item14" compid="sta_detail02" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item35" compid="sta_detail03" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item11" compid="rdo_LENT_ASSET_YN" propid="value" datasetid="ds_contract" columnid="lentAssetYn"/>
      <BindItem id="item29" compid="rdo_USUFRUCT_YN" propid="value" datasetid="ds_contract" columnid="usufructYn"/>
      <BindItem id="item36" compid="sta_detail04" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item30" compid="rdo_ORDER_YN" propid="value" datasetid="ds_contract" columnid="orderYn"/>
      <BindItem id="item37" compid="sta_detail06" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item42" compid="ed_contractPrd" propid="value" datasetid="ds_contract" columnid="contractPeriod"/>
      <BindItem id="item31" compid="periodGb01" propid="value" datasetid="ds_contract" columnid="periodGb01"/>
      <BindItem id="item32" compid="periodGb02" propid="value" datasetid="ds_contract" columnid="periodGb02"/>
      <BindItem id="item33" compid="periodGb03" propid="value" datasetid="ds_contract" columnid="periodGb03"/>
      <BindItem id="item45" compid="ed_PERIOD01" propid="value" datasetid="ds_contract" columnid="period01"/>
      <BindItem id="item46" compid="ed_PERIOD02" propid="value" datasetid="ds_contract" columnid="period02"/>
      <BindItem id="item47" compid="ed_PERIOD03" propid="value" datasetid="ds_contract" columnid="period03"/>
      <BindItem id="item48" compid="ed_NC_PERIOD" propid="value" datasetid="ds_contract" columnid="ncPeriod"/>
      <BindItem id="item49" compid="ed_RO_PERIOD" propid="value" datasetid="ds_contract" columnid="roPeriod"/>
      <BindItem id="item50" compid="ed_LS_PERIOD" propid="value" datasetid="ds_contract" columnid="lsPeriod"/>
      <BindItem id="item34" compid="fdYn" propid="value" datasetid="ds_contract" columnid="fdYn"/>
      <BindItem id="item38" compid="vaYn" propid="value" datasetid="ds_contract" columnid="vaYn"/>
      <BindItem id="item10" compid="gtMinN" propid="value" datasetid="ds_contract" columnid="gtMinN"/>
      <BindItem id="item41" compid="gtMinY" propid="value" datasetid="ds_contract" columnid="gtMinY"/>
      <BindItem id="item52" compid="lwBuyYn" propid="value" datasetid="ds_contract" columnid="lwBuyYn"/>
      <BindItem id="item39" compid="gvYn" propid="value" datasetid="ds_contract" columnid="gvYn"/>
      <BindItem id="item13" compid="sta_detail08" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="med_CREDIT_AMOUNT_value" compid="ed_DT_AMT" propid="value" datasetid="ds_contract" columnid="dtAmt"/>
      <BindItem id="item15" compid="sta_detail09" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item16" compid="ed_RECOV_EXP_AMT" propid="value" datasetid="ds_contract" columnid="recovExpAmt"/>
      <BindItem id="item18" compid="sta_detail10" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item53" compid="scObYn" propid="value" datasetid="ds_contract" columnid="scObYn"/>
      <BindItem id="item7" compid="scPvYn" propid="value" datasetid="ds_contract" columnid="scPvYn"/>
      <BindItem id="item55" compid="scInYn" propid="value" datasetid="ds_contract" columnid="scInYn"/>
      <BindItem id="item19" compid="ed_SC_OB_AMT" propid="value" datasetid="ds_contract" columnid="scObAmt"/>
      <BindItem id="item24" compid="ed_SC_PV_AMT" propid="value" datasetid="ds_contract" columnid="scPvAmt"/>
      <BindItem id="item27" compid="ed_SC_IN_AMT" propid="value" datasetid="ds_contract" columnid="scInAmt"/>
      <BindItem id="item40" compid="ed_FD_AMT" propid="value" datasetid="ds_contract" columnid="fdAmt"/>
      <BindItem id="item8" compid="ed_GT_MIN_AMT" propid="value" datasetid="ds_contract" columnid="gtMinAmt"/>
      <BindItem id="item9" compid="ed_VA_AMT" propid="value" datasetid="ds_contract" columnid="vaAmt"/>
      <BindItem id="item12" compid="ed_LW_BUY_AMT" propid="value" datasetid="ds_contract" columnid="lwBuyAmt"/>
      <BindItem id="item17" compid="ed_GV_AMT" propid="value" datasetid="ds_contract" columnid="gvAmt"/>
      <BindItem id="item56" compid="rdo_SMALL_ASSET_YN" propid="value" datasetid="ds_contract" columnid="smallAssetYn"/>
      <BindItem id="item28" compid="cal_CONTRACT_SDATE" propid="text" datasetid="ds_contract" columnid="startDate"/>
      <BindItem id="item57" compid="cal_CONTRACT_EDATE" propid="text" datasetid="ds_contract" columnid="endDate"/>
      <BindItem id="item61" compid="cal_SC_IN_PD_E" propid="text" datasetid="ds_contract"/>
      <BindItem id="item20" compid="sta_detail11" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item21" compid="sta_detail01" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item23" compid="cbo_CONTRACT_GB" propid="value" datasetid="ds_contract" columnid="contractGb"/>
      <BindItem id="item26" compid="rdo_END_YN" propid="value" datasetid="ds_contract" columnid="endYn"/>
      <BindItem id="item62" compid="rdo_callVal" propid="value" datasetid="ds_contract" columnid="callVal"/>
      <BindItem id="item63" compid="ed_DIS_RATE" propid="value" datasetid="ds_contract" columnid="disRate"/>
      <BindItem id="item64" compid="sta_detail13" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item65" compid="ed_EP_TO_AMT" propid="value" datasetid="ds_contract" columnid="epToAmt"/>
      <BindItem id="item67" compid="ed_DT_REAL_AMT" propid="value" datasetid="ds_contract" columnid="dtRealAmt"/>
      <BindItem id="item68" compid="ed_RECOV_DEB_AMT" propid="value" datasetid="ds_contract" columnid="recovDebAmt"/>
      <BindItem id="item69" compid="sta_detail14" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item70" compid="ed_USE_RGHT_ASSET_AMT" propid="value" datasetid="ds_contract" columnid="useRghtAssetAmt"/>
      <BindItem id="item71" compid="ed_LEASE_DEB_AMT" propid="value" datasetid="ds_contract" columnid="leaseDebAmt"/>
      <BindItem id="item72" compid="edt_ccNm" propid="value" datasetid="ds_contract" columnid="ccNm"/>
      <BindItem id="item73" compid="edt_ccCd" propid="value" datasetid="ds_contract" columnid="ccCd"/>
      <BindItem id="item74" compid="leYn" propid="value" datasetid="ds_contract" columnid="leYn"/>
      <BindItem id="item75" compid="ed_LEASE_DEB_REAL_BAL" propid="value" datasetid="ds_contract" columnid="leaseDebRealBal"/>
      <BindItem id="item76" compid="ed_AVG_RATE" propid="value" datasetid="ds_contract" columnid="avgRate"/>
      <BindItem id="item43" compid="ed_contractCd" propid="value" datasetid="ds_contract" columnid="contractCd"/>
      <BindItem id="item44" compid="cbo_cntrtCategory" propid="value" datasetid="ds_contract" columnid="cntrtCategory"/>
    </Bind>
    <Objects>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="custGrpCd" type="STRING" size="256"/>
          <Column id="custtype" type="STRING" size="256"/>
          <Column id="custnm" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="bsnNo" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="contractNm" type="STRING" size="256"/>
          <Column id="contractStats" type="STRING" size="256"/>
          <Column id="startDate" type="STRING" size="256"/>
          <Column id="endDate" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_list_onrowposchanged" canrowposchange="ds_list_canrowposchange" onvaluechanged="ds_list_onvaluechanged">
        <ColumnInfo>
          <Column id="custcd" type="STRING" size="255"/>
          <Column id="custGrpCd" type="STRING" size="255"/>
          <Column id="custGrpNm" type="STRING" size="255"/>
          <Column id="custtype" type="STRING" size="255"/>
          <Column id="custTypeNm" type="STRING" size="255"/>
          <Column id="custgubun" type="STRING" size="255"/>
          <Column id="custGubunNm" type="STRING" size="255"/>
          <Column id="custnm" type="STRING" size="255"/>
          <Column id="telNo" type="STRING" size="255"/>
          <Column id="telNo1" type="STRING" size="256"/>
          <Column id="telNo2" type="STRING" size="256"/>
          <Column id="telNo3" type="STRING" size="256"/>
          <Column id="handPhone" type="STRING" size="255"/>
          <Column id="faxNo" type="STRING" size="256"/>
          <Column id="faxNo1" type="STRING" size="256"/>
          <Column id="faxNo2" type="STRING" size="256"/>
          <Column id="faxNo3" type="STRING" size="256"/>
          <Column id="hpNo1" type="STRING" size="256"/>
          <Column id="hpNo2" type="STRING" size="256"/>
          <Column id="hpNo3" type="STRING" size="256"/>
          <Column id="emailAddr" type="STRING" size="256"/>
          <Column id="saupno" type="STRING" size="256"/>
          <Column id="subUpjangNum" type="STRING" size="256"/>
          <Column id="custCorpNm" type="STRING" size="256"/>
          <Column id="bubinno" type="STRING" size="256"/>
          <Column id="drname1" type="STRING" size="256"/>
          <Column id="drname2" type="STRING" size="256"/>
          <Column id="upJong" type="STRING" size="256"/>
          <Column id="upTae" type="STRING" size="256"/>
          <Column id="elctnTaxBillYn" type="STRING" size="256"/>
          <Column id="vatCustgubun" type="STRING" size="256"/>
          <Column id="postNo" type="STRING" size="256"/>
          <Column id="addr" type="STRING" size="256"/>
          <Column id="baseAddr" type="STRING" size="256"/>
          <Column id="detailAddr" type="STRING" size="256"/>
          <Column id="nationCd" type="STRING" size="256"/>
          <Column id="currencyCd" type="STRING" size="256"/>
          <Column id="arPayPossYn" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="inspectType" type="STRING" size="256"/>
          <Column id="procResultNm" type="STRING" size="256"/>
          <Column id="custAcctCd" type="STRING" size="256"/>
          <Column id="custPayCond" type="STRING" size="256"/>
          <Column id="vendorAcctCd" type="STRING" size="256"/>
          <Column id="vendorPayCond" type="STRING" size="256"/>
          <Column id="chgReason" type="STRING" size="256"/>
          <Column id="procResultMsg" type="STRING" size="256"/>
          <Column id="rtnReason" type="STRING" size="256"/>
          <Column id="addrKey" type="STRING" size="256"/>
          <Column id="sapCustCd" type="STRING" size="256"/>
          <Column id="frgnCustCd" type="STRING" size="256"/>
          <Column id="hrSosok" type="STRING" size="256"/>
          <Column id="sabun" type="STRING" size="256"/>
          <Column id="procResult" type="STRING" size="256"/>
          <Column id="hlevelCustCd" type="STRING" size="256"/>
          <Column id="requestSapYn" type="STRING" size="256"/>
          <Column id="custRequestSysCd" type="STRING" size="256"/>
          <Column id="custRequestNum" type="STRING" size="256"/>
          <Column id="ceoIdNoEnc" type="STRING" size="256"/>
          <Column id="idNoEnc" type="STRING" size="256"/>
          <Column id="zipCode" type="STRING" size="256"/>
          <Column id="mstAddr" type="STRING" size="256"/>
          <Column id="dtlAddr" type="STRING" size="256"/>
          <Column id="etcAddr" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_searchValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="custnm" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="custnm">title:거래처명,required:false</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_inchargeList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="custcd" type="STRING" size="255"/>
          <Column id="publisherSabun" type="STRING" size="255"/>
          <Column id="nmKor" type="STRING" size="255"/>
          <Column id="ccCd" type="STRING" size="255"/>
          <Column id="ccNm" type="STRING" size="255"/>
          <Column id="mgmtNum" type="STRING" size="255"/>
          <Column id="inchargeName" type="STRING" size="255"/>
          <Column id="inchargeDeptNm" type="STRING" size="255"/>
          <Column id="inchargeTelNumEnc" type="STRING" size="255"/>
          <Column id="inchargeFaxNumEnc" type="STRING" size="255"/>
          <Column id="inchargeHandphoneNumEnc" type="STRING" size="255"/>
          <Column id="inchargeEmailAddrEnc" type="STRING" size="255"/>
          <Column id="smsYn" type="STRING" size="255"/>
          <Column id="lastUseDate" type="STRING" size="255"/>
          <Column id="remark" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_addrCnt" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="addrKey" type="STRING" size="256"/>
          <Column id="addrCnt" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_callVal">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">A</Col>
            <Col id="CODE_NAME">A급</Col>
          </Row>
          <Row>
            <Col id="CODE">B</Col>
            <Col id="CODE_NAME">B급</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_yn">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">Y</Col>
            <Col id="CODE_NAME">YES</Col>
          </Row>
          <Row>
            <Col id="CODE">N</Col>
            <Col id="CODE_NAME">NO</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_closeyn">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">N</Col>
            <Col id="CODE_NAME">사용</Col>
          </Row>
          <Row>
            <Col id="CODE">Y</Col>
            <Col id="CODE_NAME">종료</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_contract" oncolumnchanged="ds_contract_oncolumnchanged" useclientlayout="false" onrowposchanged="ds_contract_onrowposchanged">
        <ColumnInfo>
          <Column id="contractCd" size="256" type="STRING"/>
          <Column id="contractName" size="256" type="STRING"/>
          <Column id="contractGb" size="256" type="STRING"/>
          <Column id="ccCd" size="256" type="STRING"/>
          <Column id="custCd" size="256" type="STRING"/>
          <Column id="sapCustCd" size="256" type="STRING"/>
          <Column id="custNm" size="256" type="STRING"/>
          <Column id="lentAssetYn" size="256" type="STRING"/>
          <Column id="usufructYn" size="256" type="STRING"/>
          <Column id="orderYn" size="256" type="STRING"/>
          <Column id="smallAssetYn" size="256" type="STRING"/>
          <Column id="startDate" size="256" type="STRING"/>
          <Column id="endDate" size="256" type="STRING"/>
          <Column id="contractPeriod" type="INT" size="256"/>
          <Column id="disRate" type="STRING" size="256"/>
          <Column id="rghtUse" size="256" type="STRING"/>
          <Column id="rghtUsePeriod" size="256" type="INT"/>
          <Column id="ncPeriod" size="256" type="INT"/>
          <Column id="roPeriod" size="256" type="INT"/>
          <Column id="lsPeriod" size="256" type="INT"/>
          <Column id="leaseGb" size="256" type="STRING"/>
          <Column id="leaseAmt" size="256" type="INT"/>
          <Column id="leaseGb2" type="STRING" size="256"/>
          <Column id="leaseAmt2" type="INT" size="256"/>
          <Column id="dtAmt" size="256" type="INT"/>
          <Column id="dtRealAmt" size="256" type="INT"/>
          <Column id="epToAmt" size="256" type="INT"/>
          <Column id="recovExpAmt" size="256" type="INT"/>
          <Column id="recovDebAmt" size="256" type="INT"/>
          <Column id="useRghtAssetAmt" size="256" type="INT"/>
          <Column id="leaseDebAmt" size="256" type="INT"/>
          <Column id="leaseDebRealBal" type="INT" size="256"/>
          <Column id="bfCntrtCd" size="256" type="STRING"/>
          <Column id="cntrtCategory" size="256" type="STRING"/>
          <Column id="callVal" size="256" type="STRING"/>
          <Column id="scObYn" size="256" type="STRING"/>
          <Column id="scObAmt" size="256" type="INT"/>
          <Column id="scObPdS" size="256" type="STRING"/>
          <Column id="scObPdE" size="256" type="STRING"/>
          <Column id="scPvYn" size="256" type="STRING"/>
          <Column id="scPvAmt" size="256" type="INT"/>
          <Column id="scPvPdS" size="256" type="STRING"/>
          <Column id="scPvPdE" size="256" type="STRING"/>
          <Column id="scInYn" size="256" type="STRING"/>
          <Column id="scInAmt" size="256" type="INT"/>
          <Column id="scInPdS" size="256" type="STRING"/>
          <Column id="scInPdE" size="256" type="STRING"/>
          <Column id="CUSER" size="256" type="STRING"/>
          <Column id="CDATE" size="256" type="STRING"/>
          <Column id="UUSER" size="256" type="STRING"/>
          <Column id="UDATE" size="256" type="STRING"/>
          <Column id="endYn" size="256" type="STRING"/>
          <Column id="periodGb01" type="STRING" size="256"/>
          <Column id="periodGb02" type="STRING" size="256"/>
          <Column id="periodGb03" type="STRING" size="256"/>
          <Column id="period01" type="STRING" size="256"/>
          <Column id="period02" type="STRING" size="256"/>
          <Column id="period03" type="STRING" size="256"/>
          <Column id="leYn" type="STRING" size="256"/>
          <Column id="fdYn" size="256" type="STRING"/>
          <Column id="fdAmt" size="256" type="INT"/>
          <Column id="vaYn" size="256" type="STRING"/>
          <Column id="vaAmt" size="256" type="INT"/>
          <Column id="gtMinY" size="256" type="STRING"/>
          <Column id="gtMinN" size="256" type="STRING"/>
          <Column id="gtMinAmt" size="256" type="INT"/>
          <Column id="lwBuyYn" size="256" type="STRING"/>
          <Column id="lwBuyAmt" size="256" type="INT"/>
          <Column id="gvYn" size="256" type="STRING"/>
          <Column id="gvAmt" size="256" type="INT"/>
          <Column id="avgRate" type="STRING" size="256"/>
          <Column id="contractStats" type="STRING" size="256"/>
          <Column id="wrtDtm" type="STRING" size="256"/>
          <Column id="wrtId" type="STRING" size="256"/>
          <Column id="wrtKostl" type="STRING" size="256"/>
          <Column id="signInstanceId" type="INT" size="256"/>
          <Column id="elctnSignId" type="STRING" size="256"/>
          <Column id="signProgressStatus" type="STRING" size="256"/>
          <Column id="contractProgressNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_contractGb">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">N</Col>
            <Col id="CODE_NAME">사용</Col>
          </Row>
          <Row>
            <Col id="CODE">Y</Col>
            <Col id="CODE_NAME">종료</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_extYn">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="CODE_NAME">신규</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="CODE_NAME">연장</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_rateSearch" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="termIntRate" type="STRING" size="256"/>
          <Column id="intRate" type="STRING" size="256"/>
          <Column id="period" type="STRING" size="256"/>
          <Column id="intYm" type="STRING" size="256"/>
          <Column id="callVal" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_contract_temp" oncolumnchanged="ds_contract_oncolumnchanged" useclientlayout="false" onrowposchanged="ds_contract_onrowposchanged">
        <ColumnInfo>
          <Column id="contractCd" size="256" type="STRING"/>
          <Column id="contractName" size="256" type="STRING"/>
          <Column id="contractGb" size="256" type="STRING"/>
          <Column id="ccCd" size="256" type="STRING"/>
          <Column id="custCd" size="256" type="STRING"/>
          <Column id="sapCustCd" size="256" type="STRING"/>
          <Column id="custNm" size="256" type="STRING"/>
          <Column id="lentAssetYn" size="256" type="STRING"/>
          <Column id="usufructYn" size="256" type="STRING"/>
          <Column id="orderYn" size="256" type="STRING"/>
          <Column id="smallAssetYn" size="256" type="STRING"/>
          <Column id="startDate" size="256" type="STRING"/>
          <Column id="endDate" size="256" type="STRING"/>
          <Column id="contractPeriod" type="INT" size="256"/>
          <Column id="disRate" type="STRING" size="256"/>
          <Column id="rghtUse" size="256" type="STRING"/>
          <Column id="rghtUsePeriod" size="256" type="INT"/>
          <Column id="ncPeriod" size="256" type="INT"/>
          <Column id="roPeriod" size="256" type="INT"/>
          <Column id="lsPeriod" size="256" type="INT"/>
          <Column id="leaseGb" size="256" type="STRING"/>
          <Column id="leaseAmt" size="256" type="INT"/>
          <Column id="leaseGb2" type="STRING" size="256"/>
          <Column id="leaseAmt2" type="INT" size="256"/>
          <Column id="dtAmt" size="256" type="INT"/>
          <Column id="dtRealAmt" size="256" type="INT"/>
          <Column id="epToAmt" size="256" type="INT"/>
          <Column id="recovExpAmt" size="256" type="INT"/>
          <Column id="recovDebAmt" size="256" type="INT"/>
          <Column id="useRghtAssetAmt" size="256" type="INT"/>
          <Column id="leaseDebAmt" size="256" type="INT"/>
          <Column id="leaseDebRealBal" type="INT" size="256"/>
          <Column id="bfCntrtCd" size="256" type="STRING"/>
          <Column id="cntrtCategory" size="256" type="STRING"/>
          <Column id="callVal" size="256" type="STRING"/>
          <Column id="scObYn" size="256" type="STRING"/>
          <Column id="scObAmt" size="256" type="INT"/>
          <Column id="scObPdS" size="256" type="STRING"/>
          <Column id="scObPdE" size="256" type="STRING"/>
          <Column id="scPvYn" size="256" type="STRING"/>
          <Column id="scPvAmt" size="256" type="INT"/>
          <Column id="scPvPdS" size="256" type="STRING"/>
          <Column id="scPvPdE" size="256" type="STRING"/>
          <Column id="scInYn" size="256" type="STRING"/>
          <Column id="scInAmt" size="256" type="INT"/>
          <Column id="scInPdS" size="256" type="STRING"/>
          <Column id="scInPdE" size="256" type="STRING"/>
          <Column id="CUSER" size="256" type="STRING"/>
          <Column id="CDATE" size="256" type="STRING"/>
          <Column id="UUSER" size="256" type="STRING"/>
          <Column id="UDATE" size="256" type="STRING"/>
          <Column id="endYn" size="256" type="STRING"/>
          <Column id="periodGb01" type="STRING" size="256"/>
          <Column id="periodGb02" type="STRING" size="256"/>
          <Column id="periodGb03" type="STRING" size="256"/>
          <Column id="period01" type="STRING" size="256"/>
          <Column id="period02" type="STRING" size="256"/>
          <Column id="period03" type="STRING" size="256"/>
          <Column id="leYn" type="STRING" size="256"/>
          <Column id="fdYn" size="256" type="STRING"/>
          <Column id="fdAmt" size="256" type="INT"/>
          <Column id="vaYn" size="256" type="STRING"/>
          <Column id="vaAmt" size="256" type="INT"/>
          <Column id="gtMinY" size="256" type="STRING"/>
          <Column id="gtMinN" size="256" type="STRING"/>
          <Column id="gtMinAmt" size="256" type="INT"/>
          <Column id="lwBuyYn" size="256" type="STRING"/>
          <Column id="lwBuyAmt" size="256" type="INT"/>
          <Column id="gvYn" size="256" type="STRING"/>
          <Column id="gvAmt" size="256" type="INT"/>
          <Column id="avgRate" type="STRING" size="256"/>
          <Column id="contractStats" type="STRING" size="256"/>
          <Column id="wrtDtm" type="STRING" size="256"/>
          <Column id="wrtId" type="STRING" size="256"/>
          <Column id="wrtKostl" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : 계약관리
  파 일 명 : ContractMgmt.xfdl
  기    능 : Design 및 Script Template 

    수정일     수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2018.09.15   김호석   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_noSapColumn = new Array("custnm", "custtype", "custgubun", "currencyCd", "arPayPossYn");
var fv_sToday = gfn_today();
var fv_mFirstDay = gfn_getFirstDate();
var TEMP_AMT=0;
var TEMP_AMT2=0;
var TEMP_AMT3=0;
var TEMP_AMT4=0;
var old_startDate = "";
var old_endDate = "";
var fv_attachList;  //상신 첨부 파일 목록 (json)
/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
 	ds_search.addRow();
 	ds_rateSearch.addRow();
 	ds_search.setColumn(0, "useYn", "Y");
 	
 	//CustSearchComponent00.isReadonly(false);
 	
 	//SCCombo.bind(this, "ComCode", "cbo_s_custGrpCd", null, {groupCode:"CUST_GRP_CD", useYn:"Y", defVal:"firstrow"}, "fn_custGrpCdTriggerEvent", SCCombo.ALL); 
 	//cal_startDate.fn_initMonthCal(this, fv_mFirstDay, null, ds_search, "startDate","Y");
	//cal_endDate.fn_initMonthCal(this, fv_sToday,  null, ds_search, "endDate","Y");
	cal_startDate.fn_initMonthCal(this, null, null, ds_search, "startDate","Y");
	cal_endDate.fn_initMonthCal(this, null,  null, ds_search, "endDate","Y");
 	SCCombo.bind(this, "ComCode", "cbo_s_contractStats", null, {groupCode:"CONTRACT_STATS", useYn:"Y", defVal:""}, "fn_custGrpCdTriggerEvent", SCCombo.ALL); 
 	
	rdo_END_YN.value = "N"; //종료여부
	cal_CONTRACT_SDATE.fn_initMonthCal(this, null, null, ds_contract, "startDate","Y");
	cal_CONTRACT_EDATE.fn_initMonthCal(this, null,  null, ds_contract, "endDate","Y");
	
	cal_SC_OB_PD_S.fn_initMonthCal(this, null, null, ds_contract, "scObPdS");
	cal_SC_OB_PD_E.fn_initMonthCal(this, null,  null, ds_contract, "scObPdE");
	cal_SC_PV_PD_S.fn_initMonthCal(this, null, null, ds_contract, "scPvPdS");
	cal_SC_PV_PD_E.fn_initMonthCal(this, null,  null, ds_contract, "scPvPdE");
	cal_SC_IN_PD_S.fn_initMonthCal(this, null, null, ds_contract, "scInPdS");
	cal_SC_IN_PD_E.fn_initMonthCal(this, null,  null, ds_contract, "scInPdE");
		
	ed_contractName.enable = false;
	cbo_CONTRACT_GB.enable = false;
	CustSearchComponent00.enable = false;
	btn_ccCdDtl.enable = false;
	ed_DT_AMT.enable = false;
	ed_DT_REAL_AMT.enable = false;
	ed_EP_TO_AMT.enable = false;
	ed_RECOV_EXP_AMT.enable = false;
	ed_RECOV_DEB_AMT.enable = false;
	
	ed_PERIOD01.enable =false;
	ed_PERIOD02.enable =false;
	ed_PERIOD03.enable =false;
		
	ed_FD_AMT.enable =false;
	ed_VA_AMT.enable =false;
	ed_GT_MIN_AMT.enable =false;
	ed_LW_BUY_AMT.enable =false;
	ed_GV_AMT.enable =false;
		
	ed_SC_OB_AMT.enable =false;
	ed_SC_PV_AMT.enable =false;
	ed_SC_IN_AMT.enable =false;	
	
	cal_SC_OB_PD_S.enable =false;
	cal_SC_OB_PD_E.enable =false;
	cal_SC_PV_PD_S.enable =false;
	cal_SC_PV_PD_E.enable =false;
	cal_SC_IN_PD_S.enable =false;
	cal_SC_IN_PD_E.enable =false;
	
	cbo_cntrtCategory.readonly = true;
	cbo_cntrtCategory.enable = false;	
	btn_extend.enable = false;
 		
 	SCCombo.bind(this, "ComCode", "cbo_CONTRACT_GB", ds_contractGb, {groupCode:"CONTRACT_GB", useYn:"Y"}, SCCombo.form);	
 	SCCombo.bind(this, "ComCode", "cbo_cntrtCategory", ds_extYn, {groupCode:"CONTRACT_CATEGORY", useYn:"Y"}, SCCombo.form);	
 	SCPopup.bind(this, "CcCode",  "edt_ccNm", 	"btn_ccCdDtl", 		null, {}, {after:"fn_cccdAfter"}); 	//CC코드팝업(입력)	
 	
 	//초기화
	ds_contract.clearData();
 	
	//ed_contractName.setFocus();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{	
	// v_ds_check 미사용시 변경사항 체크(입력 프로그램일때 변경되는 Dataset 전체 기술)
	if (gfn_dsIsUpdated(ds_contract) == true) 
	{
		// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
        if (!gfn_confirm("confirm.before.movepage")) return false;
    }
    
	// 조회프로그램에도 Return true; 기술해 주세요!
	return true;
}


/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{	
	//초기화
	//ds_contract.clearData();
	// v_ds_check 미사용시 변경사항 체크
	
	if (gfn_dsIsUpdated(ds_contract) == true) 
	{
		var retValue = gfn_confirm("confirm.before.search");	// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
		if (retValue == false) return;
	}
	

	// 조회시 Validation Check
	//if (gfn_validCheck(ds_search, ds_searchValid, true) == false) return;
	/*
	if (gfn_isNull(UpjangSearchComponent00.getUpjangCode())) {
	
		if (gfn_isNull(ds_search.getColumn(ds_search.rowposition, "contractNm")) &&
			gfn_isNull(ds_search.getColumn(ds_search.rowposition, "bsnNo")))
		{
			gfn_alert("거래처명/사업자번호중 하나는 반드시 입력하셔야 합니다.");
			return;
		}
		
		ds_search.setColumn(ds_search.rowposition, "upjang", "");
	}
	else {
		ds_search.setColumn(ds_search.rowposition, "upjang", UpjangSearchComponent00.getUpjangCode());
	}
	*/
	ds_search.setColumn(ds_search.rowposition, "custCd", CustSearchComponent01.getCustCode());

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_list);

    var strSvcID    = "search";
    var strURL      = "sc/scz/contractMgmt/selectList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_contract=ds_contract";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}



/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{	
	//ds_contract.setColumn(0, "endYn", "N");  //종료여부
	//초기화
	//ds_contract.clearData();
	var nRow = ds_contract.addRow();	
	
	//cbo_cntrtCategory.value = "1"; //신규 --등록시 변경 불가
	ds_contract.setColumn(ds_contract.rowposition,"cntrtCategory", "1");  //신규 --등록시 변경 불가
	ds_contract.setColumn(ds_contract.rowposition,"contractStats", "10");  //접수상태 --등록시 변경 불가	
	
	ed_contractName.enable = true;
	cbo_CONTRACT_GB.enable = true;
	CustSearchComponent00.enable = true;
	btn_ccCdDtl.enable = true;
	ed_DT_AMT.enable = true;
	ed_DT_REAL_AMT.enable = true;
	ed_EP_TO_AMT.enable = true;
	//복구의무는 입력 못하게 처리(회계팀 황석현과장 요청) -> 이유:부채 증가...
	//ed_RECOV_EXP_AMT.enable = true;
	//ed_RECOV_DEB_AMT.enable = true;
	
 	//rdo_extYn.value = "1"; //계약분류 (신규/연장) --등록시 변경 불가
 	//rdo_extYn.readonly = true;
 	//rdo_extYn.enable = false;
 	rdo_END_YN.value = "N"; //종료여부 --등록시 변경 불가
 	rdo_END_YN.readonly = true;
 	rdo_END_YN.enable = false;
	
	ed_PERIOD01.enable =false;
	ed_PERIOD02.enable =false;
	ed_PERIOD03.enable =false;	
	
	ed_FD_AMT.enable =false;
	ed_VA_AMT.enable =false;
	ed_GT_MIN_AMT.enable =false;
	ed_LW_BUY_AMT.enable =false;
	ed_GV_AMT.enable =false;
	
	ed_SC_OB_AMT.enable =true;
	ed_SC_PV_AMT.enable =true;
	ed_SC_IN_AMT.enable =true;	
	
	cal_SC_OB_PD_S.enable =true;
	cal_SC_OB_PD_E.enable =true;
	cal_SC_PV_PD_S.enable =true;
	cal_SC_PV_PD_E.enable =true;
	cal_SC_IN_PD_S.enable =true;
	cal_SC_IN_PD_E.enable =true;
	
	btn_extend.enable = false;
 		
 	//SCCombo.bind(this, "ComCode", "cbo_CONTRACT_GB", ds_contractGb, {groupCode:"contractGb", useYn:"Y"}, SCCombo.form);	
 	//SCPopup.bind(this, "CcCode",  "edt_ccNm", 	"btn_ccCdDtl", 		null, {}, {after:"fn_cccdAfter"}); 	//CC코드팝업(입력)	
 	
	//UpjangSearchComponent00.isApplyAuth = false;
	//UpjangSearchComponent00.setUpjangCode("");
	
	//alert(ds_contract.getColumn(ds_contract.rowposition,"cntrtCategory"));
	
	//테스트 설정
	//ed_DIS_RATE.value = "5";
	//ed_AVG_RATE.value = "5";
	//ed_LS_PERIOD.value = "13";
	//ds_contract.setColumn(ds_contract.rowposition,"startDate", "20180901");
	//ds_contract.setColumn(ds_contract.rowposition,"endDate", "20210831");
	//ed_contractPrd.value = "36";
	
	//ed_contractName.setFocus();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{
	var nRow = ds_contract.rowposition;
	
	if(ds_contract.rowposition == -1) 
	{
		gfn_alert("msg.err.grid.noselect", "삭제할 row");	// 선택된 항목이 없습니다.
		return;
	}
	
	if (ds_contract.getColumn(nRow,"contractStats") == "10") {
	
		var rtVal = gfn_confirm("confirm.before.delete");	// 선택된 자료를 삭제 하시겠습니까?
		if (rtVal == true) 
		{	
			ds_contract.deleteRow(nRow);
		}
	
	} else {
		
		alert("전자결재 상신 이후로는 삭제 불가합니다.");
		return;
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
 	// v_ds_check 미사용시 변경사항 체크
 	if (gfn_dsIsUpdated(ds_contract) == false) 
 	{
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}
	
	// 저장시 Validation Check	
	//if (gfn_validCheck(grd_list, ds_contractValid) == false)	return;
	
	/*
	if (gfn_isNull(ds_contract.getColumn(ds_contract.rowposition, "contractName")))
	{
		gfn_alert("계약명은 필수 입력항목입니다.");
		ed_contractName.setFocus();
		return;
	}
	
	if (gfn_isNull(ds_contract.getColumn(ds_contract.rowposition, "contractGb")))
	{
		gfn_alert("계약구분은 필수 입력항목입니다.");
		return;
	}
	*/
	
	//상신 또는 결재완료된건은 수정불가	
    if (!(ds_contract.getColumn(ds_contract.rowposition, "contractStats") == "10")) {    
		gfn_alert("결재상신 전까지만 수정 가능합니다.");
		return;    
	} else {
		if (ds_contract.getColumn(ds_contract.rowposition, "contractStats") == "50") {    			
			if (ds_contract.getColumn(ds_contract.rowposition, "signProgressStatus") == "REJECT") {    
				//gfn_alert("결재 반려되었습니다. 확인 후 재상신해주세요.");						
			} else if (ds_contract.getColumn(ds_contract.rowposition, "signProgressStatus") == "CANCEL") {    
				//gfn_alert("결재 취소되었습니다. 재상신 가능합니다.");			
			} else {
				gfn_alert("결재 반려/취소된 경우만 수정 가능합니다.");			
				return; 
			}
		}
    }	
	
	if (gfn_isNull(ds_contract.getColumn(ds_contract.rowposition, "custCd")))
	{
		gfn_alert("거래처는 필수 입력항목입니다.");
		return;
	}
	if (gfn_isNull(ds_contract.getColumn(ds_contract.rowposition, "ccCd")))
	{
		gfn_alert("귀속부서는 필수 입력항목입니다.");
		return;
	}	
	if (gfn_isNull(ds_contract.getColumn(ds_contract.rowposition, "lentAssetYn")))
	{
		gfn_alert("임차자산특성은 필수 입력항목입니다.");
		return;
	}	
	if (gfn_isNull(ds_contract.getColumn(ds_contract.rowposition, "startDate")) || gfn_isNull(ds_contract.getColumn(ds_contract.rowposition, "endDate")))
	{
		gfn_alert("계약기간은 필수 입력항목입니다.");
		return;
	}		
	if (gfn_isNull(ds_contract.getColumn(ds_contract.rowposition, "smallAssetYn")))
	{
		gfn_alert("소액자산여부은 필수 입력항목입니다.");
		return;
	}	
	if (gfn_isNull(ds_contract.getColumn(ds_contract.rowposition, "disRate")))
	{
		gfn_alert("적용할인율은 필수 입력항목입니다.");
		return;
	}
	if (gfn_isNull(ds_contract.getColumn(ds_contract.rowposition, "avgRate")))
	{
		gfn_alert("가중평균이자율은 필수 입력항목입니다.");
		return;
	}
	
	//보증금 현할차 
	if (!(gfn_isNull(ds_contract.getColumn(ds_contract.rowposition, "dtAmt")))) {
		if (gfn_isNull(ds_contract.getColumn(ds_contract.rowposition, "dtRealAmt")))
		{
			gfn_alert("보증금 현할차금액이 누락되었습니다./n 보증금 금액을 확인해주세요");
			return;
		}
	}
	
	//리스부채 현할차, 사용권자산	
	if (!(gfn_isNull(ds_contract.getColumn(ds_contract.rowposition, "leaseDebAmt")))) {
		if (gfn_isNull(ds_contract.getColumn(ds_contract.rowposition, "leaseDebRealBal")))
		{
			gfn_alert("리스부채 현할차금액이 누락되었습니다.");
			return;
		}
		if (gfn_isNull(ds_contract.getColumn(ds_contract.rowposition, "leaseDebRealBal")))
		{
			gfn_alert("사용권 자산금액이 누락되었습니다.");
			return;
		}
	}
	
	//자산, 부채 계산 
	fn_leaseCal();
	
	
	//종료가 가능한 상태 확인 필요
	//if (ds_contract.getColumn(nRow,"contractStats") == "1") {
	
	//종료여부가 종료인 경우 확인 후 저장 
	if (ds_contract.getColumn(ds_contract.rowposition, "endYn") == "Y") {
		var rtVal = gfn_confirm("계약을 종료로 저장하시겠습니까?");	// 선택된 자료를 삭제 하시겠습니까?
		if (rtVal == false) {
			return;
		}
	}
	
	fn_doSave();
	
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
	
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {
		// 코드분류 조회
        case "search" :
            //trace(ds_contract.saveXML());
            ed_contractName.enable = true;
            cbo_CONTRACT_GB.enable = true;
			CustSearchComponent00.enable = true;
			btn_ccCdDtl.enable = true;
			ed_DT_AMT.enable = true;
			ed_DT_REAL_AMT.enable = true;
			ed_EP_TO_AMT.enable = true;
			//복구의무는 입력 못하게 처리(회계팀 황석현과장 요청) -> 이유:부채 증가...
			//ed_RECOV_EXP_AMT.enable = true;
			//ed_RECOV_DEB_AMT.enable = true;
			
			btn_extend.enable = true;
			//rdo_extYn.value = "1"; //계약분류 (신규/연장) --등록시 변경 불가
			//rdo_extYn.readonly = false;
			//rdo_extYn.enable = true;
			//rdo_END_YN.value = "N"; //종료여부 --등록시 변경 불가
			rdo_END_YN.readonly = false;
			rdo_END_YN.enable = true;
			
            
            break;
//        case "searchCustInfo" :
//			break;
//		case "searchCustCheckList" :
//			break;
		// 이자율 조회
        case "rateSearch" :
			
			//alert("RATE : " + ds_rateSearch.getColumn(0,"intRate"));
			//alert("TERM RATE : " + ds_rateSearch.getColumn(0,"termIntRate"));
			if (gfn_isNull(ds_rateSearch.getColumn(0,"intRate"))) {
				alert("전월(계약시작일 기준) 이자율이 미등록되어 계약등록이 불가합니다.(월 결산 이후 가능)");
				ds_contract.setColumn(ds_contract.rowposition,"disRate","");
				ds_contract.setColumn(ds_contract.rowposition,"avgRate","");			
			} else {
				ds_contract.setColumn(ds_contract.rowposition,"disRate",ds_rateSearch.getColumn(0,"termIntRate"));
				ds_contract.setColumn(ds_contract.rowposition,"avgRate",ds_rateSearch.getColumn(0,"intRate"));
			}			
        	break;
        
        // 전자결재정보 저장
        case "saveSign" :
            gfn_alert("msg.save.sign.success"); // 저장 되었습니다.
			fn_search();
            break;   
        
        // 저장
        case "save" :
			gfn_alert("msg.save.success");	// 저장 되었습니다.
			fn_search();
            break;    
    }
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/**
 * @class 자료를 저장한다.
 * @param p - Event 정보
 * @return 
 */
function fn_doSave()
{
	//var requestSapYn = "N";
	
// 	if (ds_contract.getColumn(ds_contract.rowposition, "requestSapYn") == "Y")
// 	{
// 		for (var i=0,len=ds_contract.getColCount(); i<len; i++)
// 		{
// 			var colId = ds_contract.getColID(i);
// 			
// 			for (var j=0,len1=fv_noSapColumn.length; j<len1; j++)
// 			{
// 				if (colId != fv_noSapColumn[j])
// 				{
// 					if (ds_contract.getColumn(ds_contract.rowposition, colId) != ds_contract.getOrgColumn(ds_contract.rowposition, colId))
// 					{
// 						requestSapYn = "Y";
// 					}
// 				}
// 			}
// 		}
// 	}
	
	if (ds_contract.getColumn(ds_contract.rowposition,"contractStats") == "50") {
		
		alert("결재 진행중인 계약입니다. 결재 완료 후 수정/종료 가능합니다.");
		return;
	
	} else {

		var strSvcID    = "save";
		var strURL      = "sc/scz/contractMgmt/saveList.xdo";
		var strInDs     = "ds_contract=ds_contract:U ";
		var strOutDs    = "";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
		
	}
}

// /**
//  * @class 거래처 구분(검색)에 대한 Trigger Event
//  * @param p - Event 정보
//  * @return 
//  */
function fn_custGrpCdTriggerEvent(p)
{
	if (p.oid == "cbo_s_custGrpCd")
	{
		fn_bindCustType(p.object.value);
	}
// 	else if (p.oid == "cbo_custGrpCd")
// 	{
// 		fn_tapControl(p.object.value);
// 	}
	
	
	//fn_custGrpCdTriggerEvent
}

/**
 * @class 거래처 구분(검색)이 변경될 때마다 거래처 유형을 다시 설정한다.
 * @param val - 거래처 구분 코드
 * @return 
 */
function fn_bindCustType(val)
{
	switch (val)
	{
		case "1000" : //일반(국내)
			SCCombo.bind(this, "ComCode", "cbo_s_custtype", null, {groupCode:"Z01", useYn:"Y", set1:"Y"}, SCCombo.ALL);
			break;
		case "5000" : //일반(해외)
			SCCombo.bind(this, "ComCode", "cbo_s_custtype", null, {groupCode:"Z01", useYn:"Y", set2:"Y"}, SCCombo.ALL);
			break;
		case "6000" : //개인
			SCCombo.bind(this, "ComCode", "cbo_s_custtype", null, {groupCode:"Z01", useYn:"Y", set3:"Y"}, SCCombo.ALL);
			break;
		default : //전체
			SCCombo.bind(this, "ComCode", "cbo_s_custtype", null, {groupCode:"Z01", useYn:"Y"}, SCCombo.ALL);
			break;
	}
}

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/**
 * @class 거래처 구분(검색)의 변경될 때에 대한 이벤트
 * @param obj - Event Object
 * @param e - Event 발생정보
 * @return 
 */
function cbo_s_custGrpCd_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	fn_bindCustType(obj.value);
}

/**
 * @class 그리드의 Resize시에 대한 이벤트
 * @param obj - Event Object
 * @param e - Event 발생정보
 * @return 
 */
function div_corp_grid_incharge_onsize(obj:Grid, e:SizeEventInfo)
{
	fn_gridResize(obj, e);
}

/**
 * @class ds_contract의 행의 변경되기 전에 이벤트
 * @param obj - Event Object
 * @param e - Event 발생정보
 * @return 
 */
function ds_contract_canrowposchange(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	if (gfn_dsIsUpdated(ds_contract) == true) 
	{
		// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
        if (!gfn_confirm("변경된 데이터가 있습니다.\n다른 계약정보를 조회하시겠습니까?"))
        {
			return false;
		}
    }
    
    //변경된 정보를 이전정보로 Rollback한다.
    for (var i=0,len=ds_contract.getColCount(); i<len; i++)
    {
		var colId = ds_contract.getColID(i);
		
		if (ds_contract.getColumn(ds_contract.rowposition, colId) != ds_contract.getOrgColumn(ds_contract.rowposition, colId))
		{
			ds_contract.setColumn(ds_contract.rowposition, colId, ds_contract.getOrgColumn(ds_contract.rowposition, colId));
		}
    }
    
    return true;
}

/**
 * @class 그리드의 Resize시에 대한 이벤트
 * @param obj - Event Object
 * @param e - Event 발생정보
 * @return 
 */
function div_frgn_grid_incharge_onsize(obj:Grid, e:SizeEventInfo)
{
	fn_gridResize(obj, e);
}


//입력 정보에 따라 자동 계산 처리, 입력항목 활성화/비활성화
//계약정보 규칙적용, 이자율 자동조회, 일부금액 자동계산
function ds_contract_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	
	//임차자산특성이 N인 경우 사용수익권, 사용지시권 비활성화
	if (ds_contract.getColumn(e.row, "lentAssetYn") == "N") {
		rdo_USUFRUCT_YN.value = "";
		rdo_USUFRUCT_YN.readonly = true;
		rdo_ORDER_YN.value = "";
		rdo_ORDER_YN.readonly = true;		
	}
	//임차자산특성이 Y인 경우 사용수익권, 사용지시권 활성화
	if (ds_contract.getColumn(e.row, "lentAssetYn") == "Y") {		
		rdo_USUFRUCT_YN.readonly = false;		
		rdo_ORDER_YN.readonly = false;		
	}
	
	//계약기간과 사전통보기간 모두 입력했을 경우 해지불능기간 표시
	if ((e.columnid == "period03") || (e.columnid == "contractPeriod")) {
		if ((!gfn_isNull(ed_PERIOD03.value)) && (!gfn_isNull(ed_contractPrd.value))) {
			if (ed_PERIOD03.value > ed_contractPrd.value) {
				ed_NC_PERIOD.value = ed_PERIOD03.value;
			} else {
				ed_NC_PERIOD.value = ed_contractPrd.value;
			}
		} else {
		/*
			if (gfn_isNull(ed_PERIOD03.value)) {
				ed_NC_PERIOD.value = ed_contractPrd.value;		
			} else {
				if (gfn_isNull(ed_contractPrd.value)) {
					ed_NC_PERIOD.value = ed_PERIOD03.value;		
				}
			}
		*/
		}
		
		//리스기간
		ed_LS_PERIOD.value = ed_contractPrd.value + ed_RO_PERIOD.value;
		
	}
	
	/*
	if (e.columnid = "period01") {
		alert(e.newvalue);
		//ed_RO_PERIOD.value = e.newvalue;	
	}	
	
	if (e.columnid = "period02") {
		ed_RO_PERIOD.value = -e.newvalue;	
	}
	*/
	
	//리스기간 = 해지불능기간 + 선택권기간
	if ((e.columnid == "ncPeriod") || (e.columnid == "roPeriod")) {
		ed_LS_PERIOD.value = ed_NC_PERIOD.value + ed_RO_PERIOD.value;
	}
	
	//계약 시작일과  종료일 모두 입력했을 경우 계약기간 표시
	if ((e.columnid == "startDate") || (e.columnid == "endDate")) {	
		
		//alert(cal_CONTRACT_EDATE.fn_getValue());
		
		if (e.columnid == "startDate") {
			if ((!gfn_isNull(e.newvalue)) && (!gfn_isNull(cal_CONTRACT_EDATE.fn_getValue()))) {
				ed_contractPrd.value = gfn_getDiffMonth(e.newvalue, cal_CONTRACT_EDATE.fn_getValue())+1;
			}			
			//ds_rateSearch.setColumn(ds_rateSearch.rowposition, "intYm", e.newvalue.substr(0,6));		
			ds_rateSearch.setColumn(ds_rateSearch.rowposition, "intYm", e.newvalue);		
			ds_rateSearch.setColumn(ds_rateSearch.rowposition, "period", gfn_getDiffMonth(e.newvalue, cal_CONTRACT_EDATE.fn_getValue())+1);									
			
			//담보가치, 게약기간이 있는 경우 이자율 조회
			if (!gfn_isNull(rdo_callVal.value)) {	
				//alert(gfn_getDiffMonth(e.newvalue, cal_CONTRACT_EDATE.fn_getValue())+1);
				ds_rateSearch.setColumn(ds_rateSearch.rowposition, "callVal", rdo_callVal.value);					
				//12개월이상만 이자율 가져옴					
				if ((gfn_getDiffMonth(e.newvalue, cal_CONTRACT_EDATE.fn_getValue())+1) > 12) {
					fn_rateSearch();		
					//보증금 현할차 계산					
					TEMP_AMT = 1;
					var diff_day = gfn_getDiffDay(e.newvalue,ds_contract.getColumn(e.row,"endDate"));
					//alert(diff_day);
					//일수로 계산
					for (var j=0; j<diff_day; j++)
					{
						//M48/(1+I31/12)^L30
						//TEMP_AMT = TEMP_AMT * (1+(ed_AVG_RATE.value/12/100));
						TEMP_AMT = TEMP_AMT * (1+(ds_contract.getColumn(e.row,"avgRate")/365/100));
					}
					TEMP_AMT = ds_contract.getColumn(e.row,"dtAmt") / TEMP_AMT;			
					//ed_DT_REAL_AMT.value = ds_contract.getColumn(e.row,"dtAmt") - TEMP_AMT;
					ds_contract.setColumn(e.row,"dtRealAmt", ds_contract.getColumn(e.row,"dtAmt") - TEMP_AMT);
				
				}
			}	
		} else {
			if ((!gfn_isNull(cal_CONTRACT_SDATE.fn_getValue())) && (!gfn_isNull(e.newvalue))) {
				ed_contractPrd.value = gfn_getDiffMonth(cal_CONTRACT_SDATE.fn_getValue(), e.newvalue)+1;
			}
			//ds_rateSearch.setColumn(ds_rateSearch.rowposition, "intYm", cal_CONTRACT_SDATE.fn_getValue().substr(0,6));			
			ds_rateSearch.setColumn(ds_rateSearch.rowposition, "intYm", cal_CONTRACT_SDATE.fn_getValue());			
			ds_rateSearch.setColumn(ds_rateSearch.rowposition, "period", gfn_getDiffMonth(cal_CONTRACT_SDATE.fn_getValue(), e.newvalue)+1);								
			
			//담보가치, 게약기간이 있는 경우 이자율 조회
			if (!gfn_isNull(rdo_callVal.value)) {	
				//alert(gfn_getDiffMonth(cal_CONTRACT_SDATE.fn_getValue(), e.newvalue)+1);
				ds_rateSearch.setColumn(gfn_getDiffMonth(cal_CONTRACT_SDATE.fn_getValue(), e.newvalue)+1);						
				//12개월이상만 이자율 가져옴
				if ((gfn_getDiffMonth(cal_CONTRACT_SDATE.fn_getValue(), e.newvalue)+1) > 12) {
					fn_rateSearch();		
					//보증금 현할차 계산
					TEMP_AMT = 1;
					var diff_day = gfn_getDiffDay(ds_contract.getColumn(e.row,"startDate"),e.newvalue);
					alert(diff_day);
					//일수로 계산
					for (var j=0; j<diff_day; j++)
					{
						//M48/(1+I31/12)^L30
						//TEMP_AMT = TEMP_AMT * (1+(ed_AVG_RATE.value/12/100));
						TEMP_AMT = TEMP_AMT * (1+(ds_contract.getColumn(e.row,"avgRate")/365/100));
					}
					TEMP_AMT = ds_contract.getColumn(e.row,"dtAmt") / TEMP_AMT;			
					alert(TEMP_AMT);
					//ed_DT_REAL_AMT.value = ds_contract.getColumn(e.row,"dtAmt") - TEMP_AMT;
					ds_contract.setColumn(e.row,"dtRealAmt", ds_contract.getColumn(e.row,"dtAmt") - TEMP_AMT);
				
				}
			}	
		}
		
		
		//해지불능기간 
		if (gfn_isNull(ed_PERIOD03.value)) {
			ed_NC_PERIOD.value = gfn_getDiffMonth(cal_CONTRACT_SDATE.fn_getValue(), e.newvalue)+1;
			//리스기간
			if (e.columnid == "startDate") {
				if (gfn_isNull(ds_contract.getColumn(ds_contract.rowposition,"roPeriod"))) { 
					ds_contract.setColumn(ds_contract.rowposition,"lsPeriod", (gfn_getDiffMonth(e.newvalue, cal_CONTRACT_EDATE.fn_getValue())+1));
				} else {
					ds_contract.setColumn(ds_contract.rowposition,"lsPeriod", (gfn_getDiffMonth(e.newvalue, cal_CONTRACT_EDATE.fn_getValue())+1) + ds_contract.getColumn(ds_contract.rowposition,"roPeriod"));
				}
			} else {
				if (gfn_isNull(ds_contract.getColumn(ds_contract.rowposition,"roPeriod"))) { 
					ds_contract.setColumn(ds_contract.rowposition,"lsPeriod", (gfn_getDiffMonth(cal_CONTRACT_SDATE.fn_getValue(), e.newvalue)+1));
				} else {
					ds_contract.setColumn(ds_contract.rowposition,"lsPeriod", (gfn_getDiffMonth(cal_CONTRACT_SDATE.fn_getValue(), e.newvalue)+1) + ds_contract.getColumn(ds_contract.rowposition,"roPeriod"));
				}
			}
			//ed_LS_PERIOD.value = (gfn_getDiffMonth(cal_CONTRACT_SDATE.fn_getValue(), e.newvalue)+1) + ed_RO_PERIOD.value;
		} else {
			if (ed_PERIOD03.value > 0) { 
				ed_NC_PERIOD.value = ed_PERIOD03.value;			
				//리스기간
				//ed_LS_PERIOD.value = ed_PERIOD03.value + ed_RO_PERIOD.value;
				if (gfn_isNull(ds_contract.getColumn(ds_contract.rowposition,"roPeriod"))) { 
					ds_contract.setColumn(ds_contract.rowposition,"lsPeriod", ds_contract.getColumn(ds_contract.rowposition,"period03"));
				} else {
					ds_contract.setColumn(ds_contract.rowposition,"lsPeriod", ds_contract.getColumn(ds_contract.rowposition,"period03") + ds_contract.getColumn(ds_contract.rowposition,"roPeriod"));
				}
				//ds_contract.setColumn(ds_contract.rowposition,"lsPeriod", ds_contract.getColumn(ds_contract.rowposition,"period03") + ds_contract.getColumn(ds_contract.rowposition,"roPeriod"));			
			} else {
				ed_NC_PERIOD.value = gfn_getDiffMonth(cal_CONTRACT_SDATE.fn_getValue(), e.newvalue)+1;		
				//리스기간
				//ed_LS_PERIOD.value = (gfn_getDiffMonth(cal_CONTRACT_SDATE.fn_getValue(), e.newvalue)+1) + ed_RO_PERIOD.value;
				//리스기간
				if (e.columnid == "startDate") {
					if (gfn_isNull(ds_contract.getColumn(ds_contract.rowposition,"roPeriod"))) { 
						ds_contract.setColumn(ds_contract.rowposition,"lsPeriod", (gfn_getDiffMonth(e.newvalue, cal_CONTRACT_EDATE.fn_getValue())+1));
					} else {
						ds_contract.setColumn(ds_contract.rowposition,"lsPeriod", (gfn_getDiffMonth(e.newvalue, cal_CONTRACT_EDATE.fn_getValue())+1) + ds_contract.getColumn(ds_contract.rowposition,"roPeriod"));
					}
				} else {
					if (gfn_isNull(ds_contract.getColumn(ds_contract.rowposition,"roPeriod"))) { 
						ds_contract.setColumn(ds_contract.rowposition,"lsPeriod", (gfn_getDiffMonth(cal_CONTRACT_SDATE.fn_getValue(), e.newvalue)+1));
					} else {
						ds_contract.setColumn(ds_contract.rowposition,"lsPeriod", (gfn_getDiffMonth(cal_CONTRACT_SDATE.fn_getValue(), e.newvalue)+1) + ds_contract.getColumn(ds_contract.rowposition,"roPeriod"));
					}
				}
			}
		}
		
		//자산 및 부채 계산
		//fn_leaseCal();	
	}	
	
	//담보가치 선택, 게약기간이 있는 경우 이자율 조회
	if (e.columnid == "callVal") {
		ds_rateSearch.setColumn(ds_rateSearch.rowposition, "callVal", e.newvalue);		
		if (!gfn_isNull(cal_CONTRACT_SDATE.fn_getValue())) {	
			if (!gfn_isNull(ed_contractPrd.value)) {	
				//ds_rateSearch.setColumn(ds_rateSearch.rowposition, "intYm", cal_CONTRACT_SDATE.fn_getValue().substr(0,6));	
				ds_rateSearch.setColumn(ds_rateSearch.rowposition, "intYm", cal_CONTRACT_SDATE.fn_getValue());	
				ds_rateSearch.setColumn(ds_rateSearch.rowposition, "period", ed_contractPrd.value);					
				//12개월이상만 이자율 가져옴
				if (ed_contractPrd.value > 12) {
					fn_rateSearch();	
				}
			}
		}
	}
	
	
	
	//계약기간-판단 START
	//periodGb01
	if (e.columnid == "periodGb01") {
	    if (e.newvalue == "Y") {
			periodGb02.value = "N";
			periodGb03.value = "N";
			ds_contract.setColumn(e.row,"period02","");
			ds_contract.setColumn(e.row,"period03","");
			ed_PERIOD01.enable ="true";
			ed_PERIOD02.enable ="false";
			ed_PERIOD03.enable ="false";
			ds_contract.setColumn(e.row,"rghtUse","10");
			/*
			if (gfn_isNull(ed_PERIOD01.value)) {
				ed_RO_PERIOD.value = 0;
			} else {
				ed_RO_PERIOD.value = ed_PERIOD01.value - 0;
			}
			ed_NC_PERIOD.value = ed_contractPrd.value;
			*/
			//선택권기간 = 연잔선택권 기간 - 종료선택권 기간
			ds_contract.setColumn(e.row,"period01","");			
			ds_contract.setColumn(e.row,"roPeriod","");	
			//리스기간
			ed_LS_PERIOD.value = ed_contractPrd.value + ed_RO_PERIOD.value;
			//ds_contract.setColumn(e.row,"lsPeriod",ds_contract.getColumn(e.row,"ncPeriod"));	
			
		} else {
			//ed_PERIOD01.value ="";
			ds_contract.setColumn(e.row,"period01","");
			ed_PERIOD01.enable ="false";
			ds_contract.setColumn(e.row,"rghtUse","");
			
			//선택권기간 = 연잔선택권 기간 - 종료선택권 기간
			//선택권기간 = 연잔선택권 기간 - 종료선택권 기간			
			ds_contract.setColumn(e.row,"roPeriod",0);
			//리스기간
			ed_LS_PERIOD.value = ed_contractPrd.value + ed_RO_PERIOD.value;
			
		}
	
		
	}
	//periodGb02
	if (e.columnid == "periodGb02") {
	    if (e.newvalue == "Y") {
			periodGb01.value = "N";
			periodGb03.value = "N";
			ds_contract.setColumn(e.row,"period01","");
			ds_contract.setColumn(e.row,"period03","");
			ed_PERIOD01.enable ="false";
			ed_PERIOD02.enable ="true";
			ed_PERIOD03.enable ="false";
			ds_contract.setColumn(e.row,"rghtUse","20");
			/*
			if (gfn_isNull(ed_PERIOD02.value)) {
				ed_RO_PERIOD.value = 0;
			} else {
				ed_RO_PERIOD.value = 0 - ed_PERIOD01.value;
			}
			ed_NC_PERIOD.value = ed_contractPrd.value;
			*/
			//선택권기간 = 연잔선택권 기간 - 종료선택권 기간
			ds_contract.setColumn(e.row,"period01","");
			ds_contract.setColumn(e.row,"roPeriod","");	
			//리스기간
			ed_LS_PERIOD.value = ed_contractPrd.value + ed_RO_PERIOD.value;
		} else {
			
			//ed_PERIOD02.value ="";
			ds_contract.setColumn(e.row,"period02","");
			ed_PERIOD02.enable ="false";
			ds_contract.setColumn(e.row,"rghtUse","");
			
			//선택권기간 = 연잔선택권 기간 - 종료선택권 기간			
			ds_contract.setColumn(e.row,"roPeriod",0);
			//리스기간
			ed_LS_PERIOD.value = ed_contractPrd.value + ed_RO_PERIOD.value;
		}
	}
	//periodGb03
	if (e.columnid == "periodGb03") {
	    if (e.newvalue == "Y") {
			periodGb01.value = "N";
			periodGb02.value = "N";
			ed_PERIOD01.enable ="false";
			ed_PERIOD02.enable ="false";
			ed_PERIOD03.enable ="true";
			ds_contract.setColumn(e.row,"rghtUse","30");
			//선택권기간 = 연잔선택권 기간 - 종료선택권 기간
			ds_contract.setColumn(e.row,"period01","");
			ds_contract.setColumn(e.row,"period02","");
			ds_contract.setColumn(e.row,"roPeriod","");	
			
			//계약기간과 사전통보기간 모두 입력했을 경우 해지불능기간 표시
			if ((!gfn_isNull(ed_PERIOD03.value)) && (!gfn_isNull(ed_contractPrd.value))) {
				//사전통보기간이 0초과인경우 사전통보기간 설정
				if (ed_PERIOD03.value > 0) {
				//if (ed_PERIOD03.value > ed_contractPrd.value) {
					ed_NC_PERIOD.value = ed_PERIOD03.value;
					//리스기간
					ed_LS_PERIOD.value = ed_PERIOD03.value + ed_RO_PERIOD.value;
					
				} else {
					ed_NC_PERIOD.value = ed_contractPrd.value;
					ed_LS_PERIOD.value = ed_contractPrd.value + ed_RO_PERIOD.value;
				}
			} else {
				ed_NC_PERIOD.value = ed_contractPrd.value;
				ed_LS_PERIOD.value = ed_contractPrd.value + ed_RO_PERIOD.value;				
			}			
			ed_RO_PERIOD.value = 0;
		} else {
			ed_PERIOD03.value ="";
			ed_PERIOD03.enable ="false";
			ds_contract.setColumn(e.row,"rghtUse","");
			if (!gfn_isNull(ed_contractPrd.value)) {
				ed_NC_PERIOD.value = ed_contractPrd.value;
				ed_LS_PERIOD.value = ed_contractPrd.value;
			} else {
				ed_NC_PERIOD.value = "";
				ed_LS_PERIOD.value = "";
			}
		}
		
	}
	//계약기간-판단 END
	
	//계약기간-판단(개월수)
	if ((e.columnid == "period01") || (e.columnid == "period02") || (e.columnid == "period03")) { 
		ds_contract.setColumn(e.row,"rghtUsePeriod",e.newvalue);
		if (e.columnid == "period01") {
			ed_RO_PERIOD.value = e.newvalue;	
			var tsum:int = ed_NC_PERIOD.value;			
			var tsum2:int = e.newvalue;		
			ds_contract.setColumn(e.row,"lsPeriod", tsum+tsum2);			
			//ed_LS_PERIOD.value = INT(ed_NC_PERIOD.value) + INT(e.newvalue);	
		}
		if (e.columnid == "period02") {
			ed_RO_PERIOD.value = -e.newvalue;	
			var tsum:int = ed_NC_PERIOD.value;			
			var tsum2:int = -e.newvalue;		
			ds_contract.setColumn(e.row,"lsPeriod", tsum+tsum2);						
			//ed_LS_PERIOD.value = INT(ed_NC_PERIOD.value) - INT(e.newvalue);	
		}		
		if (e.columnid == "period03") {
			//사전통보기간이 0초과인경우 사전통보기간 설정
			if (e.newvalue > 0) {
				ed_NC_PERIOD.value = e.newvalue;
				var tsum:int = e.newvalue;			
				var tsum2:int = ds_contract.getColumn(e.row,"roPeriod");				
				
				//리스기간
				//ed_LS_PERIOD.value = e.newvalue + ed_RO_PERIOD.value;	
				ds_contract.setColumn(e.row,"lsPeriod", tsum+tsum2);				
				
			} else {
				ds_contract.setColumn(e.row,"ncPeriod", ed_contractPrd.value);		
				ds_contract.setColumn(e.row,"lsPeriod", ed_contractPrd.value + ed_RO_PERIOD.value);						
				ds_contract.setColumn(e.row,"lsPeriod", tsum+tsum2);		
			}			
		}
	}
	
	//보증금 현재가치할인차금 금액 계산 
	//=INT(T27-T27/((1+U27/365)^(C27-B27)))
	//보증금-보증금/((1+가중평균이자율/365)^(계약종료일-계약시작일=일수)
	
	if (e.columnid == "dtAmt") {
		
		if (!gfn_isNull(ds_contract.getColumn(e.row,"avgRate"))) {
			
			TEMP_AMT = 1;
			var diff_day = gfn_getDiffDay(ds_contract.getColumn(e.row,"startDate"),ds_contract.getColumn(e.row,"endDate"));
			//alert(diff_day);
			//일수로 계산
			for (var j=0; j<diff_day; j++)
 			{
				//M48/(1+I31/12)^L30
				//TEMP_AMT = TEMP_AMT * (1+(ed_AVG_RATE.value/12/100));
				TEMP_AMT = TEMP_AMT * (1+(ds_contract.getColumn(e.row,"avgRate")/365/100));
			}
			TEMP_AMT = ds_contract.getColumn(e.row,"dtAmt") / TEMP_AMT;			
			//ed_DT_REAL_AMT.value = ds_contract.getColumn(e.row,"dtAmt") - TEMP_AMT;
			ds_contract.setColumn(e.row,"dtRealAmt", ds_contract.getColumn(e.row,"dtAmt") - TEMP_AMT);
		}
		//fn_leaseCal();
	}
	
	
	//월리스료 START
	
	//전세계약, 고정리스료, 변동리스료, 매출연동리스료
	//전세계약(월리스료 없음)
	if (e.columnid == "leYn") {
	    if (e.newvalue == "Y") {
			fdYn.value = "N";
			vaYn.value = "N";		
			gtMinY.value = "N";
			gtMinN.value = "N";
			ds_contract.setColumn(e.row,"fdAmt","");						
			ds_contract.setColumn(e.row,"vaAmt","");				
			ds_contract.setColumn(e.row,"gtMinAmt","");				
			ed_FD_AMT.enable ="false";
			ed_VA_AMT.enable ="false";
			ed_GT_MIN_AMT.enable ="false";
			ds_contract.setColumn(e.row,"leaseGb","50");
			ds_contract.setColumn(e.row,"leaseAmt","");	
			//fn_leaseCal();
		} else {
			ds_contract.setColumn(e.row,"leaseGb","");	
			ds_contract.setColumn(e.row,"leaseAmt","");	
			//fn_leaseCal();		
		}
	}
	//고정리스료
	if (e.columnid == "fdYn") {
	    if (e.newvalue == "Y") {
			leYn.value = "N";
			vaYn.value = "N";
			gtMinY.value = "N";
			gtMinN.value = "N";					
			ds_contract.setColumn(e.row,"fdAmt","");						
			ds_contract.setColumn(e.row,"vaAmt","");				
			ds_contract.setColumn(e.row,"gtMinAmt","");				
			ed_FD_AMT.enable ="true";
			ed_VA_AMT.enable ="false";
			ed_GT_MIN_AMT.enable ="false";
			ds_contract.setColumn(e.row,"leaseGb","10");
			ds_contract.setColumn(e.row,"leaseAmt","");	
			//fn_leaseCal();
		} else {			
			ds_contract.setColumn(e.row,"fdAmt","");				
			ed_FD_AMT.enable ="false";
			ds_contract.setColumn(e.row,"leaseGb","");		
			ds_contract.setColumn(e.row,"leaseAmt","");	
			//fn_leaseCal();	
		}
	}
	//변동리스료
	if (e.columnid == "vaYn") {
	    if (e.newvalue == "Y") {
			leYn.value = "N";
			fdYn.value = "N";
			gtMinY.value = "N";
			gtMinN.value = "N";		
			ds_contract.setColumn(e.row,"fdAmt","");				
			ds_contract.setColumn(e.row,"gtMinAmt","");	
			ed_FD_AMT.enable ="false";
			ed_VA_AMT.enable ="true";
			ed_GT_MIN_AMT.enable ="false";
			ds_contract.setColumn(e.row,"leaseGb","20");
			ds_contract.setColumn(e.row,"leaseAmt","");		
			//fn_leaseCal();	
		} else {
			ds_contract.setColumn(e.row,"vaAmt","");	
			ed_VA_AMT.enable ="false";
			ds_contract.setColumn(e.row,"leaseGb","");		
			ds_contract.setColumn(e.row,"leaseAmt","");		
			//fn_leaseCal();		
		}
	}
	//매출연동리스료(최소보장 없음)
	if (e.columnid == "gtMinN") {
	    if (e.newvalue == "Y") {
			//alert(e.newvalue);
			leYn.value = "N";
			fdYn.value = "N";
			vaYn.value = "N";		
			gtMinY.value = "N";		
			ds_contract.setColumn(e.row,"fdAmt","");						
			ds_contract.setColumn(e.row,"vaAmt","");				
			ds_contract.setColumn(e.row,"gtMinAmt","");		
			ed_FD_AMT.enable ="false";
			ed_VA_AMT.enable ="false";
			ed_GT_MIN_AMT.enable ="false";
			ds_contract.setColumn(e.row,"leaseGb","30");
			ds_contract.setColumn(e.row,"leaseAmt","");		
			//fn_leaseCal();	
		} else {		
			ds_contract.setColumn(e.row,"gtMinAmt","");	
			ed_GT_MIN_AMT.enable ="false";
			ds_contract.setColumn(e.row,"leaseGb","");	
			ds_contract.setColumn(e.row,"leaseAmt","");	
			//fn_leaseCal();				
		}
	}
	//매출연동리스료(최소보장 있음)
	if (e.columnid == "gtMinY") {
	    if (e.newvalue == "Y") {
			leYn.value = "N";
			fdYn.value = "N";
			vaYn.value = "N";		
			gtMinN.value = "N";		
			ds_contract.setColumn(e.row,"fdAmt","");						
			ds_contract.setColumn(e.row,"vaAmt","");				
			ds_contract.setColumn(e.row,"gtMinAmt","");		
			ed_FD_AMT.enable ="false";
			ed_VA_AMT.enable ="false";
			ed_GT_MIN_AMT.enable ="true";
			ds_contract.setColumn(e.row,"leaseGb","40");
			ds_contract.setColumn(e.row,"leaseAmt","");		
			//fn_leaseCal();	
		} else {			
			ds_contract.setColumn(e.row,"gtMinAmt","");		
			ed_GT_MIN_AMT.enable ="false";
			ds_contract.setColumn(e.row,"leaseGb","");		
			ds_contract.setColumn(e.row,"leaseAmt","");	
			//fn_leaseCal();		
		}
	}
	
	//월리스료 금액(고정리스료, 변동리스료, 매출연동리스료)
	if ((e.columnid == "fdAmt") || (e.columnid == "vaAmt") || (e.columnid == "gtMinAmt")) { 
		//alert(e.newvalue);
		ds_contract.setColumn(e.row,"leaseAmt",e.newvalue);
		//fn_leaseCal();
	}
		
	//염가매수청구권과 잔존보증가치
	//염가매수청구권 
	if (e.columnid == "lwBuyYn") {
	    if (e.newvalue == "Y") {
			gvYn.value = "N";			
			ds_contract.setColumn(e.row,"gvAmt","");	
			ed_GV_AMT.enable ="false";
			ed_LW_BUY_AMT.enable ="true";
			ds_contract.setColumn(e.row,"leaseGb2","10");
			ds_contract.setColumn(e.row,"leaseAmt2","");
			//fn_leaseCal();
		} else {
			ds_contract.setColumn(e.row,"gvAmt","");	
			ds_contract.setColumn(e.row,"lwBuyAmt","");	
			ed_LW_BUY_AMT.enable ="false";
			ds_contract.setColumn(e.row,"leaseGb2","");
			ds_contract.setColumn(e.row,"leaseAmt2","");
			//fn_leaseCal();
		}
	}
	//잔존보증가치
	if (e.columnid == "gvYn") {
	    if (e.newvalue == "Y") {
			lwBuyYn.value = "N";
			ds_contract.setColumn(e.row,"lwBuyAmt","");	
			ed_LW_BUY_AMT.enable ="false";
			ed_GV_AMT.enable ="true";
			ds_contract.setColumn(e.row,"leaseGb2","20");
			ds_contract.setColumn(e.row,"leaseAmt2","");
			//fn_leaseCal();
		} else {
			ds_contract.setColumn(e.row,"gvAmt","");	
			ds_contract.setColumn(e.row,"lwBuyAmt","");	
			ed_GV_AMT.enable ="false";
			ds_contract.setColumn(e.row,"leaseGb2","");
			ds_contract.setColumn(e.row,"leaseAmt2","");
			//fn_leaseCal();
		}
	}
	//월리스료 금액(염가매수청구권,잔존보증가치)
	if ((e.columnid == "lwBuyAmt") || (e.columnid == "gvAmt")) { 
		ds_contract.setColumn(e.row,"leaseAmt2",e.newvalue);
		//fn_leaseCal();
	}
	
	//월리스료 END
	
	//복구충당부채 계산(회계팀 요청으로 복구금액 미입력
	if (e.columnid == "recovExpAmt") {
		
		if (!gfn_isNull(ed_DIS_RATE.value)) {
			
			TEMP_AMT = 1;
			var diff_day = gfn_getDiffDay(ds_contract.getColumn(ds_contract.rowposition,"startDate"),ds_contract.getColumn(ds_contract.rowposition,"endDate"));
			//alert(diff_day);
			//일수로 계산
			for (var j=0; j<diff_day; j++) 
			//for (var j=0; j<ed_contractPrd.value; j++)
 			{
				//M53/(1+I31/12)^L30)
				TEMP_AMT = TEMP_AMT * (1+(ed_DIS_RATE.value/365/100));
			}		
			ed_RECOV_DEB_AMT.value = ed_RECOV_EXP_AMT.value / TEMP_AMT;
			
			//사용권자산 계산
			if (!gfn_isNull(ed_LEASE_DEB_AMT.value)) {
				ed_USE_RGHT_ASSET_AMT.value = ed_LEASE_DEB_AMT.value + (ed_RECOV_EXP_AMT.value / TEMP_AMT);
			} else {
				ed_USE_RGHT_ASSET_AMT.value = (ed_RECOV_EXP_AMT.value / TEMP_AMT);
			}
			
		}
	}
	
	//매출거래처 특약
	//scObYn
	if (e.columnid == "scObYn") {
	    if (e.newvalue == "Y") {
			ed_SC_OB_AMT.value = "";
			ds_contract.setColumn(e.row,"scObYn","Y");
			ds_contract.setColumn(e.row,"scObAmt","");				
			ds_contract.setColumn(e.row,"scObPdS","");	
			ds_contract.setColumn(e.row,"scObPdE","");				
			ed_SC_OB_AMT.enable = true;
			cal_SC_OB_PD_S.enable = true;
			cal_SC_OB_PD_E.enable = true;
		} else {
			ed_SC_OB_AMT.value = "";
			ds_contract.setColumn(e.row,"scObYn","");
			ds_contract.setColumn(e.row,"scObAmt","");				
			ds_contract.setColumn(e.row,"scObPdS","");	
			ds_contract.setColumn(e.row,"scObPdE","");	
			ed_SC_OB_AMT.enable = false;
			cal_SC_OB_PD_S.enable = false;
			cal_SC_OB_PD_E.enable = false;
		}
	}
	
	//scPvYn
	if (e.columnid == "scPvYn") {
	    if (e.newvalue == "Y") {
			ed_SC_PV_AMT.value = "";
			ds_contract.setColumn(e.row,"scPvYn","Y");
			ds_contract.setColumn(e.row,"scPvAmt","");			
			ds_contract.setColumn(e.row,"scPvPdS","");	
			ds_contract.setColumn(e.row,"scPvPdE","");					
			ed_SC_PV_AMT.enable = true;
			cal_SC_PV_PD_S.enable = true;
			cal_SC_PV_PD_E.enable = true;
		} else {
			ed_SC_PV_AMT.value = "";
			ds_contract.setColumn(e.row,"scPvYn","");
			ds_contract.setColumn(e.row,"scPvAmt","");		
			ds_contract.setColumn(e.row,"scPvPdS","");	
			ds_contract.setColumn(e.row,"scPvPdE","");		
			ed_SC_PV_AMT.enable = false;
			cal_SC_PV_PD_S.enable = false;
			cal_SC_PV_PD_E.enable = false;
		}
	}

	//scObYn
	if (e.columnid == "scInYn") {
	    if (e.newvalue == "Y") {
			ed_SC_IN_AMT.value = "";
			ds_contract.setColumn(e.row,"scInYn","Y");
			ds_contract.setColumn(e.row,"scInAmt","");		
			ds_contract.setColumn(e.row,"scInPdS","");	
			ds_contract.setColumn(e.row,"scInPdE","");	
			ed_SC_IN_AMT.enable = true;
			cal_SC_IN_PD_S.enable = true;
			cal_SC_IN_PD_E.enable = true;
		} else {
			ed_SC_IN_AMT.value = "";
			ds_contract.setColumn(e.row,"scInYn","");
			ds_contract.setColumn(e.row,"scInAmt","");
			ds_contract.setColumn(e.row,"scInPdS","");	
			ds_contract.setColumn(e.row,"scInPdE","");		
			ed_SC_IN_AMT.enable = false;
			cal_SC_IN_PD_S.enable = false;
			cal_SC_IN_PD_E.enable = false;

		}
	}

	
	//계약분류 연장 선택 시 기존 계약 복사해서 생성(버튼으로 변경 주석처리)
	/*
	if (e.columnid == "cntrtCategory") {
	    if (e.newvalue == "2") {
			
			//ds_contract.setColumn(e.row,"cntrtCategory","1");
			//연장 계약 확인 
			var rtVal = gfn_confirm("연장 계약을 생성하시겠습니까?");
			if (rtVal == true) {
				
				var bSucc;
				//연장계약 생성
				ds_contract.addRow();
				//기존계약 복사
				bSucc = ds_contract.copyRow(ds_contract.rowposition,ds_contract,e.row); 
				//계약번호, 계약기간, 적용할인율, 이자율, 사용권자산 및 리스부채 초기화
				ds_contract.setColumn(ds_contract.rowposition,"contractCd",null);	
				ds_contract.setColumn(ds_contract.rowposition,"startDate",null);	
				ds_contract.setColumn(ds_contract.rowposition,"endDate",null);		
				ds_contract.setColumn(ds_contract.rowposition,"contractPeriod",null);	
				ds_contract.setColumn(ds_contract.rowposition,"disRate",null);	
				ds_contract.setColumn(ds_contract.rowposition,"avgRate",null);	
				ds_contract.setColumn(ds_contract.rowposition,"dtRealAmt",null);	
				ds_contract.setColumn(ds_contract.rowposition,"useRghtAssetAmt",null);	
				ds_contract.setColumn(ds_contract.rowposition,"leaseDebAmt",null);	
				ds_contract.setColumn(ds_contract.rowposition,"leaseDebRealBal",null);					
				
				ds_contract.setColumn(e.row,"cntrtCategory","1");
				ds_contract.setColumn(ds_contract.rowposition,"cntrtCategory","2");	
				//alert(ds_contract.getColumn(ds_contract.rowposition,"cntrtCategory"));
				//rdo_extYn.value = "2";		
				
				//rdo_extYn.readonly = true;
				//rdo_extYn.enable = true;	
				cbo_cntrtCategory.readonly = true;
				cbo_cntrtCategory.enable = false;			
				
				//연장 계약으로 표시
				//rdo_extYn.value = "2";		
			
			}	
			
			
	    }
	}
	*/
	
	
}

//리스부채 계산 함수
function fn_leaseCal()
{	
	//초기화
	ds_contract.setColumn(ds_contract.rowposition,"useRghtAssetAmt",0);
	ds_contract.setColumn(ds_contract.rowposition,"leaseDebAmt",0);
	ds_contract.setColumn(ds_contract.rowposition,"leaseDebRealBal",0);
	//리스부채현할차  계산
	//=INT(Q27*((1-(1+K27/12)^(-J27))/(K27/12)))+INT(S27/(1+K27/12)^J27)
	//리스부채현할차=월리스료*((1-(1+적용할인율/12)^(-리스기간))/(적용할인율/12)))  +  잔존보증가치/(1+적용할인율/12)^리스기간)
	if (!gfn_isNull(ds_contract.getColumn(ds_contract.rowposition,"disRate"))) {
		//alert("start");
		//리스기간이 12개월이하인 경우 0
		if (ds_contract.getColumn(ds_contract.rowposition,"contractPeriod") < 13) {
			
			//ed_LEASE_DEB_AMT.value = 0;
			ds_contract.setColumn(ds_contract.rowposition,"leaseDebAmt",0);
			
		} else {
			//alert(ed_LS_PERIOD.value);
			//리스기간이 있는 경우
			if (!gfn_isNull(ds_contract.getColumn(ds_contract.rowposition,"lsPeriod"))) {
			
				//월리스료*((1-(1+적용할인율/12)^(-리스기간))/(적용할인율/12)))
				
				//월리스료 합계
				//TEMP_AMT2 = ed_FD_AMT.value + ed_VA_AMT.value + ed_GT_MIN_AMT.value + ed_LW_BUY_AMT.value + ed_GV_AMT.value;					
				//TEMP_AMT2 = ed_FD_AMT.value;
				TEMP_AMT2 = ds_contract.getColumn(ds_contract.rowposition,"leaseAmt");
				
				TEMP_AMT = 1;					
				for (var j=0; j<ds_contract.getColumn(ds_contract.rowposition,"lsPeriod"); j++)
				{
					//M53/(1+I31/12)^L30)
					TEMP_AMT = TEMP_AMT * (1+(ds_contract.getColumn(ds_contract.rowposition,"disRate")/12/100));
				}		
				TEMP_AMT = 1/ TEMP_AMT;
				TEMP_AMT = (1 - TEMP_AMT)/(ds_contract.getColumn(ds_contract.rowposition,"disRate")/12/100)
				//alert(TEMP_AMT2);
				
				
				//ed_LEASE_DEB_REAL_BAL.value = TEMP_AMT2 * TEMP_AMT;
				//ed_LEASE_DEB_AMT.value = 

				
				//염가매수청구권, 잔존보증가치가 있는 경우 합산
				//잔존보증가치/(1+적용할인율/12)^리스기간)
				//if (!gfn_isNull(ed_GV_AMT.value)) {
				if (!gfn_isNull(ds_contract.getColumn(ds_contract.rowposition,"leaseAmt2"))) {
					//alert("aaa:"+ed_LS_PERIOD.value);
					//alert("bbb:"+ed_DIS_RATE.value/12/100);
					TEMP_AMT3 = 1;
					for (var j=0; j<ds_contract.getColumn(ds_contract.rowposition,"lsPeriod"); j++)
					{
						//M53/(1+I31/12)^L30)
						TEMP_AMT3 = TEMP_AMT3 * (1+(ds_contract.getColumn(ds_contract.rowposition,"disRate")/12/100));
					}								
					//리스부채(총액)=(Q27)*J27+R27+S27, 월리스료*리스기간+염가매수청구권행사가격+잔존보증가치
					var tot_ls_amt:int = (TEMP_AMT2*ds_contract.getColumn(ds_contract.rowposition,"lsPeriod")) + (ds_contract.getColumn(ds_contract.rowposition,"leaseAmt2"));
					//alert(TEMP_AMT2*ds_contract.getColumn(ds_contract.rowposition,"contractPeriod"));
					//alert(ds_contract.getColumn(ds_contract.rowposition,"leaseAmt2"));
					ds_contract.setColumn(ds_contract.rowposition,"leaseDebAmt",tot_ls_amt);
					//alert("a:"+tot_ls_amt);
					//alert(TEMP_AMT3);
					//리스부채(순액)= 월리스료*((1-(1+적용할인율/12)^(-리스기간))/(적용할인율/12)))  +  잔존보증가치/(1+적용할인율/12)^리스기간);
					var s_ls_amt:int = (TEMP_AMT2 * TEMP_AMT) + (ds_contract.getColumn(ds_contract.rowposition,"leaseAmt2")/TEMP_AMT3);
					//리스부채현할차= 리스부채(총액)-리스부채(순액)
					//alert(s_ls_amt);
					ds_contract.setColumn(ds_contract.rowposition,"leaseDebRealBal",tot_ls_amt - s_ls_amt);
					
				} else {
					
					//리스부채(총액)=(Q27)*J27+R27+S27, 월리스료*리스기간+염가매수청구권행사가격+잔존보증가치
					var tot_ls_amt:int = TEMP_AMT2*ds_contract.getColumn(ds_contract.rowposition,"lsPeriod");
					//alert("b:"+tot_ls_amt);
					ds_contract.setColumn(ds_contract.rowposition,"leaseDebAmt",tot_ls_amt);
					//리스부채(순액)= 월리스료*((1-(1+적용할인율/12)^(-리스기간))/(적용할인율/12)))
					var s_ls_amt:int = TEMP_AMT2 * TEMP_AMT;
					//리스부채현할차= 리스부채(총액)-리스부채(순액)
					ds_contract.setColumn(ds_contract.rowposition,"leaseDebRealBal",tot_ls_amt - s_ls_amt);
					
				}
				
				
				//사용권자산 계산
				if (!gfn_isNull(s_ls_amt)) {
					//alert("!1");
					if (!gfn_isNull(ds_contract.getColumn(ds_contract.rowposition,"dtRealAmt"))) {						
						//alert(tot_ls_amt);
						//alert(TEMP_AMT2 * TEMP_AMT);
						//ed_USE_RGHT_ASSET_AMT.value = tot_ls_amt + (TEMP_AMT2 * TEMP_AMT);
						var dtRealAmt:int = ds_contract.getColumn(ds_contract.rowposition,"dtRealAmt");
						var useRghtAssetAmt:int = s_ls_amt + dtRealAmt;
						
						//ds_contract.setColumn(ds_contract.rowposition,"useRghtAssetAmt",s_ls_amt + ds_contract.getColumn(ds_contract.rowposition,"dtRealAmt"));
						ds_contract.setColumn(ds_contract.rowposition,"useRghtAssetAmt",useRghtAssetAmt);
						
					} else {
						//ed_USE_RGHT_ASSET_AMT.value = (TEMP_AMT2 * TEMP_AMT);
						ds_contract.setColumn(ds_contract.rowposition,"useRghtAssetAmt",s_ls_amt);
					}
				}
				
			}
	}
	
}


}

function fn_custAfter()
{
	//alert(CustSearchComponent00.getCustName());
	//alert(ds_contract.rowposition);
	ds_contract.setColumn(ds_contract.rowposition,"custNm",CustSearchComponent00.getCustName());
	ds_contract.setColumn(ds_contract.rowposition,"custCd",CustSearchComponent00.getCustCode());
}

function fn_cccdAfter(p, data){
	//if(data.code != null && data.code != undefined){
	if(gfn_transNullToEmpty(data.code)){
		ds_contract.setColumn(ds_contract.rowposition,"ccCd",data.code);
		edt_ccNm.value = data.codeName;		
	}	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 이자율 조회 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_rateSearch()
{	
	
	//alert(ds_rateSearch.getColumn(ds_rateSearch.rowposition,"callVal"));
	//alert(ds_rateSearch.getColumn(ds_rateSearch.rowposition,"intYm"));
	
	var strSvcID    = "rateSearch";
    var strURL      = "sc/scz/contractMgmt/selectRateList.xdo";
    var strInDs     = "ds_rateSearch=ds_rateSearch:A";
    var strOutDs    = "ds_rateSearch=ds_rateSearch";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}



function ds_contract_onrowposchanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	
	ed_PERIOD01.enable =false;
	ed_PERIOD02.enable =false;
	ed_PERIOD03.enable =false;	
	if (ds_contract.getColumn(ds_contract.rowposition,"periodGb01") =="Y") {
		ed_PERIOD01.enable =true;
		ed_PERIOD02.enable =false;
		ed_PERIOD03.enable =false;				
	}
	if (ds_contract.getColumn(ds_contract.rowposition,"periodGb02") =="Y") {
		ed_PERIOD02.enable =true;
		ed_PERIOD01.enable =false;
		ed_PERIOD03.enable =false;				
	}
	if (ds_contract.getColumn(ds_contract.rowposition,"periodGb03") =="Y") {
		ed_PERIOD03.enable =true;
		ed_PERIOD01.enable =false;
		ed_PERIOD02.enable =false;				
	}
	
	ed_FD_AMT.enable =false;
	ed_VA_AMT.enable =false;
	ed_GT_MIN_AMT.enable =false;
	if (ds_contract.getColumn(ds_contract.rowposition,"fdYn") =="Y") {
		ed_FD_AMT.enable =true;
		ed_VA_AMT.enable =false;
		ed_GT_MIN_AMT.enable =false;
	}
	if (ds_contract.getColumn(ds_contract.rowposition,"vaYn") =="Y") {
		ed_VA_AMT.enable =true;
		ed_FD_AMT.enable =false;
		ed_GT_MIN_AMT.enable =false;
	}
	if (ds_contract.getColumn(ds_contract.rowposition,"gtMinY") =="Y") {
		ed_GT_MIN_AMT.enable =true;
		ed_VA_AMT.enable =false;
		ed_FD_AMT.enable =false;
	}
	
	ed_LW_BUY_AMT.enable =false;
	ed_GV_AMT.enable =false;
	if (ds_contract.getColumn(ds_contract.rowposition,"lwBuyYn") =="Y") {
		ed_LW_BUY_AMT.enable =true;
		ed_GV_AMT.enable =false;
	}
	if (ds_contract.getColumn(ds_contract.rowposition,"gvYn") =="Y") {
		ed_GV_AMT.enable =true;
		ed_LW_BUY_AMT.enable =false;			
	}
	
	if (ds_contract.getColumn(ds_contract.rowposition,"scObYn") =="Y") {
		ed_SC_OB_AMT.enable = true;
		cal_SC_OB_PD_S.enable = true;
		cal_SC_OB_PD_E.enable = true;
	}	
	if (ds_contract.getColumn(ds_contract.rowposition,"scPvYn") =="Y") {
		ed_SC_PV_AMT.enable = true;
		cal_SC_PV_PD_S.enable = true;
		cal_SC_PV_PD_E.enable = true;
	}	
	if (ds_contract.getColumn(ds_contract.rowposition,"scInYn") =="Y") {
		ed_SC_IN_AMT.enable = true;
		cal_SC_IN_PD_S.enable = true;
		cal_SC_IN_PD_E.enable = true;
	}
	
	//rdo_extYn.updateToDataset();
	
	
}

function btn_extend_onclick(obj:Button,  e:ClickEventInfo)
{
	//연장 계약 확인 
	//alert(ds_contract.rowposition);
	var rtVal = gfn_confirm("[이전계약번호 : " + ds_contract.getColumn(ds_contract.rowposition,"contractName") + "] 계약을 복사하여 연장하시겠습니까?");
	var oldRowNum =ds_contract.rowposition;
	if (rtVal == true) {
		
		var bSucc;
		//연장계약 생성
		ds_contract.addRow();
		//기존계약 복사
		bSucc = ds_contract.copyRow(ds_contract.rowposition,ds_contract,oldRowNum); 
		//계약번호, 계약기간, 적용할인율, 이자율, 사용권자산 및 리스부채등 초기화
		ds_contract.setColumn(ds_contract.rowposition,"contractCd",null);	
		ds_contract.setColumn(ds_contract.rowposition,"startDate",null);	
		ds_contract.setColumn(ds_contract.rowposition,"endDate",null);		
		ds_contract.setColumn(ds_contract.rowposition,"contractPeriod",null);	
		ds_contract.setColumn(ds_contract.rowposition,"ncPeriod",null);		
		ds_contract.setColumn(ds_contract.rowposition,"lsPeriod",null);				
		ds_contract.setColumn(ds_contract.rowposition,"disRate",null);	
		ds_contract.setColumn(ds_contract.rowposition,"avgRate",null);	
		ds_contract.setColumn(ds_contract.rowposition,"dtRealAmt",null);	
		ds_contract.setColumn(ds_contract.rowposition,"useRghtAssetAmt",null);	
		ds_contract.setColumn(ds_contract.rowposition,"leaseDebAmt",null);	
		ds_contract.setColumn(ds_contract.rowposition,"leaseDebRealBal",null);	
		ds_contract.setColumn(ds_contract.rowposition,"elctnSignId",null);			
		ds_contract.setColumn(ds_contract.rowposition,"contractStats",null);			
		ds_contract.setColumn(ds_contract.rowposition,"cntrtCategory","2");	//복사한 계약 연장으로 설정
		ds_contract.setColumn(ds_contract.rowposition,"bfCntrtCd",ds_contract.getColumn(e.row,"contractCd")); //이전계약번호 설정	
		
		old_startDate = ds_contract.getColumn(e.row,"startDate");
		old_endDate = ds_contract.getColumn(e.row,"endDate");
		
		cbo_cntrtCategory.readonly = true;
		cbo_cntrtCategory.enable = false;		
				
		ed_PERIOD01.enable =false;
		ed_PERIOD02.enable =false;
		ed_PERIOD03.enable =false;	
		if (ds_contract.getColumn(ds_contract.rowposition,"periodGb01") =="Y") {
			ed_PERIOD01.enable =true;
			ed_PERIOD02.enable =false;
			ed_PERIOD03.enable =false;				
		}
		if (ds_contract.getColumn(ds_contract.rowposition,"periodGb02") =="Y") {
			ed_PERIOD02.enable =true;
			ed_PERIOD01.enable =false;
			ed_PERIOD03.enable =false;				
		}
		if (ds_contract.getColumn(ds_contract.rowposition,"periodGb03") =="Y") {
			ed_PERIOD03.enable =true;
			ed_PERIOD01.enable =false;
			ed_PERIOD02.enable =false;				
		}
		
		ed_FD_AMT.enable =false;
		ed_VA_AMT.enable =false;
		ed_GT_MIN_AMT.enable =false;
		if (ds_contract.getColumn(ds_contract.rowposition,"fdYn") =="Y") {
			ed_FD_AMT.enable =true;
			ed_VA_AMT.enable =false;
			ed_GT_MIN_AMT.enable =false;
		}
		if (ds_contract.getColumn(ds_contract.rowposition,"vaYn") =="Y") {
			ed_VA_AMT.enable =true;
			ed_FD_AMT.enable =false;
			ed_GT_MIN_AMT.enable =false;
		}
		if (ds_contract.getColumn(ds_contract.rowposition,"gtMinY") =="Y") {
			ed_GT_MIN_AMT.enable =true;
			ed_VA_AMT.enable =false;
			ed_FD_AMT.enable =false;
		}
		
		ed_LW_BUY_AMT.enable =false;
		ed_GV_AMT.enable =false;
		if (ds_contract.getColumn(ds_contract.rowposition,"lwBuyYn") =="Y") {
			ed_LW_BUY_AMT.enable =true;
			ed_GV_AMT.enable =false;
		}
		if (ds_contract.getColumn(ds_contract.rowposition,"gvYn") =="Y") {
			ed_GV_AMT.enable =true;
			ed_LW_BUY_AMT.enable =false;			
		}
	
	}	
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 그룹웨어 상신 버튼 클릭 시 상신 팝업을 호출한다.
 *---------------------------------------------------------------------------------------------*/
function btn_gwDraft_onclick(obj:Button,  e:ClickEventInfo){
	

    
    var contractCd = ds_contract.getColumn(ds_contract.rowposition, "contractCd");
    
    if (gfn_isNull(contractCd)) {
		gfn_alert("계약을 선택해주세요. ");
		return;		
    }
    
    //진행 상태 체크
    //alert(ds_contract.getColumn(ds_contract.rowposition, "contractCd"));
    /*
    if (ds_contract.getColumn(ds_contract.rowposition, "contractStats") == "20") {
		gfn_alert("결재완료 되었습니다.");
		return;
		
    } else 
    */
    if (ds_contract.getColumn(ds_contract.rowposition, "contractStats") == "50") {    
		if (ds_contract.getColumn(ds_contract.rowposition, "signProgressStatus") == "DRAFT") {
			gfn_alert("결재 상신중입니다.");
			return;	
		} else if (ds_contract.getColumn(ds_contract.rowposition, "signProgressStatus") == "REJECT") {    
			gfn_alert("결재 반려되었습니다. 확인 후 재상신해주세요.");			
		} else if (ds_contract.getColumn(ds_contract.rowposition, "signProgressStatus") == "APPROVE") {    
			gfn_alert("결재 승인중입니다.");
			return;		
		} else if (ds_contract.getColumn(ds_contract.rowposition, "signProgressStatus") == "COMPLETE") {    
			gfn_alert("결재 완료되었습니다.");
			return;		
		} else if (ds_contract.getColumn(ds_contract.rowposition, "signProgressStatus") == "CANCEL") {    
			gfn_alert("결재 취소되었습니다. 재상신 가능합니다.");			
		} else if (ds_contract.getColumn(ds_contract.rowposition, "signProgressStatus") == "SUSPEND") { 
			gfn_alert("결재 보류중입니다. ");
			return;	
		} else {
			gfn_alert("결재 진행중입니다.");
			return;	
		}
	} else if (ds_contract.getColumn(ds_contract.rowposition, "contractStats") == "40") {    
		gfn_alert("EA전송 완료되었습니다.");
		return;
    }

    //첨부파일 목록을 얻는다. - 업무에 맞게 처리
    //fn_searchSignAttachList();
    //alert("fv_attachList:"+fv_attachList);

    //그룹웨어에 전달할 파라메터 생성
    var arrParams = SCGw.newParams();

    //(필수) 결재문서 서비스명 - 문서양식별로 설정된 서비스명 설정
    SCGw.setParams (arrParams, SCGw.GW_SERVICE_NAME, "HWRC_FC_PRO_CTRT_REQ");

    //(필수) 본문 URL : (주의) .do로 호출해야 하며 GET 방식으로 파라미터를 전달 (id라는 key는 사용 불가)
    var sBodyUrl = "/sm/srm/sapSlipSendRept/makeGwDraftContent2.do?contractCd="+contractCd+"&sabun="+g_EmpNo;

    SCGw.setParams(arrParams, SCGw.GW_BODY_URL, sBodyUrl);

    //(필수) 본문 제목 – 문서양식 별로 설정된 업무명
    SCGw.setParams(arrParams, SCGw.GW_BODY_TITLE, "계약관리 등록/변경 신청");

    //(필수)문서 방향 : 가로 또는 세로 방향 (GW_VERTICAL, GW_HORIZONTAL)
    //SCGw.setParams(arrParams, SCGw.GW_PORTRAIT, SCGw.GW_HORIZONTAL);
    SCGw.setParams(arrParams, SCGw.GW_PORTRAIT, SCGw.GW_VERTICAL);

    //(선택)첨부문서 목록 : json 형태 문자열
    SCGw.setParams(arrParams, SCGw.GW_ATTACH_LIST, fv_attachList);

    //그룹웨어 상신 팝업을 호출한다.
    SCGw.sendDraft(this, arrParams);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 그룹웨어 결재상세 버튼 클릭 시 결재상세 팝업을 호출한다.
 *---------------------------------------------------------------------------------------------*/
function btn_gwDetail_onclick(obj:Button,  e:ClickEventInfo){
    //그룹웨어 결재상세 팝업을 호출한다.
    SCGw.sendDetailView(this, ds_contract.getColumn(ds_contract.rowposition, "signInstanceId"));
}

function fn_searchSignAttachList(){
    gfn_transaction(this
					,"searchSignAttachList"
					,"sm/srm/sapSlipSendRept/selectGwSilpAttachFile.xdo"
					,""
					,""
					,"refSeq=" + wrapQuote(!gfn_isNull(ds_list.getColumn(ds_list.rowposition, "fileId")) ? ds_list.getColumn(ds_list.rowposition, "fileId") : "")
					,"fn_callBack"
					,false);
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 전자결재정보를 저장 (옵션-결재상신 처리 후 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_saveSign(){
    gfn_transaction(this
					,"saveSign"
					,"sm/srm/sapSlipSendRept/saveSignInfo2.xdo"
					,"ds_contract=ds_contract:U"	//결재정보가 있는 데이터셋
					,""
					,""
					,"fn_callBack"
					,false);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 그룹웨어 상신 처리 후 반환되는 Instance Id를 처리한다. (업무 테이블에 update)
 *---------------------------------------------------------------------------------------------*/
function scgw_ondraftnotify(instanceId){

	ds_contract.setColumn(ds_contract.rowposition, "signInstanceId",      instanceId);            //결재InstanceId 설정
	//ds_contract.setColumn(ds_contract.rowposition, "elctnSignId",      	instanceId);            //결재InstanceId 설정
	ds_contract.setColumn(ds_contract.rowposition, "contractStats",      '50');            //상태

	//alert(SCGw.GW_DRAFT_STATUS);
	//ds_contract.setColumn(ds_contract.rowposition, "signProgressStatus",  SCGw.GW_DRAFT_STATUS);  //결재진행상태를 상신으로 설정
    
    //결재정보 저장
    fn_saveSign();
}]]></Script>
  </Form>
</FDL>

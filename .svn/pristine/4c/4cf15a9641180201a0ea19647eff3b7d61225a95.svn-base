<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="MAP40020P01" classname="mngComCode" inheritanceid="" position="absolute 0 0 800 451" titletext="계정 선택 팝업" onload="ImprovTaskMgmt02P01_onload">
    <Layouts>
      <Layout>
        <resizeObject id="resizeObject00" text="resizeObject00" visible="false" position="absolute 4 8 25 30" style="background:#009999ff; border:1 solid #808080ff ; "/>
        <Static id="Static01" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 15 440"/>
        <Static id="Static15" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 15 0 772 10"/>
        <Static id="Static02" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 785 0 800 440"/>
        <Static id="Static03" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 15 436 787 451"/>
        <Static id="Static17" text="h10" visible="false" position="absolute 15 401 787 411" style="background:#ff000055;align:center middle;"/>
        <Static id="sta_sGroup" class="sta_WFSA_Labelbg" position="absolute 15 10 785 51" anchor="left top right" style="border:1 solid #b1b5b9b3 ; " moveX="0" moveY="0" resizeX="100" resizeY="0"/>
        <Static id="Static00" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 15 10 30 51"/>
        <Static id="Static18" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 30 10 772 20"/>
        <Static id="Static19" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 30 41 787 51"/>
        <Static id="Static04" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 770 0 785 41"/>
        <Button id="btn_search" taborder="0" tabstop="false" text="조회" onclick="btn_search_onclick" class="btn_WF_searchCm" position="absolute 711 20 770 41" anchor="top right"/>
        <Grid id="grd_list" taborder="1" binddataset="ds_list" autoenter="select" useinputpanel="false" cellsizingtype="col" fillareatype="linerow" onheadclick="grd_onheadclick" oncelldblclick="fn_return" onselectchanged="grd_scrn_onselectchanged" position="absolute 15 71 787 401" style="align:center middle; " moveX="0" moveY="0" resizeX="50" resizeY="100" anchor="all" selecttype="row">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="24" band="left"/>
                <Column size="68" band="left"/>
                <Column size="160" band="left"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
              </Columns>
              <Rows>
                <Row size="37" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell/>
                <Cell col="1" text="계정코드"/>
                <Cell col="2" text="계정명"/>
                <Cell col="3" text="1월"/>
                <Cell col="4" text="2월"/>
                <Cell col="5" text="3월"/>
                <Cell col="6" text="4월"/>
                <Cell col="7" text="5월"/>
                <Cell col="8" text="6월"/>
                <Cell col="9" text="7월"/>
                <Cell col="10" text="8월"/>
                <Cell col="11" text="9월"/>
                <Cell col="12" text="10월"/>
                <Cell col="13" text="11월"/>
                <Cell col="14" text="12월"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                <Cell col="1" style="align:left;" text="bind:acctCd"/>
                <Cell col="2" style="align:left;" text="bind:acctNm"/>
                <Cell col="3" displaytype="number" edittype="normal" editfilter="number" text="bind:mmImprovAmt01" editlimit="20" editautoselect="true"/>
                <Cell col="4" displaytype="number" edittype="normal" editfilter="number" text="bind:mmImprovAmt02" editlimit="20" editautoselect="true"/>
                <Cell col="5" displaytype="number" edittype="normal" editfilter="number" text="bind:mmImprovAmt03" editlimit="20" editautoselect="true"/>
                <Cell col="6" displaytype="number" edittype="normal" editfilter="number" text="bind:mmImprovAmt04" editlimit="20" editautoselect="true"/>
                <Cell col="7" displaytype="number" edittype="normal" editfilter="number" text="bind:mmImprovAmt05" editlimit="20" editautoselect="true"/>
                <Cell col="8" displaytype="number" edittype="normal" editfilter="number" text="bind:mmImprovAmt06" editlimit="20" editautoselect="true"/>
                <Cell col="9" displaytype="number" edittype="normal" editfilter="number" text="bind:mmImprovAmt07" editlimit="20" editautoselect="true"/>
                <Cell col="10" displaytype="number" edittype="normal" editfilter="number" text="bind:mmImprovAmt08" editlimit="20" editautoselect="true"/>
                <Cell col="11" displaytype="number" edittype="normal" editfilter="number" text="bind:mmImprovAmt09" editlimit="20" editautoselect="true"/>
                <Cell col="12" displaytype="number" edittype="normal" editfilter="number" text="bind:mmImprovAmt10" editlimit="20" editautoselect="true"/>
                <Cell col="13" displaytype="number" edittype="normal" editfilter="number" text="bind:mmImprovAmt11" editlimit="20" editautoselect="true"/>
                <Cell col="14" displaytype="number" edittype="normal" editfilter="number" text="bind:mmImprovAmt12" editlimit="20" editautoselect="true"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_close" taborder="3" text="닫기" onclick="fn_return" class="btn_WF_CRUD" position="absolute 375 412 429 436"/>
        <Button id="btn_formDownload" taborder="4" text="PL 양식 다운" class="btn_WF_Function" position="absolute 462 20 543 41" anchor="top right" onclick="btn_formDownload_onclick"/>
        <Button id="btn_excelUpload" taborder="5" text="엑셀 UPLOAD" class="btn_WF_Function" position="absolute 545 20 626 41" anchor="top right" onclick="btn_excelUpload_onclick"/>
        <Button id="btn_save" taborder="2" text="저장" class="btn_WF_Function" position="absolute 628 20 709 41" anchor="top right" onclick="btn_save_onclick"/>
        <Grid id="grd_list2" taborder="10" useinputpanel="false" position="absolute 864 200 1741 438" binddataset="ds_list2" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="normal" text="acctCd"/>
                <Cell col="1" displaytype="normal" text="acctNm"/>
                <Cell col="2" displaytype="normal" text="mmImprovAmt01"/>
                <Cell col="3" displaytype="normal" text="mmImprovAmt02"/>
                <Cell col="4" displaytype="normal" text="mmImprovAmt03"/>
                <Cell col="5" displaytype="normal" text="mmImprovAmt04"/>
                <Cell col="6" displaytype="normal" text="mmImprovAmt05"/>
                <Cell col="7" displaytype="normal" text="mmImprovAmt06"/>
                <Cell col="8" displaytype="normal" text="mmImprovAmt07"/>
                <Cell col="9" displaytype="normal" text="mmImprovAmt08"/>
                <Cell col="10" displaytype="normal" text="mmImprovAmt09"/>
                <Cell col="11" displaytype="normal" text="mmImprovAmt10"/>
                <Cell col="12" displaytype="normal" text="mmImprovAmt11"/>
                <Cell col="13" displaytype="normal" text="mmImprovAmt12"/>
              </Band>
              <Band id="body">
                <Cell displaytype="normal" text="bind:acctCd"/>
                <Cell col="1" displaytype="normal" text="bind:acctNm"/>
                <Cell col="2" displaytype="normal" text="bind:mmImprovAmt01"/>
                <Cell col="3" displaytype="normal" text="bind:mmImprovAmt02"/>
                <Cell col="4" displaytype="normal" text="bind:mmImprovAmt03"/>
                <Cell col="5" displaytype="normal" text="bind:mmImprovAmt04"/>
                <Cell col="6" displaytype="normal" text="bind:mmImprovAmt05"/>
                <Cell col="7" displaytype="normal" text="bind:mmImprovAmt06"/>
                <Cell col="8" displaytype="normal" text="bind:mmImprovAmt07"/>
                <Cell col="9" displaytype="normal" text="bind:mmImprovAmt08"/>
                <Cell col="10" displaytype="normal" text="bind:mmImprovAmt09"/>
                <Cell col="11" displaytype="normal" text="bind:mmImprovAmt10"/>
                <Cell col="12" displaytype="normal" text="bind:mmImprovAmt11"/>
                <Cell col="13" displaytype="normal" text="bind:mmImprovAmt12"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="grd_list3" taborder="11" binddataset="ds_list" autoenter="select" useinputpanel="false" cellsizingtype="col" fillareatype="linerow" onheadclick="grd_onheadclick" oncelldblclick="fn_return" onselectchanged="grd_scrn_onselectchanged" position="absolute 850 0 1134 149" style="align:center middle; " moveX="0" moveY="0" resizeX="50" resizeY="100" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="68" band="left"/>
                <Column size="160" band="left"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
              </Columns>
              <Rows>
                <Row size="37" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="계정코드"/>
                <Cell col="1" text="계정명"/>
                <Cell col="2" text="1월"/>
                <Cell col="3" text="2월"/>
                <Cell col="4" text="3월"/>
                <Cell col="5" text="4월"/>
                <Cell col="6" text="5월"/>
                <Cell col="7" text="6월"/>
                <Cell col="8" text="7월"/>
                <Cell col="9" text="8월"/>
                <Cell col="10" text="9월"/>
                <Cell col="11" text="10월"/>
                <Cell col="12" text="11월"/>
                <Cell col="13" text="12월"/>
              </Band>
              <Band id="body">
                <Cell style="align:left;" text="bind:acctCd"/>
                <Cell col="1" style="align:left;" text="bind:acctNm"/>
                <Cell col="2" displaytype="text" edittype="normal" editfilter="number" text="bind:mmImprovAmt01" editlimit="20"/>
                <Cell col="3" displaytype="text" edittype="normal" editfilter="number" text="bind:mmImprovAmt02" editlimit="20"/>
                <Cell col="4" displaytype="text" edittype="normal" editfilter="number" text="bind:mmImprovAmt03" editlimit="20"/>
                <Cell col="5" displaytype="text" edittype="normal" editfilter="number" text="bind:mmImprovAmt04" editlimit="20"/>
                <Cell col="6" displaytype="text" edittype="normal" editfilter="number" text="bind:mmImprovAmt05" editlimit="20"/>
                <Cell col="7" displaytype="text" edittype="normal" editfilter="number" text="bind:mmImprovAmt06" editlimit="20"/>
                <Cell col="8" displaytype="text" edittype="normal" editfilter="number" text="bind:mmImprovAmt07" editlimit="20"/>
                <Cell col="9" displaytype="text" edittype="normal" editfilter="number" text="bind:mmImprovAmt08" editlimit="20"/>
                <Cell col="10" displaytype="text" edittype="normal" editfilter="number" text="bind:mmImprovAmt09" editlimit="20"/>
                <Cell col="11" displaytype="text" edittype="normal" editfilter="number" text="bind:mmImprovAmt10" editlimit="20"/>
                <Cell col="12" displaytype="text" edittype="normal" editfilter="number" text="bind:mmImprovAmt11" editlimit="20"/>
                <Cell col="13" displaytype="text" edittype="normal" editfilter="number" text="bind:mmImprovAmt12" editlimit="20"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static05" text="(단위:천원)" position="absolute 717 55 787 70" style="font:굴림,9,bold;" anchor="top right"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="improvYear" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="improvMgrp" type="STRING" size="256"/>
          <Column id="improvMcalss" type="STRING" size="256"/>
          <Column id="improvSclass" type="STRING" size="256"/>
          <Column id="improvThemeSeq" type="STRING" size="256"/>
          <Column id="revSeq" type="STRING" size="256"/>
          <Column id="acctCd" type="STRING" size="256"/>
          <Column id="acctNm" type="STRING" size="256"/>
          <Column id="acctClass" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="bpcYn" type="STRING" size="256"/>
          <Column id="mmImprovAmt01" type="INT" size="256"/>
          <Column id="mmImprovAmt02" type="INT" size="256"/>
          <Column id="mmImprovAmt03" type="INT" size="256"/>
          <Column id="mmImprovAmt04" type="INT" size="256"/>
          <Column id="mmImprovAmt05" type="INT" size="256"/>
          <Column id="mmImprovAmt06" type="INT" size="256"/>
          <Column id="mmImprovAmt07" type="INT" size="256"/>
          <Column id="mmImprovAmt08" type="INT" size="256"/>
          <Column id="mmImprovAmt09" type="INT" size="256"/>
          <Column id="mmImprovAmt10" type="INT" size="256"/>
          <Column id="mmImprovAmt11" type="INT" size="256"/>
          <Column id="mmImprovAmt12" type="INT" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="cdate" type="STRING" size="256"/>
          <Column id="cuser" type="STRING" size="256"/>
          <Column id="udate" type="STRING" size="256"/>
          <Column id="uuser" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="improvYear" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="improvMgrp" type="STRING" size="256"/>
          <Column id="improvMcalss" type="STRING" size="256"/>
          <Column id="improvSclass" type="STRING" size="256"/>
          <Column id="improvThemeSeq" type="STRING" size="256"/>
          <Column id="revSeq" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="racctcd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listRtn" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="groupCode" type="STRING" size="256"/>
          <Column id="code" type="STRING" size="256"/>
          <Column id="improvMgrp" type="STRING" size="256"/>
          <Column id="improvMgrpNm" type="STRING" size="256"/>
          <Column id="improvMcalss" type="STRING" size="256"/>
          <Column id="improvMcalssNm" type="STRING" size="256"/>
          <Column id="improvSclass" type="STRING" size="256"/>
          <Column id="improvSclassNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listTmp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="improvYear" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="improvMgrp" type="STRING" size="256"/>
          <Column id="improvMcalss" type="STRING" size="256"/>
          <Column id="improvSclass" type="STRING" size="256"/>
          <Column id="improvThemeSeq" type="STRING" size="256"/>
          <Column id="revSeq" type="STRING" size="256"/>
          <Column id="acctCd" type="STRING" size="256"/>
          <Column id="acctNm" type="STRING" size="256"/>
          <Column id="acctClass" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="bpcYn" type="STRING" size="256"/>
          <Column id="mmImprovAmt01" type="INT" size="256"/>
          <Column id="mmImprovAmt02" type="INT" size="256"/>
          <Column id="mmImprovAmt03" type="INT" size="256"/>
          <Column id="mmImprovAmt04" type="INT" size="256"/>
          <Column id="mmImprovAmt05" type="INT" size="256"/>
          <Column id="mmImprovAmt06" type="INT" size="256"/>
          <Column id="mmImprovAmt07" type="INT" size="256"/>
          <Column id="mmImprovAmt08" type="INT" size="256"/>
          <Column id="mmImprovAmt09" type="INT" size="256"/>
          <Column id="mmImprovAmt10" type="INT" size="256"/>
          <Column id="mmImprovAmt11" type="INT" size="256"/>
          <Column id="mmImprovAmt12" type="INT" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="cdate" type="STRING" size="256"/>
          <Column id="cuser" type="STRING" size="256"/>
          <Column id="udate" type="STRING" size="256"/>
          <Column id="uuser" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list2" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="acctCd" type="STRING" size="256"/>
          <Column id="acctNm" type="STRING" size="256"/>
          <Column id="mmImprovAmt01" type="INT" size="256"/>
          <Column id="mmImprovAmt02" type="INT" size="256"/>
          <Column id="mmImprovAmt03" type="INT" size="256"/>
          <Column id="mmImprovAmt04" type="INT" size="256"/>
          <Column id="mmImprovAmt05" type="INT" size="256"/>
          <Column id="mmImprovAmt06" type="INT" size="256"/>
          <Column id="mmImprovAmt07" type="INT" size="256"/>
          <Column id="mmImprovAmt08" type="INT" size="256"/>
          <Column id="mmImprovAmt09" type="INT" size="256"/>
          <Column id="mmImprovAmt10" type="INT" size="256"/>
          <Column id="mmImprovAmt11" type="INT" size="256"/>
          <Column id="mmImprovAmt12" type="INT" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="improvYear" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="improvMgrp" type="STRING" size="256"/>
          <Column id="improvMcalss" type="STRING" size="256"/>
          <Column id="improvSclass" type="STRING" size="256"/>
          <Column id="improvThemeSeq" type="STRING" size="256"/>
          <Column id="revSeq" type="STRING" size="256"/>
          <Column id="acctCd" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="improvYear">title:사업연도,required:true</Col>
            <Col id="muCd">title:사업부코드,required:true</Col>
            <Col id="improvMgrp">title:개선대분류코드,required:true</Col>
            <Col id="improvMcalss">title:개선중분류코드,required:true</Col>
            <Col id="improvSclass">title:개선소분류코드,required:true</Col>
            <Col id="improvThemeSeq">title:개선과제순번,required:true</Col>
            <Col id="revSeq">title:변경차수순번,required:true</Col>
            <Col id="acctCd">title:계정코드,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_listSum" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="improvYear" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="improvMgrp" type="STRING" size="256"/>
          <Column id="improvMcalss" type="STRING" size="256"/>
          <Column id="improvSclass" type="STRING" size="256"/>
          <Column id="improvThemeSeq" type="STRING" size="256"/>
          <Column id="revSeq" type="STRING" size="256"/>
          <Column id="acctCd" type="STRING" size="256"/>
          <Column id="acctNm" type="STRING" size="256"/>
          <Column id="acctClass" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="bpcYn" type="STRING" size="256"/>
          <Column id="mmImprovAmt01" type="INT" size="256"/>
          <Column id="mmImprovAmt02" type="INT" size="256"/>
          <Column id="mmImprovAmt03" type="INT" size="256"/>
          <Column id="mmImprovAmt04" type="INT" size="256"/>
          <Column id="mmImprovAmt05" type="INT" size="256"/>
          <Column id="mmImprovAmt06" type="INT" size="256"/>
          <Column id="mmImprovAmt07" type="INT" size="256"/>
          <Column id="mmImprovAmt08" type="INT" size="256"/>
          <Column id="mmImprovAmt09" type="INT" size="256"/>
          <Column id="mmImprovAmt10" type="INT" size="256"/>
          <Column id="mmImprovAmt11" type="INT" size="256"/>
          <Column id="mmImprovAmt12" type="INT" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="cdate" type="STRING" size="256"/>
          <Column id="cuser" type="STRING" size="256"/>
          <Column id="udate" type="STRING" size="256"/>
          <Column id="uuser" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
          <Column id="persInfoYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">0</Col>
            <Col id="delYn">0</Col>
            <Col id="savYn">0</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">1</Col>
            <Col id="persInfoYn">0</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item2" compid="edt_docmTit01" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item3" compid="edt_docmTit00" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item4" compid="edt_docmTit02" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item5" compid="edt_docmTit03" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item6" compid="edt_docmTit04" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item7" compid="edt_docmTit05" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item8" compid="edt_docmTit06" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item9" compid="edt_docmTit07" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item10" compid="edt_docmTit08" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item11" compid="edt_docmTit09" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item12" compid="edt_docmTit10" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item13" compid="edt_docmTit11" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item14" compid="edt_docmTit12" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item15" compid="edt_docmTit13" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item16" compid="edt_docmTit14" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item17" compid="edt_docmTit15" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item18" compid="edt_docmTit16" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item19" compid="edt_docmTit17" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item20" compid="edt_docmTit18" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item21" compid="edt_docmTit19" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
      <BindItem id="item22" compid="edt_docmDiv00" propid="value" datasetid="ds_apprDocm" columnid="docmTit"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
 ******************************************************************************************
 * 시스템구분   : 계정 선택 팝업
 * 프로그램명   : MAP40020P01.XML
 * 기      능    : 계정 선택 팝업
 * 작  성  자    : ajn
 * 작성  일자    : 2015.09.02
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "U_lib::lib_conversionCom.xjs";
include "lib::lib_com.xjs";
/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*
 ******************************************************************************************
 * 함  수  명   : form_onload
 * 입      력   : 
 * 반      환   : 
 * 기      능   : Form Load (필수) 
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function ImprovTaskMgmt02P01_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(this);
	
	fsp_init(this);
	
	ds_search.clearData();
	ds_search.addRow();
	
	var argArgs = this.getOwnerFrame().fv_Contents;
	
	if(argArgs != null)
	{
		
		ds_search.setColumn( 0, "improvYear", argArgs[0] );//년도
		ds_search.setColumn( 0, "upjang"	, argArgs[1] );//업장
		ds_search.setColumn( 0, "improvMgrp", argArgs[2] );//대분류
		ds_search.setColumn( 0, "improvMcalss", argArgs[3] );//중분류
		ds_search.setColumn( 0, "improvSclass", argArgs[4] );//소분류
		ds_search.setColumn( 0, "improvThemeSeq", argArgs[5] );//개선과제
		ds_search.setColumn( 0, "revSeq"		, argArgs[6] );//리비젼
		ds_search.setColumn( 0, "ccCd"		, argArgs[7] );//코스트 센터
		
		if( "Y" == argArgs[8] )
			ds_search.setColumn( 0, "racctcd"		, argArgs[8] );//Y 식재의 경우 계정코드가 한정됨, N 식재를 제외한 나머지
			
	}

	
	fn_search();
}


/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*
 ******************************************************************************************
 * 함  수  명   : fn_search
 * 입      력   : 
 * 반      환   : 
 * 기      능   : 화면 목록 조회
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_search()
{
	gfn_clearSortMark(grd_list);
	
	// Transaction 설정
	var strSvcID    = "svcSearch";
    var strURL      = "/ma/map/improvtaskmgmt/list5.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_list=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);

	
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*
 ******************************************************************************************
 * 함  수  명   : fn_callBack
 * 입      력   : 
 * 반      환   : 
 * 기      능   : 트랜잭션 콜백 함수 (필수)
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	if(nErrorCode ==-1) 
	{	
		return; 
	} 
	else 
	{
		if(strSvcID == "svcSave")//save
		{ 
			gfn_alert("msg.save.success");	// 저장 되었습니다.
			fn_return();
		} 	
	}   
}

/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*
 ******************************************************************************************
 * 함  수  명   : fn_return
 * 입      력   : 
 * 반      환   : 
 * 기      능   : Return할 Array 생성 및 창 닫기
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_return()
{

	var dsObj = new Array();
	
	// 선택된 row만 리턴
	this.close(dsObj);
}


/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*
 ******************************************************************************************
 * 함  수  명   : btn_search_onclick
 * 입      력   : 
 * 반      환   : 
 * 기      능   : 조회
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function btn_search_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_search();
}

 /*
 ******************************************************************************************
 * 함  수  명   : btn_formDownload_onclick
 * 입      력   : 
 * 반      환   : 
 * 기      능   : 양식 다운로드 버튼 이벤트
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function btn_formDownload_onclick(obj:Button,  e:ClickEventInfo)
{
	this.setWaitCursor(true);

	// 파일 선택
	var strFileName = "PL 양식 다운";

	var strSheetName = "PL 양식 다운";
	
	gfn_exportExcel(grd_list3, strSheetName, strFileName);
	
	this.setWaitCursor(false);
}

 /*
 ******************************************************************************************
 * 함  수  명   : btn_excelUpload_onclick
 * 입      력   : 
 * 반      환   : 
 * 기      능   : 엑셀업로드 클릭 이벤트
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function btn_excelUpload_onclick(obj:Button,  e:ClickEventInfo)
{
	this.setWaitCursor(true);

	// 파일 선택
	var strFileName = gfn_excelFileDialog("LOAD", "EXCEL");

	if (strFileName.length == 0)
	{
		this.setWaitCursor(false);
		return;
	}

	/*********************************************************************************************
	** argument             : strFileName		파일명 (경로 포함)
	**                        strDsName			Import 대상 Dataset Name
	**                        nStartRow			Import 시작 행(사용된 Range 기준, 1 base)
	**						  bKeepColInfo		Dataset의 컬럼 정보를 유지할지 여부
	*********************************************************************************************/
	var rtn = gfn_importExcel(strFileName, "ds_list2", 2, true);

	this.setWaitCursor(false);
	
	
	
	//그리드에 읽혀진 데이타를 한줄씩 읽는다.
	
	var nRowCnt = ds_list2.getRowCount();
	
	if( nRowCnt == 0 )
	{
		alert( "데이타가 없습니다." );
		return;
	}
	
	
	for( var i = 0 ; i < nRowCnt ; i++ )
	{
		var nFaultNumber = 0;
		var nNumber 
		for( var j = 0 ; j < 9 ; j++ )
		{
			if( true == gfn_isNull( ds_list2.getColumn( i, "mmImprovAmt0" + (j + 1) ) ) )
			{
			}
			else
			{
				if( false == gfn_isNum( ds_list2.getColumn( i, "mmImprovAmt0" + (j + 1) ) ) )
				{
					alert("숫자가 아닌 값이 있습니다.");
					return;
				}
			}
		}
		
		 
		
		for( var j = 9 ; j < 12 ; j++ )
		{
			if( true == gfn_isNull( ds_list2.getColumn( i, "mmImprovAmt" + (j + 1) ) ) )
			{
			}
			else
			{
				if( false == gfn_isNum( ds_list2.getColumn( i, "mmImprovAmt" + (j + 1) ) ) )
				{
					alert("숫자가 아닌 값이 있습니다.");
					return;
				}
			}
		}
	}
	
	//계정 코드가 실제 있는 코드인지 확인한다. 
	for( var i = 0 ;  i < nRowCnt ; i++ )
	{
		if( -1 == ds_list.findRow("acctCd", ds_list2.getColumn( i, "acctCd" ) ) )
		{
			alert("사용할 수 없는 계정코드 입니다.");
			return;
		}
	}
	
	//중복된 코드가 있는지 확인한다.
	
	for( var i = 0 ;  i < nRowCnt ; i++ )
	{
		var nFirst= 0;
		var nSecond= 0;
		
		nFirst = ds_list2.findRow("acctCd", ds_list2.getColumn( i, "acctCd" ), nFirst );
		nSecond = nFirst + 1;
		
		if( nFirst < ds_list2.findRow("acctCd", ds_list2.getColumn( i, "acctCd" ), nSecond ) )
		{
			alert("중복된 계정코드가 있습니다.");
			return;
		}
		
	}
	
	//////
	
	ds_list.clearData();
	
	
	//행을 만든다.
	for( var i = 0 ; i < nRowCnt ; i++ )
	{	
		ds_list.addRow();
	}
	
	//키 값을 넣는다.
	for( var i = 0 ; i < nRowCnt ; i++ )
	{	
		ds_list.setColumn( i, "improvYear", 	ds_search.getColumn( 0, "improvYear" ) );
		ds_list.setColumn( i, "upjang", 		ds_search.getColumn( 0, "upjang" ) );
		ds_list.setColumn( i, "improvMgrp", 	ds_search.getColumn( 0, "improvMgrp" ) );
		ds_list.setColumn( i, "improvMcalss", 	ds_search.getColumn( 0, "improvMcalss" ) );
		ds_list.setColumn( i, "improvSclass", 	ds_search.getColumn( 0, "improvSclass" ) );
		ds_list.setColumn( i, "improvThemeSeq", ds_search.getColumn( 0, "improvThemeSeq" ) );
		ds_list.setColumn( i, "revSeq", 		ds_search.getColumn( 0, "revSeq" ) );
		ds_list.setColumn( i, "acctCd",     	ds_list2.getColumn( i, "acctCd" ) );
		ds_list.setColumn( i, "acctNm",     	ds_list2.getColumn( i, "acctNm" ) );
		ds_list.setColumn( i, "useYn",      	"Y" );
		ds_list.setColumn( i, "ccCd",       	ds_search.getColumn( 0, "ccCd" ) );
		
	}
	
	//숫자 부분을 넣는다.
	for( var i = 0 ; i < nRowCnt ; i++ )
	{
		for( var j = 0 ; j < 9 ; j++ )
		{
			ds_list.setColumn( i, "mmImprovAmt0" + (j + 1), ds_list2.getColumn( i, "mmImprovAmt0" + (j + 1) ) );
		}
		
		for( var j = 9 ; j < 12 ; j++ )
		{
			ds_list.setColumn( i, "mmImprovAmt" + (j + 1), ds_list2.getColumn( i, "mmImprovAmt" + (j + 1) ) );
		}
	}
	
	//체크박스 부분을 넣는다.
	for( var i = 0 ; i < nRowCnt ; i++ )
	{
		var nIsEmpty = 1;
		var strNumber = "";
		
		for( var j = 0 ; j < 9 ; j++ )
		{
			strNumber = ds_list2.getColumn( i, "mmImprovAmt0" + (j + 1) );
			
			if( true != gfn_isNull( strNumber ) )
			{
				nIsEmpty = 0;
			}
			
		}
		
		for( var j = 9 ; j < 12 ; j++ )
		{
			strNumber = ds_list2.getColumn( i, "mmImprovAmt" + (j + 1) );
			if( true != gfn_isNull( strNumber ) )
			{
				nIsEmpty = 0;
			}
		}
		
		if( nIsEmpty == 0 )
		{
			ds_list.setColumn( i, "chk", "1"  );
		}
		else if( nIsEmpty == 1 )
		{
			ds_list.setColumn( i, "chk", "0"  );
		}
	}
	
}

 /*
 ******************************************************************************************
 * 함  수  명   : btn_save_onclick
 * 입      력   : 
 * 반      환   : 
 * 기      능   : 저장 버튼 클릭 이벤트
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function btn_save_onclick(obj:Button,  e:ClickEventInfo)
{
	ds_listTmp.clearData();

	for( var i = 0 ; i < ds_list.getRowCount(); i++ )
	{
		if( ds_list.getColumn( i, "chk" ) == 1 )
		{
			var idx = ds_listTmp.addRow();
			ds_listTmp.copyRow( idx, ds_list, i );
		}	
	}

	if( ds_listTmp.getRowCount() == 0 )
	{
		alert("선택된 데이타가 없습니다.");
		return;
	}
	
	for( var i = 0 ; i < ds_listTmp.getRowCount() ; i++ )
	{
		ds_listTmp.setColumn( i, "cuser", g_EmpNo);
		ds_listTmp.setColumn( i, "uuser", g_EmpNo);
		ds_listTmp.setColumn( i, "ccCd", ds_search.getColumn( 0, "ccCd") );
	}
	
//////////////////////////////////////////////////////////////////////////////////	
	//영업 이익을 저장 한다. //44000000
	
	//var nIdx = ds_listTmp.addRow();
	
	ds_listSum.clearData();
	ds_listSum.addRow();
	ds_listSum.setColumn(0, "acctCd","41");
	
	ds_listSum.addRow();
	ds_listSum.setColumn(1, "acctCd","42");
	
	ds_listSum.addRow();
	ds_listSum.setColumn(2, "acctCd","43");
	
	
	for( var i = 0 ; i < ds_listTmp.getRowCount() ; i++ )
	{
		var gubun = gfn_subStr( ds_listTmp.getColumn( i, "acctCd" ), 0, 2 );
		if( gubun == "41" ) //상품 매출
		{
			for( var j = 0 ; j < 9 ; j++ )
			{
				var nTmp = ds_listSum.getColumn( 0, "mmImprovAmt0" + (j + 1) );
				var nTmp2 = ds_listTmp.getColumn( i, "mmImprovAmt0" + (j + 1) );
				
				if( !gfn_isNull( nTmp ) )
				{
					nTmp = parseInt(nTmp);
				}
				else
				{
					nTmp = 0;
				}
				
				if( !gfn_isNull( nTmp2 ) )
				{
					nTmp2 = parseInt(nTmp2);
				}
				else
				{
					nTmp2 = 0;
				}
				
				ds_listSum.setColumn( 0, "mmImprovAmt0" + (j + 1), nTmp + nTmp2 ); 
			}
			
			for( var j = 9 ; j < 12 ; j++ )
			{
				var nTmp = ds_listSum.getColumn( 0, "mmImprovAmt" + (j + 1) );
				var nTmp2 = ds_listTmp.getColumn( i, "mmImprovAmt" + (j + 1) );
				
				if( !gfn_isNull( nTmp ) )
				{
					nTmp = parseInt(nTmp);
				}
				else
				{
					nTmp = 0;
				}
				
				if( !gfn_isNull( nTmp2 ) )
				{
					nTmp2 = parseInt(nTmp2);
				}
				else
				{
					nTmp2 = 0;
				}
				
				ds_listSum.setColumn( 0, "mmImprovAmt" + (j + 1), nTmp + nTmp2 ); 
			}
		}
		else if( gubun == "42" )//상품 원가
		{
			for( var j = 0 ; j < 9 ; j++ )
			{
				var nTmp = ds_listSum.getColumn( 1, "mmImprovAmt0" + (j + 1) );
				var nTmp2 = ds_listTmp.getColumn( i, "mmImprovAmt0" + (j + 1) );
				
				if( !gfn_isNull( nTmp ) )
				{
					nTmp = parseInt(nTmp);
				}
				else
				{
					nTmp = 0;
				}
				
				if( !gfn_isNull( nTmp2 ) )
				{
					nTmp2 = parseInt(nTmp2);
				}
				else
				{
					nTmp2 = 0;
				}
				
				ds_listSum.setColumn( 1, "mmImprovAmt0" + (j + 1), nTmp + nTmp2 ); 
			}
			
			for( var j = 9 ; j < 12 ; j++ )
			{
				var nTmp = ds_listSum.getColumn( 1, "mmImprovAmt" + (j + 1) );
				var nTmp2 = ds_listTmp.getColumn( i, "mmImprovAmt" + (j + 1) );
				
				if( !gfn_isNull( nTmp ) )
				{
					nTmp = parseInt(nTmp);
				}
				else
				{
					nTmp = 0;
				}
				
				if( !gfn_isNull( nTmp2 ) )
				{
					nTmp2 = parseInt(nTmp2);
				}
				else
				{
					nTmp2 = 0;
				}
				
				ds_listSum.setColumn( 1, "mmImprovAmt" + (j + 1), nTmp + nTmp2 ); 
			}
		}
		else if( gubun == "43" )//지급 수수료 
		{
			for( var j = 0 ; j < 9 ; j++ )
			{
				var nTmp = ds_listSum.getColumn( 2, "mmImprovAmt0" + (j + 1) );
				var nTmp2 = ds_listTmp.getColumn( i, "mmImprovAmt0" + (j + 1) );
				
				if( !gfn_isNull( nTmp ) )
				{
					nTmp = parseInt(nTmp);
				}
				else
				{
					nTmp = 0;
				}
				
				if( !gfn_isNull( nTmp2 ) )
				{
					nTmp2 = parseInt(nTmp2);
				}
				else
				{
					nTmp2 = 0;
				}
				//trace("1 nTmp >> " + nTmp + " , nTmp2 >>> " + nTmp2);
				
				ds_listSum.setColumn( 2, "mmImprovAmt0" + (j + 1), nTmp + nTmp2 ); 
			}
			
			for( var j = 9 ; j < 12 ; j++ )
			{
				var nTmp = ds_listSum.getColumn( 2, "mmImprovAmt" + (j + 1) );
				var nTmp2 = ds_listTmp.getColumn( i, "mmImprovAmt" + (j + 1) );
				
				if( !gfn_isNull( nTmp ) )
				{
					nTmp = parseInt(nTmp);
				}
				else
				{
					nTmp = 0;
				}
				
				if( !gfn_isNull( nTmp2 ) )
				{
					nTmp2 = parseInt(nTmp2);
				}
				else
				{
					nTmp2 = 0;
				}
				//trace("2 nTmp >> " + nTmp + " , nTmp2 >>> " + nTmp2);
				
				ds_listSum.setColumn( 2, "mmImprovAmt" + (j + 1), nTmp + nTmp2 ); 
			}
		}
	}
	
	
	var nIdx = ds_listTmp.addRow();
	for( var j = 0 ; j < 9 ; j++ )
	{
		var nTmp1 = ds_listSum.getColumn( 0, "mmImprovAmt0" + (j + 1) );
		var nTmp2 = ds_listSum.getColumn( 1, "mmImprovAmt0" + (j + 1) );
		var nTmp3 = ds_listSum.getColumn( 2, "mmImprovAmt0" + (j + 1) );
		
		if( !gfn_isNull( nTmp1 ) )
		{
			nTmp1 = parseInt(nTmp1);
		}
		else
		{
			nTmp1 = 0;
		}
		
		if( !gfn_isNull( nTmp2 ) )
		{
			nTmp2 = parseInt(nTmp2);
		}
		else
		{
			nTmp2 = 0;
		}
		
		if( !gfn_isNull( nTmp3 ) )
		{
			nTmp3 = parseInt(nTmp3);
		}
		else
		{
			nTmp3 = 0;
		}
		
		//trace("3 nTmp1 >> " + nTmp1 + " , nTmp2 >>> " + nTmp2 + " , nTmp3 >>> " + nTmp3);
		if (nTmp1 == 0) {
			ds_listTmp.setColumn( nIdx, "mmImprovAmt0" + (j + 1), ( nTmp2 + nTmp3 )  );
		} else {
			ds_listTmp.setColumn( nIdx, "mmImprovAmt0" + (j + 1), nTmp1 - ( nTmp2 + nTmp3 )  );
		}
	}
			
	for( var j = 9 ; j < 12 ; j++ )
	{
		var nTmp1 = ds_listSum.getColumn( 0, "mmImprovAmt" + (j + 1) );
		var nTmp2 = ds_listSum.getColumn( 1, "mmImprovAmt" + (j + 1) );
		var nTmp3 = ds_listSum.getColumn( 2, "mmImprovAmt" + (j + 1) );
		
		if( !gfn_isNull( nTmp1 ) )
		{
			nTmp1 = parseInt(nTmp1);
		}
		else
		{
			nTmp1 = 0;
		}
		
		if( !gfn_isNull( nTmp2 ) )
		{
			nTmp2 = parseInt(nTmp2);
		}
		else
		{
			nTmp2 = 0;
		}
		
		if( !gfn_isNull( nTmp3 ) )
		{
			nTmp3 = parseInt(nTmp3);
		}
		else
		{
			nTmp3 = 0;
		}
		//trace("4 nTmp1 >> " + nTmp1 + " , nTmp2 >>> " + nTmp2 + " , nTmp3 >>> " + nTmp3);
		
		if (nTmp1 == 0) {
			ds_listTmp.setColumn( nIdx, "mmImprovAmt" + (j + 1), ( nTmp2 + nTmp3 )  );
		} else {
			ds_listTmp.setColumn( nIdx, "mmImprovAmt" + (j + 1), nTmp1 - ( nTmp2 + nTmp3 )  );
		}
	}
	
	//키 값을 넣는다.
	ds_listTmp.setColumn( nIdx, "improvYear", 		ds_search.getColumn( 0, "improvYear" ) );
	ds_listTmp.setColumn( nIdx, "upjang", 			ds_search.getColumn( 0, "upjang" ) );
	ds_listTmp.setColumn( nIdx, "improvMgrp", 		ds_search.getColumn( 0, "improvMgrp" ) );
	ds_listTmp.setColumn( nIdx, "improvMcalss", 	ds_search.getColumn( 0, "improvMcalss" ) );
	ds_listTmp.setColumn( nIdx, "improvSclass", 	ds_search.getColumn( 0, "improvSclass" ) );
	ds_listTmp.setColumn( nIdx, "improvThemeSeq",   ds_search.getColumn( 0, "improvThemeSeq" ) );
	ds_listTmp.setColumn( nIdx, "revSeq", 			ds_search.getColumn( 0, "revSeq" ) );
	ds_listTmp.setColumn( nIdx, "acctCd",     		"44000000" );
	ds_listTmp.setColumn( nIdx, "acctNm",     		"영업이익" );
	ds_listTmp.setColumn( nIdx, "useYn",      		"Y" );
	ds_listTmp.setColumn( nIdx, "ccCd",       		ds_search.getColumn( 0, "ccCd" ) );
	ds_listTmp.setColumn( nIdx, "cuser",       		g_EmpNo );
	ds_listTmp.setColumn( nIdx, "uuser",       		g_EmpNo );
////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////
	
	
	// 저장시 Validation Check	
	if (gfn_validCheck(grd_list, ds_listValid) == false)	return;
	//trace(ds_listTmp.saveXML());
	
	// Transaction 설정
	var strSvcID    = "svcSave";
    var strURL      = "/ma/map/improvtaskmgmt/save4.xdo";
    var strInDs     = "ds_list=ds_listTmp:A";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

]]></Script>
  </Form>
</FDL>

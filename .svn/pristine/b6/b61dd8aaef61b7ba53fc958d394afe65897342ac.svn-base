<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="COMP_GUIDE_13" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="이벤트 Master등록관리(EventMstReg)" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="7" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30" tabstop="false" visible="true"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 93 40" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 93 71" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static22" text="이벤트 목록" class="sta_WF_Title01" position="absolute 0 84 450 102" anchor="left top"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 450 84" anchor="left top"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 97 450 102" anchor="left top"/>
        <Static id="Static18" text="이벤트 등록" class="sta_WF_Title01" position="absolute 346 84 796 102" anchor="left top"/>
        <Static id="Static19" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 485 71 935 84" anchor="left top"/>
        <Static id="Static20" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 485 115 935 120" anchor="left top"/>
        <Static id="Static03" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1160 71 1238 77" anchor="top right"/>
        <Static id="Static10" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 1160 115 1238 120" anchor="top right"/>
        <Button id="btn_insForm" taborder="8" class="btn_WF_GrdPlus" position="absolute 1218 77 1236 97" anchor="top right" onclick="btn_insForm_onclick" visible="false"/>
        <Static id="Static00" text="w10" onclick="Tab00_tabpage_Static07_onclick" class="Guide01_AreaRed" visible="false" position="absolute 337 144 347 711"/>
        <Button id="btn_insMst" taborder="2" class="btn_WF_GrdPlus" position="absolute 296 77 314 97" anchor="default" onclick="btn_insMst_onclick"/>
        <Button id="btn_delMst" taborder="3" class="btn_WF_GrdMinus" position="absolute 316 77 334 97" anchor="default" onclick="btn_delMst_onclick" visible="true"/>
        <Static id="Static28" text="이벤트명" class="sta_WFSA_label" position="absolute 18 40 80 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 76 40 86 61" anchor="left top"/>
        <Edit id="edt_eventNm" taborder="0" position="absolute 85 40 248 61" anchor="left top" onkeydown="edt_eventNm_onkeydown" imemode="hangul"/>
        <Button id="btn_eventNm" taborder="1" tabstop="false" class="btn_WF_popSearch" position="absolute 247 40 268 61" onclick="btn_eventNm_OnClick"/>
        <Div id="div_evnt" taborder="4" position="absolute 347 104 1238 711" style="border:1 solid #53606cff,1 solid #c3c3c3ff,1 solid #c3c3c3ff,1 solid #c3c3c3ff;" anchor="all">
          <Layouts>
            <Layout>
              <Static id="sta_title8" text="이벤트 제목" class="sta_WFDA_Label01" position="absolute -1 55 106 82" anchor="left top" style="align:center middle;"/>
              <Static id="Static00" class="sta_WFDA_Labelbg" position="absolute 105 29 211 56" anchor="left top"/>
              <Static id="Static01" class="sta_WFDA_Labelbg" position="absolute 105 55 889 82" anchor="left top right"/>
              <Edit id="edt_evntTitle" taborder="4" class="edt_WF_Essential" position="absolute 108 58 886 79" anchor="left top right" maxlength="70" onkillfocus="div_evnt_edt_evntTitle_onkillfocus" imemode="hangul"/>
              <Static id="Static03" class="sta_WFDA_Labelbg" position="absolute 105 107 889 238" anchor="left top right"/>
              <Static id="sta_title4" text="분류" class="sta_WFDA_Label01" position="absolute -1 29 106 56" anchor="left top" style="align:center middle;"/>
              <Static id="sta_title5" text="테마" class="sta_WFDA_Label01" position="absolute 210 29 307 56" anchor="left top" style="align:center middle;"/>
              <Static id="sta_title10" text="컨셉 설명" class="sta_WFDA_Label01" position="absolute -1 154 106 238" anchor="left top" style="align:center middle;"/>
              <Combo id="cbo_group" taborder="0" innerdataset="@ds_cboClass" codecolumn="mclassCd" datacolumn="mclassNm" position="absolute 108 32 208 53" anchor="left top" text="FUN" index="-1" class="cmb_WF_Essential" onitemchanged="cbo_group_onitemchanged" readonly="false"/>
              <Static id="sta_title6" text="추천시기" class="sta_WFDA_Label01" position="absolute 435 29 528 56" anchor="top right" style="align:center middle;"/>
              <TextArea id="txa_cnptExpl" taborder="6" scrollbars="fixedvert" position="absolute 108 161 886 237" anchor="left top right" imemode="hangul" maxlength="2000" style="padding:3 3 3 3;"/>
              <Static id="Static06" class="sta_WFDA_Labelbg" position="absolute -1 239 889 420" anchor="all"/>
              <Static id="Static19" class="sta_WFDA_Labelbg" position="absolute 527 29 704 56" anchor="top right"/>
              <Static id="Static20" class="sta_WFDA_Labelbg" position="absolute 306 29 436 56" anchor="left top right"/>
              <Static id="sta_calYymm" text="~" position="absolute 611 31 620 53" anchor="top right"/>
              <Combo id="cbo_theme" taborder="1" innerdataset="@ds_cboTheme" codecolumn="sclassCd" datacolumn="sclassNm" class="cmb_WF_Essential" position="absolute 309 32 433 53" text="DayDay" index="-1" anchor="left top right"/>
              <Static id="Static22" class="sta_WFDA_Labelbg" position="absolute 105 81 889 160" anchor="left top right"/>
              <Static id="sta_title7" text="사용여부" class="sta_WFDA_Label01" position="absolute 703 29 796 56" anchor="top right" style="align:center middle;"/>
              <Static id="sta_title9" text="제공 메뉴" class="sta_WFDA_Label01" position="absolute -1 81 106 160" anchor="left top" style="align:center middle;"/>
              <Edit id="edt_offerMenu" taborder="5" position="absolute 124 -24 902 -3" anchor="left top right" maxlength="500" imemode="hangul"/>
              <Static id="sta_title1" text="담당 결재자명" class="sta_WFDA_Label01" position="absolute -1 1 106 28" anchor="left top" style="align:center middle;"/>
              <Static id="Static30" class="sta_WFDA_Labelbg" position="absolute 306 1 436 28" anchor="left top"/>
              <Static id="Static31" class="sta_WFDA_Labelbg" position="absolute 527 1 889 28" anchor="left top right"/>
              <Static id="sta_title3" text="반려 사유" class="sta_WFDA_Label01" position="absolute 435 1 528 28" anchor="left top" style="align:center middle;"/>
              <Edit id="edt_signStatus" taborder="7" position="absolute 309 124 433 145" anchor="left top" enable="false" visible="false"/>
              <Edit id="edt_rtnReason" taborder="8" enable="false" position="absolute 530 4 886 25" anchor="left top right"/>
              <Static id="Static33" class="sta_WFDA_Labelbg" position="absolute 795 29 889 56" anchor="top right"/>
              <Combo id="cho_use" taborder="2" innerdataset="@ds_cboUseYn" codecolumn="code" datacolumn="codeName" index="-1" class="cmb_WF_Essential" position="absolute 798 32 886 53" anchor="top right"/>
              <Static id="sta_title2" text="결재 상태" class="sta_WFDA_Label01" position="absolute 210 1 307 28" anchor="left top" style="align:center middle;"/>
              <Static id="Static26" class="sta_WFDA_Labelbg" position="absolute 105 1 211 28" anchor="left top"/>
              <ObjCalMonth id="cal_fromYymm" titletext="월력" taborder="9" scrollbars="none" position="absolute 530 32 608 53" anchor="top right"/>
              <ObjCalMonth id="cal_toYymm" titletext="월력" taborder="10" scrollbars="none" position="absolute 623 32 701 53" anchor="top right"/>
              <TextArea id="txa_offerMenu" taborder="3" scrollbars="fixedvert" imemode="hangul" maxlength="1000" position="absolute 108 84 886 158" anchor="left top right" style="padding:3 3 3 3;"/>
            </Layout>
          </Layouts>
        </Div>
        <Grid id="grd_list" taborder="5" binddataset="ds_list" useinputpanel="false" autofittype="col" treeusecheckbox="false" treeinitstatus="expand,all" position="absolute 0 103 334 711" autoenter="none" anchor="left top bottom" treeuseexpandkey="true" treeuseline="true" treeusebutton="use" style="font:Gulim,9;" onheadclick="grd_list_onheadclick" oncelldblclick="grd_list_oncelldblclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="335"/>
              </Columns>
              <Rows>
                <Row size="28" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell/>
                <Cell col="1" style="align: ;" text="이벤트 목록"/>
              </Band>
              <Band id="body">
                <Cell text="bind:lev"/>
                <Cell col="1" displaytype="tree" edittype="expr:fn_eidtCheck(currow,&quot;text&quot;, 'mstList')" style="font:EXPR(lev=='4'?&quot;Gulim,9&quot;:&quot;Gulim,9, bold&quot;);" text="bind:name" editlimit="70" treelevel="bind:lev"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_insProgress" taborder="9" class="btn_WF_GrdPlus" position="absolute 746 353 764 373" anchor="top right" onclick="btn_insProgress_onclick"/>
        <Button id="btn_delProgress" taborder="10" class="btn_WF_GrdMinus" position="absolute 766 353 784 373" anchor="top right" onclick="btn_delProgress_onclick"/>
        <Button id="btn_insUtensil" taborder="11" class="btn_WF_GrdPlus" position="absolute 1197 487 1215 507" anchor="right bottom" onclick="btn_insUtensil_onclick"/>
        <Button id="btn_delUtensil" taborder="12" class="btn_WF_GrdMinus" position="absolute 1217 487 1235 507" anchor="right bottom" onclick="btn_delUtensil_onclick"/>
        <Grid id="grd_utensil" taborder="13" binddataset="ds_utensil" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 347 510 1237 710" anchor="left right bottom" autofittype="col">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="180"/>
                <Column size="200"/>
                <Column size="508"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="기기 / 포장재" taborder="undefined"/>
                <Cell col="1" text="업체정보"/>
                <Cell col="2" text="비고"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" edittype="expr:fn_eidtCheck(currow,&quot;text&quot;, 'form')" style="align:left;" text="bind:utensil" editlimit="70" editdisplay="display" expandshow="hide" combodisplay="edit"/>
                <Cell col="1" displaytype="text" edittype="expr:fn_eidtCheck(currow,&quot;text&quot;, 'form')" text="bind:vendor" editlimit="70" editdisplay="display"/>
                <Cell col="2" displaytype="text" edittype="expr:fn_eidtCheck(currow,&quot;text&quot;, 'form')" style="align:left;" text="bind:remark" editlimit="1500" editdisplay="display" expandshow="hide" combodisplay="edit"/>
              </Band>
            </Format>
          </Formats>
          <Layouts>
            <Layout width="889" height="110"/>
          </Layouts>
        </Grid>
        <Grid id="grd_progress" taborder="14" binddataset="ds_progress" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 347 385 784 483" anchor="all" autofittype="col">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="114"/>
                <Column size="773"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="48"/>
              </Rows>
              <Band id="head">
                <Cell text="진행 절차" taborder="undefined"/>
                <Cell col="1" text="진 행 내 용"/>
              </Band>
              <Band id="body">
                <Cell displaytype="combo" edittype="expr:fn_eidtCheck(currow,&quot;combo&quot;, 'form')" style="align:left;" text="bind:progressPrcdrCd" editdisplay="edit" expandshow="hide" combodataset="ds_cboProgress" combocodecol="code" combodatacol="codeName" combodisplay="display"/>
                <Cell col="1" displaytype="text" edittype="textarea" style="align:left;" text="bind:progressPrcdrContents" editlimit="1000" editscrollbar="autovert" editdisplay="display" expandshow="hide" combodisplay="edit" autosizerow="none" autosizecol="none"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <PersonalSearchComponent id="edt_PersonalSearchComp" anchor="left top" titletext="사원 검색용 Component" taborder="15" position="absolute 456 109 556 130" bindDataset="ds_eventMst" bindSabunColumn="signPrcgSabun" bindNmKorColumn="signPrcgNm" qoMuCd="" qoTmCd="" qoTmNm="" eventAfterTrigger="" eventBeforeTrigger=""/>
        <Edit id="edt_testValue" taborder="16" onkeydown="edt_testValue_onkeydown" position="absolute 852 78 895 96" style="background:transparent;border:1 none #aaaaaaff ;color:transparent;"/>
        <Static id="sta_titleTmp1" text="생성자" class="sta_WFDA_Label01" position="absolute 299 1 357 22" visible="false"/>
        <Edit id="edt_cuser" taborder="17" imemode="hangul" maxlength="70" position="absolute 358 1 438 22" anchor="left top right" visible="false"/>
        <Edit id="edt_cuserNm" taborder="18" imemode="hangul" maxlength="70" position="absolute 439 1 519 22" anchor="left top right" visible="false"/>
        <Static id="sta_titleTmp2" text="로그인" class="sta_WFDA_Label01" position="absolute 539 1 597 22" visible="false"/>
        <Edit id="edt_loginId" taborder="19" imemode="hangul" maxlength="70" position="absolute 598 1 678 22" anchor="left top right" visible="false"/>
        <Edit id="edt_loginNm" taborder="20" imemode="hangul" maxlength="70" position="absolute 679 1 759 22" anchor="left top right" visible="false"/>
        <Grid id="grd_list00" taborder="23" binddataset="ds_list" useinputpanel="false" autofittype="col" treeusecheckbox="false" treeinitstatus="expand,all" treeuseexpandkey="true" oncellclick="grd_list_oncellclick" position="absolute 1280 80 1614 688" anchor="left top bottom" style="font:Gulim,9;" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="335"/>
              </Columns>
              <Rows>
                <Row size="28" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell/>
                <Cell col="1" text="Caption"/>
              </Band>
              <Band id="body">
                <Cell text="bind:lev"/>
                <Cell col="1" displaytype="tree" edittype="expr:fn_eidtCheck(currow,&quot;text&quot;, 'mstList')" style="font:EXPR(lev=='4'?&quot;Gulim,9&quot;:&quot;Gulim,9, bold&quot;);" text="bind:name" editlimit="70" treelevel="bind:lev"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <ObjAtchFile id="grd_AtchFile" anchor="top right bottom" titletext="Attach File Object" taborder="24" text="ObjAtchFile00" scrollbars="none" position="absolute 786 349 1237 483"/>
        <Button id="btn_addSvrFile" taborder="25" text="서버사진" onclick="btn_addSvrFile_onclick" class="btn_WF_Function" position="absolute 971 359 1036 379" anchor="top right"/>
        <Static id="Static26" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 268 40 298 61" anchor="left top"/>
        <Static id="Static01" text="결재상태" class="sta_WFSA_label" position="absolute 298 40 360 61" anchor="left top"/>
        <Static id="Static02" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 356 40 366 61" anchor="left top"/>
        <Combo id="cbo_signStatus" taborder="26" position="absolute 365 40 489 61" anchor="left top"/>
        <Static id="Static09" text="사용여부" class="sta_WFSA_label" position="absolute 519 40 581 61" anchor="left top"/>
        <Static id="Static12" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 577 40 587 61" anchor="left top"/>
        <Combo id="cbo_useYn" taborder="27" position="absolute 586 40 670 61" anchor="left top" innerdataset="@ds_cboUseYn" codecolumn="code" datacolumn="codeName"/>
        <Static id="Static13" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 489 40 519 61" anchor="left top"/>
        <Combo id="cbo_signStatusForm" taborder="28" position="absolute 658 109 781 130" anchor="left top" enable="true"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item0" compid="div_evnt.edt_evntTitle" propid="value" datasetid="ds_eventMst" columnid="evntTitle"/>
      <BindItem id="item1" compid="div_evnt.edt_offerMenu" propid="value" datasetid="ds_eventMst" columnid="offerMenu"/>
      <BindItem id="item2" compid="div_evnt.txa_cnptExpl" propid="value" datasetid="ds_eventMst" columnid="cnptExpl"/>
      <BindItem id="item5" compid="div_evnt.cbo_group" propid="value" datasetid="ds_eventMst" columnid="mclassCd"/>
      <BindItem id="item3" compid="div_evnt.cho_use" propid="value" datasetid="ds_eventMst" columnid="useYn"/>
      <BindItem id="item4" compid="div_evnt.cbo_theme" propid="value" datasetid="ds_eventMst" columnid="sclassCd"/>
      <BindItem id="item6" compid="edt_eventNm" propid="value" datasetid="ds_search" columnid="eventNm"/>
      <BindItem id="item8" compid="div_evnt.edt_signStatus" propid="value" datasetid="ds_eventMst" columnid="signStatusNm"/>
      <BindItem id="item9" compid="div_evnt.edt_rtnReason" propid="value" datasetid="ds_eventMst" columnid="rtnReason"/>
      <BindItem id="item19" compid="edt_cuser" propid="value" datasetid="ds_eventMst" columnid="cuser"/>
      <BindItem id="item20" compid="edt_cuserNm" propid="value" datasetid="ds_eventMst" columnid="cuserNm"/>
      <BindItem id="item7" compid="div_evnt.cal_fromYymm" propid="text" datasetid="ds_eventMst" columnid="propsTermSdate"/>
      <BindItem id="item10" compid="div_evnt.cal_toYymm" propid="text" datasetid="ds_eventMst" columnid="propsTermEdate"/>
      <BindItem id="item11" compid="cbo_signStatus" propid="value" datasetid="ds_search" columnid="signStatus"/>
      <BindItem id="item12" compid="cbo_useYn" propid="value" datasetid="ds_search" columnid="useYn"/>
      <BindItem id="item13" compid="cbo_signStatusForm" propid="value" datasetid="ds_eventMst" columnid="signStatus"/>
      <BindItem id="item14" compid="div_evnt.txa_offerMenu" propid="value" datasetid="ds_eventMst" columnid="offerMenu"/>
    </Bind>
    <Objects>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_list_oncolumnchanged" onrowposchanged="ds_list_onrowposchanged">
        <ColumnInfo>
          <Column id="lev" type="STRING" size="256"/>
          <Column id="code" type="STRING" size="256"/>
          <Column id="seq" type="INT" size="256"/>
          <Column id="name" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="mclassCd" type="STRING" size="256"/>
          <Column id="lclassCd" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="evntId" type="STRING" size="256"/>
          <Column id="signStatus" type="STRING" size="256"/>
          <Column id="cuser" type="STRING" size="256"/>
          <Column id="cuserNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboUseYn" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="1"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboProgress" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="1"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboClass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="mclassCd" type="STRING" size="1"/>
          <Column id="mclassNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboTheme" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="sclassCd" type="STRING" size="1"/>
          <Column id="sclassNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_eventMst" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="lclassCd" type="STRING" size="256"/>
          <Column id="mclassCd" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="fileId" type="STRING" size="256"/>
          <Column id="propsTermSdate" type="STRING" size="256"/>
          <Column id="propsTermEdate" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="evntTitle" type="STRING" size="256"/>
          <Column id="offerMenu" type="STRING" size="256"/>
          <Column id="cnptExpl" type="STRING" size="256"/>
          <Column id="rowType" type="STRING" size="256"/>
          <Column id="signPrcgNm" type="STRING" size="256"/>
          <Column id="signPrcgSabun" type="STRING" size="256"/>
          <Column id="signStatusNm" type="STRING" size="256"/>
          <Column id="signStatus" type="STRING" size="256"/>
          <Column id="rtnReason" type="STRING" size="256"/>
          <Column id="evntId" type="STRING" size="256"/>
          <Column id="cuser" type="STRING" size="256"/>
          <Column id="cuserNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_progress" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_eventMst01_oncolumnchanged">
        <ColumnInfo>
          <Column id="lclassCd" type="STRING" size="256"/>
          <Column id="mclassCd" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="progressPrcdrCd" type="STRING" size="256"/>
          <Column id="progressPrcdrContents" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_utensil" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="lclassCd" type="STRING" size="256"/>
          <Column id="mclassCd" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="utensilId" type="STRING" size="256"/>
          <Column id="utensil" type="STRING" size="256"/>
          <Column id="vendor" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="eventNm" type="STRING" size="256"/>
          <Column id="eventCd" type="STRING" size="256"/>
          <Column id="signStatus" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="mclassCd" type="STRING" size="256"/>
          <Column id="mclassNm" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="sclassNm" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_searchValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="eventNm" type="STRING" size="256"/>
          <Column id="eventCd" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_rowSearch" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="lclassCd" type="STRING" size="256"/>
          <Column id="mclassCd" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="evntId" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">0</Col>
            <Col id="delYn">0</Col>
            <Col id="savYn">1</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">0</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_listValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="lev" type="STRING" size="256"/>
          <Column id="code" type="STRING" size="256"/>
          <Column id="seq" type="INT" size="256"/>
          <Column id="name" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="mclassCd" type="STRING" size="256"/>
          <Column id="lclassCd" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="name">title:Caption,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_eventMstValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_eventMst_oncolumnchanged">
        <ColumnInfo>
          <Column id="lclassCd" type="STRING" size="256"/>
          <Column id="mclassCd" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="fileId" type="STRING" size="256"/>
          <Column id="propsTermSdate" type="STRING" size="256"/>
          <Column id="propsTermEdate" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="evntTitle" type="STRING" size="256"/>
          <Column id="offerMenu" type="STRING" size="256"/>
          <Column id="cnptExpl" type="STRING" size="256"/>
          <Column id="rowType" type="STRING" size="256"/>
          <Column id="signPrcgNm" type="STRING" size="256"/>
          <Column id="signPrcgSabun" type="STRING" size="256"/>
          <Column id="signStatusNm" type="STRING" size="256"/>
          <Column id="signStatus" type="STRING" size="256"/>
          <Column id="rtnReason" type="STRING" size="256"/>
          <Column id="cuser" type="STRING" size="256"/>
          <Column id="cuserNm" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="mclassCd">title:분류,required:true</Col>
            <Col id="sclassCd">title:테마,required:true</Col>
            <Col id="useYn">title:사용여부,required:true</Col>
            <Col id="evntTitle">title:이벤트 제목,required:true</Col>
            <Col id="propsTermSdate">title:추천시기From,comparemin:propsTermEdate:추천시기To</Col>
            <Col id="propsTermEdate">title:추천시기To,comparemax:propsTermSdate:추천시기From</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_progressValid" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_eventMst01_oncolumnchanged">
        <ColumnInfo>
          <Column id="lclassCd" type="STRING" size="256"/>
          <Column id="mclassCd" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="colNum" type="STRING" size="256"/>
          <Column id="progressPrcdrCd" type="STRING" size="256"/>
          <Column id="progressPrcdrContents" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="progressPrcdrContents">title:진행내용,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_utensilValid" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="lclassCd" type="STRING" size="256"/>
          <Column id="mclassCd" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="utensilId" type="STRING" size="256"/>
          <Column id="utensil" type="STRING" size="256"/>
          <Column id="vendor" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="utensil">title:기기/포장재,required:true</Col>
            <Col id="vendor">title:업체정보,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_file" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="refSeq" type="STRING" size="256"/>
          <Column id="appendSeq" type="STRING" size="256"/>
          <Column id="orgnlPath" type="STRING" size="256"/>
          <Column id="orgnlFileNm" type="STRING" size="256"/>
          <Column id="saveFileNm" type="STRING" size="256"/>
          <Column id="relPath" type="STRING" size="256"/>
          <Column id="fileSize" type="STRING" size="256"/>
          <Column id="fileExt" type="STRING" size="256"/>
          <Column id="encYn" type="STRING" size="256"/>
          <Column id="fileDesc" type="STRING" size="256"/>
          <Column id="fileUploadNm" type="STRING" size="256"/>
          <Column id="chk" type="INT" size="1"/>
          <Column id="preView" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : 이벤트 등록
  파 일 명 : EventMstReg.xfdl
  기    능 : 이벤트 Master 자료를 등록한다.

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2014.11.01   김윤기   최초 생성
  2015.05.21   김미경   오류 수정 (저장 권한체크, 결재상태 변경저장: 반려->재신청)
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{
    // Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
    gfn_formOnLoad(this);

    // 초기값 셋팅
    fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
//     // 신청자에 로그인 사용자명을 화면오픈 할 때 넣어서 조회
//     edt_cuserNm.value = g_Name;
//     var strCuserNm = edt_cuserNm.value;
//     ds_search.setColumn(0, "cuserNm", strCuserNm);     //로그인 사용자명
//    //ds_search.setColumn(0, "cuser", g_EmpNo);         //로그인 사용자ID
// 
// 	var strText = "로그인 사용자명=[" + g_EmpNo + "]-[" + g_Name + "], 사업부=[" + g_Mu_Cd + "], 팀=[" + g_Tm_Cd + "], 업장=[" + g_Upjang + "]-[" + g_UpjangNm + "], DeptID=[" + g_Deptid + "]";
 	//trace("EventMstReg 화면 >> fn_init : " + strText);

	edt_loginId.value = g_EmpNo;  //로그인 사용자ID
	edt_loginNm.value = g_Name;   //로그인 사용자명
	//edt_testValue.value = "";   //테스트 확인용

	var nRow= ds_search.addRow();
    
    // 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
//  v_ds_check = "ds_list";
	SCCombo.bind(this, "ComCode", "cbo_signStatus", "", {groupCode:"EVENT_SIGN_STATUS", useYn:"Y", defVal:"002"}, SCCombo.ALL);
	SCCombo.bind(this, "ComCode", "cbo_signStatusForm", "", {groupCode:"EVENT_SIGN_STATUS", useYn:"Y"});
    SCCombo.bind(this, "ComCode", "div_evnt.cho_use", ds_cboUseYn, {groupCode:"USE_YN", useYn:"Y", defVal:"Y"}, SCCombo.ALL);  //사용여부코드 (TABLE : SCC_COMMON_CODE)
    SCCombo.bind(this, "ComCode", "grd_progress.progressPrcdrCd", ds_cboProgress, {groupCode:"FS0026", useYn:"Y"});  //진행절차
    //div_evnt.cbo_theme.enable = true;    //테마

    // 조회조건을 초기화한다.
    ds_search.setColumn(nRow, "eventNm", "");  //이벤트
    ds_search.setColumn(nRow, "eventCd", "");
    ds_search.setColumn(nRow, "seq", "");
    ds_search.setColumn(nRow, "signStatus", "002");
    ds_search.setColumn(nRow, "useYn", "Y");


    // 추천시기 YYYY-MM 으로 표시
    div_evnt.cal_fromYymm.fn_initMonthCal(this, gfn_subStr(fv_sToday, 0, 6), "", ds_eventMst, "propsTermSdate", "");
    div_evnt.cal_toYymm.fn_initMonthCal(this, gfn_subStr(fv_sToday, 0, 6), "", ds_eventMst, "propsTermEdate", "");

    var nRowSearch = ds_rowSearch.addRow();


    // 첨부파일 연결
    grd_AtchFile.setDataset("ds_file");

    //fn_search();

    fn_selectLevel1();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{
//  // v_ds_check 미사용시 변경사항 체크(입력 프로그램일때 변경되는 Dataset 전체 기술)
//  if (gfn_dsIsUpdated(ds_list) == true)
//  {
//      // 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
//         if (!gfn_confirm("confirm.before.movepage")) return false;
//     }
//
//  // 조회프로그램에도 Return true; 기술해 주세요!
//  return true;

    
    //-- 첨부파일 추가 후
    // v_ds_check 미사용시 변경사항 체크
    if (gfn_dsIsUpdated(ds_eventMst) == true || gfn_dsIsUpdated(ds_progress) == true || gfn_dsIsUpdated(ds_utensil) == true || gfn_dsIsUpdated(ds_file) == true)
    {
        // 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
        if (!gfn_confirm("confirm.before.movepage")) return false;
    }


//     //-- 첨부파일 추가 전
//     // v_ds_check 사용시 변경사항 체크
//     if(gfn_length(v_ds_check) == 0)
//     {
//         // v_ds_check 설정기준 변경사항 체크
//         if (gfn_isDataChange() == true)
//         {
//             // 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
//             if (!gfn_confirm("confirm.before.movepage")) return false;
//         }
//     }

    // 조회프로그램에도 Return true; 기술해 주세요!
    return true;
}

/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
     // v_ds_check 미사용시 변경사항 체크
//  if (gfn_dsIsUpdated(ds_list) == true)
//  {
//      var retValue = gfn_confirm("confirm.before.search");    // 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
//      if (retValue == false) return;
//  }

//  // v_ds_check 사용시 공통버튼에서 변경사항 체크함
//  // 변경사항 체크
//  if (gfn_isDataChange() == true)
//  {
//      var retValue = gfn_confirm("confirm.before.search");    // 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
//      if (retValue == false) return;
//  }

    // ds_listValid Dataset에 Validation할 칼럼별로 구성
    // 항목 추가시에는 ', '로 구분
    // 예)title:금액1,required:false,minlength:2, digits:true

    // Alert시 칼럼 표시 명칭               - title:아이디(메시지의 치환할 명칭)
    // 필수체크                              - required:true(체크여부 true/false)
    // size 크기                              - length:7(size 숫자)
    // 최대 size 크기                        - maxlength:7(size 숫자)
    // 최소 size 크기                        - minlength:7(size 숫자)
    // 최대 size 크기(Byte)                  - maxlengthB:7(size 숫자)
    // 최소 size 크기(Byte)                  - minlengthB:7(size 숫자)
    // 숫자 여부                             - digits:true(체크여부 true/false)
    // 해당 숫자 이하                       - min:7(size 숫자)
    // 해당 숫자 이상                       - max:7(size 숫자)
    // 소숫점 자리수 비교                   - declimit:3(size 숫자)
    // 날짜 년월일 체크                     - date:true(체크여부 true/false)
    // 날짜 년월 체크                       - dateym:true(체크여부 true/false)
    // 타 칼럼값보다 큰지 비교             - comparemax:Column4(Dataset 칼럼ID):시작일(비교대상의 메시지 치환할 명칭)
    // 타 칼럼값보다 작은지 비교           - comparemin:Column6(Dataset 칼럼ID):종료일(비교대상의 메시지 치환할 명칭)
    // 타 칼럼값과 같은 값인지 비교        - equalto:Column5(Dataset 칼럼ID):금액1(비교대상의 메시지 치환할 명칭)
    // 사이의 값인지 비교                   - range:40(from 숫자):100(to 숫자)
    // 코드값이 목록내의 값인지 비교       - code:1(목록 숫자):2(목록 숫자):3(목록 숫자)
    // 이메일 여부 체크(함수 체크시 예제)  - isEmail:true(체크여부 true/false)

    // 오류시 focus 지정                      - focus:cal_toDate(Componet ID로 form에서부터의 경로)

    // 조회시 Validation Check
    //if (gfn_validCheck(ds_search, ds_searchValid, true) == false) return;

    // Grid sort 표시 초기화(필수)
//    gfn_clearSortMark(ds_list);

   if( fn_updateCheck("mstList") == false){
        return ;
    }

    var strSvcID    = "EventList";
    var strURL      = "fs/fse/eventMstReg/selectEventList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_list=dsEventOutput ds_cboClass=dsCboOutput ds_cboTheme=dsThemeOutput";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = false;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

//트리 셀 클릭시 이벤트화면 조회
function fn_fromSearch(){

    if( fn_updateCheck("form") == false){
        return ;
    }

    if( ds_rowSearch.getColumn(0, "seq") == ""){
        return ;
    }

    var strSvcID    = "CellClick";
    var strURL      = "fs/fse/eventMstReg/selectList.xdo";
    var strInDs     = "ds_search=ds_rowSearch";
    var strOutDs    = "ds_eventMst=dsSelectOutput ds_progress=dsSelectProgressOutput ds_cboTheme=dsThemeOutput ds_utensil=dsUtensil ds_file=dsFile";
  //var strOutDs    = "ds_eventMst=dsSelectOutput ds_progress=dsSelectProgressOutput ds_cboTheme=dsThemeOutput ds_utensil=dsUtensil";  //첨부파일 추가 전
  //var strOutDs    = "ds_eventReq=dsEventReq ds_progress=dsProgress ds_inforeg=dsInforeg ds_utensil=dsUtensil  ds_file=dsFile ds_cboTheme=dsThemeOutput";   //진행정보등록
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = false;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert(gubun)
{
    if( gubun == "form") {

        if( ds_eventMst.getColumn(0, "signStatus") == "002"){
            gfn_alert("결재가 승인된 자료입니다. 추가가 불가능합니다.");  // 추가가 불가능합니다
            return ;
        }

//      if( fn_updateCheck("mstList") == false){
//          return ;
//      }

		//-- ds_eventMst_oncolumnchanged
        ds_eventMst.setColumn(0, "lclassCd", ds_list.getColumn(ds_list.rowposition, "lclassCd"));
        ds_eventMst.setColumn(0, "mclassCd", ds_list.getColumn(ds_list.rowposition, "mclassCd"));
        ds_eventMst.setColumn(0, "sclassCd", ds_list.getColumn(ds_list.rowposition, "sclassCd"));
        ds_eventMst.setColumn(0, "seq", "");
        ds_eventMst.setColumn(0, "fileId", "");
        ds_eventMst.setColumn(0, "propsTermSdate", gfn_subStr(fv_sToday, 0, 6));
        ds_eventMst.setColumn(0, "propsTermEdate", gfn_subStr(fv_sToday, 0, 6));
        ds_eventMst.setColumn(0, "useYn", "Y");
        ds_eventMst.setColumn(0, "evntTitle", "");
        ds_eventMst.setColumn(0, "offerMenu", "");
        ds_eventMst.setColumn(0, "cnptExpl", "");

        ds_eventMst.setColumn(0, "signPrcgNm", "");
        ds_eventMst.setColumn(0, "signPrcgSabun", "");
        ds_eventMst.setColumn(0, "signStatusNm", "");
        ds_eventMst.setColumn(0, "signStatus", "");
        ds_eventMst.setColumn(0, "rtnReason", "");

        ds_eventMst.setColumn(0, "rowType", "I");

        ds_progress.clearData();
        ds_utensil.clearData();
        ds_file.clearData();     // 첨부파일
        
    } else if ( gubun == "mstList") {
//      if( fn_updateCheck("form") == false){
//          return ;
//      }

        if(ds_list.getColumn(ds_list.rowposition, "lev") == 4) {
            gfn_alert(" 더 이상의 하위데이터 생성은 불가합니다. ");
            return;
        } else {
            if(ds_list.getRowType(ds_list.rowposition) == 2) {
                gfn_alert("상위코드를 등록해야 하위코드 생성이 가능합니다.");
                return;
            } else {
                ds_eventMst.clearData();
                ds_file.clearData();     // 첨부파일
                var nRow = ds_list.insertRow(ds_list.rowposition + 1);
                ds_list.setColumn(nRow, "lev", ds_list.getColumn(nRow-1, "lev") + 1);
                ds_list.setColumn(nRow, "muCd", ds_list.getColumn(nRow-1, "muCd"));
                ds_list.setColumn(nRow, "lclassCd", ds_list.getColumn(nRow-1, "lclassCd"));
                ds_list.setColumn(nRow, "mclassCd", ds_list.getColumn(nRow-1, "mclassCd"));
                ds_list.setColumn(nRow, "sclassCd", ds_list.getColumn(nRow-1, "sclassCd"));

                if(ds_list.getColumn(nRow-1, "lev") + 1 == 4) {
                    var mRow = ds_eventMst.addRow();
                    ds_eventMst.setColumn(mRow, "lclassCd", ds_list.getColumn(nRow-1, "lclassCd"));
                    ds_eventMst.setColumn(mRow, "mclassCd", ds_list.getColumn(nRow-1, "mclassCd"));
                    ds_eventMst.setColumn(mRow, "sclassCd", ds_list.getColumn(nRow-1, "sclassCd"));
                    ds_eventMst.setColumn(mRow, "seq", "");
					ds_eventMst.setColumn(mRow, "fileId", "");
                    ds_eventMst.setColumn(mRow, "propsTermSdate", gfn_subStr(fv_sToday, 0, 6));
                    ds_eventMst.setColumn(mRow, "propsTermEdate", gfn_subStr(fv_sToday, 0, 6));
                    ds_eventMst.setColumn(mRow, "useYn", "Y");
                    ds_eventMst.setColumn(mRow, "evntTitle", "");
                    ds_eventMst.setColumn(mRow, "offerMenu", "");
                    ds_eventMst.setColumn(mRow, "cnptExpl", "");

                    ds_eventMst.setColumn(mRow, "signPrcgNm", "염수정");
                    ds_eventMst.setColumn(mRow, "signPrcgSabun", "200200418");
                    ds_eventMst.setColumn(mRow, "signStatusNm", "");
                    ds_eventMst.setColumn(mRow, "signStatus", "001");
                    ds_eventMst.setColumn(mRow, "rtnReason", "");
                    ds_eventMst.setColumn(mRow, "cuser", g_EmpNo);   //생성자ID
                    ds_eventMst.setColumn(mRow, "cuserNm", g_Name);  //생성자명

                    ds_eventMst.setColumn(mRow, "rowType", "I");

                    cbo_group_onitemchanged();
                    //fn_eidtFormCheck();
                }
            }
        }

    } else if( gubun == "progress" ) {
        if( ds_eventMst.getColumn(0, "signStatus") == "002"){
            gfn_alert("결재가 승인된 자료입니다. 추가가 불가능합니다.");  // 추가가 불가능합니다
            return ;
        }

//      if( fn_updateCheck("mstList") == false){
//          return ;
//      }

        var addRwoNum = ds_progress.addRow();

        ds_progress.setColumn(addRwoNum, "lclassCd", ds_eventMst.getColumn(0, "lclassCd"));
        ds_progress.setColumn(addRwoNum, "mclassCd", ds_eventMst.getColumn(0, "mclassCd"));
        ds_progress.setColumn(addRwoNum, "sclassCd", ds_eventMst.getColumn(0, "sclassCd"));
        ds_progress.setColumn(addRwoNum, "seq", !gfn_isNull(ds_eventMst.getColumn(0, "seq")) ? ds_eventMst.getColumn(0, "seq") : "");
        ds_progress.setColumn(addRwoNum, "progressPrcdrCd", "001");

    } else if( gubun == "utensil" ){
        if( ds_eventMst.getColumn(0, "signStatus") == "002"){
            gfn_alert("결재가 승인된 자료입니다. 추가가 불가능합니다.");  // 추가가 불가능합니다
            return ;
        }

//      if( fn_updateCheck("mstList") == false){
//          return ;
//      }

        var addRwoNum =  ds_utensil.addRow();

        ds_utensil.setColumn(addRwoNum, "lclassCd", ds_eventMst.getColumn(0, "lclassCd"));
        ds_utensil.setColumn(addRwoNum, "mclassCd", ds_eventMst.getColumn(0, "mclassCd"));
        ds_utensil.setColumn(addRwoNum, "sclassCd", ds_eventMst.getColumn(0, "sclassCd"));
        ds_utensil.setColumn(addRwoNum, "seq", !gfn_isNull(ds_eventMst.getColumn(0, "seq")) ? ds_eventMst.getColumn(0, "seq") : "");
        ds_utensil.setColumn(addRwoNum, "remark", "");
    }
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete(gubun)
{
    if( gubun == "form") {

        if( ds_eventMst.getColumn(0, "signStatus") == "002"){
            gfn_alert("결재가 승인된 자료입니다. 삭제가 불가능합니다.");  // 삭제가 불가능합니다.
            return ;
        }

//      if( fn_updateCheck("mstList") == false){
//          return ;
//      }

        var rtVal = gfn_confirm("confirm.before.delete");   // 선택된 자료를 삭제 하시겠습니까?
        if (rtVal == true) {
            ds_eventMst.deleteRow(0);
        }
    } else if ( gubun == "mstList"){

        var nRow = ds_list.rowposition;

        if( ds_list.getColumn(nRow, "signStatus") == "002"){
            gfn_alert("결재가 승인된 자료입니다. 삭제가 불가능합니다.");  // 삭제가 불가능합니다.
            return ;
        }

//      if( fn_updateCheck("form") == false){
//          return ;
//      }

        if(nRow == -1) {
            gfn_alert("msg.err.grid.noselect", "삭제할 row");   // 선택된 항목이 없습니다.
            return;
        }

        //하위 메뉴 존재시 삭제 못하도록 설정 해야 함.
        var nMclassCd = ds_list.getColumn(nRow, "mclassCd");
        var nSclassCd = ds_list.getColumn(nRow, "sclassCd");

        if( ds_list.getColumn(nRow, "lev") == "3" ){

            var nCurRow = ds_list.findRowExpr("mclassCd == '" + nMclassCd + "' && sclassCd == '" + nSclassCd + "' && seq != '0'" );

            if( nCurRow > 0 ){
                gfn_alert("하위 메뉴가 존재합니다.");   // 하위 메뉴가 존재합니다.
                return;
            }

        } else if( ds_list.getColumn(nRow, "lev") == "2" ){

            var nCurRow = ds_list.findRowExpr("mclassCd == '" + nMclassCd + "' && sclassCd != ''" );

            if( nCurRow > 0 ){
                gfn_alert("하위 메뉴가 존재합니다.");   // 하위 메뉴가 존재합니다.
                return;
            }
        } else if( ds_list.getColumn(nRow, "lev") == "1" ){
            gfn_alert("삭제가 불가능한 레벨입니다.");   // 하위 메뉴가 존재합니다.
            return;
        }

        if(ds_list.getRowType(nRow) == 2){
            ds_list.deleteRow(nRow);
        } else {
            var rtVal = gfn_confirm("confirm.before.delete");   // 선택된 자료를 삭제 하시겠습니까?
            if (rtVal == true) {
                ds_list.deleteRow(nRow);
            }
        }

    } else if( gubun == "progress" ){

        if( ds_eventMst.getColumn(0, "signStatus") == "002"){
                gfn_alert("결재가 승인된 자료입니다. 삭제가 불가능합니다.");  // 삭제가 불가능합니다.
                return ;
        }

//      if( fn_updateCheck("mstList") == false){
//          return ;
//      }

        var nRow = ds_progress.rowposition;

        if(nRow == -1)
        {
            gfn_alert("msg.err.grid.noselect", "삭제할 row");   // 선택된 항목이 없습니다.
            return;
        }

        ds_progress.deleteRow(nRow);
    } else if( gubun == "utensil" ){

        if( ds_eventMst.getColumn(0, "signStatus") == "002"){
            gfn_alert("결재가 승인된 자료입니다. 삭제가 불가능합니다.");  // 삭제가 불가능합니다.
            return ;
        }

//      if( fn_updateCheck("mstList") == false){
//          return ;
//      }

        var nRow = ds_utensil.rowposition;
        if(nRow == -1)
        {
            gfn_alert("msg.err.grid.noselect", "삭제할 row");   // 선택된 항목이 없습니다.
            return;
        }

        ds_utensil.deleteRow(nRow);
    //전체삭제 승인이 아닌건에 대해서는 삭제하자
    } else {
        if (ds_eventMst.rowcount > 0){
            if (!gfn_isNull(ds_eventMst.getColumn(0,"signStatus")) && ds_eventMst.getColumn(0,"signStatus") != "002"){
				var strSvcID    = "delete";
				var strURL      = "fs/fse/eventMstReg/deleteList.xdo";
				var strInDs     = "ds_eventMst=ds_eventMst:A ds_search=ds_search:A";
				var strOutDs    = "ds_list=dsEventOutput";
				var strArg      = "";
				var strCallback = "fn_callBack";
				var bAsync      = true;

				gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
            } else if (gfn_isNull(ds_eventMst.getColumn(0,"lclassCd"))){
                alert("등록되지 않은 이벤트입니다");
                return;
            } else if (ds_eventMst.getColumn(0,"signStatus") == "002"){
                alert("승인 처리된 이벤트입니다.");
                return;
            }
        }
    }
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
//  // v_ds_check 미사용시 변경사항 체크
//  if (gfn_dsIsUpdated(ds_list) == false)
//  {
//      gfn_alert("msg.save.nochange"); // 변경된 내역이 없습니다.
//      return;
//  }

//  // v_ds_check 사용시 변경사항 체크
//  if (gfn_isDataChange() == true)
//  {
//      gfn_alert("msg.save.nochange"); // 변경된 내역이 없습니다.
//      return;
//  }

    // ds_listValid Dataset에 Validation할 칼럼별로 구성
    // 항목 추가시에는 ", "로 구분
    // 예)title:금액1,required:false,minlength:2, digits:true

    // Alert시 칼럼 표시 명칭               - title:아이디(메시지의 치환할 명칭)
    // 필수체크                              - required:true(체크여부 true/false)
    // size 크기                              - length:7(size 숫자)
    // 최대 size 크기                        - maxlength:7(size 숫자)
    // 최소 size 크기                        - minlength:7(size 숫자)
    // 최대 size 크기(Byte)                  - maxlengthB:7(size 숫자)
    // 최소 size 크기(Byte)                  - minlengthB:7(size 숫자)
    // 숫자 여부                             - digits:true(체크여부 true/false)
    // 해당 숫자 이하                       - min:7(size 숫자)
    // 해당 숫자 이상                       - max:7(size 숫자)
    // 소숫점 자리수 비교                   - declimit:3(size 숫자)
    // 날짜 년월일 체크                     - date:true(체크여부 true/false)
    // 날짜 년월 체크                       - dateym:true(체크여부 true/false)
    // 타 칼럼값보다 큰지 비교             - comparemax:Column4(Dataset 칼럼ID):시작일(비교대상의 메시지 치환할 명칭)
    // 타 칼럼값보다 작은지 비교           - comparemin:Column6(Dataset 칼럼ID):종료일(비교대상의 메시지 치환할 명칭)
    // 타 칼럼값과 같은 값인지 비교        - equalto:Column5(Dataset 칼럼ID):금액1(비교대상의 메시지 치환할 명칭)
    // 사이의 값인지 비교                   - range:40(from 숫자):100(to 숫자)
    // 코드값이 목록내의 값인지 비교       - code:1(목록 숫자):2(목록 숫자):3(목록 숫자)
    // 이메일 여부 체크(함수 체크시 예제)  - isEmail:true(체크여부 true/false)

    // 오류시 focus 지정                      - focus:cal_toDate(Componet ID로 form에서부터의 경로)


    //-- 첨부파일 추가 후
    // v_ds_check 미사용시 변경사항 체크
    if (gfn_dsIsUpdated(ds_list) == false && gfn_dsIsUpdated(ds_eventMst) == false && gfn_dsIsUpdated(ds_progress) == false && gfn_dsIsUpdated(ds_utensil) == false && gfn_dsIsUpdated(ds_file) == false)
    {
        gfn_alert("msg.save.nochange"); // 변경된 내역이 없습니다.
        return;
    }
    
    
    // 저장시 Validation Check
    if (gfn_validCheck(ds_list, ds_listValid) == false) return;
    if (gfn_validCheck(ds_eventMst, ds_eventMstValid) == false) return;
    if (gfn_validCheck(ds_progress, ds_progressValid) == false) return;
    if (gfn_validCheck(ds_utensil, ds_utensilValid) == false)   return;
    

// 	// 결재상태가 승인인 경우는 저장되지 않도록 함
 	var strSignStatus = ds_eventMst.getColumn(0, "signStatus");
 	var strSignStatusNm = ds_eventMst.getColumn(0, "signStatusNm");
// 	trace("EventMstReg 화면 >> fn_save : 저장전 결재상태=[" + strSignStatus + "]-[" + strSignStatusNm + "]");
// 	
// 	if (ds_eventMst.getColumn(0, "signStatus") == "002"){
// 		gfn_alert("결재가 승인된 자료입니다. 저장이 불가능합니다.");  // 저장이 불가능합니다.
// 		return ;
// 	}
// 	
// 	
	// 생성자와 로그인사용자가 같은 경우에만 저장되도록 함
	var strCuser = edt_cuser.value;
	var strCuserNm = edt_cuserNm.value;
	//trace("EventMstReg 화면 >> fn_save : 이벤트 생성자=[" + strCuser + "]-[" + strCuserNm + "], 로그인 사용자=[" + g_EmpNo + "]-[" + g_Name + "]");

	if(strCuser != null && strCuser != "" && strCuser != undefined){
		if (strCuser != g_EmpNo){
			//var strEditEvntTitle = div_evnt.edt_evntTitle.value;
			//var strMstEvntTitle  = ds_eventMst.getColumn(0, "evntTitle");
			var strListEvntTitle = ds_list.getColumn(ds_list.rowposition, "name");
			var strOrgEvntTitle  = ds_list.getOrgColumn(ds_list.rowposition, "name");
			var nRow             = ds_list.rowposition + 1;
			//trace("EventMstReg 화면 >> fn_save : 저장권한 없음..[이벤트제목 ds_eventMst]=[" + strMstEvntTitle + "]-[" + strEditEvntTitle + "]");
			//trace("EventMstReg 화면 >> fn_save : 저장권한 없음..[이벤트제목 ds_list]=[" + nRow + " 행][" + strListEvntTitle + "]->[" + strOrgEvntTitle + "]");
			ds_list.setColumn(ds_list.rowposition, "name", ds_list.getOrgColumn(ds_list.rowposition, "name"));
			
			gfn_alert("저장할 권한이 없습니다.  등록자=[" + strCuserNm + "]");  // 저장할 권한이 없습니다.
			return ;
		}
	}
	
	
	// 결재상태가 반려인 경우는 재신청으로 저장되도록 함
	//var strSignStatus = ds_eventMst.getColumn(0, "signStatus");
	//var strSignStatusNm = ds_eventMst.getColumn(0, "signStatusNm");
	//trace("EventMstReg 화면 >> fn_save : 결재상태=[" + strSignStatus + "]-[" + strSignStatusNm + "]");
	
	if (strSignStatus == "003"){
		ds_eventMst.setColumn(0, "signStatus", "004");
		ds_eventMst.setColumn(0, "signStatusNm", "재신청");
// 		trace("EventMstReg 화면 >> fn_save : 결재상태가 반려인 경우 >> 004-재신청으로 저장..");
	}
    
    
    
    // 진행절차가 D-DAY 인 경우 체크 - 체크 안함으로 수정 요청 (윤혜선차장님)
//     for( var i = 0 ; i <=  ds_progress.getRowCount(); i++ ){
//         if( "001" == ds_progress.getColumn(i, "progressPrcdrCd") ){
//             gfn_alert("진행절차를 선택해주세요");
//             ds_progress.rowposition = i;
//             return ;
//         }
//     }

	var nRowCnt = ds_progress.getRowCount();
	var nDupCnt = 0, nRow = 0;
	var strPrcdrCd = "", strCd = "";
	var strPrcdrContents ="", strContents = "";
	var chkDup  = false;

    // 진행절차 코드가 2개이상(중복)인 경우 체크
    for (var i = 0 ; i < nRowCnt; i++){
		nDupCnt = 0;
		chkDup  = false;
		strCd = ds_progress.getColumn(i, "progressPrcdrCd");
		strContents = ds_progress.getColumn(i, "progressPrcdrContents");
		//trace("EventMstReg화면 >> fn_save : 기준 진행절차code=[" + strCd + "], 진행내용=[" + strContents + "]");

		for (var j = 0 ; j < nRowCnt; j++){
			strPrcdrCd = ds_progress.getColumn(j, "progressPrcdrCd");
			strPrcdrContents = ds_progress.getColumn(j, "progressPrcdrContents");
			//trace("EventMstReg화면 >> fn_save : 비교 진행절차code=[" + strPrcdrCd + "], 진행내용=[" + strPrcdrContents + "]");
			
			if (strCd == strPrcdrCd){
				nDupCnt++;
				//trace("EventMstReg화면 >> fn_save : i=[" + i + "], j=[" + j + "], 진행절차code=[" + strCd + "], nDupCnt=[" + nDupCnt + "]");

				if (nDupCnt > 1){
					nRow = i;
					chkDup  = true;
					break;
				}
			}
        }
		if (chkDup) break;
    }
	
	// 진행절차 코드가 중복된 데이타인 경우
	if (chkDup){			
		//trace("EventMstReg화면 >> fn_save : 중복된 진행절차code=[" + strCd + "], 진행내용=[" + strContents + "], nRow=[" + nRow + "], nDupCnt=[" + nDupCnt + "], chkDup=[" + chkDup + "]");
		gfn_alert("진행절차가 중복 되었습니다. 다시 선택해주세요.");
		ds_progress.rowposition = nRow;
		return ;
	}
	
	
	//var strSignPrcgNm = ds_eventMst.getColumn(0, "signPrcgNm");
	//trace("EventMstReg화면 >> fn_save : 결재자명=[" + strSignPrcgNm + "]");
	
	// 담당 결재자 지정 안된 경우 체크
	if( "" == ds_eventMst.getColumn(0, "signPrcgNm") ){
		gfn_alert("담당 결재자를 지정해주세요.");   
		edt_PersonalSearchComp.setFocus;
		return ;
	}



	//---------- 첨부파일 추가 START
    // 첨부 파일 추가가 있을때만
    if(grd_AtchFile.fn_countDs("insert") > 0) {
        var rtn = fn_uploadFile();
        if (rtn < 0)    return;
    }
    
// //     trace("ds_file.saveXML()----------");
// //     for(var i=0; i<ds_file.rowcount; i++) {
// // 		" ("+i+") ====>> "+trace(ds_file.getRowType(i));
// //     }
//   //  return;

//     var strSvcID    = "save";
//     var strURL      = "fs/fse/eventProcessInfoMgnt/saveList.xdo";
//     var strInDs     = "ds_form=ds_eventReq:A ds_progress=ds_progress:U ds_inforeg=ds_inforeg:U ds_utensil=ds_utensil:U ds_file=ds_file:A";
//     var strOutDs    = "ds_list=dsEventOutput ";
//     var strArg      = "";
//     var strCallback = "fn_callBack";
//     var bAsync      = true;
// 
//     gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	//---------- 첨부파일 추가 END

	//trace(ds_file.saveXML());
	//return;
    
    var strSvcID    = "save";
    var strURL      = "fs/fse/eventMstReg/saveList.xdo";
    var strInDs     = "ds_list=ds_list:U ds_form=ds_eventMst:A ds_progress=ds_progress:U ds_search=ds_search:A ds_utensil=ds_utensil:U ds_file=ds_file:A";
  //var strInDs     = "ds_list=ds_list:U ds_form=ds_eventMst:A ds_progress=ds_progress:U ds_search=ds_search:A ds_utensil=ds_utensil:U";  //첨부파일 추가 전
    var strOutDs    = "ds_list=dsEventOutput ";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
    // 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
    if (nErrorCode < 0)
    {
        return;
    }

    switch(strSvcID)
    {
        // 코드분류 조회
        case "EventList" :
//             trace("ds_list.saveXML()-------------");
//             trace(ds_list.saveXML());
//             trace("ds_eventMst.saveXML()-------------");
//             trace(ds_eventMst.saveXML());
//             trace("-------------");
            var nRow = ds_list.findRowExpr("seq != ''");

            if(nRow > 0) {
                ds_rowSearch.setColumn(0, "lclassCd", ds_list.getColumn(nRow, "lclassCd"));
                ds_rowSearch.setColumn(0, "mclassCd", ds_list.getColumn(nRow, "mclassCd"));
                ds_rowSearch.setColumn(0, "sclassCd", ds_list.getColumn(nRow, "sclassCd"));
                ds_rowSearch.setColumn(0, "seq", ds_list.getColumn(nRow, "seq"));
                ds_list.rowposition = nRow;

                fn_fromSearch();
            }

            break;

        // 저장
        case "save" :
            gfn_alert("msg.save.success");  // 저장 되었습니다.


            if( "I" == ds_eventMst.getColumn(0, "rowType") ){
                var nMclassCd  = ds_eventMst.getColumn(0, "mclassCd");
                var nSclassCd  = ds_eventMst.getColumn(0, "sclassCd");
                var nEvntTitle = ds_eventMst.getColumn(0, "evntTitle");

                var nRow = ds_list.findRowExpr("mclassCd == '" + nMclassCd + "' && sclassCd == '" + nSclassCd + "' && name == '" + nEvntTitle + "'" );

                ds_rowSearch.setColumn(0, "lclassCd", ds_list.getColumn(nRow, "lclassCd"));
                ds_rowSearch.setColumn(0, "mclassCd", ds_list.getColumn(nRow, "mclassCd"));
                ds_rowSearch.setColumn(0, "sclassCd", ds_list.getColumn(nRow, "sclassCd"));
                ds_rowSearch.setColumn(0, "seq", ds_list.getColumn(nRow, "seq"));
                ds_list.rowposition = nRow;
            } else {
                var seq = ds_rowSearch.getColumn(0, "seq");

                var nRow = ds_list.findRowExpr("seq == '" + seq + "'" );
                ds_list.rowposition = nRow;
            }

            if ( nRow > 0 ){
                fn_fromSearch();
            } else {
                var nRow = ds_list.findRowExpr("seq != ''");

                if (nRow > 0){
                    ds_rowSearch.setColumn(0, "lclassCd", ds_list.getColumn(nRow, "lclassCd"));
                    ds_rowSearch.setColumn(0, "mclassCd", ds_list.getColumn(nRow, "mclassCd"));
                    ds_rowSearch.setColumn(0, "sclassCd", ds_list.getColumn(nRow, "sclassCd"));
                    ds_rowSearch.setColumn(0, "seq", ds_list.getColumn(nRow, "seq"));
                    ds_list.rowposition = nRow;

                    fn_fromSearch();
                }
            }

            break;
          // 삭제
        case "delete" :
            gfn_alert("msg.save.success");  // 저장 되었습니다.
            break;
            
        case "CellClick" :
            //fn_eidtFormCheck();
            break;
    }
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/

/*-----------------------------------------------------------------------
 * 설명    : 이벤트 목록 클릭
 *-----------------------------------------------------------------------*/
function grd_list_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	if(e.clickitem == "image" || e.clickitem == "treebutton") return;

	var nRow        = obj.getTreeRow(e.row);
	var nCurRow     = grd_list.currentrow;
	var nRowType    = ds_list.getRowType(grd_list.currentrow);
	var strLev      = ds_list.getColumn(e.row, "lev");
	var strName     = ds_list.getColumn(e.row, "name");

	var strMsg = "선택 이벤트목록, nCurRow=[" + nCurRow + "], nRowType=[" + nRowType + "], nRow=[" + nRow + " 행], Lev=[" + strLev + "], 이벤트제목=[" + strName + "]";
	//trace("EventMstReg 화면 >> grd_list_oncellclick : " + strMsg);
	
	
	// 이벤트목록 TreeStatus
	if (obj.getTreeStatus(nRow) == 0){
		// 설정하고자 하는 TreeStatus.
		//  false : 해당 Row의 TreeStatus를 Collapse로 설정
		//  true  : 해당 Row의 TreeStatus를 Expand로 설정                
		obj.setTreeStatus(nRow, true);
		//trace("EventMstReg 화면 >> grd_list_oncellclick : 이벤트목록 TreeStatus : Expand로 설정(obj.getTreeStatus(nRow) == 0)");
	} else if (obj.getTreeStatus(nRow) == 1){
		obj.setTreeStatus(nRow, false);
		//trace("EventMstReg 화면 >> grd_list_oncellclick : 이벤트목록 TreeStatus : Collapse로 설정(obj.getTreeStatus(nRow) == 1)");
	} else if (obj.getTreeStatus(nRow) == 2){
		//trace("EventMstReg 화면 >> grd_list_oncellclick : 이벤트목록 TreeStatus : (obj.getTreeStatus(nRow) == 2)");
	} else {
		//trace("EventMstReg 화면 >> grd_list_oncellclick : 이벤트목록 TreeStatus : (else..)");
	}
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 팝업 검색 후 호출 메소드( 사원 데이터에 값 세팅)
 *---------------------------------------------------------------------------------------------*/
function signBeforeTrigger(obj)
{
    return true;
}

function signAfterTrigger(obj, data)
{
    ds_eventMst.setColumn(0, "signPrcgSabun", data.sabun);
    ds_eventMst.setColumn(0, "signPrcgNm", data.nmKor);
}

function fn_eidtCheck(curRow , editType , gubun)
{
//  fn_eidtCheck(currow, "text", "mstList")
    if (gubun == "mstList"){
        //trace("EventMstReg 화면 >> fn_eidtCheck : curRow=[" + curRow + "], editType=[" + editType + "], gubun=[" + gubun + "]");
        if (ds_list.getRowType(curRow) != "2"){
			//trace("EventMstReg 화면 >> fn_eidtCheck : return none..");
            return "none";
        }
    } 
//     else {
//         if (ds_eventMst.getColumn(0, "signStatus") == "002"){
//             return "none";
//         }
//     }
    return editType;
}

function fn_eidtFormCheck()
{
    if (ds_eventMst.getColumn(0, "signStatus")  == "002"){
        div_evnt.enable       = false;
        grd_progress.readonly = true;
        grd_utensil.readonly  = true;
        //div_evnt.cbo_theme.enable = false;    //테마 회색처리 (주의, 위치 변경하지 말것)
        edt_PersonalSearchComp.enable = false;  //담당 결재자명
    } else {
        div_evnt.enable       = true;
        grd_progress.readonly = false;
        grd_utensil.readonly  = false;
        //div_evnt.cbo_theme.enable = true;    //테마
        edt_PersonalSearchComp.enable = true;  //담당 결재자명
    }
}

function fn_themeSearch(){
    ds_rowSearch.setColumn(0, "mclassCd", ds_eventMst.getColumn(0, "mclassCd"));
    ds_rowSearch.setColumn(0, "sclassCd", ds_eventMst.getColumn(0, "sclassCd"));
    ds_rowSearch.setColumn(0, "lclassCd", ds_eventMst.getColumn(0, "lclassCd"));

    var strSvcID    = "Theme";
    var strURL      = "fs/fse/eventMstReg/selectTheme.xdo";
    var strInDs     = "ds_search=ds_rowSearch:A";
    var strOutDs    = "ds_cboTheme=dsThemeListOutput";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

// 검색 조건 이벤트명 검색 팝업
function btn_eventNm_OnClick(obj:Button,  e:ClickEventInfo)
{
    var arrParam = {"evntTitle" : edt_eventNm.text};
    var arrRtn   = gfn_dialog( "EventPop"                                       // Dialog ID
                             , "X_FSE::EventPop.xfdl"                           // Form URL
                             , {fv_Contents:arrParam}                           // 배열
                             , null, null, null, null, null, false, true, -1);

    if ( arrRtn instanceof Object ) {
        //edt_searchParam.value    = arrRtn["evntTitle"];

        ds_search.setColumn(0, "mclassCd",arrRtn["mclassCd"]);
        ds_search.setColumn(0, "mclassNm",arrRtn["mclassNm"]);
        ds_search.setColumn(0, "sclassCd",arrRtn["sclassCd"]);
        ds_search.setColumn(0, "sclassNm",arrRtn["sclassNm"]);
        ds_search.setColumn(0, "eventNm",arrRtn["evntTitle"]);
        ds_search.setColumn(0, "eventCd",arrRtn["seq"]);
    }

    fn_search();
}

function edt_eventNm_onkeydown(obj:Edit, e:KeyEventInfo)
{
    if (e.keycode == 13){         // Enter 키
        if (gfn_isNull(ds_search.getColumn(0, "eventCd"))){
            btn_eventNm.click();
        } else {
            fn_search();
        }
    } else if (e.keycode == 46){  // Del 키
        ds_search.setColumn(0, "eventNm", "");
        ds_search.setColumn(0, "eventCd", "");
        ds_search.setColumn(0, "sclassCd", "");
    }
}

// 수정 여부 판단
function fn_updateCheck(gubun)
{
    if (gubun == "mstList")
    {
        // 변경사항 체크
        if (gfn_dsIsUpdated(ds_list) == true)
        {
            var retValue = gfn_confirm("confirm.before.search");    // 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
            if (retValue == false){
                return false;
            } else {
                ds_list.reset();
                return true;
            }
        }
    } else {
        // 변경사항 체크
        if (gfn_dsIsUpdated(ds_eventMst) == true || gfn_dsIsUpdated(ds_progress) == true || gfn_dsIsUpdated(ds_utensil) == true )
        {
            var retValue = gfn_confirm("confirm.before.search");    // 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
            if (retValue == false){
                return false;
            } else {
                ds_eventMst.reset();
                ds_progress.reset();
                ds_utensil.reset();
                return true;
            }
        }
    }
}

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : form에서 Key Down시 단축키들 지정(공통에서 자동생성, 화면에 스크립트 작성시 화면 스크립트만 실행됨)
 *---------------------------------------------------------------------------------------------*/
// function form_onkeydown(obj:Form, e:KeyEventInfo)
// {
//  gfn_formKeyDown(obj, e);
// }

/*----------------------------------------------------------------------------------------------
 * 설명      : Grid Header Click시 정렬(공통에서 자동생성, 화면에 스크립트 작성시 화면 스크립트만 실행됨)
 *---------------------------------------------------------------------------------------------*/
// function grd_list_onheadclick(obj:Grid, e:GridClickEventInfo)
// {
//  gfn_gridSort(obj, e);
// }

//이벤트 목록 행 추가
function btn_insMst_onclick(obj:Button,  e:ClickEventInfo)
{
    fn_insert( "mstList" );
}

//이벤트 목록 행 삭제
function btn_delMst_onclick(obj:Button,  e:ClickEventInfo)
{
    fn_delete( "mstList" );
}

//이벤트 등록 추가
function btn_insForm_onclick(obj:Button,  e:ClickEventInfo)
{
    fn_insert( "form" );
}

//이벤트 등록 삭제
function btn_delForm_onclick(obj:Button,  e:ClickEventInfo)
{
    fn_delete( "form" );
}

//진행절차 행추가
function btn_insProgress_onclick(obj:Button,  e:ClickEventInfo)
{
    if( ds_progress.getRowCount() > 10 ){
        gfn_alert("10개를 초과할수 없습니다."); //진행절차를 선택해주세요
        ds_progress.rowposition = 0;
        return ;
    }

    fn_insert( "progress" );
}

//진행절차 행삭제
function btn_delProgress_onclick(obj:Button,  e:ClickEventInfo)
{
    fn_delete( "progress" );
}

//기기 추가
function btn_insUtensil_onclick(obj:Button,  e:ClickEventInfo)
{
    fn_insert( "utensil" );
}

//기기 삭제
function btn_delUtensil_onclick(obj:Button,  e:ClickEventInfo)
{
    fn_delete( "utensil" );
}

//이벤트 등록에 테마 콤보박스 연결
function cbo_group_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
    fn_themeSearch();
}

// 이벤트목록 변경시
function ds_list_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
    if(obj.getColumn(e.row, "lev") == 4) {
        ds_eventMst.setColumn(0, "evntTitle", obj.getColumn(e.row, "name"));
    }
}

// 이벤트 진행절차 변경시
function ds_progress_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
    if(e.columnid == "progressPrcdrCd" ) {
        if("001" != e.newvalue) {
            var nRow = obj.findRowExpr("progressPrcdrCd != 001 && progressPrcdrCd ==" + e.newvalue);
            trace(nRow);

            if(nRow != -1 && nRow != e.row) {
                gfn_alert("중복 선택 되었습니다");
                obj.setColumn(e.row, "progressPrcdrCd", e.oldvalue);
                return;
            }
        }
    }
}

//이벤트목록 행번경시
function ds_list_onrowposchanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
    if (obj.getColumn(e.newrow, "lev") == 1) {
        ds_eventMst.clearData();
        ds_progress.clearData();
        ds_utensil.clearData();
        ds_file.clearData();     // 첨부파일

        return;
    } else if (obj.getColumn(e.newrow, "lev") == 2) {
        ds_eventMst.clearData();
        ds_progress.clearData();
        ds_utensil.clearData();
        ds_file.clearData();     // 첨부파일

        return;
    } else if (obj.getColumn(e.newrow, "lev") == 3) {
        ds_eventMst.clearData();
        ds_progress.clearData();
        ds_utensil.clearData();
        ds_file.clearData();     // 첨부파일

        return;
    } else {
        //trace("EventMstReg 화면 >> ds_list_onrowposchanged : 이벤트목록 행번경, obj.getColumn(e.newrow, 'lev')=[" + obj.getColumn(e.newrow, 'lev') + "]");
        ds_file.clearData();     // 첨부파일
        
        if (obj.getRowType(e.newrow) != 2 && obj.getColumn(e.newrow, "lev") == 4){
            ds_rowSearch.setColumn(0, "lclassCd", obj.getColumn(e.newrow, "lclassCd"));
            ds_rowSearch.setColumn(0, "mclassCd", obj.getColumn(e.newrow, "mclassCd"));
            ds_rowSearch.setColumn(0, "sclassCd", obj.getColumn(e.newrow, "sclassCd"));
            ds_rowSearch.setColumn(0, "seq", obj.getColumn(e.newrow, "seq"));

            fn_fromSearch();
        }
    }
}

// 이벤트명 입력시
function div_evnt_edt_evntTitle_onkillfocus(obj:Edit, e:KillFocusEventInfo)
{
    ds_list.setColumn(ds_list.rowposition, "name", obj.value);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 테스트 확인용..
 *---------------------------------------------------------------------------------------------*/
function edt_testValue_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13 && edt_testValue.value == 'fse!!'){
		//var strText = "로그인 사용자명=[" + g_EmpNo + "]-[" + g_Name + "], 사업부=[" + g_Mu_Cd + "], 팀=[" + g_Tm_Cd + "], 업장=[" + g_Upjang + "]-[" + g_UpjangNm + "],DeptID=[" + g_Deptid + "]";
		//trace("EventMstReg 화면 >> edt_testValue_onkeydown : " + strText);
		//trace("EventMstReg 화면 >> edt_testValue_onkeydown : 실행 OK...");
	} else {
		//trace("EventMstReg 화면 >> edt_testValue_onkeydown : 실행 안함..");
	}
}

// function edt_cuserNm_onkeydown(obj:Edit, e:KeyEventInfo)
// {
// 	if (e.keycode == 13){
// 		//trace("EventMstReg 화면 >> edt_cuserNm_onkeydown : 실행 OK...");
// 		fn_search();
// 	} else {
// 		//trace("EventMstReg 화면 >> edt_cuserNm_onkeydown : 실행 안함..");
// 	}
// }



// 첨부파일 추가
/*----------------------------------------------------------------------------------------------
 * 설명      : 서버사진 파일추가
 *---------------------------------------------------------------------------------------------*/
function btn_addSvrFile_onclick(obj:Button,  e:ClickEventInfo)
{
    var arrParam = {"GUBUN" : "06"};
    var arrRtn   = gfn_dialog( "FileUploadPop"                                  // Dialog ID
                             , "X_FSE::FileUploadPop.xfdl"                      // Form URL
                             , {fv_Contents:arrParam}                           // 배열
                             , null, null, null, null, null, false, true, -1);

    if ( arrRtn instanceof Object ) {
        arr = arrRtn.datas;
        for(var i=0; i<arrRtn.dataRow; i++) {
            var nRow = ds_file.addRow();

            ds_file.setColumn(nRow, "refSeq", ds_file.getColumn(0, "refSeq"));
            ds_file.setColumn(nRow, "orgnlPath", gfn_trim(arr[i].relPath));
            ds_file.setColumn(nRow, "orgnlFileNm", gfn_trim(arr[i].fileNm));
            ds_file.setColumn(nRow, "fileSize", gfn_trim(arr[i].fileSize));
            ds_file.setColumn(nRow, "fileExt", gfn_trim(arr[i].fileExt));
            ds_file.setColumn(nRow, "preView", gfn_trim(arr[i].preView));
            ds_file.setColumn(nRow, "fileDesc", gfn_trim(arr[i].bigo));
            ds_file.setColumn(nRow, "saveFileNm", "");
            ds_file.setColumn(nRow, "relPath", "");
        }
    }
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 파일 업로드
 *---------------------------------------------------------------------------------------------*/
function fn_uploadFile()
{
    var v_bSuccess = false;
    var v_sUrl = "svc::sc/cmn/uploadFile.do?" + gfn_getGlobalVariableUrl(); //공통변수 추가 by kksoo
    var nRow;

    this.setWaitCursor(true);

    // FileUpload 사용 첨부파일 전체 업로드 : (FileUpload)_callback에서 Dataset 사용하기 위해
    for(var i=0; i<ds_file.getRowCount(); i++) {
        if(ds_file.getRowType(i) == 2) {
            if(gfn_isNull(ds_file.getColumn(i, "preView"))){
                grd_AtchFile.fileUpload.appendItem();
                nRow = grd_AtchFile.ds_uploadFile.addRow();
                grd_AtchFile.ds_uploadFile.copyRow(nRow, ds_file, i);
            }
        }
    }

    grd_AtchFile.fileUpload.innerdataset = "ds_uploadFile";
    grd_AtchFile.fileUpload.filecolumn   = "orgnlPath";

    v_bSuccessUpload = grd_AtchFile.fileUpload.upload(v_sUrl);
    if (v_bSuccessUpload) {
        v_bSuccess = true;
    }

    this.setWaitCursor(false);
    return v_bSuccess;
}

//트리 그리드 정렬제한
function grd_list_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	return false;
}


function fn_selectLevel1(){
	var strSvcID    = "selectLevel1";
    var strURL      = "fs/fse/eventMstReg/selectLevel1.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_list=level1";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = false;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}
]]></Script>
  </Form>
</FDL>

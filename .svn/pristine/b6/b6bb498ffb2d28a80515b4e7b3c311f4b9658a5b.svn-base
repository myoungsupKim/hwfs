<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="MAM20100V" onkeydown="fr_Main_OnKeyDown" onload="form_onload" titletext="손익비교보고서(기간별)" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static96" class="sta_WFSA_Labelbg01" position="absolute 0 80 1237 147" anchor="left top right"/>
        <Static id="Static00" position="absolute 0 30 1237 71" class="sta_WFSA_Labelbg" anchor="left top right"/>
        <Div id="div_cmnBtn" taborder="0" tabstop="false" text="Div0" url="cmn::CmnBtn.xfdl" position="absolute 0 0 1237 30" anchor="left top right" scrollbars="none"/>
        <Edit id="edt_Tm" onkeydown="edt_Tm_OnKeyDown" readonly="true" taborder="0" position="absolute 339 42 469 63"/>
        <Edit id="edt_Upjang" onkeydown="edt_Upjang_OnKeyDown" readonly="true" taborder="0" position="absolute 575 42 705 63"/>
        <Static id="Static1" text="팀" position="absolute 311 42 336 63" class="sta_WFSA_label"/>
        <Static id="Static2" text="사업장" position="absolute 519 42 584 63" class="sta_WFSA_label"/>
        <Static id="Static6" text="기간" position="absolute 15 42 50 63" class="sta_WFSA_label"/>
        <Combo displayrowcount="10" id="cbo_Subjob" onitemchanged="fn_CboChange" taborder="11" position="absolute 57 91 157 112"/>
        <Static id="Static0" text="지역" position="absolute 187 91 221 112" class="sta_WFSA_label01"/>
        <Static id="Static3" text="직군" position="absolute 15 91 49 112" class="sta_WFSA_label01"/>
        <Combo displayrowcount="10" id="cbo_Loc" onitemchanged="fn_CboChange" taborder="12" position="absolute 228 91 328 112"/>
        <Static id="Static5" text="사업구분" position="absolute 414 91 475 112" class="sta_WFSA_label01"/>
        <Combo codecolumn="GUBUN_CD" datacolumn="GUBUN_NAME" displayrowcount="10" id="cbo_New" innerdataset="ds_cbo_new" onitemchanged="fn_CboChange" taborder="12" position="absolute 695 91 760 112"/>
        <Static id="Static7" text="기존/신규" position="absolute 620 91 693 112" class="sta_WFSA_label01"/>
        <Static id="Static13" text="구분" position="absolute 15 117 49 138" class="sta_WFSA_label01"/>
        <Combo displayrowcount="10" id="cbo_Saup" onitemchanged="fn_CboChange" taborder="24" position="absolute 482 91 590 112"/>
        <Static id="Static05" text="(단위 : 천원)" position="absolute 1163 127 1234 148" anchor="top right"/>
        <Grid autofittype="col" binddataset="ds_upjang_out" enable="true" id="grd_Upjang" useinputpanel="false" autofitminwidth="100" oncelldblclick="grd_Upjang_OnCellDblClick" taborder="26" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 157 187 710" readonly="true" selecttype="row" anchor="left top bottom">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="154"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" text="사업장 선택"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:left;" text="bind:UPJANGNM"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Radio codecolumn="CLOSE_TYPE" columncount="4" datacolumn="CLOSE_TYPE_NAME" id="rdo_Type" index="-1" innerdataset="ds_rdo_type" taborder="20" position="absolute 57 117 402 138"/>
        <Grid binddataset="ds_out" cellmovingtype="col" cellsizingtype="both" enable="true" id="grd_Main" useinputpanel="false" onheadclick="grd_Main_OnHeadClick" taborder="29" tabstop="true" usecontextmenu="true" useselcolor="false" visible="true" wheelscrollrow="1" position="absolute 197 157 1237 710" readonly="true" selecttype="row" anchor="all" autofittype="col">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="248" band="left"/>
                <Column size="155"/>
                <Column size="155"/>
                <Column size="155"/>
                <Column size="155"/>
                <Column size="155"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') left middle;" class="head_Excel" text="구분"/>
                <Cell col="1" displaytype="text" text="계획"/>
                <Cell col="2" displaytype="text" text="실적"/>
                <Cell col="3" displaytype="text" text="계획대비"/>
                <Cell col="4" displaytype="text" text="전년"/>
                <Cell col="5" displaytype="text" text="전년대비"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align: ;background:#566572ff;background2:#566572ff;color:#ffffffff;color2:#ffffffff;font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:ACCT_NAME"/>
                <Cell col="1" displaytype="number" style="align: ;background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(PLAN_AMT&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(PLAN_AMT&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(PLAN_AMT&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(PLAN_AMT&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:PLAN_AMT" mask="expr:fn_getMaskType(currow)"/>
                <Cell col="2" displaytype="number" style="align: ;background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(ACT_AMT&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(ACT_AMT&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(ACT_AMT&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(ACT_AMT&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:ACT_AMT" mask="expr:fn_getMaskType(currow)"/>
                <Cell col="3" displaytype="number" style="background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#FFFFCC'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#FFFFCC'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(iif(PLAN_AMT==0,0,Math.round(ACT_AMT/PLAN_AMT*100,1))&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(iif(PLAN_AMT==0,0,Math.round(ACT_AMT/PLAN_AMT*100,1))&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(iif(PLAN_AMT==0,0,Math.round(ACT_AMT/PLAN_AMT*100,1))&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(iif(PLAN_AMT==0,0,Math.round(ACT_AMT/PLAN_AMT*100,1))&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" expr="expr:iif(PLAN_AMT==0,0,gfn_parseFloat(Math.round(ACT_AMT/PLAN_AMT*100,1)))" mask="#,##0.0 %"/>
                <Cell col="4" displaytype="number" style="background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(PRE_AMT&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(PRE_AMT&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(PRE_AMT&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(PRE_AMT&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:PRE_AMT" mask="expr:fn_getMaskType(currow)"/>
                <Cell col="5" displaytype="number" style="background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#FFFFCC'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#FFFFCC'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(iif(PRE_AMT==0,0,Math.round(ACT_AMT/PRE_AMT*100,1))&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(iif(PRE_AMT==0,0,Math.round(ACT_AMT/PRE_AMT*100,1))&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(iif(PRE_AMT==0,0,Math.round(ACT_AMT/PRE_AMT*100,1))&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(iif(PRE_AMT==0,0,Math.round(ACT_AMT/PRE_AMT*100,1))&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" expr="expr:iif(PRE_AMT==0,0,gfn_parseFloat(Math.round(ACT_AMT/PRE_AMT*100,1)))" mask="#,##0.0 %"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Radio codecolumn="CLOSE_TYPE" columncount="4" datacolumn="CLOSE_TYPE_NAME" id="rdo_Type_Temp" index="-1" innerdataset="ds_rdo_type_temp" taborder="30" position="absolute 57 117 210 138"/>
        <Static id="Static11" text="~" position="absolute 165 42 173 63"/>
        <MaskEdit id="me_Date1" mask="####-##" ontextchanged="me_Date1_OnChanged" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Month_OnKillFocus" taborder="32" type="string" position="absolute 57 42 137 63" class="msk_WF_EssentialCal"/>
        <MaskEdit id="me_Date2" mask="####-##" ontextchanged="me_Date2_OnChanged" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Month_OnKillFocus" taborder="34" type="string" position="absolute 181 42 261 63" class="msk_WF_EssentialCal"/>
        <Static id="Static09" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static14" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Button id="btn_Date1" taborder="36" tabstop="false" onclick="g_CalButton_OnClick" class="btn_WF_popSearchEssential" position="absolute 136 42 157 63" userdata="me_Date1" onkillfocus="btn_Date1_OnKillFocus"/>
        <Static id="Static04" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 47 42 57 63" anchor="left top"/>
        <Button id="btn_Date2" taborder="37" tabstop="false" onkillfocus="btn_Date2_OnKillFocus" onclick="g_CalButton_OnClick" class="btn_WF_popSearchEssential" position="absolute 260 42 281 63" userdata="me_Date2"/>
        <Static id="Static08" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 329 42 339 63" anchor="left top"/>
        <Static id="Static10" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 565 42 575 63" anchor="left top"/>
        <Button id="edtBtn_Tm" taborder="38" tabstop="false" onclick="edtBtn_Tm_OnClick" class="btn_WF_popSearch" position="absolute 468 42 489 63"/>
        <Button id="edtBtn_Upjang" taborder="39" tabstop="false" onclick="edtBtn_Upjang_OnClick" class="btn_WF_popSearch" position="absolute 704 42 725 63"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_rdo_type">
        <ColumnInfo>
          <Column id="CLOSE_TYPE" size="256" type="STRING"/>
          <Column id="CLOSE_TYPE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CLOSE_TYPE">C05A</Col>
            <Col id="CLOSE_TYPE_NAME">재무가확정</Col>
          </Row>
          <Row>
            <Col id="CLOSE_TYPE">C05B</Col>
            <Col id="CLOSE_TYPE_NAME">관리가확정</Col>
          </Row>
          <Row>
            <Col id="CLOSE_TYPE">C05C</Col>
            <Col id="CLOSE_TYPE_NAME">재무확정</Col>
          </Row>
          <Row>
            <Col id="CLOSE_TYPE">C05D</Col>
            <Col id="CLOSE_TYPE_NAME">관리확정</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_cbo_SubJob"/>
      <Dataset id="ds_cbo_Loc"/>
      <Dataset id="ds_cbo_new">
        <ColumnInfo>
          <Column id="GUBUN_CD" size="1" type="STRING"/>
          <Column id="GUBUN_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="GUBUN_CD"/>
            <Col id="GUBUN_NAME"/>
          </Row>
          <Row>
            <Col id="GUBUN_CD">O</Col>
            <Col id="GUBUN_NAME">기존</Col>
          </Row>
          <Row>
            <Col id="GUBUN_CD">N</Col>
            <Col id="GUBUN_NAME">신규</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_cbo_saup"/>
      <Dataset id="ds_old_out">
        <ColumnInfo>
          <Column id="NEW_GB" size="6" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_old_in">
        <ColumnInfo>
          <Column id="UPJANG" size="255" type="STRING"/>
          <Column id="YY" size="4" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_upjang_in">
        <ColumnInfo>
          <Column id="LOC_CD" size="10" type="STRING"/>
          <Column id="NEW_GB" size="10" type="STRING"/>
          <Column id="SAUP_TYPE" size="10" type="STRING"/>
          <Column id="SUB_JOB_CD" size="10" type="STRING"/>
          <Column id="TM_CD" size="10" type="STRING"/>
          <Column id="UPJANG" size="10" type="STRING"/>
          <Column id="YY" size="4" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_upjang_out">
        <ColumnInfo>
          <Column id="TM_CD" size="10" type="STRING"/>
          <Column id="TM_NAME" size="255" type="STRING"/>
          <Column id="UPJANG" size="6" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="255" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_in">
        <ColumnInfo>
          <Column id="CLOSE_TYPE" size="20" type="STRING"/>
          <Column id="LOC_CD" size="10" type="STRING"/>
          <Column id="NEW_GUBUN" size="10" type="STRING"/>
          <Column id="SAUP_TYPE" size="20" type="STRING"/>
          <Column id="SUB_JOB_CD" size="10" type="STRING"/>
          <Column id="TM_CD" size="3" type="STRING"/>
          <Column id="UPJANG" size="6" type="STRING"/>
          <Column id="YYMM1" size="4" type="STRING"/>
          <Column id="YYMM2" size="4" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_out">
        <ColumnInfo>
          <Column id="ACCT_CD" size="20" type="STRING"/>
          <Column id="ACCT_LEVEL" size="20" type="STRING"/>
          <Column id="ACCT_NAME" size="100" type="STRING"/>
          <Column id="ACT_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="PLAN_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="PRE_AMT" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_close"/>
      <Dataset id="ds_rdo_type_temp">
        <ColumnInfo>
          <Column id="CLOSE_TYPE" size="256" type="STRING"/>
          <Column id="CLOSE_TYPE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CLOSE_TYPE">C05B</Col>
            <Col id="CLOSE_TYPE_NAME">가확정</Col>
          </Row>
          <Row>
            <Col id="CLOSE_TYPE">C05D</Col>
            <Col id="CLOSE_TYPE_NAME">확정</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : FS시스템/경영관리/실적
 * 프로그램명   : MAM20140V.XML
 * 기      능   : 손익비교보고서(기간병)
 * 작  성  자   : 김영진
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"
//@@컨버터에서 주석처리 #include "Lib::lib_Date.js";
//@@컨버터에서 주석처리 #include "Lib::lib_Dataset.js";
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js";
//@@컨버터에서 주석처리 #include "LIB::ma_common.js";

//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================

//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	
	fsp_init(this);
	fsp_clear(this);
	
	//Login 팀 정보 
	edt_Tm.userdata = g_Tm_Cd;
	edt_Tm.value = g_Tm_Nm;
	
	// Login 사업장 정보
	edt_Upjang.userdata = g_Upjang;
	edt_Upjang.value = g_UpjangNm;
	
	//사업장 권한 셋팅#############################################################################
	fn_SetAuth("edt_Tm","edtBtn_Tm","edt_Upjang", "edtBtn_Upjang");
    //사업장 권한 셋팅############################################################################# 
	
	
	//사용자 권한에 따른 구분 선택 여부 셋팅########################################################
	if ((g_AuthLevel == "10") || (g_AuthLevel == "12"))  { // 영양사, 리더영양사
       rdo_Type.visible = false;
       rdo_Type_Temp.visible = true;
       rdo_Type_Temp.index = 1;
     }
    else {
       rdo_Type.visible = true;
       rdo_Type_Temp.visible = false;
       rdo_Type.index = 2;
     }  
    //사용자 권한에 따른 구분 선택 여부 셋팅########################################################
	
	
	fsp_clear(this);
	// 실적결산월 가져옴.
    me_Date1.value = fn_searchEisClose(ds_close, "MAM") ;
    me_Date2.value = fn_searchEisClose(ds_close, "MAM") ;
	
	rdo_Type.index = 2;
	
	
	fsp_clear(this);
	// 업장 정보 조회 
    fsp_addSearch(this, "ma/mac:MAC_UPJANG_MST_S001");
    // 서버 호출 
	http.Sync = true;
    fsp_callService(this, "", "", "", "ds_upjang_out=ds_upjang_out","TM_CD=" + wrapQuote(edt_Tm.userdata));
    http.Sync = false;
    
    fn_OrgChange();
   
}


//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================


/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 조회버튼 입력 시 처리되는 작업
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_search()
{   
   
	if (me_Date2.value < me_Date1.value) { 
	   g_Message("EE","TO-연월이 FROM-연월 이전일 수 없습니다.");
	   me_Date2.value = me_Date1.value;
	 } 
	
	
	ds_in.clearData();
    
    //gfn_clearGrid(grd_Main);
    grd_Main.binddataset = "";
    
    fsp_clear(this);
    
	// 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/mam:MAM20140V_S001");
	
	// 서버 호출 
	http.Sync = true;
	
	if ((g_AuthLevel == "10") || (g_AuthLevel == "12"))  { // 영양사, 리더영양사 
	   fsp_callService(this, "", "", "", "ds_out=ds_out","YYMM1=" + wrapQuote(me_Date1.value) + " YYMM2=" + wrapQuote(me_Date2.value) + " CLOSE_TYPE=" + wrapQuote(rdo_Type_Temp.value) + " TM_CD=" + wrapQuote(edt_Tm.userdata) + " UPJANG=" + wrapQuote(edt_Upjang.userdata) + " SUB_JOB_CD=" + iif(!gfn_isNull(cbo_Subjob.value),wrapQuote(cbo_Subjob.value),'') + " LOC_CD=" + iif(!gfn_isNull(cbo_Loc.value),wrapQuote(cbo_Loc.value),'') + " SAUP_TYPE=" + gfn_nvl(cbo_Saup.value) + " NEW_GUBUN=" + wrapQuote(cbo_New.value) ,"fn_afterSearch");
	 }
	else {
	   fsp_callService(this, "", "", "", "ds_out=ds_out","YYMM1=" + wrapQuote(me_Date1.value) + " YYMM2=" + wrapQuote(me_Date2.value) + " CLOSE_TYPE=" + wrapQuote(rdo_Type.value) + " TM_CD=" + wrapQuote(edt_Tm.userdata) + " UPJANG=" + wrapQuote(edt_Upjang.userdata) + " SUB_JOB_CD=" + iif(!gfn_isNull(cbo_Subjob.value),wrapQuote(cbo_Subjob.value),'') + " LOC_CD=" + iif(!gfn_isNull(cbo_Loc.value),wrapQuote(cbo_Loc.value),'') + " SAUP_TYPE=" + gfn_nvl(cbo_Saup.value) + " NEW_GUBUN=" + wrapQuote(cbo_New.value) ,"fn_afterSearch");
	 }
	http.Sync = false;

}


/*
 ******************************************************************************************
 * 함  수  명   : fn_Insert()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 입력버튼 입력 시 처리되는 작업
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_insert()
{
    
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Save()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 저장버튼 입력 시 처리되는 작업
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_save()
{
  
 }

/*
 ******************************************************************************************
 * 함  수  명   : fn_Delete()
 * 입      력   : kEY 값
 * 반      환   : 없음
 * 기      능   : 삭제버튼 입력 시 처리되는 작업
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */

function fn_delete()
{
      
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Close()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 닫기 버튼 이벤트
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_Close()
{
	this.close();
}



/*
 ******************************************************************************************
 * 함  수  명   : fn_Help()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 도움말 
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_help()
{
}


//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================



//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 개요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSearch
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : callback 
 * 작  성  자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_afterSearch() {
   // 재료비율
    // 재료비 식음료 비율 
    // 재료비 상품 비율
    // 인건비 비율
    // 경비 비율
    // 매출이익율 
    var row1 = fn_getRow("PLB10000");   // 재료비
    var row2 = fn_getRow("PLA00000");   // 매출액
   
    var row3 = fn_getRow("PLB11000");   // 식음료재료비
    var row4 = fn_getRow("PLA10000");   // 식음료매출
    
    var row5 = fn_getRow("PLB12000");   // 상품재료비
    var row6 = fn_getRow("PLA20000");   // 상품매출
    
    var row7 = fn_getRow("PLB20000");   // 인건비
    var row8 = fn_getRow("PLA00000");   // 매출액
    
    var row9 = fn_getRow("PLB30000");   // 경비
    var row10 = fn_getRow("PLA00000");  // 매출액
    
    var row11 = fn_getRow("PLC00000");   // 매출이익
    var row12 = fn_getRow("PLA00000");   // 매출액
    
    
    var tRow1 = fn_getRow("PLB10090");              // 재료비원가율
    var tRow2 = fn_getRow("PLB11090");   			// 식음료원가율
    var tRow3 = fn_getRow("PLB12090");   			// 상품원가율
    
    var tRow4 = fn_getRow("PLB20090");              // 인건비비율 
    var tRow5 = fn_getRow("PLB30090");			    // 경비비율 
    
    var tRow6 = fn_getRow("PLC00090");              // 영업이익율
    
 
//*****************************************************************************************
// 1.계획금액
//*****************************************************************************************
 
     // 재료비 비율
    if (toNumber(ds_out.getColumn(row2, "PLAN_AMT")) != 0 ) {
	    ds_out.setColumn(tRow1, "PLAN_AMT" 
	         , Math.round(toNumber(ds_out.getColumn(row1, "PLAN_AMT")) / toNumber(ds_out.getColumn(row2, "PLAN_AMT")) * 100, 1));
	  }
		
	// 식음료 재료비 비율
   	if (toNumber(ds_out.getColumn(row4, "PLAN_AMT")) != 0 ) {
		ds_out.setColumn(tRow2, "PLAN_AMT"
			, Math.round(toNumber(ds_out.getColumn(row3, "PLAN_AMT")) / toNumber(ds_out.getColumn(row4, "PLAN_AMT")) * 100 , 1));
	  }	
		
	 // 상품 재료비 비율 
	if (toNumber(ds_out.getColumn(row6, "PLAN_AMT")) != 0 ) {
		ds_out.setColumn(tRow3, "PLAN_AMT"
			, Math.round(toNumber(ds_out.getColumn(row5, "PLAN_AMT")) / toNumber(ds_out.getColumn(row6, "PLAN_AMT")) * 100 , 1));
	 }	
		
	// 인건비 비율 
	if (toNumber(ds_out.getColumn(row8, "PLAN_AMT")) != 0 ) {	
		ds_out.setColumn(tRow4, "PLAN_AMT"
			, Math.round(toNumber(ds_out.getColumn(row7, "PLAN_AMT")) / toNumber(ds_out.getColumn(row8, "PLAN_AMT")) * 100 , 1));
	 }
	 		
	// 경비 비율
	if (toNumber(ds_out.getColumn(row10, "PLAN_AMT")) != 0 ) {		 
		ds_out.setColumn(tRow5, "PLAN_AMT"
			, Math.round(toNumber(ds_out.getColumn(row9, "PLAN_AMT")) / toNumber(ds_out.getColumn(row10, "PLAN_AMT")) * 100 , 1)); 
	 }
	 		   
	// 매출이익율
	if (toNumber(ds_out.getColumn(row12, "PLAN_AMT")) != 0 ) {		
		ds_out.setColumn(tRow6, "PLAN_AMT"
			, Math.round(toNumber(ds_out.getColumn(row11, "PLAN_AMT")) / toNumber(ds_out.getColumn(row12, "PLAN_AMT")) * 100 , 1));    
     }

//*****************************************************************************************
// 2. 실적금액
//*****************************************************************************************
 
     // 재료비 비율
    if (toNumber(ds_out.getColumn(row2, "ACT_AMT")) != 0 ) {
	    ds_out.setColumn(tRow1, "ACT_AMT" 
	         , Math.round(toNumber(ds_out.getColumn(row1, "ACT_AMT")) / toNumber(ds_out.getColumn(row2, "ACT_AMT")) * 100, 1));
	  }
		
	// 식음료 재료비 비율
   	if (toNumber(ds_out.getColumn(row4, "ACT_AMT")) != 0 ) {
		ds_out.setColumn(tRow2, "ACT_AMT"
			, Math.round(toNumber(ds_out.getColumn(row3, "ACT_AMT")) / toNumber(ds_out.getColumn(row4, "ACT_AMT")) * 100 , 1));
	  }	
		
	 // 상품 재료비 비율 
	if (toNumber(ds_out.getColumn(row6, "ACT_AMT")) != 0 ) {
		ds_out.setColumn(tRow3, "ACT_AMT"
			, Math.round(toNumber(ds_out.getColumn(row5, "ACT_AMT")) / toNumber(ds_out.getColumn(row6, "ACT_AMT")) * 100 , 1));
	 }	
		
	// 인건비 비율 
	if (toNumber(ds_out.getColumn(row8, "ACT_AMT")) != 0 ) {	
		ds_out.setColumn(tRow4, "ACT_AMT"
			, Math.round(toNumber(ds_out.getColumn(row7, "ACT_AMT")) / toNumber(ds_out.getColumn(row8, "ACT_AMT")) * 100 , 1));
	 }
	 		
	// 경비 비율
	if (toNumber(ds_out.getColumn(row10, "ACT_AMT")) != 0 ) {		 
		ds_out.setColumn(tRow5, "ACT_AMT"
			, Math.round(toNumber(ds_out.getColumn(row9, "ACT_AMT")) / toNumber(ds_out.getColumn(row10, "ACT_AMT")) * 100 , 1)); 
	 }
	 		   
	// 매출이익율
	if (toNumber(ds_out.getColumn(row12, "ACT_AMT")) != 0 ) {		
		ds_out.setColumn(tRow6, "ACT_AMT"
			, Math.round(toNumber(ds_out.getColumn(row11, "ACT_AMT")) / toNumber(ds_out.getColumn(row12, "ACT_AMT")) * 100 , 1));    
     }   
     
//*****************************************************************************************
// 3. 전년금액
//*****************************************************************************************
 
     // 재료비 비율
    if (toNumber(ds_out.getColumn(row2, "PRE_AMT")) != 0 ) {
	    ds_out.setColumn(tRow1, "PRE_AMT" 
	         , Math.round(toNumber(ds_out.getColumn(row1, "PRE_AMT")) / toNumber(ds_out.getColumn(row2, "PRE_AMT")) * 100, 1));
	  }
		
	// 식음료 재료비 비율
   	if (toNumber(ds_out.getColumn(row4, "PRE_AMT")) != 0 ) {
		ds_out.setColumn(tRow2, "PRE_AMT"
			, Math.round(toNumber(ds_out.getColumn(row3, "PRE_AMT")) / toNumber(ds_out.getColumn(row4, "PRE_AMT")) * 100 , 1));
	  }	
		
	 // 상품 재료비 비율 
	if (toNumber(ds_out.getColumn(row6, "PRE_AMT")) != 0 ) {
		ds_out.setColumn(tRow3, "PRE_AMT"
			, Math.round(toNumber(ds_out.getColumn(row5, "PRE_AMT")) / toNumber(ds_out.getColumn(row6, "PRE_AMT")) * 100 , 1));
	 }	
		
	// 인건비 비율 
	if (toNumber(ds_out.getColumn(row8, "PRE_AMT")) != 0 ) {	
		ds_out.setColumn(tRow4, "PRE_AMT"
			, Math.round(toNumber(ds_out.getColumn(row7, "PRE_AMT")) / toNumber(ds_out.getColumn(row8, "PRE_AMT")) * 100 , 1));
	 }
	 		
	// 경비 비율
	if (toNumber(ds_out.getColumn(row10, "PRE_AMT")) != 0 ) {		 
		ds_out.setColumn(tRow5, "PRE_AMT"
			, Math.round(toNumber(ds_out.getColumn(row9, "PRE_AMT")) / toNumber(ds_out.getColumn(row10, "PRE_AMT")) * 100 , 1)); 
	 }
	 		   
	// 매출이익율
	if (toNumber(ds_out.getColumn(row12, "PRE_AMT")) != 0 ) {		
		ds_out.setColumn(tRow6, "PRE_AMT"
			, Math.round(toNumber(ds_out.getColumn(row11, "PRE_AMT")) / toNumber(ds_out.getColumn(row12, "PRE_AMT")) * 100 , 1));    
     }   
    
    grd_Main.binddataset = "ds_out";
    gfn_showMsgGrid(grd_Main);
    
 }
 
 
 /*
 ******************************************************************************************
 * 함  수  명   : fn_getRow
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 처리할 row 찾기  
 * 작  성  자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_getRow(str, stIdx) {
    if ( stIdx == null ) {
        stIdx = 0;
    }

    for ( var i = stIdx; i < ds_out.getRowCount(); i++) {
        if ( str == gfn_trim(ds_out.getColumn(i, "ACCT_CD") )) {
            return i;
        }
    }
    
    return -1 ;
}

/*
 ******************************************************************************************
 * 함  수  명   : fr_Main_OnKeyDown
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : KeyDown 이벤트 (sc_comon 호출)
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fr_Main_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	// sc_comon 호출
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
}


/*
 ******************************************************************************************
 * 함  수  명   : edtBtn_Tm_OnClick()
 * 입      력   : 없음
 * 반      환   : 팀코드/코드명
 * 기      능   : 조회조건 팝업
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */

function edtBtn_Tm_OnClick(obj:Button, e:ClickEventInfo)
{ 
        fn_sql_common_setup(strMAQuery_Team2, 
							strMAQuery_Team2KeyField, 
							strMAQuery_Team2ValueField, 
							strMAQuery_Team2KeyFieldNM, 
							strMAQuery_Team2ValueFieldNM, 
							"", 
							"", 
							"",
							strMAQuery_Team2Caption,
							strMAQuery_Team2AllField);
	
	if (gds_sql_common.getColumn(0, "ret_code") != ""){
		
		edt_Tm.userdata = gds_sql_common.getColumn(0, "ret_code");
		edt_Tm.value     = gds_sql_common.getColumn(0, "ret_name");
	   
	    edt_Upjang.userdata = "";
        edt_Upjang.value = "";
	 }	
	 
	 
    
    fsp_clear(this);
    // 업장 정보 조회 
    fsp_addSearch(this, "ma/mac:MAC_UPJANG_MST_S001");
    // 서버 호출 
	http.Sync = true;
    fsp_callService(this, "", "", "", "ds_upjang_out=ds_upjang_out","TM_CD=" + wrapQuote(edt_Tm.userdata));
    http.Sync = false;
    
    edt_Upjang.setFocus();	
    
    fn_OrgChange();
    
    
 }

/*
 ******************************************************************************************
 * 함  수  명   : edtBtn_Upjang_OnClick()
 * 입      력   : 없음
 * 반      환   : 업장코드/코드명
 * 기      능   : 조회조건 팝업
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function edtBtn_Upjang_OnClick(obj:Button, e:ClickEventInfo)
{ 
    if( gfn_length(edt_Tm.value)== 0 ) {
        g_Message("EE","팀을 먼저 선택하여 주십시오.");
        edt_Tm.setFocus();
        return;
    }  
        
        fn_sql_common_setup(strMAQuery_Upjang + " AND DECODE('" + g_AuthLevel + "', '12', LEADER_SABUN, '" + g_EmpNo + "') = '" + g_EmpNo + "'", 
							strMAQuery_UpjangKeyField, 
							strMAQuery_UpjangValueField, 
							strMAQuery_UpjangKeyFieldNM, 
							strMAQuery_UpjangValueFieldNM, 
							"", 
							"",
							" AND NVL(TM_CD,'0') LIKE '%" +gfn_toString(edt_Tm.userdata)+ "%'",// AND NVL(LOC_CD,'0') LIKE '%" +ToString(cbo_Loc.Value) + "%'" + " AND NVL(SUB_JOB_CD,'0') LIKE '%" +ToString(cbo_SubJob.Value) + "%'",
							strMAQuery_UpjangCaption,
							strMAQuery_UpjangAllField);

	if (gds_sql_common.getColumn(0, "ret_code") != ""){
		
		edt_Upjang.userdata = gds_sql_common.getColumn(0, "ret_code");
		edt_Upjang.value     = gds_sql_common.getColumn(0, "ret_name");
		
	}
     
	fn_OrgChange();  
}


/*
 ******************************************************************************************
 * 함  수  명   : edt_Tm_OnKeyDown() 
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : Edit EnterKey Event
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function edt_Tm_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	fn_edt_OnKeyDown(obj,e.keycode);
	
	if (e.keycode == 46) {
	   
	   edt_Upjang.userdata = "";
       edt_Upjang.value = "";
	   
	   fn_OrgChange();
	 
     }		
		
}

/*
 ******************************************************************************************
 * 함  수  명   : edt_Upjang_OnKeyDown() 
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : Edit EnterKey Event
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function edt_Upjang_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	fn_edt_OnKeyDown(obj,e.keycode);
	
		
	if (e.keycode == 46) {
	   
	   fn_OrgChange();
	 
      }		
    
}

/*
 ******************************************************************************************
 * 함  수  명   : grd_Main_OnHeadClick() 
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : Excel Down
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function grd_Main_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
  if (obj.getCellProperty("head",e.cell,"class") == "head_Excel") 
	  gfn_exportExcel(obj, this.titletext);
  /*}
  else {	
	G_GridSort(object(obj.BindDataset), obj, nCell);
  }	*/
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_OrgChange() 
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : 콤보박스 자료 생성
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_OrgChange()
{
   fsp_clear(this);
   
   if (gfn_length(gfn_trim(edt_Upjang.userdata))== 0 ) {  
      
      if (gfn_length(gfn_trim(edt_Tm.userdata))== 0 ) {  
			 
		 //지역코드
		 fn_sql_common("C", strMAQuery_LOC_CD,""," ORDER BY CODE_NAME","non",cbo_Loc,-1,ds_cbo_Loc);
		 
		 //SUB 직군코드
		 fn_sql_common("C", strMAQuery_MASUBJOB,""," ORDER BY SUB_JOB_NAME","non",cbo_Subjob,-1,ds_cbo_SubJob);
		 
		 //사업코드
		 fn_sql_common("C", strMAQuery_MASAUP_TYPE1,""," ORDER BY SAUP_NAME","non",cbo_Saup,-1,ds_cbo_saup);
		 
		 cbo_New.userdata = "";
		 cbo_New.text = "";
		 
		 fsp_clear(this);
	     // 업장 정보 조회 
         fsp_addSearch(this, "ma/mac:MAC_UPJANG_MST_S001");
         // 서버 호출 
	     http.Sync = true;
		 fsp_callService(this, "", "", "", "ds_upjang_out=ds_upjang_out","TM_CD=" + wrapQuote(edt_Tm.userdata) + " SUB_JOB_CD=" + iif(!gfn_isNull(cbo_Subjob.value),wrapQuote(cbo_Subjob.value),'') + " LOC_CD=" + iif(!gfn_isNull(cbo_Loc.value),wrapQuote(cbo_Loc.value),'') + " SAUP_TYPE=" + gfn_nvl(cbo_Saup.value) + " YY=" + wrapQuote(gfn_subStr(me_Date2.value,0,4)) + " NEW_GB=" + wrapQuote(cbo_New.value) );
		 http.Sync = false;
    
		}	 	 
	 else {
	  		//지역코드
		fn_sql_common("C", strMAQuery_MALOC_CD,""," AND TM_CD = '"+gfn_toString(edt_Tm.userdata)+ "' ORDER BY LOC_NAME","",cbo_Loc,-1,ds_cbo_Loc);
		 
		//SUB 직군코드
		fn_sql_common("C", strMAQuery_MASUBJOB1,""," AND TM_CD = '"+gfn_toString(edt_Tm.userdata)+ "' ORDER BY SUB_JOB_NAME","",cbo_Subjob,-1,ds_cbo_SubJob);
		 
		//사업코드
		fn_sql_common("C", strMAQuery_MASAUP_TYPE2,""," AND TM_CD = '"+gfn_toString(edt_Tm.userdata)+ "' ORDER BY SAUP_NAME","",cbo_Saup,-1,ds_cbo_saup);
		 
		cbo_New.userdata = "";
		cbo_New.text = "";
	  }
   }     
   else {
    
        //지역코드
		fn_sql_common("C", strMAQuery_MALOC_CD,""," AND UPJANG = '"+gfn_toString(edt_Upjang.userdata)+ "' ORDER BY LOC_NAME","",cbo_Loc,-1,ds_cbo_Loc);
		cbo_Loc.index = 0;
		 
		//SUB 직군코드
		fn_sql_common("C", strMAQuery_MASUBJOB1,""," AND UPJANG = '"+gfn_toString(edt_Upjang.userdata)+ "' ORDER BY SUB_JOB_NAME","",cbo_Subjob,-1,ds_cbo_SubJob);
		cbo_Subjob.index = 0;
		 
		//사업코드
		fn_sql_common("C", strMAQuery_MASAUP_TYPE2,""," AND UPJANG = '"+gfn_toString(edt_Upjang.userdata)+ "' ORDER BY SAUP_NAME","",cbo_Saup,-1,ds_cbo_saup);
		cbo_Saup.index = 0;
		
		
		// 업장 신규 정보 조회 
		fsp_addSearch(this, "ma/mac:MAC_UPJANG_NEW_S001");
		// 서버 호출 
		http.Sync = true;
		fsp_callService(this, "", "", "", "ds_old_out=ds_old_out","YY=" + wrapQuote(gfn_subStr(me_Date2.value,0,4)) + " UPJANG=" + wrapQuote(edt_Upjang.userdata));
		http.Sync = false;
	    
	    /*if (length(ds_old_out.GetColumn(ds_old_out.row, "NEW_GB")) == 0) {
		  cbo_New.UserData = "N";
		  cbo_New.Text = "신규";
		 }
		else
		  cbo_New.UserData = "O";
		  cbo_New.Text = "기존";
		 } */
		 
		if (ds_old_out.getColumn(ds_old_out.rowposition, "NEW_GB") == 0) {
		  cbo_New.index = 2; 
		}
		else
		  cbo_New.index = 1;
		}  
  }
   
 /*
 ******************************************************************************************
 * 함  수  명   : fn_CboChange() 
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : 콤보박스 Change Event
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_CboChange(obj:Combo, e:ItemChangeEventInfo)
{ 
   fsp_clear(this);
	// 업장 정보 조회 
    fsp_addSearch(this, "ma/mac:MAC_UPJANG_MST_S001");
    // 서버 호출 
	http.Sync = true;
    fsp_callService(this, "", "", "", "ds_upjang_out=ds_upjang_out","TM_CD=" + wrapQuote(edt_Tm.userdata) + " SUB_JOB_CD=" + iif(!gfn_isNull(cbo_Subjob.value),wrapQuote(cbo_Subjob.value),'') + " LOC_CD=" + iif(!gfn_isNull(cbo_Loc.value),wrapQuote(cbo_Loc.value),'') + " SAUP_TYPE=" + gfn_nvl(cbo_Saup.value) + " YY=" + wrapQuote(gfn_subStr(me_Date2.value,0,4)) + " NEW_GB=" + wrapQuote(cbo_New.value) );
    http.Sync = false;
 }   
 
 /*
 ******************************************************************************************
 * 함  수  명   : grd_Upjang_OnCellDblClick() 
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : 콤보박스 Change Event
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function grd_Upjang_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
  if ((g_AuthLevel == "10") || (g_AuthLevel == "12"))  { // 영양사, 리더영양사
	  
	  g_Message("EE","사업장 변경 권한이 없습니다.");
      return;
   }
  
  else {
	  edt_Tm.userdata = ds_upjang_out.getColumn(ds_upjang_out.rowposition, "TM_CD");
	  edt_Tm.value     = ds_upjang_out.getColumn(ds_upjang_out.rowposition, "TM_NAME");
	  
	  edt_Upjang.userdata = ds_upjang_out.getColumn(ds_upjang_out.rowposition, "UPJANG");
	  edt_Upjang.value     = ds_upjang_out.getColumn(ds_upjang_out.rowposition, "UPJANGNM");
	  
	  fn_OrgChange();
	  
	  fn_search();
   }	  
}


/*
 ******************************************************************************************
 * 함  수  명   : fn_getMaskType() 
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : 그리드 마스트 타입 
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
  
function fn_getMaskType(nRow) {
    if ( ds_out.getColumn(nRow, "ACCT_LEVEL") == "10" ) {
        // 비율 
        return "#,##0.0";
    } else {
        return "#,##0";
    }
}


function me_Date1_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{
	 return;//me_Date2.Value = me_Date1.Value;
}

function btn_Date1_OnKillFocus(obj:Button, e:KillFocusEventInfo)
{
	return;//me_Date2.Value = me_Date1.Value;
}


/*
 ******************************************************************************************
 * 함  수  명   : me_Date2_OnChanged() 
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : Date 변경 이벤트
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function me_Date2_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{  
    if (me_Date2.value < me_Date1.value) { 
	   g_Message("EE","TO-연월이 FROM-연월 이전일 수 없습니다.");
	   me_Date2.value = me_Date1.value;
	 } 
	  
}

/*
 ******************************************************************************************
 * 함  수  명   : btn_Date2_OnKillFocus() 
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : Date 팝업버튼 이벤트
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function btn_Date2_OnKillFocus(obj:Button, e:KillFocusEventInfo)
{
	 if (me_Date2.value < me_Date1.value) { 
	  g_Message("EE","TO-연월이 FROM-연월 이전일수 없습니다.");
	   me_Date2.value = me_Date1.value;
	 }  
}
]]></Script>
  </Form>
</FDL>

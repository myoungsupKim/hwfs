<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="FoodMaterialsSupplyPriceIndex" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="식자재 공급 단가표" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="1" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30" tabstop="false"/>
        <Static id="Static29" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 72" anchor="left top right"/>
        <Static id="Static45" text="W15" visible="false" position="absolute 0 30 15 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static43" text="W10" visible="false" position="absolute 15 30 278 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static44" text="W10" visible="false" position="absolute 15 61 278 71" style="background:#ff000055;align:center middle;"/>
        <Static id="Static28" text="센터" class="sta_WFSA_label" position="absolute 16 40 92 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 48 40 58 61" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 178 40 208 61" anchor="left top"/>
        <Combo id="cbo_centerCode" taborder="1" innerdataset="@ds_center" codecolumn="centerCode" datacolumn="centerName" position="absolute 58 40 178 61" anchor="left top" class="cmb_WF_Essential"/>
        <Static id="Static01" text="고객사" class="sta_WFSA_label" position="absolute 209 40 271 61" anchor="left top"/>
        <Edit id="edt_upjang" taborder="1" class="edt_WF_Essential" position="absolute 264 40 479 61" anchor="left top" onkeydown="edt_upjang_onkeydown"/>
        <Button id="btn_upjang" taborder="1" class="btn_WF_popSearchEssential" position="absolute 478 40 499 61" anchor="left top" onclick="btn_upjang_onclick"/>
        <Static id="Static04" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 499 40 529 61" anchor="left top"/>
        <Static id="sta_contract" text="단가계약번호" class="sta_WFSA_label" position="absolute 529 40 620 61" anchor="left top"/>
        <Static id="Static07" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 622 40 632 61" anchor="left top"/>
        <Combo id="cbo_contract" taborder="1" innerdataset="@ds_contract" codecolumn="contractId" datacolumn="contractDisp" position="absolute 632 40 820 61" anchor="left top" class="cmb_WF_Essential"/>
        <CheckBox id="chk_consumYN" taborder="1" text="소모품 제외" position="absolute 713 85 828 105" truevalue="Y" falsevalue="N" anchor="top right"/>
        <CheckBox id="chk_zeroPrice" taborder="1" text="0 단가 포함조회" value="true" position="absolute 841 85 956 105" truevalue="Y" falsevalue="N" anchor="top right"/>
        <CheckBox id="chk_changeRate" taborder="1" text="변동율 포함출력" position="absolute 975 85 1090 105" onchanged="chk_changeRate_onchanged" anchor="top right" onclick="chk_changeRate_onclick"/>
        <CheckBox id="chk_isCust" taborder="1" text="고객사표시출력" position="absolute 1121 85 1236 105" anchor="top right" onclick="chk_isCust_onclick"/>
        <Combo id="cbo_classType" taborder="1" codecolumn="codecolumn" position="absolute 836 40 911 61" anchor="left top" index="-1" datacolumn="datacolumn" onitemchanged="cbo_classType_onitemchanged">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">2</Col>
                <Col id="datacolumn">중분류</Col>
              </Row>
              <Row>
                <Col id="codecolumn">3</Col>
                <Col id="datacolumn">소분류</Col>
              </Row>
              <Row>
                <Col id="codecolumn">4</Col>
                <Col id="datacolumn">세분류</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="Static00" text="W10" visible="false" position="absolute 465 61 728 71" style="background:#ff000055;align:center middle;"/>
        <Static id="Static02" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 816 40 836 61" anchor="left top"/>
        <Static id="Static03" text="적용기간 :" position="absolute 944 32 1006 53" anchor="left top"/>
        <Static id="Static08" text="계  약 명 :" position="absolute 944 50 1006 71" anchor="left top"/>
        <Static id="sta_contractDate" position="absolute 1008 32 1230 53" anchor="left top" text="값1"/>
        <Static id="sta_contractName" position="absolute 1008 50 1230 71" anchor="left top" text="값2"/>
        <Static id="Static10" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 912 40 942 61" anchor="left top"/>
        <Static id="Static12" text="W5" visible="false" position="absolute 927 66 1190 71" style="background:#ff000055;align:center middle;"/>
        <Static id="Static13" text="W5" visible="false" position="absolute 927 48 1190 53" style="background:#ff000055;align:center middle;"/>
        <Static id="Static14" text="W5" visible="false" position="absolute 927 30 1190 35" style="background:#ff000055;align:center middle;"/>
        <Div id="Div00" taborder="2" position="absolute 0 76 361 121" style="background:white;"/>
        <Static id="Static18" text="공급 단가정보" class="sta_WF_Title01" position="absolute 0 85 450 103" anchor="left top"/>
        <Tab id="tab_supply" anchor="all" taborder="3" tabindex="0" scrollbars="autoboth" position="absolute 0 102 1237 711" style="showextrabutton:false;" onchanged="tab_supply_onchanged">
          <Tabpages>
            <Tabpage id="tpg_A" text="타입 A" style="anchor:default;">
              <Layouts>
                <Layout>
                  <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1235 15" anchor="left top"/>
                  <Static id="Static07" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 15 10 596"/>
                  <Static id="Static01" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1225 15 1235 596"/>
                  <Static id="Static35" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 10 568 1245 578" anchor="left top"/>
                  <Grid id="grd_listA" taborder="1" binddataset="ds_listA" autoenter="select" useinputpanel="true" cellsizingtype="col" cellmovingtype="none" autofittype="col" position="absolute 10 31 1225 569" anchor="all" auth_vendor="false">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="22"/>
                          <Column size="114"/>
                          <Column size="77"/>
                          <Column size="191"/>
                          <Column size="280"/>
                          <Column size="193"/>
                          <Column size="61"/>
                          <Column size="98"/>
                          <Column size="72"/>
                          <Column size="70"/>
                          <Column size="80"/>
                          <Column size="150"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell/>
                          <Cell col="1" text="세분류"/>
                          <Cell col="2" text="상품번호"/>
                          <Cell col="3" text="상품명"/>
                          <Cell col="4" text="규격"/>
                          <Cell col="5" text="원산지&#13;&#10;(원산지/국가/주요원료 및 함량)"/>
                          <Cell col="6" text="단위"/>
                          <Cell col="7" text="판매가"/>
                          <Cell col="8" text="면/과세"/>
                          <Cell col="9" text="발주마감"/>
                          <Cell col="10" text="담당MD"/>
                          <Cell col="11" text="공급업체명"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:NO" expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:left middle;" text="bind:className"/>
                          <Cell col="2" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                          <Cell col="3" displaytype="text" edittype="none" style="align:left middle;" text="bind:itemName"/>
                          <Cell col="4" displaytype="text" style="align:left middle;" text="bind:itemSize"/>
                          <Cell col="5" displaytype="text" style="align:center;" text="bind:originNat"/>
                          <Cell col="6" displaytype="text" style="align:center middle;" text="bind:poUom"/>
                          <Cell col="7" displaytype="number" style="align:right middle;" text="bind:salePrice"/>
                          <Cell col="8" displaytype="text" style="align:center middle;" text="bind:taxCode"/>
                          <Cell col="9" displaytype="text" style="align:center middle;" text="bind:dDays"/>
                          <Cell col="10" text="bind:mdName"/>
                          <Cell col="11" style="align:left;padding:0 0 0 8;" text="bind:vendorName"/>
                        </Band>
                      </Format>
                      <Format id="changeRate">
                        <Columns>
                          <Column size="22"/>
                          <Column size="114"/>
                          <Column size="104"/>
                          <Column size="221"/>
                          <Column size="291"/>
                          <Column size="72"/>
                          <Column size="65"/>
                          <Column size="85"/>
                          <Column size="85"/>
                          <Column size="63"/>
                          <Column size="31"/>
                          <Column size="62"/>
                          <Column size="71"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" text="세분류"/>
                          <Cell col="2" text="상품번호"/>
                          <Cell col="3" text="상품명"/>
                          <Cell col="4" text="규격"/>
                          <Cell col="5" text="원산지"/>
                          <Cell col="6" text="단위"/>
                          <Cell col="7" text="전단가"/>
                          <Cell col="8" text="판매가"/>
                          <Cell col="9" colspan="2" text="변동율" taborder="undefined"/>
                          <Cell col="11" text="면/과세"/>
                          <Cell col="12" text="발주마감"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:NO" expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:left middle;" text="bind:className"/>
                          <Cell col="2" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                          <Cell col="3" displaytype="text" edittype="none" style="align:left middle;" text="bind:itemName"/>
                          <Cell col="4" displaytype="text" style="align:left middle;" text="bind:itemSize"/>
                          <Cell col="5" displaytype="text" text="bind:originNat"/>
                          <Cell col="6" displaytype="text" style="align:center middle;" text="bind:poUom"/>
                          <Cell col="7" displaytype="number" text="bind:prePrice"/>
                          <Cell col="8" displaytype="number" style="align:right;" text="bind:salePrice"/>
                          <Cell col="9" displaytype="number" text="bind:chgrate" mask="#,##0.#0%"/>
                          <Cell col="10" displaytype="text" style="align:center middle;color:EXPR(gubun=='↑'?'red':gubun=='↓'?'blue':'');color2:EXPR(gubun=='↑'?'red':gubun=='↓'?'blue':'');" text="bind:gubun"/>
                          <Cell col="11" displaytype="text" style="align:center middle;" text="bind:taxCode"/>
                          <Cell col="12" displaytype="text" style="align:center middle;" text="bind:dDays"/>
                        </Band>
                      </Format>
                      <Format id="default_copy">
                        <Columns>
                          <Column size="22"/>
                          <Column size="114"/>
                          <Column size="77"/>
                          <Column size="191"/>
                          <Column size="280"/>
                          <Column size="69"/>
                          <Column size="61"/>
                          <Column size="98"/>
                          <Column size="72"/>
                          <Column size="70"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell/>
                          <Cell col="1" text="세분류"/>
                          <Cell col="2" text="상품번호"/>
                          <Cell col="3" text="상품명"/>
                          <Cell col="4" text="규격"/>
                          <Cell col="5" text="원산지"/>
                          <Cell col="6" text="단위"/>
                          <Cell col="7" text="판매가"/>
                          <Cell col="8" text="면/과세"/>
                          <Cell col="9" text="발주마감"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:NO" expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:left middle;" text="bind:className"/>
                          <Cell col="2" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                          <Cell col="3" displaytype="text" edittype="none" style="align:left middle;" text="bind:itemName"/>
                          <Cell col="4" displaytype="text" style="align:left middle;" text="bind:itemSize"/>
                          <Cell col="5" displaytype="text" text="bind:originNat"/>
                          <Cell col="6" displaytype="text" style="align:center middle;" text="bind:poUom"/>
                          <Cell col="7" displaytype="number" style="align:right middle;" text="bind:salePrice"/>
                          <Cell col="8" displaytype="text" style="align:center middle;" text="bind:taxCode"/>
                          <Cell col="9" displaytype="text" style="align:center middle;" text="bind:dDays"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="sta_A" text="※ 담당MD, 공급업체 정보는 대외비로 출력이 불가능합니다." position="absolute 859 10 1222 32" anchor="top right" style="color:crimson;font:Gulim,9,bold;"/>
                  <Button id="btn_excel" taborder="2" text="엑셀출력" onclick="btn_excel_onclick" class="btn_WF_Function" position="absolute 10 8 75 28"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tpg_B" text="타입 B">
              <Layouts>
                <Layout>
                  <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1235 15" anchor="left top"/>
                  <Static id="Static07" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 15 10 596"/>
                  <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 10 55 460 68" anchor="left top"/>
                  <Static id="Static21" class="sta_WFSA_Labelbg01" position="absolute 10 14 1225 55" anchor="left top right"/>
                  <Static id="Static01" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1225 15 1235 596"/>
                  <Grid id="grd_listB" taborder="4" binddataset="ds_listB" autoenter="select" useinputpanel="false" cellsizingtype="col" autofittype="col" position="absolute 10 68 1225 569" anchor="all">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="64"/>
                          <Column size="64"/>
                          <Column size="64"/>
                          <Column size="91"/>
                          <Column size="70"/>
                          <Column size="197"/>
                          <Column size="204"/>
                          <Column size="117"/>
                          <Column size="131"/>
                          <Column size="125"/>
                          <Column size="115"/>
                          <Column size="85"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" text="코드"/>
                          <Cell col="2" text="단가타입"/>
                          <Cell col="3" text="사업장구분"/>
                          <Cell col="4" displaytype="text" text="단가시작일"/>
                          <Cell col="5" text="품목코드"/>
                          <Cell col="6" text="품목명"/>
                          <Cell col="7" text="원산지&#13;&#10;(원산지/국가/주요원료 및 함량)"/>
                          <Cell col="8" text="매입처코드"/>
                          <Cell col="9" text="매입가"/>
                          <Cell col="10" text="판매가"/>
                          <Cell col="11" text="운영단가"/>
                          <Cell col="12" text="사용"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:center middle;" text="bind:진풍코드"/>
                          <Cell col="2" displaytype="text" style="align:center middle;" text="bind:단가타입"/>
                          <Cell col="3" displaytype="text" style="align:center middle;" text="bind:사업장구분"/>
                          <Cell col="4" displaytype="text" style="align:center middle;" text="bind:contractStart"/>
                          <Cell col="5" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                          <Cell col="6" displaytype="text" style="align:left middle;" text="bind:itemName"/>
                          <Cell col="7" text="bind:originNat"/>
                          <Cell col="8" displaytype="text" style="align:center middle;" text="bind:매입처코드"/>
                          <Cell col="9" displaytype="number" style="align:right middle;" text="bind:contractPrice"/>
                          <Cell col="10" displaytype="number" style="align:right middle;" text="bind:salePrice2"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" text="bind:salePrice3"/>
                          <Cell col="12" displaytype="text" style="align:center middle;" text="bind:useYn"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static35" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 10 586 1245 596" anchor="left top"/>
                  <Static id="Static23" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 11 14 104 24" anchor="left top"/>
                  <Static id="Static25" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 11 24 26 45" anchor="left top"/>
                  <Static id="Static02" text="운영단가기준일" class="sta_WFSA_label01" position="absolute 26 24 144 45" anchor="left top"/>
                  <Static id="Static26" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 144 24 154 45" anchor="left top"/>
                  <Static id="Static24" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 11 45 104 55" anchor="left top"/>
                  <Static id="Static27" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 258 24 288 45" anchor="left top"/>
                  <ObjCalendar id="cal_stdDate" anchor="left top" titletext="캘린더" taborder="5" class="cal_WF_Essential" position="absolute 154 24 258 45" style="align:center middle;"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tpg_C" text="타입 C (ECMS)">
              <Layouts>
                <Layout>
                  <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1235 15" anchor="left top"/>
                  <Grid id="grd_listC" taborder="1" binddataset="ds_listC" autoenter="select" useinputpanel="false" cellsizingtype="col" autofittype="none" position="absolute 10 15 1225 569" anchor="all">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="80"/>
                          <Column size="110"/>
                          <Column size="120"/>
                          <Column size="224"/>
                          <Column size="82"/>
                          <Column size="191"/>
                          <Column size="82"/>
                          <Column size="82"/>
                          <Column size="82"/>
                          <Column size="92"/>
                          <Column size="90"/>
                          <Column size="87"/>
                          <Column size="82"/>
                          <Column size="171"/>
                          <Column size="82"/>
                          <Column size="82"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" text="상품코드"/>
                          <Cell col="2" text="세분류"/>
                          <Cell col="3" text="중분류"/>
                          <Cell col="4" text="품목명"/>
                          <Cell col="5" text="발주단위"/>
                          <Cell col="6" text="원산지&#13;&#10;(원산지/국가/주요원료 및 함량)"/>
                          <Cell col="7" text="면/과세"/>
                          <Cell col="8" text="발주환산량"/>
                          <Cell col="9" text="리드타임"/>
                          <Cell col="10" text="최소발주량"/>
                          <Cell col="11" text="중분류코드"/>
                          <Cell col="12" text="소분류코드"/>
                          <Cell col="13" text="세분류코드"/>
                          <Cell col="14" text="규격"/>
                          <Cell col="15" text="발주단위"/>
                          <Cell col="16" text="면/과세"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                          <Cell col="2" displaytype="text" text="bind:className4"/>
                          <Cell col="3" displaytype="text" text="bind:className2"/>
                          <Cell col="4" displaytype="text" style="align:left middle;" text="bind:itemName"/>
                          <Cell col="5" displaytype="text" style="align:center middle;" text="bind:poUom"/>
                          <Cell col="6" text="bind:originNat"/>
                          <Cell col="7" displaytype="text" style="align:center middle;" text="bind:taxCode"/>
                          <Cell col="8" displaytype="number" style="align:right middle;" text="bind:kgConvertRate"/>
                          <Cell col="9" displaytype="text" style="align:center middle;" text="bind:dDays"/>
                          <Cell col="10" displaytype="number" style="align:right middle;" text="bind:minOrdQty"/>
                          <Cell col="11" displaytype="text" style="align:center middle;" text="bind:classCode2"/>
                          <Cell col="12" displaytype="text" style="align:center middle;" text="bind:classCode3"/>
                          <Cell col="13" displaytype="text" style="align:center middle;" text="bind:classCode4"/>
                          <Cell col="14" displaytype="text" text="bind:itemSize"/>
                          <Cell col="15" displaytype="text" style="align:center middle;" text="bind:poUom2"/>
                          <Cell col="16" displaytype="text" style="align:center middle;" text="bind:taxCode2"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static07" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 15 10 596"/>
                  <Static id="Static01" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1225 15 1235 596"/>
                  <Static id="Static35" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 10 586 1245 596" anchor="left top"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tpg_D" text="타입 D(비즈메카)">
              <Layouts>
                <Layout>
                  <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1235 15" anchor="left top"/>
                  <Static id="Static07" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 15 10 596"/>
                  <Static id="Static35" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 10 586 1245 596" anchor="left top"/>
                  <Static id="Static01" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1225 15 1235 596"/>
                  <Grid id="grd_listD" taborder="1" binddataset="ds_listD" autoenter="select" useinputpanel="false" cellsizingtype="col" autofittype="none" position="absolute 10 15 1225 569" anchor="all">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="80"/>
                          <Column size="152"/>
                          <Column size="152"/>
                          <Column size="197"/>
                          <Column size="63"/>
                          <Column size="89"/>
                          <Column size="146"/>
                          <Column size="82"/>
                          <Column size="155"/>
                          <Column size="82"/>
                          <Column size="157"/>
                          <Column size="82"/>
                          <Column size="82"/>
                          <Column size="82"/>
                          <Column size="82"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" text="품목코드"/>
                          <Cell col="2" text="품목명"/>
                          <Cell col="3" text="규격(스펙)"/>
                          <Cell col="4" text="원산지&#13;&#10;(원산지/국가/주요원료 및 함량)"/>
                          <Cell col="5" text="단위"/>
                          <Cell col="6" text="중분류"/>
                          <Cell col="7" text="중분류명"/>
                          <Cell col="8" text="소분류"/>
                          <Cell col="9" text="소분류명"/>
                          <Cell col="10" text="세분류"/>
                          <Cell col="11" text="세분류명"/>
                          <Cell col="12" text="판매가"/>
                          <Cell col="13" text="환산량"/>
                          <Cell col="14" text="과/면"/>
                          <Cell col="15" text="발주마감"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                          <Cell col="2" displaytype="text" text="bind:itemName"/>
                          <Cell col="3" displaytype="text" text="bind:itemSize"/>
                          <Cell col="4" text="bind:originNat"/>
                          <Cell col="5" displaytype="text" style="align:center middle;" text="bind:poUom"/>
                          <Cell col="6" displaytype="text" style="align:center middle;" text="bind:classCode2"/>
                          <Cell col="7" displaytype="text" style="align:left middle;" text="bind:className2"/>
                          <Cell col="8" displaytype="text" style="align:center middle;" text="bind:classCode3"/>
                          <Cell col="9" displaytype="text" text="bind:className3"/>
                          <Cell col="10" displaytype="text" style="align:center middle;" text="bind:classCode4"/>
                          <Cell col="11" displaytype="text" text="bind:className4"/>
                          <Cell col="12" displaytype="number" text="bind:salePrice"/>
                          <Cell col="13" displaytype="number" style="align:right middle;" text="bind:kgConvertRate"/>
                          <Cell col="14" displaytype="text" style="align:center middle;" text="bind:taxCode"/>
                          <Cell col="15" displaytype="text" style="align:center middle;" text="bind:dDays"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tpg_E" text="타입 E(비즈메카)">
              <Layouts>
                <Layout>
                  <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1235 15" anchor="left top"/>
                  <Static id="Static07" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 15 10 596"/>
                  <Static id="Static35" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 10 586 1245 596" anchor="left top"/>
                  <Static id="Static01" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1225 15 1235 596"/>
                  <Grid id="grd_listD" taborder="1" binddataset="ds_listD" autoenter="select" useinputpanel="false" cellsizingtype="col" autofittype="none" position="absolute 10 15 1225 569" anchor="all">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="200"/>
                          <Column size="200"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="100"/>
                          <Column size="100"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" text="대분류"/>
                          <Cell col="2" text="중분류"/>
                          <Cell col="3" text="품목코드"/>
                          <Cell col="4" text="품목명"/>
                          <Cell col="5" text="규격"/>
                          <Cell col="6" text="단위"/>
                          <Cell col="7" text="과세여부"/>
                          <Cell col="8" text="선발주"/>
                          <Cell col="9" text="매입단가"/>
                          <Cell col="10" text="매입처"/>
                          <Cell col="11" text="소수점발주여부"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" style="align:left;padding:0 0 0 6;" text="bind:className2"/>
                          <Cell col="2" style="align:left;padding:0 0 0 6;" text="bind:className3"/>
                          <Cell col="3" text="bind:itemCode"/>
                          <Cell col="4" style="align:left;padding:0 0 0 6;" text="bind:itemName"/>
                          <Cell col="5" style="align:left;padding:0 0 0 6;" text="bind:itemSize"/>
                          <Cell col="6" text="bind:poUom"/>
                          <Cell col="7" text="bind:taxCode" expr="expr:taxCode == 'Y' ? '과세' : '면세'"/>
                          <Cell col="8" text="bind:dDays"/>
                          <Cell col="9" displaytype="number" style="padding:0 6 0 0;" text="bind:salePrice"/>
                          <Cell col="10" text="푸디스트"/>
                          <Cell col="11" text="bind:pointFlag"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tpg_F" text="브랜드유통" style="anchor:default;">
              <Layouts>
                <Layout>
                  <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1235 15" anchor="left top"/>
                  <Static id="Static07" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 15 10 596"/>
                  <Static id="Static01" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1225 15 1235 596"/>
                  <Static id="Static35" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 10 568 1245 578" anchor="left top"/>
                  <Grid id="grd_listF" taborder="1" binddataset="ds_listF" autoenter="select" useinputpanel="true" cellsizingtype="col" cellmovingtype="none" autofittype="col" position="absolute 10 31 1225 569" anchor="all" auth_vendor="false">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="22"/>
                          <Column size="114"/>
                          <Column size="77"/>
                          <Column size="100"/>
                          <Column size="191"/>
                          <Column size="280"/>
                          <Column size="193"/>
                          <Column size="61"/>
                          <Column size="98"/>
                          <Column size="72"/>
                          <Column size="70"/>
                          <Column size="80"/>
                          <Column size="150"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell/>
                          <Cell col="1" text="세분류"/>
                          <Cell col="2" text="상품번호"/>
                          <Cell col="3" text="88코드"/>
                          <Cell col="4" text="상품명"/>
                          <Cell col="5" text="규격"/>
                          <Cell col="6" text="원산지&#13;&#10;(원산지/국가/주요원료 및 함량)"/>
                          <Cell col="7" text="단위"/>
                          <Cell col="8" text="판매가"/>
                          <Cell col="9" text="면/과세"/>
                          <Cell col="10" text="발주마감"/>
                          <Cell col="11" text="담당MD"/>
                          <Cell col="12" text="공급업체명"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:NO" expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:left middle;" text="bind:className"/>
                          <Cell col="2" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                          <Cell col="3" displaytype="text" style="align:center middle;" text="bind:winItemCd"/>
                          <Cell col="4" displaytype="text" edittype="none" style="align:left middle;" text="bind:itemName"/>
                          <Cell col="5" displaytype="text" style="align:left middle;" text="bind:itemSize"/>
                          <Cell col="6" displaytype="text" style="align:center;" text="bind:originNat"/>
                          <Cell col="7" displaytype="text" style="align:center middle;" text="bind:poUom"/>
                          <Cell col="8" displaytype="number" style="align:right middle;" text="bind:salePrice"/>
                          <Cell col="9" displaytype="text" style="align:center middle;" text="bind:taxCode"/>
                          <Cell col="10" displaytype="text" style="align:center middle;" text="bind:dDays"/>
                          <Cell col="11" text="bind:mdName"/>
                          <Cell col="12" style="align:left;padding:0 0 0 8;" text="bind:vendorName"/>
                        </Band>
                      </Format>
                      <Format id="changeRate">
                        <Columns>
                          <Column size="22"/>
                          <Column size="114"/>
                          <Column size="104"/>
                          <Column size="110"/>
                          <Column size="221"/>
                          <Column size="291"/>
                          <Column size="72"/>
                          <Column size="65"/>
                          <Column size="85"/>
                          <Column size="85"/>
                          <Column size="63"/>
                          <Column size="31"/>
                          <Column size="62"/>
                          <Column size="71"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" text="세분류"/>
                          <Cell col="2" text="상품번호"/>
                          <Cell col="3" text="88코드"/>
                          <Cell col="4" text="상품명"/>
                          <Cell col="5" text="규격"/>
                          <Cell col="6" text="원산지"/>
                          <Cell col="7" text="단위"/>
                          <Cell col="8" text="전단가"/>
                          <Cell col="9" text="판매가"/>
                          <Cell col="10" colspan="2" text="변동율" taborder="undefined"/>
                          <Cell col="12" text="면/과세"/>
                          <Cell col="13" text="발주마감"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:NO" expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:left middle;" text="bind:className"/>
                          <Cell col="2" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                          <Cell col="3" displaytype="text" style="align:center middle;" text="bind:winItemCd"/>
                          <Cell col="4" displaytype="text" edittype="none" style="align:left middle;" text="bind:itemName"/>
                          <Cell col="5" displaytype="text" style="align:left middle;" text="bind:itemSize"/>
                          <Cell col="6" displaytype="text" text="bind:originNat"/>
                          <Cell col="7" displaytype="text" style="align:center middle;" text="bind:poUom"/>
                          <Cell col="8" displaytype="number" text="bind:prePrice"/>
                          <Cell col="9" displaytype="number" style="align:right;" text="bind:salePrice"/>
                          <Cell col="10" displaytype="number" text="bind:chgrate" mask="#,##0.#0%"/>
                          <Cell col="11" displaytype="text" style="align:center middle;color:EXPR(gubun=='↑'?'red':gubun=='↓'?'blue':'');color2:EXPR(gubun=='↑'?'red':gubun=='↓'?'blue':'');" text="bind:gubun"/>
                          <Cell col="12" displaytype="text" style="align:center middle;" text="bind:taxCode"/>
                          <Cell col="13" displaytype="text" style="align:center middle;" text="bind:dDays"/>
                        </Band>
                      </Format>
                      <Format id="default_copy">
                        <Columns>
                          <Column size="22"/>
                          <Column size="114"/>
                          <Column size="77"/>
                          <Column size="100"/>
                          <Column size="191"/>
                          <Column size="280"/>
                          <Column size="69"/>
                          <Column size="61"/>
                          <Column size="98"/>
                          <Column size="72"/>
                          <Column size="70"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell/>
                          <Cell col="1" text="세분류"/>
                          <Cell col="2" text="상품번호"/>
                          <Cell col="3" text="88코드"/>
                          <Cell col="4" text="상품명"/>
                          <Cell col="5" text="규격"/>
                          <Cell col="6" text="원산지"/>
                          <Cell col="7" text="단위"/>
                          <Cell col="8" text="판매가"/>
                          <Cell col="9" text="면/과세"/>
                          <Cell col="10" text="발주마감"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:NO" expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:left middle;" text="bind:className"/>
                          <Cell col="2" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                          <Cell col="3" displaytype="text" style="align:center middle;" text="bind:winItemCd"/>
                          <Cell col="4" displaytype="text" edittype="none" style="align:left middle;" text="bind:itemName"/>
                          <Cell col="5" displaytype="text" style="align:left middle;" text="bind:itemSize"/>
                          <Cell col="6" displaytype="text" text="bind:originNat"/>
                          <Cell col="7" displaytype="text" style="align:center middle;" text="bind:poUom"/>
                          <Cell col="8" displaytype="number" style="align:right middle;" text="bind:salePrice"/>
                          <Cell col="9" displaytype="text" style="align:center middle;" text="bind:taxCode"/>
                          <Cell col="10" displaytype="text" style="align:center middle;" text="bind:dDays"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="sta_A" text="※ 담당MD, 공급업체 정보는 대외비로 출력이 불가능합니다." position="absolute 859 10 1222 32" anchor="top right" style="color:crimson;font:Gulim,9,bold;"/>
                  <Button id="btn_excel_f" taborder="2" text="엑셀출력" onclick="btn_excel_f_onclick" class="btn_WF_Function" position="absolute 10 8 75 28"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Static id="Static20" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 98 450 103" anchor="left top"/>
        <Static id="Static19" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 72 1236 85"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item0" compid="cbo_centerCode" propid="value" datasetid="ds_search" columnid="schCenter"/>
      <BindItem id="item1" compid="cbo_contract" propid="value" datasetid="ds_search" columnid="contractId"/>
      <BindItem id="item2" compid="cbo_classType" propid="value" datasetid="ds_search" columnid="itemClass"/>
      <BindItem id="item3" compid="edt_upjang" propid="value" datasetid="ds_search"/>
      <BindItem id="item4" compid="chk_zeroPrice" propid="value" datasetid="ds_search" columnid="zeroPrice"/>
      <BindItem id="item5" compid="chk_consumYN" propid="value" datasetid="ds_search" columnid="consumYN"/>
    </Bind>
    <Objects>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schCenter" type="STRING" size="256"/>
          <Column id="schUpjang" type="STRING" size="256"/>
          <Column id="contractId" type="STRING" size="256"/>
          <Column id="itemClass" type="STRING" size="256"/>
          <Column id="consumYN" type="STRING" size="256"/>
          <Column id="zeroPrice" type="STRING" size="256"/>
          <Column id="stdDate" type="STRING" size="256"/>
          <Column id="contractStDt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_searchValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schCenter" type="STRING" size="256"/>
          <Column id="schUpjang" type="STRING" size="256"/>
          <Column id="contractId" type="STRING" size="256"/>
          <Column id="itemClass" type="STRING" size="256"/>
          <Column id="consumYN" type="STRING" size="256"/>
          <Column id="zeroPrice" type="STRING" size="256"/>
          <Column id="stdDate" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="schCenter">title:센터,required:true,focus:cbo_center</Col>
            <Col id="schUpjang">title:고객사,required:true,focus:edt_customer</Col>
            <Col id="contractId">title:단가계약번호,required:true,focus:cbo_contract</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_listA" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="className" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="poUom" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="taxCode" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_center" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="centerName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_contract" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="contractId" type="STRING" size="256"/>
          <Column id="contractDisp" type="STRING" size="256"/>
          <Column id="contractNm" type="STRING" size="256"/>
          <Column id="contractStart" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listB" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="진풍코드" type="STRING" size="256"/>
          <Column id="단가타입" type="STRING" size="256"/>
          <Column id="사업장구분" type="STRING" size="256"/>
          <Column id="contractStart" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="매입처코드" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="salePrice2" type="STRING" size="256"/>
          <Column id="salePrice3" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="contractPrice" type="STRING" size="256"/>
          <Column id="originNat" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listC" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="className4" type="STRING" size="256"/>
          <Column id="className2" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="poUom" type="STRING" size="256"/>
          <Column id="taxCode" type="STRING" size="256"/>
          <Column id="kgConvertRate" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="minOrdQty" type="STRING" size="256"/>
          <Column id="classCode2" type="STRING" size="256"/>
          <Column id="classCode3" type="STRING" size="256"/>
          <Column id="classCode4" type="STRING" size="256"/>
          <Column id="null" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="poUom2" type="STRING" size="256"/>
          <Column id="taxCode2" type="STRING" size="256"/>
          <Column id="originNat" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listD" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="classCode2" type="STRING" size="256"/>
          <Column id="className2" type="STRING" size="256"/>
          <Column id="classCode3" type="STRING" size="256"/>
          <Column id="className3" type="STRING" size="256"/>
          <Column id="classCode4" type="STRING" size="256"/>
          <Column id="className4" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="poUom" type="STRING" size="256"/>
          <Column id="kgConvertRate" type="STRING" size="256"/>
          <Column id="taxCode" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="originNat" type="STRING" size="256"/>
          <Column id="pointFlag" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listF" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="className" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="poUom" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="taxCode" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="winItemCd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_date" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="date" type="DATE" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : Template
  파 일 명 : Template.xfdl
  기    능 : Design 및 Script Template 

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.04.20	최영준	최초 생성
  2017.02.03	kihoon	[CH201702_00137] MD정보,공급업체 정보 추가 / 엑셀 export 권한 추가(공통코드:FMS_PRICE_INDEX)
  2017.03.30	kihoon	[CH201703_00816] MD정보, 공급업체 쿼리 변경
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";


/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();
var tabCheck;					//탭 번호
var fv_Key = "";				//저장 시 Key값 SET(계약번호)

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	// 공통코드(DATA_SET) 정의 : 구매매입단가조회권한 SET
	SCDataset.bind(this, "ComCode", "ds_dataSet", {groupCode:"FMS_PRICE_INDEX", code:g_EmpNo, useYn:"Y"}, "fn_priceView");
	
	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	v_ds_check = "ds_list";
	
	// 센터정보 COMBO 초기화 : 조건
	fn_searchCenter();
	
	//조회조건을 초기화한다.
	var nRow= ds_search.addRow();
	ds_search.setColumn(nRow, "schCenter", "");								// 센터
	ds_search.setColumn(nRow, "itemClass", 4);								// 분류
	ds_search.setColumn(nRow, "consumYN", 'N');								// 소모품 체크
	ds_search.setColumn(nRow, "zeroPrice", 'Y');							// 0단가 체크
	
	sta_contractDate.text = '';		// 
    sta_contractName.text = '';		// 
	
	tab_supply.tpg_B.cal_stdDate.fn_initMonthCal(this, gfn_today(), "", ds_search, "stdDate");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{	
//	// v_ds_check 미사용시 변경사항 체크(입력 프로그램일때 변경되는 Dataset 전체 기술)
// 	if (gfn_dsIsUpdated(ds_list) == true) 
// 	{
// 		// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
//         if (!gfn_confirm("confirm.before.movepage")) return false;
//     }
//     
//	// 조회프로그램에도 Return true; 기술해 주세요!
// 	return true;

	// v_ds_check 사용시 변경사항 체크
	if(gfn_length(v_ds_check) == 0) 
	{	
		// v_ds_check 설정기준 변경사항 체크
		if (gfn_isDataChange() == true) 
		{		
			// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
			if (!gfn_confirm("confirm.before.movepage")) return false;
		}
	}
    
	// 조회프로그램에도 Return true; 기술해 주세요!
	return true;
}


/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{

	// 조회시 Validation Check
	if (gfn_validCheck(ds_search, ds_searchValid, true) == false) return;
   
    var strURL
    tabCheck = tab_supply.tabindex;
    ds_list.clear();
    
    ds_contract.rowposition = cbo_contract.index;
    sta_contractDate.text = ds_contract.getColumn(ds_contract.rowposition, 'contractStart');
    sta_contractName.text = ds_contract.getColumn(ds_contract.rowposition, 'contractNm');
    
    ds_search.setColumn(ds_search.rowposition, "contractStDt", (ds_contract.getColumn(ds_contract.rowposition, 'contractStart')));
    
    switch (tabCheck)
	{		
		//A
		case "0":
			strURL = "fm/fms/foodMaterialsSupplyPriceIndex/selectListA.xdo";
			// Grid sort 표시 초기화(필수)
			gfn_clearSortMark(tab_supply.tpg_A.grd_listA);
			break;			
		//B
		case "1":
			strURL = "fm/fms/foodMaterialsSupplyPriceIndex/selectListB.xdo";
			// Grid sort 표시 초기화(필수)
			gfn_clearSortMark(tab_supply.tpg_B.grd_listB);
			break;			
		//C
		case "2":
			strURL = "fm/fms/foodMaterialsSupplyPriceIndex/selectListC.xdo";
			// Grid sort 표시 초기화(필수)
			gfn_clearSortMark(tab_supply.tpg_C.grd_listC);
			break;			
		//D
		case "3":
		//E
		case "4":
			strURL = "fm/fms/foodMaterialsSupplyPriceIndex/selectListD.xdo";
			// Grid sort 표시 초기화(필수)
			gfn_clearSortMark(tab_supply.tpg_D.grd_listD);
			break;			
		//F
		case "5":
			strURL = "fm/fms/foodMaterialsSupplyPriceIndex/selectListF.xdo";
			// Grid sort 표시 초기화(필수)
			gfn_clearSortMark(tab_supply.tpg_F.grd_listF);
			break;	
	}

    var strSvcID    = "search";
    var strInDs     = "ds_search=ds_search:A";
    //var strOutDs    = "ds_listA=ds_listA ds_listB=ds_listB ds_listC=ds_listC ds_listD=ds_listD";
    var strOutDs    = "ds_list=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{	

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
	
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
	// 조회시 Validation Check
	if (gfn_validCheck(ds_search, ds_searchValid, true) == false) return;

	
	//적용기간을 날자형식에 맞는 str로 저장 ( ex)2015-06-03 )
	var str = sta_contractDate.text;	
	var str1 = str.substr(0,4); 
	var str2 = str.substr(4,2); 
	var str3 = str.substr(6,2); 
	str = str1 +'-'+ str2 +'-'+ str3;


	//레포트에 전달할 파라메터 생성
	var arrParams	= SCReport.newParams ();
	SCReport.setParams(arrParams, "contractId", cbo_contract.userdata);
	SCReport.setParams(arrParams, "consumYN", chk_consumYN.userdata);
	SCReport.setParams(arrParams, "zeroPrice", chk_zeroPrice.userdata);
	//SCReport.setParams(arrParams, "contractDate", gfn_strToDate(sta_contractDate.text));
	SCReport.setParams(arrParams, "contractDate", str);
	SCReport.setParams(arrParams, "changeRate", chk_changeRate.value);
	SCReport.setParams(arrParams, "isCust", chk_isCust.value);
	SCReport.setParams(arrParams, "center", ds_search.getColumn(0, "schCenter"));
	if(tab_supply.tabindex == "5") {
		SCReport.setParams(arrParams, "p_88Code", 1);
	} else {
		SCReport.setParams(arrParams, "p_88Code", 0);
	}
	if (chk_isCust.value) SCReport.setParams(arrParams, "upjang", edt_upjang.value.substr(8,1000));
	else SCReport.setParams(arrParams, "upjang", "");

	//--------------------------------------------------
	//방법1)서버에서 Query에 의해 처리하는 경우 예
	//(필수) 레포트명
	if(chk_changeRate.value)	SCReport.setParams (arrParams, SCReport.RPT_NAME, "/hwfs/fm/fms/FoodMaterialsSupplyPriceIndexAddChangeRate.ozr"); 
	else						SCReport.setParams (arrParams, SCReport.RPT_NAME, "/hwfs/fm/fms/FoodMaterialsSupplyPriceIndex.ozr"); 
		

	//출력 옵션 설정
	//-창 타이틀 (디폴트는 "ReportViewer")
	SCReport.setParams (arrParams, SCReport.RPT_TITLE, "FoodMaterialsSupplyPriceIndex");
	
	SCReport.viewReport (this, arrParams);
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
	
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
	switch(strSvcID)
    {
		// 목록 조회
        case "search" :
			cbo_contract.userdata = cbo_contract.value;
			chk_zeroPrice.userdata = chk_zeroPrice.value;
			chk_consumYN.userdata = chk_consumYN.value;
			switch(tabCheck)
			{		
				//A
				case "0":
					ds_listA.copyData(ds_list);
					break;			
				//B
				case "1":
					ds_listB.copyData(ds_list);
					break;			
				//C
				case "2":
					ds_listC.copyData(ds_list);
					break;			
				//D
				case "3":
				//E
				case "4":
					ds_listD.copyData(ds_list);
					break;		
				//E
				case "5":
					ds_listF.copyData(ds_list);
					break;
			}
			//trace(ds_list.saveXML());
			break;
			
			// 센터 조회
        case "searchCenter" :
            //trace(ds_center.saveXML());
            fn_center_init();
            break;

		// 계약번호 조회
        case "searchContract" :
            //trace(ds_contract.saveXML());
            fn_contract_init();
            break;
    }
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/

/*----------------------------------------------------------------------------------------------
 * 설명      : 센터정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchCenter()
{
    var strSvcID    = "searchCenter";
    var strURL      = "fm/fms/upriceContractUpjangSet/selectCenter.xdo";
    var strInDs     = "";
    var strOutDs    = "ds_center=ds_center";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 센터 COMBO 초기화 
 *---------------------------------------------------------------------------------------------*/
function fn_center_init()
{
	var defVal = "";
	ds_center.filter("centerCode != '*'");
	// COMBO 에 첫번째 Row에 기본값을 SET
	if (ds_center.getRowCount() > 1) {
		defVal = ds_center.getColumn(0, "centerCode");
	}
	cbo_centerCode.value = defVal;
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 단가계약번호 조회
 *---------------------------------------------------------------------------------------------*/
function fn_contract()
{
	// 조건 SET : 센터, 고객사
	var nRow = ds_search.rowposition;
	ds_search.setColumn(nRow, "schUpjang", edt_upjang.userdata);		// 고객사코드

    var strSvcID    = "searchContract";
    var strURL      = "fm/fms/foodMaterialsSalePrice/selectContract.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_contract=ds_contract";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 계약번호 COMBO 초기화 
 *---------------------------------------------------------------------------------------------*/
function fn_contract_init()
{
	var defVal = "";
	ds_contract.filter("contractId != 'NEW'");
	// COMBO 에 첫번째 Row에 기본값을 SET
	if (ds_contract.getRowCount() > 1) {
		// 저장이후 재조회 여부
		if (fv_Key=="") {
			defVal = ds_contract.getColumn(0, "contractId");
		} else {
			defVal = fv_Key;
		}
	}
	//trace("defVal : " + defVal);
	//trace("defVal : " + ds_contract.getColumn(0, "contractDisp"));
	cbo_contract.value = defVal;
}



/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : form에서 Key Down시 단축키들 지정(공통에서 자동생성, 화면에 스크립트 작성시 화면 스크립트만 실행됨)
 *---------------------------------------------------------------------------------------------*/
// function form_onkeydown(obj:Form, e:KeyEventInfo)
// {
// 	gfn_formKeyDown(obj, e);
// }

/*----------------------------------------------------------------------------------------------
 * 설명      : Grid Header Click시 정렬(공통에서 자동생성, 화면에 스크립트 작성시 화면 스크립트만 실행됨)
 *---------------------------------------------------------------------------------------------*/
// function grd_list_onheadclick(obj:Grid, e:GridClickEventInfo)
// {
// 	gfn_gridSort(obj, e);
// }

/*
function cbo_center_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	trace(gfn_length(cbo_center.value));
	trace('센터에 맞게 고객사 검색하는 쿼리 날려야함');
}
*/

function btn_upjang_onclick(obj:Button,  e:ClickEventInfo)
{
	// 팝업창을 호출한다	
	var strId       = "FoodMaterialsUpjang";
	var strURL      = "X_FMS::FoodMaterialsUpjangPop.xfdl";
	var objArgument = {
		P_DATASET : ds_search
	};
	
	var nWidth      = 513;
	var nHeight     = 495;
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	
	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
	
	if (arrRtn instanceof Object)
	{
		edt_upjang.value    = arrRtn["upjangNm"];
		edt_upjang.userdata = arrRtn["upjang"];
		obj.userdata       = arrRtn["upjangNm"];
		
		// 고객사 조회
		fn_contract();
		ds_listA.clearData();
		ds_listB.clearData();
		ds_listC.clearData();
		ds_listD.clearData();
		ds_listF.clearData();
	}
}



/*----------------------------------------------------------------------------------------------
 * 설명      : 고객사 검색 콘트롤 이벤트 - 삭제 시 DATA SET Clear
 *---------------------------------------------------------------------------------------------*/
function edt_upjang_onkeydown(obj:Edit, e:KeyEventInfo)
{
	// Del 키
	if(e.keycode == 46) 
	{		
		edt_upjang.value="";
		edt_upjang.userdata="";
		// 고객사 Combo 초기화
		ds_contract.clearData();
	}
	else if(e.keycode == 13)
	{
		btn_upjang.click();
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 변동율 체크시 A타입 그리드 formatid 변경
 *---------------------------------------------------------------------------------------------*/
function chk_changeRate_onchanged(obj:CheckBox, e:CheckBoxChangeEventInfo)
{
	if(e.postvalue){
		tab_supply.tpg_A.grd_listA.formatid = "changeRate";
		tab_supply.tpg_F.grd_listF.formatid = "changeRate";
	} else {
		tab_supply.tpg_A.grd_listA.formatid = "default";
		tab_supply.tpg_F.grd_listF.formatid = "default";
	}
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 자재 분류 변경에 따른 그리드 변경 - 1번째 탭만 해당 됨
 *---------------------------------------------------------------------------------------------*/
function cbo_classType_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	if (cbo_classType.value == "2") {
		tab_supply.tpg_A.grd_listA.setCellProperty("head", 1, "text", "중분류");
		tab_supply.tpg_F.grd_listF.setCellProperty("head", 1, "text", "중분류");
	} else if (cbo_classType.value == "3") {
		tab_supply.tpg_A.grd_listA.setCellProperty("head", 1, "text", "소분류");
		tab_supply.tpg_F.grd_listF.setCellProperty("head", 1, "text", "소분류");
	} else if (cbo_classType.value == "4") {
		tab_supply.tpg_A.grd_listA.setCellProperty("head", 1, "text", "세분류");
		tab_supply.tpg_F.grd_listF.setCellProperty("head", 1, "text", "세분류");
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 탭 변경 이벤트 처리
 *---------------------------------------------------------------------------------------------*/
function tab_supply_onchanged(obj:Tab, e:TabIndexChangeEventInfo)
{
	var tabIndex = e.postindex;//선택된 탭 인덱스 저장
	
	if (tabIndex == 0 || tabIndex == 5) cbo_classType.visible = true;
	else cbo_classType.visible = false;
}


/*----------------------------------------------------------------------------------------------
 * 설명      : MD 권한
 *---------------------------------------------------------------------------------------------*/
function fn_priceView(p, ds)
{
	if (p.oid == "ds_dataSet")
	{
		trace(ds.saveXML());
		if (ds.getRowCount() > 0) {
			tab_supply.tpg_A.grd_listA.auth_vendor = true;
			tab_supply.tpg_F.grd_listF.auth_vendor = true;
		}
	}
}


function btn_excel_onclick(obj:Button,  e:ClickEventInfo) {
	var objGrd = tab_supply.tpg_A.grd_listA;
	
	if ( (objGrd.formatid).toLowerCase() == "default" || gfn_isNull((objGrd.formatid).toLowerCase()) ) {
		if ( objGrd.auth_vendor == true) {
			gfn_exportExcel(objGrd);
			
		} else {
			objGrd.enableredraw = false;
			objGrd.formatid = "default_copy";
			
			gfn_exportExcel(objGrd);
			
			objGrd.formatid = "default";
			objGrd.enableredraw = true;
		}
	} else {
		gfn_exportExcel(objGrd);
	}
}

function btn_excel_f_onclick(obj:Button,  e:ClickEventInfo) {
	var objGrd = tab_supply.tpg_F.grd_listF;
	
	if ( (objGrd.formatid).toLowerCase() == "default" || gfn_isNull((objGrd.formatid).toLowerCase()) ) {
		if ( objGrd.auth_vendor == true) {
			gfn_exportExcel(objGrd);
			
		} else {
			objGrd.enableredraw = false;
			objGrd.formatid = "default_copy";
			
			gfn_exportExcel(objGrd);
			
			objGrd.formatid = "default";
			objGrd.enableredraw = true;
		}
	} else {
		gfn_exportExcel(objGrd);
	}
}

]]></Script>
  </Form>
</FDL>

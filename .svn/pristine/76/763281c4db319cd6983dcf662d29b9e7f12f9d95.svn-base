<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="SuspenseAlterPop" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1000 500" titletext="잡이익/이자수익 대체처리" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 985 10 1000 510" anchor="top right"/>
        <Static id="Static02" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 10 15 510"/>
        <Static id="Static14" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 15 485 985 500"/>
        <Grid id="grd_list" taborder="0" binddataset="ds_list" autoenter="select" useinputpanel="false" cellsizingtype="col" autofittype="col" position="absolute 15 40 985 485" oncellclick="grd_list_oncellclick" anchor="all" onexpanddown="grd_list_onexpanddown" scrollbars="autoboth">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30"/>
                <Column size="120"/>
                <Column size="80"/>
                <Column size="105"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="160"/>
                <Column size="100"/>
                <Column size="30"/>
                <Column size="80"/>
                <Column size="200"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                <Cell col="1" text="계좌번호"/>
                <Cell col="2" text="입금일자"/>
                <Cell col="3" text="입금자명"/>
                <Cell col="4" text="입금금액"/>
                <Cell col="5" text="대체금액"/>
                <Cell col="6" text="대체유형코드"/>
                <Cell col="7" text="대체일자"/>
                <Cell col="8" colspan="2" text="거래처"/>
                <Cell col="10" text="적요"/>
              </Band>
              <Band id="body">
                <Cell style="align:center middle;" expr="currow+1"/>
                <Cell col="1" text="bind:bankAcctNoMsk"/>
                <Cell col="2" text="bind:receiveDate" mask="####-##-##"/>
                <Cell col="3" text="bind:receiveGuestNm"/>
                <Cell col="4" displaytype="number" style="align:right middle;" text="bind:receiveAmt" displayexpdec="0"/>
                <Cell col="5" displaytype="number" edittype="expr:fn_setGridEditType(normal);" editfilter="number" style="align:right;" class="Cellgrd_WF_Point" text="bind:applyAmt" displayexpdec="0" editlimit="13" editdisplay="edit" editlimitbymask="integer"/>
                <Cell col="6" displaytype="combo" edittype="expr:fn_setGridEditType('combo');" class="Cellgrd_WF_Point" text="bind:suspenseAltType" combodataset="ds_suspenseAltType" combocodecol="typeCd" combodatacol="typeNm" combodisplayrowcount="10" combodisplaynulltext="선택" combodisplay="display"/>
                <Cell col="7" displaytype="date" edittype="expr:fn_setGridEditType('date');" class="Cellgrd_WF_Point" text="bind:altDate" calendardisplay="display"/>
                <Cell col="8" displaytype="text" edittype="expand" style="align:center;cursor:hand;" text="bind:custCd" expandshow="show" expandsize="20"/>
                <Cell col="9" text="bind:custNm"/>
                <Cell col="10" displaytype="text" edittype="expr:fn_setGridEditType('text');" style="align:left middle;" class="Cellgrd_WF_Point" text="bind:remark" editdisplay="display"/>
              </Band>
              <Band id="summary">
                <Cell colspan="4" style="align:center middle;" text="합계" taborder="undefined"/>
                <Cell col="4" displaytype="number" text="expr:getSum('receiveAmt')"/>
                <Cell col="5" displaytype="number" text="expr:getSum('applyAmt')"/>
                <Cell col="6"/>
                <Cell col="7"/>
                <Cell col="8"/>
                <Cell col="9"/>
                <Cell col="10"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Edit id="edt_upjungCd" taborder="149" class="edt_WF_Essential" visible="false" position="absolute 1005 603 1068 624" anchor="left top"/>
        <Edit id="edt_upjungNm" taborder="150" maxlength="18" onkillfocus="edt_altNumSch_onkillfocus" onkeydown="edt_altNumSch_onkeydown" visible="false" position="absolute 1067 603 1153 624" anchor="left top"/>
        <Button id="btn_search00" taborder="17" text="조회" onclick="fn_search" class="btn_WF_searchCm" position2="absolute r:-74 w:59 t:48 h:25" positiontype="position2" visible="false"/>
        <Button id="btn_insert" taborder="1" text="CMS조회" onclick="fn_insert" class="btn_WF_CRUD" position2="absolute r:169 w:75 t:10 h:25" positiontype="position2" visible="true"/>
        <Button id="btn_delete" taborder="3" text="대체취소" onclick="fn_delete" class="btn_WF_CRUD" position2="absolute r:15 w:75 t:10 h:25" positiontype="position2"/>
        <Button id="btn_save" taborder="2" text="대체처리" onclick="fn_save" class="btn_WF_CRUD" position2="absolute r:92 w:75 t:10 h:25" positiontype="position2"/>
        <Static id="sta_title" text="잡이익/이자수익 내역" onclick="sta_title_onclick" class="sta_WF_Title" visible="true" position="absolute 14 16 464 35"/>
        <Static id="Static71" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 15 35 985 40" style="background:slateblue;"/>
        <Edit id="edt_altNumSch" taborder="164" maxlength="18" onkillfocus="edt_altNumSch_onkillfocus" onkeydown="edt_altNumSch_onkeydown" visible="false" position="absolute 1067 629 1158 650" anchor="left top"/>
        <Edit id="edt_custCd" taborder="165" class="edt_WF_Essential" visible="false" position="absolute 1005 629 1068 650" anchor="left top"/>
        <Grid id="Grid01" taborder="166" useinputpanel="false" position="absolute 31 917 1100 1054" binddataset="ds_list" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="chk"/>
                <Cell col="1" disptype="normal" text="buCd"/>
                <Cell col="2" disptype="normal" text="buNm"/>
                <Cell col="3" disptype="normal" text="sapSuspenseNum"/>
                <Cell col="4" disptype="normal" text="receiveDate"/>
                <Cell col="5" disptype="normal" text="bankCd"/>
                <Cell col="6" disptype="normal" text="bankCdNm"/>
                <Cell col="7" disptype="normal" text="bankAcctNo"/>
                <Cell col="8" disptype="normal" text="currency"/>
                <Cell col="9" disptype="normal" text="receiveQuestNm"/>
                <Cell col="10" disptype="normal" text="ccCd"/>
                <Cell col="11" disptype="normal" text="ccNm"/>
                <Cell col="12" disptype="normal" text="muCd"/>
                <Cell col="13" disptype="normal" text="muNm"/>
                <Cell col="14" disptype="normal" text="sapSlipNum"/>
                <Cell col="15" disptype="normal" text="class"/>
                <Cell col="16" disptype="normal" text="notesPublishDate"/>
                <Cell col="17" disptype="normal" text="notesExpireDate"/>
                <Cell col="18" disptype="normal" text="notesNum"/>
                <Cell col="19" disptype="normal" text="publisherNm"/>
                <Cell col="20" disptype="normal" text="recdStatus"/>
                <Cell col="21" disptype="normal" text="receiveAmt"/>
                <Cell col="22" disptype="normal" text="applyAmt"/>
                <Cell col="23" disptype="normal" text="balAmt"/>
                <Cell col="24" disptype="normal" text="altNum"/>
                <Cell col="25" disptype="normal" text="altSeq"/>
                <Cell col="26" disptype="normal" text="suspenseAltType"/>
                <Cell col="27" disptype="normal" text="suspenseAltTypeNm"/>
                <Cell col="28" disptype="normal" text="altDate"/>
                <Cell col="29" disptype="normal" text="sapCustCd"/>
                <Cell col="30" disptype="normal" text="sapSendYn"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:chk"/>
                <Cell col="1" disptype="normal" text="bind:buCd"/>
                <Cell col="2" disptype="normal" text="bind:buNm"/>
                <Cell col="3" disptype="normal" text="bind:sapSuspenseNum"/>
                <Cell col="4" disptype="normal" text="bind:receiveDate"/>
                <Cell col="5" disptype="normal" text="bind:bankCd"/>
                <Cell col="6" disptype="normal" text="bind:bankCdNm"/>
                <Cell col="7" disptype="normal" text="bind:bankAcctNo"/>
                <Cell col="8" disptype="normal" text="bind:currency"/>
                <Cell col="9" disptype="normal" text="bind:receiveQuestNm"/>
                <Cell col="10" disptype="normal" text="bind:ccCd"/>
                <Cell col="11" disptype="normal" text="bind:ccNm"/>
                <Cell col="12" disptype="normal" text="bind:muCd"/>
                <Cell col="13" disptype="normal" text="bind:muNm"/>
                <Cell col="14" disptype="normal" text="bind:sapSlipNum"/>
                <Cell col="15" disptype="normal" text="bind:class"/>
                <Cell col="16" disptype="normal" text="bind:notesPublishDate"/>
                <Cell col="17" disptype="normal" text="bind:notesExpireDate"/>
                <Cell col="18" disptype="normal" text="bind:notesNum"/>
                <Cell col="19" disptype="normal" text="bind:publisherNm"/>
                <Cell col="20" disptype="normal" text="bind:recdStatus"/>
                <Cell col="21" disptype="normal" text="bind:receiveAmt"/>
                <Cell col="22" disptype="normal" text="bind:applyAmt"/>
                <Cell col="23" disptype="normal" text="bind:balAmt"/>
                <Cell col="24" disptype="normal" text="bind:altNum"/>
                <Cell col="25" disptype="normal" text="bind:altSeq"/>
                <Cell col="26" disptype="normal" text="bind:suspenseAltType"/>
                <Cell col="27" disptype="normal" text="bind:suspenseAltTypeNm"/>
                <Cell col="28" disptype="normal" text="bind:altDate"/>
                <Cell col="29" disptype="normal" text="bind:sapCustCd"/>
                <Cell col="30" disptype="normal" text="bind:sapSendYn"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="Grid02" taborder="167" useinputpanel="false" position="absolute 764 792 959 894" binddataset="ds_suspenseAltType" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="typeCd"/>
                <Cell col="1" disptype="normal" text="typeNm"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:typeCd"/>
                <Cell col="1" disptype="normal" text="bind:typeNm"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="Grid04" taborder="168" useinputpanel="false" position="absolute 15 505 977 678" binddataset="ds_list" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="chk"/>
                <Cell col="1" disptype="normal" text="buCd"/>
                <Cell col="2" disptype="normal" text="buNm"/>
                <Cell col="3" disptype="normal" text="sapSuspenseNum"/>
                <Cell col="4" disptype="normal" text="receiveDate"/>
                <Cell col="5" disptype="normal" text="bankCd"/>
                <Cell col="6" disptype="normal" text="bankCdNm"/>
                <Cell col="7" disptype="normal" text="bankAcctNo"/>
                <Cell col="8" disptype="normal" text="currency"/>
                <Cell col="9" disptype="normal" text="receiveGuestNm"/>
                <Cell col="10" disptype="normal" text="ccCd"/>
                <Cell col="11" disptype="normal" text="ccNm"/>
                <Cell col="12" disptype="normal" text="muCd"/>
                <Cell col="13" disptype="normal" text="muNm"/>
                <Cell col="14" disptype="normal" text="sapSlipNum"/>
                <Cell col="15" disptype="normal" text="classCd"/>
                <Cell col="16" disptype="normal" text="notesPublishDate"/>
                <Cell col="17" disptype="normal" text="notesExpireDate"/>
                <Cell col="18" disptype="normal" text="notesNum"/>
                <Cell col="19" disptype="normal" text="publisherNm"/>
                <Cell col="20" disptype="normal" text="recdStatus"/>
                <Cell col="21" disptype="normal" text="receiveAmt"/>
                <Cell col="22" disptype="normal" text="applyAmt"/>
                <Cell col="23" disptype="normal" text="balAmt"/>
                <Cell col="24" disptype="normal" text="applyAmtOrg"/>
                <Cell col="25" disptype="normal" text="altNum"/>
                <Cell col="26" disptype="normal" text="altSeq"/>
                <Cell col="27" disptype="normal" text="advanceNum"/>
                <Cell col="28" disptype="normal" text="acctCd"/>
                <Cell col="29" disptype="normal" text="custCd"/>
                <Cell col="30" disptype="normal" text="custNm"/>
                <Cell col="31" disptype="normal" text="suspenseAltType"/>
                <Cell col="32" disptype="normal" text="suspenseAltTypeNm"/>
                <Cell col="33" disptype="normal" text="altDate"/>
                <Cell col="34" disptype="normal" text="sapCustCd"/>
                <Cell col="35" disptype="normal" text="sapSendYn"/>
                <Cell col="36" disptype="normal" text="remark"/>
                <Cell col="37" disptype="normal" text="rowStatus"/>
                <Cell col="38" disptype="normal" text="sabun"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:chk"/>
                <Cell col="1" disptype="normal" text="bind:buCd"/>
                <Cell col="2" disptype="normal" text="bind:buNm"/>
                <Cell col="3" disptype="normal" text="bind:sapSuspenseNum"/>
                <Cell col="4" disptype="normal" text="bind:receiveDate"/>
                <Cell col="5" disptype="normal" text="bind:bankCd"/>
                <Cell col="6" disptype="normal" text="bind:bankCdNm"/>
                <Cell col="7" disptype="normal" text="bind:bankAcctNo"/>
                <Cell col="8" disptype="normal" text="bind:currency"/>
                <Cell col="9" disptype="normal" text="bind:receiveGuestNm"/>
                <Cell col="10" disptype="normal" text="bind:ccCd"/>
                <Cell col="11" disptype="normal" text="bind:ccNm"/>
                <Cell col="12" disptype="normal" text="bind:muCd"/>
                <Cell col="13" disptype="normal" text="bind:muNm"/>
                <Cell col="14" disptype="normal" text="bind:sapSlipNum"/>
                <Cell col="15" disptype="normal" text="bind:classCd"/>
                <Cell col="16" disptype="normal" text="bind:notesPublishDate"/>
                <Cell col="17" disptype="normal" text="bind:notesExpireDate"/>
                <Cell col="18" disptype="normal" text="bind:notesNum"/>
                <Cell col="19" disptype="normal" text="bind:publisherNm"/>
                <Cell col="20" disptype="normal" text="bind:recdStatus"/>
                <Cell col="21" disptype="normal" text="bind:receiveAmt"/>
                <Cell col="22" disptype="normal" text="bind:applyAmt"/>
                <Cell col="23" disptype="normal" text="bind:balAmt"/>
                <Cell col="24" disptype="normal" text="bind:applyAmtOrg"/>
                <Cell col="25" disptype="normal" text="bind:altNum"/>
                <Cell col="26" disptype="normal" text="bind:altSeq"/>
                <Cell col="27" disptype="normal" text="bind:advanceNum"/>
                <Cell col="28" disptype="normal" text="bind:acctCd"/>
                <Cell col="29" disptype="normal" text="bind:custCd"/>
                <Cell col="30" disptype="normal" text="bind:custNm"/>
                <Cell col="31" disptype="normal" text="bind:suspenseAltType"/>
                <Cell col="32" disptype="normal" text="bind:suspenseAltTypeNm"/>
                <Cell col="33" disptype="normal" text="bind:altDate"/>
                <Cell col="34" disptype="normal" text="bind:sapCustCd"/>
                <Cell col="35" disptype="normal" text="bind:sapSendYn"/>
                <Cell col="36" disptype="normal" text="bind:remark"/>
                <Cell col="37" disptype="normal" text="bind:rowStatus"/>
                <Cell col="38" disptype="normal" text="bind:sabun"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="Grid00" taborder="169" useinputpanel="false" position="absolute 13 583 979 661" binddataset="ds_search" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="receiveDateFrom"/>
                <Cell col="1" disptype="normal" text="receiveDateTo"/>
                <Cell col="2" disptype="normal" text="receiveGuestNm"/>
                <Cell col="3" disptype="normal" text="bankAcctNo"/>
                <Cell col="4" disptype="normal" text="muCd"/>
                <Cell col="5" disptype="normal" text="ccCd"/>
                <Cell col="6" disptype="normal" text="altNum"/>
                <Cell col="7" disptype="normal" text="inqueryMuCd"/>
                <Cell col="8" disptype="normal" text="inqueryMuNm"/>
                <Cell col="9" disptype="normal" text="inqueryTmCd"/>
                <Cell col="10" disptype="normal" text="inqueryTmNm"/>
                <Cell col="11" disptype="normal" text="inqueryCcCd"/>
                <Cell col="12" disptype="normal" text="inqueryCcNm"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:receiveDateFrom"/>
                <Cell col="1" disptype="normal" text="bind:receiveDateTo"/>
                <Cell col="2" disptype="normal" text="bind:receiveGuestNm"/>
                <Cell col="3" disptype="normal" text="bind:bankAcctNo"/>
                <Cell col="4" disptype="normal" text="bind:muCd"/>
                <Cell col="5" disptype="normal" text="bind:ccCd"/>
                <Cell col="6" disptype="normal" text="bind:altNum"/>
                <Cell col="7" disptype="normal" text="bind:inqueryMuCd"/>
                <Cell col="8" disptype="normal" text="bind:inqueryMuNm"/>
                <Cell col="9" disptype="normal" text="bind:inqueryTmCd"/>
                <Cell col="10" disptype="normal" text="bind:inqueryTmNm"/>
                <Cell col="11" disptype="normal" text="bind:inqueryCcCd"/>
                <Cell col="12" disptype="normal" text="bind:inqueryCcNm"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="Grid03" taborder="170" useinputpanel="false" position="absolute 113 264 942 446" binddataset="ds_list" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="chk"/>
                <Cell col="1" disptype="normal" text="buCd"/>
                <Cell col="2" disptype="normal" text="buNm"/>
                <Cell col="3" disptype="normal" text="sapSuspenseNum"/>
                <Cell col="4" disptype="normal" text="receiveDate"/>
                <Cell col="5" disptype="normal" text="bankCd"/>
                <Cell col="6" disptype="normal" text="bankCdNm"/>
                <Cell col="7" disptype="normal" text="bankAcctNo"/>
                <Cell col="8" disptype="normal" text="bankAcctNoMsk"/>
                <Cell col="9" disptype="normal" text="currency"/>
                <Cell col="10" disptype="normal" text="receiveGuestNm"/>
                <Cell col="11" disptype="normal" text="ccCd"/>
                <Cell col="12" disptype="normal" text="ccNm"/>
                <Cell col="13" disptype="normal" text="muCd"/>
                <Cell col="14" disptype="normal" text="muNm"/>
                <Cell col="15" disptype="normal" text="sapSlipNum"/>
                <Cell col="16" disptype="normal" text="classCd"/>
                <Cell col="17" disptype="normal" text="notesPublishDate"/>
                <Cell col="18" disptype="normal" text="notesExpireDate"/>
                <Cell col="19" disptype="normal" text="notesNum"/>
                <Cell col="20" disptype="normal" text="publisherNm"/>
                <Cell col="21" disptype="normal" text="recdStatus"/>
                <Cell col="22" disptype="normal" text="receiveAmt"/>
                <Cell col="23" disptype="normal" text="applyAmt"/>
                <Cell col="24" disptype="normal" text="balAmt"/>
                <Cell col="25" disptype="normal" text="applyAmtOrg"/>
                <Cell col="26" disptype="normal" text="altNum"/>
                <Cell col="27" disptype="normal" text="altSeq"/>
                <Cell col="28" disptype="normal" text="advanceNum"/>
                <Cell col="29" disptype="normal" text="cntAdvance"/>
                <Cell col="30" disptype="normal" text="acctCd"/>
                <Cell col="31" disptype="normal" text="custCd"/>
                <Cell col="32" disptype="normal" text="custNm"/>
                <Cell col="33" disptype="normal" text="suspenseAltType"/>
                <Cell col="34" disptype="normal" text="suspenseAltTypeNm"/>
                <Cell col="35" disptype="normal" text="altDate"/>
                <Cell col="36" disptype="normal" text="sapCustCd"/>
                <Cell col="37" disptype="normal" text="sapSendYn"/>
                <Cell col="38" disptype="normal" text="remark"/>
                <Cell col="39" disptype="normal" text="journalzYn"/>
                <Cell col="40" disptype="normal" text="rowStatus"/>
                <Cell col="41" disptype="normal" text="sabun"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:chk"/>
                <Cell col="1" disptype="normal" text="bind:buCd"/>
                <Cell col="2" disptype="normal" text="bind:buNm"/>
                <Cell col="3" disptype="normal" text="bind:sapSuspenseNum"/>
                <Cell col="4" disptype="normal" text="bind:receiveDate"/>
                <Cell col="5" disptype="normal" text="bind:bankCd"/>
                <Cell col="6" disptype="normal" text="bind:bankCdNm"/>
                <Cell col="7" disptype="normal" text="bind:bankAcctNo"/>
                <Cell col="8" disptype="normal" text="bind:bankAcctNoMsk"/>
                <Cell col="9" disptype="normal" text="bind:currency"/>
                <Cell col="10" disptype="normal" text="bind:receiveGuestNm"/>
                <Cell col="11" disptype="normal" text="bind:ccCd"/>
                <Cell col="12" disptype="normal" text="bind:ccNm"/>
                <Cell col="13" disptype="normal" text="bind:muCd"/>
                <Cell col="14" disptype="normal" text="bind:muNm"/>
                <Cell col="15" disptype="normal" text="bind:sapSlipNum"/>
                <Cell col="16" disptype="normal" text="bind:classCd"/>
                <Cell col="17" disptype="normal" text="bind:notesPublishDate"/>
                <Cell col="18" disptype="normal" text="bind:notesExpireDate"/>
                <Cell col="19" disptype="normal" text="bind:notesNum"/>
                <Cell col="20" disptype="normal" text="bind:publisherNm"/>
                <Cell col="21" disptype="normal" text="bind:recdStatus"/>
                <Cell col="22" disptype="normal" text="bind:receiveAmt"/>
                <Cell col="23" disptype="normal" text="bind:applyAmt"/>
                <Cell col="24" disptype="normal" text="bind:balAmt"/>
                <Cell col="25" disptype="normal" text="bind:applyAmtOrg"/>
                <Cell col="26" disptype="normal" text="bind:altNum"/>
                <Cell col="27" disptype="normal" text="bind:altSeq"/>
                <Cell col="28" disptype="normal" text="bind:advanceNum"/>
                <Cell col="29" disptype="normal" text="bind:cntAdvance"/>
                <Cell col="30" disptype="normal" text="bind:acctCd"/>
                <Cell col="31" disptype="normal" text="bind:custCd"/>
                <Cell col="32" disptype="normal" text="bind:custNm"/>
                <Cell col="33" disptype="normal" text="bind:suspenseAltType"/>
                <Cell col="34" disptype="normal" text="bind:suspenseAltTypeNm"/>
                <Cell col="35" disptype="normal" text="bind:altDate"/>
                <Cell col="36" disptype="normal" text="bind:sapCustCd"/>
                <Cell col="37" disptype="normal" text="bind:sapSendYn"/>
                <Cell col="38" disptype="normal" text="bind:remark"/>
                <Cell col="39" disptype="normal" text="bind:journalzYn"/>
                <Cell col="40" disptype="normal" text="bind:rowStatus"/>
                <Cell col="41" disptype="normal" text="bind:sabun"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item4" compid="edt_custCd" propid="value" datasetid="ds_search" columnid="inqueryCustCd"/>
      <BindItem id="item7" compid="edt_altNumSch" propid="value" datasetid="ds_search" columnid="altNum"/>
      <BindItem id="item14" compid="edt_upjungCd" propid="value" datasetid="ds_search" columnid="inqueryUpjangCd"/>
      <BindItem id="item16" compid="edt_upjungNm" propid="value" datasetid="ds_search" columnid="inqueryUpjangNm"/>
    </Bind>
    <Objects>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="receiveDateFrom" type="STRING" size="256"/>
          <Column id="receiveDateTo" type="STRING" size="256"/>
          <Column id="receiveGuestNm" type="STRING" size="256"/>
          <Column id="bankAcctNo" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="altNum" type="STRING" size="256"/>
          <Column id="inqueryMuCd" type="STRING" size="256"/>
          <Column id="inqueryMuNm" type="STRING" size="256"/>
          <Column id="inqueryTmCd" type="STRING" size="256"/>
          <Column id="inqueryTmNm" type="STRING" size="256"/>
          <Column id="inqueryCcCd" type="STRING" size="256"/>
          <Column id="inqueryCcNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_list_oncolumnchanged" onrowposchanged="ds_list_onrowposchanged" canrowposchange="ds_list_canrowposchanged" cancolumnchange="ds_list_cancolumnchanged">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="buCd" type="STRING" size="256"/>
          <Column id="buNm" type="STRING" size="256"/>
          <Column id="sapSuspenseNum" type="STRING" size="256"/>
          <Column id="receiveDate" type="STRING" size="256"/>
          <Column id="bankCd" type="STRING" size="256"/>
          <Column id="bankCdNm" type="STRING" size="256"/>
          <Column id="bankAcctNo" type="STRING" size="256"/>
          <Column id="bankAcctNoMsk" type="STRING" size="256"/>
          <Column id="currency" type="STRING" size="256"/>
          <Column id="receiveGuestNm" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
          <Column id="sapSlipNum" type="STRING" size="256"/>
          <Column id="classCd" type="STRING" size="256"/>
          <Column id="notesPublishDate" type="STRING" size="256"/>
          <Column id="notesExpireDate" type="STRING" size="256"/>
          <Column id="notesNum" type="STRING" size="256"/>
          <Column id="publisherNm" type="STRING" size="256"/>
          <Column id="recdStatus" type="STRING" size="256"/>
          <Column id="receiveAmt" type="BIGDECIMAL" size="256"/>
          <Column id="applyAmt" type="BIGDECIMAL" size="256"/>
          <Column id="balAmt" type="BIGDECIMAL" size="256"/>
          <Column id="applyAmtOrg" type="BIGDECIMAL" size="256"/>
          <Column id="altNum" type="STRING" size="256"/>
          <Column id="altSeq" type="STRING" size="256"/>
          <Column id="advanceNum" type="STRING" size="256"/>
          <Column id="cntAdvance" type="INT" size="256"/>
          <Column id="acctCd" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="suspenseAltType" type="STRING" size="256"/>
          <Column id="suspenseAltTypeNm" type="STRING" size="256"/>
          <Column id="altDate" type="STRING" size="256"/>
          <Column id="sapCustCd" type="STRING" size="256"/>
          <Column id="sapSendYn" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="256"/>
          <Column id="journalzYn" type="STRING" size="256"/>
          <Column id="rowStatus" type="STRING" size="256"/>
          <Column id="sabun" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_suspenseAltType" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="typeCd" type="STRING" size="256"/>
          <Column id="typeNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : SuspenseAlterPop
  파 일 명 : SuspenseAlterPop.xfdl
  기    능 : 가수금대체팝업

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.03.30   JUN   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "lib::SMCommon.xjs";	//영업회계 공통 스크립트
include "U_lib::lib_conversionCom.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();
var fv_objColInfo; 		//가수금데이터셋 컬럼정보
var v_ds_check = "";
var iCurrow = 0;
var bCreateMode	= true;		// 신규모드(단, 부모창에서 대체번호를 가져올 경우 대체번호에 해당되는 대체정보만 조회한다. bCreateMode = false : 수정모드)

var dataSet = new Dataset();
var fv_title = "거래처 검색";
var fv_labelCode = "거래처 코드";
var fv_labelName = "거래처 명";
var fv_suspenseAltYn = "";

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo){

	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	this.custSearchDatasetName = "ds_" + this.name;
 	dataSet.id = this.custSearchDatasetName;
 	dataSet.name = this.custSearchDatasetName;
 	dataSet.addRow();
	dataSet.addColumn("qid", "STRING", "1000");
	dataSet.addColumn("custGubun", "STRING", "100");
	//[[기본은 매출(002) 거래처만 설정한다.
	dataSet.setColumn(dataSet.rowposition, "qid", "StCust");
	dataSet.setColumn(dataSet.rowposition, "custGubun", "002,003");

	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init(){

	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	v_ds_check = "ds_list";
	
	//조회조건 세팅
	fn_setSearchData();
	
	//콤보조회
	fn_setCombo();
		
	// 신규모드
	if(gfn_isNull(gv_altNum)){
		bCreateMode = true;
		btn_insert.visible = true;
		
	// 수정모드	
	}else{
		bCreateMode = false;
		btn_insert.visible = false;
		btn_save.visible = false;
		//grd_list.readonly = true;
		
		fn_search();
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 부모창 조회조건 세팅
 *---------------------------------------------------------------------------------------------*/
function fn_setSearchData(){

	ds_search.clearData();
	ds_search.addRow();

	if(arrSchVal.length > 0){
		ds_search.setColumn(0, "inqueryMuCd",    	arrSchVal[0]);
		ds_search.setColumn(0, "inqueryMuNm",    	arrSchVal[1]);
		ds_search.setColumn(0, "inqueryTmCd",    	arrSchVal[2]);
		ds_search.setColumn(0, "inqueryTmNm",    	arrSchVal[3]);
		ds_search.setColumn(0, "inqueryCcCd",    	arrSchVal[4]);
		ds_search.setColumn(0, "inqueryCcNm",    	arrSchVal[5]);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close(){	
	// v_ds_check 사용시 변경사항 체크
	if(gfn_length(v_ds_check) != 0){	
	
		// v_ds_check 설정기준 변경사항 체크
		if(gfn_isDataChange() == true){
			if(!gfn_confirm("confirm.before.movepage")) return false;	// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
		}
	}
	return true;
}

/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수-공통버튼)
************************************************************************************************/
 /*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 * gfn_transaction(
 * 		@param objForm         - Form Object(this)
 * 		@param strSvcID        - 트랜잭션을 구분하기 위한 ID
 * 		@param strURL          - 트랜잭션을 요청할 주소
 * 		@param strInDatasets   - 트랜잭션을 요청할 때 입력값으로 보낼 데이터셋의 ID
 * 		@param strOutDatasets  - 트랜잭션을 처리 결과를 받을 데이터셋의 ID
 * 		@param strArgument     - 트랜잭션을 위한 인자값
 * 		@param strCallbackFunc - 트랜잭션의 결과를 돌려줄 함수의 이름
 * 		@param bAsync          - 비동기 여부(true: Async, false : Sync)
 * 		@param bProgress       - Wait Cursor 표시여부 (true : 사용, false : 사용안함)
 * )
 *---------------------------------------------------------------------------------------------*/
function fn_search(){

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_list);

	//서비스 쿼리결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장
	fv_objColInfo = gfn_getDatasetInfo (ds_list);

	//ds_search.clearData();
	//var nRow = ds_search.addRow();
	ds_search.setColumn(0, "altNum",	gv_altNum);
	
    gfn_transaction(this
					,"search"
					,"sm/spm/suspenseAlterPop/selectList.xdo"
					,"ds_search=ds_search:A"
					,"ds_list=ds_list"
					,""
					,"fn_callBack"
					,true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 입력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert(){
	if(!bCreateMode){
		if(ds_list.rowcount > 0) ds_list.clearData();
	}else{
		gv_altNum = "";
	}
	fn_openPopup();	//가수금(통장입금) 내역 조회 팝업 호출
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete(){	//대체취소 처리

	var rCnt = 0;
	if(!bCreateMode){
	    for (var i=0;i<ds_list.rowcount;i++){
	        var cntAdvance = ds_list.getColumn(i,"cntAdvance");  //선수금대체처리카운트
	        var journalzYn = ds_list.getColumn(i,"journalzYn");  //분개여부  (마감여부 판단하기 위해)
	        
	        if (cntAdvance > 0){
				rCnt = i+1;
	            alert("["+rCnt+"]행 선수금대체로 취소불가합니다.");
	            return;
	        }
	        
	        if(journalzYn != "N"){
	            alert("전표 처리된 자료이므로 취소불가합니다.");
	            return;
	        }
	    }
		fn_saveSuspenseAlt("CANCEL");	//가수금 대체/대체취소 처리(PROC/CANCEL)
	}else{
		gfn_alert("msg.search.nodata");	// 조건에 해당하는 자료가 없습니다.
		return false;
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save(){		//대체 처리
	
	//12월 처리 제한 
	//alert(arrSchVal[0]);
	/*
	if(arrSchVal[0] == "2003"){
		//pass
	} else {
		
	    for (var i=0;i<ds_list.rowcount;i++){
			if ((ds_list.getColumn(i,"altDate") > '20201200') ) {
				ds_list.setColumn(i,"altDate","20201130");
				alert("12월 대체일자로 처리 불가(물리적 분리로 SAP처리 불가)");
				//ds_taxShetMst.setColumn(0, "publishDate","20201130");
				//ds_taxShetMst.setColumn(0, "fiscalDate","20201130");
				return;
			}
		}
	}
	*/

	fn_saveSuspenseAlt("PROC");	//가수금 대체/대체취소 처리(PROC/CANCEL)
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print(){

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help(){

}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg){
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0){
		return;
	}
	
    switch(strSvcID){

   		// 대체유형Combo 조회
        case "suspenseAltType" :
        
            if(ds_suspenseAltType.rowcount < 2){
				if(gfn_isNull(ds_suspenseAltType.getColumn(0, "typeCd"))){
					
					//데이터가 없을 경우 전체조회
					ds_suspenseAltType.clearData();
					gfn_setSalesTypeCd(this, "suspenseAltType2", "ds_suspenseAltType", "014");
				}
            }else{
				//ds_suspenseAltType.filter("typeCd=='L01' || typeCd=='L02'");
            }
            break;

   		// 대체유형Combo 조회
        case "suspenseAltType2" :
			//ds_suspenseAltType.filter("typeCd=='L01' || typeCd=='L02'");
            break;
        
        //조회
        case "search" :
			
			//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
			//if(ds_list.getRowCount() == 0) gfn_loadDatasetInfo (ds_list, fv_objColInfo);
            break;
 
        //가수금 잔액체크
		case "getSuspenseAltYn" :
			if(fv_suspenseAltYn == "N"){
				gfn_alert("가수금 잔액이 부족합니다.");
				return;
			}else{
				//alert(ds_list.rowcount);
				ds_list.updatecontrol = false;
				for(var i=0; i<ds_list.rowcount; i++){
					ds_list.setRowType(i, Dataset.ROWTYPE_INSERT);
				}
				//trace(ds_list.saveXML);
				gfn_saveSuspenseAltProc(this, "saveSuspenseAltProc", "ds_list");
			}
			break;
			
        //대체처리    
		case "saveSuspenseAltProc" :
			gfn_alert("가수금 대체처리가 완료 되었습니다.");
			ds_list.updatecontrol = true;
			this.opener.fn_search();
			this.close();
			break;
            
        //대체취소
		case "saveSuspenseAltCancel" :
			gfn_alert("가수금 대체취소가 완료 되었습니다.");
			this.opener.fn_search();
			this.close();
			break;
            
    }
}

/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 콤보/팝업조회
 *---------------------------------------------------------------------------------------------*/
function fn_setCombo(){

	//대체유형조회
	if(gfn_isNull(gv_altNum)){
		gfn_setSalesTypeCdByDept(	this
							,"suspenseAltType"
							,"ds_suspenseAltType"
							,"014"
							,ds_search.getColumn(0, "inqueryMuCd")
							,ds_search.getColumn(0, "inqueryTmCd")
							,ds_search.getColumn(0, "inqueryCcCd")
							,"S"
							);
	}else{
		gfn_setSalesTypeCdByDept(	this
							,"suspenseAltType"
							,"ds_suspenseAltType"
							,"014"
							,""
							,""
							,""
							,"S"
							);	
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : //가수금(통장입금) 내역 조회 팝업 호출
 *---------------------------------------------------------------------------------------------*/
function fn_openPopup(){
	
	var arrArg = new Array();
	
	arrArg[0] = ds_search.getColumn(0, "inqueryMuCd");
	arrArg[1] = ds_search.getColumn(0, "inqueryMuNm");
	arrArg[2] = ds_search.getColumn(0, "inqueryTmCd");
	arrArg[3] = ds_search.getColumn(0, "inqueryTmNm");
	arrArg[4] = ds_search.getColumn(0, "inqueryCcCd");
	arrArg[5] = ds_search.getColumn(0, "inqueryCcNm");
	arrArg[6] = null;	//조회년월
	arrArg[7] = null;	//입금유형
			
	var dsObj = gfn_dialog(	"SuspenseDescInquiry"
							,"X_SAR::SuspenseDescInquiry.xfdl"
							,{arrSchVal:arrArg}
							,-1		//Width
							,-1		//Height
							,""		//Style
							,-1		//Left
							,-1		//Top
							,false	//Modeless
							,true	//ShowTitle
							,"-1"	//Align
							,true);	//Resizable
							
	//ds_list.assign(dsObj);
	//ds_list.copyData(dsObj,true);
	if(dsObj != undefined) fn_setDataList(dsObj);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 가수금 팝업 데이터 적용 - 디버깅을 위해 copyData를 사용하지 않음
 *---------------------------------------------------------------------------------------------*/
function fn_setDataList(dsObj){
 		
	if(ds_list.rowcount > 0) ds_list.clearData();
	
	var nRow = 0;

	//ds_list.assign(dsObj);
	//ds_list.copyData(dsObj,true);
	
	if(dsObj.rowcount > 0){
	
		gv_altNum	= "";

		for(var i=0; i<dsObj.rowcount; i++){
			nRow = ds_list.addRow();
			ds_list.setColumn(nRow, "buCd",             dsObj.getColumn(i, "buCd"));
			ds_list.setColumn(nRow, "sapSuspenseNum",   dsObj.getColumn(i, "sapSuspenseNum"));
			ds_list.setColumn(nRow, "receiveDate",      dsObj.getColumn(i, "receiveDate"));
			ds_list.setColumn(nRow, "bankCd",           dsObj.getColumn(i, "bankCd"));
			ds_list.setColumn(nRow, "bankCdNm",         dsObj.getColumn(i, "bankCdNm"));
			ds_list.setColumn(nRow, "bankAcctNo",       dsObj.getColumn(i, "bankAcctNo"));
			ds_list.setColumn(nRow, "bankAcctNoMsk",    dsObj.getColumn(i, "bankAcctNoMsk"));
			ds_list.setColumn(nRow, "currency",         dsObj.getColumn(i, "currency"));
			ds_list.setColumn(nRow, "receiveGuestNm",   dsObj.getColumn(i, "receiveGuestNm"));
			ds_list.setColumn(nRow, "ccCd",             dsObj.getColumn(i, "ccCd"));
			ds_list.setColumn(nRow, "ccNm",             dsObj.getColumn(i, "ccNm"));
			ds_list.setColumn(nRow, "muCd",             dsObj.getColumn(i, "muCd"));
			ds_list.setColumn(nRow, "muNm",             dsObj.getColumn(i, "muNm"));
			ds_list.setColumn(nRow, "sapSlipNum",       dsObj.getColumn(i, "sapSlipNum"));
			ds_list.setColumn(nRow, "classCd",          dsObj.getColumn(i, "classCd"));
			ds_list.setColumn(nRow, "notesPublishDate", dsObj.getColumn(i, "notesPublishDate"));
			ds_list.setColumn(nRow, "notesExpireDate",  dsObj.getColumn(i, "notesExpireDate"));
			ds_list.setColumn(nRow, "notesNum",         dsObj.getColumn(i, "notesNum"));
			ds_list.setColumn(nRow, "publisherNm",      dsObj.getColumn(i, "publisherNm"));
			ds_list.setColumn(nRow, "recdStatus",       dsObj.getColumn(i, "recdStatus"));
			ds_list.setColumn(nRow, "receiveAmt",       dsObj.getColumn(i, "receiveAmt"));
			ds_list.setColumn(nRow, "applyAmt",         dsObj.getColumn(i, "applyAmt"));
			ds_list.setColumn(nRow, "applyAmtOrg",      dsObj.getColumn(i, "applyAmt"));
			ds_list.setColumn(nRow, "balAmt",           dsObj.getColumn(i, "balAmt"));
			ds_list.setColumn(nRow, "altNum",           dsObj.getColumn(i, "altNum"));
			ds_list.setColumn(nRow, "altSeq",           dsObj.getColumn(i, "altSeq"));
			ds_list.setColumn(nRow, "advanceNum",       dsObj.getColumn(i, "advanceNum"));
			ds_list.setColumn(nRow, "acctCd",           dsObj.getColumn(i, "acctCd"));
			ds_list.setColumn(nRow, "custCd",           dsObj.getColumn(i, "custCd"));
			ds_list.setColumn(nRow, "custNm",           dsObj.getColumn(i, "custNm"));
			ds_list.setColumn(nRow, "suspenseAltType",  dsObj.getColumn(i, "suspenseAltType"));
			ds_list.setColumn(nRow, "suspenseAltTypeNm",dsObj.getColumn(i, "suspenseAltTypeNm"));
			ds_list.setColumn(nRow, "altDate",          dsObj.getColumn(i, "altDate"));
			ds_list.setColumn(nRow, "sapCustCd",        dsObj.getColumn(i, "sapCustCd"));
			ds_list.setColumn(nRow, "sapSendYn",        dsObj.getColumn(i, "sapSendYn"));
			ds_list.setColumn(nRow, "remark",           dsObj.getColumn(i, "remark"));
			ds_list.setColumn(nRow, "sabun",            g_EmpNo);
			
			if(gfn_isNull(dsObj.getColumn(i, "altNum"))){
				ds_list.setColumn(nRow, "altDate",          	fv_sToday);
				ds_list.setColumn(nRow, "suspenseAltType",  	"");
				ds_list.setColumn(nRow, "suspenseAltTypeNm",  	"");
			}
		}
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 가수금 대체/대체취소 처리(PROC/CANCEL) - 저장
 *---------------------------------------------------------------------------------------------*/
function fn_saveSuspenseAlt(arg){

	//대체처리/취소 Vailidation 체크
	if(!fn_chkSaveInfo(arg)) return;
	
	//가수금대체 Master/Detail Setting
	fn_setSuspenseAltInfo(arg);
	
	//가수금대체처리
	if(arg == "PROC"){

		// v_ds_check 미사용시 변경사항 체크
		if(gfn_dsIsUpdated(ds_list) == false){
			gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
			return false;
		}
		for(var i=0; i<ds_list.rowcount; i++){
			mfn_GetCcMonthClsYn("C", ds_list.getColumn(i,"ccCd"), gfn_subStr(ds_list.getColumn(i,"altDate"), 0, 6), "01");
			if (ds_common.getColumn(0, 0) == "Y")
			{
				g_Message("EE", "해당월은 월마감이 완료되어 작업할 수 없습니다.");
				ds_list.setColumn(i, "altDate", fv_sToday);
				return false; 
			}	
		}

		if(gfn_confirm("가수금 대체처리 하시겠습니까?")){
		
			//가수금 잔액체크
			gfn_getSuspenseAltYn(this, "getSuspenseAltYn", "ds_list");
			//gfn_saveSuspenseAltProc(this, "saveSuspenseAltProc", "ds_list");
		}
		
	//가수금대체취소처리
	}else if(arg == "CANCEL"){
	
		if(gfn_confirm("가수금 대체취소 하시겠습니까?")){
			gfn_saveSuspenseAltCancel(this, "saveSuspenseAltCancel", "ds_list");
		}
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 대체처리/취소 Vailidation 체크
 *---------------------------------------------------------------------------------------------*/
function fn_chkSaveInfo(arg){
	if(ds_list.rowcount == 0){
		gfn_alert("msg.search.nodata");	// 조건에 해당하는 자료가 없습니다.
		return false;
	}
/*
	//전표발행여부 체크
	for(var i=0; i<ds_list.rowcount; i++){
	//alert(ds_list.getColumn(i, "journalzYn"));
		if(ds_list.getColumn(i, "journalzYn") != "N"){
			gfn_alert("이미 전표가 발행된 가수금정보는 대체처리/취소할 수 없습니다.");
			ds_list.rowposition = i;
			return false;
		}
	}
*/
	if(arg == "PROC"){	//대체처리
		var iApplyAmtSum = 0;	//대체금액의 합

		// v_ds_check 미사용시 변경사항 체크
		if(gfn_dsIsUpdated(ds_list) == false){
			gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
			return false;
		}else{
			for(var i=0; i<ds_list.rowcount; i++){

				if(gfn_isNull(ds_list.getColumn(i, "suspenseAltType"))){
					gfn_alert("msg.noselect", "대체유형코드");	// $1 을(를) 선택해 주십시요.
					ds_list.selectRow(i);
					return false;
				}
				if(gfn_isNull(ds_list.getColumn(i, "altDate"))){
					gfn_alert("msg.noinput", "대체일자");	// $1 을(를) 입력해 주십시요.
					ds_list.selectRow(i);
					return false;
				}
				if(ds_list.getColumn(i, "suspenseAltType") == "L04" || ds_list.getColumn(i, "suspenseAltType") == "L06" || ds_list.getColumn(i, "suspenseAltType") == "L09"){
					if(gfn_isNull(ds_list.getColumn(i, "custCd"))){
						gfn_alert("msg.noinput", "고객사");	// $1 을(를) 입력해 주십시요.
						ds_list.selectRow(i);
						return false;
					}
				}
				if(gfn_isNull(ds_list.getColumn(i, "remark"))){
					gfn_alert("msg.noinput", "적요");	// $1 을(를) 입력해 주십시요.
					ds_list.selectRow(i);
					return false;
				}
				iApplyAmtSum += ds_list.getColumn(i, "applyAmt");
			}
			if(iApplyAmtSum == 0){
				gfn_alert("대체금액의 합이 0 이므로 대체처리할 수 없습니다.");
				//ds_list.reset();
				return false;
			}
		}
	}
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 가수금대체(PROC)/취소(CANCEL) Setting
 *---------------------------------------------------------------------------------------------*/
function fn_setSuspenseAltInfo(arg){
	
	var iApplyAmt 	= 0;
	var sAltNum		= "";
	var sRowStatus	= "";
	
	//가수금대체
	if(arg == "PROC"){
		
		//신규/수정 구분
		if(gfn_isNull(gv_altNum)) sRowStatus = "INSERT";
		else sRowStatus = "UPDATE";
		
		for(var i=0; i<ds_list.rowcount; i++){
			ds_list.setColumn(i, "rowStatus",	sRowStatus);
			ds_list.setColumn(i, "sabun",       g_EmpNo);
		}
		
	//가수금대체취소
	}else if(arg == "CANCEL"){
		for(var i=0; i<ds_list.rowcount; i++){
			if(!gfn_isNull(ds_list.getColumn(i, "altNum"))){
				//ds_list.setColumn(i, "applyAmtOrg",	Number(ds_list.getColumn(i, "receiveAmt")) + Number(ds_list.getColumn(i, "applyAmt")));
				ds_list.setColumn(i, "recdStatus", "D");
				ds_list.setColumn(i, "rowStatus",  "CANCEL");	//전체 대체취소
				ds_list.setColumn(i, "sabun",      g_EmpNo);
			}
		}
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : Grid 입력폼 변경
 *---------------------------------------------------------------------------------------------*/
function fn_setGridEditType(arg){
	if(bCreateMode){
		return arg;
	}else{
		return "none";
	}
}

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 포커스를 가진 레코드만 입력형태로 변환 EVENT
 *---------------------------------------------------------------------------------------------*/
function ds_list_onrowposchanged(obj:Dataset, e:DSRowPosChangeEventInfo){
	//iCurrow=e.newrow;
}

/*----------------------------------------------------------------------------------------------
 * 거래처 버튼 클릭   팝업뛰움
 *---------------------------------------------------------------------------------------------*/
function grd_list_onexpanddown(obj:Grid, e:GridMouseEventInfo)
{
// 	if(!bCreateMode){
// 		if(ds_list.rowcount > 0) ds_list.clearData();
// 	}else{
// 		gv_altNum = "";
// 	}
	//대체유형이 선수금(사업장) 인 경우 거래처 선택
	if (ds_list.getColumn(e.row, "suspenseAltType") == "L04" || ds_list.getColumn(e.row, "suspenseAltType") == "L06" || ds_list.getColumn(e.row, "suspenseAltType") == "L09"){
	    //[[팝업창을 호출한다.
		var strId       = "CustSearch";
		var strURL      = "cmn::CustSearchPop.xfdl";
		var objArgument = {
			P_DATASET    : dataSet,
			P_TITLE      : fv_title,
			P_LABEL_CODE : fv_labelCode,
			P_LABEL_NAME : fv_labelName
		};
		var nWidth      = 513;
		var nHeight     = 495;
		var strStyle    = "";
		var nLeft       = -1;
		var nTop        = -1;
		var isModeless  = false;
		var bShowTitle  = true;
		var strAlign    = "-1";

		// 리턴값을 배열로 받을 경우	
		var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
		
		if (arrRtn instanceof Object)
		{
			ds_list.setColumn(e.row, "custCd", arrRtn.custCode);
			ds_list.setColumn(e.row, "custNm", arrRtn.custName);
			ds_list.setColumn(e.row, "sapCustCd", arrRtn.sapCustCd);
			
			//[[After Event를 정의한다.
			if (!gfn_isNull(this.eventAfterTrigger))
			{
				var afterEvent = eval("parent."+this.eventAfterTrigger);
				afterEvent(this, arrRtn);
			}
			//After Event를 정의한다.]]
		}
	}
}

/*----------------------------------------------------------------------------------------------
 * 대체유형 변경에 대해 선수금(사업장)이 아니면 거래처 blank 처리
 *---------------------------------------------------------------------------------------------*/
function ds_list_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if (e.columnid == "suspenseAltType"){
	    if (obj.getColumn(e.row, "suspenseAltType") != "L04" && obj.getColumn(e.row, "suspenseAltType") != "L06" && ds_list.getColumn(e.row, "suspenseAltType") != "L09"){
	        obj.setColumn(e.row, "custCd", "");
	        obj.setColumn(e.row, "custNm", "");
	        obj.setColumn(e.row, "sapCustCd", "");
	    }
	}
}


]]></Script>
  </Form>
</FDL>

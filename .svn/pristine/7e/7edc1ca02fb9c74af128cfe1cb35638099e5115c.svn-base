<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSI00050E" onload="form_onload" titletext="업장표준레시피 자재일괄수정" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Div id="divFSI00051V" taborder="16" tabstop="false" text="Div0" url="U_FSI::FSI00051V.xfdl" position="absolute 0 110 595 410" scrollbars="none" anchor="left top"/>
        <Div id="divFSI00052V" taborder="17" tabstop="false" text="Div0" url="U_FSI::FSI00052V.xfdl" position="absolute 0 410 595 710" scrollbars="none" anchor="left top bottom"/>
        <Div id="divFSI00053V" onkeydown="fn_form_OnKeyDown" taborder="18" tabstop="false" text="Div0" url="U_FSI::FSI00053V.xfdl" position="absolute 595 110 1248 664" scrollbars="none" anchor="all"/>
        <Div id="divFSI00054V" onkeydown="fn_form_OnKeyDown" taborder="19" tabstop="false" text="Div0" url="U_FSI::FSI00054V.xfdl" visible="false" position="absolute 395 390 495 419" scrollbars="none"/>
        <Static id="Static13" position="absolute 595 663 1237 691" class="sta_WFSA_Labelbg" anchor="left right bottom"/>
        <Button id="btnITEM_CHANGE" onclick="btnITEM_CHANGE_OnClick" taborder="20" tabstop="false" text="자재 일괄 변경 적용  " position="absolute 939 666 1086 688" class="btn_WF_Save" image="" style="align:right;" anchor="right bottom"/>
        <Button id="btn_FSI00057V" onclick="btn_FSI00057V_OnClick" taborder="21" tabstop="false" text="자재 일괄 수정 이력 조회" position="absolute 1088 666 1235 688" class="btn_WF_Custom" image="" anchor="right bottom"/>
        <PopupDiv id="pdiv_Detail" taborder="15" tabstop="false" position="absolute 608 246 1076 470" scrollbars="none">
          <Layouts>
            <Layout>
              <Static id="st10" class="sta_WFDA_Label01" position="absolute 4 4 457 212"/>
              <Grid id="grd_detail" taborder="0" binddataset="ds_item_list" scrollbars="alwaysvert" wheelscrollrow="1" autoenter="select" useinputpanel="false" cellsizingtype="both" onheadclick="grd_list_OnHeadClick" onenterdown="pdiv_menu_grd_list_OnEnterDown" position="absolute 6 6 454 210">
                <Formats>
                  <Format id="Default">
                    <Columns>
                      <Column size="78"/>
                      <Column size="138"/>
                      <Column size="97"/>
                      <Column size="51"/>
                      <Column size="65"/>
                    </Columns>
                    <Rows>
                      <Row size="26" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell displaytype="text" text="자재코드"/>
                      <Cell col="1" displaytype="text" text="자재명"/>
                      <Cell col="2" displaytype="text" text="규격"/>
                      <Cell col="3" displaytype="text" text="단위"/>
                      <Cell col="4" displaytype="text" text="1인량(g)"/>
                    </Band>
                    <Band id="body">
                      <Cell displaytype="text" style="align:left;" text="bind:ITEM_CODE"/>
                      <Cell col="1" displaytype="text" style="align:left;" text="bind:ITEM_NAME"/>
                      <Cell col="2" displaytype="text" style="align:left;" text="bind:ITEM_SIZE"/>
                      <Cell col="3" displaytype="text" style="align:left;" text="bind:PO_UOM"/>
                      <Cell col="4" displaytype="number" style="align:left;" text="bind:NEED_QTY"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
            </Layout>
          </Layouts>
        </PopupDiv>
        <Static id="Static3" text="☞자재일괄수정 시 이미 등록된 식단에는 적용되지 않습니다. 구축된 업장표준레시피에만 적용됩니다." position="absolute 5 699 565 712" class="sta_WF_DiscInfoN"/>
        <Static id="Static4" text="*원가는 조회 시점의 사업장 원가입니다." visible="false" position="absolute 567 699 789 713" class="sta_WF_DiscInfoN"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="22" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 97 1034 110"/>
        <Static id="Static29" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 97" anchor="left top right"/>
        <Static id="Static34" text="W10" visible="false" position="absolute 338 40 348 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static35" text="W30" visible="false" position="absolute 263 40 293 63" style="background:#ff000055;align:center middle;"/>
        <Static id="Static43" text="W10" visible="false" position="absolute 14 30 1117 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static44" text="W10" visible="false" position="absolute 14 87 1117 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static45" text="W15" visible="false" position="absolute -1 30 14 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static51" text="W05." visible="false" position="absolute 14 61 1087 66" style="background:#ff000055;align:center middle;"/>
        <Static id="Static50" text="W10" visible="false" position="absolute 86 66 96 87" style="background:#ff000055;align:center middle;"/>
        <Static id="st_ContractStart" text="사업장" class="sta_WFSA_label" position="absolute 15 40 77 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 141 64 151 85" anchor="left top"/>
        <Button id="btnRECIPE_ALL_CHECK" onclick="btnRECIPE_ALL_CHECK_OnClick" taborder="5" tabstop="false" text="레시피분류 선택" position="absolute 14 66 140 88" class="btn_WF_Custom" image=""/>
        <Static id="st_ContractStart00" text="식당군" class="sta_WFSA_label" position="absolute 293 40 355 61" anchor="left top"/>
        <Static id="Static05" text="W10" visible="false" position="absolute 61 40 71 61" style="background:#ff000055;align:center middle;"/>
        <Edit autoselect="true" id="ed_UPJANG" imemode="native" onkeydown="ed_Upjang_OnKeyDown" readonly="true" taborder="2" position="absolute 71 40 243 61" userdata=""/>
        <Button id="btn_Upjang" onclick="btn_Upjang_OnClick" taborder="3" tabstop="false" text="" position="absolute 242 40 263 61" class="btn_WF_popSearch" image=""/>
        <Combo codecolumn="HALL_CLASS" datacolumn="HALL_CLASS_NAME" displayrowcount="10" id="cbo_UP_HALL_CLASS" innerdataset="ds_cbo_UP_HALL_CLASS" taborder="4" position="absolute 348 40 506 61"/>
        <CheckBox id="chk0" taborder="23" tabstop="false" position="absolute 151 66 233 86" onclick="chk0_onclick"/>
        <CheckBox id="chk1" taborder="24" tabstop="false" position="absolute 234 66 316 86" onclick="chk1_onclick"/>
        <CheckBox id="chk2" taborder="25" tabstop="false" position="absolute 318 66 400 86" onclick="chk2_onclick"/>
        <CheckBox id="chk3" taborder="26" tabstop="false" position="absolute 402 66 484 86" onclick="chk3_onclick"/>
        <CheckBox id="chk4" taborder="27" tabstop="false" position="absolute 486 66 568 86" onclick="chk4_onclick"/>
        <CheckBox id="chk5" taborder="28" tabstop="false" position="absolute 570 66 652 86" onclick="chk5_onclick"/>
        <CheckBox id="chk6" taborder="29" tabstop="false" position="absolute 654 66 736 86" onclick="chk6_onclick"/>
        <CheckBox id="chk7" taborder="30" tabstop="false" position="absolute 738 66 820 86" onclick="chk7_onclick"/>
        <CheckBox id="chk8" taborder="31" tabstop="false" position="absolute 822 66 904 86" onclick="chk8_onclick"/>
        <CheckBox id="chk9" taborder="32" tabstop="false" position="absolute 906 66 988 86" onclick="chk9_onclick"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static2" text="▼" position="absolute 256 394 290 424" style="font:Gulim,26;"/>
        <Static id="Static03" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 691 1228 696" anchor="left top"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cuisine_type"/>
      <Dataset id="ds_recipe_type"/>
      <Dataset id="ds_recipe_class"/>
      <Dataset id="ds_cbo_item_classM51">
        <ColumnInfo>
          <Column id="CLASS_CODE" size="255" type="STRING"/>
          <Column id="CLASS_NAME" size="255" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cbo_item_classS51">
        <ColumnInfo>
          <Column id="CLASS_CODE" size="8" type="STRING"/>
          <Column id="CLASS_NAME" size="50" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cbo_item_classD51">
        <ColumnInfo>
          <Column id="CLASS_CODE" size="8" type="STRING"/>
          <Column id="CLASS_NAME" size="50" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SEARCH_ITEM_BEFORE" onload="ds_SEARCH_ITEM_BEFORE_OnLoadCompleted" onrowposchanged="ds_SEARCH_ITEM_BEFORE_OnRowPosChanged">
        <ColumnInfo>
          <Column id="ITEM_CODE" size="12" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="ITEM_INFO" size="100" type="STRING"/>
          <Column id="ITEM_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="KG_CONVERT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="G_ITEM_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="DISUSE_RATE" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SELECT_ITEM_BEFORE">
        <ColumnInfo>
          <Column id="ITEM_CODE" size="12" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="ITEM_INFO" size="100" type="STRING"/>
          <Column id="ITEM_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="KG_CONVERT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="G_ITEM_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="DISUSE_RATE" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cbo_item_classD52">
        <ColumnInfo>
          <Column id="CLASS_CODE" size="8" type="STRING"/>
          <Column id="CLASS_NAME" size="50" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cbo_item_classM52">
        <ColumnInfo>
          <Column id="CLASS_CODE" size="255" type="STRING"/>
          <Column id="CLASS_NAME" size="255" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cbo_item_classS52">
        <ColumnInfo>
          <Column id="CLASS_CODE" size="8" type="STRING"/>
          <Column id="CLASS_NAME" size="50" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SEARCH_ITEM_AFTER" onload="ds_SEARCH_ITEM_AFTER_OnLoadCompleted" onrowposchanged="ds_SEARCH_ITEM_AFTER_OnRowPosChanged">
        <ColumnInfo>
          <Column id="ITEM_CODE" size="12" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="ITEM_INFO" size="100" type="STRING"/>
          <Column id="ITEM_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="KG_CONVERT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="G_ITEM_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="DISUSE_RATE" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SELECT_ITEM_AFTER">
        <ColumnInfo>
          <Column id="ITEM_CODE" size="12" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="ITEM_INFO" size="100" type="STRING"/>
          <Column id="ITEM_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="KG_CONVERT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="G_ITEM_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="DISUSE_RATE" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_STD_RECIPE_MST">
        <ColumnInfo>
          <Column id="RECIPE_CD" size="20" type="STRING"/>
          <Column id="RECIPE_NAME" size="50" type="STRING"/>
          <Column id="RECIPE_CLASS" size="20" type="STRING"/>
          <Column id="RECIPE_CLASS_NAME" size="100" type="STRING"/>
          <Column id="RECIPE_TYPE" size="20" type="STRING"/>
          <Column id="RECIPE_TYPE_NAME" size="100" type="STRING"/>
          <Column id="CUISINE_TYPE" size="20" type="STRING"/>
          <Column id="CUISINE_TYPE_NAME" size="100" type="STRING"/>
          <Column id="ITEM_CODE" size="12" type="STRING"/>
          <Column id="CHK_YN" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_where050">
        <ColumnInfo>
          <Column id="AFTER_ITEM_CODE" size="256" type="STRING"/>
          <Column id="BEFORE_ITEM_CODE" size="256" type="STRING"/>
          <Column id="HALL_CLASS_RECIPE_CD" size="256" type="STRING"/>
          <Column id="RECIPE_CLASS" size="256" type="STRING"/>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="HALL_CLASS" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cbo_UP_HALL_CLASS"/>
      <Dataset id="ds_item_list"/>
      <Dataset id="ds_input">
        <ColumnInfo>
          <Column id="RECIPE_TYPE" size="256" type="STRING"/>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="HALL_CLASS" size="256" type="STRING"/>
          <Column id="RECIPE_CD" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="HALL_CLASS"/>
            <Col id="RECIPE_CD"/>
            <Col id="RECIPE_TYPE"/>
            <Col id="UPJANG"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_check050"/>
    </Objects>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분: IFIS/자재관리/업장표준레시피자재일괄수정
 * 프로그램명: FSI00050E.XML
 * 기ㅡㅡㅡ능: 업장표준레시피 자재일괄 수정
 * 작ㅡ성ㅡ자: 한화S&C 박종세
 * 작성ㅡ일자: 2008-05-13
 * ----------------------------------------------------------------------------------------
 * HISTORY  :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//========================================================================================= 
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"		// 사업장팝업용 Lib
//@@컨버터에서 주석처리 #include "lib::fs_common.js"

//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================

//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	   //폼 초기화
		fn_InitForm(obj);
}

//폼 초기화
function fn_InitForm(obj)
{
	// action 정보 생성 초기화 
	fsp_init(this);	

	//----------업장권한설정---------------------------
	fn_SetAuth("","","ed_UPJANG", "btn_Upjang");
	
	//////////////////////////////////////////////////////
	/// 사업장 권한일 경우 해당 사업장 고정값 
	/// 2008.05.16
	/////////////////////////////////////////////////////
   	if(toNumber(g_AuthLevel) < 99)
	{
		ed_UPJANG.enable = false;
		btn_Upjang.enable = false;
	}
	
	
	// 폼 데이터 초기화
	fn_InitData(false);
}

// 폼데이터 초기화 
function fn_InitData(blnAllClear)
{
	
	/*****************************************************************************************
     * 기      능   :  대 중 소 분류  자재 분류 데이터 조회-41V, 42V 공통으로 사용
     *****************************************************************************************/
	// action 정보 초기화 
	fsp_clear(this);
   	// 자재 대분류 조회  
	fsp_addSearch(this, "fs/fsi:FSI00010E_S002");	
    // 자재 중분류 조회  
	fsp_addSearch(this, "fs/fsi:FSI00010E_S003");
    // 자재 소분류 조회  
	fsp_addSearch(this, "fs/fsi:FSI00010E_S004");

    var strUPJANG  = "";
    var strDataSet = "";
	if(gfn_length(ed_UPJANG.userdata)!=0)
	{
		// 업장별 식당군 가져오기 
		fsp_addSearch(this, "fs/fsc:FSC_UPJANG_HALL_CLASS_S001");
		// 업장별 레시피 가져오기 
		fsp_addSearch(this, "fs/fsc:FSC_UPJANG_RECIPE_S001");
		strUPJANG="UPJANG="+  wrapQuote(ed_UPJANG.userdata);
		//식당군 *BLANK='A' --전체 *USE_YN='Y' 사용하는 식당만  *HALL_CD='' 해당식당의 식당군 
		
		strDataSet="ds_cbo_UP_HALL_CLASS=ds_UP_HALL_CLASS ds_recipe_class=ds_out ";
    }
	
	// 서버 호출 
	fsp_callService(this, "", "", "", strDataSet + "ds_cbo_item_classM51=ds_cbo_item_classM ds_cbo_item_classS51=ds_cbo_item_classS ds_cbo_item_classD51=ds_cbo_item_classD ", "BLANK='Y' USE_YN='Y' "+ strUPJANG , "fn_After_InitData");
}


//초기화 콜백함수
function fn_After_InitData()
{

	Copy(ds_cbo_item_classM52,"ds_cbo_item_classM51");
	Copy(ds_cbo_item_classS52,"ds_cbo_item_classS51");
	Copy(ds_cbo_item_classD52,"ds_cbo_item_classD51");	
	
    divFSI00051V.ed_item_name.setFocus();
    
    //업장별 레시피 분류 만들기 ===>> FSI00053V :: 폼 로드 동기화 문제 때문에... 이곳에서 구현
    ds_recipe_class.deleteRow(0);
   
    fn_MakeRecipeClassCheckbox();
    
    
    //////////////////////////
    // 기존조회데이터 삭제하기
    //////////////////////////
    ds_SEARCH_ITEM_BEFORE.clearData();
    ds_SEARCH_ITEM_AFTER.clearData();
    ds_STD_RECIPE_MST.clearData();
    
    
    //업장으로 포커싱
    ed_UPJANG.setFocus();
}


//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*------------------------------------------------------------
	1. Function ID : fn_Search()
	2. 개       요 : 업무프로세스에 따른 조회작업
	3. 기       능 : 검색버튼 입력 시 처리되는 작업
	4. 인 수 설 명:
*------------------------------------------------------------*/
function fn_search()
{
	  //필수 입력사항 체크-----------------------------------------------------------------------
	  // if (!fn_Chk_SearchKey()) return fasle;
	
	  //조회 조건만들기-----------------------------------------------------------------------

	  // action 정보 삭제 초기화 
	  // tit_clearActionInfo(this);
		
	  // 서버에서 조회할 정보 추가 
	  //tit_addSearchActionInfo(this, "fs/fsa:FSA00050E_S001");
		
	  // 서버 호출 
	  //http.sync = true;
	  //tit_callService(this, "", "", "", "ds_hall_class=ds_out ds_template_obj=ds_list" , "UPJANG="+ Quote(strUPJANG), "fn_After_Search");	
	  //조회 실행-----------------------------------------------------------------------------
	  //http.sync = false;
}

// 조회 후 콜백 함수 
function fn_After_Search()
{
   // 데이터셋 플래그 클리어
	//ds_template_obj.ApplyChange();
}

// 조회 조건 검색
function fn_Chk_SearchKey()
{
   //체크로직- 틀리면 return false;    
   return true;
}



/*------------------------------------------------------------
	1. Function ID : fn_Insert()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명:
*------------------------------------------------------------*/
function fn_insert()
{
   //데이터셋 로우 추가
   //ds_template_obj.AddRow();				   

    //신규추가시 기본값 설정
	//fn_SetDefaultNewRow();
}

// 신규추가시 기본값 설정
function fn_SetDefaultNewRow()
{   
}



/*------------------------------------------------------------
	1. Function ID : fn_Delete()
	2. 개       요 : 업무프로세스에 따른 정보 삭제작업
	3. 기       능 : 삭제버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*------------------------------------------------------------*/
function fn_delete()
{
    // 삭제 확인메세지 호출
	//if (!fn_Call_DeleteMsg()){ return false; }							
	
    // 데이터셋이 Insert일 경우는 DeleteRow만 실행한다. 
    //if(fn_chk_rowtypeInsert_deleteRow(ds_template_obj)){return false;}

	// TO DO 식당마스터를 삭제하기전에  지울수 있는지 확인한다.				
	//if(!fn_chk_canDeleteRow(ds_template_obj)){return false;}				
	
	// 데이터셋 삭제
	//ds_template_obj.DeleteRow(ds_template_obj.row);
				
	// 트랜잭션 시작 
	//tit_clearActionInfo(this);
				
	//삭제
	//tit_addSaveActionInfo(this, "", "","fs/fsa:FSA00050E_D003", "", "", "", "");
					
	// 서버 호출 
	//tit_callService(this, "", "", "ds_in=ds_template_obj:U", "", "", "fn_After_Delete()");
	// 트랜잭션 종료 
	
	//}
}

//삭제 후 콜백 함수 
function fn_After_Delete()
{

}

//삭제 가능여부 체크
function fn_chk_canDeleteRow(ds_template_obj)
{
	//체크로직- 틀리면 return false;
	return true;
}



/*------------------------------------------------------------
	1. Function ID : fn_Save()
	2. 개       요 : 업무프로세스에 따른 정보 저장작업
	3. 기       능 : 저장버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*------------------------------------------------------------*/
function fn_save()
{
 	// 데이터 유효성 검사
	 if (!fn_DataValidation()){	return false; }
			
	  //조회 조건만들기-----------------------------------------------------------------------
	  //레시피 코드 만들기 
	  var strRECIPE_CD = "";
	  var rowCnt_CD=ds_STD_RECIPE_MST.rowcount;
	
	  for(var i=0;i<rowCnt_CD;i++)
	  {  if(ds_STD_RECIPE_MST.getColumn(i,"CHK_YN")==1)
	     { strRECIPE_CD += ds_STD_RECIPE_MST.getColumn(i,"RECIPE_CD") + ",";}
	  }
	  var arrRECIPE_CD = gfn_split(strRECIPE_CD,",");
	  
	  
	  //식당군 코드 만들기
	  var strHALL_CLASS = "";
	  
	  for(var i=0;i<rowCnt_CD;i++)
	  {  if(ds_STD_RECIPE_MST.getColumn(i,"CHK_YN")==1)
	     { strHALL_CLASS += ds_STD_RECIPE_MST.getColumn(i,"HALL_CLASS") + ",";}
	  }
	  var arrHALL_CLASS = gfn_split(strHALL_CLASS,",");
	  
	  
	  
	  //레시피 클래스(분류) 만들기 
	  var strRECIPE_CLASS = "";
	  var rowCnt_CLASS=ds_recipe_class.rowcount;			
	  for(var i=0;i<rowCnt_CLASS;i++)
	  {
		 var chkObj = eval("chk"+i);
		 if (chkObj.value)
		 {
		 	strRECIPE_CLASS+=chkObj.userdata + ",";		
		 }
	  }
	  var arrRECIPE_CLASS = gfn_split(strRECIPE_CLASS,",");
	 
	 
	 //-------------------------------------------------------
	 //--- 레시피 클래스(분류)가 선택되었는지 확인합니다.
	 //------------------------------------------------------
	 if((gfn_length(arrRECIPE_CD)==0)&&(gfn_length(arrRECIPE_CLASS)==0))
	 { 
	    g_Message("EE","변경하시려는 레시피 분류를 선택하시거나 레시피를 선택해야 합니다.");
	    return false;
	 }
/*	  
	  // 조회 임시 데이터셋 생성
	  ds_where050.AddRow();
	  ds_where050.SetColumn(0,"AFTER_ITEM_CODE",  ds_SELECT_ITEM_AFTER.GetColumn(ds_SELECT_ITEM_AFTER.currow,"ITEM_CODE"));
	  ds_where050.SetColumn(0,"BEFORE_ITEM_CODE", ds_SELECT_ITEM_BEFORE.GetColumn(ds_SELECT_ITEM_BEFORE.currow,"ITEM_CODE"));
	  ds_where050.SetColumn(0,"UPJANG", ed_UPJANG.UserData);
	  ds_where050.SetColumn(0,"HALL_CLASS", cbo_UP_HALL_CLASS.Value);
*/

	  // 레시피 코드가 선택되지 않았을 경우는 레시피 분류만 사용
	  if((rowCnt_CD<=0) || (gfn_length(arrRECIPE_CD)<1))
	  {
		  for(var i=0; i<gfn_length(arrRECIPE_CLASS);i++)
		  {  
				ds_where050.addRow();
				ds_where050.setColumn(i,"AFTER_ITEM_CODE",  ds_SELECT_ITEM_AFTER.getColumn(ds_SELECT_ITEM_AFTER.rowposition,"ITEM_CODE"));
				ds_where050.setColumn(i,"BEFORE_ITEM_CODE", ds_SELECT_ITEM_BEFORE.getColumn(ds_SELECT_ITEM_BEFORE.rowposition,"ITEM_CODE"));
				ds_where050.setColumn(i,"UPJANG", ed_UPJANG.userdata);
				ds_where050.setColumn(i,"HALL_CLASS", cbo_UP_HALL_CLASS.value);
				//
				ds_where050.setColumn(i,"RECIPE_CLASS", arrRECIPE_CLASS[i]);
				//ds_where050.AddRow();
		  }
		  //if(length(arrRECIPE_CLASS)>0){ds_where050.DeleteRow(length(arrRECIPE_CLASS));}
	  }

	  else //레시피 코드가 선택되었다면 레시피 코드만 사용
	  {
		  for(var i=0; i<gfn_length(arrRECIPE_CD);i++)
		  { 
				ds_where050.addRow();
				ds_where050.setColumn(i,"AFTER_ITEM_CODE",  ds_SELECT_ITEM_AFTER.getColumn(ds_SELECT_ITEM_AFTER.rowposition,"ITEM_CODE"));
				ds_where050.setColumn(i,"BEFORE_ITEM_CODE", ds_SELECT_ITEM_BEFORE.getColumn(ds_SELECT_ITEM_BEFORE.rowposition,"ITEM_CODE"));
				ds_where050.setColumn(i,"UPJANG", ed_UPJANG.userdata);
				ds_where050.setColumn(i,"HALL_CLASS", cbo_UP_HALL_CLASS.value);
				//
				ds_where050.setColumn(i,"HALL_CLASS_RECIPE_CD"  , arrHALL_CLASS[i] + "_" + arrRECIPE_CD[i]);
				//ds_where050.AddRow();
		  }
		  //if(length(arrRECIPE_CD)>0){ds_where050.DeleteRow(length(arrRECIPE_CD));}
	  }
	  
	  
	  
	  /////////////////////////////////////////////
	  //////////// 자재 확인 
	  //////////////////////////////////////////////
	  
	 // action 정보 삭제 초기화 
     fsp_clear(this);
/* in조건에 1000개가 넘으면 오라클 에러난다.
	  // 서버에서 조회할 정보 추가 
	  tit_addSearchActionInfo(this, "fs/fsi:FSI00050E_S001");
	  // 서버 호출 
	  http.sync = true;
	  tit_callService(this, "", "", "ds_where050=ds_where050", "ds_check050=ds_check050", "", "");	
	  http.sync = false;
	
	  var CHK_CNT = ds_check050.GetColumn(0, "CHK_CNT");
	  if (CHK_CNT > 0)
	  {
			g_Message("01", "변경후 자재를 이미 가지고 있는 레시피가 있습니다. 해당 레시피는 제외하고 변경합니다.");
	
	  }
*/
	g_Message("01", "변경후 자재를 이미 가지고 있는 레시피는 제외하고 변경합니다.");
	  	  			
	  // 입력 임시 데이터셋 생성 --> 로그생성
	  // 입력 임시 데이터셋 생성 --> 로그생성
	  var dsObj;
	  create("Dataset", "ds_in050");
	  dsObj = eval("ds_in050");
	  
	  dsObj.addColumn("UPJANG", "STRING", 100);
	  
	  dsObj.addColumn("B_ITEM_CODE", "STRING", 100);
	  dsObj.addColumn("B_ITEM_NAME", "STRING", 100);
	  dsObj.addColumn("B_ITEM_SIZE", "STRING", 100);
	  dsObj.addColumn("B_KG_CONVERT_RATE", "DECIMAL", 22);
	  dsObj.addColumn("B_ITEM_PRICE", "DECIMAL", 22);
	  dsObj.addColumn("B_G_ITEM_PRICE", "DECIMAL", 22);
	  
	  dsObj.addColumn("A_ITEM_CODE", "STRING", 100);
	  dsObj.addColumn("A_ITEM_NAME", "STRING", 100);
	  dsObj.addColumn("A_ITEM_SIZE",   "STRING", 100);
	  dsObj.addColumn("A_KG_CONVERT_RATE", "DECIMAL", 22);
	  dsObj.addColumn("A_ITEM_PRICE", "DECIMAL", 22);
	  dsObj.addColumn("A_G_ITEM_PRICE", "DECIMAL", 22);
	  	  
	  dsObj.addRow();

	  dsObj.setColumn(0,"UPJANG", ed_UPJANG.userdata);
	  
	  dsObj.setColumn(0,"B_ITEM_CODE", ds_SELECT_ITEM_BEFORE.getColumn(ds_SELECT_ITEM_BEFORE.rowposition,"ITEM_CODE"));
	  dsObj.setColumn(0,"B_ITEM_NAME", ds_SELECT_ITEM_BEFORE.getColumn(ds_SELECT_ITEM_BEFORE.rowposition,"ITEM_NAME"));
	  dsObj.setColumn(0,"B_ITEM_SIZE", ds_SELECT_ITEM_BEFORE.getColumn(ds_SELECT_ITEM_BEFORE.rowposition,"ITEM_SIZE"));
	  dsObj.setColumn(0,"B_KG_CONVERT_RATE", ds_SELECT_ITEM_BEFORE.getColumn(ds_SELECT_ITEM_BEFORE.rowposition,"KG_CONVERT_RATE"));
	  dsObj.setColumn(0,"B_ITEM_PRICE", ds_SELECT_ITEM_BEFORE.getColumn(ds_SELECT_ITEM_BEFORE.rowposition,"ITEM_PRICE"));
	  dsObj.setColumn(0,"B_G_ITEM_PRICE", ds_SELECT_ITEM_BEFORE.getColumn(ds_SELECT_ITEM_BEFORE.rowposition,"G_ITEM_PRICE"));

  	  dsObj.setColumn(0,"A_ITEM_CODE",  ds_SELECT_ITEM_AFTER.getColumn(ds_SELECT_ITEM_AFTER.rowposition,"ITEM_CODE"));
  	  dsObj.setColumn(0,"A_ITEM_NAME",  ds_SELECT_ITEM_AFTER.getColumn(ds_SELECT_ITEM_AFTER.rowposition,"ITEM_NAME"));
  	  dsObj.setColumn(0,"A_ITEM_SIZE", ds_SELECT_ITEM_AFTER.getColumn(ds_SELECT_ITEM_AFTER.rowposition,"ITEM_SIZE"));
	  dsObj.setColumn(0,"A_KG_CONVERT_RATE",ds_SELECT_ITEM_AFTER.getColumn(ds_SELECT_ITEM_AFTER.rowposition,"KG_CONVERT_RATE"));
	  dsObj.setColumn(0,"A_ITEM_PRICE", ds_SELECT_ITEM_AFTER.getColumn(ds_SELECT_ITEM_AFTER.rowposition,"ITEM_PRICE"));
	  dsObj.setColumn(0,"A_G_ITEM_PRICE", ds_SELECT_ITEM_AFTER.getColumn(ds_SELECT_ITEM_AFTER.rowposition,"G_ITEM_PRICE"));

	  // action 정보 초기화 
	  fsp_clear(this);
	 // single Action
	  //in조건에 1000개가 넘으면 오라클 에러난다.
	  //tit_addSingleActionInfo(this, "fs/fsi:FSI00050E_U001", "", "", "");
	  fsp_addMulti(this, "fs/fsi:FSI00050E_U001", "", "", "");
	  
	 // 1--> 업데이트를 한 후 트리거(FSR_UPJANG_RECIPE_ITEM_AU)가 자동으로 호출되고 -->자재변경로그 insert 완료 후
  	  // single Action -- 2. 자재 변경 로그(업장표준레시피 자재변경) 데이터를 UPDATE 한다.
	  fsp_addSingle(this, "fs/fsi:FSI00050E_U002", "", "", "");
	  
 	  // 서버 호출 후 조회 
	  fsp_callService(this, "", "", "ds_where050=ds_where050:A ds_in050=ds_in050", "" , "", "fn_After_Save");
}

//저장 후 콜백 함수 
function fn_After_Save()
{
    //조회조건 초기화
    ds_where050.clearData();
    
    //레시피 조회결과값은 삭제
    ds_STD_RECIPE_MST.clearData();
    
        
    //임시입력값 삭제
    Destroy("ds_in050");
    
    
    //변경되었습니다. 메세지 삽입.....
    g_Message("01","자재변경이 완료되었습니다.");
    
} 

//데이터 유효성검사
function fn_DataValidation()
{
    //체크로직- 틀리면 return false;

    //변경데이터 검사
	//if(!ds_template_obj.GetUpdate())   {alert("변경된 데이터가 없습니다."); return false;}
	
	//입력값 검사 - 컴포넌트 
	if(!fn_DataValidation_Component()) {return false;}	
	
	//입력값 검사 - 데이터셋
	if(!fn_DataValidation_DataSet())   {return false;}

    return true;
}

function fn_DataValidation_Component()
{
	//체크로직 - 틀리면 return false;
	return true;
}

function fn_DataValidation_DataSet()
{
	//체크로직 - 틀리면 return false;
	if((this.ds_SELECT_ITEM_BEFORE.rowcount<=0)||(gfn_length(this.ds_SELECT_ITEM_BEFORE.getColumn(ds_SELECT_ITEM_BEFORE.rowposition,"ITEM_CODE"))==0)) 
	 {
		//변경전 자재선택 메세지
		g_Message("EE","[변경전] 자재가 선택되지 않았습니다.\n[변경전] 자재를 조회 선택하여 주십시요.");
		return false;
	 }

	//체크로직 - 틀리면 return false;
	if((this.ds_SELECT_ITEM_AFTER.rowcount<=0)||(gfn_length(this.ds_SELECT_ITEM_AFTER.getColumn(ds_SELECT_ITEM_AFTER.rowposition,"ITEM_CODE"))==0))
	 {
		//변경후 자재선택 메세지
		g_Message("EE","[변경후] 자재가 선택되지 않았습니다.\n[변경후] 자재를 조회 선택하여 주십시요.");
		return false;
	 }
	 
	 if((ds_SELECT_ITEM_BEFORE.getColumn(ds_SELECT_ITEM_BEFORE.rowposition,"ITEM_CODE"))==(ds_SELECT_ITEM_AFTER.getColumn(ds_SELECT_ITEM_AFTER.rowposition,"ITEM_CODE")))
	 {
	  //변경전 자재와 변경후 자재가 같을경우 
		g_Message("EE","[변경전] 자재와 [변경후] 자재가 같습니다.\n선택하신 자재를 확인 하여 주십시요.");
		return false;
	 }
	 
	 if((ds_SELECT_ITEM_AFTER.getColumn(ds_SELECT_ITEM_AFTER.rowposition,"ITEM_PRICE"))==0)
	 {
	  //변경전 자재와 변경후 자재가 같을경우 
		g_Message("EE","[변경후] 자재의 단가가 0 원 입니다.\n선택하신 자재를 확인 하여 주십시요.");
		return false;
	 }
	 
	 var BEFORE_ITEM_CODE = ds_SELECT_ITEM_BEFORE.getColumn(ds_SELECT_ITEM_BEFORE.rowposition,"ITEM_CODE");
	 var BEFORE_ITEM_NAME = ds_SELECT_ITEM_BEFORE.getColumn(ds_SELECT_ITEM_BEFORE.rowposition,"ITEM_NAME");
	 var AFTER_ITEM_CODE  = ds_SELECT_ITEM_AFTER.getColumn(ds_SELECT_ITEM_AFTER.rowposition,"ITEM_CODE");
	 var AFTER_ITEM_NAME  = ds_SELECT_ITEM_AFTER.getColumn(ds_SELECT_ITEM_AFTER.rowposition,"ITEM_NAME");
	 
	 var blnRtn=g_Confirm("04","[변경전] 자재명:"+ BEFORE_ITEM_NAME +"\n" +
	                    "[변경후] 자재명:"+ AFTER_ITEM_NAME  +"\n\n" +
	                    "자재 변경 적용을 하시겠습니까?");
	                    	         
	 if(!blnRtn) { return false; }
	     
	return true;
}
        


/*------------------------------------------------------------
	1. Function ID : fn_Print()
	2. 개       요 : 업무프로세스에 따른 인쇄 처리
	3. 기       능 : 인쇄버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*------------------------------------------------------------*/
function fn_print()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Close()
	2. 개       요 : 업무프로세스에 따른 폼 종료 
	3. 기       능 : 닫기버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*------------------------------------------------------------*/
function fn_Close()
{
	this.close();
}

/*------------------------------------------------------------
	1. Function ID : fn_Help()
	2. 개       요 : 업무프로세스에 따른 도움말 
	3. 기       능 : 도움말버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*------------------------------------------------------------*/
function fn_help()
{
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
function fn_MakeRecipeClassCheckbox()
{
	//-------------------------------------------------------
	// 공통코드 데이터셋 - FS0001 레시피 분류 ds_recipe_class
	//-------------------------------------------------------
	if(ds_recipe_class.rowcount<=0) {return false;}
	
	var rowCnt=ds_recipe_class.rowcount;
			
	for(var i=0;i<rowCnt;i++)
	{
		var chkObj = eval("chk"+i);
		chkObj.text     =  ds_recipe_class.getColumn(i, "RECIPE_CLASS_NAME"); //체크박스 명을 레시피명 
	    chkObj.userdata =  ds_recipe_class.getColumn(i, "RECIPE_CLASS");	  //체크박스 사용자데이터를 레시피코드 
//	    chkObj.onclick  =  "fn_CheckboxClick";                        //체크박스의 이벤트를  fn_CheckboxClick 으로 연결( 이벤트 처리로 이동)
	}
	
	//checkbox object의 갯수 
	var chkObjNumber=10;
	
	while(rowCnt<chkObjNumber)
	{	
		var chkObj = eval("chk"+rowCnt);
		chkObj.enable=false;
		chkObj.visible=false;
		rowCnt++;
	}
}

function fn_CheckboxClick(obj)
{
	if(obj.value)
	{
		obj.style.background.color="#FFFFBB";
	}
	else
	{
		obj.style.background.color="-1";
	}
	
	
	
	//체크박스를 클릭하면 무조건 조회된 자재, 레시피 리스트를 클리어 한다.//이명희 요구사항
	ds_SEARCH_ITEM_BEFORE.clearData();
	ds_STD_RECIPE_MST.clearData();
}


//레시피 분류선택
function btnRECIPE_ALL_CHECK_OnClick(obj:Button, e:ClickEventInfo)
{
	if(ds_recipe_class.rowcount<=0) {return false;}
	
	var rowCnt=ds_recipe_class.rowcount;
			
	for(var i=0;i<rowCnt;i++)
	{
		var chkObj = eval("chk"+i);
		if(chkObj.value==false)
		{ chkObj.value=true;
		  fn_CheckboxClick(chkObj); } //체크박스 선택
		else
		{ chkObj.value=false;
		  fn_CheckboxClick(chkObj); } //체크박스 해제
	}
}





//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================


function ds_SEARCH_ITEM_BEFORE_OnLoadCompleted(obj:Dataset, e:DSLoadEventInfo)
{
	ds_SELECT_ITEM_BEFORE.enableevent=false;	
   //전체 로우를 삭제한다.
	ds_SELECT_ITEM_BEFORE.deleteAll();
	//로우를 추가한다.
	ds_SELECT_ITEM_BEFORE.addRow();
	//데이터를 카피한다.
	ds_SELECT_ITEM_BEFORE.copyRow(0, ds_SEARCH_ITEM_BEFORE, 0);
	ds_SELECT_ITEM_BEFORE.enableevent=true;
}


function ds_SEARCH_ITEM_BEFORE_OnRowPosChanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{	
	ds_SELECT_ITEM_BEFORE.enableevent=false;	
   //전체 로우를 삭제한다.
	ds_SELECT_ITEM_BEFORE.deleteAll();
	//로우를 추가한다.
	ds_SELECT_ITEM_BEFORE.addRow();
	//데이터를 카피한다.
	ds_SELECT_ITEM_BEFORE.copyRow(0, ds_SEARCH_ITEM_BEFORE, e.newrow);
	ds_SELECT_ITEM_BEFORE.enableevent=true;
}


function ds_SEARCH_ITEM_AFTER_OnLoadCompleted(obj:Dataset, e:DSLoadEventInfo)
{
	ds_SELECT_ITEM_AFTER.enableevent=false; 
   //전체 로우를 삭제한다.
	ds_SELECT_ITEM_AFTER.deleteAll();
	//로우를 추가한다.
	ds_SELECT_ITEM_AFTER.addRow();
	//데이터를 카피한다.
	ds_SELECT_ITEM_AFTER.copyRow(0, ds_SEARCH_ITEM_AFTER, 0);
	ds_SELECT_ITEM_AFTER.enableevent=true;	
}

function ds_SEARCH_ITEM_AFTER_OnRowPosChanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{	
	ds_SELECT_ITEM_AFTER.enableevent=false; 
   //전체 로우를 삭제한다.
	ds_SELECT_ITEM_AFTER.deleteAll();
	//로우를 추가한다.
	ds_SELECT_ITEM_AFTER.addRow();
	//데이터를 카피한다.
	ds_SELECT_ITEM_AFTER.copyRow(0, ds_SEARCH_ITEM_AFTER, e.newrow);
	ds_SELECT_ITEM_AFTER.enableevent=true;	
}


//자재변경 버튼클릭 이벤트
function btnITEM_CHANGE_OnClick(obj:Button, e:ClickEventInfo)
{
	fn_save();
}

//자재소요량 일괄변경 화면 호출 --> 업장에서는 사용하지 않음: 업장은 업장표준레시피 구축이나 업장식단장성시 변경:: 2007-12-10 이명희
//function btn_FSI00060E_OnClick(obj)
//{
//	var v_result;
//	v_result = gfn_dialog("", "FSI00060E.xml","");
//}
//자재 일괄변경 이력정보 화면 호출 
function btn_FSI00057V_OnClick(obj:Button, e:ClickEventInfo)
{
 	var arg1 = gfn_trim(ed_UPJANG.userdata);
 	var arg2 = gfn_trim(ed_UPJANG.value);
	
	var v_result = gfn_dialog("", "U_FSI::FSI00057V.xfdl", {pUPJANG:arg1,pUPJANGNM:arg2}, 896, 472); 
}

//------------------------------------------------------------------------------------------
// 업장 선택 
function ed_Upjang_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 13) fn_UpjangPopup();
}

function btn_Upjang_OnClick(obj:Button, e:ClickEventInfo)
{
	fn_UpjangPopup();
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_UpjangPopup
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 업장조회 팝업
 * 작  성  자   : 김동표
 * 작성  일자   : 2007-11-27
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_UpjangPopup()
{
// 	//[[As-Is 소스
// 	if (SCPopup.runTimeMode == "As-Is")
// 	{
		//업장조회 공통합수 적용
		fn_sql_common_setup( fn_MakeUpjangSQL()
							,strQuery_UpjangKeyField
							,strQuery_UpjangValueField
							,strQuery_UpjangKeyFieldNM
							,strQuery_UpjangValueFieldNM
							,""
							,""
							,""
							,strQuery_UpjangCaption
							,"UPJANG;UPJANGNM"
							);
							
		ed_UPJANG.value = gds_sql_common.getColumn(0, "ret_name");
		ed_UPJANG.userdata = gds_sql_common.getColumn(0, "ret_code");
		
		if(gfn_length(ed_UPJANG.userdata)!=0)
		{
			// action 정보 초기화 
			fsp_clear(this);
			
			// 업장별 식당군 가져오기 
			fsp_addSearch(this, "fs/fsc:FSC_UPJANG_HALL_CLASS_S001");
			// 업장별 레시피 가져오기 
			fsp_addSearch(this, "fs/fsc:FSC_UPJANG_RECIPE_S001");
		
			strUPJANG="UPJANG="+  wrapQuote(ed_UPJANG.userdata);
			//식당군 *BLANK='A' --전체 *USE_YN='Y' 사용하는 식당만  *HALL_CD='' 해당식당의 식당군 
			
			// 서버 호출 
			fsp_callService(this, "", "", "", "ds_cbo_UP_HALL_CLASS=ds_UP_HALL_CLASS  ds_recipe_class=ds_out", "BLANK='Y' USE_YN='Y' "+ strUPJANG , "fn_After_InitData");
		}
// 	}
// 	//As-Is 소스]]
// 	//[[To-Be 소스
// 	else
// 	{
// 		//업장조회 공통합수 적용
// 		fn_sql_common_setup( fn_MakeUpjangSQL()
// 							,strQuery_UpjangKeyField
// 							,strQuery_UpjangValueField
// 							,strQuery_UpjangKeyFieldNM
// 							,strQuery_UpjangValueFieldNM
// 							,""
// 							,""
// 							,{}
// 							,strQuery_UpjangCaption
// 							,"UPJANG;UPJANGNM"
// 							);
// 							
// 		ed_UPJANG.value = gds_sql_common.getColumn(0, "ret_name");
// 		ed_UPJANG.userdata = gds_sql_common.getColumn(0, "ret_code");
// 		
// 		if(gfn_length(ed_UPJANG.userdata)!=0)
// 		{
// 			// action 정보 초기화 
// 			fsp_clear(this);
// 			
// 			// 업장별 식당군 가져오기 
// 			fsp_addSearch(this, "fs/fsc:FSC_UPJANG_HALL_CLASS_S001");
// 			// 업장별 레시피 가져오기 
// 			fsp_addSearch(this, "fs/fsc:FSC_UPJANG_RECIPE_S001");
// 		
// 			strUPJANG="UPJANG="+  wrapQuote(ed_UPJANG.userdata);
// 			//식당군 *BLANK='A' --전체 *USE_YN='Y' 사용하는 식당만  *HALL_CD='' 해당식당의 식당군 
// 			
// 			// 서버 호출 
// 			fsp_callService(this, "", "", "", "ds_cbo_UP_HALL_CLASS=ds_UP_HALL_CLASS  ds_recipe_class=ds_out", "BLANK='Y' USE_YN='Y' "+ strUPJANG , "fn_After_InitData");
// 		}
// 	}
// 	//To-Be 소스]]
}




/*
 ******************************************************************************************
 * 함  수  명   : fn_SearchSub(nRow)
 * 입      력   : nRow = Master Row
 * 반      환   : 없음
 * 기      능   : 상세내역 조회
 * 작  성  자   : 박종세
 * 작성  일자   : 2007-12-12  
 ******************************************************************************************
 */
function fn_SearchSub(nRow, RECIPE_TYPE)
{
	// 초기화
	ds_item_list.clearData();
	
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc,strSqltype;
		

	ds_input.setColumn(0,"RECIPE_TYPE",RECIPE_TYPE);  //레시피타입은 업장
	ds_input.setColumn(0,"UPJANG",    ed_UPJANG.userdata); //업장코드
	ds_input.setColumn(0,"HALL_CLASS",ds_STD_RECIPE_MST.getColumn(nRow,"HALL_CLASS")); //업장코드
	ds_input.setColumn(0,"RECIPE_CD", ds_STD_RECIPE_MST.getColumn(nRow,"RECIPE_CD")); //레시피코드
		
	actionName		= "FSR00030E_T002";
	cmdName			= "U_svc::" + "fs/fsr/FSR00030E_T002.jsp";
	inData			= "ds_input=ds_input";
	outData			= "ds_item_list=ds_item_list";
	callBackFnc		= "fn_afterSearch";
	
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc,true,false,false);
}

function fn_afterSearch(errCode, errMsg)
{
	if(errCode!=0)
	{
		return;
	}

	switch(errMsg)
	{
	 case "UPJANG":
	 var arrPos = GetCellRect(divFSI00053V.grd_STD_RECIPE_MST,ds_STD_RECIPE_MST.rowposition, 0);
	 pdiv_Detail.trackPopup(system.clientToScreenX(divFSI00053V.grd_STD_RECIPE_MST, arrPos[0]) , system.clientToScreenY(divFSI00053V.grd_STD_RECIPE_MST, arrPos[3]));
	 break;
    }
	
}

//체크박스의 이벤트를  fn_CheckboxClick 으로 연결
function chk0_onclick(obj:CheckBox,  e:ClickEventInfo) { fn_CheckboxClick(obj); }
function chk1_onclick(obj:CheckBox,  e:ClickEventInfo) { fn_CheckboxClick(obj); }
function chk2_onclick(obj:CheckBox,  e:ClickEventInfo) { fn_CheckboxClick(obj); }
function chk3_onclick(obj:CheckBox,  e:ClickEventInfo) { fn_CheckboxClick(obj); }
function chk4_onclick(obj:CheckBox,  e:ClickEventInfo) { fn_CheckboxClick(obj); }
function chk5_onclick(obj:CheckBox,  e:ClickEventInfo) { fn_CheckboxClick(obj); }
function chk6_onclick(obj:CheckBox,  e:ClickEventInfo) { fn_CheckboxClick(obj); }
function chk7_onclick(obj:CheckBox,  e:ClickEventInfo) { fn_CheckboxClick(obj); }
function chk8_onclick(obj:CheckBox,  e:ClickEventInfo) { fn_CheckboxClick(obj); }
function chk9_onclick(obj:CheckBox,  e:ClickEventInfo) { fn_CheckboxClick(obj); }
]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="FSM90330R" classname="SAMPLE01" inheritanceid="" position="absolute 0 0 1252 725" titletext="식단표" onload="form_onload" onkeydown="FSM90050E_onkeydown">
    <Layouts>
      <Layout>
        <Grid id="grd_menuList" taborder="35" binddataset="ds_menuList" autoenter="none" useinputpanel="false" selecttype="cell" autofittype="none" position="absolute 0 120 1237 710" anchor="all" style="border:1 solid #53606cff,1 solid #c3c3c3ff,1 solid #c3c3c3ff,1 solid #c3c3c3ff;" onrbuttondown="grd_menuList_onrbuttondown" onkeydown="grd_menuList_onkeydown" oncelldblclick="grd_menuList_oncelldblclick" onheadclick="grd_menuList_onheadclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="60" band="left"/>
                <Column size="100" band="left"/>
                <Column size="153"/>
                <Column size="0"/>
                <Column size="153"/>
                <Column size="0"/>
                <Column size="153"/>
                <Column size="0"/>
                <Column size="153"/>
                <Column size="0"/>
                <Column size="153"/>
                <Column size="0"/>
                <Column size="153"/>
                <Column size="0"/>
                <Column size="153"/>
                <Column size="0"/>
              </Columns>
              <Rows>
                <Row size="30" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="끼니" taborder="undefined"/>
                <Cell col="1" text="코너" taborder="undefined"/>
                <Cell col="2" colspan="2" text="월" taborder="undefined"/>
                <Cell col="4" colspan="2" text="화" taborder="undefined"/>
                <Cell col="6" colspan="2" text="수" taborder="undefined"/>
                <Cell col="8" colspan="2" text="목" taborder="undefined"/>
                <Cell col="10" colspan="2" text="금" taborder="undefined"/>
                <Cell col="12" colspan="2" text="토" taborder="undefined"/>
                <Cell col="14" colspan="2" text="일" taborder="undefined"/>
              </Band>
              <Band id="body">
                <Cell style="background:#fffdecff;background2:#fffdecff;" text="bind:MEAL_NAME" suppress="1" suppressalign="middle"/>
                <Cell col="1" style="align:left;padding:0 0 0 5;background:#e1e6f6ff;background2:#e1e6f6ff;" text="bind:CORNER_NAME" subsumtext="열량합계" suppress="2" suppressalign="middle"/>
                <Cell col="2" style="background:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));background2:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));"/>
                <Cell col="3" style="background:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));background2:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));"/>
                <Cell col="4" style="background:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));background2:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));"/>
                <Cell col="5" style="background:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));background2:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));"/>
                <Cell col="6" style="background:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));background2:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));"/>
                <Cell col="7" style="background:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));background2:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));"/>
                <Cell col="8" style="background:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));background2:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));"/>
                <Cell col="9" style="background:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));background2:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));"/>
                <Cell col="10" style="background:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));background2:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));"/>
                <Cell col="11" style="background:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));background2:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));"/>
                <Cell col="12" style="background:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));background2:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));"/>
                <Cell col="13" style="background:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));background2:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));"/>
                <Cell col="14" style="background:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));background2:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));"/>
                <Cell col="15" style="background:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));background2:EXPR(iif(getRowLevel(currow)==1,'#FFFFFF','#F8F8F8'));"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="1" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 90" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 1237 40" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 85 1237 95" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static03" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 208 40 218 61" anchor="left top"/>
        <Static id="Static10" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 388 40 410 61" anchor="left top"/>
        <Static id="Static14" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 455 40 465 61" anchor="left top"/>
        <Static id="Static15" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 741 40 763 61" anchor="left top"/>
        <Static id="Static01" text="사업장" class="sta_WFSA_label" position="absolute 164 41 224 62" anchor="left top"/>
        <UpjangSearchComponent id="edt_upjang" titletext="업장 검색용 Component" taborder="13" text="UpjangSearchComponent00" position="absolute 218 40 388 61" bindDataset="ds_cond" bindUpjangCodeColumn="UPJANG" bindUpjangNameColumn="UPJANGNM" eventBeforeTrigger="" eventAfterTrigger="fn_hallSearch" roleSetId=""/>
        <Static id="Static00" text="식당명" class="sta_WFSA_label" position="absolute 410 41 470 62" anchor="left top"/>
        <Combo id="cbo_hall" taborder="14" position="absolute 465 40 589 61" index="-1" innerdataset="@ds_cboHall" codecolumn="HALL_CD" datacolumn="HALL_NAME" onitemchanged="cbo_hall_onitemchanged"/>
        <Static id="Static13" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 589 40 611 61" anchor="left top"/>
        <Static id="Static16" text="코너" class="sta_WFSA_label" position="absolute 611 41 671 62" anchor="left top"/>
        <Static id="Static17" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 642 40 652 61" anchor="left top"/>
        <Combo id="cbo_corner" taborder="22" position="absolute 652 40 741 61" innerdataset="@ds_cboCorner" codecolumn="CORNER" datacolumn="CORNER_NAME" onitemchanged="cbo_corner_onitemchanged"/>
        <Static id="Static02" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 400 71 1237 76"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 872 40 894 61" anchor="left top"/>
        <Static id="Static0" text="끼니" class="sta_WFSA_label" position="absolute 763 38 807 64"/>
        <Static id="Static28" text="글자간격기준 w10" onclick="Static28_onclick" class="Guide01_AreaRed" visible="false" position="absolute 794 40 804 61"/>
        <Combo id="cbo_meal" taborder="47" innerdataset="ds_cboMeal" codecolumn="MEAL" datacolumn="MEAL_NAME" position="absolute 804 40 872 61"/>
        <Static id="Static2" text="제공일" class="sta_WFSA_label" position="absolute 893 38 976 64"/>
        <CheckBox id="chk_SEARCH_ALL" taborder="50" text="열량표시" value="0" truevalue="1" falsevalue="0" position="absolute 1158 40 1226 61" onclick="chk_week_onclick"/>
        <Static id="Static11" text="글자간격기준 w10" onclick="Static28_onclick" class="Guide01_AreaRed" visible="false" position="absolute 937 40 947 61"/>
        <Static id="Static8" text="~" position="absolute 1044 41 1053 62"/>
        <ObjCalendar id="cal_startDate" anchor="left top" titletext="캘린더" taborder="51" scrollbars="none" position="absolute 947 40 1042 61"/>
        <ObjCalendar id="cal_endDate" anchor="left top" titletext="캘린더" taborder="52" scrollbars="none" position="absolute 1056 40 1151 61"/>
        <Static id="Static23" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 33 40 43 61" anchor="left top"/>
        <Static id="Static24" text="팀" class="sta_WFSA_label" position="absolute 15 41 75 62" anchor="left top"/>
        <TmSearchComponent id="edt_tm" titletext="팀 검색용 Component" taborder="55" text="TmSearchComponent00" position="absolute 43 40 142 61" bindDataset="" bindTmCdColumn="" bindTmNmColumn="" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tmChange" eventBeforeTrigger=""/>
        <Static id="Static26" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 142 40 164 61" anchor="left top"/>
        <Button id="btn_excel" taborder="62" text="엑셀출력" class="btn_WF_Function" position="absolute 1172 95 1237 115" anchor="top right" onclick="btn_excel_onclick"/>
        <Static id="Static18" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 96 1237 101"/>
        <MuSearchComponent id="cbo_mu" titletext="사업부 선택 Component" taborder="63" text="MuSearchComponent00" visible="false" position="absolute 655 75 800 96" bindDataset="ds_cond" bindMuCdColumn="MU_CD" appendText="" onItemChangedEvent=""/>
        <Static id="Static12" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 243 84" anchor="left top"/>
        <Static id="Static32" text="식단표" class="sta_WF_Title01" position="absolute 0 103 184 121" anchor="left top"/>
        <Radio id="rdo_LangGbn" taborder="64" columncount="2" rowcount="0" position="absolute 75 66 218 90" index="0" innerdataset="@ds_lang" codecolumn="CD" datacolumn="NM" value="0"/>
        <Static id="Static19" text="메뉴명" class="sta_WFSA_label" position="absolute 15 68 75 89" anchor="left top"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cboHall" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="HALL_CD" type="STRING" size="256"/>
          <Column id="HALL_NAME" type="STRING" size="256"/>
          <Column id="MENU_CYCLE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="HALL_CD">001</Col>
            <Col id="HALL_NAME">상식1</Col>
          </Row>
          <Row>
            <Col id="HALL_CD">002</Col>
            <Col id="HALL_NAME">상식선택식</Col>
          </Row>
          <Row>
            <Col id="HALL_CD">003</Col>
            <Col id="HALL_NAME">연식</Col>
          </Row>
          <Row>
            <Col id="HALL_CD">004</Col>
            <Col id="HALL_NAME">산모식</Col>
          </Row>
          <Row>
            <Col id="HALL_CD">005</Col>
            <Col id="HALL_NAME">소아식</Col>
          </Row>
          <Row>
            <Col id="HALL_CD">006</Col>
            <Col id="HALL_NAME">유아식</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="UPJANGNM" type="STRING" size="256"/>
          <Column id="HALL_CD" type="STRING" size="256"/>
          <Column id="HALL_NM" type="STRING" size="256"/>
          <Column id="SUBINV_CODE" type="STRING" size="256"/>
          <Column id="MENU_DATE" type="STRING" size="256"/>
          <Column id="START_DATE" type="STRING" size="256"/>
          <Column id="END_DATE" type="STRING" size="256"/>
          <Column id="EMP_NO" type="STRING" size="256"/>
          <Column id="CORNER" type="STRING" size="256"/>
          <Column id="MEAL" type="STRING" size="256"/>
          <Column id="LANG_GBN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_headList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="FDAY" type="STRING" size="256"/>
          <Column id="WE" type="STRING" size="256"/>
          <Column id="WE_COLOR" type="STRING" size="256"/>
          <Column id="WCD" type="STRING" size="256"/>
          <Column id="WNM" type="STRING" size="256"/>
          <Column id="WIMG" type="STRING" size="256"/>
          <Column id="REM" type="STRING" size="256"/>
          <Column id="WEEK" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_bodyList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="MENU_CD" type="STRING" size="256"/>
          <Column id="MENU_DATE" type="STRING" size="256"/>
          <Column id="MENU_DAYS" type="STRING" size="256"/>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="HALL_CD" type="STRING" size="256"/>
          <Column id="MEAL" type="STRING" size="256"/>
          <Column id="MEAL_NAME" type="STRING" size="256"/>
          <Column id="CORNER" type="STRING" size="256"/>
          <Column id="CORNER_NAME" type="STRING" size="256"/>
          <Column id="RECIPE_INFO" type="STRING" size="256"/>
          <Column id="RECIPE_CD" type="STRING" size="256"/>
          <Column id="RECIPE_NAME" type="STRING" size="256"/>
          <Column id="RECIPE_CAL" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_menuList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="MEAL" type="STRING" size="256"/>
          <Column id="MEAL_NAME" type="STRING" size="256"/>
          <Column id="CORNER" type="STRING" size="256"/>
          <Column id="CORNER_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboCorner" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CORNER" type="STRING" size="256"/>
          <Column id="CORNER_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_condValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="UPJANGNM" type="STRING" size="256"/>
          <Column id="HALL_CD" type="STRING" size="256"/>
          <Column id="HALL_NM" type="STRING" size="256"/>
          <Column id="MENU_DATE" type="STRING" size="256"/>
          <Column id="START_DATE" type="STRING" size="256"/>
          <Column id="END_DATE" type="STRING" size="256"/>
          <Column id="EMP_NO" type="STRING" size="256"/>
          <Column id="CORNER" type="STRING" size="256"/>
          <Column id="MEAL" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="UPJANG">title:업장,required:true</Col>
            <Col id="HALL_CD">title:식당,required:true</Col>
            <Col id="START_DATE">title:주기식단등록월,required:true</Col>
            <Col id="END_DATE">title:주기식단등록월,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_cboMeal">
        <ColumnInfo>
          <Column id="MEAL" size="256" type="STRING"/>
          <Column id="MEAL_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="MEAL"/>
            <Col id="MEAL_NAME"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_lang">
        <ColumnInfo>
          <Column id="CD" size="256" type="STRING"/>
          <Column id="NM" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CD">0</Col>
            <Col id="NM">한글명</Col>
          </Row>
          <Row>
            <Col id="CD">1</Col>
            <Col id="NM">영문명</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item1" compid="cbo_corner" propid="value" datasetid="ds_cond" columnid="CORNER"/>
      <BindItem id="item0" compid="cbo_hall" propid="value" datasetid="ds_cond" columnid="HALL_CD"/>
      <BindItem id="item2" compid="cbo_meal" propid="value" datasetid="ds_cond" columnid="MEAL"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";

/******************************************************************************************
 * 시스템구분 : 메뉴관리/식단출력물
 * 프로그램명 : FSM90330R.XML
 * 기ㅡㅡㅡ능 : 식단표
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-07-22
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************/

//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================

//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(this);

	// X-Framework : Action 정보 생성
	fsp_init(this);
	
	// 초기화
	fn_init();
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_init()
 * 기ㅡㅡㅡ능 : 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_init()
{
	// 조회조건 초기화
	ds_cond.clearData();
	ds_cond.addRow();

	// 권한처리
	edt_tm.applyAuthLevel(cbo_mu);
	edt_upjang.applyAuthLevel(edt_tm);
	
	// 식단제공일 초기화
	cal_startDate.fn_initMonthCal(this, gfn_today(), '', ds_cond, 'START_DATE');
	cal_endDate.fn_initMonthCal(this, gfn_addDate(gfn_today(), 7), '', ds_cond, 'END_DATE');
	
	// 식당정보 조회
	fn_hallSearch();
	
	//cbo_mu.setMuCode("");
	//edt_tm.setTmCode("");
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_initData()
 * 기ㅡㅡㅡ능 : 화면 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_initData() {

	// 그리드 데이터 초기화
	ds_menuList.clearData();
	ds_bodyList.clearData();
	ds_headList.clearData();
}

//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,출력)
//
//=========================================================================================
/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_search()
 * 기ㅡㅡㅡ능 : 조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_search()
{
	// 유효성 검사
	if (gfn_validCheck(ds_cond, ds_condValid, true) == false) return;

	// 그리드 데이터 초기화
	ds_menuList.clearData();
	ds_bodyList.clearData();
	ds_headList.clearData();
	
	//	0:한글명, 1:영문명
	v_LangGbn = rdo_LangGbn.index;
	ds_cond.setColumn(0, "LANG_GBN", v_LangGbn);

	fsp_clear(this);
	fsp_addSearch(this, "fs/fsm:FSM90030E_S001");  // 헤더 정보
	fsp_addSearch(this, "fs/fsm:FSM00330R_S001");  // 식단 정보
	fsp_callService(this, "", "", "ds_in=ds_cond ds_input=ds_cond", "ds_headList=DS_head ds_bodyList=ds_list" , "", "fn_callbackSearch");	
}

function fn_callbackSearch(errCode, errMsg) 
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오!");
		return;
	}
	
	// 열량미표시
	if(chk_SEARCH_ALL.value == 0)
	{
		// 그리드 데이터 세팅
		fn_setMenuGridData2(grd_menuList, ds_menuList, ds_headList, ds_bodyList);
	}
	// 열량표시
	else
	{
		// 그리드 데이터 세팅
		fn_setMenuGridData1(grd_menuList, ds_menuList, ds_headList, ds_bodyList);
	}	
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_setMenuGridData(grdObj, dsGrdObj, dsHeadObj, dsBodyObj)
 * 기ㅡㅡㅡ능 : 그리드 데이터 세팅(열량표시)
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_setMenuGridData1(grdObj, dsGrdObj, dsHeadObj, dsBodyObj)
{
	dsGrdObj.enableevent = false;
	var nRow, nCol;
	dsGrdObj.keystring = "S:+MEAL+CORNER+RECIPE_INFO";
	dsGrdObj.clear();
	dsGrdObj.addColumn("KEY"                 , "STRING");  // 키
	dsGrdObj.addColumn("MEAL"                , "STRING");  // 끼니
	dsGrdObj.addColumn("MEAL_NAME"           , "STRING");  // 끼니명
	dsGrdObj.addColumn("CORNER"              , "STRING");  // 코너
	dsGrdObj.addColumn("CORNER_NAME"         , "STRING");  // 코너명
	dsGrdObj.addColumn("RECIPE_INFO"         , "STRING");  // 레시피순번
	
	var sKey = "";
	var nRow = 0;
	for(var i=0; i<dsBodyObj.getRowCount(); i++)
	{
		nRow = dsGrdObj.findRow("KEY", dsBodyObj.getColumn(i, "MEAL") + dsBodyObj.getColumn(i, "CORNER") + dsBodyObj.getColumn(i, "RECIPE_INFO"));
		// 키가 존재하지 않을 경우 행 추가 후 세팅
		if(nRow == -1)
		{
			nRow = dsGrdObj.addRow();
			dsGrdObj.setColumn(nRow, "KEY"          , dsBodyObj.getColumn(i, "MEAL") + dsBodyObj.getColumn(i, "CORNER") + dsBodyObj.getColumn(i, "RECIPE_INFO"));			// 끼니코드 + 코너코드 + 레시피순번
			dsGrdObj.setColumn(nRow, "MEAL"         , dsBodyObj.getColumn(i, "MEAL"));
			dsGrdObj.setColumn(nRow, "MEAL_NAME"    , dsBodyObj.getColumn(i, "MEAL_NAME"));
			dsGrdObj.setColumn(nRow, "CORNER"       , dsBodyObj.getColumn(i, "CORNER"));
			dsGrdObj.setColumn(nRow, "CORNER_NAME"  , dsBodyObj.getColumn(i, "CORNER_NAME"));
			dsGrdObj.setColumn(nRow, "RECIPE_INFO"  , dsBodyObj.getColumn(i, "RECIPE_INFO"));
		}
	}
	
	dsGrdObj.keystring = "S:+MENU_DATE+MEAL+CORNER+RECIPE_INFO";
	
	sKey = "";
	for (var i=0; i<dsBodyObj.rowcount; i++) 
	{
		sKey = dsBodyObj.getColumn(i, "MENU_DATE");
		dsGrdObj.addColumn("RECIPE_NAME"  + sKey, "STRING");	
		dsGrdObj.addColumn("RECIPE_CAL"   + sKey, "BIGDECIMAL");
		
		var nFindRow = dsGrdObj.findRowExpr("MEAL=='" + dsBodyObj.getColumn(i, "MEAL") + "' && CORNER=='" + dsBodyObj.getColumn(i, "CORNER") + "' && RECIPE_INFO=='" + dsBodyObj.getColumn(i, "RECIPE_INFO") + "'");
		if (nFindRow > -1) 
		{
			dsGrdObj.setColumn(nFindRow, "RECIPE_NAME"  + sKey, gfn_trim(dsBodyObj.getColumn(i, "RECIPE_NAME")));
			dsGrdObj.setColumn(nFindRow, "RECIPE_CAL"   + sKey, dsBodyObj.getColumn(i, "RECIPE_CAL"));   // 칼로리
		}
	}
	
	// 그리드 초기화
	for (var i=grdObj.getFormatColCount() - 1; i > 1; i--)
	{
		grdObj.deleteContentsCol('body', i, false);
	}
	
	// TOP, RIGHT, BOTTEM, LEFT
	var sProp1 = "0 none #c3c3c3ff, 1 dotted #c3c3c3ff, 0 none  #c3c3c3ff, 1 solid  #c3c3c3ff";  // 메뉴 body line
	var sProp2 = "0 none #c3c3c3ff, 1 dotted #c3c3c3ff, 1 solid #c3c3c3ff, 0 none   #c3c3c3ff";  // 메뉴 소계 line
	var sProp3 = "0 none #c3c3c3ff, 1 solid  #c3c3c3ff, 0 none  #c3c3c3ff, 1 dotted #c3c3c3ff";  // 원가 body line
	var sProp4 = "0 none #c3c3c3ff, 1 solid  #c3c3c3ff, 1 solid #c3c3c3ff, 1 dotted #c3c3c3ff";  // 원가 소계 line
	
	var sColId;
	var sDay;
	var sMenuDate;
	var sCorner;
	for (var i=0, nCol=-1; i < dsGrdObj.colcount; i++)
	{
		sColId = dsGrdObj.getColID(i);
		
		if(sColId.indexOf("RECIPE_NAME") < 0 && sColId.indexOf("RECIPE_CAL") < 0) continue;
		
		if (sColId.substr(0, 11) == "RECIPE_NAME")
		{
			sMenuDate = sColId.replace("RECIPE_NAME", "");
			nCol = grdObj.appendContentsCol();
			if (nCol > -1)
			{
				nRow = dsHeadObj.findRowExpr("FDAY==" + sMenuDate);
				sDay = gfn_subStr(sMenuDate, 4, 2) + "/" + gfn_subStr(sMenuDate, 6, 2) + " (" + dsHeadObj.getColumn(nRow, "WE") + ")";
			
				grdObj.setFormatColProperty(nCol, "size", 100);
				grdObj.setCellProperty("head", nCol, "text", sDay);
				grdObj.setCellProperty("head", nCol, "color", "#" + dsHeadObj.lookup("FDAY", sMenuDate, "WE_COLOR"));
				grdObj.setCellProperty("head", fn_getColId(grdObj, nCol), "color", "#" + dsHeadObj.lookup("FDAY", sMenuDate, "WE_COLOR"));				
				grdObj.setCellProperty("body", nCol, "text", "bind:" + sColId);
				grdObj.setCellProperty("body", nCol, "edittype", "text");
				grdObj.setCellProperty("body", nCol, "align", "left");
				grdObj.setCellProperty("body", nCol, "padding", "2 2 2 2");
				grdObj.setCellProperty("body", nCol, "line", "EXPR(iif(MEAL_NAME!=ds_menuList.getColumn(currow+1, 'MEAL_NAME') || CORNER_NAME!=ds_menuList.getColumn(currow+1, 'CORNER_NAME'),'" + sProp2 + "','" + sProp1 + "'))");
				//grdObj.setCellProperty("body", nCol, "line", "EXPR(iif(getRowLevel(currow)==1,'" + sProp2 + "','" + sProp1 + "'))");
				grdObj.setCellProperty("body", nCol, "background", "EXPR(iif(getRowLevel(currow)==1,'#fffdecff','#ffffffff'))");
				grdObj.setCellProperty("body", nCol, "background2", "EXPR(iif(getRowLevel(currow)==1,'#fffdecff','#ffffffff'))");
			}
		} 
		else if (sColId.substr(0, 10) == "RECIPE_CAL")
		{
			sMenuDate = sColId.replace("RECIPE_CAL", "").substr(0,8);
			nCol = grdObj.appendContentsCol();
			if (nCol > -1)
			{
				nRow = dsHeadObj.findRowExpr("FDAY==" + sMenuDate);
				sDay = gfn_subStr(sMenuDate, 4, 2) + "/" + gfn_subStr(sMenuDate, 6, 2) + " (" + dsHeadObj.getColumn(nRow, "WE") + ")";
				
				grdObj.setFormatColProperty(nCol, "size", 53);
				grdObj.setCellProperty("head", nCol, "text", "Kcal");
				grdObj.setCellProperty("head", nCol, "color", "#" + dsHeadObj.lookup("FDAY", sMenuDate, "WE_COLOR"));
				grdObj.setCellProperty("head", fn_getColId(grdObj, nCol), "color", "#" + dsHeadObj.lookup("FDAY", sMenuDate, "WE_COLOR"));				
				grdObj.setCellProperty("body", nCol, "text", "bind:" + sColId);
				grdObj.setCellProperty("body", nCol, "align", "right");
				grdObj.setCellProperty("body", nCol, "line", "EXPR(iif(MEAL_NAME!=ds_menuList.getColumn(currow+1, 'MEAL_NAME') || CORNER_NAME!=ds_menuList.getColumn(currow+1, 'CORNER_NAME'),'" + sProp4 + "','" + sProp3 + "'))");
				//grdObj.setCellProperty("body", nCol, "line", "EXPR(iif(getRowLevel(currow)==1,'" + sProp4 + "','" + sProp3 + "'))");
				grdObj.setCellProperty("body", nCol, "displaytype", "number");
				grdObj.setCellProperty("body", nCol, "background", "EXPR(iif(getRowLevel(currow)==1,'#fffdecff','whitesmoke'))");
				grdObj.setCellProperty("body", nCol, "background2", "EXPR(iif(getRowLevel(currow)==1,'#fffdecff','whitesmoke'))");
			}
		}
	}

	grdObj.setCellProperty("body", 0, "text", "EXPR(iif(getRowLevel(currow)==1,ds_menuList.getColumn(currow-1,'MEAL_NAME'),MEAL_NAME))");
	grdObj.setCellProperty("body", 1, "background", "EXPR(iif(getRowLevel(currow)==1,'#fffdecff','whitesmoke'))");
	grdObj.setCellProperty("body", 1, "background2", "EXPR(iif(getRowLevel(currow)==1,'#fffdecff','whitesmoke'))");

	dsGrdObj.rowposition = -1;
	dsGrdObj.enableevent = true;
	
	dsGrdObj.keystring = "G:MEAL";
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_setMenuGridData(grdObj, dsGrdObj, dsHeadObj, dsBodyObj)
 * 기ㅡㅡㅡ능 : 그리드 데이터 세팅(열량미표시)
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_setMenuGridData2(grdObj, dsGrdObj, dsHeadObj, dsBodyObj)
{
	dsGrdObj.enableevent = false;
	var nRow, nCol;
	dsGrdObj.keystring = "S:+MEAL+CORNER+RECIPE_INFO";
	dsGrdObj.clear();
	dsGrdObj.addColumn("KEY"                 , "STRING");  // 키
	dsGrdObj.addColumn("MEAL"                , "STRING");  // 끼니
	dsGrdObj.addColumn("MEAL_NAME"           , "STRING");  // 끼니명
	dsGrdObj.addColumn("CORNER"              , "STRING");  // 코너
	dsGrdObj.addColumn("CORNER_NAME"         , "STRING");  // 코너명
	dsGrdObj.addColumn("RECIPE_INFO"         , "STRING");  // 레시피순번
	
	
	var sKey = "";
	var nRow = 0;
	for(var i=0; i<dsBodyObj.getRowCount(); i++)
	{
		nRow = dsGrdObj.findRow("KEY", dsBodyObj.getColumn(i, "MEAL") + dsBodyObj.getColumn(i, "CORNER") + dsBodyObj.getColumn(i, "RECIPE_INFO"));
		// 키가 존재하지 않을 경우 행 추가 후 세팅
		if(nRow == -1)
		{
			nRow = dsGrdObj.addRow();
			dsGrdObj.setColumn(nRow, "KEY"          , dsBodyObj.getColumn(i, "MEAL") + dsBodyObj.getColumn(i, "CORNER") + dsBodyObj.getColumn(i, "RECIPE_INFO"));			// 끼니코드 + 코너코드 + 레시피순번
			dsGrdObj.setColumn(nRow, "MEAL"         , dsBodyObj.getColumn(i, "MEAL"));
			dsGrdObj.setColumn(nRow, "MEAL_NAME"    , dsBodyObj.getColumn(i, "MEAL_NAME"));
			dsGrdObj.setColumn(nRow, "CORNER"       , dsBodyObj.getColumn(i, "CORNER"));
			dsGrdObj.setColumn(nRow, "CORNER_NAME"  , dsBodyObj.getColumn(i, "CORNER_NAME"));
			dsGrdObj.setColumn(nRow, "RECIPE_INFO"  , dsBodyObj.getColumn(i, "RECIPE_INFO"));
		}
	}
	
	dsGrdObj.keystring = "S:+MENU_DATE+MEAL+CORNER+RECIPE_INFO";
	
	sKey = "";
	for (var i=0; i<dsBodyObj.rowcount; i++) 
	{
		sKey = dsBodyObj.getColumn(i, "MENU_DATE");
		dsGrdObj.addColumn("RECIPE_NAME"  + sKey, "STRING");	
		
		var nFindRow = dsGrdObj.findRowExpr("MEAL=='" + dsBodyObj.getColumn(i, "MEAL") + "' && CORNER=='" + dsBodyObj.getColumn(i, "CORNER") + "' && RECIPE_INFO=='" + dsBodyObj.getColumn(i, "RECIPE_INFO") + "'");
		if (nFindRow > -1) 
		{
			dsGrdObj.setColumn(nFindRow, "RECIPE_NAME"  + sKey, gfn_trim(dsBodyObj.getColumn(i, "RECIPE_NAME")));
		}
	}	

	// 그리드 초기화
	for (var i=grdObj.getFormatColCount() - 1; i > 1; i--)
	{
		grdObj.deleteContentsCol('body', i, false);
	}
	
	// TOP, RIGHT, BOTTEM, LEFT
	var sProp1 = "0 none #c3c3c3ff, 1 dotted #c3c3c3ff, 0 none  #c3c3c3ff, 1 solid  #c3c3c3ff";  // 메뉴 body line
	var sProp2 = "0 none #c3c3c3ff, 1 dotted #c3c3c3ff, 1 solid #c3c3c3ff, 0 none   #c3c3c3ff";  // 메뉴 소계 line
	var sProp3 = "0 none #c3c3c3ff, 1 solid  #c3c3c3ff, 0 none  #c3c3c3ff, 1 dotted #c3c3c3ff";  // 원가 body line
	var sProp4 = "0 none #c3c3c3ff, 1 solid  #c3c3c3ff, 1 solid #c3c3c3ff, 1 dotted #c3c3c3ff";  // 원가 소계 line
	
	var sColId;
	var sDay;
	var sMenuDate;
	var sCorner;
	for (var i=0, nCol=-1; i < dsGrdObj.colcount; i++)
	{
		sColId = dsGrdObj.getColID(i);
		
		if(sColId.indexOf("RECIPE_NAME") < 0) continue;
		
		if (sColId.substr(0, 11) == "RECIPE_NAME")
		{
			sMenuDate = sColId.replace("RECIPE_NAME", "");
			nCol = grdObj.appendContentsCol();
			if (nCol > -1)
			{
				nRow = dsHeadObj.findRowExpr("FDAY==" + sMenuDate);
				sDay = gfn_subStr(sMenuDate, 4, 2) + "/" + gfn_subStr(sMenuDate, 6, 2) + " (" + dsHeadObj.getColumn(nRow, "WE") + ")";
			
				grdObj.setFormatColProperty(nCol, "size", 153);
				grdObj.setCellProperty("head", nCol, "text", sDay);
				grdObj.setCellProperty("head", nCol, "color", "#" + dsHeadObj.lookup("FDAY", sMenuDate, "WE_COLOR"));
				grdObj.setCellProperty("head", fn_getColId(grdObj, nCol), "color", "#" + dsHeadObj.lookup("FDAY", sMenuDate, "WE_COLOR"));				
				grdObj.setCellProperty("body", nCol, "text", "bind:" + sColId);
				grdObj.setCellProperty("body", nCol, "edittype", "text");
				grdObj.setCellProperty("body", nCol, "align", "left");
				grdObj.setCellProperty("body", nCol, "padding", "2 2 2 2");
				grdObj.setCellProperty("body", nCol, "editautoselect", "true");
				grdObj.setCellProperty("body", nCol, "line", "EXPR(iif(MEAL_NAME!=ds_menuList.getColumn(currow+1, 'MEAL_NAME') || CORNER_NAME!=ds_menuList.getColumn(currow+1, 'CORNER_NAME'),'" + sProp2 + "','" + sProp1 + "'))");
				grdObj.setCellProperty("body", nCol, "background", "EXPR(iif(getRowLevel(currow)==1,'#fffdecff','#ffffffff'))");
				grdObj.setCellProperty("body", nCol, "background2", "EXPR(iif(getRowLevel(currow)==1,'#fffdecff','#ffffffff'))");
			}
		} 
	}

	dsGrdObj.rowposition = -1;
	dsGrdObj.enableevent = true;
}

function fn_getColId(objGrid, nBodyColIdx)
{
	var arrCellIdx = [];
	for (var i=0; i<objGrid.getCellCount("head"); i++) {
		var nHeadColIdx = objGrid.getCellProperty("head", i, "col");
		if (nBodyColIdx == nHeadColIdx) {
			arrCellIdx[arrCellIdx.length] = i;
		}
	}	
	return arrCellIdx[arrCellIdx.length-1];	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_hallSearch()
 * 기ㅡㅡㅡ능 : 식당정보 조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_hallSearch()
{
	// 업장이 선택되어 있을 경우에만 조회한다.
	if(gfn_isNull(ds_cond.getColumn(0, "UPJANG"))) return;

	// 기존 데이터 초기화
	fn_initData();

	fsp_clear(this); 
	fsp_addSearch(this, "fs/fsc:FSA_HALL_MST_S001");
	fsp_callService(this, "", "", "", "ds_cboHall=gds_Csqlout", "UPJANG=" + wrapQuote(ds_cond.getColumn(0, "UPJANG")), "fn_callbackHallSearch");
}

function fn_callbackHallSearch(errCode, errMsg) 
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오!");
		return;
	}
	cbo_hall.index = 0;

	// 창고코드 셋팅
	ds_cond.setColumn(0, "SUBINV_CODE", ds_cboHall.getColumn(0, "SUBINV_CODE"));	

	// 코너 조회
	fn_cornerSearch();
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_cornerSearch()
 * 기ㅡㅡㅡ능 : 코너정보 조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_cornerSearch()
{
	var otherArg = "";
	otherArg = "UPJANG=" + wrapQuote(ds_cond.getColumn(0, "UPJANG"));
	otherArg = otherArg + " HALL_CD=" + wrapQuote(gfn_trim(cbo_hall.value));
	otherArg = otherArg + " BLANK='Y'";
	
	fsp_clear(this); 
    fsp_addSearch(this, "fs/fsc:FSC_UPJANG_HALL_CORNER_S001");
    fsp_callService(this, "", "", "", "ds_cboCorner=ds_upjang_hall_corner", otherArg, "fn_callbackCornerSearch");
}

function fn_callbackCornerSearch(errCode, errMsg) 
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오!");
		return;
	}
	
	// 초기값 셋팅
	cbo_corner.index = 0;
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// 
//=========================================================================================
/******************************************************************************************
 * 함ㅡ수ㅡ명 : cbo_hall_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
 * 기ㅡㅡㅡ능 : 식당 변경시 식단주기값 세팅 및 코너조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function cbo_hall_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	// 식당변경시 데이터 초기화
	fn_initData();
	
	// 창고코드 셋팅
	ds_cond.setColumn(0, "SUBINV_CODE", ds_cboHall.getColumn(e.postindex, "SUBINV_CODE"));	
	
	// 코너 조회
	fn_cornerSearch();
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : cbo_corner_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
 * 기ㅡㅡㅡ능 : 코너 변경시 끼니 조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function cbo_corner_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	var otherArg = "";
	otherArg = "UPJANG=" + wrapQuote(ds_cond.getColumn(0,"UPJANG"));
	otherArg = otherArg + " HALL_CD=" + wrapQuote(gfn_trim(cbo_hall.value));
	otherArg = otherArg + " CORNER=" + wrapQuote(gfn_trim(obj.value));
	otherArg = otherArg + " BLANK='Y'";
	
	fsp_clear(this); 
    fsp_addSearch(this, "fs/fsc:FSC_UPJANG_HALL_MEAL_S001");
    fsp_callService(this, "", "", "", "ds_cboMeal=ds_upjang_hall_meal", otherArg, "fn_callbackMealSearch");
}

function fn_callbackMealSearch(errCode, errMsg) 
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오!");
		return;
	}
	
	// 초기값 셋팅
	cbo_meal.index = 0;
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_excel_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 엑셀 내려받기
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function btn_excel_onclick(obj:Button,  e:ClickEventInfo)
{
	if (ds_menuList.getRowCount() == 0) {
		g_Message("EE",	"출력할 식단정보가 없습니다.");
		return;
	}

	gfn_exportExcel(grd_menuList, "식단표","","","","","cellline");		
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : grd_menuList_onheadclick(obj:Grid, e:GridClickEventInfo)
 * 기ㅡㅡㅡ능 : 헤더클릭시 정렬기능 막기
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function grd_menuList_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	return false;
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_tmChange(obj, data)
 * 기ㅡㅡㅡ능 : 팀 변경시 사업장 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function fn_tmChange(obj, data)
{
	if(gfn_isNull(edt_tm.getTmCode()))
	{
		cbo_mu.setMuCode("");
	}
	edt_upjang.setUpjangCode("");
}

function grd_menuList_onrbuttondown(obj:Grid, e:GridMouseEventInfo)
{
	var nRow = ds_menuList.rowposition;
	if(nRow < 0) return;

	var nCell = grd_menuList.getCellPos();
	if (nCell < 1) { return false; }
	
	system.clearClipboard();
	
	var sColId = grd_menuList.getCellProperty("body", nCell, "text").replace("bind:", "");
	var sMeal = ds_menuList.getColumn(nRow, "MEAL");
	var sCorner = ds_menuList.getColumn(nRow, "CORNER");

	ds_menuList.filter("MEAL=='" + sMeal + "' && CORNER=='" + sCorner + "'");
	var sMenuText = "";
	for(var i=0; i<ds_menuList.getRowCount(); i++)
	{
		if(gfn_isNull(ds_menuList.getColumn(i, sColId))) 
		{
			if(i < ds_menuList.getRowCount() - 1)
			{
				sMenuText += "\r\n";
			}
			continue;
		}
	
		sMenuText += ds_menuList.getColumn(i, sColId);
		if(i < ds_menuList.getRowCount() - 1)
		{
			sMenuText += "\r\n";
		}
	}
	ds_menuList.filter("");
	system.setClipboard("CF_TEXT", sMenuText);
}

function grd_menuList_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
}

function grd_menuList_onkeydown(obj:Grid, e:KeyEventInfo)
{
	var nRow = ds_menuList.rowposition;
	if(nRow < 0) return;

	var nCell = grd_menuList.getCellPos();
	if (nCell < 1) { return false; }
	
	// 복사하기 : Ctrl + S 키
	if ( e.keycode == 83 && e.ctrlKey && ToUpperCase(GetType(e.fromreferenceobject))== "GRID" )
	{
		system.clearClipboard();
		
		var sColId = grd_menuList.getCellProperty("body", nCell, "text").replace("bind:", "");
		var sMeal = ds_menuList.getColumn(nRow, "MEAL");
		var sCorner = ds_menuList.getColumn(nRow, "CORNER");

		ds_menuList.filter("MEAL=='" + sMeal + "' && CORNER=='" + sCorner + "'");
		var sMenuText = "";
		for(var i=0; i<ds_menuList.getRowCount(); i++)
		{
			if(gfn_isNull(ds_menuList.getColumn(i, sColId))) 
			{
				if(i < ds_menuList.getRowCount() - 1)
				{
					sMenuText += "\r\n";
				}
				continue;
			}
		
			sMenuText += ds_menuList.getColumn(i, sColId);
			if(i < ds_menuList.getRowCount() - 1)
			{
				sMenuText += "\r\n";
			}
		}
		ds_menuList.filter("");

		system.setClipboard("CF_TEXT", sMenuText);
	}
}
]]></Script>
  </Form>
</FDL>

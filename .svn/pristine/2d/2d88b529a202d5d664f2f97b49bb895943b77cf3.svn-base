<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="SpecmTypeTestArticleMappMgmt" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="검체유형시험항목매핑관리" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="6" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static22" text="검체유형목록" class="sta_WF_Title01" position="absolute 0 84 450 102" anchor="left top"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 450 84" anchor="left top"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 97 450 102" anchor="left top"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 93 40" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 93 71" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Grid id="grd_specmTypeArticleList" taborder="3" binddataset="ds_specmTypeArticleList" autoenter="none" useinputpanel="false" cellsizingtype="col" autofittype="col" position="absolute 0 102 520 710" anchor="left top bottom" selecttype="row" cellclickbound="control" fillareatype="none" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" oncellclick="grd_specmTypeArticleList_oncellclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="44"/>
                <Column size="132"/>
                <Column size="160"/>
                <Column size="196"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="No."/>
                <Cell col="1" text="대분류"/>
                <Cell col="2" text="중분류"/>
                <Cell col="3" text="소분류"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" displaytype="text" edittype="none" style="align: ;" text="bind:mgrpNm" suppress="1" suppressalign="first"/>
                <Cell col="2" displaytype="text" edittype="none" style="align: ;" text="bind:mcalssNm" suppress="2"/>
                <Cell col="3" displaytype="text" edittype="none" style="align: ;" text="bind:sclassNm"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="sta_specmTypeArticleCnt" text="총건수 : 0건" position="absolute 141 85 272 99"/>
        <Static id="Static34" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 520 71 530 375" anchor="left bottom"/>
        <Static id="Static00" text="시험항목" class="sta_WF_Title01" position="absolute 530 84 980 102" anchor="left top"/>
        <Static id="Static01" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 528 71 978 84" anchor="left top"/>
        <Static id="Static02" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 528 97 978 102" anchor="left top"/>
        <Tab id="tab_testArticle" taborder="30" tabindex="0" scrollbars="autoboth" position="absolute 530 156 1237 710" style="buttonpadding:8 13 5 13;showextrabutton:false;" canchange="tab_testArticle_canchange" onchanged="tab_testArticle_onchanged" anchor="all">
          <Tabpages>
            <Tabpage id="tpg_insptPurp1" text="공전법1">
              <Layouts>
                <Layout>
                  <Static id="Static07" visible="false" position="absolute 0 0 10 111" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static05" visible="false" position="absolute 12 570 657 580" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static01" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 10 0 460 13" anchor="left top"/>
                  <Static id="Static00" text="시험항목" class="sta_WF_Title01" position="absolute 10 13 460 31" anchor="left top"/>
                  <Static id="Static02" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 26 460 31" anchor="left top"/>
                  <Static id="Static03" visible="false" position="absolute 695 0 705 111" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static39" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 553 -991 637 -986" anchor="top right"/>
                  <Static id="Static40" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 553 -1017 637 -1011" anchor="top right"/>
                  <Static id="Static41" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 617 -1010 619 -990" anchor="top right"/>
                  <Static id="Static42" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 534 -1010 536 -990" anchor="top right"/>
                  <Static id="Static04" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 611 26 695 31" anchor="top right"/>
                  <Static id="Static06" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 611 0 695 6" anchor="top right"/>
                  <Static id="Static08" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 576 7 578 27" anchor="top right"/>
                  <Button id="btn_excelUpload" taborder="1" text="엑셀업로드" class="btn_WF_Function" position="absolute 806 7 887 27" anchor="top right" onclick="btn_excelUpload_onclick" visible="false"/>
                  <Button id="btn_saveExcel" taborder="2" class="btn_WF_GrdSave" position="absolute 677 6 695 26" anchor="top right" tooltiptext="저장" onclick="btn_saveExcel_onclick" visible="true"/>
                  <Button id="btn_delAll" taborder="3" text="전체삭제" class="btn_WF_Function" position="absolute 739 7 804 27" anchor="top right" onclick="btn_delAll_onclick" visible="false"/>
                  <Button id="btn_excelUploadSave" taborder="4" text="엑셀엡로드저장" class="btn_WF_Function" position="absolute 889 7 986 27" anchor="top right" onclick="btn_excelUploadSave_onclick" visible="false"/>
                  <Static id="Static09" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 493 7 495 27" anchor="top right"/>
                  <Static id="Static10" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 675 7 677 27" anchor="top right"/>
                  <Static id="Static11" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 513 450 526" anchor="left top"/>
                  <Grid id="grd_testArticleList" taborder="6" binddataset="ds_testArticleList01" autoenter="select" useinputpanel="false" cellsizingtype="col" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" position="absolute 10 31 695 513" anchor="all">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40" band="left"/>
                          <Column size="44" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="105" band="left"/>
                          <Column size="200" band="left"/>
                          <Column size="62"/>
                          <Column size="62"/>
                          <Column size="77"/>
                          <Column size="62"/>
                          <Column size="73"/>
                          <Column size="211"/>
                          <Column size="85"/>
                          <Column size="85"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="206"/>
                          <Column size="206"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" displaytype="checkbox" edittype="checkbox"/>
                          <Cell col="2" text="대분류코드"/>
                          <Cell col="3" text="대분류명"/>
                          <Cell col="4" text="중분류코드"/>
                          <Cell col="5" text="중분류명"/>
                          <Cell col="6" text="소분류코드"/>
                          <Cell col="7" text="소분류명"/>
                          <Cell col="8" edittype="text" text="코드"/>
                          <Cell col="9" text="시험항목"/>
                          <Cell col="10" class="grd_WF_Essential" text="법적기준"/>
                          <Cell col="11" class="grd_WF_Essential" text="내부기준"/>
                          <Cell col="12" text="검사분야"/>
                          <Cell col="13" text="소요기간"/>
                          <Cell col="14" text="부적합 분류"/>
                          <Cell col="15" class="grd_WF_Essential" text="규격기준"/>
                          <Cell col="16" text="식약처수수료"/>
                          <Cell col="17" text="내부수수료"/>
                          <Cell col="18" text="수수료3"/>
                          <Cell col="19" text="수수료4"/>
                          <Cell col="20" text="수수료5"/>
                          <Cell col="21" text="수수료산정"/>
                          <Cell col="22" class="grd_WF_Essential" text="비고"/>
                        </Band>
                        <Band id="body">
                          <Cell text="expr:currow+1"/>
                          <Cell col="1" displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                          <Cell col="2" text="bind:mgrpCd"/>
                          <Cell col="3" text="bind:mgrpNm"/>
                          <Cell col="4" text="bind:mcalssCd"/>
                          <Cell col="5" text="bind:mcalssNm"/>
                          <Cell col="6" text="bind:sclassCd"/>
                          <Cell col="7" text="bind:sclassNm"/>
                          <Cell col="8" edittype="none" style="align:center;" text="bind:articleCd"/>
                          <Cell col="9" displaytype="text" edittype="none" style="align: ;" text="bind:articleNm"/>
                          <Cell col="10" displaytype="checkbox" edittype="checkbox" text="bind:legalBasis"/>
                          <Cell col="11" displaytype="checkbox" edittype="checkbox" text="bind:insideBasis"/>
                          <Cell col="12" displaytype="combo" text="bind:insptFld" combodataset="ds_cboInsptFld" combocodecol="code" combodatacol="codeName"/>
                          <Cell col="13" text="bind:takeTerm"/>
                          <Cell col="14" displaytype="combo" text="bind:notFitClsfi" combodataset="ds_cboNotFitClsfi" combocodecol="code" combodatacol="codeName"/>
                          <Cell col="15" displaytype="text" edittype="text" style="align: ;" text="bind:basisStand"/>
                          <Cell col="16" displaytype="number" edittype="none" text="bind:comm1" mask="@,@@@"/>
                          <Cell col="17" displaytype="number" text="bind:comm2" mask="@,@@@"/>
                          <Cell col="18" displaytype="number" text="0" mask="@,@@@"/>
                          <Cell col="19" displaytype="number" text="0" mask="@,@@@"/>
                          <Cell col="20" displaytype="number" text="0" mask="@,@@@"/>
                          <Cell col="21" displaytype="text" style="align: ;" text="bind:commCalc"/>
                          <Cell col="22" displaytype="text" edittype="text" text="bind:remark"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tpg_insptPurp2" text="공전법2" style="anchor:default;margin:0 0 0 0;">
              <Layouts>
                <Layout>
                  <Static id="Static12" visible="false" position="absolute 0 0 10 111" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static13" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 10 0 460 13" anchor="left top"/>
                  <Static id="Static14" text="시험항목" class="sta_WF_Title01" position="absolute 10 13 460 31" anchor="left top"/>
                  <Grid id="grd_testArticleList" taborder="1" binddataset="ds_testArticleList02" autoenter="select" useinputpanel="false" cellsizingtype="col" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" position="absolute 10 31 695 513" anchor="all">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40" band="left"/>
                          <Column size="44" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="105" band="left"/>
                          <Column size="200" band="left"/>
                          <Column size="62"/>
                          <Column size="62"/>
                          <Column size="77"/>
                          <Column size="62"/>
                          <Column size="73"/>
                          <Column size="211"/>
                          <Column size="85"/>
                          <Column size="85"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="206"/>
                          <Column size="206"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" displaytype="checkbox" edittype="checkbox"/>
                          <Cell col="2" text="대분류코드"/>
                          <Cell col="3" text="대분류명"/>
                          <Cell col="4" text="중분류코드"/>
                          <Cell col="5" text="중분류명"/>
                          <Cell col="6" text="소분류코드"/>
                          <Cell col="7" text="소분류명"/>
                          <Cell col="8" edittype="text" text="코드"/>
                          <Cell col="9" text="시험항목"/>
                          <Cell col="10" class="grd_WF_Essential" text="법적기준"/>
                          <Cell col="11" class="grd_WF_Essential" text="내부기준"/>
                          <Cell col="12" text="검사분야"/>
                          <Cell col="13" text="소요기간"/>
                          <Cell col="14" text="부적합 분류"/>
                          <Cell col="15" class="grd_WF_Essential" text="규격기준"/>
                          <Cell col="16" text="식약처수수료"/>
                          <Cell col="17" text="내부수수료"/>
                          <Cell col="18" text="수수료3"/>
                          <Cell col="19" text="수수료4"/>
                          <Cell col="20" text="수수료5"/>
                          <Cell col="21" text="수수료산정"/>
                          <Cell col="22" class="grd_WF_Essential" text="비고"/>
                        </Band>
                        <Band id="body">
                          <Cell text="expr:currow+1"/>
                          <Cell col="1" displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                          <Cell col="2" text="bind:mgrpCd"/>
                          <Cell col="3" text="bind:mgrpNm"/>
                          <Cell col="4" text="bind:mcalssCd"/>
                          <Cell col="5" text="bind:mcalssNm"/>
                          <Cell col="6" text="bind:sclassCd"/>
                          <Cell col="7" text="bind:sclassNm"/>
                          <Cell col="8" edittype="none" style="align:center;" text="bind:articleCd"/>
                          <Cell col="9" displaytype="text" edittype="none" style="align: ;" text="bind:articleNm"/>
                          <Cell col="10" displaytype="checkbox" edittype="checkbox" text="bind:legalBasis"/>
                          <Cell col="11" displaytype="checkbox" edittype="checkbox" text="bind:insideBasis"/>
                          <Cell col="12" displaytype="combo" text="bind:insptFld" combodataset="ds_cboInsptFld" combocodecol="code" combodatacol="codeName"/>
                          <Cell col="13" text="bind:takeTerm"/>
                          <Cell col="14" displaytype="combo" text="bind:notFitClsfi" combodataset="ds_cboNotFitClsfi" combocodecol="code" combodatacol="codeName"/>
                          <Cell col="15" displaytype="text" edittype="text" style="align: ;" text="bind:basisStand"/>
                          <Cell col="16" displaytype="number" edittype="none" text="bind:comm1" mask="@,@@@"/>
                          <Cell col="17" displaytype="number" text="bind:comm2" mask="@,@@@"/>
                          <Cell col="18" displaytype="number" text="0" mask="@,@@@"/>
                          <Cell col="19" displaytype="number" text="0" mask="@,@@@"/>
                          <Cell col="20" displaytype="number" text="0" mask="@,@@@"/>
                          <Cell col="21" displaytype="text" style="align: ;" text="bind:commCalc"/>
                          <Cell col="22" displaytype="text" edittype="text" text="bind:remark"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static17" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 26 460 31" anchor="left top"/>
                  <Static id="Static18" visible="false" position="absolute 695 0 705 111" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static19" visible="false" position="absolute 12 570 657 580" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static04" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 611 26 695 31" anchor="top right"/>
                  <Static id="Static06" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 611 0 695 6" anchor="top right"/>
                  <Static id="Static08" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 576 7 578 27" anchor="top right"/>
                  <Button id="btn_excelUpload" taborder="1" text="엑셀업로드" class="btn_WF_Function" position="absolute 495 6 576 26" anchor="top right" onclick="btn_excelUpload_onclick" visible="false"/>
                  <Button id="btn_saveExcel" taborder="2" class="btn_WF_GrdSave" position="absolute 677 6 695 26" anchor="top right" tooltiptext="저장" onclick="btn_saveExcel_onclick" visible="true"/>
                  <Button id="btn_delAll" taborder="3" text="전체삭제" class="btn_WF_Function" position="absolute 428 6 493 26" anchor="top right" onclick="btn_delAll_onclick" visible="false"/>
                  <Button id="btn_excelUploadSave" taborder="4" text="엑셀엡로드저장" class="btn_WF_Function" position="absolute 578 6 675 26" anchor="top right" onclick="btn_excelUploadSave_onclick" visible="false"/>
                  <Static id="Static09" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 493 7 495 27" anchor="top right"/>
                  <Static id="Static10" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 675 7 677 27" anchor="top right"/>
                  <Static id="Static00" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 513 450 526" anchor="left top"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tpg_insptPurp3" text="내부실험법1">
              <Layouts>
                <Layout>
                  <Static id="Static12" visible="false" position="absolute 0 0 10 111" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static13" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 10 0 460 13" anchor="left top"/>
                  <Static id="Static14" text="시험항목" class="sta_WF_Title01" position="absolute 10 13 460 31" anchor="left top"/>
                  <Grid id="grd_testArticleList" taborder="1" binddataset="ds_testArticleList03" autoenter="select" useinputpanel="false" cellsizingtype="col" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" position="absolute 10 31 695 513" anchor="all">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40" band="left"/>
                          <Column size="44" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="105" band="left"/>
                          <Column size="200" band="left"/>
                          <Column size="62"/>
                          <Column size="62"/>
                          <Column size="77"/>
                          <Column size="62"/>
                          <Column size="73"/>
                          <Column size="211"/>
                          <Column size="85"/>
                          <Column size="85"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="206"/>
                          <Column size="206"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" displaytype="checkbox" edittype="checkbox"/>
                          <Cell col="2" text="대분류코드"/>
                          <Cell col="3" text="대분류명"/>
                          <Cell col="4" text="중분류코드"/>
                          <Cell col="5" text="중분류명"/>
                          <Cell col="6" text="소분류코드"/>
                          <Cell col="7" text="소분류명"/>
                          <Cell col="8" edittype="text" text="코드"/>
                          <Cell col="9" text="시험항목"/>
                          <Cell col="10" class="grd_WF_Essential" text="법적기준"/>
                          <Cell col="11" class="grd_WF_Essential" text="내부기준"/>
                          <Cell col="12" text="검사분야"/>
                          <Cell col="13" text="소요기간"/>
                          <Cell col="14" text="부적합 분류"/>
                          <Cell col="15" class="grd_WF_Essential" text="규격기준"/>
                          <Cell col="16" text="식약처수수료"/>
                          <Cell col="17" text="내부수수료"/>
                          <Cell col="18" text="수수료3"/>
                          <Cell col="19" text="수수료4"/>
                          <Cell col="20" text="수수료5"/>
                          <Cell col="21" text="수수료산정"/>
                          <Cell col="22" class="grd_WF_Essential" text="비고"/>
                        </Band>
                        <Band id="body">
                          <Cell text="expr:currow+1"/>
                          <Cell col="1" displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                          <Cell col="2" text="bind:mgrpCd"/>
                          <Cell col="3" text="bind:mgrpNm"/>
                          <Cell col="4" text="bind:mcalssCd"/>
                          <Cell col="5" text="bind:mcalssNm"/>
                          <Cell col="6" text="bind:sclassCd"/>
                          <Cell col="7" text="bind:sclassNm"/>
                          <Cell col="8" edittype="none" style="align:center;" text="bind:articleCd"/>
                          <Cell col="9" displaytype="text" edittype="none" style="align: ;" text="bind:articleNm"/>
                          <Cell col="10" displaytype="checkbox" edittype="checkbox" text="bind:legalBasis"/>
                          <Cell col="11" displaytype="checkbox" edittype="checkbox" text="bind:insideBasis"/>
                          <Cell col="12" displaytype="combo" text="bind:insptFld" combodataset="ds_cboInsptFld" combocodecol="code" combodatacol="codeName"/>
                          <Cell col="13" text="bind:takeTerm"/>
                          <Cell col="14" displaytype="combo" text="bind:notFitClsfi" combodataset="ds_cboNotFitClsfi" combocodecol="code" combodatacol="codeName"/>
                          <Cell col="15" displaytype="text" edittype="text" style="align: ;" text="bind:basisStand"/>
                          <Cell col="16" displaytype="number" edittype="none" text="bind:comm1" mask="@,@@@"/>
                          <Cell col="17" displaytype="number" text="bind:comm2" mask="@,@@@"/>
                          <Cell col="18" displaytype="number" text="0" mask="@,@@@"/>
                          <Cell col="19" displaytype="number" text="0" mask="@,@@@"/>
                          <Cell col="20" displaytype="number" text="0" mask="@,@@@"/>
                          <Cell col="21" displaytype="text" style="align: ;" text="bind:commCalc"/>
                          <Cell col="22" displaytype="text" edittype="text" text="bind:remark"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static17" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 26 460 31" anchor="left top"/>
                  <Static id="Static18" visible="false" position="absolute 695 0 705 111" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static19" visible="false" position="absolute 12 570 657 580" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static04" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 611 26 695 31" anchor="top right"/>
                  <Static id="Static06" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 611 0 695 6" anchor="top right"/>
                  <Static id="Static08" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 576 7 578 27" anchor="top right"/>
                  <Button id="btn_excelUpload" taborder="1" text="엑셀업로드" class="btn_WF_Function" position="absolute 495 6 576 26" anchor="top right" onclick="btn_excelUpload_onclick" visible="false"/>
                  <Button id="btn_saveExcel" taborder="2" class="btn_WF_GrdSave" position="absolute 677 6 695 26" anchor="top right" tooltiptext="저장" onclick="btn_saveExcel_onclick" visible="true"/>
                  <Button id="btn_delAll" taborder="3" text="전체삭제" class="btn_WF_Function" position="absolute 428 6 493 26" anchor="top right" onclick="btn_delAll_onclick" visible="false"/>
                  <Button id="btn_excelUploadSave" taborder="4" text="엑셀엡로드저장" class="btn_WF_Function" position="absolute 578 6 675 26" anchor="top right" onclick="btn_excelUploadSave_onclick" visible="false"/>
                  <Static id="Static09" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 493 7 495 27" anchor="top right"/>
                  <Static id="Static10" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 675 7 677 27" anchor="top right"/>
                  <Static id="Static00" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 4 513 454 526" anchor="left top"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tpg_insptPurp4" text="내부실험법2">
              <Layouts>
                <Layout>
                  <Static id="Static12" visible="false" position="absolute 0 0 10 111" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static13" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 10 0 460 13" anchor="left top"/>
                  <Static id="Static14" text="시험항목" class="sta_WF_Title01" position="absolute 10 13 460 31" anchor="left top"/>
                  <Grid id="grd_testArticleList" taborder="1" binddataset="ds_testArticleList04" autoenter="select" useinputpanel="false" cellsizingtype="col" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" position="absolute 10 31 695 513" anchor="all">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40" band="left"/>
                          <Column size="44" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="0" band="left"/>
                          <Column size="105" band="left"/>
                          <Column size="200" band="left"/>
                          <Column size="62"/>
                          <Column size="62"/>
                          <Column size="77"/>
                          <Column size="62"/>
                          <Column size="73"/>
                          <Column size="211"/>
                          <Column size="85"/>
                          <Column size="85"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="206"/>
                          <Column size="206"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" displaytype="checkbox" edittype="checkbox"/>
                          <Cell col="2" text="대분류코드"/>
                          <Cell col="3" text="대분류명"/>
                          <Cell col="4" text="중분류코드"/>
                          <Cell col="5" text="중분류명"/>
                          <Cell col="6" text="소분류코드"/>
                          <Cell col="7" text="소분류명"/>
                          <Cell col="8" edittype="text" text="코드"/>
                          <Cell col="9" text="시험항목"/>
                          <Cell col="10" class="grd_WF_Essential" text="법적기준"/>
                          <Cell col="11" class="grd_WF_Essential" text="내부기준"/>
                          <Cell col="12" text="검사분야"/>
                          <Cell col="13" text="소요기간"/>
                          <Cell col="14" text="부적합 분류"/>
                          <Cell col="15" class="grd_WF_Essential" text="규격기준"/>
                          <Cell col="16" text="식약처수수료"/>
                          <Cell col="17" text="내부수수료"/>
                          <Cell col="18" text="수수료3"/>
                          <Cell col="19" text="수수료4"/>
                          <Cell col="20" text="수수료5"/>
                          <Cell col="21" text="수수료산정"/>
                          <Cell col="22" class="grd_WF_Essential" text="비고"/>
                        </Band>
                        <Band id="body">
                          <Cell text="expr:currow+1"/>
                          <Cell col="1" displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                          <Cell col="2" text="bind:mgrpCd"/>
                          <Cell col="3" text="bind:mgrpNm"/>
                          <Cell col="4" text="bind:mcalssCd"/>
                          <Cell col="5" text="bind:mcalssNm"/>
                          <Cell col="6" text="bind:sclassCd"/>
                          <Cell col="7" text="bind:sclassNm"/>
                          <Cell col="8" edittype="none" style="align:center;" text="bind:articleCd"/>
                          <Cell col="9" displaytype="text" edittype="none" style="align: ;" text="bind:articleNm"/>
                          <Cell col="10" displaytype="checkbox" edittype="checkbox" text="bind:legalBasis"/>
                          <Cell col="11" displaytype="checkbox" edittype="checkbox" text="bind:insideBasis"/>
                          <Cell col="12" displaytype="combo" text="bind:insptFld" combodataset="ds_cboInsptFld" combocodecol="code" combodatacol="codeName"/>
                          <Cell col="13" text="bind:takeTerm"/>
                          <Cell col="14" displaytype="combo" text="bind:notFitClsfi" combodataset="ds_cboNotFitClsfi" combocodecol="code" combodatacol="codeName"/>
                          <Cell col="15" displaytype="text" edittype="text" style="align: ;" text="bind:basisStand"/>
                          <Cell col="16" displaytype="number" edittype="none" text="bind:comm1" mask="@,@@@"/>
                          <Cell col="17" displaytype="number" text="bind:comm2" mask="@,@@@"/>
                          <Cell col="18" displaytype="number" text="0" mask="@,@@@"/>
                          <Cell col="19" displaytype="number" text="0" mask="@,@@@"/>
                          <Cell col="20" displaytype="number" text="0" mask="@,@@@"/>
                          <Cell col="21" displaytype="text" style="align: ;" text="bind:commCalc"/>
                          <Cell col="22" displaytype="text" edittype="text" text="bind:remark"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static17" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 26 460 31" anchor="left top"/>
                  <Static id="Static18" visible="false" position="absolute 695 0 705 111" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static19" visible="false" position="absolute 12 570 657 580" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static04" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 611 26 695 31" anchor="top right"/>
                  <Static id="Static06" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 611 0 695 6" anchor="top right"/>
                  <Static id="Static08" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 576 7 578 27" anchor="top right"/>
                  <Button id="btn_excelUpload" taborder="1" text="엑셀업로드" class="btn_WF_Function" position="absolute 495 6 576 26" anchor="top right" onclick="btn_excelUpload_onclick" visible="false"/>
                  <Button id="btn_saveExcel" taborder="2" class="btn_WF_GrdSave" position="absolute 677 6 695 26" anchor="top right" tooltiptext="저장" onclick="btn_saveExcel_onclick" visible="true"/>
                  <Button id="btn_delAll" taborder="3" text="전체삭제" class="btn_WF_Function" position="absolute 428 6 493 26" anchor="top right" onclick="btn_delAll_onclick" visible="false"/>
                  <Button id="btn_excelUploadSave" taborder="4" text="엑셀엡로드저장" class="btn_WF_Function" position="absolute 578 6 675 26" anchor="top right" onclick="btn_excelUploadSave_onclick" visible="false"/>
                  <Static id="Static09" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 493 7 495 27" anchor="top right"/>
                  <Static id="Static10" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 675 7 677 27" anchor="top right"/>
                  <Static id="Static00" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 1 513 451 526" anchor="left top"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 73 40 83 61" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 243 40 273 61" anchor="left top"/>
        <Static id="Static03" text="중분류" class="sta_WFSA_label" position="absolute 273 40 335 61" anchor="left top"/>
        <Static id="Static10" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 318 40 328 61" anchor="left top"/>
        <Static id="Static28" text="공전유형" class="sta_WFSA_label" position="absolute 15 40 101 61" anchor="left top"/>
        <Combo id="cbo_specmTypeCd" taborder="0" innerdataset="ds_cboSpecmTypeCd" codecolumn="code" datacolumn="codeName" onitemchanged="cbo_specmTypeCd_onitemchanged" position="absolute 83 40 243 61" anchor="left top" class="cmb_WF_Essential"/>
        <Edit id="edt_searchMclass" taborder="1" imemode="hangul" onkeydown="edt_search_onkeydown" position="absolute 328 40 488 61" anchor="left top"/>
        <Static id="Static12" text="체크된 데이터만 저장 됩니다." class="sta_WF_DiscPoint" position="absolute 1032 84 1236 99" anchor="top right" style="color:red;"/>
        <Static id="Static45" class="sta_WFSA_Labelbg01" position="absolute 530 102 1237 143" anchor="left top right"/>
        <Static id="Static43" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 603 112 613 133" anchor="left top"/>
        <Edit id="edt_searchSub" taborder="4" imemode="hangul" position="absolute 613 112 773 133" anchor="left top" onkeydown="edt_searchSub_onkeydown" ontextchanged="edt_searchSub_ontextchanged"/>
        <Static id="Static46" text="시험항목" class="sta_WFSA_label01" position="absolute 545 112 611 133" anchor="left top"/>
        <Combo id="cbo_insptFld" taborder="0" innerdataset="@ds_insptFld" codecolumn="code" datacolumn="codeName" position="absolute 848 112 914 133" anchor="left top" onitemchanged="cbo_insptFld_onitemchanged"/>
        <Static id="Static110" text="검사분야" class="sta_WFSA_label" position="absolute 780 112 846 133" anchor="left top"/>
        <Static id="Static13" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 531 103 624 113" anchor="left top"/>
        <Static id="Static14" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 531 133 624 143" anchor="left top"/>
        <Static id="Static17" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 531 112 546 133" anchor="left top"/>
        <Button id="btn_search" taborder="5" text="조회" class="btn_WF_Function" position="absolute 1161 112 1226 132" anchor="top right" onclick="btn_search_onclick"/>
        <Static id="Static19" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 530 143 980 156" anchor="left top"/>
        <Static id="Static18" visible="false" position="absolute 1226 103 1236 142" style="background:#ff000033;font:Dotum,8;"/>
        <Button id="btn_wideLeft" taborder="35" text="옆으로늘이기" class="btn_WF_Function" position="absolute 1143 156 1227 176" anchor="top right" onclick="btn_wideLeft_onclick"/>
        <Static id="Static20" visible="false" position="absolute 1227 143 1237 182" style="background:#ff000033;font:Dotum,8;"/>
        <Static id="Static21" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1143 176 1227 182" anchor="top right"/>
        <Static id="Static23" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 488 40 518 61" anchor="left top"/>
        <Static id="Static24" text="소분류" class="sta_WFSA_label" position="absolute 518 40 580 61" anchor="left top"/>
        <Static id="Static25" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 563 40 573 61" anchor="left top"/>
        <Edit id="edt_search" taborder="2" imemode="hangul" onkeydown="edt_search_onkeydown" ontextchanged="edt_search_ontextchanged" position="absolute 573 40 733 61" anchor="left top" tabstop="true"/>
        <Button id="btn_ImprvexcelUpload" taborder="36" text="엑셀등록" class="btn_WF_Function" position="absolute 1073 156 1138 176" anchor="top right" onclick="btn_ImprvexcelUpload_onclick"/>
        <Button id="btn_ImprvexcelDown" taborder="38" text="엑셀다운로드" class="btn_WF_Function" position="absolute 990 156 1068 176" anchor="top right" onclick="btn_ImprvexcelDown_onclick"/>
        <Grid id="Grid_Mapping" taborder="39" useinputpanel="false" position="absolute 1377 125 2033 180" binddataset="ds_testMappingList" onheadclick="Grid_Mapping_onheadclick" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" class="head_Excel"/>
                <Cell col="1" rowspan="2" style="align:center middle;" text="대분류코드"/>
                <Cell col="2" rowspan="2" style="align:center middle;" text="대분류명"/>
                <Cell col="3" rowspan="2" style="align:center middle;" text="중분류코드"/>
                <Cell col="4" rowspan="2" style="align:center middle;" text="중분류명"/>
                <Cell col="5" rowspan="2" style="align:center middle;" text="소분류코드"/>
                <Cell col="6" rowspan="2" style="align:center middle;" text="소분류명"/>
                <Cell col="7" colspan="2" text="시험항목"/>
                <Cell col="9" colspan="5" text="법적기준(공전법)"/>
                <Cell col="14" colspan="5" text="법적+내부기준(공전법)"/>
                <Cell col="19" colspan="5" text="법적+내부기준(내부법)"/>
                <Cell col="24" colspan="5" text="Spare Part"/>
                <Cell row="1" col="7" text="시험항목코드"/>
                <Cell row="1" col="8" text="시험항목명"/>
                <Cell row="1" col="9" text="등록"/>
                <Cell row="1" col="10" text="법적기준"/>
                <Cell row="1" col="11" text="내부기준"/>
                <Cell row="1" col="12" text="규격기준"/>
                <Cell row="1" col="13" text="비고"/>
                <Cell row="1" col="14" text="등록"/>
                <Cell row="1" col="15" text="법적기준"/>
                <Cell row="1" col="16" text="내부기준"/>
                <Cell row="1" col="17" text="규격기준"/>
                <Cell row="1" col="18" text="비고"/>
                <Cell row="1" col="19" text="등록"/>
                <Cell row="1" col="20" text="법적기준"/>
                <Cell row="1" col="21" text="내부기준"/>
                <Cell row="1" col="22" text="규격기준"/>
                <Cell row="1" col="23" text="비고"/>
                <Cell row="1" col="24" text="등록"/>
                <Cell row="1" col="25" text="법적기준"/>
                <Cell row="1" col="26" text="내부기준"/>
                <Cell row="1" col="27" text="규격기준"/>
                <Cell row="1" col="28" text="비고"/>
                <Cell row="2" colspan="9" text="필수입력항목: 대분류코드, 중분류코드, 소분류코드, 시험항목코드" taborder="undefined"/>
                <Cell row="2" col="9" colspan="20" text="등록여부가 'N'이면 등록데이터 삭제/법적기준, 내부기준 중 1개 선택 필수" taborder="undefined"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" text="bind:mgrpCd"/>
                <Cell col="2" text="bind:mgrpNm"/>
                <Cell col="3" text="bind:mcalssCd"/>
                <Cell col="4" text="bind:mcalssNm"/>
                <Cell col="5" text="bind:sclassCd"/>
                <Cell col="6" text="bind:sclassNm"/>
                <Cell col="7" text="bind:articleCd"/>
                <Cell col="8" text="bind:articleNm"/>
                <Cell col="9" text="bind:useYn101"/>
                <Cell col="10" text="bind:legalBasis101"/>
                <Cell col="11" text="bind:insideBasis101"/>
                <Cell col="12" text="bind:basisStand101"/>
                <Cell col="13" text="bind:remark101"/>
                <Cell col="14" text="bind:useYn102"/>
                <Cell col="15" text="bind:legalBasis102"/>
                <Cell col="16" text="bind:insideBasis102"/>
                <Cell col="17" text="bind:basisStand102"/>
                <Cell col="18" text="bind:remark102"/>
                <Cell col="19" text="bind:useYn103"/>
                <Cell col="20" text="bind:legalBasis103"/>
                <Cell col="21" text="bind:insideBasis103"/>
                <Cell col="22" text="bind:basisStand103"/>
                <Cell col="23" text="bind:remark103"/>
                <Cell col="24" text="bind:useYn104"/>
                <Cell col="25" text="bind:legalBasis104"/>
                <Cell col="26" text="bind:insideBasis104"/>
                <Cell col="27" text="bind:basisStand104"/>
                <Cell col="28" text="bind:remark104"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item1" compid="cbo_specmTypeCd" propid="value" datasetid="ds_search" columnid="specmType"/>
      <BindItem id="item0" compid="edt_searchMclass" propid="value" datasetid="ds_search" columnid="edtMclassSearch"/>
      <BindItem id="item2" compid="edt_searchSub" propid="value" datasetid="ds_search" columnid="edtSearchSub"/>
      <BindItem id="item3" compid="edt_search" propid="value" datasetid="ds_search" columnid="edtSearch"/>
      <BindItem id="item4" compid="cbo_insptFld" propid="value" datasetid="ds_search" columnid="insptFld"/>
    </Bind>
    <Objects>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">Y</Col>
            <Col id="insYn">N</Col>
            <Col id="delYn">N</Col>
            <Col id="savYn">N</Col>
            <Col id="prtYn">N</Col>
            <Col id="exlYn">N</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_cboNotFitClsfi" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboInsptFld" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="specmType" type="STRING" size="256"/>
          <Column id="mgrpCd" type="STRING" size="256"/>
          <Column id="mcalssCd" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="insptPurp" type="STRING" size="256"/>
          <Column id="edtSearch" type="STRING" size="256"/>
          <Column id="edtMclassSearch" type="STRING" size="256"/>
          <Column id="edtSearchSub" type="STRING" size="256"/>
          <Column id="isExcel" type="STRING" size="256"/>
          <Column id="insptFld" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_cboSpecmTypeCd" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_specmTypeArticleList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="specmType" type="STRING" size="255"/>
          <Column id="mgrpCd" type="STRING" size="255"/>
          <Column id="mgrpNm" type="STRING" size="256"/>
          <Column id="mcalssCd" type="STRING" size="255"/>
          <Column id="mcalssNm" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="255"/>
          <Column id="sclassNm" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_testArticleList01" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="mgrpCd" type="STRING" size="255"/>
          <Column id="mgrpNm" type="STRING" size="255"/>
          <Column id="mcalssCd" type="STRING" size="255"/>
          <Column id="mcalssNm" type="STRING" size="255"/>
          <Column id="sclassCd" type="STRING" size="255"/>
          <Column id="sclassNm" type="STRING" size="255"/>
          <Column id="articleCd" type="STRING" size="256"/>
          <Column id="articleNm" type="STRING" size="256"/>
          <Column id="legalBasis" type="STRING" size="255"/>
          <Column id="insideBasis" type="STRING" size="255"/>
          <Column id="insptFld" type="STRING" size="256"/>
          <Column id="takeTerm" type="STRING" size="256"/>
          <Column id="notFitClsfi" type="STRING" size="256"/>
          <Column id="basisStand" type="STRING" size="256"/>
          <Column id="comm1" type="STRING" size="256"/>
          <Column id="comm2" type="STRING" size="256"/>
          <Column id="comm3" type="STRING" size="256"/>
          <Column id="comm4" type="STRING" size="256"/>
          <Column id="comm5" type="STRING" size="256"/>
          <Column id="commCalc" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="255"/>
        </ColumnInfo>
        <Rows/>
      </Dataset>
      <Dataset id="ds_testArticleListValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_groupList_oncolumnchanged">
        <ColumnInfo>
          <Column id="articleCd" type="STRING" size="255"/>
          <Column id="basisStand" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="articleCd">title:시험항목코드,required:true</Col>
            <Col id="basisStand">title:기준규격,required:true,maxlengthB:400</Col>
            <Col id="remark">title:비고,maxlengthB:3000</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_testArticleList02" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="mgrpCd" type="STRING" size="255"/>
          <Column id="mgrpNm" type="STRING" size="255"/>
          <Column id="mcalssCd" type="STRING" size="255"/>
          <Column id="mcalssNm" type="STRING" size="255"/>
          <Column id="sclassCd" type="STRING" size="255"/>
          <Column id="sclassNm" type="STRING" size="255"/>
          <Column id="articleCd" type="STRING" size="256"/>
          <Column id="articleNm" type="STRING" size="256"/>
          <Column id="legalBasis" type="STRING" size="255"/>
          <Column id="insideBasis" type="STRING" size="255"/>
          <Column id="insptFld" type="STRING" size="256"/>
          <Column id="takeTerm" type="STRING" size="256"/>
          <Column id="notFitClsfi" type="STRING" size="256"/>
          <Column id="basisStand" type="STRING" size="256"/>
          <Column id="comm1" type="STRING" size="256"/>
          <Column id="comm2" type="STRING" size="256"/>
          <Column id="comm3" type="STRING" size="256"/>
          <Column id="comm4" type="STRING" size="256"/>
          <Column id="comm5" type="STRING" size="256"/>
          <Column id="commCalc" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="255"/>
        </ColumnInfo>
        <Rows/>
      </Dataset>
      <Dataset id="ds_testArticleList03" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="mgrpCd" type="STRING" size="255"/>
          <Column id="mgrpNm" type="STRING" size="255"/>
          <Column id="mcalssCd" type="STRING" size="255"/>
          <Column id="mcalssNm" type="STRING" size="255"/>
          <Column id="sclassCd" type="STRING" size="255"/>
          <Column id="sclassNm" type="STRING" size="255"/>
          <Column id="articleCd" type="STRING" size="256"/>
          <Column id="articleNm" type="STRING" size="256"/>
          <Column id="legalBasis" type="STRING" size="255"/>
          <Column id="insideBasis" type="STRING" size="255"/>
          <Column id="insptFld" type="STRING" size="256"/>
          <Column id="takeTerm" type="STRING" size="256"/>
          <Column id="notFitClsfi" type="STRING" size="256"/>
          <Column id="basisStand" type="STRING" size="256"/>
          <Column id="comm1" type="STRING" size="256"/>
          <Column id="comm2" type="STRING" size="256"/>
          <Column id="comm3" type="STRING" size="256"/>
          <Column id="comm4" type="STRING" size="256"/>
          <Column id="comm5" type="STRING" size="256"/>
          <Column id="commCalc" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="255"/>
        </ColumnInfo>
        <Rows/>
      </Dataset>
      <Dataset id="ds_testArticleList04" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="mgrpCd" type="STRING" size="255"/>
          <Column id="mgrpNm" type="STRING" size="255"/>
          <Column id="mcalssCd" type="STRING" size="255"/>
          <Column id="mcalssNm" type="STRING" size="255"/>
          <Column id="sclassCd" type="STRING" size="255"/>
          <Column id="sclassNm" type="STRING" size="255"/>
          <Column id="articleCd" type="STRING" size="256"/>
          <Column id="articleNm" type="STRING" size="256"/>
          <Column id="legalBasis" type="STRING" size="255"/>
          <Column id="insideBasis" type="STRING" size="255"/>
          <Column id="insptFld" type="STRING" size="256"/>
          <Column id="takeTerm" type="STRING" size="256"/>
          <Column id="notFitClsfi" type="STRING" size="256"/>
          <Column id="basisStand" type="STRING" size="256"/>
          <Column id="comm1" type="STRING" size="256"/>
          <Column id="comm2" type="STRING" size="256"/>
          <Column id="comm3" type="STRING" size="256"/>
          <Column id="comm4" type="STRING" size="256"/>
          <Column id="comm5" type="STRING" size="256"/>
          <Column id="commCalc" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="255"/>
        </ColumnInfo>
        <Rows/>
      </Dataset>
      <Dataset id="ds_testArticleListExcelValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_groupList_oncolumnchanged">
        <ColumnInfo>
          <Column id="mgrpCd" type="STRING" size="256"/>
          <Column id="mcalssCd" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="articleCd" type="STRING" size="255"/>
          <Column id="basisStand" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="articleCd">title:시험항목코드,required:true</Col>
            <Col id="basisStand">title:기준규격,required:true</Col>
            <Col id="mgrpCd">title:대분류코드,required:true</Col>
            <Col id="mcalssCd">title:중분류코드,required:true</Col>
            <Col id="sclassCd">title:소분류코드,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_insptPurp" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_insptFld" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_excelDtlList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="A" type="STRING" size="256"/>
          <Column id="B" type="STRING" size="256"/>
          <Column id="C" type="STRING" size="256"/>
          <Column id="D" type="STRING" size="256"/>
          <Column id="E" type="STRING" size="256"/>
          <Column id="F" type="STRING" size="256"/>
          <Column id="G" type="STRING" size="256"/>
          <Column id="H" type="STRING" size="256"/>
          <Column id="I" type="STRING" size="256"/>
          <Column id="J" type="STRING" size="256"/>
          <Column id="K" type="STRING" size="256"/>
          <Column id="L" type="STRING" size="256"/>
          <Column id="M" type="STRING" size="256"/>
          <Column id="N" type="STRING" size="256"/>
          <Column id="O" type="STRING" size="256"/>
          <Column id="P" type="STRING" size="256"/>
          <Column id="Q" type="STRING" size="256"/>
          <Column id="R" type="STRING" size="256"/>
          <Column id="S" type="STRING" size="256"/>
          <Column id="T" type="STRING" size="256"/>
          <Column id="U" type="STRING" size="256"/>
          <Column id="V" type="STRING" size="256"/>
          <Column id="W" type="STRING" size="256"/>
          <Column id="X" type="STRING" size="256"/>
          <Column id="Y" type="STRING" size="256"/>
          <Column id="Z" type="STRING" size="256"/>
          <Column id="AA" type="STRING" size="256"/>
          <Column id="AB" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_retval" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="procCnt" type="STRING" size="256"/>
          <Column id="notProcCnt" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_testMappingList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="mgrpNm" type="STRING" size="256"/>
          <Column id="mgrpCd" type="STRING" size="256"/>
          <Column id="mcalssCd" type="STRING" size="256"/>
          <Column id="mcalssNm" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="sclassNm" type="STRING" size="256"/>
          <Column id="articleCd" type="STRING" size="256"/>
          <Column id="articleNm" type="STRING" size="256"/>
          <Column id="useYn101" type="STRING" size="256"/>
          <Column id="legalBasis101" type="STRING" size="256"/>
          <Column id="insideBasis101" type="STRING" size="256"/>
          <Column id="basisStand101" type="STRING" size="256"/>
          <Column id="remark101" type="STRING" size="256"/>
          <Column id="useYn102" type="STRING" size="256"/>
          <Column id="legalBasis102" type="STRING" size="256"/>
          <Column id="insideBasis102" type="STRING" size="256"/>
          <Column id="basisStand102" type="STRING" size="256"/>
          <Column id="remark102" type="STRING" size="256"/>
          <Column id="useYn103" type="STRING" size="256"/>
          <Column id="legalBasis103" type="STRING" size="256"/>
          <Column id="insideBasis103" type="STRING" size="256"/>
          <Column id="basisStand103" type="STRING" size="256"/>
          <Column id="remark103" type="STRING" size="256"/>
          <Column id="useYn104" type="STRING" size="256"/>
          <Column id="legalBasis104" type="STRING" size="256"/>
          <Column id="insideBasis104" type="STRING" size="256"/>
          <Column id="basisStand104" type="STRING" size="256"/>
          <Column id="remark104" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : SpecmTypeTestArticleMappMgmt
  파 일 명 : SpecmTypeTestArticleMappMgmt.xfdl
  기    능 : 검체유형시험항목매핑관리

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.03.12   jshoon   최초 생성 
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/

include "lib::lib_com.xjs";
include "lib::LimsUtil.xjs";

/****************************************************************************************
 * FORM 변수 선언 영역
 ****************************************************************************************/
var fv_iProcessCnt = 0;  	// 저장건수를 저장한다.(Controller Class에서만 할당함.)
var pretab_index = 0;	// 이전 탭 index 저장
var tab_validate = 0;	// 탭에 invalidation 발생
var codeList = "SPECM_TYPE,INSPT_FLD,NOT_FIT_CLSFI,INSPT_PURP_2,INSPT_FLD";
var mappingDsList = "ds_cboSpecmTypeCd,ds_cboInsptFld,ds_cboNotFitClsfi,ds_insptPurp,ds_insptFld";

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{
    // Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
    gfn_formOnLoad(this);	// 검체유형 GRID에는 공통 이벤트 제외

    // 초기값 셋팅
    fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
    // 화면의 Combo 처리
//     SCCombo.bind(this, "ComCode", "ds_cboSpecmTypeCd", ds_cboSpecmTypeCd, {groupCode:"SPECM_TYPE", useYn:"Y"}, "fn_setComboSpecmTypeCallback");	// 공전유형
//     SCCombo.bind(this, "ComCode", "ds_cboInsptFld", ds_cboInsptFld, {groupCode:"INSPT_FLD", useYn:"Y"});	// 검사분야
//     SCCombo.bind(this, "ComCode", "ds_cboNotFitClsfi", ds_cboNotFitClsfi, {groupCode:"NOT_FIT_CLSFI", useYn:"Y"});	// 부적합분류
//     SCCombo.bind(this, "ComCode", "ds_insptPurp", ds_insptPurp, {groupCode:"INSPT_PURP_2", useYn:"Y"}, "fn_setInsptPurpCallback");	// 검사목적 2

	// 사용 코드를 한번에 가져와서 mappingDsList에 정의된 Dataset에 순차적으로 binding 시킨다.
	LimsUtil.selectCodeBatchList(this, null, codeList, null, null, mappingDsList);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 공통코드 binding 조회 후 callback function
 *---------------------------------------------------------------------------------------------*/
function fn_codeBatchCallback()
{
	cbo_specmTypeCd.index = 0;
    ds_search.setColumn(0, "specmType", cbo_specmTypeCd.value);
    
    var nRowCnt = ds_insptPurp.rowcount;
    if (nRowCnt > 4) nRowCnt = 4;	//Tab 4개 까지
    for (var i = 0; i < nRowCnt; i++)
    {
        eval("tab_testArticle.tpg_insptPurp"+(i+1)).text = ds_insptPurp.getColumn(i, "codeName");
    }

	ds_insptFld.insertRow(0);
	ds_insptFld.setColumn(0, "code", "");
	ds_insptFld.setColumn(0, "codeName", "전체");
	
	cbo_insptFld.index = 0;

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 공전유형코드 셋팅
 *---------------------------------------------------------------------------------------------*/
// function fn_setComboSpecmTypeCallback()
// {
//     cbo_specmTypeCd.index = 0;
//     ds_search.setColumn(0, "specmType", cbo_specmTypeCd.value);
// }

/*----------------------------------------------------------------------------------------------
 * 설명      : 검사목적 2 코드로 탭 Text 셋팅
 *---------------------------------------------------------------------------------------------*/
// function fn_setInsptPurpCallback()
// {
//     var nRowCnt = ds_insptPurp.rowcount;
//     if (nRowCnt > 4) nRowCnt = 4;	//Tab 4개 까지
//     for (var i = 0; i < nRowCnt; i++)
//     {
//         eval("tab_testArticle.tpg_insptPurp"+(i+1)).text = ds_insptPurp.getColumn(i, "codeName");
//     }
// }

/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
    fn_doSearch();	// 대분류코드 조회
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
    // 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
    if (nErrorCode < 0)
    {
        return;
    }

    switch(strSvcID)
    {
        // 검체유형 조회
        case "selectSpecmTypeList" :
            sta_specmTypeArticleCnt.text = "총건수 : " + gfn_numFormat(ds_specmTypeArticleList.rowcount) + "건";
            break;
        // 시험항목 조회
        case "selectList" :
            break;
        // 전체 저장
        case "saveList" :
            if (fv_iProcessCnt > 0) gfn_alert("msg.save.success");	// 저장 되었습니다.
            fn_doSearcSub();	// 탭 재 조회
            break;
        // 전체 삭제 저장
        case "saveDelAllList" :
            if (fv_iProcessCnt > 0) gfn_alert("msg.save.success");	// 저장 되었습니다.
            fn_doSearcSub();	// 탭 재 조회
            break;
        // 엑셀 저장
        case "saveExlList" :
            if (fv_iProcessCnt > 0) gfn_alert("msg.save.success");	// 저장 되었습니다.
            break;
        case "selectMappingList" :
            break;
     }
}

/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 검체유형 목록 조회 처리
 *---------------------------------------------------------------------------------------------*/
function fn_doSearch()
{
	// v_ds_check 미사용시 변경사항 체크
 	if (gfn_dsIsUpdated(ds_testArticleList01) ||
 	    gfn_dsIsUpdated(ds_testArticleList02) ||
 	    gfn_dsIsUpdated(ds_testArticleList03) ||
 	    gfn_dsIsUpdated(ds_testArticleList04))
 	{
		// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
 		var retValue = gfn_confirm("confirm.before.search");
 		if (retValue == false) return;
 	}
 	
     // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_specmTypeArticleList);

    //코드목록을 초기화한다.
     ds_specmTypeArticleList.clearData();

     ds_testArticleList01.clearData();
     ds_testArticleList02.clearData();
     ds_testArticleList03.clearData();
     ds_testArticleList04.clearData();

     ds_search.setColumn(0, "isExcel", '');
     ds_search.setColumn(0, "mgrpCd", "");
     ds_search.setColumn(0, "mcalssCd", "");
     ds_search.setColumn(0, "sclassCd", "");
     
    var strSvcID    = "selectSpecmTypeList";
    var strURL      = "ls/lcm/specmTypeArticleMgmt/selectList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_specmTypeArticleList=ds_specmTypeArticleList";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 시험항목 목록 조회 처리
 *---------------------------------------------------------------------------------------------*/
function btn_search_onclick(obj:Button,  e:ClickEventInfo)
{
    fn_doSearcSub();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 검체유형 목록 조회 처리
 *---------------------------------------------------------------------------------------------*/
function fn_doSearcSub()
{
    if (ds_specmTypeArticleList.rowposition == -1)
    {
        gfn_alert("검체유형을 먼저 조회하여 주십시오!.");
        return;
    }

     // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(tab_testArticle.tpg_insptPurp1.grd_testArticleList);
    gfn_clearSortMark(tab_testArticle.tpg_insptPurp2.grd_testArticleList);
    gfn_clearSortMark(tab_testArticle.tpg_insptPurp2.grd_testArticleList);
    gfn_clearSortMark(tab_testArticle.tpg_insptPurp4.grd_testArticleList);

    ds_testArticleList01.clearData();
    ds_testArticleList02.clearData();
    ds_testArticleList03.clearData();
    ds_testArticleList04.clearData();

    ds_search.setColumn(0, "mgrpCd", ds_specmTypeArticleList.getColumn(ds_specmTypeArticleList.rowposition, "mgrpCd"));
    ds_search.setColumn(0, "mcalssCd", ds_specmTypeArticleList.getColumn(ds_specmTypeArticleList.rowposition, "mcalssCd"));
    ds_search.setColumn(0, "sclassCd", ds_specmTypeArticleList.getColumn(ds_specmTypeArticleList.rowposition, "sclassCd"));

    ds_search.setColumn(0, "isExcel", '');

    var strSvcID    = "selectList";
    var strURL      = "ls/lcm/specmTypeTestArticleMappMgmt/selectList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_testArticleList01=ds_testArticleList01 ds_testArticleList02=ds_testArticleList02 ds_testArticleList03=ds_testArticleList03 ds_testArticleList04=ds_testArticleList04";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조회조건 엔터 클릭
 *---------------------------------------------------------------------------------------------*/
function edt_search_onkeydown(obj:Edit, e:KeyEventInfo)
{
    if (e.keycode == 13)
    {
        edt_search.updateToDataset();
        fn_doSearch();
    }
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조회조건 입력 시 리스트 Position Move 클릭
 *---------------------------------------------------------------------------------------------*/
function edt_search_ontextchanged(obj:Edit,  e:TextChangedEventInfo)
{
    LimsUtil.setFindDataPosition(ds_specmTypeArticleList, "sclassNm", edt_search.text);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 검체유형목록 클릭 시
 *---------------------------------------------------------------------------------------------*/
function grd_specmTypeArticleList_oncellclick(obj:Grid, e:GridClickEventInfo)
{
    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(tab_testArticle.tpg_insptPurp1.grd_testArticleList);
    gfn_clearSortMark(tab_testArticle.tpg_insptPurp2.grd_testArticleList);
    gfn_clearSortMark(tab_testArticle.tpg_insptPurp3.grd_testArticleList);
    gfn_clearSortMark(tab_testArticle.tpg_insptPurp4.grd_testArticleList);

    //코드목록을 초기화한다.
     ds_testArticleList01.clearData();
     ds_testArticleList02.clearData();
     ds_testArticleList03.clearData();
     ds_testArticleList04.clearData();

     ds_search.setColumn(0, "mgrpCd", ds_specmTypeArticleList.getColumn(ds_specmTypeArticleList.rowposition, "mgrpCd"));
     ds_search.setColumn(0, "mcalssCd", ds_specmTypeArticleList.getColumn(ds_specmTypeArticleList.rowposition, "mcalssCd"));
     ds_search.setColumn(0, "sclassCd", ds_specmTypeArticleList.getColumn(ds_specmTypeArticleList.rowposition, "sclassCd"));

    var strSvcID    = "selectList";
    var strURL      = "ls/lcm/specmTypeTestArticleMappMgmt/selectList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_testArticleList01=ds_testArticleList01 ds_testArticleList02=ds_testArticleList02 ds_testArticleList03=ds_testArticleList03 ds_testArticleList04=ds_testArticleList04";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 탭 저장버튼 클릭 시
 *---------------------------------------------------------------------------------------------*/
function btn_saveExcel_onclick(obj:Button,  e:ClickEventInfo)
{
    if (tab_testArticle.tabindex == -1)
    {
        gfn_alert("탭이 존재하지 않습니다.");
        return;
    }

    var objDs = "ds_testArticleList0" + (tab_testArticle.tabindex + 1);
    var strInsptPurp = ds_insptPurp.getColumn(tab_testArticle.tabindex, "code");

    if (!gfn_dsIsUpdated(eval(objDs)))
    {
        gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
        return;
    }
    
    if (gfn_validCheck(eval(objDs), ds_testArticleListValid) == false)	return;

    // 체크된 항목들만 상태값을 UPDATE로 변경하고 나머지는 NORMAL로 변경 한다.
    //eval(objDs).updatecontrol = false;
    for (var i = 0; i < eval(objDs).rowcount; i++)
    {
        if (eval(objDs).getColumn(i, "chk") == '1')
        {
            if (!fn_basisCheck(eval(objDs), i))
            {
                gfn_alert("법적기준 또는 내부기준을 선택하여 주십시오!");
                eval(objDs).rowposition = i;
                return;
            }
            if (!fn_basisDupCheck(eval(objDs), i))
            {
                gfn_alert("법적기준 또는 내부기준을 둘중 하나만 선택하여 주십시오!");
                eval(objDs).rowposition = i;
                return;
            }
            //eval(objDs).setRowType(i, Dataset.ROWTYPE_UPDATE);
        }
//         else
//         {
//             eval(objDs).setRowType(i, Dataset.ROWTYPE_NORMAL);
//         }
    }
    //eval(objDs).updatecontrol = true;
    
    // 자료를 저장 하시겠습니까?
	if (!gfn_confirm("confirm.before.save")) return false;

    ds_search.setColumn(0, "mgrpCd", ds_specmTypeArticleList.getColumn(ds_specmTypeArticleList.rowposition, "mgrpCd"));
    ds_search.setColumn(0, "mcalssCd", ds_specmTypeArticleList.getColumn(ds_specmTypeArticleList.rowposition, "mcalssCd"));
    ds_search.setColumn(0, "sclassCd", ds_specmTypeArticleList.getColumn(ds_specmTypeArticleList.rowposition, "sclassCd"));
    ds_search.setColumn(0, "insptPurp", strInsptPurp);

    var strSvcID    = "saveList";
    var strURL      = "ls/lcm/specmTypeTestArticleMappMgmt/saveList.xdo";
    var strInDs     = "ds_search=ds_search:A " + objDs + "=" + objDs + ":U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 탭 엑셀 저장버튼 클릭 시
 *---------------------------------------------------------------------------------------------*/
function btn_excelUploadSave_onclick(obj:Button,  e:ClickEventInfo)
{
    if (tab_testArticle.tabindex == -1)
    {
        gfn_alert("탭이 존재하지 않습니다.");
        return;
    }

    var objDs = "ds_testArticleList0" + (tab_testArticle.tabindex + 1);
    var strInsptPurp = ds_insptPurp.getColumn(tab_testArticle.tabindex, "code");

    if (!gfn_dsIsUpdated(eval(objDs)))
    {
        gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
        return;
    }

    if (gfn_validCheck(eval(objDs), ds_testArticleListExcelValid) == false)	return;

    // 체크된 항목들만 상태값을 UPDATE로 변경하고 나머지는 NORMAL로 변경 한다.
    eval(objDs).updatecontrol = false;
    for (var i = 0; i < eval(objDs).rowcount; i++)
    {
        if (eval(objDs).getColumn(i, "chk") == '1')
        {
            if (!fn_basisCheck(eval(objDs), i))
            {
                gfn_alert("법적기준 또는 내부기준을 선택하여 주십시오!");
                eval(objDs).rowposition = i;
                return;
            }
            if (!fn_basisDupCheck(eval(objDs), i))
            {
                gfn_alert("법적기준 또는 내부기준을 둘중 하나만 선택하여 주십시오!");
                eval(objDs).rowposition = i;
                return;
            }
            eval(objDs).setRowType(i, Dataset.ROWTYPE_UPDATE);
        }
        else
        {
            eval(objDs).setRowType(i, Dataset.ROWTYPE_NORMAL);
        }
    }
    eval(objDs).updatecontrol = true;

     ds_search.setColumn(0, "insptPurp", strInsptPurp);
     ds_search.setColumn(0, "isExcel", '1');	// 엑셀 저장 클릭 여부

    var strSvcID    = "saveList";
    var strURL      = "ls/lcm/specmTypeTestArticleMappMgmt/saveList.xdo";
    var strInDs     = "ds_search=ds_search:A " + objDs + "=" + objDs + ":U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 다른 탭 클릭 시 변경사항이 있으면 이전 탭으로 이동
 *---------------------------------------------------------------------------------------------*/
function tab_testArticle_onchanged(obj:Tab, e:TabIndexChangeEventInfo)
{
    if (tab_validate == 1)
    {
        tab_testArticle.tabindex = pretab_index;
    }
    else
    {
        tab_validate = 0;
    }
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 다른 탭 클릭 시 이전 탭 변경사항 체크
 *---------------------------------------------------------------------------------------------*/
function tab_testArticle_canchange(obj:Tab, e:TabIndexChangeEventInfo)
{
    if (tab_testArticle.tabindex == -1)
    {
        gfn_alert("탭이 존재하지 않습니다.");
        return;
    }

    var objDs = "ds_testArticleList0" + (tab_testArticle.tabindex + 1);

    if (gfn_dsIsUpdated(eval(objDs)))
    {
        gfn_alert("변경된 내역이 있습니다.\n저장 후 이동 하십시오!");
        pretab_index = tab_testArticle.tabindex;
        tab_validate = 1;
        return;
    }

    tab_validate = 0;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 법적기준, 내부기준 입력 체크
 *---------------------------------------------------------------------------------------------*/
function fn_basisCheck(objDs, nRowIdx)
{
    if ((gfn_isNull(objDs.getColumn(nRowIdx, "legalBasis")) && gfn_isNull(objDs.getColumn(nRowIdx, "insideBasis"))) ||
        (objDs.getColumn(nRowIdx, "legalBasis") == '0' && objDs.getColumn(nRowIdx, "insideBasis") == '0')
       ) return false;
    else return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 법적기준, 내부기준 중복 체크
 *---------------------------------------------------------------------------------------------*/
function fn_basisDupCheck(objDs, nRowIdx)
{
    if (objDs.getColumn(nRowIdx, "legalBasis") == '1' && objDs.getColumn(nRowIdx, "insideBasis") == '1') return false;
    else return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 시험항목 조회조건 클릭 시
 *---------------------------------------------------------------------------------------------*/
function edt_searchSub_onkeydown(obj:Edit, e:KeyEventInfo)
{
    if (e.keycode == 13)
    {
        edt_searchSub.updateToDataset();
        fn_doSearcSub();
    }
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 시험항목 조회조건 입력 시 리스트 Position Move 클릭
 *---------------------------------------------------------------------------------------------*/
function edt_searchSub_ontextchanged(obj:Edit,  e:TextChangedEventInfo)
{
    if (tab_testArticle.tabindex == -1)
    {
        gfn_alert("탭이 존재하지 않습니다.");
        return;
    }

    var objDs = "ds_testArticleList0" + (tab_testArticle.tabindex + 1);

    LimsUtil.setFindDataPosition(eval(objDs), "articleNm", edt_searchSub.text);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 전체삭제 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_delAll_onclick(obj:Button,  e:ClickEventInfo)
{
    if (tab_testArticle.tabindex == -1)
    {
        gfn_alert("탭이 존재하지 않습니다.");
        return;
    }

    var objDs = "ds_testArticleList0" + (tab_testArticle.tabindex + 1);
    var strInsptPurp = ds_insptPurp.getColumn(tab_testArticle.tabindex, "code");
    var strInsptPurpNm = ds_insptPurp.getColumn(tab_testArticle.tabindex, "codeName");

    var sMsg = "검체유형 시험항목매핑 [" + strInsptPurpNm + "] 전체를 삭제 하시겠습니까?";
    if (!gfn_confirm(sMsg, "", "C")) return;

    ds_search.setColumn(0, "mgrpCd", ds_specmTypeArticleList.getColumn(ds_specmTypeArticleList.rowposition, "mgrpCd"));
     ds_search.setColumn(0, "mcalssCd", ds_specmTypeArticleList.getColumn(ds_specmTypeArticleList.rowposition, "mcalssCd"));
     ds_search.setColumn(0, "sclassCd", ds_specmTypeArticleList.getColumn(ds_specmTypeArticleList.rowposition, "sclassCd"));
     ds_search.setColumn(0, "insptPurp", strInsptPurp);

    var strSvcID    = "saveDelAllList";
    var strURL      = "ls/lcm/specmTypeTestArticleMappMgmt/saveDelAllList.xdo";
    var strInDs     = "ds_search=ds_search:A " + objDs + "=" + objDs + ":U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 엑셀업로드 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_excelUpload_onclick(obj:Button,  e:ClickEventInfo)
{
    this.setWaitCursor(true, true);

    // 파일 선택
    var strFileName = gfn_excelFileDialog("LOAD", "EXCEL");

    if (strFileName.length == 0)
    {
        this.setWaitCursor(false, true);
        return;
    }

    var objDs = "ds_testArticleList01";
    if (tab_testArticle.tabindex == 0)
    {
        objDs = "ds_testArticleList01";
    }
    else if (tab_testArticle.tabindex == 1)
    {
        objDs = "ds_testArticleList02";
    }
    else if (tab_testArticle.tabindex == 2)
    {
        objDs = "ds_testArticleList03";
    }
    else if (tab_testArticle.tabindex == 3)
    {
        objDs = "ds_testArticleList04";
    }

    var rtn = gfn_importExcel(strFileName, objDs, 2, 1);

    this.setWaitCursor(false, true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 옆으로늘이기 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_wideLeft_onclick(obj:Button,  e:ClickEventInfo)
{
	gfn_objResize(this, 
	              tab_testArticle, 
				  btn_wideLeft, 
				  "옆으로늘이기",
				  "position.left", 
				  Static34.position.x + 10, 		// 늘이기 from
				  1, 								// 늘이기 to
				  1,								// 원래대로 from
				  Static34.position.x + 10);		// 원래대로 to
}

function cbo_insptFld_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	cbo_insptFld.updateToDataset();
	fn_doSearcSub();
}


function btn_ImprvexcelUpload_onclick(obj:Button,  e:ClickEventInfo)
{
	this.setWaitCursor(true, true);
	
	var strFileName = gfn_excelFileDialog("LOAD", "EXCEL");

	if (strFileName.length == 0)
	{
		this.setWaitCursor(false, true);
		return;
	}

	ds_excelDtlList.clearData();
	
 	var rtn = gfn_importExcel(strFileName, "ds_excelDtlList", 4, 1);	//4번째 라인부터 데이터 처리
 	
	this.setWaitCursor(false, true);
	
	if(ds_excelDtlList.getRowCount() > 0)
	{
		if (!gfn_confirm("confirm.before.save")) return false;

		var strSvcID    = "saveExlList";
		var strURL      = "ls/lcm/specmTypeTestArticleMappMgmt/saveExlList.xdo";
		var strInDs     = "ds_excelDtlList=ds_excelDtlList:A";
		var strOutDs    = "ds_retval=ds_retval";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;

		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}
}

function btn_ImprvexcelDown_onclick(obj:Button,  e:ClickEventInfo)
{
	this.setWaitCursor(true, true);

     // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(Grid_Mapping);

	ds_testMappingList.clearData();
	
	var strSvcID    = "selectMappingList";
	var strURL      = "ls/lcm/specmTypeTestArticleMappMgmt/selectMappingList.xdo";
    var strInDs     = "ds_search=ds_search:A";
	var strOutDs    = "ds_testMappingList=ds_testMappingList";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = false;

	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);

	this.setWaitCursor(false, true);
	
	//trace(ds_testMappingList.getRowCount()+"-"+ds_testMappingList.getColCount());
	//return;

    // 엑셀 다운로드
	gfn_exportExcel(Grid_Mapping);

}

function Grid_Mapping_onheadclick(obj:Grid, e:GridClickEventInfo)
{
    gfn_gridSort(obj, e);
}
]]></Script>
  </Form>
</FDL>

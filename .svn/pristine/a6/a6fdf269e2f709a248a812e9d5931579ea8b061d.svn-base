<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="FSC00310E" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="협력업체 평가결과 등록" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static12" class="sta_WFDA_Labelbg" position="absolute 650 206 1237 233" anchor="top right"/>
        <Static id="Static38" class="sta_WFDA_Labelbg" position="absolute 650 180 1237 207" anchor="top right"/>
        <Static id="Static37" class="sta_WFDA_Labelbg" position="absolute 650 232 1237 259" anchor="top right"/>
        <Combo id="cbo_specmType" taborder="37" innerdataset="@ds_specmType" codecolumn="CODE" datacolumn="VALUE" class="cmb_WF_Essential" position="absolute 653 235 715 256" anchor="top right" index="0" value="101" text="식품" onitemchanged="cbo_specmType_onitemchanged"/>
        <Static id="Static39" class="sta_WFDA_Labelbg" position="absolute 650 128 1237 155" anchor="top right"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="4" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static18" text="평가 정보" class="sta_WF_Title01" position="absolute 0 84 450 102" anchor="left top"/>
        <Static id="Static19" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 500 84"/>
        <Static id="Static20" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 97 500 102" anchor="left top"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static28" text="업체명" class="sta_WFSA_label" position="absolute 15 40 77 61" anchor="left top"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 93 40" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 93 71" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 60 40 70 61" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 294 40 324 61" anchor="left top"/>
        <Static id="Static00" text="기간" class="sta_WFSA_label" position="absolute 324 40 386 61" anchor="left top"/>
        <Static id="Static01" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 358 40 368 61" anchor="left top"/>
        <Grid id="grd_resultList" taborder="5" useinputpanel="false" position="absolute 0 102 555 259" anchor="left top right" binddataset="ds_resultList" oncelldblclick="grd_resultList_oncelldblclick" autoenter="none" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" cellsizingtype="col">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30"/>
                <Column size="90"/>
                <Column size="75"/>
                <Column size="175"/>
                <Column size="119"/>
                <Column size="81"/>
                <Column size="70"/>
                <Column size="65"/>
                <Column size="76"/>
                <Column size="85"/>
                <Column size="79"/>
              </Columns>
              <Rows>
                <Row size="32" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="평가일"/>
                <Cell col="2" text="구분"/>
                <Cell col="3" text="업체명"/>
                <Cell col="4" text="하위공장명"/>
                <Cell col="5" text="평가자"/>
                <Cell col="6" text="결과&#13;&#10;확정"/>
                <Cell col="7" text="개선&#13;&#10;확정"/>
                <Cell col="8" text="평가결재&#13;&#10;상태"/>
                <Cell col="9" text="개선결재&#13;&#10;상태"/>
                <Cell col="10" text="구매&#13;&#10;전송"/>
              </Band>
              <Band id="body">
                <Cell text="expr:rowidx+1"/>
                <Cell col="1" displaytype="date" text="bind:CHK_DD" calendardisplaynulltype="none"/>
                <Cell col="2" text="bind:CHK_CLASS_NM"/>
                <Cell col="3" displaytype="text" text="bind:CUSTNM"/>
                <Cell col="4" text="bind:SUB_COMP_NM"/>
                <Cell col="5" text="bind:INSPECTOR_NM"/>
                <Cell col="6" text="bind:CONFIRM_YN"/>
                <Cell col="7" text="bind:IMPROV_CONFIRM_YN"/>
                <Cell col="8" expr="expr:SIGN_PROGRESS_STATUS1==&quot;DRAFT&quot;?&quot;상신&quot;:(SIGN_PROGRESS_STATUS1==&quot;REJECT&quot;?&quot;반려&quot;:(SIGN_PROGRESS_STATUS1==&quot;COMPLETE&quot;?&quot;승인&quot;:(SIGN_PROGRESS_STATUS1==&quot;CANCEL&quot;?&quot;취소&quot;:&quot;&quot;)))"/>
                <Cell col="9" expr="expr:SIGN_PROGRESS_STATUS2==&quot;DRAFT&quot;?&quot;상신&quot;:(SIGN_PROGRESS_STATUS2==&quot;REJECT&quot;?&quot;반려&quot;:(SIGN_PROGRESS_STATUS2==&quot;COMPLETE&quot;?&quot;승인&quot;:(SIGN_PROGRESS_STATUS2==&quot;CANCEL&quot;?&quot;취소&quot;:&quot;&quot;)))"/>
                <Cell col="10" text="bind:PO_SEND_YN"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static40" class="sta_WFDA_Labelbg" position="absolute 650 154 1237 181" anchor="top right"/>
        <Static id="Static44" text="납품처" class="sta_WFDA_Label01" position="absolute 793 154 863 181" anchor="top right"/>
        <Static id="Static43" text="거래구분" class="sta_WFDA_Label01" position="absolute 793 128 863 155" anchor="top right"/>
        <Static id="Static41" text="경유센터" class="sta_WFDA_Label01" position="absolute 793 180 863 207" anchor="top right"/>
        <Static id="Static21" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 555 102 565 334"/>
        <Button id="btn_custSearch" taborder="1" class="btn_WF_popSearch" position="absolute 273 40 294 61" anchor="left top" onclick="btn_custSearch_onclick"/>
        <Edit id="edt_custNm" taborder="0" position="absolute 70 40 274 61" anchor="left top" readonly="true" enable="true" autoselect="true" onkeydown="edt_custNm_onkeydown"/>
        <Static id="Static02" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 594 40 624 61" anchor="left top"/>
        <Static id="Static47" text="8" class="Guide05_SizeBlack" visible="false" position="absolute 469 37 484 56"/>
        <Static id="Static85" text="~" class="sta_WF_Dash" position="absolute 477 40 493 61"/>
        <Static id="Static86" class="Guide01_AreaRed" visible="false" position="absolute 469 46 477 53"/>
        <Static id="Static87" class="Guide01_AreaRed" visible="false" position="absolute 485 46 493 53"/>
        <Static id="Static88" text="8" class="Guide05_SizeBlack" visible="false" position="absolute 486 37 501 56"/>
        <Static id="Static36" text="소속" class="sta_WFDA_Label01" position="absolute 565 154 651 181" anchor="top right"/>
        <Static id="Static35" text="평가일" class="sta_WFDA_Label01" position="absolute 565 128 651 155" anchor="top right"/>
        <Static id="Static33" text="평가자" class="sta_WFDA_Label01" position="absolute 565 180 651 207" anchor="top right"/>
        <Static id="Static49" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1074 71 1237 77" anchor="top right"/>
        <Combo id="cbo_chkClass" taborder="10" position="absolute 1088 131 1202 152" anchor="top right" innerdataset="@ds_cboChkClass" codecolumn="CODE" datacolumn="CODE_NAME" class="cmb_WF_Essential"/>
        <Calendar id="cal_chkDd" taborder="8" dateformat="yyyy-MM-dd" position="absolute 653 131 791 152" anchor="top right" value="null" class="cal_WF_Essential"/>
        <Static id="Static29" text="식품의 유형" class="sta_WFDA_Label01" position="absolute 565 232 651 259" anchor="top right"/>
        <Button id="btn_tmCd" taborder="12" position="absolute 770 157 791 178" anchor="top right" onclick="btn_tmCd_onclick" class="btn_WF_popSearch"/>
        <Button id="btn_inspector" taborder="14" class="btn_WF_popSearch" position="absolute 770 183 791 204" anchor="top right" onclick="btn_inspector_onclick"/>
        <Static id="Static30" text="평가구분" class="sta_WFDA_Label01" position="absolute 992 128 1086 155" anchor="top right"/>
        <Combo id="cbo_dealClass" taborder="9" position="absolute 865 131 990 152" anchor="top right" innerdataset="@ds_cboDealClass" codecolumn="CODE" datacolumn="CODE_NAME" class="cmb_WF_Essential"/>
        <Static id="Static10" text="유형구분" class="sta_WFDA_Label01" position="absolute 886 206 980 233" anchor="top right"/>
        <Combo id="cbo_foodTypeMgrp" taborder="15" innerdataset="@ds_cboFoodTypeMgrp" codecolumn="CODE" datacolumn="CODE_NAME" position="absolute 718 235 804 256" anchor="top right" class="cmb_WF_Essential" onitemchanged="cbo_foodTypeMgrp_onitemchanged"/>
        <Combo id="cbo_foodTypeMclass" taborder="16" innerdataset="@ds_cboFoodTypeMclass" codecolumn="CODE" datacolumn="CODE_NAME" position="absolute 806 235 898 256" anchor="top right" class="cmb_WF_Essential" onitemchanged="cbo_foodTypeMclass_onitemchanged"/>
        <Combo id="cbo_foodTypeSclass" taborder="17" innerdataset="@ds_cboFoodTypeSclass" codecolumn="CODE" datacolumn="CODE_NAME" position="absolute 901 235 1006 256" anchor="top right" class="cmb_WF_Essential"/>
        <Static id="Static34" text="하위공장명" class="sta_WFDA_Label01" position="absolute 1007 232 1080 259" anchor="top right"/>
        <Edit id="edt_sub_comp_nm" taborder="38" position="absolute 1081 234 1235 256" anchor="top right" text="" imemode="hangul" onkillfocus="edt_sub_comp_nm_onkillfocus"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Button id="btn_confirm" taborder="23" text="결과확정" class="btn_WF_Function" position="absolute 1172 77 1237 97" anchor="top right" onclick="btn_confirm_onclick"/>
        <Static id="Static25" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 1070 97 1229 102" anchor="top right"/>
        <Static id="Static13" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1170 77 1172 97" anchor="top right"/>
        <Button id="btn_inspectReq" taborder="24" text="식품검사의뢰" class="btn_WF_Function" position="absolute 1081 77 1170 97" anchor="top right" onclick="btn_inspectReq_onclick"/>
        <Div id="div_deliveryPlce" taborder="20" position="absolute 869 157 1233 177" style="background:#ffffffff;" anchor="top right"/>
        <Div id="div_passCenter" taborder="21" style="background:#ffffffff;" position="absolute 869 183 1233 203" anchor="top right"/>
        <Div id="div_foodTypeClass" taborder="22" style="background:#ffffffff;" position="absolute 986 209 1203 229" anchor="top right">
          <Layouts>
            <Layout/>
          </Layouts>
        </Div>
        <Edit id="edt_tmCd" taborder="11" position="absolute 653 157 771 178" anchor="top right" enable="true" readonly="true" class="edt_WF_Essential"/>
        <Edit id="edt_inspector" taborder="13" position="absolute 653 183 771 204" anchor="top right" enable="true" readonly="true" class="edt_WF_Essential"/>
        <Static id="Static14" class="sta_WFDA_Labelbg" position="absolute 650 102 1237 129" anchor="top right"/>
        <Static id="Static15" text="양식명" class="sta_WFDA_Label01" position="absolute 793 102 863 129" anchor="top right"/>
        <Static id="Static16" text="평가표구분" class="sta_WFDA_Label01" position="absolute 565 102 651 129" anchor="top right"/>
        <Combo id="cbo_formCd" taborder="7" innerdataset="@ds_cboFormCd" codecolumn="FORM_CD" datacolumn="FORM_NM" position="absolute 865 105 1202 126" anchor="top right" class="cmb_WF_Essential" onitemchanged="cbo_formCd_onitemchanged"/>
        <Combo id="cbo_tableType" taborder="6" innerdataset="@ds_cboTableType" codecolumn="CODE" datacolumn="CODE_NAME" position="absolute 653 105 791 126" anchor="top right" onitemchanged="cbo_tableType_onitemchanged" class="cmb_WF_Essential"/>
        <Static id="Static03" text="총평 및 특이사항" class="sta_WFDA_Label01" position="absolute 565 269 651 334" anchor="left top"/>
        <TextArea id="txt_remark" taborder="18" position="absolute 650 269 1237 334" anchor="left top right" oneditdblclick="txt_remark_oneditdblclick" value="1. 평가 결과 : 00.0점 (합격  / 거래가능)&#13;&#10;"/>
        <Static id="Static17" text="총점" class="sta_WFDA_Label01" position="absolute 0 269 80 334" anchor="left top"/>
        <Static id="Static22" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 259 1237 269" anchor="left top"/>
        <Static id="Static23" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 334 1237 344" anchor="left top"/>
        <Static id="Static24" text="위생 등급" class="sta_WFDA_Label01" position="absolute 184 269 264 334" anchor="left top"/>
        <Static id="Static26" text="평가 결과" class="sta_WFDA_Label01" position="absolute 369 269 449 334" anchor="left top"/>
        <TextArea id="txt_totScore" taborder="25" position="absolute 79 269 185 334" style="background:lavender;color:#444444ff;align:center middle;font:HY견고딕,20,antialias;" anchor="left top" readonly="true"/>
        <TextArea id="txt_grde" taborder="26" readonly="true" position="absolute 263 269 370 334" anchor="left top" style="background:lavender;align:center middle;font:HY견고딕,20,antialias;"/>
        <TextArea id="txt_chkResult" taborder="27" readonly="true" position="absolute 448 269 555 334" anchor="left top" style="background:lavender;align:center middle;font:굴림,18,bold;"/>
        <Static id="Static27" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 905 546 1226 556" anchor="left top"/>
        <Static id="Static31" text="평가시간" class="sta_WFDA_Label01" position="absolute 565 206 651 233" anchor="top right"/>
        <Calendar id="cal_chkStartTime" taborder="28" value="000000000" type="spin" dateformat="hh:mm tt" editformat="HH:mm" position="absolute 653 209 757 230" anchor="top right"/>
        <Calendar id="cal_chkEndTime" taborder="29" value="000000000" type="spin" dateformat="hh:mm tt" editformat="HH:mm" position="absolute 780 209 884 230" anchor="top right"/>
        <Static id="Static32" text="~" position="absolute 765 210 773 231" anchor="top right"/>
        <ObjCalendar id="cal_startDd" anchor="left top" titletext="캘린더" taborder="2" scrollbars="none" position="absolute 368 40 471 61"/>
        <ObjCalendar id="cal_endDd" anchor="left top" titletext="캘린더" taborder="3" scrollbars="none" position="absolute 491 40 594 61"/>
        <Button id="btn_sendResult" taborder="30" text="결과구매전송" class="btn_WF_Function" position="absolute 990 77 1079 97" anchor="top right" onclick="btn_sendResult_onclick"/>
        <Button id="btn_gwDraftCheck" taborder="31" text="평가결과상신" onclick="btn_gwDraftCheck_onclick" class="btn_WF_CRUD" position="absolute 461 0 563 25" anchor="top right"/>
        <Button id="btn_gwDetailCheck" taborder="32" text="평가결과상세" onclick="btn_gwDetailCheck_onclick" class="btn_WF_CRUD" position="absolute 565 0 659 25" anchor="top right"/>
        <Button id="btn_gwDraft" taborder="33" text="개선결과상신" onclick="btn_gwDraft_onclick" class="btn_WF_CRUD" position="absolute 661 0 755 25" anchor="top right"/>
        <Button id="btn_gwDetail" taborder="34" text="개선결과상세" onclick="btn_gwDetail_onclick" class="btn_WF_CRUD" position="absolute 757 0 851 25" anchor="top right"/>
        <Button id="btn_reject" taborder="36" text="개선반려" class="btn_WF_Function" position="absolute 923 77 988 97" anchor="top right" onclick="btn_reject_onclick"/>
        <Button id="btn_download" taborder="35" text="자료수신" class="btn_WF_Function" position="absolute 855 77 920 97" anchor="top right" onclick="btn_download_onclick"/>
        <Tab id="tab_resultList" anchor="all" taborder="19" tabindex="0" scrollbars="autoboth" position="absolute 0 344 1237 710" style="showextrabutton:false;background:white;" onchanged="tab_resultList_onchanged">
          <Tabpages>
            <Tabpage id="tabpage" text="평가항목" style="anchor:default;">
              <Layouts>
                <Layout width="1235" height="340">
                  <Grid id="grd_dtlList" taborder="13" binddataset="ds_resultDtlList" autoenter="select" useinputpanel="false" cellsizingtype="col" autofittype="none" position="absolute 10 31 894 328" anchor="all" ontextchange="tab_resultList_tabpage_grd_dtlList_ontextchange" oncellclick="tab_resultList_tabpage_grd_dtlList_oncellclick" scrollbars="autoboth" autofitbandtype="nohead" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="0"/>
                          <Column size="200"/>
                          <Column size="0"/>
                          <Column size="200"/>
                          <Column size="0"/>
                          <Column size="200"/>
                          <Column size="30"/>
                          <Column size="70"/>
                          <Column size="70"/>
                          <Column size="70"/>
                          <Column size="70"/>
                          <Column size="70"/>
                          <Column size="70"/>
                          <Column size="70"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" text="대분류코드"/>
                          <Cell col="2" text="대분류"/>
                          <Cell col="3" text="중분류코드"/>
                          <Cell col="4" text="중분류"/>
                          <Cell col="5" text="소분류코드"/>
                          <Cell col="6" text="소분류"/>
                          <Cell col="7" text="N/A"/>
                          <Cell col="8" text="중점"/>
                          <Cell col="9" text="지표"/>
                          <Cell col="10" text="점수"/>
                          <Cell col="11" text="결과"/>
                          <Cell col="12" text="평가"/>
                          <Cell col="13" text="개선"/>
                          <Cell col="14" text="사진"/>
                        </Band>
                        <Band id="body">
                          <Cell style="selectbackground: ;" text="expr:rowidx+1"/>
                          <Cell col="1" text="bind:HL_CLASS_CD"/>
                          <Cell col="2" displaytype="text" style="background2: ;" text="bind:HL_CLASS_NM" suppress="0"/>
                          <Cell col="3" text="bind:HM_CLASS_CD"/>
                          <Cell col="4" displaytype="text" style="background2: ;" text="bind:HM_CLASS_NM" suppress="0"/>
                          <Cell col="5" text="bind:CLASS_CD"/>
                          <Cell col="6" displaytype="text" text="bind:CLASS_NM"/>
                          <Cell col="7" displaytype="checkbox" edittype="checkbox" text="bind:NA_YN"/>
                          <Cell col="8" style="background:EXPR(FOCS_ARTICLE_YN == &quot;Y&quot; ? &quot;orange&quot; : &quot;&quot;);background2:EXPR(FOCS_ARTICLE_YN == &quot;Y&quot; ? &quot;orange&quot; : &quot;&quot;);selectbackground:EXPR(FOCS_ARTICLE_YN == &quot;Y&quot; ? &quot;orange&quot; : &quot;&quot;);" text="bind:FOCS_ARTICLE_YN"/>
                          <Cell col="9" displaytype="number" style="align:center;" text="expr:CHK_IDCTR"/>
                          <Cell col="10" displaytype="number" edittype="expr:NA_YN == 1 ? 'none' : 'normal'" style="align:center;background:EXPR(NA_YN == 0 ? '' : 'darkgray');background2:EXPR(NA_YN == 0 ? '' : 'darkgray');selectbackground:EXPR(NA_YN == 0 ? '' : 'darkgray');" text="bind:CHK_SCORE" editlimit="3" editautoselect="true"/>
                          <Cell col="11" displaytype="combo" edittype="none" style="background:EXPR(CHK_RESULT == &quot;2&quot; ? &quot;orange&quot; : &quot;&quot;);background2:EXPR(CHK_RESULT == &quot;2&quot; ? &quot;orange&quot; : &quot;&quot;);selectbackground:EXPR(CHK_RESULT == &quot;2&quot; ? &quot;orange&quot; : &quot;&quot;);" text="bind:CHK_RESULT" combodataset="ds_cboChkResult" combocodecol="CODE" combodatacol="CODE_NAME"/>
                          <Cell col="12" text="bind:CHK_CONTENTS_YN"/>
                          <Cell col="13" text="bind:IMPROV_CONTENTS_YN"/>
                          <Cell col="14" displaytype="normal" style="background:EXPR(iif(IMGE_CNT&gt;0,grd_list_BKimg('popup1'), grd_list_BKimg('camera1')));background2:EXPR(iif(IMGE_CNT&gt;0,grd_list_BKimg('popup2'), grd_list_BKimg('camera2')));selectbackground:EXPR(iif(IMGE_CNT&gt;0,grd_list_BKimg('selectpopup'), grd_list_BKimg('selectcamera')));"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static22" text="평가항목" class="sta_WF_Title01" position="absolute 10 13 460 31" anchor="left top"/>
                  <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 10 0 460 13" anchor="left top"/>
                  <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 26 948 31" anchor="left top"/>
                  <Static id="Static25" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 1071 26 1225 31" anchor="top right"/>
                  <Static id="Static26" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1071 0 1225 6" anchor="top right"/>
                  <Static id="Static00" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1158 6 1160 26" anchor="top right"/>
                  <Button id="btn_excelUpload" taborder="14" text="엑셀등록" class="btn_WF_Function" position="absolute 1160 6 1225 26" anchor="top right" onclick="tab_resultList_tabpage_btn_excelUpload_onclick"/>
                  <Button id="btn_fullScreen" taborder="16" text="전체화면" class="btn_WF_Function" position="absolute 1093 6 1158 26" anchor="top right" onclick="tab_resultList_tabpage_btn_fullScreen_onclick"/>
                  <Static id="Static07" visible="false" position="absolute 0 0 10 338" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static01" visible="false" position="absolute 1225 0 1235 338" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static03" visible="false" position="absolute 10 328 1225 338" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static06" text="개선 내용" class="sta_WF_Title01" position="absolute 904 184 1204 202" anchor="top right"/>
                  <Static id="Static08" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 904 197 1204 202" anchor="left top"/>
                  <TextArea id="TextArea00" taborder="20" position="absolute 904 202 1225 328" anchor="top right bottom" readonly="true"/>
                  <Static id="Static09" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 894 31 904 328"/>
                  <Static id="Static02" text="평가 내용" class="sta_WF_Title01" position="absolute 904 31 1204 49" anchor="top right"/>
                  <Static id="Static04" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 904 44 1204 49" anchor="left top"/>
                  <TextArea id="TextArea01" taborder="21" position="absolute 904 49 1225 175" anchor="top right"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage5" text="평가결과">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" taborder="2" binddataset="ds_resultSum" autoenter="select" useinputpanel="false" selecttype="row" cellsizingtype="col" autofittype="col" position="absolute 10 31 1225 328" anchor="all">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="21"/>
                          <Column size="140"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" text="구분"/>
                          <Cell col="2" text="가중치"/>
                          <Cell col="3" text="총점"/>
                          <Cell col="4" text="평가총점"/>
                          <Cell col="5" text="평가점수"/>
                          <Cell col="6" text="백분율"/>
                          <Cell col="7" text="반영점수"/>
                          <Cell col="8" text="부적합건수"/>
                          <Cell col="9" text="결과"/>
                        </Band>
                        <Band id="body">
                          <Cell text="expr:rowidx+1"/>
                          <Cell col="1" displaytype="text" style="background2: ;font:arial,9;" text="bind:CLASS_NM"/>
                          <Cell col="2" text="bind:WGT_RATE"/>
                          <Cell col="3" text="bind:CHK_IDCTR"/>
                          <Cell col="4" text="bind:CHK_IDCTR_NA"/>
                          <Cell col="5" displaytype="number" style="align:center;" text="bind:CHK_SCORE_NA"/>
                          <Cell col="6" displaytype="number" style="align:center;" text="bind:RATIO" mask="@@@.@"/>
                          <Cell col="7" displaytype="number" style="align:center;" text="bind:FINAL_SCORE" mask="@@@.@" maskchar="_"/>
                          <Cell col="8" displaytype="normal" text="bind:NOT_FIT_RESULT_CNT"/>
                          <Cell col="9" text="bind:NOT_FIT_RESULT"/>
                        </Band>
                        <Band id="summary">
                          <Cell colspan="2" style="align:center;" text="합계" taborder="undefined"/>
                          <Cell col="2" displaytype="number" text="expr:getSum('WGT_RATE')"/>
                          <Cell col="3" displaytype="number" text="expr:getSum('CHK_IDCTR')"/>
                          <Cell col="4" displaytype="number" text="expr:getSum('CHK_IDCTR_NA')"/>
                          <Cell col="5" displaytype="number" text="expr:getSum('CHK_SCORE_NA')"/>
                          <Cell col="6" displaytype="number" text="expr:fn_clearNaN(Math.round(getAvg('RATIO'), 1))" mask="@@@.@"/>
                          <Cell col="7" displaytype="number" text="expr:Math.round(getSum('FINAL_SCORE'), 1)" mask="@@@.@"/>
                          <Cell col="8" displaytype="number" text="expr:getSum('NOT_FIT_RESULT_CNT')"/>
                          <Cell col="9"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static22" text="평가결과" class="sta_WF_Title01" position="absolute 10 13 460 31" anchor="left top"/>
                  <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 10 0 460 13" anchor="left top"/>
                  <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 26 460 31" anchor="left top"/>
                  <Static id="Static25" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 1141 26 1225 31" anchor="top right"/>
                  <Static id="Static26" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1141 0 1225 6" anchor="top right"/>
                  <Static id="Static63" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1 554 11 709"/>
                  <Static id="Static64" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 11 699 1226 709"/>
                  <Static id="Static65" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1226 554 1236 709"/>
                  <Button id="btn_fullScreen" taborder="3" text="전체화면" onclick="tab_resultList_tabpage_btn_fullScreen_onclick" class="btn_WF_Function" position="absolute 1160 6 1225 26" anchor="top right"/>
                  <Static id="Static07" visible="false" position="absolute 0 0 10 338" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static01" visible="false" position="absolute 1225 0 1235 338" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static03" visible="false" position="absolute 10 328 1225 338" style="background:#ff000033;font:Dotum,8;"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage3" text="업체기타정보">
              <Layouts>
                <Layout>
                  <Static id="Static34" class="sta_WFDA_Labelbg" position="absolute 10 13 526 40" anchor="default"/>
                  <Static id="Static33" text="주요 납품품목" class="sta_WFDA_Label01" position="absolute 10 13 144 40" anchor="default"/>
                  <Edit id="edt_attr01" taborder="1" position="absolute 146 16 523 37" anchor="default"/>
                  <Static id="Static07" class="sta_WFDA_Labelbg" position="absolute 10 39 526 66" anchor="default"/>
                  <Static id="Static08" text="인증현황/인증일자" class="sta_WFDA_Label01" position="absolute 10 39 144 66" anchor="default"/>
                  <Edit id="edt_attr02" taborder="2" position="absolute 146 42 523 63" anchor="default"/>
                  <Static id="Static06" class="sta_WFDA_Labelbg" position="absolute 10 65 526 92" anchor="default"/>
                  <Static id="Static09" text="주요 납품처" class="sta_WFDA_Label01" position="absolute 10 65 144 92" anchor="default"/>
                  <Edit id="edt_attr03" taborder="3" position="absolute 146 68 523 89" anchor="default"/>
                  <Static id="Static10" class="sta_WFDA_Labelbg" position="absolute 10 91 526 118" anchor="default"/>
                  <Static id="Static11" text="영업의 종류" class="sta_WFDA_Label01" position="absolute 10 91 144 118" anchor="default"/>
                  <Edit id="edt_attr04" taborder="4" position="absolute 146 94 523 115" anchor="default"/>
                  <Static id="Static12" class="sta_WFDA_Labelbg" position="absolute 10 117 526 144" anchor="default"/>
                  <Static id="Static13" text="총 매출액(년)" class="sta_WFDA_Label01" position="absolute 10 117 144 144" anchor="default"/>
                  <Edit id="edt_attr05" taborder="5" position="absolute 146 120 523 141" anchor="default"/>
                  <Static id="Static14" class="sta_WFDA_Labelbg" position="absolute 10 143 526 170" anchor="default"/>
                  <Static id="Static16" text="매출점유율(%)" class="sta_WFDA_Label01" position="absolute 10 143 144 170" anchor="default"/>
                  <Edit id="edt_attr06" taborder="6" position="absolute 146 146 523 167" anchor="default"/>
                  <Static id="Static17" class="sta_WFDA_Labelbg" position="absolute 10 169 526 196" anchor="default"/>
                  <Static id="Static18" text="연락처/메일" class="sta_WFDA_Label01" position="absolute 10 169 144 196" anchor="default"/>
                  <Edit id="edt_attr07" taborder="7" position="absolute 146 172 523 193" anchor="default"/>
                  <Static id="Static19" class="sta_WFDA_Labelbg" position="absolute 10 195 526 222" anchor="default"/>
                  <Static id="Static21" text="소재지" class="sta_WFDA_Label01" position="absolute 10 195 144 222" anchor="default"/>
                  <Edit id="edt_attr08" taborder="8" position="absolute 146 198 523 219" anchor="default"/>
                  <Static id="Static22" class="sta_WFDA_Labelbg" position="absolute 10 221 526 248" anchor="default"/>
                  <Static id="Static23" text="사용용수" class="sta_WFDA_Label01" position="absolute 10 221 144 248" anchor="default"/>
                  <Edit id="edt_attr09" taborder="9" position="absolute 146 224 523 245" anchor="default"/>
                  <Static id="Static24" class="sta_WFDA_Labelbg" position="absolute 10 247 526 274" anchor="default"/>
                  <Static id="Static25" text="정수처리시설" class="sta_WFDA_Label01" position="absolute 10 247 144 274" anchor="default"/>
                  <Edit id="edt_attr10" taborder="10" position="absolute 146 250 523 271" anchor="default"/>
                  <Static id="Static26" class="sta_WFDA_Labelbg" position="absolute 10 273 526 300" anchor="default"/>
                  <Static id="Static27" text="담당MD" class="sta_WFDA_Label01" position="absolute 10 273 144 300" anchor="default"/>
                  <Edit id="edt_attr11" taborder="11" position="absolute 146 276 523 297" anchor="default"/>
                  <Static id="Static28" class="sta_WFDA_Labelbg" position="absolute 10 299 526 326" anchor="default"/>
                  <Static id="Static29" text="수검자" class="sta_WFDA_Label01" position="absolute 10 299 144 326" anchor="default"/>
                  <Edit id="edt_attr12" taborder="12" position="absolute 146 302 523 323" anchor="default"/>
                  <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 10 0 460 13" anchor="left top"/>
                  <Static id="Static00" visible="false" position="absolute 0 0 10 338" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static03" visible="false" position="absolute 10 328 1225 338" style="background:#ff000033;font:Dotum,8;"/>
                  <Static id="Static01" class="sta_WFDA_Labelbg" position="absolute 525 13 1041 40"/>
                  <Static id="Static42" text="금번평가비고" class="sta_WFDA_Label01" position="absolute 525 13 659 40"/>
                  <Edit id="edt_attr13" taborder="13" position="absolute 661 16 1038 37"/>
                  <Static id="Static45" class="sta_WFDA_Labelbg" position="absolute 525 39 1041 66"/>
                  <Static id="Static46" text="전기평가비고" class="sta_WFDA_Label01" position="absolute 525 39 659 66"/>
                  <Edit id="edt_attr14" taborder="14" position="absolute 661 42 1038 63"/>
                  <Button id="btn_Histget" taborder="3" text="최근정보" onclick="tab_resultList_tabpage_btn_Histget_onclick" class="btn_WF_Function" position="absolute 1160 6 1225 26" anchor="top right"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item9" compid="edt_tmCd" propid="value" datasetid="ds_resultMst" columnid="TM_NM"/>
      <BindItem id="item0" compid="edt_inspector" propid="value" datasetid="ds_resultMst" columnid="INSPECTOR_NM"/>
      <BindItem id="item1" compid="cbo_foodTypeMgrp" propid="value" datasetid="ds_resultMst" columnid="FOOD_TYPE_MGRP"/>
      <BindItem id="item20" compid="cbo_foodTypeMclass" propid="value" datasetid="ds_resultMst" columnid="FOOD_TYPE_MCALSS"/>
      <BindItem id="item21" compid="cbo_foodTypeSclass" propid="value" datasetid="ds_resultMst" columnid="FOOD_TYPE_SCLASS"/>
      <BindItem id="item22" compid="edt_custNm" propid="value" datasetid="ds_cond" columnid="CUSTNM"/>
      <BindItem id="item2" compid="cbo_tableType" propid="value" datasetid="ds_resultMst" columnid="TABLE_TYPE"/>
      <BindItem id="item3" compid="cbo_formCd" propid="value" datasetid="ds_resultMst" columnid="FORM_CD"/>
      <BindItem id="item4" compid="cal_chkDd" propid="value" datasetid="ds_resultMst" columnid="CHK_DD"/>
      <BindItem id="item5" compid="cbo_dealClass" propid="value" datasetid="ds_resultMst" columnid="DEAL_CLASS"/>
      <BindItem id="item6" compid="cbo_chkClass" propid="value" datasetid="ds_resultMst" columnid="CHK_CLASS"/>
      <BindItem id="item7" compid="txt_remark" propid="value" datasetid="ds_resultMst" columnid="REMARK"/>
      <BindItem id="item8" compid="txt_totScore" propid="value" datasetid="ds_resultMst" columnid="SCORE"/>
      <BindItem id="item10" compid="txt_grde" propid="value" datasetid="ds_resultMst" columnid="GRADE_CD"/>
      <BindItem id="item11" compid="txt_chkResult" propid="value" datasetid="ds_resultMst" columnid="CHK_RESULT_TXT"/>
      <BindItem id="item15" compid="tab_resultList.tabpage.TextArea00" propid="value" datasetid="ds_resultDtlList" columnid="IMPROV_MRMT_CONTENTS"/>
      <BindItem id="item12" compid="tab_resultList.tabpage.TextArea01" propid="value" datasetid="ds_resultDtlList" columnid="CHK_CONTENTS"/>
      <BindItem id="cal_CHECK_START_TIME_value" compid="cal_chkStartTime" propid="value" datasetid="ds_resultMst" columnid="CHK_START_TIME"/>
      <BindItem id="item13" compid="cal_chkEndTime" propid="value" datasetid="ds_resultMst" columnid="CHK_END_TIME"/>
      <BindItem id="item14" compid="tab_resultList.tabpage3.edt_attr01" propid="value" datasetid="ds_resultMst" columnid="ATTR01"/>
      <BindItem id="item16" compid="tab_resultList.tabpage3.edt_attr02" propid="value" datasetid="ds_resultMst" columnid="ATTR02"/>
      <BindItem id="item17" compid="tab_resultList.tabpage3.edt_attr03" propid="value" datasetid="ds_resultMst" columnid="ATTR03"/>
      <BindItem id="item18" compid="tab_resultList.tabpage3.edt_attr04" propid="value" datasetid="ds_resultMst" columnid="ATTR04"/>
      <BindItem id="item19" compid="tab_resultList.tabpage3.edt_attr05" propid="value" datasetid="ds_resultMst" columnid="ATTR05"/>
      <BindItem id="item23" compid="tab_resultList.tabpage3.edt_attr06" propid="value" datasetid="ds_resultMst" columnid="ATTR06"/>
      <BindItem id="item24" compid="tab_resultList.tabpage3.edt_attr07" propid="value" datasetid="ds_resultMst" columnid="ATTR07"/>
      <BindItem id="item25" compid="tab_resultList.tabpage3.edt_attr08" propid="value" datasetid="ds_resultMst" columnid="ATTR08"/>
      <BindItem id="item26" compid="tab_resultList.tabpage3.edt_attr09" propid="value" datasetid="ds_resultMst" columnid="ATTR09"/>
      <BindItem id="item27" compid="tab_resultList.tabpage3.edt_attr10" propid="value" datasetid="ds_resultMst" columnid="ATTR10"/>
      <BindItem id="item28" compid="tab_resultList.tabpage3.edt_attr11" propid="value" datasetid="ds_resultMst" columnid="ATTR11"/>
      <BindItem id="item29" compid="tab_resultList.tabpage3.edt_attr12" propid="value" datasetid="ds_resultMst" columnid="ATTR12"/>
      <BindItem id="item30" compid="tab_resultList.tabpage3.edt_attr13" propid="value" datasetid="ds_resultMst" columnid="ATTR13"/>
      <BindItem id="item31" compid="tab_resultList.tabpage3.edt_attr14" propid="value" datasetid="ds_resultMst" columnid="ATTR14"/>
      <BindItem id="item32" compid="cbo_specmType" propid="value" datasetid="ds_resultMst" columnid="SPECM_TYPE"/>
      <BindItem id="item33" compid="edt_dtrVendor" propid="value" datasetid="ds_specmArticleList" columnid="dtrVendor"/>
    </Bind>
    <Objects>
      <Dataset id="ds_resultDtlList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onvaluechanged="ds_resultDtlList_onvaluechanged">
        <ColumnInfo>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="CUSTCD" type="STRING" size="256"/>
          <Column id="CHK_DD" type="STRING" size="256"/>
          <Column id="CLASS_CD" type="STRING" size="256"/>
          <Column id="HL_CLASS_CD" type="STRING" size="256"/>
          <Column id="HL_CLASS_NM" type="STRING" size="256"/>
          <Column id="HM_CLASS_CD" type="STRING" size="256"/>
          <Column id="HM_CLASS_NM" type="STRING" size="256"/>
          <Column id="CLASS_NM" type="STRING" size="256"/>
          <Column id="CHK_IDCTR" type="INT" size="256"/>
          <Column id="NOT_FIT_SCORE" type="INT" size="256"/>
          <Column id="CHK_RESULT" type="STRING" size="256"/>
          <Column id="FOCS_ARTICLE_YN" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="CUSER" type="STRING" size="256"/>
          <Column id="CDATE" type="STRING" size="256"/>
          <Column id="UUSER" type="STRING" size="256"/>
          <Column id="UDATE" type="STRING" size="256"/>
          <Column id="CLASS_TYPE" type="STRING" size="256"/>
          <Column id="WGT_RATE" type="STRING" size="256"/>
          <Column id="NOT_FIT_CNT" type="STRING" size="256"/>
          <Column id="CHK_SCORE" type="STRING" size="256"/>
          <Column id="NA_YN" type="STRING" size="256"/>
          <Column id="CHK_CONTENTS" type="STRING" size="256"/>
          <Column id="CHK_CONTENTS_YN" type="STRING" size="256"/>
          <Column id="IMPROV_MRMT_DD" type="STRING" size="256"/>
          <Column id="IMPROV_MRMT_CONTENTS" type="STRING" size="256"/>
          <Column id="IMPROV_CONTENTS_YN" type="STRING" size="256"/>
          <Column id="IMGE_CNT" type="STRING" size="256"/>
          <Column id="SUB_COMP_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_resultSum" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CLASS_CD" type="STRING" size="256"/>
          <Column id="CLASS_NM" type="STRING" size="256"/>
          <Column id="WGT_RATE" type="STRING" size="256"/>
          <Column id="CHK_IDCTR" type="INT" size="256"/>
          <Column id="CHK_IDCTR_NA" type="INT" size="256"/>
          <Column id="CHK_SCORE_NA" type="INT" size="256"/>
          <Column id="RATIO" type="BIGDECIMAL" size="256"/>
          <Column id="FINAL_SCORE" type="BIGDECIMAL" size="256"/>
          <Column id="NOT_FIT_RESULT_CNT" type="INT" size="256"/>
          <Column id="NOT_FIT_RESULT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <FileDialog id="fdl_excel" filter="All(*.*)|*.*|" filterindex="0" defaultextention="false"/>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CUSTCD" type="STRING" size="256"/>
          <Column id="CUSTNM" type="STRING" size="256"/>
          <Column id="START_DD" type="STRING" size="256"/>
          <Column id="END_DD" type="STRING" size="256"/>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="CHK_DD" type="STRING" size="256"/>
          <Column id="SIGN_INSTANCE_ID1" type="STRING" size="256"/>
          <Column id="SIGN_INSTANCE_ID2" type="STRING" size="256"/>
          <Column id="DRAFT_GUBUN" type="STRING" size="256"/>
          <Column id="SUB_COMP_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_resultList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="FORM_NM" type="STRING" size="256"/>
          <Column id="CUSTCD" type="STRING" size="256"/>
          <Column id="CUSTNM" type="STRING" size="256"/>
          <Column id="CHK_DD" type="STRING" size="256"/>
          <Column id="DEAL_CLASS" type="STRING" size="256"/>
          <Column id="CHK_CLASS" type="STRING" size="256"/>
          <Column id="CHK_CLASS_NM" type="STRING" size="256"/>
          <Column id="TM_CD" type="STRING" size="256"/>
          <Column id="DELIVERY_PLCE" type="STRING" size="256"/>
          <Column id="INSPECTOR" type="STRING" size="256"/>
          <Column id="INSPECTOR_NM" type="STRING" size="256"/>
          <Column id="PASS_CENTER" type="STRING" size="256"/>
          <Column id="FOOD_TYPE_MGRP" type="STRING" size="256"/>
          <Column id="FOOD_TYPE_MCALSS" type="STRING" size="256"/>
          <Column id="FOOD_TYPE_SCLASS" type="STRING" size="256"/>
          <Column id="FOOD_TYPE_CLASS" type="STRING" size="256"/>
          <Column id="CHK_START_TIME" type="STRING" size="256"/>
          <Column id="CHK_END_TIME" type="STRING" size="256"/>
          <Column id="SCORE" type="STRING" size="256"/>
          <Column id="CONFIRM_YN" type="STRING" size="256"/>
          <Column id="IMPROV_CONFIRM_YN" type="STRING" size="256"/>
          <Column id="INSPT_REQ_YN" type="STRING" size="256"/>
          <Column id="INSPT_REQ_DD" type="STRING" size="256"/>
          <Column id="INSPT_REQ_NUM" type="STRING" size="256"/>
          <Column id="INSPT_REQ_RESULT" type="STRING" size="256"/>
          <Column id="REMARK" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="CUSER" type="STRING" size="256"/>
          <Column id="CDATE" type="STRING" size="256"/>
          <Column id="UUSER" type="STRING" size="256"/>
          <Column id="UDATE" type="STRING" size="256"/>
          <Column id="SIGN_INSTANCE_ID1" type="STRING" size="256"/>
          <Column id="SIGN_PROGRESS_STATUS1" type="STRING" size="256"/>
          <Column id="SIGN_INSTANCE_ID2" type="STRING" size="256"/>
          <Column id="SIGN_PROGRESS_STATUS2" type="STRING" size="256"/>
          <Column id="PO_SEND_YN" type="STRING" size="256"/>
          <Column id="SUB_COMP_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboChkClass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboDealClass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_resultMst" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_resultMst_oncolumnchanged">
        <ColumnInfo>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="FORM_NM" type="STRING" size="256"/>
          <Column id="CUSTCD" type="STRING" size="256"/>
          <Column id="CHK_DD" type="STRING" size="256"/>
          <Column id="DEAL_CLASS" type="STRING" size="256"/>
          <Column id="CHK_CLASS" type="STRING" size="256"/>
          <Column id="TM_CD" type="STRING" size="256"/>
          <Column id="TM_NM" type="STRING" size="256"/>
          <Column id="DELIVERY_PLCE" type="STRING" size="256"/>
          <Column id="INSPECTOR" type="STRING" size="256"/>
          <Column id="INSPECTOR_NM" type="STRING" size="256"/>
          <Column id="PASS_CENTER" type="STRING" size="256"/>
          <Column id="FOOD_TYPE_MGRP" type="STRING" size="256"/>
          <Column id="FOOD_TYPE_MCALSS" type="STRING" size="256"/>
          <Column id="FOOD_TYPE_SCLASS" type="STRING" size="256"/>
          <Column id="FOOD_TYPE_CLASS" type="STRING" size="256"/>
          <Column id="CHK_START_TIME" type="STRING" size="256"/>
          <Column id="CHK_END_TIME" type="STRING" size="256"/>
          <Column id="SCORE" type="STRING" size="256"/>
          <Column id="GRADE_CD" type="STRING" size="256"/>
          <Column id="CHK_RESULT" type="STRING" size="256"/>
          <Column id="CHK_RESULT_TXT" type="STRING" size="256"/>
          <Column id="CONFIRM_YN" type="STRING" size="256"/>
          <Column id="IMPROV_CONFIRM_YN" type="STRING" size="256"/>
          <Column id="IMPROV_MRMT_YN" type="STRING" size="256"/>
          <Column id="IMPROV_MRMT_DD" type="STRING" size="256"/>
          <Column id="INSPT_REQ_YN" type="STRING" size="256"/>
          <Column id="INSPT_REQ_DD" type="STRING" size="256"/>
          <Column id="INSPT_REQ_NUM" type="STRING" size="256"/>
          <Column id="INSPT_REQ_RESULT" type="STRING" size="256"/>
          <Column id="REMARK" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="CUSER" type="STRING" size="256"/>
          <Column id="CDATE" type="STRING" size="256"/>
          <Column id="UUSER" type="STRING" size="256"/>
          <Column id="UDATE" type="STRING" size="256"/>
          <Column id="ATTR01" type="STRING" size="256"/>
          <Column id="ATTR02" type="STRING" size="256"/>
          <Column id="ATTR03" type="STRING" size="256"/>
          <Column id="ATTR04" type="STRING" size="256"/>
          <Column id="ATTR05" type="STRING" size="256"/>
          <Column id="ATTR06" type="STRING" size="256"/>
          <Column id="ATTR07" type="STRING" size="256"/>
          <Column id="ATTR08" type="STRING" size="256"/>
          <Column id="ATTR09" type="STRING" size="256"/>
          <Column id="ATTR10" type="STRING" size="256"/>
          <Column id="ATTR11" type="STRING" size="256"/>
          <Column id="ATTR12" type="STRING" size="256"/>
          <Column id="ATTR13" type="STRING" size="256"/>
          <Column id="ATTR14" type="STRING" size="256"/>
          <Column id="SPECM_TYPE" type="STRING" size="256"/>
          <Column id="SUB_COMP_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboTableType">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboFormCd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="FORM_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboChkResult" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_formDtlList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onvaluechanged="ds_resultDtlList_onvaluechanged">
        <ColumnInfo>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="CLASS_CD" type="STRING" size="256"/>
          <Column id="HL_CLASS_CD" type="STRING" size="256"/>
          <Column id="HL_CLASS_NM" type="STRING" size="256"/>
          <Column id="HM_CLASS_CD" type="STRING" size="256"/>
          <Column id="HM_CLASS_NM" type="STRING" size="256"/>
          <Column id="CLASS_NM" type="STRING" size="256"/>
          <Column id="CHK_IDCTR" type="INT" size="256"/>
          <Column id="NOT_FIT_SCORE" type="INT" size="256"/>
          <Column id="CHK_RESULT" type="STRING" size="256"/>
          <Column id="FOCS_ARTICLE_YN" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="CUSER" type="STRING" size="256"/>
          <Column id="CDATE" type="STRING" size="256"/>
          <Column id="UUSER" type="STRING" size="256"/>
          <Column id="UDATE" type="STRING" size="256"/>
          <Column id="CLASS_TYPE" type="STRING" size="256"/>
          <Column id="WGT_RATE" type="STRING" size="256"/>
          <Column id="NOT_FIT_CNT" type="STRING" size="256"/>
          <Column id="CHK_SCORE" type="STRING" size="256"/>
          <Column id="NA_YN" type="STRING" size="256"/>
          <Column id="CHK_CONTENTS" type="STRING" size="256"/>
          <Column id="IMPROV_MRMT_DD" type="STRING" size="256"/>
          <Column id="IMPROV_MRMT_CONTENTS" type="STRING" size="256"/>
          <Column id="IMGE_CNT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_excelDtlList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="A" type="STRING" size="256"/>
          <Column id="B" type="STRING" size="256"/>
          <Column id="C" type="STRING" size="256"/>
          <Column id="D" type="STRING" size="256"/>
          <Column id="E" type="STRING" size="256"/>
          <Column id="F" type="STRING" size="256"/>
          <Column id="G" type="STRING" size="256"/>
          <Column id="H" type="STRING" size="256"/>
          <Column id="I" type="STRING" size="256"/>
          <Column id="J" type="STRING" size="256"/>
          <Column id="K" type="STRING" size="256"/>
          <Column id="L" type="STRING" size="256"/>
          <Column id="M" type="STRING" size="256"/>
          <Column id="N" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_resultMstValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_resultMst_oncolumnchanged">
        <ColumnInfo>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="FORM_NM" type="STRING" size="256"/>
          <Column id="CUSTCD" type="STRING" size="256"/>
          <Column id="CHK_DD" type="STRING" size="256"/>
          <Column id="DEAL_CLASS" type="STRING" size="256"/>
          <Column id="CHK_CLASS" type="STRING" size="256"/>
          <Column id="TM_CD" type="STRING" size="256"/>
          <Column id="TM_NM" type="STRING" size="256"/>
          <Column id="DELIVERY_PLCE" type="STRING" size="256"/>
          <Column id="INSPECTOR" type="STRING" size="256"/>
          <Column id="INSPECTOR_NM" type="STRING" size="256"/>
          <Column id="PASS_CENTER" type="STRING" size="256"/>
          <Column id="FOOD_TYPE_MGRP" type="STRING" size="256"/>
          <Column id="FOOD_TYPE_MCALSS" type="STRING" size="256"/>
          <Column id="FOOD_TYPE_SCLASS" type="STRING" size="256"/>
          <Column id="FOOD_TYPE_CLASS" type="STRING" size="256"/>
          <Column id="CHK_START_TIME" type="STRING" size="256"/>
          <Column id="CHK_END_TIME" type="STRING" size="256"/>
          <Column id="SCORE" type="STRING" size="256"/>
          <Column id="GRADE_CD" type="STRING" size="256"/>
          <Column id="CHK_RESULT" type="STRING" size="256"/>
          <Column id="CHK_RESULT_TXT" type="STRING" size="256"/>
          <Column id="CONFIRM_YN" type="STRING" size="256"/>
          <Column id="IMPROV_MRMT_YN" type="STRING" size="256"/>
          <Column id="IMPROV_MRMT_DD" type="STRING" size="256"/>
          <Column id="INSPT_REQ_YN" type="STRING" size="256"/>
          <Column id="INSPT_REQ_DD" type="STRING" size="256"/>
          <Column id="INSPT_REQ_NUM" type="STRING" size="256"/>
          <Column id="INSPT_REQ_RESULT" type="STRING" size="256"/>
          <Column id="REMARK" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="CUSER" type="STRING" size="256"/>
          <Column id="CDATE" type="STRING" size="256"/>
          <Column id="UUSER" type="STRING" size="256"/>
          <Column id="UDATE" type="STRING" size="256"/>
          <Column id="Column0" type="STRING" size="256"/>
          <Column id="Column1" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="TABLE_TYPE">title:평가표구분,required:true</Col>
            <Col id="FORM_CD">title:양식명,required:true</Col>
            <Col id="CUSTCD">title:업체명,required:true</Col>
            <Col id="CHK_DD">title:평가일,required:true</Col>
            <Col id="DEAL_CLASS">title:거래구분,required:true</Col>
            <Col id="CHK_CLASS">title:평가구분,required:true</Col>
            <Col id="TM_CD">title:소속,required:true</Col>
            <Col id="INSPECTOR">title:평가자,required:true</Col>
            <Col id="FOOD_TYPE_MGRP">title:식품의유형-대분류,required:true</Col>
            <Col id="FOOD_TYPE_MCALSS">title:식품의유형-중분류,required:true</Col>
            <Col id="FOOD_TYPE_SCLASS">title:식품의유형-소분류,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_improvDtlList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onvaluechanged="ds_resultDtlList_onvaluechanged">
        <ColumnInfo>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="CLASS_CD" type="STRING" size="256"/>
          <Column id="HL_CLASS_CD" type="STRING" size="256"/>
          <Column id="HL_CLASS_NM" type="STRING" size="256"/>
          <Column id="HM_CLASS_CD" type="STRING" size="256"/>
          <Column id="HM_CLASS_NM" type="STRING" size="256"/>
          <Column id="CLASS_NM" type="STRING" size="256"/>
          <Column id="CHK_IDCTR" type="INT" size="256"/>
          <Column id="NOT_FIT_SCORE" type="INT" size="256"/>
          <Column id="CHK_RESULT" type="STRING" size="256"/>
          <Column id="FOCS_ARTICLE_YN" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="CUSER" type="STRING" size="256"/>
          <Column id="CDATE" type="STRING" size="256"/>
          <Column id="UUSER" type="STRING" size="256"/>
          <Column id="UDATE" type="STRING" size="256"/>
          <Column id="CLASS_TYPE" type="STRING" size="256"/>
          <Column id="WGT_RATE" type="STRING" size="256"/>
          <Column id="NOT_FIT_CNT" type="STRING" size="256"/>
          <Column id="CHK_SCORE" type="STRING" size="256"/>
          <Column id="NA_YN" type="STRING" size="256"/>
          <Column id="CHK_CONTENTS" type="STRING" size="256"/>
          <Column id="IMPROV_MRMT_DD" type="STRING" size="256"/>
          <Column id="IMPROV_MRMT_CONTENTS" type="STRING" size="256"/>
          <Column id="IMGE_CNT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboFoodTypeMclass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
          <Column id="MGRP_CD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboFoodTypeMgrp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboFoodTypeSclass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_condValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CUSTCD" type="STRING" size="256"/>
          <Column id="CUSTNM" type="STRING" size="256"/>
          <Column id="START_DD" type="STRING" size="256"/>
          <Column id="END_DD" type="STRING" size="256"/>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="CHK_DD" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="START_DD">title:시작일,required:true</Col>
            <Col id="END_DD">title:종료일,comparemax:START_DD:시작일</Col>
            <Col id="CUSTCD"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_specmType" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="VALUE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">101</Col>
            <Col id="VALUE">식품</Col>
          </Row>
          <Row>
            <Col id="CODE">102</Col>
            <Col id="VALUE">축산</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_visible">
        <ColumnInfo>
          <Column id="CODE" size="10" type="STRING"/>
          <Column id="NAME" size="100" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">Y</Col>
            <Col id="NAME">예</Col>
          </Row>
          <Row>
            <Col id="CODE">N</Col>
            <Col id="NAME">아니오</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_custHist" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_resultMst_oncolumnchanged">
        <ColumnInfo>
          <Column id="ATTR01" type="STRING" size="256"/>
          <Column id="ATTR02" type="STRING" size="256"/>
          <Column id="ATTR03" type="STRING" size="256"/>
          <Column id="ATTR04" type="STRING" size="256"/>
          <Column id="ATTR05" type="STRING" size="256"/>
          <Column id="ATTR06" type="STRING" size="256"/>
          <Column id="ATTR07" type="STRING" size="256"/>
          <Column id="ATTR08" type="STRING" size="256"/>
          <Column id="ATTR09" type="STRING" size="256"/>
          <Column id="ATTR10" type="STRING" size="256"/>
          <Column id="ATTR11" type="STRING" size="256"/>
          <Column id="ATTR12" type="STRING" size="256"/>
          <Column id="ATTR13" type="STRING" size="256"/>
          <Column id="ATTR14" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <InitValue/>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
include "lib::LimsUtil.xjs";

/******************************************************************************************
 * 시스템구분 : 위생관리/협력업체위생관리
 * 프로그램명 : FSC00310E.xfdl
 * 기ㅡㅡㅡ능 : 협력업체점검결과등록
 * 작ㅡ성ㅡ자 : 김민수f
 * 작성ㅡ일자 : 2015-03-23
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 * 2018.05.24 김명섭 자료수신(엑셀) 저장 기능 추가
 ******************************************************************************************/
 
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var fstrQuery = "SELECT FORM_CD, FORM_NM, TABLE_TYPE FROM FSC_CONTRT_FORM WHERE USE_YN = 'Y' AND TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN START_DD AND NVL(END_DD,'99999999') ORDER BY FORM_CD DESC";
var mgrpQuery = "SELECT MGRP_CD AS CODE, MGRP_NM AS CODE_NAME FROM LCM_SPECM_TYPE_MGRP WHERE USE_YN = 'Y'";
var mclassQuery = "SELECT MCALSS_CD AS CODE, MCALSS_NM AS CODE_NAME, MGRP_CD FROM LCM_SPECM_TYPE_MCALSS WHERE USE_YN = 'Y'";
var sclassQuery = "SELECT SCLASS_CD AS CODE, SCLASS_NM AS CODE_NAME, MGRP_CD, MCALSS_CD FROM LCM_SPECM_TYPE_SCLASS WHERE USE_YN = 'Y'";

var fv_attachList;	//상신 첨부 파일 목록 (json)
var fv_RefSeq;
var fv_option = {buttons:[{id:"btn_gwDraft", action:"draft"}, {id:"btn_gwDetail", action:"detail"}]}; //개선결과 결재 관련 버튼 정의
var fv_optionCheck = {buttons:[{id:"btn_gwDraftCheck", action:"draft"}, {id:"btn_gwDetailCheck", action:"detail"}]}; //점검결과 결재 관련 버튼 정의
var fv_retVal;
var strDraftGubun = '1'	// 1:점검결과, 2:개선결과
var iOffsetX = 192;
var fMode;
var strLoadPath = "";

//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(this);

	// X-Framework : Action 정보 생성
	fsp_init(this);
	
	// 초기화
	fn_init();
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_init()
 * 기ㅡㅡㅡ능 : 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function fn_init() 
{
	//그룹웨어 연동 초기화
    SCGw.init (this);
    
    btn_gwDraft.enable = false;
	btn_gwDetail.enable = false;
	btn_gwDraftCheck.enable = false;
	btn_gwDetailCheck.enable = false;
    
	// 조회조건 DataSet 초기화
	ds_cond.clearData();
	ds_cond.addRow();

	//공통코드조회
	var objCode = fn_common_code("'FS0102','FS0104','FS0106','FS0117','FS0117_2'","","","non","Y");

	// 점검표구분
	var sCond = "GROUP_CODE == 'FS0102' && CODE != null";
	objCode.filter(sCond);
	CopyF(ds_cboTableType, objCode.name);
	
	// 협력업체 거래구분
	sCond = "GROUP_CODE == 'FS0104'";
	objCode.filter(sCond);
	CopyF(ds_cboDealClass, objCode.name);

	// 협력업체 점검구분
	sCond = "GROUP_CODE == 'FS0106'";
	objCode.filter(sCond);
	CopyF(ds_cboChkClass, objCode.name);

	// 점검결과
	sCond = "GROUP_CODE == 'FS0117_2'";
	objCode.filter(sCond);
	CopyF(ds_cboChkResult, objCode.name);
	ds_cboChkResult.addRow();
	ds_cboChkResult.setColumn("CODE", "");
	ds_cboChkResult.setColumn("CODE_NAME", "");

	// 식품의유형
	fn_sql_common("C", mgrpQuery + "AND SPECM_TYPE = '101'", "", "", "non", cbo_foodTypeMgrp, -1, ds_cboFoodTypeMgrp);	// 대분류
 	fn_sql_common("C", mclassQuery + "AND SPECM_TYPE = '101'", "", "", "non", cbo_foodTypeMclass, -1, ds_cboFoodTypeMclass);	// 중분류
 	fn_sql_common("C", sclassQuery + "AND SPECM_TYPE = '101'", "", "", "non", cbo_foodTypeSclass, -1, ds_cboFoodTypeSclass);	// 소분류
	
	//공통코드조회
	SCCheckbox.bind(this, 'ComCode', 'div_deliveryPlce', {groupCode:"FS0115", useYn:"Y"}, {appearance:{usingDb:true}, append:{appendText:'전체'}});
	SCCheckbox.bind(this, 'ComCode', 'div_passCenter', {groupCode:"FS0116", useYn:"Y"}, {appearance:{usingDb:true}, append:{appendText:'전체'}});
	SCCheckbox.bind(this, 'ComCode', 'div_foodTypeClass', {groupCode:"PICK_STATUS", useYn:"Y"}, {appearance:{usingDb:true}});

	// 양식조회
	fn_sql_common("C", fstrQuery, "", "", "non", cbo_formCd, -1, ds_cboFormCd);
	
	// 조회기간 초기화
	cal_startDd.fn_initMonthCal(this, gfn_today().substr(0, 6) + '01', "", ds_cond, "START_DD", "Y");
	cal_endDd.fn_initMonthCal(this, gfn_today(), "", ds_cond, "END_DD", "Y");
	
	// 조회 모드로 전환
	fn_changeUpdateMode("S");
}

//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,출력)
//
//=========================================================================================
/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_search()
 * 기ㅡㅡㅡ능 : 점검정보 목록조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function fn_search() 
{
	// 유효성 검사
	if (gfn_validCheck(ds_cond, ds_condValid, true) == false) return;

	var strMsg = "변경된 내역이 있습니다. 저장하시겠습니까?";

	// 변경 데이터 체크
	if(gfn_dsIsUpdated(ds_resultDtlList) || gfn_dsIsUpdated(ds_resultMst))
	{
		if (g_Confirm("02",strMsg))
		{
			fn_save();
			return;
		}
	}	
	
	fsp_clear(this);
	
	btn_gwDraft.enable = false;
	btn_gwDetail.enable = false;
	btn_gwDraftCheck.enable = false;
	btn_gwDetailCheck.enable = false;
	
	// 조회조건 초기화
	ds_cond.setColumn(0, "CHK_DD", "");
	ds_cond.setColumn(0, "TABLE_TYPE", "");
	ds_cond.setColumn(0, "FORM_CD", "");
	ds_cond.setColumn(0, "SUB_COMP_NM", "");
	
	// 점검결과목록 초기화
	ds_resultList.clearData();
	ds_resultMst.clearData();
	ds_resultDtlList.clearData();
	ds_resultSum.clearData();
	
	// 체크박스 초기화
 	SCCheckbox.setValue("div_deliveryPlce", "");
 	SCCheckbox.setValue("div_passCenter", "");
 	SCCheckbox.setValue("div_foodTypeClass", "");
 	
 	edt_sub_comp_nm.value = "";

	fsp_addSearch(this,"fs/fsc:FSC00310E_S001");
	fsp_callService(this,"","","ds_cond=ds_cond","ds_resultList=ds_list","","fn_callBackSearch");
}

function fn_callBackSearch(errCode, errMsg) 
{
	if( errCode != 0 ) {
		g_Message("EE", errMsg);
		return;
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_insert()
 * 기ㅡㅡㅡ능 : 점검결과 입력
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function fn_insert() 
{
	if (gfn_isNull(ds_cond.getColumn(0, "CUSTCD")))
	{
		g_Message("EE", "업체를 선택해주세요.");
		return;
	}

	// 데이터셋 초기화
	ds_resultList.clearData();
	ds_resultMst.clearData();
	ds_resultDtlList.clearData();
	ds_resultSum.clearData();

	ds_resultMst.addRow();
	// 협력업체 코드 세팅
	ds_resultMst.setColumn(0, "CUSTCD", ds_cond.getColumn(0, "CUSTCD"));
	ds_resultMst.setColumn(0, "USE_YN", "Y");
	var strBasisRemark;
	strBasisRemark = "1. 평가 결과 : 00.0점 (합격  / 거래가능)\n";
	strBasisRemark += "\n";
	strBasisRemark += "2. 개선 요청사항\n";
	strBasisRemark += "  1) 법규항목\n";
	strBasisRemark += "    -\n";
	strBasisRemark += "  2) 중점항목\n";
	strBasisRemark += "    -\n";
	strBasisRemark += "  3) 일반항목\n";
	strBasisRemark += "    -\n";
	strBasisRemark += "\n";
	strBasisRemark += "3. 특이사항\n";
	strBasisRemark += "  -\n";
	strBasisRemark += "\n";
	strBasisRemark += "※ 중요관리점 현황\n";
	strBasisRemark += "  - CCP-1B(OO공정) : 00.0℃ 이상, 0~0분\n";
	strBasisRemark += "  - CCP-2P(OO공정) : Fe 0mm, SUS 0mm\n";
	ds_resultMst.setColumn(0, "REMARK", strBasisRemark);
	
	// 점검표구분 초기 세팅
	cbo_tableType.index = 0;
	
	// 양식 초기 세팅
	ds_cboFormCd.filter("TABLE_TYPE==" + wrapQuote(ds_cboTableType.getColumn(0, "CODE")));
	cbo_formCd.index = 0;		// 양식
	cbo_dealClass.index = 1;	// 거래구분
	cbo_chkClass.index = 1;		// 점검구분
	
	// 체크박스 초기화
 	SCCheckbox.setValue("div_deliveryPlce", "");
 	SCCheckbox.setValue("div_passCenter", "");
 	SCCheckbox.setValue("div_foodTypeClass", "");
 	
 	edt_sub_comp_nm.value = "";
	
	// 점검일 세팅 (오늘날짜)
	//cal_chkDd.value = gfn_today();
	
	// 양식 디테일 조회
	fn_formLoad();
	
	// 입력 모드로 전환
	fn_changeUpdateMode("I");
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_delete()
 * 기ㅡㅡㅡ능 : 점검결과 삭제
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function fn_delete() 
{
	var nRow = ds_resultList.rowposition;
	
	if (nRow < 0)
	{
		g_Message("EE", "삭제하실 점검 정보를 선택해주세요.");
		return;
	}
	
 	if (ds_resultList.getColumn(nRow,"SIGN_PROGRESS_STATUS1") == 'DRAFT') {
 		g_Message("EE", "평가결재 상신상태(DRAFT)는 삭제하실 수 없습니다.");
 		return;
 	}

 	if (ds_resultList.getColumn(nRow,"SIGN_PROGRESS_STATUS1") == 'APPROVE') {
 		g_Message("EE", "평가결재 승인상태(APPROVE)는 삭제하실 수 없습니다.");
 		return;
 	}

 	if (ds_resultList.getColumn(nRow,"SIGN_PROGRESS_STATUS1") == 'COMPLETE') {
 		g_Message("EE", "평가결재 완료상태(COMPLETE)는 삭제하실 수 없습니다.");
 		return;
 	}

 	if (ds_resultList.getColumn(nRow,"SIGN_PROGRESS_STATUS2") == 'DRAFT') {
 		g_Message("EE", "개선결재 상신상태(DRAFT)는 삭제하실 수 없습니다.");
 		return;
 	}

 	if (ds_resultList.getColumn(nRow,"SIGN_PROGRESS_STATUS2") == 'APPROVE') {
 		g_Message("EE", "개선결재 승인상태(APPROVE)는 삭제하실 수 없습니다.");
 		return;
 	}

 	if (ds_resultList.getColumn(nRow,"SIGN_PROGRESS_STATUS2") == 'COMPLETE') {
 		g_Message("EE", "개선결재 완료상태(COMPLETE)는 삭제하실 수 없습니다.");
 		return;
 	}
	
	if (!g_Confirm("01", "[" + ds_resultList.getColumn(nRow, "CHK_DD") + "] " + ds_resultList.getColumn(nRow, "FORM_NM") + "를 삭제하시겠습니까?")) return;
	
	ds_resultList.deleteRow(nRow);
	
	jsp_transaction(
		  this                                 // 해당 스크립트를 호출하는 Form 객체
		, "FSC00310E_T003"                     // 서비스 ID
		, "U_svc::fs/fsc/FSC00310E_T003.jsp"   // 서비스 URL
		, "ds_resultList=ds_resultList:U"      // 서버로 전송할 DataSet 객체 Str
		, ""                                   // 서버로부터 전송 받을 DataSet 객체 String
		, ""                                   // 서버로 전송할 기타 Argument 정보 String
		, "fn_callBackDelete"                  // 서버에서 처리가 완료된 후 Callback 받을 Function 명
		, true                                 // 에러 발생 시 Callback 함수 호출 여부
		, false                                // 처리중입니다. 메시지 창 보여줄지 여부 설정하기
		, true                                 // 동기식으로 설정할지 여부
	);
}

function fn_callBackDelete(errCode, errMsg) 
{
	if( errCode != 0 ) {
		g_Message("EE", errMsg);
		return;
	}
	else
	{
		g_Message("02", "점검 정보가 삭제되었습니다.");
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_save()
 * 기ㅡㅡㅡ능 : 점검결과 저장
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function fn_save() 
{

	// 0값 체크
	var nRow = ds_resultDtlList.findRowExpr("NA_YN==0 && gfn_isNull(CHK_SCORE)");
	if(nRow > -1)
	{
		g_Message("02", "[ " + ds_resultDtlList.getColumn(nRow, "CLASS_NM") + "] 소분류의 점수가 입력되지 않았습니다.");
		ds_resultDtlList.rowposition = nRow;
		return;
	}

	// 체크 값 세팅
	var sDeliveryPlce = SCCheckbox.getValue("div_deliveryPlce", SCCheckbox.ONLY_VALUE);
	var sPassCenter = SCCheckbox.getValue("div_passCenter", SCCheckbox.ONLY_VALUE);
	var sFoodTypeClass = SCCheckbox.getValue("div_foodTypeClass", SCCheckbox.ONLY_VALUE);
	
	// 공백일 경우 null값으로 넣어줘야 변경 없는 데이터로 인식
	if (sDeliveryPlce == '') sDeliveryPlce = null;
	if (sPassCenter == '') sPassCenter = null;
	if (sFoodTypeClass == '') sFoodTypeClass = null;
	
	ds_resultMst.setColumn(0, "DELIVERY_PLCE", sDeliveryPlce);
	ds_resultMst.setColumn(0, "PASS_CENTER", sPassCenter);
	ds_resultMst.setColumn(0, "FOOD_TYPE_CLASS", sFoodTypeClass);

	if((!gfn_dsIsUpdated(ds_resultDtlList)) && (!gfn_dsIsUpdated(ds_resultMst)))
	{
		g_Message("EE", "변경된 데이터가 없습니다.");
		return false;
	}
	
	// 업체 코드 세팅 (신규일 경우 조회조건의 업체코드 세팅)
	if(gfn_isNull(ds_resultMst.getColumn(0, "CUSTCD")))
	{
		ds_resultMst.setColumn(0, "CUSTCD", ds_cond.getColumn(0, "CUSTCD"));
	}
	
	// 유효성 검사
	if (gfn_validCheck(ds_resultMst, ds_resultMstValid, true) == false) return;
	
	if (!g_Confirm("01", "점검 정보를 저장하시겠습니까?")) return;

	//2018.05.25 김명섭 신규입력일 경우 점검결과 Dataset 하위공장명 세팅(PK값으로 입력값이 없을 경우 스페이스 처리)
	if (fMode == "I") {
		if (edt_sub_comp_nm.value == "") edt_sub_comp_nm.value = " ";
		for(i=0; i<ds_resultDtlList.rowcount; i++)
		{
			ds_resultDtlList.setColumn(i,"SUB_COMP_NM", edt_sub_comp_nm.value);
		}
		ds_resultMst.setColumn(0, "SUB_COMP_NM", edt_sub_comp_nm.value);
	}
	
	jsp_transaction(
		  this                                 // 해당 스크립트를 호출하는 Form 객체
		, "FSC00300E_T001"                     // 서비스 ID
		, "U_svc::fs/fsc/FSC00310E_T001.jsp"   // 서비스 URL
		, "ds_resultMst=ds_resultMst:U ds_resultDtlList=ds_resultDtlList:U"        // 서버로 전송할 DataSet 객체 Str
		, ""                                   // 서버로부터 전송 받을 DataSet 객체 String
		, ""                                   // 서버로 전송할 기타 Argument 정보 String
		, "fn_callBackSave"                    // 서버에서 처리가 완료된 후 Callback 받을 Function 명
		, true                                 // 에러 발생 시 Callback 함수 호출 여부
		, false                                // 처리중입니다. 메시지 창 보여줄지 여부 설정하기
		, false                                // 동기식으로 설정할지 여부
	);

}

function fn_callBackSave(errCode, errMsg) 
{
	if( errCode != 0 ) {
		g_Message("EE", errMsg);
		return;
	} else {
		g_Message("02", "점검 정보를 저장하였습니다.");
		if (ds_resultList.rowposition >= 0)
		{
			fn_resultLoad(ds_resultList.rowposition);
		}
		else
		{
			fn_search();
		}
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_print()
 * 기ㅡㅡㅡ능 : 점검결과 출력
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function fn_print()
{
	//레포트에 전달할 파라메터 생성
	var arrParams	= SCReport.newParams ();
	
	//--------------------------------------------------
	//방법1)서버에서 Query에 의해 처리하는 경우 예
	//(필수) 레포트명
	SCReport.setParams (arrParams, SCReport.RPT_NAME, "/IFIS/FSC00310E_R01.ozr");

	//출력 옵션 설정
	SCReport.setParams (arrParams, SCReport.RPT_TITLE, "협력업체 점검결과");
	
	//레포트에 맞게 전달되는 개발자 정의 파라미터
	SCReport.setParams (arrParams, "PARAM1", ds_resultList.getColumn(ds_resultList.rowposition, "FORM_CD")); //FORM_CD
	SCReport.setParams (arrParams, "PARAM2", ds_resultList.getColumn(ds_resultList.rowposition, "CUSTCD"));	//CUSTCD
	SCReport.setParams (arrParams, "PARAM3", ds_resultList.getColumn(ds_resultList.rowposition, "CHK_DD")); //CHK_DD
	SCReport.setParams (arrParams, "PARAM4", ds_resultList.getColumn(ds_resultList.rowposition, "TABLE_TYPE")); //TABLE_TYPE
	//2018.05.25 김명섭 하위공장명추가
	SCReport.setParams (arrParams, "PARAM5", ds_resultList.getColumn(ds_resultList.rowposition, "SUB_COMP_NM")); //SUB_COMP_NM
	
	SCReport.setParams (arrParams, "zoom", 100);
//	trace("PARAM1["+arrParams["PARAM1"]+"]");
//	trace("PARAM2["+arrParams["PARAM2"]+"]");
//	trace("PARAM3["+arrParams["PARAM3"]+"]");
//	trace("PARAM4["+arrParams["PARAM4"]+"]");
//	trace("PARAM5["+arrParams["PARAM5"]+"]");
	//------------------------------------------
	SCReport.viewReport (this, arrParams);
}	
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_changeUpdateMode(mode) 
 * 기ㅡㅡㅡ능 : 컴포넌트 활성/비활성 처리
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function fn_changeUpdateMode(mode) 
{
	fMode = mode;

	// 조회모드
	if (mode == "S")
	{
		btn_sendResult.enable = false;	// 결과구매전송
		btn_inspectReq.enable = false;	// 식품검사의뢰
		btn_confirm.enable = false;		// 결과확정
		cbo_tableType.enable = false;   // 점검표구분
		cbo_formCd.enable = false;      // 양식명
		cal_chkDd.enable = false;       // 점검일
		btn_tmCd.enable = false;        // 소속
		btn_inspector.enable = false;   // 점검자
		btn_reject.enable = false;      // 개선반려
		edt_sub_comp_nm.enable = false; // 하위공장명
	}
	// 입력모드
	else if (mode == "I")
	{
		btn_sendResult.enable = false;	// 결과구매전송
		btn_inspectReq.enable = false;	// 식품검사의뢰
		btn_confirm.enable = false;		// 결과확정
		cbo_tableType.enable = true;    // 점검표구분
		cbo_formCd.enable = true;       // 양식명
		cal_chkDd.enable = true;        // 점검일
		btn_tmCd.enable = true;         // 소속
		btn_inspector.enable = true;    // 점검자
		edt_sub_comp_nm.enable = true;  // 하위공장명
	}
	// 수정모드
	else if (mode == "U")
	{
		btn_sendResult.enable = true;	// 결과구매전송
		btn_inspectReq.enable = true;	// 식품검사의뢰
		btn_confirm.enable = true;		// 결과확정
		cbo_tableType.enable = false;   // 점검표구분
		cbo_formCd.enable = false;      // 양식명
		cal_chkDd.enable = false;       // 점검일
		btn_tmCd.enable = true;         // 소속
		btn_inspector.enable = true;    // 점검자
		edt_sub_comp_nm.enable =false;  // 하위공장명
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : grd_list_BKimg(val)
 * 기ㅡㅡㅡ능 : 사진 아이콘
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function grd_list_BKimg(val)
{
	var camera = "'theme://images/new/grd_WF_Camerabtn.png'";
	var expand = "'theme://images/new/grd_WF_Expand.png'";
	
	switch(val)
	{
		case "camera1":
			return "transparent URL(" + camera + ") center middle";
			break;
		
		case "camera2":
			return "#e4e4e4ff URL(" + camera + ") center middle";
			break;
		
		case "selectcamera":
			return "#24a3a8ff URL(" + camera + ") center middle";
			break;
		
		case "popup1":
			return "transparent URL(" + expand + ") center middle";
			break;
		
		case "popup2":
			return "#e4e4e4ff URL(" + expand + ") center middle";
			break;
		
		case "selectpopup":
			return "#24a3a8ff URL(" + expand + ") center middle";
			break;

		default:
			return val;
			break;
	}
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_tmCd_onclick(obj:Button, e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 소속팀 조회 팝업
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function btn_tmCd_onclick(obj:Button, e:ClickEventInfo)
{
	// MU_CD : 2001 (FC사업지원부)
	fn_sql_common_setup( "SELECT DISTINCT TM_CD, TM_NM FROM HLDC_SC_DEPT_V WHERE (1 = 1) AND (MU_CD = '2001') "
						,strMAQuery_TeamKeyField
						,strMAQuery_TeamValueField
						,strMAQuery_TeamKeyFieldNM
						,strMAQuery_TeamValueFieldNM
						,""
						,""
						,""
						,strMAQuery_TeamCaption
						,strMAQuery_TeamAllField
						);
	
	ds_resultMst.setColumn(0,"TM_NM", gds_sql_common.getColumn(0, "ret_name"));
	ds_resultMst.setColumn(0,"TM_CD", gds_sql_common.getColumn(0, "ret_code"));	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_inspector_onclick(obj:Button, e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 점검자 조회 팝업
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function btn_inspector_onclick(obj:Button, e:ClickEventInfo)
{
	fn_sql_common_setup( strMAQuery_SABUN
						,strMAQuery_SABUNKeyField
						,strMAQuery_SABUNValueField
						,strMAQuery_SABUNKeyFieldNM
						,strMAQuery_SABUNValueFieldNM
						,""
						,""
						," AND (V.PER_DTD IS NULL OR V.PER_DTD = '00000000') "
						,strMAQuery_SABUNCaption
						,strMAQuery_SABUNAllField
						);

	ds_resultMst.setColumn(0,"INSPECTOR_NM", gds_sql_common.getColumn(0, "ret_name"));
	ds_resultMst.setColumn(0,"INSPECTOR", gds_sql_common.getColumn(0, "ret_code"));	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : tab_resultList_tabpage_btn_excelUpload_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 엑셀등록
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function tab_resultList_tabpage_btn_excelUpload_onclick(obj:Button,  e:ClickEventInfo)
{
	if (gfn_isNull(ds_resultMst.getColumn(0, "FORM_CD")))
	{
		g_Message("EE", "양식을 선택해주세요.");
		return;
	}

	this.setWaitCursor(true, true);
	
	ds_excelDtlList.clearData();
	
    var sFile;
	sFile = fdl_excel.open("FileOpen", fdl_excel.LOAD, "%MYDOCUMENT%");
	
	if (sFile == "undefined" || sFile == null)
	{
		this.setWaitCursor(false, true);
		return;
	}

	var objImport = new ExtCommon();
	//excelImportByIndex(파일명, 시트index, importDSName, Dataset의 컬럼 정보를 유지할지 여부, intExp, intDecimal, Import 시작 행(사용된 Range 기준, 1 base)
	objImport.excelImportByIndex(sFile.fullpath,0, "ds_excelDtlList", 1, 1, 0, 2);
	objImport = null;
	
	//trace(ds_excelDtlList.getRowCount());
	
	// 엑셀파일로 업로드 한 내용을 등록
	var nExcelCnt = ds_excelDtlList.getRowCount();
	var nRow;
	var nSetCnt = 0;
	var nNaCnt = 0;
	var nScore = 0;
	for (i=0; i<nExcelCnt; i++)
	{
		nRow = ds_resultDtlList.findRow("CLASS_CD", gfn_lPad(ds_excelDtlList.getColumn(i, "F"), "0", 8));
		//trace(nRow);
		//trace(gfn_lPad(ds_excelDtlList.getColumn(i, "F"), "0", 8));
		if (nRow > -1)
		{
			// N/A가 아닐경우만 점수, 점검내용 처리
			if (ds_excelDtlList.getColumn(i, "H") == "0") {
				ds_resultDtlList.setColumn(nRow, "NA_YN", ds_excelDtlList.getColumn(i, "H"));        // N/A
				ds_resultDtlList.setColumn(nRow, "CHK_SCORE", ds_excelDtlList.getColumn(i, "K"));    // 점수
				ds_resultDtlList.setColumn(nRow, "CHK_CONTENTS", ds_excelDtlList.getColumn(i, "M")); // 점검내용
				
				// 중점항목에 대해서만 적합/부적합 처리
				if (ds_resultDtlList.getColumn(nRow, "FOCS_ARTICLE_YN") == "Y")
				{
					nScore = ds_resultDtlList.getColumn(nRow, "NOT_FIT_SCORE");
					if(gfn_isNull(nScore))
					{
						nScore = ds_resultDtlList.getColumn(nRow, "CHK_IDCTR");
					}
				
					if (nScore > 0)
					{
						if (Number(ds_excelDtlList.getColumn(i, "K")) > Number(ds_resultDtlList.getColumn(nRow, "CHK_IDCTR")))
						{
							this.setWaitCursor(false, true);
							g_Message("02", (i + 1) + "번째 항목에 점검지표보다 큰 점수가 입력되었습니다.\n점검 양식이 맞는지 확인해주시기 바랍니다.");
							fn_formLoad();
							return;
						}
						
						if (ds_excelDtlList.getColumn(i, "K") < nScore)
						{
							ds_resultDtlList.setColumn(nRow, "CHK_RESULT", "2"); // 부적합
						}
						else
						{
							ds_resultDtlList.setColumn(nRow, "CHK_RESULT", "1"); // 적합
						}
					}
				}
				nSetCnt = nSetCnt + 1;
			} else {
				ds_resultDtlList.setColumn(nRow, "NA_YN", ds_excelDtlList.getColumn(i, "H"));        // N/A
				nNaCnt = nNaCnt + 1;
			}
		}
	}

	this.setWaitCursor(false, true);

	if (nSetCnt + nNaCnt == 0) {
		g_Message("02", "등록된 항목이 없습니다. \n점검 양식이 맞는지 확인해주시기 바랍니다.");
	} else {
		g_Message("02", nSetCnt + "건 항목이 적용되었습니다. ( N/A : " + nNaCnt + "건 )");
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : cbo_tableType_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
 * 기ㅡㅡㅡ능 : 점검표구분 변경시 양식명 필터링
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function cbo_tableType_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	ds_cboFormCd.filter("TABLE_TYPE==" + wrapQuote(e.postvalue));
	// 첫번째 양식 선택후 폼 
	cbo_formCd.index = 0;
	fn_formLoad();
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : grd_resultList_oncelldblclick(obj:Grid, e:GridClickEventInfo)
 * 기ㅡㅡㅡ능 : 점검정보목록 선택시 점검정보 조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function grd_resultList_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	var strMsg = "변경된 내역이 있습니다. 저장하시겠습니까?";

	// 변경 데이터 체크
	if(gfn_dsIsUpdated(ds_resultDtlList) || gfn_dsIsUpdated(ds_resultMst))
	{
		if (g_Confirm("02",strMsg))
		{
			fn_save();
			return;
		}
	}
	
	// 의뢰정보 클릭 시 전자결재 상신 또는 상신상세 버튼 연동
    fn_gwUserButtonInit();
	
	fn_resultLoad(e.row);
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_resultLoad(nRow) 
 * 기ㅡㅡㅡ능 : 점검정보 조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function fn_resultLoad(nRow) 
{

	// 점검결과목록 초기화
	ds_resultMst.clearData();
	ds_resultDtlList.clearData();
	ds_resultSum.clearData();
	
	// 조회 키값 세팅
	
	var sOtherArgs = "CUSTCD=" + ds_resultList.getColumn(nRow, "CUSTCD");
	sOtherArgs    += " TABLE_TYPE=" + ds_resultList.getColumn(nRow, "TABLE_TYPE");
	sOtherArgs    += " FORM_CD=" + ds_resultList.getColumn(nRow, "FORM_CD");
	sOtherArgs    += " CHK_DD=" + ds_resultList.getColumn(nRow, "CHK_DD");
	sOtherArgs    += " SUB_COMP_NM='" + ds_resultList.getColumn(nRow, "SUB_COMP_NM") + "'"; //하위공장명추가_2018.05.24
	
	fsp_clear(this);
	fsp_addSearch(this,"fs/fsc:FSC00310E_S001");	// 점검 마스터
	fsp_addSearch(this,"fs/fsc:FSC00310E_S002");	// 점검 디테일
	fsp_addSearch(this,"fs/fsc:FSC00310E_S004");	// 점검 결과
	fsp_callService(this,"","","","ds_resultMst=ds_list ds_resultDtlList=ds_dtlList ds_resultSum=ds_sumList",sOtherArgs,"fn_callBackDblClick");

}

function fn_callBackDblClick() 
{
	// 수정모드로 전환
	fn_changeUpdateMode("U");
	
	// 결과 확정이 된 점검에 대해서만 결과구매전송, 전자결재 가능하도록 처리
	if(ds_resultMst.getColumn(0, "CONFIRM_YN") == "Y") 
	{
		btn_sendResult.enable = true;	// 결과구매전송
		btn_confirm.enable = false;
	} 
	else 
	{
		btn_sendResult.enable = false;	// 결과구매전송
		btn_confirm.enable = true;
	}

	if(ds_resultMst.getColumn(0, "CONFIRM_YN") == "Y" && ds_resultMst.getColumn(0, "SIGN_PROGRESS_STATUS1")=="COMPLETE")
	{
		btn_gwDraftCheck.enable = false;
	}
	else
	{
		btn_gwDraftCheck.enable = true;
	}
	
	// 개선 확정이 된 점검에 대해서만 전자결재 가능하도록 처리
	if(ds_resultMst.getColumn(0, "IMPROV_CONFIRM_YN") == "Y") 
	{
		btn_reject.enable = true;
	}
	else
	{
		btn_reject.enable = false;
	}
	
	if(ds_resultMst.getColumn(0, "IMPROV_CONFIRM_YN") == "Y" && ds_resultMst.getColumn(0, "SIGN_PROGRESS_STATUS2")!="COMPLETE")
	{
		btn_gwDraft.enable = true;
	}
	else
	{
		btn_gwDraft.enable = false;
	}

	ds_cboFormCd.filter("TABLE_TYPE==" + ds_resultMst.getColumn(0, "TABLE_TYPE"));
			
	// 체크박스 세팅
	SCCheckbox.setValue('div_deliveryPlce', ds_resultMst.getColumn(0, "DELIVERY_PLCE"), SCCheckbox.ONLY_VALUE);
	SCCheckbox.setValue('div_passCenter', ds_resultMst.getColumn(0, "PASS_CENTER"), SCCheckbox.ONLY_VALUE);
	SCCheckbox.setValue('div_foodTypeClass', ds_resultMst.getColumn(0, "FOOD_TYPE_CLASS"), SCCheckbox.ONLY_VALUE);
	
 	var sFoodTypeMgrp = ds_resultMst.getColumn(0, "FOOD_TYPE_MGRP");
 	var sFoodTypeMclass = ds_resultMst.getColumn(0, "FOOD_TYPE_MCALSS");
 	var sFoodTypeSclass = ds_resultMst.getColumn(0, "FOOD_TYPE_SCLASS");

	// 식품의유형 코드 조회
	fn_sql_common("C", mgrpQuery + "AND SPECM_TYPE = '" + ds_resultMst.getColumn(0, "SPECM_TYPE") + "'", "", "", "non", cbo_foodTypeMgrp, -1, ds_cboFoodTypeMgrp);	// 대분류
 	fn_sql_common("C", mclassQuery + "AND SPECM_TYPE = '" + ds_resultMst.getColumn(0, "SPECM_TYPE") + "'", "", "", "non", cbo_foodTypeMclass, -1, ds_cboFoodTypeMclass);	// 중분류
 	fn_sql_common("C", sclassQuery + "AND SPECM_TYPE = '" + ds_resultMst.getColumn(0, "SPECM_TYPE") + "'", "", "", "non", cbo_foodTypeSclass, -1, ds_cboFoodTypeSclass);	// 소분류	
	
 	// 식품의유형 세팅
 	ds_resultMst.setColumn(0, "FOOD_TYPE_MGRP", sFoodTypeMgrp);
 	ds_resultMst.setColumn(0, "FOOD_TYPE_MCALSS", sFoodTypeMclass);
 	ds_resultMst.setColumn(0, "FOOD_TYPE_SCLASS", sFoodTypeSclass);
 	
 	//하위공장명
 	edt_sub_comp_nm.value = ds_resultMst.getColumn(0, "SUB_COMP_NM");
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : cbo_formCd_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
 * 기ㅡㅡㅡ능 : 양식명 선택시 양식정보 조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function cbo_formCd_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	fn_formLoad();
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_formLoad()
 * 기ㅡㅡㅡ능 : 양식정보 조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function fn_formLoad() {
	// 키값 세팅
	ds_cond.setColumn(0, "TABLE_TYPE", ds_resultMst.getColumn(0, "TABLE_TYPE"));
	ds_cond.setColumn(0, "FORM_CD", ds_resultMst.getColumn(0, "FORM_CD"));
	
	fsp_clear(this);
	fsp_addSearch(this,"fs/fsc:FSC00310E_S003");
	fsp_callService(this,"","","ds_cond=ds_cond","ds_formDtlList=ds_dtlList","","fn_callBackFormCd");	
}

function fn_callBackFormCd(errCode, errMsg)
{
	if( errCode != 0 ) {
		g_Message("EE", errMsg);
		return;
	}
	
	// 조회 양식을 점검결과로 복사
	ds_resultDtlList.clearData();
	for(i=0; i<ds_formDtlList.rowcount; i++)
	{
		ds_resultDtlList.addRow();
		ds_resultDtlList.copyRow(i, ds_formDtlList, i);
	}
	ds_resultDtlList.rowposition = 0;
	
	// 점검일자 초기화 (중복 체크를 위해)
	ds_resultMst.setColumn(0, "CHK_DD", "");
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : ds_resultDtlList_onvaluechanged(obj:Dataset,  e:DSColChangeEventInfo)
 * 기ㅡㅡㅡ능 : 점검항목 값 변경시 처리
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function ds_resultDtlList_onvaluechanged(obj:Dataset,  e:DSColChangeEventInfo)
{

	// N/A 일 경우 점수, 결과, 점검내용 초기화
	if (e.columnid == "NA_YN") 
	{
		if (e.newvalue == 1) 
		{
			ds_resultDtlList.setColumn(e.row, "CHK_SCORE", "");
			ds_resultDtlList.setColumn(e.row, "CHK_RESULT", "");
			ds_resultDtlList.setColumn(e.row, "CHK_CONTENTS", "");
		}
		else
		{
			ds_resultDtlList.setColumn(e.row, "CHK_SCORE", 0);
		}
	}
	
	// 중점항목에 대해서는 점수 입력시 부적합 점수 기준에 따라 결과 텍스트(적합/부적합) 표시
	if (e.columnid == "CHK_SCORE" && ds_resultDtlList.getColumn(e.row, "FOCS_ARTICLE_YN") == "Y") 
	{
		var nScore = ds_resultDtlList.getColumn(e.row, "NOT_FIT_SCORE");
		
		if (gfn_isNull(e.newvalue))
		{
			ds_resultDtlList.setColumn(e.row, "CHK_RESULT", "");
		}
		else
		{
			if (nScore > 0)
			{
				if (e.newvalue < nScore) 
				{
					ds_resultDtlList.setColumn(e.row, "CHK_RESULT", "2");	// 부적합
				}
				else
				{
					ds_resultDtlList.setColumn(e.row, "CHK_RESULT", "1");	// 적합
				}
			}
		}
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : tab_resultList_tabpage_btn_fullScreen_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 점검항목 전체화면 처리
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function tab_resultList_tabpage_btn_fullScreen_onclick(obj:Button,  e:ClickEventInfo)
{
    if (tab_resultList.tabpage.btn_fullScreen.text == "원래대로") 
    {
		tab_resultList.position.top = "344px";
		tab_resultList.tabpage.btn_fullScreen.text = "전체화면";
		tab_resultList.tabpage5.btn_fullScreen.text = "전체화면";
    }
    else 
    {
		tab_resultList.position.top = "30px";
		tab_resultList.tabpage.btn_fullScreen.text = "원래대로";
		tab_resultList.tabpage5.btn_fullScreen.text = "원래대로";
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : tab_resultList_tabpage_grd_dtlList_oncellclick(obj:Grid, e:GridClickEventInfo)
 * 기ㅡㅡㅡ능 : 사진 아이콘 클릭시 사진등록 팝업
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function tab_resultList_tabpage_grd_dtlList_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	// 점검항목 사진 아이콘
	if (e.cell == 14)
	{
		// 점검결과 등록 후 사진 등록 가능
		if(gfn_isNull(ds_resultMst.getColumn(0, "CHK_RESULT")))
		{
			g_Message("EE", "점검결과를 등록하셔야 사진등록이 가능합니다.");
			return;
		}
	
		var HL_CLASS_NM = ds_resultDtlList.getColumn(e.row, "HL_CLASS_NM");
		var HM_CLASS_NM = ds_resultDtlList.getColumn(e.row, "HM_CLASS_NM");
		var CLASS_NM = ds_resultDtlList.getColumn(e.row, "CLASS_NM");
		var CLASS_CD = ds_resultDtlList.getColumn(e.row, "CLASS_CD");
		var CHK_CONTENTS = ds_resultDtlList.getColumn(e.row, "CHK_CONTENTS");
		var sParam = {
			  HL_CLASS_NM:HL_CLASS_NM
			, HM_CLASS_NM:HM_CLASS_NM
			, CLASS_NM:CLASS_NM
			, CLASS_CD:CLASS_CD
			, CHK_CONTENTS:CHK_CONTENTS
			, CALL_TYPE:"CHECK"
			, FDIALOG_PATH:strLoadPath
		};
		var vRtn = gfn_dialog("", "U_FSC::FSC00312P.xfdl", sParam);
		if(!gfn_isNull(vRtn))
		{
			var vResult = gfn_split(vRtn, "::");
		
			//ds_resultDtlList.setColumn(e.row, "IMGE_CNT", vRtn);
			ds_resultDtlList.setColumn(e.row, "IMGE_CNT", vResult[0]);
			strLoadPath = vResult[1];
		}
	}
	
    if (e.cell == 6) {
		var objArg = {
			sParam1 : eval(obj.binddataset).getColumn(e.row, "TABLE_TYPE"),
			sParam2 : eval(obj.binddataset).getColumn(e.row, "FORM_CD"),
			sParam3 : eval(obj.binddataset).getColumn(e.row, "CLASS_CD")
		};
        var sPlayerPopup = {
			 objGrd	       : obj
			,evtGrid       : e
			,nPwidth       : 546
			,nPheight      : 290
			,sPpopupDivNm  : 'FSC00310P'
			,sPopupUrl     : 'U_FSC::FSC00310P.xfdl'
			,objArg        : objArg
			,objForm       : this
		};
		LimsUtil.gridLayerPopup(sPlayerPopup);
    }
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : tab_resultList_onchanged(obj:Tab, e:TabIndexChangeEventInfo)
 * 기ㅡㅡㅡ능 : 탭 변경시 처리 (점검결과 탭 클릭시 점검결과 조회)
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function tab_resultList_onchanged(obj:Tab, e:TabIndexChangeEventInfo)
{
    if(ds_resultMst.getRowCount() == 0) return;
    
	fsp_clear(this);
	
	// 조회 키값 세팅
	var sOtherArgs = "CUSTCD=" + ds_resultMst.getColumn(0, "CUSTCD");
	sOtherArgs    += " TABLE_TYPE=" + ds_resultMst.getColumn(0, "TABLE_TYPE");
	sOtherArgs    += " FORM_CD=" + ds_resultMst.getColumn(0, "FORM_CD");
	sOtherArgs    += " CHK_DD=" + ds_resultMst.getColumn(0, "CHK_DD");
	sOtherArgs    += " SUB_COMP_NM='" + ds_resultMst.getColumn(0, "SUB_COMP_NM") + "'"; //하위공장명추가_2018.05.24
	
	// 점검결과 탭
	if (tab_resultList.tabindex == 1)
	{	
		// 점검결과 초기화
		ds_resultSum.clearData();

		fsp_clear(this);
		fsp_addSearch(this,"fs/fsc:FSC00310E_S004");
		fsp_callService(this,"","","","ds_resultSum=ds_sumList",sOtherArgs,"fn_callBackSearch");
	}

}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_confirm_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 결과 확정
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function btn_confirm_onclick(obj:Button,  e:ClickEventInfo)
{
	if (gfn_isNull(ds_resultMst.getColumn(0, "TABLE_TYPE")))
	{
		g_Message("EE", "점검 정보를 선택해 주세요.");
		return;
	}

	if (ds_resultMst.getColumn(0, "CONFIRM_YN") == "Y")
	{
		g_Message("EE", "이미 확정된 점검정보 입니다.");
		return;
	}

	if (!g_Confirm("01", "확정 하시겠습니까?")) return;
		
	jsp_transaction(
		  this                                 // 해당 스크립트를 호출하는 Form 객체
		, "FSC00310E_T002"                     // 서비스 ID
		, "U_svc::fs/fsc/FSC00310E_T002.jsp"   // 서비스 URL
		, "ds_resultMst=ds_resultMst"          // 서버로 전송할 DataSet 객체 Str
		, ""                                   // 서버로부터 전송 받을 DataSet 객체 String
		, ""                                   // 서버로 전송할 기타 Argument 정보 String
		, "fn_callBackConfirm"                    // 서버에서 처리가 완료된 후 Callback 받을 Function 명
		, true                                 // 에러 발생 시 Callback 함수 호출 여부
		, false                                // 처리중입니다. 메시지 창 보여줄지 여부 설정하기
		, false                                // 동기식으로 설정할지 여부
	);
}

function fn_callBackConfirm(errCode, errMsg)
{
	if( errCode != 0 ) {
		g_Message("EE", errMsg);
		return;
	} else {
		fn_search();
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : tab_resultList_tabpage_grd_dtlList_ontextchange(obj:Grid, e:GridEditTextChangeEventInfo)
 * 기ㅡㅡㅡ능 : 입력한 점수가 지표보다 클 경우 처리
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function tab_resultList_tabpage_grd_dtlList_ontextchange(obj:Grid, e:GridEditTextChangeEventInfo)
{
    var nVal = Number(e.posttext);	// 입력 값
    var idctr = ds_resultDtlList.getColumn(obj.currentrow, "CHK_IDCTR");	// 지표
    if (nVal >  Number(idctr) || nVal < 0)
    {
		return false;
    }
    else
    { 
        return true;
    }		
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_custSearch_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 협력업체 조회팝업
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function btn_custSearch_onclick(obj:Button,  e:ClickEventInfo)
{
	var vRtn = gfn_dialog("", "U_FSC::FSC00311P.xfdl","");
	
	if (vRtn != null)
	{
		var vResult = gfn_split(vRtn, ";");
		
		ds_cond.setColumn(0, "CUSTCD", vResult[0]);
		ds_cond.setColumn(0, "CUSTNM", vResult[1]);
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : ds_resultMst_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
 * 기ㅡㅡㅡ능 : 점검일 변경시 중복체크
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function ds_resultMst_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if (e.columnid == "CHK_DD" || e.columnid == "SUB_COMP_NM")
	{
		fn_dupCheck();
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_dupCheck(sChkDd)
 * 기ㅡㅡㅡ능 : 점검정보 중복체크
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function fn_dupCheck(sChkDd)
{
	if (gfn_isNull(ds_resultMst.getColumn(0, "CHK_DD")))
	{
		return;
	}
	
	fsp_clear(this);
	
	ds_cond.setColumn(0, "TABLE_TYPE", ds_resultMst.getColumn(0, "TABLE_TYPE"));
	ds_cond.setColumn(0, "FORM_CD", ds_resultMst.getColumn(0, "FORM_CD"));
	ds_cond.setColumn(0, "CHK_DD", ds_resultMst.getColumn(0, "CHK_DD"));
	ds_cond.setColumn(0, "SUB_COMP_NM", ds_resultMst.getColumn(0, "SUB_COMP_NM"));

	fsp_addSearch(this,"fs/fsc:FSC00310E_S001");
	fsp_callService(this,"","","ds_cond=ds_cond","ds_resultList=ds_list","","fn_callBackDupCheck");
}

function fn_callBackDupCheck(errCode, errMsg)
{
	if( errCode != 0 ) {
		g_Message("EE", errMsg);
		return;
	} else {
		if (ds_resultList.getRowCount() > 0)
		{
			g_Message("EE", "이미 등록되어있는 점검 결과가 존재합니다.\n점검정보 선택 후 수정하시기 바랍니다.\n[하위공장명확인]");
			ds_resultMst.setColumn(0, "CHK_DD", "");
		}
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : edt_custNm_onkeydown(obj:Edit, e:KeyEventInfo)
 * 기ㅡㅡㅡ능 : 조회조건 협력업체코드/명 삭제
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function edt_custNm_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13) btn_custSearch.click();
	if (e.keycode == 46) {
		ds_cond.setColumn(0, "CUSTCD", "");
		ds_cond.setColumn(0, "CUSTNM", "");
	}	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : cbo_foodTypeMgrp_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
 * 기ㅡㅡㅡ능 : 식품의유형 대분류 선택시 중분류 조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function cbo_foodTypeMgrp_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	ds_cboFoodTypeMclass.filter("MGRP_CD=='" + e.postvalue + "'");
	ds_cboFoodTypeSclass.filter("N");
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : cbo_foodTypeMgrp_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
 * 기ㅡㅡㅡ능 : 식품의유형 중분류 선택시 소분류 조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function cbo_foodTypeMclass_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	ds_cboFoodTypeSclass.filter("MCALSS_CD=='" + e.postvalue + "'");
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_inspectReq_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 식품검사의뢰
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function btn_inspectReq_onclick(obj:Button,  e:ClickEventInfo)
{
	//var strMenuID = "2528";	// 인터페이스 할 메뉴ID - DM 실패 고객 조회
	var arrParam = new Array();
	arrParam[0] = "IFIS";                                  // 검사의뢰처 구분
	arrParam[1] = ds_resultMst.getColumn(0, "TABLE_TYPE"); // 점검표코드
	arrParam[2] = ds_resultMst.getColumn(0, "FORM_CD");    // 양식코드
	arrParam[3] = ds_resultMst.getColumn(0, "CUSTCD");     // 업체코드
	arrParam[4] = ds_resultMst.getColumn(0, "CHK_DD");     // 점검일
	arrParam[5] = "";                                      // 구매 VENDOR CODE (VD_CD)
	
// 	arrParam[0] = ds_resultMst.getColumn(0, "TABLE_TYPE"); // 점검표코드
// 	arrParam[1] = ds_resultMst.getColumn(0, "FORM_CD");    // 양식코드
// 	arrParam[2] = ds_resultMst.getColumn(0, "CUSTCD");     // 업체코드
// 	arrParam[3] = ds_resultMst.getColumn(0, "CHK_DD");     // 점검일

	// 다른업무화면 호출 - MENUID,
	//gfn_openMenu(strMenuID, arrParam);
	gfn_openMenuForm("TestInfoReg.xfdl"
	                ,"X_LRM"
	                ,arrParam
	                ,"시험정보등록");
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_sendResult_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 구매시스템으로 점검결과 전송
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function btn_sendResult_onclick(obj:Button,  e:ClickEventInfo)
{
	if (gfn_isNull(ds_resultMst.getColumn(0, "TABLE_TYPE")))
	{
		g_Message("EE", "점검 정보를 선택해 주세요.");
		return;
	}

	if (!ds_resultMst.getColumn(0, "CONFIRM_YN") == "Y")
	{
		g_Message("EE", "점검결과 확정된 정보만 전송이 가능합니다.");
		return;
	}

	if (!g_Confirm("01", "전송 하시겠습니까?")) return;
		
	jsp_transaction(
		  this                                 // 해당 스크립트를 호출하는 Form 객체
		, "FSC00310E_T006"                     // 서비스 ID
		, "U_svc::fs/fsc/FSC00310E_T006.jsp"   // 서비스 URL
		, "ds_resultMst=ds_resultMst"          // 서버로 전송할 DataSet 객체 Str
		, ""                                   // 서버로부터 전송 받을 DataSet 객체 String
		, ""                                   // 서버로 전송할 기타 Argument 정보 String
		, "fn_callBackConfirm"                    // 서버에서 처리가 완료된 후 Callback 받을 Function 명
		, true                                 // 에러 발생 시 Callback 함수 호출 여부
		, false                                // 처리중입니다. 메시지 창 보여줄지 여부 설정하기
		, false                                // 동기식으로 설정할지 여부
	);	
}


/**
 * 전자결재 버튼정보를 초기화 한다.
 * @param
 * @return
 */
function fn_gwUserButtonInit()
{
    //그룹웨어 연동 버튼을 설정
    SCGw.setUserButton (this, fv_option, gfn_nvl(ds_resultList.getColumn(ds_resultList.rowposition, "SIGN_PROGRESS_STATUS2"), ""));
    SCGw.setUserButton (this, fv_optionCheck, gfn_nvl(ds_resultList.getColumn(ds_resultList.rowposition, "SIGN_PROGRESS_STATUS1"), ""), iOffsetX);
}

/**
 * 그룹웨어 개선결과 상신 버튼 클릭 시 상신 팝업을 호출한다.
 * @param obj Button
 * @param e ClickEventInfo
 * @return none
 */
function btn_gwDraft_onclick(obj:Button,  e:ClickEventInfo)
{
    if ( ds_resultList.getColumn(ds_resultList.rowposition, "SIGN_PROGRESS_STATUS2") == "DRAFT" ) {
        gfn_alert("결재 상신중입니다.");	//
        return;
    }
    if ( ds_resultList.getColumn(ds_resultList.rowposition, "SIGN_PROGRESS_STATUS2") == "COMPLETE" ) {
        gfn_alert("결재 승인완료 상태 입니다.");	//
        return;
    }

	fn_gwDraftAction('2');	// 개선결과
}

/**
 * 그룹웨어 점검결과 결재 상신 버튼 클릭 시 상신 팝업을 호출한다.
 * @param obj Button
 * @param e ClickEventInfo
 * @return none
 */
function btn_gwDraftCheck_onclick(obj:Button,  e:ClickEventInfo)
{
    if ( ds_resultList.getColumn(ds_resultList.rowposition, "SIGN_PROGRESS_STATUS1") == "DRAFT" ) {
        gfn_alert("결재 상신중입니다.");	//
        return;
    }
    if ( ds_resultList.getColumn(ds_resultList.rowposition, "SIGN_PROGRESS_STATUS1") == "COMPLETE" ) {
        gfn_alert("결재 승인완료 상태 입니다.");	//
        return;
    }
    
    fn_gwDraftAction('1');	// 점검결과
}

/**
 * 그룹웨어 상신 버튼 클릭 시 상신 팝업을 호출한다.
 * @param obj Button
 * @param e ClickEventInfo
 * @return none
 */
function fn_gwDraftAction(draftGubun)
{
     //그룹웨어에 전달할 파라메터 생성
    var arrParams	= SCGw.newParams ();

    //(필수) 결재문서 서비스명 - 문서양식별로 설정된 서비스명 설정
    var gwServiceId = "HWRC_FC_FSC_CONTRT_RESULT_REQ";
    //var gwServiceId = "HWRC_FC_FSC_RESULT_REQ";
    //var gwTitle = "[" + cbo_chkClass.text + "] " + ds_resultMst.getColumn(0, "CUSTNM") + " - 협력업체 점검결과 상신";
    var gwTitle;
    var strSubComp = ds_resultMst.getColumn(0, "SUB_COMP_NM");
    if (strSubComp != null && strSubComp != "undefined" && strSubComp != " ")
    {
		gwTitle = "[" + cbo_chkClass.text + "] " + ds_resultMst.getColumn(0, "CUSTNM") + ":" + strSubComp + " - 협력사 위생평가 결과보고";
    }
    else
    {
		gwTitle = "[" + cbo_chkClass.text + "] " + ds_resultMst.getColumn(0, "CUSTNM") + " - 협력사 위생평가 결과보고";
    }
    
    //(필수)문서 방향 : 가로 또는 세로 방향 (GW_VERTICAL, GW_HORIZONTAL)
    SCGw.setParams (arrParams, SCGw.GW_PORTRAIT, SCGw.VERTICAL);
    
    // 개선결과 결재 상신인 경우
    if (draftGubun == '2')
    {
        gwServiceId = "HWRC_FC_FSC_CONTRT_IMPROV_REQ";
        //gwServiceId = "HWRC_FC_FSC_IMPROV_REQ";
        //gwTitle = "[" + cbo_chkClass.text + "] " + ds_resultMst.getColumn(0, "CUSTNM") + " - 협력업체 개선결과 상신";
        gwTitle = "[" + cbo_chkClass.text + "] " + ds_resultMst.getColumn(0, "CUSTNM") + " - 협력업체 개선결과 상신";
        
		//(필수)문서 방향 : 가로 또는 세로 방향 (GW_VERTICAL, GW_HORIZONTAL)
		SCGw.setParams (arrParams, SCGw.GW_PORTRAIT, SCGw.GW_HORIZONTAL);
    }
    SCGw.setParams (arrParams, SCGw.GW_SERVICE_NAME, gwServiceId);

    //trace(gwTitle);
    
    //(필수) 본문 URL : (주의) .do로 호출해야 하며 GET 방식으로 파라미터를 전달 (id라는 key는 사용 불가)
    // draftGubun에 따라 양식을 변경 한다.
    var sBodyUrl = "/fs/cmn/gwDraftController/makeGwDraftContent.do?searchId=" + draftGubun
                                            + "&FORM_CD=" + ds_resultList.getColumn(ds_resultList.rowposition, "FORM_CD")
                                            + "&CUSTCD=" + ds_resultList.getColumn(ds_resultList.rowposition, "CUSTCD")
                                            + "&CHK_DD=" + ds_resultList.getColumn(ds_resultList.rowposition, "CHK_DD")
                                            + "&TABLE_TYPE=" + ds_resultList.getColumn(ds_resultList.rowposition, "TABLE_TYPE")
                                            //+ "&IMG_ROOT=" + fsp_getServerDir("FSC_RESULT_PHOTO", "") + "/"
                                            //모바일에서 그룹웨어 결제 어플에서 읽기 위해서 결제할때 외부 URL 사용
                                            + "&IMG_ROOT=" + "https://nfics.hanwhafoodist.co.kr//app/gpfs/app_repository/ifis/upload/fs/fsc/photo" + "/"
                                            //2018.05.25 김명섭 하위공장명추가
                                            + "&SUB_COMP_NM=" + ds_resultList.getColumn(ds_resultList.rowposition, "SUB_COMP_NM")
                                            ;
                                            
    SCGw.setParams (arrParams, SCGw.GW_BODY_URL, sBodyUrl);

    //(필수) 본문 제목 – 문서양식 별로 설정된 업무명
    SCGw.setParams (arrParams, SCGw.GW_BODY_TITLE, gwTitle);

    //(선택)첨부문서 목록 : json 형태 문자열
	SCGw.setParams (arrParams, SCGw.GW_ATTACH_LIST, fv_attachList);

    //(선택)Client Id : 결재 instance id와 연관을 맺기위한 업무별 ID로 unique key를 이용, 생략하면 상신시각이 됨(최대 40 byte)
    //SCGw.setParams (arrParams, SCGw.GW_CLIENT_ID, edt_id.value);

    strDraftGubun = draftGubun;

    //그룹웨어 상신 팝업을 호출한다.
    SCGw.sendDraft (this, arrParams);
}

/**
 * 그룹웨어 점검결과 재상세 버튼 클릭 시 결재상세 팝업을 호출한다.
 * @param obj Button
 * @param e ClickEventInfo
 * @return none
 */
function btn_gwDetail_onclick(obj:Button,  e:ClickEventInfo)
{
    //그룹웨어 결재상세 팝업을 호출한다.
    SCGw.sendDetailView (this, ds_resultList.getColumn(ds_resultList.rowposition, "SIGN_INSTANCE_ID2"));
}

/**
 * 그룹웨어 개선결과 결재상세 버튼 클릭 시 결재상세 팝업을 호출한다.
 * @param obj Button
 * @param e ClickEventInfo
 * @return none
 */
function btn_gwDetailCheck_onclick(obj:Button,  e:ClickEventInfo)
{
    //그룹웨어 부적합 결재상세 팝업을 호출한다.
    SCGw.sendDetailView (this, ds_resultList.getColumn(ds_resultList.rowposition, "SIGN_INSTANCE_ID1"));
}

/**
 * 그룹웨어 상신 처리 후 반환되는 Instance Id를 처리한다. (업무 테이블에 update)
 * (중요) 이 함수는 SCGw에서 호출되므로 필히 선언되어야 한다.
 * @param instanceId
 * @return none
 */
function scgw_ondraftnotify(instanceId)
{
    //alert("instance id=[" + instanceId + "]"+" SCGw.GW_DRAFT_STATUS :"+SCGw.GW_DRAFT_STATUS);
    // 점검결과
    if (strDraftGubun == '1')
    {
        ds_resultList.setColumn(ds_resultList.rowposition, "SIGN_INSTANCE_ID1", instanceId);	 //결재InstanceId 설정
        ds_resultList.setColumn(ds_resultList.rowposition, "SIGN_PROGRESS_STATUS1", SCGw.GW_DRAFT_STATUS);	 //결재진행상태를 상신으로 설정
    }
    else	// 개선결과
    {
        ds_resultList.setColumn(ds_resultList.rowposition, "SIGN_INSTANCE_ID2", instanceId);	 //결재InstanceId 설정
        ds_resultList.setColumn(ds_resultList.rowposition, "SIGN_PROGRESS_STATUS2", SCGw.GW_DRAFT_STATUS);	 //결재진행상태를 상신으로 설정
    }

    ds_resultList.updatecontrol = false;
    ds_resultList.setRowType(ds_resultList.rowposition, Dataset.ROWTYPE_NORMAL);
    ds_resultList.updatecontrol = true;

    fn_gwResultDraft();	//결재정보 저장
}

/**
 * 전자결재 결과 정보를 업무테이블에 저장 한다.
 * @param
 * @return
 */
function fn_gwResultDraft()
{
	ds_cond.setColumn(0, "DRAFT_GUBUN", strDraftGubun);
	
	ds_cond.setColumn(0, "TABLE_TYPE", ds_resultList.getColumn(ds_resultList.rowposition, "TABLE_TYPE"));
	ds_cond.setColumn(0, "FORM_CD", ds_resultList.getColumn(ds_resultList.rowposition, "FORM_CD"));
	ds_cond.setColumn(0, "CUSTCD", ds_resultList.getColumn(ds_resultList.rowposition, "CUSTCD"));
	ds_cond.setColumn(0, "CHK_DD", ds_resultList.getColumn(ds_resultList.rowposition, "CHK_DD"));
	//2018.05.25 김명섭 하위공장명 추가
	ds_cond.setColumn(0, "SUB_COMP_NM", ds_resultList.getColumn(ds_resultList.rowposition, "SUB_COMP_NM"));
	
	
    if (strDraftGubun == '1')	// 점검결과
    {
        ds_cond.setColumn(0, "SIGN_INSTANCE_ID1", ds_resultList.getColumn(ds_resultList.rowposition, "SIGN_INSTANCE_ID1"));
    }
    else	// 개선결과
    {
        ds_cond.setColumn(0, "SIGN_INSTANCE_ID2", ds_resultList.getColumn(ds_resultList.rowposition, "SIGN_INSTANCE_ID2"));
    }
    
    //trace(ds_cond.saveXML());

	// 뭔가 업무 처리할 경우 Transaction 발생
    jsp_transaction(
		  this                                 // 해당 스크립트를 호출하는 Form 객체
		, "FSC00310E_T007"                     // 서비스 ID
		, "U_svc::fs/fsc/FSC00310E_T007.jsp"   // 서비스 URL
		, "ds_cond=ds_cond:A"      			   // 서버로 전송할 DataSet 객체 Str
		, ""                                   // 서버로부터 전송 받을 DataSet 객체 String
		, ""                                   // 서버로 전송할 기타 Argument 정보 String
		, "fn_callBackDraft"                   // 서버에서 처리가 완료된 후 Callback 받을 Function 명
		, true                                 // 에러 발생 시 Callback 함수 호출 여부
		, false                                // 처리중입니다. 메시지 창 보여줄지 여부 설정하기
		, true                                 // 동기식으로 설정할지 여부
	);
}

/**
 * 전자결재 결과 정보를 업무테이블에 저장한 callback
 * @param
 * @return
 */
function fn_callBackDraft(errCode, errMsg) 
{
	if( errCode != 0 ) {
		g_Message("EE", errMsg);
		return;
	}
	else
	{
        // 의뢰정보 클릭 시 전자결재 상신 또는 상신상세 버튼 연동
        fn_gwUserButtonInit();
        
        g_Message("02", (strDraftGubun=='1'?"점검결과":"개선결과")+" 결재 상신 되었습니다!");
        
        strDraftGubun = '1';
        
        if (gfn_isNull(edt_custNm.value)) {
			ds_cond.setColumn(0, "CUSTCD", "");
        }
        
        ds_cond.setColumn(0, "DRAFT_GUBUN", "");
        ds_cond.setColumn(0, "SIGN_INSTANCE_ID1", "");
        ds_cond.setColumn(0, "SIGN_INSTANCE_ID2", "");
        
        // 재조회
        fn_search() ;
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_reject_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 업체에서 등록한 개선결과에 대해 반려처리를 한다.
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function btn_reject_onclick(obj:Button,  e:ClickEventInfo)
{
	if (!g_Confirm("01", "개선사항에 대해 반려처리 하시겠습니까?")) return;

	ds_resultMst.setColumn(0, "IMPROV_CONFIRM_YN", "N");
	jsp_transaction(
		  this                                 // 해당 스크립트를 호출하는 Form 객체
		, "FSC00310E_T005"                     // 서비스 ID
		, "U_svc::fs/fsc/FSC00310E_T005.jsp"   // 서비스 URL
		, "ds_resultMst=ds_resultMst"          // 서버로 전송할 DataSet 객체 Str
		, ""                                   // 서버로부터 전송 받을 DataSet 객체 String
		, ""                                   // 서버로 전송할 기타 Argument 정보 String
		, "fn_callBackConfirm"                    // 서버에서 처리가 완료된 후 Callback 받을 Function 명
		, true                                 // 에러 발생 시 Callback 함수 호출 여부
		, false                                // 처리중입니다. 메시지 창 보여줄지 여부 설정하기
		, false                                // 동기식으로 설정할지 여부
	);	
}

function cbo_specmType_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	// 식품의유형
	fn_sql_common("C", mgrpQuery + "AND SPECM_TYPE = '" + e.postvalue + "'", "", "", "non", cbo_foodTypeMgrp, -1, ds_cboFoodTypeMgrp);	// 대분류
 	fn_sql_common("C", mclassQuery + "AND SPECM_TYPE = '" + e.postvalue + "'", "", "", "non", cbo_foodTypeMclass, -1, ds_cboFoodTypeMclass);	// 중분류
 	fn_sql_common("C", sclassQuery + "AND SPECM_TYPE = '" + e.postvalue + "'", "", "", "non", cbo_foodTypeSclass, -1, ds_cboFoodTypeSclass);	// 소분류
}

function btn_download_onclick(obj:Button,  e:ClickEventInfo)
{
	if (ds_resultList.rowcount < 1) return;
	if (ds_resultDtlList.rowcount < 1) return;
	if (fMode == "I") return;
	
	//세션이 쿠키에 있는지를 검사 
	if (gfn_isNull(JSESSIONID)) {
		gfn_alert("서버에 접속할 수 있는 세션정보가 없습니다.@프로그램 종료 후 다시 로그인 하신 후 처리하시기 바랍니다.");
		return;
	}

	var arrParams = new Array();

	setParams (arrParams, "portrait", "vertical");

    var sParams = "FORM_CD=" + ds_resultList.getColumn(ds_resultList.rowposition, "FORM_CD")
                                            + "&CUSTCD=" + ds_resultList.getColumn(ds_resultList.rowposition, "CUSTCD")
                                            + "&CHK_DD=" + ds_resultList.getColumn(ds_resultList.rowposition, "CHK_DD")
                                            + "&TABLE_TYPE=" + ds_resultList.getColumn(ds_resultList.rowposition, "TABLE_TYPE")
                                            + "&IMG_ROOT=" + fsp_getServerDir("FSC_RESULT_PHOTO", "") + "/"
                                            //URL 이미지 읽기 위해 외부 URL 사용
                                            //+ "&IMG_ROOT=" + "https://nfics.hanwhafoodist.co.kr//app/gpfs/app_repository/ifis/upload/fs/fsc/photo" + "/"
                                            + "&SUB_COMP_NM=" + encodeURI(encodeURIComponent(ds_resultList.getColumn(ds_resultList.rowposition, "SUB_COMP_NM")))
                                            ;

	setParams (arrParams, "sParams", sParams);
	
	var gwTitle = "[" + cbo_chkClass.text + "] " + ds_resultMst.getColumn(0, "CUSTNM") + " - 협력업체 평가결과 조회";

	setParams (arrParams, "bodyTitle", gwTitle);

	var rtnVal = gfn_dialog("FSC00310E_Pop"				// dialogId
					   , "U_FSC::FSC00310E_Pop.xfdl"	// Url
					   , {fv_Contents:arrParams}		// 배열
					   , null, null, null, null, null, false, true, -1);

}

function setParams(arrParams, strName, strValue) {
	return arrParams[strName] =  strValue;
}

function edt_sub_comp_nm_onkillfocus(obj:Edit, e:KillFocusEventInfo)
{
	ds_resultMst.setColumn(0,"SUB_COMP_NM", obj.value);
}

function txt_remark_oneditdblclick(obj:TextArea,  e:EditClickEventInfo)
{
	var arrParam = new Array();
	//arrParam[0] = ds_resultMst.getColumn(0, "REMARK");
	arrParam[0] = obj.text;
	var rtnVal = gfn_dialog("FSC00310P02"				// dialogId
						   , "U_FSC::FSC00310P02.xfdl"			// Url
						   , {fv_Contents:arrParam}			// 배열
						   , null, null, null, null, null, false, true, -1);
	if (typeof rtnVal != "undefined" && rtnVal != null)
	{
		ds_resultMst.setColumn(0, "REMARK", rtnVal);
	}	
}

function tab_resultList_tabpage_btn_Histget_onclick(obj:Button,  e:ClickEventInfo)
{
	if (gfn_isNull(ds_cond.getColumn(0, "CUSTCD")))
	{
		g_Message("EE", "업체를 선택해주세요.");
		return;
	}

	if (!g_Confirm("01", "최근 업체기타정보를 불러오겠습니까?")) return;

	ds_custHist.clearData();

	fsp_clear(this);
	fsp_addSearch(this,"fs/fsc:FSC00310E_S006");
	fsp_callService(this,"","","ds_cond=ds_cond","ds_custHist=ds_custHist","","fn_callBackSearchHist");
}

function fn_callBackSearchHist(errCode, errMsg) 
{
	if( errCode != 0 ) {
		g_Message("EE", errMsg);
		return;
	}
	
	if(ds_custHist.getRowCount() == 0)
	{
		g_Message("", "최근 업체정보가 존재하지 않습니다.");
		return;
	}
	
	ds_resultMst.setColumn(0, "ATTR01", ds_custHist.getColumn(0, "ATTR01"));
	ds_resultMst.setColumn(0, "ATTR02", ds_custHist.getColumn(0, "ATTR02"));
	ds_resultMst.setColumn(0, "ATTR03", ds_custHist.getColumn(0, "ATTR03"));
	ds_resultMst.setColumn(0, "ATTR04", ds_custHist.getColumn(0, "ATTR04"));
	ds_resultMst.setColumn(0, "ATTR05", ds_custHist.getColumn(0, "ATTR05"));
	ds_resultMst.setColumn(0, "ATTR06", ds_custHist.getColumn(0, "ATTR06"));
	ds_resultMst.setColumn(0, "ATTR07", ds_custHist.getColumn(0, "ATTR07"));
	ds_resultMst.setColumn(0, "ATTR08", ds_custHist.getColumn(0, "ATTR08"));
	ds_resultMst.setColumn(0, "ATTR09", ds_custHist.getColumn(0, "ATTR09"));
	ds_resultMst.setColumn(0, "ATTR10", ds_custHist.getColumn(0, "ATTR10"));
	ds_resultMst.setColumn(0, "ATTR11", ds_custHist.getColumn(0, "ATTR11"));
	ds_resultMst.setColumn(0, "ATTR12", ds_custHist.getColumn(0, "ATTR12"));
	ds_resultMst.setColumn(0, "ATTR13", ds_custHist.getColumn(0, "ATTR13"));
	ds_resultMst.setColumn(0, "ATTR14", ds_custHist.getColumn(0, "ATTR14"));
}
]]></Script>
  </Form>
</FDL>

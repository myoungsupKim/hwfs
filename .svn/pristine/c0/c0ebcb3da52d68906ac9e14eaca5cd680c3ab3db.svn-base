<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="TabFrame" classname="Top" inheritanceid="" position="absolute 0 0 1267 30" scrollbars="none" titletext="Tab Frame" onload="TabFrame_onload" class="frm_WF_MID">
    <Layouts>
      <Layout>
        <Static id="Static00" class="sta_MDI_Bg" anchor="left top right" position="absolute 0 0 1267 30" positiontype="position"/>
        <Tab id="tab_WorkTitle" anchor="left top right" onextrabuttonclick="tab_WorkTitle_onextrabuttonclick" scrollbars="autoboth" showextrabutton="true" position="absolute 29 0 1145 30" onchanged="tab_WorkTitle_onchanged" onlbuttonup="tab_WorkTitle_onlbuttonup" style="showextrabutton:true;" positiontype="position" class="tab_MDI" onsetfocus="tab_WorkTitle_onsetfocus">
          <Tabpages/>
        </Tab>
        <PopupMenu id="PopMenuFunc" innerdataset="ds_func" idcolumn="formId" captioncolumn="menuNm" levelcolumn="menuLvl" checkboxcolumn="menuChk" userdatacolumn="menuGubun" onmenuclick="PopMenuFunc_onmenuclick" position="absolute 43 39 208 264" anchor="default" positiontype="position"/>
        <Button id="btn_home" taborder="2" position="absolute 0 0 30 30" onclick="btn_home_onclick" anchor="left top" positiontype="position" class="btn_MDI_HomeS"/>
        <Button id="btn_Maximize" taborder="4" tabstop="false" onclick="btn_Maximize_onclick" class="btn_MDI_FrmMax" position="absolute 1185 0 1208 30" anchor="top right" tooltiptext="화면 최대화" positiontype="position"/>
        <Button id="btn_Cascade" taborder="6" tabstop="false" onclick="btn_Cascade_onclick" class="btn_MDI_FrmDivide" position="absolute 1208 0 1231 30" anchor="top right" tooltiptext="화면 Cascade 정렬" positiontype="position"/>
        <Button id="btn_CloseAll" taborder="7" tabstop="false" onclick="btn_CloseAll_onclick" class="btn_MDI_MdiClose" position="absolute 1231 0 1254 30" anchor="top right" tooltiptext="화면 모두 닫기" positiontype="position"/>
        <PopupDiv id="pdv_menu" scrollbars="none" visible="false" position="absolute 1019 33 1184 263" anchor="top right bottom" positiontype="position" class="pdiv_MDI_MdiPop">
          <Layouts>
            <Layout>
              <Grid id="grd_open" taborder="0" useinputpanel="false" position="absolute 6 6 164 228" class="grd_MDI_MidList" binddataset="gds_openPage" anchor="all" oncellclick="pdv_menu_grd_open_oncellclick" scrollbars="fixedvert" autofittype="col">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="12"/>
                      <Column size="126"/>
                      <Column size="15" band="right"/>
                    </Columns>
                    <Rows>
                      <Row size="0" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="Column0"/>
                      <Cell col="1"/>
                      <Cell col="2"/>
                    </Band>
                    <Band id="body">
                      <Cell style="background:transparent URL('theme://images/new/grd_MDI_MidListDot.png') center middle;background2:transparent URL('theme://images/new/grd_MDI_MidListDot.png') center middle;selectbackground:transparent URL('theme://images/new/grd_MDI_MidListDot.png') center middle;"/>
                      <Cell col="1" style="align:left;" text="bind:menuName"/>
                      <Cell col="2" displaytype="button" edittype="button" style="background:transparent URL('theme://images/new/grd_MDI_MidListBtn.png') center middle;background2:transparent URL('theme://images/new/grd_MDI_MidListBtn.png') center middle;selectbackground:transparent URL('theme://images/new/grd_MDI_MidListBtn.png') center middle;"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
            </Layout>
          </Layouts>
        </PopupDiv>
        <Button id="btn_openList" taborder="8" position="absolute 1153 0 1176 30" class="btn_MDI_MdiList" anchor="top right" onclick="btn_openList_onclick"/>
        <Static id="Static03" text="w09" class="Guide01_AreaRed" visible="false" position="absolute 1176 0 1185 30" anchor="top right"/>
        <Static id="Static01" text="w11" class="Guide01_AreaRed" visible="false" position="absolute 1142 0 1153 30" anchor="top right"/>
        <Static id="Static02" text="w13" class="Guide01_AreaRed" visible="false" position="absolute 1254 0 1267 30" anchor="top right"/>
        <Static id="Static04" text="h03" class="Guide01_AreaRed" visible="false" position="absolute 1019 30 1184 33" anchor="top right"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 1019 33 1184 43" anchor="top right"/>
        <Static id="Static06" text="h04" class="Guide01_AreaRed" visible="false" position="absolute 1019 259 1184 263" anchor="top right"/>
        <Static id="Static07" text="w06" class="Guide01_AreaRed" visible="false" position="absolute 1004 43 1010 259" anchor="top right"/>
        <Static id="Static08" text="w06" class="Guide01_AreaRed" visible="false" position="absolute 1178 43 1184 229" anchor="top right"/>
        <Button id="btn_home00" taborder="9" onclick="btn_home_onclick" class="btn_MDI_Home" position="absolute 0 338 30 368" anchor="left top"/>
        <Tab id="tab_WorkTitle00" anchor="left top right" taborder="10" onchanged="tab_WorkTitle_onchanged" onextrabuttonclick="tab_WorkTitle_onextrabuttonclick" onlbuttonup="tab_WorkTitle_onlbuttonup" tabindex="0" scrollbars="autoboth" showextrabutton="true" class="tab_MDI_S" position="absolute 29 338 1145 368" style="showextrabutton:true;">
          <Tabpages>
            <Tabpage id="tabpage1" text="tabpage1"/>
            <Tabpage id="tabpage2" text="tabpage2"/>
            <Tabpage id="tabpage3" text="tabpage3"/>
          </Tabpages>
        </Tab>
        <Static id="Static23" text=" ClassName : btn_MDI_Home" class="Guide02_DescriptionRed" visible="false" position="absolute -1 403 211 429"/>
        <Static id="Static18" class="Guide01_AreaRed" visible="false" position="absolute 15 366 16 393"/>
        <Static id="Static09" text=" ClassName : tab_MDI_S" class="Guide02_DescriptionRed" visible="false" position="absolute 267 403 479 429"/>
        <Static id="Static10" class="Guide01_AreaRed" visible="false" position="absolute 283 366 284 393"/>
        <Button id="btn_changeUser" taborder="11" text="접속 사용자 변경" onclick="btn_changeUser_onclick" class="btn_TT_System" visible="false" position="absolute 1010 0 1134 30" anchor="top right" style="color:darkred;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_func" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="menuLvl" type="INT" size="256"/>
          <Column id="formId" type="STRING" size="256"/>
          <Column id="menuName" type="STRING" size="256"/>
          <Column id="menuChk" type="STRING" size="256"/>
          <Column id="menuGubun" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="menuLvl">1</Col>
            <Col id="menuName">닫기</Col>
            <Col id="formId">C</Col>
            <Col id="menuGubun">C</Col>
          </Row>
          <Row>
            <Col id="menuLvl">1</Col>
            <Col id="menuName">전체 닫기</Col>
            <Col id="formId">CA</Col>
            <Col id="menuGubun">C</Col>
          </Row>
          <Row>
            <Col id="menuLvl">1</Col>
            <Col id="menuName">현재 창 제외 닫기</Col>
            <Col id="formId">CABT</Col>
            <Col id="menuGubun">C</Col>
          </Row>
          <Row>
            <Col id="formId">-</Col>
            <Col id="menuLvl">1</Col>
            <Col id="menuName">-</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : MDI Tab Frame 화면
  파 일 명 : TabFrame.xfdl
  기    능 : MDI Tab으로 화면 이동 및 닫기 기능 제공

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2014.11.01   김윤기   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";


/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_strSelMenuId = "";    //현재 선택된 메뉴 ID


/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function TabFrame_onload(obj:Form, e:LoadEventInfo) 
{
    
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*-----------------------------------------------------------------------
 * 설명    : tab_WorkTitle tabpage 추가
 *-----------------------------------------------------------------------*/
function fn_AddTitle(sFormId, sTitle) 
{
    sTitle = (gfn_lengthByte(sTitle) > 20) ? sTitle.slice(0, 10) + ".." : sTitle;
    sTitle = "" + sTitle + "";
    
    var nIndex = tab_WorkTitle.insertTabpage(sFormId, 0, "", sTitle);
    
    if( nIndex >= 0 ) {
        tab_WorkTitle.visible = true;
    }
}

/*-----------------------------------------------------------------------
 * 설명    : tab_WorkTitle tabpage 삭제
 *-----------------------------------------------------------------------*/
function fn_DelTitle(sFormId) 
{
    var bResult;
    
    if( tab_WorkTitle.tabindex >= 0 ) {
        bResult = fn_activeTitle(sFormId);
        tab_WorkTitle.removeTabpage(bResult);
    }
}

/*-----------------------------------------------------------------------
 * 설명    : 현재 tab_WorkTitle tabpage FOCUS
 *-----------------------------------------------------------------------*/
function fn_activeTitle(sFormId) 
{
    // Tab Index 변경 후 Index 리턴
    var arrPages = tab_WorkTitle.tabpages;
    
    for (var i = 0 ; i < arrPages.length; i++) {
        if (tab_WorkTitle.tabpages[i].name == sFormId) {
            tab_WorkTitle.tabindex = i;
            av_ActiveFormId = sFormId;
            return i;
        }
    }
    return -1
}

/*-----------------------------------------------------------------------
 * 설명    : 열린 화면 일괄 종료
 *-----------------------------------------------------------------------*/
function fn_closeAll(sExceptFormId) 
{
    var sFormId;
    var sPopupYN;
    var row = gds_openPage.getRowCount();
    
    for (var i = row - 1; i >= 0; i--) {
        sFormId  = gds_openPage.getColumn(i, "formId");
        sPopupYN = gds_openPage.getColumn(i, "isPopup");
        
        if (( gfn_isNull(sExceptFormId) || sFormId != sExceptFormId ) && sPopupYN != "Y")
        {
            if(afrm_MDI.all[sFormId].form.fn_close() == false) {
                fn_activeTitle(sFormId);
                return false;
            }
        }
    }
    return true;
}

/*-----------------------------------------------------------------------
 * 설명    : MDI 화면 showtitlebar togle 처리
 *-----------------------------------------------------------------------*/
function fn_show_titlebar_togle(strBtnNm) 
{
    var openFrameCnt = afrm_MDI.all.length;
    for(var i=0; i<openFrameCnt; i++) {
        var currFromNm = afrm_MDI.all[i].name;
        if(strBtnNm == "btn_Maximize") {
            afrm_MDI.all[currFromNm].showtitlebar = false;
        } else {
            afrm_MDI.all[currFromNm].showtitlebar = true;
            
            if(g_SystemId == "SPOON" || g_SystemId == "FICS")
			{
				afrm_MDI.all[currFromNm].style.border = "2 solid #515d6f";        
				afrm_MDI.all[currFromNm].titlebar.style.background = "#696cc3";
				afrm_MDI.all[currFromNm].titlebar.style.border = "0 none, 0 none, 1 solid #5a5daf, 0 none"; 
			}
			else {   
				afrm_MDI.all[currFromNm].style.border = "2 solid #515d6f";        
				afrm_MDI.all[currFromNm].titlebar.style.background = "#02a7ad";
				afrm_MDI.all[currFromNm].titlebar.style.border = "0 none, 0 none, 1 solid #48888b, 0 none";
			}
        }
    }
}


/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/

/*-----------------------------------------------------------------------
 * 설명    : MDI 탭 선택 시
 *-----------------------------------------------------------------------*/
function tab_WorkTitle_onsetfocus(obj:Tab, e:SetFocusEventInfo)
{
	if(tab_WorkTitle.getTabpageCount() == 0) {
		return;
	}
	else {
		tab_WorkTitle.class  = "tab_MDI";
		btn_home.class       = "btn_MDI_Home";
	}
}

/*-----------------------------------------------------------------------
 * 설명    : MDI 탭 변경 시
 *-----------------------------------------------------------------------*/
function tab_WorkTitle_onchanged(obj:Tab, e:TabIndexChangeEventInfo) 
{
    if(!afrm_MDI.visible) {
        afrm_MDI.visible     = true;
        afrm_Intro.visible   = false;
    }
    tab_WorkTitle.class  = "tab_MDI";
    btn_home.class       = "btn_MDI_Home";
    
    var sFormId = obj.tabpages[e.postindex].name;
    
    objChildFrame = afrm_MDI.all[sFormId];
    if(gfn_isNull(objChildFrame)) return;
    
    afrm_MDI.all[sFormId].openstatus = av_openStatus;
    
    afrm_MDI[sFormId].setFocus();
    
    // 메뉴ID 전역변수에 세팅
    gv_menuId = sFormId.replace("WF_","");
  
    var row = gds_menu.findRow(gv_menuIdCol, gv_menuId);
    
    // 프로그램ID 전역변수에 세팅
    gv_progrmId = gds_menu.getColumn(row, gv_menuProgCol);

    // HelpID 전역변수에 세팅 by kksoo
    gv_helpId = gds_menu.getColumn(row, gv_helpIdCol);

    //현재선택된 메뉴ID의 최상위 메뉴ID로 메뉴목록 필터링
    var sRootMenuId= gds_menu.getColumn(row, gv_menuRootCol);    
    var strFilter = gv_menuLevelCol + " > 0 && " + gv_menuRootCol + "=='" + sRootMenuId + "'" ;    
    
	// Top 버튼 Style 변경
	afrm_Top.form.fn_setActiveBtn(sRootMenuId);
        
    // 최상단 메뉴가 변경되었을 경우에만 처리
    if(afrm_Left.form.sta_menuTitle.text != gds_mainMenu.lookup(gv_menuIdCol, sRootMenuId, gv_menuNameCol)) 
    {        
		gds_leftMenu.filter(strFilter);
		// Left Frame 메뉴타이틀
		afrm_Left.form.sta_menuTitle.text = gds_mainMenu.lookup(gv_menuIdCol, sRootMenuId, gv_menuNameCol);       // 한글메뉴명
    }
    //선택된 메뉴 재설정
    gds_leftMenu.rowposition = gds_leftMenu.findRow(gv_menuIdCol,gv_menuId);
}

/*-----------------------------------------------------------------------
 * 설명    : MDI탭 닫기버튼 클릭
 *-----------------------------------------------------------------------*/
function tab_WorkTitle_onextrabuttonclick(obj:Tab, e:TabMouseEventInfo) 
{
    var sFormId = tab_WorkTitle.tabpages[e.index].name;
    
    if (afrm_MDI.all[sFormId].form.fn_close() == false) 
    {
        fn_activeTitle(sFormId);
        return true;
    }
}

/*-----------------------------------------------------------------------
 * 설명    : 탭에서 마우스 좌클릭 시
 *-----------------------------------------------------------------------*/
function tab_WorkTitle_onlbuttonup(obj:Tab, e:TabMouseEventInfo) 
{
    if(tab_WorkTitle.getTabpageCount() == 0) 
    {
        if(!afrm_Intro.visible) {
            afrm_MDI.visible   = false;
            afrm_Intro.visible = true;
        }
    } else {
        if(!afrm_MDI.visible) {
            afrm_MDI.visible   = true;
            afrm_Intro.visible = false;
        }
    }
}

/*-----------------------------------------------------------------------
 * 설명    : 탭에서 마우스 우클릭 시
 *-----------------------------------------------------------------------*/
function tab_WorkTitle_onrbuttonup(obj:Tab, e:TabMouseEventInfo) 
{
    var nX   = e.screenX;
    var nY   = e.screenY;
    var nIdx = obj.getIndex(e.clientX, e.clientY);
    
    if ( nIdx < 0 )    return;
    
    fv_strSelMenuId = obj.tabpages[nIdx].name;
    
    ds_func.reset();
    
    for ( var i=0; i<gds_openPage.rowcount; i++ ) {
        var rowIdx = ds_func.addRow();
        
        ds_func.setColumn(rowIdx, "menuLvl", 1);
        ds_func.setColumn(rowIdx, "formId", gds_openPage.getColumn(i, "formId"));
        ds_func.setColumn(rowIdx, gv_menuNameCol, gds_openPage.getColumn(i, gv_menuNameCol));
        
        //현재 메뉴에 체크 표시
        if ( fv_strSelMenuId == gds_openPage.getColumn(i, "formId") ) {
            ds_func.setColumn(rowIdx, "menuChk", 1);
        } else {
            ds_func.setColumn(rowIdx, "menuChk", 0);
        }
        
        ds_func.setColumn(rowIdx, "menuGubun", "F");
    }
	
    if(PopMenuFunc.isPopup()==true) PopMenuFunc.closePopup();
    var RetVal = PopMenuFunc.trackPopup(nX, nY, "right bottom");
}

/*-----------------------------------------------------------------------
 * 설명    : 우클릭 메뉴 선택 시
 *-----------------------------------------------------------------------*/
function PopMenuFunc_onmenuclick(obj:PopupMenu, e:MenuClickEventInfo) 
{
    obj.closePopup();
    
    // 닫기관련 메뉴 클릭 시
    if ( e.userdata == "C" ) 
    {
        switch ( e.id ) 
        {
            case "C" :        //Close
                if (afrm_MDI.all[fv_strSelMenuId].form.fn_close() == false) {
                    fn_activeTitle(sFormId);
                    return true;
                }
                break;
            case "CA" :        //Close All
                fn_closeAll();
                break;
            case "CABT" :    //Close All But This
                fn_closeAll(fv_strSelMenuId);
                break;
        }
    // 다른화면 메뉴 클릭 시
    } else if ( e.userdata == "F" ) {
		trace("e.id : " + e.id);
        fn_activeTitle(e.id);
    }
}

/*-----------------------------------------------------------------------
 * 설명    : Main 페이지 가기
 *-----------------------------------------------------------------------*/
function btn_home_onclick(obj:Button,  e:ClickEventInfo)
{
    if(!afrm_Intro.visible) {
        afrm_MDI.visible     = false;
        afrm_Intro.visible   = true;  
    }
    tab_WorkTitle.class  = "tab_MDI_S";
    btn_home.class       = "btn_MDI_HomeS";
}

/*-----------------------------------------------------------------------
 * 설명    : 화면 Border 처리
 *-----------------------------------------------------------------------*/
function fn_setBorder() 
{
    var arrWorkFrame = afrm_MDI.frames;
    
    for(var i=0; i < arrWorkFrame.length; i++) {
        arrWorkFrame[i].style.border     = "1 solid #898989";
        arrWorkFrame[i].style.bordertype = "round 5 5";
        arrWorkFrame[i].style.background = "#ffffff";
    }
}

/*-----------------------------------------------------------------------
 * 설명    : MDI 화면 최대화
 *-----------------------------------------------------------------------*/
function btn_Maximize_onclick(obj:Button,  e:ClickEventInfo) 
{
    if(afrm_Tab.form.tab_WorkTitle.getTabpageCount() == 0) {
        return;
    }
    
    // Intro 활성화 여부 체크
    if(!afrm_MDI.visible) {
        afrm_MDI.visible   = true;
        afrm_Intro.visible = false;
    }
    
    av_openStatus = "maximize";
    av_arrange    = "m";
    
    // MDI 화면 showtitlebar togle 처리
    afrm_Tab.form.fn_show_titlebar_togle(obj.name);
    
    var arrWorkFrame = afrm_MDI.frames;
    
    for(var i=0; i < arrWorkFrame.length; i++) 
    {
        arrWorkFrame[i].openstatus       = "maximize";
        arrWorkFrame[i].style.border     = "0px none #ffffffff";
        arrWorkFrame[i].style.bordertype = "normal 0 0";
        arrWorkFrame[i].style.background = "transparent";
    }
}

/*-----------------------------------------------------------------------
 * 설명    : MDI 세로 정렬
 *-----------------------------------------------------------------------*/
function btn_Vertical_onclick(obj:Button,  e:ClickEventInfo) 
{
    av_openStatus = "normal";
    av_arrange    = "v";
    
    // MDI 화면 showtitlebar togle 처리
    afrm_Tab.form.fn_show_titlebar_togle(obj.name);
    
    fn_setBorder();
    
    afrm_MDI.arrange("vertical");
}

/*-----------------------------------------------------------------------
 * 설명    : MDI 가로 정렬
 *-----------------------------------------------------------------------*/
function btn_Horizon_onclick(obj:Button,  e:ClickEventInfo) 
{
    av_openStatus = "normal";
    av_arrange    = "h";
    
    // MDI 화면 showtitlebar togle 처리
    afrm_Tab.form.fn_show_titlebar_togle(obj.name);
    
    fn_setBorder();
    
    afrm_MDI.arrange("horizontal");
}

/*-----------------------------------------------------------------------
 * 설명    : MDI Cascade 정렬
 *-----------------------------------------------------------------------*/
function btn_Cascade_onclick(obj:Button,  e:ClickEventInfo) 
{
    if(afrm_Tab.form.tab_WorkTitle.getTabpageCount() == 0) 
    {
        return;
    }
    
    // Intro 활성화 여부 체크
    if(!afrm_MDI.visible) {
        afrm_MDI.visible   = true;
        afrm_Intro.visible = false;
    }
    
    av_openStatus = "normal";
    av_arrange    = "c";
    
    // MDI 화면 showtitlebar togle 처리
    afrm_Tab.form.fn_show_titlebar_togle(obj.name);
    
    fn_setBorder();
    
    afrm_MDI.arrange("cascade");
}

/*-----------------------------------------------------------------------
 * 설명    : MDI 화면 모두 닫기
 *-----------------------------------------------------------------------*/
function btn_CloseAll_onclick(obj:Button,  e:ClickEventInfo) 
{
    if(afrm_Tab.form.tab_WorkTitle.getTabpageCount() == 0) 
    {
        return;
    }
    
    // Intro 활성화 여부 체크
    if(!afrm_MDI.visible) {
        afrm_MDI.visible   = true;
        afrm_Intro.visible = false;
    }    
    
    // 모든 화면을 닫으시겠습니까?
    if (gfn_confirm("confirm.allclose") == true) 
    {
        fn_closeAll();
        obj.setSelectStatus(false);
        
        if(!afrm_Intro.visible) {
            afrm_MDI.visible   = false;
            afrm_Intro.visible = true;
        }
		tab_WorkTitle.class  = "tab_MDI_S";
		btn_home.class       = "btn_MDI_HomeS";        
    }
}

/*-----------------------------------------------------------------------
 * 설명    : 열린 화면 목록
 *-----------------------------------------------------------------------*/
function btn_openList_onclick(obj:Button,  e:ClickEventInfo)
{
	if(gds_openPage.rowcount == 0) return;
	
	var nX = system.clientToScreenX(btn_openList, 0) - 140;
	var nY = system.clientToScreenY(btn_openList, 0) + btn_openList.position.height + 3;
	var nW = 168;
	var nH = 33;
	
	if (gds_openPage.rowcount > 1) {
		nH = gds_openPage.rowcount * 24 + 9;
	}
	
	pdv_menu.trackPopup(nX, nY, nW, nH);
}

function pdv_menu_grd_open_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	var sColName = gfn_getCellColId(pdv_menu.grd_open,e.col);
	switch(e.col)
	{
		case 1:
			pdv_menu.closePopup();
			
			fn_activeTitle(gds_openPage.getColumn(gds_openPage.rowposition,"formId"));
			break;
			
		case 2:
			pdv_menu.closePopup();
			
			fv_strSelMenuId = gds_openPage.getColumn(gds_openPage.rowposition,"formId");
			if (afrm_MDI.all[fv_strSelMenuId].form.fn_close() == false) {
				fn_activeTitle(sFormId);
				return true;
			}
			break;			
	}
}

function btn_changeUser_onclick(obj:Button,  e:ClickEventInfo)
{
	gfn_alert("준비중입니다.");
}
]]></Script>
  </Form>
</FDL>

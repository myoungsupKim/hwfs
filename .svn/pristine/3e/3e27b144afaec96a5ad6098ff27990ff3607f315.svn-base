<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSC91010E" onkeydown="frm_OnKeyDown" onload="form_onload" titletext="테스트문제관리" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static03" class="sta_WFDA_Labelbg" position="absolute 0 190 1237 217"/>
        <Grid autoenter="select" binddataset="ds_list" cellsizingtype="both" readonly="false" enable="true" id="grd_list" useinputpanel="false" onheadclick="grd_List_OnHeadClick" taborder="8" tabstop="true" tooltiptype="hover" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 86 1237 183" selecttype="row" anchor="left top right" autofittype="col" oncellclick="grd_list_oncellclick">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="40" band="left"/>
                <Column size="200"/>
                <Column size="595"/>
                <Column size="180"/>
                <Column size="105"/>
                <Column size="100"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="image" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="유형구분"/>
                <Cell col="2" displaytype="text" text="테스트명"/>
                <Cell col="3" displaytype="text" text="사용기간"/>
                <Cell col="4" displaytype="text" text="최종수정일"/>
                <Cell col="5" displaytype="text" text="사용"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;background:white;background2:white;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;background:white;background2:white;" text="bind:TYPE_NAME"/>
                <Cell col="2" displaytype="text" style="align:left;background:white;background2:white;" text="bind:FORM_NAME"/>
                <Cell col="3" displaytype="text" style="align:left;background:white;background2:white;" text="bind:DATE_PERIOD" mask="expr:iif(gfn_length(DATE_PERIOD)==16,'@@@@.@@.@@ ~ @@@@.@@.@@','@@@@.@@.@@ ~')"/>
                <Cell col="4" displaytype="text" style="align:center;background:white;background2:white;" text="bind:UDATE"/>
                <Cell col="5" displaytype="combo" style="align:left;background:white;background2:white;" text="bind:USE_YN" combodataset="ds_USE_YN" combocodecol="CODE" combodatacol="code_name"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static01" position="absolute 0 30 1237 71" class="sta_WFSA_Labelbg" anchor="left top right"/>
        <Static id="Static02" text="유형구분" position="absolute 15 40 93 61" class="sta_WFSA_label"/>
        <Combo id="cbo_S_TEST_TYPE" imemode="none" index="0" type="NOTFILTERED" taborder="23" position="absolute 96 40 236 60" innerdataset="@ds_TEST_TYPE" codecolumn="CODE" datacolumn="CODE_NAME"/>
        <Static id="Static00" text="테 스 트 명" position="absolute 263 190 359 217" class="sta_WFDA_Label01"/>
        <Static id="Static1" text="사용기간" position="absolute 750 190 844 217" class="sta_WFDA_Label01"/>
        <Static id="Static2" text="사용여부" position="absolute 1070 190 1155 217" class="sta_WFDA_Label01"/>
        <Edit id="ed_FORM_NAME" imemode="hangul" taborder="10" position="absolute 361 193 748 214" class="edt_WF_Essential"/>
        <Combo codecolumn="CODE" datacolumn="code_name" id="cbo_USE_YN" index="0" innerdataset="ds_USE_YN" type="NOTFILTERED" taborder="13" position="absolute 1157 193 1231 214" value="Y" text="사용"/>
        <MaskEdit id="me_FROM_DT" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="11" type="string" userdata="btn_FROM_DT" position="absolute 846 193 926 214" class="msk_WF_Cal"/>
        <Button id="btn_FROM_DT" onclick="g_CalButton_OnClick" taborder="24" tabstop="false" userdata="me_FROM_DT" position="absolute 925 193 945 214" class="btn_WF_cal" text="" image=""/>
        <Static id="Static7" text="~" position="absolute 953 193 961 214"/>
        <MaskEdit id="me_TO_DT" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="12" type="string" userdata="btn_TO_DT" position="absolute 969 193 1049 214" class="msk_WF_Cal"/>
        <Button id="btn_TO_DT" onclick="g_CalButton_OnClick" taborder="25" tabstop="false" userdata="me_TO_DT" position="absolute 1048 193 1068 214" class="btn_WF_cal" text="" image=""/>
        <Button enable="true" id="btn_input1" taborder="5" userdata="" position="absolute 508 243 526 263" class="btn_WF_GrdPlus" image="" onclick="btn_input1_onclick"/>
        <Button enable="true" id="btn_delete1" taborder="4" userdata="" position="absolute 528 243 546 263" class="btn_WF_GrdMinus" image="" onclick="btn_delete1_onclick"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="26" url="cmn::CmnBtn.xfdl" text="Div0" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 93 40" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 86 40 96 61" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 93 71" anchor="left top"/>
        <Static id="Static08" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 180 450 195" anchor="left top"/>
        <Static id="Static09" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 237 450 250" anchor="left top"/>
        <Static id="Static22" text="테스트목록" class="sta_WF_Title01" position="absolute 0 250 306 268" anchor="left top"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 263 450 268" anchor="left top"/>
        <Static id="Static12" text="문제관리" class="sta_WF_Title01" position="absolute 0 401 450 419" anchor="left top"/>
        <Static id="Static15" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 71 450 86" anchor="left top"/>
        <Static id="Static10" text="유형구분" class="sta_WFDA_Label01" position="absolute 1 190 97 217"/>
        <Combo id="cbo_S_TEST_TYPE00" taborder="9" innerdataset="@ds_TEST_TYPE" codecolumn="CODE" datacolumn="CODE_NAME" position="absolute 99 194 260 214" onitemchanged="cbo_S_TEST_TYPE00_onitemchanged" class="cmb_WF_Essential"/>
        <Grid id="grd_Detail1" taborder="7" binddataset="ds_Detail1" autoenter="select" useinputpanel="false" cellsizingtype="both" position="absolute 0 268 1237 390" anchor="default" autofittype="col" oncellclick="grd_Detail1_oncellclick" onkeyup="grd_Detail1_onkeyup">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="22"/>
                <Column size="72"/>
                <Column size="233"/>
                <Column size="252"/>
                <Column size="123"/>
                <Column size="0"/>
                <Column size="102"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
              </Columns>
              <Rows>
                <Row size="30" band="head"/>
                <Row size="23"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel" taborder="undefined"/>
                <Cell col="1" text="순번"/>
                <Cell col="2" class="grd_WF_Essential" text="문제"/>
                <Cell col="3" class="grd_WF_Essential" text="보기"/>
                <Cell col="4" text="정답"/>
                <Cell col="5" text="구입유형설명"/>
                <Cell col="6" text="배점"/>
                <Cell col="7" text="모델명설명"/>
                <Cell col="8" text="출력횟수"/>
                <Cell col="9" text="첨부파일명"/>
                <Cell col="10" text="서버파일명"/>
                <Cell col="11" text="파일존재여부"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" displaytype="normal" edittype="none" style="align:center middle;background: ;" text="bind:SEQ"/>
                <Cell col="2" displaytype="normal" edittype="none" style="align:center middle;background: ;" text="bind:TEST" combodataset="ds_amsStatCd" combocodecol="code" combodatacol="codeName"/>
                <Cell col="3" displaytype="normal" edittype="none" style="align:left middle;background: ;" text="bind:EXAMPLE" combodataset="ds_amsComeqType" combocodecol="code" combodatacol="codeName"/>
                <Cell col="4" displaytype="normal" edittype="none" style="align:left middle;background: ;" text="bind:ANSWER" combodataset="ds_amsPurchaseType" combocodecol="code" combodatacol="codeName"/>
                <Cell col="5" displaytype="normal" edittype="none" style="align:center middle;background: ;" text="bind:purchaseDesc"/>
                <Cell col="6" displaytype="normal" edittype="none" style="align:right middle;" text="bind:DISTRIBUTION" combodataset="ds_amsModelNm" combocodecol="code" combodatacol="codeName"/>
                <Cell col="7" displaytype="normal" edittype="none" style="align:left middle;background: ;" text="bind:modelDesc"/>
                <Cell col="8" displaytype="number" edittype="none" style="align:right middle;" text="bind:prtCnt" mask="@,@@@"/>
                <Cell col="9" displaytype="normal" edittype="none" style="align:center middle;" text="bind:appendFilenm"/>
                <Cell col="10" displaytype="normal" edittype="none" style="align:center middle;" text="bind:serverFilenm"/>
                <Cell col="11" displaytype="normal" edittype="none" style="align:center middle;" text="bind:fileExists"/>
              </Band>
              <Band id="summary">
                <Cell colspan="2" text="합계" taborder="undefined"/>
                <Cell col="2"/>
                <Cell col="3"/>
                <Cell col="4"/>
                <Cell col="5"/>
                <Cell col="6" style="align:right middle;" expr="expr:getSum(&quot;DISTRIBUTION&quot;)"/>
                <Cell col="7"/>
                <Cell col="8"/>
                <Cell col="9"/>
                <Cell col="10"/>
                <Cell col="11"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static14" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 388 450 401" anchor="left top"/>
        <Static id="Static17" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 414 450 419" anchor="left top"/>
        <Static id="Static34" class="sta_WFDA_Labelbg" position="absolute 1 418 679 445" anchor="left top"/>
        <Static id="Static33" text="순번" class="sta_WFDA_Label01" position="absolute 1 418 95 445" anchor="left top"/>
        <Edit id="edt_Seq" taborder="6" readonly="true" position="absolute 97 421 180 442" anchor="left top" style="background:#ecececff;align:center middle;"/>
        <Static id="Static18" class="sta_WFDA_Labelbg" position="absolute 1 444 679 575" anchor="left top"/>
        <Static id="Static20" text="문제" class="sta_WFDA_Label01" position="absolute 1 447 95 575" anchor="left top"/>
        <TextArea id="txt_Test" taborder="16" scrollbars="fixedvert" wordwrap="word" position="absolute 97 447 679 550" anchor="left top" imemode="hangul"/>
        <Static id="Static21" class="sta_WFDA_Labelbg" position="absolute 0 552 678 706" anchor="left top"/>
        <Static id="Static23" text="보기" class="sta_WFDA_Label01" position="absolute 0 554 71 706" anchor="left top"/>
        <TextArea id="txt_Test00" taborder="17" scrollbars="fixedvert" wordwrap="word" position="absolute 96 557 678 589" anchor="left top" imemode="hangul"/>
        <Static id="Static79" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 679 444 692 705"/>
        <Static id="Static80" text="이미지정보" class="sta_WF_Title01" position="absolute 696 449 786 467" anchor="left top"/>
        <Static id="Static81" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 696 462 778 467" anchor="left top"/>
        <Static id="Static82" class="sta_WFDA_Labelbg" position="absolute 696 467 1233 494" anchor="left top"/>
        <Static id="Static83" text="이미지파일명" class="sta_WFDA_Label01" position="absolute 696 467 790 494" anchor="left top"/>
        <Edit id="edt_appendFilenm" taborder="0" readonly="true" position="absolute 792 470 1229 491" anchor="left top" style="background:#ecececff;"/>
        <Static id="Static84" class="sta_WFDA_Labelbg" position="absolute 696 495 1234 706" anchor="left top"/>
        <Static id="Static85" text="이미지보기" class="sta_WFDA_Label01" position="absolute 696 499 790 702" anchor="left top"/>
        <ImageViewer id="img_viewer" taborder="1" stretch="fixaspectratio" class="img_WF_NoImage" position="absolute 792 500 1230 702" anchor="left top" style="border:1 solid #808080ff ;" moveX="0" moveY="0" resizeX="100" resizeY="100"/>
        <Static id="Static86" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 831 462 1004 467" anchor="left top"/>
        <Button id="btn_attachFile" taborder="2" text="이미지첨부" onclick="btn_attachFile_onclick" class="btn_WF_Function" position="absolute 939 444 1004 464" anchor="left top"/>
        <Static id="Static87" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 831 444 1012 449" anchor="left top"/>
        <Static id="Static88" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 696 444 778 449" anchor="left top"/>
        <Button id="btn_deleteFile" taborder="3" text="이미지삭제" onclick="btn_deleteFile_onclick" class="btn_WF_Function" position="absolute 871 444 936 464" anchor="left top"/>
        <Static id="Static24" class="sta_WFDA_Labelbg" position="absolute 681 418 1234 445" anchor="left top"/>
        <Static id="Static25" text="정답" class="sta_WFDA_Label01" position="absolute 681 418 775 445" anchor="left top"/>
        <Edit id="edt_Answer" taborder="22" imemode="hangul" position="absolute 777 421 1229 442" anchor="left top"/>
        <Static id="Static13" text="배점" class="sta_WFDA_Label01" position="absolute 470 418 564 445" anchor="left top"/>
        <MaskEdit id="edt_distribution" taborder="21" mask="##0" autoselect="true" position="absolute 566 421 671 442" anchor="left top" style="background:#ffffffff;border:1 solid #aaaaaaff ;" inputtype="number" maxlength="10"/>
        <Static id="Static26" text="1" class="sta_WFDA_Label01" position="absolute 71 555 93 588" anchor="left top"/>
        <Static id="Static27" text="2" class="sta_WFDA_Label01" position="absolute 71 590 93 623" anchor="left top"/>
        <Static id="Static28" text="3" class="sta_WFDA_Label01" position="absolute 71 622 93 655" anchor="left top"/>
        <Static id="Static29" text="4" class="sta_WFDA_Label01" position="absolute 71 656 93 689" anchor="left top"/>
        <TextArea id="txt_Test01" taborder="18" scrollbars="fixedvert" imemode="hangul" wordwrap="word" position="absolute 96 590 678 622" anchor="left top"/>
        <TextArea id="txt_Test02" taborder="19" scrollbars="fixedvert" imemode="hangul" wordwrap="word" position="absolute 96 623 678 655" anchor="left top"/>
        <TextArea id="txt_Test03" taborder="20" scrollbars="fixedvert" imemode="hangul" wordwrap="word" position="absolute 96 656 678 688" anchor="left top"/>
        <Static id="Static30" text="보기를 등록하지 않은 문제는 주관식입니다." position="absolute 79 690 529 708" anchor="left top"/>
        <Static id="Static31" class="sta_WFDA_Labelbg" position="absolute 0 215 1237 242"/>
        <Static id="Static32" text="동영상링크" class="sta_WFDA_Label01" position="absolute 1 215 97 242"/>
        <Edit id="ed_Link" taborder="14" imemode="alpha" class="edt_WF_Essential" position="absolute 99 218 527 239"/>
        <Static id="Static35" text="최소동영상시청시간" class="sta_WFDA_Label01" position="absolute 529 215 660 242"/>
        <Static id="Static64" text="초" position="absolute 780 223 806 236"/>
        <MaskEdit id="ed_timelimit" taborder="15" mask="#,##0" autoselect="true" position="absolute 661 218 775 239" style="background:#ffffffff;border:1 solid #aaaaaaff ;" inputtype="number" maxlength="10"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_list">
        <ColumnInfo>
          <Column id="DATE_PERIOD" size="16" type="STRING"/>
          <Column id="END_DATE" size="8" type="STRING"/>
          <Column id="FORM_CD" size="20" type="STRING"/>
          <Column id="FORM_NAME" size="100" type="STRING"/>
          <Column id="START_DATE" size="8" type="STRING"/>
          <Column id="TEST_TYPE" size="20" type="STRING"/>
          <Column id="UDATE" size="10" type="STRING"/>
          <Column id="USE_YN" size="1" type="STRING"/>
          <Column id="TYPE_NAME" size="256" type="STRING"/>
          <Column id="CNT" type="BIGDECIMAL" size="256"/>
          <Column id="ATTR01" type="STRING" size="256"/>
          <Column id="ATTR02" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_input">
        <ColumnInfo>
          <Column id="TEST_TYPE" size="256" type="STRING"/>
          <Column id="FORM_CD" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="FORM_CD"/>
            <Col id="TEST_TYPE"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_TEST_TYPE">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Detail1" useclientlayout="true">
        <ColumnInfo>
          <Column id="TEST_TYPE" type="STRING" size="20"/>
          <Column id="FORM_CD" type="STRING" size="20"/>
          <Column id="SEQ" size="3" type="BIGDECIMAL"/>
          <Column id="TEST" size="4000" type="STRING"/>
          <Column id="EXAMPLE1" size="4000" type="STRING"/>
          <Column id="EXAMPLE2" type="STRING" size="256"/>
          <Column id="EXAMPLE3" type="STRING" size="256"/>
          <Column id="EXAMPLE4" type="STRING" size="256"/>
          <Column id="DISTRIBUTION" size="3" type="BIGDECIMAL"/>
          <Column id="ANSWER" size="200" type="STRING"/>
          <Column id="APPEND_FILENM" type="STRING" size="256"/>
          <Column id="SERVER_FILENM" type="STRING" size="256"/>
          <Column id="IMG_FILE" type="BLOB" size="256"/>
          <Column id="ISUPLOAD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Master">
        <ColumnInfo>
          <Column id="DATE_PERIOD" size="16" type="STRING"/>
          <Column id="END_DATE" size="8" type="STRING"/>
          <Column id="FORM_CD" size="20" type="STRING"/>
          <Column id="FORM_NAME" size="100" type="STRING"/>
          <Column id="START_DATE" size="8" type="STRING"/>
          <Column id="TEST_TYPE" size="20" type="STRING"/>
          <Column id="UDATE" size="10" type="STRING"/>
          <Column id="USE_YN" size="1" type="STRING"/>
          <Column id="ATTR01" type="STRING" size="256"/>
          <Column id="ATTR02" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_USE_YN">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">Y</Col>
            <Col id="code_name">사용</Col>
            <Col id="SET1"/>
          </Row>
          <Row>
            <Col id="CODE">N</Col>
            <Col id="code_name">미사용</Col>
            <Col id="SET1"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_in">
        <ColumnInfo>
          <Column id="FORM_CD" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="FORM_CD"/>
          </Row>
        </Rows>
      </Dataset>
      <FileDialog defaultextention="false" filter="All(*.*)|*.*|" filterindex="0" id="fd"/>
    </Objects>
    <Bind>
      <BindItem id="ed_FORM_NAME_value" compid="ed_FORM_NAME" propid="value" datasetid="ds_Master" columnid="FORM_NAME"/>
      <BindItem id="cbo_USE_YN_value" compid="cbo_USE_YN" propid="value" datasetid="ds_Master" columnid="USE_YN"/>
      <BindItem id="me_FROM_DT_value" compid="me_FROM_DT" propid="value" datasetid="ds_Master" columnid="START_DATE"/>
      <BindItem id="me_TO_DT_value" compid="me_TO_DT" propid="value" datasetid="ds_Master" columnid="END_DATE"/>
      <BindItem id="item0" compid="cbo_S_TEST_TYPE00" propid="value" datasetid="ds_Master" columnid="TEST_TYPE"/>
      <BindItem id="item5" compid="edt_Seq" propid="value" datasetid="ds_Detail1" columnid="SEQ"/>
      <BindItem id="item1" compid="txt_Test" propid="value" datasetid="ds_Detail1" columnid="TEST"/>
      <BindItem id="item2" compid="txt_Test00" propid="value" datasetid="ds_Detail1" columnid="EXAMPLE1"/>
      <BindItem id="item3" compid="edt_appendFilenm" propid="value" datasetid="ds_Detail1" columnid="APPEND_FILENM"/>
      <BindItem id="item34" compid="img_viewer" propid="image" datasetid="ds_Detail1" columnid="IMG_FILE"/>
      <BindItem id="item15" compid="edt_Answer" propid="value" datasetid="ds_Detail1" columnid="ANSWER"/>
      <BindItem id="item32" compid="edt_distribution" propid="value" datasetid="ds_Detail1" columnid="DISTRIBUTION"/>
      <BindItem id="item6" compid="txt_Test01" propid="value" datasetid="ds_Detail1" columnid="EXAMPLE2"/>
      <BindItem id="item7" compid="txt_Test02" propid="value" datasetid="ds_Detail1" columnid="EXAMPLE3"/>
      <BindItem id="item8" compid="txt_Test03" propid="value" datasetid="ds_Detail1" columnid="EXAMPLE4"/>
      <BindItem id="item9" compid="ed_Link" propid="value" datasetid="ds_Master" columnid="ATTR01"/>
      <BindItem id="item23" compid="ed_timelimit" propid="value" datasetid="ds_Master" columnid="ATTR02"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 위생관리/문제관리
 * 프로그램명   : FSC91010E.XML
 * 기      능   : 문제관리
 * 작  성  자   : 김명섭
 * 작성  일자   : 2009-07-03
 * 비      고   : 
 *		- ds_input				: [input DS] 조회조건 파라미터 DS
 * ----------------------------------------------------------------------------------------
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"		// X-Framework Lib
//@@컨버터에서 주석처리 #include "LIB::fm_common.js"			// 사업장팝업용 Lib
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var fnCnt;		// 수정가능여부체크용
var bFileUpCheck = false;	// 첨부파일 업로드 체크 여부
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	// 업데이트 DS
	v_ds_check = "ds_Master;ds_Detail1";
	
	// X-Framework : Action 정보 생성 
	fsp_init(this);
	
	//공통코드조회
	var v_fil_cond;
	var v_ds = fn_common_code("'FS9100'","","","blk","Y");

	// 문제유형(ds_TEST_TYPE, GROUP_CODE : 'FS9100')
	v_fil_cond = "GROUP_CODE == 'FS9100'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_TEST_TYPE,v_ds.name);	

	cbo_S_TEST_TYPE.index = 0;
	cbo_S_TEST_TYPE00.enable = false;
}

function frm_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
}
//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_search()
{
	cbo_S_TEST_TYPE00.enable = false;

	ds_input.setColumn(0,"TEST_TYPE",cbo_S_TEST_TYPE.value);
	// 초기화
	ds_list.clearData();
	ds_Master.clearData();
	ds_Detail1.clearData();
	
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	actionName		= "FSC91010E_T001";
	cmdName			= "U_svc::" + "fs/fsc/FSC91010E_T001.jsp";
	inData			= "ds_input=ds_input";
	outData			= "ds_list=ds_list ds_Master=ds_list";
	callBackFnc		= "fn_afterSearchList";
	
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc);
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Insert()
 * 기      능   : [입력버튼] 입력 시 처리되는 작업
 * 비      고	: 팝업사용
 ******************************************************************************************
 */
function fn_insert()
{
	if (gfn_dsIsUpdated(ds_Master)==true || gfn_dsIsUpdated(ds_Detail1)==true)
	{
		g_Message("EE", "변경된 데이터가 있습니다.\n 저장 후 입력해주십시오.");
		return;
	}
	
	if (cbo_S_TEST_TYPE.value == "")
	{
		g_Message("EE", "유형구분을 선택하세요!");
		cbo_S_TEST_TYPE.setFocus();
		return;
	}
	
	var nARow;
	
	fnCnt = 0;
	
	nARow = ds_Master.addRow();
	ds_Master.setColumn(nARow,"TEST_TYPE",cbo_S_TEST_TYPE.value);
	ds_Master.setColumn(nARow,"USE_YN","Y");
	
	ds_Detail1.clearData();
	
	fn_formSetting();
	
	cbo_S_TEST_TYPE00.enable = true;
	ed_FORM_NAME.setFocus();
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Save()
 * 기      능   : [저장버튼] 저장 시 처리되는 작업
 ******************************************************************************************
 */
function fn_save()
{
	// 변경여부 확인
	if(gfn_dsIsUpdated(ds_Master)==false && gfn_dsIsUpdated(ds_Detail1)==false)
	{
		g_Message("EE", "변경된 데이터가 없습니다.");
		return;
	}
	
	//배점계산
	var nTotScore = 0;
	var nRowCnt = ds_Detail1.getRowCount();
	for(var i=0 ; i<nRowCnt ; i++)
	{
		nTotScore = nTotScore + ds_Detail1.getColumn(i,"DISTRIBUTION");
		//정답체크
		if(gfn_isNull(gfn_trim(ds_Detail1.getColumn(i,"ANSWER")," ")))
		{
			var strMsg;
			if(gfn_isNull(ds_Detail1.getColumn(i,"SEQ")))
			{
				strMsg = i + 1 + "번째행 정답이 등록되지 않았습니다.";
			}
			else
			{
				strMsg = ds_Detail1.getColumn(i,"SEQ") + "번 정답이 등록되지 않았습니다.";
			}
			g_Message("EE", strMsg);
			return;
		}
	}
	
	if(nTotScore <> 100)
	{
		g_Message("EE", "배점합이 100이 아닙니다.");
		return;
	}
	
	if(!fn_SaveCheck())
	{
		return;
	}
	
	if (! g_Confirm("01", '저장하시겠습니까?!')) return;

    // 서비스셋팅
    var actionName, cmdName, inData, outData, otherArg, callBackFnc;
    
    if (GetRowType(ds_Master,ds_Master.rowposition)== "insert")
    {
		ds_in.setColumn(0,"FORM_CD",""); 
    }
    else
    {
		ds_in.clearData();
		ds_in.addRow();
		ds_in.setColumn(0,"FORM_CD",ds_Master.getColumn(ds_Master.rowposition,"FORM_CD"));
    }
    
    //trace(ds_Master.saveXML());
    //trace(ds_Detail1.saveXML());
    //trace(ds_in.saveXML());
    //return;
    
	actionName		= "FSC91010E_T003";
	cmdName			= "U_svc::" + "fs/fsc/FSC91010E_T003.jsp";
	inData			= "ds_Master=ds_Master:U ds_Detail1=ds_Detail1:U ds_in=ds_in";
    outData			= "ds_in=ds_in";
    callBackFnc		= "fn_afterSave";
	
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc);
   
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Delete()
 * 기      능   : [삭제버튼] 삭제 시 처리되는 작업
 ******************************************************************************************
 */
function fn_delete()
{
	if(ds_list.getRowCount()==0)
	{
		g_Message("EE", "삭제할 데이터가 없습니다.");
		return;
	}
	
	if (gfn_dsIsUpdated(ds_Master)==true || gfn_dsIsUpdated(ds_Detail1)==true)
	{
		g_Message("EE", "변경된 데이터가 있습니다.\n 저장 후 삭제해십시오.");
		return;
	}
	
	if (toNumber(ds_list.getColumn(ds_list.rowposition,"CNT")) != 0)
	{
		g_Message("EE", "작성된 테스트등록내역이 있습니다.\n확인해 주십시오.");
		return;
	}
	
	var strMsg,btp,nRow,nFRow;
	
	nRow 	= ds_list.rowposition;
	nFRow 	= ds_Master.findRow("FORM_CD",ds_list.getColumn(nRow,"FORM_CD"));
	
	strMsg = "[" + ds_list.getColumn(nRow,"FORM_NAME") + "] " + "를 삭제하시겠습니까?";
	
	// 삭제확인
	if(!g_Confirm("01",strMsg))
	{
		return false;
	}
	
	// Data삭제
	ds_list.deleteRow(nRow);
	ds_Master.deleteRow(nFRow);
	ds_Master.rowposition = -1;
	ds_Detail1.clearData();
	
	// 삭제
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	actionName		= "FSC91010E_T004";
	cmdName			= "U_svc::" + "fs/fsc/FSC91010E_T004.jsp";
	inData			= "ds_Master=ds_Master:U";
	
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc);
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Print()
 * 기      능   : [출력버튼] 출력 시 처리되는 작업
 ******************************************************************************************
 */
function fn_print()
{
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Excel()
 * 기      능   : [엑셀버튼] 엑셀 시 처리되는 작업
 ******************************************************************************************
 */
function fn_Excel()
{
	gfn_exportExcel(grd_Detail, "Sheet1");
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function fn_Close()
{
	this.close();
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Help()
 * 기      능   : [도움말버튼] 도움말
 ******************************************************************************************
 */
function fn_help()
{
	// tit_addSearchActionInfo(this, "fs/fsm:SCC_MENU_SELECT");
	// tit_callService(this, "", "", "ds_cond=ds_cond", "ds_Menu=ds_list", "", "");	
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_SaveCheck()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 저상시 필수입력 체크
 ******************************************************************************************
 */
function fn_SaveCheck()
{
	var nFRow,nRow,strValue,btp,strmsg;
	
	nRow = ds_Master.rowposition;
	
	// 필수 입력 사항 확인 
	if(gfn_length(ds_Master.getColumn(nRow,"TEST_TYPE"))== 0)
	{
		g_Message("EE", "유형구분을 입력해주십시오.");
		cbo_S_TEST_TYPE00.setFocus();
		return false;
	}
	if(gfn_length(ds_Master.getColumn(nRow,"FORM_NAME"))== 0)
	{
		g_Message("EE", "테스트명을 입력해주십시오.");
		ed_FORM_NAME.setFocus();
		return false;
	}
	if(gfn_length(ds_Master.getColumn(nRow,"START_DATE"))== 0)
	{
		g_Message("EE", "사용시작일을 입력해주십시오.");
		me_FROM_DT.setFocus();
		return false;
	}
	if(gfn_length(ds_Master.getColumn(nRow,"ATTR01"))== 0)
	{
		g_Message("EE", "교육동영상 링크주소를  입력해주십시오.");
		ed_Link.setFocus();
		return false;
	}
	if(gfn_length(ds_Master.getColumn(nRow,"ATTR02"))== 0)
	{
		g_Message("EE", "교육동영상 최소시청시간을 입력해주십시오.");
		ed_timelimit.setFocus();
		return false;
	}
	
    return true;
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSearchList()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 ******************************************************************************************
 */
function fn_afterSearchList(errCode, errMsg)
{	
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오");
		return;
	}
	
	ds_Master.copyData(ds_list);
	ds_Master.rowposition = -1;
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSave()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 저장후 실행 함수
 ******************************************************************************************
 */
function fn_afterSave(errCode, errMsg)
{
	cbo_S_TEST_TYPE00.enable = false;
	
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오");
		return;
	}
	else
		g_Message("03", "저장되었습니다.");
	
	fn_search();
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_formSetting()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 화면버튼셋팅
 ******************************************************************************************
 */
function fn_formSetting()
{
	return;
	
	var btp;
	
	if ( fnCnt == 0)
	{
		btp = true;
	}
	else
	{
		btp = false;
	}
	
	btn_input1.enable = btp;
	btn_delete1.enable = btp;
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
 /******************************************************************************************
 * 함  수  명   : grd_List_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
 * 기      능   : 그리드헤드 더블클릭시 Sort
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-18  
 ******************************************************************************************
 */
function grd_List_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	if (obj.name == "grd_list")
	{
		gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
	}
	else
	{
		if (e.cell!=0) return;
		gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : btn_Date_OnClick(obj,nX,nY)
 * 기      능   : 달력
 ******************************************************************************************
 */
function btn_Date_OnClick(obj:Button, e:ClickEventInfo)
{
	var objme = eval(obj.userdata);
	
	var retDate = gfn_dialog("", "U_SCC::SCC_CALENDAR.xfdl","fa_Date="+wrapQuote(objme.value),-1,-1,"Title=false Status=false");
	//gfn_callCalendarPopDiv(objme.value , me_FROM_DT.bottom, me_FROM_DT.bottom);
	objme.value  = retDate;
}


function grd_OnEnterDown(obj:Grid, e:GridEditEventInfo)
{
	//fn_addCode(obj.UserData);
}


function grd_list_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	switch(e.cell)
	{
		case 0:
			gfn_exportExcel(obj, "sheet1");
			break;
        default :
            break;
	}
}

function cbo_S_TEST_TYPE00_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	ds_Detail1.filter("");
    for(var i=0; i<ds_Detail1.getCountNF(); i++)
    {
		ds_Detail1.setColumn(i, "TEST_TYPE", e.postvalue);
    }
    ed_FORM_NAME.setFocus();
    
}

function btn_input1_onclick(obj:Button,  e:ClickEventInfo)
{
	
	var nRow = ds_Detail1.addRow();
	
	ds_Detail1.setColumn(nRow, "TEST_TYPE", ds_Master.getColumn(ds_Master.rowposition,"TEST_TYPE"));
	ds_Detail1.setColumn(nRow, "FORM_CD", ds_Master.getColumn(ds_Master.rowposition,"FORM_CD"));
	
	txt_Test.setFocus();

}

function btn_delete1_onclick(obj:Button,  e:ClickEventInfo)
{
	var nRow,nCnt,strClassCD,strRowtype;

	// 삭제확인
	if(!g_Confirm("01",""))
	{
		return false;
	}

	nRow = ds_Detail1.rowposition;
	strRowtype = GetRowType(ds_Detail1,nRow);
	ds_Detail1.deleteRow(nRow);
	/*
	if (strRowtype!="insert")
	{
		g_Message("EE", "문제삭제 처리 후 배점 조정 작업이 필요합니다.");

		var actionName, cmdName, inData, outData, otherArg, callBackFnc;
		
		actionName		= "FSC91010E_T005";
		cmdName			= "U_svc::" + "fs/fsc/FSC91010E_T005.jsp";
		inData			= "ds_input=ds_input ds_Detail1=ds_Detail1:U";
		outData			= "ds_Detail1=ds_Detail1";
		
		jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc);
	}
	*/
}

function grd_list_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	var strMsg = "변경된 내역이 있습니다. 저장하시겠습니까?\n(취소하신 경우 자료는 초기화됩니다.)";
	var nFRow,strClassType,objds,nARow;

	nFRow = ds_Master.findRowExpr("FORM_CD=='" + ds_list.getColumn(e.row,"FORM_CD") + "'&&TEST_TYPE=='" + ds_list.getColumn(e.row,"TEST_TYPE") + "'");
/*
	if (nFRow != ds_Master.rowposition)
	{
		if (gfn_dsIsUpdated(ds_Master)==true || gfn_dsIsUpdated(ds_Detail1)==true)
		{
			if (g_Confirm("02",strMsg))
			{
				fn_save();
				return;
			}
			else
			{
				ds_Master.reset();
				ds_Detail1.reset();
			}
		}
	}
*/
	
	cbo_S_TEST_TYPE00.enable = false;
	ds_Master.rowposition = nFRow;

	// 초기화
	ds_Detail1.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	nRow = ds_list.rowposition;
	
	ds_input.setColumn(0,"TEST_TYPE",ds_Master.getColumn(nRow,"TEST_TYPE"));
	ds_input.setColumn(0,"FORM_CD",ds_Master.getColumn(nRow,"FORM_CD"));
	
	//trace(ds_input.saveXML());
	//return;
	
	actionName		= "FSC91010E_T002";
	cmdName			= "U_svc::" + "fs/fsc/FSC91010E_T002.jsp";
	inData			= "ds_input=ds_input";
	outData			= "ds_Detail1=ds_Detail1";
	callBackFnc		= "fn_afterSearch";
	
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc);
}

/***************************************************************************
 * 설명   : 서버에 저장된 이미지파일 view
 ***************************************************************************/
function fn_imgFileView()
{
	var imgVal = ds_Detail1.getColumn(ds_Detail1.rowposition, "SERVER_FILENM");
	
    if (!gfn_isNull(imgVal))
    {
		if (ds_Detail1.getColumn(ds_Detail1.rowposition, "ISUPLOAD") == "" || ds_Detail1.getColumn(ds_Detail1.rowposition, "ISUPLOAD") == "undefined" || ds_Detail1.getColumn(ds_Detail1.rowposition, "ISUPLOAD") == null)
		{
		//trace(application.services["svc"].url + "upload/fs/" + imgVal);
			edt_appendFilenm.value = ds_Detail1.getColumn(ds_Detail1.rowposition, "APPEND_FILENM");
			img_viewer.stretch = "fit"; //fixaspectratio, none, fit
			img_viewer.image = application.services["svc"].url + "upload/fs/" + imgVal;
		}
	}
}

function grd_Detail1_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	fn_imgFileView();
}

function grd_Detail1_onkeyup(obj:Grid, e:KeyEventInfo)
{
	fn_imgFileView();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 이미지첨부 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_attachFile_onclick(obj:Button,  e:ClickEventInfo)
{
	var nRowCnt = ds_Detail1.getRowCount();
	
	if(nRowCnt <= 0) return;
	
	if(ds_Detail1.rowposition < 0) return;
	
	var objFD = new FileDialog();
	objFD.defaultextention = true;
	objFD.filter = "image files (*.bmp;*.jpg;*.jpeg;*.gif;*.png)|*.bmp;*.jpg;*.jpeg;*.gif;*.png";

	var objVFile1 = objFD.open("file open", FileDialog.LOAD, "%MYDOCUMENT%");

	if (objVFile1) 
	{
		objVFile1.open(VirtualFile.openRead | VirtualFile.openBinary);
	} 
	else 
	{
		return false;
	}

	// 파일크기 100KB 제한
// 	if (objVFile1.getFileSize() > 100000) 
// 	{
// 		gfn_alert("파일크기가 100KB를 초과하였습니다!", "", "A");
// 		return;
// 	}
	ds_Detail1.setColumn(ds_Detail1.rowposition, "APPEND_FILENM", objVFile1.filename);

	img_viewer.stretch = "fit";	//fixaspectratio, none, fit
	img_viewer.image = objVFile1.fullpath;
	//trace(objVFile1.fullpath);
	//trace(objVFile1.getFileSize());
	//trace(ds_Detail1.rowposition);

	ds_Detail1.setColumn(ds_Detail1.rowposition, "IMG_FILE", objVFile1.read(objVFile1.getFileSize()));
	ds_Detail1.setColumn(ds_Detail1.rowposition, "ISUPLOAD", "Y");
	//trace(ds_Detail1.saveXML());
	
	//trace(ds_Detail1.getColumn(ds_Detail1.rowposition, "IMG_FILE"));
	//trace(ds_Detail1.getColumn(ds_Detail1.rowposition, "ISUPLOAD"));

    bFileUpCheck = true;
    objVFile1.close();
}

function btn_deleteFile_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_Detail1.rowposition < 0) return;
	ds_Detail1.setColumn(ds_Detail1.rowposition,"APPEND_FILENM","");
	ds_Detail1.setColumn(ds_Detail1.rowposition,"SERVER_FILENM","");
	ds_Detail1.setColumn(ds_Detail1.rowposition,"IMG_FILE","");
}

function fn_afterSearch(errCode, errMsg)
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오");
		return;
	}
	
	fnCnt = toNumber(ds_Master.getColumn(ds_Master.rowposition,"CNT"));

	var nRowCnt = ds_Detail1.getRowCount();
	for(var i=0 ; i<nRowCnt ; i++)
	{
		ds_Detail1.setColumn(i,"IMG_FILE","");
		ds_Detail1.setColumn(i,"ISUPLOAD","");
	}
	
	fn_imgFileView();
	
	fn_formSetting();
}]]></Script>
  </Form>
</FDL>

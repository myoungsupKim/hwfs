<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="GuideCTI_new" classname="GuideCTI_new" inheritanceid="" position="absolute 0 0 1024 768" titletext="New Form" onload="GuideCTI_new_onload">
    <Layouts>
      <Layout>
        <Static id="Static49" class="sta_WFDA_Labelbg" position="absolute 21 134 761 161" anchor="left top"/>
        <Static id="Static31" text="Label Title" class="sta_WFDA_Labelbg" position="absolute 21 160 761 187" anchor="left top"/>
        <Static id="Static67" class="sta_WFDA_Labelbg" position="absolute 21 186 761 213" anchor="left top"/>
        <Static id="Static16" class="sta_WFDA_Labelbg" position="absolute 21 212 761 239" anchor="left top"/>
        <ActiveX id="WebPBX" position="absolute 24 14 38 29" useautobitmapcache="1" anchor="default" taborder="0" OnActivate="WebPBX_OnActivate" OnAfterMonitorDpiChanged="WebPBX_OnAfterMonitorDpiChanged" OnBeforeMonitorDpiChanged="WebPBX_OnBeforeMonitorDpiChanged" OnBLFNotified="WebPBX_OnBLFNotified" OnCallAnswer="WebPBX_OnCallAnswer" OnCallDialing="WebPBX_OnCallDialing" OnCallDisconnect="WebPBX_OnCallDisconnect" OnCallIncoming="WebPBX_OnCallIncoming" OnCallRecorded="WebPBX_OnCallRecorded" OnCallRecordFailed="WebPBX_OnCallRecordFailed" OnCallRinging="WebPBX_OnCallRinging" OnCallStatus="WebPBX_OnCallStatus" OnClick="WebPBX_OnClick" OnCreate="WebPBX_OnCreate" OnDblClick="WebPBX_OnDblClick" OnDeactivate="WebPBX_OnDeactivate" OnDestroy="WebPBX_OnDestroy" OnKeyPress="WebPBX_OnKeyPress" onkillfocus="WebPBX_onkillfocus" OnMouseEnter="WebPBX_OnMouseEnter" OnMouseLeave="WebPBX_OnMouseLeave" OnMsgReceived="WebPBX_OnMsgReceived" OnPaint="WebPBX_OnPaint" OnRequestResult="WebPBX_OnRequestResult" OnSessionResult="WebPBX_OnSessionResult" onsetfocus="WebPBX_onsetfocus" progid="{299A7F9F-9B16-4DAB-8C7F-679CF82185D3}"/>
        <Static id="Static41" text="콜아이디" class="sta_WFDA_Label01" position="absolute 21 134 115 161" anchor="left top"/>
        <Static id="Static43" text="서버IP" class="sta_WFDA_Label01" position="absolute 21 186 115 213" anchor="left top"/>
        <Static id="Static44" text="전화걸기" class="sta_WFDA_Label01" position="absolute 21 212 115 239" anchor="left top"/>
        <Edit id="edt_tel" taborder="1" position="absolute 117 215 266 236" anchor="left top" value="01026673721"/>
        <Edit id="edt_servIp" taborder="2" position="absolute 117 189 266 210" anchor="left top" value="172.25.6.91"/>
        <Edit id="edt_callId" taborder="3" position="absolute 117 137 266 158" anchor="left top" value="9302"/>
        <Static id="Static42" text="비밀번호" class="sta_WFDA_Label01" position="absolute 21 160 115 187" anchor="left top"/>
        <Edit id="edt_passwd" taborder="4" position="absolute 117 163 266 184" anchor="left top" value="skb_2039()"/>
        <Static id="Static00" class="sta_WFDA_Labelbg" position="absolute 21 238 761 265" anchor="left top"/>
        <Static id="Static01" text="돌려주기" class="sta_WFDA_Label01" position="absolute 21 238 115 265" anchor="left top"/>
        <Edit id="edt_trans" taborder="5" position="absolute 117 241 266 262" anchor="left top" value="6209"/>
        <Static id="Static02" class="sta_WFDA_Labelbg" position="absolute 21 264 761 325" anchor="left top"/>
        <Button id="btn_call" taborder="6" text="전화걸기" class="btn_WF_CRUD" position="absolute 268 214 376 237" onclick="btn_call_onclick"/>
        <Button id="btn_trans" taborder="7" text="전화돌려주기" class="btn_WF_CRUD" position="absolute 268 238 376 261" onclick="btn_trans_onclick"/>
        <Button id="btn_connect" taborder="8" text="서버접속" class="btn_WF_CRUD" position="absolute 24 266 132 289" onclick="btn_connect_onclick"/>
        <Button id="btn_disconnect" taborder="9" text="서버접속종료" class="btn_WF_CRUD" position="absolute 136 266 244 289" onclick="btn_disconnect_onclick"/>
        <Button id="btn_doAnswer" taborder="10" text="통화" class="btn_WF_CRUD" position="absolute 248 266 356 289" onclick="btn_doAnswer_onclick"/>
        <Button id="btn_doHangup" taborder="11" text="통화종료" class="btn_WF_CRUD" position="absolute 360 266 468 289" onclick="btn_doHangup_onclick"/>
        <Button id="btn_doDone" taborder="12" text="인바운드후처리완료" class="btn_WF_CRUD" position="absolute 472 266 612 289" onclick="btn_doDone_onclick"/>
        <Button id="btn_doRest" taborder="13" text="상담원휴식" class="btn_WF_CRUD" position="absolute 24 298 132 321" onclick="btn_doRest_onclick"/>
        <Button id="btn_doEdu" taborder="14" text="상담원교육" class="btn_WF_CRUD" position="absolute 136 298 244 321" onclick="btn_doEdu_onclick"/>
        <Button id="btn_doMeet" taborder="15" text="상담원회의" class="btn_WF_CRUD" position="absolute 360 298 468 321" onclick="btn_doMeet_onclick"/>
        <Button id="btn_doMeal" taborder="16" text="상담원식사" class="btn_WF_CRUD" position="absolute 248 298 356 321" onclick="btn_doMeal_onclick"/>
        <Button id="btn_doEtc" taborder="17" text="기타" class="btn_WF_CRUD" position="absolute 472 298 580 321" onclick="btn_doEtc_onclick"/>
        <TextArea id="txt_msg" taborder="18" position="absolute 20 347 760 528"/>
        <Button id="btn_doObAfter" taborder="19" text="아웃바운드후처리완료" class="btn_WF_CRUD" position="absolute 616 266 756 289" onclick="btn_doObAfter_onclick"/>
        <Static id="Static03" class="sta_WFDA_Labelbg" position="absolute 21 108 761 135" anchor="left top"/>
        <Static id="Static04" text="포트" class="sta_WFDA_Label01" position="absolute 21 108 115 135" anchor="left top"/>
        <Edit id="edt_port" taborder="21" value="8043" position="absolute 117 111 266 132" anchor="left top"/>
        <Static id="Static05" class="sta_WFDA_Labelbg" position="absolute 21 82 761 109" anchor="left top"/>
        <Static id="Static06" text="그룹번호" class="sta_WFDA_Label01" position="absolute 21 82 115 109" anchor="left top"/>
        <Edit id="edt_group" taborder="22" value="2000" position="absolute 117 85 266 106" anchor="left top"/>
      </Layout>
    </Layouts>
    <Script type="xscript4.0"><![CDATA[function GuideCTI_new_onload(obj:Form, e:LoadEventInfo) {
	fn_setInit(true);
}

function fn_setInit(bEnable) {
	btn_connect.enable = bEnable;
	btn_disconnect.enable = !bEnable;
	btn_doAnswer.enable = !bEnable;
	btn_doHangup.enable = !bEnable;
	btn_doObAfter.enable = !bEnable;
	btn_doRest.enable = !bEnable;
	btn_doDone.enable = !bEnable;
	btn_doEdu.enable = !bEnable;
	btn_doMeal.enable = !bEnable;
	btn_doMeet.enable = !bEnable;
	btn_doEtc.enable = !bEnable;
	btn_call.enable = !bEnable;
	btn_trans.enable = !bEnable;
}

// action master
function fn_actionPBX( sMode, nNum, oParam ) {

	if ( sMode != "Connect" && WebPBX.IsConnected == 0 ) {
		//alert("연결상태가 아닙니다.");
		//return;
	} 
	
	switch ( sMode ) {
		case "Connect" :
			
			WebPBX.AppServer = "172.25.5.186";							//애플리케이션 서버 주소 - 
			WebPBX.Port = edt_port.value;
			WebPBX.AutoCallAfter = true;								//콜통화후 자동 후처리(true:자동처리, false:미처리)
			WebPBX.PBXServer = edt_servIp.value;						//PBXServer IP 설정 - 172.25.6.91
			WebPBX.DoLogon(edt_callId.value, edt_passwd.value);			//서버에 연결(콜아이디 , 콜비밀번호)
			WebPBX.Group = edt_group.value;								//그룹설정(외식:2000, 급식:3000)
			break;
			
		case "Disconnect" :
			WebPBX.DoLogout();
			break;
			
		case "DoDial" :
			WebPBX.DialNum = nNum;
			WebPBX.DoDial();
			//WebPBX.Dial(edt_tel.value);
			break;
			
		case "DoAnswer" :
			WebPBX.DoAnswer();
			break;
		
		case "DoHangup" :
			WebPBX.DoHangup();
			break;
		
		case "DoTransfer" :
			WebPBX.DoTransfer(nNum);
			break;
			
		case "DoDone" :
			WebPBX.DoDone();
			break;
			
		case "DoObAfter" :
			WebPBX.DoObAfter();
			break;
			
		case "DoRest" :
			WebPBX.DoRest();
			break;
			
		case "DoEdu" :
			WebPBX.DoEdu();
			break;
			
		case "DoMeal" :
			WebPBX.DoMeal();
			break;
			
		case "DoMeet" :
			WebPBX.DoMeet();
			break;
			
		case "DoEtc" :
			WebPBX.DoEtc();
			break;
	}
}


// dail
function btn_call_onclick(obj:Button,  e:ClickEventInfo) {
	fn_actionPBX("DoDial", edt_tel.value);
}

// transfer
function btn_trans_onclick(obj:Button,  e:ClickEventInfo) {
	fn_actionPBX("DoTransfer", edt_trans.value);
}

// connect
function btn_connect_onclick(obj:Button,  e:ClickEventInfo) {
	fn_actionPBX("Connect");
}

// disconnect
function btn_disconnect_onclick(obj:Button,  e:ClickEventInfo) {
	fn_actionPBX("Disconnect");
}

// answer
function btn_doAnswer_onclick(obj:Button,  e:ClickEventInfo) {
	fn_actionPBX("DoAnswer");
}

// hangup
function btn_doHangup_onclick(obj:Button,  e:ClickEventInfo) {
	fn_actionPBX("DoHangup");
}

// done
function btn_doDone_onclick(obj:Button,  e:ClickEventInfo) {
	fn_actionPBX("DoDone");
}

// doObAfter
function btn_doObAfter_onclick(obj:Button,  e:ClickEventInfo) {
	fn_actionPBX("DoAnswer");
}

// doRest
function btn_doRest_onclick(obj:Button,  e:ClickEventInfo) {
	fn_actionPBX("DoRest");
}

// doEdu
function btn_doEdu_onclick(obj:Button,  e:ClickEventInfo) {
	fn_actionPBX("DoEdu");
}

// doMeal
function btn_doMeal_onclick(obj:Button,  e:ClickEventInfo) {
	fn_actionPBX("DoMeal");
}

// doMeet
function btn_doMeet_onclick(obj:Button,  e:ClickEventInfo) {
	fn_actionPBX("DoMeet");
}

// doEtc
function btn_doEtc_onclick(obj:Button,  e:ClickEventInfo) {
	fn_actionPBX("DoEtc");
}

function WebPBX_OnRequestResult(obj:ActiveX, e) {
	trace("## WebPBX_OnRequestResult ##");
	for (var p in e ) {
		trace("["+p +"]="+ e[p]);
	}
	
}

function WebPBX_OnSessionResult(obj:ActiveX, e) {
	trace("## WebPBX_OnSessionResult ##");
	for (var p in e ) {
		trace("["+p +"]="+ e[p]);
	}

	txt_msg.value = "[result]"+e.result+"\r\n[result_msg]"+e.result_msg;
	
	if ( e.result == 12292 ) {
		fn_setInit(false);
	} else if ( e.result == 12293 ) {
		fn_setInit(false);
	}
}

function WebPBX_OnCallStatus(obj:ActiveX, e) {
	trace("## WebPBX_OnCallStatus ##");
	for (var p in e ) {
		trace("["+p +"]="+ e[p]);
	}
	
	txt_msg.value = "[status]"+e.status+"\r\n[value]"+e.value;
}

function WebPBX_OnCallDialing(obj:ActiveX, e) {
	trace("## WebPBX_OnCallDialing ##");
	for (var p in e ) {
		trace("["+p +"]="+ e[p]);
	}
}

function WebPBX_OnActivate(obj:ActiveX) {
	trace("## WebPBX_OnActivate ##");
}

function WebPBX_OnAfterMonitorDpiChanged(obj:ActiveX, e) {
	trace("## WebPBX_OnAfterMonitorDpiChanged ##");
}

function WebPBX_OnBeforeMonitorDpiChanged(obj:ActiveX, e) {
	trace("## WebPBX_OnBeforeMonitorDpiChanged ##");
}

function WebPBX_OnBLFNotified(obj:ActiveX, e) {
	trace("## WebPBX_OnBLFNotified ##");
}

function WebPBX_OnCallAnswer(obj:ActiveX, e) {
	trace("## WebPBX_OnCallAnswer ##");
	for (var p in e ) {
		trace("["+p +"]="+ e[p]);
	}
}

function WebPBX_OnCallDisconnect(obj:ActiveX, e) {
	trace("## WebPBX_OnCallDisconnect ##");
	for (var p in e ) {
		trace("["+p +"]="+ e[p]);
	}
}

function WebPBX_OnCallIncoming(obj:ActiveX, e) {
	trace("## WebPBX_OnCallIncoming ##");
	for (var p in e ) {
		trace("["+p +"]="+ e[p]);
	}
}

function WebPBX_OnCallRecorded(obj:ActiveX, e) {
	trace("## WebPBX_OnCallRecorded ##");
	for (var p in e ) {
		trace("["+p +"]="+ e[p]);
	}
}

function WebPBX_OnCallRecordFailed(obj:ActiveX, e) {
	trace("## WebPBX_OnCallRecordFailed ##");
}

function WebPBX_OnCallRinging(obj:ActiveX, e) {
	trace("## WebPBX_OnCallRinging ##");
	for (var p in e ) {
		trace("["+p +"]="+ e[p]);
	}
}

function WebPBX_OnClick(obj:ActiveX) {
	trace("## WebPBX_OnClick ##");
}

function WebPBX_OnCreate(obj:ActiveX) {
	trace("## WebPBX_OnCreate ##");
}

function WebPBX_OnDblClick(obj:ActiveX) {
	trace("## WebPBX_OnDblClick ##");
}

function WebPBX_OnDeactivate(obj:ActiveX) {
	trace("## WebPBX_OnDeactivate ##");
}

function WebPBX_OnDestroy(obj:ActiveX) {
	trace("## WebPBX_OnDestroy ##");
}

function WebPBX_OnKeyPress(obj:ActiveX, e) {
	trace("## WebPBX_OnKeyPress ##");
}

function WebPBX_onkillfocus(obj:ActiveX, e:KillFocusEventInfo) {
	trace("## WebPBX_onkillfocus ##");
}

function WebPBX_OnMouseEnter(obj:ActiveX) {
	trace("## WebPBX_OnMouseEnter ##");
}

function WebPBX_OnMouseLeave(obj:ActiveX) {
	trace("## WebPBX_OnMouseLeave ##");
}

function WebPBX_OnMsgReceived(obj:ActiveX, e) {
	trace("## WebPBX_OnMsgReceived ##");
}

function WebPBX_OnPaint(obj:ActiveX) {
	trace("## WebPBX_OnPaint ##");
}

function WebPBX_onsetfocus(obj:ActiveX, e:SetFocusEventInfo) {
	trace("## WebPBX_onsetfocus ##");
}]]></Script>
  </Form>
</FDL>

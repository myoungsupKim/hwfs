<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="btn_DetailView" onkeydown="fn_form_OnKeyDown" onload="form_onload" titletext="입금등록" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="sta_detail00" class="sta_WFDA_Labelbg" position="absolute 544 138 629 165"/>
        <Static id="st_ACNTCD" text="계좌번호" class="sta_WFDA_Label01" position="absolute 0 138 80 165" userdata="strMAQuery_ACNTCD"/>
        <Static id="sta_detail14" class="sta_WFDA_Labelbg" position="absolute 854 86 1237 113"/>
        <Static id="sta_detail15" class="sta_WFDA_Labelbg" position="absolute 854 112 1237 139"/>
        <Static id="sta_detail16" class="sta_WFDA_Labelbg" position="absolute 854 138 1237 165"/>
        <Static id="sta_detail11" class="sta_WFDA_Labelbg" position="absolute 623 86 776 113"/>
        <Static id="sta_detail12" class="sta_WFDA_Labelbg" position="absolute 623 112 776 139"/>
        <Static id="sta_detail13" class="sta_WFDA_Labelbg" position="absolute 691 138 776 165"/>
        <Static id="sta_detail08" class="sta_WFDA_Labelbg" position="absolute 356 86 545 113"/>
        <Static id="sta_detail09" class="sta_WFDA_Labelbg" position="absolute 356 112 545 139"/>
        <Static id="sta_detail10" class="sta_WFDA_Labelbg" position="absolute 356 138 482 165"/>
        <Static id="sta_detail07" class="sta_WFDA_Labelbg" position="absolute 79 138 278 165"/>
        <Static id="sta_detail06" class="sta_WFDA_Labelbg" position="absolute 79 112 278 139"/>
        <Static id="sta_detail05" class="sta_WFDA_Labelbg" position="absolute 79 86 278 113"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static9" text="입금등록일자" position="absolute 278 40 368 61" class="sta_WFSA_label"/>
        <Static id="st_RCP_TYPE" text="입금유형" userdata="strMAQuery_UPJANG_TYPE_CD" position="absolute 0 86 80 113" class="sta_WFDA_Label01"/>
        <Static id="st_PRICE" text="단가" position="absolute 544 112 624 139" class="sta_WFDA_Label01"/>
        <Static id="st_RCP_DESC" text="적요" position="absolute 277 138 357 165" class="sta_WFDA_Label01"/>
        <Static id="st_SUBINV_CODE" text="창고" userdata="strMAQuery_SUBINV_CODE" position="absolute 277 86 357 113" class="sta_WFDA_Label01"/>
        <Static id="st_QTY" text="식수" position="absolute 277 112 357 139" class="sta_WFDA_Label01"/>
        <Static id="st_CUSTCD" text="고 객 사" userdata="strMAQuery_UPJANG_CUST" position="absolute 544 86 624 113" class="sta_WFDA_Label01"/>
        <Static id="st_AMT" text="금액" position="absolute 0 112 80 139" class="sta_WFDA_Label01"/>
        <Static id="st_TICKET_SEQ" text="식권차수" position="absolute 775 138 855 165" class="sta_WFDA_Label01"/>
        <Static id="st_RCP_ID" text="입금코드" position="absolute 775 86 855 113" class="sta_WFDA_Label01"/>
        <Static id="st_FEE" text="수수료" position="absolute 775 112 855 139" class="sta_WFDA_Label01"/>
        <Static id="st_ADITEM1" text="식구분" userdata="strMAQuery_MGUBUN" position="absolute 481 138 545 165" class="sta_WFDA_Label01"/>
        <MaskEdit id="me_RCP_DATE" mask="####-##-##" ontextchanged="me_RCP_DATE_OnChanged" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="2" type="string" position="absolute 373 40 451 61" class="msk_WF_EssentialCal"/>
        <Button id="edtBtn_Date" onclick="edtBtn_Date_OnClick" taborder="17" tabstop="false" position="absolute 450 40 471 61" class="btn_WF_popSearchEssential" text="" image=""/>
        <Edit autoselect="true" id="edt_RCP_TYPE" imemode="none" onkeydown="edt_RCP_TYPE_OnKeyDown" readonly="true" taborder="3" position="absolute 82 89 255 110" class="edt_WF_Essential"/>
        <Button id="edtBtn_RCP_TYPE" onclick="edtBtn_RCP_TYPE_OnClick" taborder="18" tabstop="false" position="absolute 254 89 275 110" class="btn_WF_popSearchEssential" text="" image=""/>
        <Edit autoselect="true" id="edt_SUBINV_CODE" onkeydown="edt_RCP_TYPE_OnKeyDown" readonly="true" taborder="4" position="absolute 359 89 522 110" class="edt_WF_Essential"/>
        <Button id="edtBtn_SUBINV_CODE" onclick="edtBtn_RCP_TYPE_OnClick" taborder="19" tabstop="false" position="absolute 521 89 542 110" class="btn_WF_popSearchEssential" text="" image=""/>
        <Edit autoselect="true" id="edt_CUSTCD" onkeydown="edt_RCP_TYPE_OnKeyDown" readonly="true" taborder="5" position="absolute 626 89 753 110" class="edt_WF_Essential"/>
        <Button id="edtBtn_CUSTCD" onclick="edtBtn_RCP_TYPE_OnClick" taborder="20" tabstop="false" position="absolute 752 89 773 110" class="btn_WF_popSearchEssential" text="" image=""/>
        <Edit autoselect="true" enable="false" id="edt_TICKET_SEQ" readonly="true" taborder="14" position="absolute 857 141 945 162" class="edt_WF_Essential"/>
        <Button enable="false" id="edtBtn_TICKET_SEQ" onclick="edtBtn_TICKET_SEQ_OnClick" taborder="21" tabstop="false" position="absolute 944 141 965 162" class="btn_WF_popSearchEssential" text="" image=""/>
        <Edit enable="false" id="edt_RCP_ID" readonly="true" taborder="22" position="absolute 857 89 966 110"/>
        <Edit autoselect="true" lengthunit="asciii" id="edt_RCP_DESC" imemode="native" maxlength="100" onkeydown="edt_RCP_DESC_OnKeyDown" taborder="11" position="absolute 359 141 479 162" class="edt_WF_Essential"/>
        <MaskEdit enable="false" id="me_PRICE" mask="###,##0" taborder="8" value="MaskEdit00" position="absolute 626 115 773 136" class="msk_WF_Essential"/>
        <MaskEdit id="me_QTY" mask="###,##0" taborder="7" value="MaskEdit00" position="absolute 359 115 542 136" class="msk_WF_Essential"/>
        <MaskEdit id="edt_AMT" mask="###,##0" onkeydown="edt_RCP_TYPE_OnKeyDown" readonly="true" taborder="6" value="MaskEdit00" position="absolute 82 115 255 136" class="msk_WF_Essential"/>
        <Edit autoselect="true" id="edt_ADITEM1" imemode="none" onkeydown="edt_ADITEM1_OnKeyDown" readonly="true" taborder="12" position="absolute 547 141 606 162" class="edt_WF_Essential"/>
        <Button id="edtBtn_ADITEM1" onclick="edtBtn_RCP_TYPE_OnClick" taborder="23" tabstop="false" position="absolute 605 141 626 162" class="btn_WF_popSearchEssential" text="" image=""/>
        <Static id="Static0" text="[단위:식,원,VAT포함]" position="absolute 499 45 626 58"/>
        <CheckBox id="chk_Auto" taborder="25" text="자동저장기능" position="absolute 660 41 767 59" value="true"/>
        <MaskEdit id="me_FEE" mask="###,##0" taborder="9" value="MaskEdit00" position="absolute 857 115 966 136"/>
        <Edit autoselect="true" enable="false" id="edt_ACNTCD" imemode="none" onkeydown="edt_RCP_TYPE_OnKeyDown" readonly="true" taborder="10" position="absolute 82 141 255 162" class="edt_WF_Essential"/>
        <Button enable="false" id="edtBtn_ACNTCD" onclick="edtBtn_RCP_TYPE_OnClick" taborder="26" tabstop="false" position="absolute 254 141 275 162" class="btn_WF_popSearchEssential" text="" image=""/>
        <Button enable="false" id="edtBtn_AMT" onclick="edtBtn_AMT_OnClick" taborder="27" tabstop="false" position="absolute 254 115 275 136" class="btn_WF_popSearchEssential" text="" image=""/>
        <Button id="btn_DetailCMS" onclick="btn_DetailCMS_OnClick" taborder="28" text="CMS조회" position="absolute 1021 40 1120 61" class="btn_WF_Custom" image=""/>
        <Grid autoenter="select" binddataset="ds_list" cellsizingtype="both" readonly="false" enable="true" cellsizebandtype="allband" id="grid_List" useinputpanel="false" onexpanddown="grid_List_OnExpandEdit" onheadclick="grid_List_OnHeadClick" taborder="24" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 180 1237 710" selecttype="row" autofittype="col" anchor="all">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="36"/>
                <Column size="163"/>
                <Column size="105"/>
                <Column size="200"/>
                <Column size="144"/>
                <Column size="64"/>
                <Column size="46"/>
                <Column size="76"/>
                <Column size="46"/>
                <Column size="106"/>
                <Column size="39"/>
                <Column size="39"/>
                <Column size="39"/>
                <Column size="39"/>
                <Column size="39"/>
                <Column size="39"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="입금유형"/>
                <Cell col="2" displaytype="text" text="창고"/>
                <Cell col="3" displaytype="text" text="고객사"/>
                <Cell col="4" displaytype="text" text="계좌번호"/>
                <Cell col="5" displaytype="text" text="단가"/>
                <Cell col="6" displaytype="text" text="식수"/>
                <Cell col="7" displaytype="text" text="금액"/>
                <Cell col="8" displaytype="text" text="수수료"/>
                <Cell col="9" displaytype="text" text="적요"/>
                <Cell col="10" displaytype="text" text="매출"/>
                <Cell col="11" displaytype="text" text="대체"/>
                <Cell col="12" displaytype="text" text="CMS"/>
                <Cell col="13" displaytype="text" text="수입금"/>
                <Cell col="14" displaytype="text" text="자동"/>
                <Cell col="15" displaytype="text" text="마감"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:TYPE_NAME"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:SUBINV_CODENM"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:CUSTCDNM"/>
                <Cell col="4" displaytype="text" style="align:left;" text="bind:ACNTCD"/>
                <Cell col="5" displaytype="number" style="align:left;" text="bind:PRICE"/>
                <Cell col="6" displaytype="number" style="align:left;" text="bind:QTY"/>
                <Cell col="7" displaytype="number" style="align:left;" text="bind:AMT"/>
                <Cell col="8" displaytype="number" style="align:left;" text="bind:FEE"/>
                <Cell col="9" displaytype="text" style="align:left;" text="bind:RCP_DESC"/>
                <Cell col="10" displaytype="text" style="align:center;background:EXPR(fn_GetBackColorClose(&quot;1&quot;, CROSS_YN));background2:EXPR(fn_GetBackColorClose(&quot;2&quot;, CROSS_YN));" text="bind:TRX_YN" expandshow="expr:iif(TRX_YN=='Y', 'True', 'False')"/>
                <Cell col="11" displaytype="text" style="align:center;background:EXPR(fn_GetBackColorClose(&quot;1&quot;, SUBST_YN));background2:EXPR(fn_GetBackColorClose(&quot;2&quot;, SUBST_YN));" text="bind:SUBST_YN" expandshow="expr:iif(SUBST_YN=='Y', 'True', 'False')"/>
                <Cell col="12" displaytype="text" style="align:center;" text="bind:CMS_YN" expandshow="expr:iif(CMS_YN=='Y', 'True', 'False')"/>
                <Cell col="13" displaytype="text" style="align:center;background:EXPR(fn_GetBackColorClose(&quot;1&quot;, RMT_YN));background2:EXPR(fn_GetBackColorClose(&quot;2&quot;, RMT_YN));" text="bind:RMT_YN" expandshow="expr:iif(RMT_YN=='Y', 'True', 'False')"/>
                <Cell col="14" displaytype="text" style="align:center;background:EXPR(fn_GetBackColorClose(&quot;1&quot;, AUTO_YN));background2:EXPR(fn_GetBackColorClose(&quot;2&quot;, AUTO_YN));" text="bind:AUTO_YN" expandshow="expr:iif(AUTO_YN=='Y', 'True', 'False')"/>
                <Cell col="15" displaytype="text" style="align:center;background:EXPR(fn_GetBackColorClose(&quot;1&quot;, CLS_YN));background2:EXPR(fn_GetBackColorClose(&quot;2&quot;, CLS_YN));" text="bind:CLS_YN"/>
              </Band>
              <Band id="summary">
                <Cell style="align:left;"/>
                <Cell col="1" colspan="5" style="align:center;" text="합계"/>
                <Cell col="6" displaytype="number" style="align:left;" expr="expr:getSum('QTY')"/>
                <Cell col="7" displaytype="number" style="align:left;" expr="expr:getSum('AMT')"/>
                <Cell col="8" displaytype="number" style="align:left;" expr="expr:getSum('FEE')"/>
                <Cell col="9" colspan="7" style="align:left;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="st_ADITEM2" text="카드사" userdata="strMAQuery_CARD_COMPANY" position="absolute 628 138 692 165" class="sta_WFDA_Label01"/>
        <Edit autoselect="true" id="edt_ADITEM2" imemode="none" onkeydown="edt_ADITEM2_OnKeyDown" readonly="true" taborder="13" position="absolute 694 141 753 162" class="edt_WF_Essential"/>
        <Button id="edtBtn_ADITEM2" onclick="edtBtn_RCP_TYPE_OnClick" taborder="38" tabstop="false" position="absolute 752 141 773 162" class="btn_WF_popSearchEssential" text="" image=""/>
        <Static id="st_SuspenseYN" position="absolute 1 688 970 704"/>
        <Button id="Button0" onclick="fn_Exl_Import" taborder="66" text="입금엑셀등록" position="absolute 1122 40 1221 61" class="btn_WF_Custom" image=""/>
        <MPFileDialog id="fd_Excel" taborder="66" position="absolute 1260 41 1284 65"/>
        <Static id="st_UPJANGQuery" text="업장" class="sta_WFSA_label" position="absolute 16 40 86 61" userdata="strMAQuery_Upjang"/>
        <Edit id="edt_UPJANGQuery" taborder="67" readonly="true" onkeydown="edt_UPJANGQuery_OnKeyDown" ontextchanged="edt_UPJANGQuery_OnChanged" class="edt_WF_Essential" position="absolute 59 40 228 61"/>
        <Button id="edtBtn_UPJANGQuery" taborder="69" tabstop="false" onclick="edtBtn_UPJANGQuery_OnClick" class="btn_WF_popSearchEssential" position="absolute 227 40 248 61"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="73" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 93 40"/>
        <Static id="Static09" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 93 71"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61"/>
        <Static id="Static10" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 248 40 278 61"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 49 40 59 61"/>
        <Static id="Static02" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 363 40 373 61"/>
        <Static id="Static03" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 471 40 501 61"/>
        <Static id="Static16" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 165 450 180"/>
        <Static id="Static01" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1221 39 1236 60"/>
        <Static id="Static04" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 71 1252 86" anchor="left bottom"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond"/>
      <Dataset id="ds_Type">
        <ColumnInfo>
          <Column id="ADITEM1_CD" size="20" type="STRING"/>
          <Column id="ADITEM1_CDNM" size="100" type="STRING"/>
          <Column id="ADITEM1_CHK_YN" size="20" type="STRING"/>
          <Column id="ADITEM1_CHK_YNNM" size="100" type="STRING"/>
          <Column id="ADITEM2_CD" size="20" type="STRING"/>
          <Column id="ADITEM2_CDNM" size="100" type="STRING"/>
          <Column id="ADITEM2_CHK_YN" size="20" type="STRING"/>
          <Column id="ADITEM2_CHK_YNNM" size="100" type="STRING"/>
          <Column id="ALL_YN" size="20" type="STRING"/>
          <Column id="AUTO_AMT_YN" size="20" type="STRING"/>
          <Column id="BIZ_CHK_YN" size="20" type="STRING"/>
          <Column id="BIZ_CHK_YNNM" size="100" type="STRING"/>
          <Column id="BOND_CHK_YN" size="20" type="STRING"/>
          <Column id="CMP_ACCTCD" size="20" type="STRING"/>
          <Column id="CMP_ACCTCDNM" size="60" type="STRING"/>
          <Column id="CMP_AUTO_YN" size="20" type="STRING"/>
          <Column id="CMP_CLASS" size="20" type="STRING"/>
          <Column id="CMP_CLASSNM" size="100" type="STRING"/>
          <Column id="CMP_GRP" size="20" type="STRING"/>
          <Column id="CMP_GRPNM" size="100" type="STRING"/>
          <Column id="CMP_SPLS_ACCTCD" size="20" type="STRING"/>
          <Column id="CMP_SPLS_ACCTCDNM" size="60" type="STRING"/>
          <Column id="CMP_SPLS_YN" size="20" type="STRING"/>
          <Column id="CMP_TYPE" size="20" type="STRING"/>
          <Column id="CMP_TYPENM" size="200" type="STRING"/>
          <Column id="CR_ACCTCD" size="20" type="STRING"/>
          <Column id="CR_ACCTCDNM" size="60" type="STRING"/>
          <Column id="CUST_CHK_YN" size="20" type="STRING"/>
          <Column id="CUST_CHK_YNNM" size="100" type="STRING"/>
          <Column id="DR_ACCTCD" size="20" type="STRING"/>
          <Column id="DR_ACCTCDNM" size="60" type="STRING"/>
          <Column id="FEE_ACCTCD" size="20" type="STRING"/>
          <Column id="FEE_ACCTCDNM" size="60" type="STRING"/>
          <Column id="FEE_REG_YN" size="20" type="STRING"/>
          <Column id="SUBINV_CHK_YN" size="20" type="STRING"/>
          <Column id="SUBINV_CHK_YNNM" size="100" type="STRING"/>
          <Column id="TYPE_CD" size="20" type="STRING"/>
          <Column id="TYPE_GRP" size="20" type="STRING"/>
          <Column id="TYPE_GRPNM" size="100" type="STRING"/>
          <Column id="TYPE_NAME" size="200" type="STRING"/>
          <Column id="TYPE_TYPE" size="20" type="STRING"/>
          <Column id="TYPE_TYPENM" size="100" type="STRING"/>
          <Column id="USE_YN" size="1" type="STRING"/>
          <Column id="TYPE_CLASS" size="256" type="STRING"/>
          <Column id="TYPE_DESC" size="256" type="STRING"/>
          <Column id="TCK_YN" size="1" type="STRING"/>
          <Column id="ITEM_TYPE" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_MAS_TRX_LINE">
        <ColumnInfo>
          <Column id="RCP_ID" size="256" type="BIGDECIMAL"/>
          <Column id="AMT" size="256" type="BIGDECIMAL"/>
          <Column id="TRX_ID" size="256" type="BIGDECIMAL"/>
          <Column id="SOURCE_FR" size="256" type="STRING"/>
          <Column id="SOURCE_TO" size="256" type="STRING"/>
          <Column id="LINE_DATE" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listInput_AutoLine">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="BIGDECIMAL"/>
          <Column id="ID" size="256" type="BIGDECIMAL"/>
          <Column id="AMT" size="256" type="BIGDECIMAL"/>
          <Column id="DATE" size="256" type="STRING"/>
          <Column id="CUSTCD" size="256" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="256" type="STRING"/>
          <Column id="CMP_CLASS" size="256" type="STRING"/>
          <Column id="CMP_GRP" size="256" type="STRING"/>
          <Column id="CMP_TYPE" size="256" type="STRING"/>
          <Column id="CMP_ACCTCD" size="256" type="STRING"/>
          <Column id="ALL_YN" size="256" type="STRING"/>
          <Column id="RTN" size="256" type="STRING"/>
          <Column id="RTNMSG" size="256" type="STRING"/>
          <Column id="GUBUN" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listInput_AutoLineReturn">
        <ColumnInfo>
          <Column id="RTN" size="256" type="STRING"/>
          <Column id="RTNMSG" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list" onrowposchanged="ds_list_OnRowPosChanged">
        <ColumnInfo>
          <Column id="ACNTCD" size="255" type="STRING"/>
          <Column id="ADITEM1" size="255" type="STRING"/>
          <Column id="ADITEM1NM" size="255" type="STRING"/>
          <Column id="ALT_AMT" size="0" type="BIGDECIMAL"/>
          <Column id="AMT" size="0" type="BIGDECIMAL"/>
          <Column id="AUTO_GUBUN" size="255" type="STRING"/>
          <Column id="AUTO_KIND" size="255" type="STRING"/>
          <Column id="CLS_YN" size="255" type="STRING"/>
          <Column id="CMS_YN" size="255" type="STRING"/>
          <Column id="CR_ACCTCD" size="255" type="STRING"/>
          <Column id="CUSTCD" size="0" type="BIGDECIMAL"/>
          <Column id="CUSTCDNM" size="255" type="STRING"/>
          <Column id="DR_ACCTCD" size="255" type="STRING"/>
          <Column id="FEE" size="0" type="BIGDECIMAL"/>
          <Column id="FEE_ACCTCD" size="255" type="STRING"/>
          <Column id="GADATE" size="255" type="STRING"/>
          <Column id="GALINE" size="0" type="BIGDECIMAL"/>
          <Column id="GAMU" size="255" type="STRING"/>
          <Column id="GANO" size="0" type="BIGDECIMAL"/>
          <Column id="PARENT_ID" size="0" type="BIGDECIMAL"/>
          <Column id="PARTIAL_SEQ" size="0" type="BIGDECIMAL"/>
          <Column id="PRICE" size="0" type="BIGDECIMAL"/>
          <Column id="QTY" size="0" type="BIGDECIMAL"/>
          <Column id="RCP_DATE" size="255" type="STRING"/>
          <Column id="RCP_DESC" size="255" type="STRING"/>
          <Column id="RCP_ID" size="0" type="BIGDECIMAL"/>
          <Column id="RCP_TYPE" size="255" type="STRING"/>
          <Column id="SUBINV_CODE" size="255" type="STRING"/>
          <Column id="SUBINV_CODENM" size="255" type="STRING"/>
          <Column id="SUBST_YN" size="255" type="STRING"/>
          <Column id="SUS_SEQ" size="0" type="BIGDECIMAL"/>
          <Column id="TICKET_SEQ" size="0" type="BIGDECIMAL"/>
          <Column id="TRX_YN" size="255" type="STRING"/>
          <Column id="TYPE_NAME" size="255" type="STRING"/>
          <Column id="UPJANG" size="0" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="255" type="STRING"/>
          <Column id="AUTO_YN" size="256" type="STRING"/>
          <Column id="RMT_YN" size="256" type="STRING"/>
          <Column id="CROSS_YN" size="256" type="STRING"/>
          <Column id="ADITEM2" size="256" type="STRING"/>
          <Column id="ADITEM2NM" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listInput" cancolumnchange="ds_listInput_CanColumnChange" oncolumnchanged="ds_listInput_OnColumnChanged">
        <ColumnInfo>
          <Column id="ACNTCD" size="255" type="STRING"/>
          <Column id="ADITEM1" size="255" type="STRING"/>
          <Column id="ADITEM1NM" size="255" type="STRING"/>
          <Column id="ALT_AMT" size="0" type="BIGDECIMAL"/>
          <Column id="AMT" size="0" type="BIGDECIMAL"/>
          <Column id="AUTO_GUBUN" size="255" type="STRING"/>
          <Column id="AUTO_KIND" size="255" type="STRING"/>
          <Column id="CLS_YN" size="255" type="STRING"/>
          <Column id="CMS_YN" size="255" type="STRING"/>
          <Column id="CR_ACCTCD" size="255" type="STRING"/>
          <Column id="CUSTCD" size="0" type="BIGDECIMAL"/>
          <Column id="CUSTCDNM" size="255" type="STRING"/>
          <Column id="DR_ACCTCD" size="255" type="STRING"/>
          <Column id="FEE" size="0" type="BIGDECIMAL"/>
          <Column id="FEE_ACCTCD" size="255" type="STRING"/>
          <Column id="GADATE" size="255" type="STRING"/>
          <Column id="GALINE" size="0" type="BIGDECIMAL"/>
          <Column id="GAMU" size="255" type="STRING"/>
          <Column id="GANO" size="0" type="BIGDECIMAL"/>
          <Column id="PARENT_ID" size="0" type="BIGDECIMAL"/>
          <Column id="PARTIAL_SEQ" size="0" type="BIGDECIMAL"/>
          <Column id="PRICE" size="0" type="BIGDECIMAL"/>
          <Column id="QTY" size="0" type="BIGDECIMAL"/>
          <Column id="RCP_DATE" size="255" type="STRING"/>
          <Column id="RCP_DESC" size="255" type="STRING"/>
          <Column id="RCP_ID" size="0" type="BIGDECIMAL"/>
          <Column id="RCP_TYPE" size="255" type="STRING"/>
          <Column id="SUBINV_CODE" size="255" type="STRING"/>
          <Column id="SUBINV_CODENM" size="255" type="STRING"/>
          <Column id="SUBST_YN" size="255" type="STRING"/>
          <Column id="SUS_SEQ" size="0" type="BIGDECIMAL"/>
          <Column id="TICKET_SEQ" size="0" type="BIGDECIMAL"/>
          <Column id="TRX_YN" size="255" type="STRING"/>
          <Column id="TYPE_NAME" size="255" type="STRING"/>
          <Column id="UPJANG" size="0" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="255" type="STRING"/>
          <Column id="AUTO_YN" size="256" type="STRING"/>
          <Column id="RMT_YN" size="256" type="STRING"/>
          <Column id="CROSS_YN" size="256" type="STRING"/>
          <Column id="ADITEM2" size="256" type="STRING"/>
          <Column id="ADITEM2NM" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listInput_Exc">
        <ColumnInfo>
          <Column id="ACNTCD" size="255" type="STRING"/>
          <Column id="ADITEM1" size="255" type="STRING"/>
          <Column id="ADITEM1NM" size="255" type="STRING"/>
          <Column id="ALT_AMT" size="0" type="BIGDECIMAL"/>
          <Column id="AMT" size="0" type="BIGDECIMAL"/>
          <Column id="AUTO_GUBUN" size="255" type="STRING"/>
          <Column id="AUTO_KIND" size="255" type="STRING"/>
          <Column id="CLS_YN" size="255" type="STRING"/>
          <Column id="CMS_YN" size="255" type="STRING"/>
          <Column id="CR_ACCTCD" size="255" type="STRING"/>
          <Column id="CUSTCD" size="0" type="BIGDECIMAL"/>
          <Column id="CUSTCDNM" size="255" type="STRING"/>
          <Column id="DR_ACCTCD" size="255" type="STRING"/>
          <Column id="FEE" size="0" type="BIGDECIMAL"/>
          <Column id="FEE_ACCTCD" size="255" type="STRING"/>
          <Column id="GADATE" size="255" type="STRING"/>
          <Column id="GALINE" size="0" type="BIGDECIMAL"/>
          <Column id="GAMU" size="255" type="STRING"/>
          <Column id="GANO" size="0" type="BIGDECIMAL"/>
          <Column id="PARENT_ID" size="0" type="BIGDECIMAL"/>
          <Column id="PARTIAL_SEQ" size="0" type="BIGDECIMAL"/>
          <Column id="PRICE" size="0" type="BIGDECIMAL"/>
          <Column id="QTY" size="0" type="BIGDECIMAL"/>
          <Column id="RCP_DATE" size="255" type="STRING"/>
          <Column id="RCP_DESC" size="255" type="STRING"/>
          <Column id="RCP_ID" size="0" type="BIGDECIMAL"/>
          <Column id="RCP_TYPE" size="255" type="STRING"/>
          <Column id="SUBINV_CODE" size="255" type="STRING"/>
          <Column id="SUBINV_CODENM" size="255" type="STRING"/>
          <Column id="SUBST_YN" size="255" type="STRING"/>
          <Column id="SUS_SEQ" size="0" type="BIGDECIMAL"/>
          <Column id="TICKET_SEQ" size="0" type="BIGDECIMAL"/>
          <Column id="TRX_YN" size="255" type="STRING"/>
          <Column id="TYPE_NAME" size="255" type="STRING"/>
          <Column id="UPJANG" size="0" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="255" type="STRING"/>
          <Column id="AUTO_YN" size="256" type="STRING"/>
          <Column id="RMT_YN" size="256" type="STRING"/>
          <Column id="CROSS_YN" size="256" type="STRING"/>
          <Column id="ADITEM2" size="256" type="STRING"/>
          <Column id="ADITEM2NM" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_MAS_TICKET_MST">
        <ColumnInfo>
          <Column id="TICKET_SEQ" size="256" type="BIGDECIMAL"/>
          <Column id="QTY" size="256" type="BIGDECIMAL"/>
          <Column id="RCP_ID" size="256" type="BIGDECIMAL"/>
          <Column id="TICKET_GROUP_SEQ" size="256" type="STRING"/>
          <Column id="RCP_DATE" size="256" type="STRING"/>
          <Column id="PRICE" size="256" type="STRING"/>
          <Column id="RCP_DESC" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Excel"/>
      <Dataset id="ds_common"/>
    </Objects>
    <Bind>
      <BindItem id="edt_RCP_TYPE_value" compid="edt_RCP_TYPE" propid="value" datasetid="ds_listInput" columnid="TYPE_NAME"/>
      <BindItem id="edt_SUBINV_CODE_value" compid="edt_SUBINV_CODE" propid="value" datasetid="ds_listInput" columnid="SUBINV_CODENM"/>
      <BindItem id="edt_CUSTCD_value" compid="edt_CUSTCD" propid="value" datasetid="ds_listInput" columnid="CUSTCDNM"/>
      <BindItem id="edt_TICKET_SEQ_value" compid="edt_TICKET_SEQ" propid="value" datasetid="ds_listInput" columnid="TICKET_SEQ"/>
      <BindItem id="edt_RCP_ID_value" compid="edt_RCP_ID" propid="value" datasetid="ds_listInput" columnid="RCP_ID"/>
      <BindItem id="edt_RCP_DESC_value" compid="edt_RCP_DESC" propid="value" datasetid="ds_listInput" columnid="RCP_DESC"/>
      <BindItem id="me_PRICE_value" compid="me_PRICE" propid="value" datasetid="ds_listInput" columnid="PRICE"/>
      <BindItem id="me_QTY_value" compid="me_QTY" propid="value" datasetid="ds_listInput" columnid="QTY"/>
      <BindItem id="edt_AMT_value" compid="edt_AMT" propid="value" datasetid="ds_listInput" columnid="AMT"/>
      <BindItem id="edt_ADITEM1_value" compid="edt_ADITEM1" propid="value" datasetid="ds_listInput" columnid="ADITEM1NM"/>
      <BindItem id="me_FEE_value" compid="me_FEE" propid="value" datasetid="ds_listInput" columnid="FEE"/>
      <BindItem id="edt_ACNTCD_value" compid="edt_ACNTCD" propid="value" datasetid="ds_listInput" columnid="ACNTCD"/>
      <BindItem id="edt_ADITEM2_value" compid="edt_ADITEM2" propid="value" datasetid="ds_listInput" columnid="ADITEM2NM"/>
      <BindItem id="item10" compid="sta_detail05" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item11" compid="sta_detail06" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item12" compid="sta_detail07" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item13" compid="sta_detail08" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item14" compid="sta_detail09" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item15" compid="sta_detail10" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item16" compid="sta_detail11" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item17" compid="sta_detail12" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item18" compid="sta_detail13" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item19" compid="sta_detail14" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item20" compid="sta_detail15" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item21" compid="sta_detail16" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item0" compid="sta_detail00" propid="text" datasetid="ds_view" columnid="D_1"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
 ******************************************************************************************
 * 시스템구분   : FS시스템/시스템공통/템플릿 1
 * 프로그램명   : Sam_Form_Basic1.XML
 * 기      능   : 표준 UI Form
 * 작  성  자   : 구종화
 * 작성  일자   : 2007-11-16
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
                1)박은규 2013-06-10 CSR#(CH201306_00051) 요청자:이남석, 김진옥(컨세션사업팀팀)
                  매출/입금 엑셀자료 일괄 업로드 기능개발
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
include "U_lib::lib_conversionCom.xjs";
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::ma_common.js"


//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var f_Saved_ID,
	f_AfterCallServerCheck;
	
var f_NewDataCheck;		
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

    var F_ArrCol          = new Array(-1);
    var F_ArrColType      = new Array(-1);
    
	//init_btn_setup();	// Button 초기화
	fsp_init(this);


	/*
	#############################################################################################################
	공통코드 SETTING
	#############################################################################################################
	*/	
	edt_UPJANGQuery.userdata = g_Upjang;
	edt_UPJANGQuery.value     = g_UpjangNm;
			

    f_CurrDate = fn_CurrDateWeek();
	me_RCP_DATE.value   = f_CurrDate;		
	//me_RCP_DATE.Value   = "20070911";		

    fn_insert();
    
    //사업장 권한 셋팅#############################################################################
	fn_SetAuth("","","edt_UPJANGQuery", "edtBtn_UPJANGQuery");
    //사업장 권한 셋팅#############################################################################    
    
    //가수금잔액 존재할경우 warning############################################
    fn_UnConsentSuspenseYN(ds_cond, edt_UPJANGQuery.userdata);
    //가수금잔액 존재할경우 warning############################################
	/*
	#############################################################################################################
	공통코드 SETTING
	#############################################################################################################
	*/
}





//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
function fn_search()
{
	if (!before_SelectCheck())
		return;


	//매출리스트############################################################
    fsp_clear(this);
    
	fsp_addSearch(this, "ma/mas:MAS10100E_S001");	

	ds_cond.clear();
	ds_cond.addColumn("UPJANG","INT",256);
	ds_cond.addColumn("RCP_DATE","STRING",256);
	
	// 개인정보 마스킹 처리
	// 20140307 김장욱 수정
	ds_cond.addColumn("EMPNO","STRING",256);
			
	ds_cond.addRow();
		
	ds_cond.setColumn(ds_cond.rowposition, "UPJANG",    edt_UPJANGQuery.userdata);
	ds_cond.setColumn(ds_cond.rowposition, "RCP_DATE",  me_RCP_DATE.value);
	
	// 개인정보 마스킹 처리
	// 20140307 김장욱 수정
	ds_cond.setColumn(ds_cond.rowposition, "EMPNO",  g_EmpNo);
					
	fn_DataSetAllClear();

    http.Sync = true;
	fsp_callService(this, "", "", "ds_cond=ds_cond","ds_list=ds_list","","fn_SearchDetail()");
	http.Sync = false;	
	//매출리스트############################################################
		
	//일마감체크#####################################################################
	if (!fn_IsCloseDate(ds_cond, edt_UPJANGQuery.userdata, me_RCP_DATE.value, "002")){
	 	 
		for (i=0;i<ds_list.rowcount;i++){
			
			ds_list.setColumn(i, "CLS_YN", "Y");
		}
	 }    
	//일마감체크#####################################################################
}

function fn_insert()
{
	if (!before_SelectCheck()) return;
	
	ds_listInput.clearData();

	//edtBtn Component 초기화############################
	Set_edtBtn_UserData("Clear");	
	//edtBtn Component 초기화############################

	ds_listInput.addRow();
	ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG", edt_UPJANGQuery.userdata);	  
	ds_listInput.setColumn(ds_listInput.rowposition, "UPJANGNM", edt_UPJANGQuery.value);
	ds_listInput.setColumn(ds_listInput.rowposition, "RCP_DATE", me_RCP_DATE.value);	   
	 
	fn_ds_listInput_OnColumnChanged(ds_listInput,0,"RCP_DATE","",ds_listInput.getColumn(ds_listInput.rowposition, "RCP_DATE"),0);
	//Setds_listInput_OnColumnChanged();
		 
	//Disabled항목 Enabled처리####################################
	edt_RCP_TYPE.enable       = true;
	edtBtn_RCP_TYPE.enable    = true;
	
	edt_SUBINV_CODE.enable    = true;
	edtBtn_SUBINV_CODE.enable = true;
	
	edt_CUSTCD.enable         = true;
	edtBtn_CUSTCD.enable      = true;	
			
	edtBtn_TICKET_SEQ.enable      = false;				
    //Disabled항목 Enabled처리####################################
		 
	edt_RCP_TYPE.setFocus();
}

function fn_delete()
{
    if (!before_DeleteCheck("Master") ){

		return;
    }
}

function fn_save()
{

    if (!before_SaveCheck("Master") ){
        
        if (f_NewDataCheck){
			
			ds_listInput.setColumn(ds_listInput.rowposition, "RCP_ID", "");
        }
        
		return;
    }
}


function fn_print()
{
}
function fn_Close()
{
	this.close();
}
function fn_help()
{
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================

function fn_SearchDetail(int_TabIndex)
{
	/*
	if (Length(Tab_UPJANG.tab1.st_CC_CD.Value) == 0)
		return;


	//업장정보GET############################################################
    tit_clearActionInfo(this);
	tit_addSearchActionInfo(this, "ma/mas:MAS10020E_S002");

	ds_cond.Clear();
	ds_cond.AddColumn("CC_CD","VARCHAR",256);
	ds_cond.AddRow();

	ds_cond.SetColumn(ds_cond.Row, "CC_CD",  Tab_UPJANG.tab1.st_CC_CD.Value);


	tit_callService(this, "", "", "ds_cond=ds_cond","ds_deptHis=ds_list","","");
	//업장정보GET############################################################



	*/
}

function before_SelectCheck()
{

	if (numFormat(edt_UPJANGQuery.userdata)== "0")
	{
	
		gfn_alert("업장을 지정하여 주십시요.");
		edt_UPJANGQuery.setFocus();
		return false;
	}

	if (gfn_length(me_RCP_DATE.value)== 0)
	{
	
		gfn_alert("입금일자를 지정하여 주십시요.");
		me_RCP_DATE.setFocus();
		return false;
	}
		
	return true;
}


function before_SaveCheck(str_Gubun)
{
        
		//권한에 따른 저장/삭제 가능체크#########################################################################
		if (
//				(g_AuthLevel != "99") &&
				(g_AuthLevel < "99") &&
				(!fn_GetSaveAuthBy_AuthLevel(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG")))
		    )  return false;		    
		//권한에 따른 저장/삭제 가능체크#########################################################################
		   
		          
        /*
        업무구분별로 addAction 지정세팅##########################################        
        */
        
        f_Saved_ID = 0;
        f_NewDataCheck = false;
        
        //자동비교여부가 'N'일 경우 입금비교 팝업창을 띄운다.
		ds_MAS_TRX_LINE.clearData();		
		
        //자동비교일경우 입금내역에 대해 자동으로 라인저장여부
		ds_listInput_AutoLine.clearData();
		ds_listInput_AutoLineReturn.clearData();
		
		//초과금액을 처리해야 하는경우
		ds_listInput_Exc.clearData();
		
		//식권관리유형일 경우 식권비교 팝업창을 띄운다.
		ds_MAS_TICKET_MST.clearData();
		
        /*
        업무구분별로 addAction 지정세팅##########################################        
        */
		
		
 		if (ds_listInput.rowcount == 0){

			return;
		}

	    if (str_Gubun == "Master"){

			if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0")
			{
			
				g_Message("EE", "업장을 지정하여 주십시요.");
				edt_UPJANGQuery.setFocus();
				return false;
			}
		
			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_DATE"))== 0)
			{
			
				g_Message("EE", "입금일자가 누락되었습니다.");
				me_RCP_DATE.setFocus();
				return false;
			}
	        
	        //입력일때 Confirm체크##################################        	        
	        if ( 
	             (ds_listInput.rowcount > 0) &&
                 (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"))== "0") &&
	             (chk_Auto.value == "0") 
	           )
	        {
				if (!g_Confirm("02")) return false;	             
	        }     
	        //입력일때 Confirm체크##################################
	             
	             
	        //수정일때 Confirm체크##################################
            if (
                 (ds_listInput.rowcount > 0) &&
                 (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"))!= "0")
               )
            {	        
				g_Message("EE", "기존 입금데이터를 수정하려면\n삭제 후 신규 등록해야만 합니다.\n" +
				                "확인하여 주십시요.");                
				return false;   
			}
	        //수정일때 Confirm체크##################################
	        
			//각 구분별 대체 마감체크##############################
            if (
                 (ds_listInput.rowcount > 0) &&
                 (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"))!= "0")
               )
            {			
				if (!fn_GetALT_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"), ds_listInput.getColumn(ds_listInput.rowposition, "CR_ACCTCD"))) return false;
			}
			//각 구분별 대체 마감체크##############################	        
					        
			//마감체크###############################################
			if (!fn_CheckMAClosing(ds_cond, edt_UPJANGQuery.userdata, me_RCP_DATE.value, "002"))
				return false;                
			//마감체크###############################################
			
			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_TYPE"))== 0){
				
				g_Message("EE", "입금유형이 누락되었습니다.\n" +
				                "확인하여 주십시요.");
                edt_RCP_TYPE.setFocus();
				return false;                
			}
			
			if (ds_Type.getColumn(0, "SUBINV_CHK_YN") == "R"){
	
				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "SUBINV_CODE"))== 0){
		
					g_Message("EE", "창고가 누락되었습니다.\n" +
									"확인하여 주십시요.");
					edt_SUBINV_CODE.setFocus();
					return false;     
				}
			}
			
			
			if (ds_Type.getColumn(0, "CUST_CHK_YN") == "R"){
	
				if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD"))== "0"){
		
					g_Message("EE", "고객사가 누락되었습니다.\n" +
									"확인하여 주십시요.");
					edt_CUSTCD.setFocus();
					return false;     
				}
			}
		
			if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "QTY"))== "0"){
				
				g_Message("EE", "식수가 누락되었습니다.\n" +
				                "확인하여 주십시요.");
                me_QTY.setFocus();
				return false;                
			}		
		
		
		
			if (ds_Type.getColumn(0, "AUTO_AMT_YN") == "Y"){
	
				if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "PRICE"))== "0"){
		
					g_Message("EE", "단가가 누락되었습니다.\n" +
									"확인하여 주십시요.");
					me_PRICE.setFocus();
					return false;     
				}
				
				if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "QTY"))== "0"){
		
					g_Message("EE", "식수가 누락되었습니다.\n" +
									"확인하여 주십시요.");
					me_QTY.setFocus();
					return false;     
				}														
			}	
				
			if (toNumber(numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "AMT"))) <= 0){
	
				g_Message("EE", "금액이 누락되었습니다.\n" +
								"확인하여 주십시요.");
				edt_AMT.setFocus();
				return false;     
			}				
			
			
			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ACNTCD"))== 0){
			
				if (gfn_length(fn_GetALT_AcctcdCHECK(ds_cond, ds_Type.getColumn(ds_Type.rowposition, "DR_ACCTCD"), "", "", "ACNTCD"))!= 0){
				
					
					g_Message("EE", "계좌번호가 누락되었습니다.\n" +
									"확인하여 주십시요.");
					edt_ACNTCD.setFocus();
					return false;     
				}			
			}
			
			
			if (toNumber(numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "FEE"))) < 0){
	
				g_Message("EE", "수수료는 마이너스 등록이 허용되지 않습니다.\n" +
								"확인하여 주십시요.");
				me_FEE.setFocus();
				return false;     
			}				
			
			
	
			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_DESC"))== 0){
				
				//alert(ds_listInput.GetColumn(ds_listInput.row, "TRX_DESC"));
				g_Message("EE", "적요가 누락되었습니다.\n" +
				                "확인하여 주십시요.");
                edt_RCP_DESC.setFocus();
				return false;                
			}			
		
		
			if (ds_Type.getColumn(0, "ADITEM1_CHK_YN") == "R"){
	
				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ADITEM1"))== 0){
		
					g_Message("EE", "식구분이 누락되었습니다.\n" +
									"확인하여 주십시요.");
					edt_ADITEM1.setFocus();
					return false;     
				}
			}		
		
			if (ds_Type.getColumn(0, "ADITEM2_CHK_YN") == "R"){
	
				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ADITEM2"))== 0){
		
					g_Message("EE", "카드사가 누락되었습니다.\n" +
									"확인하여 주십시요.");
					edt_ADITEM2.setFocus();
					return false;     
				}
			}			
		
			

		    // 매출액 비교 작업 시작 ###################################################
		    var real_RcpAmt = ds_listInput.getColumn(ds_listInput.rowposition, "AMT");
		    var real_FeeAmt = ds_listInput.getColumn(ds_listInput.rowposition, "FEE");
		    var real_JANAMT = 0;
			var real_ExcAmt = 0;
		    
			if (ds_Type.getColumn(0, "CMP_CLASS") != "N"){
				
				
	            real_JANAMT = fn_GetBalance(ds_cond, 
											ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"), 
											ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"), 
											ds_listInput.getColumn(ds_listInput.rowposition, "RCP_DATE"), 											
											ds_Type.getColumn(0, "CMP_CLASS"), 
											ds_Type.getColumn(0, "CMP_GRP"), 
											ds_Type.getColumn(0, "CMP_TYPE"), 
											ds_Type.getColumn(0, "CMP_ACCTCD"), 
											ds_Type.getColumn(0, "ALL_YN"), 											
											ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD"), 
											ds_listInput.getColumn(ds_listInput.rowposition, "SUBINV_CODE"));
											
				
				//alert(real_TrxAmt);
				//alert(real_JANAMT);
				
				real_ExcAmt = (real_RcpAmt + real_FeeAmt) - real_JANAMT;
				if (
				    (real_ExcAmt > 0) && //초과금액
				    (ds_Type.getColumn(0, "CMP_SPLS_YN") == "N") //초과금액처리여부
				   )
				{
		
					g_Message("EE", "입금액이 매출액을 초과했습니다.\n" +
									"확인하여 주십시요.");
					edt_AMT.setFocus();
					return false;     
				}
				
				// 초과금액 비교 후 입금액 다시 설정.
				if (real_ExcAmt > 0)
				{
					real_RcpAmt = (real_RcpAmt + real_FeeAmt) - real_ExcAmt; 
				}
				else {
				
					real_RcpAmt = (real_RcpAmt + real_FeeAmt);
				}
				

				if (real_RcpAmt < 0)
			    {
					g_Message("EE", "입금액이 -일수는 없습니다.\n" +
									"확인하여 주십시요.");
					edt_AMT.setFocus();
					return false;   		    			    
			    }
			    
			    
				if (real_JANAMT > 0)
				{
				
					//자동비교여부가 'N'일 경우 입금비교 팝업창을 띄운다.
					if (ds_Type.getColumn(0, "CMP_AUTO_YN") == "N")
					{
						
						if(!fn_OpenLineWindow(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"), real_RcpAmt)) return false;
					}
					//자동비교일경우 입금내역에 대해 자동으로 라인저장
					else {
					
					
						if(!fn_InsertAutoLine(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"), real_RcpAmt)) return false;
					}				
				}

				//초과금액을 처리해야 하는경우
				if (
				    (real_ExcAmt > 0) &&
				    (ds_Type.getColumn(0, "CMP_SPLS_YN") == "Y")
				   )
				{
					// 잔액이 0보다크고 또한 잔액이 수수료보다 클 경우 초과금액 처리
					// 에서 수수료는 0이된다.
					if (
						(real_JANAMT > 0) &&
						(real_JANAMT > real_FeeAmt)
					   )
					{
					   
						if(!fn_SaveExcTrxData(real_ExcAmt, 0)) return false;
					}
					// 잔액이 0보다 크지 않거나 수수료 보다 작을 경우
					// 초과금액 처리로직에서 수수료 금액을 처리한다.
					else
					{
					
						if (real_ExcAmt == real_FeeAmt){
						
							g_Message("EE", "수수료가 잔액을 초과하는 금액과\n동일할 경우 처리할 수 없습니다.\n" +
											"확인하여 주십시요.");
							me_FEE.setFocus();
							return false;   							
						}
						
						if(!fn_SaveExcTrxData(real_ExcAmt - real_FeeAmt, real_FeeAmt)) return false;
					}					
					
				}				
				
			}
			// 매출액 비교 작업 시작 ###################################################					
			
			
			
			//식권관리유형일 경우 식권비교 팝업창을 띄운다.#########################
			if (ds_Type.getColumn(0, "TCK_YN") == "Y"){
	
				if(!fn_OpenTicketLineWindow("INSERT", ds_listInput.getColumn(ds_listInput.rowposition, "QTY"))) return false;
			}	
			//식권관리유형일 경우 식권비교 팝업창을 띄운다.#########################
			
			
						
			//RCP_ID 지정#################################################################
            if (
					(real_RcpAmt > 0)||
					(
						(real_ExcAmt > 0) &&
						(ds_Type.getColumn(0, "CMP_SPLS_YN") == "Y")
					)
               )  			
			{
				// 매출비교작업을 하지 않을 경우
				if (ds_Type.getColumn(0, "CMP_CLASS") == "N"){
				
					if (!fn_SaveTrxData(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"))) return false;
				}							
				else {
					
					// 매출비교작업을 해서 수수료가 삭감처리 된 경우...
					if (
					    (real_JANAMT > 0) &&
					    (real_JANAMT > real_FeeAmt)
					   )
					{
					
						if (real_RcpAmt == real_FeeAmt){
						
							g_Message("EE", "입금액은 없고 수수료만 존재할 경우\n처리할 수 없습니다.'\n" +
											"확인하여 주십시요.");
							me_FEE.setFocus();
							return false;  						
						}
						
						real_RcpAmt = real_RcpAmt - real_FeeAmt;
						real_FeeAmt = real_FeeAmt;
						
					    if (!fn_SaveTrxData(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"))) return false;
					}
					else {
					
						real_RcpAmt = real_RcpAmt;
						real_FeeAmt = 0;
						if (!fn_SaveTrxData(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"))) return false;
					}
				
				}
				
			}
		}			

        
		//저장#############################################################
	    if (str_Gubun == "Master"){


		    // 매출액 비교 작업 시작 ##############################저장전 중복확인
		    var real_RcpAmt = ds_listInput.getColumn(ds_listInput.rowposition, "AMT");
		    var real_FeeAmt = ds_listInput.getColumn(ds_listInput.rowposition, "FEE");
		    var real_JANAMT = 0;
			var real_ExcAmt = 0;
		    
			if (ds_Type.getColumn(0, "CMP_CLASS") != "N"){
				
				
	            real_JANAMT = fn_GetBalance(ds_cond, 
											ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"), 
											ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"), 
											ds_listInput.getColumn(ds_listInput.rowposition, "RCP_DATE"), 											
											ds_Type.getColumn(0, "CMP_CLASS"), 
											ds_Type.getColumn(0, "CMP_GRP"), 
											ds_Type.getColumn(0, "CMP_TYPE"), 
											ds_Type.getColumn(0, "CMP_ACCTCD"), 
											ds_Type.getColumn(0, "ALL_YN"), 											
											ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD"), 
											ds_listInput.getColumn(ds_listInput.rowposition, "SUBINV_CODE"));
											
				//alert(real_TrxAmt);
				//alert(real_JANAMT);
				
				real_ExcAmt = (real_RcpAmt + real_FeeAmt) - real_JANAMT;
				if (
				    (real_ExcAmt > 0) && //초과금액
				    (ds_Type.getColumn(0, "CMP_SPLS_YN") == "N") //초과금액처리여부
				   )
				{
		
					g_Message("EE", "입금액이 매출액을 초과했습니다..\n" +
									"확인하여 주십시요..");
					edt_AMT.setFocus();
					return false;     
				}
				
				// 초과금액 비교 후 입금액 다시 설정.
				if (real_ExcAmt > 0)
				{
					real_RcpAmt = (real_RcpAmt + real_FeeAmt) - real_ExcAmt; 
				}
				else {
				
					real_RcpAmt = (real_RcpAmt + real_FeeAmt);
				}
				

				if (real_RcpAmt < 0)
			    {
					g_Message("EE", "입금액이 -일수는 없습니다.\n" +
									"확인하여 주십시요.");
					edt_AMT.setFocus();
					return false;   		    			    
			    }
			    
			    

				
				//초과금액을 처리해야 하는경우
				if (
				    (real_ExcAmt > 0) &&
				    (ds_Type.getColumn(0, "CMP_SPLS_YN") == "Y")
				   )
				{
					// 잔액이 0보다크고 또한 잔액이 수수료보다 클 경우 초과금액 처리
					// 에서 수수료는 0이된다.
					if (
						(real_JANAMT > 0) &&
						(real_JANAMT > real_FeeAmt)
					   )
					{
					   

					}
					// 잔액이 0보다 크지 않거나 수수료 보다 작을 경우
					// 초과금액 처리로직에서 수수료 금액을 처리한다.
					else
					{
					
						if (real_ExcAmt == real_FeeAmt){
						
							g_Message("EE", "수수료가 잔액을 초과하는 금액과\n동일할 경우 처리할 수 없습니다.\n" +
											"확인하여 주십시요.");
							me_FEE.setFocus();
							return false;   							
						}
						
					}					
					
				}				
				
			}
			// 매출액 비교 작업 시작 ##############################저장전 중복확인
			
			//RCP_ID 지정#############################################저장전 중복확인
            if (
					(real_RcpAmt > 0)||
					(
						(real_ExcAmt > 0) &&
						(ds_Type.getColumn(0, "CMP_SPLS_YN") == "Y")
					)
               )  			
			{
				// 매출비교작업을 하지 않을 경우
				if (ds_Type.getColumn(0, "CMP_CLASS") == "N"){
				
					
				}							
				else {
					
					// 매출비교작업을 해서 수수료가 삭감처리 된 경우...
					if (
					    (real_JANAMT > 0) &&
					    (real_JANAMT > real_FeeAmt)
					   )
					{
					
						if (real_RcpAmt == real_FeeAmt){
						
							g_Message("EE", "입금액은 없고 수수료만 존재할 경우\n처리할 수 없습니다.'\n" +
											"확인하여 주십시요.");
							me_FEE.setFocus();
							return false;  						
						}
						
						real_RcpAmt = real_RcpAmt - real_FeeAmt;
						real_FeeAmt = real_FeeAmt;
											    
					}
					else {
					
						real_RcpAmt = real_RcpAmt;
						real_FeeAmt = 0;						
					}
				
				}
				
			}		    
		    //RCP_ID 지정#############################################저장전 중복확인
			
			
			//각 구분별 대체 마감체크##############################저장전 중복확인
            if (
                 (ds_listInput.rowcount > 0) &&
                 (numFormat(f_Saved_ID)!= "0")
               )
            {			
				if (!fn_GetALT_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"), ds_listInput.getColumn(ds_listInput.rowposition, "CR_ACCTCD"))) return false;
			}
			//각 구분별 대체 마감체크##############################저장전 중복확인
			
			
			//가수금 잔액체크#######################################저장전 중복확인
			if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "SUS_SEQ"))!= "0"){
			
				if(!fn_GetIsSupenseJanAmtOK(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "SUS_SEQ"), ds_listInput.getColumn(ds_listInput.rowposition, "AMT"))) return false;
			}
			//가수금 잔액체크#######################################저장전 중복확인
			
			
			//대체잔액체크##########################################저장전 중복확인
			if (ds_MAS_TRX_LINE.rowcount > 0){
				if (!fn_GetBalanceLine(ds_cond, ds_MAS_TRX_LINE, "매출잔액체크"))
					return false;   
	        }    
			//대체잔액체크##########################################저장전 중복확인
						
			
			//식권잔액체크##########################################저장전 중복확인
			if (ds_MAS_TICKET_MST.rowcount > 0){
			    
			    var real_MAS_TICKET_MST_GROUP_S;
			    			
				real_MAS_TICKET_MST_GROUP_S = fn_GetMAS_TICKET_MST_GROUP_S(ds_cond);
								
				for (i=0;i<ds_MAS_TICKET_MST.rowcount;i++){
					
					ds_MAS_TICKET_MST.setColumn(i, "TICKET_GROUP_SEQ", real_MAS_TICKET_MST_GROUP_S);			
					ds_MAS_TICKET_MST.setColumn(i, "RCP_ID", ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"));
					ds_MAS_TICKET_MST.setColumn(i, "RCP_DATE", ds_listInput.getColumn(ds_listInput.rowposition, "RCP_DATE"));					
					ds_MAS_TICKET_MST.setColumn(i, "RCP_DESC", ds_listInput.getColumn(ds_listInput.rowposition, "RCP_DESC"));	
									
					if ( 
						 (ds_listInput.rowcount > 0) &&
						 (numFormat(f_Saved_ID)== "0")
					   )
					{
						//기존 미승인내역 체크###########################################################
						if (!fn_UnConsentTicketYN(ds_cond, ds_MAS_TICKET_MST.getColumn(i, "TICKET_SEQ")))
							return false;	             
						
						//기존 미승인내역 체크###########################################################
					}  									
				}
				
				if (!fn_GetBalanceLine(ds_cond, ds_MAS_TICKET_MST, "식권판매잔액체크"))
					return false;   				
				
				ds_listInput.setColumn(ds_listInput.rowposition, "TICKET_SEQ", real_MAS_TICKET_MST_GROUP_S);	
	        }    
			//식권잔액체크##########################################저장전 중복확인
									
									
			
			// action 정보 초기화
			fsp_clear(this);	  		
										    		        
	    
            //기존 라인 및 입금 데이터 삭제.          
            if (
                 (ds_listInput.rowcount > 0) &&
                 (numFormat(f_Saved_ID)!= "0")
               )
            {
            
                fsp_addSingle(this, "ma/mas:MAS10100E_D003");
				fsp_addSingle(this, "ma/mas:MAS10100E_D002");
				fsp_addSingle(this, "ma/mas:MAS10100E_D001");
            }
       
            
            
            //입금 저장
            if (real_RcpAmt > 0){
            
				ds_listInput.setColumn(ds_listInput.rowposition, "AMT", real_RcpAmt);
				fsp_addSingle(this, "ma/mas:MAS10100E_I001");
            }                  		
			
            //자동비교여부가 'N'일 경우 매출비교 팝업창
            if (ds_MAS_TRX_LINE.rowcount > 0){
            
				fsp_addMulti(this, "ma/mas:MAS10100E_I002");
            }

            //자동비교일경우 매출내역에 대해 자동으로 라인저장
            if (ds_listInput_AutoLine.rowcount > 0){

                ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "ID", ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"));
				fsp_addSingle(this, "ma/mas:MAS10100E_I003");
            }

            //초과금액을 처리해야 하는경우
            if (ds_listInput_Exc.rowcount > 0){
                
				ds_listInput_Exc.setColumn(ds_listInput_Exc.rowposition, "PARENT_ID", ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"));
				fsp_addSingle(this, "ma/mas:MAS10100E_I004");
            }                   		
			
            //식권관리유형일 경우 식권비교 팝업창
            if (ds_MAS_TICKET_MST.rowcount > 0){
                				
				fsp_addMulti(this, "ma/mas:MAS10100E_I005");
            }   			
			
			f_Saved_ID = ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID");

			//TRX실행
			http.Sync = true; //저장을 반드시 싱크로 저장해야 일괄등록 시 저장완료 후에 다음 자료가 순차적으로 저장될 수 있다.(안그러면 잔액체크 못함)
			fsp_callService(this, "", "", "ds_cond=ds_listInput:A ds_listInput_Exc=ds_listInput_Exc:A ds_listInput_AutoLine=ds_listInput_AutoLine:A ds_MAS_TRX_LINE=ds_MAS_TRX_LINE:A ds_MAS_TICKET_MST=ds_MAS_TICKET_MST:A", "ds_listInput_AutoLineReturn=ds_listInput_AutoLineReturn",  "", "fn_AfterSaveSearch()");
			//
		}

		return true;
}


function fn_AfterSaveSearch(errCode, errMsg)
{
	if (errCode != 0){
		
		g_Message("EE");		
		return;
	}
		

	fn_search();	
	fn_insert();
	
	http.Sync = true;
	if (chk_Auto.value == "0") ds_list.rowposition = ds_list.findRowExpr("RCP_ID==" + f_Saved_ID);
	http.Sync = false;
	/*
	for(i=0;i<ds_list.rowcount;i++){
	
		if (f_Saved_ID == ds_list.GetColumn(i, "TRX_ID")){
					
			ds_list.row = i;
		}
	}
	*/
	
}

/*
 ******************************************************************************************
 * 함  수  명   : Common_Btn_common_OnClick
 * 입      력   : obj  = Form Component
 * 반      환   : 없음
 * 기      능   : 
 * 작  성  자   : 구종화
 * 작성  일자   : 2007-11-16
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
function WorkForm_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
{
	
	gfn_formKeyDown(obj, e); //(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam);
}



function edt_UPJANGQuery_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	fn_edt_OnKeyDown(obj,e.keycode);	
			
	if (e.keycode == 46){
			
		if (obj.name == "edt_UPJANGQuery"){
				
			fn_DataSetAllClear();				
		}		
	}
}


function fn_DataSetAllClear()
{

	ds_list.clearData();	

	ds_listInput.clearData();	
	
	ds_Type.clearData();	
	
	//자동비교여부가 'N'일 경우 매출비교 팝업창을 띄운다.
	ds_MAS_TRX_LINE.clearData();		
	
	//자동비교일경우 매출내역에 대해 자동으로 라인저장여부
	ds_listInput_AutoLine.clearData();
	ds_listInput_AutoLineReturn.clearData();
	
	//초과금액을 처리해야 하는경우
	ds_listInput_Exc.clearData();	

	//식권관리유형일 경우 식권비교 팝업창을 띄운다.
	ds_MAS_TICKET_MST.clearData();
}	



function edtBtn_Date_OnClick(obj:Button, e:ClickEventInfo)
{
	var retDate = g_CalButton_OnClick(me_RCP_DATE);
 
	me_RCP_DATE.value = retDate;
	
	fn_DataSetAllClear();	
	
	//가수금잔액 존재할경우 warning############################################
    fn_UnConsentSuspenseYN(ds_cond, edt_UPJANGQuery.userdata);
    //가수금잔액 존재할경우 warning############################################	
}


function edtBtn_UPJANGQuery_OnClick(obj:Button, e:ClickEventInfo)
{
    
	fn_edtBtn_OnClick(obj);
	fn_DataSetAllClear();	
		
	//가수금잔액 존재할경우 warning############################################
    fn_UnConsentSuspenseYN(ds_cond, edt_UPJANGQuery.userdata);
    //가수금잔액 존재할경우 warning############################################		
}

function grid_List_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	
	
	if (obj.getCellProperty("head",e.cell,"backgroundimage") == "ico_Excel"){
		gfn_exportExcel(obj, this.titletext);
	}
	else {
	
		gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);	
		fn_ds_list_OnRowPosChanged(ds_list,-1,0);	
	}
	//obj.ExportExcel(this.Title, , False);	
}



function edtBtn_RCP_TYPE_OnClick(obj:Button, e:ClickEventInfo)
{   
	if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0") return;

	var str_Where;
/*
    //입금유형####################################################################################
    if (obj.id == "edtBtn_RCP_TYPE"){	
		
		str_Where += "  AND (A.TYPE_TYPE = 'R') AND  (V.UPJANG = " + edt_UPJANGQuery.UserData + ") AND (V.USE_YN = 'Y')  ";
    }
    
    //창고코드####################################################################################
    if (obj.id == "edtBtn_SUBINV_CODE"){	
		
		str_Where += " AND  (UPJANG = " + edt_UPJANGQuery.UserData + ")";
				 
    }   
     
    //고객사코드####################################################################################
    if (obj.id == "edtBtn_CUSTCD"){	
		
		str_Where += " AND  (A.UPJANG = " + edt_UPJANGQuery.UserData + ") AND (A.USE_YN = 'Y') ";			
    }         
 
    //계좌코드####################################################################################
    if (obj.id == "edtBtn_ACNTCD"){	
		
		if (
		    (ds_Type.rowcount == 0)||
		    (length(ds_Type.GetColumn(ds_Type.row, "DR_ACCTCD")) == 0)
		   )
		{
		
				g_Message("EE", "입금유형을 먼저 선택하여 주십시요.\n" +
								"확인하여 주십시요.");
				edtBtn_RCP_TYPE.SetFocus();
				return;   				
		}
		
		str_Where += " AND  (UPJANG = " + edt_UPJANGQuery.UserData + ")";	
		
		//미수금(신용카드) 1110815/ 미수금(식권) 1110822 일경우 => 가계좌
		if (
		    (ds_Type.GetColumn(ds_Type.row, "DR_ACCTCD") == "1110815") ||
		    (ds_Type.GetColumn(ds_Type.row, "DR_ACCTCD") == "1110822")
		   )
		{
		
			str_Where += " AND  (ACCTCD = '1110114')";	
		}
		else {		
			
			str_Where += " AND  (ACCTCD = '" + ds_Type.GetColumn(ds_Type.row, "DR_ACCTCD") + "')";				
		}
    }         
*/
	str_Where = getAddWhere(obj);

	fn_edtBtn_OnClick(obj, str_Where);

    if (gfn_length(eval("edt_" + gfn_subStr(obj.name, 7)).userdata)!= 0)
	ds_listInput.setColumn(ds_listInput.rowposition, gfn_subStr(obj.name, 7), eval("edt_" + gfn_subStr(obj.name, 7)).userdata);	
			    		
}

function getAddWhere(obj)
{
	var str_Where;
    //입금유형####################################################################################
    if (obj.name == "edtBtn_RCP_TYPE"){	
		
		str_Where += "  AND (A.TYPE_TYPE = 'R') AND  (V.UPJANG = " + edt_UPJANGQuery.userdata + ") AND (V.USE_YN = 'Y')  ";
    }
    
    //창고코드####################################################################################
    if (obj.name == "edtBtn_SUBINV_CODE"){	
		
		str_Where += " AND  (UPJANG = " + edt_UPJANGQuery.userdata + ")";
				 
    }   
     
    //고객사코드####################################################################################
    if (obj.name == "edtBtn_CUSTCD"){	
		
		str_Where += " AND  (A.UPJANG = " + edt_UPJANGQuery.userdata + ") AND (A.USE_YN = 'Y') ";			
    }         
 
    //계좌코드####################################################################################
    if (obj.name == "edtBtn_ACNTCD"){	
		
		if (
		    (ds_Type.rowcount == 0)||
		    (gfn_length(ds_Type.getColumn(ds_Type.rowposition, "DR_ACCTCD"))== 0)
		   )
		{
		
				g_Message("EE", "입금유형을 먼저 선택하여 주십시요.\n" +
								"확인하여 주십시요.");
				edtBtn_RCP_TYPE.setFocus();
				return;   				
		}
		
		str_Where += " AND  (UPJANG = " + edt_UPJANGQuery.userdata + ")";	
		
		//미수금(신용카드) 1110815/ 미수금(식권) 1110822 일경우 => 가계좌
		if (
		    (ds_Type.getColumn(ds_Type.rowposition, "DR_ACCTCD") == "1110815") ||
		    (ds_Type.getColumn(ds_Type.rowposition, "DR_ACCTCD") == "1110822")
		   )
		{
		
			str_Where += " AND  (ACCTCD = '1110114')";	
		}
		else {		
			
			str_Where += " AND  (ACCTCD = '" + ds_Type.getColumn(ds_Type.rowposition, "DR_ACCTCD") + "')";				
		}
    }         

	return str_Where;
}

//대체계정이 가수금일 경우 가수비교 팝업창을 띄운다.#########################
function edtBtn_AMT_OnClick(obj:Button, e:ClickEventInfo)
{
   
    if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0"){    

		g_Message("EE", "업장을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_UPJANGQuery.setFocus();
        return false;
    }
    
    if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_DATE"))== 0){    

		g_Message("EE", "입금일자가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 						       
        me_RCP_DATE.setFocus();
        return false;
    }
	
	if ( 
	     (!edt_AMT.readonly) ||
	     (gfn_length(fn_GetALT_AcctcdCHECK(ds_cond, ds_Type.getColumn(ds_Type.rowposition, "DR_ACCTCD"), "GasuAcctCd", ""))== 0)
	   )
	{
		
		return;
	}

	ds_listInput.setColumn(ds_listInput.rowposition, "AMT", "");		
	ds_listInput.setColumn(ds_listInput.rowposition, "ACNTCD",  "");
	ds_listInput.setColumn(ds_listInput.rowposition, "SUS_SEQ", "");
	
	var arrArgs = {str_CMSGUBUN:"입금대체",str_DATE:ds_listInput.getColumn(ds_listInput.rowposition, "RCP_DATE")};	    
	gfn_dialog("", "U_MAS::MAS10100P.xfdl", arrArgs);
	
	edt_AMT.setFocus();
	return true;
    
}
//대체계정이 가수금일 경우 가수비교 팝업창을 띄운다.#########################



function edt_RCP_TYPE_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	fn_edt_OnKeyDown(obj,e.keycode);		
	
	if (e.keycode == 46)
	ds_listInput.setColumn(ds_listInput.rowposition, gfn_subStr(obj.name, 4), "");	
}


function ds_list_OnRowPosChanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	fn_ds_list_OnRowPosChanged(obj, e.oldrow, e.newrow);
}

function fn_ds_list_OnRowPosChanged(obj, nOldRow, nNewRow)
{
    if (ds_list.rowcount == 0) return;
    
	ds_listInput.clearData();
	var row = ds_listInput.addRow();
	ds_listInput.copyRow(row, ds_list, nNewRow);
	ds_listInput.applyChange();

	//edtBtn Component 복사############################
	Set_edtBtn_UserData("Clear");
	Set_edtBtn_UserData("Copy");
	
	ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG", gfn_nvl(edt_UPJANGQuery.userdata));	   
	ds_listInput.setColumn(ds_listInput.rowposition, "UPJANGNM", gfn_nvl(edt_UPJANGQuery.value));
	ds_listInput.setColumn(ds_listInput.rowposition, "RCP_DATE", gfn_nvl(me_RCP_DATE.value));	
	//edtBtn Component 복사############################
	
	
	Setds_listInput_OnColumnChanged();
	//edt_TYPE_CD.Enable        = False;

	//edt_TYPE_NAME.SetFocus();
}

//edtBtn Component 세팅/초기화####################################################################
function Set_edtBtn_UserData(str_Gubun)
{

	if (str_Gubun == "Copy"){

		//edtBtn Component 초기화############################  		 
		for (i=0;i<components.length;i++){
							
			if (
				(gfn_subStr(components[i].name, 0, 3)== "st_") &&
				(gfn_subStr(components[i].userdata, 0, 10)== "strMAQuery")
			   )	
			{

			    if (gfn_length(eval("edt_" + gfn_subStr(components[i].name, 3)).Column)!= 0)
				eval("edt_" + gfn_subStr(components[i].name, 3)).userdata = ds_listInput.getColumn(ds_listInput.rowposition, gfn_subStr(components[i].name, 3));
			}
		}		 
		//edtBtn Component 초기화############################
	}
	else if (str_Gubun == "Clear"){

		//edtBtn Component 초기화############################
		for (i=0;i<components.length;i++){
				
				
			if (
				(gfn_subStr(components[i].name, 0, 3)== "st_") &&
				(gfn_subStr(components[i].userdata, 0, 10)== "strMAQuery")
			   )	
			{
				if (gfn_length(components[i].Column)!= 0)
				eval("edt_" + gfn_subStr(components[i].name, 3)).userdata = "";
			}
		}  
		//edtBtn Component 초기화############################
	}
}

function Setds_listInput_OnColumnChanged()
{

	fn_ds_listInput_OnColumnChanged(ds_listInput,0,"RCP_TYPE","",ds_listInput.getColumn(ds_listInput.rowposition, "RCP_TYPE"),0);	
	/*
	fn_ds_listInput_OnColumnChanged(ds_listInput,0,"BIZ_CHK_YN","",ds_listInput.GetColumn(ds_listInput.row, "BIZ_CHK_YN"),0);
	fn_ds_listInput_OnColumnChanged(ds_listInput,0,"FEE_REG_YN","",ds_listInput.GetColumn(ds_listInput.row, "FEE_REG_YN"),0);
	fn_ds_listInput_OnColumnChanged(ds_listInput,0,"ADITEM1_CHK_YN","",ds_listInput.GetColumn(ds_listInput.row, "ADITEM1_CHK_YN"),0);
	fn_ds_listInput_OnColumnChanged(ds_listInput,0,"ADITEM2_CHK_YN","",ds_listInput.GetColumn(ds_listInput.row, "ADITEM2_CHK_YN"),0);
	*/
}

function ds_listInput_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	fn_ds_listInput_OnColumnChanged(obj, e.row, e.columnid, e.oldvalue, e.newvalue, -1);
}
function fn_ds_listInput_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	var F_ArrCol          = new Array(-1);
	var F_ArrColType      = new Array(-1);
	
	if (strColumnID== "RCP_TYPE"){
	
		//alert(ds_list.GetRowType(ds_list.row));
		//Combo DATASET Composition#########################
		F_ArrCol = [];
		
		F_ArrCol[0]     = "TYPE_CD";		
		F_ArrColType[0] = "STRING";
		
	    frm_InitSearchDS(ds_cond, ds_Type, F_ArrCol, F_ArrColType, "TYPE_CD", ds_listInput.getColumn(ds_listInput.rowposition, "RCP_TYPE"), "ma/mae:MAE10020E_S001");	
	  
	    
		edt_SUBINV_CODE.enable    = false;
		edtBtn_SUBINV_CODE.enable = false;
		
		edt_CUSTCD.enable      = false;
		edtBtn_CUSTCD.enable   = false;
		
		edt_AMT.enable       = true;
		edtBtn_AMT.enable    = true;
		
		edt_ADITEM1.enable    = false;
		edtBtn_ADITEM1.enable = false;
	
		edt_ADITEM2.enable    = false;
		edtBtn_ADITEM2.enable = false;
				
		me_FEE.enable                = false;
		
		//수정불가위해세팅###################################	
		//edt_AMT.Enable           = True;
		//edtBtn_AMT.Enable        = True;	
		
		me_QTY.enable            = true;
		
		//me_FEE.Enable            = True;
		
		edt_ACNTCD.enable        = true;
		edtBtn_ACNTCD.enable     = true;
		
		edt_RCP_DESC.enable      = true;
		
		//edt_ADITEM1.Enable       = False;
		//edtBtn_ADITEM1.Enable    = False;
		//수정불가위해세팅###################################		
						
	    if (nPivotIndex == -1){
	
			ds_listInput.setColumn(ds_listInput.rowposition, "SUBINV_CODE", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "SUBINV_CODENM", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "CUSTCD", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "CUSTCDNM", "");			
			ds_listInput.setColumn(ds_listInput.rowposition, "AMT", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "QTY", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "PRICE", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "FEE", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "ACNTCD", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "RCP_DESC", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM1", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM1NM", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "TICKET_SEQ", "");	
													
			if (gfn_length(varNewValue)== 0) ds_Type.clearData();
		}
		
		if (ds_Type.getColumn(0, "SUBINV_CHK_YN") == "R"){
		
			edt_SUBINV_CODE.enable    = true;
			edtBtn_SUBINV_CODE.enable = true;
		}
		
		if (ds_Type.getColumn(0, "SUBINV_CHK_YN") == "O"){
		
			edt_SUBINV_CODE.enable    = true;
			edtBtn_SUBINV_CODE.enable = true;
		}		
		
		if (ds_Type.getColumn(0, "CUST_CHK_YN") == "R"){
		
			edt_CUSTCD.enable      = true;
			edtBtn_CUSTCD.enable   = true;
		}
						
		if (ds_Type.getColumn(0, "CUST_CHK_YN") == "O"){
		
			edt_CUSTCD.enable      = true;
			edtBtn_CUSTCD.enable   = true;
		}
								
								
		if (ds_Type.getColumn(0, "AUTO_AMT_YN") == "Y"){
		
			//edtBtn_AMT.Enable    = False;
		}
										
		if (ds_Type.getColumn(0, "ADITEM1_CHK_YN") == "R"){
		
			edt_ADITEM1.enable    = true;
			edtBtn_ADITEM1.enable = true;
		}
												
		if (ds_Type.getColumn(0, "ADITEM1_CHK_YN") == "O"){
		
			edt_ADITEM1.enable    = true;
			edtBtn_ADITEM1.enable = true;
		}				
			
			
		if (ds_Type.getColumn(0, "ADITEM2_CHK_YN") == "R"){
		
			edt_ADITEM2.enable    = true;
			edtBtn_ADITEM2.enable = true;
		}
												
		if (ds_Type.getColumn(0, "ADITEM2_CHK_YN") == "O"){
		
			edt_ADITEM2.enable    = true;
			edtBtn_ADITEM2.enable = true;
		}				
	
	
		if (ds_Type.getColumn(0, "FEE_REG_YN") == "Y"){
		
			me_FEE.enable        = true;			
		}
			
			
	    if (
	        (nRow >= 0) &&
	        (ds_Type.rowcount > 0)
	       )
	    {
			
			ds_listInput.setColumn(nRow, "DR_ACCTCD", ds_Type.getColumn(ds_Type.rowposition, "DR_ACCTCD"));
			ds_listInput.setColumn(nRow, "CR_ACCTCD", ds_Type.getColumn(ds_Type.rowposition, "CR_ACCTCD"));
			ds_listInput.setColumn(nRow, "FEE_ACCTCD", ds_Type.getColumn(ds_Type.rowposition, "FEE_ACCTCD"));
		}	
		
		if (gfn_length(fn_GetALT_AcctcdCHECK(ds_cond, ds_Type.getColumn(ds_Type.rowposition, "DR_ACCTCD"), "GasuAcctCd", ""))!= 0){
			
			edt_AMT.readonly  = true;
			edtBtn_AMT.enable = true;
		}
		else {
		
			edt_AMT.readonly  = false;
			edtBtn_AMT.enable = false;
		}		
		
		
		//입금유형별 계좌가져오기############################################################
		if (nPivotIndex == -1){
	    
			edt_ACNTCD.userdata = fn_GetUpjangAcntcd(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"), ds_Type.getColumn(ds_Type.rowposition, "DR_ACCTCD"));
			edt_ACNTCD.value    = edt_ACNTCD.userdata;
		}
	    //입금유형별 계좌가져오기############################################################
	    
	    
	}

	if (strColumnID == "AMT"){
	    
	    ds_listInput.setColumn(ds_listInput.rowposition, "QTY", 0);
	    ds_listInput.setColumn(ds_listInput.rowposition, "PRICE", 0);
	    
	}	
		
	if (strColumnID == "QTY"){
	    
	    if (numFormat(varNewValue)== "0"){
	 
			ds_listInput.setColumn(ds_listInput.rowposition, "PRICE", 0);
		}
		/*
		else if ((ds_listInput.GetColumn(ds_listInput.row, "AMT") % ToNumber(varNewValue)) != 0)
		{
	
		    ds_listInput.SetColumn(ds_listInput.row, "QTY", 0);
		    ds_listInput.SetColumn(ds_listInput.row, "PRICE", 0);
			g_Message("EE", "정확한 단가 산출이 안됩니다.\n금액 혹은 식수를 확인하세요.\n" +
							"확인하여 주십시요.");
			me_QTY.SetFocus();			
		}
		*/
		else {
		
			me_PRICE.value = Math.round(toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "AMT")) / toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "QTY")));
		}
	}	
	
	edtBtn_TICKET_SEQ.enable = false;
	if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"))!= "0"){
	
		edt_RCP_TYPE.enable       = false;
		edtBtn_RCP_TYPE.enable    = false;
		
		edt_SUBINV_CODE.enable    = false;
		edtBtn_SUBINV_CODE.enable = false;
		
		edt_CUSTCD.enable      = false;
		edtBtn_CUSTCD.enable   = false;
						
			
			
		//수정불가위해세팅###################################	
		edt_AMT.enable           = false;
		edtBtn_AMT.enable        = false;	
		
		me_QTY.enable            = false;
		
		me_FEE.enable            = false;
		
		edt_ACNTCD.enable        = false;
		edtBtn_ACNTCD.enable     = false;
		
		edt_RCP_DESC.enable      = false;
		
		edt_ADITEM1.enable       = false;
		edtBtn_ADITEM1.enable    = false;
		
		edt_ADITEM2.enable       = false;
		edtBtn_ADITEM2.enable    = false;		
		//수정불가위해세팅###################################
		
		if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "TICKET_SEQ"))!= "0")
		edtBtn_TICKET_SEQ.enable = true;
	}	
	
	fn_ImportantImgSetting(this);
	
    //단가, 식수 선택요소 이미지 세팅#######################
    //img_imp_me_PRICE.visible = false;
    //img_imp_me_QTY.visible   = false;
    me_PRICE.class = "";
    me_QTY.class = "";
    
    if (ds_Type.getColumn(0, "AUTO_AMT_YN") == "Y"){
    
		//img_imp_me_PRICE.visible = true;
		//img_imp_me_QTY.visible   = true;   
		 me_PRICE.class = "msk_WF_Essential";
		 me_QTY.class = "msk_WF_Essential";
    }
    //단가, 식수 선택요소 이미지 세팅#######################
}



			 


//각 구분별 대체마감체크############################################################
function fn_GetALT_CLOSE(objOutDs, real_RCP_ID, str_CR_ACCTCD)
{

    //대체마감체크#####################################################################
    var str_CloseErr = "";
    
    objOutDs.clear();
    objOutDs.addColumn("TRX_YN","STRING",256);	       
    objOutDs.addColumn("SUBST_YN","STRING",256);	       
    objOutDs.addColumn("CMS_YN","STRING",256);	 
    objOutDs.addColumn("AUTO_YN","STRING",256);	
    objOutDs.addColumn("CLS_YN","STRING",256);	
    objOutDs.addColumn("RMT_YN","STRING",256);
    
    objOutDs.addColumn("TICKET_YN","STRING",256);
    
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/mas:MAS10100E_S003");
	
	//alert(str_ACCTCD);
	//alert(str_DATE_STD);
	// 서버 호출 
	
	f_AfterCallServerCheck = true;
	
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","RCP_ID=" + real_RCP_ID + 
															   " CR_ACCTCD=" + wrapQuote(str_CR_ACCTCD)
	                                                           ,"fn_AfterCallServiceCheck()");	
	http.Sync = false;
	
	if (!f_AfterCallServerCheck) return false;
	

	if (objOutDs.getColumn(objOutDs.rowposition, "TRX_YN") == "Y")    str_CloseErr = "입금액의 일부 혹은 전부에 대해 \n매출이 발생했으므로\n수정/삭제할 수 없습니다.";

	if (objOutDs.getColumn(objOutDs.rowposition, "SUBST_YN") == "Y")  str_CloseErr = "영업대체된 데이터는\n수정/삭제할 수 없습니다.";				

	//if (objOutDs.GetColumn(objOutDs.row, "CMS_YN") == "Y")   str_CloseErr = "";			    
			                          	
	if (objOutDs.getColumn(objOutDs.rowposition, "AUTO_YN") == "Y")   str_CloseErr = "자동등록된 데이터는\n수정/삭제할 수 없습니다.\n해당 화면에서 취소하신후 다시 작업\n하여주십시요.";			    
	
	if (objOutDs.getColumn(objOutDs.rowposition, "CLS_YN") == "Y")    str_CloseErr = "마감된 데이터는\n수정/삭제할 수 없습니다.";				
	
	if (objOutDs.getColumn(objOutDs.rowposition, "RMT_YN") == "Y")    str_CloseErr = "현금/미수금->수입금이체된 데이터는\n수정/삭제할 수 없습니다.";
	
	if (objOutDs.getColumn(objOutDs.rowposition, "TICKET_YN") == "Y") str_CloseErr = "해당입금 이후에 해당식권의 수불이\n발생하였으므로\n수정/삭제할 수 없습니다.";
	
	if (gfn_length(str_CloseErr )!= 0){
	
		g_Message("EE", str_CloseErr + "\n" +
						"확인하여 주십시요.");			 
		return false;        
	}

	return true;
	//대체마감체크#####################################################################
 
}			 
//각 구분별 대체마감체크############################################################
			 



/*
 ******************************************************************************************
 * 함  수  명   : fn_GetBalance
 * 입      력   : real_UPJANG : 업장코드
	              str_DATE : 일자
	             
 * 반      환   :  값 리턴
 * 기      능   : 영업잔액체크
 * 작  성  자   : 황승한
 * 작성  일자   : 2007-11-28
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
*/
function fn_GetBalance(objOutDs, real_UPJANG, real_ID, str_DATE, str_CMP_CLASS, str_CMP_GRP, str_CMP_TYPE, str_CMP_ACCTCD, str_ALL_YN, real_CUSTCD, str_SUBINV_CODE)
{

    
    //잔액체크#####################################################################
    objOutDs.clear();
    objOutDs.addColumn("JANAMT","INT",256);	       
    
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/mas:GetMAS_GETBALANCE");
	
	//alert(str_ACCTCD);
	//alert(str_DATE_STD);
	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","V_GUBUN=" + wrapQuote("매출잔액체크") + 
															   " V_UPJANG=" + wrapQuote(real_UPJANG) + 
	                                                           " V_ID=" + wrapQuote(real_ID) + 
	                                                           " V_DATE=" + wrapQuote(str_DATE) +
	                                                           " V_CMP_CLASS=" + wrapQuote(str_CMP_CLASS) +
	                                                           " V_CMP_GRP=" + wrapQuote(str_CMP_GRP) +
	                                                           " V_CMP_TYPE=" + wrapQuote(str_CMP_TYPE) +
	                                                           " V_CMP_ACCTCD=" + wrapQuote(str_CMP_ACCTCD) +
	                                                           " V_ALL_YN=" + wrapQuote(str_ALL_YN) +
	                                                           " V_CUSTCD=" + wrapQuote(real_CUSTCD) +
	                                                           " V_SUBINV_CODE=" + wrapQuote(str_SUBINV_CODE)
	                                                           ,"");	
	http.Sync = false;
                          	
	
	//alert(objOutDs.GetColumn(objOutDs.row, "ACCTCD_DATE") );
	return objOutDs.getColumn(objOutDs.rowposition, "JANAMT");
	//잔액체크#####################################################################
	
}



//자동비교여부가 'N'일 경우 매출비교 팝업창을 띄운다.#########################
function fn_OpenLineWindow(real_TRX_ID, real_RcpAmt)
{

    if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0"){    

		g_Message("EE", "업장을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");
        edt_UPJANGQuery.setFocus();
        return false;
    }
    
    if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_DATE"))== 0){    

		g_Message("EE", "입금일자가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요.");
        me_RCP_DATE.setFocus();
        return false;
    }    

    var arrArgs = {real_RcpAmt:real_RcpAmt};
	gfn_dialog("", "U_MAS::MAS10101P.xfdl", arrArgs);
	
	//if (ds_MAS_TRX_LINE.rowcount == 0) return false;
	if (ds_MAS_TRX_LINE.rowcount == 0)
	{
		g_Message("EE", "대체할 매출이 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요.");
		return false;
	}
	
	return true;
    
}
//자동비교여부가 'N'일 경우 매출비교 팝업창을 띄운다.#########################

//자동비교일경우 매출내역에 대해 자동으로 라인저장.###########################
function fn_InsertAutoLine(real_TRX_ID, real_RcpAmt)
{

    if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0"){    

		g_Message("EE", "업장을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_UPJANGQuery.setFocus();
        return false;
    }
    
    if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_DATE"))== 0){    


		g_Message("EE", "입금일자가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 						       
        me_RCP_DATE.setFocus();
        return false;
    }    

    //ds_listInput_AutoLine.ClearData();
    
    ds_listInput_AutoLine.addRow();
    
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "GUBUN", "매출자동대체");
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "UPJANG", ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "ID", ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "AMT", real_RcpAmt);
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "DATE", ds_listInput.getColumn(ds_listInput.rowposition, "RCP_DATE"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "CUSTCD", ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "SUBINV_CODE", ds_listInput.getColumn(ds_listInput.rowposition, "SUBINV_CODE"));
    
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "CMP_CLASS", ds_Type.getColumn(ds_Type.rowposition, "CMP_CLASS"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "CMP_GRP", ds_Type.getColumn(ds_Type.rowposition, "CMP_GRP"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "CMP_TYPE", ds_Type.getColumn(ds_Type.rowposition, "CMP_TYPE"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "CMP_ACCTCD", ds_Type.getColumn(ds_Type.rowposition, "CMP_ACCTCD"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "ALL_YN", ds_Type.getColumn(ds_Type.rowposition, "ALL_YN"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "RTN", "");
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "RTNMSG", "");    
    
    return true;
}
//자동비교일경우 매출내역에 대해 자동으로 라인저장.###########################








//초과금액을 처리해야 하는경우.##################################################
function fn_SaveExcTrxData(real_ExcAmt, real_FeeAmt)
{

    if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0"){    

		g_Message("EE", "업장을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_UPJANGQuery.setFocus();
        return false;
    }
    
    if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_DATE"))== 0){    

		g_Message("EE", "입금일자가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 						       
        me_RCP_DATE.setFocus();
        return false;
    }    

    
    Copy(ds_listInput_Exc,ds_listInput);
           
    if (real_ExcAmt != ds_listInput.getColumn(ds_listInput.rowposition, "AMT")){
    
		ds_listInput_Exc.setColumn(ds_listInput_Exc.rowposition, "PRICE", 0);
		ds_listInput_Exc.setColumn(ds_listInput_Exc.rowposition, "QTY", 0);
    } 
               
    ds_listInput_Exc.setColumn(ds_listInput_Exc.rowposition, "CR_ACCTCD", ds_Type.getColumn(ds_Type.rowposition, "CMP_SPLS_ACCTCD"));
        
    ds_listInput_Exc.setColumn(ds_listInput_Exc.rowposition, "AMT", real_ExcAmt);
    ds_listInput_Exc.setColumn(ds_listInput_Exc.rowposition, "FEE", real_FeeAmt);
               
    return true;
}
//초과금액을 처리해야 하는경우.##################################################




//TRX_ID 세팅#######################################################################
function fn_SaveTrxData(real_RCP_ID)
{

    if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0"){    

		g_Message("EE", "업장을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_UPJANGQuery.setFocus();
        return false;
    }
    
    if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_DATE"))== 0){    

		g_Message("EE", "입금일자가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 						       
        me_RCP_DATE.setFocus();
        return false;
    }    

    f_Saved_ID = ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID");
    
    if (numFormat(real_RCP_ID)== "0"){
    
		ds_cond.clear();
		ds_cond.addColumn("MAS_RCP_S","INT",256);
					
		// action 정보 초기화
		fsp_clear(this);

		// 서버에서 조회할 정보 추가
		fsp_addSearch(this, "ma/mas:MAS10100E_S002");

		// 서버 호출
		http.Sync = true;
		fsp_callService(this, "", "", "", ds_cond.name + "=ds_list","","");
		http.Sync = false;
		
		real_RCP_ID = ds_cond.getColumn(ds_cond.rowposition, "MAS_RCP_S");
		ds_listInput.setColumn(ds_listInput.rowposition, "RCP_ID", real_RCP_ID);
		
		f_Saved_ID  = 0;
		f_NewDataCheck = true;
    }
    
		
	//수기입금 대체###########################
	for (i=0;i<ds_MAS_TRX_LINE.rowcount;i++){
		
			ds_MAS_TRX_LINE.setColumn(i, "RCP_ID", real_RCP_ID);
			ds_MAS_TRX_LINE.setColumn(i, "SOURCE_FR", "RCP");
			ds_MAS_TRX_LINE.setColumn(i, "SOURCE_TO", "TRX");
			ds_MAS_TRX_LINE.setColumn(i, "LINE_DATE", ds_listInput.getColumn(ds_listInput.rowposition, "RCP_DATE"));
	}
	//수기입금 대체###########################   
	 
	//자동비교 대체###########################
	for (i=0;i<ds_listInput_AutoLine.rowcount;i++){
		
			ds_listInput_AutoLine.setColumn(i, "RCP_ID", real_RCP_ID);
	}
	//자동비교 대체###########################
	
  
    return true;
}
//TRX_ID 세팅#######################################################################

function edt_UPJANGQuery_OnChanged(obj:Edit, e:TextChangedEventInfo)
{
	fn_DataSetAllClear();		
	

}


function edt_RCP_DESC_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13){
				
		if (
		    (!edt_ADITEM1.enable) && (!edt_ADITEM2.enable)
		   )
		{
		    div_cmnBtn.setFocus();
			fn_save();
		}
	}	
}



function edt_ADITEM1_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
    //Http.Sync = True;
	fn_edt_OnKeyDown(obj,e.keycode);	
	//Http.Sync = False;

	if (e.keycode == 13){
				
  		if (
		    (!edt_ADITEM2.enable)
		   )
		{
		    div_cmnBtn.setFocus();
			fn_save();
		}
	}
	
}


function grid_List_OnExpandEdit(obj:Grid, e:GridMouseEventInfo)
{
	if (numFormat(ds_list.getColumn(ds_list.rowposition, "RCP_ID"))== "0") return;
	
	var str_MenuIDText = "",
	    str_MenuIDTextDetail = "",
		str_XMLADDRESS1 = "",
		str_XMLADDRESS2 = "",		
		str_ColumnTitle = "",
		real_RCP_ID = ds_list.getColumn(ds_list.rowposition, "RCP_ID");
	
	str_ColumnTitle = gfn_replace(gfn_replace(fn_Get_ColHeaderTitle(obj, e.cell), "▼"), "▲");	
    if (str_ColumnTitle  == "매출"){
		
		str_MenuIDText       = "입금-매출내역";
		str_MenuIDTextDetail = "[해당입금을매출대체]/[해당입금이매출대체]한내역";
		str_XMLADDRESS1       = "ma/mas:MAS10081P_S010";
		str_XMLADDRESS2       = "ma/mas:MAS10081P_S015";
	}
	else if (str_ColumnTitle  == "대체"){
	
		str_MenuIDText       = "입금-영업대체내역";
		str_MenuIDTextDetail = "[해당입금을영업대체]한내역입니다.";
		str_XMLADDRESS1   	 = "ma/mas:MAS10081P_S011";	
		str_XMLADDRESS2      = "ma/mas:MAS10081P_S015";
	}
	else if (str_ColumnTitle  == "CMS"){
	
		str_MenuIDText = "입금-CMS대체내역";
		str_MenuIDTextDetail = "[해당입금이CMS대체]한내역입니다.";
		str_XMLADDRESS1 = "ma/mas:MAS10081P_S012";	
		str_XMLADDRESS2 = "NONE";
	}	
	else if (str_ColumnTitle  == "수입금"){
	
		str_MenuIDText = "입금-수입금이체내역";
		str_MenuIDTextDetail = "[해당입금을수입금이체]한내역입니다.";
		str_XMLADDRESS1 = "ma/mas:MAS10081P_S013";	
		str_XMLADDRESS2 = "NONE";
	}	
	else if (str_ColumnTitle  == "자동"){
	
		str_MenuIDText = "입금-자동내역";
		str_MenuIDTextDetail = "[자동으로등록]된내역입니다.";
		str_XMLADDRESS1 = "ma/mas:MAS10081P_S014";	
		str_XMLADDRESS2 = "NONE";
	}
	
	var arrArgs = {str_MenuIDText:str_MenuIDText,str_MenuIDTextDetail:str_MenuIDTextDetail,str_XMLADDRESS1:str_XMLADDRESS1,str_XMLADDRESS2:str_XMLADDRESS2,TRID:real_RCP_ID};
	gfn_dialog("", "U_MAS::MAS10081P.xfdl", arrArgs);	
}




//삭제처리###########################################################################
function before_DeleteCheck(str_GUBUN)
{


	//권한에 따른 저장/삭제 가능체크#########################################################################
	if (
//			(g_AuthLevel != "99") &&
			(g_AuthLevel < "99") &&
			(!fn_GetSaveAuthBy_AuthLevel(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG")))
		)  return false;		    
	//권한에 따른 저장/삭제 가능체크#########################################################################

	
	
	if ( 
		(ds_listInput.rowcount == 0) ||
		(numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"))== "0") ||
		(!g_Confirm("01"))
	   )
	{

		return false;
	}

	//각 구분별 대체 마감체크##############################
    if (!fn_GetALT_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ID"), ds_listInput.getColumn(ds_listInput.rowposition, "CR_ACCTCD"))) return false;	
	//각 구분별 대체 마감체크##############################	        

	//마감체크###############################################
	if (!fn_CheckMAClosing(ds_cond, edt_UPJANGQuery.userdata, me_RCP_DATE.value, "002"))
		return false;                
	//마감체크###############################################


	// action 정보 초기화
	fsp_clear(this);			
	
	//기존 라인 및 매출 데이터 삭제.
	fsp_addSingle(this, "ma/mas:MAS10100E_D003");
	fsp_addSingle(this, "ma/mas:MAS10100E_D002");
	fsp_addSingle(this, "ma/mas:MAS10100E_D001");
	   
	http.Sync = true;
	fsp_callService(this, "", "", "ds_cond=ds_listInput:A",  "", "", "fn_AfterDeleteSearch()");		
	http.Sync = false;		
	
	return true;
}


function fn_AfterDeleteSearch(errCode, errMsg)
{
	if (errCode != 0){

		g_Message("EE");
		return;
	}

    g_Message("01");
    
	fn_search();
	fn_insert();

}
//삭제처리###########################################################################



//마감항목 배경색처리###############################################################
function fn_GetBackColorClose(ColorGubun, YN)
{

   	if (YN == "Y")
   	{
		return "thistle";
	}
	else
	{
		if (ColorGubun == "1")
		return "white";
		else
		return "#F6FCFC";
	}

}
//마감항목 배경색처리###############################################################

function me_RCP_DATE_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{

	fn_DataSetAllClear();	
	
	//가수금잔액 존재할경우 warning############################################
    fn_UnConsentSuspenseYN(ds_cond, edt_UPJANGQuery.userdata);
    //가수금잔액 존재할경우 warning############################################	
}







function ds_listInput_CanColumnChange(obj:Dataset, e:DSColChangeEventInfo)
{
	if (
	    (e.columnid == "AMT")||
	    (e.columnid == "QTY")||
	    (e.columnid == "PRICE")||
	    (e.columnid == "FEE")
	   )
	{
	
		if (toNumber(e.newvalue) < 0){
		
			g_Message("EE", "-금액을 입력할 수 없습니다.\n" +
							"확인하여 주십시요.");	
			
                        
			if (e.columnid == "AMT"){
				eval("edt_" + e.columnid).value = "";
				eval("edt_" + e.columnid).setFocus();
				
			}
			else {
				eval("me_" + e.columnid).value = "";
				eval("me_" + e.columnid).setFocus();				
			}
			
			return false;  		

						
		}
	}	
}


function btn_DetailCMS_OnClick(obj:Button, e:ClickEventInfo)
{
	gfn_dialog("", "U_MAS::MAS10110E.xfdl", "");		
}



//식권관리유형일 경우 식권비교 팝업창을 띄운다.#########################
function edtBtn_TICKET_SEQ_OnClick(obj:Button, e:ClickEventInfo)
{
   
    if (
        (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0") 
       )     
    return;
       
    if (
        (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "TICKET_SEQ"))== "0") 
       )     
    return;
         
    fn_OpenTicketLineWindow("SELECT", ds_listInput.getColumn(ds_listInput.rowposition, "QTY"));
}
//식권관리유형일 경우 식권비교 팝업창을 띄운다.#########################


//식권관리유형일 경우 식권비교 팝업창을 띄운다.#########################
function fn_OpenTicketLineWindow(str_Gubun, real_OO_QTY)
{

    if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0"){    

		g_Message("EE", "업장을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_UPJANGQuery.setFocus();
        return false;
    }
    
    if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_DATE"))== 0){    

		g_Message("EE", "입금일자가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 						       
        me_RCP_DATE.setFocus();
        return false;
    }    

    var arrArgs = {str_Gubun:str_Gubun,real_OO_QTY:real_OO_QTY};
	gfn_dialog("", "U_MAS::MAS10270E.xfdl", arrArgs);
	
	if (ds_MAS_TICKET_MST.rowcount == 0) return false;
	
	return true;
    
}
//식권관리유형일 경우 식권비교 팝업창을 띄운다.#########################


//식권관리유형일 경우 미승인내역 체크####################################
function fn_UnConsentTicketYN(objOutDs, real_TICKET_SEQ)
{

    
    //잔액체크#####################################################################
    objOutDs.clear();
    objOutDs.addColumn("CNT","INT",256);	       
    
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/mas:MAS10100E_S004");
	
	//alert(str_ACCTCD);
	//alert(str_DATE_STD);
	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","TICKET_SEQ=" + wrapQuote(real_TICKET_SEQ)
	                                                           ,"");	
	http.Sync = false;
	                        
	
	if (toNumber(objOutDs.getColumn(objOutDs.rowposition, "CNT")) != 0){
	
		g_Message("EE", "승인되지 않은 식권폐기신청이\n존재합니다.\n" +
						"신청승인완료후 다음 작업이 진행됩니다.\n" +
						"식권관리자에게 문의하여 주십시요.");
		return false;
	}
	else {
	
		return true;
	}
	
	//잔액체크#####################################################################
	
}
//식권관리유형일 경우 미승인내역 체크####################################





//가수금잔액 존재할경우 warning############################################
function fn_UnConsentSuspenseYN(objOutDs, real_UPJANG)
{
    st_SuspenseYN.text = "";
    
    //잔액체크#####################################################################
    objOutDs.clear();
    objOutDs.addColumn("CNT","INT",256);	       
    
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/mas:MAS10100E_S005");
	
	//alert(str_ACCTCD);
	//alert(str_DATE_STD);
	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","UPJANG=" + wrapQuote(real_UPJANG) + " REC_DATE=" + wrapQuote(me_RCP_DATE.value)
	                                                           ,"");	
	http.Sync = false;
	                        
	
	if (toNumber(objOutDs.getColumn(objOutDs.rowposition, "CNT")) != 0){
		// 팝업으로 한번 더 보여준다.
		// 20140901 정승화 요청 by 김장욱
		gfn_alert("CMS잔액이 " + objOutDs.getColumn(objOutDs.rowposition, "CNT") + "건 존재합니다. 입금등록/수입금이체/미수금대체에서 확인하시고 대체하여 주시기 바랍니다.");
		
		st_SuspenseYN.text = "CMS잔액이 " + objOutDs.getColumn(objOutDs.rowposition, "CNT") + "건 존재합니다. 입금등록/수입금이체/미수금대체에서 확인하시고 대체하여 주시기 바랍니다.";
		return false;
	}
	else {
	
		return true;
	}
	
	//잔액체크#####################################################################
	
}
//가수금잔액 존재할경우 warning############################################


function fn_AfterCallServiceCheck(errCode, errMsg)
{
	if (errCode != 0){

		g_Message("EE");
		
		f_AfterCallServerCheck = false;
		fn_insert();
		return false;
	}
}

function edt_ADITEM2_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
    //Http.Sync = True;
	fn_edt_OnKeyDown(obj,e.keycode);	
	//Http.Sync = False;

	if (e.keycode == 13){
				
		//if (!edt_TICKET_SEQ.Enable){
		
			div_cmnBtn.setFocus();
			fn_save();
		//}
	}
	
}

//============================================================================================
//(2013-06-10 추가) 시작
// 박은규 2013-06-10 CSR#(CH201306_00051) 요청자:이남석, 김진옥(컨세션사업팀팀)
// 매출/입금 엑셀자료 일괄 업로드 기능개발
//============================================================================================
function fn_Exl_Import(obj:Button, e:ClickEventInfo)
{
	if (!g_Confirm("02", "본 작업은 휴게소업장 전용으로 정해진 규약에 의한 엑셀자료만 업로드 가능합니다.\n\n입금자료 엑셀업로드 작업을 하시겠습니까?!")) return;
	//엑셀 임포트
	fd_Excel.Type = "OPEN";
	fd_Excel.Filter = "Excel File(*.xls;*.xlsx)|*.xls;*.xlsx|All(*.*)|*.*|";

	if( fd_Excel.Open() )
	{
		var sFullFileName = fd_Excel.FilePath + '\\' + fd_Excel.FileName;
		ds_Excel.clearData();
		//ext_ExcelImportByIndex(파일풀패스, 시트순번, 깡통데이타셑);
		ext_ExcelImportByIndex(sFullFileName, 0, "ds_Excel");
		//
		http.Sync = true;
		//
		fn_SetImpData();
	}
}

function fn_SetImpData()
{
	if (!before_SelectCheck()) return;
	//
	var iRow;
	for (iRow = 0; iRow < ds_Excel.rowcount; iRow++)
	{
		//입력작업...
		if (! fn_SetImpDataInput(iRow)) break;
		//저장작업...
		if (! fn_SetImpDataSave(iRow)) break;
	}
	//
	g_Message("01", "총 " + (iRow) + "건의 입금이 등록되었습니다.");
}

function fn_SetImpDataInput(iRow)
{
	//입력작업...
	var strQuery;
	//
	if (me_RCP_DATE.value <> ds_Excel.getColumn(iRow, "Col01"))
	{
		g_Message("EE","(" + (iRow+1) + "행)입금일자가 올바르지 않습니다!");
		return false;
	}
	fn_insert();
	//입금유형
	if (ffn_ChkNull(ds_Excel.getColumn(iRow, "Col02")))
	{
		g_Message("EE","(" + (iRow+1) + "행)입금유형이 누락되었습니다!");
		return false;
	}
	strQuery = eval(eval("st_" + gfn_subStr(edtBtn_RCP_TYPE.name, 7)).userdata) + getAddWhere(edtBtn_RCP_TYPE);
	//strQuery += " AND A.TYPE_CD = '" + ds_Excel.GetColumn(iRow, "Col02") + "'";
	//기존 R003, R016 -> R031, R033으로 바뀌었다...업체 측에 얘기해서 엑셀생성 시 바꾸라고 해야하는데
	//일단 업장에서 급히 써야하니 이쪽에서 임시로 수정
	strQuery += " AND A.TYPE_CD = DECODE('" + ds_Excel.getColumn(iRow, "Col02") + "','R003','R031','R016','R033','" + ds_Excel.getColumn(iRow, "Col02") + "')";
	strQuery += " AND A.USE_YN = 'Y'";
	strQuery += " AND EXISTS (SELECT 1 FROM SCC_COMMON_CODE Z WHERE Z.GROUP_CODE = 'MA0050' AND Z.CODE = A.TYPE_CD AND Z.USE_YN = 'Y')";
	if (fn_sql_common("P", strQuery).rowcount < 1)
	{
		g_Message("EE","(" + (iRow+1) + "행)입금유형이 올바르지 않습니다!");
		return false;
	}
	else
	{
		ds_listInput.setColumn(ds_listInput.rowposition, "RCP_TYPE", ds_common.getColumn(0, "TYPE_CD"));
		ds_listInput.setColumn(ds_listInput.rowposition, "TYPE_NAME", ds_common.getColumn(0, "TYPE_NAME"));
	}
	if (ds_Type.getColumn(0, "ADITEM1_CHK_YN") == "R")
	{
		g_Message("EE","(" + (iRow+1) + "행)해당 입금유형은 식구분을 관리합니다!");
		return false;
	}
	//창고
	if (ffn_ChkNull(ds_Excel.getColumn(iRow, "Col04")))
	{
		g_Message("EE","(" + (iRow+1) + "행)입금창고가 누락되었습니다!");
		return false;
	}
	strQuery = eval(eval("st_" + gfn_subStr(edtBtn_SUBINV_CODE.name, 7)).userdata) + getAddWhere(edtBtn_SUBINV_CODE);
	//strQuery += " AND SUBINV_CODE = '" + ds_Excel.GetColumn(iRow, "Col04") + "'";
	strQuery += " AND SUBINV_CODE = (SELECT Z.SET1 FROM SCC_COMMON_CODE Z WHERE Z.GROUP_CODE = 'MA0052' AND Z.CODE = '" + ds_Excel.getColumn(iRow, "Col04") + "' AND Z.USE_YN = 'Y')";
	if (fn_sql_common("P", strQuery).rowcount < 1)
	{
		g_Message("EE","(" + (iRow+1) + "행)입금창고가 올바르지 않습니다!");
		return false;
	}
	else
	{
		ds_listInput.setColumn(ds_listInput.rowposition, "SUBINV_CODE", ds_common.getColumn(0, "SUBINV_CODE"));
		ds_listInput.setColumn(ds_listInput.rowposition, "SUBINV_CODENM", ds_common.getColumn(0, "SUBINV_NAME"));
	}
	//고객사, 공란인 경우 999998:기타(개인)
	strQuery = eval(eval("st_" + gfn_subStr(edtBtn_CUSTCD.name, 7)).userdata) + getAddWhere(edtBtn_CUSTCD);
	strQuery += " AND A.CUSTCD = (SELECT Z.SET1 FROM SCC_COMMON_CODE Z WHERE Z.GROUP_CODE = 'MA0049' AND Z.CODE = NVL('" + ds_Excel.getColumn(iRow, "Col06") + "','DEF') AND Z.USE_YN = 'Y')";
	if (fn_sql_common("P", strQuery).rowcount < 1)
	{
		g_Message("EE","(" + (iRow+1) + "행)고객사코드가 올바르지 않습니다!");
		return false;
	}
	else
	{
		ds_listInput.setColumn(ds_listInput.rowposition, "CUSTCD", ds_common.getColumn(0, "CUSTCD"));
		ds_listInput.setColumn(ds_listInput.rowposition, "CUSTCDNM", ds_common.getColumn(0, "CUSTNM"));
	}
	//금액
	if ( ffn_ChkNull(ds_Excel.getColumn(iRow, "Col10")) || (toNumber(ds_Excel.getColumn(iRow, "Col10")) <= 0) )
	{
		g_Message("EE","(" + (iRow+1) + "행)금액이 올바르지 않습니다!");
		return false;
	}
	else
	{
		ds_listInput.setColumn(ds_listInput.rowposition, "AMT", ds_Excel.getColumn(iRow, "Col10"));
	}
	//식수
	if ( ffn_ChkNull(ds_Excel.getColumn(iRow, "Col09")) || (toNumber(ds_Excel.getColumn(iRow, "Col09")) <= 0) )
	{
		g_Message("EE","(" + (iRow+1) + "행)식수가 올바르지 않습니다!");
		return false;
	}
	else
	{
		ds_listInput.setColumn(ds_listInput.rowposition, "QTY", ds_Excel.getColumn(iRow, "Col09"));
	}
	//단가:자동계산
	//수수료
	if (ds_Type.getColumn(0, "FEE_REG_YN") == "Y")
	{
		if ( toNumber(ds_Excel.getColumn(iRow, "Col11")) < 0)
		{
			g_Message("EE","(" + (iRow+1) + "행)수수료가 올바르지 않습니다!");
			return false;
		}
		ds_listInput.setColumn(ds_listInput.rowposition, "FEE", ds_Excel.getColumn(iRow, "Col11"));
	}
	//카드사
	if (ds_Type.getColumn(0, "ADITEM2_CHK_YN") == "R")
	{
		if (ffn_ChkNull(ds_Excel.getColumn(iRow, "Col12")))
		{
			g_Message("EE","(" + (iRow+1) + "행)카드사가 누락되었습니다!");
			return false;
		}
	}
	if (
		((ds_Type.getColumn(0, "ADITEM2_CHK_YN") == "R") || (ds_Type.getColumn(0, "ADITEM2_CHK_YN") == "O")) &&
		(!ffn_ChkNull(ds_Excel.getColumn(iRow, "Col12")))
		)
	{
		strQuery = eval(eval("st_" + gfn_subStr(edtBtn_ADITEM2.name, 7)).userdata) + getAddWhere(edtBtn_ADITEM2);
		//strQuery += " AND CODE = '" + ds_Excel.GetColumn(iRow, "Col12") + "' AND USE_YN = 'Y'";
		strQuery += " AND CODE = (SELECT Z.SET1 FROM SCC_COMMON_CODE Z WHERE Z.GROUP_CODE = 'MA0051' AND Z.CODE = '" + ds_Excel.getColumn(iRow, "Col12") + "' AND Z.USE_YN = 'Y') AND USE_YN = 'Y'";
		if (fn_sql_common("P", strQuery).rowcount < 1)
		{
			g_Message("EE","(" + (iRow+1) + "행)카드사가 올바르지 않습니다!");
			return false;
		}
		else
		{
			ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM2", ds_common.getColumn(0, "CODE"));
			ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM2NM", ds_common.getColumn(0, "CODE_NAME"));
		}
	}
	//적요
	if (! ffn_ChkNull(ds_Excel.getColumn(iRow, "Col14")))
		ds_listInput.setColumn(ds_listInput.rowposition, "RCP_DESC", ds_Excel.getColumn(iRow, "Col14"));
	else
		ds_listInput.setColumn(ds_listInput.rowposition, "RCP_DESC", me_RCP_DATE.value + ' ' + ds_listInput.getColumn(ds_listInput.rowposition, "TYPE_NAME"));
	//계좌번호: 'FS-1' + 업장코드로 구성(ex:FS-112331)
	strQuery = eval(eval("st_" + gfn_subStr(edtBtn_ACNTCD.name, 7)).userdata) + getAddWhere(edtBtn_ACNTCD);
	strQuery += " AND ACNTCD_ENC = SC_CRYPTO_FUN('ENC', '" + ("FS-" + edt_UPJANGQuery.userdata) + "', '3') ";
	if (fn_sql_common("P", strQuery).rowcount < 1)
	{
		g_Message("EE","(" + (iRow+1) + "행)계좌번호가 올바르지 않습니다!");
		return false;
	}
	else
		ds_listInput.setColumn(ds_listInput.rowposition, "ACNTCD", ds_common.getColumn(0, "ACNTCD"));
	//
	return true;
}

function fn_SetImpDataSave(iRow)
{
	//저장작업...
	if (!before_SaveCheck("Master"))
	{
		g_Message("EE","(" + (iRow+1) + "행)입금저장 오류사항을 확인하세요!");
		return false;
	}
	//
	return true;
}

function ffn_ChkNull(strData){
	return (gfn_length(gfn_trim(strData))== 0);
}
//============================================================================================
//(2013-06-10 추가) 끝
//============================================================================================
]]></Script>
  </Form>
</FDL>

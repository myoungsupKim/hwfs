<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="CustomerInformationInquiry" classname="GUIDE_class" left="0" top="0" width="540" height="760" titletext="거래처정보조회" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static04" taborder="46" left="0" top="0" height="2" cssclass="sta_WF_TopLine" right="0"/>
        <Static id="Static06" taborder="47" text="h10" cssclass="sta_GUIDE_Area" visible="false" left="0" top="122" width="540" height="10" style="align:center middle;"/>
        <Static id="Static15" taborder="50" text="w10" cssclass="sta_GUIDE_Area" visible="false" left="0" top="129" width="10" height="361" style="align:center middle;"/>
        <Static id="Static02" taborder="82" cssclass="sta_WFSA_LabelBg" left="0" top="63" height="59" right="0"/>
        <Button id="btn_search" taborder="86" text="검색" cssclass="btn_WF_Search" top="69" width="100" height="47" right="9" onclick="btnSearch_onclick" visible="true"/>
        <Static id="sta_upjang" taborder="87" text="거래처" cssclass="sta_WF_Label02" left="560" top="63" width="135" height="59" visible="false"/>
        <Static id="Static05" taborder="92" text="w10" cssclass="sta_GUIDE_Area" visible="false" left="530" top="129" width="10" height="361" style="align:center middle;"/>
        <Grid id="grd_list00" taborder="104" useinputpanel="false" left="10" top="132" width="520" height="421" binddataset="ds_grdCust" scrollbars="none" autosizingtype="row" extendsizetype="row" visible="false" oncellclick="grd_list00_oncellclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="182"/>
                <Column size="283"/>
                <Column size="55"/>
              </Columns>
              <Rows>
                <Row size="0" band="head"/>
                <Row size="60"/>
                <Row size="60"/>
                <Row size="60"/>
                <Row size="60"/>
                <Row size="60"/>
                <Row size="60"/>
                <Row size="60"/>
              </Rows>
              <Band id="head">
                <Cell text="Column0"/>
                <Cell col="1" text="Column1"/>
                <Cell col="2"/>
              </Band>
              <Band id="body">
                <Cell style="align:left;padding:0 5 0 10;background:#74748aff;background2:#74748aff;color:#ffffffff;color2:#ffffffff;selectbackground:#74748aff;selectcolor:#ffffffff;" cssclass="CellGrd_WF_LabelIndigo" text="담당부서"/>
                <Cell col="1" colspan="2" displaytype="normal" style="align:left middle;padding:0 5 0 10;background:#edededff;background2:#edededff;selectbackground:#edededff;selectcolor:#555555ff;" cssclass="CellGrd_WF_LabelGray" text="bind:ccNm" wordwrap="char" autosizerow="limitmin" autosizecol="default"/>
                <Cell row="1" style="align:left;padding:0 5 0 10;background:#74748aff;background2:#74748aff;color:#ffffffff;color2:#ffffffff;selectbackground:#74748aff;selectcolor:#ffffffff;" cssclass="CellGrd_WF_LabelIndigo" text="영업담당자"/>
                <Cell row="1" col="1" colspan="2" style="align:left middle;padding:0 5 0 10;background:#edededff;background2:#edededff;selectbackground:#edededff;selectcolor:#555555ff;" cssclass="CellGrd_WF_LabelGray" text="bind:mgmtSabunnm" wordwrap="char" autosizerow="limitmin" autosizecol="default"/>
                <Cell row="2" style="align:left;padding:0 5 0 10;background:#74748aff;background2:#74748aff;color:#ffffffff;color2:#ffffffff;selectbackground:#74748aff;selectcolor:#ffffffff;" cssclass="CellGrd_WF_LabelIndigo" text="(고객사)담당자"/>
                <Cell row="2" col="1" colspan="2" style="align:left middle;padding:0 5 0 10;background:#edededff;background2:#edededff;selectbackground:#edededff;selectcolor:#555555ff;" cssclass="CellGrd_WF_LabelGray" text="bind:name" wordwrap="char" autosizerow="limitmin" autosizecol="default"/>
                <Cell row="3" style="align:left;padding:0 5 0 10;background:#74748aff;background2:#74748aff;color:#ffffffff;color2:#ffffffff;selectbackground:#74748aff;selectcolor:#ffffffff;" cssclass="CellGrd_WF_LabelIndigo" text="연락처"/>
                <Cell row="3" col="1" style="align:left middle;padding:0 5 0 10;line:0 solid #808080ff,0 solid #808080ff,1 solid #808080ff,0 solid #808080ff;background:#edededff;background2:#edededff;selectbackground:#edededff;selectcolor:#555555ff;" cssclass="CellGrd_WF_LabelGray" text="bind:hpTel" wordwrap="char" autosizerow="limitmin" autosizecol="default"/>
                <Cell row="3" col="2" displaytype="expr:hpTel == &quot;&quot;?&quot;normal&quot;:(hpTel == &quot;--&quot;?&quot;normal&quot;:&quot;button&quot;)" edittype="button" style="padding:5 5 5 0;background:#edededff;background2:#edededff;selectbackground:#edededff;controlbackground:black URL('HWImage::btn_WF_Phone.png');"/>
                <Cell row="4" style="align:left;padding:0 5 0 10;background:#74748aff;background2:#74748aff;color:#ffffffff;color2:#ffffffff;selectbackground:#74748aff;selectcolor:#ffffffff;" cssclass="CellGrd_WF_LabelIndigo" text="주소"/>
                <Cell row="4" col="1" colspan="2" style="align:left middle;padding:0 5 0 10;background:#edededff;background2:#edededff;selectbackground:#edededff;selectcolor:#555555ff;" cssclass="CellGrd_WF_LabelGray" text="bind:addr" wordwrap="char" autosizerow="limitmin" autosizecol="default"/>
                <Cell row="5" style="align:left;padding:0 5 0 10;background:#74748aff;background2:#74748aff;color:#ffffffff;color2:#ffffffff;selectbackground:#74748aff;selectcolor:#ffffffff;" cssclass="CellGrd_WF_LabelIndigo" text="직군1"/>
                <Cell row="5" col="1" colspan="2" style="align:left middle;padding:0 5 0 10;background:#edededff;background2:#edededff;selectbackground:#edededff;selectcolor:#555555ff;" cssclass="CellGrd_WF_LabelGray" text="bind:jobCdnm" wordwrap="char" autosizerow="limitmin" autosizecol="default"/>
                <Cell row="6" cssclass="CellGrd_WF_LabelIndigo" text="지역1"/>
                <Cell row="6" col="1" colspan="2" style="align:left middle;padding:0 5 0 10;background:#edededff;background2:#edededff;selectbackground:#edededff;selectcolor:#555555ff;" text="bind:locCdnm" wordwrap="char" autosizerow="limitmin"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static03" taborder="107" text="w07" cssclass="sta_GUIDE_Area2" visible="false" left="523" top="325" width="7" height="29"/>
        <Edit id="edt_upjang" taborder="108" left="673" top="69" height="47" visible="false" readonly="true" width="312"/>
        <Static id="Static08" taborder="109" text="글자사이간격w20" cssclass="sta_GUIDE_Area2" visible="false" left="93" top="78" width="20" height="29"/>
        <Button id="btn_upjang" taborder="111" onclick="btn_upjang_onclick" cssclass="btn_WF_EdtSearch" top="69" right="-444" width="47" height="47" visible="false"/>
        <Button id="btn_cust00" taborder="112" text="가망고객" onclick="btn_cust00_onclick" cssclass="btn_WF_TabMFOn" visible="true" left="0" top="0" width="270" height="63"/>
        <Button id="btn_cust01" taborder="113" text="거래고객" onclick="btn_cust01_onclick" cssclass="btn_WF_TabMFOff" visible="true" left="270" top="0" width="270" height="63"/>
        <Static id="sta_sabun" taborder="114" text="고객명" cssclass="sta_WF_Label02" left="0" top="63" width="135" height="59" visible="false" onclick="sta_sabun_onclick"/>
        <Edit id="edt_sabun" taborder="115" left="113" top="69" height="47" visible="false" readonly="true" width="312"/>
        <Button id="btn_sabun" taborder="116" onclick="btn_upjang_onclick" cssclass="btn_WF_EdtSearch" top="69" width="47" height="47" visible="false" right="116"/>
        <Grid id="grd_list01" taborder="117" binddataset="ds_grdUpjang" scrollbars="none" useinputpanel="false" extendsizetype="none" autosizingtype="row" left="546" top="132" width="520" height="601" visible="false" oncellclick="grd_list01_oncellclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="183"/>
                <Column size="282"/>
                <Column size="55"/>
              </Columns>
              <Rows>
                <Row size="0" band="head"/>
                <Row size="60"/>
                <Row size="60"/>
                <Row size="60"/>
                <Row size="60"/>
                <Row size="60"/>
                <Row size="60"/>
                <Row size="60"/>
                <Row size="60"/>
                <Row size="60"/>
                <Row size="60"/>
              </Rows>
              <Band id="head">
                <Cell text="Column0"/>
                <Cell col="1" text="Column1"/>
                <Cell col="2"/>
              </Band>
              <Band id="body">
                <Cell style="align:left;padding:0 5 0 10;background:#74748aff;background2:#74748aff;color:#ffffffff;color2:#ffffffff;selectbackground:#74748aff;selectcolor:#ffffffff;" cssclass="CellGrd_WF_LabelIndigo" text="담당부서" autosizerow="limitmin"/>
                <Cell col="1" colspan="2" displaytype="normal" style="align:left middle;padding:0 5 0 10;background:#edededff;background2:#edededff;selectbackground:#edededff;selectcolor:#555555ff;" cssclass="CellGrd_WF_LabelGray" text="bind:ccNm" wordwrap="char" autosizerow="limitmin" autosizecol="default"/>
                <Cell row="1" style="align:left;padding:0 5 0 10;background:#74748aff;background2:#74748aff;color:#ffffffff;color2:#ffffffff;selectbackground:#74748aff;selectcolor:#ffffffff;" cssclass="CellGrd_WF_LabelIndigo" text="영업담당자" autosizerow="limitmin"/>
                <Cell row="1" col="1" colspan="2" style="align:left middle;padding:0 5 0 10;background:#edededff;background2:#edededff;selectbackground:#edededff;selectcolor:#555555ff;" cssclass="CellGrd_WF_LabelGray" text="bind:partSalesSabunNm" wordwrap="char" autosizerow="limitmin" autosizecol="default"/>
                <Cell row="2" style="align:left;padding:0 5 0 10;background:#74748aff;background2:#74748aff;color:#ffffffff;color2:#ffffffff;selectbackground:#74748aff;selectcolor:#ffffffff;" cssclass="CellGrd_WF_LabelIndigo" text="CS담당자" autosizerow="limitmin"/>
                <Cell row="2" col="1" style="align:left middle;padding:0 5 0 10;line:0 solid #808080ff,0 solid #808080ff,1 solid #808080ff,0 solid #808080ff;background:#edededff;background2:#edededff;selectbackground:#edededff;selectcolor:#555555ff;" cssclass="CellGrd_WF_LabelGray" text="bind:csSabunNm" wordwrap="char" autosizerow="limitmin" autosizecol="default"/>
                <Cell row="2" col="2" displaytype="expr:csTelNo == &quot;&quot;?&quot;normal&quot;:(csTelNo == &quot;--&quot;?&quot;normal&quot;:&quot;button&quot;)" edittype="button" style="padding:5 5 5 0;background:#edededff;background2:#edededff;selectbackground:#edededff;controlbackground:black URL('HWImage::btn_WF_Phone.png');"/>
                <Cell row="3" style="align:left;padding:0 5 0 10;background:#74748aff;background2:#74748aff;color:#ffffffff;color2:#ffffffff;selectbackground:#74748aff;selectcolor:#ffffffff;" cssclass="CellGrd_WF_LabelIndigo" text="(고객사)담당자" autosizerow="limitmin"/>
                <Cell row="3" col="1" colspan="2" style="align:left middle;padding:0 5 0 10;background:#edededff;background2:#edededff;selectbackground:#edededff;selectcolor:#555555ff;" cssclass="CellGrd_WF_LabelGray" text="bind:drname2" wordwrap="char" autosizerow="limitmin" autosizecol="default"/>
                <Cell row="4" style="align:left;padding:0 5 0 10;background:#74748aff;background2:#74748aff;color:#ffffffff;color2:#ffffffff;selectbackground:#74748aff;selectcolor:#ffffffff;" cssclass="CellGrd_WF_LabelIndigo" text="(고객)연락처" autosizerow="limitmin"/>
                <Cell row="4" col="1" style="align:left middle;padding:0 5 0 10;line:0 solid #808080ff,0 solid #808080ff,1 solid #808080ff,0 solid #808080ff;background:#edededff;background2:#edededff;selectbackground:#edededff;selectcolor:#555555ff;" cssclass="CellGrd_WF_LabelGray" text="bind:custTelNo" wordwrap="char" autosizerow="limitmin" autosizecol="default"/>
                <Cell row="4" col="2" displaytype="expr:custTelNo == &quot;&quot;?&quot;normal&quot;:(custTelNo  == &quot;--&quot;?&quot;normal&quot;:&quot;button&quot;)" edittype="button" style="padding:5 5 5 0;background:#edededff;background2:#edededff;selectbackground:#edededff;controlbackground:black URL('HWImage::btn_WF_Phone.png');" cssclass="CellGrd_WF_LabelGray" wordwrap="none" autosizerow="limitmin" autosizecol="default"/>
                <Cell row="5" cssclass="CellGrd_WF_LabelIndigo" text="(고객)휴대폰"/>
                <Cell row="5" col="1" style="align:left middle;padding:0 5 0 10;line:0 solid #808080ff,0 solid #808080ff,1 solid #808080ff,0 solid #808080ff;background:#edededff;background2:#edededff;selectbackground:#edededff;selectcolor:#555555ff;" text="bind:custHpNo" autosizerow="limitmin"/>
                <Cell row="5" col="2" displaytype="expr:custHpNo == &quot;&quot;?&quot;normal&quot;:(custHpNo  == &quot;--&quot;?&quot;normal&quot;:&quot;button&quot;)" edittype="button" style="padding:5 5 5 0;background:#edededff;background2:#edededff;selectbackground:#edededff;controlbackground:black URL('HWImage::btn_WF_Phone.png');" autosizerow="limitmin"/>
                <Cell row="6" style="align:left;padding:0 5 0 10;background:#74748aff;background2:#74748aff;color:#ffffffff;color2:#ffffffff;selectbackground:#74748aff;selectcolor:#ffffffff;" cssclass="CellGrd_WF_LabelIndigo" text="계좌정보" autosizerow="limitmin"/>
                <Cell row="6" col="1" colspan="2" style="align:left middle;padding:0 5 0 10;background:#edededff;background2:#edededff;selectbackground:#edededff;selectcolor:#555555ff;" cssclass="CellGrd_WF_LabelGray" text="bind:acntcd" wordwrap="char" autosizerow="limitmin" autosizecol="default"/>
                <Cell row="7" cssclass="CellGrd_WF_LabelIndigo" text="주소" autosizerow="limitmin"/>
                <Cell row="7" col="1" colspan="2" style="align:left middle;padding:0 5 0 10;background:#edededff;background2:#edededff;selectbackground:#edededff;selectcolor:#555555ff;" text="bind:addr" wordwrap="char" autosizerow="limitmin"/>
                <Cell row="8" cssclass="CellGrd_WF_LabelIndigo" text="직군1" autosizerow="limitmin"/>
                <Cell row="8" col="1" colspan="2" style="align:left middle;padding:0 5 0 10;background:#edededff;background2:#edededff;selectbackground:#edededff;selectcolor:#555555ff;" text="bind:bizGroup" wordwrap="char" autosizerow="limitmin"/>
                <Cell row="9" cssclass="CellGrd_WF_LabelIndigo" text="지역1" autosizerow="limitmin"/>
                <Cell row="9" col="1" colspan="2" style="align:left middle;padding:0 5 0 10;background:#edededff;background2:#edededff;selectbackground:#edededff;selectcolor:#555555ff;" text="bind:local1" wordwrap="char" autosizerow="limitmin"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
      </Layout>
    </Layouts>
    <Bind/>
    <Objects>
      <Dataset id="ds_grdCust" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="custId" type="STRING" size="256"/>
          <Column id="custnm" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="mgmtSabun" type="STRING" size="256"/>
          <Column id="mgmtSabunnm" type="STRING" size="256"/>
          <Column id="name" type="STRING" size="256"/>
          <Column id="hpTel" type="STRING" size="256"/>
          <Column id="addr" type="STRING" size="256"/>
          <Column id="jobCdnm" type="STRING" size="256"/>
          <Column id="locCdnm" type="STRING" size="256"/>
          <Column id="totCnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grdUpjang" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="upjangnmDisp" type="STRING" size="256"/>
          <Column id="fstRegDate" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="partSalesSabun" type="STRING" size="256"/>
          <Column id="partSalesSabunNm" type="STRING" size="256"/>
          <Column id="csSabunNm" type="STRING" size="256"/>
          <Column id="csTelNo" type="STRING" size="256"/>
          <Column id="drname2" type="STRING" size="256"/>
          <Column id="addr" type="STRING" size="256"/>
          <Column id="custTelNo" type="STRING" size="256"/>
          <Column id="custHpNo" type="STRING" size="256"/>
          <Column id="acntcd" type="STRING" size="256"/>
          <Column id="bizGroup" type="STRING" size="256"/>
          <Column id="local1" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.0"><![CDATA[//########################################################
// [프로젝트]		FC종합전산 모바일시스템 구축
// [시스템명]		거래처정보조회
// [부시스템명]	거래처정보조회 - 조회
// [설명]
// 		부서 검색하기.
// [작성자명] 		강대성
// [작성일자]		2015.02.04
// -----------------[수정이력]--------------------------
// 수정일자 : 수정자 : 수정내용
// 2015.02.04 : 강대성 : 화면 신규.
// 2015.05.20 : 강대성 : 프로그램 수정(가망고객 및 거래고객)
//########################################################
include "lib::lib_Com.xjs"

/*======================================================
 전역변수
 ======================================================*/
this.upjang = undefined;
this.gubun = undefined;
this.phonNumber = undefined;
this.mgmtSabun = undefined;
this.auth = 1;

// 모바일런타임deviceAPI용
this.fspmob;
/*================================================================================
 * 2. Form관련 Script
 *===============================================================================*/
/** 
 * Form의 모든 컴포넌트가 생성되고, 모든 Object가 Load 되었을 때에 발생하는 Event
 * @param
	obj : Event가 발생한 Object
	e : Event Object
 * @return : 없음
 */ 
this.form_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{	
	//필수
	this.fn_init();
	
	// 필수(모바일런타임 DeviceAPI사용
	this.fspmob = new nexacro.FSPMobile();
	this.fspmob.addEventHandler("onsuccess", this.on_success, this);
	this.fspmob.addEventHandler("onerror", this.on_error, this);
}

//초기값
this.fn_init = function ()
{
	this.gubun = "00";
	// 메뉴권한에 따른 버튼 활성화 및 디폴트값 설정
	this.auth = this.fn_SetBtnControl("this.btn_search","");	
	
	// 권한에 따른 버튼 활성화 및 디폴트값 설정
	this.fn_SetAuth("this.edt_sabun", "this.btn_sabun");
	
	//초기값 가망고객 layer보여줌
	this.sta_sabun.set_visible(true);
	this.edt_sabun.set_visible(true);
	this.btn_sabun.set_visible(true);
	this.grd_list00.set_visible(true);	
	
	this.upjang = application.g_Upjang;	
	
	if(this.ds_grdCust.getRowCount() == 0){
		var nRow = this.ds_grdCust.addRow();		
		this.ds_grdCust.setColumn(nRow,"hpTel", "");
	}	
	
	this.edt_sabun.set_enable(true);
	this.btn_sabun.set_enable(true);
}

//상단 버튼에 따라 cssclass변경
this.btn_cust00_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	// 메뉴권한에 따른 버튼 활성화 및 디폴트값 설정
	this.auth = this.fn_SetBtnControl("this.btn_search","");	
	
	// 권한에 따른 버튼 활성화 및 디폴트값 설정
	this.fn_SetAuth("this.edt_upjang", "this.btn_upjang");
	
	this.btn_cust00.set_cssclass("btn_WF_TabMFOn");
	this.btn_cust01.set_cssclass("btn_WF_TabMFOff");
	this.gubun = "00";
	
	//초기값 가망고객 layer보여줌
	this.sta_sabun.set_visible(true);
	this.edt_sabun.set_visible(true);
	this.btn_sabun.set_visible(true);
	this.grd_list00.set_visible(true);	
		
	//초기값 거래고객 layer숨김
	this.sta_upjang.set_visible(false);
	this.edt_upjang.set_visible(false);
	this.btn_upjang.set_visible(false);
	this.grd_list01.set_visible(false);
	
	if(this.ds_grdCust.getRowCount() == 0){
		var nRow = this.ds_grdCust.addRow();		
		this.ds_grdCust.setColumn(nRow,"hpTel", "");
	}	
	
	this.edt_sabun.set_enable(true);
	this.btn_sabun.set_enable(true);
	
}

//상단 버튼에 따라 cssclass변경
this.btn_cust01_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	// 메뉴권한에 따른 버튼 활성화 및 디폴트값 설정
	this.auth = this.fn_SetBtnControl("this.btn_search","");	
	
	// 권한에 따른 버튼 활성화 및 디폴트값 설정
	this.fn_SetAuth("this.edt_upjang", "this.btn_upjang");
	
	this.btn_cust00.set_cssclass("btn_WF_TabMFOff");
	this.btn_cust01.set_cssclass("btn_WF_TabMFOn");
	this.gubun = "01";
	
	//초기값 가망고객 layer보여줌
	this.sta_sabun.set_visible(false);
	this.edt_sabun.set_visible(false);
	this.btn_sabun.set_visible(false);
	this.grd_list00.set_visible(false);	
		
	//초기값 거래고객 layer숨김
	this.sta_upjang.set_visible(true);
	this.edt_upjang.set_visible(true);
	this.btn_upjang.set_visible(true);
	this.grd_list01.set_visible(true);
		
	//위치값 조정
	this.sta_upjang.set_left(0);
	this.edt_upjang.set_left(113);
	this.btn_upjang.set_right(116);
	this.grd_list01.set_left(10);
	
	if(this.ds_grdUpjang.getRowCount() == 0){
		var nRow = this.ds_grdUpjang.addRow();		
		this.ds_grdUpjang.setColumn(nRow,"csTelNo", "");
		this.ds_grdUpjang.setColumn(nRow,"custTelNo", "");
		this.ds_grdUpjang.setColumn(nRow,"custHpNo", "");
	}	
	
	this.edt_upjang.set_enable(true);
	this.btn_upjang.set_enable(true);	
}

/** 
 * 가망고객 및 업장 팝업 호출
 */
this.btn_upjang_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{	
	//가망고객 선택시(가망고객 검색 팝업 창 호출)
	if(this.gubun == "00"){
		var arg = new Array();
		arg[0] = this.auth;
	
		application.goMain.gfn_POP_create("searchSabun", "M_MSM::CustMgmtSearchPop.xfdl", "fn_callbackPOP", this, arg, "POP", application.goMain.divBase);
		return false;
		
	//거래고객 선택시(사업장 검색 팝업 창 호출)
	}else if(this.gubun = "01"){
		var arg = new Array();
		//arg[0] = this.edt_upjang.value;
		arg[1] = this.upjang;
		arg[2] = "FMS";
		/*
		if(application.g_AuthLevel == "999" || application.g_AuthLevel == "99" || application.g_AuthLevel == "80" )
		{
			arg[2] = "FMS";		
		}
		else
		{
			arg[2] = "FMS2";
		}
		*/
		application.goMain.gfn_POP_create("upjangNm", "M_MLM::WorkplaceSearchPop2.xfdl", "fn_callbackPOP", this, arg, "POP", application.goMain.divBase);
		return false;	
	}
	
}

/*******************************************************************************
* 기      능   :  검색
* 설      명   :  등록
********************************************************************************/
this.btnSearch_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.fn_search();	
}

this.fn_search = function()
{
	if(this.gubun == "01"){
	
		this.ds_grdUpjang.clearData();
		
		if ( this.gfn_isNull(this.edt_upjang.value) )
		{
			application.goMain.gfn_Msg("ALERT_0", "알림", "거래처명을 입력하십시요", "OK");
			return;
		}
		
		//검색
		var strSvcID   		 = "searchUpjang";
		var strUrl     		 = "ms/msm/customerInformationInquiry/selectUpjangList.xdo";
		var strInDataset     = "";
		var strOutDataset    = "ds_grdUpjang=ds_list";
		var strArguments	 = "upjang=" + nexacro.wrapQuote(this.upjang);
		    strArguments     += " maskAuth=" + nexacro.wrapQuote(this.auth); //입력권한에 따른 마스크 여부를 위해 maskAuth전달함
		var strCallbackFunc	 = "fn_callBack";
		var bAsync			 = true;

		this.gfn_transaction(this, strSvcID, strUrl, strInDataset, strOutDataset, strArguments, strCallbackFunc, bAsync);
		// connect the server 
	
	}	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
this.fn_callBack = function (strSvcID, nErrorCode, strErrorMsg)
{	
	
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {		
		//가망고객 조회시
        case "searchSabun" :
			// 조회 건수 확인  
            if (this.ds_grdCust.getRowCount() == 0) 
            {
                application.goMain.gfn_Msg("alertTest", "Information", "조회되는 내용이 없습니다.", "OK");	//조회되는 내용이 없습니다..
                return;
            }else{
						
            }			
  			break;
		//거래고객 조회시
        case "searchUpjang" :
			// 조회 건수 확인  
            if (this.ds_grdUpjang.getRowCount() == 0) 
            {
                application.goMain.gfn_Msg("alertTest", "Information", "조회되는 내용이 없습니다.", "OK");	//조회되는 내용이 없습니다..
                return;
            }else{
				
				this.partSalesSabun = this.ds_grdUpjang.getColumn(this.ds_grdUpjang.rowposition, "partSalesSabun");	//cs담당자 사번	
				
				//해당 영업사원이 아니면 cs담당자, (고객사)담당자, (고객)연락처, 계좌정보 및 주소는 숨긴다.
				if ( (this.partSalesSabun != application.g_EmpNo && application.g_AuthLevel != "99") ) {
					this.grd_list01.set_autosizingtype("none");
					this.grd_list01.setFormatRowProperty(3, "size", 0); 
					this.grd_list01.setFormatRowProperty(4, "size", 0);
					this.grd_list01.setFormatRowProperty(5, "size", 0);
					this.grd_list01.setFormatRowProperty(6, "size", 0);
					this.grd_list01.setFormatRowProperty(7, "size", 0);
					this.grd_list01.setFormatRowProperty(8, "size", 0);	
					this.grd_list01.set_height(241);
							
				}else{
					this.grd_list01.set_autosizingtype("row");
					this.grd_list01.setFormatRowProperty(3, "size", 60); 
					this.grd_list01.setFormatRowProperty(4, "size", 60);
					this.grd_list01.setFormatRowProperty(5, "size", 60);
					this.grd_list01.setFormatRowProperty(6, "size", 60);
					this.grd_list01.setFormatRowProperty(7, "size", 60);
					this.grd_list01.setFormatRowProperty(8, "size", 60);
					this.grd_list01.set_height(601);
				}				
            }			
  			break;  		
    }    
   
}

/** 
 * 팝업 callBack
 * @param  : popname - 팝업을 구분짓는 id
 rtn : 팝업이 닫히면서 전달된 값
 * @return : 없음
 */
this.fn_callbackPOP = function (popname, rtn)
{
	switch (popname)
	{		
		case "searchSabun":
			this.edt_sabun.set_value(rtn[0]);
			
			this.ds_grdCust.setColumn(0, "ccNm", rtn[1])        //부서명
			this.ds_grdCust.setColumn(0, "mgmtSabunnm", rtn[3]) //담당자명
			this.ds_grdCust.setColumn(0, "name", rtn[4])        //고객명
			this.ds_grdCust.setColumn(0, "hpTel", rtn[5])       //고객연락처
			this.ds_grdCust.setColumn(0, "addr", rtn[6])        //고객주소
			this.ds_grdCust.setColumn(0, "jobCdnm", rtn[7])     //직군1
			this.ds_grdCust.setColumn(0, "locCdnm", rtn[8])     //지역1
			
			this.mgmtSabun = rtn[2];	//담당자 사번
			
			if(!(this.mgmtSabun == application.g_EmpNo || application.g_AuthLevel == "999")){
				
				this.grd_list00.set_autosizingtype("none");
				this.grd_list00.setFormatRowProperty(3, "size", 0); 
				this.grd_list00.setFormatRowProperty(4, "size", 0);
				this.grd_list00.setFormatRowProperty(5, "size", 0);
				this.grd_list00.set_height(241);
				
			}else{
				
				this.grd_list00.set_autosizingtype("none");
				this.grd_list00.setFormatRowProperty(3, "size", 60); 
				this.grd_list00.setFormatRowProperty(4, "size", 60);
				this.grd_list00.setFormatRowProperty(5, "size", 60);
				this.grd_list00.set_height(421);
			}
			
			break;
		case "upjangNm":
			this.edt_upjang.set_value(rtn[1]);
			this.upjang = rtn[0];
			this.fn_search();
			break;
	}
}

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/

// 바로걸기
this.btn_directPhone_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	// 모바일런타임전환으로 fspmob 함수 변경	20150708  김광호
	// this.fspmob_call(this, this.phonNumber, "call_callback");
	this.fspmob.call(nexacro.parseInt(this.phonNumber));
}

// 전화 앱 연결(가망고객)
this.grd_list00_oncellclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.cell == "8"){
		this.phonNumber = this.ds_grdCust.getColumn(this.ds_grdCust.rowposition, "hpTel");
		
		if (!(this.gfn_isNull(this.phonNumber) || this.phonNumber == "--"))
		{
			// 모바일런타임전환으로 fspmob 함수 변경	20150707  김광호
			// this.fspmob_dial(this, this.phonNumber, "call_callback");
			this.fspmob.dial(this.phonNumber);
		}
	}
}

// 전화 앱 연결(거래고객)
this.grd_list01_oncellclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	if(e.cell == "6"){
		this.phonNumber = this.ds_grdUpjang.getColumn(this.ds_grdUpjang.rowposition, "csTelNo");
		
		if (!(this.gfn_isNull(this.phonNumber) || this.phonNumber == "--"))
		{
			// 모바일런타임전환으로 fspmob 함수 변경	20150707  김광호
			// this.fspmob_dial(this, this.phonNumber, "call_callback");
			this.fspmob.dial(this.phonNumber);
		}
	}else if(e.cell == "11"){
		this.phonNumber = this.ds_grdUpjang.getColumn(this.ds_grdUpjang.rowposition, "custTelNo");
		
		if (!(this.gfn_isNull(this.phonNumber) || this.phonNumber == "--"))
		{
			// 모바일런타임전환으로 fspmob 함수 변경	20150707  김광호
			// this.fspmob_dial(this, this.phonNumber, "call_callback");
			this.fspmob.dial(this.phonNumber);
		}
	}else if(e.cell == "14"){
		this.phonNumber = this.ds_grdUpjang.getColumn(this.ds_grdUpjang.rowposition, "custHpNo");
		
		if (!(this.gfn_isNull(this.phonNumber) || this.phonNumber == "--"))
		{
			// 모바일런타임전환으로 fspmob 함수 변경	20150707  김광호
			// this.fspmob_dial(this, this.phonNumber, "call_callback");
			this.fspmob.dial(this.phonNumber);
		}
	}
}

// 모바일런타임 전환으로 추가   20150707  김광호
this.on_success = function(obj,e)
{
	if (e.reason == "10")
	{
	//	this.alert("on_success :: obj :: "+obj.name+" :: e = "+e.reason);
// 		var obj = this.ta0;
// 		
// 		obj.set_value(e.reason + " : " + JSON.stringify(e.returnvalue) );
		this.trace(e.errormsg);
	}
	else if (e.reason == "9")
	{
		application.goMain.gfn_Msg("ALERT_0", "메세지", e.errormsg, "OK", true, this);
		return false;
	}
}

// 모바일런타임 전환으로 추가   20150707  김광호
this.on_error = function(obj,e)
{
//	this.alert("on_error :: obj :: "+obj.name+" :: e = "+e.reason);
	//alert(e.reason);
	if (e.reason == "10")
	{
// 		var obj = this.ta0;
// 		obj.set_value(e.reason + " : " + e.errormsg );
	
		application.goMain.gfn_Msg("ALERT_0", "메세지", e.errormsg, "OK", true, this);
		return false;
	}
	else if (e.reason == "9")
	{
		trace(e.errormsg);
		return false;
	}
}



this.sta_sabun_onclick = function(obj:Static,  e:nexacro.ClickEventInfo)
{
	if ( application.g_userId == "Z1855902" ) {
		if( !this.btn_cust00.cssclass || this.btn_cust00.cssclass == null ) {
			this.btn_cust00.set_cssclass("btn_WF_TabTFOn");
		} else {
			this.btn_cust00.set_cssclass("");
		}
	}
}
]]></Script>
  </Form>
</FDL>

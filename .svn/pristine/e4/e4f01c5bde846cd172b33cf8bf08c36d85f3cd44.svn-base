<?xml version="1.0" encoding="euc-kr"?>
<query dynamic="true">
	<type>select</type>
	<description><![CDATA[]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>1</result-count>
	<statement>
SELECT '' CLOSE_GUBUN,
			CLOSE_GUBUNNM,
			UPJANG,
			UPJANGNM,
			CLOSE_DATE,
			YN,
			CASE WHEN YN||YN1||YN2||YN3||YN4||YN5 = 'YYYYYY' THEN '전체마감'
            	ELSE '미마감존재' END NOTE 
			
			FROM
	    
	    (
	    	SELECT CLOSE_GUBUN,CLOSE_GUBUNNM,UPJANG,UPJANGNM,CLOSE_DATE,
            		DECODE(YN||CLOSE_YN, 'NN', 'N' ,'Y') YN,
                    DECODE(YN1||CLOSE_YN, 'NN', 'N' ,'Y') YN1,
                    DECODE(YN2||CLOSE_YN1, 'NN', 'N' ,'Y') YN2,
                    DECODE(YN3||CLOSE_YN2, 'NN', 'N' ,'Y') YN3,
                    DECODE(YN4||CLOSE_YN3, 'NN', 'N' ,'Y') YN4,
                    DECODE(YN5||CLOSE_YN4, 'NN', 'N' ,'Y') YN5
                    FROM
			(
						SELECT '' CLOSE_GUBUN,
						       '급식운영일지마감' CLOSE_GUBUNNM,
						       #UPJANG# UPJANG,
						       (SELECT UPJANGNM FROM SCO_UPJANG_MST_V WHERE UPJANG = #UPJANG#) UPJANGNM,
						       MM||DD CLOSE_DATE,
						     --  DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_DATE = A.MM||B.DD), 5, 'Y', 'N') YN,
						   	  'N' CLOSE_YN,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '001' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN1,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '006' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN2,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '008' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN3,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '009' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN4,
						      -- DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_DATE = A.MM||B.DD), 5, '전체마감', '미마감존재') NOTE
						      DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '005' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') YN,
						      DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '004' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') YN1,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '11'), 0, 'N' ,'Y') YN2,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '16'), 0, 'N' ,'Y') YN3,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '19'), 0, 'N' ,'Y') YN4,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '17'), 0, 'N' ,'Y') YN5
						  FROM 
						        (SELECT #CLOSE_DATE# MM
						           FROM DUAL) A,
						        (SELECT LPAD(ROWNUM,2,'0') DD
						        FROM DICT
						        WHERE ROWNUM &lt;= 31) B
						WHERE TO_CHAR(LAST_DAY(TO_DATE(A.MM||'01','YYYYMMDD')),'DD') &gt;= B.DD
			)
			UNION ALL
			
			SELECT CLOSE_GUBUN,CLOSE_GUBUNNM,UPJANG,UPJANGNM,CLOSE_DATE,
            		DECODE(YN||CLOSE_YN, 'NN', 'N' ,'Y') YN,
                    DECODE(YN1||CLOSE_YN, 'NN', 'N' ,'Y') YN1,
                    DECODE(YN2||CLOSE_YN1, 'NN', 'N' ,'Y') YN2,
                    DECODE(YN3||CLOSE_YN2, 'NN', 'N' ,'Y') YN3,
                    DECODE(YN4||CLOSE_YN3, 'NN', 'N' ,'Y') YN4,
                    DECODE(YN5||CLOSE_YN4, 'NN', 'N' ,'Y') YN5
                    FROM
			(
						SELECT '' CLOSE_GUBUN,
						       '재고마감' CLOSE_GUBUNNM,
						       #UPJANG# UPJANG,
						       (SELECT UPJANGNM FROM SCO_UPJANG_MST_V WHERE UPJANG = #UPJANG#) UPJANGNM,
						       MM||DD CLOSE_DATE,
						      DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '004' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') YN,
						      'N' CLOSE_YN,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '001' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN1,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '006' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN2,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '008' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN3,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '009' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN4,
						      DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '005' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') YN1,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '11'), 0, 'N' ,'Y') YN2,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '16'), 0, 'N' ,'Y') YN3,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '19'), 0, 'N' ,'Y') YN4,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '17'), 0, 'N' ,'Y') YN5
						  FROM 
						        (SELECT #CLOSE_DATE# MM
						           FROM DUAL) A,
						        (SELECT LPAD(ROWNUM,2,'0') DD
						        FROM DICT
						        WHERE ROWNUM &lt;= 31) B
						WHERE TO_CHAR(LAST_DAY(TO_DATE(A.MM||'01','YYYYMMDD')),'DD') &gt;= B.DD
			)
			UNION ALL
			
			SELECT CLOSE_GUBUN,CLOSE_GUBUNNM,UPJANG,UPJANGNM,CLOSE_DATE,
            		DECODE(YN||CLOSE_YN1||CLOSE_YN5||CLOSE_YN6, 'NNNN', 'N' ,'Y') YN,
                    DECODE(YN1||CLOSE_YN, 'NN', 'N' ,'Y') YN1,
                    DECODE(YN2||CLOSE_YN, 'NN', 'N' ,'Y') YN2,
                    DECODE(YN3||CLOSE_YN2, 'NN', 'N' ,'Y') YN3,
                    DECODE(YN4||CLOSE_YN3, 'NN', 'N' ,'Y') YN4,
                    DECODE(YN5||CLOSE_YN4, 'NN', 'N' ,'Y') YN5
                    FROM
			(
						SELECT '' CLOSE_GUBUN,
						       '매출마감(급식)' CLOSE_GUBUNNM,
						       #UPJANG# UPJANG,
						       (SELECT UPJANGNM FROM SCO_UPJANG_MST_V WHERE UPJANG = #UPJANG#) UPJANGNM,
						       MM||DD CLOSE_DATE,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '11'), 0, 'N' ,'Y') YN,
			                  'N' CLOSE_YN,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_MEAL_TICKET_SAL_MST WHERE UPJANG_CD = #UPJANG# AND SALE_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '11'), 0, 'N' ,'Y') CLOSE_YN5,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_ADVANCE_OCCUR WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '11'), 0, 'N' ,'Y') CLOSE_YN6,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '001' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN1,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '006' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN2,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '008' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN3,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '009' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN4,
						        DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '005' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') YN1,
						      DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '004' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') YN2,
						      DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '16'), 0, 'N' ,'Y') YN3,
						      DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '19'), 0, 'N' ,'Y') YN4,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '17'), 0, 'N' ,'Y') YN5
						  FROM 
						        (SELECT #CLOSE_DATE# MM
						           FROM DUAL) A,
						        (SELECT LPAD(ROWNUM,2,'0') DD
						        FROM DICT
						        WHERE ROWNUM &lt;= 31) B
						WHERE TO_CHAR(LAST_DAY(TO_DATE(A.MM||'01','YYYYMMDD')),'DD') &gt;= B.DD
			)
			UNION ALL
			
			SELECT CLOSE_GUBUN,CLOSE_GUBUNNM,UPJANG,UPJANGNM,CLOSE_DATE,
            		DECODE(YN||CLOSE_YN2, 'NN', 'N' ,'Y') YN,
                    DECODE(YN1||CLOSE_YN, 'NN', 'N' ,'Y') YN1,
                    DECODE(YN2||CLOSE_YN, 'NN', 'N' ,'Y') YN2,
                    DECODE(YN3||CLOSE_YN1, 'NN', 'N' ,'Y') YN3,
                    DECODE(YN4||CLOSE_YN3, 'NN', 'N' ,'Y') YN4,
                    DECODE(YN5||CLOSE_YN4, 'NN', 'N' ,'Y') YN5
                    FROM
			(
						SELECT '' CLOSE_GUBUN,
						       '매출마감(장례식)' CLOSE_GUBUNNM,
						       #UPJANG# UPJANG,
						       (SELECT UPJANGNM FROM SCO_UPJANG_MST_V WHERE UPJANG = #UPJANG#) UPJANGNM,
						       MM||DD CLOSE_DATE,
						      DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '16'), 0, 'N' ,'Y') YN,
						      'N' CLOSE_YN,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '001' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN1,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '006' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN2,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '008' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN3,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '009' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN4,
						        DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '005' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') YN1,
						      DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '004' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') YN2,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '11'), 0, 'N' ,'Y') YN3,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '19'), 0, 'N' ,'Y') YN4,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '17'), 0, 'N' ,'Y') YN5
						  FROM 
						        (SELECT #CLOSE_DATE# MM
						           FROM DUAL) A,
						        (SELECT LPAD(ROWNUM,2,'0') DD
						        FROM DICT
						        WHERE ROWNUM &lt;= 31) B
						WHERE TO_CHAR(LAST_DAY(TO_DATE(A.MM||'01','YYYYMMDD')),'DD') &gt;= B.DD
			)
			UNION ALL
			
			SELECT CLOSE_GUBUN,CLOSE_GUBUNNM,UPJANG,UPJANGNM,CLOSE_DATE,
            		DECODE(YN||CLOSE_YN3, 'NN', 'N' ,'Y') YN,
                    DECODE(YN1||CLOSE_YN2, 'NN', 'N' ,'Y') YN1,
                    DECODE(YN2||CLOSE_YN, 'NN', 'N' ,'Y') YN2,
                    DECODE(YN3||CLOSE_YN, 'NN', 'N' ,'Y') YN3,
                    DECODE(YN4||CLOSE_YN1, 'NN', 'N' ,'Y') YN4,
                    DECODE(YN5||CLOSE_YN4, 'NN', 'N' ,'Y') YN5
                    FROM
			(
						SELECT '' CLOSE_GUBUN,
						       '매출마감(폐식용유)' CLOSE_GUBUNNM,
						       #UPJANG# UPJANG,
						       (SELECT UPJANGNM FROM SCO_UPJANG_MST_V WHERE UPJANG = #UPJANG#) UPJANGNM,
						       MM||DD CLOSE_DATE,
						      DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '19'), 0, 'N' ,'Y') YN,
						      'N' CLOSE_YN,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '001' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN1,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '006' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN2,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '008' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN3,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '009' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN4,
						      DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '16'), 0, 'N' ,'Y') YN1,
						        DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '005' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') YN2,
						      DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '004' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') YN3,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '11'), 0, 'N' ,'Y') YN4,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '17'), 0, 'N' ,'Y') YN5
			                  
						  FROM 
						        (SELECT #CLOSE_DATE# MM
						           FROM DUAL) A,
						        (SELECT LPAD(ROWNUM,2,'0') DD
						        FROM DICT
						        WHERE ROWNUM &lt;= 31) B
						WHERE TO_CHAR(LAST_DAY(TO_DATE(A.MM||'01','YYYYMMDD')),'DD') &gt;= B.DD
			)
			UNION ALL
			
			SELECT CLOSE_GUBUN,CLOSE_GUBUNNM,UPJANG,UPJANGNM,CLOSE_DATE,
            		DECODE(YN||CLOSE_YN4, 'NN', 'N' ,'Y') YN,
                    DECODE(YN1||CLOSE_YN3, 'NN', 'N' ,'Y') YN1,
                    DECODE(YN2||CLOSE_YN2, 'NN', 'N' ,'Y') YN2,
                    DECODE(YN3||CLOSE_YN, 'NN', 'N' ,'Y') YN3,
                    DECODE(YN4||CLOSE_YN, 'NN', 'N' ,'Y') YN4,
                    DECODE(YN5||CLOSE_YN1, 'NN', 'N' ,'Y') YN5
                    FROM
			(
						SELECT '' CLOSE_GUBUN,
						       '매출마감(특판)' CLOSE_GUBUNNM,
						       #UPJANG# UPJANG,
						       (SELECT UPJANGNM FROM SCO_UPJANG_MST_V WHERE UPJANG = #UPJANG#) UPJANGNM,
						       MM||DD CLOSE_DATE,
						      DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '17'), 0, 'N' ,'Y') YN,
						      'N' CLOSE_YN,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '001' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN1,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '006' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN2,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '008' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN3,
                              DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '009' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') CLOSE_YN4,
						      DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '19'), 0, 'N' ,'Y') YN1,
						      DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '16'), 0, 'N' ,'Y') YN2,
						        DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '005' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') YN3,
						      DECODE((SELECT COUNT(*) FROM MAS_CLOSE_MGMT WHERE UPJANG = #UPJANG# AND CLOSE_GUBUN =  '004' AND CLOSE_DATE = A.MM||B.DD), 0, 'N', 'Y') YN4,
			                  DECODE((SELECT COUNT(*) FROM SLA_IF_UPJANG_SALS_DETAIL WHERE UPJANG_CD = #UPJANG# AND OCCUR_DATE = A.MM||B.DD AND DDDD_CLOSE_YN = 'Y' AND SYS_CLASS = '11'), 0, 'N' ,'Y') YN5
						  FROM 
						        (SELECT #CLOSE_DATE# MM
						           FROM DUAL) A,
						        (SELECT LPAD(ROWNUM,2,'0') DD
						        FROM DICT
						        WHERE ROWNUM &lt;= 31) B
						WHERE TO_CHAR(LAST_DAY(TO_DATE(A.MM||'01','YYYYMMDD')),'DD') &gt;= B.DD
			)			
		)

ORDER BY CLOSE_DATE,CLOSE_GUBUNNM
</statement>
	<input default-name="ds_cond">
		<col name="CLOSE_GUBUN" size="256" type="VARCHAR" description="" /> 	
		<col name="UPJANG" size="22" type="NUMERIC" description="" /> 				
		<col name="CLOSE_DATE" size="256" type="VARCHAR" description="" /> 
	</input>
	<output default-name="ds_list">
		<col name="CLOSE_GUBUN" size="20" type="VARCHAR" description="" /> 
		<col name="CLOSE_GUBUNNM" size="20" type="VARCHAR" description="" /> 
		<col name="UPJANG" size="22" type="NUMERIC" description="" /> 
		<col name="UPJANGNMM" size="20" type="VARCHAR" description="" /> 
		<col name="CLOSE_DATE" size="8" type="VARCHAR" description="" /> 
		<col name="YN" size="8" type="VARCHAR" description="" /> 
	</output>
</query>
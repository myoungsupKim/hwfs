<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSC91030E" onkeydown="frm_OnKeyDown" onload="form_onload" titletext="외부기관점검결과관리" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static0" class="sta_WFDA_Labelbg" position="absolute 140 648 1237 710" anchor="all"/>
        <Static id="Static19" text="기타 특이사항" class="sta_WF_Title01" position="absolute 0 661 137 679" anchor="left top"/>
        <TextArea id="ta_ETC_CONTENTS" taborder="32" imemode="hangul" maxlength="2000" oneditdblclick="ta_SPECIAL_FACT_oneditdblclick" position="absolute 143 650 1234 707" anchor="all"/>
        <Static id="Static17" text="수검사항" class="sta_WF_Title01" position="absolute 0 385 121 403" anchor="default"/>
        <Grid id="grd_detail" taborder="33" binddataset="ds_Detail" autoenter="select" useinputpanel="false" cellsizingtype="col" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" oncellclick="grd_detail_oncellclick" autofittype="col" anchor="left top right" position="absolute 0 402 1237 506" positiontype="position">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="40"/>
                <Column size="105"/>
                <Column size="110"/>
                <Column size="303"/>
                <Column size="235"/>
                <Column size="88"/>
                <Column size="99"/>
                <Column size="44"/>
              </Columns>
              <Rows>
                <Row size="22" band="head"/>
                <Row size="20"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="구분"/>
                <Cell col="2" displaytype="text" text="항목"/>
                <Cell col="3" displaytype="text" text="점검 세부 내용"/>
                <Cell col="4" text="개선 조치 계획"/>
                <Cell col="5" text="개선일자"/>
                <Cell col="6" text="주체"/>
                <Cell col="7" text="사진"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center middle;background:#ffffffff;background2:#ffffffff;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="combo" edittype="combo" style="align:center middle;background:#ffffffff;background2:#ffffffff;" text="bind:CHECKGB"/>
                <Cell col="2" displaytype="combo" edittype="combo" style="align:center middle;background:#ffffffff;background2:#ffffffff;" text="bind:CHECKDTL"/>
                <Cell col="3" displaytype="text" edittype="normal" style="background:#ffffffff;background2:#ffffffff;" text="bind:CHECK_CONTENTS" suppress="0"/>
                <Cell col="4" displaytype="text" edittype="normal" text="bind:IMPRV_CONTENTS"/>
                <Cell col="5" displaytype="date" edittype="date" text="bind:IMPRV_DT"/>
                <Cell col="6" displaytype="combo" edittype="combo" text="bind:MAIN_AGENT"/>
                <Cell col="7" style="background:EXPR(iif(IMGE_CNT&gt;0,grd_list_BKimg('popup1'), grd_list_BKimg('camera1')));background2:EXPR(iif(IMGE_CNT&gt;0,grd_list_BKimg('popup1'), grd_list_BKimg('camera1')));selectbackground:EXPR(iif(IMGE_CNT&gt;0,grd_list_BKimg('popup1'), grd_list_BKimg('camera1')));"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static39" text="수거검사내역" class="sta_WF_Title01" position="absolute 0 524 121 542" anchor="default"/>
        <Grid id="grd_detail1" taborder="34" binddataset="ds_Detail1" autoenter="select" useinputpanel="false" cellsizingtype="col" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" anchor="left top right" position="absolute 0 541 1237 645" positiontype="position">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="40"/>
                <Column size="90"/>
                <Column size="300"/>
                <Column size="151"/>
                <Column size="119"/>
              </Columns>
              <Rows>
                <Row size="22" band="head"/>
                <Row size="20"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="구분"/>
                <Cell col="2" displaytype="text" text="수거품목"/>
                <Cell col="3" displaytype="text" text="수거시상태"/>
                <Cell col="4" text="시료이동방법"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center middle;background:#ffffffff;background2:#ffffffff;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="combo" edittype="combo" style="align:center middle;background:#ffffffff;background2:#ffffffff;" text="bind:CHECKGB"/>
                <Cell col="2" displaytype="text" edittype="normal" style="align:left middle;background:#ffffffff;background2:#ffffffff;" text="bind:PUMMOK"/>
                <Cell col="3" displaytype="text" edittype="normal" style="background:#ffffffff;background2:#ffffffff;" text="bind:STATUS" suppress="3"/>
                <Cell col="4" displaytype="combo" edittype="combo" text="bind:MOVEGB"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static100" text="* 환경 : 칼, 도마, 종사자 손 등(ATP 청결도 검사 포함) * 식품 : 식재료, 반제품, 완제품, 음용수, 조리용수 등" class="sta_WF_DiscInfo" position="absolute 463 523 1237 538" anchor="default"/>
        <Button id="btn_input1" taborder="3" onclick="btn_input1_onclick" class="btn_WF_GrdPlus" enable="false" position="absolute 412 381 430 401" userdata="" anchor="default"/>
        <Button id="btn_delete1" taborder="2" onclick="btn_delete1_onclick" class="btn_WF_GrdMinus" enable="false" position="absolute 432 381 450 401" userdata="" anchor="default"/>
        <Button id="btn_input2" taborder="1" class="btn_WF_GrdPlus" enable="false" position="absolute 412 520 430 540" userdata="" onclick="btn_input2_onclick" anchor="default"/>
        <Button id="btn_delete2" taborder="0" class="btn_WF_GrdMinus" enable="false" position="absolute 432 520 450 540" userdata="" onclick="btn_delete2_onclick" anchor="default"/>
        <Static id="Static1" position="absolute 0 230 1237 257" class="sta_WFDA_Labelbg" anchor="left top right"/>
        <Button enable="false" id="btn_CHARGE" onclick="btn_CHARGE_SABUN_OnClick" taborder="27" text="" position="absolute 295 233 316 254" class="btn_WF_popSearch" image="" anchor="default"/>
        <Static id="Static03" position="absolute 0 204 1237 231" class="sta_WFDA_Labelbg" anchor="left top right"/>
        <Static id="Static00" text="운영부서" position="absolute 0 204 85 231" class="sta_WFDA_Label01" anchor="default"/>
        <Static id="Static8" text="점      장" position="absolute 0 230 85 257" class="sta_WFDA_Label01" anchor="default"/>
        <Static id="Static15" text="사업부장" position="absolute 317 204 402 231" class="sta_WFDA_Label01" anchor="default"/>
        <Static id="Static22" text="인허가구분" position="absolute 317 230 402 257" class="sta_WFDA_Label01" anchor="default"/>
        <Edit autoselect="true" id="ed_CHARGE_SABUN_NM" imemode="native" readonly="true" taborder="10" position="absolute 87 233 295 254" anchor="default"/>
        <Static id="Static05" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 164 450 179" anchor="left top"/>
        <Static id="st_playtime" position="absolute 708 259 1022 280" style="align:left middle;"/>
        <Static id="Static13" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 372 450 385" anchor="default"/>
        <Static id="Static21" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 192 450 197" anchor="left top"/>
        <Static id="Static23" text="사업장 정보" position="absolute 0 179 159 197" anchor="left top" class="sta_WF_Title01"/>
        <Edit id="ed_TM_NM" taborder="7" readonly="true" autoselect="true" position="absolute 87 208 295 229"/>
        <Button id="btn_TMNM" taborder="28" class="btn_WF_popSearch" enable="false" position="absolute 295 208 316 229" onclick="btn_TMNM_onclick"/>
        <Edit id="ed_TEAM_MST_SABUN_NM" taborder="8" readonly="true" autoselect="true" position="absolute 404 208 612 229"/>
        <Button id="btn_TEAMMST" taborder="29" class="btn_WF_popSearch" enable="false" position="absolute 612 208 633 229" onclick="btn_TEAMMST_onclick"/>
        <Static id="Static04" text="운영팀장" class="sta_WFDA_Label01" position="absolute 633 204 718 231"/>
        <Edit id="ed_SUBTEAM_MST_SABUN_NM" taborder="9" readonly="true" autoselect="true" position="absolute 720 208 928 229"/>
        <Button id="btn_SUBTEAMMST" taborder="30" class="btn_WF_popSearch" enable="false" position="absolute 928 208 949 229" onclick="btn_SUBTEAMMST_onclick"/>
        <Combo id="cbo_permissionType" taborder="11" innerdataset="@ds_PERMISSION_TYPE" codecolumn="CODE" datacolumn="CODE_NAME" position="absolute 404 233 558 254" anchor="default"/>
        <Static id="Static10" class="sta_WFDA_Labelbg" position="absolute 0 320 1237 347" anchor="left top right"/>
        <Static id="Static11" class="sta_WFDA_Labelbg" position="absolute 0 294 1237 321" anchor="left top right"/>
        <Static id="Static12" text="방문기관" class="sta_WFDA_Label01" position="absolute 0 294 85 321"/>
        <Static id="Static16" text="기관명" class="sta_WFDA_Label01" position="absolute 0 320 85 347"/>
        <Static id="Static24" text="점검유형" class="sta_WFDA_Label01" position="absolute 317 294 402 321"/>
        <Static id="Static25" text="방문자" class="sta_WFDA_Label01" position="absolute 317 320 402 347"/>
        <Edit id="ed_AGENCY_NM" taborder="15" readonly="false" autoselect="true" position="absolute 87 323 316 344" imemode="hangul" class="edt_WF_Essential"/>
        <Static id="Static26" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 282 450 287" anchor="left top"/>
        <Static id="Static27" text="방문기관 정보" class="sta_WF_Title01" position="absolute 0 269 159 287" anchor="left top"/>
        <Static id="Static28" text="방문일자" class="sta_WFDA_Label01" position="absolute 633 294 718 321"/>
        <Combo id="cbo_agencyType" taborder="12" innerdataset="@ds_AGENCY_TYPE" codecolumn="CODE" datacolumn="CODE_NAME" position="absolute 87 297 315 318" class="cmb_WF_Essential"/>
        <Static id="Static29" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 254 450 269" anchor="left top"/>
        <Combo id="cbo_checkType" taborder="13" innerdataset="@ds_CHECK_TYPE" codecolumn="CODE" datacolumn="CODE_NAME" position="absolute 404 297 632 318" class="cmb_WF_Essential"/>
        <MaskEdit id="me_VISIT_DT" taborder="14" type="string" mask="####-##-##" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" oneditclick="g_Date_OnFocus" class="msk_WF_EssentialCal" position="absolute 720 297 800 318" userdata=""/>
        <Button id="btn_FROM_DT00" taborder="31" tabstop="false" onclick="g_CalButton_OnClick" class="btn_WF_cal" position="absolute 799 297 819 318" userdata="me_VISIT_DT"/>
        <Edit id="ed_VISIT_NM" taborder="16" imemode="hangul" position="absolute 404 323 632 344"/>
        <Static id="Static30" text="확인서청구" class="sta_WFDA_Label01" position="absolute 633 320 718 347"/>
        <Combo id="cbo_CONFIRM_YN" taborder="17" innerdataset="@ds__YN_GUBUN" codecolumn="CODE" datacolumn="code_name" position="absolute 720 323 819 344" class="cmb_WF_Essential"/>
        <Static id="Static31" class="sta_WFDA_Labelbg" position="absolute 0 346 1237 373" anchor="left top right"/>
        <Combo id="cbo_PICK_CHECK_YN" taborder="20" innerdataset="@ds__YN_GUBUN" codecolumn="CODE" datacolumn="code_name" position="absolute 720 349 819 370" class="cmb_WF_Essential"/>
        <Static id="Static32" text="수거검사" class="sta_WFDA_Label01" position="absolute 633 346 718 373"/>
        <Edit id="ed_CHECK_CONTENTS" taborder="19" imemode="hangul" position="absolute 404 349 632 370" onsetfocus="ed_CHECK_CONTENTS_onsetfocus"/>
        <Static id="Static33" text="내용" class="sta_WFDA_Label01" position="absolute 317 346 402 373"/>
        <Static id="Static34" text="행정처분적발" class="sta_WFDA_Label01" position="absolute 0 346 85 373"/>
        <Combo id="cbo_EXPOSE_YN" taborder="18" innerdataset="@ds__YN_GUBUN" codecolumn="CODE" datacolumn="code_name" position="absolute 87 349 186 370" class="cmb_WF_Essential"/>
        <Static id="Static01" position="absolute 0 30 1237 71" class="sta_WFSA_Labelbg" anchor="left top right"/>
        <Static id="st_UPJANG" text="사 업 장" position="absolute 15 40 77 61" class="sta_WFSA_label"/>
        <MaskEdit id="me_FROM_DT" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="5" type="string" userdata="btn_FROM_DT" position="absolute 411 40 491 61" class="msk_WF_EssentialCal"/>
        <Button id="btn_FROM_DT" onclick="g_CalButton_OnClick" taborder="23" tabstop="false" userdata="me_FROM_DT" position="absolute 490 40 511 61" class="btn_WF_calEssential" text="" image="" anchor="default"/>
        <Static id="Static7" text="~" position="absolute 519 40 527 61" style="align:center middle;"/>
        <MaskEdit id="me_TO_DT" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="6" type="string" userdata="btn_TO_DT" position="absolute 535 40 615 61" class="msk_WF_EssentialCal"/>
        <Button id="btn_TO_DT" onclick="g_CalButton_OnClick" taborder="24" tabstop="false" userdata="me_TO_DT" position="absolute 614 40 635 61" class="btn_WF_calEssential" text="" image="" anchor="default"/>
        <Static id="Static14" text="기    간" position="absolute 348 40 405 61" class="sta_WFSA_label"/>
        <Div id="div_cmnBtn" taborder="25" text="Div0" url="cmn::CmnBtn.xfdl" position="absolute 0 0 1237 30" anchor="left top right" scrollbars="none"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Static id="Static36" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 71 40 81 61" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 318 40 348 61" anchor="left top"/>
        <Static id="Static37" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 401 40 411 61" anchor="left top"/>
        <Static id="Static38" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 635 40 665 61" anchor="left top"/>
        <Splitter type="vertical" id="sp_left" max="640" min="166" position="absolute 0 166 1237 171" anchor="left top right">
          <Formats>
            <Format id="default">
              <SplitterItems id="items">
                <SplitterItem id="item00" position="leftortop" bindtype="resize" componentid="div_bk"/>
              </SplitterItems>
            </Format>
          </Formats>
        </Splitter>
        <Div id="div_bk" onsize="div_bk_OnSize" taborder="26" text="Div0" position="absolute 0 86 1237 164" scrollbars="none" anchor="left top right" style="border:0 none #808080ff ;">
          <Layouts>
            <Layout>
              <Grid autoenter="select" binddataset="ds_list" cellsizingtype="both" readonly="false" enable="true" id="grd_list" useinputpanel="false" onheadclick="grd_List_OnHeadClick" taborder="1" tabstop="true" tooltiptype="hover" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 0 1237 78" selecttype="row" anchor="left top right" style="background:white;" autofittype="col" oncellclick="div_bk_grd_list_oncellclick">
                <Formats>
                  <Format id="Default">
                    <Columns>
                      <Column size="40" band="left"/>
                      <Column size="160"/>
                      <Column size="86"/>
                      <Column size="112"/>
                      <Column size="100"/>
                      <Column size="90"/>
                      <Column size="138"/>
                      <Column size="85"/>
                      <Column size="92"/>
                      <Column size="193"/>
                      <Column size="90"/>
                      <Column size="78"/>
                    </Columns>
                    <Rows>
                      <Row size="26" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell displaytype="image" class="head_Excel"/>
                      <Cell col="1" displaytype="text" text="사업장"/>
                      <Cell col="2" text="방문일자"/>
                      <Cell col="3" text="방문자"/>
                      <Cell col="4" text="방문기관"/>
                      <Cell col="5" displaytype="text" text="점검유형"/>
                      <Cell col="6" displaytype="text" text="기관명"/>
                      <Cell col="7" displaytype="text" text="확인서청구"/>
                      <Cell col="8" displaytype="text" text="행정처분적발"/>
                      <Cell col="9" displaytype="text" text="내용"/>
                      <Cell col="10" displaytype="text" text="수거검사"/>
                      <Cell col="11" text="결재상태"/>
                    </Band>
                    <Band id="body">
                      <Cell displaytype="text" style="align:center middle;background:white;background2:white;" expr="expr:currow+1"/>
                      <Cell col="1" displaytype="text" style="background:white;background2:white;" text="bind:UPJANG_NM" suppress="0"/>
                      <Cell col="2" displaytype="date" text="bind:VISIT_DT"/>
                      <Cell col="3" text="bind:VISIT_NM"/>
                      <Cell col="4" text="bind:AGENCY_TYPE_NM"/>
                      <Cell col="5" displaytype="normal" style="background:white;background2:white;" text="bind:CHECK_TYPE_NM"/>
                      <Cell col="6" displaytype="normal" style="align:left middle;background:white;background2:white;" text="bind:AGENCY_NM"/>
                      <Cell col="7" displaytype="text" style="align:center middle;background:white;background2:white;" text="bind:CONFIRM_YN"/>
                      <Cell col="8" displaytype="normal" style="align:center middle;background:white;background2:white;" text="bind:EXPOSE_YN"/>
                      <Cell col="9" displaytype="text" style="background:white;background2:white;" text="bind:CHECK_CONTENTS"/>
                      <Cell col="10" displaytype="expr:iif(gfn_isNull(RPT_DATE), 'none', 'date')" style="align:center middle;background:white;background2:white;" text="bind:PICK_CHECK_YN"/>
                      <Cell col="11" expr="expr:SIGN_PROGRESS_STATUS==&quot;DRAFT&quot;?&quot;상신&quot;:(SIGN_PROGRESS_STATUS==&quot;REJECT&quot;?&quot;반려&quot;:(SIGN_PROGRESS_STATUS==&quot;COMPLETE&quot;?&quot;승인&quot;:(SIGN_PROGRESS_STATUS==&quot;CANCEL&quot;?&quot;취소&quot;:&quot;&quot;)))"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static40" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 71 450 86" anchor="left top"/>
        <Static id="Static18" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 398 450 403" anchor="default"/>
        <Static id="Static02" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 648 139 661" anchor="left top"/>
        <Static id="Static20" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 674 139 679" anchor="left top"/>
        <UpjangSearchComponent id="edt_upjang" titletext="업장 검색용 Component" taborder="22" onclick="edt_upjang_onclick" text="UpjangSearchComponent00" position="absolute 81 40 318 61" bindDataset="ds_input" bindUpjangCodeColumn="UPJANG" bindUpjangNameColumn="UPJANG_NM" eventBeforeTrigger="" eventAfterTrigger="" roleSetId="ScoAuthLevel01"/>
        <Static id="Static35" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 511 450 524" anchor="default"/>
        <Static id="Static41" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 537 450 542" anchor="default"/>
        <Combo id="cbo_CHECKGB" taborder="35" innerdataset="@ds_CHECKGB" codecolumn="CODE" datacolumn="code_name" position="absolute 1291 260 1390 281" visible="false"/>
        <Combo id="cbo_CHECKDTL" taborder="36" innerdataset="@ds_CHECKDTL" codecolumn="CODE" datacolumn="code_name" visible="false" position="absolute 1291 297 1390 318"/>
        <Combo id="cbo_MAIN_AGENT" taborder="37" innerdataset="@ds_MAIN_AGENT" codecolumn="CODE" datacolumn="code_name" visible="false" position="absolute 1291 330 1390 351"/>
        <Combo id="cbo_CHECKGB2" taborder="38" innerdataset="@ds_CHECKGB2" codecolumn="CODE" datacolumn="code_name" visible="false" position="absolute 1291 372 1390 393"/>
        <Combo id="cbo_MOVEGB" taborder="39" innerdataset="@ds_MOVEGB" codecolumn="CODE" datacolumn="code_name" visible="false" position="absolute 1291 409 1390 430"/>
        <Button id="btn_gwDraftCheck" taborder="21" text="점검결과상신" onclick="btn_gwDraftCheck_onclick" class="btn_WF_CRUD" position="absolute 653 0 755 25" anchor="top right"/>
        <Button id="btn_gwDetailCheck" taborder="4" text="점검결과상세" onclick="btn_gwDetailCheck_onclick" class="btn_WF_CRUD" position="absolute 757 0 851 25" anchor="top right"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_list">
        <ColumnInfo>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="UPJANG_NM" type="STRING" size="256"/>
          <Column id="VISIT_DT" type="STRING" size="256"/>
          <Column id="SEQNO" type="BIGDECIMAL" size="256"/>
          <Column id="TM_CD" type="STRING" size="256"/>
          <Column id="TM_NM" type="STRING" size="256"/>
          <Column id="TEAM_MST_SABUN" type="STRING" size="256"/>
          <Column id="TEAM_MST_SABUN_NM" type="STRING" size="256"/>
          <Column id="SUBTEAM_MST_SABUN" type="STRING" size="256"/>
          <Column id="SUBTEAM_MST_SABUN_NM" type="STRING" size="256"/>
          <Column id="CHARGE_SABUN" type="STRING" size="256"/>
          <Column id="CHARGE_SABUN_NM" type="STRING" size="256"/>
          <Column id="PERMISSION_TYPE" type="STRING" size="256"/>
          <Column id="PERMISSION_TYPE_NM" type="STRING" size="256"/>
          <Column id="AGENCY_TYPE" type="STRING" size="256"/>
          <Column id="AGENCY_TYPE_NM" type="STRING" size="256"/>
          <Column id="CHECK_TYPE" type="STRING" size="256"/>
          <Column id="CHECK_TYPE_NM" type="STRING" size="256"/>
          <Column id="AGENCY_NM" type="STRING" size="256"/>
          <Column id="VISIT_NM" type="STRING" size="256"/>
          <Column id="CONFIRM_YN" type="STRING" size="256"/>
          <Column id="EXPOSE_YN" type="STRING" size="256"/>
          <Column id="PICK_CHECK_YN" type="STRING" size="256"/>
          <Column id="CHECK_CONTENTS" type="STRING" size="256"/>
          <Column id="ETC_CONTENTS" type="STRING" size="2000"/>
          <Column id="SIGN_INSTANCE_ID" type="STRING" size="256"/>
          <Column id="SIGN_PROGRESS_STATUS" type="STRING" size="256"/>
          <Column id="UUSER" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_input" onvaluechanged="ds_input_onvaluechanged">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="UPJANG_NM" type="STRING" size="256"/>
          <Column id="FROM_DT" type="STRING" size="256"/>
          <Column id="TO_DT" type="STRING" size="256"/>
          <Column id="MST_UPJANG" type="STRING" size="256"/>
          <Column id="VISIT_DT" type="STRING" size="256"/>
          <Column id="SEQNO" type="BIGDECIMAL" size="256"/>
          <Column id="SIGN_INSTANCE_ID" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="UPJANG"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Detail" cancolumnchange="ds_CanColumnChange">
        <ColumnInfo>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="VISIT_DT" type="STRING" size="256"/>
          <Column id="SEQNO" type="BIGDECIMAL" size="256"/>
          <Column id="CHECKSEQ" type="BIGDECIMAL" size="256"/>
          <Column id="CHECKGB" type="STRING" size="256"/>
          <Column id="CHECKGBNM" type="STRING" size="256"/>
          <Column id="CHECKDTL" type="STRING" size="256"/>
          <Column id="CHECKDTLNM" type="STRING" size="256"/>
          <Column id="CHECK_CONTENTS" type="STRING" size="256"/>
          <Column id="IMPRV_CONTENTS" type="STRING" size="256"/>
          <Column id="IMPRV_DT" type="STRING" size="256"/>
          <Column id="MAIN_AGENT" type="STRING" size="256"/>
          <Column id="MAIN_AGENTNM" type="STRING" size="256"/>
          <Column id="IMGE_CNT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_common">
        <ColumnInfo>
          <Column id="code" size="256" type="STRING"/>
          <Column id="codename" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_DetailExcel" cancolumnchange="ds_CanColumnChange" oncolumnchanged="ds_Detail_OnColumnChanged">
        <ColumnInfo>
          <Column id="NO" type="STRING" size="256"/>
          <Column id="LRG_CLASS_NAME" size="200" type="STRING"/>
          <Column id="MIDDLE_CLASS_NAME" size="200" type="STRING"/>
          <Column id="CLASS_CD" size="8" type="STRING"/>
          <Column id="CLASS_NAME" size="200" type="STRING"/>
          <Column id="MARK_1" type="STRING" size="256"/>
          <Column id="MARK_2" type="STRING" size="256"/>
          <Column id="MARK_3" type="STRING" size="256"/>
          <Column id="MARK_4" type="STRING" size="256"/>
          <Column id="NOT_FIT_YN" size="1" type="STRING"/>
          <Column id="CHK_POINT" size="20" type="BIGDECIMAL"/>
          <Column id="EVAL_CONTENTS" size="256" type="STRING"/>
          <Column id="CHK" type="STRING" size="1"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_TEST_TYPE" oncolumnchanged="ds_TEST_TYPE_oncolumnchanged">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_TEST_EXAM" oncolumnchanged="ds_TEST_TYPE_oncolumnchanged">
        <ColumnInfo>
          <Column id="TEST_TYPE" size="256" type="STRING"/>
          <Column id="FORM_CD" size="256" type="STRING"/>
          <Column id="SEQ" size="256" type="BIGDECIMAL"/>
          <Column id="TEST" type="STRING" size="256"/>
          <Column id="EXAMPLE" type="STRING" size="256"/>
          <Column id="APPEND_FILENM" type="STRING" size="256"/>
          <Column id="SERVER_FILENM" type="STRING" size="256"/>
          <Column id="DISTRIBUTION" type="BIGDECIMAL" size="256"/>
          <Column id="ANSWER" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Master" cancolumnchange="ds_Master_cancolumnchange">
        <ColumnInfo>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="UPJANG_NM" type="STRING" size="256"/>
          <Column id="VISIT_DT" type="STRING" size="256"/>
          <Column id="SEQNO" type="BIGDECIMAL" size="256"/>
          <Column id="TM_CD" type="STRING" size="256"/>
          <Column id="TM_NM" type="STRING" size="256"/>
          <Column id="TEAM_MST_SABUN" type="STRING" size="256"/>
          <Column id="TEAM_MST_SABUN_NM" type="STRING" size="256"/>
          <Column id="SUBTEAM_MST_SABUN" type="STRING" size="256"/>
          <Column id="SUBTEAM_MST_SABUN_NM" type="STRING" size="256"/>
          <Column id="CHARGE_SABUN" type="STRING" size="256"/>
          <Column id="CHARGE_SABUN_NM" type="STRING" size="256"/>
          <Column id="PERMISSION_TYPE" type="STRING" size="256"/>
          <Column id="PERMISSION_TYPE_NM" type="STRING" size="256"/>
          <Column id="AGENCY_TYPE" type="STRING" size="256"/>
          <Column id="AGENCY_TYPE_NM" type="STRING" size="256"/>
          <Column id="CHECK_TYPE" type="STRING" size="256"/>
          <Column id="CHECK_TYPE_NM" type="STRING" size="256"/>
          <Column id="AGENCY_NM" type="STRING" size="256"/>
          <Column id="VISIT_NM" type="STRING" size="256"/>
          <Column id="CONFIRM_YN" type="STRING" size="256"/>
          <Column id="EXPOSE_YN" type="STRING" size="256"/>
          <Column id="PICK_CHECK_YN" type="STRING" size="256"/>
          <Column id="CHECK_CONTENTS" type="STRING" size="256"/>
          <Column id="ETC_CONTENTS" type="STRING" size="2000"/>
          <Column id="SIGN_INSTANCE_ID" type="STRING" size="256"/>
          <Column id="SIGN_PROGRESS_STATUS" type="STRING" size="256"/>
          <Column id="UUSER" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_PERMISSION_TYPE" oncolumnchanged="ds_TEST_TYPE_oncolumnchanged">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_AGENCY_TYPE" oncolumnchanged="ds_TEST_TYPE_oncolumnchanged">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CHECK_TYPE" oncolumnchanged="ds_TEST_TYPE_oncolumnchanged">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_UpjangInfo">
        <ColumnInfo>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="UPJANGNM" type="STRING" size="256"/>
          <Column id="TM_CD" type="STRING" size="256"/>
          <Column id="TM_NM" type="STRING" size="256"/>
          <Column id="TEAM_MST_SABUN" type="STRING" size="256"/>
          <Column id="TEAM_MST_SABIUNNM" type="STRING" size="256"/>
          <Column id="SUBTEAM_MST_SABUN" type="STRING" size="256"/>
          <Column id="SUBTEAM_MST_SABUNNM" type="STRING" size="256"/>
          <Column id="CHARGE_SABUN" type="STRING" size="256"/>
          <Column id="CHARGE_SABUNNM" type="STRING" size="256"/>
          <Column id="PERMISSION_TYPE" type="STRING" size="256"/>
          <Column id="PERMISSION_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds__YN_GUBUN">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">Y</Col>
            <Col id="code_name">Y</Col>
            <Col id="SET1"/>
          </Row>
          <Row>
            <Col id="CODE">N</Col>
            <Col id="code_name">N</Col>
            <Col id="SET1"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Detail1" cancolumnchange="ds_CanColumnChange">
        <ColumnInfo>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="VISIT_DT" type="STRING" size="256"/>
          <Column id="SEQNO" type="BIGDECIMAL" size="256"/>
          <Column id="CHECKSEQ" type="BIGDECIMAL" size="256"/>
          <Column id="CHECKGB" type="STRING" size="256"/>
          <Column id="CHECKGBNM" type="STRING" size="256"/>
          <Column id="PUMMOK" type="STRING" size="256"/>
          <Column id="STATUS" type="STRING" size="256"/>
          <Column id="MOVEGB" type="STRING" size="256"/>
          <Column id="MOVEGBNM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CHECKGB" oncolumnchanged="ds_TEST_TYPE_oncolumnchanged">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CHECKDTL" oncolumnchanged="ds_TEST_TYPE_oncolumnchanged">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_MAIN_AGENT" oncolumnchanged="ds_TEST_TYPE_oncolumnchanged">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CHECKGB2" oncolumnchanged="ds_TEST_TYPE_oncolumnchanged">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_MOVEGB" oncolumnchanged="ds_TEST_TYPE_oncolumnchanged">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_MasterCp" cancolumnchange="ds_Master_cancolumnchange">
        <ColumnInfo>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="UPJANG_NM" type="STRING" size="256"/>
          <Column id="VISIT_DT" type="STRING" size="256"/>
          <Column id="SEQNO" type="BIGDECIMAL" size="256"/>
          <Column id="TM_CD" type="STRING" size="256"/>
          <Column id="TM_NM" type="STRING" size="256"/>
          <Column id="TEAM_MST_SABUN" type="STRING" size="256"/>
          <Column id="TEAM_MST_SABUN_NM" type="STRING" size="256"/>
          <Column id="SUBTEAM_MST_SABUN" type="STRING" size="256"/>
          <Column id="SUBTEAM_MST_SABUN_NM" type="STRING" size="256"/>
          <Column id="CHARGE_SABUN" type="STRING" size="256"/>
          <Column id="CHARGE_SABUN_NM" type="STRING" size="256"/>
          <Column id="PERMISSION_TYPE" type="STRING" size="256"/>
          <Column id="PERMISSION_TYPE_NM" type="STRING" size="256"/>
          <Column id="AGENCY_TYPE" type="STRING" size="256"/>
          <Column id="AGENCY_TYPE_NM" type="STRING" size="256"/>
          <Column id="CHECK_TYPE" type="STRING" size="256"/>
          <Column id="CHECK_TYPE_NM" type="STRING" size="256"/>
          <Column id="AGENCY_NM" type="STRING" size="256"/>
          <Column id="VISIT_NM" type="STRING" size="256"/>
          <Column id="CONFIRM_YN" type="STRING" size="256"/>
          <Column id="EXPOSE_YN" type="STRING" size="256"/>
          <Column id="PICK_CHECK_YN" type="STRING" size="256"/>
          <Column id="CHECK_CONTENTS" type="STRING" size="256"/>
          <Column id="ETC_CONTENTS" type="STRING" size="2000"/>
          <Column id="SIGN_INSTANCE_ID" type="STRING" size="256"/>
          <Column id="SIGN_PROGRESS_STATUS" type="STRING" size="256"/>
          <Column id="UUSER" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="me_FROM_DT_value" compid="me_FROM_DT" propid="value" datasetid="ds_input" columnid="FROM_DT"/>
      <BindItem id="me_TO_DT_value" compid="me_TO_DT" propid="value" datasetid="ds_input" columnid="TO_DT"/>
      <BindItem id="ed_CHARGE_NM_value" compid="ed_CHARGE_SABUN_NM" propid="value" datasetid="ds_Master" columnid="CHARGE_SABUN_NM"/>
      <BindItem id="item1" compid="ed_TM_NM" propid="value" datasetid="ds_Master" columnid="TM_NM"/>
      <BindItem id="item2" compid="ed_TEAM_MST_SABUN_NM" propid="value" datasetid="ds_Master" columnid="TEAM_MST_SABUN_NM"/>
      <BindItem id="item3" compid="ed_SUBTEAM_MST_SABUN_NM" propid="value" datasetid="ds_Master" columnid="SUBTEAM_MST_SABUN_NM"/>
      <BindItem id="item7" compid="cbo_permissionType" propid="value" datasetid="ds_Master" columnid="PERMISSION_TYPE"/>
      <BindItem id="item0" compid="ed_AGENCY_NM" propid="value" datasetid="ds_Master" columnid="AGENCY_NM"/>
      <BindItem id="item8" compid="cbo_agencyType" propid="value" datasetid="ds_Master" columnid="AGENCY_TYPE"/>
      <BindItem id="item4" compid="cbo_checkType" propid="value" datasetid="ds_Master" columnid="CHECK_TYPE"/>
      <BindItem id="item5" compid="me_VISIT_DT" propid="value" datasetid="ds_Master" columnid="VISIT_DT"/>
      <BindItem id="ed_FORM_NAME_value" compid="ed_VISIT_NM" propid="value" datasetid="ds_Master" columnid="VISIT_NM"/>
      <BindItem id="cbo_USE_YN_value" compid="cbo_CONFIRM_YN" propid="value" datasetid="ds_Master" columnid="CONFIRM_YN"/>
      <BindItem id="item6" compid="cbo_PICK_CHECK_YN" propid="value" datasetid="ds_Master" columnid="PICK_CHECK_YN"/>
      <BindItem id="item9" compid="ed_CHECK_CONTENTS" propid="value" datasetid="ds_Master" columnid="CHECK_CONTENTS"/>
      <BindItem id="item10" compid="cbo_EXPOSE_YN" propid="value" datasetid="ds_Master" columnid="EXPOSE_YN"/>
      <BindItem id="ta_SPECIAL_FACT_value" compid="ta_ETC_CONTENTS" propid="value" datasetid="ds_Master" columnid="ETC_CONTENTS"/>
      <BindItem id="item11" compid="cbo_CHECKGB" propid="value" datasetid="ds_Master" columnid="EXPOSE_YN"/>
      <BindItem id="item12" compid="cbo_CHECKDTL" propid="value" datasetid="ds_Master" columnid="EXPOSE_YN"/>
      <BindItem id="item13" compid="cbo_MAIN_AGENT" propid="value" datasetid="ds_Master" columnid="EXPOSE_YN"/>
      <BindItem id="item14" compid="cbo_CHECKGB2" propid="value" datasetid="ds_Master" columnid="EXPOSE_YN"/>
      <BindItem id="item15" compid="cbo_MOVEGB" propid="value" datasetid="ds_Master" columnid="EXPOSE_YN"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
include "lib::LimsUtil.xjs";
include "lib::lib_com.xjs";
include "lib::FTCommon.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 위생관리/외부위생점검결과관리
 * 프로그램명   : FSC091030E.XML
 * 기      능   : 외부점검관리
 * 작  성  자   : 김명섭
 * 작성  일자   : 2019-07-17
 * 비      고   : 
 * ----------------------------------------------------------------------------------------
******************************************************************************************
*/
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"		// X-Framework Lib
//@@컨버터에서 주석처리 #include "LIB::fm_common.js"			// 사업장팝업용 Lib
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var fstrFormQuery = "SELECT FORM_CD, FORM_NAME, TEST_TYPE, ATTR01 AS URL_LINK FROM FSC_TEST_FORM_MST WHERE USE_YN = 'Y'   AND TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN START_DATE AND NVL(END_DATE,'99999999') ORDER BY START_DATE DESC, FORM_CD";
var strDt;
var fbAble = true;							// true = 수정가능 false = 수정불가
var isInsert = true;						// true = 입력 , false = 수정

var nSeqNo = 0; //테스트순번
var nFseqno, nLseqno; //문제시작번호,최종번호
var strFinishYn;
var strAllYn;

var codeList = "MA0004,FS9110,FS9120";
var BATCH_CODE_LIST_FORM = "";  	// 해당 Form
var BATCH_CODE_LIST_DIV = "";   	// 해당 Div Component
var BATCH_CODE_LIST = "";       	// 코드 리스트

var fv_attachList;	//상신 첨부 파일 목록 (json)
var fv_RefSeq;
var fv_option = {buttons:[{id:"btn_gwDraft", action:"draft"}, {id:"btn_gwDetail", action:"detail"}]}; //개선결과 결재 관련 버튼 정의
var fv_optionCheck = {buttons:[{id:"btn_gwDraftCheck", action:"draft"}, {id:"btn_gwDetailCheck", action:"detail"}]}; //점검결과 결재 관련 버튼 정의
var fv_retVal;
var iOffsetX = 192;

//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	// 업데이트 DS
	v_ds_check = "ds_Master;ds_Detail;ds_Detail1";
	
	// X-Framework : Action 정보 생성 
	fsp_init(this);

	//그룹웨어 연동 초기화
    SCGw.init (this);
    
	btn_gwDraftCheck.enable = false;
	btn_gwDetailCheck.enable = false;
	
	//공통코드조회
	var v_fil_cond, v_ds;

	v_ds = fn_common_code("'MA0004','FS9110','FS9120'","","","blk","Y");
	//인허가형태
	v_fil_cond = "GROUP_CODE == 'MA0004'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_PERMISSION_TYPE,v_ds.name);	
	v_ds.filter("");
	//방문기관형태
	v_fil_cond = "GROUP_CODE == 'FS9110'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_AGENCY_TYPE,v_ds.name);	
	v_ds.filter("");
	//점검형태
	v_fil_cond = "GROUP_CODE == 'FS9120'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_CHECK_TYPE,v_ds.name);	
	v_ds.filter("");
	
	//trace(ds_PERMISSION_TYPE.saveXML());
	//trace(ds_AGENCY_TYPE.saveXML());
	//trace(ds_CHECK_TYPE.saveXML());

	
	strDt = fn_CurrDateWeek();
	ds_input.setColumn(0, "FROM_DT", gfn_left(strDt,6)+"01");				// 일자
	ds_input.setColumn(0, "TO_DT", strDt);							// 일자

	//사업장인경우
	if (g_AuthLevel <= g_Leader_AuthLevel)
	{
		fbAble = false;
	}

	// 초기값 셋팅
	fn_init();

}

function fn_init()
{
	SCCombo.bind(this, "ComCode", "grd_detail.CHECKGB", null, {groupCode:"FS9130", useYn:"Y"}); 	//수검구분
	SCCombo.bind(this, "ComCode", "grd_detail.CHECKDTL", null, {groupCode:"FS9140", useYn:"Y"}); 	//수검항목
	SCCombo.bind(this, "ComCode", "grd_detail.MAIN_AGENT", null, {groupCode:"FS9150", useYn:"Y"}); 	//주체
	SCCombo.bind(this, "ComCode", "grd_detail1.CHECKGB", null, {groupCode:"FS9160", useYn:"Y"}); 	//검사구분
	SCCombo.bind(this, "ComCode", "grd_detail1.MOVEGB", null, {groupCode:"FS9170", useYn:"Y"}); 	//시료이동방법
}

function frm_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
}
//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_search()
{
	if (!fn_SearchCheck())		// 조회조건체크
	{
		return;
	}
	
	// 초기화
	ds_list.clearData();
	ds_Master.clearData();
	ds_Detail.clearData();
	ds_Detail1.clearData();
	//trace(ds_input.saveXML());

	btn_gwDraftCheck.enable = false;
	btn_gwDetailCheck.enable = false;
	
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	actionName		= "FSC91030E_T001";
	cmdName			= "U_svc::" + "fs/fsc/FSC91030E_T001.jsp";
	inData			= "ds_input=ds_input";
	outData			= "ds_list=ds_list ds_Master=ds_list";
	callBackFnc		= "fn_afterSearchList";
	
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc,true,false,false);
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Insert()
 * 기      능   : [입력버튼] 입력 시 처리되는 작업
 * 비      고	: 팝업사용
 ******************************************************************************************
 */
function fn_insert()
{
	//trace(ds_input.saveXML());
	if (gfn_length(ds_input.getColumn(0,"UPJANG"))== 0 || gfn_isNull(ds_UpjangInfo.getColumn(0,"UPJANG")) || gfn_length(ds_UpjangInfo.getColumn(0,"UPJANG")) == 0)
	{
		g_Message("EE", "사업장을 입력하세요.");
		edt_upjang.setFocus();
		return false;
	}
/*	if (gfn_length(ds_UpjangInfogetColumn(0,"UPJANG"))== 0)
	{
		g_Message("EE", "사업장을 입력하세요.");
		edt_upjang.setFocus();
		return false;
	} */
	
	if (gfn_dsIsUpdated(ds_Master)==true || gfn_dsIsUpdated(ds_Detail)==true || gfn_dsIsUpdated(ds_Detail1)==true)
	{
		g_Message("EE", "변경된 데이터가 있습니다.\n 저장 후 입력해주십시오.");
		return;
	}
	
	fbAble	= true;
	
	btn_TMNM.enable = true;
	btn_TEAMMST.enable = true;
	btn_SUBTEAMMST.enable = true;
	btn_CHARGE.enable = true;
	btn_input1.enable = true;
	btn_delete1.enable = true;
	btn_input2.enable = true;
	btn_delete2.enable = true;

	isInsert = true;

	var nARow;
	
	ds_Master.clearData();
	nARow = ds_Master.addRow();
	
	//trace(ds_UpjangInfo.saveXML());
	
	ds_Master.setColumn(nARow, "UPJANG", ds_UpjangInfo.getColumn(0,"UPJANG"));
	ds_Master.setColumn(nARow, "UPJANG_NM", ds_UpjangInfo.getColumn(0,"UPJANGNM"));
	ds_Master.setColumn(nARow, "TM_CD", ds_UpjangInfo.getColumn(0,"TM_CD"));
	ds_Master.setColumn(nARow, "TM_NM", ds_UpjangInfo.getColumn(0,"TM_NM"));
	ds_Master.setColumn(nARow, "TEAM_MST_SABUN", ds_UpjangInfo.getColumn(0,"TEAM_MST_SABUN"));
	ds_Master.setColumn(nARow, "TEAM_MST_SABUN_NM", ds_UpjangInfo.getColumn(0,"TEAM_MST_SABUNNM"));
	ds_Master.setColumn(nARow, "SUBTEAM_MST_SABUN", ds_UpjangInfo.getColumn(0,"SUBTEAM_MST_SABUN"));
	ds_Master.setColumn(nARow, "SUBTEAM_MST_SABUN_NM", ds_UpjangInfo.getColumn(0,"SUBTEAM_MST_SABUNNM"));
	ds_Master.setColumn(nARow, "CHARGE_SABUN", ds_UpjangInfo.getColumn(0,"CHARGE_SABUN"));
	ds_Master.setColumn(nARow, "CHARGE_SABUN_NM", ds_UpjangInfo.getColumn(0,"CHARGE_SABUNNM"));
	ds_Master.setColumn(nARow, "PERMISSION_TYPE", ds_UpjangInfo.getColumn(0,"PERMISSION_TYPE"));
	ds_Master.setColumn(nARow, "PERMISSION_TYPE_NM", ds_UpjangInfo.getColumn(0,"PERMISSION_NM"));
	
	ds_Detail.clearData();
	ds_Detail1.clearData();
	
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Save()
 * 기      능   : [저장버튼] 저장 시 처리되는 작업
 ******************************************************************************************
 */
function fn_save()
{
	// 변경여부 확인
	if(gfn_dsIsUpdated(ds_Master)==false && gfn_dsIsUpdated(ds_Detail)==false && gfn_dsIsUpdated(ds_Detail1)==false)
	{
		g_Message("EE", "변경된 데이터가 없습니다.");
		return;
	}
	
	if(!fn_SaveCheck())
	{
		return;
	}
	
	//if(!isInsert)
	//{
		if(! confirm('저장하시겠습니까?')) return;
	//}
	
	
	//trace(ds_Master.saveXML());
	//trace(ds_Master.rowposition);
	//trace(ds_Detail.saveXML());
	//trace(ds_Detail1.saveXML());
	//return;
	
	ds_MasterCp.clearData();
	var nRow = ds_MasterCp.addRow();
	ds_MasterCp.copyRow(nRow, ds_Master, ds_Master.rowposition);
	
	//trace(ds_MasterCp.saveXML());
	//return;
	
    // 서비스셋팅
    var actionName, cmdName, inData, outData, otherArg, callBackFnc;

	actionName		= "FSC91030E_T006";
	cmdName			= "U_svc::" + "fs/fsc/FSC91030E_T006.jsp";
	inData			= "ds_MasterCp=ds_MasterCp:U ds_Detail=ds_Detail:U ds_Detail1=ds_Detail1:U";
    outData			= "";
    callBackFnc		= "fn_afterSave";
	
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc);
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Delete()
 * 기      능   : [삭제버튼] 삭제 시 처리되는 작업
 ******************************************************************************************
 */
function fn_delete()
{
	if(ds_list.getRowCount()==0)
	{
		g_Message("EE", "삭제할 데이터가 없습니다.");
		return;
	}

	if (!fbAble)
	{
		g_Message("EE", "삭제하실 수 없습니다.");
		return;
	}
	
	if (gfn_dsIsUpdated(ds_Master)==true || gfn_dsIsUpdated(ds_Detail)==true || gfn_dsIsUpdated(ds_Detail1)==true)
	{
		g_Message("EE", "변경된 데이터가 있습니다.\n 저장 후 삭제해십시오.");
		return;
	}
	
	var strMsg,btp,nRow,nFRow;
	
	nRow 	= ds_list.rowposition;
	for(var i=0 ; i<ds_Master.getRowCount() ; i++)
	{
		if(ds_list.getColumn(nRow,"UPJANG") == ds_Master.getColumn(i,"UPJANG") && ds_list.getColumn(nRow,"VISIT_DT") == ds_Master.getColumn(i,"VISIT_DT") && ds_list.getColumn(nRow,"SEQNO") == ds_Master.getColumn(i,"SEQNO"))
		{
			nFRow = i;
		}
	}
	
	if(ds_Detail.rowcount > 0)
	{
		g_Message("EE", "등록된 수검사항이 있습니다.");
		return;
	}
	if(ds_Detail1.rowcount > 0)
	{
		g_Message("EE", "등록된 수거검사내역이 있습니다.");
		return;
	}
	
	strMsg = "[" + ds_list.getColumn(nRow,"UPJANG_NM") + "] " + " 삭제하시겠습니까?";
	
	// 삭제확인
	if(!g_Confirm("01",strMsg))
	{
		return false;
	}
	
	// Data삭제
	ds_list.deleteRow(nRow);
	ds_Master.deleteRow(nFRow);
	ds_Master.rowposition = -1;
	ds_Detail.clearData();
	ds_Detail1.clearData();
	
	// 삭제
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	actionName		= "FSC91030E_T007";
	cmdName			= "U_svc::" + "fs/fsc/FSC91030E_T007.jsp";
	inData			= "ds_Master=ds_Master:U";
	callBackFnc		= "fn_afterDelete"
	
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc);
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Print()
 * 기      능   : [출력버튼] 출력 시 처리되는 작업
 ******************************************************************************************
 */
function fn_print()
{
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Excel()
 * 기      능   : [엑셀버튼] 엑셀 시 처리되는 작업
 ******************************************************************************************
 */
function fn_Excel()
{
	gfn_exportExcel(grd_Detail, "Sheet1");
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function fn_Close()
{
	this.close();
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Help()
 * 기      능   : [도움말버튼] 도움말
 ******************************************************************************************
 */
function fn_help()
{
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_SearchCheck()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 조회시 필수조회조건 체크
 ******************************************************************************************
 */
function fn_SearchCheck()
{
	/*
	if (gfn_length(ds_input.getColumn(0,"UPJANG")) == 0)
	{
		g_Message("EE", "사업장을 입력하세요.");
		return false;
	}
	*/

	if (gfn_length(ds_input.getColumn(0,"FROM_DT"))== 0)
	{
		g_Message("EE", "날짜를 입력하세요");
		me_FROM_DT.setFocus();
		return false;
	}

	if (gfn_length(ds_input.getColumn(0,"TO_DT"))== 0)
	{
		g_Message("EE", "날짜를 입력하세요");
		me_TO_DT.setFocus();
		return false;
	}

	if (ds_input.getColumn(0,"FROM_DT") > ds_input.getColumn(0,"TO_DT"))
	{
		g_Message("EE", "검색기간을 확인해 주십시오.");
		me_FROM_DT.setFocus();
		return false;
	}
	
    return true;
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_SaveCheck()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 저상시 필수입력 체크
 ******************************************************************************************
 */
function fn_SaveCheck()
{
	var nFRow,nRow;
	
	nRow = ds_Master.rowposition;
	
	// 필수 입력 사항 확인 
	if(gfn_length(ds_Master.getColumn(nRow,"UPJANG"))== 0)
	{
		g_Message("EE", "업장을 입력해주십시오.");
		edt_upjang.setFocus();
		return false;
	}

	if(gfn_length(ds_Master.getColumn(nRow,"AGENCY_TYPE"))== 0)
	{
		g_Message("EE", "방문기관을 선택해주십시오.");
		cbo_agencyType.setFocus();
		return false;
	}

	if(gfn_length(ds_Master.getColumn(nRow,"CHECK_TYPE"))== 0)
	{
		g_Message("EE", "점검유형을 선택해주십시오.");
		cbo_checkType.setFocus();
		return false;
	}

	if(gfn_length(ds_Master.getColumn(nRow,"VISIT_DT"))== 0)
	{
		g_Message("EE", "방문일자를 입력해주십시오.");
		me_VISIT_DT.setFocus();
		return false;
	}

	if(gfn_length(ds_Master.getColumn(nRow,"AGENCY_NM"))== 0)
	{
		g_Message("EE", "기관명을 입력해주십시오.");
		ed_AGENCY_NM.setFocus();
		return false;
	}

	if(gfn_length(ds_Master.getColumn(nRow,"CONFIRM_YN"))== 0)
	{
		g_Message("EE", "확인서청구를 선택해주십시오.");
		cbo_CONFIRM_YN.setFocus();
		return false;
	}

	if(gfn_length(ds_Master.getColumn(nRow,"EXPOSE_YN"))== 0)
	{
		g_Message("EE", "행정처분적발을 선택해주십시오.");
		cbo_EXPOSE_YN.setFocus();
		return false;
	}

	if(gfn_length(ds_Master.getColumn(nRow,"PICK_CHECK_YN"))== 0)
	{
		g_Message("EE", "수거검사를 선택해주십시오.");
		cbo_PICK_CHECK_YN.setFocus();
		return false;
	}
	
	if(ds_Master.getColumn(nRow,"PICK_CHECK_YN") == "Y")
	{
		if(ds_Detail1.rowcount <= 0)
		{
			g_Message("EE", "수거검사내역을 입력해주십시오.");
			return false;
		}
	}

    return true;
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSearchList()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 
 ******************************************************************************************
 */
function fn_afterSearchList(errCode, errMsg)
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오");
		return;
	}
	
	//trace(ds_list.saveXML());
	//trace(ds_Master.saveXML());
	
	ds_Master.copyData(ds_list);
	ds_Master.rowposition = -1;

	if(ds_Master.rowcount > 0)
	{
		ds_Master.rowposition = 0;

		btn_TMNM.enable = false;
		btn_TEAMMST.enable = false;
		btn_SUBTEAMMST.enable = false;
		btn_CHARGE.enable = false;
		btn_input1.enable = false;
		btn_delete1.enable = false;
		btn_input2.enable = false;
		btn_delete2.enable = false;
		
		var btp;
		
		//trace(g_AuthLevel+"-"+g_Leader_AuthLevel+"-"+gfn_isNull(ds_list.getColumn(e.row,"SIGN_PROGRESS_STATUS")));
		
		if (g_AuthLevel > g_Leader_AuthLevel)	// 수정가능 
		{
			btp = true;
		}
		else
		{
			btp = false;
		}
		
		btn_TMNM.enable = btp;
		btn_TEAMMST.enable = btp;
		btn_SUBTEAMMST.enable = btp;
		btn_CHARGE.enable = btp;
		btn_input1.enable = btp;
		btn_delete1.enable = btp;
		btn_input2.enable = btp;
		btn_delete2.enable = btp;

		isInsert = false;
		
		fbAble = btp;

		// 초기화
		ds_Detail.clearData();
		ds_Detail1.clearData();
		
		// 조회
		var actionName, cmdName, inData, outData, otherArg, callBackFnc;
		
		nRow = ds_list.rowposition;
		
		strAllYn = "Y";
		
		ds_input.setColumn(0,"UPJANG",ds_Master.getColumn(nRow,"UPJANG"));
		ds_input.setColumn(0,"UPJANG_NM",ds_Master.getColumn(nRow,"UPJANG_NM"));
		ds_input.setColumn(0,"VISIT_DT",ds_Master.getColumn(nRow,"VISIT_DT"));
		ds_input.setColumn(0,"SEQNO",ds_Master.getColumn(nRow,"SEQNO"));

		strAllYn = "N";
		
		actionName		= "FSC91030E_T003";
		cmdName			= "U_svc::" + "fs/fsc/FSC91030E_T003.jsp";
		inData			= "ds_input=ds_input";
		outData			= "ds_Detail=ds_Detail ds_Detail1=ds_Detail1";
		callBackFnc		= "fn_afterSearch";
		
		jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc);
	}
	
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSearch()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 사업장 조회 후 실행 함수
 ******************************************************************************************
 */
function fn_afterSearch(errCode, errMsg)
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오");
		return;
	}

	//trace(ds_Detail.saveXML());
	//trace(ds_Detail1.saveXML());

	edt_upjang.setUpjangCode(ds_input.getColumn(0,"UPJANG"));
	edt_upjang.setUpjangName(ds_input.getColumn(0,"UPJANG_NM"));

	fn_gwUserButtonInit();
}

/**
 * 전자결재 버튼정보를 초기화 한다.
 * @param
 * @return
 */
function fn_gwUserButtonInit()
{
    //그룹웨어 연동 버튼을 설정
    SCGw.setUserButton (this, fv_optionCheck, gfn_nvl(ds_list.getColumn(ds_list.rowposition, "SIGN_PROGRESS_STATUS"), ""));
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSave()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 저장후 실행 함수
 ******************************************************************************************
 */
function fn_afterSave(errCode, errMsg)
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오");
		return;
	}
	else
		g_Message("03", "저장되었습니다.");

	fn_search();
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_afterDelete()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 삭제후 실행 함수
 ******************************************************************************************
 */
function fn_afterDelete(errCode, errMsg)
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오.");
		return;
	}
	else
		g_Message("02", "삭제되었습니다.");
	
}


//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
 /******************************************************************************************
 * 함  수  명   : grd_List_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
 * 기      능   : 그리드헤드 더블클릭시 Sort
 ******************************************************************************************
 */
function grd_List_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
	
	// 초기화
	ds_Detail.clearData();
	ds_Detail1.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	nRow = ds_list.rowposition;
	
	strAllYn = "Y";
	
	nFRow = ds_Master.findRowExpr("UPJANG=='" + ds_list.getColumn(nRow,"UPJANG") + "'&&VISIT_DT=='" + ds_list.getColumn(nRow,"VISIT_DT") + "'&&SEQNO=='" + ds_list.getColumn(nRow,"SEQNO") + "'");
	ds_Master.rowposition = nFRow;
	
	ds_input.setColumn(0,"UPJANG",ds_list.getColumn(nRow,"UPJANG"));
	ds_input.setColumn(0,"UPJANG_NM",ds_list.getColumn(nRow,"UPJANG_NM"));
	ds_input.setColumn(0,"VISIT_DT",ds_list.getColumn(nRow,"VISIT_DT"));
	ds_input.setColumn(0,"SEQNO",ds_list.getColumn(nRow,"SEQNO"));

	strAllYn = "N";
	
	actionName		= "FSC91030E_T003";
	cmdName			= "U_svc::" + "fs/fsc/FSC91030E_T003.jsp";
	inData			= "ds_input=ds_input";
	outData			= "ds_Detail=ds_Detail ds_Detail1=ds_Detail1";
	callBackFnc		= "fn_afterSearch";
	
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc);
}
/*
 ******************************************************************************************
 * 함  수  명   : btn_Date_OnClick(obj,nX,nY)
 * 기      능   : 달력
 ******************************************************************************************
 */
function btn_Date_OnClick(obj:Button, e:ClickEventInfo)
{
	var objme = eval(obj.userdata);
	
	var retDate = gfn_dialog("", "U_SCC::SCC_CALENDAR.xfdl","fa_Date="+wrapQuote(objme.value),-1,-1,"Title=false Status=false");

	objme.value  = retDate;
}
/*
 ******************************************************************************************
 * 함  수  명   : ed_pop_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
 * 기      능   : 업장엔터시팝업
 ******************************************************************************************
 */
function ed_pop_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13)
	{
		var objme = eval(obj.userdata);
		objme.click();
	}
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Pop_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
 * 기      능   : 팝업edit키입력시
 ******************************************************************************************
 */
function fn_Pop_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if( e.keycode == 13 ) {
		if( gfn_length(gfn_trim(obj.value))== 0 ) {
			var objme = eval(obj.userdata);
			objme.click();
		}
	}
}

function div_bk_grd_list_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	if(e.row < 0) return;
	
	var strMsg = "변경된 내역이 있습니다. 저장하시겠습니까?\n(취소하신 경우 자료는 초기화됩니다.)";
	var nFRow,strSts;

	nFRow = ds_Master.findRowExpr("UPJANG=='" + ds_list.getColumn(e.row,"UPJANG") + "'&&VISIT_DT=='" + ds_list.getColumn(e.row,"VISIT_DT") + "'&&SEQNO=='" + ds_list.getColumn(e.row,"SEQNO") + "'");

	if (nFRow != ds_Master.rowposition)
	{
		if (gfn_dsIsUpdated(ds_Master)==true || gfn_dsIsUpdated(ds_Detail)==true || gfn_dsIsUpdated(ds_Detail1)==true)
		{
			if (g_Confirm("02",strMsg))
			{
				fn_save();
				return;
			}
			else
			{
				fn_search();
				return;
			}
		}
	}
	
	ds_Master.rowposition = nFRow;
	
	//trace(ds_Master.saveXML());
	
	btn_TMNM.enable = false;
	btn_TEAMMST.enable = false;
	btn_SUBTEAMMST.enable = false;
	btn_CHARGE.enable = false;
	btn_input1.enable = false;
	btn_delete1.enable = false;
	btn_input2.enable = false;
	btn_delete2.enable = false;
	
	var btp;
	
	//trace(g_AuthLevel+"-"+g_Leader_AuthLevel+"-"+gfn_isNull(ds_list.getColumn(e.row,"SIGN_PROGRESS_STATUS")));
	
	if (g_AuthLevel > g_Leader_AuthLevel)	// 수정가능 
	{
		btp = true;
	}
	else
	{
		btp = false;
	}
	
	btn_TMNM.enable = btp;
	btn_TEAMMST.enable = btp;
	btn_SUBTEAMMST.enable = btp;
	btn_CHARGE.enable = btp;
	btn_input1.enable = btp;
	btn_delete1.enable = btp;
	btn_input2.enable = btp;
	btn_delete2.enable = btp;

	isInsert = false;
	
	fbAble = btp;

	// 초기화
	ds_Detail.clearData();
	ds_Detail1.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	nRow = ds_list.rowposition;
	
	strAllYn = "Y";
	
	ds_input.setColumn(0,"UPJANG",ds_list.getColumn(nRow,"UPJANG"));
	ds_input.setColumn(0,"UPJANG_NM",ds_list.getColumn(nRow,"UPJANG_NM"));
	ds_input.setColumn(0,"VISIT_DT",ds_list.getColumn(nRow,"VISIT_DT"));
	ds_input.setColumn(0,"SEQNO",ds_list.getColumn(nRow,"SEQNO"));

	strAllYn = "N";
	
	actionName		= "FSC91030E_T003";
	cmdName			= "U_svc::" + "fs/fsc/FSC91030E_T003.jsp";
	inData			= "ds_input=ds_input";
	outData			= "ds_Detail=ds_Detail ds_Detail1=ds_Detail1";
	callBackFnc		= "fn_afterSearch";
	
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc);
}
 
/*
 ******************************************************************************************
 * 함  수  명   : ds_Master_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
 * 기      능   : 마스터 변경시
 ******************************************************************************************
 */
function ds_Master_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{

}

/*
 ******************************************************************************************
 * 함  수  명   : ds_CanColumnChange(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
 * 기      능   : 수정불가인 경우 수정불가
 ******************************************************************************************
 */
function ds_CanColumnChange(obj:Dataset, e:DSColChangeEventInfo)
{
	if (!fbAble)
	{
		return false;
	}
}

/*
 ******************************************************************************************
 * 함  수  명   : div_bk_OnSize(obj,nCx,nCy)
 * 기      능   : 리스트 div가 변경될때 그리드 크기변경
 ******************************************************************************************
 */
function div_bk_OnSize(obj:Div, e:SizeEventInfo)
{
	div_bk.grd_list.position.height = obj.position.height -4;
}

//================================================================
// 점장 조회 팝업 클릭 이벤트
//================================================================
function btn_CHARGE_SABUN_OnClick(obj:Button, e:ClickEventInfo){
	fn_sql_common_setup( strMAQuery_SABUN
						,strMAQuery_SABUNKeyField
						,strMAQuery_SABUNValueField
						,strMAQuery_SABUNKeyFieldNM
						,strMAQuery_SABUNValueFieldNM
						,""
						,""
						,""
						,strMAQuery_SABUNCaption
						,strMAQuery_SABUNAllField
						);
	
	ds_Master.setColumn(ds_Master.rowposition, "CHARGE_SABUN_NM",    gds_sql_common.getColumn(0, "ret_name"));
	ds_Master.setColumn(ds_Master.rowposition, "CHARGE_SABUN", gds_sql_common.getColumn(0, "ret_code"));
}


function btn_UPJANGNM2_OnClick(obj:Button, e:ClickEventInfo)
{
	fn_sql_common_setup( strMAQuery_Team
						,strMAQuery_TeamKeyField
						,strMAQuery_TeamValueField
						,strMAQuery_TeamKeyFieldNM
						,strMAQuery_TeamValueFieldNM
						,""
						,""
						,""
						,strMAQuery_TeamCaption
						,strMAQuery_TeamAllField
						);

	
	ds_Master.setColumn(ds_Master.rowposition, "TM_NM", gds_sql_common.getColumn(0, "ret_name"));
	ds_Master.setColumn(ds_Master.rowposition, "TM_CD", gds_sql_common.getColumn(0, "ret_code"));
}

/***************************************************************************
 * 설명   : 그리드에서 커서로 버튼 이동시 결재버튼 제어
 ***************************************************************************/

function edt_upjang_onclick(obj:UpjangSearchComponent,  e:ClickEventInfo)
{
	
}

function btn_TMNM_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_sql_common_setup( strMAQuery_Team
						,strMAQuery_TeamKeyField
						,strMAQuery_TeamValueField
						,strMAQuery_TeamKeyFieldNM
						,strMAQuery_TeamValueFieldNM
						,""
						,""
						,""
						,strMAQuery_TeamCaption
						,strMAQuery_TeamAllField
						);

	
	ds_Master.setColumn(ds_Master.rowposition, "TM_NM", gds_sql_common.getColumn(0, "ret_name"));
	ds_Master.setColumn(ds_Master.rowposition, "TM_CD", gds_sql_common.getColumn(0, "ret_code"));
}

function ds_input_onvaluechanged(obj:Dataset,  e:DSColChangeEventInfo)
{
	//trace("ds_input_onvaluechanged");

	if(strAllYn == "Y") return;
	
	if(e.columnid == "UPJANG")
	{
		fn_upjangChangedEvent();
	}
}

function fn_upjangChangedEvent() {
	
	//trace("fn_upjangChangedEvent");

	// 초기화
	ds_list.clearData();
	ds_Master.clearData();
	ds_Detail.clearData();
	ds_Detail1.clearData();

	btn_TMNM.enable = false;
	btn_TEAMMST.enable = false;
	btn_SUBTEAMMST.enable = false;
	btn_CHARGE.enable = false;
	btn_input1.enable = false;
	btn_delete1.enable = false;
	btn_input2.enable = false;
	btn_delete2.enable = false;
	
	if(gfn_isNull(ds_input.getColumn(0, "UPJANG"))) {
		return;
	}

	// 초기화
	ds_UpjangInfo.clearData();
	
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	actionName		= "FSC91030E_T002";
	cmdName			= "U_svc::" + "fs/fsc/FSC91030E_T002.jsp";
	inData			= "ds_input=ds_input";
	outData			= "ds_UpjangInfo=ds_UpjangInfo";
	callBackFnc		= "fn_afterUpjangInfo";
	
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc,true,false,false);
	
}

function fn_afterUpjangInfo(errCode, errMsg)
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오");
		return;
	}
	if(ds_UpjangInfo.rowcount == 0)
	{
		g_Message("EE", "사업장을 재검색해 주세요");
		edt_upjang.setFocus();
		return;
	}
	
	//trace(ds_UpjangInfo.saveXML());
}
function btn_TEAMMST_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_sql_common_setup( strMAQuery_SABUN
						,strMAQuery_SABUNKeyField
						,strMAQuery_SABUNValueField
						,strMAQuery_SABUNKeyFieldNM
						,strMAQuery_SABUNValueFieldNM
						,""
						,""
						,""
						,strMAQuery_SABUNCaption
						,strMAQuery_SABUNAllField
						);
	
	ds_Master.setColumn(ds_Master.rowposition, "TEAM_MST_SABUN_NM",    gds_sql_common.getColumn(0, "ret_name"));
	ds_Master.setColumn(ds_Master.rowposition, "TEAM_MST_SABUN", gds_sql_common.getColumn(0, "ret_code"));
}

function btn_SUBTEAMMST_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_sql_common_setup( strMAQuery_SABUN
						,strMAQuery_SABUNKeyField
						,strMAQuery_SABUNValueField
						,strMAQuery_SABUNKeyFieldNM
						,strMAQuery_SABUNValueFieldNM
						,""
						,""
						,""
						,strMAQuery_SABUNCaption
						,strMAQuery_SABUNAllField
						);
	
	ds_Master.setColumn(ds_Master.rowposition, "SUBTEAM_MST_SABUN_NM",    gds_sql_common.getColumn(0, "ret_name"));
	ds_Master.setColumn(ds_Master.rowposition, "SUBTEAM_MST_SABUN", gds_sql_common.getColumn(0, "ret_code"));
}

function fn_BeforeCheck()
{
	var nFRow,nRow;
	
	nRow = ds_Master.rowposition;
	
	// 필수 입력 사항 확인 
	if(gfn_length(ds_Master.getColumn(nRow,"UPJANG"))== 0)
	{
		g_Message("EE", "업장을 입력해주십시오.");
		return false;
	}
	if(gfn_length(ds_Master.getColumn(nRow,"VISIT_DT"))== 0)
	{
		g_Message("EE", "방문일자를 입력해주십시오.");
		me_VISIT_DT.setFocus();
		return false;
	}
    return true;
}

function btn_input1_onclick(obj:Button,  e:ClickEventInfo)
{
	if(!fn_BeforeCheck())
	{
		return;
	}

	var nRow = ds_Detail.addRow();
	
	ds_Detail.setColumn(nRow, "UPJANG", ds_Master.getColumn(ds_Master.rowposition,"UPJANG"));
	ds_Detail.setColumn(nRow, "VISIT_DT", ds_Master.getColumn(ds_Master.rowposition,"VISIT_DT"));
	ds_Detail.setColumn(nRow, "IMGE_CNT", "0");
}

function btn_delete1_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_Detail.getRowCount() <= 0) return;
	
	var nRow,nCnt,strClassCD,strRowtype;

	// 삭제확인
	if(!g_Confirm("01",""))
	{
		return false;
	}

	nRow = ds_Detail.rowposition;
	strRowtype = GetRowType(ds_Detail,nRow);
	ds_Detail.deleteRow(nRow);
	
	if (strRowtype!="insert")
	{
		var actionName, cmdName, inData, outData, otherArg, callBackFnc;
		
		actionName		= "FSC91030E_T004";
		cmdName			= "U_svc::" + "fs/fsc/FSC91030E_T004.jsp";
		inData			= "ds_Detail=ds_Detail:U";
		
		jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc);
	}
}

function btn_input2_onclick(obj:Button,  e:ClickEventInfo)
{
	if(!fn_BeforeCheck())
	{
		return;
	}

	var nRow = ds_Detail1.addRow();
	
	ds_Detail1.setColumn(nRow, "UPJANG", ds_Master.getColumn(ds_Master.rowposition,"UPJANG"));
	ds_Detail1.setColumn(nRow, "VISIT_DT", ds_Master.getColumn(ds_Master.rowposition,"VISIT_DT"));
}

function btn_delete2_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_Detail1.getRowCount() <= 0) return;
	
	var nRow,nCnt,strClassCD,strRowtype;

	// 삭제확인
	if(!g_Confirm("01",""))
	{
		return false;
	}

	nRow = ds_Detail1.rowposition;
	strRowtype = GetRowType(ds_Detail1,nRow);
	ds_Detail1.deleteRow(nRow);
	
	if (strRowtype!="insert")
	{
		var actionName, cmdName, inData, outData, otherArg, callBackFnc;
		
		actionName		= "FSC91030E_T005";
		cmdName			= "U_svc::" + "fs/fsc/FSC91030E_T005.jsp";
		inData			= "ds_Detail1=ds_Detail1:U";
		
		jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc);
	}
}

function ed_CHECK_CONTENTS_onsetfocus(obj:Edit, e:SetFocusEventInfo)
{
	//적박여부가 'Y'일 경우 내용항목 활성화
	if(ds_Master.getColumn(ds_Master.rowposition,"EXPOSE_YN") != "Y")	ed_CHECK_CONTENTS.readonly = true;
	else ed_CHECK_CONTENTS.readonly = false;
}

function ds_Master_cancolumnchange(obj:Dataset, e:DSColChangeEventInfo)
{
	if (e.columnid == "VISIT_DT")
	{
		//trace(e.oldvalue+"-"+e.newvalue);
		//trace(ds_Detail.rowposition+"-"+ds_Detail1.rowposition);
		if(e.oldvalue <> e.newvalue)
		{
			if(ds_Detail.rowposition >= 0) ds_Detail.setColumn(ds_Detail.rowposition,"VISIT_DT",e.newvalue);
			if(ds_Detail1.rowposition >= 0) ds_Detail1.setColumn(ds_Detail1.rowposition,"VISIT_DT",e.newvalue);
		}
	}
}

function grd_list_BKimg(val)
{

	var camera = "'theme://images/new/grd_WF_Camerabtn.png'";
	var expand = "'theme://images/new/grd_WF_Expand.png'";
	
	switch(val)
	{
		case "camera1":
			return "transparent URL(" + camera + ") center middle";
			break;
		
		case "camera2":
			return "#e4e4e4ff URL(" + camera + ") center middle";
			break;
		
		case "selectcamera":
			return "#24a3a8ff URL(" + camera + ") center middle";
			break;
		
		case "popup1":
			return "transparent URL(" + expand + ") center middle";
			break;
		
		case "popup2":
			return "#e4e4e4ff URL(" + expand + ") center middle";
			break;
		
		case "selectpopup":
			return "#24a3a8ff URL(" + expand + ") center middle";
			break;

		default:
			return val;
			break;
	}
}

function grd_detail_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	if (e.cell == 7) //사진
	{
		if(!fbAble) return;
	
		var strUpjang = ds_Detail.getColumn(e.row, "UPJANG");
		var strVisitDt = ds_Detail.getColumn(e.row, "VISIT_DT");
		var strSeqNo = ds_Detail.getColumn(e.row, "SEQNO");
		var strCheckSeq = ds_Detail.getColumn(e.row, "CHECKSEQ");
		var strCheckGb = ds_Detail.getColumn(e.row, "CHECKGBNM");
		var strCheckDtl = ds_Detail.getColumn(e.row, "CHECKDTLNM");
		var strCheckContents = ds_Detail.getColumn(e.row, "CHECK_CONTENTS");
		var strImprvContents = ds_Detail.getColumn(e.row, "IMPRV_CONTENTS");
		
		if(strSeqNo == "" || gfn_isNull(strSeqNo) || strCheckSeq == "" || gfn_isNull(strCheckSeq))
		{
			g_Message("EE", "수검사항 저장 후 이미지작업 가능합니다.");
			return;
		}
		
		//trace(strUpjang+"-"+strVisitDt+"-"+strSeqNo+"-"+strCheckSeq);

		var sParam = {
			  strUpjang:strUpjang
			, strVisitDt:strVisitDt
			, strSeqNo:strSeqNo
			, strCheckSeq:strCheckSeq
			, strCheckGb:strCheckGb
			, strCheckDtl:strCheckDtl
			, strCheckContents:strCheckContents
			, strImprvContents:strImprvContents
		};
		var vRtn = gfn_dialog("", "U_FSC::FSC91030P.xfdl", sParam);
		if(!gfn_isNull(vRtn))
		{
			if(gfn_dsIsUpdated(ds_Detail)==false)
			{
				ds_Detail.setColumn(e.row, "IMGE_CNT", vRtn);
				ds_Detail.updatecontrol = false;
				ds_Detail.setRowType(e.row, Dataset.ROWTYPE_NORMAL);
				ds_Detail.updatecontrol = true;

			}
			else
			{
				ds_Detail.setColumn(e.row, "IMGE_CNT", vRtn);
			}
		}	

	}
}

/**
 * 그룹웨어 점검결과 결재 상신 버튼 클릭 시 상신 팝업을 호출한다.
 * @param obj Button
 * @param e ClickEventInfo
 * @return none
 */
function btn_gwDraftCheck_onclick(obj:Button,  e:ClickEventInfo)
{
    if ( ds_list.getColumn(ds_list.rowposition, "SIGN_PROGRESS_STATUS") == "DRAFT" ) {
        gfn_alert("결재 상신중입니다.");	//
        return;
    }
    if ( ds_list.getColumn(ds_list.rowposition, "SIGN_PROGRESS_STATUS") == "COMPLETE" ) {
        gfn_alert("결재 승인완료 상태 입니다.");	//
        return;
    }

	if (!gfn_confirm("결재상신 하시겠습니까?")) return false;
    
    fn_gwDraftAction();	// 점검결과
}

/**
 * 그룹웨어 상신 버튼 클릭 시 상신 팝업을 호출한다.
 * @param obj Button
 * @param e ClickEventInfo
 * @return none
 */
function fn_gwDraftAction()
{
     //그룹웨어에 전달할 파라메터 생성
    var arrParams	= SCGw.newParams ();

    //(필수) 결재문서 서비스명 - 문서양식별로 설정된 서비스명 설정
    var gwServiceId = "HWRC_FC_FSC_TEST_EXTERNAL";	//신규추가(W/EP 나민유대리)
    
    var gwTitle = ds_Master.getColumn(0, "UPJANG_NM") + " - 외부기관 점검결과 보고서";

    SCGw.setParams (arrParams, SCGw.GW_SERVICE_NAME, gwServiceId);

    //(필수) 본문 URL : (주의) .do로 호출해야 하며 GET 방식으로 파라미터를 전달 (id라는 key는 사용 불가)
    var sBodyUrl = "/fs/cmn/gwDraftController/makeGwDraftExternalContent.do?"
                                            + "UPJANG=" + ds_list.getColumn(ds_list.rowposition, "UPJANG")
                                            + "&VISIT_DT=" + ds_list.getColumn(ds_list.rowposition, "VISIT_DT")
                                            + "&SEQNO=" + ds_list.getColumn(ds_list.rowposition, "SEQNO")
                                            + "&IMG_ROOT=" + fsp_getServerDir("FSC_RESULT_PHOTO", "") + "/"
                                            //모바일에서 그룹웨어 결제 어플에서 읽기 위해서 결제할때 외부 URL 사용
                                            //+ "&IMG_ROOT=" + "https://nfics.hanwhafoodist.co.kr//app/gpfs/app_repository/ifis/upload/fs/fsc/photo" + "/"
                                            ;
                                            
    SCGw.setParams (arrParams, SCGw.GW_BODY_URL, sBodyUrl);

    //(필수) 본문 제목 – 문서양식 별로 설정된 업무명
    SCGw.setParams (arrParams, SCGw.GW_BODY_TITLE, gwTitle);

    //(필수)문서 방향 : 가로 또는 세로 방향 (GW_VERTICAL, GW_HORIZONTAL)
    SCGw.setParams (arrParams, SCGw.GW_PORTRAIT, SCGw.GW_HORIZONTAL);
    
    //(선택)첨부문서 목록 : json 형태 문자열
	SCGw.setParams (arrParams, SCGw.GW_ATTACH_LIST, fv_attachList);

    //(선택)Client Id : 결재 instance id와 연관을 맺기위한 업무별 ID로 unique key를 이용, 생략하면 상신시각이 됨(최대 40 byte)
    //SCGw.setParams (arrParams, SCGw.GW_CLIENT_ID, edt_id.value);

    //그룹웨어 상신 팝업을 호출한다.
    SCGw.sendDraft (this, arrParams);
}

/**
 * 그룹웨어 결재상세 버튼 클릭 시 결재상세 팝업을 호출한다.
 * @param obj Button
 * @param e ClickEventInfo
 * @return none
 */
function btn_gwDetailCheck_onclick(obj:Button,  e:ClickEventInfo)
{
    //그룹웨어 결재상세 팝업을 호출한다.
    SCGw.sendDetailView (this, ds_list.getColumn(ds_list.rowposition, "SIGN_INSTANCE_ID"));
}

/**
 * 그룹웨어 상신 처리 후 반환되는 Instance Id를 처리한다. (업무 테이블에 update)
 * (중요) 이 함수는 SCGw에서 호출되므로 필히 선언되어야 한다.
 * @param instanceId
 * @return none
 */
function scgw_ondraftnotify(instanceId)
{
	ds_list.setColumn(ds_list.rowposition, "SIGN_INSTANCE_ID", instanceId);	 //결재InstanceId 설정
	ds_list.setColumn(ds_list.rowposition, "SIGN_PROGRESS_STATUS", SCGw.GW_DRAFT_STATUS);	 //결재진행상태를 상신으로 설정

    ds_list.updatecontrol = false;
    ds_list.setRowType(ds_list.rowposition, Dataset.ROWTYPE_NORMAL);
    ds_list.updatecontrol = true;

    fn_gwResultDraft();	//결재정보 저장
}

/**
 * 전자결재 결과 정보를 업무테이블에 저장 한다.
 * @param
 * @return
 */
function fn_gwResultDraft()
{
	ds_input.setColumn(0, "UPJANG", ds_list.getColumn(ds_list.rowposition, "UPJANG"));
	ds_input.setColumn(0, "VISIT_DT", ds_list.getColumn(ds_list.rowposition, "VISIT_DT"));
	ds_input.setColumn(0, "SEQNO", ds_list.getColumn(ds_list.rowposition, "SEQNO"));
	
	ds_input.setColumn(0, "SIGN_INSTANCE_ID", ds_list.getColumn(ds_list.rowposition, "SIGN_INSTANCE_ID"));

    jsp_transaction(
		  this									// 해당 스크립트를 호출하는 Form 객체
		, "FSC91030E_T008"						// 서비스 ID
		, "U_svc::fs/fsc/FSC91030E_T008.jsp"	// 서비스 URL
		, "ds_input=ds_input:A"					// 서버로 전송할 DataSet 객체 Str
		, ""									// 서버로부터 전송 받을 DataSet 객체 String
		, ""									// 서버로 전송할 기타 Argument 정보 String
		, "fn_callBackDraft"					// 서버에서 처리가 완료된 후 Callback 받을 Function 명
		, true									// 에러 발생 시 Callback 함수 호출 여부
		, false									// 처리중입니다. 메시지 창 보여줄지 여부 설정하기
		, true									// 동기식으로 설정할지 여부
	);
}

/**
 * 전자결재 결과 정보를 업무테이블에 저장한 callback
 * @param
 * @return
 */
function fn_callBackDraft(errCode, errMsg) 
{
	if( errCode != 0 ) {
		g_Message("EE", errMsg);
		return;
	}
	else
	{
        // 전자결재 상신 또는 상신상세 버튼 연동
        fn_gwUserButtonInit();
        
        g_Message("02", " 결재 상신 되었습니다!");
        
        ds_input
        
        if (gfn_isNull(edt_upjang.getUpjangCode())) {
			ds_input.setColumn(0, "UPJANG", "");
        }
        
        ds_input.setColumn(0, "VISIT_DT", "");
		ds_input.setColumn(0, "SEQNO", "");
        ds_input.setColumn(0, "SIGN_INSTANCE_ID", "");
        
        // 재조회
        fn_search() ;
	}
}]]></Script>
  </Form>
</FDL>

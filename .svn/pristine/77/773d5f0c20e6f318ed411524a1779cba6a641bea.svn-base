<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="ObjPaging" classname="CMPageFrmInfo" inheritanceid="" position="absolute 0 0 1017 24" titletext="Paging User Object" onsize="ObjPaging_onsize" scrollbars="none" class="sta_paging_Bg" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="sta_pageBg" position="absolute 0 0 1017 25" style="background:#f4f4f4ff;" text="" anchor="left right bottom"/>
        <Div id="divPage" taborder="1" applystyletype="cascade,keep" position="absolute 362 0 654 26" scrollbars="none" anchor="left right bottom">
          <Layouts>
            <Layout>
              <Button id="Button44" taborder="0" onclick="Button44_onclick" class="btn_WF_PagePrevious" position="absolute 43 5 58 21" anchor="left top"/>
              <Button id="Button45" taborder="1" class="btn_WF_PageNext" position="absolute 234 5 249 21" anchor="left top"/>
              <Button id="Button46" taborder="2" class="btn_WF_PagePreviousP" position="absolute 24 5 41 21" anchor="left top"/>
              <Button id="Button47" taborder="3" class="btn_WF_PageNextP" position="absolute 251 5 268 21" anchor="left top"/>
              <Static id="Static102" class="sta_GID_H" visible="false" position="absolute 17 6 22 22"/>
              <Static id="Static109" visible="false" position="absolute 41 1 43 20" style="background:crimson;opacity:70;" anchor="left top"/>
              <Button id="Button49" taborder="4" text="1" class="btn_WF_Page" position="absolute 62 5 77 21" anchor="left top"/>
              <Button id="Button50" taborder="5" text="2" class="btn_WF_Page" position="absolute 79 5 94 21" anchor="left top"/>
              <Button id="Button51" taborder="6" text="3" class="btn_WF_Page" position="absolute 96 5 111 21" anchor="left top"/>
              <Button id="Button52" taborder="7" text="4" class="btn_WF_Page" position="absolute 113 5 128 21" anchor="left top"/>
              <Button id="Button53" taborder="8" text="5" class="btn_WF_Page" position="absolute 130 5 145 21" anchor="left top"/>
              <Button id="Button54" taborder="9" text="6" class="btn_WF_Page" position="absolute 147 5 162 21" anchor="left top"/>
              <Button id="Button55" taborder="10" text="7" class="btn_WF_Page" position="absolute 164 5 179 21" anchor="left top"/>
              <Button id="Button56" taborder="11" text="8" class="btn_WF_Page" position="absolute 181 5 196 21" anchor="left top"/>
              <Button id="Button57" taborder="12" text="9" class="btn_WF_Page" position="absolute 198 5 213 21" anchor="left top"/>
              <Button id="Button61" taborder="13" text="10" class="btn_WF_Page" position="absolute 215 5 230 21" anchor="left top"/>
              <Static id="Static38" visible="false" position="absolute 77 2 79 21" style="background:crimson;opacity:70;" anchor="left top"/>
              <Static id="Static40" visible="false" position="absolute 94 2 96 21" style="background:crimson;opacity:70;" anchor="left top"/>
              <Static id="Static42" visible="false" position="absolute 111 2 113 21" style="background:crimson;opacity:70;" anchor="left top"/>
              <Static id="Static49" visible="false" position="absolute 128 2 130 21" style="background:crimson;opacity:70;" anchor="left top"/>
              <Static id="Static51" visible="false" position="absolute 145 2 147 21" style="background:crimson;opacity:70;" anchor="left top"/>
              <Static id="Static134" visible="false" position="absolute 162 2 164 21" style="background:crimson;opacity:70;" anchor="left top"/>
              <Static id="Static144" visible="false" position="absolute 179 2 181 21" style="background:crimson;opacity:70;" anchor="left top"/>
              <Static id="Static146" visible="false" position="absolute 196 2 198 21" style="background:crimson;opacity:70;" anchor="left top"/>
              <Static id="Static148" visible="false" position="absolute 213 2 215 21" style="background:crimson;opacity:70;" anchor="left top"/>
              <Static id="Static154" visible="false" position="absolute 58 1 62 20" style="background:crimson;opacity:70;" anchor="left top"/>
              <Static id="Static156" visible="false" position="absolute 230 1 234 20" style="background:crimson;opacity:70;" anchor="left top"/>
              <Static id="Static159" visible="false" position="absolute 249 1 251 20" style="background:crimson;opacity:70;" anchor="left top"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="stc00" text="화면조회건수 :" position="absolute 15 2 100 23" style="font:Dotum,9;" visible="false" anchor="left bottom"/>
        <Combo id="cmbSelCnt" taborder="2" position="absolute 103 2 173 23" codecolumn="codecolumn" datacolumn="datacolumn" onitemchanged="f_chagneRowPage" visible="false" class="cmb_paging" anchor="left bottom" displayrowcount="10">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">10</Col>
                <Col id="datacolumn">10</Col>
              </Row>
              <Row>
                <Col id="codecolumn">50</Col>
                <Col id="datacolumn">50</Col>
              </Row>
              <Row>
                <Col id="codecolumn">100</Col>
                <Col id="datacolumn">100</Col>
              </Row>
              <Row>
                <Col id="codecolumn">500</Col>
                <Col id="datacolumn">500</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1000</Col>
                <Col id="datacolumn">1000</Col>
              </Row>
              <Row>
                <Col id="codecolumn">5000</Col>
                <Col id="datacolumn">5000</Col>
              </Row>
              <Row>
                <Col id="codecolumn">10000</Col>
                <Col id="datacolumn">10000</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="stc01" text="page /" visible="false" position2="absolute r:70 w:44 t:2 h:21" positiontype="position2"/>
        <Static id="stc02" text="" style="border:0 solid #b2bbc3ff ;align:left middle;" mask="###,###" position2="absolute r:10 w:59 t:2 h:21" positiontype="position2"/>
        <Edit id="cmbPageList" taborder="1" maxlength="50" paramid="lopNm" inputtype="number" style="align:right middle;" visible="false" onkeydown="cmbPageList_onkeydown" onsetfocus="cmbPageList_onsetfocus" position2="absolute r:120 w:64 t:2 h:21" positiontype="position2"/>
        <Combo id="cmbPageList_old" taborder="1" innerdataset="@ds_cmbPageList" codecolumn="COL_CD" datacolumn="COL_NM" displayrowcount="5" onitemchanged="f_chagneCmbPage" class="cmb_paging" visible="false" position="absolute 837 33 901 54" anchor="right bottom">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows/>
          </Dataset>
        </Combo>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cmbPageList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="COL_CD" type="STRING" size="256"/>
          <Column id="COL_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item54" compid="cmbPageList_old" propid="value" datasetid="ds_cond" columnid="lopNm"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
  파일명 : ObjPaging.xfdl
  설  명 : Paging User Object

  수정일       수정자   수정내용
  ----------   -------  --------------------------------------------------
  2013.01.07   김윤기   최초 생성
  2015.05.18   kksoo     Maximize, Minimize 시 위치 조정에 오류가 있어 position2로 변경하여 재조정
*/


/****************************************************************************************
 * FORM 변수 선언 영역
 ****************************************************************************************/ 
var nNowPageNum = 1;       // 현재 페이지
var nPageRowCnt = 10;      // 페이지당 조회 건 수
var nPageScaleC = 10;      // 하단에 Pasing되는 page번호 갯수
var nTotPageCnt = 0;       // 서버에서 총 건수를 꼭 받아야 페이징을 합니다.
var sParentFunN = null;    // Page 조회 Fuction ID
var sPageInfoDS = null;    // Page Info DataSet
var nTotalPageC;
var nDivWidth   = 292;     // Div width
var bFlag       = true;

var bOnlyPagingBtn = false; 

/***************************************************************************
 * 설명        : Page Composite Load
 * 파라미터    : dsPageInfo - Page Info DataSet
 *             : fnID       - Paging 처리 Fuction ID
 *             : cFlag      - 조회 콤보 사용유무
 ***************************************************************************/
function fn_pageLoad(strPageInfoDs, fnID, cFlag) {
    if(cFlag == undefined ) {
        bFlag = true;
    } else {
        bFlag = cFlag;
    }
    
    nTotPageCnt = eval(strPageInfoDs).getColumn(0, "totalCount");
	nNowPageNum = eval(strPageInfoDs).getColumn(0, "currentPage");
    nPageRowCnt = eval(strPageInfoDs).getColumn(0, "volumePerPage");
    sParentFunN = fnID;
    sPageInfoDS = strPageInfoDs;
    
    // 페이지 번호 생성
    fn_makePage();
}

/***************************************************************************
 * 설명            : 페이징버튼만 보이도록
 ***************************************************************************/
function onlyPagingBtn() {
    bOnlyPagingBtn = true;
    
    stc00.visible       = false;
    cmbSelCnt.visible   = false;
    cmbPageList.visible = false;
    stc01.visible       = false;
    stc02.visible       = false;
}

/***************************************************************************
 * 설명            : Page Number Button Click
 ***************************************************************************/
function fn_pageList(obj) {
    eval(sPageInfoDS).setColumn(0, "currentPage", obj.userData);
    
    // Parent Page Search Function 호줄
    eval(sParentFunN + "()");
}

/***************************************************************************
 * 설명            : 페이지당 조회 건 수 변경시
 ***************************************************************************/
function f_chagneRowPage() {
    eval(sPageInfoDS).setColumn(0, "volumePerPage", cmbSelCnt.value);
    eval(sPageInfoDS).setColumn(0, "currentPage"  , 1);
    
    // Parent Page Search Function 호출
    eval(sParentFunN+"()");
}

/***************************************************************************
 * 설명            : Page 변경 시
 ***************************************************************************/
function cmbPageList_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode != 13) return;
	
	if(cmbPageList.value > nTotalPageC) {
		gfn_alert("이동할 페이지가 총 페이지보다 큽니다.");
		cmbPageList.value = nTotalPageC;
		cmbPageList.setSelect();
		return;
	}
	f_chagneCmbPage();
}

function f_chagneCmbPage() {
    eval(sPageInfoDS).setColumn(0, "volumePerPage", cmbSelCnt.value);
    eval(sPageInfoDS).setColumn(0, "currentPage"  , cmbPageList.value);
    
    // Parent Page Search Function 호출
    eval(sParentFunN+"()");
}

/***************************************************************************
 * 설명            : 페이지 번호 생성
 ***************************************************************************/
function fn_makePage() {
    var iLeft    = 100;
    var iWidth   = 15;
    var iTop     = 2;
    var iBottom  = 18;
    var iMyFont  = "";
    var iMyColor = "";
    var iTab     = 0;
    var iDivLeft = 0;
    
    // divPage Layout 구성
    var sb = "<Layout>\n";
    nTotalPageC = 0;
    
    if( Math.floor( nTotPageCnt % nPageRowCnt ) > 0 ) {
        nTotalPageC = Math.floor( nTotPageCnt / nPageRowCnt ) + 1;
    } else {
        nTotalPageC = Math.floor( nTotPageCnt / nPageRowCnt );
    }
    
    var uint = Math.floor( ( Number( nNowPageNum ) - 1 ) / Number( nPageScaleC ) );
        uint = ( uint * nPageScaleC ) + 1;
    
    var nextUnit = Number( uint + nPageScaleC );
    
    for (var i=uint; i<nextUnit; i++) {
        if(i > nTotalPageC) break;
        iLeft -= 10;
    }
    
    iDivLeft = iLeft;
    
    // 첫페이지(<<)
    if(uint > nPageScaleC) {
        sb = sb + "<Button id='first' taborder='0' userData='1' class='btn_WF_PagePreviousP' position='absolute " + iLeft + " " + iTop + " " + (iLeft + iWidth) + " " + iBottom + "' onclick='fn_pageList'/>\n" ;
    } else {
        sb = sb + "<Button id='first' taborder='0' enable='false' userData='1' class='btn_WF_PagePreviousP' position='absolute " + iLeft + " " + iTop + " " + (iLeft + iWidth) + " " + iBottom + "' />\n" ;
    }
    
    iLeft = iLeft + iWidth + 2;

    // 앞으로(<)
    if(uint > nPageScaleC) {
        sb = sb + "<Button id='before' taborder='" + iTab++ + "' userData='" + (uint - 1) +"' class='btn_WF_PagePrevious' position='absolute " + iLeft + " " + iTop + " " + (iLeft + iWidth) + " " + iBottom + "' onclick='fn_pageList'/>\n" ;
    } else {
        sb = sb + "<Button id='before' taborder='" + iTab++ + "' enable='false' userData='" + (uint - 1) + "' class='btn_WF_PagePrevious' position='absolute " + iLeft + " "+ iTop + " " + (iLeft + iWidth) + " "+ iBottom + "'/>\n" ;
    }
    
    iLeft = iLeft + 4;
    
    // 페이징[1 2 3 4 5 6 7 8 9 10]
    for(var i=uint; i<nextUnit; i++ ) {
        if ( gfn_lengthByte(uint) > 2 ) {
            iWidth = 15 + (gfn_lengthByte(uint)*3);
        }
        
        iLeft = iLeft + iWidth;
        
        if(i > nTotalPageC) break;
        
        if(i == nNowPageNum) {
            sb = sb + "<Button id='" + i + "' taborder='" + iTab++ + "' userData='" + i + "' position='absolute " + iLeft + " " + iTop + " " + (iLeft + iWidth) + " " + iBottom + "' class='btn_WF_Page' font='굴림,9,bold' text='" + i + "' color='blue' />\n" ;
        } else {
            sb = sb + "<Button id='" + i + "' taborder='" + iTab++ + "' userData='" + i + "' position='absolute " + iLeft + " " + iTop + " " + (iLeft + iWidth) + " " + iBottom + "' class='btn_WF_Page' font='굴림,9' text='" + i + "' color='black' onclick='fn_pageList'/>\n" ;
        }
    }
    
    if ( gfn_lengthByte(uint) > 2 ) {
        iLeft = iLeft + (gfn_lengthByte(uint)*3);
    }
    
    if (i == nextUnit ) {
        iLeft = iLeft + iWidth;
    }
    
    iWidth = 15;
    iLeft = iLeft + 4;
    
    // 뒤로(>)
    if( nextUnit <= nTotalPageC ) {
        sb = sb + "<Button id='next'  taborder='" + iTab++ + "' userData='" + nextUnit + "' class='btn_WF_PageNext' position='absolute " + iLeft + " " + iTop + " " + (iLeft + iWidth) + " " + iBottom + "' onclick='fn_pageList'/>\n" ;
    } else {
        sb = sb + "<Button id='next'  taborder='" + iTab++ + "' enable='false' userData='" + nextUnit + "' class='btn_WF_PageNext' position='absolute " + iLeft + " " + iTop + " " + (iLeft + iWidth) + " " + iBottom+"' />\n" ;
    }
    
    iLeft = iLeft + iWidth + 2;
    
    // 마지막페이지(>>)
    if(nextUnit < nTotalPageC) {
        sb = sb + "<Button id='end'  taborder='" + iTab++ + "' userData='" + nTotalPageC + "' class='btn_WF_PageNextP' position='absolute " + iLeft + " " + iTop + " "+ (iLeft + iWidth) + " " + iBottom + "' onclick='fn_pageList'/>\n" ;
    } else {
        sb = sb + "<Button id='end'  taborder='" + iTab++ +"' enable='false' userData='" + nTotalPageC + "' class='btn_WF_PageNextP' position='absolute " + iLeft + " " + iTop + " " + (iLeft + iWidth) + " " + iBottom + "' />\n" ;
    }
    
    sb = sb +"</Layout>\n";
    
    divPage.layout = sb;
    
    nDivWidth = divPage.end.position.right + iDivLeft;
    
    // 화면기타설정
    fn_setDisplay();
}

/***************************************************************************
 * 설명            : 기타 화면 설정
 ***************************************************************************/
function fn_setDisplay() {
    if(bFlag) {
        // 한화면 조회 건수 설정
        if( nTotPageCnt > 0 && !bOnlyPagingBtn ) {
            stc00.visible     = true;
            cmbSelCnt.visible = true;
            cmbSelCnt.value   = nPageRowCnt;
        } else {
            stc00.visible     = false;
            cmbSelCnt.visible = false;
        }
        
        // 총건수 및 페이징콤보설정
        if( nTotPageCnt > 0 ) {
            ds_cmbPageList.clearData();
            for(var i=1; i<=nTotalPageC; i++ ) {
                ds_cmbPageList.addRow();
                ds_cmbPageList.setColumn( (i-1), "COL_CD", i );
                ds_cmbPageList.setColumn( (i-1), "COL_NM", i );
            }
            
            if ( !bOnlyPagingBtn ) {
                stc01.visible = true;
                stc02.visible = true;
                stc02.text    = nTotalPageC;
                
                cmbPageList.visible = true;
                cmbPageList.value   = nNowPageNum;
            }
        } else {
            stc01.visible       = false;
            stc02.visible       = false;
            cmbPageList.visible = false;
        }
    }
    
    divPage.position.left  = this.position.width/2 - nDivWidth/2;
    divPage.position.width = nDivWidth
    sta_pageBg.width       = this.position.right;
}

/***************************************************************************
 * 설명            : Form onsize
 ***************************************************************************/
function ObjPaging_onsize(obj:Form, e:SizeEventInfo) {
    divPage.position.left  = this.position.width/2 - nDivWidth/2;
    sta_pageBg.width       = this.position.right - this.position.left;
}

/***************************************************************************
 * 설명            : Form onload
 ***************************************************************************/
function form_onload(obj:Form, e:LoadEventInfo)
{
	ObjPaging_onsize ();
}
]]></Script>
  </Form>
</FDL>

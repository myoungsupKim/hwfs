<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FMM00210E" onkeydown="fn_form_OnKeyDown" onload="form_onload" titletext="레시피검색및 등록" position="absolute 0 0 1220 744" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static49" class="sta_WFDA_Labelbg" position="absolute 15 82 599 109"/>
        <Static id="Static05" class="sta_WFDA_Labelbg" position="absolute 15 108 599 135"/>
        <Static id="Static24" class="sta_WFDA_Labelbg" position="absolute 15 160 599 187"/>
        <Static id="Static25" class="sta_WFDA_Labelbg" position="absolute 15 134 599 161"/>
        <ImageViewer id="img_Weather" taborder="35" position="absolute 15 53 43 78" style="border:0 none #cacacaff ;"/>
        <Grid autoenter="select" binddataset="ds_Menu" selecttype="row" cellsizingtype="both" readonly="false" enable="true" id="grd_RealRecipe" useinputpanel="false" oncellclick="grd_RealRecipe_OnCellClick" onheadclick="grd_RealRecipe_OnHeadClick" onmousemove="grd_RealRecipe_OnMouseOver" onsummclick="grd_RealRecipe_OnSummClick" taborder="26" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 631 82 1205 356">
          <Formats>
            <Format id="ETC">
              <Columns>
                <Column size="25"/>
                <Column size="0"/>
                <Column size="30"/>
                <Column size="21"/>
                <Column size="55"/>
                <Column size="120"/>
                <Column size="60"/>
                <Column size="25"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" style="align:center;" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="????"/>
                <Cell col="2" rowspan="2" displaytype="text" text="구축"/>
                <Cell col="3" rowspan="2" colspan="2" displaytype="text" text="레시피코드"/>
                <Cell col="5" rowspan="2" displaytype="text" text="레시피명"/>
                <Cell col="6" rowspan="2" displaytype="text" text="원가&#10;(원)"/>
                <Cell col="7" rowspan="2" displaytype="text" text="색"/>
                <Cell col="8" rowspan="2" displaytype="text" text="에너지&#10;(kcal)"/>
                <Cell col="9" rowspan="2" displaytype="text" text="당질&#10;(g)"/>
                <Cell col="10" rowspan="2" displaytype="text" text="단백질&#10;(g)"/>
                <Cell col="11" rowspan="2" displaytype="text" text="지질&#10;(g)"/>
                <Cell col="12" rowspan="2" displaytype="text" text="비타민A&#10;(R.E)"/>
                <Cell col="13" rowspan="2" displaytype="text" text="비타민B1&#10;(mg)"/>
                <Cell col="14" rowspan="2" displaytype="text" text="비타민B2&#10;(mg)"/>
                <Cell col="15" rowspan="2" displaytype="text" text="비타민C&#10;(mg)"/>
                <Cell col="16" rowspan="2" displaytype="text" text="칼슘&#10;(mg)"/>
                <Cell col="17" rowspan="2" displaytype="text" text="철&#10;(mg)"/>
                <Cell col="18" rowspan="2" displaytype="text" text="구분"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:right;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="number" edittype="text" editfilter="number" style="align:right;" text="bind:RECIPE_SEQ"/>
                <Cell col="2" displaytype="checkbox" edittype="checkbox" style="align:center;" text="bind:CREAT"/>
                <Cell col="3" displaytype="image" style="align: ;" text="URL('theme://Images/new/grd_WF_ExpandImageX.png')"/>
                <Cell col="4" displaytype="text" style="align:center;" text="bind:RECIPE_CD"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:RECIPE_COST"/>
                <Cell col="7" displaytype="image" style="align:center middle;" text="expr:gfn_nvl(COLOR)==&quot;&quot;?&quot;&quot;:&quot;URL('theme://convertImages/&quot;+COLOR+&quot;.bmp')&quot;"/>
                <Cell col="8" displaytype="number" style="align:right;" text="bind:S_KCAL"/>
                <Cell col="9" displaytype="number" style="align:right;" text="bind:S_CARBO"/>
                <Cell col="10" displaytype="number" style="align:right;" text="bind:S_PROT"/>
                <Cell col="11" displaytype="number" style="align:right;" text="bind:S_FAT"/>
                <Cell col="12" displaytype="number" style="align:right;" text="bind:S_VITA"/>
                <Cell col="13" displaytype="number" style="align:right;" text="bind:S_THIA"/>
                <Cell col="14" displaytype="number" style="align:right;" text="bind:S_RIBO"/>
                <Cell col="15" displaytype="number" style="align:right;" text="bind:S_VITA_C"/>
                <Cell col="16" displaytype="number" style="align:right;" text="bind:S_CA"/>
                <Cell col="17" displaytype="number" style="align:right;" text="bind:S_FE"/>
                <Cell col="18" displaytype="text" style="align:left;" text="bind:ATTR04"/>
              </Band>
              <Band id="summary">
                <Cell colspan="5" displaytype="text" style="align:center;" text="합계"/>
                <Cell col="5" displaytype="text" style="align:right;"/>
                <Cell col="6" displaytype="number" style="align:right;" expr="expr:getSum('RECIPE_COST')"/>
                <Cell col="7" displaytype="text" style="align:left;"/>
                <Cell col="8" displaytype="number" style="align:right;" expr="expr:getSum('S_KCAL')"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:getSum('S_CARBO')"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="expr:getSum('S_PROT')"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:getSum('S_FAT')"/>
                <Cell col="12" displaytype="number" style="align:right;" expr="expr:getSum('S_VITA')"/>
                <Cell col="13" displaytype="number" style="align:right;" expr="expr:getSum('S_THIA')"/>
                <Cell col="14" displaytype="number" style="align:right;" expr="expr:getSum('S_RIBO')"/>
                <Cell col="15" displaytype="number" style="align:right;" expr="expr:getSum('S_VITA_C')"/>
                <Cell col="16" displaytype="number" style="align:right;" expr="expr:getSum('S_CA')"/>
                <Cell col="17" displaytype="number" style="align:right;" expr="expr:getSum('S_FE')"/>
                <Cell col="18" displaytype="text" style="align:left;"/>
              </Band>
            </Format>
            <Format id="SS_ETC">
              <Columns>
                <Column size="25"/>
                <Column size="0"/>
                <Column size="30"/>
                <Column size="21"/>
                <Column size="55"/>
                <Column size="120"/>
                <Column size="60"/>
                <Column size="25"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" style="align:center;" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="????"/>
                <Cell col="2" rowspan="2" displaytype="text" text="구축"/>
                <Cell col="3" rowspan="2" colspan="2" displaytype="text" text="레시피코드"/>
                <Cell col="5" rowspan="2" displaytype="text" text="레시피명"/>
                <Cell col="6" rowspan="2" displaytype="text" text="원가&#10;(원)"/>
                <Cell col="7" rowspan="2" displaytype="text" text="색"/>
                <Cell col="8" rowspan="2" displaytype="text" text="에너지&#10;(kcal)"/>
                <Cell col="9" rowspan="2" displaytype="text" text="당질&#10;(g)"/>
                <Cell col="10" rowspan="2" displaytype="text" text="단백질&#10;(g)"/>
                <Cell col="11" rowspan="2" displaytype="text" text="지질&#10;(g)"/>
                <Cell col="12" rowspan="2" displaytype="text" text="비타민A&#10;(R.E)"/>
                <Cell col="13" rowspan="2" displaytype="text" text="비타민B1&#10;(mg)"/>
                <Cell col="14" rowspan="2" displaytype="text" text="비타민B2&#10;(mg)"/>
                <Cell col="15" rowspan="2" displaytype="text" text="비타민C&#10;(mg)"/>
                <Cell col="16" rowspan="2" displaytype="text" text="칼슘&#10;(mg)"/>
                <Cell col="17" rowspan="2" displaytype="text" text="철&#10;(mg)"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:right;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="number" edittype="text" editfilter="number" style="align:right;" text="bind:RECIPE_SEQ"/>
                <Cell col="2" displaytype="checkbox" edittype="checkbox" style="align:center;" text="bind:CREAT"/>
                <Cell col="3" displaytype="image" style="align: ;" text="URL('theme://Images/new/grd_WF_ExpandImageX.png')"/>
                <Cell col="4" displaytype="text" style="align:center;" text="bind:RECIPE_CD"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:RECIPE_COST"/>
                <Cell col="7" displaytype="image" style="align:center;" text="expr:&quot;URL('theme://convertImages/&quot;+COLOR+&quot;.bmp')&quot;"/>
                <Cell col="8" displaytype="number" style="align:right;" text="bind:SS_KCAL"/>
                <Cell col="9" displaytype="number" style="align:right;" text="bind:SS_CARBO"/>
                <Cell col="10" displaytype="number" style="align:right;" text="bind:SS_PROT"/>
                <Cell col="11" displaytype="number" style="align:right;" text="bind:SS_FAT"/>
                <Cell col="12" displaytype="number" style="align:right;" text="bind:SS_VITA"/>
                <Cell col="13" displaytype="number" style="align:right;" text="bind:SS_THIA"/>
                <Cell col="14" displaytype="number" style="align:right;" text="bind:SS_RIBO"/>
                <Cell col="15" displaytype="number" style="align:right;" text="bind:SS_VITA_C"/>
                <Cell col="16" displaytype="number" style="align:right;" text="bind:SS_CA"/>
                <Cell col="17" displaytype="number" style="align:right;" text="bind:SS_FE"/>
              </Band>
              <Band id="summary">
                <Cell colspan="5" displaytype="text" style="align:center;" text="합계"/>
                <Cell col="5" displaytype="text" style="align:right;"/>
                <Cell col="6" displaytype="number" style="align:right;" expr="expr:getSum('RECIPE_COST')"/>
                <Cell col="7" displaytype="text" style="align:left;"/>
                <Cell col="8" displaytype="number" style="align:right;" expr="expr:getSum('SS_KCAL')"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:getSum('SS_CARBO')"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="expr:getSum('SS_PROT')"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:getSum('SS_FAT')"/>
                <Cell col="12" displaytype="number" style="align:right;" expr="expr:getSum('SS_VITA')"/>
                <Cell col="13" displaytype="number" style="align:right;" expr="expr:getSum('SS_THIA')"/>
                <Cell col="14" displaytype="number" style="align:right;" expr="expr:getSum('SS_RIBO')"/>
                <Cell col="15" displaytype="number" style="align:right;" expr="expr:getSum('SS_VITA_C')"/>
                <Cell col="16" displaytype="number" style="align:right;" expr="expr:getSum('SS_CA')"/>
                <Cell col="17" displaytype="number" style="align:right;" expr="expr:getSum('SS_FE')"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_ImgPop" onclick="btn_ImgPop_OnClick" taborder="33" position="absolute 631 361 652 382" class="btn_WF_camera" image=""/>
        <Button id="btn_Qality" onclick="btn_Qality_OnClick" taborder="27" text=" 품질평가" position="absolute 654 361 717 382" class="btn_WF_Custom" image=""/>
        <Button id="btn_Nut" onclick="btn_Nut_OnClick" taborder="28" text="영양평가" position="absolute 719 361 783 382" class="btn_WF_Custom" image=""/>
        <CheckBox id="chk_disuse1" onclick="chk_disuse_OnClick" taborder="34" text="폐기율미적용 영양소보기" visible="false" position="absolute 1248 380 1416 400" value="true"/>
        <Button id="btn_leftMoveData" onclick="btn_leftMoveData_OnClick" taborder="21" text="" position="absolute 604 218 626 240" class="btn_WF_rightMove" image=""/>
        <Combo codecolumn="CD" datacolumn="NM" id="cbo_CuisineClass" index="0" innerdataset="ds_CookClass" onkeydown="common_OnKeyDown" type="filter" taborder="13" position="absolute 18 137 212 158" displayrowcount="10"/>
        <Combo codecolumn="CD" datacolumn="NM" id="cbo_Item" index="0" innerdataset="ds_Material" onkeydown="common_OnKeyDown" type="filter" taborder="14" position="absolute 213 137 408 158" displayrowcount="10"/>
        <Combo codecolumn="CD" datacolumn="NM" id="cbo_Element" index="0" innerdataset="ds_Element" onkeydown="common_OnKeyDown" type="filter" taborder="15" position="absolute 409 137 596 158" displayrowcount="10"/>
        <MaskEdit id="me_SalePfrom" taborder="18" visible="false" position="absolute 390 163 481 184"/>
        <Static id="Static14" text="~" visible="false" position="absolute 487 163 496 184"/>
        <MaskEdit id="me_SalePto" taborder="19" visible="false" position="absolute 502 163 596 184"/>
        <CheckBox id="chk_StdRecipe" taborder="8" text="본사표준레시피" position="absolute 141 85 242 106" value="true" falsevalue="0" truevalue="1"/>
        <CheckBox id="chk_UpjangRecipe" taborder="9" text="사업장표준레시피" position="absolute 253 85 372 106" value="true" falsevalue="0" truevalue="1"/>
        <Static id="Static41" text="원가" position="absolute 15 160 84 187" class="sta_WFDA_Label01"/>
        <MaskEdit id="me_UnitPfrom" onkeydown="common_OnKeyDown" taborder="16" position="absolute 86 163 192 184"/>
        <Static id="Static12" text="~" position="absolute 199 163 208 184"/>
        <MaskEdit id="me_UnitPto" onkeydown="common_OnKeyDown" taborder="17" position="absolute 213 163 315 184"/>
        <Static id="Static23" text="판매가" visible="false" position="absolute 317 160 388 187" class="sta_WFDA_Label01"/>
        <Button id="btn_SubSearch" onclick="btn_SubSearch_OnClick" taborder="32" text="조회" position="absolute 547 56 599 77" class="btn_WF_Custom" image=""/>
        <Combo codecolumn="CD" datacolumn="NM" id="cbo_RecipeType" index="0" innerdataset="ds_RecipeType" onitemchanged="cbo_RecipeType_OnChanged" onkeydown="common_OnKeyDown" type="filter" taborder="12" position="absolute 409 111 596 132" displayrowcount="10"/>
        <Combo codecolumn="CD" datacolumn="NM" id="cbo_RecipeClass" index="0" innerdataset="ds_RecipeClass" onkeydown="common_OnKeyDown" type="filter" taborder="11" position="absolute 213 111 408 132" displayrowcount="10"/>
        <Combo codecolumn="NM" datacolumn="NM" id="cbo_RecipeNM" imemode="hangul" index="0" innerdataset="ds_RecipeNM" type="filter" taborder="10" position="absolute 18 111 212 132" displayrowcount="10" onkillfocus="cbo_RecipeNM_onkillfocus" onkeydown="cbo_RecipeNM_onkeydown" onitemchanged="cbo_RecipeNM_onitemchanged" ontextchanged="cbo_RecipeNM_ontextchanged"/>
        <Button id="btn_ibDateUpdate" onclick="btn_ibDateUpdate_OnClick" taborder="44" text="입고예정일 일괄수정" visible="false" position="absolute 1248 400 1371 422" class="btn_WF_Custom" image=""/>
        <CheckBox id="chk_HWStdRecipe" taborder="7" text="한화표준레시피" position="absolute 21 85 128 106" value="true" falsevalue="0" truevalue="1"/>
        <Grid binddataset="ds_List" enable="true" id="grd_Excel" useinputpanel="false" oncellclick="div_extend_grd_List_OnCellClick" oncelldblclick="div_extend_grd_List_OnCellDblClick" onheadclick="div_extend_grd_List_OnHeadClick" onkillfocus="div_extend_grd_List_OnKillFocus" taborder="45" tabstop="true" usecontextmenu="true" useselcolor="true" visible="false" wheelscrollrow="1" position="absolute 24 790 504 917" readonly="true" selecttype="row">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="25"/>
                <Column size="40"/>
                <Column size="65"/>
                <Column size="22"/>
                <Column size="130"/>
                <Column size="55"/>
                <Column size="21"/>
                <Column size="90"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="20" band="head"/>
                <Row size="21"/>
              </Rows>
              <Band id="head">
                <Cell col="0" displaytype="text" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="구분"/>
                <Cell col="2" displaytype="text" text="레시피코드"/>
                <Cell col="3" colspan="2" displaytype="text" text="레시피명"/>
                <Cell col="5" displaytype="text" text="원가"/>
                <Cell col="6" displaytype="text" text="H"/>
                <Cell col="7" displaytype="text" text="선호도"/>
                <Cell col="8" displaytype="text" text="레시피분류"/>
                <Cell col="9" displaytype="text" text="레시피유형"/>
                <Cell col="10" displaytype="text" text="조리법유형"/>
              </Band>
              <Band id="body">
                <Cell col="0" displaytype="text" expr="expr:currow+1" style="align:right;"/>
                <Cell col="1" text="bind:GUBUN" combocodecol="CD" combodataset="ds_gbn" combodatacol="NM" displaytype="combo" style="align:right;"/>
                <Cell col="2" text="bind:RECIPE_CD" displaytype="text" style="align:right;backgroundimage:EXPR(iif(DI_MON==1,'ico_NewR',''));"/>
                <Cell col="3" colspan="2" displaytype="text" style="align:left;">
                  <Cell col="0" displaytype="text" style="backgroundimage:EXPR(iif(PHF=='Y','ico_Danger',''));align:left;"/>
                  <Cell col="1" text="bind:RECIPE_NAME" displaytype="text" style="align:left;"/>
                </Cell>
                <Cell col="5" text="bind:RECIPE_COST" displaytype="number" style="align:right;"/>
                <Cell col="6" displaytype="image" style="align:left;"/>
                <Cell col="7" displaytype="text" style="align:left;backgroundimage:EXPR(PREFER_LABEL);"/>
                <Cell col="8" text="bind:RECIPE_CLASS" combocodecol="CD" combodataset="ds_RecipeClass" combodatacol="NM" displaytype="combo" style="align:left;"/>
                <Cell col="9" text="bind:RECIPE_TYPE" combocodecol="CD" combodataset="ds_RecipeType" combodatacol="NM" displaytype="combo" style="align:left;"/>
                <Cell col="10" text="bind:CUISINE_TYPE" combocodecol="CD" combodataset="ds_CookClass" combodatacol="NM" displaytype="combo" style="align:left;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid autoenter="select" binddataset="ds_Menu" cellsizingtype="both" readonly="false" enable="true" id="grd_Excel1" useinputpanel="false" oncellclick="grd_RealRecipe_OnCellClick" onheadclick="grd_RealRecipe_OnHeadClick" taborder="46" tabstop="true" usecontextmenu="true" useselcolor="true" visible="false" wheelscrollrow="1" position="absolute 528 792 975 991" selecttype="row">
          <Formats>
            <Format id="ETC">
              <Columns>
                <Column size="25"/>
                <Column size="0"/>
                <Column size="30"/>
                <Column size="21"/>
                <Column size="55"/>
                <Column size="120"/>
                <Column size="60"/>
                <Column size="25"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="20" band="head"/>
                <Row size="20" band="head"/>
                <Row size="21"/>
                <Row size="20" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" style="align:center;" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="????"/>
                <Cell col="2" rowspan="2" displaytype="text" text="구축"/>
                <Cell col="3" rowspan="2" colspan="2" displaytype="text" text="레시피코드"/>
                <Cell col="5" rowspan="2" displaytype="text" text="레시피명"/>
                <Cell col="6" rowspan="2" displaytype="text" text="원가&#10;(원)"/>
                <Cell col="7" rowspan="2" displaytype="text" text="색"/>
                <Cell col="8" rowspan="2" displaytype="text" text="에너지&#10;(kcal)"/>
                <Cell col="9" rowspan="2" displaytype="text" text="당질&#10;(g)"/>
                <Cell col="10" rowspan="2" displaytype="text" text="단백질&#10;(g)"/>
                <Cell col="11" rowspan="2" displaytype="text" text="지질&#10;(g)"/>
                <Cell col="12" rowspan="2" displaytype="text" text="비타민A&#10;(R.E)"/>
                <Cell col="13" rowspan="2" displaytype="text" text="비타민B1&#10;(mg)"/>
                <Cell col="14" rowspan="2" displaytype="text" text="비타민B2&#10;(mg)"/>
                <Cell col="15" rowspan="2" displaytype="text" text="비타민C&#10;(mg)"/>
                <Cell col="16" rowspan="2" displaytype="text" text="칼슘&#10;(mg)"/>
                <Cell col="17" rowspan="2" displaytype="text" text="철&#10;(mg)"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:right;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="number" edittype="text" editfilter="number" style="align:right;" text="bind:RECIPE_SEQ"/>
                <Cell col="2" displaytype="checkbox" edittype="checkbox" style="align:center;" text="bind:CREAT"/>
                <Cell col="3" displaytype="button" style="align:left;"/>
                <Cell col="4" displaytype="text" style="align:center;" text="bind:RECIPE_CD"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:RECIPE_COST"/>
                <Cell col="7" displaytype="text" style="align:left;background: ;"/>
                <Cell col="8" displaytype="number" style="align:right;" text="bind:S_KCAL"/>
                <Cell col="9" displaytype="number" style="align:right;" text="bind:S_CARBO"/>
                <Cell col="10" displaytype="number" style="align:right;" text="bind:S_PROT"/>
                <Cell col="11" displaytype="number" style="align:right;" text="bind:S_FAT"/>
                <Cell col="12" displaytype="number" style="align:right;" text="bind:S_VITA"/>
                <Cell col="13" displaytype="number" style="align:right;" text="bind:S_THIA"/>
                <Cell col="14" displaytype="number" style="align:right;" text="bind:S_RIBO"/>
                <Cell col="15" displaytype="number" style="align:right;" text="bind:S_VITA_C"/>
                <Cell col="16" displaytype="number" style="align:right;" text="bind:S_CA"/>
                <Cell col="17" displaytype="number" style="align:right;" text="bind:S_FE"/>
              </Band>
              <Band id="summary">
                <Cell colspan="6" displaytype="text" style="align:center;" text="합계"/>
                <Cell col="6" displaytype="text" style="align:right;" expr="expr:getSum('RECIPE_COST')+'('+Math.round((getSum('RECIPE_COST')/getAvg('CORN_SALE_PRICE'))*100,1)+'%)'"/>
                <Cell col="7" displaytype="text" style="align:left;"/>
                <Cell col="8" displaytype="number" style="align:right;" expr="expr:getSum('S_KCAL')"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:getSum('S_CARBO')"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="expr:getSum('S_PROT')"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:getSum('S_FAT')"/>
                <Cell col="12" displaytype="number" style="align:right;" expr="expr:getSum('S_VITA')"/>
                <Cell col="13" displaytype="number" style="align:right;" expr="expr:getSum('S_THIA')"/>
                <Cell col="14" displaytype="number" style="align:right;" expr="expr:getSum('S_RIBO')"/>
                <Cell col="15" displaytype="number" style="align:right;" expr="expr:getSum('S_VITA_C')"/>
                <Cell col="16" displaytype="number" style="align:right;" expr="expr:getSum('S_CA')"/>
                <Cell col="17" displaytype="number" style="align:right;" expr="expr:getSum('S_FE')"/>
              </Band>
            </Format>
            <Format id="SS_ETC">
              <Columns>
                <Column size="25"/>
                <Column size="0"/>
                <Column size="30"/>
                <Column size="21"/>
                <Column size="55"/>
                <Column size="120"/>
                <Column size="60"/>
                <Column size="25"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="20" band="head"/>
                <Row size="20" band="head"/>
                <Row size="21"/>
                <Row size="20" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" style="align:center;" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="????"/>
                <Cell col="2" rowspan="2" displaytype="text" text="구축"/>
                <Cell col="3" rowspan="2" colspan="2" displaytype="text" text="레시피코드"/>
                <Cell col="5" rowspan="2" displaytype="text" text="레시피명"/>
                <Cell col="6" rowspan="2" displaytype="text" text="원가&#10;(원)"/>
                <Cell col="7" rowspan="2" displaytype="text" text="색"/>
                <Cell col="8" rowspan="2" displaytype="text" text="에너지&#10;(kcal)"/>
                <Cell col="9" rowspan="2" displaytype="text" text="당질&#10;(g)"/>
                <Cell col="10" rowspan="2" displaytype="text" text="단백질&#10;(g)"/>
                <Cell col="11" rowspan="2" displaytype="text" text="지질&#10;(g)"/>
                <Cell col="12" rowspan="2" displaytype="text" text="비타민A&#10;(R.E)"/>
                <Cell col="13" rowspan="2" displaytype="text" text="비타민B1&#10;(mg)"/>
                <Cell col="14" rowspan="2" displaytype="text" text="비타민B2&#10;(mg)"/>
                <Cell col="15" rowspan="2" displaytype="text" text="비타민C&#10;(mg)"/>
                <Cell col="16" rowspan="2" displaytype="text" text="칼슘&#10;(mg)"/>
                <Cell col="17" rowspan="2" displaytype="text" text="철&#10;(mg)"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:right;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="number" edittype="text" editfilter="number" style="align:right;" text="bind:RECIPE_SEQ"/>
                <Cell col="2" displaytype="checkbox" edittype="checkbox" style="align:center;" text="bind:CREAT"/>
                <Cell col="3" displaytype="button" style="align:left;"/>
                <Cell col="4" displaytype="text" style="align:center;" text="bind:RECIPE_CD"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:RECIPE_COST"/>
                <Cell col="7" displaytype="text" style="align:left;background: ;"/>
                <Cell col="8" displaytype="number" style="align:right;" text="bind:SS_KCAL"/>
                <Cell col="9" displaytype="number" style="align:right;" text="bind:SS_CARBO"/>
                <Cell col="10" displaytype="number" style="align:right;" text="bind:SS_PROT"/>
                <Cell col="11" displaytype="number" style="align:right;" text="bind:SS_FAT"/>
                <Cell col="12" displaytype="number" style="align:right;" text="bind:SS_VITA"/>
                <Cell col="13" displaytype="number" style="align:right;" text="bind:SS_THIA"/>
                <Cell col="14" displaytype="number" style="align:right;" text="bind:SS_RIBO"/>
                <Cell col="15" displaytype="number" style="align:right;" text="bind:SS_VITA_C"/>
                <Cell col="16" displaytype="number" style="align:right;" text="bind:SS_CA"/>
                <Cell col="17" displaytype="number" style="align:right;" text="bind:SS_FE"/>
              </Band>
              <Band id="summary">
                <Cell colspan="6" displaytype="text" style="align:center;" text="???"/>
                <Cell col="6" displaytype="text" style="align:right;" expr="expr:getSum('RECIPE_COST')+'('+Math.round((getSum('RECIPE_COST')/getAvg('CORN_SALE_PRICE'))*100,1)+'%)'"/>
                <Cell col="7" displaytype="text" style="align:left;"/>
                <Cell col="8" displaytype="number" style="align:right;" expr="expr:getSum('SS_KCAL')"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:getSum('SS_CARBO')"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="expr:getSum('SS_PROT')"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:getSum('SS_FAT')"/>
                <Cell col="12" displaytype="number" style="align:right;" expr="expr:getSum('SS_VITA')"/>
                <Cell col="13" displaytype="number" style="align:right;" expr="expr:getSum('SS_THIA')"/>
                <Cell col="14" displaytype="number" style="align:right;" expr="expr:getSum('SS_RIBO')"/>
                <Cell col="15" displaytype="number" style="align:right;" expr="expr:getSum('SS_VITA_C')"/>
                <Cell col="16" displaytype="number" style="align:right;" expr="expr:getSum('SS_CA')"/>
                <Cell col="17" displaytype="number" style="align:right;" expr="expr:getSum('SS_FE')"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_Pop_Save" onclick="Common_Btn_common_OnClick" taborder="23" text="저장" position="absolute 1020 56 1072 77" class="btn_WF_Custom" image=""/>
        <Button id="btn_Pop_Search" onclick="Common_Btn_common_OnClick" taborder="22" text="조회" position="absolute 966 56 1018 77" class="btn_WF_Custom" image=""/>
        <Button id="btn_Pop_Delete" onclick="Common_Btn_common_OnClick" taborder="24" text="전체삭제" position="absolute 1074 56 1151 77" class="btn_WF_Custom" image=""/>
        <Button id="btn_Pop_Close" onclick="Common_Btn_common_OnClick" taborder="25" text="닫기" position="absolute 1153 56 1205 77" class="btn_WF_Custom" image=""/>
        <CheckBox id="chk_disuse" onclick="chk_disuse_OnClick" taborder="30" text="폐기율 적용" tooltiptext="체크시 폐기율이 적용되어&#10;영양소가 계산됩니다." position="absolute 1118 361 1204 382" value="true"/>
        <Button id="btn_NutReCalc" onclick="btn_NutReCalc_OnClick" taborder="29" text="영양소 재계산" tooltiptext="레시피 수정후 정확한 영양소를 보려면&#10;클릭하세요." position="absolute 1023 361 1110 382" class="btn_WF_Custom" image=""/>
        <Static id="Static6" text="※레시피명만 넣으셔도 조회 됩니다." position="absolute 126 64 382 82" class="sta_WF_Bluehelp"/>
        <Static id="Static7" text="레시피검색" position="absolute 15 64 110 82" class="sta_WF_Title01"/>
        <Static id="Static9" text="식단구성" position="absolute 631 64 766 82" class="sta_WF_Title01"/>
        <Tab id="tab_main" onchanged="tab_main_OnChanged" canchange="tab_main_OnChanging" taborder="31" position="absolute 15 392 1205 729" showextrabutton="false" tabindex="0">
          <Tabpages>
            <Tabpage id="tab0" taborder="65" text="레시피수정" url="U_FMM::FMM00211E.xfdl" position="absolute 2 24 973 298" scrollbars="none"/>
            <Tabpage id="tab1" taborder="65" text="조리법" url="U_FMM::FMM00212E.xfdl" position="absolute 2 24 973 298" scrollbars="none"/>
            <Tabpage id="tab2" taborder="65" text="PHF관리" url="U_FMM::FMM00213E.xfdl" position="absolute 2 24 973 298" scrollbars="none"/>
            <Tabpage id="tab3" taborder="65" text="조리공정" position="absolute 2 24 973 298" scrollbars="none">
              <Layouts>
                <Layout>
                  <Div id="div_ImgLoadUrl" onactivate="FSR00064E_OnActivate" scrollbars="autoboth" taborder="1" text="Div0" url="U_FMM::FMM00214E.xfdl" position="absolute 0 0 1188 309"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Static id="Static0" text="※주문제외글자 클릭(전체선택/해제)" position="absolute 987 402 1207 420" class="sta_WF_DiscInfoN"/>
        <Static id="Static01" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 15 637"/>
        <Static id="Static02" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1205 0 1220 701"/>
        <Static id="Static03" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 15 729 1119 744"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 15 10 1205 51" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 10 989 20"/>
        <Static id="Static11" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 41 1109 51"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 15 20 30 41"/>
        <Static id="Static13" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 79 20 89 41"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 188 20 218 41"/>
        <Static id="Static16" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 251 20 261 41"/>
        <Static id="Static18" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 334 20 364 41"/>
        <Static id="Static19" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 398 20 408 41"/>
        <Static id="Static00" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 516 20 546 41"/>
        <Button id="btn_GiveCal" onclick="btn_GiveCal_OnClick" taborder="1" text="" position="absolute 167 20 188 41" class="btn_WF_cal" image="" userdata="me_GiveDay" tabstop="false"/>
        <MaskEdit id="me_GiveDay" mask="####-##-##" ontextchanged="me_GiveDay_OnChanged" taborder="0" trimtype="both" type="string" position="absolute 89 20 168 41" onkillfocus="me_GiveDay_onkillfocus"/>
        <Static id="Static10" text="제공일" position="absolute 32 20 88 41" class="sta_WFSA_label"/>
        <MaskEdit id="me_Cnt" taborder="4" position="absolute 616 20 684 41" ontextchanged="me_common_ontextchanged" mask="#,###" autoselect="true"/>
        <MaskEdit id="me_danga" ontextchanged="me_common_ontextchanged" taborder="5" position="absolute 771 20 840 41" mask="#,###" autoselect="true"/>
        <Static id="Static1" text="끼니" position="absolute 219 20 268 41" class="sta_WFSA_label"/>
        <Static id="Static2" text="코너" position="absolute 366 20 406 41" class="sta_WFSA_label"/>
        <Static id="Static3" text="예상식수" position="absolute 547 20 609 41" class="sta_WFSA_label"/>
        <Static id="Static4" text="식단가" position="absolute 714 20 761 41" class="sta_WFSA_label"/>
        <Combo codecolumn="MEAL" datacolumn="MEAL_NAME" displayrowcount="10" id="cbo_DinGbn" index="0" innerdataset="ds_Meal" onitemchanged="common_OnChanged" taborder="2" position="absolute 261 20 334 41"/>
        <Combo codecolumn="CORNER" datacolumn="CORNER_DETAIL_NAME" displayrowcount="10" id="cbo_CornGbn" index="0" innerdataset="ds_Corner" onitemchanged="common_OnChanged" taborder="3" position="absolute 408 20 516 41"/>
        <Button id="btn_MenuIns" onclick="btn_MenuIns_OnClick" taborder="6" text="메뉴저장" position="absolute 1125 20 1189 41" class="btn_WF_Custom" image=""/>
        <Static id="Static15" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 606 20 616 41"/>
        <Static id="Static20" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 684 20 714 41"/>
        <Static id="Static21" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 761 20 771 41"/>
        <Static id="Static22" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 12 51 174 64"/>
        <Static id="Static26" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 12 77 598 82"/>
        <Static id="Static27" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1109 10"/>
        <Div id="div_extend" taborder="20" scrollbars="none" class="div_WFGRD_graybg" position="absolute 14 191 599 384" style="background:white;border:1 none #f2eee5ff ;">
          <Layouts>
            <Layout>
              <Static id="st_bar" position="absolute 0 179 489 192" anchor="left bottom"/>
              <Grid id="grd_List" taborder="3" binddataset="ds_List" wheelscrollrow="1" readonly="true" useinputpanel="false" cellsizingtype="both" onmousemove="div_extend_grd_List_OnMouseOver" onkillfocus="div_extend_grd_List_OnKillFocus" oncellclick="div_extend_grd_List_OnCellClick" onheadclick="div_extend_grd_List_OnHeadClick" oncelldblclick="div_extend_grd_List_OnCellDblClick" position="absolute 0 0 583 179" anchor="left top bottom">
                <Formats>
                  <Format id="Default">
                    <Columns>
                      <Column size="25"/>
                      <Column size="40"/>
                      <Column size="22"/>
                      <Column size="65"/>
                      <Column size="22"/>
                      <Column size="130"/>
                      <Column size="55"/>
                      <Column size="26"/>
                      <Column size="0"/>
                      <Column size="80"/>
                      <Column size="80"/>
                      <Column size="80"/>
                    </Columns>
                    <Rows>
                      <Row size="26" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell displaytype="text" class="head_Excel"/>
                      <Cell col="1" displaytype="text" text="구분"/>
                      <Cell col="2" colspan="2" text="레시피코드" taborder="undefined"/>
                      <Cell col="4" colspan="2" displaytype="text" text="레시피명"/>
                      <Cell col="6" displaytype="text" text="원가"/>
                      <Cell col="7" displaytype="text" text="H"/>
                      <Cell col="8" displaytype="text" text="선호도"/>
                      <Cell col="9" displaytype="text" text="레시피분류"/>
                      <Cell col="10" displaytype="text" text="레시피유형"/>
                      <Cell col="11" displaytype="text" text="조리법유형"/>
                    </Band>
                    <Band id="body">
                      <Cell displaytype="text" style="align:right;" expr="expr:currow+1"/>
                      <Cell col="1" displaytype="combo" style="align:right;" text="bind:GUBUN" combodataset="ds_gbn" combocodecol="CD" combodatacol="NM"/>
                      <Cell col="2" colspan="2" taborder="undefined">
                        <Cell displaytype="image" style="align:center middle;" text="expr:iif(DI_MON==1,&quot;URL('theme://Images/new/grd_WF_N.png')&quot;,&quot;&quot;)"/>
                        <Cell col="1" displaytype="text" style="align:left;" text="bind:RECIPE_CD"/>
                      </Cell>
                      <Cell col="4" colspan="2" taborder="undefined">
                        <Cell displaytype="image" style="align:left;backgroundimage: ;" text="expr:iif(PHF=='Y',&quot;URL('theme://Images/new/grd_WF_P.png')&quot;,&quot;&quot;)"/>
                        <Cell col="1" displaytype="text" style="align:left;backgroundimage: ;" text="bind:RECIPE_NAME"/>
                      </Cell>
                      <Cell col="6" displaytype="number" style="align:right;" text="bind:RECIPE_COST"/>
                      <Cell col="7" displaytype="image" style="align: ;" text="URL('theme://Images/new/grd_WF_ExpandImage.png')"/>
                      <Cell col="8" displaytype="text" style="align:left;backgroundimage:EXPR(PREFER_LABEL);"/>
                      <Cell col="9" displaytype="combo" style="align:left;" text="bind:RECIPE_CLASS" combodataset="ds_RecipeClass" combocodecol="CD" combodatacol="NM"/>
                      <Cell col="10" displaytype="combo" style="align:left;" text="bind:RECIPE_TYPE" combodataset="ds_RecipeType" combocodecol="CD" combodatacol="NM"/>
                      <Cell col="11" displaytype="combo" style="align:left;" text="bind:CUISINE_TYPE" combodataset="ds_CookClass" combocodecol="CD" combodatacol="NM"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <ImageViewer id="img_open" taborder="4" image="URL('theme://convertImages/img_OpenBottom.png')" onclick="div_extend_img_open_OnClick" position="absolute 0 179 36 191" anchor="left bottom" userdata="close"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static17" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 636 77 1094 82"/>
        <TextArea id="ta_Sql" readonly="true" taborder="65" tabstop="false" visible="false" position="absolute 360 52 544 77"/>
        <Static id="Static28" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 12 187 470 192"/>
        <Static id="Static29" text="w05" class="Guide01_AreaRed" visible="false" position="absolute 599 204 604 257"/>
        <Static id="Static30" text="w05" class="Guide01_AreaRed" visible="false" position="absolute 626 204 631 257"/>
        <Static id="Static31" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 628 356 1086 361"/>
        <Static id="Static32" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 382 1053 392"/>
        <Static id="Static33" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 532 413 990 418"/>
        <Static id="Static34" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1189 20 1204 41"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_GetDate"/>
      <Dataset id="ds_List"/>
      <Dataset id="ds_input"/>
      <Dataset id="ds_weather"/>
      <Dataset id="ds_RecipeNM"/>
      <Dataset id="ds_RecipeClass"/>
      <Dataset id="ds_RecipeType"/>
      <Dataset id="ds_CookClass"/>
      <Dataset id="ds_Material"/>
      <Dataset id="ds_Element"/>
      <Dataset id="ds_CutList"/>
      <Dataset id="ds_Hall_class"/>
      <Dataset id="ds_Corner"/>
      <Dataset id="ds_Meal"/>
      <Dataset id="ds_Menu">
        <ColumnInfo>
          <Column id="RECIPE_CD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Const"/>
      <Dataset id="ds_Recipe"/>
      <Dataset id="ds_CookMethod"/>
      <Dataset id="ds_cond"/>
      <Dataset id="ds_phf" oncolumnchanged="ds_phf_OnColumnChanged"/>
      <Dataset id="ds_Item" cancolumnchange="ds_Item_CanColumnChange" oncolumnchanged="ds_Item_OnColumnChanged" onrowposchanged="ds_Item_OnRowPosChanged"/>
      <Dataset id="ds_RecipePhf"/>
      <Dataset id="ds_Chk"/>
      <Dataset id="ds_Check">
        <ColumnInfo>
          <Column id="GIVEDAY" size="256" type="STRING"/>
          <Column id="MEAL" size="256" type="STRING"/>
          <Column id="CORNER" size="256" type="STRING"/>
          <Column id="EXPECT_CNT" size="256" type="STRING"/>
          <Column id="MEAL_PRICE" size="256" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Price"/>
      <Dataset id="ds_Cnt"/>
      <Dataset id="ds_Check_Menu"/>
      <Dataset id="ds_MCPrice"/>
      <Dataset id="ds_gbn">
        <ColumnInfo>
          <Column id="CD" size="256" type="STRING"/>
          <Column id="NM" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CD">0</Col>
            <Col id="NM">한화</Col>
          </Row>
          <Row>
            <Col id="CD">1</Col>
            <Col id="NM">본사</Col>
          </Row>
          <Row>
            <Col id="CD">2</Col>
            <Col id="NM">사업장</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Excel"/>
      <Dataset id="ds_MyCond">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="SUBINV_CODE" size="256" type="STRING"/>
          <Column id="MEAL" size="256" type="STRING"/>
          <Column id="CORNER" size="256" type="STRING"/>
          <Column id="MENU_DATE" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_RecentCnt">
        <ColumnInfo>
          <Column id="EXPECT_MEAL_QTY" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sCond">
        <ColumnInfo>
          <Column id="UPJANG" size="256" prop="default" type="STRING"/>
          <Column id="MENU_CODE" size="256" prop="default" type="STRING"/>
          <Column id="RECIPE_CD" size="256" prop="default" type="STRING"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="me_Cnt" propid="value" datasetid="ds_Cnt" columnid="CNT"/>
      <BindItem id="item1" compid="me_danga" propid="value" datasetid="ds_Cnt" columnid="SALE_PRICE"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
 ******************************************************************************************
 * 시스템구분   : 메뉴관리>식단관리>식단등록>레시피검색및 등록
 * 프로그램명   : FMM00210E
 * 기      능   : 레시피검색및 등록
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20080201 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
//******************************************************************************************(90)
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//******************************************************************************************
include "U_lib::lib_conversionCom.xjs";
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"		
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"		
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//=========================================================================================
var fa_Sql = ''; //서버에서 넘어오는 쿼리문




/*

<레시피검색및 등록>
	UPJANG,	fa_SUBINV_CODE, FROM_DT, TO_DT(업장코드,창고코드,시작일,종료일)
	MEAL,	CORNER,  MENU_DATE     (끼니,코너,제공일)

*/
// var	fa_UPJANG    = "107368";
// var	fa_SUBINV_CODE = "S1001338";
// var	fa_FROM_DT   = "20150119";
// var	fa_TO_DT     = "20150125";
// var	fa_MEAL      = "001";
// var	fa_CORNER    = "001";
// var	fa_MENU_DATE = "20150120";
	
var fs_MENU_CD="";

var v_CurRecipenm="";
var v_CurRecipecd="";
var v_CurCuisineType="";
var v_gbn=1;
var v_con=0;
//******************************************************************************************
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//******************************************************************************************
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);
			
// 	trace('fa_UPJANG    => ' + fa_UPJANG   );
// 	trace('fa_SUBINV_CODE => ' + fa_SUBINV_CODE);
// 	trace('fa_FROM_DT   => ' + fa_FROM_DT  ); 
// 	trace('fa_TO_DT     => ' + fa_TO_DT    ); 
// 	trace('fa_MEAL      => ' + fa_MEAL     );
// 	trace('fa_CORNER    => ' + fa_CORNER   );
// 	trace('fa_MENU_DATE => ' + fa_MENU_DATE); 
	
	v_con=0;
	fsp_init(this); 	
	fn_Make_Menu_Mst(true);
	
	//관리자일 경우만 쿼리 텍스트 보임
   	if(application.g_AuthLevel == "999")
   	{
   	   	ta_Sql.visible = true;
   	}else{
		ta_Sql.visible = false;
   	}
	
	//부모창에서 넘어온 변수값을 저장
	var upjang = fa_UPJANG;
	var subinvCode = fa_SUBINV_CODE;
	var meal = fa_MEAL;
	var corner = fa_CORNER;
	var menuDate = fa_MENU_DATE;
	
	//가장 최근일자의 예상식수를 가져와서 셋팅
	//me_Cnt.value = fn_getRecentExpectCnt(upjang, subinvCode, meal, corner, menuDate);
}

//
//	메뉴 마스터테이블에 식단가 넣어주기
// 
function fn_Make_Menu_Mst(str)
{	// true: 최초 화면 로딩     false:제공일,끼니, 코너 변경시

	// str  true	: 최초 화면 로딩
	//		false	: 콤보값으로 조회 조회
	
	var arg="";
	if(str)
	{
		arg	="UPJANG="			+	wrapQuote(fa_UPJANG)
			+" SUBINV_CODE="	+	wrapQuote(fa_SUBINV_CODE)
			+" MEAL="			+	wrapQuote(fa_MEAL)
			+" CORNER="			+	wrapQuote(fa_CORNER)
			+" MENU_DATE="		+	wrapQuote(fa_MENU_DATE);
			// +" EXPECT_MEAL_QTY="+	quote(me_Cnt.Value)
			// +" MEAL_PRICE="		+	quote(me_danga.Value);	
	}
	else
	{
		arg	="UPJANG="			+	wrapQuote(fa_UPJANG)
			+" SUBINV_CODE="	+	wrapQuote(fa_SUBINV_CODE)
			+" MEAL="			+	wrapQuote(cbo_DinGbn.value)
			+" CORNER="			+	wrapQuote(cbo_CornGbn.value)
			+" MENU_DATE="		+	wrapQuote(me_GiveDay.value);
			// +" EXPECT_MEAL_QTY="+	quote(me_Cnt.Value)
			// +" MEAL_PRICE="		+	quote(me_danga.Value);
	}
	
	fsp_clear(this);
	ds_MCPrice.clearData();
	ds_Check_Menu.clearData();
	fsp_addSearch(this,"fm/fmm:FMM00210E_S007");	// 식단가
	fsp_addSearch(this,"fm/fmm:FMM00210E_S006");	// 예상식수
	http.Sync=true;
	fsp_callService(this,"","",
					"",
					"ds_MCPrice=ds_MCPrice ds_Check_Menu=ds_Check_Menu",
					arg,
					"",
					"",
					true);
	http.Sync=false;
	
	fsp_clear(this);
	if(ds_MCPrice.getRowCount()==0)	// 끼니코너 식단가
	{// 생성
		fsp_addSingle(this,"fm/fmm:FMM00210E_I001");
		arg +=" EXPECT_MEAL_QTY=0"
			+ " MEAL_PRICE=0";
		http.Sync=true;		
		fsp_callService(this,"","",
						"",
						"",
						arg,
						"",
						"",
						true);	
		http.Sync=false;
		btn_MenuIns.userdata=1;
	}
	else
	{// 업데이트 식단가
		// 2008.06.25 fms_meal_corner정보는 업데이트 없음으로 변경
		//tit_AddSingleActionInfo(this,"fm/fmm:FMM00210E_U001");
	}
	
	arg="";
	if(str)
	{
		arg	="UPJANG="			+	wrapQuote(fa_UPJANG)
			+" SUBINV_CODE="	+	wrapQuote(fa_SUBINV_CODE)
			+" MEAL="			+	wrapQuote(fa_MEAL)
			+" CORNER="			+	wrapQuote(fa_CORNER)
			+" MENU_DATE="		+	wrapQuote(fa_MENU_DATE);
			// +" EXPECT_MEAL_QTY="+	quote(me_Cnt.Value)
			// +" MEAL_PRICE="		+	quote(me_danga.Value);	
	}
	else
	{
		arg	="UPJANG="			+	wrapQuote(fa_UPJANG)
			+" SUBINV_CODE="	+	wrapQuote(fa_SUBINV_CODE)
			+" MEAL="			+	wrapQuote(cbo_DinGbn.value)
			+" CORNER="			+	wrapQuote(cbo_CornGbn.value)
			+" MENU_DATE="		+	wrapQuote(me_GiveDay.value);
			// +" EXPECT_MEAL_QTY="+	quote(me_Cnt.Value)
			// +" MEAL_PRICE="		+	quote(me_danga.Value);
	}
	fsp_clear(this);
	
	if(ds_Check_Menu.getRowCount()==0)	// 메뉴 예상식수
	{// 생성
		fsp_addSingle(this,"fm/fmm:FMM00210E_I002");
		
		if(ds_MCPrice.getRowCount()==0)
		{
			arg +=" MEAL_PRICE=0";
			arg +=" EXPECT_MEAL_QTY=0";
			//arg +=" MEAL_PRICE="+ds_MCPrice.getColumn(0,"MEAL_PRICE");
		}
		else
		{
			/*
			if(gfn_length(gfn_trim(ds_MCPrice.getColumn("MEAL_PRICE")))==0 || gfn_trim(ds_MCPrice.getColumn("MEAL_PRICE"))==null)
			{
				ds_MCPrice.setColumn(0,"MEAL_PRICE",0);
			}
			*/
			arg +=" MEAL_PRICE=" + gfn_nvl(ds_MCPrice.getColumn(0,"MEAL_PRICE"), 0);
			arg +=" EXPECT_MEAL_QTY=" + gfn_nvl(ds_MCPrice.getColumn(0,"EXPECT_MEAL_QTY"), 0);
		}
		btn_MenuIns.userdata=1;		
	}
	else
	{// 업데이트 예상식수
		fsp_addSingle(this,"fm/fmm:FMM00210E_U002");
		if(gfn_length(gfn_trim(ds_Check_Menu.getColumn(0,"EXPECT_MEAL_QTY")))==0)
		{
			ds_Check_Menu.setColumn(0,"EXPECT_MEAL_QTY",0);
			btn_MenuIns.userdata=1;
		}
		arg +=" EXPECT_MEAL_QTY="	+	ds_Check_Menu.getColumn(0,"EXPECT_MEAL_QTY");
		if(ds_MCPrice.getRowCount()==0)
		{
			arg +=" MEAL_PRICE=0";
			btn_MenuIns.userdata=1;
			//trace("333");
		}
		else
		{
			if(ds_Check_Menu.getColumn(0,"SALE_PRICE")>0)
			{
				arg +=" MEAL_PRICE="		+	ds_Check_Menu.getColumn(0,"SALE_PRICE");
				//trace("444");
			}
			else
			{
				if(ds_MCPrice.getColumn(0,"MEAL_PRICE")>0)
				{
					arg +=" MEAL_PRICE="		+	ds_MCPrice.getColumn(0,"MEAL_PRICE");
				}
				else
				{
					arg +=" MEAL_PRICE=0";
					btn_MenuIns.userdata=1;
				}
				//trace("555");
			}
		}		
	}
	
	http.Sync=true;
	fsp_callService(this,"","",
					"",
					"",
					arg,
					"",
					"",
					true);	
	http.Sync=false;
	
	if(str)
	{
		fn_Init();
	}
}

function fn_call_back_type(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
		ds_RecipeType.filter("SET1!='Y'");
	}
}

function fn_Init()
{
	fs_MENU_CD=fa_MENU_DATE+"-"+fa_SUBINV_CODE+fa_MEAL+fa_CORNER;//	MENU_CD='20071102-S1000374001001'
	
	fsp_clear(this);
	//오늘 날짜
	ds_GetDate.clearData(); 
	fsp_addSearch(this,"sc/scc:SCC_TODAY");
	fsp_callService(this,"","","","ds_GetDate=ds_GetDate","","fn_call_back_init","",true);

	fsp_clear(this);
	// 레시피명(한화 + 본사)
	ds_RecipeNM.clearData();
	fsp_addSearch(this,"fm/fmm:FMM00210E_S014");
	fsp_callService(this,"","","","ds_RecipeNM=ds_RecipeNM","","fn_call_back_nm","",true);

// 	// 레시피분류
// 	ds_RecipeClass.clearData();
// 	fsp_addSearch(this,"fs/fsr:FSR00010E_S002");
// 	fsp_callService(this,"","","","ds_RecipeClass=ds_RecipeClass","","fn_call_back_class","",true);
	
	fsp_clear(this);
	// 레시피유형
	ds_RecipeType.clearData();
	fsp_addSearch(this,"fm/fmr:FMR00010E_S003");
	fsp_callService(this,"","","","ds_RecipeType=ds_RecipeType","","fn_call_back_type","",true);

	fsp_clear(this);  
	// 조리법유형
	ds_CookClass.clearData();
	fsp_addSearch(this,"fm/fmr:FMR00010E_S004");
	fsp_callService(this,"","","","ds_CookClass=ds_CookClass","","fn_call_back_init","",true);
	
	fsp_clear(this);
	// 주재료군
	ds_Material.clearData();
	fsp_addSearch(this,"fm/fmr:FMR00010E_S005");
	fsp_callService(this,"","","","ds_Material=ds_Material","","fn_call_back_init","",true);	
	

	fsp_clear(this);
	// 대표영양성분
	ds_Element.clearData();
	fsp_addSearch(this,"fm/fmr:FMR00010E_S006");
	fsp_callService(this,"","","","ds_Element=ds_Element","","fn_call_back_init","",true);

	fsp_clear(this);
	// 커팅규격
	ds_CutList.clearData();
	fsp_addSearch(this,"fm/fmr:FMR00010E_S022");
	fsp_callService(this,"","","","ds_CutList=ds_CuttingList","","fn_call_back_init","",true);

	fsp_clear(this);
	// 병원구성요소(식단구성)
	ds_Const.clearData();
	fsp_addSearch(this,"fm/fmm:FMM00060E_S007");
	fsp_callService(this,"","","","ds_Const=ds_Const","","fn_call_back_init","",true);

	if(gfn_length(gfn_trim(fa_UPJANG))==0)
	{
		g_Message("EE",fn_AlertMsg("010"));
		return;
	}
	if(gfn_length(gfn_trim(fa_SUBINV_CODE))==0)
	{
		g_Message("EE",fn_AlertMsg("011"));
		return;
	}
	if(gfn_length(gfn_trim(fa_FROM_DT))==0)
	{
		g_Message("EE",fn_AlertMsg("027"));
		return;
	}
	if(gfn_length(gfn_trim(fa_TO_DT))==0)
	{
		g_Message("EE",fn_AlertMsg("027"));
		return;
	}
	if(gfn_length(gfn_trim(fa_MEAL))==0)
	{
		g_Message("EE",fn_AlertMsg("014"));
		return;
	}
	if(gfn_length(gfn_trim(fa_CORNER))==0)
	{
		g_Message("EE",fn_AlertMsg("015"));
		return;
	}
	if(gfn_length(gfn_trim(fa_MENU_DATE))==0)
	{
		g_Message("EE",fn_AlertMsg("013"));
		return;
	}	
	me_GiveDay.value=fa_MENU_DATE;
	
//	*********업장정보 받아가기***********
	ds_input.clear();
	ds_input.addColumn("CUR_DATE","STRING");
	ds_input.addColumn("UPJANG","STRING");
	ds_input.addColumn("SUBINV_CODE","STRING");
	ds_input.addColumn("MEAL","STRING");
	ds_input.addColumn("CORNER","STRING");
	ds_input.addRow();
	ds_input.setColumn(0,"CUR_DATE",fa_MENU_DATE);
	ds_input.setColumn(0,"UPJANG",fa_UPJANG);
	ds_input.setColumn(0,"SUBINV_CODE",fa_SUBINV_CODE);
	ds_input.setColumn(0,"MEAL",fa_MEAL);
	ds_input.setColumn(0,"CORNER",fa_CORNER);
// ***************************************	
	
	fsp_clear(this);
	ds_GetDate.clearData();
	ds_weather.clearData();
	ds_Hall_class.clearData();
	fsp_addSearch(this,"sc/scc:SCC_TODAY");		// 당일 날짜
	fsp_addSearch(this,"fm/fmm:FMM00060E_S001");  // 날씨정보
	fsp_addSearch(this,"fm/fmm:FMM00210E_S001");	// 식당군조회 ds_Hall_class.SUBINV_CLASS
	http.Sync=true;
	fsp_callService(this,"","",
					"ds_input=ds_input",
					"ds_GetDate=ds_GetDate ds_weather=ds_weather ds_Hall_class=ds_hall_class",
					"",
					"fn_call_back_init",
					"",
					true);
	http.Sync=false;
	// tit_ClearActionInfo(this);
	// ds_Meal.ClearData();
	// ds_Corner.ClearData();
	// tit_addSearchActionInfo(this,"fm/fmm:FMM00210E_S002"); 
	// tit_addSearchActionInfo(this,"fm/fmm:FMM00210E_S003");
	// tit_CallService(this,"","",
					// "ds_input=ds_input",
					// "ds_Meal=ds_Meal ds_Corner=ds_Corner",
					// "",
					// "",
					// "",
					// true);

	fsp_clear(this);
	ds_Cnt.clearData();
	ds_Price.clearData();
	fsp_addSearch(this,"fm/fmm:FMM00210E_S004"); 
	fsp_addSearch(this,"fm/fmm:FMM00210E_S005");
	http.Sync=true;
	fsp_callService(this,"","",
					"ds_input=ds_input",
					"ds_Cnt=ds_Cnt ds_Price=ds_Price",
					"",
					"",
					"",
					true);
	http.Sync=false;  

	//레시피분류
	fsp_clear(this);
	ds_RecipeClass.clearData();
	fsp_addSearch(this,"fm/fmm:FMM00210E_S013");
	fsp_callService(this,"","","","ds_RecipeClass=ds_RecipeClass","SUBINV_CLASS="+wrapQuote(ds_Hall_class.getColumn(0,"SUBINV_CLASS")),"fn_call_back_class","",true);

	if(ds_Cnt.getRowCount()==0)
	{
		btn_MenuIns.userdata=1;
		ds_Cnt.addRow();
		ds_Cnt.setColumn(0,"CNT",0); 
		ds_Cnt.setColumn(0,"SALE_PRICE",0); 
	}
	if(ds_Price.getRowCount()==0)
	{
		btn_MenuIns.userdata=1;
		ds_Price.addRow(); 
		ds_Price.setColumn(0,"MEAL_PRICE",0);
	}
	// 2008 06 24 메뉴 마스터에 저장된 SALE_PRICE 로 식단가를 변경합니다.
	//me_Cnt.value=ds_Cnt.getColumn(0,"CNT");
	//me_danga.Value=ds_Price.GetColumn(0,"MEAL_PRICE");
	//me_danga.value=ds_Cnt.getColumn(0,"SALE_PRICE");
	
	cbo_DinGbn.value=fa_MEAL;
	cbo_CornGbn.value=fa_CORNER;
	
	ds_Check.clearData();
	ds_Check.addRow();
	ds_Check.setColumn(0,"GIVEDAY",fa_MENU_DATE);
	ds_Check.setColumn(0,"MEAL",fa_MEAL);
	ds_Check.setColumn(0,"CORNER",fa_CORNER);
	ds_Check.setColumn(0,"EXPECT_CNT",ds_Cnt.getColumn(0,"CNT"));
	// 2008 06 24 메뉴 마스터에 저장된 SALE_PRICE 로 식단가를 변경합니다.
	//ds_Check.SetColumn(0,"MEAL_PRICE",ds_Price.GetColumn(0,"MEAL_PRICE"));
	ds_Check.setColumn(0,"MEAL_PRICE",ds_Cnt.getColumn(0,"SALE_PRICE"));
	
	img_Weather.image = gfn_nvl(ds_weather.getColumn(0,"W_IMAGE"));

	grd_RealRecipe.formatid="ETC";
	grd_Excel1.formatid="ETC"; 
	//v_con=1;
	fn_Meal();

	fn_Pop_Search();
}
function fn_call_back_meal(cd,errmsg)
{
	if(cd==-1)
	{
	}
	else
	{
		// if(ds_Meal.RowCount()>0)
		// {	//끼니 조회후 코너 조회
			if(v_gbn==1)
			{
				cbo_DinGbn.value=fa_MEAL;
			}
			fn_Corner();
		// }
		
	}
}
function fn_call_back_corner(cd,errmsg)
{
	if(cd==-1)
	{
	}
	else
	{	
		if(v_gbn==1)
		{
			cbo_CornGbn.value=fa_CORNER;
			v_gbn=0;
		}
		
		cbo_CornGbn.index = 0;
		//cbo_CornGbn_OnChanged();
//		g_debug("ds_Corner");
//		fn_Pop_Search("load");
	}
}

//콜백 프로세스 처리
function fn_call_back_nm(cd,errmsg)
{
	if(cd!=0) 
	{
		return;
	}
	else
	{
		cbo_RecipeNM.index = 0;
	}	
}

//콜백 프로세스 처리
function fn_call_back_class(cd,errmsg)
{
	if(cd!=0) 
	{
		return;
	}
	else
	{
		if ( ds_RecipeClass.rowcount > 0 ) ds_RecipeClass.filter("CD!='H'");
		
		cbo_RecipeClass.index = 0;
	}	
}

//콜백 프로세스 처리
function fn_call_back_init(cd,errmsg)
{
	if(cd!=0) 
	{
		return;
	}
	else
	{
		cbo_RecipeType.index = 0;
		cbo_CuisineClass.index = 0;
		cbo_Item.index = 0;
		cbo_Element.index = 0;
	}	
}

//콜백 프로세스 처리
function fn_call_back(cd,errmsg)
{
	if(cd!=0) 
	{
		return;
	}
	else
	{
	}	
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Pop_Search()
 * 입      력   : 검색조건
 * 반      환   : 없음
 * 기      능   : 사용자 등록정보
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071226
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function fn_Pop_Search(str)
{
    // 예상식수 = 0 일때 막는 부분 추가 090304일 노규완 추가 수정
	if((btn_MenuIns.userdata==1) || (toNumber(me_Cnt.value)==0))	
	{
		g_Message("EE",fn_AlertMsg("030"));
		return;
	}
	if(gfn_dsIsUpdated(ds_Menu)==true ||
		gfn_dsIsUpdated(ds_Item)==true)
	{
		if(g_Confirm("02",fn_AlertMsg("028"))==true)
		{
			fn_Pop_Save("BTN_SAVE");
		}
	}
	tab_main.tabindex=0;
	ds_Menu.clearData();
	ds_Item.clearData();
	ds_RecipePhf.clearData();
	ds_phf.clearData();
	if(str!="load")
	{
		if(gfn_length(gfn_trim(cbo_DinGbn.value))==0)
		{
			g_Message("EE",fn_AlertMsg("014"));
			return;
		}
		if(gfn_length(gfn_trim(cbo_CornGbn.value))==0)
		{
			g_Message("EE",fn_AlertMsg("015"));
			return;
		}
		if(gfn_length(gfn_trim(me_Cnt.value))==0)
		{
			g_Message("EE",fn_AlertMsg("016"));
			return;
		}
	}
	else
	{
		if(gfn_length(gfn_trim(cbo_DinGbn.value))==0)
		{
			return;
		}
		if(gfn_length(gfn_trim(cbo_CornGbn.value))==0)
		{
			return;
		}
		if(gfn_length(gfn_trim(me_Cnt.value))==0)
		{
			return;
		}
	}
		
	var arg="";
	
	arg 	=   " MEAL="					+	wrapQuote(gfn_trim(cbo_DinGbn.value))
				+" CORNER="					+	wrapQuote(gfn_trim(cbo_CornGbn.value))
				+" MENU_DATE="				+	wrapQuote(gfn_trim(me_GiveDay.value))
				+" UPJANG="					+	wrapQuote(gfn_trim(fa_UPJANG))
				+" SUBINV_CODE="			+	wrapQuote(gfn_trim(fa_SUBINV_CODE))
				+" SUBINV_CLASS="			+	wrapQuote(gfn_trim(ds_Hall_class.getColumn(0,"SUBINV_CLASS")));
	// 속도문제로 JSP로 변경
	// tit_ClearActionInfo(this);
	// tit_addSearchActionInfo(this,"fm/fmm:FMM00210E_S010");
	// http.Sync=true;
	// tit_CallService(this,"","","","ds_Menu=ds_Menu",arg,"fn_call_back","",true);
	// http.Sync=false;

	// 속도문제로 JSP로 변경

	var OutDS="ds_Menu=ds_Menu";
	ds_Menu.clearData();
	//http.Sync=true;
	//transaction("ds_Menu","S_FMM::FMM00210V_S010.jsp","",OutDS,arg,"fn_call_back_jsp");
	//http.Sync=false;
	jsp_transaction(this,"FMM00210V_S010","U_svc::" + "fm/fmm/FMM00210V_S010.jsp","",OutDS,arg,"fn_call_back_jsp", false, false, false);
	
	//if(ds_Menu.getRowCount()>0)
	//{
	//	tab_main.tab0.fn_T1_Search();
	//}
}

//function fn_call_back_jsp(svcid,cd,errmsg)
function fn_call_back_jsp(cd,errmsg)
{
	if(cd==-1)
	{
	}
	else
	{
		var value="식재료율("+Math.round(toNumber(ds_Menu.getSum("RECIPE_COST"))/toNumber(me_danga.value)*100,2)+"%)";
		grd_RealRecipe.setCellProperty("summary",1,"text",value);
		
		if(ds_Menu.getRowCount()>0)
		{
			tab_main.tab0.fn_T1_Search();
		}
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Pop_Save()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 저장
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071226
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function fn_Pop_Save(str)
{
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	var searchsql,insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql;
	var searchsql,insertSql2, updateSql2, deleteSql2;
	var searchsql,insertSql3, updateSql3, deleteSql3;	
	switch(str)
	{
		case "ICO_RECIPE_DEL":	// x아이콘 레시피
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_Menu=ds_Menu:U ds_Item=ds_Item:U";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "";
			insertSql2 	= "";
			insertSql3 	= "";			
			updateSql1	= "";
			updateSql2	= "";			
			updateSql3	= "";
			deleteSql1	= "fm/fmm:FMM00210E_D012";
			deleteSql2	= "fm/fmm:FMM00210E_D013";
			deleteSql3	= "fm/fmm:FMM00210E_D014";
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			fsp_addSave(this, insertSql2, updateSql2, deleteSql2,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			fsp_addSave(this, insertSql3, updateSql3, deleteSql3,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);
			break;
		case "ICO_ITEM_DEL":	// x아이콘 자제
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_Menu=ds_Menu:U ds_Item=ds_Item:U";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "";
			insertSql2 	= "";
			insertSql3 	= "";			
			updateSql1	= "";
			updateSql2	= "";			
			updateSql3	= "";
			deleteSql1	= "fm/fmm:FMM00210E_D012";
			deleteSql2	= "fm/fmm:FMM00210E_D013";
			deleteSql3	= "fm/fmm:FMM00210E_D014";
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			fsp_addSave(this, insertSql2, updateSql2, deleteSql2,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			fsp_addSave(this, insertSql3, updateSql3, deleteSql3,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			http.Sync=true;
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);
			http.Sync=false;
			//fn_Pop_Search();
			break;
		case "COOK":	// 조리법저장
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_CookMethod=ds_CookMethod:U";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "fm/fmm:FMM00210E_I015";
			updateSql1	= "fm/fmm:FMM00210E_U005";
			deleteSql1	= "fm/fmm:FMM00210E_D011";
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);		
			break;	
		case "PHF":	// PHF관리 업데이트
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_RecipePhf=ds_RecipePhf:U";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "";			
			updateSql1	= "fm/fmm:FMM00210E_U006";
			deleteSql1	= "";
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);		
			break;								
		case "BTN_DEL":	// 삭제 버튼(식단 삭제)
			fsp_clear(this);
			
			otherArg	="UPJANG="		+wrapQuote(fa_UPJANG)
						+" MENU_CD="	+wrapQuote(ds_Menu.getColumn(0,"MENU_CD"));
			
			inData		= "";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "";
			insertSql2 	= "";
			insertSql3 	= "";
			updateSql1	= "";
			updateSql2	= "";			
			updateSql3	= "";
			deleteSql1	= "fm/fmm:FMM00210E_D005";
			deleteSql2	= "fm/fmm:FMM00210E_D006";	
			deleteSql3	= "fm/fmm:FMM00210E_D007";
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSingle(this, deleteSql1);
			fsp_addSingle(this, deleteSql2);
			fsp_addSingle(this, deleteSql3);
			http.Sync=true;
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);	
			http.Sync=false;
			//DB에서 지웠으니 화면도 초기화하자...
			ds_Menu.clearData();
			ds_Item.clearData();
			ds_RecipePhf.clearData();
			ds_phf.clearData();
			//fn_Pop_Search();
			break;	
		case "BTN_SAVE":	// 저장 버튼
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_Menu=ds_Menu:U ds_Item=ds_Item:U";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "";
			insertSql2 	= "";
			// 레시피정보는 업데이트 없음
			// if(ds_Hall_class.GetColumn(0,"HALL_CLASS")=="005")	// 카페테리아 
			// {
				// updateSql1	= "fs/fsm:FSM00060E_U003";
			// }
			// else 												// 그외 
			// {
				// updateSql1	= "fs/fsm:FSM00060E_U004";
			// }
			updateSql2	= "fm/fmm:FMM00210E_U004";			
			deleteSql1	= "";
			deleteSql2	= "";	
			keyIncrement= -1;
			callbackSql	= "";
			
			//tit_addSaveActionInfo(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			fsp_addSave(this, insertSql2, updateSql2, deleteSql2,saveFlagColumn, keySqlName, keyIncrement, callbackSql);			
			http.Sync=true;
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);	
			http.Sync=false;

			fn_Pop_Save("CHK_CONSTRUCT");
			break;
		case "BTN_SAVE_GRID":	// 그리드만 저장하는 버튼
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_Menu=ds_Menu:U ds_Item=ds_Item:U";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "";
			insertSql2 	= "";
			// 레시피정보는 업데이트 없음
			// if(ds_Hall_class.GetColumn(0,"HALL_CLASS")=="005")	// 카페테리아 
			// {
				// updateSql1	= "fs/fsm:FSM00060E_U003";
			// }
			// else 												// 그외 
			// {
				// updateSql1	= "fs/fsm:FSM00060E_U004";
			// }
			updateSql2	= "fm/fmm:FMM00210E_U004";			
			deleteSql1	= "";
			deleteSql2	= "";	
			keyIncrement= -1;
			callbackSql	= "";
			
			//tit_addSaveActionInfo(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			fsp_addSave(this, insertSql2, updateSql2, deleteSql2,saveFlagColumn, keySqlName, keyIncrement, callbackSql);			
			http.Sync=true;
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);	
			http.Sync=false;

			break;		
		case "BTN_CREATE":	// 신규레시피추가 생성
			break;								
		case "CHK_CONSTRUCT":	// 식단구성 구축 체크(구축이면 기존 본사업장표준데이타 일괄삭제후 실제 식단 레시피로 일괄대체합니다.
			// grd_RealRecipe.Redraw=false;
			// ds_Menu.Filter("CREAT==1");
			var arg="";
			var upjang="";
			var menuCode="";
			var recipeCd="";
			
			for(i=0;i<ds_Menu.getRowCount();i++)
			{
				if(ds_Menu.getColumn(i,"CREAT")==1)
				{
					arg		="UPJANG="		+wrapQuote(ds_Menu.getColumn(i,"UPJANG"))
							+" SUBINV_CLASS="	+wrapQuote(ds_Hall_class.getColumn(0,"SUBINV_CLASS"))
							+" RECIPE_CD="	+wrapQuote(ds_Menu.getColumn(i,"RECIPE_CD"))
							+" MENU_CD="	+wrapQuote(ds_Menu.getColumn(i,"MENU_CD"))
							+" MENU_DATE="	+wrapQuote(me_GiveDay.value);
							
					fsp_clear(this);
					ds_Chk.clearData();
					fsp_addSearch(this,"fm/fmm:FMM00210E_S012");
					http.Sync=true;
					fsp_callService(this,"","","","ds_Chk=ds_Chk",arg,"fn_call_back","",true);
					http.Sync=false;
					// 일괄삭제
					inData		= "";
					outData		= "";
					callBackFnc	= "";
					insertSql1 	= "";
					insertSql2 	= "";
					updateSql1	= "";
					updateSql2	= "";			
					deleteSql1	= "fm/fmm:FMM00210E_D008";
					deleteSql2	= "fm/fmm:FMM00210E_D009";
					deleteSql3	= "fm/fmm:FMM00210E_D010";	
					keyIncrement= -1;
					callbackSql	= "";
					
					fsp_addSingle(this, deleteSql1);
					fsp_addSingle(this, deleteSql2);
					fsp_addSingle(this, deleteSql3);
					
					http.Sync=true;
					fsp_callService(this, "", "", inData, outData, arg, callBackFnc);	
					http.Sync=false;
					
					fsp_clear(this);

					// insert
					inData		= "";
					outData		= "";
					callBackFnc	= "";
					insertSql1 	= "fm/fmm:FMM00210E_I012";
					insertSql2 	= "fm/fmm:FMM00210E_I013";
					insertSql3 	= "fm/fmm:FMM00210E_I014";
					keyIncrement= -1;
					callbackSql	= "";
					fsp_addSingle(this, insertSql1);
					fsp_addSingle(this, insertSql2);
					fsp_addSingle(this, insertSql3);
					http.Sync=true;
					fsp_callService(this, actionName, cmdName, inData, outData, arg, callBackFnc);
					http.Sync=false;
					
					/*
					구축한레시피를 다 입력하고 나면 메뉴목록의 상태(한화,본사,사업장)를
					한화->사업장으로 바꾸어주는 로직
					*/
					
					upjang = ds_Menu.getColumn(i,"UPJANG");
					menuCode = ds_Menu.getColumn(i,"MENU_CD");
					recipeCd = ds_Menu.getColumn(i,"RECIPE_CD");
					
					fn_changGubun(upjang, menuCode, recipeCd);
				}
			}
			fn_Pop_Search();
			// ds_Menu.UnFilter();
			// grd_RealRecipe.Redraw=true;
			break;
		case "CREATE_REAL":
			var arg	="UPJANG="		+fa_UPJANG
					+" SUBINV_CLASS="	+wrapQuote(ds_Hall_class.getColumn(0,"SUBINV_CLASS"))
					+" RECIPE_CD="	+wrapQuote(ds_List.getColumn(ds_List.rowposition,"RECIPE_CD"))
					+" SUBINV_CODE="+wrapQuote(gfn_trim(fa_SUBINV_CODE))
					+" MEAL="		+wrapQuote(gfn_trim(cbo_DinGbn.value))
					+" CORNER="		+wrapQuote(gfn_trim(cbo_CornGbn.value))	
					+" NEED_DATE="	+wrapQuote(me_GiveDay.value)
					+" MENU_CD="	+wrapQuote(me_GiveDay.value+"-"+fa_SUBINV_CODE+cbo_DinGbn.value+cbo_CornGbn.value);
					//+" MENU_CD="	+quote(fa_MENU_DATE+"-"+fa_SUBINV_CODE+cbo_DinGbn.Value+cbo_CornGbn.Value);
			fsp_clear(this);
			if(ds_List.getColumn(ds_List.rowposition,"GUBUN")=="2")	// 업장
			{
				inData		= "";
				outData		= "";
				callBackFnc	= "";
				insertSql1 	= "fm/fmm:FMM00210E_I003";
				insertSql2 	= "fm/fmm:FMM00210E_I004";
				insertSql3 	= "fm/fmm:FMM00210E_I005";
				keyIncrement= -1;
				callbackSql	= "";
				fsp_addSingle(this, insertSql1);
				fsp_addSingle(this, insertSql2);
				fsp_addSingle(this, insertSql3);
				http.Sync=true;
				fsp_callService(this, actionName, cmdName, inData, outData, arg, callBackFnc);
				http.Sync=false;
			}
			else if(ds_List.getColumn(ds_List.rowposition,"GUBUN")=="1") //본사
			{
				inData		= "";
				outData		= "";
				callBackFnc	= "";
				insertSql1 	= "fm/fmm:FMM00210E_I006";
				insertSql2 	= "fm/fmm:FMM00210E_I007";	
				insertSql3 	= "fm/fmm:FMM00210E_I008";
				keyIncrement= -1;
				callbackSql	= "";
				fsp_addSingle(this, insertSql1);
				fsp_addSingle(this, insertSql2);
				fsp_addSingle(this, insertSql3);
				http.Sync=true;
				fsp_callService(this, actionName, cmdName, inData, outData, arg, callBackFnc);
				http.Sync=false;			
			}
			else											// "0" 한화
			{
				inData		= "";
				outData		= "";
				callBackFnc	= "";
				insertSql1 	= "fm/fmm:FMM00210E_I009";
				insertSql2 	= "fm/fmm:FMM00210E_I010";	
				insertSql3 	= "fm/fmm:FMM00210E_I011";
				keyIncrement= -1;
				callbackSql	= "";
				fsp_addSingle(this, insertSql1);
				fsp_addSingle(this, insertSql2);
				fsp_addSingle(this, insertSql3);
				http.Sync=true;
				fsp_callService(this, actionName, cmdName, inData, outData, arg, callBackFnc);
				http.Sync=false;			
			}		
			
			// 우측재조회
			fn_Pop_Search();
			break;
        default :
            break;
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Pop_Delete()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 삭제
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071226
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function fn_Pop_Delete()
{
	if(ds_Menu.getRowCount()==0)
	{
		return;
	}
	if(g_Confirm("01",fn_AlertMsg("025"))==true)
	{
		fn_Pop_Save("BTN_DEL");
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Pop_Close()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 화면닫기
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071226
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function fn_Pop_Close()
{
	if(gfn_dsIsUpdated(ds_Menu)==true ||
		gfn_dsIsUpdated(ds_Item)==true)
	{
		if(g_Confirm("02",fn_AlertMsg("028"))==true)
		{
			fn_Pop_Save("BTN_SAVE");
			return;
		}
	}	
	this.close();
}
/******************************************************************************************
 * 함  수  명   : fn_AlertMsg(cd)
 * 입      력   : 메시지 코드
 * 반      환   : 메세지 텍스트
 * 기      능   : 메시지 처리
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071226
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
 function fn_AlertMsg(cd)
{
	var v_Msg="";
	switch(cd)
	{
		case "001":
			v_Msg= "버튼이 정의 되어 있지않습니다.";
			break;
		case "002":
			v_Msg="서비스 오류:시스템 관리자에게 문의하십시오.";
			break;
		case "003":
			v_Msg="조회된 데이타가 없습니다.";
			break;														
		case "004":
			v_Msg="변경된 데이타가 있습니다.\n\n저장하시겠습니까?";
			break;
		case "005":
			v_Msg="날짜를 입력하셔야 합니다.";
			break;
		case "006":
			v_Msg="날짜 형식을 확인하세요.";
			break;			
		case "007":
			v_Msg="월이 잘못되었습니다.";
			break;			
		case "008":
			v_Msg="일자가 잘못되었습니다.";
			break;	
		case "009":
			v_Msg="조회 기간을 벗어났습니다.";
			break;					
		case "010":
			v_Msg="업장정보가 없습니다.";
			break;
		case "011":
			v_Msg="창고 정보가 없습니다.";
			break;
		case "012":
			v_Msg="식당군정보가 없습니다.";
			break;
		case "013":
			v_Msg="제공일정보가 없습니다.";
			break;
		case "014":
			v_Msg="끼니정보가 없습니다.";
			break;
		case "015":
			v_Msg="코너정보가 없습니다.";
			break;	
		case "016":
			v_Msg="예상식수가 없습니다.";
			break;										
		case "017":
			v_Msg="입고 예정일이 잘못되었습니다.\n\n다시 선택하세요.";
			break;
		case "018":
			v_Msg="발주된 자재가 있습니다.\n\n삭제할 수 없습니다.";
			break;	
		case "019":
			v_Msg="레시피별 하나의 자재만 선택대체 할 수 있습니다.";
			break;	
		case "020":
			v_Msg="레시피별 하나의 자재만 선택대체 할 수 있습니다.";
			break;
		case "021":
			v_Msg="조리법이 비어있는 라인이 있습니다.비어있는 라인을 입력하세요.";
			break;	
		case "022":
			v_Msg="변경된 데이타가 있습니다.\n\n먼저 저장하신후 작업하세요.";
			break;	
		case "023":
			v_Msg="제공일을 넘을수 없습니다.";
			break;	
		case "024":
			v_Msg="적용할 입고 예정일을 입력하세요.";
			break;
		case "025":
			v_Msg="식단 전체를 삭제 하시겠습니까?";
			break;
		case "026":
			v_Msg="이미 등록된 레시피 입니다.";
			break;	
		case "027":
			v_Msg="조회기간 정보가 없습니다.";
			break;					
		case "028":
			v_Msg="갱신된 정보가 있습니다.저장 후 작업하시겠습니까?";
			break;
		case "029":
			v_Msg="레시피를 추가 하시겠습니까?";
			break;								
		case "030":
			v_Msg="식단 작업전에 메뉴저장 버튼으로 정보를 갱신하세요";
			break;
		case "031":
			v_Msg="검색할 레시피를 하나 이상 체크 하셔야 합니다.";
			break;
		case "032":
			v_Msg="예상식수를 입력하세요.";
			break;
		case "033":
			v_Msg="식단가를 입력하세요.";
			break;
		case "034":
			//v_Msg="본사및 사업장만 다운로드 가능합니다.";
			v_Msg="한화 표준레시피를 그대로 사용한 레시피는 다운로드 되지 않습니다.";  //수정 : 2011/05/23  이혜은 대리 요청 문구 수정.
			break;
/*			
		case "":
			v_Msg="";
			break;
*/			
		default:
			break;			
	}
	return v_Msg;
}

function fn_Meal()
{
//	*********업장정보 받아가기***********
	ds_input.clear();
	ds_input.addColumn("CUR_DATE","STRING");
	ds_input.addColumn("UPJANG","STRING");
	ds_input.addColumn("HALL_CD","STRING");
	ds_input.addColumn("MEAL","STRING");
	ds_input.addColumn("CORNER","STRING");
	ds_input.addRow();
	ds_input.setColumn(0,"CUR_DATE",gfn_trim(me_GiveDay.value));//제공일
	ds_input.setColumn(0,"UPJANG",fa_UPJANG);
	ds_input.setColumn(0,"HALL_CD",fa_SUBINV_CODE); //fa_HALL_CD
	ds_input.setColumn(0,"MEAL","");
	ds_input.setColumn(0,"CORNER","");
// ***************************************	
	var arg="SUBINV_CODE="+	wrapQuote(fa_SUBINV_CODE);
	http.Sync=true;
	fsp_clear(this);
	ds_Meal.clearData();
	//tit_addSearchActionInfo(this,"fs/fsm:FSM00060E_S002");	// 끼니 조회 ds_Meal
	fsp_addSearch(this,"fm/fmm:FMM00210E_S015");
	fsp_callService(this,"","",
					"",
					"ds_Meal=ds_Meal",
					arg,
					"fn_call_back_meal",
					"",
					true);
	http.Sync=false;
}
function fn_Corner()
{
//	*********업장정보 받아가기***********
	ds_input.clear();
	ds_input.addColumn("CUR_DATE","STRING");
	ds_input.addColumn("UPJANG","STRING");
	ds_input.addColumn("HALL_CD","STRING");
	ds_input.addColumn("MEAL","STRING");
	ds_input.addColumn("CORNER","STRING");
	ds_input.addRow();
	ds_input.setColumn(0,"CUR_DATE",gfn_trim(me_GiveDay.value));//제공일
	ds_input.setColumn(0,"UPJANG",fa_UPJANG);
	ds_input.setColumn(0,"HALL_CD",fa_SUBINV_CODE);	//fa_HALL_CD
	ds_input.setColumn(0,"MEAL",cbo_DinGbn.value);
	ds_input.setColumn(0,"CORNER","");
// ***************************************	
	var arg	="SUBINV_CODE="+wrapQuote(fa_SUBINV_CODE)
			+" MEAL="+		wrapQuote(cbo_DinGbn.value);
	http.Sync=true;
	fsp_clear(this);
	ds_Corner.clearData();
	//tit_addSearchActionInfo(this,"fs/fsm:FSM00060E_S004");	// 끼니 조회 ds_Meal
	fsp_addSearch(this,"fm/fmm:FMM00210E_S016");
	fsp_callService(this,"","",
					"",
					"ds_Corner=ds_Corner",
					arg,
					"fn_call_back_corner",
					"",
					true);
	http.Sync=false;	
	
}

function fn_AlertMsg(cd)
{
	var v_Msg="";
	switch(cd)
	{
		case "001":
			v_Msg= "버튼이 정의 되어 있지않습니다.";
			break;
		case "002":
			v_Msg="서비스 오류:시스템 관리자에게 문의하십시오.";
			break;
		case "003":
			v_Msg="조회된 데이타가 없습니다.";
			break;														
		case "004":
			v_Msg="변경된 데이타가 있습니다.\n\n저장하시겠습니까?";
			break;
		case "005":
			v_Msg="날짜를 입력하셔야 합니다.";
			break;
		case "006":
			v_Msg="날짜 형식을 확인하세요.";
			break;			
		case "007":
			v_Msg="월이 잘못되었습니다.";
			break;			
		case "008":
			v_Msg="일자가 잘못되었습니다.";
			break;	
		case "009":
			v_Msg="조회 기간을 벗어났습니다.";
			break;					
		case "010":
			v_Msg="업장정보가 없습니다.";
			break;
		case "011":
			v_Msg="창고 정보가 없습니다.";
			break;
		case "012":
			v_Msg="식당군정보가 없습니다.";
			break;
		case "013":
			v_Msg="제공일정보가 없습니다.";
			break;
		case "014":
			v_Msg="끼니정보가 없습니다.";
			break;
		case "015":
			v_Msg="코너정보가 없습니다.";
			break;	
		case "016":
			v_Msg="예상식수가 없습니다.";
			break;										
		case "017":
			v_Msg="입고 예정일이 잘못되었습니다.\n\n다시 선택하세요.";
			break;
		case "018":
			v_Msg="발주된 자재가 있습니다.\n\n삭제할 수 없습니다.";
			break;	
		case "019":
			v_Msg="레시피별 하나의 자재만 선택대체 할 수 있습니다.";
			break;	
		case "020":
			v_Msg="레시피별 하나의 자재만 선택대체 할 수 있습니다.";
			break;
		case "021":
			v_Msg="조리법이 비어있는 라인이 있습니다.비어있는 라인을 입력하세요.";
			break;	
		case "022":
			v_Msg="변경된 데이타가 있습니다.\n\n먼저 저장하신후 작업하세요.";
			break;	
		case "023":
			v_Msg="제공일을 넘을수 없습니다.";
			break;	
		case "024":
			v_Msg="적용할 입고 예정일을 입력하세요.";
			break;
		case "025":
			v_Msg="식단 전체를 삭제 하시겠습니까?";
			break;
		case "026":
			v_Msg="이미 등록된 레시피 입니다.";
			break;	
		case "027":
			v_Msg="조회기간 정보가 없습니다.";
			break;					
		case "028":
			v_Msg="갱신된 정보가 있습니다.저장 후 작업하시겠습니까?";
			break;
		case "029":
			v_Msg="레시피를 추가 하시겠습니까?";
			break;								
		case "030":
			v_Msg="식단 작업전에 메뉴저장 버튼으로 정보를 갱신하세요";
			break;
		case "031":
			v_Msg="검색할 레시피를 하나 이상 체크 하셔야 합니다.";
			break;
		case "032":
			v_Msg="예상식수를 입력하세요.";
			break;
		case "033":
			v_Msg="식단가를 입력하세요.";
			break;
		case "034":
			//v_Msg="본사및 사업장만 다운로드 가능합니다.";
			v_Msg="한화 표준레시피를 그대로 사용한 레시피는 다운로드 되지 않습니다.";  //수정 : 2011/05/23  이혜은 대리 요청 문구 수정.
			break;
/*			
		case "":
			v_Msg="";
			break;
*/			
		default:
			break;			
	}
	return v_Msg;
}
/******************************************************************************************
 * 함  수  명   : Common_Btn_common_OnClick
 * 입      력   : 화면공통버튼 
 * 반      환   : 없음
 * 기      능   : 화면공통버튼이벤트처리 :함수호출
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function Common_Btn_common_OnClick(obj:Button, e:ClickEventInfo)
{
	switch(obj.name)
	{
		case "btn_Pop_Search":
			fn_Pop_Search();
			break;
		case "btn_Pop_Save":
			fn_Pop_Save("BTN_SAVE");
			break;
		case "btn_Pop_Delete":
			fn_Pop_Delete();
			break;
		case "btn_Pop_Close":
			fn_Pop_Close();
			break;
        default :
            break;
	}
}
/******************************************************************************************
 * 함  수  명   : div_extend_img_open_OnClick
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 조회단 그리드 싸이즈 늘이기및 줄이기
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function div_extend_img_open_OnClick(obj:ImageViewer, e:ClickEventInfo)
{
	if(div_extend.img_open.userdata=="open")
	{
		div_extend.img_open.image="URL('theme://convertImages/img_OpenBottom.png')";
		div_extend.img_open.userdata = "close";
		div_extend.position.height=191;
	}
	else
	{
		div_extend.img_open.image="URL('theme://convertImages/img_CloseBottom.png')";
		div_extend.img_open.userdata = "open";
		div_extend.position.height=480;
	}
}
/******************************************************************************************
 * 함  수  명   : div_extend_grd_List_OnKillFocus
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 조회 그리드 싸이즈 줄이기
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function div_extend_grd_List_OnKillFocus(obj:Grid, e:KillFocusEventInfo)
{
	if(div_extend.img_open.userdata=="open")
	{
		div_extend.img_open.image="URL('theme://convertImages/img_OpenBottom.png')";
		div_extend.img_open.userdata = "close";
		div_extend.position.height=191;
	}
}
/******************************************************************************************
 * 함  수  명   : btn_GiveCal_OnClick
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 날짜 조회 팝업
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function btn_GiveCal_OnClick(obj:Button, e:ClickEventInfo)
{
	g_CalButton_OnClick(obj);
	
	var v_ret= me_GiveDay.value;

	if(gfn_trim(v_ret)<fa_FROM_DT || gfn_trim(v_ret)>fa_TO_DT)
	{
		g_Message("EE",fn_AlertMsg("009"));
		return;
	}
	if(gfn_length(gfn_trim(v_ret))==8)
	{
		//me_GiveDay.value=v_ret;
		fn_init_Common("","");		
		
		ds_input.clear();
		ds_input.addColumn("CUR_DATE","STRING");
		ds_input.addColumn("UPJANG","STRING");
		ds_input.addRow();
		ds_input.setColumn(0,"CUR_DATE",me_GiveDay.value);
		ds_input.setColumn(0,"UPJANG",fa_UPJANG);
		fsp_clear(this);
		ds_weather.clearData();
		fsp_addSearch(this,"fs/fsm:FSM00060E_S001");  // 날씨정보
		
		http.Sync=true;
		fsp_callService(this,"","",
						"ds_input=ds_input",
						"ds_weather=ds_weather",
						"",
						"fn_call_back",
						"",
						true);
		http.Sync=false;
		img_Weather.image = gfn_nvl(ds_weather.getColumn(0,"W_IMAGE"));
	}
	else
	{
		return;
		// if(me_GiveDay.Value.Trim().length()!=8)
		// {
			// me_GiveDay.Value=ds_GetDate.GetColumn(0,"TODAY");
			// fn_Meal();
		// }
	}
	
}
/******************************************************************************************
 * 함  수  명   : me_GiveDay_OnKillFocus
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 날짜 유효성체크
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function me_GiveDay_onkillfocus(obj:MaskEdit, e:KillFocusEventInfo)
{
	var bCheck = gfn_isDate8(me_GiveDay.value);
	if ( !bCheck ) me_GiveDay.setFocus();
}

// function fn_IsDate(sYmd)
// {
//  	if(  gfn_length(gfn_trim(sYmd))< 1) {
// 		g_Message("EE",fn_AlertMsg("005"));
//     	return false;
//   	}
//   	
//     // 숫자 확인
//     if(g_fn_IsNumber(sYmd) == -1) {
//     	g_Message("EE",fn_AlertMsg("006"));
//     	me_GiveDay.value="";
//     	return false;
//   	}
//   	
//   	// 길이 확인
//   	if(gfn_length(sYmd)== 8) {
//   	} else {
// 	    g_Message("EE",fn_AlertMsg("006"));
//     	return false;
//   	}
//   	
//   	var iYear	= toNumber(gfn_subStr(sYmd,0,4));		//년도입력(YYYY)
//   	var iMonth	= toNumber(gfn_subStr(sYmd,4,2));		//월입력(MM)
//   	var iDay	= toNumber(gfn_subStr(sYmd,6,2));		//일자입력(DD)
//   	
//   	if((iMonth < 1) ||(iMonth >12)) {
// 	    g_Message("EE",fn_AlertMsg("007"));
// 	    me_GiveDay.setSelect(5,7);
// 	    me_GiveDay.setFocus();
//         return false;
//   	}
//   	
//   	// 날짜의 존재 여부를 확인
//   	if(gfn_getDay(sYmd)< 0 ) {
// 	    g_Message("EE",fn_AlertMsg("008"));
// 	    me_GiveDay.setSelect(8,10);
// 	    me_GiveDay.setFocus();
// 	    me_GiveDay.value=gfn_subStr(sYmd,0,6);
//     	return ;
//   	}
// }
/******************************************************************************************
 * 함  수  명   : cbo_DinGbn_OnChanged
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 끼니 선택시 코너 조회
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function cbo_DinGbn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	fn_Corner();
}
/******************************************************************************************
 * 함  수  명   : cbo_CornGbn_OnChanged
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 코너 선택시 헤디라인 나머지값 채우기
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function cbo_CornGbn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	//ds_Corner.row=cbo_CornGbn.Index;

	// me_Cnt.Value=ds_Corner.GetColumn(ds_Corner.row,"EXPECT_MEAL_QTY");
	// me_danga.Value=ds_Corner.GetColumn(ds_Corner.row,"SALE_PRICE");
	// ed_Feature.value=ds_Corner.GetColumn(ds_Corner.row,"MENU_FEATURE");

	//fn_Pop_Search();
}
/******************************************************************************************
 * 함  수  명   : me_GiveDay_OnChanged
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 제공일 변경시 끼니 다시 조회
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function me_GiveDay_OnChanged(obj:MaskEdit,  e:TextChangedEventInfo)
{
	if ( gfn_length(me_GiveDay.value) == 8 ) {
		fn_Reset();
		
		var bCheck = gfn_isDate8(me_GiveDay.value);
		if ( bCheck ) fn_Meal();
	}
}
/******************************************************************************************
 * 함  수  명   : btn_SubSearch_OnClick
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 표준및 업장 표준레시피 조회
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function btn_SubSearch_OnClick(obj:Button, e:ClickEventInfo)
{
	if(chk_UpjangRecipe.value==0 	&& 
		chk_StdRecipe.value==0		&&
		chk_HWStdRecipe.value==0)
	{
		g_Message("EE",fn_AlertMsg("031"));
		return;
	}
	if(btn_MenuIns.userdata==1)
	{
		g_Message("EE",fn_AlertMsg("030"));
		return;
	}

//	필수 입력 체크 할것
	var chk_Std=0;
	var chk_Upjang=0;
	var chk_subUpjang=0;

	var fa_SUBINV_CLASS=ds_Hall_class.getColumn(0,"SUBINV_CLASS");
	//var fa_SUBINV_CLASS=fa_SUBINV_CODE;
	
	chk_Std			=chk_HWStdRecipe.value;
	chk_Upjang		=chk_StdRecipe.value;
	chk_subUpjang	=chk_UpjangRecipe.value;
	
	if(gfn_length(gfn_trim(fa_UPJANG))==0)
	{
		g_Message("EE",fn_AlertMsg("010"));
		return;
	}
	if(gfn_length(gfn_trim(fa_SUBINV_CLASS))==0)
	{
		g_Message("EE",fn_AlertMsg("012"));
		return;
	}	
	if(gfn_length(gfn_trim(me_GiveDay.value))==0)
	{
		g_Message("EE",fn_AlertMsg("013"));
		return;
	}		
	var ActionVal="";
	ActionVal 	="STD_CHK="					+	wrapQuote(gfn_trim(gfn_nvl(chk_Std)))
				+" UPJANG_CHK="				+	wrapQuote(gfn_trim(gfn_nvl(chk_Upjang)))
				+" SUBUPJANG_CHK="			+	wrapQuote(gfn_trim(gfn_nvl(chk_subUpjang)))
				+" RECIPE_NAME="			+	wrapQuote(gfn_trim(gfn_replace(cbo_RecipeNM.value,"==레시피명==","")))
				+" RECIPE_CLASS="			+	wrapQuote(gfn_trim(gfn_nvl(cbo_RecipeClass.value)))
				+" RECIPE_TYPE="			+	wrapQuote(gfn_trim(gfn_nvl(cbo_RecipeType.value)))
				+" CUISINE_TYPE="			+	wrapQuote(gfn_trim(gfn_nvl(cbo_CuisineClass.value)))
				+" MAIN_ITEM_CODE1="		+	wrapQuote(gfn_trim(gfn_nvl(cbo_Item.value)))
				+" RESP_NUT1="				+	wrapQuote(gfn_trim(gfn_nvl(cbo_Element.value)))
				+" MENU_DATE="				+	wrapQuote(gfn_trim(gfn_nvl(me_GiveDay.value)))
				+" UPJANG="					+	wrapQuote(gfn_trim(gfn_nvl(fa_UPJANG)))
				+" SUBINV_CLASS="			+	wrapQuote(gfn_trim(gfn_nvl(fa_SUBINV_CLASS)))
				+" UNITPRICE_FROM="			+	wrapQuote(gfn_trim(gfn_nvl(me_UnitPfrom.value)))
				+" UNITPRICE_TO="			+	wrapQuote(gfn_trim(gfn_nvl(me_UnitPto.value)))
				+" SALEPRICE_FROM="			+	wrapQuote(gfn_trim(gfn_nvl(me_SalePfrom.value)))
				+" SALEPRICE_TO="			+	wrapQuote(gfn_trim(gfn_nvl(me_SalePto.value)));
	// 속도 문제로 jsp로 교체
	// tit_ClearActionInfo(this);
	// ds_List.ClearData();
	// tit_addSearchActionInfo(this,"fm/fmm:FMM00210E_S009");
	// tit_CallService(this,"","","","ds_List=ds_List",ActionVal,"fn_call_back","",true);

	var OutDS="ds_List=ds_List";
	ds_List.clearData();
	//transaction("ds_List","S_FMM::FMM00210V_S009.jsp","",OutDS,ActionVal,"fn_call_back_T1_Search_jsp");
	jsp_transaction(this,"FMM00210V_S009","U_svc::" + "fm/fmm/FMM00210V_S009.jsp","",OutDS,ActionVal,"fn_call_back_T1_Search_jsp", false, false, false);
}

//function fn_call_back_T1_Search_jsp(svcid,cd,errmsg)
function fn_call_back_T1_Search_jsp(cd,errmsg)
{
	if(cd!=0)
	{
		g_Message("EE","시스템 오류!\n\n전산담당자에게 문의 하세요.");
		return;
	}
	else
	{
	}
}
/******************************************************************************************
 * 함  수  명   : chk_RecipeGbn_OnClick
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 표준및 업장 표준레시피 체크 선택(두개중에 하나는 반드시 선택되도록 이벤트 처리)
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */

function div_extend_grd_List_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
	var chkGbn="";
	
	btn_leftMoveData.click();
	
	return;// 식제 영업은 팝업 없음
	
	/*
	if(ds_List.getColumn(e.row,"GUBUN")=="업장")
	{	// 업장표준레시피
		chkGbn="UPJANG";
	}
	else
	{	// 표준레시피
		chkGbn="STD";
	}
	var v_GUBUN					=gfn_trim(chkGbn);
	var v_RECIPE_CD				=gfn_trim(ds_List.getColumn(e.row,"RECIPE_CD"));
	var v_RECIPE_NAME			=gfn_trim(ds_List.getColumn(e.row,"RECIPE_NAME"));
	var v_UPJANG				=gfn_trim(fa_UPJANG);
	var v_HALL_CLASS			=gfn_trim(ds_Hall_class.getColumn(0,"HALL_CLASS"));
	var v_MENU_DATE				=gfn_trim(me_GiveDay.value);
	
	var arg	= {GUBUN:v_GUBUN
	          ,RECIPE_CD:v_RECIPE_CD
	          ,RECIPE_NAME:v_RECIPE_NAME
	          ,UPJANG:v_UPJANG
	          ,HALL_CLASS:v_HALL_CLASS
	          ,MENU_CD:fa_MENU_DATE+"-"+fa_HALL_CD+cbo_DinGbn.value+cbo_CornGbn.value
	          ,MENU_DATE:v_MENU_DATE};
	
	gfn_dialog("", "U_FMM::FMM00068P.xml",arg);	
	*/
}

function chk_disuse_OnClick(obj:CheckBox, e:ClickEventInfo)
{
/*	var v_strGrdID=grd_RealRecipe.Format;
	var v_strGrdIDEx=grd_Excel1.Format;
	if(chk_disuse.Value==1)
	{
		if(substr(v_strGrdID,0,3)=="SS_")
		{
			grd_RealRecipe.Format=replace(v_strGrdID,"SS_","");
			grd_Excel1.Format=replace(v_strGrdIDEx,"SS_","");
		}
	}
	else
	{
		if(substr(v_strGrdID,0,3)!="SS_")
		{
			grd_RealRecipe.Format="SS_"+v_strGrdID;
			grd_Excel1.Format="SS_"+v_strGrdIDEx;
		}		
	}
*/	
	var v_strGrdID=grd_RealRecipe.formatid;
	var v_strGrdIDEx=grd_Excel1.formatid;
	if(obj.isChecked()==1)		//폐기율 적용 영양소 보기 ss_cal  ss_grd
	{
		if(gfn_subStr(v_strGrdID,0,3)!="SS_")
		{
			grd_RealRecipe.formatid=v_strGrdID;
			grd_Excel1.formatid=v_strGrdID;
		}
		else
		{
			grd_RealRecipe.formatid=gfn_replace(v_strGrdID,"SS_","");
			grd_Excel1.formatid=gfn_replace(v_strGrdID,"SS_","");
		}
	}
	else	//폐기율 미적용 영양소 보기   s_cal  grd
	{
		if(gfn_subStr(v_strGrdID,0,3)=="SS_")
		{
			grd_RealRecipe.formatid=v_strGrdID;
			grd_Excel1.formatid=v_strGrdID;
		}
		else
		{
			grd_RealRecipe.formatid="SS_"+v_strGrdID;
			grd_Excel1.formatid="SS_"+v_strGrdID;
		}
	}	
	var value="식재료율("+Math.round(toNumber(ds_Menu.getSum("RECIPE_COST"))/toNumber(me_danga.value)*100,2)+"%)";
	grd_RealRecipe.setCellProperty("summary",1,"text",value);
}

function btn_ImgPop_OnClick(obj:Button, e:ClickEventInfo)
{
	if(ds_Menu.getRowCount()==0)
	{
		return;
	}
	
	var arg	= {MENU_DATE:gfn_subStr(ds_Menu.getColumn(0,"MENU_CD"),0,8)
			  ,MEAL:gfn_subStr(ds_Menu.getColumn(0,"MENU_CD"),17,3)
			  ,UPJANG:ds_Menu.getColumn(0,"UPJANG")
			  ,SUBINV_CODE:gfn_subStr(ds_Menu.getColumn(0,"MENU_CD"),9,8)
			  ,CORNER:gfn_subStr(ds_Menu.getColumn(0,"MENU_CD"),20,3)};
	gfn_dialog("", "U_FMM::FMM00216P.xfdl",arg);
}

function btn_Qality_OnClick(obj:Button, e:ClickEventInfo)
{
	if(ds_Menu.getRowCount()==0)
	{
		return;
	}
	var arg	= { MENU_DATE:gfn_subStr(ds_Menu.getColumn(0,"MENU_CD"),0,8)
	           ,MEAL:gfn_subStr(ds_Menu.getColumn(0,"MENU_CD"),17,3)
	           ,UPJANG:ds_Menu.getColumn(0,"UPJANG")
	           ,SUBINV_CODE:gfn_subStr(ds_Menu.getColumn(0,"MENU_CD"),9,8)
	           ,CORNER:gfn_subStr(ds_Menu.getColumn(0,"MENU_CD"),20,3) };
	gfn_dialog("", "U_FMM::FMM00214P.xfdl",arg);	
} 

function btn_Nut_OnClick(obj:Button, e:ClickEventInfo)
{
	if(ds_Menu.getRowCount()==0)
	{
		return;
	}
	var arg	= {UPJANG:fa_UPJANG
	          ,SUBINV_CODE:gfn_subStr(ds_Menu.getColumn(0,"MENU_CD"),9,8)
	          ,GUBUN:chk_disuse.value 
	          ,OBJ_DS_MENU:ds_Menu};
	gfn_dialog("", "U_FMM::FMM00212P.xfdl",arg); 
}

function btn_leftMoveData_OnClick(obj:Button, e:ClickEventInfo)
{
	if(ds_List.getRowCount()==0)
	{
		return;
	}
	if(gfn_length(gfn_trim(me_GiveDay.value))==0 || gfn_trim(me_GiveDay.value)==null )
	{
		g_Message("EE",fn_AlertMsg("005"));
		return;
	}
// 예상식수 = 0 일때 막는 부분 추가 090304일 노규와 추가 수정
	if(toNumber(me_Cnt.value)==0)
	{
		g_Message("EE",fn_AlertMsg("032"));
		return;
	}

	if(gfn_length(gfn_trim(cbo_DinGbn.value))==0 || gfn_trim(cbo_DinGbn.value)==null )
	{
		g_Message("EE",fn_AlertMsg("014"));
		return;
	}
	if(gfn_length(gfn_trim(cbo_CornGbn.value))==0 || gfn_trim(cbo_CornGbn.value)==null )
	{
		g_Message("EE",fn_AlertMsg("015"));
		return;
	}
	if(btn_MenuIns.userdata==1)
	{
		g_Message("EE",fn_AlertMsg("030"));
		return;
	}	
	var v_Recipe=ds_List.getColumn(ds_List.rowposition,"RECIPE_CD");
//trace(ds_Menu.saveXML());
	if(ds_Menu.findRow("RECIPE_CD",gfn_trim(v_Recipe))!=-1)
	{
		g_Message("EE",fn_AlertMsg("026"));
		return;
	}
	// 레시피 추가 메시지 제거
	// if(g_Confirm("02",fn_AlertMsg("029"))==false)
	// {
		// return;
	// }	
	if(gfn_dsIsUpdated(ds_Menu)==true ||
		gfn_dsIsUpdated(ds_Item)==true)
	{
		if(g_Confirm("02",fn_AlertMsg("028"))==true)
		{
			fn_Pop_Save("BTN_SAVE");
		}
	}
	fn_Pop_Save("CREATE_REAL");
}

function div_extend_grd_List_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	//ds_List.rowposition=e.row;
	if(e.col!=7)
	{
		return;
	}
	if(btn_MenuIns.userdata==1)
	{
		g_Message("EE",fn_AlertMsg("030"));
		return;
	}		
	if(gfn_dsIsUpdated(ds_Menu)==true ||
		gfn_dsIsUpdated(ds_Item)==true)
	{
		if(g_Confirm("02",fn_AlertMsg("028"))==true)
		{
			fn_Pop_Save("BTN_SAVE");
		}
	}	
	var arg	= {UPJANG:fa_UPJANG
	          ,RECIPE_CD:ds_List.getColumn(e.row,"RECIPE_CD")
	          ,RECIPE_NAME:ds_List.getColumn(e.row,"RECIPE_NAME")
	          ,SUBINV_CODE:gfn_trim(fa_SUBINV_CODE)
	          ,MEAL:gfn_trim(cbo_DinGbn.value)
	          ,CORNER:gfn_trim(cbo_CornGbn.value)
	          ,MENU_DATE:gfn_trim(me_GiveDay.value)
	          ,MENU_CD:fa_MENU_DATE+"-"+fa_SUBINV_CODE+cbo_DinGbn.value+cbo_CornGbn.value };
	//trace(arg);
	var v_bln=gfn_dialog("", "U_FMM::FMM00215P.xfdl",arg);
	//trace("v_bln==="+v_bln);
	if(v_bln)
	{
		fn_Pop_Search();
	}
}

function ds_Item_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{	
	//SetWaitCursor(true);
	
	var v_EQ=0;	// EDIBLE_QTY		가식부량 1인소요량*폐기율==>NEED_QTY*(100-disuse_rate)
	var v_PP=0; // PERSON_PRICE 	1인원가	자재g당단가*1인소요량==>GRAM_PRICE*NEED_QTY
//	var v_CC=0; // CAL_CALC			에너지    100g:기본에너지=가식부량:계산할에너지==>CAL_CALC=(CAL*EDIBLE_QTY)/100
	var v_TQ=0; //	1인소요량* 예상식수/1000 = 총소요량  
	var v_Price=0;
	var v_Row="";
	var v_nut="";
	var v_rtn="";
	var v_col="";	
	switch(e.columnid)
	{
		case "NEED_QTY":	// 1인소요량
			//trace(ds_Item.getColumn(e.row,"G_ITEM_PRICE")+" // "+ds_Item.getColumn(e.row,"NEED_QTY"));
			v_PP	=	Math.round(ds_Item.getColumn(e.row,"G_ITEM_PRICE")*ds_Item.getColumn(e.row,"NEED_QTY"),0);
			ds_Item.setColumn(e.row,"OP_PRICE",v_PP);	// 1인원가 
			
			//추가 : case "OP_PRICE":	// 1인원가 식단레시피 마스터그리드 반영
			v_Price	= 	ds_Item.getCaseSum("RECIPE_CD=="+wrapQuote(ds_Item.getColumn(e.row,"RECIPE_CD")),"OP_PRICE");
			v_Row	=	ds_Menu.findRow("RECIPE_CD",ds_Item.getColumn(e.row,"RECIPE_CD"));
			ds_Menu.setColumn(v_Row,"RECIPE_COST",v_Price);
			var value="식재료율("+Math.round(toNumber(ds_Menu.getSum("RECIPE_COST"))/toNumber(me_danga.value)*100,2)+"%)";
			grd_RealRecipe.setCellProperty("summary",1,"text",value);
			
			v_EQ	=	Math.round(ds_Item.getColumn(e.row,"NEED_QTY")*((100-ds_Item.getColumn(e.row,"DISUSE_RATE"))/100),2);
			ds_Item.setColumn(e.row,"EDIBLE_QTY",v_EQ);			// 가식부량	
			
			v_TQ	=	Math.round((ds_Item.getColumn(e.row,"NEED_QTY")*ds_Item.getColumn(e.row,"EXPECT_MEAL_QTY"))/1000,2);
			ds_Item.setColumn(e.row,"TOT_QTY",v_TQ);			// 총소요량
			
			break;	
		case "EDIBLE_QTY":	// 가식부량
			// CAL WATER PROT FAT CARBO FIBER ASH CA P FE NA K VITA_A RETIN B_CAROT THIA RIBO NIACIN VITA_C CHOLE 
			v_rtn="CAL;WATER;PROT;FAT;CARBO;FIBER;ASH;CA;P;FE;NA;K;VITA_A;RETIN;B_CAROT;THIA;RIBO;NIACIN;VITA_C;CHOLE";
			v_nut=gfn_split(v_rtn,";");
			/*	불가 협의 요망	->확인 영양속 재계산 버튼으로 처리 		
			for(i=0;i<20;i++)
			{	
				// 영양가 계산(1 폐기율 적용영양소 계산 2 폐기율 미적용영양소 계산)
				// 1 폐기율 적용영양소 계산
				//trace(v_nut[i]);
				v_col="S_"+v_nut[i];
				v_Price	= 	ds_Item.CaseSum("RECIPE_CD=="+quote(ds_Item.GetColumn(nRow,"RECIPE_CD")),"NEED_QTY");	// 레시피별 1인량합
				v_Row	=	ds_Menu.FindRow("RECIPE_CD",ds_Item.GetColumn(nRow,"RECIPE_CD"));
				ds_Menu.SetColumn(v_Row, v_col , round(v_Price * ds_Menu.GetColumn(v_Row,v_nut[i]),2) );			
				//trace(v_col);
				// 2 폐기율 미적용영양소 계산
				v_col="SS_"+v_nut[i];
				v_Price	= 	ds_Item.CaseSum("RECIPE_CD=="+quote(ds_Item.GetColumn(nRow,"RECIPE_CD")),"EDIBLE_QTY");	// 레시피별 가식부량
				v_Row	=	ds_Menu.FindRow("RECIPE_CD",ds_Item.GetColumn(nRow,"RECIPE_CD"));
				ds_Menu.SetColumn(v_Row, v_col , round(v_Price * ds_Menu.GetColumn(v_Row,v_nut[i]),2) );					
				//trace(v_col);
			}
			*/
			break;			
		case "OP_PRICE":	// 1인원가 식단레시피 마스터그리드 반영
			v_Price	= 	ds_Item.getCaseSum("RECIPE_CD=="+wrapQuote(ds_Item.getColumn(e.row,"RECIPE_CD")),"OP_PRICE");
			v_Row	=	ds_Menu.findRow("RECIPE_CD",ds_Item.getColumn(e.row,"RECIPE_CD"));
			ds_Menu.setColumn(v_Row,"RECIPE_COST",v_Price);
			var value="식재료율("+Math.round(toNumber(ds_Menu.getSum("RECIPE_COST"))/toNumber(me_danga.value)*100,2)+"%)";
			grd_RealRecipe.setCellProperty("summary",1,"text",value);
			break;		
        default :
            break;
	}

	// 고객사(푸드원) 요청에 의해 변경사항 팝업 제거하고 바로 저장하는 루틴
	if(gfn_dsIsUpdated(ds_Menu)==true || gfn_dsIsUpdated(ds_Item)==true)
	{
		var ordExpYn = ds_Item.getColumn(e.row,"PR_ID");
		
		//발주여부가 'Y'이면 주문제외를 체크할 수 없도록 함.
		if(ordExpYn > 0)
		{
			ds_Item.setColumn(e.row,"ORD_EXP_YN",0);
		}
		
		//그리드만 저장하기
		fn_Pop_Save("BTN_SAVE_GRID");
	}
	
	//SetWaitCursor(false);	
}

function tab_main_OnChanged(obj:Tab, e:TabIndexChangeEventInfo)
{
	if(e.postindex==3)
	{
		tab_main.tab3.div_ImgLoadUrl.img_JoryMethod.image=GF_FILE_SERVER_URL+"upload/img/cook_ctrl/"+v_CurCuisineType+".jpg";
		//trace(tab_main.tab3.div_ImgLoadUrl.img_JoryMethod.image);	
	}
}

function ds_Item_OnRowPosChanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	v_CurRecipenm=ds_Item.getColumn(e.newrow,"RECIPE_NAME");
	v_CurRecipecd=ds_Item.getColumn(e.newrow,"RECIPE_CD");
	v_CurCuisineType=ds_Item.getColumn(e.newrow,"CUISINE_TYPE");
}

function tab_main_OnChanging(obj:Tab, e:TabIndexChangeEventInfo)
{
	if(ds_Item.getRowCount()==0 || ds_Menu.getRowCount()==0)
	{
		return false;
	}
	switch(e.preindex)
	{
		case 0:	// 레시피수정
			break;
		case 1:	// 조리법
			if(gfn_dsIsUpdated(ds_CookMethod)==false)
			{
				return;
			}
			else
			{
				if(g_Confirm("02",fn_AlertMsg("028"))==true)
				{
					if(ds_CookMethod.findRowExpr("gfn_length(gfn_trim(CUISINE_DESC))==0 || gfn_trim(CUISINE_DESC)==null")!=-1)
					{
						//alert(fn_AlertMsg("016"));
						g_Message("EE", fn_AlertMsg("021"));
						return false;
					}
					var v_max=ds_CookMethod.getMax("CUISINE_SEQ");
					if( gfn_trim(v_max)==null || gfn_length(gfn_trim(v_max))==0 )
					{
						v_max=0;
					}
					for(i=0;i<ds_CookMethod.getRowCount();i++)
					{
						if(gfn_length(gfn_trim(ds_CookMethod.getColumn(i,"CUISINE_SEQ")))==0
								|| gfn_trim(ds_CookMethod.getColumn(i,"CUISINE_SEQ"))==null )
						{
							v_max=v_max+1;
							ds_CookMethod.setColumn(i,"CUISINE_SEQ",v_max);
						}
						
					}					
					fn_Pop_Save("COOK");
					return;
				}
			}
			break;
		case 2:	// PHF
			// ds_RecipePhf
			if(gfn_dsIsUpdated(ds_RecipePhf)==false)
			{
				return;
			}
			else
			{
				if(g_Confirm("02",fn_AlertMsg("028"))==true)
				{				
					fn_Pop_Save("PHF");
					return;
				}
			}			
			break;
        default :
            break;
	}
}

function ds_phf_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	switch(e.row)
	{
		case 0:
			if(e.columnid=="PHF")
			{
				ds_RecipePhf.setColumn(0,"PHF_MGMT1",e.newvalue);
			}
			break;
		case 1:
			if(e.columnid=="PHF")
			{
				ds_RecipePhf.setColumn(0,"PHF_MGMT2",e.newvalue);
			}
			break;
		case 2:
			if(e.columnid=="PHF")
			{			
				ds_RecipePhf.setColumn(0,"PHF_MGMT3",e.newvalue);
			}
			break;
		case 3:
			if(e.columnid=="PHF")
			{			
				ds_RecipePhf.setColumn(0,"PHF_MGMT4",e.newvalue);
			}
			break;
		case 4:
			if(e.columnid=="PHF")
			{		
				ds_RecipePhf.setColumn(0,"PHF_MGMT5",e.newvalue);
			}
			break;
        default :
            break;
	}
	var v_1=ds_RecipePhf.getColumn(0,"PHF_MGMT1");
	var v_2=ds_RecipePhf.getColumn(0,"PHF_MGMT2");
	var v_3=ds_RecipePhf.getColumn(0,"PHF_MGMT3");
	var v_4=ds_RecipePhf.getColumn(0,"PHF_MGMT4");
	var v_5=ds_RecipePhf.getColumn(0,"PHF_MGMT5");
	
	if( v_1=='Y' && v_2=='N')
	{
		ds_RecipePhf.setColumn(0,"PHF","Y");
	}
	else
	{
		if(v_1=='Y' || v_2=='N')
		{
			if(v_3=='Y' || v_4=='Y' || v_5=='Y')
			{
				ds_RecipePhf.setColumn(0,"PHF","Y");
			}
			else
			{
				ds_RecipePhf.setColumn(0,"PHF","N");
			}
		}
		else
		{
			ds_RecipePhf.setColumn(0,"PHF","N");
		}
	}
}

function grd_RealRecipe_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	var v_row;
	var v_cnt;
	ds_Item.clearSelect();
	ds_Item.rowposition=ds_Item.findRow("RECIPE_CD",ds_Menu.getColumn(e.row,"RECIPE_CD"));
	ds_Item.selectRow(ds_Item.rowposition);	
	switch(e.cell)
	{
		case 3:
			v_cnt=ds_Item.getRowCount();
			if(v_cnt==0 || v_cnt== null)
			{
				return;
			}			
			// 발주된 자재가 있는 레시피는 삭제할 수 없습니다.
			if(ds_Item.findRowExpr("RECIPE_CD=="+wrapQuote(ds_Menu.getColumn(e.row,"RECIPE_CD"))+" && ORDER_YN=='Y'")!=-1)
			{
				g_Message("EE",fn_AlertMsg("018"));
				return;
			}
			// if(g_Confirm("01")==false)
			// {
				// return;
			// }
			for(i=0;i<v_cnt;i++)
			{
				v_row=ds_Item.findRow("RECIPE_CD", ds_Menu.getColumn(e.row,"RECIPE_CD") );
				ds_Item.deleteRow(v_row);
			}
			ds_Menu.deleteRow(e.row);
			
			fn_Pop_Save("ICO_RECIPE_DEL");
			break;
        default :
            break;
	}
}

function div_extend_grd_List_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	// if(nCell==0)
	// {
		// div_extend.grd_List.ExportExcelEx("Sheet1");
	// }
	switch(e.cell)
	{
		case 0:
			// if(ds_MainRecipeList.RowCount()==0)
			// {
				// return;
			// }
			g_Message("04",fn_AlertMsg("034"));
			ds_Excel.clear();
			Copy(ds_Excel,obj.binddataset);
			ds_Excel.filter("GUBUN!=0");
			grd_Excel.binddataset="ds_Excel";
			gfn_exportExcel(grd_Excel, "sheet1");
			break;
		default:			
			gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
			break;
	}
}

function grd_RealRecipe_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	// if(nCell==0)
	// {	
		// grd_RealRecipe.ExportExcelEx("Sheet1");
	// }
	switch(e.cell)
	{
		case 0:
			// if(ds_MainRecipeList.RowCount()==0)
			// {
				// return;
			// }
			/*
			g_Message("04",fn_AlertMsg("034"));
			ds_Excel.Clear();
			ds_Excel.Copy(obj.BindDataSet);
			ds_Excel.Filter("IsAlpha(substr(RECIPE_CD,0,1))!=true");
			grd_Excel1.BindDataset="ds_Excel";
			grd_Excel1.ExportExcelEx("sheet1");
			break;
			*/
			g_Message("04",fn_AlertMsg("034"));
			ds_Excel.clear();
			Copy(ds_Excel,obj.binddataset);
			ds_Excel.filter("ATTR04!=0");
			grd_Excel1.binddataset="ds_Excel";
			gfn_exportExcel(grd_Excel1, "sheet1");
			break;
		case 2:
			var dsRecCnt= eval(obj.binddataset).getRowCount();
			if(dsRecCnt==0) {return;}
			var inNum="";
			if(eval(obj.binddataset).findRow("CREAT",0)==-1)
			{
				inNum=0;
			}
			else
			{
				inNum=1;
			}
			for(i=0;i<dsRecCnt;i++)
			{
				eval(obj.binddataset).setColumn(i,"CREAT",inNum);
			}		
			break;
		default:
			gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);		
			break;
	}	
}

function common_OnChanged(obj, e:ItemChangeEventInfo)
{
	fn_common_OnChanged(obj, e.postvalue);
}

function fn_common_OnChanged(obj, sVal)
{
	fn_Reset();
	
// 	if(obj.name=="me_GiveDay")
// 	{
// //trace("me_GiveDay e.postvalue=="+sVal);
// 		if ( gfn_length(sVal) != 8 )	{
// 			fn_Make_Menu_Mst(false);
// 		}
// 	} else {
// 		fn_Make_Menu_Mst(false);
// 	}

	if(obj.name=="cbo_DinGbn")
	{
		fn_Corner();
	}
	
	if(v_con==0)
	{
		//return;
	}
	
// 	if(obj.name=="me_danga" || obj.name=="me_Cnt")
// 	{
// 		btn_MenuIns.userdata=1;
// 		return;
// 	}
	
	var arg	="UPJANG="			+	wrapQuote(fa_UPJANG)
			+" SUBINV_CODE="	+	wrapQuote(fa_SUBINV_CODE)
			+" MEAL="			+	wrapQuote(cbo_DinGbn.value)
			+" CORNER="			+	wrapQuote(cbo_CornGbn.value)
			+" MENU_DATE="		+	wrapQuote(me_GiveDay.value)
			+" EXPECT_MEAL_QTY="+	wrapQuote(me_Cnt.value)
			+" MEAL_PRICE="		+	wrapQuote(me_danga.value);
			
	fsp_clear(this);
	ds_MCPrice.clearData();
	ds_Check_Menu.clearData();
	fsp_addSearch(this,"fm/fmm:FMM00210E_S007");
	fsp_addSearch(this,"fm/fmm:FMM00210E_S006");
	fsp_callService(this,"","",
					"",
					"ds_MCPrice=ds_MCPrice ds_Check_Menu=ds_Check_Menu",
					arg,
					"fn_call_back_chnchk",
					"",
					true);
					
}

function me_common_ontextchanged(obj:MaskEdit,  e:TextChangedEventInfo)
{
	//fn_Reset();
	btn_MenuIns.userdata=1;
}

function fn_init_Common()
{
	fn_Reset();

	var arg	="UPJANG="			+	wrapQuote(fa_UPJANG)
			+" SUBINV_CODE="	+	wrapQuote(fa_SUBINV_CODE)
			+" MEAL="			+	wrapQuote(cbo_DinGbn.value)
			+" CORNER="			+	wrapQuote(cbo_CornGbn.value)
			+" MENU_DATE="		+	wrapQuote(me_GiveDay.value)
			+" EXPECT_MEAL_QTY="+	wrapQuote(me_Cnt.value)
			+" MEAL_PRICE="		+	wrapQuote(me_danga.value);
			
	fsp_clear(this);
	ds_MCPrice.clearData();
	ds_Check_Menu.clearData();
	fsp_addSearch(this,"fm/fmm:FMM00210E_S007");
	fsp_addSearch(this,"fm/fmm:FMM00210E_S006");
	fsp_callService(this,"","",
					"",
					"ds_MCPrice=ds_MCPrice ds_Check_Menu=ds_Check_Menu",
					arg,
					"fn_call_back_chnchk",
					"",
					true);
}

function fn_call_back_chnchk(cd,errmsg)
{
	if(cd!=0)
	{
		
	}
	else
	{
		if(ds_MCPrice.getRowCount()==0 && ds_Check_Menu.getRowCount()==0)
		{
			btn_MenuIns.userdata=1;
			me_Cnt.value=0;
			me_danga.value=0;
			return;
		}
		else
		{
			if(ds_Check_Menu.getRowCount()>0)
			{
				if(gfn_length(gfn_trim(ds_Check_Menu.getColumn(0,"EXPECT_MEAL_QTY")))==0)
				{
					me_Cnt.value=0;
				}
				else
				{
					me_Cnt.value=ds_Check_Menu.getColumn(0,"EXPECT_MEAL_QTY");
				}
				if(gfn_length(gfn_trim(ds_Check_Menu.getColumn(0,"SALE_PRICE")))==0)
				{
					me_danga.value=0;
				}
				else
				{
					me_danga.value=ds_Check_Menu.getColumn(0,"SALE_PRICE");
				}
			}
			else
			{
				btn_MenuIns.userdata=1;
				me_Cnt.value=0;
			}
			/*
			if(ds_MCPrice.RowCount()>0)
			{
				if(length(trim(ds_MCPrice.GetColumn(0,"MEAL_PRICE")))==0)
				{
					me_danga.Value=0;
				}
				else
				{
					me_danga.Value=ds_MCPrice.GetColumn(0,"MEAL_PRICE");
				}
			}
			else
			{
				// trace("danga="+ds_MCPrice.GetColumn(0,"MEAL_PRICE"));
				btn_MenuIns.UserData=1;
				me_danga.Value=0;
			}
			if(toNumber(ds_Check_Menu.GetColumn(0,"EXPECT_MEAL_QTY"))!=0  &&
				toNumber(ds_MCPrice.GetColumn(0,"MEAL_PRICE"))!=0)
			{
				btn_MenuIns.UserData=0;
			}
			*/
			if(toNumber(ds_Check_Menu.getColumn(0,"EXPECT_MEAL_QTY"))!=0  &&
				toNumber(ds_Check_Menu.getColumn(0,"SALE_PRICE"))!=0)
			{
				btn_MenuIns.userdata=0;
			}
		}
		
		btn_Pop_Search.click();
	}
}

function btn_MenuIns_OnClick(obj:Button, e:ClickEventInfo)
{
	if(btn_MenuIns.userdata==0)
	{
		return;
	}
	var arg	="UPJANG="			+	wrapQuote(fa_UPJANG)
			+" SUBINV_CODE="	+	wrapQuote(fa_SUBINV_CODE)
			+" MEAL="			+	wrapQuote(cbo_DinGbn.value)
			+" CORNER="			+	wrapQuote(cbo_CornGbn.value)
			+" MENU_DATE="		+	wrapQuote(me_GiveDay.value)
			+" EXPECT_MEAL_QTY="+	wrapQuote(me_Cnt.value)
			+" MEAL_PRICE="		+	wrapQuote(me_danga.value);
	if(me_Cnt.value==0)
	{
		g_Message("EE",fn_AlertMsg("032"));
		me_Cnt.setFocus();
		return;
	}
	if(me_danga.value==0)
	{
		g_Message("EE",fn_AlertMsg("033"));
		me_danga.setFocus();
		return;
	}
	//trace("Process");
	
	fsp_clear(this);
	ds_MCPrice.clearData();
	ds_Check_Menu.clearData();
	fsp_addSearch(this,"fm/fmm:FMM00210E_S007");
	fsp_addSearch(this,"fm/fmm:FMM00210E_S006");
	http.Sync=true;
	fsp_callService(this,"","",
					"",
					"ds_MCPrice=ds_MCPrice ds_Check_Menu=ds_Check_Menu",
					arg,
					"",
					"",
					true);
	http.Sync=false;
	fsp_clear(this);
	if(ds_MCPrice.getRowCount()==0)	// 끼니코너 식단가
	{// 생성
		fsp_addSingle(this,"fm/fmm:FMM00210E_I001");
	}
	else
	{// 업데이트 식단가
		// 2008.06.25 fms_meal_corner정보는 업데이트 없음으로 변경
		//tit_AddSingleActionInfo(this,"fm/fmm:FMM00210E_U001");
	}
	fsp_callService(this,"","",
					"",
					"",
					arg,
					"",
					"",
					true);	
	fsp_clear(this);
	if(ds_Check_Menu.getRowCount()==0)	// 메뉴 예상식수
	{// 생성
		fsp_addSingle(this,"fm/fmm:FMM00210E_I002");
	}
	else
	{// 업데이트 예상식수
		fsp_addSingle(this,"fm/fmm:FMM00210E_U002");
	}
	fsp_callService(this,"","",
					"",
					"",
					arg,
					"",
					"",
					true);
	btn_MenuIns.userdata=0;					
}


///////////////////////////////////////////////////    
//레시피명 Row추가및 검색로직 시작
///////////////////////////////////////////////////  
function cbo_RecipeNM_ontextchanged(obj:Combo, e:TextChangedEventInfo)
{
	obj.userdata   = e.posttext;
	obj.userchange = "1";
}

function cbo_RecipeNM_onkillfocus(obj:Combo, e:KillFocusEventInfo)
{
	var strValue,nFRow,objDs,strDataColumn;
	
	strValue 		= obj.userdata;
	objDs			= eval(obj.innerdataset);
	strDataColumn	= obj.datacolumn;
	
	if (gfn_length(strValue) > 0) {
		nFRow = objDs.findRow(strDataColumn,strValue);
		
		if (nFRow == -1)
		{
			var nRow = objDs.addRow();
			objDs.setColumn(nRow,strDataColumn,strValue);
			obj.value = strValue;
		} else {
			obj.value = strValue;
		}
	} else {
		obj.index 		= 0;
	}
}

function cbo_RecipeNM_onkeydown(obj:Combo, e:KeyEventInfo)
{
	if (e.keycode == 13 && obj.userchange == "1") {
		var strValue,nFRow,objDs,strDataColumn;
		
		strValue 		= obj.userdata;
		objDs			= eval(obj.innerdataset);
		strDataColumn	= obj.datacolumn;
		
		if (gfn_length(strValue)>0) {
			nFRow = objDs.findRow(strDataColumn,strValue);
			
			if (nFRow == -1)
			{
				var nRow = objDs.addRow();
				objDs.setColumn(nRow,strDataColumn,strValue);
				obj.index = nRow;
			} else {
				obj.index = nFRow;
			}
		}
		//화면별 처리 시작
		btn_SubSearch.setFocus();
		btn_SubSearch.click();
		//화면별 처리 끝
		obj.setFocus();
		
	} else if (e.keycode == 38 || e.keycode == 40) {
		if ( obj.isDropdown() ) {
			obj.userchange = "2";
		} else {
			obj.userchange = "1";
		}
	}
}

function cbo_RecipeNM_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	if ( obj.userchange == "2" ) {
		obj.userchange = "0";
		obj.userdata   = e.posttext;
		//화면별 처리 시작
		btn_SubSearch.setFocus();
		btn_SubSearch.click();
		//화면별 처리 끝
		obj.setFocus();
	} else {
		obj.userchange = "1";
		obj.userdata = e.posttext;
	}
}
///////////////////////////////////////////////////    
//레시피명 Row추가및 검색로직 끝
///////////////////////////////////////////////////    


function cbo_RecipeType_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	if(e.postindex==0)
	{
		ds_CookClass.filter("");
	}
	else
	{
		ds_CookClass.filter("gfn_length(gfn_trim(SET1))==0 || SET1=='"+e.postvalue+"'");
	}
}

function common_OnKeyDown(obj, e:KeyEventInfo)
{
	switch(e.keycode)
	{
		/*
		case 13:	// Enter
			switch(obj.id)
			{
				case "cbo_RecipeNM":
					var objDS=object(obj.InnerDataSet);
					if(nChar==13)
					{
						if(trim(obj.UserData).length() != 0 )
						{
							if(objDS.FindRow("NM",trim(obj.UserData))==-1)
							{
								objDS.AddRow();
								objDS.SetColumn(objDS.row,"NM",trim(obj.UserData));
								//div_Reci.cbo_RecipeNM.Value=trim(div_Reci.cbo_RecipeNM.UserData);
								var v_index=objDS.FindRow("NM",obj.UserData);
								obj.Index=v_index;
								sleep(100);
							}
						}
						btn_SubSearch.Click();
						obj.UserData="";
					}
					break;
				default :
					break;
			}
			var v_nComp=GetNextComponent();
			v_nComp.SetFocus();			
			break;
		*/
		case 46:	// del
			if(GetType(obj)=="Combo")
			{
				obj.index=-1;
			}
			else
			{
				obj.text="";
				obj.value="";
			}
			break;
        default :
            break;
	}
}

function btn_NutReCalc_OnClick(obj:Button, e:ClickEventInfo)
{
	if(!gfn_dsIsUpdated(ds_Item))
	{
		return;
	}
	fn_NutReCalc("BTN_SAVE");
}

function fn_NutReCalc(str)
{
	// 변경된 자재 정보를 저장하고 레시피 목록(식단구성)만 재 조회 한다.
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	var searchsql,insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql;
	var searchsql,insertSql2, updateSql2, deleteSql2;
	var searchsql,insertSql3, updateSql3, deleteSql3;	
	switch(str)
	{								
		case "BTN_SAVE":	// 저장 버튼
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_Menu=ds_Menu:U ds_Item=ds_Item:U";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "";
			insertSql2 	= "";
			// 레시피정보는 업데이트 없음
			// if(ds_Hall_class.GetColumn(0,"HALL_CLASS")=="005")	// 카페테리아 
			// {
				// updateSql1	= "fs/fsm:FSM00060E_U003";
			// }
			// else 												// 그외 
			// {
				// updateSql1	= "fs/fsm:FSM00060E_U004";
			// }
			updateSql2	= "fm/fmm:FMM00210E_U004";			
			deleteSql1	= "";
			deleteSql2	= "";	
			keyIncrement= -1;
			callbackSql	= "";
			
			//tit_addSaveActionInfo(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			fsp_addSave(this, insertSql2, updateSql2, deleteSql2,saveFlagColumn, keySqlName, keyIncrement, callbackSql);			
			http.Sync=true;
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);	
			http.Sync=false;

			fn_NutReCalc("CHK_CONSTRUCT");
			break;					
		case "CHK_CONSTRUCT":	// 식단구성 구축 체크(구축이면 기존 본사업장표준데이타 일괄삭제후 실제 식단 레시피로 일괄대체합니다.
			// grd_RealRecipe.Redraw=false;
			// ds_Menu.Filter("CREAT==1");
			var arg="";
			for(i=0;i<ds_Menu.getRowCount();i++)
			{
				if(ds_Menu.getColumn(i,"CREAT")==1)
				{
					arg		="UPJANG="		+wrapQuote(ds_Menu.getColumn(i,"UPJANG"))
							+" SUBINV_CLASS="	+wrapQuote(ds_Hall_class.getColumn(0,"SUBINV_CLASS"))
							+" RECIPE_CD="	+wrapQuote(ds_Menu.getColumn(i,"RECIPE_CD"))
							+" MENU_CD="	+wrapQuote(ds_Menu.getColumn(i,"MENU_CD"));
							
					fsp_clear(this);
					ds_Chk.clearData();
					fsp_addSearch(this,"fm/fmm:FMM00210E_S012");
					http.Sync=true;
					fsp_callService(this,"","","","ds_Chk=ds_Chk",arg,"fn_call_back","",true);
					http.Sync=false;
					// 일괄삭제
					inData		= "";
					outData		= "";
					callBackFnc	= "";
					insertSql1 	= "";
					insertSql2 	= "";
					updateSql1	= "";
					updateSql2	= "";			
					deleteSql1	= "fm/fmm:FMM00210E_D008";
					deleteSql2	= "fm/fmm:FMM00210E_D009";
					deleteSql3	= "fm/fmm:FMM00210E_D010";	
					keyIncrement= -1;
					callbackSql	= "";
					
					fsp_addSingle(this, deleteSql1);
					fsp_addSingle(this, deleteSql2);
					fsp_addSingle(this, deleteSql3);
					
					http.Sync=true;
					fsp_callService(this, "", "", inData, outData, arg, callBackFnc);	
					http.Sync=false;
					
					fsp_clear(this);

					// insert
					inData		= "";
					outData		= "";
					callBackFnc	= "";
					insertSql1 	= "fm/fmm:FMM00210E_I012";
					insertSql2 	= "fm/fmm:FMM00210E_I013";
					insertSql3 	= "fm/fmm:FMM00210E_I014";
					keyIncrement= -1;
					callbackSql	= "";
					fsp_addSingle(this, insertSql1);
					fsp_addSingle(this, insertSql2);
					fsp_addSingle(this, insertSql3);
					http.Sync=true;
					fsp_callService(this, actionName, cmdName, inData, outData, arg, callBackFnc);
					http.Sync=false;
				}
			}
			fn_Menu_Search();
			// ds_Menu.UnFilter();
			// grd_RealRecipe.Redraw=true;
			break;
        default :
            break;
	}				
}

function fn_Menu_Search()
{
	if(tab_main.tabindex!=0 ||
		ds_Menu.getRowCount()==0 )
	{
		return;
	}
	if(btn_MenuIns.userdata==1)
	{
		g_Message("EE","메뉴 정보가 갱신 되었습니다.\n\n저장후 작업하세요.");
		return;
	}

	if(gfn_length(gfn_trim(cbo_DinGbn.value))==0)
	{
		return;
	}
	if(gfn_length(gfn_trim(cbo_CornGbn.value))==0)
	{
		return;
	}
	if(gfn_length(gfn_trim(me_Cnt.value))==0)
	{
		return;
	}

	var arg="";
	
	arg 	=   " MEAL="					+	wrapQuote(gfn_trim(cbo_DinGbn.value))
				+" CORNER="					+	wrapQuote(gfn_trim(cbo_CornGbn.value))
				+" MENU_DATE="				+	wrapQuote(gfn_trim(me_GiveDay.value))
				+" UPJANG="					+	wrapQuote(gfn_trim(fa_UPJANG))
				+" SUBINV_CODE="			+	wrapQuote(gfn_trim(fa_SUBINV_CODE))
				+" SUBINV_CLASS="			+	wrapQuote(gfn_trim(ds_Hall_class.getColumn(0,"SUBINV_CLASS")));
	// 속도문제로 JSP로 변경
	// tit_ClearActionInfo(this);
	// tit_addSearchActionInfo(this,"fm/fmm:FMM00210E_S010");
	// http.Sync=true;
	// tit_CallService(this,"","","","ds_Menu=ds_Menu",arg,"fn_call_back","",true);
	// http.Sync=false;

	// 속도문제로 JSP로 변경

	var OutDS="ds_Menu=ds_Menu";
	ds_Menu.clearData();
	//transaction("ds_Menu","S_FMM::FMM00210V_S010.jsp","",OutDS,arg,"fn_Call_Sms");
	jsp_transaction(this,"FMM00210V_S010","U_svc::" + "fm/fmm/FMM00210V_S010.jsp","",OutDS,arg,"fn_Call_Sms", false, false, true);
}

//function fn_Call_Sms(svcid,cd,errmsg)
function fn_Call_Sms(cd,errmsg)
{
	if(cd==-1)
	{
	}
	else
	{
		var value="식재료율("+Math.round(toNumber(ds_Menu.getSum("RECIPE_COST"))/toNumber(me_danga.value)*100,2)+"%)";
		grd_RealRecipe.setCellProperty("summary",1,"text",value);
		g_Message("02","처리가 완료 되었습니다.");
		return;
	}
}

function ds_Item_CanColumnChange(obj:Dataset, e:DSColChangeEventInfo)
{
	/*
	if(strColumnID=="NEED_QTY" || strColumnID=="EDIBLE_QTY")
	{
		if(toNumber(varNewValue)<=0)
		{
			g_Message("EE","0보다 큰값으로 입력해야 합니다.");
			return false; //	반드시 0보다 큰값으로 입력해야함.		
		}
	}
	*/
}

function grd_RealRecipe_OnMouseOver(obj:Grid, e:GridMouseEventInfo)
{
	if(e.row==-1 && e.cell < 3 )
	{
		grd_RealRecipe.tooltiptext="체크후 저장하시면 사업장 레시피로 구축됩니다.";
	}
	else
	{
		if(e.row>=0 && e.cell==5)
		{
			if(gfn_length(gfn_trim(ds_Menu.getColumn(e.row,"RECIPE_NAME")))>7)
			{
				grd_RealRecipe.tooltiptext=ds_Menu.getColumn(e.row,"RECIPE_NAME");
			}
			else
			{
				grd_RealRecipe.tooltiptext="";
			}
		}else if(e.row>=0 && e.cell==3)
		{
			grd_RealRecipe.tooltiptext="삭제";
		}
		else
		{
			grd_RealRecipe.tooltiptext="";
		}
	}
}

// function fn_GetSalePrice()
// {
	// return me_danga.Value;
	// var value=round(toNumber(ds_Menu.Sum("RECIPE_COST"))/toNumber(me_danga.Value),2);
	// grd_RealRecipe.SetCellProp("summary",1,"Text",value);
// }
//		'식재료율('+decode(fn_GetSalePrice(),0,0,round((SUM('RECIPE_COST')/fn_GetSalePrice())*100,1))+'%)'
function grd_RealRecipe_OnSummClick(obj:Grid, e:GridClickEventInfo)
{
	//trace(e.cell);
}
function fn_Reset()
{
	if( gfn_dsIsUpdated(ds_Menu)==true ||
		gfn_dsIsUpdated(ds_Item)==true )
	{
		if(g_Confirm("02",fn_AlertMsg("028"))==true)
		{
			fn_Pop_Save("BTN_SAVE");
			return;
		}
	}	
	tab_main.tabindex=0;
	ds_Menu.clearData();
	ds_Item.clearData();
}


function div_extend_grd_List_OnMouseOver(obj:Grid, e:GridMouseEventInfo)
{
	if(e.row>=0 && e.cell==2 && ds_List.getColumn(e.row,"DI_MON")==1)
	{
		div_extend.grd_List.tooltiptext="NEW";
	}
	else if(e.row>=0 && e.cell==3 && ds_List.getColumn(e.row,"PHF")=="Y")
	{
		div_extend.grd_List.tooltiptext="Potentially hazardous foods\n(잠재 위해 식품)";
	}
	else if(e.row>=0 && e.cell==5)
	{
		div_extend.grd_List.tooltiptext="과거 제공 내역";
	}
	else
	{
		div_extend.grd_List.tooltiptext="";
	}
}

//가장 최근일자의 식수를 가져오는 함수
function fn_getRecentExpectCnt(upjang, subinvCode, meal, corner, menuDate)
{
	ds_MyCond.clearData();
	ds_MyCond.addRow();
	ds_MyCond.setColumn(0,"UPJANG",upjang);
	ds_MyCond.setColumn(0,"SUBINV_CODE",subinvCode);
	ds_MyCond.setColumn(0,"MEAL",meal);
	ds_MyCond.setColumn(0,"CORNER",corner);
	ds_MyCond.setColumn(0,"MENU_DATE",menuDate);
		
	//Transaction 설정
	var formObj			= this;
	var strSvcID		= "FMM00210E_T001";
	var strURL			= "U_svc::" + "fm/fmm/FMM00210E_T001.jsp";
	var strInDatasets	= "inDs_Cond=ds_MyCond";
	var strOutDatasets	= "ds_RecentCnt=outDs_List";
	var strArgument;	//= "name1=park name2=yongdae";
	var strCallbackFunc	= "fn_MyCallback_Search";
	var isErrorNotCall	= false;
	var isNotShow		= false;	//false 메세지 보여줌 --> sync일때 표현 안됨.
	var isSync			= true;		//true 다실행하고 실행됨.(async)

	//서버호출
	jsp_transaction(formObj, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, isErrorNotCall, isNotShow, isSync);
	
	return ds_RecentCnt.getColumn(0,'EXPECT_MEAL_QTY');
}

//=========================================================================================
// [ PART 5 ]
// Callback Function 정의 
//=========================================================================================
function fn_MyCallback_Search(errCdoe, strErrorMag)
{
	ta_Sql.value = fa_Sql;
	//trace("errCdoe:" + nErrorCode);
	//trace("errMsg:" + strErrorMag);
	//trace("조회완료 되었습니다.");
}

//레시피 구축후 메뉴의 상태값을 사업장으로 변경
function fn_changGubun(upjang, menuCode, recipeCd)
{
	//trace(upjang +"/"+ menuCode +"/"+ recipeCd);

	ds_sCond.clearData();
	ds_sCond.addRow();
	ds_sCond.setColumn(0,"UPJANG",upjang);
	ds_sCond.setColumn(0,"MENU_CODE",menuCode);
	ds_sCond.setColumn(0,"RECIPE_CD",recipeCd);

	// 조회
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMM00210E_T002";
	strURL   = "U_svc::" + "fm/fmm/FMM00210E_T002.jsp";
	// 파라메터 설정
	strArgument  = "";
	// 데이터셋 설정
	strInDatasets  = "ds_Cond=ds_sCond";
	strOutDatasets = "";
	// 콜백함수 지정
	strCallbackFunc = "";
	// 서버 호출
	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
}
// function cbo_RecipeNM_onsetfocus(obj:Combo, e:SetFocusEventInfo)
// {
// 	obj.usercheck = "1";
// 	obj.setSelect();
// }
// 
// function cbo_RecipeNM_oneditclick(obj:Combo,  e:EditClickEventInfo)
// {
// 	if ( obj.usercheck == "1" ) {
// 		obj.usercheck = "0";
// 		obj.setSelect();
// 	}
// 	
// }

function div_extend_st_bar_onclick(obj:Static,  e:ClickEventInfo)
{
	
}
]]></Script>
  </Form>
</FDL>

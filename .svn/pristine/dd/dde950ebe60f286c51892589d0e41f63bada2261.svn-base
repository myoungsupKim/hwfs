<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="EquipmentRequest" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="전산장비등록" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 82" anchor="left top right"/>
        <Grid id="grd_list" taborder="0" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 0 102 466 467" anchor="left top right" binddataset="ds_list" selecttype="row" oncellclick="grd_list_oncellclick" onkeyup="grd_list_onkeyup">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="22"/>
                <Column size="22"/>
                <Column size="82"/>
                <Column size="72"/>
                <Column size="72"/>
                <Column size="58"/>
                <Column size="0"/>
                <Column size="102"/>
                <Column size="0"/>
                <Column size="55"/>
                <Column size="0"/>
                <Column size="70"/>
                <Column size="0"/>
                <Column size="70"/>
                <Column size="0"/>
                <Column size="69"/>
                <Column size="0"/>
                <Column size="69"/>
                <Column size="69"/>
                <Column size="82"/>
                <Column size="99"/>
                <Column size="73"/>
                <Column size="87"/>
                <Column size="83"/>
                <Column size="83"/>
                <Column size="83"/>
                <Column size="83"/>
                <Column size="83"/>
                <Column size="83"/>
                <Column size="90"/>
                <Column size="105"/>
                <Column size="83"/>
                <Column size="104"/>
                <Column size="83"/>
                <Column size="83"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
              </Columns>
              <Rows>
                <Row size="30" band="head"/>
                <Row size="23"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel" taborder="undefined"/>
                <Cell col="1" displaytype="checkbox" edittype="checkbox" text="expr:0" taborder="undefined"/>
                <Cell col="2" text="관리번호"/>
                <Cell col="3" class="grd_WF_Essential" text="장비상태"/>
                <Cell col="4" class="grd_WF_Essential" text="장비유형"/>
                <Cell col="5" text="구입유형"/>
                <Cell col="6" text="구입유형설명"/>
                <Cell col="7" text="모델명"/>
                <Cell col="8" text="모델명설명"/>
                <Cell col="9" text="OS유형"/>
                <Cell col="10" text="OS유형설명"/>
                <Cell col="11" text="CPU유형"/>
                <Cell col="12" text="CPU유형설명"/>
                <Cell col="13" text="메모리유형"/>
                <Cell col="14" text="메모리유형설명"/>
                <Cell col="15" text="제조사"/>
                <Cell col="16" text="제조사설명"/>
                <Cell col="17" text="화면사이즈"/>
                <Cell col="18" text="HDD유형"/>
                <Cell col="19" text="제조년월"/>
                <Cell col="20" text="시리얼번호"/>
                <Cell col="21" text="구입일자"/>
                <Cell col="22" text="구입금액"/>
                <Cell col="23" text="내용연수"/>
                <Cell col="24" text="등록일자"/>
                <Cell col="25" text="등록자"/>
                <Cell col="26" text="귀속업장"/>
                <Cell col="27" text="귀속사용자"/>
                <Cell col="28" text="기타사항"/>
                <Cell col="29" text="폐기/매각일자"/>
                <Cell col="30" text="폐기/매각등록자"/>
                <Cell col="31" text="매각금액"/>
                <Cell col="32" text="폐기/매각사항"/>
                <Cell col="33" text="최종수정자"/>
                <Cell col="34" text="최종수정일자"/>
                <Cell col="35" text="등록자사번"/>
                <Cell col="36" text="귀속업장코드"/>
                <Cell col="37" text="귀속사용자사번"/>
                <Cell col="38" text="폐기/매각등록자사번"/>
                <Cell col="39" text="출력횟수"/>
                <Cell col="40" text="첨부파일명"/>
                <Cell col="41" text="서버파일명"/>
                <Cell col="42" text="파일존재여부"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                <Cell col="2" displaytype="normal" edittype="none" style="align:center middle;background: ;" text="bind:eqNo"/>
                <Cell col="3" displaytype="combo" edittype="none" style="align:center middle;background: ;" text="bind:statCd" combodataset="ds_amsStatCd" combocodecol="code" combodatacol="codeName"/>
                <Cell col="4" displaytype="combo" edittype="none" style="align:left middle;background: ;" text="bind:comeqType" combodataset="ds_amsComeqType" combocodecol="code" combodatacol="codeName"/>
                <Cell col="5" displaytype="combo" edittype="none" style="align:left middle;background: ;" text="bind:purchaseType" combodataset="ds_amsPurchaseType" combocodecol="code" combodatacol="codeName"/>
                <Cell col="6" displaytype="combo" edittype="none" style="align:center middle;background: ;" text="bind:purchaseDesc"/>
                <Cell col="7" displaytype="combo" edittype="none" style="align:left middle;background: ;" text="bind:modelNm" combodataset="ds_amsModelNm" combocodecol="code" combodatacol="codeName"/>
                <Cell col="8" displaytype="normal" edittype="none" style="align:left middle;background: ;" text="bind:modelDesc"/>
                <Cell col="9" displaytype="combo" edittype="none" style="align:left middle;background: ;" text="bind:osType" combodataset="ds_amsOsType" combocodecol="code" combodatacol="codeName"/>
                <Cell col="10" displaytype="normal" edittype="none" style="align:left middle;background: ;" text="bind:osDesc"/>
                <Cell col="11" displaytype="combo" edittype="none" style="align:left middle;background: ;" text="bind:cpuType" combodataset="ds_amsCpuType" combocodecol="code" combodatacol="codeName"/>
                <Cell col="12" displaytype="normal" edittype="none" style="align:left middle;background: ;" text="bind:cpuDesc"/>
                <Cell col="13" displaytype="combo" edittype="none" style="align:left middle;background: ;" text="bind:memType" combodataset="ds_amsMemType" combocodecol="code" combodatacol="codeName"/>
                <Cell col="14" displaytype="normal" edittype="none" style="align:center middle;background: ;" text="bind:memDesc"/>
                <Cell col="15" displaytype="combo" edittype="none" style="align:left middle;background: ;" text="bind:madComp" combodataset="ds_amsMadComp" combocodecol="code" combodatacol="codeName"/>
                <Cell col="16" displaytype="normal" edittype="none" style="align:center middle;background: ;" text="bind:madCompDesc"/>
                <Cell col="17" displaytype="combo" edittype="none" style="align:left middle;background: ;" text="bind:dispType" combodataset="ds_amsDispType" combocodecol="code" combodatacol="codeName"/>
                <Cell col="18" displaytype="combo" edittype="none" style="align:left middle;background: ;" text="bind:hddType" combodataset="ds_amsHddType" combocodecol="code" combodatacol="codeName"/>
                <Cell col="19" displaytype="normal" edittype="mask" style="align:center middle;background: ;" text="bind:madYmd" mask="####-##" maskchar="_"/>
                <Cell col="20" displaytype="normal" edittype="none" style="align:left middle;background: ;" text="bind:serialNo"/>
                <Cell col="21" displaytype="date" edittype="none" style="align:center middle;background: ;" text="bind:purchaseDt"/>
                <Cell col="22" displaytype="number" edittype="none" style="align:right middle;background: ;" text="bind:purchaseAmt" mask="@,@@@"/>
                <Cell col="23" displaytype="normal" edittype="none" style="align:center middle;background: ;" text="bind:serviceLife"/>
                <Cell col="24" displaytype="date" edittype="none" style="align:center middle;background: ;" text="bind:inputDt"/>
                <Cell col="25" displaytype="normal" edittype="none" style="align:center middle;background: ;" text="bind:inputSabunNm"/>
                <Cell col="26" displaytype="normal" edittype="none" style="align:left middle;background: ;" text="bind:attrUpjangNm"/>
                <Cell col="27" displaytype="normal" edittype="none" style="align:center middle;background: ;" text="bind:attrSabunNm"/>
                <Cell col="28" displaytype="normal" edittype="none" style="align:left middle;background: ;" text="bind:etcNote"/>
                <Cell col="29" displaytype="date" edittype="none" style="align:center middle;background: ;" text="bind:outDt"/>
                <Cell col="30" displaytype="normal" edittype="none" style="align:center middle;background: ;" text="bind:outSabunNm"/>
                <Cell col="31" displaytype="number" edittype="none" style="align:right middle;background: ;" text="bind:saleAmt" mask="@,@@@"/>
                <Cell col="32" displaytype="normal" edittype="none" style="align:left middle;background: ;" text="bind:outNote"/>
                <Cell col="33" displaytype="normal" edittype="none" style="align:center middle;background: ;" text="bind:uuser"/>
                <Cell col="34" displaytype="date" edittype="none" style="align:center middle;background: ;" text="bind:udate"/>
                <Cell col="35" displaytype="normal" edittype="none" style="align:center middle;" text="bind:inputSabun"/>
                <Cell col="36" displaytype="normal" edittype="none" style="align:center middle;" text="bind:attrUpjang"/>
                <Cell col="37" displaytype="normal" edittype="none" style="align:center middle;" text="bind:attrSabun"/>
                <Cell col="38" displaytype="normal" edittype="none" style="align:center middle;" text="bind:outSabun"/>
                <Cell col="39" displaytype="number" edittype="none" style="align:right middle;" text="bind:prtCnt" mask="@,@@@"/>
                <Cell col="40" displaytype="normal" edittype="none" style="align:center middle;" text="bind:appendFilenm"/>
                <Cell col="41" displaytype="normal" edittype="none" style="align:center middle;" text="bind:serverFilenm"/>
                <Cell col="42" displaytype="normal" edittype="none" style="align:center middle;" text="bind:fileExists"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="1" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static22" text="장비목록" class="sta_WF_Title01" position="absolute 0 84 450 102" anchor="left top"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 1290 71 1740 84" anchor="left top"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 97 450 102" anchor="left top"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 488 40" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 93 71" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 257 40 287 61" anchor="left top"/>
        <Static id="Static00" text="장비상태" class="sta_WFSA_label" position="absolute 287 58 347 79" anchor="left top"/>
        <Static id="Static01" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 345 42 355 63" anchor="left top"/>
        <Combo id="cbo_searchstatCd" taborder="23" position="absolute 355 58 424 79" index="-1"/>
        <Static id="Static02" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 425 39 435 60" anchor="left top"/>
        <Static id="Static03" text="장비유형" class="sta_WFSA_label" position="absolute 436 58 496 79" anchor="left top"/>
        <Combo id="cbo_searchcomeqType" taborder="24" position="absolute 504 58 577 79" index="-1"/>
        <Static id="Static10" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 495 39 505 60" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" onclick="Static28_onclick" class="Guide01_AreaRed" visible="false" position="absolute 60 40 70 61"/>
        <Static id="Static2" text="등록일" class="sta_WFSA_label" position="absolute 15 56 66 82"/>
        <ObjCalendar id="cal_startDate" anchor="left top" titletext="캘린더" taborder="25" scrollbars="none" position="absolute 70 58 165 79"/>
        <Static id="Static12" text="~" position="absolute 168 61 177 82"/>
        <ObjCalendar id="cal_endDate" anchor="left top" titletext="캘린더" taborder="26" scrollbars="none" position="absolute 180 58 275 79"/>
        <Static id="Static13" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 577 39 587 60" anchor="left top"/>
        <Static id="Static14" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 647 39 657 60" anchor="left top"/>
        <Static id="Static17" text="구입유형" class="sta_WFSA_label" position="absolute 588 58 648 79" anchor="left top"/>
        <Combo id="cbo_searchpurchaseType" taborder="27" position="absolute 656 58 729 79"/>
        <Static id="Static18" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 724 39 734 60" anchor="left top"/>
        <Static id="Static19" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 794 39 804 60" anchor="left top"/>
        <Static id="Static20" text="관리번호" class="sta_WFSA_label" position="absolute 735 58 795 79" anchor="left top"/>
        <Edit id="edt_searcheqno" taborder="28" inputtype="number" maxlength="13" onkeydown="edt_search_onkeydown" position="absolute 803 57 910 78"/>
        <Static id="Static32" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 466 71 477 467"/>
        <Static id="Static93" class="sta_WFDA_Labelbg" position="absolute 476 206 1238 233" anchor="top right"/>
        <Static id="Static29" text="등록정보" class="sta_WF_Title01" position="absolute 470 83 920 101" anchor="top right"/>
        <Static id="Static30" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 1760 70 2010 83" anchor="left top"/>
        <Static id="Static31" text="글자기준간격 h07" class="Guide01_AreaRed" visible="false" position="absolute 470 95 720 102" anchor="left top"/>
        <Static id="Static34" class="sta_WFDA_Labelbg" position="absolute 476 102 1238 129" anchor="top right"/>
        <Static id="Static33" text="장비관리번호" class="sta_WFDA_Label01" position="absolute 476 102 570 129" anchor="top right"/>
        <Edit id="edt_eqNo" taborder="29" readonly="true" position="absolute 572 105 720 126" anchor="top right" style="background:#ecececff;align:center middle;" enable="true"/>
        <Static id="Static36" text="장비유형" class="sta_WFDA_Label01" position="absolute 952 102 1046 129" anchor="top right" style="align:left middle;"/>
        <Static id="Static37" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 873 97 1237 102" anchor="top right"/>
        <Static id="Static38" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1153 71 1237 77" anchor="top right"/>
        <Static id="Static41" class="sta_WFDA_Labelbg" position="absolute 476 180 1238 207" anchor="top right"/>
        <Static id="Static42" text="모델명" class="sta_WFDA_Label01" position="absolute 476 180 570 207" anchor="top right"/>
        <Static id="Static43" text="OS유형" class="sta_WFDA_Label01" position="absolute 476 206 570 233" anchor="top right"/>
        <Combo id="cbo_statCd" taborder="33" position="absolute 815 105 949 126" anchor="top right" innerdataset="@ds_amsStatCd" codecolumn="code" datacolumn="codeName" enable="true" class="cmb_WF_Essential" readonly="true"/>
        <Static id="Static51" class="sta_WFDA_Labelbg" position="absolute 476 232 1238 259" anchor="top right"/>
        <Static id="Static52" text="CPU유형" class="sta_WFDA_Label01" position="absolute 476 232 570 259" anchor="top right"/>
        <Static id="Static53" class="sta_WFDA_Labelbg" position="absolute 476 258 1238 285" anchor="top right"/>
        <Static id="Static57" class="sta_WFDA_Labelbg" position="absolute 476 154 1238 181" anchor="top right"/>
        <Static id="Static58" text="제조사" class="sta_WFDA_Label01" position="absolute 476 154 570 181" anchor="top right"/>
        <Static id="Static62" class="sta_WFDA_Labelbg" position="absolute 476 284 1238 311" anchor="top right"/>
        <Static id="Static69" class="sta_WFDA_Labelbg" position="absolute 476 336 1238 363" anchor="top right"/>
        <Static id="Static76" class="sta_WFDA_Labelbg" position="absolute 476 128 1238 155" anchor="top right"/>
        <Static id="Static68" text="구입유형" class="sta_WFDA_Label01" position="absolute 476 128 570 155" anchor="top right"/>
        <Static id="Static21" text="구입유형세부" class="sta_WFDA_Label01" position="absolute 688 128 782 155" anchor="top right"/>
        <Static id="Static99" class="sta_WFDA_Labelbg" position="absolute 476 310 1238 337" anchor="top right"/>
        <Static id="Static35" text="장비상태" class="sta_WFDA_Label01" position="absolute 726 102 813 129" anchor="top right" style="align:left middle;"/>
        <Combo id="cbo_comeqType" taborder="66" innerdataset="@ds_amsComeqType" codecolumn="code" datacolumn="codeName" position="absolute 1048 105 1234 126" anchor="top right" class="cmb_WF_Essential"/>
        <Combo id="cbo_purchaseType" taborder="67" innerdataset="@ds_amsPurchaseType" codecolumn="code" datacolumn="codeName" position="absolute 572 131 687 152" anchor="top right"/>
        <Edit id="edt_purchaseDesc" taborder="68" position="absolute 785 131 1235 152" anchor="top right" imemode="hangul"/>
        <Combo id="cbo_modelNm" taborder="69" innerdataset="@ds_amsModelNm" codecolumn="code" datacolumn="codeName" position="absolute 572 183 687 204" anchor="top right"/>
        <Static id="Static26" text="모델명세부" class="sta_WFDA_Label01" position="absolute 688 180 782 207" anchor="top right"/>
        <Edit id="edt_modelDesc" taborder="70" position="absolute 785 183 1235 204" anchor="top right" imemode="alpha" inputmode="normal"/>
        <Combo id="cbo_osType" taborder="71" innerdataset="@ds_amsOsType" codecolumn="code" datacolumn="codeName" position="absolute 572 209 687 230" anchor="top right"/>
        <Static id="Static27" text="OS세부" class="sta_WFDA_Label01" position="absolute 688 206 782 233" anchor="top right"/>
        <Edit id="edt_osDesc" taborder="72" position="absolute 785 209 1235 230" anchor="top right" imemode="hangul"/>
        <Combo id="cbo_cpuType" taborder="73" innerdataset="@ds_amsCpuType" codecolumn="code" datacolumn="codeName" position="absolute 572 235 687 256" anchor="top right"/>
        <Static id="Static28" text="CPU세부" class="sta_WFDA_Label01" position="absolute 688 232 782 259" anchor="top right"/>
        <Edit id="edt_cpuDesc" taborder="74" position="absolute 785 235 1235 256" anchor="top right" imemode="hangul"/>
        <Combo id="cbo_memType" taborder="75" innerdataset="@ds_amsMemType" codecolumn="code" datacolumn="codeName" position="absolute 572 287 687 308" anchor="top right"/>
        <Static id="Static39" text="메모리세부" class="sta_WFDA_Label01" position="absolute 688 284 782 311" anchor="top right"/>
        <Edit id="edt_memDesc" taborder="76" position="absolute 785 287 1235 308" anchor="top right" imemode="hangul"/>
        <Combo id="cbo_madComp" taborder="77" innerdataset="@ds_amsMadComp" codecolumn="code" datacolumn="codeName" position="absolute 572 157 687 178" anchor="top right"/>
        <Static id="Static40" text="제조사세부" class="sta_WFDA_Label01" position="absolute 688 154 782 181" anchor="top right"/>
        <Edit id="edt_madCompDesc" taborder="78" position="absolute 785 157 1235 178" anchor="top right" imemode="hangul"/>
        <Static id="Static23" text="시리얼번호" class="sta_WFDA_Label01" position="absolute 688 310 782 337" anchor="top right"/>
        <Edit id="edt_serialNo" taborder="79" position="absolute 785 313 1235 334" anchor="top right" class="edt_WF_Essential" imemode="alpha" inputmode="normal"/>
        <Static id="Static24" class="sta_WFDA_Labelbg" position="absolute 476 388 1238 415" anchor="top right"/>
        <Static id="Static25" class="sta_WFDA_Labelbg" position="absolute 476 362 1238 389" anchor="top right"/>
        <Static id="Static44" text="구입일자" class="sta_WFDA_Label01" position="absolute 476 336 570 363" anchor="top right"/>
        <ObjCalendar id="cal_purchaseDt" anchor="top right" titletext="캘린더" taborder="80" text="ObjCalendar00" scrollbars="none" position="absolute 572 339 684 360"/>
        <Static id="Static45" text="구입금액" class="sta_WFDA_Label01" position="absolute 688 336 782 363" anchor="top right"/>
        <MaskEdit id="edt_purchaseAmt" taborder="81" mask="#,##0" autoselect="true" position="absolute 785 339 899 360" style="background:#ffffffff;border:1 solid #aaaaaaff ;" inputtype="number" maxlength="10" anchor="top right"/>
        <Static id="Static46" class="Guide01_AreaRed" visible="false" position="absolute 900 338 904 359" anchor="top right"/>
        <Static id="Static64" text="원" position="absolute 904 343 930 356" anchor="top right"/>
        <Static id="Static47" text="내용연수" class="sta_WFDA_Label01" position="absolute 936 336 1030 363" anchor="top right"/>
        <Static id="Static49" class="Guide01_AreaRed" visible="false" position="absolute 1127 338 1131 359" anchor="top right"/>
        <Static id="Static50" text="년" position="absolute 1131 343 1157 356" anchor="top right"/>
        <MaskEdit id="edt_serviceLife" taborder="82" mask="#,##0" autoselect="true" position="absolute 1032 339 1125 360" anchor="top right" style="background:#ffffffff;border:1 solid #aaaaaaff ;" inputtype="number" maxlength="2"/>
        <Static id="Static48" text="등록일자" class="sta_WFDA_Label01" position="absolute 838 362 932 389" anchor="top right"/>
        <ObjCalendar id="cal_inputDt" anchor="top right" titletext="캘린더" taborder="83" text="ObjCalendar00" scrollbars="none" position="absolute 935 365 1047 386" enable="false"/>
        <Static id="Static55" text="등록자" class="sta_WFDA_Label01" position="absolute 1050 362 1144 389" anchor="top right"/>
        <Edit id="edt_inputSabunNm" taborder="84" position="absolute 1146 365 1234 386" anchor="top right" enable="true" readonly="true" style="background:#ecececff; :disabled {background:#ecececff;}"/>
        <Static id="Static56" text="귀속업장" class="sta_WFDA_Label01" position="absolute 476 388 570 415" anchor="top right"/>
        <Static id="Static59" text="귀속사용자" class="sta_WFDA_Label01" position="absolute 785 388 879 415" anchor="top right"/>
        <Static id="Static60" class="sta_WFDA_Labelbg" position="absolute 476 414 1238 441" anchor="top right"/>
        <Static id="Static61" class="sta_WFDA_Labelbg" position="absolute 551 440 1237 467" anchor="top right"/>
        <Static id="Static63" text="기타사항" class="sta_WFDA_Label01" position="absolute 476 362 570 389" anchor="top right"/>
        <Edit id="edt_etcNote" taborder="85" position="absolute 572 365 835 386" anchor="top right" imemode="hangul"/>
        <Edit id="edt_attrUpjangNm" taborder="86" position="absolute 572 391 761 412" anchor="top right" tooltiptext="사업장검색" class="cmb_WF_Essential" onkeydown="edt_attrUpjangNm_onkeydown"/>
        <Button id="btn_attrUpjangPop" taborder="87" position="absolute 761 391 782 412" anchor="top right" class="btn_WF_popSearch" onclick="btn_attrUpjangPop_onclick"/>
        <Edit id="edt_attrSabunNm" taborder="88" position="absolute 1281 391 1470 412" anchor="top right" tooltiptext="사용자검색" class="cmb_WF_Essential" ontextchanged="edt_attrSabunNm_ontextchanged" onkeydown="edt_attrSabunNm_onkeydown" enable="false" enableevent="false" visible="false"/>
        <Button id="btn_attrSabunPop" taborder="89" class="btn_WF_popSearch" position="absolute 1470 391 1491 412" anchor="top right" onclick="btn_attrSabunPop_onclick" enable="false" enableevent="false" visible="false"/>
        <Static id="Static70" text="폐기/매각일자" class="sta_WFDA_Label01" position="absolute 476 414 570 441" anchor="top right"/>
        <ObjCalendar id="cal_outDt" anchor="top right" titletext="캘린더" taborder="90" text="ObjCalendar00" scrollbars="none" position="absolute 572 417 684 438"/>
        <Static id="Static72" text="폐기/매각자" class="sta_WFDA_Label01" position="absolute 688 414 782 441" anchor="top right"/>
        <Edit id="edt_outSabunNm" taborder="91" enable="true" position="absolute 785 417 929 438" anchor="top right" readonly="true" style="background:#ecececff;"/>
        <Static id="Static73" text="폐기/매각사항" class="sta_WFDA_Label01" position="absolute 476 440 570 467" anchor="top right"/>
        <Edit id="edt_outNote" taborder="92" position="absolute 572 443 850 464" anchor="top right" imemode="hangul"/>
        <Static id="Static74" class="Guide01_AreaRed" visible="false" position="absolute 1143 416 1147 437" anchor="top right"/>
        <Static id="Static75" text="원" position="absolute 1147 421 1173 434" anchor="top right"/>
        <MaskEdit id="edt_saleAmt" taborder="93" mask="#,##0" autoselect="true" position="absolute 1028 417 1142 438" anchor="top right" style="background:#ffffffff;border:1 solid #aaaaaaff ;" inputtype="number" maxlength="10"/>
        <Static id="Static77" text="매각금액" class="sta_WFDA_Label01" position="absolute 931 414 1025 441" anchor="top right"/>
        <Static id="Static66" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 487 450 492" anchor="left top"/>
        <Static id="Static67" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 455 450 470" anchor="left top"/>
        <Static id="Static78" text="전산장비이력" class="sta_WF_Title01" position="absolute 0 474 450 492" anchor="left top"/>
        <Grid id="grd_hist" taborder="94" binddataset="ds_hist" autoenter="select" useinputpanel="false" cellsizingtype="col" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" onkeyup="grd_testArticleList_onkeyup" oncellclick="grd_testArticleList_oncellclick" onheadclick="grd_testArticleList_onheadclick" oncelldblclick="grd_testArticleList_oncelldblclick" onenterdown="grd_testArticleList_onenterdown" onexpanddown="grd_testArticleList_onexpanddown" position="absolute 0 492 847 710" anchor="all">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="44"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="112"/>
                <Column size="61"/>
                <Column size="59"/>
                <Column size="400"/>
                <Column size="400"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel" taborder="undefined"/>
                <Cell col="1" text="관리번호"/>
                <Cell col="2" text="시퀀스번호"/>
                <Cell col="3" text="변경일시"/>
                <Cell col="4" text="변경자"/>
                <Cell col="5" text="변경구분"/>
                <Cell col="6" text="변경前데이터"/>
                <Cell col="7" text="변경後데이터"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" displaytype="normal" edittype="none" text="bind:eqNo"/>
                <Cell col="2" displaytype="normal" edittype="none" text="bind:seq"/>
                <Cell col="3" displaytype="normal" edittype="none" style="align:center middle;background: ;" text="bind:chgDt"/>
                <Cell col="4" displaytype="normal" edittype="none" style="align:left middle;" text="bind:chgSabunNm"/>
                <Cell col="5" displaytype="normal" edittype="none" style="align:left middle;" text="bind:chgGubun"/>
                <Cell col="6" displaytype="normal" edittype="none" style="align:left middle;" text="bind:chgBefore"/>
                <Cell col="7" displaytype="normal" edittype="none" style="align:left middle;" text="bind:chgAfter"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static79" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 849 463 860 710"/>
        <Static id="Static80" text="이미지정보" class="sta_WF_Title01" position="absolute 860 446 950 464" anchor="top right"/>
        <Static id="Static81" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 860 459 942 464" anchor="top right"/>
        <Static id="Static82" class="sta_WFDA_Labelbg" position="absolute 860 464 1238 491" anchor="top right"/>
        <Static id="Static83" text="이미지파일명" class="sta_WFDA_Label01" position="absolute 860 464 954 491" anchor="top right"/>
        <Edit id="edt_appendFilenm" taborder="95" readonly="true" position="absolute 956 467 1235 488" anchor="top right" style="background:#ecececff;"/>
        <Static id="Static84" class="sta_WFDA_Labelbg" position="absolute 860 490 1238 713" anchor="top right"/>
        <Static id="Static85" text="이미지보기" class="sta_WFDA_Label01" position="absolute 860 490 954 710" anchor="top right"/>
        <ImageViewer id="img_viewer" taborder="96" stretch="fixaspectratio" class="img_WF_NoImage" position="absolute 956 493 1235 710" anchor="top right" style="border:1 solid #808080ff ;" moveX="0" moveY="0" resizeX="100" resizeY="100"/>
        <Static id="Static86" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 1065 459 1238 464" anchor="top right"/>
        <Button id="btn_attachFile" taborder="97" text="이미지첨부" class="btn_WF_Function" position="absolute 1173 441 1238 461" anchor="top right" onclick="btn_attachFile_onclick"/>
        <Static id="Static87" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1065 441 1246 446" anchor="top right"/>
        <Static id="Static88" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 860 441 942 446" anchor="top right"/>
        <Button id="btn_deleteFile" taborder="98" text="이미지삭제" class="btn_WF_Function" position="absolute 1105 441 1170 461" anchor="top right" onclick="btn_deleteFile_onclick"/>
        <Button id="btn_as" taborder="99" text="AS관리" class="btn_WF_Function" position="absolute 1165 77 1237 99" anchor="top right" onclick="btn_as_onclick"/>
        <MaskEdit id="me_madYmd" taborder="100" type="string" mask="####-##" onsetfocus="g_Date_OnFocus" onkillfocus="g_Month_OnKillFocus" oneditclick="g_Date_OnFocus" position="absolute 572 313 665 334" style="align:center middle;" anchor="top right"/>
        <Button id="btn_Date" taborder="101" tabstop="false" onclick="g_CalButton_OnClick" position="absolute 666 313 687 334" userdata="me_madYmd" class="btn_WF_popSearchEssential" anchor="top right"/>
        <Static id="Static54" text="메모리유형" class="sta_WFDA_Label01" position="absolute 476 284 570 311" anchor="top right"/>
        <Static id="Static65" text="제조년월" class="sta_WFDA_Label01" position="absolute 476 310 570 337" anchor="top right"/>
        <Static id="Static89" text="화면사이즈" class="sta_WFDA_Label01" position="absolute 476 258 570 285" anchor="top right"/>
        <Combo id="cbo_dispType" taborder="102" innerdataset="@ds_amsDispType" codecolumn="code" datacolumn="codeName" position="absolute 572 261 687 282" anchor="top right"/>
        <Static id="Static90" text="HDD유형" class="sta_WFDA_Label01" position="absolute 688 258 782 285" anchor="top right"/>
        <Combo id="cbo_hddType" taborder="103" innerdataset="@ds_amsHddType" codecolumn="code" datacolumn="codeName" position="absolute 785 261 900 282" anchor="top right"/>
        <UserSearchComponent id="uc_searchSabun" titletext="사용자 검색용 Component" taborder="104" text="UserSearchComponent00" position="absolute 880 391 1065 412" bindDataset="ds_list" bindSabunColumn="attrSabun" bindNameColumn="attrSabunNm" eventBeforeTrigger="" eventAfterTrigger="" qoUserGroup="" qoUseYn="Y" qoSosok="" qoSosokName="" isMultiChoice="false" anchor="top right"/>
        <CheckBox id="chk_useYn" taborder="105" text="미사용 여부" position="absolute 922 57 1066 77" style="textpadding:1 0 0 5;" visible="false"/>
        <Static id="Static91" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 910 39 920 60" anchor="left top"/>
        <Static id="Static96" text="사업부" class="sta_WFSA_label" position="absolute 15 33 62 54" anchor="left top"/>
        <MuSearchComponent id="cbo_mu" titletext="사업부 선택 Component" taborder="109" onkeydown="cbo_mu_onkeydown" text="MuSearchComponent00" position="absolute 70 33 171 54" bindDataset="" bindMuCdColumn="" appendText="" onItemChangedEvent="fn_muChange"/>
        <Static id="Static97" text="팀" class="sta_WFSA_label" position="absolute 201 33 225 54" anchor="left top"/>
        <TmSearchComponent id="edt_tm" titletext="팀 검색용 Component" taborder="110" text="TmSearchComponent00" position="absolute 229 33 336 54" bindDataset="" bindTmCdColumn="" bindTmNmColumn="" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tmChange" eventBeforeTrigger=""/>
        <Static id="Static98" text="사업장" class="sta_WFSA_label" position="absolute 366 33 413 54" anchor="left top"/>
        <UpjangSearchComponent id="edt_upjang" titletext="업장 검색용 Component" taborder="111" text="UpjangSearchComponent00" position="absolute 421 33 544 54" bindDataset="" bindUpjangCodeColumn="" bindUpjangNameColumn="" eventBeforeTrigger="" eventAfterTrigger="fn_upjangChange" roleSetId=""/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item1" compid="cbo_searchstatCd" propid="value" datasetid="ds_search" columnid="statCd"/>
      <BindItem id="item2" compid="cbo_searchcomeqType" propid="value" datasetid="ds_search" columnid="comeqType"/>
      <BindItem id="item3" compid="cbo_searchpurchaseType" propid="value" datasetid="ds_search" columnid="purchaseType"/>
      <BindItem id="item4" compid="edt_searcheqno" propid="value" datasetid="ds_search" columnid="eqNo"/>
      <BindItem id="item5" compid="edt_eqNo" propid="value" datasetid="ds_list" columnid="eqNo"/>
      <BindItem id="item6" compid="cbo_statCd" propid="value" datasetid="ds_list" columnid="statCd"/>
      <BindItem id="item7" compid="cbo_purchaseType" propid="value" datasetid="ds_list" columnid="purchaseType"/>
      <BindItem id="item8" compid="edt_purchaseDesc" propid="value" datasetid="ds_list" columnid="purchaseDesc"/>
      <BindItem id="item9" compid="cbo_comeqType" propid="value" datasetid="ds_list" columnid="comeqType"/>
      <BindItem id="item10" compid="cbo_modelNm" propid="value" datasetid="ds_list" columnid="modelNm"/>
      <BindItem id="item11" compid="edt_modelDesc" propid="value" datasetid="ds_list" columnid="modelDesc"/>
      <BindItem id="item12" compid="cbo_osType" propid="value" datasetid="ds_list" columnid="osType"/>
      <BindItem id="item13" compid="edt_osDesc" propid="value" datasetid="ds_list" columnid="osDesc"/>
      <BindItem id="item14" compid="cbo_cpuType" propid="value" datasetid="ds_list" columnid="cpuType"/>
      <BindItem id="item15" compid="edt_cpuDesc" propid="value" datasetid="ds_list" columnid="cpuDesc"/>
      <BindItem id="item16" compid="cbo_memType" propid="value" datasetid="ds_list" columnid="memType"/>
      <BindItem id="item17" compid="edt_memDesc" propid="value" datasetid="ds_list" columnid="memDesc"/>
      <BindItem id="item18" compid="cbo_madComp" propid="value" datasetid="ds_list" columnid="madComp"/>
      <BindItem id="item19" compid="edt_madCompDesc" propid="value" datasetid="ds_list" columnid="madCompDesc"/>
      <BindItem id="item21" compid="edt_serialNo" propid="value" datasetid="ds_list" columnid="serialNo"/>
      <BindItem id="item22" compid="cal_purchaseDt" propid="text" datasetid="ds_list" columnid="purchaseDt"/>
      <BindItem id="item23" compid="edt_purchaseAmt" propid="value" datasetid="ds_list" columnid="purchaseAmt"/>
      <BindItem id="item24" compid="edt_serviceLife" propid="value" datasetid="ds_list" columnid="serviceLife"/>
      <BindItem id="item25" compid="cal_inputDt" propid="text" datasetid="ds_list" columnid="inputDt"/>
      <BindItem id="item26" compid="edt_inputSabunNm" propid="value" datasetid="ds_list" columnid="inputSabunNm"/>
      <BindItem id="item27" compid="edt_attrUpjangNm" propid="value" datasetid="ds_list" columnid="attrUpjangNm"/>
      <BindItem id="item28" compid="edt_attrSabunNm" propid="value" datasetid="ds_list" columnid="attrSabunNm"/>
      <BindItem id="item29" compid="edt_etcNote" propid="value" datasetid="ds_list" columnid="etcNote"/>
      <BindItem id="item30" compid="cal_outDt" propid="text" datasetid="ds_list" columnid="outDt"/>
      <BindItem id="item31" compid="edt_outSabunNm" propid="value" datasetid="ds_list" columnid="outSabunNm"/>
      <BindItem id="item32" compid="edt_saleAmt" propid="value" datasetid="ds_list" columnid="saleAmt"/>
      <BindItem id="item33" compid="edt_outNote" propid="value" datasetid="ds_list" columnid="outNote"/>
      <BindItem id="item0" compid="edt_appendFilenm" propid="value" datasetid="ds_list" columnid="appendFilenm"/>
      <BindItem id="item34" compid="img_viewer" propid="image" datasetid="ds_list" columnid="imgFile"/>
      <BindItem id="item20" compid="me_madYmd" propid="value" datasetid="ds_list" columnid="madYmd"/>
      <BindItem id="item35" compid="cbo_dispType" propid="value" datasetid="ds_list" columnid="dispType"/>
      <BindItem id="item36" compid="cbo_hddType" propid="value" datasetid="ds_list" columnid="hddType"/>
    </Bind>
    <Objects>
      <Dataset id="ds_adminList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="Sabun" type="STRING" size="256"/>
          <Column id="Name" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="START_DATE" type="STRING" size="256"/>
          <Column id="END_DATE" type="STRING" size="256"/>
          <Column id="statCd" type="STRING" size="256"/>
          <Column id="comeqType" type="STRING" size="256"/>
          <Column id="purchaseType" type="STRING" size="256"/>
          <Column id="eqNo" type="STRING" size="256"/>
          <Column id="adminYn" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="attrUpjang" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="outletCd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onvaluechanged="ds_list_onvaluechanged">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="eqNo" type="STRING" size="256"/>
          <Column id="statCd" type="STRING" size="256"/>
          <Column id="purchaseType" type="STRING" size="256"/>
          <Column id="purchaseDesc" type="STRING" size="256"/>
          <Column id="comeqType" type="STRING" size="256"/>
          <Column id="modelNm" type="STRING" size="256"/>
          <Column id="modelDesc" type="STRING" size="256"/>
          <Column id="osType" type="STRING" size="256"/>
          <Column id="osDesc" type="STRING" size="256"/>
          <Column id="cpuType" type="STRING" size="256"/>
          <Column id="cpuDesc" type="STRING" size="256"/>
          <Column id="memType" type="STRING" size="256"/>
          <Column id="memDesc" type="STRING" size="256"/>
          <Column id="madComp" type="STRING" size="256"/>
          <Column id="madCompDesc" type="STRING" size="256"/>
          <Column id="dispType" type="STRING" size="256"/>
          <Column id="hddType" type="STRING" size="256"/>
          <Column id="madYmd" type="STRING" size="256"/>
          <Column id="serialNo" type="STRING" size="256"/>
          <Column id="purchaseDt" type="STRING" size="300"/>
          <Column id="purchaseAmt" type="STRING" size="256"/>
          <Column id="serviceLife" type="STRING" size="256"/>
          <Column id="inputDt" type="STRING" size="256"/>
          <Column id="inputSabun" type="STRING" size="256"/>
          <Column id="attrUpjang" type="STRING" size="256"/>
          <Column id="attrSabun" type="STRING" size="256"/>
          <Column id="etcNote" type="STRING" size="256"/>
          <Column id="outDt" type="STRING" size="256"/>
          <Column id="outSabun" type="STRING" size="256"/>
          <Column id="saleAmt" type="STRING" size="256"/>
          <Column id="outNote" type="STRING" size="256"/>
          <Column id="prtCnt" type="STRING" size="256"/>
          <Column id="uuser" type="STRING" size="256"/>
          <Column id="udate" type="STRING" size="256"/>
          <Column id="modifyYn" type="STRING" size="256"/>
          <Column id="inputSabunNm" type="STRING" size="256"/>
          <Column id="attrUpjangNm" type="STRING" size="256"/>
          <Column id="attrSabunNm" type="STRING" size="256"/>
          <Column id="outSabunNm" type="STRING" size="256"/>
          <Column id="appendFilenm" type="STRING" size="256"/>
          <Column id="serverFilenm" type="STRING" size="256"/>
          <Column id="fileExists" type="STRING" size="256"/>
          <Column id="imgFile" type="BLOB" size="256"/>
          <Column id="isUpload" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listValid" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="statCd" type="STRING" size="255"/>
          <Column id="comeqType" type="STRING" size="255"/>
          <Column id="serialNo" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="statCd">title:장비상태,required:true</Col>
            <Col id="comeqType">title:장비유형,required:true</Col>
            <Col id="serialNo">title:시리얼번호,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_amsComeqType" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
          <Column id="set1" type="STRING" size="256"/>
          <Column id="Column1" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_amsCpuType" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
          <Column id="set1" type="STRING" size="256"/>
          <Column id="set2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_amsMadComp" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
          <Column id="set1" type="STRING" size="256"/>
          <Column id="set2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_amsManSabun" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
          <Column id="set1" type="STRING" size="256"/>
          <Column id="set2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_amsMemType" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
          <Column id="set1" type="STRING" size="256"/>
          <Column id="set2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_amsModelNm" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
          <Column id="set1" type="STRING" size="256"/>
          <Column id="set2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_amsOsType" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
          <Column id="set1" type="STRING" size="256"/>
          <Column id="set2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_amsPurchaseType" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
          <Column id="set1" type="STRING" size="256"/>
          <Column id="set2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_amsStatCd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
          <Column id="set1" type="STRING" size="256"/>
          <Column id="set2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_amsDispType" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
          <Column id="set1" type="STRING" size="256"/>
          <Column id="set2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_amsHddType" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
          <Column id="set1" type="STRING" size="256"/>
          <Column id="set2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_hist" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onvaluechanged="ds_list_onvaluechanged">
        <ColumnInfo>
          <Column id="eqNo" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="chgDt" type="STRING" size="256"/>
          <Column id="chgGubun" type="STRING" size="256"/>
          <Column id="chgBefore" type="STRING" size="256"/>
          <Column id="chgAfter" type="STRING" size="256"/>
          <Column id="chgSabunNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_searchHist" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="eqNo" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <FileDialog defaultextention="false" filter="All(*.*)|*.*|" filterindex="0" id="fd"/>
      <Dataset id="ds_barprtList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="Sabun" type="STRING" size="256"/>
          <Column id="Name" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/* 
  화 면 명 : 전산장비 등록
  파 일 명 : EquipmentRegist.xfdl
  기    능 : Design 및 Script Template 

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2018.12.12   김명섭  최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "U_lib::lib_conversionCom.xjs";
include "lib::LimsUtil.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_procCnt = 0; //저장에 대한 처리건수를 저장한다.(AuthMgmtController에서 할당함.)
var bFileUpCheck = false;	// 첨부파일 업로드 체크 여부
var v_admin = "N";
var v_selYn = "N";
var v_barprtYn = "N";
var curDate = gfn_today();
var codeList = "AMS_COMEQ_TYPE,AMS_CPU_TYPE,AMS_MAD_COMP,AMS_MAN_SABUN,AMS_MEM_TYPE,AMS_MODEL_NM,AMS_OS_TYPE,AMS_PURCHASE_TYPE,AMS_STAT_CD,AMS_DISP_TYPE,AMS_HDD_TYPE";

var BATCH_CODE_LIST_FORM = "";  	// 해당 Form
var BATCH_CODE_LIST_DIV = "";   	// 해당 Div Component
var BATCH_CODE_LIST = "";       	// 코드 리스트

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
	
	ds_search.clearData();
	ds_search.addRow();
	// 조회기간 초기화
	cal_startDate.fn_initMonthCal(this, gfn_left(gfn_today(), 6) + '01', '', ds_search, 'START_DATE');
	cal_endDate.fn_initMonthCal(this, gfn_today(), '', ds_search, 'END_DATE');
	ds_search.setColumn(0, "START_DATE", cal_startDate.text);
	ds_search.setColumn(0, "END_DATE", cal_endDate.text);
	ds_search.setColumn(0, "START_DATE", "");
	ds_search.setColumn(0, "END_DATE", "");
	ds_search.setColumn(0, "attrUpjang", g_Upjang);
	
	var rtnParam = gfn_getScreenParams();
	
	if(rtnParam[0] == "조회")
	{
		v_selYn = "Y";
		preSet();
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	SCCombo.bind(this, "ComCode", "cbo_searchstatCd", null, {groupCode:"AMS_STAT_CD", useYn:"Y"}, SCCombo.ALL);				//장비상태
	SCCombo.bind(this, "ComCode", "cbo_searchcomeqType", null, {groupCode:"AMS_COMEQ_TYPE", useYn:"Y"}, SCCombo.ALL);			//장비유형
	SCCombo.bind(this, "ComCode", "cbo_searchpurchaseType", null, {groupCode:"AMS_PURCHASE_TYPE", useYn:"Y"}, SCCombo.ALL);	//구입유형

	//SCCombo.bind(this, "ComCode", "grd_list.statCd", null, {groupCode:"AMS_STAT_CD", useYn:"Y"});
	//SCCombo.bind(this, "ComCode", "grd_list.comeqType", null, {groupCode:"AMS_COMEQ_TYPE", useYn:"Y"});

    cal_purchaseDt.fn_initMonthCal(this, curDate, "fn_calendarCallBack", ds_list, "purchaseDt");	//구입일자
    cal_inputDt.fn_initMonthCal(this, curDate, "fn_calendarCallBack", ds_list, "inputDt");			//등록일자
    cal_outDt.fn_initMonthCal(this, curDate, "fn_calendarCallBack", ds_list, "outDt");				//매각폐기일자
    
	// 공통코드 세팅
	fn_CodeBatchList(this, null, codeList);
	
	ds_search.clearData();
	ds_search.addRow();
	fn_selectAdminUser(); //관리자조회
	fn_selectBarprtUser(); //바코드프린터사용자조회
	
	div_cmnBtn.btn_print.tooltiptext = "지급/재고자산 장비관리번호 바코드를 출력합니다.";
	
	uc_searchSabun.setApplySystemMaster(false);
	uc_searchSabun.setEditable(true);
	
	// 권한설정
    edt_tm.applyAuthLevel(cbo_mu);
	edt_upjang.applyAuthLevel(edt_tm);
	edt_upjang.applyMainUpjang(null);
	
}

function fn_CodeBatchList(thisForm, thisDiv, codeList)
{
        BATCH_CODE_LIST_FORM = thisForm;
        BATCH_CODE_LIST_DIV = thisDiv;
        BATCH_CODE_LIST = codeList;
        
        // DataSet 생성
        var outDsId = "ds_codeList";
        if (thisForm.all[outDsId] != null) thisForm.removeChild(outDsId);
        outDs = new Dataset();
        outDs.id = outDsId;
        outDs.name = outDsId;
        thisForm.addChild(outDsId, outDs);

        var strSvcID    = "selectCodeBatchList";
        var strURL      = "am/ams/equipmentRegist/selectCodeDtlBatchList.xdo";
        var strInDs     = "";
        var strOutDs    = "ds_codeList=ds_codeList";
        var strArg      = "groupCodeList=" + BATCH_CODE_LIST;
        var strCallback = "fn_codeBatchCallback";
        var bAsync      = true;

        gfn_transaction(thisForm, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync, false);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 달력 조회 후 callback function
 *---------------------------------------------------------------------------------------------*/
function fn_calendarCallBack()
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 공통코드 binding 조회 후 callback function
 *---------------------------------------------------------------------------------------------*/
function fn_codeBatchCallback(strSvcID, nErrorCode, strErrorMsg)
{
	if (nErrorCode < 0)
	{
		return;
	}

	switch(strSvcID)
	{
		// 코드 일괄 조회
		case "selectCodeBatchList" :
			var tmpCodeList = BATCH_CODE_LIST.split(",");
			var tmpCamelGroupCode = "";
			var tmpDs = "";
			var tmpCombo = "";
			var tmpObj;
			var exCnt = 0;

			for (var i = 0, iColCnt = tmpCodeList.length; i < iColCnt; i++)
			{
				exCnt = 0;
				ds_codeList.filter("groupCode == '" + tmpCodeList[i] + "'");    // GroupCode로 Filter
				tmpCamelGroupCode = fn_toCamelCase(gfn_trim(tmpCodeList[i]));  // CamelCase 형식으로 변환
				tmpDs = "ds_"+tmpCamelGroupCode;

				tmpObj = BATCH_CODE_LIST_FORM;

				if (BATCH_CODE_LIST_FORM.all[tmpDs] != null)
				{
					tmpDs = eval(tmpDs);
					tmpDs.copyData(ds_codeList, true);  // 필터된 DataSet copy

					tmpCombo = "cbo_"+tmpCamelGroupCode;
					if (tmpObj.all[tmpCombo] != null)
					{
						eval("tmpObj."+tmpCombo).codecolumn = "code";
						eval("tmpObj."+tmpCombo).datacolumn = "codeName";
						eval("tmpObj."+tmpCombo).innerdataset = tmpDs;
					}
				}
			}
			//trace(ds_amsModelNm.saveXML());
			break;
	}
}

function  fn_toCamelCase(strVal)
{
	strVal = strVal.trim().toLowerCase();
	strVal = strVal.replace(/([_]+)([a-zA-Z0-9])/g, function(a, b, c) {
		return c.toUpperCase();
	});
	return strVal;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{
	// v_ds_check 미사용시 변경사항 체크(입력 프로그램일때 변경되는 Dataset 전체 기술)
	if (gfn_dsIsUpdated(ds_list)) 
	{
		// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
        if (!gfn_confirm("confirm.before.movepage")) return false;
    }
    // 조회프로그램에도 Return true; 기술해 주세요!
	return true;
}


/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{	
	//업장 설정
	ds_search.setColumn(0, "muCd",  gfn_nvl(cbo_mu.getMuCode(),""));
	ds_search.setColumn(0, "tmCd",  gfn_nvl(edt_tm.getTmCode(),""));
	ds_search.setColumn(0, "outletCd",  gfn_nvl(edt_upjang.getUpjangCode(),""));
	
	if(chk_useYn.value == true) //사용여부 체크
	{
		ds_search.setColumn(0, "useYn", "N");
	}
	else
	{
		ds_search.setColumn(0, "useYn", "Y");
	}
	
 	// v_ds_check 미사용시 변경사항 체크
 	if (gfn_dsIsUpdated(ds_list)) 
 	{
		// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
 		var retValue = gfn_confirm("confirm.before.search");
 		if (retValue == false) return;
 	}
	
    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_list);

	// Dataset을 초기화한다.
	ds_list.clearData();

	var strSvcID    = "selectList";
    var strURL      = "am/ams/equipmentRegist/selectList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_list=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{
	ds_hist.clearData();
	
	var nRow = ds_list.addRow();
	
	ds_list.setColumn(nRow, "statCd", "I"); //신규입력 장비상태(재고)
	ds_list.setColumn(nRow, "inputDt", curDate);
	ds_list.setColumn(nRow, "inputSabun", gfn_getUserInfo("userid"));
	ds_list.setColumn(nRow, "inputSabunNm", gfn_getUserInfo("nmKor"));
	ds_list.setColumn(nRow, "serviceLife", "8"); //default 8년
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{
	var nRowCnt = ds_list.getRowCount();
	var bIsDeletedRow = false;
	
	//삭제할 행이 있는지 판별한다.
	for(var i=0 ; i<nRowCnt ; i++)
	{
		//신규등록인 경우 삭제 가능(마스터반영데이터는 삭제불가)
		if ((ds_list.getColumn(i, "chk") == 1)) 
		// && (ds_adminList.findRow("sabun",g_EmpNo) != -1)) 
		//&& (ds_list.getRowType(i) == Dataset.ROWTYPE_INSERT))
		{
			bIsDeletedRow = true;
			continue;
		}
	}
	
	//삭제할 행이 없을 시에 메시지를 처리한다.
	if (!bIsDeletedRow)
	{
		gfn_alert("선택된 항목이 없습니다.\n관리자 권한만 삭제 가능합니다.", "삭제할 row");	// 선택된 항목이 없습니다.
		//gfn_alert("선택된 항목이 없습니다.\n마스터에 등록된 데이터는 삭제할 수 없습니다.", "삭제할 row");	// 선택된 항목이 없습니다.
		return;
	}
	
	bIsDeletedRow = false;

	var rtVal = gfn_confirm("confirm.before.delete");	// 선택된 자료를 삭제 하시겠습니까?
	
	if (rtVal == true) 
	{
		grd_list.enableredraw=false;
		
		//선택된 행을 삭제한다.
		for (var i=nRowCnt ; i>=0 ; i--)
		{
			if ((ds_list.getColumn(i, "chk") == 1) && (chk_useYn.value == false))
			// && (ds_list.getRowType(i) == Dataset.ROWTYPE_INSERT))
			{
				ds_list.setColumn(i, "useYn", "N"); //사용유무만 변경 2020.10.30 정보시스템팀 김영욱 요청
				gfn_alert("삭제요청 완료되었습니다.\n저장 시 삭제가 확정됩니다.");
				//ds_list.deleteRow(i);
			}
			else if((ds_list.getColumn(i, "chk") == 1) && (ds_adminList.findRow("sabun",g_EmpNo) != -1) && (chk_useYn.value == true))
			{
				ds_list.deleteRow(i);
			}
		}
		
		grd_list.enableredraw=true;	
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
	//v_ds_check 미사용시 변경사항 체크
 	if (!gfn_dsIsUpdated(ds_list))
 	{
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}
 	
 	//요청구분에 따른 입력 데이터 체크
 	var v_statCd, v_purchaseType, v_purchaseDesc, v_comeqType, v_modelNm, v_modelDesc, v_osType, v_osDesc, v_cpuType, v_cpuDesc, v_memType, v_memDesc;
 	var v_madComp, v_madCompDesc, v_madYmd, v_serialNo, v_purchaseDt, v_purchaseAmt, v_serviceLife;
 	var v_inputDt, v_inputSabun, v_attrUpjang, v_attrSabun, v_etcNote, v_outDt, v_outSabun, v_saleAmt, v_outNote;
 	var v_appendFilenm, v_serverFilenm, _lastDot, _fileExt

	for(var i=0;i<ds_list.rowcount;i++)
	{
		v_statCd = ds_list.getColumn(i,"statCd");
		v_purchaseType = ds_list.getColumn(i,"purchaseType");
		v_purchaseDesc = ds_list.getColumn(i,"purchaseDesc");
		v_comeqType = ds_list.getColumn(i,"comeqType");
		v_modelNm = ds_list.getColumn(i,"modelNm");
		v_modelDesc = ds_list.getColumn(i,"modelDesc");
		v_osType = ds_list.getColumn(i,"osType");
		v_osDesc = ds_list.getColumn(i,"osDesc");
		v_cpuType = ds_list.getColumn(i,"cpuType");
		v_cpuDesc = ds_list.getColumn(i,"cpuDesc");
		v_memType = ds_list.getColumn(i,"memType");
		v_memDesc = ds_list.getColumn(i,"memDesc");
		v_madComp= ds_list.getColumn(i,"madComp");
		v_madCompDesc = ds_list.getColumn(i,"madCompDesc");
		v_madYmd = ds_list.getColumn(i,"madYmd");
		v_serialNo = ds_list.getColumn(i,"serialNo");
		v_purchaseDt = ds_list.getColumn(i,"purchaseDt");
		v_purchaseAmt = ds_list.getColumn(i,"purchaseAmt");
		v_serviceLife = ds_list.getColumn(i,"serviceLife");
		v_inputDt = ds_list.getColumn(i,"inputDt");
		v_inputSabun = ds_list.getColumn(i,"inputSabun");
		v_attrUpjang = ds_list.getColumn(i,"attrUpjang");
		v_attrSabun = ds_list.getColumn(i,"attrSabun");
		v_etcNote = ds_list.getColumn(i,"etcNote");
		v_outDt = ds_list.getColumn(i,"outDt");
		v_outSabun = ds_list.getColumn(i,"outSabun");
		v_saleAmt = ds_list.getColumn(i,"saleAmt");
		v_outNote = ds_list.getColumn(i,"outNote");
		v_appendFilenm = ds_list.getColumn(i,"appendFilenm");
		v_serverFilenm = ds_list.getColumn(i,"serverFilenm");

		//첨부이미지 확장자 체크
		if(v_appendFilenm != "undefined" && v_appendFilenm != null && v_appendFilenm != "")
		{
			_lastDot = v_appendFilenm.lastIndexOf('.');
			if(_lastDot > 0)
			{
				_fileExt = v_appendFilenm.substring(_lastDot+1, v_appendFilenm.length).toLowerCase();
				if(_fileExt != "bmp" && _fileExt != "jpg" && _fileExt != "jpeg" && _fileExt != "gif" && _fileExt != "png")
				{
					gfn_alert(i + 1 + "번째 행 첨부이미지가\n정상적이지 않습니다.");
					return;
				}
			}
			else
			{
				gfn_alert(i + 1 + "번째 행 첨부이미지가\n정상적이지 않습니다.");
				return;
			}
		}
		if(v_serverFilenm != "undefined" && v_serverFilenm != null && v_serverFilenm != "")
		{
			_lastDot = v_serverFilenm.lastIndexOf('.');
			if(_lastDot > 0)
			{
				_fileExt = v_serverFilenm.substring(_lastDot+1, v_serverFilenm.length).toLowerCase();
				if(_fileExt != "bmp" && _fileExt != "jpg" && _fileExt != "jpeg" && _fileExt != "gif" && _fileExt != "png")
				{
					gfn_alert(i + 1 + "번째 행 첨부이미지가\n정상적이지 않습니다.");
					return;
				}
			}
			else
			{
				gfn_alert(i + 1 + "번째 행 첨부이미지가\n정상적이지 않습니다.");
				return;
			}
		}

		//장비유형체크
		if(v_comeqType == "undefined" || v_comeqType == null || v_comeqType == "")
		{
			gfn_alert(i + 1 + "번째 행 장비유형이\n등록되지 않았습니다.");
			return;
		}
		//지급일 경우 귀속업장/사용자 필수
		if(v_statCd == "P")
		{
			//귀속업장체크
			if(v_attrUpjang == "undefined" || v_attrUpjang == null || v_attrUpjang == "")
			{
				gfn_alert(i + 1 + "번째 행 귀속업장이\n등록되지 않았습니다.");
				return;
			}
			//귀속사용자체크
			if(v_attrSabun == "undefined" || v_attrSabun == null || v_attrSabun == "")
			{
				gfn_alert(i + 1 + "번째 행 귀속사용자가\n등록되지 않았습니다.");
				return;
			}
		}
		else
		{
			//폐기
			if(v_statCd == "D" || v_statCd == "S")
			{
				if(v_outSabun == "undefined" || v_outSabun == null || v_outSabun == "")
				{
					gfn_alert(i + 1 + "번째 행 폐기/매각자가\n등록되지 않았습니다.");
					return;
				}
				if(v_outDt == "undefined" || v_outDt == null || v_outDt == "")
				{
					gfn_alert(i + 1 + "번째 행 폐기/매각일자가\n등록되지 않았습니다.");
					return;
				}
			}
			//재고, 폐기, 매각일 경우 귀속업장/사용자 Clear
			//실오픈 후 주석 제거
			//ds_list.setColumn(i, "attrUpjang", "");
			//ds_list.setColumn(i, "attrUpjangNm", "");
			//ds_list.setColumn(i, "attrSabun", "");
			//ds_list.setColumn(i, "attrSabunNm", "");
			//재고일 경우 귀속업장, 사용자 체크(실오픈 후 script 삭제)
			if(v_statCd == "I")
			{
				//귀속업장체크
				if(v_attrUpjang == "undefined" || v_attrUpjang == null || v_attrUpjang == "")
				{
					gfn_alert(i + 1 + "번째 행 귀속업장이\n등록되지 않았습니다.");
					return;
				}
				//귀속사용자체크
				if(v_attrSabun == "undefined" || v_attrSabun == null || v_attrSabun == "")
				{
					gfn_alert(i + 1 + "번째 행 귀속사용자가\n등록되지 않았습니다.");
					return;
				}
			}
		}
	}
	
	// 저장시 Validation Check
	if (gfn_validCheck(grd_list, ds_listValid) == false)	return;
	
	if (! g_Confirm("02", '저장하시겠습니까?!')) return;

    var strSvcID    = "save";
    var strURL      = "am/ams/equipmentRegist/saveList.xdo";
    var strInDs     = "ds_list=ds_list:U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
 //전산장비관리번호 바코드스티커 출력
function fn_print()
{
	var nRowCnt = ds_list.getRowCount();
	var bIsSelectedRow = false;
	
	//출력할 행이 있는지 판별한다.
	for(var i=0 ; i<nRowCnt ; i++)
	{
		if ((ds_list.getColumn(i, "chk") == 1) && (ds_list.getRowType(i) != Dataset.ROWTYPE_INSERT))
		{
			bIsSelectedRow = true;
			continue;
		}
	}
	
	//출력할 행이 없을 시에 메시지를 처리한다.
	if (!bIsSelectedRow)
	{
		gfn_alert("msg.err.grid.noselect", "출력할 row");	// 선택된 항목이 없습니다.
		return;
	}
	
	bIsSelectedRow = false;

	//선택된 행을 출력한다.
	var argEqno = "";

	for(var i=0 ; i<nRowCnt ; i++)
	{
		if (ds_list.getColumn(i, "chk") == 1 && ds_list.getColumn(i, "eqNo") != null && ds_list.getColumn(i, "eqNo") != "" && ds_list.getColumn(i, "eqNo") != "undefined")
		{
			//전산장비관리번호 바코드 출력
			if (ds_list.getRowType(i) != Dataset.ROWTYPE_INSERT)
			{
				//지급,재고자산출력가능
				if(ds_list.getColumn(i, "statCd") == "I" || ds_list.getColumn(i, "statCd") == "P")
				{
					bIsSelectedRow = true;
					argEqno += "'" + ds_list.getColumn(i, "eqNo") + "',";
				}
			}
		}
	}
	
	//출력할 행이 없을 시에 메시지를 처리한다.
	if (!bIsSelectedRow)
	{
		gfn_alert("msg.err.grid.noselect", "출력할 row");	// 선택된 항목이 없습니다.
		return;
	}

	var rtVal = gfn_confirm("선택된 자료를 출력 하시겠습니까?");	// 선택된 자료를 출력 하시겠습니까?
	
	if (rtVal == true) 
	{
		argEqno = argEqno.substring(0, argEqno.length-1);
		
		//레포트에 전달할 파라메터 생성
		var arrParams	= SCReport.newParams ();
		
		//--------------------------------------------------
		//방법1)서버에서 Query에 의해 처리하는 경우 예
		//(필수) 레포트명
		if(v_barprtYn == "N") {
			SCReport.setParams (arrParams, SCReport.RPT_NAME, "/hwfs/am/ams/AmsEqno.ozr");
		}
		else
		{
			SCReport.setParams (arrParams, SCReport.RPT_NAME, "/hwfs/am/ams/AmsEqnoBarprt.ozr");
		}

		//출력 옵션 설정
		//-창 타이틀 (디폴트는 "ReportViewer")
		SCReport.setParams (arrParams, SCReport.RPT_TITLE, "장비관리번호바코드출력");

		//레포트에 맞게 전달되는 개발자 정의 파라미터
		SCReport.setParams (arrParams, "PARAM1", argEqno);
		
		SCReport.viewReport (this, arrParams, false);
		
		//출력횟수저장
		var strSvcID    = "savePrt";
		var strURL      = "am/ams/equipmentRegist/savePrtList.xdo";
		var strInDs     = "ds_list=ds_list:U";
		var strOutDs    = "";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {
		//조회
        case "selectList" :
			//trace(ds_list.saveXML());
			//전산장비이력조회call
			fn_searchHist();
            break;
            
        //관리자조회
        case "selectAdminList" :
			//trace(ds_adminList.saveXML());
			// 관리자 컨트롤 항목 enable
			for(var i=0;i<ds_adminList.rowcount;i++)
			{
				if(ds_adminList.getColumn(i,"sabun") ==  gfn_getUserId())
				{
					v_admin = "Y";
					chk_useYn.visible = true;
					break;
				}
			}
			//관리자가 아닌 경우 로그인 사용자 데이터만 조회 가능
			ds_search.setColumn(0, "adminYn", v_admin);
			
			if(v_admin != "Y")
			{
				cbo_mu.enable = false;
				edt_tm.enable = false;
				edt_upjang.enable = false;
			}
            break;

        case "selectBarprtList" :
			//trace(ds_barprtList.saveXML());
			for(var i=0;i<ds_barprtList.rowcount;i++)
			{
				if(ds_barprtList.getColumn(i,"sabun") ==  gfn_getUserId())
				{
					v_barprtYn = "Y";
					break;
				}
			}
            break;
        
        // 저장
        case "save" :
			gfn_alert("msg.save.success");	// 저장 되었습니다.
			//재조회
			fn_search();
            break;
            
        //삭제
		case "delete" :
			gfn_alert("msg.delete.success"); // 삭제 되었습니다.
			//전산장비이력조회call
			fn_searchHist();
			break;
			
		//조회
        case "selectHist" :
			//trace(ds_hist.saveXML());
			break;

		//출력저장
        case "savePrt" :
			break;
			
    }
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 특정 그룹에 대한 공통코드를 조회한다.
 *---------------------------------------------------------------------------------------------*/
/*----------------------------------------------------------------------------------------------
 * 설명      : 관리자조회
 *---------------------------------------------------------------------------------------------*/
function fn_selectAdminUser()
{
	var strSvcID    = "selectAdminList";
    var strURL      = "am/ams/equipmentRegist/selectAdminList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_adminList=ds_adminList";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync, false);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 라벨바코드프린터사용자조회
 *---------------------------------------------------------------------------------------------*/
function fn_selectBarprtUser()
{
	var strSvcID    = "selectBarprtList";
    var strURL      = "am/ams/equipmentRegist/selectBarprtList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_barprtList=ds_barprtList";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync, false);
}

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/

function grd_list_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	//전산장비이력조회
	fn_searchHist(e.cell);
}

function grd_list_onkeyup(obj:Grid, e:KeyEventInfo)
{
	//전산장비이력조회
	fn_searchHist(e.cell);
}

//전산장비이력조회
function fn_searchHist(intValue)
{
	//신규입력일 경우 장비상태 disable
	if(ds_list.getRowType(ds_list.rowposition) == Dataset.ROWTYPE_INSERT)
	{
		cbo_statCd.readonly = true;		//장비상태
		cal_outDt.enable = false;		//매각폐기일자
		edt_saleAmt.readonly = true;	//매각금액
		edt_outNote.readonly = true;	//매각기타
	}
	else
	{
		//관리자, 등록화면일 경우 장비상태 enable
		if(v_admin == "Y" && v_selYn == "N")
		{
			cbo_statCd.readonly = false;
			//매각폐기
			if(ds_list.getColumn(ds_list.rowposition,"statCd") == "S" || ds_list.getColumn(ds_list.rowposition,"statCd") == "D")
			{
				cal_outDt.enable = true;
				if(ds_list.getColumn(ds_list.rowposition,"statCd") == "S") edt_saleAmt.readonly = false;
				else edt_saleAmt.readonly = true;
				edt_outNote.readonly = false;
			}
			else
			{
				cal_outDt.enable = false;
				edt_saleAmt.readonly = true;
				edt_outNote.readonly = true;
			}
		}
		else
		{
			cal_outDt.enable = false;
			edt_saleAmt.readonly = true;
			edt_outNote.readonly = true;
		}
	}

	//체크박스 선택 시 이력조회 skip
	if(intValue == 1) return;

	//이미지조회call
	fn_imgFileView();

	//전산장비관리번호체크
	var v_eqno = ds_list.getColumn(ds_list.rowposition, "eqNo");
	if(v_eqno == "undefined" || v_eqno == null || v_eqno == "") return;

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_hist);

	// Dataset을 초기화한다.
	ds_hist.clearData();

	ds_searchHist.clearData();
	ds_searchHist.addRow();

	ds_searchHist.setColumn(0, "eqNo", ds_list.getColumn(ds_list.rowposition, "eqNo"));

	var strSvcID    = "selectHist";
    var strURL      = "am/ams/equipmentRegist/selectHist.xdo";
    var strInDs     = "ds_searchHist=ds_searchHist:A";
    var strOutDs    = "ds_hist=ds_hist";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/***************************************************************************
 * 설명   : 서버에 저장된 이미지파일 view
 ***************************************************************************/
function fn_imgFileView()
{
	var imgVal = ds_list.getColumn(ds_list.rowposition, "serverFilenm");
    if (!gfn_isNull(imgVal))
    {
		if (ds_list.getColumn(ds_list.rowposition, "isUpload") == "")
		{
			edt_appendFilenm.value = ds_list.getColumn(ds_list.rowposition, "appendFilenm");
			img_viewer.image = application.services["svc"].url + "upload/am/" + imgVal;
		}
	}
}

function btn_attrSabunPop_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_attrSabunPop();
}

/***************************************************************************
 * 설명    		: 귀속사용자 Popup
 ***************************************************************************/
function fn_attrSabunPop()
{
	//팝업창을 호출한다.
	var strId       = "UserSearch";
	var strURL      = "cmn::UserSearchPop.xfdl";
	var objArgument = {
		P_SOSOK_CODE      : "",
		P_SOSOK_NAME      : "",
		P_USER_GROUP      : "",
		P_USE_YN          : "Y",
		P_IS_MULTI_CHOICE : "false",
		P_USER_NAME       : edt_attrSabunNm.value,
		P_APPLY_SYSTEM_MST: "N",
		P_FORCED_USER_GROUP : ""
	};
	var nWidth      = 700;
	var nHeight     = 495;
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	
	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
 	
	if (typeof arrRtn != "undefined" && arrRtn != null && gfn_getObjkeyLength(arrRtn) > 0)
	{
		arr = arrRtn.datas;
		arrRtn = arr[0];
	
		//trace(arrRtn.sabun);
		//trace(arrRtn.nmKor);
		ds_list.setColumn(ds_list.rowposition, "attrSabun", arrRtn.sabun);
		ds_list.setColumn(ds_list.rowposition, "attrSabunNm", arrRtn.nmKor);
	}

}

function edt_attrSabunNm_onkeydown(obj:Edit, e:KeyEventInfo)
{
	// Enter 키
	if(e.keycode == 13) 
	{		
		ds_list.setColumn(ds_list.rowposition, "attrSabun", "");
		ds_list.setColumn(ds_list.rowposition, "attrSabunNm", "");
		fn_attrSabunPop();
	}
	// Del 키
	else if(e.keycode == 46) 
	{
		ds_list.setColumn(ds_list.rowposition, "attrSabun", "");
		ds_list.setColumn(ds_list.rowposition, "attrSabunNm", "");
	}
}

function btn_attrUpjangPop_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_attrUpjangPop();
}

/***************************************************************************
 * 설명    		: 귀속사업장 Popup
 ***************************************************************************/
function fn_attrUpjangPop()
{
	var dataSet = new Dataset();
	dataSet.id = "ds_comm_search";
	dataSet.name = "ds_comm_search";
 	dataSet.addRow();
 	dataSet.addColumn("roleSetId", "STRING", "4000");
 	dataSet.addColumn("designTitle", "STRING", "4000"); //팝업디자인정보 : 타이틀명
 	dataSet.addColumn("designUpjangCode", "STRING", "4000"); //팝업디자인정보 : 업장코드명
 	dataSet.addColumn("designUpjangName", "STRING", "4000"); //팝업디자인정보 : 업장명
	dataSet.setColumn(dataSet.rowposition, "designTitle", "업장검색");
	dataSet.setColumn(dataSet.rowposition, "designUpjangCode", "업장코드");
	dataSet.setColumn(dataSet.rowposition, "designUpjangName", "업장명");
 	dataSet.setColumn(dataSet.rowposition, "roleSetId", "ScoUpjangMst");
 	
	//[[팝업창을 호출한다.
	var strId       = "UpjangSearch";
	var strURL      = "cmn::UpjangSearchPop.xfdl";
	var objArgument = {
		P_DATASET : dataSet
	};
	var nWidth      = 513;
	var nHeight     = 495;
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";

	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);

	if (typeof arrRtn != "undefined" && arrRtn != null && gfn_getObjkeyLength(arrRtn) > 0)
	{
		//trace(arrRtn.upjangCode);
		//trace(arrRtn.upjangName);
		ds_list.setColumn(ds_list.rowposition, "attrUpjang", arrRtn.upjangCode);
		ds_list.setColumn(ds_list.rowposition, "attrUpjangNm", arrRtn.upjangName);
	}

}

function edt_attrUpjangNm_onkeydown(obj:Edit, e:KeyEventInfo)
{
	// Enter 키
	if(e.keycode == 13) 
	{		
		ds_list.setColumn(ds_list.rowposition, "attrUpjang", "");
		ds_list.setColumn(ds_list.rowposition, "attrUpjangNm", "");
		fn_attrUpjangPop();
	}
	// Del 키
	else if(e.keycode == 46) 
	{
		ds_list.setColumn(ds_list.rowposition, "attrUpjang", "");
		ds_list.setColumn(ds_list.rowposition, "attrUpjangNm", "");
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 이미지첨부 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_attachFile_onclick(obj:Button,  e:ClickEventInfo)
{
	var nRowCnt = ds_list.getRowCount();
	
	if(nRowCnt <= 0) return;
	
	if(ds_list.rowposition < 0) return;
	
	var objFD = new FileDialog();
	objFD.defaultextention = true;
	objFD.filter = "image files (*.bmp;*.jpg;*.jpeg;*.gif;*.png)|*.bmp;*.jpg;*.jpeg;*.gif;*.png";

	var objVFile1 = objFD.open("file open", FileDialog.LOAD, "%MYDOCUMENT%");

	if (objVFile1) 
	{
		objVFile1.open(VirtualFile.openRead | VirtualFile.openBinary);
	} 
	else 
	{
		return false;
	}

	// 파일크기 100KB 제한
// 	if (objVFile1.getFileSize() > 100000) 
// 	{
// 		gfn_alert("파일크기가 100KB를 초과하였습니다!", "", "A");
// 		return;
// 	}

	ds_list.setColumn(ds_list.rowposition, "appendFilenm", objVFile1.filename);

	img_viewer.stretch = "fixaspectratio";
	img_viewer.image = objVFile1.fullpath;
	//trace(objVFile1.fullpath);

	ds_list.setColumn(ds_list.rowposition, "imgFile", objVFile1.read(objVFile1.getFileSize()));
	ds_list.setColumn(ds_list.rowposition, "isUpload", "Y");

    bFileUpCheck = true;
    objVFile1.close();
}

function preSet()
{
	div_cmnBtn.btn_insert.visible = false;
	div_cmnBtn.btn_delete.visible = false;
	div_cmnBtn.btn_save.visible = false;
	btn_attachFile.visible = false;
	btn_deleteFile.visible = false;
	cbo_statCd.readonly = true;
	cbo_comeqType.readonly = true;
	cbo_purchaseType.readonly = true;
	cbo_modelNm.readonly = true;
	cbo_osType.readonly = true;
	cbo_cpuType.readonly = true;
	cbo_memType.readonly = true;
	cbo_madComp.readonly = true;
	edt_purchaseDesc.readonly = true;
	edt_modelDesc.readonly = true;
	edt_osDesc.readonly = true;
	edt_cpuDesc.readonly = true;
	edt_memDesc.readonly = true;
	edt_madCompDesc.readonly = true;
	edt_serialNo.readonly = true;
	cal_purchaseDt.enable = false;
	edt_purchaseAmt.readonly = true;
	edt_serviceLife.readonly = true;
	edt_attrUpjangNm.readonly = true;
	edt_attrSabunNm.readonly = true;
	edt_etcNote.readonly = true;
	btn_attrUpjangPop.enable = false;
	btn_attrSabunPop.enable = false;
	cal_outDt.enable = false;
	edt_saleAmt.readonly = true;
	edt_outNote.readonly = true;
	me_madYmd.readonly = true;
	btn_Date.enable = false;
}

function ds_list_onvaluechanged(obj:Dataset,  e:DSColChangeEventInfo)
{
	if(e.columnid == "statCd")
	{
		//매각폐기
		if(e.newvalue == "S" || e.newvalue == "D")
		{
			ds_list.setColumn(e.row, "outSabun", gfn_getUserInfo("userid"));
			ds_list.setColumn(e.row, "outSabunNm", gfn_getUserInfo("nmKor"));
			cal_outDt.enable = true;
			if(e.newvalue == "S")
			{
				edt_saleAmt.readonly = false;
			}
			else
			{
				ds_list.setColumn(e.row, "saleAmt", "0");
				edt_saleAmt.readonly = true;
			}
			edt_outNote.readonly = false;
		}
		else
		{
			ds_list.setColumn(e.row, "outSabun", "");
			ds_list.setColumn(e.row, "outSabunNm", "");
			ds_list.setColumn(e.row, "outDt", "");
			cal_outDt.enable = false;
			ds_list.setColumn(e.row, "saleAmt", "0");
			edt_saleAmt.readonly = true;
			ds_list.setColumn(e.row, "outNote", "");
			edt_outNote.readonly = true;
		}
	}

	//장비유형
	if(e.columnid == "comeqType")
	{
		var strFilter = "";
		
		ds_amsModelNm.filter(strFilter);
		
		if(e.newvalue != "undefined" && e.newvalue != "")
		{
			//모델명 Clear
			ds_list.setColumn(e.row, "modelNm", "");
			ds_list.setColumn(e.row, "modelDesc", "");
			//장비유형filter
			strFilter = "set1 == '" + e.newvalue + "'";
			if(typeof ds_list.getColumn(e.row,"madComp") != "undefined" && ds_list.getColumn(e.row,"madComp") != "")
			{
				//제조사filter
				strFilter = strFilter + " && " + "set2 == '" + ds_list.getColumn(e.row,"madComp") + "'";
			}
			//trace(strFilter);
			ds_amsModelNm.filter(strFilter);
		}
		
		//데스크탑일 경우 화면사이즈 clear/disable
		if(e.newvalue == "DT")
		{
			ds_list.setColumn(e.row, "dispType", "");
			cbo_dispType.enable = false;
		}
		else
		{
			cbo_dispType.enable = true;
		}
		//모니터일 경우 OS, CPU, 메모리 clear
		if(e.newvalue == "MO")
		{
			ds_list.setColumn(e.row, "osType", "");
			ds_list.setColumn(e.row, "osDesc", "");
			ds_list.setColumn(e.row, "cpuType", "");
			ds_list.setColumn(e.row, "cpuDesc", "");
			ds_list.setColumn(e.row, "memType", "");
			ds_list.setColumn(e.row, "memDesc", "");
			cbo_osType.enable = false;
			edt_osDesc.enable = false;
			cbo_cpuType.enable = false;
			edt_cpuDesc.enable = false;
			cbo_memType.enable = false;
			edt_memDesc.enable = false;
		}
		else
		{
			cbo_osType.enable = true;
			edt_osDesc.enable = true;
			cbo_cpuType.enable = true;
			edt_cpuDesc.enable = true;
			cbo_memType.enable = true;
			edt_memDesc.enable = true;
		}
	}

	//제조사
	if(e.columnid == "madComp")
	{
		var strFilter = "";
		
		ds_amsModelNm.filter(strFilter);
		
		if(e.newvalue != "undefined" && e.newvalue != "")
		{
			//모델명 Clear
			ds_list.setColumn(e.row, "modelNm", "");
			ds_list.setColumn(e.row, "modelDesc", "");
			//제조사filter
			strFilter = "set2 == '" + e.newvalue + "'";
			if(typeof ds_list.getColumn(e.row,"comeqType") != "undefined" && ds_list.getColumn(e.row,"comeqType") != "")
			{
				//장비유형filter
				strFilter = strFilter + " && " + "set1 == '" + ds_list.getColumn(e.row,"comeqType") + "'";
			}
			//trace(strFilter);
			ds_amsModelNm.filter(strFilter);
		}
	}

	//시리얼번호
	if(e.columnid == "serialNo")
	{
		if(e.newvalue != "")
		{
			//중복체크
		}
	}

}

function btn_deleteFile_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_list.rowposition < 0) return;
	ds_list.setColumn(ds_list.rowposition,"appendFilenm","");
	ds_list.setColumn(ds_list.rowposition,"serverFilenm","");
	ds_list.setColumn(ds_list.rowposition,"imgFile","");
}

function btn_as_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_list.rowcount <= 0) {
		return;
	}
	
	if(gfn_isNull(ds_list.getColumn(ds_list.rowposition, "eqNo"))) {
		return;
	}
	
	var arGb = "";
	
	if(v_admin != "Y") arGb = "조회";

	if(ds_list.getColumn(ds_list.rowposition, "statCd") == "D" || ds_list.getColumn(ds_list.rowposition, "statCd") == "S") {
		arGb = "조회";
	}
	
	if(v_selYn == "Y") arGb = "조회";
	
	var strId       = "EquipmentAsPopup";
	var strURL      = "X_AMS::EquipmentAsPopup.xfdl";
	var objArgument = {argEqNo:ds_list.getColumn(ds_list.rowposition, "eqNo"),argGubun:arGb};
	var nWidth      = 550;
	var nHeight     = 380;
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	// 리턴값을 배열로 받을 경우
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
	
}


/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
  
/*----------------------------------------------------------------------------------------------
 * 설명      : 사업부 변경되는 경우
 *---------------------------------------------------------------------------------------------*/
function fn_muChange(obj, event)
{
	edt_tm.setTmCode("");
	edt_upjang.setUpjangCode("");
	ds_list.clearData();
	fn_outletSubHidden();
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 팀(운영부서) 변경되는 경우
 *---------------------------------------------------------------------------------------------*/
 
//팀(운영부서) 변경되는 경우
function fn_tmChange(obj, data)
{
	edt_upjang.setUpjangCode("");
	ds_list.clearData();
	fn_outletSubHidden();
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 업장(사업장) 변경되는 경우
 *---------------------------------------------------------------------------------------------*/
function fn_upjangChange(obj,data)
{
	ds_list.clearData();
	SCCombo.bind(this, "ComCode", "cbo_outletSub",     null, {groupCode:"SLE_0111", useYn:"Y",  attr01:edt_upjang.getUpjangCode(), defVal:""},SCCombo.CHOOSE,"fn_TriggerEvent");	 
}  


function fn_TriggerEvent(p) 
{
	if(cbo_outletSub.getCount() > 1 ) 
	{
		cbo_outletSub.visible =true;
		stat_outletSub.visible=true;
	}else
	{
		cbo_outletSub.visible =false;
		stat_outletSub.visible=false;
	}
}

function fn_outletSubHidden()
{
	SCCombo.remove(this, "cbo_outletSub", null);
	cbo_outletSub.visible =false;
	stat_outletSub.visible=false;
}]]></Script>
  </Form>
</FDL>

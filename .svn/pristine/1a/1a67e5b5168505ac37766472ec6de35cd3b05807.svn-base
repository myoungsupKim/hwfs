<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="SapSlipUpload" classname="CloseMgnt01" inheritanceid="" position="absolute 0 0 1251 725" titletext="SAP 전표 생성" style="background:white;color:red;" onload="form_onload">
    <Layouts>
      <Layout>
        <Div id="div_cmnBtn" anchor="left top right" taborder="6" tabstop="false" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static58" class="sta_WFSA_Labelbg" position="absolute 0 30 1236 98" anchor="left top right"/>
        <Static id="Static70" text="H10" visible="false" position="absolute 15 30 1220 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static72" text="W15" visible="false" position="absolute 0 30 15 91" style="background:#ff000055;align:center middle;"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1251 725" anchor="left bottom"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1236 0 1251 710" anchor="top right"/>
        <Static id="Static28" text="회계월 " class="sta_WFSA_label" position="absolute 517 66 587 87" anchor="left top" style="align:left middle;"/>
        <Static id="Static05" text="W15" visible="false" position="absolute 1220 30 1235 98" style="background:#ff000055;align:center middle;"/>
        <Button id="btn_receive" taborder="16" text="전표생성" onclick="btn_receive_onclick" class="btn_WF_CRUD" position="absolute 786 0 851 25" anchor="left top" visible="true" style="font:Gulim,9,bold;" enable="false"/>
        <Static id="Static13" text="H10" visible="false" position="absolute 0 87 1205 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static56" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1 40 16 61" anchor="left top"/>
        <Static id="Static57" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 77 40 87 61" anchor="left top"/>
        <Static id="Static55" text="사업부" class="sta_WFSA_label" position="absolute 16 40 76 60" style="background:URL('theme://images/new/sta_WFSA_label.png') left middle;align:left middle;"/>
        <Static id="Static01" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 563 40 573 61" anchor="left top"/>
        <Static id="Static44" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 329 40 338 61" anchor="left top"/>
        <Static id="Static46" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 227 40 257 61" anchor="left top"/>
        <Static id="Static03" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 487 40 517 61" anchor="left top"/>
        <Static id="Static04" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 876 66 906 87" anchor="left top"/>
        <Static id="Static09" text="CC" class="sta_WFSA_label" position="absolute 517 40 587 60" style="background:URL('theme://images/new/sta_WFSA_label.png') left middle;align:left middle;"/>
        <Edit id="edt_tmCd" taborder="31" readonly="true" onkeydown="edt_tmNm_onkeydown" visible="false" position="absolute 407 725 617 746" anchor="left top right" tmCd=""/>
        <Edit id="edt_ccCd" taborder="32" readonly="true" autoselect="true" visible="false" position="absolute 717 725 927 746"/>
        <Edit id="edt_upjang" taborder="33" readonly="true" onkeydown="edt_upjangnm_onkeydown" visible="false" position="absolute 1027 725 1233 746" anchor="left top right" tmCd=""/>
        <ObjCalMonth id="cal_slipMon" titletext="월력" taborder="5" scrollbars="none" position="absolute 573 66 649 87"/>
        <Static id="Static02" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 563 66 573 87" anchor="left top"/>
        <Grid id="grd_list" taborder="7" binddataset="ds_list" useinputpanel="false" treeusecheckbox="false" treeinitstatus="expand,all" position="absolute 0 129 1236 710" anchor="all" autofittype="col" visible="true">
          <Formats>
            <Format id="grd_FM">
              <Columns>
                <Column size="40"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="180"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="70"/>
                <Column size="150"/>
                <Column size="150"/>
                <Column size="70"/>
                <Column size="150"/>
                <Column size="150"/>
                <Column size="180"/>
              </Columns>
              <Rows>
                <Row size="20" band="head"/>
                <Row size="20" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel" taborder="undefined"/>
                <Cell col="1" text="사업부"/>
                <Cell col="2" text="업장(CC)"/>
                <Cell col="3" rowspan="2" text="고객사" taborder="undefined"/>
                <Cell col="4" rowspan="2" colspan="2" text="전표유형" taborder="undefined"/>
                <Cell col="6" colspan="3" text="차변" taborder="undefined"/>
                <Cell col="9" colspan="3" text="대변" taborder="undefined"/>
                <Cell col="12" rowspan="2" text="CC" taborder="undefined"/>
                <Cell row="1" col="1"/>
                <Cell row="1" col="2"/>
                <Cell row="1" col="6" colspan="2" text="계정" taborder="undefined"/>
                <Cell row="1" col="8" text="금액"/>
                <Cell row="1" col="9" colspan="2" text="계정" taborder="undefined"/>
                <Cell row="1" col="11" text="금액"/>
              </Band>
              <Band id="body">
                <Cell style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" expr="currow+1"/>
                <Cell col="1" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:muNm" suppress="1"/>
                <Cell col="2" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:ccNm" suppress="2"/>
                <Cell col="3" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:custNm" subsumtext="소계" suppress="0"/>
                <Cell col="4" style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:slipType" suppress="0" suppressalign="first"/>
                <Cell col="5" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:slipTypeNm" suppress="0" suppressalign="first"/>
                <Cell col="6" style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:dAcctCd"/>
                <Cell col="7" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:dAcctNm"/>
                <Cell col="8" displaytype="number" style="background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:dAmt"/>
                <Cell col="9" style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:cAcctCd"/>
                <Cell col="10" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:cAcctNm"/>
                <Cell col="11" displaytype="number" style="background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:cAmt"/>
                <Cell col="12" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:ccNm" suppress="0"/>
              </Band>
              <Band id="summary">
                <Cell colspan="8" style="align:right middle;" text="차변합계" taborder="undefined"/>
                <Cell col="8" displaytype="number" text="expr:getSum('dAmt')"/>
                <Cell col="9" colspan="2" style="align:right middle;" text="대변합계" taborder="undefined"/>
                <Cell col="11" displaytype="number" text="expr:getSum('cAmt')"/>
                <Cell col="12"/>
              </Band>
            </Format>
            <Format id="grd_RC">
              <Columns>
                <Column size="40"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="35"/>
                <Column size="180"/>
                <Column size="80"/>
                <Column size="150"/>
                <Column size="150"/>
                <Column size="80"/>
                <Column size="150"/>
                <Column size="150"/>
                <Column size="160"/>
                <Column size="160"/>
              </Columns>
              <Rows>
                <Row size="20" band="head"/>
                <Row size="20" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel" taborder="undefined"/>
                <Cell col="1" text="사업부"/>
                <Cell col="2" text="업장(CC)"/>
                <Cell col="3" rowspan="2" colspan="2" text="전표유형" taborder="undefined"/>
                <Cell col="5" colspan="3" text="차변" taborder="undefined"/>
                <Cell col="8" colspan="3" text="대변" taborder="undefined"/>
                <Cell col="11" rowspan="2" text="고객사" taborder="undefined"/>
                <Cell col="12" rowspan="2" text="CC" taborder="undefined"/>
                <Cell row="1" col="1"/>
                <Cell row="1" col="2"/>
                <Cell row="1" col="5" colspan="2" text="계정" taborder="undefined"/>
                <Cell row="1" col="7" text="금액"/>
                <Cell row="1" col="8" colspan="2" text="계정" taborder="undefined"/>
                <Cell row="1" col="10" text="금액"/>
              </Band>
              <Band id="body">
                <Cell style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font: ;" expr="currow+1"/>
                <Cell col="1" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:muNm" suppress="1"/>
                <Cell col="2" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:ccNm" suppress="2"/>
                <Cell col="3" style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:slipType" suppress="1" suppressalign="first"/>
                <Cell col="4" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:slipTypeNm" suppress="2" suppressalign="first"/>
                <Cell col="5" style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:dAcctCd"/>
                <Cell col="6" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:dAcctNm"/>
                <Cell col="7" displaytype="number" style="background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:dAmt"/>
                <Cell col="8" style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:cAcctCd"/>
                <Cell col="9" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:cAcctNm"/>
                <Cell col="10" displaytype="number" style="background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:cAmt"/>
                <Cell col="11" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:custNm" suppress="0"/>
                <Cell col="12" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:ccNm" suppress="0"/>
              </Band>
              <Band id="summary">
                <Cell colspan="7" style="align:right middle;" text="차변금액" taborder="undefined"/>
                <Cell col="7" displaytype="number" text="expr:getSum('dAmt')"/>
                <Cell col="8" colspan="2" style="align:right middle;" text="대변금액" taborder="undefined"/>
                <Cell col="10" displaytype="number" text="expr:getSum('cAmt')"/>
                <Cell col="11" colspan="2" taborder="undefined"/>
              </Band>
            </Format>
            <Format id="grd_test">
              <Columns>
                <Column size="40"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="50"/>
                <Column size="160"/>
                <Column size="80"/>
                <Column size="150"/>
                <Column size="110"/>
                <Column size="80"/>
                <Column size="150"/>
                <Column size="110"/>
                <Column size="150"/>
                <Column size="130"/>
                <Column size="50"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="20" band="head"/>
                <Row size="20" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel" taborder="undefined"/>
                <Cell col="1" text="사업부"/>
                <Cell col="2" text="업장(CC)"/>
                <Cell col="3" rowspan="2" colspan="2" text="전표유형" taborder="undefined"/>
                <Cell col="5" colspan="3" text="차변" taborder="undefined"/>
                <Cell col="8" colspan="3" text="대변" taborder="undefined"/>
                <Cell col="11" rowspan="2" text="고객사" taborder="undefined"/>
                <Cell col="12" rowspan="2" text="업장(CC)" taborder="undefined"/>
                <Cell col="13" rowspan="2" taborder="undefined"/>
                <Cell col="14" rowspan="2" taborder="undefined"/>
                <Cell row="1" col="1"/>
                <Cell row="1" col="2"/>
                <Cell row="1" col="5" colspan="2" text="계정" taborder="undefined"/>
                <Cell row="1" col="7" text="금액"/>
                <Cell row="1" col="8" colspan="2" text="계정" taborder="undefined"/>
                <Cell row="1" col="10" text="금액"/>
              </Band>
              <Band id="body">
                <Cell style="align:center middle;" expr="currow+1"/>
                <Cell col="1" style="align:left middle;" text="bind:muNm" suppress="1"/>
                <Cell col="2" style="align:left middle;" text="bind:ccNm" suppress="2"/>
                <Cell col="3" style="align:center middle;" text="bind:slipType" suppress="0" suppressalign="first"/>
                <Cell col="4" style="align:left middle;" text="bind:slipTypeNm" suppress="0" suppressalign="first"/>
                <Cell col="5" style="align:center middle;background: ;" text="bind:dAcctCd"/>
                <Cell col="6" style="align:left middle;" text="bind:dAcctNm"/>
                <Cell col="7" displaytype="number" text="bind:dAmt"/>
                <Cell col="8" style="align:center middle;" text="bind:cAcctCd"/>
                <Cell col="9" style="align:left middle;" text="bind:cAcctNm"/>
                <Cell col="10" displaytype="number" text="bind:cAmt"/>
                <Cell col="11" style="align:left middle;" text="bind:custNm" suppress="0"/>
                <Cell col="12" style="align:left middle;" text="bind:ccNm" suppress="0"/>
                <Cell col="13" text="bind:journalzYn"/>
                <Cell col="14" text="bind:journalzNum"/>
              </Band>
              <Band id="summary">
                <Cell colspan="7" style="align:right middle;" text="차변합계" taborder="undefined"/>
                <Cell col="7" displaytype="number" text="expr:getSum('dAmt')"/>
                <Cell col="8" colspan="2" style="align:right middle;" text="대변합계" taborder="undefined"/>
                <Cell col="10" displaytype="number" text="expr:getSum('cAmt')"/>
                <Cell col="11"/>
                <Cell col="12"/>
                <Cell col="13"/>
                <Cell col="14"/>
              </Band>
            </Format>
            <Format id="grd_Helper">
              <Columns>
                <Column size="40"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="35"/>
                <Column size="180"/>
                <Column size="80"/>
                <Column size="150"/>
                <Column size="150"/>
                <Column size="80"/>
                <Column size="150"/>
                <Column size="150"/>
                <Column size="180"/>
              </Columns>
              <Rows>
                <Row size="20" band="head"/>
                <Row size="20" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel" taborder="undefined"/>
                <Cell col="1" text="사업부"/>
                <Cell col="2" text="업장(CC)"/>
                <Cell col="3" rowspan="2" colspan="2" text="전표유형" taborder="undefined"/>
                <Cell col="5" colspan="3" text="차변" taborder="undefined"/>
                <Cell col="8" colspan="3" text="대변" taborder="undefined"/>
                <Cell col="11" rowspan="2" text="CC" taborder="undefined"/>
                <Cell row="1" col="1"/>
                <Cell row="1" col="2"/>
                <Cell row="1" col="5" colspan="2" text="계정" taborder="undefined"/>
                <Cell row="1" col="7" text="금액"/>
                <Cell row="1" col="8" colspan="2" text="계정" taborder="undefined"/>
                <Cell row="1" col="10" text="금액"/>
              </Band>
              <Band id="body">
                <Cell style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font: ;" expr="currow+1"/>
                <Cell col="1" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:muNm" suppress="1"/>
                <Cell col="2" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:ccNm" suppress="2"/>
                <Cell col="3" style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:slipType" suppress="1" suppressalign="first"/>
                <Cell col="4" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:slipTypeNm" taborder="0" suppress="2" suppressalign="first"/>
                <Cell col="5" style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:dAcctCd"/>
                <Cell col="6" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:dAcctNm"/>
                <Cell col="7" displaytype="number" style="background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:dAmt"/>
                <Cell col="8" style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:cAcctCd"/>
                <Cell col="9" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:cAcctNm"/>
                <Cell col="10" displaytype="number" style="background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:cAmt"/>
                <Cell col="11" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:ccNm" suppress="0"/>
              </Band>
              <Band id="summary">
                <Cell colspan="7" style="align:right middle;" text="차변금액" taborder="undefined"/>
                <Cell col="7" displaytype="number" text="expr:getSum('dAmt')"/>
                <Cell col="8" colspan="2" style="align:right middle;" text="대변금액" taborder="undefined"/>
                <Cell col="10" displaytype="number" text="expr:getSum('cAmt')"/>
                <Cell col="11"/>
              </Band>
            </Format>
            <Format id="grd_TX1">
              <Columns>
                <Column size="40"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="35"/>
                <Column size="180"/>
                <Column size="80"/>
                <Column size="150"/>
                <Column size="90"/>
                <Column size="80"/>
                <Column size="150"/>
                <Column size="90"/>
                <Column size="160"/>
                <Column size="160"/>
                <Column size="180"/>
              </Columns>
              <Rows>
                <Row size="20" band="head"/>
                <Row size="20" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel" taborder="undefined"/>
                <Cell col="1" text="사업부"/>
                <Cell col="2" text="업장(CC)"/>
                <Cell col="3" rowspan="2" colspan="2" text="전표유형" taborder="undefined"/>
                <Cell col="5" colspan="3" text="차변" taborder="undefined"/>
                <Cell col="8" colspan="3" text="대변" taborder="undefined"/>
                <Cell col="11" rowspan="2" text="고객사" taborder="undefined"/>
                <Cell col="12" rowspan="2" text="CC" taborder="undefined"/>
                <Cell col="13" rowspan="2" text="계산서번호" taborder="undefined"/>
                <Cell row="1" col="1"/>
                <Cell row="1" col="2"/>
                <Cell row="1" col="5" colspan="2" text="계정" taborder="undefined"/>
                <Cell row="1" col="7" text="금액"/>
                <Cell row="1" col="8" colspan="2" text="계정" taborder="undefined"/>
                <Cell row="1" col="10" text="금액"/>
              </Band>
              <Band id="body">
                <Cell style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font: ;" expr="currow+1"/>
                <Cell col="1" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:muNm" suppress="1"/>
                <Cell col="2" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:ccNm" suppress="2"/>
                <Cell col="3" style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:slipType" suppress="1" suppressalign="first"/>
                <Cell col="4" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:slipTypeNm" suppress="2" suppressalign="first"/>
                <Cell col="5" style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:dAcctCd"/>
                <Cell col="6" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:dAcctNm"/>
                <Cell col="7" displaytype="number" style="background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:dAmt"/>
                <Cell col="8" style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:cAcctCd"/>
                <Cell col="9" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:cAcctNm"/>
                <Cell col="10" displaytype="number" style="background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:cAmt"/>
                <Cell col="11" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:custNm" suppress="0"/>
                <Cell col="12" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');font:EXPR(getRowLevel(currow) == 1 ? 'Gulim,9,bold' : '');" text="bind:ccNm" suppress="0"/>
                <Cell col="13" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:taxShetNumOrg" suppress="0"/>
              </Band>
              <Band id="summary">
                <Cell colspan="7" style="align:right middle;" text="차변금액" taborder="undefined"/>
                <Cell col="7" displaytype="number" text="expr:getSum('dAmt')"/>
                <Cell col="8" colspan="2" style="align:right middle;" text="대변금액" taborder="undefined"/>
                <Cell col="10" displaytype="number" text="expr:getSum('cAmt')"/>
                <Cell col="11" colspan="2" taborder="undefined"/>
                <Cell col="13"/>
              </Band>
            </Format>
            <Format id="grd_TX">
              <Columns>
                <Column size="40"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="180"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="80"/>
                <Column size="150"/>
                <Column size="150"/>
                <Column size="80"/>
                <Column size="150"/>
                <Column size="150"/>
                <Column size="180"/>
              </Columns>
              <Rows>
                <Row size="20" band="head"/>
                <Row size="20" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel" taborder="undefined"/>
                <Cell col="1" text="사업부"/>
                <Cell col="2" text="업장(CC)"/>
                <Cell col="3" rowspan="2" text="세금계산서번호" taborder="undefined"/>
                <Cell col="4" rowspan="2" colspan="2" text="전표유형" taborder="undefined"/>
                <Cell col="6" colspan="3" text="차변" taborder="undefined"/>
                <Cell col="9" colspan="3" text="대변" taborder="undefined"/>
                <Cell col="12" rowspan="2" text="CC" taborder="undefined"/>
                <Cell row="1" col="1"/>
                <Cell row="1" col="2"/>
                <Cell row="1" col="6" colspan="2" text="계정" taborder="undefined"/>
                <Cell row="1" col="8" text="금액"/>
                <Cell row="1" col="9" colspan="2" text="계정" taborder="undefined"/>
                <Cell row="1" col="11" text="금액"/>
              </Band>
              <Band id="body">
                <Cell style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" expr="currow+1"/>
                <Cell col="1" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:muNm" suppress="1"/>
                <Cell col="2" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:ccNm" suppress="2"/>
                <Cell col="3" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:taxShetNumOrg" subsumtext="소계" suppress="0"/>
                <Cell col="4" style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:slipType" suppress="0" suppressalign="first"/>
                <Cell col="5" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:slipTypeNm" suppress="0" suppressalign="first"/>
                <Cell col="6" style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:dAcctCd"/>
                <Cell col="7" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:dAcctNm"/>
                <Cell col="8" displaytype="number" style="background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:dAmt"/>
                <Cell col="9" style="align:center middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:cAcctCd"/>
                <Cell col="10" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:cAcctNm"/>
                <Cell col="11" displaytype="number" style="background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:cAmt"/>
                <Cell col="12" style="align:left middle;background:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');background2:EXPR(getRowLevel(currow) == 1 ? '#fddcc9ff' : '');" text="bind:ccNm" suppress="0"/>
              </Band>
              <Band id="summary">
                <Cell colspan="8" style="align:right middle;" text="차변합계" taborder="undefined"/>
                <Cell col="8" displaytype="number" text="expr:getSum('dAmt')"/>
                <Cell col="9" colspan="2" style="align:right middle;" text="대변합계" taborder="undefined"/>
                <Cell col="11" displaytype="number" text="expr:getSum('cAmt')"/>
                <Cell col="12"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 124 1236 129" anchor="left top"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 98 1236 111" anchor="left top"/>
        <Static id="Static22" text="유형별 전표내역" class="sta_WF_Title01" position="absolute 0 111 150 129" anchor="left top"/>
        <Static id="Static10" text="전표유형" class="sta_WFSA_label" position="absolute 16 66 77 87" anchor="left top" style="align:left middle;"/>
        <Combo id="cbo_slipType" taborder="3" displaynulltext="선택" innerdataset="@ds_slipType" codecolumn="code" datacolumn="codeName" onitemchanged="cbo_slipType_onitemchanged" position="absolute 87 66 227 87" anchor="left top" class="cmb_WF_Essential"/>
        <Button id="btn_test8B" taborder="51" text="원가이관" onclick="fn_search8B" class="btn_WF_Custom" position="absolute 881 960 956 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Button id="btn_test8B00" taborder="52" text="Helper" onclick="fn_searchHelper" class="btn_WF_Custom" position="absolute 804 960 879 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Button id="btn_test8A" taborder="53" text="영업환불" onclick="fn_search8A" class="btn_WF_Custom" position="absolute 727 960 802 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Button id="btn_test8D" taborder="54" text="영업기타" onclick="fn_search8D" class="btn_WF_Custom" position="absolute 650 960 725 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Button id="btn_test8D_B03" taborder="55" text="채권상계" onclick="fn_search8D_B03" class="btn_WF_Custom" position="absolute 573 960 648 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Button id="btn_test8D_B17" taborder="56" text="대손처리" onclick="fn_search8D_B17" class="btn_WF_Custom" position="absolute 496 960 571 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Button id="btn_test7I" taborder="57" text="쿠폰" onclick="fn_search7I" class="btn_WF_Custom" position="absolute 419 960 494 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Static id="Static08" text="시스템구분" class="sta_WFSA_label" position="absolute 257 66 333 87" anchor="left top" style="align:left middle;"/>
        <Combo id="cbo_sysClass" taborder="4" onitemchanged="cbo_sysClass_onitemchanged" position="absolute 338 66 486 87" anchor="left top" innerdataset="ds_sysClass" enable="false" codecolumn="code" datacolumn="codeName" displaynulltext="선택" class="cmb_WF_Essential"/>
        <Button id="btn_test7I00" taborder="62" text="7A_11204014" onclick="fn_search7A_11204014" class="btn_WF_Custom" position="absolute 322 960 417 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Button id="btn_test" taborder="63" text="단체급식매출" onclick="fn_search2" class="btn_WF_Custom" position="absolute 1135 960 1230 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Button id="btn_test100" taborder="64" text="100% 세금계산서 발행 전표" onclick="fn_search100" class="btn_WF_Custom" position="absolute 958 960 1133 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Grid id="Grid00" taborder="65" binddataset="ds_sapSlipList" useinputpanel="false" position="absolute 32 441 1235 683" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="slipNum"/>
                <Cell col="1" disptype="normal" text="buCd"/>
                <Cell col="2" disptype="normal" text="dtlNum"/>
                <Cell col="3" disptype="normal" text="slipType"/>
                <Cell col="4" disptype="normal" text="slipEvidenceDate"/>
                <Cell col="5" disptype="normal" text="slipPeriodDate"/>
                <Cell col="6" disptype="normal" text="masterAcct"/>
                <Cell col="7" disptype="normal" text="drCrClass"/>
                <Cell col="8" disptype="normal" text="nextBuCd"/>
                <Cell col="9" disptype="normal" text="ccCd"/>
                <Cell col="10" disptype="normal" text="orderNum"/>
                <Cell col="11" disptype="normal" text="fnctPrvn"/>
                <Cell col="12" disptype="normal" text="plCenter"/>
                <Cell col="13" disptype="normal" text="minusPeriodYn"/>
                <Cell col="14" disptype="normal" text="slipCurrencyAmt"/>
                <Cell col="15" disptype="normal" text="lcalAmt"/>
                <Cell col="16" disptype="normal" text="supplyplceNum"/>
                <Cell col="17" disptype="normal" text="guestNum"/>
                <Cell col="18" disptype="normal" text="foSupplyplceNum"/>
                <Cell col="19" disptype="normal" text="foCustNm"/>
                <Cell col="20" disptype="normal" text="muCd"/>
                <Cell col="21" disptype="normal" text="inltYn"/>
                <Cell col="22" disptype="normal" text="itemText"/>
                <Cell col="23" disptype="normal" text="vatCd"/>
                <Cell col="24" disptype="normal" text="upjang"/>
                <Cell col="25" disptype="normal" text="stdAmt"/>
                <Cell col="26" disptype="normal" text="taxAmt"/>
                <Cell col="27" disptype="normal" text="quantity"/>
                <Cell col="28" disptype="normal" text="unit"/>
                <Cell col="29" disptype="normal" text="payerName"/>
                <Cell col="30" disptype="normal" text="expireCalBasisDate"/>
                <Cell col="31" disptype="normal" text="payMtod"/>
                <Cell col="32" disptype="normal" text="payCond"/>
                <Cell col="33" disptype="normal" text="payDfer"/>
                <Cell col="34" disptype="normal" text="payRef"/>
                <Cell col="35" disptype="normal" text="lcNum"/>
                <Cell col="36" disptype="normal" text="membNum"/>
                <Cell col="37" disptype="normal" text="realUser"/>
                <Cell col="38" disptype="normal" text="telNum"/>
                <Cell col="39" disptype="normal" text="useNoMan"/>
                <Cell col="40" disptype="normal" text="assignNum"/>
                <Cell col="41" disptype="normal" text="poNum"/>
                <Cell col="42" disptype="normal" text="attachDept"/>
                <Cell col="43" disptype="normal" text="mgmtDept"/>
                <Cell col="44" disptype="normal" text="mgmtArticle"/>
                <Cell col="45" disptype="normal" text="reasonCd"/>
                <Cell col="46" disptype="normal" text="crgleftClass"/>
                <Cell col="47" disptype="normal" text="singlePayYn"/>
                <Cell col="48" disptype="normal" text="tempCustNm"/>
                <Cell col="49" disptype="normal" text="bankAcctNo"/>
                <Cell col="50" disptype="normal" text="bankAcctOwnr"/>
                <Cell col="51" disptype="normal" text="bankCd"/>
                <Cell col="52" disptype="normal" text="coPaGuest"/>
                <Cell col="53" disptype="normal" text="coPaCcCd"/>
                <Cell col="54" disptype="normal" text="startDate"/>
                <Cell col="55" disptype="normal" text="endDate"/>
                <Cell col="56" disptype="normal" text="blDate"/>
                <Cell col="57" disptype="normal" text="assetNum"/>
                <Cell col="58" disptype="normal" text="assetLlevelNum"/>
                <Cell col="59" disptype="normal" text="mgmtGuest"/>
                <Cell col="60" disptype="normal" text="mgmtSupplyplce"/>
                <Cell col="61" disptype="normal" text="custRemark"/>
                <Cell col="62" disptype="normal" text="refDate"/>
                <Cell col="63" disptype="normal" text="lshipDate"/>
                <Cell col="64" disptype="normal" text="taxStdAmt"/>
                <Cell col="65" disptype="normal" text="mmAmt"/>
                <Cell col="66" disptype="normal" text="taxRate"/>
                <Cell col="67" disptype="normal" text="intRate"/>
                <Cell col="68" disptype="normal" text="guOfficeNum"/>
                <Cell col="69" disptype="normal" text="remark1"/>
                <Cell col="70" disptype="normal" text="remark2"/>
                <Cell col="71" disptype="normal" text="addr"/>
                <Cell col="72" disptype="normal" text="etc"/>
                <Cell col="73" disptype="normal" text="cardSrlNum"/>
                <Cell col="74" disptype="normal" text="cardInterfaceNum"/>
                <Cell col="75" disptype="normal" text="cardNum"/>
                <Cell col="76" disptype="normal" text="interfaceLogNum"/>
                <Cell col="77" disptype="normal" text="inputDate"/>
                <Cell col="78" disptype="normal" text="inputTime"/>
                <Cell col="79" disptype="normal" text="currency"/>
                <Cell col="80" disptype="normal" text="slipText"/>
                <Cell col="81" disptype="normal" text="writeEmpSabun"/>
                <Cell col="82" disptype="normal" text="writeEmpDept"/>
                <Cell col="83" disptype="normal" text="writeEmpMuCd"/>
                <Cell col="84" disptype="normal" text="sysCd"/>
                <Cell col="85" disptype="normal" text="remark"/>
                <Cell col="86" disptype="normal" text="fiscalYear"/>
                <Cell col="87" disptype="normal" text="signType"/>
                <Cell col="88" disptype="normal" text="signStatus"/>
                <Cell col="89" disptype="normal" text="slipStatus"/>
                <Cell col="90" disptype="normal" text="slipMon"/>
                <Cell col="91" disptype="normal" text="vatClass"/>
                <Cell col="92" disptype="normal" text="custCdOrg"/>
                <Cell col="93" disptype="normal" text="elctntaxBillApprvnum"/>
                <Cell col="94" disptype="normal" text="suspenseAltType"/>
                <Cell col="95" disptype="normal" text="taxShetNum"/>
                <Cell col="96" disptype="normal" text="slipUpjang"/>
                <Cell col="97" disptype="normal" text="sysClass"/>
                <Cell col="98" disptype="normal" text="slipCreationMm"/>
                <Cell col="99" disptype="normal" text="ccCdOrg"/>
                <Cell col="100" disptype="normal" text="receiptNum"/>
                <Cell col="101" disptype="normal" text="giftBillingNum"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:slipNum"/>
                <Cell col="1" disptype="normal" text="bind:buCd"/>
                <Cell col="2" disptype="normal" text="bind:dtlNum"/>
                <Cell col="3" disptype="normal" text="bind:slipType"/>
                <Cell col="4" disptype="normal" text="bind:slipEvidenceDate"/>
                <Cell col="5" disptype="normal" text="bind:slipPeriodDate"/>
                <Cell col="6" disptype="normal" text="bind:masterAcct"/>
                <Cell col="7" disptype="normal" text="bind:drCrClass"/>
                <Cell col="8" disptype="normal" text="bind:nextBuCd"/>
                <Cell col="9" disptype="normal" text="bind:ccCd"/>
                <Cell col="10" disptype="normal" text="bind:orderNum"/>
                <Cell col="11" disptype="normal" text="bind:fnctPrvn"/>
                <Cell col="12" disptype="normal" text="bind:plCenter"/>
                <Cell col="13" disptype="normal" text="bind:minusPeriodYn"/>
                <Cell col="14" disptype="normal" text="bind:slipCurrencyAmt"/>
                <Cell col="15" disptype="normal" text="bind:lcalAmt"/>
                <Cell col="16" disptype="normal" text="bind:supplyplceNum"/>
                <Cell col="17" disptype="normal" text="bind:guestNum"/>
                <Cell col="18" disptype="normal" text="bind:foSupplyplceNum"/>
                <Cell col="19" disptype="normal" text="bind:foCustNm"/>
                <Cell col="20" disptype="normal" text="bind:muCd"/>
                <Cell col="21" disptype="normal" text="bind:inltYn"/>
                <Cell col="22" disptype="normal" text="bind:itemText"/>
                <Cell col="23" disptype="normal" text="bind:vatCd"/>
                <Cell col="24" disptype="normal" text="bind:upjang"/>
                <Cell col="25" disptype="normal" text="bind:stdAmt"/>
                <Cell col="26" disptype="normal" text="bind:taxAmt"/>
                <Cell col="27" disptype="normal" text="bind:quantity"/>
                <Cell col="28" disptype="normal" text="bind:unit"/>
                <Cell col="29" disptype="normal" text="bind:payerName"/>
                <Cell col="30" disptype="normal" text="bind:expireCalBasisDate"/>
                <Cell col="31" disptype="normal" text="bind:payMtod"/>
                <Cell col="32" disptype="normal" text="bind:payCond"/>
                <Cell col="33" disptype="normal" text="bind:payDfer"/>
                <Cell col="34" disptype="normal" text="bind:payRef"/>
                <Cell col="35" disptype="normal" text="bind:lcNum"/>
                <Cell col="36" disptype="normal" text="bind:membNum"/>
                <Cell col="37" disptype="normal" text="bind:realUser"/>
                <Cell col="38" disptype="normal" text="bind:telNum"/>
                <Cell col="39" disptype="normal" text="bind:useNoMan"/>
                <Cell col="40" disptype="normal" text="bind:assignNum"/>
                <Cell col="41" disptype="normal" text="bind:poNum"/>
                <Cell col="42" disptype="normal" text="bind:attachDept"/>
                <Cell col="43" disptype="normal" text="bind:mgmtDept"/>
                <Cell col="44" disptype="normal" text="bind:mgmtArticle"/>
                <Cell col="45" disptype="normal" text="bind:reasonCd"/>
                <Cell col="46" disptype="normal" text="bind:crgleftClass"/>
                <Cell col="47" disptype="normal" text="bind:singlePayYn"/>
                <Cell col="48" disptype="normal" text="bind:tempCustNm"/>
                <Cell col="49" disptype="normal" text="bind:bankAcctNo"/>
                <Cell col="50" disptype="normal" text="bind:bankAcctOwnr"/>
                <Cell col="51" disptype="normal" text="bind:bankCd"/>
                <Cell col="52" disptype="normal" text="bind:coPaGuest"/>
                <Cell col="53" disptype="normal" text="bind:coPaCcCd"/>
                <Cell col="54" disptype="normal" text="bind:startDate"/>
                <Cell col="55" disptype="normal" text="bind:endDate"/>
                <Cell col="56" disptype="normal" text="bind:blDate"/>
                <Cell col="57" disptype="normal" text="bind:assetNum"/>
                <Cell col="58" disptype="normal" text="bind:assetLlevelNum"/>
                <Cell col="59" disptype="normal" text="bind:mgmtGuest"/>
                <Cell col="60" disptype="normal" text="bind:mgmtSupplyplce"/>
                <Cell col="61" disptype="normal" text="bind:custRemark"/>
                <Cell col="62" disptype="normal" text="bind:refDate"/>
                <Cell col="63" disptype="normal" text="bind:lshipDate"/>
                <Cell col="64" disptype="normal" text="bind:taxStdAmt"/>
                <Cell col="65" disptype="normal" text="bind:mmAmt"/>
                <Cell col="66" disptype="normal" text="bind:taxRate"/>
                <Cell col="67" disptype="normal" text="bind:intRate"/>
                <Cell col="68" disptype="normal" text="bind:guOfficeNum"/>
                <Cell col="69" disptype="normal" text="bind:remark1"/>
                <Cell col="70" disptype="normal" text="bind:remark2"/>
                <Cell col="71" disptype="normal" text="bind:addr"/>
                <Cell col="72" disptype="normal" text="bind:etc"/>
                <Cell col="73" disptype="normal" text="bind:cardSrlNum"/>
                <Cell col="74" disptype="normal" text="bind:cardInterfaceNum"/>
                <Cell col="75" disptype="normal" text="bind:cardNum"/>
                <Cell col="76" disptype="normal" text="bind:interfaceLogNum"/>
                <Cell col="77" disptype="normal" text="bind:inputDate"/>
                <Cell col="78" disptype="normal" text="bind:inputTime"/>
                <Cell col="79" disptype="normal" text="bind:currency"/>
                <Cell col="80" disptype="normal" text="bind:slipText"/>
                <Cell col="81" disptype="normal" text="bind:writeEmpSabun"/>
                <Cell col="82" disptype="normal" text="bind:writeEmpDept"/>
                <Cell col="83" disptype="normal" text="bind:writeEmpMuCd"/>
                <Cell col="84" disptype="normal" text="bind:sysCd"/>
                <Cell col="85" disptype="normal" text="bind:remark"/>
                <Cell col="86" disptype="normal" text="bind:fiscalYear"/>
                <Cell col="87" disptype="normal" text="bind:signType"/>
                <Cell col="88" disptype="normal" text="bind:signStatus"/>
                <Cell col="89" disptype="normal" text="bind:slipStatus"/>
                <Cell col="90" disptype="normal" text="bind:slipMon"/>
                <Cell col="91" disptype="normal" text="bind:vatClass"/>
                <Cell col="92" disptype="normal" text="bind:custCdOrg"/>
                <Cell col="93" disptype="normal" text="bind:elctntaxBillApprvnum"/>
                <Cell col="94" disptype="normal" text="bind:suspenseAltType"/>
                <Cell col="95" disptype="normal" text="bind:taxShetNum"/>
                <Cell col="96" disptype="normal" text="bind:slipUpjang"/>
                <Cell col="97" disptype="normal" text="bind:sysClass"/>
                <Cell col="98" disptype="normal" text="bind:slipCreationMm"/>
                <Cell col="99" disptype="normal" text="bind:ccCdOrg"/>
                <Cell col="100" disptype="normal" text="bind:receiptNum"/>
                <Cell col="101" disptype="normal" text="bind:giftBillingNum"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="Grid01" taborder="66" binddataset="ds_search" useinputpanel="false" autofittype="none" position="absolute 2 365 1236 436" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="muCd"/>
                <Cell col="1" disptype="normal" text="tmCd"/>
                <Cell col="2" disptype="normal" text="tmNm"/>
                <Cell col="3" disptype="normal" text="ccCd"/>
                <Cell col="4" disptype="normal" text="ccNm"/>
                <Cell col="5" disptype="normal" text="upjangCd"/>
                <Cell col="6" disptype="normal" text="upjangNm"/>
                <Cell col="7" disptype="normal" text="slipMon"/>
                <Cell col="8" disptype="normal" text="closeYn"/>
                <Cell col="9" disptype="normal" text="loginSabun"/>
                <Cell col="10" disptype="normal" text="custCd"/>
                <Cell col="11" disptype="normal" text="sysClass"/>
                <Cell col="12" disptype="normal" text="slipDateFr"/>
                <Cell col="13" disptype="normal" text="slipDateTo"/>
                <Cell col="14" disptype="normal" text="slipType"/>
                <Cell col="15" disptype="normal" text="slipTypeBySQL"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:muCd"/>
                <Cell col="1" disptype="normal" text="bind:tmCd"/>
                <Cell col="2" disptype="normal" text="bind:tmNm"/>
                <Cell col="3" disptype="normal" text="bind:ccCd"/>
                <Cell col="4" disptype="normal" text="bind:ccNm"/>
                <Cell col="5" disptype="normal" text="bind:upjangCd"/>
                <Cell col="6" disptype="normal" text="bind:upjangNm"/>
                <Cell col="7" disptype="normal" text="bind:slipMon"/>
                <Cell col="8" disptype="normal" text="bind:closeYn"/>
                <Cell col="9" disptype="normal" text="bind:loginSabun"/>
                <Cell col="10" disptype="normal" text="bind:custCd"/>
                <Cell col="11" disptype="normal" text="bind:sysClass"/>
                <Cell col="12" disptype="normal" text="bind:slipDateFr"/>
                <Cell col="13" disptype="normal" text="bind:slipDateTo"/>
                <Cell col="14" disptype="normal" text="bind:slipType"/>
                <Cell col="15" disptype="normal" text="bind:slipTypeBySQL"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_cancel" taborder="67" text="전표취소" onclick="btn_cancel_onclick" class="btn_WF_CRUD" position="absolute 719 0 784 25" anchor="left top" style="font:Gulim,9,bold;" visible="false" enable="false"/>
        <Grid id="Grid02" taborder="68" useinputpanel="false" position="absolute 56 535 1046 752" binddataset="ds_list" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="slipType"/>
                <Cell col="1" disptype="normal" text="slipTypeNm"/>
                <Cell col="2" disptype="normal" text="drCrClass"/>
                <Cell col="3" disptype="normal" text="dAcctCd"/>
                <Cell col="4" disptype="normal" text="dAcctNm"/>
                <Cell col="5" disptype="normal" text="cAcctCd"/>
                <Cell col="6" disptype="normal" text="cAcctNm"/>
                <Cell col="7" disptype="normal" text="dAmt"/>
                <Cell col="8" disptype="normal" text="cAmt"/>
                <Cell col="9" disptype="normal" text="xAmt"/>
                <Cell col="10" disptype="normal" text="vAmt"/>
                <Cell col="11" disptype="normal" text="sysClass"/>
                <Cell col="12" disptype="normal" text="sysClassNm"/>
                <Cell col="13" disptype="normal" text="muCd"/>
                <Cell col="14" disptype="normal" text="ccCd"/>
                <Cell col="15" disptype="normal" text="muNm"/>
                <Cell col="16" disptype="normal" text="ccNm"/>
                <Cell col="17" disptype="normal" text="slipMon"/>
                <Cell col="18" disptype="normal" text="custCd"/>
                <Cell col="19" disptype="normal" text="sapCustCd"/>
                <Cell col="20" disptype="normal" text="custNm"/>
                <Cell col="21" disptype="normal" text="sort"/>
                <Cell col="22" disptype="normal" text="vatClass"/>
                <Cell col="23" disptype="normal" text="withdrawSchdDate"/>
                <Cell col="24" disptype="normal" text="custCdOrg"/>
                <Cell col="25" disptype="normal" text="suspenseAltType"/>
                <Cell col="26" disptype="normal" text="taxBillNum"/>
                <Cell col="27" disptype="normal" text="taxShetNum"/>
                <Cell col="28" disptype="normal" text="upjang"/>
                <Cell col="29" disptype="normal" text="cardDate"/>
                <Cell col="30" disptype="normal" text="ccCdOrg"/>
                <Cell col="31" disptype="normal" text="subUpjangNum"/>
                <Cell col="32" disptype="normal" text="occurDate"/>
                <Cell col="33" disptype="normal" text="journalzYn"/>
                <Cell col="34" disptype="normal" text="journalzNum"/>
                <Cell col="35" disptype="normal" text="bankCd"/>
                <Cell col="36" disptype="normal" text="bankAcctOwnr"/>
                <Cell col="37" disptype="normal" text="bankAcctNo"/>
                <Cell col="38" disptype="normal" text="singlePayYn"/>
                <Cell col="39" disptype="normal" text="slipEvidenceDate"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:slipType"/>
                <Cell col="1" disptype="normal" text="bind:slipTypeNm"/>
                <Cell col="2" disptype="normal" text="bind:drCrClass"/>
                <Cell col="3" disptype="normal" text="bind:dAcctCd"/>
                <Cell col="4" disptype="normal" text="bind:dAcctNm"/>
                <Cell col="5" disptype="normal" text="bind:cAcctCd"/>
                <Cell col="6" disptype="normal" text="bind:cAcctNm"/>
                <Cell col="7" disptype="normal" text="bind:dAmt"/>
                <Cell col="8" disptype="normal" text="bind:cAmt"/>
                <Cell col="9" disptype="normal" text="bind:xAmt"/>
                <Cell col="10" disptype="normal" text="bind:vAmt"/>
                <Cell col="11" disptype="normal" text="bind:sysClass"/>
                <Cell col="12" disptype="normal" text="bind:sysClassNm"/>
                <Cell col="13" disptype="normal" text="bind:muCd"/>
                <Cell col="14" disptype="normal" text="bind:ccCd"/>
                <Cell col="15" disptype="normal" text="bind:muNm"/>
                <Cell col="16" disptype="normal" text="bind:ccNm"/>
                <Cell col="17" disptype="normal" text="bind:slipMon"/>
                <Cell col="18" disptype="normal" text="bind:custCd"/>
                <Cell col="19" disptype="normal" text="bind:sapCustCd"/>
                <Cell col="20" disptype="normal" text="bind:custNm"/>
                <Cell col="21" disptype="normal" text="bind:sort"/>
                <Cell col="22" disptype="normal" text="bind:vatClass"/>
                <Cell col="23" disptype="normal" text="bind:withdrawSchdDate"/>
                <Cell col="24" disptype="normal" text="bind:custCdOrg"/>
                <Cell col="25" disptype="normal" text="bind:suspenseAltType"/>
                <Cell col="26" disptype="normal" text="bind:taxBillNum"/>
                <Cell col="27" disptype="normal" text="bind:taxShetNum"/>
                <Cell col="28" disptype="normal" text="bind:upjang"/>
                <Cell col="29" disptype="normal" text="bind:cardDate"/>
                <Cell col="30" disptype="normal" text="bind:ccCdOrg"/>
                <Cell col="31" disptype="normal" text="bind:subUpjangNum"/>
                <Cell col="32" disptype="normal" text="bind:occurDate"/>
                <Cell col="33" disptype="normal" text="bind:journalzYn"/>
                <Cell col="34" disptype="normal" text="bind:journalzNum"/>
                <Cell col="35" disptype="normal" text="bind:bankCd"/>
                <Cell col="36" disptype="normal" text="bind:bankAcctOwnr"/>
                <Cell col="37" disptype="normal" text="bind:bankAcctNo"/>
                <Cell col="38" disptype="normal" text="bind:singlePayYn"/>
                <Cell col="39" disptype="normal" text="bind:slipEvidenceDate"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <MaskEdit id="edt_differAmt" taborder="69" value="0" readonly="true" mask="#,###" position="absolute 1091 106 1243 127" anchor="top right" style="background:transparent;border:1 none #c2c2c2ff ;color:red;padding:1 5 0 0;font:gulim,9,bold;"/>
        <TmSearchComponent id="TmSearchComponent01" titletext="팀 검색용 Component" taborder="1" text="TmSearchComponent00" position="absolute 338 40 487 61" bindDataset="ds_search" bindTmCdColumn="tmCd" bindTmNmColumn="tmNm" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tmChanged" eventBeforeTrigger="fn_tmBeforeEvent" isTeamControl="Y" class="edt_WF_Essential"/>
        <UpjangSearchComponent id="UpjangSearchComponent01" titletext="업장 검색용 Component" taborder="2" text="UpjangSearchComponent00" position="absolute 573 40 861 61" bindDataset="ds_search" bindUpjangCodeColumn="ccCd" bindUpjangNameColumn="ccNm" eventBeforeTrigger="fn_upjangBeforeEvent" eventAfterTrigger="fn_upjangAfterEvent" roleSetId="" onclick="UpjangSearchComponent01_onclick"/>
        <MuSearchComponent id="MuSearchComponent01" titletext="사업부 선택 Component" taborder="0" text="MuSearchComponent00" position="absolute 87 40 227 61" bindDataset="ds_search" bindMuCdColumn="muCd" appendText="선택" onItemChangedEvent="fn_muChanged" class="cmb_WF_Essential"/>
        <Static id="Static11" text="부서" class="sta_WFSA_label" position="absolute 257 39 309 60" anchor="left top"/>
        <Static id="Static00" text="전기일자" class="sta_WFSA_label" position="absolute 679 66 741 87" anchor="left top"/>
        <ObjCalendar id="cal_slipPeriodDate" titletext="캘린더" taborder="70" scrollbars="none" class="cal_WF_Essential" position="absolute 749 66 861 87"/>
        <Static id="Static07" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 649 66 679 87" anchor="left top"/>
        <Static id="stc_taxInchargeId" text="발행자" class="sta_WFSA_label" position="absolute 905 66 952 87" anchor="left top"/>
        <PersonalSearchComponent id="PersonalSearchComponent00" titletext="사원 검색용 Component" taborder="71" text="PersonalSearchComponent00" position="absolute 1053 66 1165 87" bindDataset="ds_search" bindSabunColumn="supplierInchargeId" bindNmKorColumn="supplierInchargeNm" qoMuCd="" qoTmCd="" qoTmNm="" eventAfterTrigger="" eventBeforeTrigger="" qoCcCd="" qoCcNm="" enable="true"/>
        <Static id="Static12" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 876 40 906 61" anchor="left top"/>
        <Static id="stc_taxShetNo" text="계산서번호" class="sta_WFSA_label" position="absolute 905 40 996 61" anchor="left top"/>
        <Edit id="edt_taxShetNo" taborder="72" readonly="false" autoselect="true" position="absolute 981 39 1165 60" tmCd=""/>
        <Edit id="edt_supplierInchargeId" taborder="73" ontextchanged="edt_supplierInchargeId_ontextchanged" position="absolute 981 66 1054 87" anchor="left top" readonly="true"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="tmNm" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="upjangCd" type="STRING" size="256"/>
          <Column id="upjangNm" type="STRING" size="256"/>
          <Column id="slipMon" type="STRING" size="256"/>
          <Column id="closeYn" type="STRING" size="256"/>
          <Column id="loginSabun" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="slipDateFr" type="STRING" size="256"/>
          <Column id="slipDateTo" type="STRING" size="256"/>
          <Column id="slipType" type="STRING" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="slipTypeBySQL" type="STRING" size="256"/>
          <Column id="slipPeriodDate" type="STRING" size="256"/>
          <Column id="supplierInchargeId" type="STRING" size="256"/>
          <Column id="supplierInchargeNm" type="STRING" size="256"/>
          <Column id="taxShetNo" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="slipType" type="STRING" size="256"/>
          <Column id="slipTypeNm" type="STRING" size="256"/>
          <Column id="drCrClass" type="STRING" size="256"/>
          <Column id="dAcctCd" type="STRING" size="256"/>
          <Column id="dAcctNm" type="STRING" size="256"/>
          <Column id="cAcctCd" type="STRING" size="256"/>
          <Column id="cAcctNm" type="STRING" size="256"/>
          <Column id="dAmt" type="BIGDECIMAL" size="256"/>
          <Column id="cAmt" type="BIGDECIMAL" size="256"/>
          <Column id="xAmt" type="BIGDECIMAL" size="256"/>
          <Column id="vAmt" type="BIGDECIMAL" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="sysClassNm" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="slipMon" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="sapCustCd" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="sort" type="STRING" size="256"/>
          <Column id="vatClass" type="STRING" size="256"/>
          <Column id="withdrawSchdDate" type="STRING" size="256"/>
          <Column id="custCdOrg" type="STRING" size="256"/>
          <Column id="suspenseAltType" type="STRING" size="256"/>
          <Column id="taxBillNum" type="STRING" size="256"/>
          <Column id="taxShetNum" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="cardDate" type="STRING" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="ccCdOrg" type="STRING" size="256"/>
          <Column id="subUpjangNum" type="STRING" size="256"/>
          <Column id="occurDate" type="STRING" size="256"/>
          <Column id="journalzYn" type="STRING" size="256"/>
          <Column id="journalzNum" type="STRING" size="256"/>
          <Column id="bankCd" type="STRING" size="256"/>
          <Column id="bankAcctOwnr" type="STRING" size="256"/>
          <Column id="bankAcctNo" type="STRING" size="256"/>
          <Column id="singlePayYn" type="STRING" size="256"/>
          <Column id="slipEvidenceDate" type="STRING" size="256"/>
          <Column id="receiptNum" type="STRING" size="256"/>
          <Column id="nextBuCd" type="STRING" size="256"/>
          <Column id="giftBillingNum" type="STRING" size="256"/>
          <Column id="crgleftClass" type="STRING" size="256"/>
          <Column id="taxShetNumOrg" type="STRING" size="256"/>
          <Column id="altNum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_muCd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sapSlipList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="slipNum" type="STRING" size="256"/>
          <Column id="buCd" type="STRING" size="256"/>
          <Column id="dtlNum" type="BIGDECIMAL" size="256"/>
          <Column id="slipType" type="STRING" size="256"/>
          <Column id="slipEvidenceDate" type="STRING" size="256"/>
          <Column id="slipPeriodDate" type="STRING" size="256"/>
          <Column id="masterAcct" type="STRING" size="256"/>
          <Column id="drCrClass" type="STRING" size="256"/>
          <Column id="nextBuCd" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="orderNum" type="STRING" size="256"/>
          <Column id="fnctPrvn" type="STRING" size="256"/>
          <Column id="plCenter" type="STRING" size="256"/>
          <Column id="minusPeriodYn" type="STRING" size="256"/>
          <Column id="slipCurrencyAmt" type="BIGDECIMAL" size="256"/>
          <Column id="lcalAmt" type="BIGDECIMAL" size="256"/>
          <Column id="supplyplceNum" type="STRING" size="256"/>
          <Column id="guestNum" type="STRING" size="256"/>
          <Column id="foSupplyplceNum" type="STRING" size="256"/>
          <Column id="foCustNm" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="inltYn" type="STRING" size="256"/>
          <Column id="itemText" type="STRING" size="256"/>
          <Column id="vatCd" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="stdAmt" type="BIGDECIMAL" size="256"/>
          <Column id="taxAmt" type="BIGDECIMAL" size="256"/>
          <Column id="quantity" type="BIGDECIMAL" size="256"/>
          <Column id="unit" type="STRING" size="256"/>
          <Column id="payerName" type="STRING" size="256"/>
          <Column id="expireCalBasisDate" type="STRING" size="256"/>
          <Column id="payMtod" type="STRING" size="256"/>
          <Column id="payCond" type="STRING" size="256"/>
          <Column id="payDfer" type="STRING" size="256"/>
          <Column id="payRef" type="STRING" size="256"/>
          <Column id="lcNum" type="STRING" size="256"/>
          <Column id="membNum" type="STRING" size="256"/>
          <Column id="realUser" type="STRING" size="256"/>
          <Column id="telNum" type="STRING" size="256"/>
          <Column id="useNoMan" type="STRING" size="256"/>
          <Column id="assignNum" type="STRING" size="256"/>
          <Column id="poNum" type="STRING" size="256"/>
          <Column id="attachDept" type="STRING" size="256"/>
          <Column id="mgmtDept" type="STRING" size="256"/>
          <Column id="mgmtArticle" type="STRING" size="256"/>
          <Column id="reasonCd" type="STRING" size="256"/>
          <Column id="crgleftClass" type="STRING" size="256"/>
          <Column id="singlePayYn" type="STRING" size="256"/>
          <Column id="tempCustNm" type="STRING" size="256"/>
          <Column id="bankAcctNo" type="STRING" size="256"/>
          <Column id="bankAcctOwnr" type="STRING" size="256"/>
          <Column id="bankCd" type="STRING" size="256"/>
          <Column id="coPaGuest" type="STRING" size="256"/>
          <Column id="coPaCcCd" type="STRING" size="256"/>
          <Column id="startDate" type="STRING" size="256"/>
          <Column id="endDate" type="STRING" size="256"/>
          <Column id="blDate" type="STRING" size="256"/>
          <Column id="assetNum" type="STRING" size="256"/>
          <Column id="assetLlevelNum" type="STRING" size="256"/>
          <Column id="mgmtGuest" type="STRING" size="256"/>
          <Column id="mgmtSupplyplce" type="STRING" size="256"/>
          <Column id="custRemark" type="STRING" size="256"/>
          <Column id="refDate" type="STRING" size="256"/>
          <Column id="lshipDate" type="STRING" size="256"/>
          <Column id="taxStdAmt" type="STRING" size="256"/>
          <Column id="mmAmt" type="BIGDECIMAL" size="256"/>
          <Column id="taxRate" type="STRING" size="256"/>
          <Column id="intRate" type="STRING" size="256"/>
          <Column id="guOfficeNum" type="STRING" size="256"/>
          <Column id="remark1" type="STRING" size="256"/>
          <Column id="remark2" type="STRING" size="256"/>
          <Column id="addr" type="STRING" size="256"/>
          <Column id="etc" type="STRING" size="256"/>
          <Column id="cardSrlNum" type="STRING" size="256"/>
          <Column id="cardInterfaceNum" type="STRING" size="256"/>
          <Column id="cardNum" type="STRING" size="256"/>
          <Column id="interfaceLogNum" type="STRING" size="256"/>
          <Column id="inputDate" type="STRING" size="256"/>
          <Column id="inputTime" type="STRING" size="256"/>
          <Column id="currency" type="STRING" size="256"/>
          <Column id="slipText" type="STRING" size="256"/>
          <Column id="writeEmpSabun" type="STRING" size="256"/>
          <Column id="writeEmpDept" type="STRING" size="256"/>
          <Column id="writeEmpMuCd" type="STRING" size="256"/>
          <Column id="sysCd" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="256"/>
          <Column id="fiscalYear" type="STRING" size="256"/>
          <Column id="signType" type="STRING" size="256"/>
          <Column id="signStatus" type="STRING" size="256"/>
          <Column id="slipStatus" type="STRING" size="256"/>
          <Column id="slipMon" type="STRING" size="256"/>
          <Column id="foSupplyplceNum" type="STRING" size="256"/>
          <Column id="foCustNm" type="STRING" size="256"/>
          <Column id="assignNum" type="STRING" size="256"/>
          <Column id="mgmtArticle" type="STRING" size="256"/>
          <Column id="reasonCd" type="STRING" size="256"/>
          <Column id="coPaGuest" type="STRING" size="256"/>
          <Column id="coPaCcCd" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="vatClass" type="BIGDECIMAL" size="256"/>
          <Column id="custCdOrg" type="STRING" size="256"/>
          <Column id="elctntaxBillApprvnum" type="STRING" size="256"/>
          <Column id="suspenseAltType" type="STRING" size="256"/>
          <Column id="taxShetNum" type="STRING" size="256"/>
          <Column id="slipUpjang" type="STRING" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="slipCreationMm" type="STRING" size="256"/>
          <Column id="ccCdOrg" type="STRING" size="256"/>
          <Column id="receiptNum" type="STRING" size="256"/>
          <Column id="giftBillingNum" type="STRING" size="256"/>
          <Column id="altNum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_slipType" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="code">6A</Col>
            <Col id="codeName">6A:단체급식매출</Col>
          </Row>
          <Row>
            <Col id="code">6B</Col>
            <Col id="codeName">6B:식재영업매출</Col>
          </Row>
          <Row>
            <Col id="code">6C</Col>
            <Col id="codeName">6C:식재도매매출</Col>
          </Row>
          <Row>
            <Col id="code">6D</Col>
            <Col id="codeName">6D:외식사업매출</Col>
          </Row>
          <Row>
            <Col id="code">6H</Col>
            <Col id="codeName">6H:기타매출(POS외등)</Col>
          </Row>
          <Row>
            <Col id="code">7A</Col>
            <Col id="codeName">7A:입금처리</Col>
          </Row>
          <Row>
            <Col id="code">7B</Col>
            <Col id="codeName">7B:채권 이관</Col>
          </Row>
          <Row>
            <Col id="code">7C</Col>
            <Col id="codeName">7C:선수금발생 관리</Col>
          </Row>
          <Row>
            <Col id="code">7E</Col>
            <Col id="codeName">7E:선수금 이관</Col>
          </Row>
          <Row>
            <Col id="code">7F</Col>
            <Col id="codeName">7F:영업현금 가수금 대체</Col>
          </Row>
          <Row>
            <Col id="code">7H</Col>
            <Col id="codeName">7H:기타 가수금 대체</Col>
          </Row>
          <Row>
            <Col id="code">7I</Col>
            <Col id="codeName">7I:쿠폰(식권)판매/교환/소멸</Col>
          </Row>
          <Row>
            <Col id="code">7J</Col>
            <Col id="codeName">7J:상품권 청구</Col>
          </Row>
          <Row>
            <Col id="code">8A</Col>
            <Col id="codeName">8A:영업환불(영업미지급)</Col>
          </Row>
          <Row>
            <Col id="code">8B</Col>
            <Col id="codeName">8B:원가 이관(직원식대처리)</Col>
          </Row>
          <Row>
            <Col id="code">8C</Col>
            <Col id="codeName">8C:Helper</Col>
          </Row>
          <Row>
            <Col id="code">8D</Col>
            <Col id="codeName">8D:영업기타</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_sysClass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sapSlipCancelList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="slipNum" type="STRING" size="256"/>
          <Column id="buCd" type="STRING" size="256"/>
          <Column id="dtlNum" type="BIGDECIMAL" size="256"/>
          <Column id="slipType" type="STRING" size="256"/>
          <Column id="slipEvidenceDate" type="STRING" size="256"/>
          <Column id="slipPeriodDate" type="STRING" size="256"/>
          <Column id="masterAcct" type="STRING" size="256"/>
          <Column id="drCrClass" type="STRING" size="256"/>
          <Column id="nextBuCd" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="orderNum" type="STRING" size="256"/>
          <Column id="fnctPrvn" type="STRING" size="256"/>
          <Column id="plCenter" type="STRING" size="256"/>
          <Column id="minusPeriodYn" type="STRING" size="256"/>
          <Column id="slipCurrencyAmt" type="BIGDECIMAL" size="256"/>
          <Column id="lcalAmt" type="BIGDECIMAL" size="256"/>
          <Column id="supplyplceNum" type="STRING" size="256"/>
          <Column id="guestNum" type="STRING" size="256"/>
          <Column id="foSupplyplceNum" type="STRING" size="256"/>
          <Column id="foCustNm" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="inltYn" type="STRING" size="256"/>
          <Column id="itemText" type="STRING" size="256"/>
          <Column id="vatCd" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="stdAmt" type="BIGDECIMAL" size="256"/>
          <Column id="taxAmt" type="BIGDECIMAL" size="256"/>
          <Column id="quantity" type="BIGDECIMAL" size="256"/>
          <Column id="unit" type="STRING" size="256"/>
          <Column id="payerName" type="STRING" size="256"/>
          <Column id="expireCalBasisDate" type="STRING" size="256"/>
          <Column id="payMtod" type="STRING" size="256"/>
          <Column id="payCond" type="STRING" size="256"/>
          <Column id="payDfer" type="STRING" size="256"/>
          <Column id="payRef" type="STRING" size="256"/>
          <Column id="lcNum" type="STRING" size="256"/>
          <Column id="membNum" type="STRING" size="256"/>
          <Column id="realUser" type="STRING" size="256"/>
          <Column id="telNum" type="STRING" size="256"/>
          <Column id="useNoMan" type="STRING" size="256"/>
          <Column id="assignNum" type="STRING" size="256"/>
          <Column id="poNum" type="STRING" size="256"/>
          <Column id="attachDept" type="STRING" size="256"/>
          <Column id="mgmtDept" type="STRING" size="256"/>
          <Column id="mgmtArticle" type="STRING" size="256"/>
          <Column id="reasonCd" type="STRING" size="256"/>
          <Column id="crgleftClass" type="STRING" size="256"/>
          <Column id="singlePayYn" type="STRING" size="256"/>
          <Column id="tempCustNm" type="STRING" size="256"/>
          <Column id="bankAcctNo" type="STRING" size="256"/>
          <Column id="bankAcctOwnr" type="STRING" size="256"/>
          <Column id="bankCd" type="STRING" size="256"/>
          <Column id="coPaGuest" type="STRING" size="256"/>
          <Column id="coPaCcCd" type="STRING" size="256"/>
          <Column id="startDate" type="STRING" size="256"/>
          <Column id="endDate" type="STRING" size="256"/>
          <Column id="blDate" type="STRING" size="256"/>
          <Column id="assetNum" type="STRING" size="256"/>
          <Column id="assetLlevelNum" type="STRING" size="256"/>
          <Column id="mgmtGuest" type="STRING" size="256"/>
          <Column id="mgmtSupplyplce" type="STRING" size="256"/>
          <Column id="custRemark" type="STRING" size="256"/>
          <Column id="refDate" type="STRING" size="256"/>
          <Column id="lshipDate" type="STRING" size="256"/>
          <Column id="taxStdAmt" type="STRING" size="256"/>
          <Column id="mmAmt" type="BIGDECIMAL" size="256"/>
          <Column id="taxRate" type="STRING" size="256"/>
          <Column id="intRate" type="STRING" size="256"/>
          <Column id="guOfficeNum" type="STRING" size="256"/>
          <Column id="remark1" type="STRING" size="256"/>
          <Column id="remark2" type="STRING" size="256"/>
          <Column id="addr" type="STRING" size="256"/>
          <Column id="etc" type="STRING" size="256"/>
          <Column id="cardSrlNum" type="STRING" size="256"/>
          <Column id="cardInterfaceNum" type="STRING" size="256"/>
          <Column id="cardNum" type="STRING" size="256"/>
          <Column id="interfaceLogNum" type="STRING" size="256"/>
          <Column id="inputDate" type="STRING" size="256"/>
          <Column id="currency" type="STRING" size="256"/>
          <Column id="slipText" type="STRING" size="256"/>
          <Column id="writeEmpSabun" type="STRING" size="256"/>
          <Column id="sysCd" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="256"/>
          <Column id="fiscalYear" type="STRING" size="256"/>
          <Column id="signType" type="STRING" size="256"/>
          <Column id="signStatus" type="STRING" size="256"/>
          <Column id="slipStatus" type="STRING" size="256"/>
          <Column id="slipMon" type="STRING" size="256"/>
          <Column id="foSupplyplceNum" type="STRING" size="256"/>
          <Column id="foCustNm" type="STRING" size="256"/>
          <Column id="assignNum" type="STRING" size="256"/>
          <Column id="mgmtArticle" type="STRING" size="256"/>
          <Column id="reasonCd" type="STRING" size="256"/>
          <Column id="coPaGuest" type="STRING" size="256"/>
          <Column id="coPaCcCd" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="vatClass" type="BIGDECIMAL" size="256"/>
          <Column id="custCdOrg" type="STRING" size="256"/>
          <Column id="elctntaxBillApprvnum" type="STRING" size="256"/>
          <Column id="suspenseAltType" type="STRING" size="256"/>
          <Column id="taxShetNum" type="STRING" size="256"/>
          <Column id="slipUpjang" type="STRING" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="slipCreationMm" type="STRING" size="256"/>
          <Column id="ccCdOrg" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">0</Col>
            <Col id="delYn">0</Col>
            <Col id="savYn">0</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">0</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_searchValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="muCd">title:사업부,required:true</Col>
            <Col id="tmCd">title:팀,required:false</Col>
            <Col id="ccCd">title:업장(CC),required:false</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_sapClose" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
    </Objects>
    <Bind>
      <BindItem id="item3" compid="edt_tmCd" propid="value" datasetid="ds_search" columnid="tmCd"/>
      <BindItem id="item5" compid="edt_ccCd" propid="value" datasetid="ds_search" columnid="ccCd"/>
      <BindItem id="item7" compid="edt_upjang" propid="value" datasetid="ds_search" columnid="upjangCd"/>
      <BindItem id="item8" compid="cal_slipMon" propid="text" datasetid="ds_search" columnid="slipMon"/>
      <BindItem id="item10" compid="cbo_slipType" propid="value" datasetid="ds_search" columnid="slipType"/>
      <BindItem id="item1" compid="cbo_sysClass" propid="value" datasetid="ds_search" columnid="sysClass"/>
      <BindItem id="item0" compid="edt_taxShetNo" propid="value" datasetid="ds_search" columnid="taxShetNo"/>
      <BindItem id="item2" compid="edt_supplierInchargeId" propid="value" datasetid="ds_search" columnid="supplierInchargeId"/>
    </Bind>
    <InitValue/>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : SapSlipUpload
  파 일 명 : SapSlipUpload.xfdl
  기    능 : SAP 전표 생성

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.06.16   JUN   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "lib::SMCommon.xjs";	//영업회계 공통 스크립트

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();
var fv_objColInfo;	//데이터셋 컬럼정보
var v_ds_check	= "";
var gOccrDate	= "";
var gSysClass	= "";
var gUpjangCd	= "";
var gTaxSearchYn= "";	//100% 세금계산서 발행 매출전표
var gSlipMon	= "";
var fv_retVal   = "";
var gScreenYn	= "N";	//화면 이동여부
var be_cnt = 0; //전 건수
var be_amt = 0; //전 금액
var af_cnt = 0; //현재 건수
var af_amt = 0; //현재 금액

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo){

	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	
		/*
	var chk_day = "";

	fv_taxDay = fv_sToday;
	
	fn_init();
	
	
	//지난달 월마감 체크해서 전기일자 자동 세팅되도록 변경 필요(FC회계팀)  2017.08.18 처리자:김호석 선처리
	var muCd = MuSearchComponent01.getMuCode();
	var ccCd = "0";
	chk_day = gfn_getLastDate(gfn_addMonth(fv_sToday, -1));	
	var year = chk_day.substr(0, 4);
	var mm = chk_day.substr(4, 2);
		
	if( !fn_sapCloseChk2(muCd, ccCd, year, mm) )	{ 
		//지난달 월마감이 되었으면  오늘날짜로
		//alert("월마감 : Y");		
	} else {
		//alert("월마감 : N");
		//지난달 월마감이 안되었으면 전월 마지막날로 
		fv_taxDay = gfn_getLastDate(gfn_addMonth(fv_sToday, -1));	
	}
	*/
	fv_taxDay = fv_sToday;
	
	//월마감 체크해서 전기일자 자동 세팅되도록 변경 필요	
	if(parseInt(fv_sToday.substr(6, 2)) < 11){
		fv_taxDay = gfn_getLastDate(gfn_addMonth(fv_sToday, -1));
	}		
	

	// 초기값 셋팅
	fn_init();

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init(){
	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	v_ds_check = "ds_list";

	//콤보조회
	fn_setCombo();
	
	//조회조건을 초기화한다.
	fn_clearSearch();
	
	TmSearchComponent01.applyAuthLevel(MuSearchComponent01);
	UpjangSearchComponent01.setForcedRoleSet("CostCenter");
	UpjangSearchComponent01.applyAuthLevel(TmSearchComponent01);
	
	cal_slipPeriodDate.fn_initMonthCal(this, fv_taxDay, null, ds_search, "slipPeriodDate", "Y");
	
	//미마감조회에서 이동할 경우 조회조건 세팅
	var arrArg = gfn_getScreenParams();
	if(!gfn_isNull(arrArg)) fn_searchBySapSlipNonUploadList(arrArg);

	if(MuSearchComponent01.getMuCode() == "2004" || MuSearchComponent01.getMuCode() == "2005"){
		ds_search.setColumn(0, "supplierInchargeId", g_EmpNo);
		ds_search.setColumn(0, "supplierInchargeNm", g_Name);
		stc_taxInchargeId.visible=true;
		PersonalSearchComponent00.visible=true;
		stc_taxShetNo.visible=true;
		edt_taxShetNo.visible=true;
		edt_supplierInchargeId.visible=true;
	}else{
		ds_search.setColumn(0, "supplierInchargeId", "");
		ds_search.setColumn(0, "supplierInchargeNm", "");	
		stc_taxInchargeId.visible=false;
		PersonalSearchComponent00.visible=false;
		stc_taxShetNo.visible=false;
		edt_taxShetNo.visible=false;		
		edt_supplierInchargeId.visible=false;
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 팀(부서)의 팝업을 호출하기 전에 발생되는 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_tmBeforeEvent(obj)
{
	obj.qoMuCd = MuSearchComponent01.getMuCode();	//cbo_mu.value;
	obj.qoUseYn = "Y";
	
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 업장의 팝업을 호출하기 전에 발생되는 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_upjangBeforeEvent(obj, cls)
{
	cls.setTmCd(TmSearchComponent01.getTmCode());	//cls.setTmCd(edt_tm.getTmCode());
	
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 사업부 변경시 부서, CC 초기화 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_muChanged(){
    ds_search.setColumn(0, "tmCd",  "");
    ds_search.setColumn(0, "tmNm",  "");
    ds_search.setColumn(0, "ccCd",  "");
    ds_search.setColumn(0, "ccNm",  "");
	ds_slipType.clearData();
	ds_sysClass.clearData();
	cbo_slipType.value = "";
	cbo_sysClass.value = "";
	gfn_setSlipTypeByMuCd(this, "cbo_slipType", "ds_slipType", MuSearchComponent01.getMuCode());
	
	if(MuSearchComponent01.getMuCode() == "2004" || MuSearchComponent01.getMuCode() == "2005"){
		ds_search.setColumn(0, "supplierInchargeId", g_EmpNo);
		ds_search.setColumn(0, "supplierInchargeNm", g_Name);
		stc_taxInchargeId.visible=true;
		PersonalSearchComponent00.visible=true;
		stc_taxShetNo.visible=true;
		edt_taxShetNo.visible=true;		
		edt_supplierInchargeId.visible=true;
	}else{
		ds_search.setColumn(0, "supplierInchargeId", "");
		ds_search.setColumn(0, "supplierInchargeNm", "");	
		stc_taxInchargeId.visible=false;
		PersonalSearchComponent00.visible=false;
		stc_taxShetNo.visible=false;
		edt_taxShetNo.visible=false;	
		edt_supplierInchargeId.visible=false;
	}
	ds_list.clearData();
	ds_sapSlipList.clearData();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 부서 변경시 CC 초기화 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_tmChanged(){
    ds_search.setColumn(0, "ccCd",  "");
    ds_search.setColumn(0, "ccNm",  "");
	ds_list.clearData();
	ds_sapSlipList.clearData();    
}
function fn_upjangAfterEvent(){
	ds_list.clearData();
	ds_sapSlipList.clearData();   
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close(){	
	// v_ds_check 사용시 변경사항 체크
	if(gfn_length(v_ds_check) != 0){	
	
		// v_ds_check 설정기준 변경사항 체크
		if(gfn_isDataChange() == true){
			if(!gfn_confirm("confirm.before.movepage")) return false;	// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
		}
	}
	return true;
}

/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수-공통버튼)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search(sGubun){
	
	//12월 발행 제한 
	/*
	if(MuSearchComponent01.getMuCode() == "2003"){
		//pass
	} else {
		if ((cal_slipPeriodDate.text > '20201200') ) {
			ds_search.setColumn(0,"slipPeriodDate","20201130");
			alert("12월 전표 발행 불가(물리적 분리로 SAP처리 불가)");
			//ds_taxShetMst.setColumn(0, "publishDate","20201130");
			//ds_taxShetMst.setColumn(0, "fiscalDate","20201130");
			return false;
		}
	}
	*/
	
	// 조회시 Validation Check
	if(gfn_validCheck(ds_search, ds_searchValid, true) == false) return;

	// 조회시 Validation Check
	if(!fn_validCheck()) return;
	
	if(cbo_slipType.value != "6B"){
		if(gfn_isNull(ds_search.getColumn(0, "tmCd"))){
			gfn_alert("팀을 선택해 주세요.");
			return false;
		}
	}
	//세금계산서로 전표발행 하는 경우 회계월이 전기일자보다 작으면 막기 20170322 김호석 (식재영업, 물류매출, 기타매출(페유)) CH201703_00711
	if (cbo_slipType.value == "6B" || cbo_slipType.value == "6C"  || cbo_slipType.value == "6G" || cbo_slipType.value == "6H" || cbo_slipType.value == "7J") {
		if ( cal_slipMon.text < gfn_subStr(cal_slipPeriodDate.text,0,6) ) {
			gfn_alert("세금계산서발행 후 전표생성하는 6B, 6C, 6G ,6H, 7J 전표유형의 경우 회계월이 전기월보다 작을 수 없습니다. 필요 시 재경팀에 문의해주세요");
			return false;
		}
	}
	
	//회계월이 전기일자보다 크면 막기 20160510 20170821 김호석 CH201708_00383
    if ( cal_slipMon.text > gfn_subStr(cal_slipPeriodDate.text,0,6) ) {
        gfn_alert("회계월이 전기일자보다 클 수 없습니다.");
        return;
    } 
    
    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_list);

	//서비스 쿼리결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장
	fv_objColInfo = gfn_getDatasetInfo (ds_list);

	var sSysClass = "";		//시스템구분
	var sSlipType = "";		//전표유형
	var sSlipGubun = "selectSlipList";	//전표구분
	
	sSlipType = ds_search.getColumn(0, "slipType");
	sSysClass = ds_search.getColumn(0, "sysClass");
	gSlipMon  = ds_search.getColumn(0, "slipMon");
	
	//100% 세금계산서 발행 매출전표(6B:식재영업,6C:식재도매,6E:연구소,6G:물류매출,6H:기타매출)
	if(sSysClass == "13" || sSysClass == "14" || sSysClass == "18" || sSysClass == "19" || sSysClass == "23"){
		gTaxSearchYn = "Y";
		sSlipType = "Tax100";
		//grd_list.setFormat("grd_TX");
		
	//급식, 외식 매출전표(6A:FS사업,6D:외식사업,6A:장례식장,6F:특판,6A:매점POS,6D:외식POS)
	}else if(sSysClass == "11" || sSysClass == "12"|| sSysClass == "15" || sSysClass == "16" || sSysClass == "17" || sSysClass == "20" || sSysClass == "21" || sSysClass == "22" || sSysClass == "25"){
		//grd_list.setFormat("grd_RC");
		sSlipType = "TaxEtc";
		gTaxSearchYn = "N";
	}else{
		//grd_list.setFormat("grd_RC");
		gTaxSearchYn = "N";
	}

	if(sSlipType == "8C" || sSlipType == "7F"){
		grd_list.setFormat("grd_Helper");
	}else if(sSlipType == "Tax100"){
		grd_list.setFormat("grd_TX");
	}else{
		grd_list.setFormat("grd_RC");
	}
	ds_search.setColumn(0, "slipTypeBySQL", sSlipType);
	
	//전표생성전 조회
	if (sGubun == "C") { 
		gfn_transaction(this
					,"search2"
					,"sm/srm/sapSlipUpload/selectSlipList.xdo"
					,"ds_search=ds_search:A"
					,"ds_list=ds_list"
					,""
					,"fn_callBack"
					,true);	
	} else {
	//일반 조회	
		gfn_transaction(this
					,"search"
					,"sm/srm/sapSlipUpload/selectSlipList.xdo"
					,"ds_search=ds_search:A"
					,"ds_list=ds_list"
					,""
					,"fn_callBack"
					,true);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert(){}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete(){}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save(){

	if(!gfn_confirm("전표생성을 하시겠습니까?")) 	 
	{	
		return;
	}
	
	//application.httptimeout = 0;
	
	gfn_transaction(this
					,"save"
					,"sm/srm/sapSlipUpload/saveSlipList.xdo"
					,"ds_sapSlipList=ds_sapSlipList:U"
					,""
					,""
					,"fn_callBack"
					,true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print(){}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help(){}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg){
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0){
		//에러 시 내역 그리드 클리어 및 재조회하도록 수정(중복생성 방지 추가) 2018.02.01 김호석
		ds_list.clear();
		ds_list.clearData();
		ds_sapSlipList.clearData();
		//fn_search();
		return;
	}

	var iCntJ = 0;
	var iCntN = 0;
	var iSalsAmt = 0;
	var iPaymAmt = 0;
	
    switch(strSvcID){

   		// 사업부Combo 조회
        //case "searchMuCd" :
		//	fn_setSmSearchDataset("MU", false);
        //    break;    
            
        case "cbo_sysClass" :
			if(ds_sysClass.rowcount == 1) cbo_sysClass.index = 0;
			
			if(gScreenYn == "Y"){
				
				if(ds_sysClass.rowcount > 0){
					fn_search();
				}
				gScreenYn = "N";
			}
            break;          

        //조회
        case "search" :
			if(ds_list.getRowCount() == 0){ //서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				gfn_loadDatasetInfo (ds_list, fv_objColInfo);
				btn_receive.enable = false;
				btn_cancel.enable = false;
				edt_differAmt.value = 0;
			}else{
								
				for(var i=0; i<ds_list.rowcount; i++){
					if(ds_list.getColumn(i, "journalzYn") == "J") iCntJ++;	//전표취소 가능
					if(ds_list.getColumn(i, "journalzYn") == "N") iCntN++;	//전표생성 가능
					if(ds_list.getColumn(i, "drCrClass") == "1"){
						iSalsAmt += parseFloat(ds_list.getColumn(i, "dAmt"));
					}else{
						iPaymAmt += parseFloat(ds_list.getColumn(i, "cAmt"));
					}
					//alert(iCntN);
  
					ds_list.updatecontrol = false;
					//21401080:선수금_선수식권,21401090:선수금_외상식권 >>> 거래처 = 기타(거래처)
					//환불전표중 선수식권(세금계산서발행) 환불인경우 개인이 아닌경우 거래처가 들어가야함(박근화) 20180402 김호석
					if(ds_list.getColumn(0, "slipType") == "8A"){
						//원래 거래처
					} else {
						if(ds_list.getColumn(i, "dAcctCd") == "21401080" || ds_list.getColumn(i, "cAcctCd") == "21401080"
							|| ds_list.getColumn(i, "dAcctCd") == "21401090" || ds_list.getColumn(i, "cAcctCd") == "21401090"){
							ds_list.setColumn(i, "custCd",		"999999");
							ds_list.setColumn(i, "custNm",		"기타(거래처)");
							ds_list.setColumn(i, "sapCustCd",	"99002");
							ds_list.setRowType(i, Dataset.ROWTYPE_NORMAL);
						}		
					}
					ds_list.updatecontrol = true;
				}
				
				//전표취소 가능
				if(ds_list.rowcount == iCntJ){
					btn_receive.enable = false;
					btn_cancel.enable = true;
					
				//전표생성 가능
				}else if(ds_list.rowcount == iCntN){
					btn_receive.enable = true;
					btn_cancel.enable = false;
					
				//전표생성/취소 불가
				}else{
					btn_receive.enable = false;
					btn_cancel.enable = false;
				}
				
				//전표생성버튼 임시(테스트용)
				//btn_receive.enable = true;		
				
				//alert(ds_list.getColumn(0, "slipType"));
				if(ds_list.getColumn(0, "slipType") == "8B"){
					btn_receive.enable = true;
					btn_cancel.enable = false;
				}
				
				//alert(iSalsAmt+":"+iPaymAmt);
				edt_differAmt.value = iSalsAmt - iPaymAmt;
				
				var sSlipType = ds_search.getColumn(0, "slipType");

/*
				if(gfn_isNull(ds_search.getColumn(0, "ccCd"))){
					
					//6B:식재영업,6C:식재도매,6E:연구소,6G:물류매출,6H:기타매출,7J:상품권 청구 - 세금계산서번호
					if(sSlipType == "6B" || sSlipType == "6C" || sSlipType == "6E" || sSlipType == "6G" || sSlipType == "6H" || sSlipType == "7J"){
						ds_list.keystring = "G:taxBillNum";
					
					//7B:채권 이관,7E:선수금 이관,8C:Helper - CC코드(조회조건)
					}else if(sSlipType == "7B" || sSlipType == "7E" || sSlipType == "8C"){
						ds_list.keystring = "G:ccCdOrg";
						
					//8O:내부이용 - 영수증번호
					}else if(sSlipType == "8O"){
						ds_list.keystring = "G:receiptNum";
						
					//7H:기타 가수금 대체, 8D:영업기타
					}else if(sSlipType == "7H" || sSlipType == "8D"){
						ds_list.keystring = "G:+ccCd+suspenseAltType";
						
					//ETC - CC코드(결과값)
					}else{
						ds_list.keystring = "G:ccCd";
					}
				}
*/
/*
				var idx1 = grd_list.getBindCellIndex("body","custNm");
				if(sSlipType == "7F"){
					grd_list.setFormatColProperty(idx1 , "size", 0);
				}else{
					if(sSlipType != "8C") grd_list.setFormatColProperty(idx1 , "size", 160);
				}
*/				
			}
            break;
            
        //조회
        case "search2" :
			if(ds_list.getRowCount() == 0){ //서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				gfn_loadDatasetInfo (ds_list, fv_objColInfo);
				btn_receive.enable = false;
				btn_cancel.enable = false;
				edt_differAmt.value = 0;
			
				//재조회 시 전표 생성대상 결과가 없으면 메시지 팝업 20181114 김호석
				alert("전표 생성 조건에 해당하는 자료가 없습니다.");
				
			}else{
								
				for(var i=0; i<ds_list.rowcount; i++){
					if(ds_list.getColumn(i, "journalzYn") == "J") iCntJ++;	//전표취소 가능
					if(ds_list.getColumn(i, "journalzYn") == "N") iCntN++;	//전표생성 가능
					if(ds_list.getColumn(i, "drCrClass") == "1"){
						iSalsAmt += parseFloat(ds_list.getColumn(i, "dAmt"));
					}else{
						iPaymAmt += parseFloat(ds_list.getColumn(i, "cAmt"));
					}
					//alert(iCntN);
  
					ds_list.updatecontrol = false;
					//21401080:선수금_선수식권,21401090:선수금_외상식권 >>> 거래처 = 기타(거래처)
					//환불전표중 선수식권(세금계산서발행) 환불인경우 개인이 아닌경우 거래처가 들어가야함(박근화) 20180402 김호석
					if(ds_list.getColumn(0, "slipType") == "8A"){
						//원래 거래처
					} else {
						if(ds_list.getColumn(i, "dAcctCd") == "21401080" || ds_list.getColumn(i, "cAcctCd") == "21401080"
							|| ds_list.getColumn(i, "dAcctCd") == "21401090" || ds_list.getColumn(i, "cAcctCd") == "21401090"){
							ds_list.setColumn(i, "custCd",		"999999");
							ds_list.setColumn(i, "custNm",		"기타(거래처)");
							ds_list.setColumn(i, "sapCustCd",	"99002");
							ds_list.setRowType(i, Dataset.ROWTYPE_NORMAL);
						}		
					}
					ds_list.updatecontrol = true;
				}
				
				//조회 건수 및 금액 저장 20180719 김호석				
				//af_cnt = ds_list.rowcount;
				//af_amt = iSalsAmt;
				//alert("건수: " +af_cnt);
				
				//전표취소 가능
				if(ds_list.rowcount == iCntJ){
					btn_receive.enable = false;
					btn_cancel.enable = true;
					
				//전표생성 가능
				}else if(ds_list.rowcount == iCntN){
					btn_receive.enable = true;
					btn_cancel.enable = false;
					
				//전표생성/취소 불가
				}else{
					btn_receive.enable = false;
					btn_cancel.enable = false;
				}
				
				//alert(ds_list.getColumn(0, "slipType"));
				if(ds_list.getColumn(0, "slipType") == "8B"){
					btn_receive.enable = true;
					btn_cancel.enable = false;
				}
				
				//alert(iSalsAmt+":"+iPaymAmt);
				edt_differAmt.value = iSalsAmt - iPaymAmt;
				
				var sSlipType = ds_search.getColumn(0, "slipType");
				
				//전표생성 클릭시 건수/금액 
				af_cnt = ds_list.rowcount;
				af_amt = ds_list.getSum('dAmt');
				//alert(be_cnt + ", " + be_amt);
				//alert("전건수:" + be_cnt + " 현건수:" + af_cnt + " 전금액:" + be_amt + " 현금액:" + af_amt);
				
				var bt_cnt = 0;
				var bt_amt = 0;
				
				//조회 후 전표생성 시 비교 20180719 김호석
				if (be_cnt <> af_cnt) {		
					if (af_cnt > 0) {
						bt_cnt = af_cnt- be_cnt;
						alert("조회 건수가 " + be_cnt + "건에서 "+af_cnt+"건으로 "+ bt_cnt + "건 변경되었습니다." );
						break;
					}
				}
				
				if (be_amt <> af_amt) {
					if (af_amt > 0) {
						bt_amt = af_amt - be_amt;
						alert("조회 금액이 " + be_amt + "원에서 "+af_amt+"원으로 " + bt_amt + "원 변경되었습니다." );
						break;
					}
				}
				
				//재조회 시 전표 생성대상 결과가 없으면 패스 20181114 김호석
				fn_setSlipList();	//전표데이터 생성				
			}
            break;

        //전표생성    
		case "save" :
		
			var arrRetVal  = fv_retVal.split("|");
			
			//성공
			if(arrRetVal[0] == "TRUE"){
				gfn_alert("전표생성이 완료 되었습니다.");				
				//fn_search();
				
			//실패
			}else{
				gfn_alert("["+arrRetVal[0]+"] "+arrRetVal[1]);				
				//fn_search();
			}
			btn_receive.enable = false;		
			gTaxSearchYn = "N";
			
			//초기화
			ds_list.clear();
			ds_list.clearData();
			
			break;   
			         
		//전표생성취소 
		case "cancel" :
		
			var arrRetVal  = fv_retVal.split("|");
			
			//성공
			if(arrRetVal[0] == "TRUE"){
				gfn_alert("생성된 전표가 취소되었습니다.");
				fn_search();
				
			//실패
			}else{
				gfn_alert("["+arrRetVal[0]+"] "+arrRetVal[1]);
			}
			gTaxSearchYn = "N";
			break;
    }
}

/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 콤보/팝업조회
 *---------------------------------------------------------------------------------------------*/
function fn_setCombo(){
/*
	//사업부 com.hwfs.sm.cmn.dao.CommonDAO.selectMuCd
    gfn_transaction(this
					,"searchMuCd"
					,"sm/cmn/common/selectMuCd.xdo"
					,""
					,"ds_muCd=ds_combo"
					,""
					,"fn_callBack"
					,true);
*/
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조회조건 초기화
 *---------------------------------------------------------------------------------------------*/
function fn_clearSearch(){
    var nRow= ds_search.addRow();
    //ds_search.setColumn(nRow, "occurDate",  fv_sToday);
    ds_search.setColumn(nRow, "muCd",       g_Mu_Cd);
    ds_search.setColumn(nRow, "tmCd",       g_Tm_Cd);
    ds_search.setColumn(nRow, "tmNm",       g_Tm_Nm);
    ds_search.setColumn(nRow, "ccCd",       g_Cc_Cd);
    ds_search.setColumn(nRow, "ccNm",       g_Cc_Nm);
    //ds_search.setColumn(nRow, "upjangCd",   g_Upjang);
    //ds_search.setColumn(nRow, "upjangNm",   g_UpjangNm);
    ds_search.setColumn(nRow, "loginSabun", g_EmpNo);

	//조회조건 헤더생성
	//gds_SmSearch.clearData();
	//gds_SmSearch.addRow();
	
	//달력 초기화
	//cal_slipMon.fn_initMonthCal(this, gfn_getYear()+gfn_getMonth(), "", ds_search, "slipMon", "Y");
	cal_slipMon.fn_initMonthCal(this, fv_taxDay.substring(0,6), "", ds_search, "slipMon", "Y");

	//사용자 버튼 위치 조정
	SCAuth.setUserButton(this, {buttons : [{id:"btn_receive", role:"src", ischange:false}]});	//,{id:"btn_cancel", role:"src", ischange:false}

	gfn_setSlipTypeByMuCd(this, "cbo_slipType", "ds_slipType", MuSearchComponent01.getMuCode());
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조회시 Validation Check
 *---------------------------------------------------------------------------------------------*/
function fn_validCheck(){
/*
	if (gfn_isNull(cbo_muCd.text)){
		gfn_alert("msg.noselect", "사업부");	// $1 을(를) 선택해 주십시요.
		cbo_muCd.setFocus();
		return false;
	}
	if (gfn_isNull(edt_tmNm.value)){
		gfn_alert("msg.noselect", "팀");	// $1 을(를) 선택해 주십시요.
		edt_tmNm.setFocus();
		return false;
	}
	if (gfn_isNull(edt_ccNm.value)){
		gfn_alert("msg.noselect", "CC");	// $1 을(를) 선택해 주십시요.
		edt_ccNm.setFocus();
		return false;
	}
*/
	if (gfn_isNull(cbo_slipType.value)){
		gfn_alert("msg.noselect", "전표유형");	// $1 을(를) 선택해 주십시요.
		cbo_slipType.setFocus();
		return false;
	}
	if(gfn_subStr(cbo_slipType.value,0,1) == "6"){
		if (gfn_isNull(cbo_sysClass.value)){
			gfn_alert("msg.noselect", "시스템구분");	// $1 을(를) 선택해 주십시요.
			cbo_sysClass.setFocus();
			return false;
		}
	}
	if (gfn_isNull(cal_slipMon.text)){
		gfn_alert("msg.noinput", "회계월");	// $1 을(를) 입력해 주십시요.
		cal_occurDate.setFocus();
		return false;
	}
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 입력값 데이터셋 저장(BIND)
 *---------------------------------------------------------------------------------------------*/
function fn_setSmSearchDataset(arg, initYn){

	if(initYn == true){
		//사업부 변경
		if(arg == "MU"){
			edt_tmCd.value		= "";
			edt_tmNm.value		= "";
			edt_ccCd.value		= "";
			edt_ccNm.value		= "";
			edt_upjang.value	= "";
			edt_upjangnm.value	= "";

		//팀 변경	
		}else if(arg == "TM"){
			edt_ccCd.value		= "";
			edt_ccNm.value		= "";
			edt_upjang.value	= "";
			edt_upjangnm.value	= "";
			
		//CC 변경	
		}else if(arg == "CC"){
			edt_upjang.value	= "";
			edt_upjangnm.value	= "";
		}
	}
	gds_SmSearch.setColumn(0, "muCd",		cbo_muCd.value);
	gds_SmSearch.setColumn(0, "muNm",		cbo_muCd.text);
	gds_SmSearch.setColumn(0, "tmCd",		edt_tmCd.value);
	gds_SmSearch.setColumn(0, "tmNm",		edt_tmNm.value);
	gds_SmSearch.setColumn(0, "ccCd",		edt_ccCd.value);
	gds_SmSearch.setColumn(0, "ccNm",		edt_ccNm.value);
	gds_SmSearch.setColumn(0, "upjang",		edt_upjang.value);
	gds_SmSearch.setColumn(0, "upjangnm",	edt_upjangnm.value);
	gds_SmSearch.setColumn(0, "inputVal",	"");
	btn_receive.enable = false; //전표생성 버튼 비활성화	
}

/*----------------------------------------------------------------------------------------------
 * 팝업창 호출
 *---------------------------------------------------------------------------------------------*/
 function fn_openPopup(arg){
	var sUrl = "";
	
	if(arg == "TM")				sUrl = "cmn::SmTmSearchPop.xfdl";
	else if(arg == "CC")		sUrl = "cmn::SmCcSearchPop.xfdl";
	else if(arg == "UPJANG")	sUrl = "cmn::SmUpjangSearchPop.xfdl";

	if(arg == "TM"){
		gds_SmSearch.setColumn(0, "inputVal", 	gds_SmSearch.getColumn(0, "tmNm"));
	}else if(arg == "CC"){
		gds_SmSearch.setColumn(0, "inputVal", 	gds_SmSearch.getColumn(0, "ccNm"));
	}else if(arg == "UPJANG"){
		gds_SmSearch.setColumn(0, "inputVal", 	gds_SmSearch.getColumn(0, "upjangnm"));
	}
	
	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog( arg, sUrl, null, 500, 500, "", -1, -1, false, true, "-1");
	
	if (arrRtn instanceof Object){
	
		//팀
		if(arg == "TM"){
			cbo_muCd.value = arrRtn.muCd;
			edt_tmCd.value = arrRtn.tmCd;
			edt_tmNm.value = arrRtn.tmNm;

		//CC
		}else if(arg == "CC"){
			cbo_muCd.value = arrRtn.muCd;
			edt_tmCd.value = arrRtn.tmCd;
			edt_tmNm.value = arrRtn.tmNm;
			edt_ccCd.value = arrRtn.ccCd;
			edt_ccNm.value = arrRtn.ccNm;
		
		//업장
		}else if(arg == "UPJANG"){
			cbo_muCd.value		= arrRtn.muCd;
			edt_tmCd.value		= arrRtn.tmCd;
			edt_tmNm.value		= arrRtn.tmNm;
			edt_ccCd.value		= arrRtn.ccCd;
			edt_ccNm.value		= arrRtn.ccNm;
			edt_upjang.value	= arrRtn.upjang;
			edt_upjangnm.value	= arrRtn.upjangnm;
		}
		fn_setSmSearchDataset(arg, true);
	}
}

/*----------------------------------------------------------------------------------------------
 * 전표데이터 생성
 *---------------------------------------------------------------------------------------------*/
function fn_setSlipList(){
	if(ds_list.rowcount == 0){
		gfn_alert("msg.search.nodata");	// 조건에 해당하는 자료가 없습니다.
		return false;
	}
	
	if(gfn_isNull(cal_slipPeriodDate.fn_getValue())){
		gfn_alert("전기일자를 확인하세요.");
		return false;
	}
	if(cbo_slipType.value != "6B"){
		if(gfn_isNull(ds_search.getColumn(0, "tmCd"))){
			gfn_alert("팀을 선택해 주세요.");
			return false;
		}
	}

	var sMasterAcct = "";
	var sAcctNm = "";
	var nLcalAmt = 0;
	var nTaxStdAmt = 0;
	var nStdAmt = 0;
	var dTotAmt = 0;
	var cTotAmt = 0;

	ds_sapSlipList.clearData();


	// sap 월마감 체크 FOR 문 밖으로 위치 변경 20160615 처리자:맹수영  (CH201606_00521)
	var muCd = MuSearchComponent01.getMuCode()
	var ccCd = "0";
	var year = cal_slipPeriodDate.fn_getValue().substr(0, 4);
	var mm = cal_slipPeriodDate.fn_getValue().substr(4, 2);

	if( !fn_sapCloseChk(muCd, ccCd, year, mm) )	return;
    // sap 월마감 체크 FOR 문 밖으로 위치 변경
    
	for(var i=0; i<ds_list.rowcount; i++){
	
// 
// 		// sap 월마감 체크
// 		var muCd = ds_list.getColumn(i, "muCd");
// 		var ccCd = ds_list.getColumn(i, "ccCd");
// 		var year = cal_slipPeriodDate.fn_getValue().substr(0, 4);
// 		var mm = cal_slipPeriodDate.fn_getValue().substr(4, 2);
// 
// 		if( !fn_sapCloseChk(muCd, ccCd, year, mm) )	return;

		//입금전표 중복 생성 방지 20180515 김호석
		if (ds_list.getColumn(i, "slipType") == "7A" || ds_list.getColumn(i, "slipType") == "6D") {
			
			//CC코드가 선택된 경우만 체크
			//alert(ds_search.getColumn(0,"ccCd"));
			if (!gfn_isNull(ds_search.getColumn(0,"ccCd"))) {
				//대변으로 끝나야하는데 다시 차변데이타가 들어오는 경우
				if (i > 0) {
					if (ds_list.getColumn(i-1, "drCrClass") == "2" && ds_list.getColumn(i, "drCrClass") == "1") {
						alert("상세 데이타가 중복되었습니다. 재검색 후 생성해주세요");
						fn_search();
						return false;
					}		
				}
			}
		}
		//if(ds_list.getRowLevel(i) == 0){
			if(!gfn_isNull(ds_list.getColumn(i, "custCd"))){
				
				if(gfn_isNull(ds_list.getColumn(i, "sapCustCd"))){
					//alert(ds_list.getColumn(i, "custCd"));
					gfn_alert("<거래처명:"+ds_list.getColumn(i, "custNm") + ", 거래처번호:" + ds_list.getColumn(i, "custCd") +"> 회계팀 미승인 상태입니다.\n" + "거래처 신청/변경 화면에서 확인해주세요");
					ds_list.rowposition = i;
					return;
				}
			}
			//임시로 구매사업부 POS매출 종사업자번호 넣기	
			//alert(ds_list.getColumn(i, "muCd"));
			/*
			if(ds_list.getColumn(i, "muCd") == "2005"){
				if(gfn_isNull(ds_list.getColumn(i, "subUpjangNum"))){					
					ds_list.setColumn(i, "subUpjangNum",	"0180");
				}
			}
			*/
			
			if(ds_list.getColumn(i, "slipType") != "8O"
				&& ds_list.getColumn(i, "slipType") != "7A"
				&& ds_list.getColumn(i, "slipType") != "7B"
				&& ds_list.getColumn(i, "slipType") != "7D"
				&& ds_list.getColumn(i, "slipType") != "7E"
				&& ds_list.getColumn(i, "slipType") != "7F"
				&& ds_list.getColumn(i, "slipType") != "7G"
				&& ds_list.getColumn(i, "slipType") != "7H"
				&& ds_list.getColumn(i, "slipType") != "7J"
				&& ds_list.getColumn(i, "slipType") != "8C"){
				if(!gfn_isNull(ds_list.getColumn(i, "ccCd"))){
					if(gfn_isNull(ds_list.getColumn(i, "subUpjangNum"))){
						gfn_alert("<CC명:" + ds_list.getColumn(i, "ccNm") + ", CC코드:" + ds_list.getColumn(i, "ccCd") +">" + " 종사업장번호가 누락되었습니다." + "\n 전략기획팀에 문의주세요");
						ds_list.rowposition = i;
						return;
					}
				}
			}
			
			if(ds_list.getColumn(i, "drCrClass") == "1"){
				sMasterAcct	= ds_list.getColumn(i, "dAcctCd");
				sAcctNm		= ds_list.getColumn(i, "dAcctNm");
				nLcalAmt	= ds_list.getColumn(i, "dAmt");
				dTotAmt	   += nLcalAmt;
				
			}else{
				sMasterAcct	= ds_list.getColumn(i, "cAcctCd");
				sAcctNm		= ds_list.getColumn(i, "cAcctNm");
				nLcalAmt	= ds_list.getColumn(i, "cAmt");
				cTotAmt	   += nLcalAmt;
			}
			
			//nowSlipType = ds_list.getColumn(i, "slipType");

			ds_sapSlipList.addRow();
			ds_sapSlipList.setColumn(i, "slipNum",			"");
			ds_sapSlipList.setColumn(i, "buCd",				"2000");
			ds_sapSlipList.setColumn(i, "slipType",			ds_list.getColumn(i, "slipType"));
			ds_sapSlipList.setColumn(i, "masterAcct",		sMasterAcct);
			ds_sapSlipList.setColumn(i, "drCrClass",		ds_list.getColumn(i, "drCrClass"));
			ds_sapSlipList.setColumn(i, "ccCd",				ds_list.getColumn(i, "ccCd"));
			ds_sapSlipList.setColumn(i, "slipCurrencyAmt",	nLcalAmt);
			ds_sapSlipList.setColumn(i, "lcalAmt",			nLcalAmt);
			ds_sapSlipList.setColumn(i, "muCd",				ds_list.getColumn(i, "muCd"));
			//외식사업부인 경우
			if (ds_list.getColumn(i, "muCd") == "2003") {
				ds_sapSlipList.setColumn(i, "itemText",			"" + ds_list.getColumn(i, "ccNm")+", " + ds_list.getColumn(i, "slipTypeNm")+" 자동전표");
				ds_sapSlipList.setColumn(i, "slipText",			"" + ds_list.getColumn(i, "ccNm")+", " + ds_list.getColumn(i, "slipTypeNm")+" 자동전표");
				ds_sapSlipList.setColumn(i, "remark",			"" + ds_list.getColumn(i, "ccNm")+", " + ds_list.getColumn(i, "slipTypeNm")+" 자동전표");			
			} else {
				ds_sapSlipList.setColumn(i, "itemText",			"FD, " + ds_list.getColumn(i, "ccNm")+", " + ds_list.getColumn(i, "slipTypeNm")+" 자동전표");
				ds_sapSlipList.setColumn(i, "slipText",			"FD, " + ds_list.getColumn(i, "ccNm")+", " + ds_list.getColumn(i, "slipTypeNm")+" 자동전표");
				ds_sapSlipList.setColumn(i, "remark",			"FD, " + ds_list.getColumn(i, "ccNm")+", " + ds_list.getColumn(i, "slipTypeNm")+" 자동전표");
			}
			
			ds_sapSlipList.setColumn(i, "vatCd",			ds_list.getColumn(i, "vatClass"));
			ds_sapSlipList.setColumn(i, "currency",			"KRW");
			ds_sapSlipList.setColumn(i, "writeEmpSabun",	g_EmpNo);
			ds_sapSlipList.setColumn(i, "writeEmpDept",		g_Cc_Cd);
			ds_sapSlipList.setColumn(i, "writeEmpMuCd",		g_Mu_Cd);
			ds_sapSlipList.setColumn(i, "sysCd",			"IFC");
			ds_sapSlipList.setColumn(i, "fiscalYear",		gfn_getYear());
			ds_sapSlipList.setColumn(i, "slipStatus",		"J");	//J:전표생성
			ds_sapSlipList.setColumn(i, "signStatus",		"N");
			ds_sapSlipList.setColumn(i, "slipMon",			gSlipMon);
			//7I:쿠폰
			//용역상품권 계정인경우 외식사업지원팀으로 생성되도록 변경 20171106 요청자:신나라
			
			/*
			if (ds_list.getColumn(i, "slipType") == "7I" && ds_sapSlipList.getColumn(i, "masterAcct") == "21401050" && ds_list.getColumn(i, "muCd") == "2003"){
			   ds_sapSlipList.setColumn(i, "attachDept",	"315060");
			   ds_sapSlipList.setColumn(i, "ccCdOrg",			ds_list.getColumn(i, "ccCdOrg"));
			} else {
				ds_sapSlipList.setColumn(i, "attachDept",	ds_list.getColumn(i, "ccCd"));	
				ds_sapSlipList.setColumn(i, "ccCdOrg",			ds_list.getColumn(i, "ccCdOrg"));		
			}
			*/
			
				ds_sapSlipList.setColumn(i, "ccCdOrg",		ds_list.getColumn(i, "ccCdOrg"));				
				ds_sapSlipList.setColumn(i, "attachDept",	ds_list.getColumn(i, "ccCd"));		
				
			//쿠폰/상품권 종류의 원가부서로 생성되도록 변경 (쿼리수정) 20190306 요청자:신나라
			if(ds_list.getColumn(i, "slipType") == "7I") {
				//쿼리에서 쿠폰종류의 원가부서로 설정, 나머지는 원업장으로 설정 필요			
				ds_sapSlipList.setColumn(i, "mgmtDept",			ds_list.getColumn(i, "ccCdOrg"));							
				ds_sapSlipList.setColumn(i, "coPaCcCd",			ds_list.getColumn(i, "ccCdOrg"));
			} else {			
				ds_sapSlipList.setColumn(i, "mgmtDept",			ds_list.getColumn(i, "ccCd"));							
				ds_sapSlipList.setColumn(i, "coPaCcCd",			ds_list.getColumn(i, "ccCd"));
			}
				
				ds_sapSlipList.setColumn(i, "vatClass",			ds_list.getColumn(i, "vatClass"));
				ds_sapSlipList.setColumn(i, "slipCreationMm",	gSlipMon);
						
			//종사업장번호(7A,7B,7D,7E,7F,7G,7H,7J) = "" - 9/23 김**팀장
			if(ds_list.getColumn(i, "slipType") != "7A"
				&& ds_list.getColumn(i, "slipType") != "7B"
				&& ds_list.getColumn(i, "slipType") != "7D"
				&& ds_list.getColumn(i, "slipType") != "7E"
				&& ds_list.getColumn(i, "slipType") != "7F"
				&& ds_list.getColumn(i, "slipType") != "7G"
				&& ds_list.getColumn(i, "slipType") != "7H"
				&& ds_list.getColumn(i, "slipType") != "7J"){
				ds_sapSlipList.setColumn(i, "upjang", ds_list.getColumn(i, "subUpjangNum"));	//종사업장번호	 0180			
			}else{
				ds_sapSlipList.setColumn(i, "upjang", "");
			}

			/*********************************************************************************************************
			 * 매출전표
			 *********************************************************************************************************/
			if(gfn_subStr(ds_list.getColumn(i, "slipType"),0,1) == "6"){
				ds_sapSlipList.setColumn(i, "sysClass",			ds_list.getColumn(i, "sysClass"));
				ds_sapSlipList.setColumn(i, "taxShetNum",		ds_list.getColumn(i, "taxShetNum"));
				ds_sapSlipList.setColumn(i, "stdAmt",			ds_list.getColumn(i, "xAmt"));
				ds_sapSlipList.setColumn(i, "taxAmt",			ds_list.getColumn(i, "vAmt"));
			}else if(ds_list.getColumn(i, "slipType") =="8O" && ds_list.getColumn(i, "muCd") == "2005" && ds_list.getColumn(i, "cAcctCd") == "21405000"){
				ds_sapSlipList.setColumn(i, "taxAmt",			ds_list.getColumn(i, "cAmt"));
			//채권채무상계전표 부가세 계정인 경우 부가세정보에 부가세 금액 들어가도록 추가  20160511 요청자:이숙자 처리:맹수영
			}else if(ds_list.getColumn(i, "slipType") =="7G" && ds_list.getColumn(i, "cAcctCd") == "21405000"){
				ds_sapSlipList.setColumn(i, "taxAmt",			ds_list.getColumn(i, "cAmt"));
				//종사업자 번호 추가 20160601  처리자: 맹수영
				ds_sapSlipList.setColumn(i, "upjang",			ds_list.getColumn(i, "subUpjangNum"));
			
			}else if(ds_list.getColumn(i, "slipType") =="8A") {	
				/*
				하단에서 대체번호별로 과세표준, 세액 금액 넣어줌
				if(ds_list.getColumn(i, "cAcctCd") == "21405000"){
					ds_sapSlipList.setColumn(i, "taxAmt",			ds_list.getColumn(i, "vAmt"));
				}
				*/
				//환불전표(8A) 세금계산서 번호 추가 20180828 김호석
				ds_sapSlipList.setColumn(i, "elctntaxBillApprvnum",	ds_list.getColumn(i, "taxShetNum"));
			//영업기타(h&r)유형 추가 20161227 처리자 : 맹수영
			}else if(ds_list.getColumn(i, "slipType") =="1I" ){
				ds_sapSlipList.setColumn(i, "sysClass",			ds_list.getColumn(i, "sysClass"));
			}

			/*********************************************************************************************************
			 * 100% 세금계산서 발행 매출전표 : ELCTNTAX_BILL_APPRVNUM 삽입
			 *********************************************************************************************************/
			if(gTaxSearchYn == "Y"){
				ds_sapSlipList.setColumn(i, "elctntaxBillApprvnum",	ds_list.getColumn(i, "taxShetNum"));
				ds_sapSlipList.setColumn(i, "slipEvidenceDate",	ds_list.getColumn(i, "slipEvidenceDate"));
				ds_sapSlipList.setColumn(i, "slipPeriodDate",	cal_slipPeriodDate.fn_getValue());
				ds_sapSlipList.setColumn(i, "inputDate",		ds_list.getColumn(i, "inputDate"));
				ds_sapSlipList.setColumn(i, "inputTime",		ds_list.getColumn(i, "inputTime"));
			}else{
				if(ds_list.getColumn(i, "slipType") == "7G"){	//채권재무상계일경우 지정번호와 동일월의 말일 
					ds_sapSlipList.setColumn(i, "slipEvidenceDate",	gfn_getLastDate(ds_list.getColumn(i, "occurDate")));								
				}else{
					ds_sapSlipList.setColumn(i, "slipEvidenceDate",	cal_slipPeriodDate.fn_getValue());				
				}
				ds_sapSlipList.setColumn(i, "slipPeriodDate",	cal_slipPeriodDate.fn_getValue());
			}
			
			/*********************************************************************************************************
			 * 거래처별(급식, 외식) 전표발생
			 *********************************************************************************************************/
			if(ds_list.getColumn(i, "muCd") == "2001" || ds_list.getColumn(i, "muCd") == "2004"){
				ds_sapSlipList.setColumn(i, "custCdOrg",		ds_list.getColumn(i, "custCdOrg"));
			}
			
			/*********************************************************************************************************
			 * ASSIGN_NUM : 지정 번호 - "11204014:미수금_신용카드" 일경우 "CARD_DATE" 삽입
			 *********************************************************************************************************/
			if(ds_list.getColumn(i, "dAcctCd") == "11204014" || ds_list.getColumn(i, "cAcctCd") == "11204014"){ //미수금_신용카드
				ds_sapSlipList.setColumn(i, "assignNum",	ds_list.getColumn(i, "cardDate"));
			}else{
				//급식, 외식 매출전표(6A:FS사업,6D:외식사업,6A:장례식장,6F:특판,6A:매점POS,6D:외식POS)
				if(ds_list.getColumn(i, "slipType") == "6A" || ds_list.getColumn(i, "slipType") == "6D" || ds_list.getColumn(i, "slipType") == "6F"){
				
					ds_sapSlipList.setColumn(i, "assignNum",	gfn_subStr(ds_list.getColumn(i, "occurDate"),0,6));
				
				//7A:입금처리, 7B:채권 이관, 7E:선수금이관, 7H:기타 가수금 대체
				}else if(ds_list.getColumn(i, "slipType") == "7A" || ds_list.getColumn(i, "slipType") == "7B"
					  || ds_list.getColumn(i, "slipType") == "7C" || ds_list.getColumn(i, "slipType") == "7D"
					  || ds_list.getColumn(i, "slipType") == "7E" || ds_list.getColumn(i, "slipType") == "7F"
					  || ds_list.getColumn(i, "slipType") == "7G" || ds_list.getColumn(i, "slipType") == "7H" || ds_list.getColumn(i, "slipType") == "7I" 
					  || ds_list.getColumn(i, "slipType") == "8D" || ds_list.getColumn(i, "slipType") == "8O"){
					//alert(ds_list.getColumn(i, "occurDate"));
					ds_sapSlipList.setColumn(i, "assignNum",	ds_list.getColumn(i, "occurDate"));
							
				}else{
				
					ds_sapSlipList.setColumn(i, "assignNum",	gSlipMon);
					
				}
				//리조트 마일리지 지정번호 선수금번호로 등록(선수금_마일리지 계정인 경우) 20200519 김호석
				if(ds_list.getColumn(i, "dAcctCd") == "21401180") {
					//alert(ds_list.getColumn(i, "altNum"));
					ds_sapSlipList.setColumn(i, "assignNum", ds_list.getColumn(i, "altNum"));
				}				
			}

			ds_sapSlipList.setColumn(i, "coPaGuest",		ds_list.getColumn(i, "sapCustCd"));
			ds_sapSlipList.setColumn(i, "mgmtArticle",		ds_list.getColumn(i, "sapCustCd"));

			ds_sapSlipList.setColumn(i, "foSupplyplceNum",	ds_list.getColumn(i, "custCd"));
			ds_sapSlipList.setColumn(i, "foCustNm",			ds_list.getColumn(i, "custNm"));

			/*********************************************************************************************************
			 * SAP 고객사 - 분기(공급업체 vs 거래처)
			 * 공급업체 : 미지급금_거래처, 판매장려금, 외상매입금_거래처
			 * 거래처:Default
			 * "21102010:미지급금_거래처" 경우 SAP거래처를 공급업체에 지급조건키(F000) 삽입
			 *********************************************************************************************************/
			//미지급금_거래처
			if(ds_list.getColumn(i, "dAcctCd") == "21102010" || ds_list.getColumn(i, "cAcctCd") == "21102010"){
				ds_sapSlipList.setColumn(i, "supplyplceNum",	ds_list.getColumn(i, "sapCustCd"));
				ds_sapSlipList.setColumn(i, "mgmtSupplyplce",	ds_list.getColumn(i, "sapCustCd"));
				ds_sapSlipList.setColumn(i, "payCond",			"F000");
				
			//판매장려금 - 7A에서 사용
			}else if(ds_list.getColumn(i, "dAcctCd") == "46117040" || ds_list.getColumn(i, "cAcctCd") == "46117040"){
				ds_sapSlipList.setColumn(i, "supplyplceNum",	ds_list.getColumn(i, "sapCustCd"));
				ds_sapSlipList.setColumn(i, "mgmtSupplyplce",	ds_list.getColumn(i, "sapCustCd"));

			//외상매입금_거래처 - 7A에서 사용
			}else if(ds_list.getColumn(i, "dAcctCd") == "21101010" || ds_list.getColumn(i, "cAcctCd") == "21101010"){
				ds_sapSlipList.setColumn(i, "supplyplceNum",	ds_list.getColumn(i, "sapCustCd"));
				ds_sapSlipList.setColumn(i, "mgmtSupplyplce",	ds_list.getColumn(i, "sapCustCd"));
				ds_sapSlipList.setColumn(i, "payCond",			"F000");
				
			}else{
				ds_sapSlipList.setColumn(i, "guestNum",			ds_list.getColumn(i, "sapCustCd"));
				ds_sapSlipList.setColumn(i, "mgmtGuest",		ds_list.getColumn(i, "sapCustCd"));
			}

			/*********************************************************************************************************
			 * EXPIRE_CAL_BASIS_DATE : 만기 계산 기준일 - 차변에만 들어감
			 *********************************************************************************************************/
			if(ds_list.getColumn(i, "drCrClass") == "1"){
				if(gfn_isNull(ds_list.getColumn(i, "withdrawSchdDate"))){
					ds_sapSlipList.setColumn(i, "expireCalBasisDate",	gfn_getLastDate(gfn_addMonth(fv_sToday, 1)));	//익월 말일
				}else{
					ds_sapSlipList.setColumn(i, "expireCalBasisDate",	ds_list.getColumn(i, "withdrawSchdDate"));
				}
			}
			
			if(ds_list.getColumn(i, "dAcctCd") == "11202010" || ds_list.getColumn(i, "cAcctCd") == "11202010" || ds_list.getColumn(i, "dAcctCd") == "11204014" || ds_list.getColumn(i, "cAcctCd") == "11204014" || ds_list.getColumn(i, "cAcctCd") == "21102010"){	//외상매출금_FO  - 차변/대변에만 들어감
				if(gfn_isNull(ds_list.getColumn(i, "withdrawSchdDate"))){
					ds_sapSlipList.setColumn(i, "expireCalBasisDate",	gfn_getLastDate(gfn_addMonth(fv_sToday, 1)));	//익월 말일
				}else{
					ds_sapSlipList.setColumn(i, "expireCalBasisDate",	ds_list.getColumn(i, "withdrawSchdDate"));
				}
			}
			
			//선수금이관
			if(ds_list.getColumn(i, "slipType") == "7A" || ds_list.getColumn(i, "slipType") == "7E"){
				ds_sapSlipList.setColumn(i, "expireCalBasisDate",	ds_list.getColumn(i, "withdrawSchdDate"));
			}
			
			/*********************************************************************************************************
			 * REASON_CD : 사유코드 입력
			 *********************************************************************************************************/
			if(
				   ds_list.getColumn(i, "dAcctCd") == "11202010" || ds_list.getColumn(i, "cAcctCd") == "11202010"   //외상매출금_FO
				|| ds_list.getColumn(i, "dAcctCd") == "11203010" || ds_list.getColumn(i, "cAcctCd") == "11203010"   //받을어음
				|| ds_list.getColumn(i, "dAcctCd") == "11203020" || ds_list.getColumn(i, "cAcctCd") == "11203020"   //부도수표
				|| ds_list.getColumn(i, "dAcctCd") == "11204014" || ds_list.getColumn(i, "cAcctCd") == "11204014"   //미수금_신용카드_청구
				|| ds_list.getColumn(i, "dAcctCd") == "11204020" || ds_list.getColumn(i, "cAcctCd") == "11204020"   //미수금_타사상품권
				|| ds_list.getColumn(i, "dAcctCd") == "11204030" || ds_list.getColumn(i, "cAcctCd") == "11204030"   //미수금_식권및쿠폰 -- 9/1 추가
				|| ds_list.getColumn(i, "dAcctCd") == "11501010" || ds_list.getColumn(i, "cAcctCd") == "11501010"   //선급금_거래처
				|| ds_list.getColumn(i, "dAcctCd") == "11502060" || ds_list.getColumn(i, "cAcctCd") == "11502060"   //선급비용_보증금상각
				|| ds_list.getColumn(i, "dAcctCd") == "15204010" || ds_list.getColumn(i, "cAcctCd") == "15204010"   //임차보증금
				|| ds_list.getColumn(i, "dAcctCd") == "15204040" || ds_list.getColumn(i, "cAcctCd") == "15204040"   //영업예치보증금
				|| ds_list.getColumn(i, "dAcctCd") == "15204050" || ds_list.getColumn(i, "cAcctCd") == "15204050"   //전신전화가입보증금
			){
				if(ds_list.getColumn(i, "drCrClass") == "1"){
					ds_sapSlipList.setColumn(i, "reasonCd", "A00"); //A00(입금처리 외)
				}else{
					ds_sapSlipList.setColumn(i, "reasonCd", "B00"); //B00(입금처리)
				}
			}else if(
				   ds_list.getColumn(i, "dAcctCd") == "21101010" || ds_list.getColumn(i, "cAcctCd") == "21101010"   //외상매입금_거래처
				|| ds_list.getColumn(i, "dAcctCd") == "21101020" || ds_list.getColumn(i, "cAcctCd") == "21101020"   //외상매입금_지급어음
				|| ds_list.getColumn(i, "dAcctCd") == "21102010" || ds_list.getColumn(i, "cAcctCd") == "21102010"   //미지급금_거래처
				|| ds_list.getColumn(i, "dAcctCd") == "21102011" || ds_list.getColumn(i, "cAcctCd") == "21102011"   //미지급금_부서
				|| ds_list.getColumn(i, "dAcctCd") == "21102040" || ds_list.getColumn(i, "cAcctCd") == "21102040"   //미지급금_법인카드
				|| ds_list.getColumn(i, "dAcctCd") == "21102050" || ds_list.getColumn(i, "cAcctCd") == "21102050"   //미지급금_지급어음
				|| ds_list.getColumn(i, "dAcctCd") == "21302010" || ds_list.getColumn(i, "cAcctCd") == "21302010"   //예수보증금
				|| ds_list.getColumn(i, "dAcctCd") == "21302020" || ds_list.getColumn(i, "cAcctCd") == "21302020"   //기타보증금_부채
				|| ds_list.getColumn(i, "dAcctCd") == "21401010" || ds_list.getColumn(i, "cAcctCd") == "21401010"   //선수금_본사
				|| ds_list.getColumn(i, "dAcctCd") == "21401020" || ds_list.getColumn(i, "cAcctCd") == "21401020"   //선수금_사업장
				|| ds_list.getColumn(i, "dAcctCd") == "21401030" || ds_list.getColumn(i, "cAcctCd") == "21401030"   //선수금_계약이행선납금
				|| ds_list.getColumn(i, "dAcctCd") == "21401040" || ds_list.getColumn(i, "cAcctCd") == "21401040"   //선수금_분양
				|| ds_list.getColumn(i, "dAcctCd") == "21401050" || ds_list.getColumn(i, "cAcctCd") == "21401050"   //선수금_용역상품권
				|| ds_list.getColumn(i, "dAcctCd") == "21401060" || ds_list.getColumn(i, "cAcctCd") == "21401060"   //선수금_통합상품권
				|| ds_list.getColumn(i, "dAcctCd") == "21401070" || ds_list.getColumn(i, "cAcctCd") == "21401070"   //선수금_선매출
				|| ds_list.getColumn(i, "dAcctCd") == "21401080" || ds_list.getColumn(i, "cAcctCd") == "21401080"   //선수금_선수식권
				|| ds_list.getColumn(i, "dAcctCd") == "21401090" || ds_list.getColumn(i, "cAcctCd") == "21401090"   //선수금_외상식권
				|| ds_list.getColumn(i, "dAcctCd") == "21401100" || ds_list.getColumn(i, "cAcctCd") == "21401100"   //선수금_기타
				|| ds_list.getColumn(i, "dAcctCd") == "21401110" || ds_list.getColumn(i, "cAcctCd") == "21401110"   //가수금_수익금
				|| ds_list.getColumn(i, "dAcctCd") == "21401120" || ds_list.getColumn(i, "cAcctCd") == "21401120"   //가수금_가상계좌
				|| ds_list.getColumn(i, "dAcctCd") == "21401130" || ds_list.getColumn(i, "cAcctCd") == "21401130"   //가수금_받을어음
				|| ds_list.getColumn(i, "dAcctCd") == "21401140" || ds_list.getColumn(i, "cAcctCd") == "21401140"   //가수금_반환
				|| ds_list.getColumn(i, "dAcctCd") == "25202030" || ds_list.getColumn(i, "cAcctCd") == "25202030"   //임대보증금
				|| ds_list.getColumn(i, "dAcctCd") == "21401180" || ds_list.getColumn(i, "cAcctCd") == "21401180"   //선수금_마일리지
			){
				if(ds_list.getColumn(i, "drCrClass") == "1"){
					ds_sapSlipList.setColumn(i, "reasonCd", "B00"); //B00(입금처리)
				}else{
					ds_sapSlipList.setColumn(i, "reasonCd", "A00"); //A00(입금처리 외)
				}
			}

			//7B:채권이관(차변)/7E:선수금이관(대변) >> 사유코드 예외처리
			if(ds_list.getColumn(i, "slipType") == "7B" || ds_list.getColumn(i, "slipType") == "7E"){
				if(nLcalAmt > 0){
					ds_sapSlipList.setColumn(i, "reasonCd", "A00"); //A00(입금처리 외)	-- 발생
				}else{
					ds_sapSlipList.setColumn(i, "reasonCd", "B00"); //B00(입금처리) 	-- 소멸
				}
			}

			/*********************************************************************************************************
			 * 기타 : 정리된 문서가 없음. 수정할때마다 확인 요망
			 *********************************************************************************************************/
			//식재매출전표
			//if(ds_list.getColumn(i, "slipType") == "6B"){
			//	if(ds_list.getColumn(i, "sysClass") == "13"){
			//		ds_sapSlipList.setColumn(i, "ccCdOrg",	ds_list.getColumn(i, "ccCdOrg"));
			//	}
			//}
			
			//7A:입금관리
			if(ds_list.getColumn(i, "slipType") == "7A"){
				ds_sapSlipList.setColumn(i, "nextBuCd",		ds_list.getColumn(i, "nextBuCd"));
				//ds_sapSlipList.setColumn(i, "ccCdOrg",		ds_list.getColumn(i, "ccCdOrg"));
			}
			 
			//7B:채권이관, 7E:선수금이관, 8C:Helper
			if(ds_list.getColumn(i, "slipType") == "7B" || ds_list.getColumn(i, "slipType") == "7E" || ds_list.getColumn(i, "slipType") == "8C"){
				//ds_sapSlipList.setColumn(i, "ccCdOrg",	ds_list.getColumn(i, "ccCdOrg"));
			}
			 
			//7C:선수금 발생 관리
			if(ds_list.getColumn(i, "slipType") == "7C"){
				ds_sapSlipList.setColumn(i, "expireCalBasisDate",	gfn_getLastDate(gfn_addMonth(fv_sToday, 1)));	//익월 말일
				
			//7H:기타 가수금 대체
			}else if(ds_list.getColumn(i, "slipType") == "7H"){
				ds_sapSlipList.setColumn(i, "suspenseAltType",		ds_list.getColumn(i, "suspenseAltType"));
				ds_sapSlipList.setColumn(i, "expireCalBasisDate",	gfn_getLastDate(gfn_addMonth(fv_sToday, 1)));	//익월 말일
				ds_sapSlipList.setColumn(i, "nextBuCd",		ds_list.getColumn(i, "nextBuCd"));

			//7J:상품권 청구
			}else if(ds_list.getColumn(i, "slipType") == "7J"){
				if(ds_list.getColumn(i, "dAcctCd") == "43216050" || ds_list.getColumn(i, "cAcctCd") == "43216050"){ //지급수수료_기타수수료
					ds_sapSlipList.setColumn(i, "mgmtGuest",	"");
				}
				ds_sapSlipList.setColumn(i, "elctntaxBillApprvnum",	ds_list.getColumn(i, "taxShetNum"));
				ds_sapSlipList.setColumn(i, "taxShetNum",			ds_list.getColumn(i, "taxShetNum"));
				ds_sapSlipList.setColumn(i, "inputDate",			ds_list.getColumn(i, "inputDate"));
				ds_sapSlipList.setColumn(i, "inputTime",			ds_list.getColumn(i, "inputTime"));
				//ds_sapSlipList.setColumn(i, "ccCdOrg",				ds_list.getColumn(i, "ccCdOrg"));
				ds_sapSlipList.setColumn(i, "giftBillingNum",		ds_list.getColumn(i, "giftBillingNum"));
				//청구번호 별로 업데이트 되도록 수정 20190107 김호석
				ds_sapSlipList.setColumn(i, "altNum",		ds_list.getColumn(i, "giftBillingNum"));				
				
				//if(gfn_isNull(ds_sapSlipList.getColumn(i, "taxShetNum"))){
				//	gfn_alert("해당 전표에 세금계산서번호가 누락 되었습니다.");
				//	return false;
				//}

			//7I:쿠폰
			}else if(ds_list.getColumn(i, "slipType") == "7I"){
				ds_sapSlipList.setColumn(i, "reasonCd",	"A00");	//발생
				ds_sapSlipList.setColumn(i, "expireCalBasisDate",	gfn_getLastDate(gfn_addMonth(fv_sToday, 1)));	//익월 말일
			    
			    //용역상품권 계정인경우 외식사업지원팀으로 생성되도록 변경 20160203 요청자:박선경
			    //쿼리에서 원가부서 가져오도록 수정해서 삭제 20190307 김호석
			    /*
			    if (ds_sapSlipList.getColumn(i, "masterAcct") == "21401050"){
			       ds_sapSlipList.setColumn(i, "ccCd",	"315060");
			    }
			    */
			    
			//7J:상품권 청구 >> 매출도 복사
			//}else if(ds_list.getColumn(i, "slipType") == "7J"){
			//	ds_sapSlipList.setColumn(i, "taxShetNum",	ds_list.getColumn(i, "taxShetNum"));

			//8A:영업환불(영업미지급)
			}else if(ds_list.getColumn(i, "slipType") == "8A"){
				ds_sapSlipList.setColumn(i, "singlePayYn",	ds_list.getColumn(i, "singlePayYn"));
				ds_sapSlipList.setColumn(i, "tempCustNm",	ds_list.getColumn(i, "bankAcctOwnr"));
				ds_sapSlipList.setColumn(i, "bankCd",		ds_list.getColumn(i, "bankCd"));
				ds_sapSlipList.setColumn(i, "bankAcctOwnr",	ds_list.getColumn(i, "bankAcctOwnr"));
				ds_sapSlipList.setColumn(i, "bankAcctNo",	ds_list.getColumn(i, "bankAcctNo"));
				
			//	if(ds_list.getColumn(i, "cAcctCd") == "11101021"){	//대손상각비
			//		ds_sapSlipList.setColumn(i, "mgmtGuest",	"");
			//	}
				if(ds_list.getColumn(i, "drCrClass") == "2" && ds_list.getColumn(i, "sapCustCd") == "90002"){
					ds_sapSlipList.setColumn(i, "mgmtGuest",	"");
			//	//    ds_sapSlipList.setColumn(i, "reasonCd", "Y");
				}
				
			//8B:원가 이관, 8C:Helper
			}else if(ds_list.getColumn(i, "slipType") == "8B" || ds_list.getColumn(i, "slipType") == "8C"){
				ds_sapSlipList.setColumn(i, "slipUpjang",	ds_list.getColumn(i, "upjang"));
				
			//8D:영업기타
			}else if(ds_list.getColumn(i, "slipType") == "8D" || ds_list.getColumn(i, "slipType") == "7D"
				  || ds_list.getColumn(i, "slipType") == "7G" || ds_list.getColumn(i, "slipType") == "8O"){
				if(ds_list.getColumn(i, "dAcctCd") == "43224000" || ds_list.getColumn(i, "cAcctCd") == "43224000"){	//대손상각비
					ds_sapSlipList.setColumn(i, "mgmtGuest",	"");
				}
				ds_sapSlipList.setColumn(i, "sysClass",			ds_list.getColumn(i, "sysClass"));
				ds_sapSlipList.setColumn(i, "suspenseAltType",	ds_list.getColumn(i, "suspenseAltType"));
			}

			//전자결재 유무
			if(ds_list.getColumn(i, "slipType") == "7D"){
				ds_sapSlipList.setColumn(i, "signType",	"2");	//서면결재
			}else{
				ds_sapSlipList.setColumn(i, "signType",	"1");	//전자결재
			}
			
			//8O:내부이용가계정(내부매출) - 영수증번호 세팅
			if(ds_list.getColumn(i, "slipType") == "8O"){
				ds_sapSlipList.setColumn(i, "receiptNum",	ds_list.getColumn(i, "receiptNum"));
				//ds_sapSlipList.setColumn(i, "ccCdOrg",		ds_list.getColumn(i, "ccCdOrg"));
				ds_sapSlipList.setColumn(i, "nextBuCd",		ds_list.getColumn(i, "nextBuCd"));
			}
			//8A:환불전표 - 대체번호 세팅
			if(ds_list.getColumn(i, "slipType") == "8A"){
				ds_sapSlipList.setColumn(i, "altNum",	ds_list.getColumn(i, "altNum"));
				//ds_sapSlipList.setColumn(i, "ccCdOrg",		ds_list.getColumn(i, "ccCdOrg"));
				//ds_sapSlipList.setColumn(i, "nextBuCd",		ds_list.getColumn(i, "nextBuCd"));
			}
			//7H:기타입금 대체전표 - 대체 or 입금번호 세팅
			if(ds_list.getColumn(i, "slipType") == "7H"){
				ds_sapSlipList.setColumn(i, "altNum",	ds_list.getColumn(i, "altNum"));
				//ds_sapSlipList.setColumn(i, "ccCdOrg",		ds_list.getColumn(i, "ccCdOrg"));
				//ds_sapSlipList.setColumn(i, "nextBuCd",		ds_list.getColumn(i, "nextBuCd"));
			}
			//7G:외상 매입대체 은행 타입
			if(ds_list.getColumn(i, "slipType") == "7G"){
				if(ds_list.getColumn(i, "drCrClass") == "1"){
					ds_sapSlipList.setColumn(i, "crgleftClass",		ds_list.getColumn(i, "crgleftClass"));
					ds_sapSlipList.setColumn(i, "nextBuCd",		ds_list.getColumn(i, "nextBuCd"));
				}
			}
			if(ds_list.getColumn(i, "dAcctCd") == "21101010"){
				if(ds_list.getColumn(i, "drCrClass") == "1"){
					ds_sapSlipList.setColumn(i, "crgleftClass",		ds_list.getColumn(i, "crgleftClass"));
			//		ds_sapSlipList.setColumn(i, "assignNum",	gfn_subStr(cal_slipPeriodDate.fn_getValue(),0,6));
					ds_sapSlipList.setColumn(i, "slipEvidenceDate",	cal_slipPeriodDate.fn_getValue());
					if(ds_search.getColumn(0, "tmCd") == "CEF"){
						ds_sapSlipList.setColumn(i, "expireCalBasisDate",		gfn_subStr(gfn_getLastDate(gfn_addMonth(fv_sToday, 1)),0,6) + "10");
					}else{
						ds_sapSlipList.setColumn(i, "expireCalBasisDate",		cal_slipPeriodDate.fn_getValue());
					}
				}
			}

			/*********************************************************************************************************
			 * STD_AMT : 과세 표준 금액(전표 통화), TAX_AMT : 세액(전표 통화) 계산
			 *********************************************************************************************************/
			if(gfn_subStr(ds_list.getColumn(i, "slipType"),0,1) == "6"){
				ds_sapSlipList.setColumn(i, "stdAmt",	ds_list.getColumn(i, "xAmt"));
			}else{

				//차변
				if(ds_list.getColumn(i, "drCrClass") == "1"){	
					if(ds_list.getColumn(i, "dAcctCd") == "11503000"){	//매입부가세
						for(var j=0; j<ds_list.rowcount; j++){
							if(ds_list.getColumn(j, "drCrClass") == "1"){
								if(ds_list.getColumn(j, "dAcctCd") == "43216050"){	//지급수수료_기타수수료
									nStdAmt		+= ds_list.getColumn(j, "dAmt");
								}
								//if(ds_list.getColumn(j, "dAcctCd") != "11503000"){
								//	nStdAmt		+= ds_list.getColumn(j, "dAmt");
								//}
							}
						}
						ds_sapSlipList.setColumn(i, "stdAmt",	nStdAmt);
						ds_sapSlipList.setColumn(i, "taxAmt",	nLcalAmt);
						nStdAmt = 0;
					}
				}
				
				//대변
				if(ds_list.getColumn(i, "drCrClass") == "2"){
					//21405000:매출부가세, 90007020:매출부가세 가계정, 41209040:기타매출_기타
					if(ds_list.getColumn(i, "cAcctCd") == "21405000" || ds_list.getColumn(i, "cAcctCd") == "90007020" || ds_list.getColumn(i, "cAcctCd") == "41209040"){	//21405000:매출부가세, 90007020:매출부가세 가계정
					
						for(var j=0; j<ds_list.rowcount; j++){
						
							if(ds_list.getColumn(i, "custCd") == ds_list.getColumn(j, "custCd")){
								if(ds_list.getColumn(j, "drCrClass") == "2"){
									if(ds_list.getColumn(i, "muCd") == "2004"){	//식재영업
										if(ds_list.getColumn(j, "cAcctCd") == "41201010"){	//41201010:상품매출_일반 : 공급가액
											nStdAmt		= ds_list.getColumn(j, "cAmt");
										}
										if(ds_list.getColumn(j, "cAcctCd") == "41209040"){	//41209040:기타매출_기타 : 공급가액
											nStdAmt		= ds_list.getColumn(j, "cAmt");
										}	
									}else if(ds_list.getColumn(i, "muCd") == "2003" || ds_list.getColumn(i, "muCd") == "2002" || ds_list.getColumn(i, "muCd") == "2001"){	//외식영업, 단체급식
										//if(ds_list.getColumn(j, "cAcctCd") != "21405000" && ds_list.getColumn(j, "cAcctCd") != "45114050"){
										if(ds_list.getColumn(j, "cAcctCd") != "45114050"){
											if(ds_list.getColumn(i, "vatClass") == ds_list.getColumn(j, "vatClass")){
												//alert(ds_list.getColumn(j, "vatClass"));
												//alert("매출부가세");
												//채권채무상계전표  -부가세인경우 공급가액, 부가세액 오류로 수정 20160511
												if(ds_list.getColumn(i, "slipType") == "7G"){
												    nStdAmt		+= ds_list.getColumn(i, "xAmt") ;
												//영업환불 매출부가세 과세표준금액, 세액 잘못들어가는 문제 수정 김호석 20180828
												} else if(ds_list.getColumn(i, "slipType") == "8A"){	
														//같은 거래처로 여러번 환불하는 경우 같은 대체번호의 금액으로 과세표준, 세액 가져오도록 오류 수정 20181011 김호석
														if(ds_list.getColumn(i, "altNum") == ds_list.getColumn(j, "altNum")){
														//같은 대체 번호별 과세표준금액, 세액으로 들어가도록 처리
															for(var k=0; k<ds_list.rowcount; k++){
																if(ds_list.getColumn(k, "drCrClass") == "1"){
																   if(ds_list.getColumn(i, "altNum") == ds_list.getColumn(k, "altNum")){
																		nStdAmt		= ds_list.getColumn(j, "cAmt");	
																   }
																}												    										    
															}    
														}
												} else {
												
													nStdAmt		+= ds_list.getColumn(j, "cAmt");		
													
												}
												
												
											}
										}

									}else if(ds_list.getColumn(i, "muCd") == "2005"){
										if(ds_list.getColumn(j, "cAcctCd") != "21405000"){
											if(ds_list.getColumn(i, "vatClass") == ds_list.getColumn(j, "vatClass")){
												nStdAmt		+= ds_list.getColumn(j, "cAmt");
											}
										}
									}
								}
							}
						}

						//if(ds_list.getColumn(i, "cAcctCd") == "21405000"){	//21405000:매출부가세 : 부가세
						//영업환불 매출부가세 과세표준금액, 세액 잘못들어가는 문제 수정 김호석 20170406
						if(ds_list.getColumn(i, "slipType") == "8A"){ 
							if(ds_list.getColumn(i, "cAcctCd") == "21405000"){			
								//alert(ds_sapSlipList.getColumn(i, "altNum") + " - " + ds_sapSlipList.getColumn(i, "foCustNm")+ " -lcalAmt:" + ds_sapSlipList.getColumn(i, "lcalAmt") +  " : " + nStdAmt);
								ds_sapSlipList.setColumn(i, "stdAmt",		nStdAmt*10);
								ds_sapSlipList.setColumn(i, "taxAmt",		nStdAmt);								
							}
						//기타입금대체 매출부가세가계정 과세표준금액, 세액 잘못들어가는 문제 수정 김호석 20180508
						} else if(ds_list.getColumn(i, "slipType") == "7H"){ 
							if(ds_list.getColumn(i, "cAcctCd") == "90007020:"){																
								ds_sapSlipList.setColumn(i, "stdAmt",		nStdAmt*10);
								ds_sapSlipList.setColumn(i, "taxAmt",		nStdAmt);								
							}
						} else {
							if((ds_sapSlipList.getColumn(i, "lcalAmt")<0) && (nStdAmt > 0)){
								nStdAmt = nStdAmt * -1;
							}
							ds_sapSlipList.setColumn(i, "stdAmt",		nStdAmt);
							nStdAmt = 0;
						}
						//}
					}
				}
			}
		//}
	}
//alert(cTotAmt + ":" + dTotAmt);
	if(dTotAmt != cTotAmt){
		gfn_alert("차변금액의 합계와 대변금액의 차액 ["+gfn_numFormat(parseFloat(cTotAmt - dTotAmt),1000)+"]이 발생합니다. 전표를 생성 할 수 없습니다.");
		return;
	}
	fn_save();
}

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 사업부 변경 EVENT
 *---------------------------------------------------------------------------------------------*/
function cbo_muCd_onitemchanged(obj:Combo, e:ItemChangeEventInfo){
	fn_setSmSearchDataset("MU", true);
	ds_slipType.clearData();
	ds_sysClass.clearData();
	cbo_slipType.value = "";
	cbo_sysClass.value = "";
	gfn_setSlipTypeByMuCd(this, "cbo_slipType", "ds_slipType", cbo_muCd.value);
}

/*----------------------------------------------------------------------------------------------
 * 팀 팝업버튼 클릭 EVENT
 *---------------------------------------------------------------------------------------------*/
function btn_tmCd_onclick(obj:Button,  e:ClickEventInfo){
	fn_openPopup("TM");
}

/*----------------------------------------------------------------------------------------------
 * 팀 keydown EVENT
 *---------------------------------------------------------------------------------------------*/
function edt_tmNm_onkeydown(obj:Edit, e:KeyEventInfo){
	if(e.keycode == 13){		//Enter 키
		//if(!gfn_isNull(edt_tmNm.value)) parent.fn_search();
	}else if(e.keycode == 46){	//Del 키
		fn_setSmSearchDataset("MU", true);
	}
}

/*----------------------------------------------------------------------------------------------
 * 팀 변경 EVENT
 *---------------------------------------------------------------------------------------------*/
function edt_tmNm_ontextchanged(obj:Edit,  e:TextChangedEventInfo){
	fn_setSmSearchDataset("TM", true);
}

/*----------------------------------------------------------------------------------------------
 * CC 팝업버튼 클릭 EVENT
 *---------------------------------------------------------------------------------------------*/
function btn_ccCd_onclick(obj:Button,  e:ClickEventInfo){
	fn_openPopup("CC");
}

/*----------------------------------------------------------------------------------------------
 * CC keydown EVENT
 *---------------------------------------------------------------------------------------------*/
function edt_ccNm_onkeydown(obj:Edit, e:KeyEventInfo){
	if(e.keycode == 13){		//Enter 키
		//if(!gfn_isNull(edt_ccNm.value)) parent.fn_searc h();
	}else if(e.keycode == 46){	//Del 키
		btn_receive.enable = false; //전표생성 버튼 비활성화	
		fn_setSmSearchDataset("TM", true);		
	}
}

/*----------------------------------------------------------------------------------------------
 * CC 변경 EVENT
 *---------------------------------------------------------------------------------------------*/
function edt_ccNm_ontextchanged(obj:Edit,  e:TextChangedEventInfo){
	fn_setSmSearchDataset("CC", true);
}

/*----------------------------------------------------------------------------------------------
 * 전표처리 Click EVENT
 *---------------------------------------------------------------------------------------------*/
function btn_receive_onclick(obj:Button,  e:ClickEventInfo){

	//12월 발행 제한 
	//alert(cal_slipPeriodDate.text);
	/*
	if(MuSearchComponent01.getMuCode() == "2003"){
		//pass
	} else {
		if ((cal_slipPeriodDate.text > '20201200') ) {
			ds_search.setColumn(0,"slipPeriodDate","20201130");
			alert("12월 전표 발행 불가");
			//ds_taxShetMst.setColumn(0, "publishDate","20201130");
			//ds_taxShetMst.setColumn(0, "fiscalDate","20201130");
			return false;
		}
	}
	*/
	
    //회계월이 전기일자보다 크면 막기 20160510
    if ( cal_slipMon.text > gfn_subStr(cal_slipPeriodDate.text,0,6) ) {
        gfn_alert("회계월이 전기일자보다 클 수 없습니다.");
        return;
    } 
	//세금계산서로 전표발행 하는 경우 회계월이 전기일자보다 작으면 막기 20170322 김호석 (식재영업, 물류매출, 기타매출(페유)) CH201703_00711
	if (cbo_slipType.value == "6B" || cbo_slipType.value == "6C"  || cbo_slipType.value == "6G" || cbo_slipType.value == "6H" || cbo_slipType.value == "7J") {
		if ( cal_slipMon.text < gfn_subStr(cal_slipPeriodDate.text,0,6) ) {
			gfn_alert("세금계산서발행 후 전표생성하는 6B, 6C, 6G ,6H, 7J 전표유형의 경우 회계월이 전기월보다 작을 수 없습니다. 필요 시 재경팀에 문의해주세요");
			return;
		}
	}	
	
	//전표생성 전 건수/금액 
	be_cnt = ds_list.rowcount;
	be_amt = ds_list.getSum('dAmt');
	//alert(be_cnt + ", " + be_amt);
	
	ds_list.clear();
	//전표생성전 재조회(조회 후 변경내역 확인) 20180719 김호석
	fn_search("C");	
	/*
	//전표생성 클릭시 건수/금액 
	af_cnt = ds_list.rowcount;
	af_amt = ds_list.getSum('dAmt');
	//alert(be_cnt + ", " + be_amt);
	//alert("전건수:" + be_cnt + " 현건수:" + af_cnt + " 전금액:" + be_amt + " 현금액:" + af_amt);
	
	var bt_cnt = 0;
	var bt_amt = 0;
	
	//조회 후 전표생성 시 비교 20180719 김호석
	if (be_cnt <> af_cnt) {		
		if (af_cnt > 0) {
			bt_cnt = af_cnt- be_cnt;
			alert("조회 건수가 " + be_cnt + "건에서 "+af_cnt+"건으로 "+ bt_cnt + "건 변경되었습니다." );
		}
	}
	
	if (be_amt <> af_amt) {
		if (af_amt > 0) {
			bt_amt = af_amt - be_amt;
			alert("조회 금액이 " + be_amt + "원에서 "+af_amt+"원으로 " + bt_amt + "원 변경되었습니다." );
		}
	}
	
	//재조회 시 전표 생성대상 결과가 없으면 패스 20181114 김호석
	if (af_cnt > 0) {
		fn_setSlipList();	//전표데이터 생성
	} else {
		alert("전표 생성 조건에 해당하는 자료가 없습니다.");
	}
	*/
}

/*----------------------------------------------------------------------------------------------
 * 전표유형 변경 EVENT
 *---------------------------------------------------------------------------------------------*/
function cbo_slipType_onitemchanged(obj:Combo, e:ItemChangeEventInfo){
	ds_sysClass.clearData();
	cbo_sysClass.value = "";
	cbo_sysClass.enable = false;
	if( cbo_slipType.value == "6A" || cbo_slipType.value == "6B" || cbo_slipType.value == "6C" ||
		cbo_slipType.value == "6D" || cbo_slipType.value == "6E" || cbo_slipType.value == "6F" ||
		//영업기타(h&r)유형 추가 20161227 처리자 : 맹수영
		cbo_slipType.value == "6G" || cbo_slipType.value == "6H" || cbo_slipType.value == "1I" ){
		cbo_sysClass.enable = true;
		gfn_setSysClassBySlipType(this, "cbo_sysClass", "ds_sysClass", cbo_slipType.value);
	}
	//초기화
	ds_list.clear();
	ds_list.clearData();
	btn_receive.enable = false;
	btn_cancel.enable = false;					
}

/*----------------------------------------------------------------------------------------------
 * 업장 팝업버튼 클릭 EVENT
 *---------------------------------------------------------------------------------------------*/
function btn_upjangCd_onclick(obj:Button,  e:ClickEventInfo){
	//fn_openPopup("UPJANG");
}

/*----------------------------------------------------------------------------------------------
 * 업장 keydown EVENT
 *---------------------------------------------------------------------------------------------*/
function edt_upjangnm_onkeydown(obj:Edit, e:KeyEventInfo){
	//if(e.keycode == 13){		//Enter 키
	//	//if(!gfn_isNull(edt_upjangnm.value)) parent.fn_search();
	//}else if(e.keycode == 46){	//Del 키
	//	fn_setSmSearchDataset("CC", true);
	//}
}

/*----------------------------------------------------------------------------------------------
 * 업장 변경 EVENT
 *---------------------------------------------------------------------------------------------*/
function edt_upjangnm_ontextchanged(obj:Edit,  e:TextChangedEventInfo){
	fn_setSmSearchDataset("UPJANG", true);
}

/*----------------------------------------------------------------------------------------------
 * 전표 생성 취소 Click EVENT
 *---------------------------------------------------------------------------------------------*/
function btn_cancel_onclick(obj:Button,  e:ClickEventInfo){
	//var sSlipNum	= new Array();
	//for(var i=0; i<ds_list.rowcount; i++){
	//	if(!gfn_isNull(ds_list.getColumn(i, "journalzNum"))){
	//		sSlipNum[i] = ds_list.getColumn(i, "journalzNum");
	//	}
	//}
	ds_sapSlipCancelList.clearData();
	
	for(var i=0; i<ds_list.rowcount; i++){
		ds_sapSlipCancelList.addRow();
		ds_sapSlipCancelList.setColumn(i, "slipNum",			ds_list.getColumn(i, "journalzNum"));
		ds_sapSlipCancelList.setColumn(i, "buCd",				"2000");
		ds_sapSlipCancelList.setColumn(i, "slipType",			ds_list.getColumn(i, "slipType"));
		ds_sapSlipCancelList.setColumn(i, "drCrClass",			ds_list.getColumn(i, "drCrClass"));
		ds_sapSlipCancelList.setColumn(i, "ccCd",				ds_list.getColumn(i, "ccCd"));
		ds_sapSlipCancelList.setColumn(i, "muCd",				ds_list.getColumn(i, "muCd"));
	}
		
	if(!gfn_confirm("해당 전표를 취소하시겠습니까?")) return;

	gfn_transaction(this
					,"cancel"
					,"sm/srm/sapSlipUpload/cancelSlipList.xdo"
					,"ds_sapSlipCancelList=ds_sapSlipCancelList:U"
					,""
					,""
					,"fn_callBack"
					,true);
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 미마감조회에서 이동할 경우 조회조건 세팅
 *---------------------------------------------------------------------------------------------*/
function fn_searchBySapSlipNonUploadList(arrArg){
    var v_arg = arrArg;
    
    if(typeof v_arg == "undefined") return;

	if(!gfn_isNull(v_arg)) {
		gScreenYn = "Y";
		ds_search.setColumn(0, "muCd",      arrArg[0]);
		ds_search.setColumn(0, "tmCd",      arrArg[1]);
		ds_search.setColumn(0, "tmNm",      arrArg[2]);
		ds_search.setColumn(0, "ccCd",  	arrArg[3]);
		ds_search.setColumn(0, "ccNm",  	arrArg[4]);
		ds_search.setColumn(0, "slipType", 	arrArg[5]);
		ds_search.setColumn(0, "slipMon", 	arrArg[6]);
		ds_search.setColumn(0, "sysClass",  arrArg[7]);
		
		if( gfn_subStr(arrArg[5],0,1) == "6"){
			cbo_sysClass.enable = true;
			gfn_setSysClassBySlipType(this, "cbo_sysClass", "ds_sysClass", arrArg[5]);
		}else{
			ds_sysClass.clearData();
			cbo_sysClass.value	= "";
			cbo_sysClass.enable = false;
			fn_search();
		}
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 미마감조회에서 이동할 경우 조회조건 세팅 (이미 화면이 열려 있을 경우 사용)
 *---------------------------------------------------------------------------------------------*/
function fn_getScreenParams(arrArg){
	fn_searchBySapSlipNonUploadList(arrArg);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : sap 월마감 체크
 *---------------------------------------------------------------------------------------------*/
 function fn_sapCloseChk(muCd, ccCd, year, mm)
 {
	var rtn = true;

	var args  = "year=" + wrapQuote(year);
		args += " mm=" + wrapQuote(mm);
		args += " muCd=" + wrapQuote(muCd);
		args += " ccCd=" + wrapQuote(ccCd);

	gfn_transaction(this
					,"sapClose"
					,"sm/srm/sapSlipUpload/selectSapClose.xdo"
					,""
					,"ds_sapClose=ds_sapClose"
					,args
					,""
					,false);

	if( ds_sapClose.getColumn(0, "sapClose") == "Y" )
	{
		gfn_alert("SAP 회계 월마감 되었습니다. 회계팀에 문의하세요.");
		rtn = false;
	}

	return rtn;
}

 function fn_sapCloseChk2(muCd, ccCd, year, mm)
 {
	var rtn = true;

	var args  = "year=" + wrapQuote(year);
		args += " mm=" + wrapQuote(mm);
		args += " muCd=" + wrapQuote(muCd);
		args += " ccCd=" + wrapQuote(ccCd);

	gfn_transaction(this
					,"sapClose"
					,"sm/srm/sapSlipUpload/selectSapClose.xdo"
					,""
					,"ds_sapClose=ds_sapClose"
					,args
					,""
					,false);

	if( ds_sapClose.getColumn(0, "sapClose") == "Y" )
	{
		//gfn_alert("SAP 회계 월마감 되었습니다. 회계팀에 문의하세요.");
		rtn = false;
	}

	return rtn;
}
function cbo_sysClass_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	//초기화
	ds_list.clear();
	ds_list.clearData();
	btn_receive.enable = false;
	btn_cancel.enable = false;		
		
}
]]></Script>
  </Form>
</FDL>

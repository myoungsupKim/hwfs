<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="UpjangMealList" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 858" titletext="사업장별 식수집계" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Grid id="grd_list" taborder="11" autoenter="none" useinputpanel="false" cellsizingtype="col" position="absolute 0 95 1237 508" formats="&lt;Formats&gt;&#10;  &lt;Format id=&quot;default&quot;&gt;&#10;    &lt;Columns&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;    &lt;/Columns&gt;&#10;    &lt;Rows&gt;&#10;      &lt;Row band=&quot;head&quot; size=&quot;24&quot;/&gt;&#10;      &lt;Row band=&quot;body&quot; size=&quot;24&quot;/&gt;&#10;    &lt;/Rows&gt;&#10;    &lt;Band id=&quot;head&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;카드접수유형명&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;카드사코드&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;카드사명&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;입금주기&quot;/&gt;&#10;      &lt;Cell col=&quot;4&quot; disptype=&quot;normal&quot; text=&quot;수수료율&quot;/&gt;&#10;    &lt;/Band&gt;&#10;    &lt;Band id=&quot;body&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;bind:카드접수유형명&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;bind:카드사코드&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;bind:카드사명&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;bind:입금주기&quot;/&gt;&#10;      &lt;Cell col=&quot;4&quot; disptype=&quot;normal&quot; text=&quot;bind:수수료율&quot;/&gt;&#10;    &lt;/Band&gt;&#10;  &lt;/Format&gt;&#10;&lt;/Formats&gt;&#10;" binddataset="ds_list" autofittype="none" autosizingtype="none" anchor="left top right">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="25"/>
                <Column size="65"/>
                <Column size="28"/>
                <Column size="55"/>
                <Column size="56"/>
                <Column size="56"/>
                <Column size="40"/>
                <Column size="45"/>
                <Column size="51"/>
                <Column size="54"/>
                <Column size="40"/>
                <Column size="52"/>
                <Column size="33"/>
                <Column size="40"/>
                <Column size="44"/>
                <Column size="83"/>
                <Column size="77"/>
                <Column size="72"/>
                <Column size="75"/>
                <Column size="72"/>
                <Column size="85"/>
                <Column size="78"/>
                <Column size="97"/>
                <Column size="60"/>
                <Column size="80"/>
                <Column size="60"/>
                <Column size="75"/>
                <Column size="77"/>
                <Column size="141"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                <Cell col="1" rowspan="2" text="매출일자" taborder="undefined"/>
                <Cell col="2" rowspan="2" text="요일" taborder="undefined"/>
                <Cell col="3" colspan="7" text="식음료식수" taborder="undefined"/>
                <Cell col="10" rowspan="2" text="행사&#13;&#10;식수" taborder="undefined"/>
                <Cell col="11" rowspan="2" text="부가매출&#13;&#10;식수" taborder="undefined"/>
                <Cell col="12" rowspan="2" text="기타&#13;&#10;식수" taborder="undefined"/>
                <Cell col="13" rowspan="2" text="카페&#13;&#10;식수" taborder="undefined"/>
                <Cell col="14" rowspan="2" text="계" taborder="undefined"/>
                <Cell col="15" colspan="8" text="식음료매출" taborder="undefined"/>
                <Cell col="23" colspan="2" text="상품매출" taborder="undefined"/>
                <Cell col="25" colspan="2" text="기타매출" taborder="undefined"/>
                <Cell col="27" rowspan="2" text="내부매출" taborder="undefined"/>
                <Cell col="28" rowspan="2" text="총계" taborder="undefined"/>
                <Cell row="1"/>
                <Cell row="1" col="3" text="조"/>
                <Cell row="1" col="4" text="중"/>
                <Cell row="1" col="5" text="석"/>
                <Cell row="1" col="6" text="간"/>
                <Cell row="1" col="7" text="야"/>
                <Cell row="1" col="8" text="계"/>
                <Cell row="1" col="9" text="객단가" taborder="undefined"/>
                <Cell row="1" col="15" text="식음료"/>
                <Cell row="1" col="16" text="행사"/>
                <Cell row="1" col="17" text="부가매출"/>
                <Cell row="1" col="18" text="관리비"/>
                <Cell row="1" col="19" text="기타"/>
                <Cell row="1" col="20" text="카페"/>
                <Cell row="1" col="21" text="POS"/>
                <Cell row="1" col="22" text="계"/>
                <Cell row="1" col="23" text="일반"/>
                <Cell row="1" col="24" text="슈퍼매점"/>
                <Cell row="1" col="25" text="임대매출"/>
                <Cell row="1" col="26" text="기타매출"/>
              </Band>
              <Band id="body">
                <Cell expr="currow+1"/>
                <Cell col="1" displaytype="normal" text="bind:occurDate"/>
                <Cell col="2" text="bind:weekKor"/>
                <Cell col="3" displaytype="number" style="align:center;background:EXPR( fn_setColor1(currow));background2:EXPR( fn_setColor1(currow));backgroundimage: ;" text="bind:p01"/>
                <Cell col="4" displaytype="number" style="align:center;background:EXPR( fn_setColor2(currow));background2:EXPR( fn_setColor2(currow));backgroundimage: ;" text="bind:p02"/>
                <Cell col="5" displaytype="number" style="align:center;background:EXPR( fn_setColor3(currow));background2:EXPR( fn_setColor3(currow));backgroundimage: ;" text="bind:p03"/>
                <Cell col="6" displaytype="number" style="align:center;background:EXPR( fn_setColor4(currow));background2:EXPR( fn_setColor4(currow));backgroundimage: ;" text="bind:p04"/>
                <Cell col="7" displaytype="number" style="align:center;background:EXPR( fn_setColor5(currow));background2:EXPR( fn_setColor5(currow));backgroundimage: ;" text="bind:p05"/>
                <Cell col="8" displaytype="number" style="align:center;" text="bind:pTot"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:pTot==0?0:Math.round(totNet01/pTot)"/>
                <Cell col="10" displaytype="number" style="align:center;" text="bind:m02"/>
                <Cell col="11" displaytype="number" style="align:center;" text="bind:m03"/>
                <Cell col="12" displaytype="number" style="align:center;" text="bind:m04"/>
                <Cell col="13" text="bind:m05"/>
                <Cell col="14" displaytype="number" style="align:right;" text="bind:mTot"/>
                <Cell col="15" displaytype="number" style="align:right;" text="bind:totNet01"/>
                <Cell col="16" displaytype="number" style="align:right;" text="bind:totNet02"/>
                <Cell col="17" displaytype="number" style="align:right;" text="bind:totNet03"/>
                <Cell col="18" displaytype="number" style="align:right;" text="bind:totNet04"/>
                <Cell col="19" displaytype="number" style="align:right;" text="bind:totNet05"/>
                <Cell col="20" displaytype="number" style="align:right;" text="bind:totNet06"/>
                <Cell col="21" displaytype="number" style="align:right;" text="bind:totNet07"/>
                <Cell col="22" displaytype="number" style="align:right;" text="bind:fsNet"/>
                <Cell col="23" displaytype="number" style="align:right;" text="bind:g1Net"/>
                <Cell col="24" displaytype="number" style="align:right;" text="bind:g2Net"/>
                <Cell col="25" displaytype="number" style="align:right;" text="bind:e1Net"/>
                <Cell col="26" displaytype="number" style="align:right;" text="bind:e2Net"/>
                <Cell col="27" displaytype="number" style="align:right;" text="bind:inNet"/>
                <Cell col="28" displaytype="number" style="align:right;" text="bind:totNet"/>
              </Band>
              <Band id="summary">
                <Cell/>
                <Cell col="1" colspan="2" text="합계" taborder="undefined"/>
                <Cell col="3" displaytype="number" expr="expr:getSum('p01')"/>
                <Cell col="4" displaytype="number" text="expr:getSum('p02')"/>
                <Cell col="5" displaytype="number" text="expr:getSum('p03')"/>
                <Cell col="6" displaytype="number" text="expr:getSum('p04')"/>
                <Cell col="7" displaytype="number" text="expr:getSum('p05')"/>
                <Cell col="8" displaytype="number" text="expr:getSum('pTot')"/>
                <Cell col="9" displaytype="number" text="expr:getSum('pTot')==0?0:Math.round(getSum('totNet01')/getSum('pTot'))"/>
                <Cell col="10" displaytype="number" text="expr:getSum('m02')"/>
                <Cell col="11" displaytype="number" text="expr:getSum('m03')"/>
                <Cell col="12" displaytype="number" text="expr:getSum('m04')"/>
                <Cell col="13" displaytype="number" text="expr:getSum('m05')"/>
                <Cell col="14" displaytype="number" text="expr:getSum('mTot')"/>
                <Cell col="15" displaytype="number" text="expr:getSum('totNet01')"/>
                <Cell col="16" displaytype="number" text="expr:getSum('totNet02')"/>
                <Cell col="17" displaytype="number" text="expr:getSum('totNet03')"/>
                <Cell col="18" displaytype="number" text="expr:getSum('totNet04')"/>
                <Cell col="19" displaytype="number" text="expr:getSum('totNet05')"/>
                <Cell col="20" displaytype="number" text="expr:getSum('totNet06')"/>
                <Cell col="21" displaytype="number" text="expr:getSum('totNet07')"/>
                <Cell col="22" displaytype="number" text="expr:getSum('fsNet')"/>
                <Cell col="23" displaytype="number" text="expr:getSum('g1Net')"/>
                <Cell col="24" displaytype="number" text="expr:getSum('g2Net')"/>
                <Cell col="25" displaytype="number" text="expr:getSum('e1Net')"/>
                <Cell col="26" displaytype="number" text="expr:getSum('e2Net')"/>
                <Cell col="27" displaytype="number" text="expr:getSum('inNet')"/>
                <Cell col="28" displaytype="number" text="expr:getSum('totNet')"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 845" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 840 1252 855" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="12" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30" tabstop="false"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 70" anchor="left top right"/>
        <Static id="Static28" text="사업부" class="sta_WFSA_label" position="absolute 15 40 88 61" anchor="left top"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 95 40" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 88 40 98 61" anchor="left top"/>
        <Static id="Static22" text="내역" class="sta_WF_Title01" position="absolute 0 81 450 99" anchor="left top" onclick="Static22_onclick"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 68 450 81" anchor="left top"/>
        <Static id="Static18" text="주별" class="sta_WF_Title01" position="absolute 10 566 132 584" anchor="left top" visible="true" titletext="사업장별 식수집계"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 208 40 238 61" anchor="left top"/>
        <Static id="Static60" text="업장" class="sta_WFSA_label" position="absolute 479 40 513 61" anchor="left top"/>
        <UpjangSearchComponent id="UpjangSearchComponent01" titletext="업장 검색용 Component" taborder="8" text="UpjangSearchComponent00" position="absolute 546 40 733 61" bindDataset="ds_search" bindUpjangCodeColumn="upjangCd" bindUpjangNameColumn="upjangNm" eventBeforeTrigger="" eventAfterTrigger="" roleSetId="StUpjang"/>
        <Static id="Static00" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 536 40 546 61" anchor="left top"/>
        <MuSearchComponent id="MuSearchComponent01" titletext="사업부 선택 Component" taborder="13" text="MuSearchComponent00" class="cmb_WF_Essential" position="absolute 97 40 208 61" bindDataset="ds_search" bindMuCdColumn="muCd" appendText="" onItemChangedEvent="fn_muCd_changed" visible="true"/>
        <TmSearchComponent id="TmSearchComponent01" titletext="팀 검색용 Component" taborder="14" text="TmSearchComponent00" class="edt_WF_Essential" position="absolute 298 40 447 61" bindDataset="ds_search" bindTmCdColumn="tmCd" bindTmNmColumn="tmNm" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tmCd_changed" eventBeforeTrigger="" visible="true"/>
        <Static id="Static25" text="부서" class="sta_WFSA_label" position="absolute 240 40 287 61" anchor="left top"/>
        <Static id="Static26" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 288 40 298 61" anchor="left top"/>
        <Static id="Static27" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 447 40 477 61" anchor="left top"/>
        <Static id="Static01" text="회계월 " class="sta_WFSA_label" position="absolute 743 40 813 61" anchor="left top" style="align:left middle;"/>
        <ObjCalMonth id="cal_slipMon" titletext="월력" taborder="15" scrollbars="none" position="absolute 814 40 890 61"/>
        <Grid id="Gridw" taborder="16" useinputpanel="false" position="absolute 9 584 609 764" binddataset="ds_listStat" cellsizingtype="col" scrollbars="none">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="38"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell/>
                <Cell style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                <Cell col="1" text="일"/>
                <Cell col="2" text="월"/>
                <Cell col="3" text="화"/>
                <Cell col="4" text="수"/>
                <Cell col="5" text="목"/>
                <Cell col="6" text="금"/>
                <Cell col="7" text="토"/>
              </Band>
              <Band id="body">
                <Cell text="bind:week"/>
                <Cell col="1" displaytype="number" text="bind:a1"/>
                <Cell col="2" displaytype="number" style="background:EXPR(fn_setColorA2(currow));background2:EXPR(fn_setColorA2(currow));" text="bind:a2"/>
                <Cell col="3" displaytype="number" style="background:EXPR(fn_setColorA3(currow));background2:EXPR(fn_setColorA3(currow));" text="bind:a3"/>
                <Cell col="4" displaytype="number" style="background:EXPR(fn_setColorA4(currow));background2:EXPR(fn_setColorA4(currow));" text="bind:a4"/>
                <Cell col="5" displaytype="number" style="background:EXPR(fn_setColorA5(currow));background2:EXPR(fn_setColorA5(currow));" text="bind:a5"/>
                <Cell col="6" displaytype="number" style="background:EXPR(fn_setColorA6(currow));background2:EXPR(fn_setColorA6(currow));" text="bind:a6"/>
                <Cell col="7" displaytype="number" text="bind:a7"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Combo id="cbo_type" taborder="17" innerdataset="ds_type" codecolumn="code" datacolumn="codeName" class="cmb_WF_Essential" position="absolute 520 560 607 580" onitemchanged="cbo_type_onitemchanged"/>
        <Static id="Static02" text="끼니 :" position="absolute 482 559 529 582" style="font:arial,9,bold;"/>
        <Static id="Static03" text="※운영 기간 내 끼니별 최대식수(파란색)/ 최소식수(빨간색) 표기(월~금, 토/일 제외)" position="absolute 14 777 638 793" style="color:crimson;font:arial,9,bold;"/>
        <Static id="Static05" text="그래프형태" class="sta_WFSA_label" position="absolute 1008 519 1108 540" anchor="left top"/>
        <Combo id="cbo_graphType" taborder="19" value="MSColumn2D" innerdataset="ds_graphType" codecolumn="cd" datacolumn="nm" onitemchanged="cbo_graphType_onitemchanged" position="absolute 1084 518 1231 539" anchor="left top"/>
        <ActiveX id="atx_chart1" position="absolute 631 544 1233 837" progid="ShockwaveFlash.ShockwaveFlash.10" windowed="true" useautobitmapcache="1" anchor="left top" taborder="20" FSCommand="atx_chart_FSCommand" style="border:1 solid #808080ff ;"/>
        <Static id="sta_detail14" text="최대값" class="sta_WFDA_Label01" position="absolute 314 520 379 540" anchor="left top"/>
        <Static id="sta_detail00" text="최소값" class="sta_WFDA_Label01" position="absolute 314 539 379 559" anchor="left top"/>
        <Static id="sta_detail01" text="평균값" class="sta_WFDA_Label01" position="absolute 314 558 379 578" anchor="left top"/>
        <MaskEdit id="msk_max" taborder="27" position="absolute 379 520 442 540" mask="#,##9.9"/>
        <MaskEdit id="msk_min" taborder="28" mask="#,##9.9" position="absolute 379 539 442 559"/>
        <MaskEdit id="msk_avg" taborder="29" mask="#,##9.9" position="absolute 379 557 442 578"/>
        <Static id="Static10" text="매출구분 :" position="absolute 456 530 530 553" style="font:arial,9,bold;"/>
        <Combo id="cbo_type2" taborder="30" innerdataset="@ds_type2" codecolumn="code" datacolumn="codeName" onitemchanged="cbo_type2_onitemchanged" class="cmb_WF_Essential" position="absolute 520 531 607 551"/>
        <CheckBox id="chk_bonbu" taborder="31" text="본부전체조회" onclick="chk_0_OnClick" position="absolute 908 42 999 60" anchor="top right" style="color:blue;" userdata="007"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item8" compid="cal_slipMon" propid="text" datasetid="ds_search" columnid="month"/>
      <BindItem id="item0" compid="cbo_type" propid="value" datasetid="ds_search" columnid="mealCd"/>
      <BindItem id="item1" compid="cbo_type2" propid="value" datasetid="ds_search" columnid="saleGubun"/>
    </Bind>
    <Objects>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_list_onrowposchanged" useclientlayout="true">
        <ColumnInfo>
          <Column id="upjangCd" type="STRING" size="256"/>
          <Column id="upjangNm" type="STRING" size="256"/>
          <Column id="occurDate" type="STRING" size="256"/>
          <Column id="weekKor" type="STRING" size="256"/>
          <Column id="weekCd" type="STRING" size="256"/>
          <Column id="p01" type="FLOAT" size="22"/>
          <Column id="p02" type="FLOAT" size="22"/>
          <Column id="p03" type="FLOAT" size="22"/>
          <Column id="p04" type="FLOAT" size="22"/>
          <Column id="p05" type="FLOAT" size="22"/>
          <Column id="p06" type="FLOAT" size="22"/>
          <Column id="pTot" type="FLOAT" size="22"/>
          <Column id="mPrice" type="FLOAT" size="22"/>
          <Column id="m02" type="FLOAT" size="22"/>
          <Column id="m03" type="FLOAT" size="22"/>
          <Column id="m04" type="FLOAT" size="22"/>
          <Column id="m05" type="FLOAT" size="256"/>
          <Column id="totPsn" type="FLOAT" size="22"/>
          <Column id="totNet01" type="FLOAT" size="22"/>
          <Column id="totNet02" type="FLOAT" size="22"/>
          <Column id="totNet03" type="FLOAT" size="22"/>
          <Column id="totNet04" type="FLOAT" size="22"/>
          <Column id="totNet05" type="FLOAT" size="256"/>
          <Column id="totNet06" type="FLOAT" size="22"/>
          <Column id="totNet07" type="FLOAT" size="256"/>
          <Column id="fsNet" type="FLOAT" size="22"/>
          <Column id="g1Net" type="FLOAT" size="22"/>
          <Column id="g2Net" type="FLOAT" size="22"/>
          <Column id="e1Net" type="FLOAT" size="22"/>
          <Column id="e2Net" type="FLOAT" size="22"/>
          <Column id="inNet" type="FLOAT" size="22"/>
          <Column id="totNet" type="FLOAT" size="22"/>
          <Column id="mTot" type="FLOAT" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="frncStorNum" type="STRING" size="256"/>
          <Column id="cardClass" type="STRING" size="256"/>
          <Column id="buycpnyCd" type="STRING" size="256"/>
          <Column id="upjangCd" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="frncStorNum">title:가맹점번호,required:true</Col>
            <Col id="buycpnyCd">title:매입사,required:true</Col>
            <Col id="cardClass">title:카드구분,required:true</Col>
            <Col id="upjangCd">title:업장,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="upjangCd" type="STRING" size="256"/>
          <Column id="upjangNm" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
          <Column id="tmNm" type="STRING" size="256"/>
          <Column id="month" type="STRING" size="256"/>
          <Column id="mealCd" type="STRING" size="256"/>
          <Column id="saleGubun" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">0</Col>
            <Col id="delYn">0</Col>
            <Col id="savYn">0</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">1</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_searchValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="muCd">title:부서,required:true</Col>
            <Col id="tmCd">title:팀코드,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_type" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listStat" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="week" type="STRING" size="256"/>
          <Column id="a1" type="BIGDECIMAL" size="22"/>
          <Column id="a2" type="BIGDECIMAL" size="22"/>
          <Column id="a3" type="BIGDECIMAL" size="22"/>
          <Column id="a4" type="BIGDECIMAL" size="22"/>
          <Column id="a5" type="BIGDECIMAL" size="22"/>
          <Column id="a6" type="BIGDECIMAL" size="22"/>
          <Column id="a7" type="BIGDECIMAL" size="22"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_graphType" preload="true" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="nm" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="cd">MSColumn2D</Col>
            <Col id="nm">MSColumn2D</Col>
          </Row>
          <Row>
            <Col id="cd">MSColumn3D</Col>
            <Col id="nm">MSColumn3D</Col>
          </Row>
          <Row>
            <Col id="cd">MSLine</Col>
            <Col id="nm">MSLine</Col>
          </Row>
          <Row>
            <Col id="cd">MSArea</Col>
            <Col id="nm">MSArea</Col>
          </Row>
          <Row>
            <Col id="cd">MSBar2D</Col>
            <Col id="nm">MSBar2D</Col>
          </Row>
          <Row>
            <Col id="cd">MSBar3D</Col>
            <Col id="nm">MSBar3D</Col>
          </Row>
          <Row>
            <Col id="cd">StackedColumn2D</Col>
            <Col id="nm">StackedColumn2D</Col>
          </Row>
          <Row>
            <Col id="cd">StackedColumn3D</Col>
            <Col id="nm">StackedColumn3D</Col>
          </Row>
          <Row>
            <Col id="cd">StackedArea2D</Col>
            <Col id="nm">StackedArea2D</Col>
          </Row>
          <Row>
            <Col id="cd">StackedBar2D</Col>
            <Col id="nm">StackedBar2D</Col>
          </Row>
          <Row>
            <Col id="cd">StackedBar3D</Col>
            <Col id="nm">StackedBar3D</Col>
          </Row>
          <Row>
            <Col id="cd">ScrollStackedColumn2D</Col>
            <Col id="nm">ScrollStackedColumn2D</Col>
          </Row>
          <Row>
            <Col id="cd">ScrollLine2D</Col>
            <Col id="nm">ScrollLine2D</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_listStat2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="weekCd" type="STRING" size="256"/>
          <Column id="1" type="BIGDECIMAL" size="22"/>
          <Column id="2" type="BIGDECIMAL" size="22"/>
          <Column id="3" type="BIGDECIMAL" size="22"/>
          <Column id="4" type="BIGDECIMAL" size="22"/>
          <Column id="5" type="BIGDECIMAL" size="22"/>
          <Column id="6" type="BIGDECIMAL" size="22"/>
          <Column id="7" type="BIGDECIMAL" size="22"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_type2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <InitValue>
      <CheckBox id="chk_bonbu" userdata="007"/>
    </InitValue>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : 사업장별 식수집계 조회
  파 일 명 : UpjangMealList.xfdl
  기    능 : Design 및 Script Template 

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2020.06.19   김호석   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "lib::SMCommon.xjs";	//영업회계 공통 스크립트


/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();
var p01x = 0;
var p02x = 0;
var p03x = 0;
var p04x = 0;
var p05x = 0;
var p01m = 0;
var p02m = 0;
var p03m = 0;
var p04m = 0;
var p05m = 0;

var p01xi = 0;
var p02xi = 0;
var p03xi = 0;
var p04xi = 0;
var p05xi = 0;
var p01mi = 0;
var p02mi = 0;
var p03mi = 0;
var p04mi = 0;
var p05mi = 0;

var pMax = 0;
var pMin = 0;
var pMaxx = 0;
var pMinx = 0;
var pMaxy = 0;
var pMiny = 0;
var tmCd = "";

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	v_ds_check = "ds_list";
	
	//조회조건을 초기화한다.
	var nRow= ds_search.addRow();
	
	TmSearchComponent01.applyAuthLevel(MuSearchComponent01);
	UpjangSearchComponent01.applyAuthLevel(TmSearchComponent01);
	tmCd = TmSearchComponent01.getTmCode();
	
	//당월
	//fv_sToday = "20191101"; //테스트용 - 운영 반영 시 주석처리 필요
	cal_slipMon.fn_initMonthCal(this, fv_sToday.substring(0,6), "", ds_search, "month", "Y");
	
	
	fn_comCode("ds_type", "FS0047",	"Y");		
	fn_comCode("ds_type2", "FS0046", "Y");			
		
	ds_type2.addRow;
	for( var i = ds_type2.rowcount-1; i >= 0; i-- )
	{
		ds_type2.setColumn(i+1,"code",ds_type2.getColumn(i,"code"));
		ds_type2.setColumn(i+1,"codeName",ds_type2.getColumn(i,"codeName"));
	}
	
	ds_type2.setColumn(0,"code","");
	ds_type2.setColumn(0,"codeName","전체");
	
	cbo_type.index = 0;	
	cbo_type2.index = 0;	
	
	drawChart();
	
}
/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 사업부 변경시 부서, CC 초기화 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_muCd_changed(){
    ds_search.setColumn(0, "tmCd",  "");
    ds_search.setColumn(0, "tmNm",  "");
    ds_search.setColumn(0, "upjangCd",  "");
    ds_search.setColumn(0, "upjangNm",  "");
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 부서부 변경시 부서, CC 초기화 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_tmCd_changed(){
    ds_search.setColumn(0, "upjangCd",  "");
    ds_search.setColumn(0, "upjangNm",  "");
    tmCd = TmSearchComponent01.getTmCode();
}

/*----------------------------------------------------------------------------------------------
 * ComCode 조회
 *-------------------------------------------------------------------------'--------------------*/
function fn_comCode(dataset,type, str){
		gfn_transaction(this
						,"salsType"
						,"sm/cmn/common/selectComCode.xdo"
						,""
						,dataset+"=ds_combo"
						,"groupCode="+wrapQuote(type)+" useYn="+wrapQuote(str)
						,"fn_callBack"
						,false);
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{	
//	// v_ds_check 미사용시 변경사항 체크(입력 프로그램일때 변경되는 Dataset 전체 기술)
// 	if (gfn_dsIsUpdated(ds_list) == true) 
// 	{
// 		// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
//         if (!gfn_confirm("confirm.before.movepage")) return false;
//     }
//     
//	// 조회프로그램에도 Return true; 기술해 주세요!
// 	return true;

	// v_ds_check 사용시 변경사항 체크
	if(gfn_length(v_ds_check) == 0) 
	{	
		// v_ds_check 설정기준 변경사항 체크
		if (gfn_isDataChange() == true) 
		{		
			// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
			if (!gfn_confirm("confirm.before.movepage")) return false;
		}
	}
    
	// 조회프로그램에도 Return true; 기술해 주세요!
	return true;
}

/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
// 	// v_ds_check 미사용시 변경사항 체크
// 	if (gfn_dsIsUpdated(ds_list) == true) 
// 	{
// 		var retValue = gfn_confirm("confirm.before.search");	// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
// 		if (retValue == false) return;
// 	}

// 	// v_ds_check 사용시 공통버튼에서 변경사항 체크함
// 	// 변경사항 체크
// 	if (gfn_isDataChange() == true) 
// 	{		
// 		var retValue = gfn_confirm("confirm.before.search");	// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
// 		if (retValue == false) return;
// 	}
	
	// ds_listValid Dataset에 Validation할 칼럼별로 구성
	// 항목 추가시에는 ','로 구분
	// 예)title:금액1,required:false,minlength:2,digits:true
	
	// Alert시 칼럼 표시 명칭               - title:아이디(메시지의 치환할 명칭) 
	// 필수체크                              - required:true(체크여부 true/false)
	// size 크기                              - length:7(size 숫자)
	// 최대 size 크기                        - maxlength:7(size 숫자)
	// 최소 size 크기                        - minlength:7(size 숫자)
	// 최대 size 크기(Byte)                  - maxlengthB:7(size 숫자)
	// 최소 size 크기(Byte)                  - minlengthB:7(size 숫자)
	// 숫자 여부                             - digits:true(체크여부 true/false)
	// 해당 숫자 이하                       - min:7(size 숫자)
	// 해당 숫자 이상                       - max:7(size 숫자)
	// 소숫점 자리수 비교                   - declimit:3(size 숫자)
	// 날짜 년월일 체크                     - date:true(체크여부 true/false)
	// 날짜 년월 체크                       - dateym:true(체크여부 true/false)
	// 타 칼럼값보다 큰지 비교             - comparemax:Column4(Dataset 칼럼ID):시작일(비교대상의 메시지 치환할 명칭)
	// 타 칼럼값보다 작은지 비교           - comparemin:Column6(Dataset 칼럼ID):종료일(비교대상의 메시지 치환할 명칭)
	// 타 칼럼값과 같은 값인지 비교        - equalto:Column5(Dataset 칼럼ID):금액1(비교대상의 메시지 치환할 명칭)
	// 사이의 값인지 비교                   - range:40(from 숫자):100(to 숫자)
	// 코드값이 목록내의 값인지 비교       - code:1(목록 숫자):2(목록 숫자):3(목록 숫자)
	// 이메일 여부 체크(함수 체크시 예제)  - isEmail:true(체크여부 true/false)
	
	// 오류시 focus 지정                      - focus:cal_toDate(Componet ID로 form에서부터의 경로)
	
	ds_search.setColumn(0,"muCd",MuSearchComponent01.getMuCode());
	//ds_search.setColumn(0,"tmCd",TmSearchComponent01.getTmCode());
	ds_search.setColumn(0,"upjangCd",UpjangSearchComponent01.getUpjangCode()); 
	
	//본부검색 추가 20200810
	tmCd = TmSearchComponent01.getTmCode();
	if(chk_bonbu.value == true &&  TmSearchComponent01.getTmCode() != "")  {
		
		ds_search.setColumn(0, "tmCd", gfn_subStr(tmCd ,0,3) );  //본부조건 		
		
	} 		
 	else if(chk_bonbu.value == false &&  TmSearchComponent01.getTmCode() != "")  {
		
		ds_search.setColumn(0,"tmCd",tmCd); //팀 조건 	
	//} else {	
	//	alert("tm: " + TmSearchComponent01.getTmCode());
 	}		
 	
	//trace(ds_search.saveXML());	
	
	// 조회시 Validation Check
	if (gfn_validCheck(ds_search, ds_searchValid, true) == false) return;

    // Grid sort 표시 초기화(필수)
    //gfn_clearSortMark(grd_list);

    var strSvcID    = "search";
    var strURL      = "fs/fsl/upjangSaleRegMgnt/selectSgList.xdo";
    var strInDs     = "ds_search=ds_search";
    //var strOutDs    = "ds_list=ds_list ds_listStat=ds_listStat ds_listStat2=ds_listStat2";
    var strOutDs    = "ds_list=ds_list ds_listStat=ds_listStat";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
	
}


 /******************************************************************************************
 * 함  수  명	: drawChart()
 * 기      능	: 다중차트 생성
 ******************************************************************************************
 */

function drawChart()
{
	var arrArg,arrSer;

	//****요일별
	//---------------------------------------------
	// arrArg : 차트속성
	// caption		- 차트제목
	// xAxisName	- X축의 명
	// yAxisName	- Y축의 명
	// showValues	- 0 : 차트에 값 표시 안함
	// "formatNumberScale","0"  "numberScaleValue","1"  "formatNumberScale","1"  "formatNumber","1" 
	//---------------------------------------------
	arrArg = ["caption","요일별 추이","xAxisName","요일","yAxisName","식수","showValues","1"];
	
	//---------------------------------------------
	// arrSer : 그룹속성(3개씩 셋트)
	// [그룹명,Y축값컬럼명,그룹속성, ...]
	// 다중차트는 그룹속성을 설정안함.
	//---------------------------------------------
	//arrSer = ["월","a1","","화","a2","","수","a3","","목","a4","","금","a5","","토","a6","","일","a7",""];
	arrSer = ["1W","1","","2W","2","","3W","3","","4W","4","","5W","5",""];
	
	//gfn_MultiChart(atx_chart1,cbo_graphType.value,ds_listStat2,"weekCd",arrSer,arrArg,"",[]);
	//var strChartXML = gfn_MultiMakeXML(objDS,strColLab,arrSer,arrArg,arrColor,arrColLink);
	
	var strChartXML = "<chart caption='요일별 추이' xAxisName='요일' yAxisName='식수' showValues='1' baseFont='Gulim' baseFontSize='11' baseFontColor='444444' canvasBorder='0' canvasBorderThickness='1' canvasBorderAlpha='100' canvasBorderColor='9da9bb' canvasBaseAlpha='0' canvasBaseColor='ffffff' canvasBgColor='ffffff' useRoundEdges='0' plotSpacePercent='50' 'plotBorderAlpha='20' plotGradientColor='' chartbottomMargin='8' chartTopMargin='8' chartleftMargin='8' chartRightMargin='8' outCnvBaseFontColor='6c7a8f' outCnvBaseFontSize='12' outCnvBaseFont='Gulim' numberSuffix='' numberPrefix='' alternateVGridAlpha='0' alternateHGridAlpha='0' divLineDashGap='0' divLineDashLen='1' divLineIsDashed='0' divLineThickness='1' divLineAlpha='100' divLineColor='d6dbe6' numDivLines='5' borderColor='ffffff' borderAlpha='100' BgAlpha='100' BgColor='ffffff' toolTipBorderColor='605030' toolTipBorder='2' hovercapbg='fcffb8' formatNumberScale='1' decimals='1' showLabel='0' showShadow='0' showValues='0' palette='1'>";
	
	strChartXML = strChartXML + "<categories>";	
	strChartXML = strChartXML + "<category label='일'/>";	
	strChartXML = strChartXML + "<category label='월'/>";	
	strChartXML = strChartXML + "<category label='화'/>";	
	strChartXML = strChartXML + "<category label='수'/>";	
	strChartXML = strChartXML + "<category label='목'/>";	
	strChartXML = strChartXML + "<category label='금'/>";	
	strChartXML = strChartXML + "<category label='토'/>";	
	strChartXML = strChartXML + "</categories>";	

	for( var j = 0; j < ds_listStat.rowcount; j++ )	
	{
		
		if (ds_listStat.getColumn(j,"week") == 1 ) {
			strChartXML = strChartXML + "<dataset seriesName='1주'  color='2B93C6'>";
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a1") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a2") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a3") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a4") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a5") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a6") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a7") + "'/>"
			strChartXML = strChartXML + "</dataset>";
		}
		if (ds_listStat.getColumn(j,"week") == 2 ) {
			strChartXML = strChartXML + "<dataset seriesName='2주'  color='F08737'>";
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a1") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a2") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a3") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a4") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a5") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a6") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a7") + "'/>"
			strChartXML = strChartXML + "</dataset>";
		}
		if (ds_listStat.getColumn(j,"week") == 3 ) {
			strChartXML = strChartXML + "<dataset seriesName='3주'  color='94BD61'>";
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a1") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a2") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a3") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a4") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a5") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a6") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a7") + "'/>"
			strChartXML = strChartXML + "</dataset>";
		}
		if (ds_listStat.getColumn(j,"week") == 4 ) {
			strChartXML = strChartXML + "<dataset seriesName='4주'  color='BA6078'>";
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a1") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a2") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a3") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a4") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a5") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a6") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a7") + "'/>"
			strChartXML = strChartXML + "</dataset>";
		}
		if (ds_listStat.getColumn(j,"week") == 5) {
			strChartXML = strChartXML + "<dataset seriesName='5주'  color='C2AA3E'>";
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a1") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a2") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a3") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a4") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a5") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a6") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a7") + "'/>"
			strChartXML = strChartXML + "</dataset>";
		}
		if (ds_listStat.getColumn(j,"week") == 6 ) {
			strChartXML = strChartXML + "<dataset seriesName='6주'  color='3C6EC3'>";
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a1") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a2") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a3") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a4") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a5") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a6") + "'/>"
			strChartXML = strChartXML + "<set value='" + ds_listStat.getColumn(j,"a7") + "'/>"
			strChartXML = strChartXML + "</dataset>";
		}
	
	}
	
	strChartXML = strChartXML + "</chart>";
	//trace("Movie : " + gv_chartPath + cbo_graphType.value + ".swf");
	atx_chart1.Stop();
	atx_chart1.Movie = gv_chartPath + cbo_graphType.value + ".swf";	// Chart 종류설정
	atx_chart1.SetVariable('dataXML', strChartXML);		// xml값 셋팅
	//trace("strChartXML : " + strChartXML);
	
	atx_chart1.Rewind();
	atx_chart1.Play();
	
	
}


/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {
		// 코드분류 조회
        case "search" :
			var mealCnt = 0; //평균 분모
			var mealSum = 0; //평균 분자        
			var mealAvg = 0; //평균 식수
			
            //trace(ds_list.saveXML());         
            p01xi = 0;
			p02xi = 0;
			p03xi = 0;
			p04xi = 0;
			p05xi = 0;
			p01mi = 0;
			p02mi = 0;
			p03mi = 0;
			p04mi = 0;
			p05mi = 0;
						
			p01x = ds_list.getColumn(0, "p01");
			p02x = ds_list.getColumn(0, "p02");
			p03x = ds_list.getColumn(0, "p03");
			p04x = ds_list.getColumn(0, "p04");
			p05x = ds_list.getColumn(0, "p05");
			
			
			p01m = 1000000;
			p02m = 1000000;
			p03m = 1000000;
			p04m = 1000000;
			p05m = 1000000;
			
			//최소값 초기비교값 
			/*
			for( var i = 0; i < ds_list.rowcount; i++ )
			{
				
				if  (toNumber(ds_list.getColumn(i, "p01")) > 0) {
					p01m = ds_list.getColumn(i, "p01");
				}
				if  (toNumber(ds_list.getColumn(i, "p02")) > 0)  {
					p02m = ds_list.getColumn(i, "p02");
				}
				if  (toNumber(ds_list.getColumn(i, "p03")) > 0)  {
					//p03m = ds_list.getColumn(i "p03");
					p03m = ds_list.getColumn(i, "p03");
				}
				if  (toNumber(ds_list.getColumn(i, "p04")) > 0)  {
					//p03m = ds_list.getColumn(i "p03");
					p04m = ds_list.getColumn(i, "p04");
				}
				if  (toNumber(ds_list.getColumn(i, "p05")) > 0)  {
					p05m = ds_list.getColumn(i, "p05");
				}
			
			}
			*/
			/*
			trace(p01m);
			trace(p02m);
			trace(p03m);
			trace(p05m);
			p01m = ds_list.getColumn(0, "p01");
			p02m = ds_list.getColumn(0, "p02");
			p03m = ds_list.getColumn(0, "p03");
			p05m = ds_list.getColumn(0, "p05");
			*/
			
			for( var i = 0; i < ds_list.rowcount; i++ )
			{
				//식수별 최대값
				if (p01x < toNumber(ds_list.getColumn(i, "p01")))
				{ 
					//trace("크다");
					p01x = ds_list.getColumn(i, "p01");
					p01xi = i;				
				}
				if (p02x < toNumber(ds_list.getColumn(i, "p02")))
				{ 
					p02x = ds_list.getColumn(i, "p02");
					p02xi = i;				
				}
				if (p03x < toNumber(ds_list.getColumn(i, "p03")))
				{ 
					p03x = ds_list.getColumn(i, "p03");
					p03xi = i;				
				}
				
				if (p04x < toNumber(ds_list.getColumn(i, "p04")))
				{ 
					p04x = ds_list.getColumn(i, "p04");
					p04xi = i;				
				}
				if (p05x < toNumber(ds_list.getColumn(i, "p05")))
				{ 
					p05x = ds_list.getColumn(i, "p05");
					p05xi = i;				
				}
				
				//식수별 최소값
				if (toNumber(ds_list.getColumn(i, "p01")) > 0 && p01m > toNumber(ds_list.getColumn(i, "p01")))
				{ 
					p01m = ds_list.getColumn(i, "p01");
					p01mi = i;				
				}
				if (toNumber(ds_list.getColumn(i, "p02")) > 0 && p02m > toNumber(ds_list.getColumn(i, "p02")))
				{ 
					p02m = ds_list.getColumn(i, "p02");
					p02mi = i;				
				}
				if (toNumber(ds_list.getColumn(i, "p03")) > 0 && p03m > toNumber(ds_list.getColumn(i, "p03")))
				{ 
					p03m = ds_list.getColumn(i, "p03");
					p03mi = i;				
				}				
				if (toNumber(ds_list.getColumn(i, "p04")) > 0 && p03m > toNumber(ds_list.getColumn(i, "p04")))
				{ 
					p04m = ds_list.getColumn(i, "p04");
					p04mi = i;				
				}
				if (toNumber(ds_list.getColumn(i, "p05")) > 0 && p05m > toNumber(ds_list.getColumn(i, "p05")))
				{ 
					p05m = ds_list.getColumn(i, "p05");
					p05mi = i;				
				}
								
			}
			
			if (p01m == 1000000) p01m = 0;
			if (p02m == 1000000) p02m = 0;
			if (p03m == 1000000) p03m = 0;
			if (p04m == 1000000) p04m = 0;
			if (p05m == 1000000) p05m = 0;
			
			//최대=최소인 경우(색 미표시)
			if (p01x == p01m) 
			{
				p01x = 0;
				p01m = 0;
			}
			if (p02x == p02m) 
			{
				p02x = 0;
				p02m = 0;
			}
			if (p03x == p03m) 
			{
				p03x = 0;
				p03m = 0;
			}
			
			if (p04x == p04m) 
			{
				p04x = 0;
				p04m = 0;
			}
			if (p05x == p05m) 
			{
				p05x = 0;
				p05m = 0;
			}
			
			//주차별 식수 최대/최소값 
			pMax = 0;
			//pMin = 0;
			pMaxx = 0;
			pMinx = 0;
			pMaxy = 0;
			pMiny = 0;
								
			//pMax = ds_listStat.getColumn(0, "a1");		
			//최초로 값이 있는 값을 최소값 초기값으로 설정
			for( var i = 0; i < ds_listStat.rowcount; i++ )
			{
				if (toNumber(ds_listStat.getColumn(i, "a1")) > 0) {
					mealSum = mealSum + toNumber(ds_listStat.getColumn(i, "a1"));
					mealCnt = mealCnt + 1;
				}
				if (toNumber(ds_listStat.getColumn(i, "a2")) > 0) {
					mealSum = mealSum + toNumber(ds_listStat.getColumn(i, "a2"));
					mealCnt = mealCnt + 1;
				}
				if (toNumber(ds_listStat.getColumn(i, "a3")) > 0) {
					mealSum = mealSum + toNumber(ds_listStat.getColumn(i, "a3"));
					mealCnt = mealCnt + 1;
				}
				if (toNumber(ds_listStat.getColumn(i, "a4")) > 0) {
					mealSum = mealSum + toNumber(ds_listStat.getColumn(i, "a4"));
					mealCnt = mealCnt + 1;
				}
				if (toNumber(ds_listStat.getColumn(i, "a5")) > 0) {
					mealSum = mealSum + toNumber(ds_listStat.getColumn(i, "a5"));
					mealCnt = mealCnt + 1;
				}
				if (toNumber(ds_listStat.getColumn(i, "a6")) > 0) {
					mealSum = mealSum + toNumber(ds_listStat.getColumn(i, "a6"));
					mealCnt = mealCnt + 1;
				}
				if (toNumber(ds_listStat.getColumn(i, "a7")) > 0) {
					mealSum = mealSum + toNumber(ds_listStat.getColumn(i, "a7"));
					mealCnt = mealCnt + 1;
				}				
				
			}
			//trace("min : "+pMin);
			//초기값
			pMax = 0;
			pMin = 1000000;
			for( var i = 0; i < ds_listStat.rowcount; i++ )
			{
				//식수별 최대값
				/*
				trace("i:"+i);
				*/
				//trace(i+" : "+pMax);
				if (pMax < toNumber(ds_listStat.getColumn(i, "a2")))
				{ 
					pMax = ds_listStat.getColumn(i, "a2");
					pMaxx = 2;		
					pMaxy = i;		
				}
				if (pMax < toNumber(ds_listStat.getColumn(i, "a3")))
				{ 
					pMax = ds_listStat.getColumn(i, "a3");
					pMaxx = 3;		
					pMaxy = i;		
				}
				if (pMax < toNumber(ds_listStat.getColumn(i, "a4")))
				{ 
					pMax = ds_listStat.getColumn(i, "a4");
					pMaxx = 4;		
					pMaxy = i;			
				}
				if (pMax < toNumber(ds_listStat.getColumn(i, "a5")))
				{ 
					pMax = ds_listStat.getColumn(i, "a5");
					pMaxx = 5;		
					pMaxy = i;		
				}				
				if (pMax < toNumber(ds_listStat.getColumn(i, "a6")))
				{ 		
					pMax = ds_listStat.getColumn(i, "a6");
					pMaxx = 6;		
					pMaxy = i;		
				}
								
				//식수별 최소값(0보다 크고 공백이 아닌 경우)
								
				if (toNumber(ds_listStat.getColumn(i, "a2")) > 0 && ds_listStat.getColumn(i, "a2") != "" && pMin > toNumber(ds_listStat.getColumn(i, "a2")))
				{ 
					pMin = ds_listStat.getColumn(i, "a2");
					pMinx = 2;		
					pMiny = i;		
				}
				if (toNumber(ds_listStat.getColumn(i, "a3")) > 0 && ds_listStat.getColumn(i, "a3") != "" && pMin > toNumber(ds_listStat.getColumn(i, "a3")))
				{ 
					pMin = ds_listStat.getColumn(i, "a3");
					pMinx = 3;		
					pMiny = i;		
				}
				if (toNumber(ds_listStat.getColumn(i, "a4")) > 0 && ds_listStat.getColumn(i, "a4") != "" && pMin > toNumber(ds_listStat.getColumn(i, "a4")))
				{ 
					pMin = ds_listStat.getColumn(i, "a4");
					pMinx = 4;		
					pMiny = i;			
				}
				if (toNumber(ds_listStat.getColumn(i, "a5")) > 0 && ds_listStat.getColumn(i, "a5") != "" && pMin > toNumber(ds_listStat.getColumn(i, "a5")))
				{ 
					pMin = ds_listStat.getColumn(i, "a5");
					pMinx = 5;		
					pMiny = i;		
				}
				if (toNumber(ds_listStat.getColumn(i, "a6")) > 0 && ds_listStat.getColumn(i, "a6") != "" && pMin > toNumber(ds_listStat.getColumn(i, "a6")))
				{ 
					pMin = ds_listStat.getColumn(i, "a6");
					pMinx = 6;		
					pMiny = i;		
				}
				
				
            }
            
			//trace("E: "+pMax);	
			//trace("E: "+pMin);	
			//최대=최소인 경우(색 미표시)
			if (pMax == pMin && pMax == 0) 
			{
				pMax = 0;
				pMin = 0;
			}
			
			mealAvg = Math.round(mealSum/mealCnt,0); //평균:소수점 첫째자리 반올림
			if (mealCnt == 0) mealAvg = 0;
			if (pMax == "" || pMax == null) pMax = 0;
			if (pMin == 1000000) pMin = 0;
			            
            //trace("pMax:"+pMax);
            //trace("pMin:"+pMin);
            //trace("mealAvg:"+mealAvg);
            
            msk_max.enable = true;
            msk_min.enable = true;
            msk_avg.enable = true;
            msk_max.readonly = false;
            msk_min.readonly = false;
            msk_avg.readonly = false;
            
            msk_max.value = pMax;
            msk_min.value = pMin;
            msk_avg.value = mealAvg;
            
            msk_max.enable = false;
            msk_min.enable = false;
            msk_avg.enable = false;
           
            //요일명 한글 맵핑(차트에 나오는 명칭)
			for( var i = 0; i < ds_listStat2.rowcount; i++ )
			{
				if (ds_listStat2.getColumn(i,"weekCd") == "A1") {
					ds_listStat2.setColumn(i,"weekCd", "일");
				}
				if (ds_listStat2.getColumn(i,"weekCd") == "A2") {
					ds_listStat2.setColumn(i,"weekCd", "월");
				}
				if (ds_listStat2.getColumn(i,"weekCd") == "A3") {
					ds_listStat2.setColumn(i,"weekCd", "화");
				}
				if (ds_listStat2.getColumn(i,"weekCd") == "A4") {
					ds_listStat2.setColumn(i,"weekCd", "수");
				}
				if (ds_listStat2.getColumn(i,"weekCd") == "A5") {
					ds_listStat2.setColumn(i,"weekCd", "목");
				}
				if (ds_listStat2.getColumn(i,"weekCd") == "A6") {
					ds_listStat2.setColumn(i,"weekCd", "금");
				}
				if (ds_listStat2.getColumn(i,"weekCd") == "A7") {
					ds_listStat2.setColumn(i,"weekCd", "토");
				}
				
			}
            //차트
            cbo_graphType.value = "MSColumn2D";
            drawChart();
            
			ds_search.setColumn(0,"tmCd",tmCd); //팀 조건 	
			
            break;
       
    }
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 편차율
 *---------------------------------------------------------------------------------------------*/

function fn_setColorA1(nRow)
{
	var sColor = "white";
	
	
	//최대값
	//if( p01xi == nRow) 	
	if (pMaxy == nRow)
	{
		if(pMax == ds_listStat.getColumn(nRow, "a1") && pMax > 0)
		{
			sColor = "#B2CCFF";
		}
	}
	//최소값
	//if( p01mi == nRow) 
	if (pMiny == nRow)
	{
		if(pMin == ds_listStat.getColumn(nRow, "a1") && pMin > 0)
		{	
			sColor = "#FFA7A7";
		}
	}
	//#B2CCFF- 파랑 , #FFA7A7- 빨강

	return sColor;
}

function fn_setColorA2(nRow)
{
	var sColor = "white";
	
	
	//최대값
	//if( p01xi == nRow) 
	if (pMaxy == nRow)
	{
		if(pMax == ds_listStat.getColumn(nRow, "a2") && pMax > 0)
		{
			sColor = "#B2CCFF";
		}
	}
	//최소값
	//if( p01mi == nRow) 
	if (pMiny == nRow)
	{
		if(pMin == ds_listStat.getColumn(nRow, "a2") && pMin > 0)
		{	
			sColor = "#FFA7A7";
		}
	}
	//#B2CCFF- 파랑 , #FFA7A7- 빨강

	return sColor;
}

function fn_setColorA3(nRow)
{
	var sColor = "white";
	
	
	//최대값
	//if( p01xi == nRow) 
	if (pMaxy == nRow)
	{
		if(pMax == ds_listStat.getColumn(nRow, "a3") && pMax > 0)
		{
			sColor = "#B2CCFF";
		}
	}
	//최소값
	//if( p01mi == nRow) 
	if (pMiny == nRow)
	{
		if(pMin == ds_listStat.getColumn(nRow, "a3") && pMin > 0)
		{	
			sColor = "#FFA7A7";
		}
	}
	//#B2CCFF- 파랑 , #FFA7A7- 빨강

	return sColor;
}

function fn_setColorA4(nRow)
{
	var sColor = "white";
	
	
	//최대값
	//if( p01xi == nRow) 
	//trace("pMax:"+pMax);
	//trace("a3:["+ds_listStat.getColumn(nRow, "a3")+"]");
	if (pMaxy == nRow)
	{
		if(pMax == ds_listStat.getColumn(nRow, "a4") && pMax > 0)
		{
			sColor = "#B2CCFF";
		}
	}
	//최소값
	//if( p01mi == nRow) 
	if (pMiny == nRow)
	{
		if(pMin == ds_listStat.getColumn(nRow, "a4") && pMin > 0)
		{	
			sColor = "#FFA7A7";
		}
	}
	//#B2CCFF- 파랑 , #FFA7A7- 빨강

	return sColor;
}

function fn_setColorA5(nRow)
{
	var sColor = "white";
	
	
	//최대값
	//if( p01xi == nRow) 
	if (pMaxy == nRow)
	{
		if(pMax == ds_listStat.getColumn(nRow, "a5") && pMax > 0)
		{
			sColor = "#B2CCFF";
		}
	}
	//최소값
	//if( p01mi == nRow) 
	if (pMiny == nRow)
	{
		if(pMin == ds_listStat.getColumn(nRow, "a5") && pMin > 0)
		{	
			sColor = "#FFA7A7";
		}
	}
	//#B2CCFF- 파랑 , #FFA7A7- 빨강

	return sColor;
}

function fn_setColorA6(nRow)
{
	var sColor = "white";
	
	
	//최대값
	//if( p01xi == nRow) 
	if (pMaxy == nRow)
	{
		if(pMax == ds_listStat.getColumn(nRow, "a6") && pMax > 0)
		{
			sColor = "#B2CCFF";
		}
	}
	//최소값
	//if( p01mi == nRow) 
	if (pMiny == nRow)
	{
		if(pMin == ds_listStat.getColumn(nRow, "a6") && pMin > 0)
		{	
			sColor = "#FFA7A7";
		}
	}
	//#B2CCFF- 파랑 , #FFA7A7- 빨강

	return sColor;
}

/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 편차율
 *---------------------------------------------------------------------------------------------*/
function fn_setColor1(nRow)
{
	var sColor = "white";
	
	
	//최대값
	//if( p01xi == nRow) 
	if(p01x == ds_list.getColumn(nRow, "p01") && p01x > 0)
	{
		sColor = "#B2CCFF";
	}
	//최소값
	//if( p01mi == nRow) 
	if(p01m == ds_list.getColumn(nRow, "p01") && p01m > 0)
	{	
		sColor = "#FFA7A7";
	}
	//#B2CCFF- 파랑 , #FFA7A7- 빨강

	return sColor;
}

function fn_setColor2(nRow)
{
	var sColor = "white";
	
	
	//최대값
	//if(p02xi == nRow) 
	if(p02x == ds_list.getColumn(nRow, "p02") && p02x > 0)
	{
		sColor = "#B2CCFF";
	}
	//최소값
	//if(p02mi == nRow) 
	if(p02m == ds_list.getColumn(nRow, "p02") && p02m > 0)
	{	
		sColor = "#FFA7A7";
	}
	//#B2CCFF- 파랑 , #FFA7A7- 빨강

	return sColor;
}

function fn_setColor3(nRow)
{
	var sColor = "white";
	
	
	//최대값
	//if(p03xi == nRow) 
	if(p03x == ds_list.getColumn(nRow, "p03") && p03x > 0)
	{
		sColor = "#B2CCFF";
	}
	//최소값
	//if(p03mi == nRow) 
	if(p03m == ds_list.getColumn(nRow, "p03") && p03m > 0)
	{	
		sColor = "#FFA7A7";
	}
	//#B2CCFF- 파랑 , #FFA7A7- 빨강

	return sColor;
}


function fn_setColor4(nRow)
{
	var sColor = "white";
	
	
	//최대값
	if(p04x == ds_list.getColumn(nRow, "p04") && p04x > 0)
	{
		sColor = "#B2CCFF";
	}
	//최소값
	if(p04m == ds_list.getColumn(nRow, "p04") && p04m > 0)
	{	
		sColor = "#FFA7A7";
	}
	//#B2CCFF- 파랑 , #FFA7A7- 빨강

	return sColor;
}

function fn_setColor5(nRow)
{
	var sColor = "white";
	
	
	//최대값
	//if(p05xi == nRow) 
	if(p05x == ds_list.getColumn(nRow, "p05") && p05x > 0)
	{
		sColor = "#B2CCFF";
	}
	//최소값
	//if(p05mi == nRow) 
	if(p05m == ds_list.getColumn(nRow, "p05") && p05m > 0)
	{	
		sColor = "#FFA7A7";
	}
	//#B2CCFF- 파랑 , #FFA7A7- 빨강

	return sColor;
}
function cbo_type_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	fn_search();
}

function cbo_type2_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	//alert(cbo_type2.index);
	if (cbo_type2.index == "0" || cbo_type2.index == "1") {
		cbo_type.enable = true;
	} else {		
		cbo_type.index = 0;
		cbo_type.enable = false;
	}
	fn_search();
}


function cbo_graphType_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	drawChart();
}
]]></Script>
  </Form>
</FDL>

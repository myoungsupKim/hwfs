<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="FSM90010E" classname="SAMPLE01" inheritanceid="" position="absolute 0 0 1252 725" titletext="기간표준식단관리" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="1" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static22" text="지난주 권장메뉴식단표" class="sta_WF_Title01" position="absolute 0 407 450 425" anchor="left bottom"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 420 1237 425" anchor="left top"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 1237 40" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 1237 71" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static19" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 813 84"/>
        <Static id="Static00" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 213 40 243 61" anchor="left top"/>
        <Combo id="cbo_menuClass" taborder="2" innerdataset="@ds_cboMenuClass" codecolumn="CODE" datacolumn="CODE_NAME" class="cmb_WF_Essential" position="absolute 83 40 213 61"/>
        <Static id="Static03" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 73 40 83 61" anchor="left top"/>
        <Static id="Static01" text="식단분류" class="sta_WFSA_label" position="absolute 15 41 75 62" anchor="left top"/>
        <Static id="Static20" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 394 994 407" anchor="left top"/>
        <Static id="Static37" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1179 71 1237 77" anchor="top right"/>
        <Static id="Static02" text="원가유형" class="sta_WFSA_label" position="absolute 243 41 303 62" anchor="left top"/>
        <Static id="Static09" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 301 40 311 61" anchor="left top"/>
        <Combo id="cbo_costType" taborder="3" innerdataset="@ds_cboCostType" codecolumn="CODE" datacolumn="CODE_NAME" class="cmb_WF_Essential" position="absolute 311 40 421 61"/>
        <Static id="Static10" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 421 40 451 61" anchor="left top"/>
        <Static id="Static11" text="식단유형" class="sta_WFSA_label" position="absolute 451 41 511 62" anchor="left top"/>
        <Static id="Static14" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 509 40 519 61" anchor="left top"/>
        <Combo id="cbo_menuType" taborder="4" innerdataset="@ds_cboMenuType" codecolumn="CODE" datacolumn="CODE_NAME" class="cmb_WF_Essential" position="absolute 519 40 619 61"/>
        <Static id="Static15" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 619 40 649 61" anchor="left top"/>
        <Static id="Static17" text="끼니" class="sta_WFSA_label" position="absolute 649 41 683 62" anchor="left top"/>
        <Static id="Static18" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 681 40 691 61" anchor="left top"/>
        <Combo id="cbo_meal" taborder="5" innerdataset="@ds_cboMeal" codecolumn="CODE" datacolumn="CODE_NAME" class="cmb_WF_Essential" position="absolute 691 40 781 61"/>
        <Static id="Static21" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 943 40 973 61" anchor="left top"/>
        <Static id="Static23" text="제공일" class="sta_WFSA_label" position="absolute 973 41 1020 62" anchor="left top"/>
        <Static id="Static24" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 1018 40 1028 61" anchor="left top"/>
        <Grid id="grd_menuList" taborder="8" binddataset="ds_menuList" useinputpanel="false" selecttype="multiarea" autofittype="col" onmousemove="grd_menuList_onmousemove" oncellclick="grd_menuList_oncellclick" oncelldblclick="grd_menuList_oncelldblclick" position="absolute 0 109 1237 394" anchor="all" style="border:1 solid #53606cff,1 solid #c3c3c3ff,1 solid #c3c3c3ff,1 solid #c3c3c3ff;">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="100"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" text="일자" taborder="undefined"/>
                <Cell col="1" text="월" taborder="undefined"/>
                <Cell col="2" rowspan="2" taborder="undefined"/>
                <Cell col="3" text="화" taborder="undefined"/>
                <Cell col="4" rowspan="2" taborder="undefined"/>
                <Cell col="5" text="수" taborder="undefined"/>
                <Cell col="6" rowspan="2" taborder="undefined"/>
                <Cell col="7" text="목" taborder="undefined"/>
                <Cell col="8" rowspan="2" taborder="undefined"/>
                <Cell col="9" text="금" taborder="undefined"/>
                <Cell col="10" rowspan="2" taborder="undefined"/>
                <Cell col="11" style="color:#99ccffff;" text="토" taborder="undefined"/>
                <Cell col="12" rowspan="2" taborder="undefined"/>
                <Cell col="13" style="color:#ffcc00;" text="일" taborder="undefined"/>
                <Cell col="14" rowspan="2" taborder="undefined"/>
                <Cell row="1" col="1" taborder="undefined"/>
                <Cell row="1" col="3" taborder="undefined"/>
                <Cell row="1" col="5" taborder="undefined"/>
                <Cell row="1" col="7" taborder="undefined"/>
                <Cell row="1" col="9" taborder="undefined"/>
                <Cell row="1" col="11" taborder="undefined"/>
                <Cell row="1" col="13" taborder="undefined"/>
              </Band>
              <Band id="body">
                <Cell style="background:whitesmoke;background2:whitesmoke;" text="expr:!gfn_isNull(KEY) ? SGBN_NM + '(' + CGBN + ')' : ''" suppress="1" suppressalign="middle"/>
                <Cell col="1" displaytype="text" style="padding:0 0 0 5;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z2 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z2 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));color:EXPR(!gfn_isNull(C2) ? &quot;C2&quot; : &quot;black&quot;);" text="bind:M2"/>
                <Cell col="2" displaytype="number" style="padding:0 3 0 0;background:EXPR(!gfn_isNull(C2) ? C2 : gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);background2:EXPR(!gfn_isNull(C2) ? C2 : gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);" text="bind:P2"/>
                <Cell col="3" displaytype="text" style="padding:0 0 0 5;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z3 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z3 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));" text="bind:M3"/>
                <Cell col="4" displaytype="number" style="padding:0 3 0 0;background:EXPR(!gfn_isNull(C3) ? C3 : gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);background2:EXPR(!gfn_isNull(C3) ? C3 : gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);" text="bind:P3"/>
                <Cell col="5" displaytype="text" style="padding:0 0 0 5;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z4 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z4 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));" text="bind:M4"/>
                <Cell col="6" displaytype="number" style="padding:0 3 0 0;background:EXPR(!gfn_isNull(C4) ? C4 : gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);background2:EXPR(!gfn_isNull(C4) ? C4 : gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);" text="bind:P4"/>
                <Cell col="7" displaytype="text" style="padding:0 0 0 5;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z5 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z5 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));" text="bind:M5"/>
                <Cell col="8" displaytype="number" style="padding:0 3 0 0;background:EXPR(!gfn_isNull(C5) ? C5 : gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);background2:EXPR(!gfn_isNull(C5) ? C5 : gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);" text="bind:P5"/>
                <Cell col="9" displaytype="text" style="padding:0 0 0 5;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z6 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z6 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));" text="bind:M6"/>
                <Cell col="10" displaytype="number" style="padding:0 3 0 0;background:EXPR(!gfn_isNull(C6) ? C6 : gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);background2:EXPR(!gfn_isNull(C6) ? C6 : gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);" text="bind:P6"/>
                <Cell col="11" displaytype="text" style="padding:0 0 0 5;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z7 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z7 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));" text="bind:M7"/>
                <Cell col="12" displaytype="number" style="padding:0 3 0 0;background:EXPR(!gfn_isNull(C7) ? C7 : gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);background2:EXPR(!gfn_isNull(C7) ? C7 : gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);" text="bind:P7"/>
                <Cell col="13" displaytype="text" style="padding:0 0 0 5;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z1 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z1 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));" text="bind:M1"/>
                <Cell col="14" displaytype="number" style="padding:0 3 0 0;background:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);background2:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);" text="bind:P1"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_nutAnalysis" taborder="9" text="영양분석" onclick="btn_nutAnalysis_onclick" class="btn_WF_Function" position="absolute 1038 84 1103 104" anchor="top right"/>
        <Button id="btn_excel" taborder="10" text="Excel" onclick="btn_excel_onclick" class="btn_WF_Function" position="absolute 1105 84 1170 104" anchor="top right"/>
        <Static id="Static25" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1103 85 1105 105" anchor="top right"/>
        <Static id="Static99" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1170 85 1172 105" anchor="top right"/>
        <Button id="btn_eval" taborder="11" text="식단평가" onclick="btn_eval_onclick" class="btn_WF_Function" position="absolute 1172 84 1237 104" anchor="top right"/>
        <Button id="btn_menuCopy" taborder="12" text="식단복사" onclick="btn_menuCopy_onclick" class="btn_WF_Function" position="absolute 971 84 1036 104" anchor="top right"/>
        <Static id="Static26" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1036 85 1038 105" anchor="top right"/>
        <Static id="Static12" text="금주평균원가" class="sta_WFDA_Label01" position="absolute 0 77 105 104" anchor="left top" style="background:lavender;font:Gulim,9,bold;"/>
        <Static id="Static27" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 104 1237 109" anchor="left top"/>
        <Grid id="grd_pastMenuList" taborder="13" binddataset="ds_pastMenuList" useinputpanel="false" selecttype="area" autofittype="col" position="absolute 0 425 1237 710" anchor="left right bottom" style="border:1 solid #53606cff,1 solid #c3c3c3ff,1 solid #c3c3c3ff,1 solid #c3c3c3ff;">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="100"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" text="일자" taborder="undefined"/>
                <Cell col="1" text="월" taborder="undefined"/>
                <Cell col="2" rowspan="2" taborder="undefined"/>
                <Cell col="3" text="화" taborder="undefined"/>
                <Cell col="4" rowspan="2" taborder="undefined"/>
                <Cell col="5" text="수" taborder="undefined"/>
                <Cell col="6" rowspan="2" taborder="undefined"/>
                <Cell col="7" text="목" taborder="undefined"/>
                <Cell col="8" rowspan="2" taborder="undefined"/>
                <Cell col="9" text="금" taborder="undefined"/>
                <Cell col="10" rowspan="2" taborder="undefined"/>
                <Cell col="11" style="color:#99ccffff;" text="토" taborder="undefined"/>
                <Cell col="12" rowspan="2" taborder="undefined"/>
                <Cell col="13" style="color:#ffcc00;" text="일" taborder="undefined"/>
                <Cell col="14" rowspan="2" taborder="undefined"/>
                <Cell row="1" col="1" taborder="undefined"/>
                <Cell row="1" col="3" taborder="undefined"/>
                <Cell row="1" col="5" taborder="undefined"/>
                <Cell row="1" col="7" taborder="undefined"/>
                <Cell row="1" col="9" taborder="undefined"/>
                <Cell row="1" col="11" taborder="undefined"/>
                <Cell row="1" col="13" taborder="undefined"/>
              </Band>
              <Band id="body">
                <Cell style="background:whitesmoke;background2:whitesmoke;" text="expr:!gfn_isNull(KEY) ? SGBN_NM + '(' + CGBN + ')' : ''" suppress="1" suppressalign="middle"/>
                <Cell col="1" displaytype="text" style="padding:0 0 0 5;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z2 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z2 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));" text="bind:M2"/>
                <Cell col="2" displaytype="number" style="padding:0 3 0 0;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);" text="bind:P2"/>
                <Cell col="3" displaytype="text" style="padding:0 0 0 5;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z3 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z3 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));" text="bind:M3"/>
                <Cell col="4" displaytype="number" style="padding:0 3 0 0;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);" text="bind:P3"/>
                <Cell col="5" displaytype="text" style="padding:0 0 0 5;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z4 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z4 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));" text="bind:M4"/>
                <Cell col="6" displaytype="number" style="padding:0 3 0 0;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);" text="bind:P4"/>
                <Cell col="7" displaytype="text" style="padding:0 0 0 5;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z5 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z5 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));" text="bind:M5"/>
                <Cell col="8" displaytype="number" style="padding:0 3 0 0;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);" text="bind:P5"/>
                <Cell col="9" displaytype="text" style="padding:0 0 0 5;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z6 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z6 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));" text="bind:M6"/>
                <Cell col="10" displaytype="number" style="padding:0 3 0 0;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);" text="bind:P6"/>
                <Cell col="11" displaytype="text" style="padding:0 0 0 5;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z7 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z7 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));" text="bind:M7"/>
                <Cell col="12" displaytype="number" style="padding:0 3 0 0;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);" text="bind:P7"/>
                <Cell col="13" displaytype="text" style="padding:0 0 0 5;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z1 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : (Z1 == '1' ? &quot;lightskyblue&quot;:&quot;white&quot;));" text="bind:M1"/>
                <Cell col="14" displaytype="number" style="padding:0 3 0 0;background:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);background2:EXPR(gfn_isNull(KEY) ? &quot;#DDFCDB&quot; : &quot;whitesmoke&quot;);" text="bind:P1"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static13" text="지난주평균원가" class="sta_WFDA_Label01" position="absolute 229 77 334 104" anchor="left top" style="background:lavender;"/>
        <MaskEdit id="edt_pastAvgCost" taborder="14" readonly="true" mask="#,###" position="absolute 333 77 459 104" anchor="left top" style="font:Gulim,9,bold;"/>
        <Static id="Static28" text="증감율(%)" class="sta_WFDA_Label01" position="absolute 458 77 563 104" anchor="left top" style="background:lavender;"/>
        <MaskEdit id="edt_avgCostRate" taborder="15" readonly="true" mask="#,###.##" position="absolute 562 77 688 104" anchor="left top" style="color:red;font:Gulim,9,bold;"/>
        <Div id="div_eval" anchor="top right" taborder="16" url="U_FSM::FSM90011P.xfdl" scrollbars="none" visible="false" position="absolute 687 109 1237 609"/>
        <MaskEdit id="edt_avgCost" taborder="17" readonly="true" mask="#,###" position="absolute 104 77 230 104" anchor="left top" style="color:blue;font:Gulim,9,bold;"/>
        <ObjCalendar id="cal_menuDate" anchor="left top" titletext="캘린더" taborder="7" scrollbars="none" position="absolute 1028 40 1131 61"/>
        <Static id="Static29" text="코너" class="sta_WFSA_label" position="absolute 811 41 845 62" anchor="left top"/>
        <Static id="Static30" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 781 40 811 61" anchor="left top"/>
        <Static id="Static31" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 843 40 853 61" anchor="left top"/>
        <Combo id="cbo_corner" taborder="6" innerdataset="@ds_corner" codecolumn="CODE" datacolumn="CODE_NAME" class="cmb_WF_Essential" position="absolute 853 40 943 61"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cboMenuClass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboCostType" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboMenuType" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboMeal" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="MENU_CLASS" type="STRING" size="256"/>
          <Column id="COST_TYPE" type="STRING" size="256"/>
          <Column id="MENU_TYPE" type="STRING" size="256"/>
          <Column id="MEAL" type="STRING" size="256"/>
          <Column id="MENU_DATE" type="STRING" size="256"/>
          <Column id="MENU_SDATE" type="STRING" size="256"/>
          <Column id="MENU_EDATE" type="STRING" size="256"/>
          <Column id="CORNER" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_headList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_bodyList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_menuList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="KEY" type="STRING" size="256"/>
          <Column id="TERM_MENU_CD" type="STRING" size="256"/>
          <Column id="SGBN" type="STRING" size="256"/>
          <Column id="SGBN_NM" type="STRING" size="256"/>
          <Column id="CGBN_CD" type="STRING" size="256"/>
          <Column id="CGBN" type="STRING" size="256"/>
          <Column id="SSEQ" type="STRING" size="256"/>
          <Column id="M2" type="STRING" size="256"/>
          <Column id="M3" type="STRING" size="256"/>
          <Column id="M4" type="STRING" size="256"/>
          <Column id="M5" type="STRING" size="256"/>
          <Column id="M6" type="STRING" size="256"/>
          <Column id="M7" type="STRING" size="256"/>
          <Column id="M1" type="STRING" size="256"/>
          <Column id="P2" type="BIGDECIMAL" size="256"/>
          <Column id="P3" type="BIGDECIMAL" size="256"/>
          <Column id="P4" type="BIGDECIMAL" size="256"/>
          <Column id="P5" type="BIGDECIMAL" size="256"/>
          <Column id="P6" type="BIGDECIMAL" size="256"/>
          <Column id="P7" type="BIGDECIMAL" size="256"/>
          <Column id="P1" type="BIGDECIMAL" size="256"/>
          <Column id="T2" type="STRING" size="256"/>
          <Column id="T3" type="STRING" size="256"/>
          <Column id="T4" type="STRING" size="256"/>
          <Column id="T5" type="STRING" size="256"/>
          <Column id="T6" type="STRING" size="256"/>
          <Column id="T7" type="STRING" size="256"/>
          <Column id="T1" type="STRING" size="256"/>
          <Column id="D2" type="STRING" size="256"/>
          <Column id="D3" type="STRING" size="256"/>
          <Column id="D4" type="STRING" size="256"/>
          <Column id="D5" type="STRING" size="256"/>
          <Column id="D6" type="STRING" size="256"/>
          <Column id="D7" type="STRING" size="256"/>
          <Column id="D1" type="STRING" size="256"/>
          <Column id="C2" type="STRING" size="256"/>
          <Column id="C3" type="STRING" size="256"/>
          <Column id="C4" type="STRING" size="256"/>
          <Column id="C5" type="STRING" size="256"/>
          <Column id="C6" type="STRING" size="256"/>
          <Column id="C7" type="STRING" size="256"/>
          <Column id="C1" type="STRING" size="256"/>
          <Column id="Z2" type="STRING" size="256"/>
          <Column id="Z3" type="STRING" size="256"/>
          <Column id="Z4" type="STRING" size="256"/>
          <Column id="Z5" type="STRING" size="256"/>
          <Column id="Z6" type="STRING" size="256"/>
          <Column id="Z7" type="STRING" size="256"/>
          <Column id="Z1" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_pastHeadList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_pastBodyList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_pastMenuList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="KEY" type="STRING" size="256"/>
          <Column id="TERM_MENU_CD" type="STRING" size="256"/>
          <Column id="SGBN" type="STRING" size="256"/>
          <Column id="SGBN_NM" type="STRING" size="256"/>
          <Column id="CGBN_CD" type="STRING" size="256"/>
          <Column id="CGBN" type="STRING" size="256"/>
          <Column id="SSEQ" type="STRING" size="256"/>
          <Column id="M2" type="STRING" size="256"/>
          <Column id="M3" type="STRING" size="256"/>
          <Column id="M4" type="STRING" size="256"/>
          <Column id="M5" type="STRING" size="256"/>
          <Column id="M6" type="STRING" size="256"/>
          <Column id="M7" type="STRING" size="256"/>
          <Column id="M1" type="STRING" size="256"/>
          <Column id="P2" type="BIGDECIMAL" size="256"/>
          <Column id="P3" type="BIGDECIMAL" size="256"/>
          <Column id="P4" type="BIGDECIMAL" size="256"/>
          <Column id="P5" type="BIGDECIMAL" size="256"/>
          <Column id="P6" type="BIGDECIMAL" size="256"/>
          <Column id="P7" type="BIGDECIMAL" size="256"/>
          <Column id="P1" type="BIGDECIMAL" size="256"/>
          <Column id="T2" type="STRING" size="256"/>
          <Column id="T3" type="STRING" size="256"/>
          <Column id="T4" type="STRING" size="256"/>
          <Column id="T5" type="STRING" size="256"/>
          <Column id="T6" type="STRING" size="256"/>
          <Column id="T7" type="STRING" size="256"/>
          <Column id="T1" type="STRING" size="256"/>
          <Column id="D2" type="STRING" size="256"/>
          <Column id="D3" type="STRING" size="256"/>
          <Column id="D4" type="STRING" size="256"/>
          <Column id="D5" type="STRING" size="256"/>
          <Column id="D6" type="STRING" size="256"/>
          <Column id="D7" type="STRING" size="256"/>
          <Column id="D1" type="STRING" size="256"/>
          <Column id="C2" type="STRING" size="256"/>
          <Column id="C3" type="STRING" size="256"/>
          <Column id="C4" type="STRING" size="256"/>
          <Column id="C5" type="STRING" size="256"/>
          <Column id="C6" type="STRING" size="256"/>
          <Column id="C7" type="STRING" size="256"/>
          <Column id="C1" type="STRING" size="256"/>
          <Column id="Z2" type="STRING" size="256"/>
          <Column id="Z3" type="STRING" size="256"/>
          <Column id="Z4" type="STRING" size="256"/>
          <Column id="Z5" type="STRING" size="256"/>
          <Column id="Z6" type="STRING" size="256"/>
          <Column id="Z7" type="STRING" size="256"/>
          <Column id="Z1" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_pastCond" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="MENU_CLASS" type="STRING" size="256"/>
          <Column id="COST_TYPE" type="STRING" size="256"/>
          <Column id="MENU_TYPE" type="STRING" size="256"/>
          <Column id="MEAL" type="STRING" size="256"/>
          <Column id="MENU_DATE" type="STRING" size="256"/>
          <Column id="MENU_SDATE" type="STRING" size="256"/>
          <Column id="MENU_EDATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_corner" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="cbo_menuClass" propid="value" datasetid="ds_cond" columnid="MENU_CLASS"/>
      <BindItem id="item1" compid="cbo_costType" propid="value" datasetid="ds_cond" columnid="COST_TYPE"/>
      <BindItem id="item2" compid="cbo_menuType" propid="value" datasetid="ds_cond" columnid="MENU_TYPE"/>
      <BindItem id="item3" compid="cbo_meal" propid="value" datasetid="ds_cond" columnid="MEAL"/>
      <BindItem id="item4" compid="cbo_corner" propid="value" datasetid="ds_cond" columnid="CORNER"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";

/******************************************************************************************
 * 시스템구분 : 메뉴관리/식단관리
 * 프로그램명 : FSM90010E.XML
 * 기ㅡㅡㅡ능 : 기간표준식단관리
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************/

//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var menuCnt    = 0;	          // 식단등록 수
var isEvalShow = false;       // 식단평가 팝업 여부
var fa_PFormID = "FSM90010E"  // 식단평가 팝업에서 분기 조건으로 사용

//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(this, false);

	// X-Framework : Action 정보 생성
	fsp_init(this);
	
	// 초기화
	fn_init();
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_init()
 * 기ㅡㅡㅡ능 : 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function fn_init()
{
	// 조회조건 초기화
	ds_cond.clearData();
	ds_cond.addRow();
	ds_pastCond.clearData();
	ds_pastCond.addRow();


	// 공통코드 조회
	var v_fil_cond;
	var v_ds = fn_common_code("'FS0029','FS0030','FS0031','FS0023','FS0022'","","","non","Y");
	
	// 기간식단분류(ds_cboMenuClass, GROUP_CODE : 'FS0029')
	v_fil_cond = "GROUP_CODE == 'FS0029'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_cboMenuClass, v_ds.name);

	// 원가유형(ds_cboCostType, GROUP_CODE : 'FS0030')
	v_fil_cond = "GROUP_CODE == 'FS0030'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_cboCostType, v_ds.name);
	
	// 식단유형(ds_cboMenuType, GROUP_CODE : 'FS0031')
	v_fil_cond = "GROUP_CODE == 'FS0031'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_cboMenuType, v_ds.name);

	// 끼니(ds_cboMeal, GROUP_CODE : 'FS0023')
	v_fil_cond = "GROUP_CODE == 'FS0023' && SET3 == 'Y'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_cboMeal, v_ds.name);

	// 코너(ds_CORNER, GROUP_CODE : 'FS0022')
	v_fil_cond = "GROUP_CODE == 'FS0022' && SET3 =='Y'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_corner, v_ds.name);
	
	// 초기값 세팅
	cbo_menuClass.index = 0;
	cbo_costType.index = 0;
	cbo_menuType.index = 0;
	cbo_meal.index = 0;
	cbo_corner.index = 0;
	cal_menuDate.fn_initMonthCal(this, gfn_today(), "", ds_cond, "MENU_DATE", "Y");
	//cal_menuDate.fn_initMonthCal(this, "20130424", "", ds_cond, "MENU_DATE", "Y");
	
	// 메뉴제공일에 포커스 처리
	cal_menuDate.setFocus();
}

//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,출력)
//
//=========================================================================================
/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_search()
 * 기ㅡㅡㅡ능 : 조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function fn_search()
{
	// 식단평가 div 안보이게 처리
	div_eval.visible = false;
	isEvalShow = false;
	
	// 식단제공일 필수 체크
	if(gfn_isNull(ds_cond.getColumn(0, "MENU_DATE")))
	{
		g_Message("EE",	"식단 제공일을 입력해주세요.");
		return;
	}

	// 메뉴정보 조회 (금주)
	fn_menuSearch();
}

function fn_callback(errCode, errMsg) 
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오!");
		return;
	}
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_menuSearch()
 * 기ㅡㅡㅡ능 : 메뉴정보 조회 (일자, 날씨정보)
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function fn_menuSearch()
{
	// 주(Week)의 시작일, 종료일 세팅
	fn_setPeriodOfWeek(ds_cond, ds_cond.getColumn(0, "MENU_DATE"));

	ds_headList.clearData();
	ds_bodyList.clearData();
	fsp_clear(this); 
    fsp_addSearch(this, "fs/fsm:FSM00020E_S002");  // 헤더 정보
    fsp_addSearch(this, "fs/fsm:FSM00020E_S003");  // 메뉴 정보
    fsp_callService(this, "", "", "ds_input=ds_cond", "ds_headList=DS_head ds_bodyList=DS_body", "", "fn_callbackMenuSearch");
}

function fn_callbackMenuSearch(errCode, errMsg) 
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오!");
		return;
	}
	else
	{
		if(ds_bodyList.getRowCount() == 0)
		{
			for(var i=0; i<ds_headList.getRowCount(); i++)
			{
				var nRow = ds_bodyList.addRow();
				ds_bodyList.setColumn(nRow, "KEY"     , cbo_meal.value + "001" + "1");
				ds_bodyList.setColumn(nRow, "SGBN"    , cbo_meal.value);
				ds_bodyList.setColumn(nRow, "SGBN_NM" , cbo_meal.text);
				ds_bodyList.setColumn(nRow, "CGBN_CD" , cbo_corner.value);
				ds_bodyList.setColumn(nRow, "CGBN"    , cbo_corner.text);
				ds_bodyList.setColumn(nRow, "SSEQ"    , "1");
				ds_bodyList.setColumn(nRow, "FDAY" , ds_headList.getColumn(i, "FDAY"));
				ds_bodyList.setColumn(nRow, "WEEK" , ds_headList.getColumn(i, "WEEK"));
			}
		}
	
		fn_setGridData("menuList", "headList", "bodyList");
		
		// 주간 표준원가 세팅 (menuCnt는 메뉴 데이터 세팅시 계산)
		edt_avgCost.value = Math.round(ds_bodyList.getSum("SD_WON") / menuCnt, 0);
		
		// 식단평가 날짜버튼 세팅
		div_eval.setBtnDate();
		
		// 메뉴정보 조회 (지난주)
		fn_pastMenuSearch();
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_menuSearch()
 * 기ㅡㅡㅡ능 : 지난주 메뉴정보 조회 (일자, 날씨정보)
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function fn_pastMenuSearch()
{
	// 주(Week)의 시작일, 종료일 세팅
	ds_pastCond.copyData(ds_cond, false);
	fn_setPeriodOfWeek(ds_pastCond, gfn_addDate(ds_cond.getColumn(0, "MENU_DATE"), -6));

	ds_pastHeadList.clearData();
	ds_pastBodyList.clearData();
	fsp_clear(this); 
    fsp_addSearch(this, "fs/fsm:FSM00020E_S002");  // 헤더 정보
    fsp_addSearch(this, "fs/fsm:FSM00020E_S003");  // 메뉴 정보
    fsp_callService(this, "", "", "ds_input=ds_pastCond", "ds_pastHeadList=DS_head ds_pastBodyList=DS_body", "", "fn_callbackPastMenuSearch");
}

function fn_callbackPastMenuSearch(errCode, errMsg) 
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오!");
		return;
	}
	else
	{
		fn_setGridData("pastMenuList", "pastHeadList", "pastBodyList");
		
		// 지난주 주간 표준원가 세팅 (menuCnt는 메뉴 데이터 세팅시 계산)
		edt_pastAvgCost.value = Math.round(ds_pastBodyList.getSum("SD_WON") / menuCnt, 0);
		
		// 증감율
		edt_avgCostRate.value = Math.round((Number(edt_avgCost.value) - Number(edt_pastAvgCost.value)) / Number(edt_avgCost.value), 5) * 100;
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_setGridData(menuObj, headObj, bodyObj)
 * 기ㅡㅡㅡ능 : 그리드 데이터 세팅
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function fn_setGridData(menuObj, headObj, bodyObj)
{
	var dsMenuObj = eval("ds_" + menuObj);
	var grdMenuObj = eval("grd_" + menuObj);
	var dsHeadObj = eval("ds_" + headObj);
	var dsBodyObj = eval("ds_" + bodyObj);
	
	menuCnt = 0;
	dsMenuObj.clearData();

	// 헤더 데이터 세팅
	var idx = 0;
	var sDay = "";
	var sImage = "";
	for(var i=0; i<grdMenuObj.getFormatColCount(); i++)
	{
		if(i % 2 != 0) 
		{
			// 날짜 세팅
			sDay = gfn_subStr(dsHeadObj.getColumn(idx, "FDAY"), 4, 2) + "/" + gfn_subStr(dsHeadObj.getColumn(idx, "FDAY"), 6, 2) + "(" + dsHeadObj.getColumn(idx, "WE") + ")"
			grdMenuObj.setCellProperty("Head", i, "text", sDay);

			// 날씨 이미지 세팅
			sImage = "URL('theme://convertImages/" + dsHeadObj.getColumn(idx, "WIMG") + ".png')";			
  		    grdMenuObj.setCellProperty('head', i + 1, 'displaytype', 'image'); 
			grdMenuObj.setCellProperty("head", i + 1, "text", sImage);
			idx ++;
		}
	}

	// 컬럼 데이터 세팅
	var sKey = "";
	var nRow = 0;
	for(var i=0; i<dsBodyObj.getRowCount(); i++)
	{
		nRow = dsMenuObj.findRow("KEY", dsBodyObj.getColumn(i, "KEY"));
		// 키가 존재하지 않을 경우 행 추가 후 세팅
		if(nRow == -1)
		{
			nRow = dsMenuObj.addRow();
			dsMenuObj.setColumn(nRow, "KEY"         , dsBodyObj.getColumn(i, "KEY"));			// 끼니코드 + 코너코드 + 레시피순번
			dsMenuObj.setColumn(nRow, "SGBN"        , dsBodyObj.getColumn(i, "SGBN"));			// 끼니코드
			dsMenuObj.setColumn(nRow, "SGBN_NM"     , dsBodyObj.getColumn(i, "SGBN_NM"));		// 끼니명
			dsMenuObj.setColumn(nRow, "CGBN_CD"     , dsBodyObj.getColumn(i, "CGBN_CD"));		// 코너코드
			dsMenuObj.setColumn(nRow, "CGBN"        , dsBodyObj.getColumn(i, "CGBN"));			// 코너명
			dsMenuObj.setColumn(nRow, "SSEQ"        , dsBodyObj.getColumn(i, "SSEQ"));			// 레시피순번
		}
		dsMenuObj.setColumn(nRow, "T" + dsBodyObj.getColumn(i, "WEEK"), dsBodyObj.getColumn(i, "TERM_MENU_CD"));	// 메뉴코드
		dsMenuObj.setColumn(nRow, "D" + dsBodyObj.getColumn(i, "WEEK"), dsBodyObj.getColumn(i, "FDAY"));			// 제공일
		dsMenuObj.setColumn(nRow, "M" + dsBodyObj.getColumn(i, "WEEK"), dsBodyObj.getColumn(i, "SD_NM"));			// 레시피명
		dsMenuObj.setColumn(nRow, "P" + dsBodyObj.getColumn(i, "WEEK"), dsBodyObj.getColumn(i, "SD_WON"));			// 레시피원가
		dsMenuObj.setColumn(nRow, "C" + dsBodyObj.getColumn(i, "WEEK"), dsBodyObj.getColumn(i, "DUP_COLOR"));		// 식단평가색상
		dsMenuObj.setColumn(nRow, "Z" + dsBodyObj.getColumn(i, "WEEK"), dsBodyObj.getColumn(i, "ATTR02"));			// 대표레시피

		// 소계 처리
		if(dsBodyObj.getColumn(i, "SGBN") != dsBodyObj.getColumn(i + 1, "SGBN"))
		{
			nRow = dsMenuObj.addRow();
			dsMenuObj.setColumn(nRow, "SGBN"        , dsBodyObj.getColumn(i, "SGBN"));
			dsMenuObj.setColumn(nRow, "SGBN_NM"     , dsBodyObj.getColumn(i, "SGBN_NM"));
			dsMenuObj.setColumn(nRow, "CGBN_CD"     , dsBodyObj.getColumn(i, "CGBN_CD"));
			dsMenuObj.setColumn(nRow, "CGBN"        , dsBodyObj.getColumn(i, "CGBN"));
			dsMenuObj.setColumn(nRow, "SSEQ"        , dsBodyObj.getColumn(i, "SSEQ"));
			
			for(var j=0; j<dsHeadObj.getRowCount(); j++)
			{
				if(dsMenuObj.getSum("P" + (j + 1)) > 0)
				{
					dsMenuObj.setColumn(nRow, "T" + (j + 1), dsMenuObj.getMax("T" + (j + 1)));        // 메뉴코드
					dsMenuObj.setColumn(nRow, "D" + (j + 1), dsMenuObj.getMax("D" + (j + 1)));        // 제공일
					dsMenuObj.setColumn(nRow, "M" + (j + 1), Put_comma(dsMenuObj.getSum("P" + (j + 1)), 0) + " 원");   // 소계

					// 주간평균원가 계산용 식단제공수 처리
					menuCnt ++;
				}
			}
		}
	}

	var sProp1 = "0 none #c3c3c3ff, 1 solid #c3c3c3ff, 0 none #c3c3c3ff,  0 none #c3c3c3ff";   // body line
	var sProp2 = "0 none #c3c3c3ff, 0 none #c3c3c3ff,   0 none #c3c3c3ff,  0 none #c3c3c3ff";  // body line (오른쪽라인 없는 Style)
	var sProp3 = "0 none #c3c3c3ff, 1 solid #c3c3c3ff, 1 solid #c3c3c3ff, 0 none #c3c3c3ff";   // 소계 line
	var sProp4 = "0 none #c3c3c3ff, 0 none #c3c3c3ff,   1 solid #c3c3c3ff, 0 none #c3c3c3ff";  // 소계 line (오른쪽라인 없는 Style)
	sImage = "URL('theme://Images/new/grd_WF_ExpandImageX.png') middle center #DDFCDB";
	var expr = "";
	
	for(var i=0; i<grdMenuObj.getFormatColCount(); i++)
	{
		if(i % 2 == 0)
		{
			expr = 'EXPR(!gfn_isNull(KEY)?"' + sProp1 + '":"' + sProp3 + '")';
			
			// 식단 삭제버튼 (금주 그리드에만 처리)
			if(i > 0 && menuObj == "menuList")
			{
				// 식단평가 색상처리를 위해 색상컬럼 ID를 찾는다.
				var val = grdMenuObj.getCellProperty("body", i, "text");
				if(!gfn_isNull(val))
				{
					val = 'C' + gfn_right(val.replace("bind:", ""), 1);
				}
				grdMenuObj.setCellProperty("body", i, "background", 'EXPR(!gfn_isNull(' + val + ') ?' + val + ':!gfn_isNull(KEY)?"whitesmoke":"' + sImage + '")');
				grdMenuObj.setCellProperty("body", i, "background2", 'EXPR(!gfn_isNull(' + val + ') ?' + val + ':!gfn_isNull(KEY)?"whitesmoke":"' + sImage + '")');
				grdMenuObj.setCellProperty("body", i, "selectbackground", 'EXPR(!gfn_isNull(KEY)?"":"#DDFCDB ' + sImage + '")');
			} 
		}
		else
		{
			expr = 'EXPR(!gfn_isNull(KEY)?"' + sProp2 + '":"' + sProp4 + '")';
		}
		grdMenuObj.setCellProperty("body", i, "line", expr);
		
		if(i > 0)
		{
			grdMenuObj.setCellProperty("body", i, "font", 'EXPR(!gfn_isNull(KEY)?"굴림,9":"굴림,9,bold right")');
			grdMenuObj.setCellProperty("body", i, "selectfont", 'EXPR(!gfn_isNull(KEY)?"굴림,9":"굴림,9,bold")');
			grdMenuObj.setCellProperty("body", i, "align", 'EXPR(!gfn_isNull(KEY)?"":"right middle")');
		}
	}
	// 표준식단 그리드의 끼니 컬럼 bold 처리
	grdMenuObj.setCellProperty("body", 0, "font", "굴림,9,bold");
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_setPeriodOfWeek(menuDate)
 * 기ㅡㅡㅡ능 : 일자가 속한 주(Week)의 시작일, 종료일 세팅 (월 ~ 일)
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function fn_setPeriodOfWeek(condObj, menuDate)
{
	var objCalendar = new Calendar();
	objCalendar.value = menuDate;

	var startDate = gfn_getStartOfWeek(objCalendar);	// 시작일
	var endDate = gfn_getEndOfWeek(objCalendar);		// 종료일
	
	// 조회조건의 식단 제공일이 일요일일 경우 전주 식단을 제공
	var addDay = 0;
	if(startDate == menuDate) 
	{
		addDay = -6;
	}
	else
	{
		addDay = 1;
	}
	
	condObj.setColumn(0, "MENU_SDATE", gfn_addDate(startDate, addDay));
	condObj.setColumn(0, "MENU_EDATE", gfn_addDate(endDate, addDay));
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : grd_menuList_oncellclick(obj:Grid, e:GridClickEventInfo)
 * 기ㅡㅡㅡ능 : 식단평가 팝업에서 선택시 식단 그리드에 색상마킹 처리
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function fn_dupColor(p_eval, p_date, p_row, p_title)
{
	var if_col = ""; // 컬러를 적용할 조건 컬럼
	var v_case = ""; // fillter 할 조건

	// 색을 적용할 조건 컬럼을 셋팅
	switch(p_eval) {
		case 0:
			if_col = "SD_NM";	        // 시피명 중복횟수
			break;
		case 1:
			if_col = "MAIN_ITEM_CODE1";	// 주재료군 중복횟수
			break;
		case 2:
			if_col = "CUISINE_TYPE";    // 조리법 중복횟수
			break;
	}
	
	if (gfn_length(gfn_toString(p_row))> 0) {
		v_case += if_col + "=='" + ds_evalList.getColumn(p_row, "CD") + "'";
	}
	else {
		for (var i=0; i < ds_evalList.rowcount; i++)
		{
			if (i > 0) {
				v_case += " || ";
			}
			v_case += if_col + "=='" + ds_evalList.getColumn(i, "CD") + "'";
		}
	}
	
	// 특정일을 선택했을 경우 일자 조건 추가
	if (gfn_length(gfn_toString(p_date)) == 8) { // 일자 선택 시
		v_case += " && FDAY=='" + p_date + "'";
	}
	
	// 데이터 초기화
	ds_bodyList.filter('');
	for (var i=0; i < ds_bodyList.rowcount; i++)
	{
    	ds_bodyList.setColumn(i, "DUP_COLOR", '');
	}
	
	// 조건에 맞는 데이터를 필터링 하여 색상 데이터 세팅
  	ds_bodyList.filter(v_case);
	for (var i=0; i < ds_bodyList.rowcount; i++)
	{
    	ds_bodyList.setColumn(i, "DUP_COLOR", div_eval.fn_getColor(p_row));
	}
  	ds_bodyList.filter('');
  	
  	// 변경된 색상 정보로 그리드에 데이터를 다시 세팅한다.
  	fn_setGridData("menuList", "headList", "bodyList");
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// 
//=========================================================================================
/******************************************************************************************
 * 함ㅡ수ㅡ명 : grd_menuList_oncellclick(obj:Grid, e:GridClickEventInfo)
 * 기ㅡㅡㅡ능 : 그리드 선택시 처리 프로세스 (메뉴 삭제)
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function grd_menuList_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	if(e.col > 0)
	{
		var sCellType = grd_menuList.getCellProperty("body", e.col, "displaytype");
		if(sCellType == "number" && gfn_isNull(ds_menuList.getColumn(e.row, "KEY")))
		{
			var weekNum = gfn_right(grd_menuList.getCellProperty("body", e.col, "text"), 1);
			var sMenuCd = ds_menuList.getColumn(e.row, "T" + weekNum);
			
			if(gfn_isNull(sMenuCd)) return;
			
			var msg = grd_menuList.getCellProperty("head",  e.col - 1, "text") + " : " + ds_menuList.getColumn(e.row, "SGBN_NM") + ds_menuList.getColumn(e.row, "CGBN") + "을(를) 삭제하시겠습니까?\n\n[ " + sMenuCd + " ]";

			if (g_Confirm("04",	msg) == true) {
				// 삭제처리
				var actionName, cmdName, inData, outData, otherArg, callBackFnc;
				
				inData			= "";
				outData			= "";
				otherArg		= "MENU_CD=" + sMenuCd;
				callBackFnc		= "";
				
				fsp_clear(this); 
				fsp_addSearch(this, "fs/fsm:FSM00020E_D001");									// 조회 
				http.Sync = true;
				fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
				http.Sync = false;

				fn_search();
			}		
		}
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : grd_menuList_oncellclick(obj:Grid, e:GridClickEventInfo)
 * 기ㅡㅡㅡ능 : 그리드 더블클릭시 처리 프로세스 (메뉴 등록 팝업)
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function grd_menuList_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{

	// 해당 일자의 식단조회버튼을 클릭했을 경우
	if(e.col > 0)
	{
		var sCellType = grd_menuList.getCellProperty("body", e.col, "displaytype");
		if(sCellType == "text" && !gfn_isNull(ds_menuList.getColumn(e.row, "KEY")))
		{
			var weekNum = gfn_right(grd_menuList.getCellProperty("body", e.col, "text"), 1);
			var sMenuDate = ds_headList.getColumn((e.cell - 1) / 2, "FDAY");
			var msg = grd_menuList.getCellProperty("head",  e.col, "text") + " : " + ds_menuList.getColumn(e.row, "SGBN_NM") + ds_menuList.getColumn(e.row, "CGBN") + " 에 대한\n\n레시피 검색 및 등록/수정 작업을\n\n하시겠습니까?";

			if (g_Confirm("04",	msg) == true) {
				// 레시피 검색 및 등록/수정
				var v_arg = { fa_FROM_DT:ds_cond.getColumn(0, "MENU_SDATE")
						    , fa_TO_DT:ds_cond.getColumn(0, "MENU_EDATE")
						    , fa_MEAL:ds_menuList.getColumn(e.row, "SGBN")
						    , fa_CORNER:ds_menuList.getColumn(e.row, "CGBN_CD")
						    , fa_MENU_DATE:sMenuDate
						    , fa_MENU_CLASS:ds_cond.getColumn(0, "MENU_CLASS")
						    , fa_COST_TYPE:ds_cond.getColumn(0, "COST_TYPE")
						    , fa_MENU_TYPE:ds_cond.getColumn(0, "MENU_TYPE")};
				
				v_rtn = gfn_dialog("", "U_FSM::FSM00030E.xfdl", v_arg);
				
				fn_search();
			}
		}
	}	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : grd_menuList_onmousemove(obj:Grid, e:GridMouseEventInfo)
 * 기ㅡㅡㅡ능 : 이미지 버튼에 대한 커서 처리
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function grd_menuList_onmousemove(obj:Grid, e:GridMouseEventInfo)
{
	if(e.col > 0)
	{
		if(e.col % 2 == 0 && gfn_isNull(ds_menuList.getColumn(e.row, "KEY")))
		{
			grd_menuList.setCellProperty('body', e.col, 'cursor', 'pointer');
		}
		else
		{
			grd_menuList.setCellProperty('body', e.col, 'cursor', '');
		}
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_menuCopy_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 식단복사
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function btn_menuCopy_onclick(obj:Button,  e:ClickEventInfo)
{
	// 상단 검색조건 변경시는 조회 후  처리하여야 한다.
	if (gfn_dsIsUpdated(ds_cond)) {
		g_Message("EE",	"검색조건이 변경되었습니다.\n\n조회후 작업을 처리하세요.");
		return;
	}
	
	var v_arg = { fa_FROM_DT:ds_cond.getColumn(0, "MENU_SDATE")
				, fa_TO_DT:ds_cond.getColumn(0, "MENU_EDATE")
				, fa_MENU_CLASS:ds_cond.getColumn(0, "MENU_CLASS")
				, fa_MENU_CLASS_NM:cbo_menuClass.text
				, fa_COST_TYPE:ds_cond.getColumn(0, "COST_TYPE")
				, fa_COST_TYPE_NM:cbo_costType.text
				, fa_MENU_TYPE:ds_cond.getColumn(0, "MENU_TYPE")
				, fa_MENU_TYPE_NM:cbo_menuType.text
				, fa_MEAL:ds_cond.getColumn(0, "MEAL")
				, fa_MEAL_NM:cbo_meal.text};
	
	gfn_dialog("", "U_FSM::FSM00040E.xfdl", v_arg);
	fn_search();	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_nutAnalysis_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 영양분석
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function btn_nutAnalysis_onclick(obj:Button,  e:ClickEventInfo)
{
	// 상단 검색조건 변경시는 조회 후  처리하여야 한다.
	if (gfn_dsIsUpdated(ds_cond)) {
		g_Message("EE",	"검색조건이 변경되었습니다.\n\n조회후 작업을 처리하세요.");
		return;
	}

	var v_arg = { fa_FROM_MENU_DATE:ds_cond.getColumn(0, "MENU_SDATE")
				, fa_TO_MENU_DATE:ds_cond.getColumn(0, "MENU_EDATE")
				, fa_MENU_TYPE:ds_cond.getColumn(0, "MENU_TYPE")
				, fa_MEAL:ds_cond.getColumn(0, "MEAL")};

	gfn_dialog("", "U_FSM::FSM00021P.xfdl", v_arg);	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_excel_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 엑셀 다운로드
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function btn_excel_onclick(obj:Button,  e:ClickEventInfo)
{
	if (ds_menuList.getRowCount() == 0) {
		g_Message("EE",	"출력할 메뉴정보가 없습니다.");
		return;
	}
	
	gfn_exportExcel(grd_menuList, "식단표","","","","","cellline");	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_eval_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 식단평가
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function btn_eval_onclick(obj:Button,  e:ClickEventInfo)
{
	// 상단 검색조건 변경시는 조회 후  처리하여야 한다.
	if (gfn_dsIsUpdated(ds_cond)) {
		g_Message("EE",	"검색조건이 변경되었습니다.\n\n조회후 작업을 처리하세요.");
		return;
	}
	
	div_eval.visible = !isEvalShow;
	isEvalShow = !isEvalShow;
}]]></Script>
  </Form>
</FDL>

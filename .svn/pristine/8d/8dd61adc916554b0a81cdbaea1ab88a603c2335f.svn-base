<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSP00275V" onkeydown="frm_OnKeyDown" onload="form_onload" titletext="식자재 사용패턴 조회(관리자용)" position="absolute 0 0 1252 725" scrollbars="none" onsize="FSP00275V_onsize">
    <Layouts>
      <Layout>
        <Grid autoenter="select" binddataset="ds_list" readonly="false" enable="true" id="grd_list" useinputpanel="false" oncelldblclick="grd_list_OnCellDblClick" onheadclick="grd_List_OnHeadClick" taborder="7" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 84 1237 407" selecttype="row" anchor="left top right" class="grd_WF_LineNone" autofittype="none">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30" band="left"/>
                <Column size="80" band="left"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="100"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" class="head_Excel"/>
                <Cell col="1" rowspan="2" text="운영부서"/>
                <Cell col="2" colspan="2" displaytype="text" text="양곡"/>
                <Cell col="4" colspan="2" text="과실"/>
                <Cell col="6" colspan="2" text="채소"/>
                <Cell col="8" colspan="2" text="축산물"/>
                <Cell col="10" colspan="2" text="수산물"/>
                <Cell col="12" colspan="2" text="조미/양념"/>
                <Cell col="14" colspan="2" text="조리식재"/>
                <Cell col="16" colspan="2" text="김치"/>
                <Cell col="18" colspan="2" text="빵/떡류"/>
                <Cell col="20" colspan="2" text="유가공품"/>
                <Cell col="22" colspan="2" text="음료/주류"/>
                <Cell col="24" colspan="2" text="공산식품"/>
                <Cell col="26" colspan="2" text="가공식품(농산)"/>
                <Cell col="28" colspan="2" text="가공식품(수산)"/>
                <Cell col="30" colspan="2" text="가공식품(축산)"/>
                <Cell col="32" colspan="2" text="식사대용/경관식"/>
                <Cell col="34" colspan="2" text="식자재(호텔/외식)"/>
                <Cell col="36" colspan="2" text="기타식자재(가공)"/>
                <Cell col="38" text="합계"/>
                <Cell row="1" col="2" text="사용금액"/>
                <Cell row="1" col="3" text="구성비(%)"/>
                <Cell row="1" col="4" text="사용금액"/>
                <Cell row="1" col="5" text="구성비(%)"/>
                <Cell row="1" col="6" text="사용금액"/>
                <Cell row="1" col="7" text="구성비(%)"/>
                <Cell row="1" col="8" text="사용금액"/>
                <Cell row="1" col="9" text="구성비(%)"/>
                <Cell row="1" col="10" text="사용금액"/>
                <Cell row="1" col="11" text="구성비(%)"/>
                <Cell row="1" col="12" text="사용금액"/>
                <Cell row="1" col="13" text="구성비(%)"/>
                <Cell row="1" col="14" text="사용금액"/>
                <Cell row="1" col="15" text="구성비(%)"/>
                <Cell row="1" col="16" text="사용금액"/>
                <Cell row="1" col="17" text="구성비(%)"/>
                <Cell row="1" col="18" text="사용금액"/>
                <Cell row="1" col="19" text="구성비(%)"/>
                <Cell row="1" col="20" text="사용금액"/>
                <Cell row="1" col="21" text="구성비(%)"/>
                <Cell row="1" col="22" text="사용금액"/>
                <Cell row="1" col="23" text="구성비(%)"/>
                <Cell row="1" col="24" text="사용금액"/>
                <Cell row="1" col="25" text="구성비(%)"/>
                <Cell row="1" col="26" text="사용금액"/>
                <Cell row="1" col="27" text="구성비(%)"/>
                <Cell row="1" col="28" text="사용금액"/>
                <Cell row="1" col="29" text="구성비(%)"/>
                <Cell row="1" col="30" text="사용금액"/>
                <Cell row="1" col="31" text="구성비(%)"/>
                <Cell row="1" col="32" text="사용금액"/>
                <Cell row="1" col="33" text="구성비(%)"/>
                <Cell row="1" col="34" text="사용금액"/>
                <Cell row="1" col="35" text="구성비(%)"/>
                <Cell row="1" col="36" text="사용금액"/>
                <Cell row="1" col="37" text="구성비(%)"/>
                <Cell row="1" col="38" text="사용금액"/>
              </Band>
              <Band id="body">
                <Cell style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:TM_NM"/>
                <Cell col="2" displaytype="number" style="align:right;" text="bind:AMT01"/>
                <Cell col="3" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT01/AMT_TOT*100,1)) ? 0 : Math.round(AMT01/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="4" displaytype="number" style="align:right;" text="bind:AMT02"/>
                <Cell col="5" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT02/AMT_TOT*100,1)) ? 0 : Math.round(AMT02/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:AMT03"/>
                <Cell col="7" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT03/AMT_TOT*100,1)) ? 0 : Math.round(AMT03/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="8" displaytype="number" style="align:right;" text="bind:AMT04"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT04/AMT_TOT*100,1)) ? 0 : Math.round(AMT04/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="10" displaytype="number" style="align:right;" text="bind:AMT05"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT05/AMT_TOT*100,1)) ? 0 : Math.round(AMT05/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="12" displaytype="number" style="align:right;" text="bind:AMT06"/>
                <Cell col="13" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT06/AMT_TOT*100,1)) ? 0 : Math.round(AMT06/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="14" displaytype="number" style="align:right;" text="bind:AMT07"/>
                <Cell col="15" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT07/AMT_TOT*100,1)) ? 0 : Math.round(AMT07/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="16" displaytype="number" style="align:right;" text="bind:AMT08"/>
                <Cell col="17" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT8/AMT_TOT*100,1)) ? 0 : Math.round(AMT08/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="18" displaytype="number" style="align:right;" text="bind:AMT09"/>
                <Cell col="19" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT9/AMT_TOT*100,1)) ? 0 : Math.round(AMT09/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="20" displaytype="number" style="align:right;" text="bind:AMT10"/>
                <Cell col="21" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT10/AMT_TOT*100,1)) ? 0 : Math.round(AMT10/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="22" displaytype="number" style="align:right;" text="bind:AMT11"/>
                <Cell col="23" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT11/AMT_TOT*100,1)) ? 0 : Math.round(AMT11/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="24" displaytype="number" style="align:right;" text="bind:AMT12"/>
                <Cell col="25" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT12/AMT_TOT*100,1)) ? 0 : Math.round(AMT12/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="26" displaytype="number" style="align:right;" text="bind:AMT13"/>
                <Cell col="27" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT13/AMT_TOT*100,1)) ? 0 : Math.round(AMT13/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="28" displaytype="number" style="align:right;" text="bind:AMT14"/>
                <Cell col="29" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT14/AMT_TOT*100,1)) ? 0 : Math.round(AMT14/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="30" displaytype="number" style="align:right;" text="bind:AMT15"/>
                <Cell col="31" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT15/AMT_TOT*100,1)) ? 0 : Math.round(AMT15/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="32" displaytype="number" style="align:right;" text="bind:AMT16"/>
                <Cell col="33" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT16/AMT_TOT*100,1)) ? 0 : Math.round(AMT16/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="34" displaytype="number" style="align:right;" text="bind:AMT17"/>
                <Cell col="35" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT17/AMT_TOT*100,1)) ? 0 : Math.round(AMT17/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="36" displaytype="number" style="align:right;" text="bind:AMT18"/>
                <Cell col="37" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT18/AMT_TOT*100,1)) ? 0 : Math.round(AMT18/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="38" displaytype="number" style="align:right;" text="bind:AMT_TOT"/>
              </Band>
              <Band id="summary">
                <Cell style="align:left;"/>
                <Cell col="1" style="align:center;" text="합계"/>
                <Cell col="2" displaytype="number" style="align:right;" expr="expr:getSum('AMT01')"/>
                <Cell col="3" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT01')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT01')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="4" displaytype="number" style="align:right;" expr="expr:getSum('AMT02')"/>
                <Cell col="5" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT02')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT02')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="6" displaytype="number" style="align:right;" expr="expr:getSum('AMT03')"/>
                <Cell col="7" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT03')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT03')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="8" displaytype="number" style="align:right;" expr="expr:getSum('AMT04')"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT04')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT04')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="expr:getSum('AMT05')"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT05')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT05')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="12" displaytype="number" style="align:right;" expr="expr:getSum('AMT06')"/>
                <Cell col="13" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT06')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT06')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="14" displaytype="number" style="align:right;" expr="expr:getSum('AMT07')"/>
                <Cell col="15" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT07')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT07')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="16" displaytype="number" style="align:right;" expr="expr:getSum('AMT08')"/>
                <Cell col="17" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT08')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT08')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="18" displaytype="number" style="align:right;" expr="expr:getSum('AMT09')"/>
                <Cell col="19" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT09')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT09')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="20" displaytype="number" style="align:right;" expr="expr:getSum('AMT10')"/>
                <Cell col="21" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT10')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT10')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="22" displaytype="number" style="align:right;" expr="expr:getSum('AMT11')"/>
                <Cell col="23" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT11')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT11')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="24" displaytype="number" style="align:right;" expr="expr:getSum('AMT12')"/>
                <Cell col="25" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT12')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT12')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="26" displaytype="number" style="align:right;" expr="expr:getSum('AMT13')"/>
                <Cell col="27" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT13')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT13')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="28" displaytype="number" style="align:right;" expr="expr:getSum('AMT14')"/>
                <Cell col="29" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT14')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT14')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="30" displaytype="number" style="align:right;" expr="expr:getSum('AMT15')"/>
                <Cell col="31" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT15')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT15')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="32" displaytype="number" style="align:right;" expr="expr:getSum('AMT16')"/>
                <Cell col="33" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT16')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT16')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="34" displaytype="number" style="align:right;" expr="expr:getSum('AMT17')"/>
                <Cell col="35" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT17')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT17')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="36" displaytype="number" style="align:right;" expr="expr:getSum('AMT18')"/>
                <Cell col="37" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT18')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT18')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="38" displaytype="number" style="align:right;" expr="expr:getSum('AMT_TOT')"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Splitter type="vertical" id="sp_line" onmove="sp_line_OnMove" position="absolute 0 412 1237 422" class="spt_WF_2" max="-1" min="84" anchor="left top right">
          <Formats>
            <Format id="default">
              <SplitterItems id="items">
                <SplitterItem id="item00" bindtype="resize" position="leftortop" offset="5" componentid="grd_list"/>
                <SplitterItem id="item01" bindtype="resize" position="rightorbottom" offset="5" componentid="grd_Detail"/>
              </SplitterItems>
            </Format>
          </Formats>
        </Splitter>
        <Grid autoenter="select" binddataset="ds_Detail" cellsizingtype="both" readonly="false" enable="true" id="grd_Detail" useinputpanel="false" onheadclick="grd_List_OnHeadClick" taborder="8" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 427 1237 710" selecttype="row" anchor="all" class="grd_WF_LineNone" autofittype="none">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30" band="left"/>
                <Column size="60" band="left"/>
                <Column size="73" band="left"/>
                <Column size="195" band="left"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="100"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" class="head_Excel"/>
                <Cell col="1" rowspan="2" text="직군"/>
                <Cell col="2" rowspan="2" text="상세직군"/>
                <Cell col="3" rowspan="2" text="사업장"/>
                <Cell col="4" colspan="2" displaytype="text" text="양곡"/>
                <Cell col="6" colspan="2" text="과실"/>
                <Cell col="8" colspan="2" text="채소"/>
                <Cell col="10" colspan="2" text="축산물"/>
                <Cell col="12" colspan="2" text="수산물"/>
                <Cell col="14" colspan="2" text="조미/양념"/>
                <Cell col="16" colspan="2" text="조리식재"/>
                <Cell col="18" colspan="2" text="김치"/>
                <Cell col="20" colspan="2" text="빵/떡류"/>
                <Cell col="22" colspan="2" text="유가공품"/>
                <Cell col="24" colspan="2" text="음료/주류"/>
                <Cell col="26" colspan="2" text="공산식품"/>
                <Cell col="28" colspan="2" text="가공식품(농산)"/>
                <Cell col="30" colspan="2" text="가공식품(수산)"/>
                <Cell col="32" colspan="2" text="가공식품(축산)"/>
                <Cell col="34" colspan="2" text="식사대용/경관식"/>
                <Cell col="36" colspan="2" text="식자재(호텔/외식)"/>
                <Cell col="38" colspan="2" text="기타식자재(가공)"/>
                <Cell col="40" text="합계"/>
                <Cell row="1" col="4" text="사용금액"/>
                <Cell row="1" col="5" text="구성비(%)"/>
                <Cell row="1" col="6" text="사용금액"/>
                <Cell row="1" col="7" text="구성비(%)"/>
                <Cell row="1" col="8" text="사용금액"/>
                <Cell row="1" col="9" text="구성비(%)"/>
                <Cell row="1" col="10" text="사용금액"/>
                <Cell row="1" col="11" text="구성비(%)"/>
                <Cell row="1" col="12" text="사용금액"/>
                <Cell row="1" col="13" text="구성비(%)"/>
                <Cell row="1" col="14" text="사용금액"/>
                <Cell row="1" col="15" text="구성비(%)"/>
                <Cell row="1" col="16" text="사용금액"/>
                <Cell row="1" col="17" text="구성비(%)"/>
                <Cell row="1" col="18" text="사용금액"/>
                <Cell row="1" col="19" text="구성비(%)"/>
                <Cell row="1" col="20" text="사용금액"/>
                <Cell row="1" col="21" text="구성비(%)"/>
                <Cell row="1" col="22" text="사용금액"/>
                <Cell row="1" col="23" text="구성비(%)"/>
                <Cell row="1" col="24" text="사용금액"/>
                <Cell row="1" col="25" text="구성비(%)"/>
                <Cell row="1" col="26" text="사용금액"/>
                <Cell row="1" col="27" text="구성비(%)"/>
                <Cell row="1" col="28" text="사용금액"/>
                <Cell row="1" col="29" text="구성비(%)"/>
                <Cell row="1" col="30" text="사용금액"/>
                <Cell row="1" col="31" text="구성비(%)"/>
                <Cell row="1" col="32" text="사용금액"/>
                <Cell row="1" col="33" text="구성비(%)"/>
                <Cell row="1" col="34" text="사용금액"/>
                <Cell row="1" col="35" text="구성비(%)"/>
                <Cell row="1" col="36" text="사용금액"/>
                <Cell row="1" col="37" text="구성비(%)"/>
                <Cell row="1" col="38" text="사용금액"/>
                <Cell row="1" col="39" text="구성비(%)"/>
                <Cell row="1" col="40" text="사용금액"/>
              </Band>
              <Band id="body">
                <Cell style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:JOB_NAME" suppress="1"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:SUB_JOB_NAME" suppress="2"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:UPJANGNM"/>
                <Cell col="4" displaytype="number" style="align:right;" text="bind:AMT01"/>
                <Cell col="5" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT01/AMT_TOT*100,1)) ? 0 : Math.round(AMT01/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:AMT02"/>
                <Cell col="7" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT02/AMT_TOT*100,1)) ? 0 : Math.round(AMT02/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="8" displaytype="number" style="align:right;" text="bind:AMT03"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT03/AMT_TOT*100,1)) ? 0 : Math.round(AMT03/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="10" displaytype="number" style="align:right;" text="bind:AMT04"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT04/AMT_TOT*100,1)) ? 0 : Math.round(AMT04/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="12" displaytype="number" style="align:right;" text="bind:AMT05"/>
                <Cell col="13" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT05/AMT_TOT*100,1)) ? 0 : Math.round(AMT05/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="14" displaytype="number" style="align:right;" text="bind:AMT06"/>
                <Cell col="15" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT06/AMT_TOT*100,1)) ? 0 : Math.round(AMT06/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="16" displaytype="number" style="align:right;" text="bind:AMT07"/>
                <Cell col="17" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT07/AMT_TOT*100,1)) ? 0 : Math.round(AMT07/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="18" displaytype="number" style="align:right;" text="bind:AMT08"/>
                <Cell col="19" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT08/AMT_TOT*100,1)) ? 0 : Math.round(AMT08/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="20" displaytype="number" style="align:right;" text="bind:AMT09"/>
                <Cell col="21" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT09/AMT_TOT*100,1)) ? 0 : Math.round(AMT09/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="22" displaytype="number" style="align:right;" text="bind:AMT10"/>
                <Cell col="23" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT10/AMT_TOT*100,1)) ? 0 : Math.round(AMT10/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="24" displaytype="number" style="align:right;" text="bind:AMT11"/>
                <Cell col="25" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT11/AMT_TOT*100,1)) ? 0 : Math.round(AMT11/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="26" displaytype="number" style="align:right;" text="bind:AMT12"/>
                <Cell col="27" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT12/AMT_TOT*100,1)) ? 0 : Math.round(AMT12/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="28" displaytype="number" style="align:right;" text="bind:AMT13"/>
                <Cell col="29" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT13/AMT_TOT*100,1)) ? 0 : Math.round(AMT13/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="30" displaytype="number" style="align:right;" text="bind:AMT14"/>
                <Cell col="31" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT14/AMT_TOT*100,1)) ? 0 : Math.round(AMT14/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="32" displaytype="number" style="align:right;" text="bind:AMT15"/>
                <Cell col="33" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT15/AMT_TOT*100,1)) ? 0 : Math.round(AMT15/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="34" displaytype="number" style="align:right;" text="bind:AMT16"/>
                <Cell col="35" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT16/AMT_TOT*100,1)) ? 0 : Math.round(AMT16/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="36" displaytype="number" style="align:right;" text="bind:AMT17"/>
                <Cell col="37" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT17/AMT_TOT*100,1)) ? 0 : Math.round(AMT17/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="38" displaytype="number" style="align:right;" text="bind:AMT18"/>
                <Cell col="39" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(AMT18/AMT_TOT*100,1)) ? 0 : Math.round(AMT18/AMT_TOT*100,1)" mask="###,##0.0"/>
                <Cell col="40" displaytype="number" style="align:right;" text="bind:AMT_TOT"/>
              </Band>
              <Band id="summary">
                <Cell style="align:left;"/>
                <Cell col="1" colspan="3" style="align:center;" text="합계"/>
                <Cell col="4" displaytype="number" style="align:right;" expr="expr:getSum('AMT01')"/>
                <Cell col="5" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT01')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT01')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="6" displaytype="number" style="align:right;" expr="expr:getSum('AMT02')"/>
                <Cell col="7" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT02')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT02')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="8" displaytype="number" style="align:right;" expr="expr:getSum('AMT03')"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT03')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT03')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="expr:getSum('AMT04')"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT04')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT04')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="12" displaytype="number" style="align:right;" expr="expr:getSum('AMT05')"/>
                <Cell col="13" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT05')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT05')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="14" displaytype="number" style="align:right;" expr="expr:getSum('AMT06')"/>
                <Cell col="15" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT06')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT06')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="16" displaytype="number" style="align:right;" expr="expr:getSum('AMT07')"/>
                <Cell col="17" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT07')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT07')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="18" displaytype="number" style="align:right;" expr="expr:getSum('AMT08')"/>
                <Cell col="19" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT08')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT08')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="20" displaytype="number" style="align:right;" expr="expr:getSum('AMT09')"/>
                <Cell col="21" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT09')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT09')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="22" displaytype="number" style="align:right;" expr="expr:getSum('AMT10')"/>
                <Cell col="23" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT10')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT10')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="24" displaytype="number" style="align:right;" expr="expr:getSum('AMT11')"/>
                <Cell col="25" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT11')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT11')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="26" displaytype="number" style="align:right;" expr="expr:getSum('AMT12')"/>
                <Cell col="27" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT12')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT12')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="28" displaytype="number" style="align:right;" expr="expr:getSum('AMT13')"/>
                <Cell col="29" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT13')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT13')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="30" displaytype="number" style="align:right;" expr="expr:getSum('AMT14')"/>
                <Cell col="31" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT14')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT14')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="32" displaytype="number" style="align:right;" expr="expr:getSum('AMT15')"/>
                <Cell col="33" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT15')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT15')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="34" displaytype="number" style="align:right;" expr="expr:getSum('AMT16')"/>
                <Cell col="35" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT16')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT16')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="36" displaytype="number" style="align:right;" expr="expr:getSum('AMT17')"/>
                <Cell col="37" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT17')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT17')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="38" displaytype="number" style="align:right;" expr="expr:getSum('AMT18')"/>
                <Cell col="39" displaytype="number" style="align:right;" expr="expr:isNaN(Math.round(getSum('AMT18')/getSum('AMT_TOT')*100,1))?0.0:Math.round(getSum('AMT18')/getSum('AMT_TOT')*100,1)" mask="###,##0.0"/>
                <Cell col="40" displaytype="number" style="align:right;" expr="expr:getSum('AMT_TOT')"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Div id="div_cmnBtn" anchor="left top right" taborder="14" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 1197 40"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 1205 71"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 1226 84"/>
        <Static id="Static03" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 360 40 370 61" anchor="left top"/>
        <Static id="Static11" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 536 40 566 61" anchor="left top"/>
        <Static id="Static19" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 774 40 800 61" anchor="left top"/>
        <Static id="Static13" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 610 40 620 61" anchor="left top"/>
        <Static id="Static20" text="연월" class="sta_WFSA_label" position="absolute 800 40 838 61" anchor="left top"/>
        <Static id="Static21" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 848 40 858 61" anchor="left top"/>
        <Static id="Static14" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 943 40 973 61" anchor="left top"/>
        <MaskEdit id="me_DATE" mask="####-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkeydown="ed_pop_OnKeyDown" onkillfocus="g_Date_OnKillFocus" taborder="3" type="string" userdata="btn_DATE" position="absolute 842 40 907 61" class="msk_WF_Essential" style="align:center middle;"/>
        <Button id="btn_DATE" onclick="g_CalButton_OnClick" taborder="4" userdata="me_DATE" position="absolute 906 40 927 61" class="btn_WF_cal" text="" image=""/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Static id="Static27" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static25" text="사업부" class="sta_WFSA_label" position="absolute 15 41 85 62"/>
        <MuSearchComponent id="cbo_mu" titletext="사업부 선택 Component" taborder="0" text="MuSearchComponent00" class="cmb_WF_Essential" position="absolute 70 40 240 61" bindDataset="ds_input" bindMuCdColumn="MU_CD" appendText="" onItemChangedEvent="fn_muChange"/>
        <Static id="Static00" text="팀" class="sta_WFSA_label" position="absolute 270 40 290 61"/>
        <TmSearchComponent id="edt_tm" titletext="팀 검색용 Component" taborder="1" text="TmSearchComponent00" position="absolute 298 40 451 61" bindDataset="ds_input" bindTmCdColumn="TM_CD" bindTmNmColumn="TM_NM" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tmChange" eventBeforeTrigger=""/>
        <Static id="st_UPJANG" text="사업장" class="sta_WFSA_label" position="absolute 481 40 554 61" anchor="left top" userdata=""/>
        <UpjangSearchComponent id="edt_upjang" titletext="업장 검색용 Component" taborder="2" text="UpjangSearchComponent00" position="absolute 537 40 774 61" tooltiptext="입고업장" bindDataset="ds_input" bindUpjangCodeColumn="UPJANG" bindUpjangNameColumn="UPJANG_NM" eventBeforeTrigger="" eventAfterTrigger="" roleSetId="ScoAuthLevel01"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_input" oncolumnchanged="ds_input_OnColumnChanged">
        <ColumnInfo>
          <Column id="MU_CD" type="STRING" size="256"/>
          <Column id="TM_CD" size="256" type="STRING"/>
          <Column id="TM_NM" size="256" type="STRING"/>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="UPJANG_NM" size="256" type="STRING"/>
          <Column id="DATE" size="256" type="STRING"/>
          <Column id="MST_TM_CD" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="DATE"/>
            <Col id="MST_TM_CD"/>
            <Col id="TM_CD"/>
            <Col id="TM_NM"/>
            <Col id="UPJANG"/>
            <Col id="UPJANG_NM"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list">
        <ColumnInfo>
          <Column id="AMT01" size="22" type="BIGDECIMAL"/>
          <Column id="CLASS_CODE" size="8" type="STRING"/>
          <Column id="CLASS_NAME" size="50" type="STRING"/>
          <Column id="TM_CD" size="3" type="STRING"/>
          <Column id="TM_NM" size="50" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Detail">
        <ColumnInfo>
          <Column id="CUT_SPEC" size="20" type="STRING"/>
          <Column id="DISH_INFO" size="20" type="STRING"/>
          <Column id="DISUSE_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="EDIBLE_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="ITEM_CODE" size="12" type="STRING"/>
          <Column id="ITEM_COST" size="22" type="BIGDECIMAL"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="ITEM_SPEC" size="0" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="NEED_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="RECIPE_CD" size="20" type="STRING"/>
          <Column id="RECIPE_NAME" size="50" type="STRING"/>
          <Column id="RESTRICT_YN" size="1" type="STRING"/>
          <Column id="SINGLE_MENU_CD" size="20" type="STRING"/>
          <Column id="UNIT_COST" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_SEQ" size="256" type="STRING"/>
          <Column id="column0" size="256" type="INT"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="me_DATE_value" compid="me_DATE" propid="value" datasetid="ds_input" columnid="DATE"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
 ***********************************************************************************************
 * 시스템구분   : 구매관리 / 현황분석 / 자재사용패턴조회(관리자용) 
 * 프로그램명   : FSP00090V
 * 기      능   : 자재사용패턴조회(관리자용)
 * 작  성  자   : 정영철
 * 작성  일자   : 2015-06-17
 * --------------------------------------------------------------------------------------------
 * HISTORY    :
 ***********************************************************************************************
 */
 
/***********************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/ 
include "U_lib::lib_conversionCom.xjs";

/***********************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/ 

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 로드시 이벤트
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(this);
	
	// X-Framework : Action 정보 생성 
	fsp_init(this);
	
	fn_init();
}

// 초기화
function fn_init()
{
	// 초기값 셋팅
	var strDt = fn_CurrDateWeek();
	ds_input.setColumn(0,"DATE",gfn_left(strDt,6));
	
	// 사업부 팀 업장 셋팅
	edt_tm.applyAuthLevel(cbo_mu);
	edt_upjang.applyAuthLevel(edt_tm);
	
	cbo_mu.setFocus();
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_search()
{	
	var sSvcID;			// 서비스 ID
	var sUrl;			// jsp 경로
	var sInDs;			// 입력 데이터셋
	var sOutDs;			// 출력 데이터셋
	var sArg;			// 추가 파라미터
	var sCallFunc;		// 콜백함수명

	sSvcID		= "MAIN_SEARCH";
	sUrl		= "U_svc::" + "fs/fsp/FSP00275V_T001.jsp";
	sInDs		= "ds_input=ds_input";
	sOutDs		= "ds_list=ds_list";
	sCallFunc	= "fn_search_callback";
	
	// 유효성 체크
	if(!fn_search_validation(sSvcID)){return false;}
	
	// 데이터셋초기화
	ds_list.clearData();
	ds_Detail.clearData();
	
	jsp_transaction(this, sSvcID, sUrl, sInDs, sOutDs, sArg, sCallFunc, true, false, false);
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_SearchSub(nRow)
 * 입      력   : nRow = Master Row
 * 반      환   : 없음
 * 기      능   : 상세내역 조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-12  
 ******************************************************************************************
 */
function fn_SearchSub(nRow)
{
	var sSvcID;			// 서비스 ID
	var sUrl;			// jsp 경로
	var sInDs;			// 입력 데이터셋
	var sOutDs;			// 출력 데이터셋
	var sArg;			// 추가 파라미터
	var sCallFunc;		// 콜백함수명

	sSvcID		= "DETAIL_SEARCH";
	sUrl		= "U_svc::" + "fs/fsp/FSP00275V_T002.jsp";
	sInDs		= "ds_input=ds_input";
	sOutDs		= "ds_Detail=ds_list";
	sCallFunc	= "fn_search_callback";
	
	// 유효성 체크
	if(!fn_search_validation(sSvcID)){return false;}
	
	// 데이터셋초기화
	ds_Detail.clearData();
	
	ds_input.setColumn(0,"MST_TM_CD",ds_list.getColumn(nRow,"TM_CD"));
	
	jsp_transaction(this, sSvcID, sUrl, sInDs, sOutDs, sArg, sCallFunc, true, false, false);
}

/*------------------------------------------------------------
	1. Function    : fn_search_callback(obj)
	2. Description : 조회 이벤트 콜백
	3. Arguments   : strSvcID, nErrorCode, strErrorMag
	4. History     : 2008. 02. 04 - 최초작성
	                 2015. 06. 03 - 고도화
*------------------------------------------------------------*/
function fn_search_callback(nErrorCode, sErrorMag, sSvcID)
{
	var msg = "";
	switch(sSvcID){
		
		case "DETAIL_SEARCH" :	// 구매유형
			break;
			
		case "MAIN_SEARCH" :	// 메인조회
			break;
	}
}

/*------------------------------------------------------------
	1. Function    : fn_search_validation(obj)
	2. Description : 조회유효성체크
	3. Arguments   : strSvcID
	4. History     : 2008. 02. 04 - 최초작성
	                 2015. 06. 03 - 고도화
*------------------------------------------------------------*/
function fn_search_validation(strSvcID)
{
	switch(strSvcID)
	{
		case "DETAIL_SEARCH" :	// 구매유형 유효성 체크
			break;
			
		case "MAIN_SEARCH" : // 상세조회 유효성 체크
			
			if(!mfn_Chk_Obj_IsNotNull(cbo_mu.cbo_mu)){
				cbo_mu.cbo_mu.class = "cmb_WF_Error";
				g_Message("EE", "사업부은(는) 필수 입력사항 입니다.");
				cbo_mu.setFocus();
				return false;  	 	// 업장	
			}
			cbo_mu.cbo_mu.class = "cmb_WF_Essential";
			
			if (gfn_length(ds_input.getColumn(0,"DATE"))==0){
				me_DATE.class = "msk_WF_Error";
				g_Message("EE", "검색년월을 입력해 주십시오.");
				me_DATE.setFocus();
				return;
			}
			me_DATE.class = "msk_WF_Essential";
			
			break;
	}

    return true;
}


/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/ 
/*
 ******************************************************************************************
 * 함  수  명   : fn_Insert()
 * 기      능   : [입력버튼] 입력 시 처리되는 작업
 * 비      고	: 팝업사용
 ******************************************************************************************
 */
function fn_insert()
{
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Save()
 * 기      능   : [저장버튼] 저장 시 처리되는 작업
 ******************************************************************************************
 */
function fn_save()
{
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function fn_Close()
{
	this.close();
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Excel()
 * 기      능   : [엑셀버튼] 엑셀 변환 시 처리되는 작업
 ******************************************************************************************
 */
function fn_Excel()
{
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
 /******************************************************************************************
 * 함  수  명   : grd_List_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
 * 기      능   : 그리드헤드 더블클릭시 Sort
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-02-12  
 ******************************************************************************************
 */
function grd_List_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
}

function frm_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
	if ( (e.keycode == 13) && (e.fromreferenceobject == me_DATE) ) fn_search();
}	

/*
 ******************************************************************************************
 * 함  수  명   : grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
 * 기      능   : 상세내역조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-03  
 ******************************************************************************************
 */
function grd_list_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
	fn_SearchSub(e.row);
}

function fn_muChange(obj, event)
{
	edt_tm.setTmCode("");
	edt_upjang.setUpjangCode("");
}

function fn_tmChange(obj, data)
{
	edt_upjang.setUpjangCode("");
}

function FSP00275V_onsize(obj:Form, e:SizeEventInfo)
{
	sp_line.max = this.getOwnerFrame().position.bottom - 30;
}
]]></Script>
  </Form>
</FDL>

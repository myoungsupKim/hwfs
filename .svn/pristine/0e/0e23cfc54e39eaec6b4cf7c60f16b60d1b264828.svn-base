<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="UpjangMealTicketRegMgnt" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="선수금관리(UpjangMealTicketRegMgnt2)" scrollbars="autoboth" onload="form_onload" style="margin:0 0 0 0;">
    <Layouts>
      <Layout>
        <Grid id="Grid00" taborder="23" useinputpanel="false" position="absolute 7 268 1234 395" binddataset="ds_list" anchor="left right" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="receiptNum"/>
                <Cell col="1" disptype="normal" text="tmpSeq"/>
                <Cell col="2" disptype="normal" text="custCd"/>
                <Cell col="3" disptype="normal" text="custNm"/>
                <Cell col="4" disptype="normal" text="dealType"/>
                <Cell col="5" disptype="normal" text="advanceClass"/>
                <Cell col="6" disptype="normal" text="advanceClassNm"/>
                <Cell col="7" disptype="normal" text="posGuestinfo"/>
                <Cell col="8" disptype="normal" text="posGuestinfoNm"/>
                <Cell col="9" disptype="normal" text="posOutvatFlag"/>
                <Cell col="10" disptype="normal" text="settleClass"/>
                <Cell col="11" disptype="normal" text="settleClassNm"/>
                <Cell col="12" disptype="normal" text="buycpnyCd"/>
                <Cell col="13" disptype="normal" text="buycpnyNm"/>
                <Cell col="14" disptype="normal" text="frncStorNum"/>
                <Cell col="15" disptype="normal" text="cardComCd"/>
                <Cell col="16" disptype="normal" text="cardComNm"/>
                <Cell col="17" disptype="normal" text="occurAdvanceNum"/>
                <Cell col="18" disptype="normal" text="qty"/>
                <Cell col="19" disptype="normal" text="uprice"/>
                <Cell col="20" disptype="normal" text="amt"/>
                <Cell col="21" disptype="normal" text="remark"/>
                <Cell col="22" disptype="normal" text="itemCd"/>
                <Cell col="23" disptype="normal" text="itemNm"/>
                <Cell col="24" disptype="normal" text="ccCd"/>
                <Cell col="25" disptype="normal" text="seq"/>
                <Cell col="26" disptype="normal" text="avt"/>
                <Cell col="27" disptype="normal" text="etc"/>
                <Cell col="28" disptype="normal" text="muCd"/>
                <Cell col="29" disptype="normal" text="tmCd"/>
                <Cell col="30" disptype="normal" text="upjangCd"/>
                <Cell col="31" disptype="normal" text="occurDate"/>
                <Cell col="32" disptype="normal" text="sysClass"/>
                <Cell col="33" disptype="normal" text="ticketSeq"/>
                <Cell col="34" disptype="normal" text="settleRefInfo"/>
                <Cell col="35" disptype="normal" text="supplyAmt"/>
                <Cell col="36" disptype="normal" text="vatAmt"/>
                <Cell col="37" disptype="normal" text="vatCd"/>
                <Cell col="38" disptype="normal" text="taxShetPublishYn"/>
                <Cell col="39" disptype="normal" text="saleOccurYn"/>
                <Cell col="40" disptype="normal" text="ticketStartnum"/>
                <Cell col="41" disptype="normal" text="ticketEndnum"/>
                <Cell col="42" disptype="normal" text="varSusAmt"/>
                <Cell col="43" disptype="normal" text="modifySalsYn"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:receiptNum"/>
                <Cell col="1" disptype="normal" text="bind:tmpSeq"/>
                <Cell col="2" disptype="normal" text="bind:custCd"/>
                <Cell col="3" disptype="normal" text="bind:custNm"/>
                <Cell col="4" disptype="normal" text="bind:dealType"/>
                <Cell col="5" disptype="normal" text="bind:advanceClass"/>
                <Cell col="6" disptype="normal" text="bind:advanceClassNm"/>
                <Cell col="7" disptype="normal" text="bind:posGuestinfo"/>
                <Cell col="8" disptype="normal" text="bind:posGuestinfoNm"/>
                <Cell col="9" disptype="normal" text="bind:posOutvatFlag"/>
                <Cell col="10" disptype="normal" text="bind:settleClass"/>
                <Cell col="11" disptype="normal" text="bind:settleClassNm"/>
                <Cell col="12" disptype="normal" text="bind:buycpnyCd"/>
                <Cell col="13" disptype="normal" text="bind:buycpnyNm"/>
                <Cell col="14" disptype="normal" text="bind:frncStorNum"/>
                <Cell col="15" disptype="normal" text="bind:cardComCd"/>
                <Cell col="16" disptype="normal" text="bind:cardComNm"/>
                <Cell col="17" disptype="normal" text="bind:occurAdvanceNum"/>
                <Cell col="18" disptype="normal" text="bind:qty"/>
                <Cell col="19" disptype="normal" text="bind:uprice"/>
                <Cell col="20" disptype="normal" text="bind:amt"/>
                <Cell col="21" disptype="normal" text="bind:remark"/>
                <Cell col="22" disptype="normal" text="bind:itemCd"/>
                <Cell col="23" disptype="normal" text="bind:itemNm"/>
                <Cell col="24" disptype="normal" text="bind:ccCd"/>
                <Cell col="25" disptype="normal" text="bind:seq"/>
                <Cell col="26" disptype="normal" text="bind:avt"/>
                <Cell col="27" disptype="normal" text="bind:etc"/>
                <Cell col="28" disptype="normal" text="bind:muCd"/>
                <Cell col="29" disptype="normal" text="bind:tmCd"/>
                <Cell col="30" disptype="normal" text="bind:upjangCd"/>
                <Cell col="31" disptype="normal" text="bind:occurDate"/>
                <Cell col="32" disptype="normal" text="bind:sysClass"/>
                <Cell col="33" disptype="normal" text="bind:ticketSeq"/>
                <Cell col="34" disptype="normal" text="bind:settleRefInfo"/>
                <Cell col="35" disptype="normal" text="bind:supplyAmt"/>
                <Cell col="36" disptype="normal" text="bind:vatAmt"/>
                <Cell col="37" disptype="normal" text="bind:vatCd"/>
                <Cell col="38" disptype="normal" text="bind:taxShetPublishYn"/>
                <Cell col="39" disptype="normal" text="bind:saleOccurYn"/>
                <Cell col="40" disptype="normal" text="bind:ticketStartnum"/>
                <Cell col="41" disptype="normal" text="bind:ticketEndnum"/>
                <Cell col="42" disptype="normal" text="bind:varSusAmt"/>
                <Cell col="43" disptype="normal" text="bind:modifySalsYn"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="19" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30" tabstop="false"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 93 40" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 93 71" anchor="left top"/>
        <Static id="Static43" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 408 130 421" anchor="left top"/>
        <Static id="Static42" text="선수금 등록" class="sta_WF_Title01" position="absolute 0 421 455 439" anchor="left top"/>
        <Static id="Static44" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 434 130 439" anchor="left top"/>
        <Static id="Static19" class="sta_WFDA_Labelbg" position="absolute 0 439 1236 466" anchor="left top right"/>
        <Static id="Static20" class="sta_WFDA_Labelbg" position="absolute 0 465 1236 492" anchor="left top right"/>
        <Static id="Static21" class="sta_WFDA_Labelbg" position="absolute 0 491 1236 518" anchor="left top right"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 97 450 102" anchor="left top"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 450 84" anchor="left top"/>
        <Static id="sta_detail03" text="구       분" class="sta_WFDA_Label01" position="absolute 362 439 449 466" style="border:1 solid #c3c3c3ff ;color:#444444ff;padding:0 0 0 0;bordertype:normal 0 0 ;align:center middle;"/>
        <Static id="sta_detail00" text="고   객   사" class="sta_WFDA_Label01" position="absolute 0 439 87 466" style="border:1 solid #c3c3c3ff ;color:#444444ff;padding:0 0 0 0;bordertype:normal 0 0 ;align:center middle;"/>
        <Static id="sta_detail01" text="입금 코드" class="sta_WFDA_Label01" position="absolute 905 465 992 492" style="border:1 solid #c3c3c3ff ;color:#444444ff;padding:0 0 0 0;bordertype:normal 0 0 ;align:center middle;"/>
        <Edit id="edtReceiptNum" taborder="17" position="absolute 994 468 1233 489" anchor="left top" style="background:#e4e4e4ff;" enable="false"/>
        <Static id="sta_detail05" text="식       수" class="sta_WFDA_Label01" position="absolute 181 465 268 492" style="border:1 solid #c3c3c3ff ;color:#444444ff;padding:0 0 0 0;bordertype:normal 0 0 ;align:center middle;"/>
        <Static id="sta_detail09" text="적         요" class="sta_WFDA_Label01" position="absolute 0 491 87 518" style="border:1 solid #c3c3c3ff ;color:#444444ff;padding:0 0 0 0;bordertype:normal 0 0 ;align:center middle;"/>
        <Static id="sta_detail12" text="식권 차수" class="sta_WFDA_Label01" position="absolute 905 491 992 518" style="border:1 solid #c3c3c3ff ;color:#444444ff;padding:0 0 0 0;bordertype:normal 0 0 ;align:center middle;"/>
        <Edit id="edtTicketSeq" taborder="18" position="absolute 994 493 1233 514" anchor="left top" style="background:#e4e4e4ff;" readonly="false" enable="false"/>
        <Static id="sta_detail02" text="결제 유형" class="sta_WFDA_Label01" position="absolute 543 465 630 492" style="border:1 solid #c3c3c3ff ;color:#444444ff;padding:0 0 0 0;bordertype:normal 0 0 ;align:center middle;" usebitmapcache="true"/>
        <Combo id="cboSettleClass" taborder="11" innerdataset="@ds_signClass" codecolumn="set1" datacolumn="codeName" index="-1" class="cmb_WF_Essential" position="absolute 632 468 722 489" enable="true" oncloseup="cboSettleClass_oncloseup" onitemchanged="cboSettleClass_onitemchanged" onkillfocus="cboSettleClass_onkillfocus"/>
        <Static id="sta_detail10" text="카  드  사" class="sta_WFDA_Label01" position="absolute 724 465 811 492" style="border:1 solid #c3c3c3ff ;color:#444444ff;padding:0 0 0 0;bordertype:normal 0 0 ;align:center middle;"/>
        <Edit id="txt_etc" taborder="13" position="absolute 89 493 360 515" onkeydown="txt_etc_onkeydown" class="edt_WF_Essential" imemode="hangul"/>
        <Static id="Static00" text="사업부" class="sta_WFSA_label" position="absolute 15 40 77 61" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static01" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 60 40 70 61" anchor="left top"/>
        <MuSearchComponent id="edt_muNm" titletext="사업부 선택 Component" taborder="0" class="cmb_WF_Essential" position="absolute 71 40 230 61" bindDataset="ds_search" bindMuCdColumn="muCd" appendText="" onItemChangedEvent="fn_muItemChangedEvent"/>
        <Static id="Static02" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 230 40 260 61" anchor="left top"/>
        <Static id="Static03" text="팀" class="sta_WFSA_label" position="absolute 260 40 322 61" anchor="left top"/>
        <Static id="Static09" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 279 40 289 61" anchor="left top"/>
        <TmSearchComponent id="edt_tmNm" titletext="팀 검색용 Component" taborder="1" text="TmSearchComponent00" class="edt_WF_Essential" position="absolute 287 40 432 61" bindDataset="ds_search" bindTmCdColumn="schTm" bindTmNmColumn="schTmNm" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="" eventBeforeTrigger="fn_tmChangedEvent"/>
        <Static id="Static27" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 432 40 462 61" anchor="left top"/>
        <Static id="Static10" text="사업장" class="sta_WFSA_label" position="absolute 463 40 525 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 510 40 520 61" anchor="left top"/>
        <UpjangSearchComponent id="edt_upjangNm" titletext="업장 검색용 Component" taborder="2" text="UpjangSearchComponent00" class="edt_WF_Essential" position="absolute 517 40 744 62" bindDataset="ds_search" bindUpjangCodeColumn="upjangCd" bindUpjangNameColumn="upjangNm" eventBeforeTrigger="" eventAfterTrigger="fn_upjangAfter" roleSetId=""/>
        <Static id="Static14" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 744 40 774 61" anchor="left top"/>
        <Static id="Static17" text="등록일자" class="sta_WFSA_label" position="absolute 774 40 836 61" anchor="left top"/>
        <Static id="Static18" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 832 40 842 61" anchor="left top"/>
        <ObjCalendar id="cal_occurDate" titletext="캘린더" taborder="3" onclick="cal_procDateFr_onclick" class="cal_WF_Essential" position="absolute 842 40 935 61" onkeydown="cal_occurDate_onkeydown"/>
        <CustSearchComponent id="edt_custnm" titletext="거래처 검색용 Component" taborder="4" text="CustSearchComponent00" position="absolute 89 442 360 463" bindDataset="ds_list" eventBeforeTrigger="fn_custPopup" eventAfterTrigger="fn_custPopupAfter" bindCustCodeColumn="custCd" bindCustNameColumn="custNm" class="edt_WF_Essential" onkeydown="edt_custnm_onkeydown"/>
        <MaskEdit id="msk_Qty" taborder="9" position="absolute 270 468 360 489" class="edt_WF_Essential" style="caretcolor:#ce520dff;background:#fff6e9ff URL('theme://images/new/img_WF_EssentialBg.png') left top;" limitbymask="none" mask="###,###,###,###,###" autoselect="true"/>
        <Static id="sta_detail06" text="단         가" class="sta_WFDA_Label01" position="absolute 0 465 87 492" style="border:1 solid #c3c3c3ff ;color:#444444ff;padding:0 0 0 0;bordertype:normal 0 0 ;align:center middle;"/>
        <MaskEdit id="msk_Amt" taborder="10" mask="###,###,###,###,###" limitbymask="none" class="edt_WF_Essential" position="absolute 451 468 541 489" style="caretcolor:#ce520dff;background:#fff6e9ff URL('theme://images/new/img_WF_EssentialBg.png') left top;" autoselect="true" enable="false"/>
        <Static id="sta_detail04" text="금       액" class="sta_WFDA_Label01" position="absolute 362 465 449 492" style="border:1 solid #c3c3c3ff ;color:#444444ff;padding:0 0 0 0;bordertype:normal 0 0 ;align:center middle;"/>
        <MaskEdit id="msk_Uprice" taborder="8" mask="###,###,###,###,###" limitbymask="none" class="edt_WF_Essential" position="absolute 89 468 179 489" style="caretcolor:#ce520dff;background:#fff6e9ff URL('theme://images/new/img_WF_EssentialBg.png') left top;" autoselect="true"/>
        <Static id="sta_detail15" text="창       고" class="sta_WFDA_Label01" position="absolute 543 439 630 466" style="border:1 solid #c3c3c3ff ;color:#444444ff;padding:0 0 0 0;bordertype:normal 0 0 ;align:center middle;"/>
        <Edit id="edtPost" taborder="6" position="absolute 632 442 883 463" anchor="left top" class="edt_WF_Essential" enable="true" onkeydown="edtPost_onkeydown"/>
        <Button id="btn_postPopup" taborder="7" class="btn_WF_popSearch" position="absolute 882 442 903 463" anchor="left top" onclick="btn_postPopup_onclick" enable="false"/>
        <Combo id="cboGubun" taborder="5" innerdataset="@ds_advanceClass" codecolumn="code" datacolumn="codeName" index="-1" class="cmb_WF_Essential" position="absolute 451 442 541 463" onitemchanged="cboGubun_onitemchanged" onkillfocus="cboGubun_onkillfocus"/>
        <Edit id="edt_bankInfo" taborder="16" visible="true" position="absolute 994 442 1233 463" anchor="left top" enable="false"/>
        <Static id="sta_detail08" class="sta_WFDA_Label01" visible="true" position="absolute 905 439 992 466" style="border:1 solid #c3c3c3ff ;color:#444444ff;padding:0 0 0 0;bordertype:normal 0 0 ;align:center middle;" text="가수금번호"/>
        <Combo id="cboEncClass" taborder="12" innerdataset="@ds_cardlist" codecolumn="buycpnyCd" datacolumn="buycpnyNm" class="cmb_WF_Essential" position="absolute 813 468 903 489" oncloseup="cboEncClass_oncloseup" onkillfocus="cboEncClass_onkillfocus"/>
        <Static id="sta_detail16" text="자재 코드" class="sta_WFDA_Label01" position="absolute 362 491 449 518" style="border:1 solid #c3c3c3ff ;color:#444444ff;padding:0 0 0 0;bordertype:normal 0 0 ;align:center middle;"/>
        <Edit id="edt_ticket" taborder="14" class="edt_WF_Essential" position="absolute 451 494 883 515" anchor="left top" enable="true" onkeydown="edt_ticket_onkeydown" readonly="true"/>
        <Button id="btn_edt_ticket" taborder="15" class="btn_WF_popSearch" enable="false" position="absolute 882 494 903 515" anchor="left top" onclick="btn_edt_ticket_onclick"/>
        <Static id="Static12" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 518 130 531" anchor="left top"/>
        <Div id="div_Ticket" taborder="21" text="Div00" position="absolute 0 533 1239 709" anchor="all" style="background:transparent;">
          <Layouts>
            <Layout width="1237" height="176">
              <Static id="st_subTitle" text="식권수불내역" class="sta_WF_Title01" position="absolute 0 0 405 18" anchor="left top"/>
              <Static id="Static23" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 1 13 131 18" anchor="left top"/>
              <Grid id="grd_TicketList" taborder="1" binddataset="ds_list_ticketD" autoenter="select" useinputpanel="false" cellsizingtype="col" autofittype="col" position="absolute 0 18 1236 176" anchor="all" cellmovingtype="none">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="70"/>
                      <Column size="60"/>
                      <Column size="80"/>
                      <Column size="115"/>
                      <Column size="209"/>
                      <Column size="66"/>
                      <Column size="60"/>
                      <Column size="60"/>
                      <Column size="60"/>
                      <Column size="100"/>
                      <Column size="60"/>
                      <Column size="90"/>
                      <Column size="62"/>
                    </Columns>
                    <Rows>
                      <Row size="26" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="일자"/>
                      <Cell col="1" text="수불구분"/>
                      <Cell col="2" text="입금유형"/>
                      <Cell col="3" text="고객사"/>
                      <Cell col="4" text="자재명"/>
                      <Cell col="5" text="수불금액"/>
                      <Cell col="6" text="시작번호"/>
                      <Cell col="7" text="종료번호"/>
                      <Cell col="8" text="입고"/>
                      <Cell col="9" text="판매+불용+로스"/>
                      <Cell col="10" text="교환"/>
                      <Cell col="11" text="최대수불번호"/>
                      <Cell col="12" text="잔존수량"/>
                    </Band>
                    <Band id="body">
                      <Cell displaytype="date" style="align:center;background:EXPR(fn_color(receiptNum));background2:EXPR(fn_color(receiptNum));" text="bind:transDd"/>
                      <Cell col="1" style="align:center;background:EXPR(fn_color(receiptNum));background2:EXPR(fn_color(receiptNum));" text="bind:itemTypeNm"/>
                      <Cell col="2" style="align:center;background:EXPR(fn_color(receiptNum));background2:EXPR(fn_color(receiptNum));" text="bind:transTypeNm"/>
                      <Cell col="3" style="align:left;background:EXPR(fn_color(receiptNum));background2:EXPR(fn_color(receiptNum));" text="bind:custNm"/>
                      <Cell col="4" style="align:left;background:EXPR(fn_color(receiptNum));background2:EXPR(fn_color(receiptNum));" text="bind:itemCodenm"/>
                      <Cell col="5" style="align:center;background:EXPR(fn_color(receiptNum));background2:EXPR(fn_color(receiptNum));" text="bind:uprice"/>
                      <Cell col="6" displaytype="number" style="background:EXPR(fn_color(receiptNum));background2:EXPR(fn_color(receiptNum));" text="bind:ticketStartnum"/>
                      <Cell col="7" displaytype="number" style="background:EXPR(fn_color(receiptNum));background2:EXPR(fn_color(receiptNum));" text="bind:ticketEndnum"/>
                      <Cell col="8" displaytype="number" style="background:EXPR(fn_color(receiptNum));background2:EXPR(fn_color(receiptNum));" text="bind:inQty"/>
                      <Cell col="9" displaytype="number" style="background:EXPR(fn_color(receiptNum));background2:EXPR(fn_color(receiptNum));" text="bind:outQty"/>
                      <Cell col="10" displaytype="number" style="background:EXPR(fn_color(receiptNum));background2:EXPR(fn_color(receiptNum));" text="bind:xcQty"/>
                      <Cell col="11" displaytype="number" style="background:EXPR(fn_color(receiptNum));background2:EXPR(fn_color(receiptNum));" text="bind:maxNum" suppress="1"/>
                      <Cell col="12" displaytype="number" style="background:EXPR(fn_color(receiptNum));background2:EXPR(fn_color(receiptNum));" text="bind:janQty" suppress="1"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Button id="btn_fullScreen" taborder="2" text="전체화면" class="btn_WF_Function" position="absolute 1168 0 1233 17" anchor="top right" onclick="div_Ticket_btn_fullScreen_onclick"/>
              <Grid id="Grid00" taborder="3" useinputpanel="false" position="absolute 742 59 1225 167" binddataset="ds_search" visible="false" anchor="default">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                    </Columns>
                    <Rows>
                      <Row band="head" size="24"/>
                      <Row band="body" size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell col="0" disptype="normal" text="muCd"/>
                      <Cell col="1" disptype="normal" text="custCd"/>
                      <Cell col="2" disptype="normal" text="custNm"/>
                      <Cell col="3" disptype="normal" text="occurDate"/>
                      <Cell col="4" disptype="normal" text="schTm"/>
                      <Cell col="5" disptype="normal" text="schTmNm"/>
                      <Cell col="6" disptype="normal" text="schMu"/>
                      <Cell col="7" disptype="normal" text="upjangCd"/>
                      <Cell col="8" disptype="normal" text="upjangNm"/>
                      <Cell col="9" disptype="normal" text="sysClass"/>
                      <Cell col="10" disptype="normal" text="batchId"/>
                      <Cell col="11" disptype="normal" text="occurCopyDate"/>
                      <Cell col="12" disptype="normal" text="muNm"/>
                      <Cell col="13" disptype="normal" text="saleClass"/>
                      <Cell col="14" disptype="normal" text="receiptNum"/>
                      <Cell col="15" disptype="normal" text="ticketSeq"/>
                      <Cell col="16" disptype="normal" text="ccCd"/>
                      <Cell col="17" disptype="normal" text="itemCd"/>
                      <Cell col="18" disptype="normal" text="itemType"/>
                      <Cell col="19" disptype="normal" text="taxShetPublishYn"/>
                      <Cell col="20" disptype="normal" text="occurAdvanceNum"/>
                      <Cell col="21" disptype="normal" text="ticketEndnum"/>
                    </Band>
                    <Band id="body">
                      <Cell col="0" disptype="normal" text="bind:muCd"/>
                      <Cell col="1" disptype="normal" text="bind:custCd"/>
                      <Cell col="2" disptype="normal" text="bind:custNm"/>
                      <Cell col="3" disptype="normal" text="bind:occurDate"/>
                      <Cell col="4" disptype="normal" text="bind:schTm"/>
                      <Cell col="5" disptype="normal" text="bind:schTmNm"/>
                      <Cell col="6" disptype="normal" text="bind:schMu"/>
                      <Cell col="7" disptype="normal" text="bind:upjangCd"/>
                      <Cell col="8" disptype="normal" text="bind:upjangNm"/>
                      <Cell col="9" disptype="normal" text="bind:sysClass"/>
                      <Cell col="10" disptype="normal" text="bind:batchId"/>
                      <Cell col="11" disptype="normal" text="bind:occurCopyDate"/>
                      <Cell col="12" disptype="normal" text="bind:muNm"/>
                      <Cell col="13" disptype="normal" text="bind:saleClass"/>
                      <Cell col="14" disptype="normal" text="bind:receiptNum"/>
                      <Cell col="15" disptype="normal" text="bind:ticketSeq"/>
                      <Cell col="16" disptype="normal" text="bind:ccCd"/>
                      <Cell col="17" disptype="normal" text="bind:itemCd"/>
                      <Cell col="18" disptype="normal" text="bind:itemType"/>
                      <Cell col="19" disptype="normal" text="bind:taxShetPublishYn"/>
                      <Cell col="20" disptype="normal" text="bind:occurAdvanceNum"/>
                      <Cell col="21" disptype="normal" text="bind:ticketEndnum"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
            </Layout>
          </Layouts>
        </Div>
        <Edit id="edt_tmpSeq" taborder="22" enable="false" position="absolute 1051 526 1161 547" anchor="left top" style="background:#e4e4e4ff;" visible="false"/>
        <Grid id="Grid01" taborder="24" useinputpanel="false" position="absolute 7 585 731 711" binddataset="ds_list_ticket" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="ticketSeq"/>
                <Cell col="1" disptype="normal" text="occurDate"/>
                <Cell col="2" disptype="normal" text="sQty"/>
                <Cell col="3" disptype="normal" text="remarkDesc"/>
                <Cell col="4" disptype="normal" text="upjangCd"/>
                <Cell col="5" disptype="normal" text="uprice"/>
                <Cell col="6" disptype="normal" text="tmpSeq"/>
                <Cell col="7" disptype="normal" text="custCd"/>
                <Cell col="8" disptype="normal" text="muCd"/>
                <Cell col="9" disptype="normal" text="transDd"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:ticketSeq"/>
                <Cell col="1" disptype="normal" text="bind:occurDate"/>
                <Cell col="2" disptype="normal" text="bind:sQty"/>
                <Cell col="3" disptype="normal" text="bind:remarkDesc"/>
                <Cell col="4" disptype="normal" text="bind:upjangCd"/>
                <Cell col="5" disptype="normal" text="bind:uprice"/>
                <Cell col="6" disptype="normal" text="bind:tmpSeq"/>
                <Cell col="7" disptype="normal" text="bind:custCd"/>
                <Cell col="8" disptype="normal" text="bind:muCd"/>
                <Cell col="9" disptype="normal" text="bind:transDd"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_add" taborder="26" text="건별추가" onclick="btn_add_onclick" class="btn_WF_CRUD" enable="true" position="absolute 717 0 782 25" anchor="left top" style="font:Gulim,9,bold;" visible="true"/>
        <Button id="btn_delete" taborder="27" text="건별삭제" onclick="btn_delete_onclick" class="btn_WF_CRUD" position="absolute 786 0 851 25" anchor="left top" style="font:Gulim,9,bold;"/>
        <Div id="Div_list" taborder="32" text="Div00" position="absolute 0 88 1236 418" style="background:transparent;border:0 none transparent ;color:transparent;" anchor="left top right">
          <Layouts>
            <Layout>
              <Button id="btn_close" taborder="1" text="사업장일마감관리" onclick="btn_close_onclick" class="btn_WF_Function" position="absolute 1050 1 1158 21" anchor="top right"/>
              <Static id="Static13" text="선수금 관련 항목은 삭제만 가능합니다." position="absolute 834 1 1047 19" anchor="top right" style="color:red;font:arial,8,bold;"/>
              <Static id="Static22" text="선수금 상세 목록" class="sta_WF_Title01" position="absolute 0 4 450 22" anchor="left top"/>
              <Button id="btn_fullScreen" taborder="2" text="전체화면" class="btn_WF_Function" position="absolute 1165 1 1230 21" anchor="top right" onclick="btn_fullScreen_onclick"/>
              <Grid id="grd_list" taborder="0" binddataset="ds_list" autoenter="select" useinputpanel="false" cellsizingtype="col" autofittype="col" oncellclick="grd_list_oncellclick" position="absolute 0 22 1236 328" anchor="all" style="background:white;">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="135"/>
                      <Column size="68"/>
                      <Column size="59"/>
                      <Column size="122"/>
                      <Column size="48"/>
                      <Column size="67"/>
                      <Column size="68"/>
                      <Column size="190"/>
                      <Column size="136"/>
                      <Column size="113"/>
                      <Column size="63"/>
                      <Column size="65"/>
                      <Column size="70"/>
                      <Column size="70"/>
                      <Column size="70"/>
                      <Column size="70"/>
                      <Column size="70"/>
                    </Columns>
                    <Rows>
                      <Row size="26" band="head"/>
                      <Row size="24"/>
                      <Row size="24" band="summ"/>
                    </Rows>
                    <Band id="head">
                      <Cell class="grd_WF_Essential" text="고객사" taborder="undefined"/>
                      <Cell col="1" class="grd_WF_Essential" text="식권종류" taborder="undefined"/>
                      <Cell col="2" class="grd_WF_Essential" text="결제유형" taborder="undefined"/>
                      <Cell col="3" text="카드사" taborder="undefined"/>
                      <Cell col="4" text="식수" taborder="undefined"/>
                      <Cell col="5" text="단가" taborder="undefined"/>
                      <Cell col="6" class="grd_WF_Essential" text="금액" taborder="undefined"/>
                      <Cell col="7" text="자재명" taborder="undefined"/>
                      <Cell col="8" class="grd_WF_Essential" text="창고" taborder="undefined"/>
                      <Cell col="9" text="적요" taborder="undefined"/>
                      <Cell col="10" text="시작번호" taborder="undefined"/>
                      <Cell col="11" text="종료번호" taborder="undefined"/>
                      <Cell col="12" celltype="none" displaytype="decoratetext" text="매출" taborder="undefined" autosizerow="default"/>
                      <Cell col="13" celltype="none" displaytype="decoratetext" text="채권대체" taborder="undefined" autosizerow="default"/>
                      <Cell col="14" celltype="none" displaytype="decoratetext" text="선발행" taborder="undefined" autosizerow="default"/>
                      <Cell col="15" celltype="none" displaytype="decoratetext" text="발행" taborder="undefined" autosizerow="default"/>
                      <Cell col="16" text="마감" taborder="undefined"/>
                    </Band>
                    <Band id="body">
                      <Cell style="align:left;background:#ffffffff;background2: ;barcolor:transparent;" text="bind:custNm"/>
                      <Cell col="1" displaytype="combo" style="background:#ffffffff;background2: ;" text="bind:advanceClass" combodataset="ds_advanceClass" combocodecol="code" combodatacol="codeName"/>
                      <Cell col="2" displaytype="combo" style="align:center;background:#ffffffff;background2: ;" text="bind:settleClass" combodataset="ds_signClass" combocodecol="set1" combodatacol="codeName"/>
                      <Cell col="3" style="align:center;background:#ffffffff;background2: ;" text="bind:buycpnyNm"/>
                      <Cell col="4" displaytype="number" style="background:#ffffffff;background2: ;" text="bind:qty"/>
                      <Cell col="5" displaytype="number" style="background:#ffffffff;background2: ;" text="bind:uprice"/>
                      <Cell col="6" displaytype="number" style="background:#ffffffff;background2: ;" text="bind:amt"/>
                      <Cell col="7" style="align:left;background:#ffffffff;background2: ;" text="bind:itemNm"/>
                      <Cell col="8" style="align:left;background:EXPR(expr:iif(advanceClass == '003' &amp;&amp; settleClass == '1',&quot;#FAF4C0&quot;));background2:EXPR(expr:iif(advanceClass == '003' &amp;&amp; settleClass == '1',&quot;#FAF4C0&quot;));" text="bind:posGuestinfoNm"/>
                      <Cell col="9" style="align:left;background:#ffffffff;background2: ;" text="bind:remark"/>
                      <Cell col="10" displaytype="number" style="background:#ffffffff;background2: ;" text="bind:ticketStartnum"/>
                      <Cell col="11" displaytype="number" style="background:#ffffffff;background2: ;" text="bind:ticketEndnum"/>
                      <Cell col="12" displaytype="expr:expr:iif(saleRcvy == 'Y', 'button','text')" style="background:#ffffffff;background2: ;" text="bind:saleRcvy"/>
                      <Cell col="13" displaytype="expr:expr:iif(recvDlng == 'Y', 'button','text')" style="background:#ffffffff;background2: ;" text="bind:recvDlng"/>
                      <Cell col="14" displaytype="normal" style="background:#ffffffff;background2: ;" text="bind:taxShetPublishYn"/>
                      <Cell col="15" displaytype="expr:expr:expr:iif(taxYn == 'Y', 'button','text')" style="background:#ffffffff;background2: ;" text="bind:taxYn"/>
                      <Cell col="16" style="background:#ffffffff;background2: ;" text="bind:ddddCloseYn"/>
                    </Band>
                    <Band id="summary">
                      <Cell colspan="4" style="align:center;" text="합계" taborder="undefined"/>
                      <Cell col="4" displaytype="number" style="align:right;" expr="expr:getSum(&quot;qty&quot;)"/>
                      <Cell col="5" displaytype="number" style="align:right;" expr="expr:getSum(&quot;uprice&quot;)"/>
                      <Cell col="6" displaytype="number" style="align:right;" expr="expr:getSum(&quot;amt&quot;)"/>
                      <Cell col="7" colspan="11" taborder="undefined"/>
                      <Cell col="14" taborder="undefined"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Grid id="Grid00" taborder="3" useinputpanel="false" position="absolute 120 143 1134 276" binddataset="ds_list" visible="false">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                      <Col size="80"/>
                    </Columns>
                    <Rows>
                      <Row band="head" size="24"/>
                      <Row band="body" size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell col="0" disptype="normal" text="receiptNum"/>
                      <Cell col="1" disptype="normal" text="tmpSeq"/>
                      <Cell col="2" disptype="normal" text="custCd"/>
                      <Cell col="3" disptype="normal" text="custNm"/>
                      <Cell col="4" disptype="normal" text="dealType"/>
                      <Cell col="5" disptype="normal" text="advanceClass"/>
                      <Cell col="6" disptype="normal" text="advanceClassNm"/>
                      <Cell col="7" disptype="normal" text="posGuestinfo"/>
                      <Cell col="8" disptype="normal" text="posGuestinfoNm"/>
                      <Cell col="9" disptype="normal" text="posOutvatFlag"/>
                      <Cell col="10" disptype="normal" text="settleClass"/>
                      <Cell col="11" disptype="normal" text="settleClassNm"/>
                      <Cell col="12" disptype="normal" text="buycpnyCd"/>
                      <Cell col="13" disptype="normal" text="buycpnyNm"/>
                      <Cell col="14" disptype="normal" text="frncStorNum"/>
                      <Cell col="15" disptype="normal" text="cardComCd"/>
                      <Cell col="16" disptype="normal" text="cardComNm"/>
                      <Cell col="17" disptype="normal" text="occurAdvanceNum"/>
                      <Cell col="18" disptype="normal" text="qty"/>
                      <Cell col="19" disptype="normal" text="uprice"/>
                      <Cell col="20" disptype="normal" text="amt"/>
                      <Cell col="21" disptype="normal" text="remark"/>
                      <Cell col="22" disptype="normal" text="itemCd"/>
                      <Cell col="23" disptype="normal" text="itemNm"/>
                      <Cell col="24" disptype="normal" text="ccCd"/>
                      <Cell col="25" disptype="normal" text="seq"/>
                      <Cell col="26" disptype="normal" text="avt"/>
                      <Cell col="27" disptype="normal" text="etc"/>
                      <Cell col="28" disptype="normal" text="muCd"/>
                      <Cell col="29" disptype="normal" text="tmCd"/>
                      <Cell col="30" disptype="normal" text="upjangCd"/>
                      <Cell col="31" disptype="normal" text="occurDate"/>
                      <Cell col="32" disptype="normal" text="sysClass"/>
                      <Cell col="33" disptype="normal" text="ticketSeq"/>
                      <Cell col="34" disptype="normal" text="settleRefInfo"/>
                      <Cell col="35" disptype="normal" text="supplyAmt"/>
                      <Cell col="36" disptype="normal" text="vatAmt"/>
                      <Cell col="37" disptype="normal" text="vatCd"/>
                      <Cell col="38" disptype="normal" text="taxShetPublishYn"/>
                      <Cell col="39" disptype="normal" text="saleOccurYn"/>
                      <Cell col="40" disptype="normal" text="ticketStartnum"/>
                      <Cell col="41" disptype="normal" text="ticketEndnum"/>
                      <Cell col="42" disptype="normal" text="varSusAmt"/>
                      <Cell col="43" disptype="normal" text="modifySalsYn"/>
                      <Cell col="44" disptype="normal" text="ddddCloseYn"/>
                      <Cell col="45" disptype="normal" text="saleRcvy"/>
                      <Cell col="46" disptype="normal" text="recvDlng"/>
                      <Cell col="47" disptype="normal" text="chgSeq"/>
                      <Cell col="48" disptype="normal" text="taxYn"/>
                      <Cell col="49" disptype="normal" text="altSeq"/>
                    </Band>
                    <Band id="body">
                      <Cell col="0" disptype="normal" text="bind:receiptNum"/>
                      <Cell col="1" disptype="normal" text="bind:tmpSeq"/>
                      <Cell col="2" disptype="normal" text="bind:custCd"/>
                      <Cell col="3" disptype="normal" text="bind:custNm"/>
                      <Cell col="4" disptype="normal" text="bind:dealType"/>
                      <Cell col="5" disptype="normal" text="bind:advanceClass"/>
                      <Cell col="6" disptype="normal" text="bind:advanceClassNm"/>
                      <Cell col="7" disptype="normal" text="bind:posGuestinfo"/>
                      <Cell col="8" disptype="normal" text="bind:posGuestinfoNm"/>
                      <Cell col="9" disptype="normal" text="bind:posOutvatFlag"/>
                      <Cell col="10" disptype="normal" text="bind:settleClass"/>
                      <Cell col="11" disptype="normal" text="bind:settleClassNm"/>
                      <Cell col="12" disptype="normal" text="bind:buycpnyCd"/>
                      <Cell col="13" disptype="normal" text="bind:buycpnyNm"/>
                      <Cell col="14" disptype="normal" text="bind:frncStorNum"/>
                      <Cell col="15" disptype="normal" text="bind:cardComCd"/>
                      <Cell col="16" disptype="normal" text="bind:cardComNm"/>
                      <Cell col="17" disptype="normal" text="bind:occurAdvanceNum"/>
                      <Cell col="18" disptype="normal" text="bind:qty"/>
                      <Cell col="19" disptype="normal" text="bind:uprice"/>
                      <Cell col="20" disptype="normal" text="bind:amt"/>
                      <Cell col="21" disptype="normal" text="bind:remark"/>
                      <Cell col="22" disptype="normal" text="bind:itemCd"/>
                      <Cell col="23" disptype="normal" text="bind:itemNm"/>
                      <Cell col="24" disptype="normal" text="bind:ccCd"/>
                      <Cell col="25" disptype="normal" text="bind:seq"/>
                      <Cell col="26" disptype="normal" text="bind:avt"/>
                      <Cell col="27" disptype="normal" text="bind:etc"/>
                      <Cell col="28" disptype="normal" text="bind:muCd"/>
                      <Cell col="29" disptype="normal" text="bind:tmCd"/>
                      <Cell col="30" disptype="normal" text="bind:upjangCd"/>
                      <Cell col="31" disptype="normal" text="bind:occurDate"/>
                      <Cell col="32" disptype="normal" text="bind:sysClass"/>
                      <Cell col="33" disptype="normal" text="bind:ticketSeq"/>
                      <Cell col="34" disptype="normal" text="bind:settleRefInfo"/>
                      <Cell col="35" disptype="normal" text="bind:supplyAmt"/>
                      <Cell col="36" disptype="normal" text="bind:vatAmt"/>
                      <Cell col="37" disptype="normal" text="bind:vatCd"/>
                      <Cell col="38" disptype="normal" text="bind:taxShetPublishYn"/>
                      <Cell col="39" disptype="normal" text="bind:saleOccurYn"/>
                      <Cell col="40" disptype="normal" text="bind:ticketStartnum"/>
                      <Cell col="41" disptype="normal" text="bind:ticketEndnum"/>
                      <Cell col="42" disptype="normal" text="bind:varSusAmt"/>
                      <Cell col="43" disptype="normal" text="bind:modifySalsYn"/>
                      <Cell col="44" disptype="normal" text="bind:ddddCloseYn"/>
                      <Cell col="45" disptype="normal" text="bind:saleRcvy"/>
                      <Cell col="46" disptype="normal" text="bind:recvDlng"/>
                      <Cell col="47" disptype="normal" text="bind:chgSeq"/>
                      <Cell col="48" disptype="normal" text="bind:taxYn"/>
                      <Cell col="49" disptype="normal" text="bind:altSeq"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
            </Layout>
          </Layouts>
        </Div>
        <CheckBox id="chk_Auto" taborder="33" tabstop="false" text="자동저장" value="true" position="absolute 1000 40 1088 61"/>
        <Button id="btn_prev" taborder="34" onclick="btn_prev_onclick" class="btn_WF_leftMove" position="absolute 939 40 959 60" anchor="top right"/>
        <Button id="btn_next" taborder="35" onclick="btn_next_onclick" class="btn_WF_rightMove" position="absolute 962 40 982 60" anchor="top right"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item8" compid="sta_detail08" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item28" compid="edt_bankInfo" propid="value" datasetid="ds_list" columnid="settleRefInfo"/>
      <BindItem id="item2" compid="sta_detail03" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item0" compid="sta_detail00" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item3" compid="sta_detail01" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item4" compid="sta_detail04" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item5" compid="sta_detail05" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item9" compid="sta_detail09" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item12" compid="sta_detail12" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item1" compid="sta_detail02" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item10" compid="sta_detail10" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item15" compid="sta_detail15" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item16" compid="cal_occurDate" propid="text" datasetid="ds_search" columnid="occurDate"/>
      <BindItem id="item7" compid="edt_muNm" propid="text" datasetid="ds_search" columnid=""/>
      <BindItem id="item21" compid="cboGubun" propid="value" datasetid="ds_list" columnid="advanceClass"/>
      <BindItem id="item24" compid="cboSettleClass" propid="value" datasetid="ds_list" columnid="settleClass"/>
      <BindItem id="item25" compid="edtPost" propid="value" datasetid="ds_list" columnid="posGuestinfoNm"/>
      <BindItem id="item19" compid="msk_Qty" propid="value" datasetid="ds_list" columnid="qty"/>
      <BindItem id="item6" compid="sta_detail06" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item18" compid="msk_Amt" propid="value" datasetid="ds_list" columnid="amt"/>
      <BindItem id="item20" compid="msk_Uprice" propid="value" datasetid="ds_list" columnid="uprice"/>
      <BindItem id="item22" compid="CustSearchComponent00" propid="text" datasetid="ds_list" columnid="custNm"/>
      <BindItem id="item31" compid="edtReceiptNum" propid="value" datasetid="ds_list" columnid="receiptNum"/>
      <BindItem id="item32" compid="edtTicketSeq" propid="value" datasetid="ds_list" columnid="ticketSeq"/>
      <BindItem id="item27" compid="cboEncClass" propid="value" datasetid="ds_list" columnid="buycpnyCd"/>
      <BindItem id="item33" compid="sta_detail16" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item11" compid="edt_ticket" propid="value" datasetid="ds_list" columnid="itemNm"/>
      <BindItem id="item13" compid="txt_etc" propid="value" datasetid="ds_list" columnid="remark"/>
      <BindItem id="item14" compid="edt_tmpSeq" propid="value" datasetid="ds_list" columnid="tmpSeq"/>
    </Bind>
    <Objects>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_list_oncolumnchanged" onrowposchanged="ds_list_onrowposchanged">
        <ColumnInfo>
          <Column id="receiptNum" type="STRING" size="256"/>
          <Column id="tmpSeq" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="dealType" type="STRING" size="256"/>
          <Column id="advanceClass" type="STRING" size="256"/>
          <Column id="advanceClassNm" type="STRING" size="256"/>
          <Column id="posGuestinfo" type="STRING" size="256"/>
          <Column id="posGuestinfoNm" type="STRING" size="256"/>
          <Column id="posOutvatFlag" type="STRING" size="256"/>
          <Column id="settleClass" type="STRING" size="256"/>
          <Column id="settleClassNm" type="STRING" size="256"/>
          <Column id="buycpnyCd" type="STRING" size="256"/>
          <Column id="buycpnyNm" type="STRING" size="256"/>
          <Column id="frncStorNum" type="STRING" size="256"/>
          <Column id="cardComCd" type="STRING" size="256"/>
          <Column id="cardComNm" type="STRING" size="256"/>
          <Column id="occurAdvanceNum" type="STRING" size="256"/>
          <Column id="qty" type="BIGDECIMAL" size="22"/>
          <Column id="uprice" type="BIGDECIMAL" size="22"/>
          <Column id="amt" type="BIGDECIMAL" size="22"/>
          <Column id="remark" type="STRING" size="256"/>
          <Column id="itemCd" type="STRING" size="256"/>
          <Column id="itemNm" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="avt" type="INT" size="256"/>
          <Column id="etc" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="upjangCd" type="STRING" size="256"/>
          <Column id="occurDate" type="STRING" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="ticketSeq" type="STRING" size="256"/>
          <Column id="settleRefInfo" type="STRING" size="256"/>
          <Column id="supplyAmt" type="STRING" size="256"/>
          <Column id="vatAmt" type="STRING" size="256"/>
          <Column id="vatCd" type="STRING" size="256"/>
          <Column id="taxShetPublishYn" type="STRING" size="256"/>
          <Column id="saleOccurYn" type="STRING" size="256"/>
          <Column id="ticketStartnum" type="STRING" size="256"/>
          <Column id="ticketEndnum" type="STRING" size="256"/>
          <Column id="occurDate" type="STRING" size="256"/>
          <Column id="varSusAmt" type="STRING" size="256"/>
          <Column id="modifySalsYn" type="STRING" size="256"/>
          <Column id="ddddCloseYn" type="STRING" size="256"/>
          <Column id="saleRcvy" type="STRING" size="256"/>
          <Column id="recvDlng" type="STRING" size="256"/>
          <Column id="chgSeq" type="STRING" size="256"/>
          <Column id="taxYn" type="STRING" size="256"/>
          <Column id="altSeq" type="STRING" size="256"/>
          <Column id="advanceNum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" cancolumnchange="ds_search_cancolumnchange" oncolumnchanged="ds_search_oncolumnchanged">
        <ColumnInfo>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="occurDate" type="STRING" size="256"/>
          <Column id="schTm" type="STRING" size="256"/>
          <Column id="schTmNm" type="STRING" size="256"/>
          <Column id="schMu" type="STRING" size="256"/>
          <Column id="upjangCd" type="STRING" size="256"/>
          <Column id="upjangNm" type="STRING" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="batchId" type="STRING" size="256"/>
          <Column id="occurCopyDate" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
          <Column id="saleClass" type="STRING" size="256"/>
          <Column id="receiptNum" type="STRING" size="256"/>
          <Column id="ticketSeq" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="itemCd" type="STRING" size="256"/>
          <Column id="itemType" type="STRING" size="256"/>
          <Column id="taxShetPublishYn" type="STRING" size="256"/>
          <Column id="occurAdvanceNum" type="STRING" size="256"/>
          <Column id="receiptNum" type="STRING" size="256"/>
          <Column id="ticketEndnum" type="STRING" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="advanceNum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_advanceClass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="groupCode" type="STRING" size="50"/>
          <Column id="code" type="STRING" size="50"/>
          <Column id="codeName" type="STRING" size="500"/>
          <Column id="contents" type="STRING" size="300"/>
          <Column id="sortSeq" type="BIGDECIMAL" size="22"/>
          <Column id="systemYn" type="STRING" size="1"/>
          <Column id="posYn" type="STRING" size="1"/>
          <Column id="set1" type="STRING" size="100"/>
          <Column id="set2" type="STRING" size="100"/>
          <Column id="set3" type="STRING" size="100"/>
          <Column id="set4" type="STRING" size="100"/>
          <Column id="set5" type="STRING" size="100"/>
          <Column id="remark" type="STRING" size="300"/>
          <Column id="useYn" type="STRING" size="1"/>
          <Column id="attr01" type="STRING" size="300"/>
          <Column id="attr02" type="STRING" size="300"/>
          <Column id="attr03" type="STRING" size="300"/>
          <Column id="attr04" type="STRING" size="300"/>
          <Column id="attr05" type="STRING" size="300"/>
          <Column id="attr06" type="STRING" size="300"/>
          <Column id="attr07" type="STRING" size="300"/>
          <Column id="attr08" type="STRING" size="300"/>
          <Column id="attr09" type="STRING" size="300"/>
          <Column id="attr10" type="STRING" size="300"/>
          <Column id="cuser" type="STRING" size="20"/>
          <Column id="cdate" type="DATETIME" size="7"/>
          <Column id="uuser" type="STRING" size="20"/>
          <Column id="udate" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_signClass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="groupCode" type="STRING" size="50"/>
          <Column id="code" type="STRING" size="50"/>
          <Column id="codeName" type="STRING" size="500"/>
          <Column id="contents" type="STRING" size="300"/>
          <Column id="sortSeq" type="BIGDECIMAL" size="22"/>
          <Column id="systemYn" type="STRING" size="1"/>
          <Column id="posYn" type="STRING" size="1"/>
          <Column id="set1" type="STRING" size="100"/>
          <Column id="set2" type="STRING" size="100"/>
          <Column id="set3" type="STRING" size="100"/>
          <Column id="set4" type="STRING" size="100"/>
          <Column id="set5" type="STRING" size="100"/>
          <Column id="remark" type="STRING" size="300"/>
          <Column id="useYn" type="STRING" size="1"/>
          <Column id="attr01" type="STRING" size="300"/>
          <Column id="attr02" type="STRING" size="300"/>
          <Column id="attr03" type="STRING" size="300"/>
          <Column id="attr04" type="STRING" size="300"/>
          <Column id="attr05" type="STRING" size="300"/>
          <Column id="attr06" type="STRING" size="300"/>
          <Column id="attr07" type="STRING" size="300"/>
          <Column id="attr08" type="STRING" size="300"/>
          <Column id="attr09" type="STRING" size="300"/>
          <Column id="attr10" type="STRING" size="300"/>
          <Column id="cuser" type="STRING" size="20"/>
          <Column id="cdate" type="DATETIME" size="7"/>
          <Column id="uuser" type="STRING" size="20"/>
          <Column id="udate" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_tmpSeq" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="tmpSeq" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_dataset" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="advanceClassNm" type="STRING" size="256"/>
          <Column id="advanceClass" type="STRING" size="256"/>
          <Column id="settleClass" type="STRING" size="256"/>
          <Column id="posGuestinfo" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="uprice" type="INT" size="256"/>
          <Column id="qty" type="INT" size="256"/>
          <Column id="amt" type="INT" size="256"/>
          <Column id="avt" type="INT" size="256"/>
          <Column id="etc" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="settleClassNm" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="upjangCd" type="STRING" size="256"/>
          <Column id="occurDate" type="STRING" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="receiptNum" type="STRING" size="256"/>
          <Column id="posGuestinfoNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_searchValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="occurDate" type="STRING" size="256"/>
          <Column id="schTm" type="STRING" size="256"/>
          <Column id="upjangCd" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="muCd">title:원가부서,required:true</Col>
            <Col id="occurDate">title:등록일자,required:true</Col>
            <Col id="schTm">title:팀,required:true</Col>
            <Col id="upjangCd">title:사업장,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list_ticketD" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="ticketSeq" type="bigdecimal" size="255"/>
          <Column id="transDd" type="string" size="255"/>
          <Column id="itemType" type="string" size="255"/>
          <Column id="itemTypeNm" type="string" size="255"/>
          <Column id="itemCode" type="string" size="255"/>
          <Column id="itemCodenm" type="string" size="255"/>
          <Column id="transType" type="string" size="255"/>
          <Column id="transTypeNm" type="string" size="255"/>
          <Column id="transGubun" type="string" size="255"/>
          <Column id="transGubunnm" type="string" size="255"/>
          <Column id="remarkDesc" type="string" size="255"/>
          <Column id="uprice" type="bigdecimal" size="255"/>
          <Column id="ticketStartnum" type="bigdecimal" size="255"/>
          <Column id="ticketEndnum" type="bigdecimal" size="255"/>
          <Column id="sourceId" type="bigdecimal" size="255"/>
          <Column id="set1" type="string" size="255"/>
          <Column id="inQty" type="bigdecimal" size="255"/>
          <Column id="outQty" type="bigdecimal" size="255"/>
          <Column id="maxNum" type="bigdecimal" size="255"/>
          <Column id="janQty" type="bigdecimal" size="255"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="receiptNum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="advanceClass" type="STRING" size="256"/>
          <Column id="posGuestinfoNm" type="STRING" size="256"/>
          <Column id="uprice" type="INT" size="256"/>
          <Column id="qty" type="INT" size="256"/>
          <Column id="amt" type="STRING" size="256"/>
          <Column id="settleClass" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="custCd">title:고객사,required:true,focus:edt_custnm</Col>
            <Col id="advanceClass">title:구분,required:true,focus:cboGubun</Col>
            <Col id="posGuestinfoNm">title:창고,required:true,focus:edtPost</Col>
            <Col id="uprice">title:단가,required:true,focus:msk_Uprice</Col>
            <Col id="qty">title:식수,required:true,focus:msk_Qty</Col>
            <Col id="amt">title:금액,required:true,focus:msk_Amt</Col>
            <Col id="settleClass">title:결재유형,required:true,focus:cboSettleClass</Col>
            <Col id="remark">title:적요,required:true,focus:txt_etc</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_cccd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cardlist" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="buycpnyCd" type="STRING" size="256"/>
          <Column id="buycpnyNm" type="STRING" size="256"/>
          <Column id="cardCustCd" type="STRING" size="256"/>
          <Column id="bankCd" type="STRING" size="256"/>
          <Column id="frncStorNum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_saleRegMgnt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="occurAdvanceNum" type="STRING" size="256"/>
          <Column id="maxTicketEndnum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_ticket" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_list_ticket_oncolumnchanged">
        <ColumnInfo>
          <Column id="ticketSeq" type="STRING" size="256"/>
          <Column id="occurDate" type="STRING" size="3"/>
          <Column id="sQty" type="BIGDECIMAL" size="22"/>
          <Column id="remarkDesc" type="STRING" size="256"/>
          <Column id="upjangCd" type="BIGDECIMAL" size="22"/>
          <Column id="uprice" type="STRING" size="256"/>
          <Column id="tmpSeq" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="transDd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_beforeDt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="dtCnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_beforeDt2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="dtCnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">1</Col>
            <Col id="delYn">1</Col>
            <Col id="savYn">1</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">0</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_apprv" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="apprvYn" type="STRING" size="256"/>
          <Column id="apprvDate" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_openDate" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="openDate" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_common">
        <ColumnInfo>
          <Column id="code" size="256" type="STRING"/>
          <Column id="codename" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_beforeRv" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="rvCnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : Template
  파 일 명 : Template.xfdl
  기    능 : Design 및 Script Template 

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2014.11.01   김윤기   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "U_lib::lib_conversionCom.xjs";
include "U_lib::sc_comon.xjs";
include "lib::lib_com.xjs";
include "lib::SMCommon.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_authLvl = g_AuthLevel;
var fv_sToday = gfn_today();
var sRow = -1;
var searchboolean = false;
var suspenseAmt = 0; //가수금 팝에서 가져온 금액
var fv_retVal = "";
var delFlag = false;

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fsp_init(this);
	fn_init();
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	v_ds_check = "ds_list";
	ds_search.addRow();
	
	ds_search.setColumn(0, "muCd", g_Mu_Cd);             //사업부
    ds_search.setColumn(0, "muNm", g_Mu_Nm);
    ds_search.setColumn(0, "schTm", g_Tm_Cd);
    ds_search.setColumn(0, "schTmNm", g_Tm_Nm);
    ds_search.setColumn(0, "upjangCd", g_Upjang);
    ds_search.setColumn(0, "upjangNm", g_UpjangNm);
	
	edt_tmNm.applyAuthLevel(edt_muNm);
    edt_upjangNm.applyAuthLevel(edt_tmNm);
    edt_upjangNm.applyMainUpjang(null);
    
    //업장에 대한 권한을 팀을 따라가도록 설정한다.
	edt_upjangNm.setTmComponent(edt_tmNm);
   
    cal_occurDate.fn_initMonthCal(this, fv_sToday, null, ds_search, "occurDate");
    
	ds_dataset.copyData(ds_list);
    
    //cc_cd 조회
	fn_upjangCcCdInfo();
	
	// 사업장별 오픈일자 조회 : 2015.11.04
	fn_searchOpenDate();
	
    //테스트용 운영1팀 한화빌딩 -- 테스트후 주석
    //edt_muNm.setMuCode("2002");             //사업부
    //edt_tmNm.setTmCode("CDG");
    //edt_tmNm.setTmName("FS운영1팀");
    //edt_upjangNm.setUpjangCode("100785");   //갤러압구정
    //edt_upjangNm.setUpjangName("FC 갤러리아압구정점");   //갤러압구정
    
    //edt_muNm.setMuCode("2002");             //사업부
    //edt_tmNm.setTmCode("CDG");
    //edt_tmNm.setTmName("FS운영1팀");
    //edt_upjangNm.setUpjangCode("100751");//FC 한화빌딩점
    //edt_upjangNm.setUpjangName("FC 한화빌딩점");//FC 한화빌딩점
    
    //edt_muNm.setMuCode("2002");             //사업부
    //edt_tmNm.setTmCode("CDG");
    //edt_tmNm.setTmName("FS운영1팀");
    //edt_upjangNm.setUpjangCode("100763");//FC 한화빌딩점
    //edt_upjangNm.setUpjangName("FC빙그레2점");//FC빙그레2점
    
    //cal_occurDate.fn_initMonthCal(this, "20150716", null, ds_search, "occurDate");
    
    //사업부에 따라 매출유형이 달라진다
	if(ds_search.getColumn(0,"muCd") == "2001"){
	    ds_search.setColumn(0, "sysClass", "15");
	}else if(ds_search.getColumn(0,"muCd") == "2003"){
	    ds_search.setColumn(0, "sysClass", "12");
	}else{
		ds_search.setColumn(0, "sysClass", "11");
	}
    
    SCPopup.bind(this, "PosList", "edtPost", "btn_postPopup", null, {upjangCd:ds_search.getColumn(0, "upjangCd"), ccCd:ds_search.getColumn(0, "ccCd")}, {before:"fn_posPopBefore", after:"fn_posPop"}); //창고팝업
    
    fn_comCode("ds_advanceClass","ADVANCE_CLASS");//선수금 구분
    fn_comCode("ds_signClass","ADVANCE_SIGN_CLASS");//선수금 결재 구분
    
    SCAuth.setUserButton(this, {buttons : [{id:"btn_add", role:"src", ischange:false},{id:"btn_delete", role:"src", ischange:false}]});
	
}

function fn_custPopup(p){
	p.setQid("ScoUpjangCust");//거래처팝업에 반드시 필요
	p.setUpjang(ds_search.getColumn(0, "upjangCd"));
	return true;
}

//거래처팝업 후처리
function fn_custPopupAfter(){
	//cboGubun.value = "";
	edtPost.value = "";
	//cboSettleClass.value = "";
	cboEncClass.value = "";
	
	msk_Qty.value = "";
	msk_Uprice.value = "";
	msk_Amt.value = "";
	
	//첫번째로 기본설정 
	//alert(ds_signClass.getColumn(0, "set1"));
	//ds_list.setColumn(ds_list.rowposition,"advanceClass",ds_advanceClass.getColumn(0, "code"));
	//ds_list.setColumn(ds_list.rowposition,"settleClass",ds_signClass.getColumn(0, "set1"));
}

//창고팝업 
function fn_posPopBefore(data){
	//cc_cd 조회
	fn_upjangCcCdInfo();
	
	data.option.upjangCd = ds_search.getColumn(0, "upjangCd");
	data.option.ccCd = ds_search.getColumn(0, "ccCd");
	return true;
}

//창고팝업 후처리
function fn_posPop(p, data){
	ds_list.setColumn(ds_list.rowposition, "posGuestinfo", edtPost.userdata);
	ds_list.setColumn(ds_list.rowposition, "posOutvatFlag", data.outvatFlag);
	return true;
}

//업장변경후처리
function fn_upjangAfter(){
	//cccd 조회
	fn_upjangCcCdInfo();
	
	// 사업장별 오픈일자 조회 : 2015.11.04 추가
	fn_searchOpenDate();
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{	
//	// v_ds_check 미사용시 변경사항 체크(입력 프로그램일때 변경되는 Dataset 전체 기술)
// 	if (gfn_dsIsUpdated(ds_list) == true) 
// 	{
// 		// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
//         if (!gfn_confirm("confirm.before.movepage")) return false;
//     }
//     
//	// 조회프로그램에도 Return true; 기술해 주세요!
// 	return true;

	// v_ds_check 사용시 변경사항 체크
	if(gfn_length(v_ds_check) != 0)
	{	
		// v_ds_check 설정기준 변경사항 체크
		if (gfn_isDataChange() == true) 
		{		
			// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
			if (!gfn_confirm("confirm.before.movepage")) return false;
		}
	}
    
	// 조회프로그램에도 Return true; 기술해 주세요!
	return true;
}
/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * ComCode 조회
 *-------------------------------------------------------------------------'--------------------*/
function fn_comCode(dataset,type){
	if(type == "CARD_LIST"){
		gfn_transaction(this
						,"cardList"
						,"fs/fsl/upjangMealTicketRegMgnt/cardList.xdo"    
						,"ds_search=ds_search"
						,"ds_cardlist=ds_cardlist"
						,""
						,"fn_callBack"
						,false);
	}else{
		gfn_transaction(this
						,"salsType"
						,"sm/cmn/common/selectComCode.xdo"    
						,""
						,dataset+"=ds_combo"
						,"groupCode="+wrapQuote(type)
						,"fn_callBack"
						,false);
	}
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
// 	// v_ds_check 미사용시 변경사항 체크
// 	if (gfn_dsIsUpdated(ds_list) == true) 
// 	{
// 		var retValue = gfn_confirm("confirm.before.search");	// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
// 		if (retValue == false) return;
// 	}

// 	// v_ds_check 사용시 공통버튼에서 변경사항 체크함
// 	// 변경사항 체크
// 	if (gfn_isDataChange() == true) 
// 	{		
// 		var retValue = gfn_confirm("confirm.before.search");	// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
// 		if (retValue == false) return;
// 	}
	
	// ds_listValid Dataset에 Validation할 칼럼별로 구성
	// 항목 추가시에는 ','로 구분
	// 예)title:금액1,required:false,minlength:2,digits:true
	
	// Alert시 칼럼 표시 명칭               - title:아이디(메시지의 치환할 명칭) 
	// 필수체크                              - required:true(체크여부 true/false)
	// size 크기                              - length:7(size 숫자)
	// 최대 size 크기                        - maxlength:7(size 숫자)
	// 최소 size 크기                        - minlength:7(size 숫자)
	// 최대 size 크기(Byte)                  - maxlengthB:7(size 숫자)
	// 최소 size 크기(Byte)                  - minlengthB:7(size 숫자)
	// 숫자 여부                             - digits:true(체크여부 true/false)
	// 해당 숫자 이하                       - min:7(size 숫자)
	// 해당 숫자 이상                       - max:7(size 숫자)
	// 소숫점 자리수 비교                   - declimit:3(size 숫자)
	// 날짜 년월일 체크                     - date:true(체크여부 true/false)
	// 날짜 년월 체크                       - dateym:true(체크여부 true/false)
	// 타 칼럼값보다 큰지 비교             - comparemax:Column4(Dataset 칼럼ID):시작일(비교대상의 메시지 치환할 명칭)
	// 타 칼럼값보다 작은지 비교           - comparemin:Column6(Dataset 칼럼ID):종료일(비교대상의 메시지 치환할 명칭)
	// 타 칼럼값과 같은 값인지 비교        - equalto:Column5(Dataset 칼럼ID):금액1(비교대상의 메시지 치환할 명칭)
	// 사이의 값인지 비교                   - range:40(from 숫자):100(to 숫자)
	// 코드값이 목록내의 값인지 비교       - code:1(목록 숫자):2(목록 숫자):3(목록 숫자)
	// 이메일 여부 체크(함수 체크시 예제)  - isEmail:true(체크여부 true/false)
	
	// 오류시 focus 지정                      - focus:cal_toDate(Componet ID로 form에서부터의 경로)
	
	// 조회시 Validation Check
	if (gfn_validCheck(ds_search, ds_searchValid, true) == false) return;

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(Div_list.grd_list);
    
    if(ds_cccd.getRowCount() > 0){
		ds_search.setColumn(0,"ccCd" , ds_cccd.getColumn(0,"ccCd"));
	}
	
	//trace(ds_search.saveXML());

    var strSvcID    = "search";
    var strURL      = "/fs/fsl/upjangMealTicketRegMgnt/selectList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_list=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = false;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
    
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{
// 	if(ds_search.getColumn(0, "occurDate") > fv_sToday){
// 		gfn_alert("오늘날짜 이후는 입력할 수 없습니다.");
// 		fn_search();
// 		return ;
// 	}
// 	
// 	if(ds_search.getColumn(0, "occurDate") < "20151001"){
// 		gfn_alert("10월 이전으로는  입력할 수 없습니다.");
// 		return;
// 	}
// 
// 	// 건별추가를 할때는 마감여부 체크를 하지 않는다 : 2015.10.23 추가
// 	if(!gubun == "add"){
// 		fn_beforeDt();//마감여부 조회
// 		for(var i=0; i<ds_beforeDt.rowcount; i++){
// 			if(ds_beforeDt.getColumn(i, "dtCnt") == "Y"){
// 				gfn_alert("마감이 완료되어 변경할 수 없습니다.");
// 				fn_search();
// 				return false;
// 			}
// 		}
// 	
// 		
// 		fn_beforeDt2(); // 전일자 마감여부 조회
// 		for(var i=0; i<ds_beforeDt2.rowcount; i++){
// 			if(ds_beforeDt2.getColumn(i, "dtCnt") == "N"){
// 				gfn_alert("전일자 미마감건이 존재하여 변경할 수 없습니다.");
// 				fn_search();
// 				return false;
// 			}
// 		}
// 	}
// 	
// 	
// 	
// 	for(var i=0; i<ds_list.rowcount; i++){
// 		if(ds_list.getColumn(i, "receiptNum") == undefined){
// 			gfn_alert("작성중인 데이터가 있습니다.\n추가입력은 저장 후 가능합니다");
// 			return false;
// 		}
// 	}
// 	
// 	edt_custnm.enable = true;//고객사
// 	cboGubun.enable = true;//구분
// 	edtPost.enable = true;//창고
// 	btn_postPopup.enable = true;//창고버튼
// 	cboSettleClass.enable = true;//결재유형
// 	cboEncClass.enable = true;//카드사
// 	msk_Qty.enable = true;//식수
// 	msk_Uprice.enable = true;//단가
// 	//msk_Amt.enable = true;//금액
// 	//edt_ticket.enable = true;//자재명
// 	btn_edt_ticket.enable = true;//자재명
// 	txt_etc.enable = true;//비고
// 		
// 	if(fn_searchboolean())return;
// 	sRow = ds_list.addRow();
// 	// Grid 입력 cell 지정
// 	grd_list.setFocus();
// 	grd_list.setCellPos(1);
// 	ds_list.setColumn(sRow,"muCd" , ds_search.getColumn(0,"muCd"));
// 	//ds_list.setColumn(sRow,"tmCd" , ds_search.getColumn(0,"tmCd"));
// 	ds_list.setColumn(sRow,"upjangCd" , ds_search.getColumn(0,"upjangCd"));
// 	ds_list.setColumn(sRow,"occurDate" , ds_search.getColumn(0,"occurDate"));
// 	
// 	if(ds_search.getColumn(0,"muCd") == "2002"){
// 		ds_list.setColumn(sRow,"sysClass","11");
// 	}else if(ds_search.getColumn(0,"muCd") == "2003"){
// 		ds_list.setColumn(sRow,"sysClass","12");
// 	}
// 	
// 	// 건별추가 플래그 modifySalsYn을 A로 추가 : 2015.10.23 추가
// 	if(gubun == "add"){
// 		ds_list.setColumn(sRow, "modifySalsYn", "A");
// 	}
// 	
// 	fn_tmpSeq();
// 	fn_settleclass("");
// 	fn_Gubun("", false);
// 	

 	// 기존 insert는 구분자 default로 추가
	fn_add("default");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_add(gubun)
{
	if(ds_search.getColumn(0, "occurDate") > fv_sToday){
		gfn_alert("오늘날짜 이후는 입력할 수 없습니다.");
		fn_search();
		return ;
	}
	
	if(ds_search.getColumn(0, "occurDate") < "20151001"){
		gfn_alert("10월 이전으로는  입력할 수 없습니다.");
		return;
	}
	
	// 해당월이 월마감이 된경우 매출등록을 할 수 없다.
	mfn_GetClsStatus(gfn_subStr(cal_occurDate.fn_getValue(), 0, 6));
	if (ds_common.rowcount > 0)
	{
		g_Message("EE", "해당월은 월마감이 완료되어 입력이 불가합니다.");
		return false;
	}
	
	mfn_GetCcMonthClsYn("U",edt_upjangNm.getUpjangCode(),gfn_subStr(ds_search.getColumn(0, "occurDate"),0,6),"01");
	if(ds_common.getColumn(0,0) == "Y"){
		g_Message("EE", "해당월은 월마감이 완료되어 입력이 불가합니다.\n-영업 월마감-");
		return false;
	}

	// 건별추가를 할때는 마감여부 체크를 하지 않는다
	if(gubun == "default"){
		fn_beforeDt();//마감여부 조회
		for(var i=0; i<ds_beforeDt.rowcount; i++){
			if(ds_beforeDt.getColumn(i, "dtCnt") == "Y"){
				gfn_alert("마감이 완료되어 변경할 수 없습니다.");
				fn_search();
				return false;
			}
		}
	
		// 오픈일자가 오늘인 경우에는 전일자 체크를 하지 않는다 : 2015.11.04 추가
		//trace(ds_openDate.getColumn(0, "openDate"));
		if(ds_openDate.getColumn(0, "openDate") != fv_sToday){
			fn_beforeDt2(); // 전일자 마감여부 조회
			for(var i=0; i<ds_beforeDt2.rowcount; i++){
				if(ds_beforeDt2.getColumn(i, "dtCnt") == "N"){
					gfn_alert("전일자 미마감건이 존재하여 변경할 수 없습니다.");
					fn_search();
					return false;
				}
			}
		}
	}else{
		fn_beforeDt();//마감여부 조회
		for(var i=0; i<ds_beforeDt.rowcount; i++){
			if(ds_beforeDt.getColumn(i, "dtCnt") == "N"){
				gfn_alert("미마감건이 있어 건별추가를 하실 수 없습니다.");
				fn_search();
				return false;
			}
		}
	}
	
	
	
	for(var i=0; i<ds_list.rowcount; i++){
		if(ds_list.getColumn(i, "receiptNum") == undefined){
			gfn_alert("작성중인 데이터가 있습니다.\n추가입력은 저장 후 가능합니다");
			return false;
		}
	}
	
	
	edt_custnm.enable = true;//고객사
	cboGubun.enable = true;//구분
	edtPost.enable = true;//창고
	btn_postPopup.enable = true;//창고버튼
	cboSettleClass.enable = true;//결재유형					
	//cboSettleClass.value = ds_signClass.getColumn(0, "code");
	cboEncClass.enable = true;//카드사
	msk_Qty.enable = true;//식수
	msk_Qty.readonly = false;
	msk_Uprice.enable = true;//단가
	msk_Uprice.readonly = false;
 	
	//msk_Amt.enable = true;//금액
	//edt_ticket.enable = true;//자재명
	btn_edt_ticket.enable = true;//자재명
	txt_etc.enable = true;//비고
		
	if(fn_searchboolean())return;
	//sRow = ds_list.addRow();
	sRow = ds_list.insertRow(0);			
	
	// Grid 입력 cell 지정
	Div_list.grd_list.setFocus();
	Div_list.grd_list.setCellPos(1);
	ds_list.setColumn(sRow,"muCd" , ds_search.getColumn(0,"muCd"));
	//ds_list.setColumn(sRow,"tmCd" , ds_search.getColumn(0,"tmCd"));
	ds_list.setColumn(sRow,"upjangCd" , ds_search.getColumn(0,"upjangCd"));
	ds_list.setColumn(sRow,"occurDate" , ds_search.getColumn(0,"occurDate"));
	
	if(ds_search.getColumn(0,"muCd") == "2001"){
		ds_list.setColumn(sRow,"sysClass","15");
	}else if(ds_search.getColumn(0,"muCd") == "2002"){
		ds_list.setColumn(sRow,"sysClass","11");
	}else if(ds_search.getColumn(0,"muCd") == "2003"){
		ds_list.setColumn(sRow,"sysClass","12");
	}
	
	// 건별추가 플래그 modifySalsYn을 A로 추가 : 2015.10.23 추가
	if(gubun == "add"){
		ds_list.setColumn(sRow, "modifySalsYn", "A");
	}
	
	fn_tmpSeq();
	fn_settleclass("");	
	fn_Gubun("", false);		
	edt_custnm.setFocus();	
	//거래처선택창 띄우기
	edt_custnm.btn_search_onclick();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{
	for(var i=0; i<ds_list.rowcount; i++){
		if(ds_list.getColumn(i, "receiptNum") == undefined){
			if(i != ds_list.rowposition){
				gfn_alert("작성중인 데이터가 있습니다.\n삭제는 저장 후 가능합니다");
				return false;
			}
		}
	}
	
	if(ds_list.getColumn(ds_list.rowposition, "occurAdvanceNum") != "" && ds_list.getColumn(ds_list.rowposition, "occurAdvanceNum") != null
		&& ds_list.getColumn(ds_list.rowposition, "occurAdvanceNum") != undefined){
		fn_selectSaleRegMgnt(ds_list.rowposition);//매출등록 여부 확인
		
		if(ds_list.getColumn(ds_list.rowposition, "occurAdvanceNum") == ds_saleRegMgnt.getColumn(0, "occurAdvanceNum")){
			gfn_alert("매출등록이 되어 삭제할 수 없습니다.");
			return;
		}
		
		if(ds_list.getColumn(ds_list.rowposition, "advanceClass") == "001" || ds_list.getColumn(ds_list.rowposition, "advanceClass") == "002"){
			if(ds_saleRegMgnt.getColumn(0, "maxTicketEndnum") != null && ds_saleRegMgnt.getColumn(0, "maxTicketEndnum") != ""
				&& ds_saleRegMgnt.getColumn(0, "maxTicketEndnum") != undefined){
				gfn_alert("이후에 판매된 식권이존재하여 삭제할 수 없습니다.");
				return;
			}
		}
	}
	

	fn_beforeDt();//마감여부 조회
	//alert("마감여부 조회");
	//alert("마감여부 조회" + ds_list.getRowType(ds_list.rowposition));
	if(ds_list.getRowType(ds_list.rowposition) == 1){
		for(var i=0; i<ds_beforeDt.rowcount; i++){
			if(ds_beforeDt.getColumn(i, "dtCnt") == "Y"){
				gfn_alert("마감이 완료되어 변경할 수 없습니다.");
				fn_search();
				return false;
			}
		}
		
		// 사업장 오픈일자가 오늘이라면 전일자 미마감 체크는 하지 않는다 : 2015.11.04 추가
		if(ds_openDate.getColumn(0, "openDate") != fv_sToday){
			fn_beforeDt2(); // 전일자 마감여부 조회
			for(var i=0; i<ds_beforeDt2.rowcount; i++){
				if(ds_beforeDt2.getColumn(i, "dtCnt") == "N"){
					gfn_alert("전일자 미마감건이 존재하여 변경할 수 없습니다.");
					fn_search();
					return false;
				}
			}
		}
	}		

	
	var nRow = ds_list.rowposition;
	
	if(ds_list.rowposition == -1) 
	{
		gfn_alert("msg.err.grid.noselect", "삭제할 row");	// 선택된 항목이 없습니다.
		return;
	}

	var rtVal = gfn_confirm("confirm.before.delete");	// 선택된 자료를 삭제 하시겠습니까?
	if (rtVal == true) {
		//ds_list_ticket 삭제
		if(ds_list_ticket.rowcount > 0){
			for(var i = ds_list_ticket.rowcount-1; i >= 0; i--){
				if(ds_list_ticket.getColumn(i, "tmpSeq") == edt_tmpSeq.value){
					ds_list_ticket.deleteRow(i);
				}
			}
		}
		
		ds_list.deleteRow(nRow);
		delFlag = true;
		
		fn_save();
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
	//입금일자 제한
	/*
	if (edt_muNm.getMuCode() == "2003") {
		//pass
	} else {
		
		for(var i=0; i<ds_list.rowcount; i++){
			if(ds_list.getColumn(i, "settleClass") == "3"){
				if(ds_search.getColumn(0,"occurDate") > '20201130'){
					alert("12월 일자로 가수금 처리 불가(물리적 분리로 SAP처리 불가)");
					return;
				}
			}
		}		
	}
	*/	
	
	//자동 마감 시간에는 등록 불가처리(몇건만 미마감되는 문제 해결) 20180419 김호석
	//var workTime = (gfn_todayTime().substr(8, 4));		
	//서버시간으로 체크하도록 변경 20181113 김호석
	fn_CurrDateWeek();
	var workTime = gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4);
	if ( workTime >= 1030 && workTime <= 1040 ) {
		gfn_alert("자동 일마감 시간인 10:30 ~ 10:40 10분간은 선수금 등록이 불가합니다.");
		return;
	}
// 	// v_ds_check 미사용시 변경사항 체크
	if (gfn_dsIsUpdated(ds_list) == false) 
	{
		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
		return;
	}
	
	// 해당월이 월마감이 된경우 매출등록을 할 수 없다.
	mfn_GetClsStatus(gfn_subStr(cal_occurDate.fn_getValue(), 0, 6));
	if (ds_common.rowcount > 0)
	{
		g_Message("EE", "해당월은 월마감이 완료되어 저장이 불가합니다.");
		return false;
	}
	
	// 해당 식권의 입고일보다 등록일자가 먼저일경우 리턴
	if(ds_search.getColumn(0, "occurDate") < ds_list_ticket.getColumn(0, "transDd")){
		gfn_alert("식권의 입고일자가 등록일 이후 입니다.\n\n입고일자를 확인해 주세요.");
		return;
	}
	//alert("저장시작");
// 	// v_ds_check 사용시 변경사항 체크
// 	if (gfn_isDataChange() == true) 
// 	{		
// 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
// 		return;
// 	}
	
	
	// ds_listValid Dataset에 Validation할 칼럼별로 구성
	// 항목 추가시에는 ','로 구분
	// 예)title:금액1,required:false,minlength:2,digits:true
	
	// Alert시 칼럼 표시 명칭               - title:아이디(메시지의 치환할 명칭) 
	// 필수체크                              - required:true(체크여부 true/false)
	// size 크기                              - length:7(size 숫자)
	// 최대 size 크기                        - maxlength:7(size 숫자)
	// 최소 size 크기                        - minlength:7(size 숫자)
	// 최대 size 크기(Byte)                  - maxlengthB:7(size 숫자)
	// 최소 size 크기(Byte)                  - minlengthB:7(size 숫자)
	// 숫자 여부                             - digits:true(체크여부 true/false)
	// 해당 숫자 이하                       - min:7(size 숫자)
	// 해당 숫자 이상                       - max:7(size 숫자)
	// 소숫점 자리수 비교                   - declimit:3(size 숫자)
	// 날짜 년월일 체크                     - date:true(체크여부 true/false)
	// 날짜 년월 체크                       - dateym:true(체크여부 true/false)
	// 타 칼럼값보다 큰지 비교             - comparemax:Column4(Dataset 칼럼ID):시작일(비교대상의 메시지 치환할 명칭)
	// 타 칼럼값보다 작은지 비교           - comparemin:Column6(Dataset 칼럼ID):종료일(비교대상의 메시지 치환할 명칭)
	// 타 칼럼값과 같은 값인지 비교        - equalto:Column5(Dataset 칼럼ID):금액1(비교대상의 메시지 치환할 명칭)
	// 사이의 값인지 비교                   - range:40(from 숫자):100(to 숫자)
	// 코드값이 목록내의 값인지 비교       - code:1(목록 숫자):2(목록 숫자):3(목록 숫자)
	// 이메일 여부 체크(함수 체크시 예제)  - isEmail:true(체크여부 true/false)
	
	// 오류시 focus 지정                      - focus:cal_toDate(Componet ID로 form에서부터의 경로)
	
	if (gfn_validCheck(ds_list, ds_listValid, true) == false) return;
	// 저장시 Validation Check	
	//alert("저장");

	// 자동저장시 확인 눌러야 저장 가능
	if(delFlag == false){
		if(chk_Auto.value){
			var retVal = gfn_confirm("입력하신 내용을 저장 하시겠습니까?");
			if(retVal){
				if (fn_valid(true) == false) return;
			}else{
				return;
			}
		}else{
			if (fn_valid(true) == false) return;
		}
 	}else{
 		if (fn_valid(true) == false) return;
 	}
 	
 	//return;
 	//trace(ds_list.saveXML());
	
    var strSvcID    = "save";
    var strURL      = "/fs/fsl/upjangMealTicketRegMgnt/saveList.xdo";
    var strInDs     = "ds_list=ds_list:U ds_list_ticket=ds_list_ticket:U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

function fn_valid(){
	fn_beforeDt();//마감여부 조회
	
	//alert(ds_list.getColumn(ds_list.rowposition, "modifySalsYn"));
	//alert(ds_list.getRowType(ds_list.rowposition));
	//alert(ds_list.getRowType(0));
	if(ds_list.getColumn(ds_list.rowposition, "modifySalsYn") != "A" || ds_list.getRowType(ds_list.rowposition) == 4 || ds_list.getRowType(ds_list.rowposition) == 0){
	
		//alert("33");
		for(var i=0; i<ds_beforeDt.rowcount; i++){
			if(ds_beforeDt.getColumn(i, "dtCnt") == "Y"){
				gfn_alert("마감이 완료되어 변경할 수 없습니다.");
				fn_search();
				return false;
			}
		}
		
		// 사업장 오픈일자가 오늘이라면 전일자 미마감 체크는 하지 않는다 : 2015.11.04 추가
		if(ds_openDate.getColumn(0, "openDate") != fv_sToday){
			fn_beforeDt2(); // 전일자 마감여부 조회
			for(var i=0; i<ds_beforeDt2.rowcount; i++){
				if(ds_beforeDt2.getColumn(i, "dtCnt") == "N"){
					gfn_alert("전일자 미마감건이 존재하여 변경할 수 없습니다.");
					fn_search();
					return false;
				}
			}
		}
	}	

	for(var i=0; i<ds_list.rowcount; i++){
		if(ds_list.getRowType(i) == Dataset.ROWTYPE_INSERT){
			//CCCD 셋팅
			ds_list.setColumn(i, "ccCd" ,ds_cccd.getColumn(0, "ccCd"));
			if(ds_list.getColumn(i, "settleClass") == "3"){
				//계좌번호
				if(ds_list.getColumn(i, "settleRefInfo") == "" || ds_list.getColumn(i, "settleRefInfo") == null){
					gfn_alert("결재유형이 가수금 일때 가수금번호는 필수 입니다.");
					ds_list.rowposition = i;
					return false;
				}
				
				//금액체크
				if(ds_list.getColumn(i, "amt") != ds_list.getColumn(i, "varSusAmt")){
					gfn_alert("[가수금금액:"+gfn_numFormat(ds_list.getColumn(i, "varSusAmt"))+"]"+" "+"[금액:"+gfn_numFormat(ds_list.getColumn(i, "amt"))+"]\n금액이 다릅니다.");
					//단가,식수,자재명,금액 초기화
					ds_list.setColumn(i, "uprice", "");
					ds_list.setColumn(i, "qty", "");
					ds_list.setColumn(i, "itemNm", "");
					ds_list.setColumn(i, "amt", "");
					ds_list.rowposition = i;
					return false;
				}
			}
			
			//카드사 체크
			if(ds_list.getColumn(i, "settleClass") == "2"){
				if(ds_list.getColumn(i, "buycpnyCd") == "" || ds_list.getColumn(i, "buycpnyCd") == null){
					gfn_alert("결재유형이 카드 일때 카드사는 필수 입니다.");
					ds_list.rowposition = i;
					return false;
				}
			}
		
		
			//단가,식수,자재명
			if(ds_list.getColumn(i, "advanceClass") == "001" || ds_list.getColumn(i, "advanceClass") == "002"){
			//alert(ds_list.getColumn(i, "uprice")+"/"+ds_list.getColumn(i, "qty")+"/"+ds_list.getColumn(i, "itemNm"));
				if(ds_list.getColumn(i, "uprice") == "" || ds_list.getColumn(i, "qty") == "" || ds_list.getColumn(i, "itemNm") == ""){
					gfn_alert("구분이 식권일때 단가/식수/자재명은 필수 입력 항목입니다.");
					ds_list.rowposition = i;
					return false;
				}else if(ds_list.getColumn(i, "uprice") == null || ds_list.getColumn(i, "qty") == null || ds_list.getColumn(i, "itemNm") == null){
					gfn_alert("구분이 식권일때 단가/식수/자재명은 필수 입력 항목입니다.");
					ds_list.rowposition = i;
					return false;
				}
				
			}else if(ds_list.getColumn(i, "advanceClass") == "004"){
				if(ds_list.getColumn(i, "uprice") == "" || ds_list.getColumn(i, "qty") == ""){
					gfn_alert("구분이 식권일때 단가/식수는 필수 입력 항목입니다.");
					ds_list.rowposition = i;
					return false;
				}else if(ds_list.getColumn(i, "uprice") == null || ds_list.getColumn(i, "qty") == null){
					gfn_alert("구분이 식권일때 단가/식수는 필수 입력 항목입니다.");
					ds_list.rowposition = i;
					return false;
				}
				trace(ds_list.getColumn(i,"receiptNum") + " save : " + !gfn_isNull(ds_list.getColumn(i,"receiptNum")));
				trace(ds_list.getColumn(i,"chgSeq") + " save : " + gfn_isNull(ds_list.getColumn(i,"chgSeq")) );
				if(!gfn_isNull(ds_list.getColumn(i,"receiptNum")) ||  gfn_isNull(ds_list.getColumn(i,"chgSeq"))){
					gfn_alert("교환식권을 선택해 주세요.");
					ds_list.rowposition = i;
					fn_chgTicket();
					return false;
				}
				
			}
			
			ds_list.setColumn(i, "supplyAmt", gfn_round(ds_list.getColumn(i, "amt")/1.1));//공급가액(총액/1.1)
			ds_list.setColumn(i, "vatAmt", ds_list.getColumn(i, "amt") - ds_list.getColumn(i, "supplyAmt"));//부가세금액(매출액 - 공급가)	
			
	// 		if(ds_list.getColumn(i, "advanceClass") == "001" && ds_list.getColumn(i, "posOutvatFlag") == "Y"){
	// 
	// 		}else if(ds_list.getColumn(i, "advanceClass") == "002" && ds_list.getColumn(i, "posOutvatFlag") == "Y"){
	// 		
	// 		}
		}//if getrowType
	}//for
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
	//** 테스트 검색 조건 **//
	ds_search.setColumn(0,"muCd","YA");
	ds_search.setColumn(0,"upjangCd","101045");
	ds_search.setColumn(0,"upjangNm","FC 산재동해점(폐점:2015년05월29일)");
	ds_search.setColumn(0,"schTmNm", "병원영업팀");
	ds_search.setColumn(0,"schTm", "Y64");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
	
}
/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {
		// 코드분류 조회
        case "search" :   
			ds_list_ticketD.clearData();
            if(ds_list.getRowCount() > 0){
				//삭제만 가능
				var advanceNum = ds_list.getColumn(ds_list.rowposition, "occurAdvanceNum");
				if(advanceNum != null && advanceNum != "" && advanceNum != undefined){
					edt_custnm.enable = false;
					cboGubun.enable = false;
					edtPost.enable = false;
					cboSettleClass.enable = false;
					cboEncClass.enable = false;
					msk_Qty.enable =false;
					msk_Uprice.enable =false;
					//msk_Amt.enable =false;
					//edt_ticket.enable =false;
					btn_edt_ticket.enable =false;
					txt_etc.enable = false;
				}
	
				fn_Gubun(ds_list.getColumn(ds_list.rowposition,"advanceClass"), false);
				fn_settleclass(ds_list.getColumn(ds_list.rowposition,"settleClass"));
				
				if(ds_list.getColumn(ds_list.rowposition, "advanceClass") == "001" || ds_list.getColumn(ds_list.rowposition, "advanceClass") == "002"){
					if(ds_list.getColumn(ds_list.rowposition, "itemCd") != "" && ds_list.getColumn(ds_list.rowposition, "itemCd") != null){
						ds_search.setColumn(0, "itemCd", ds_list.getColumn(ds_list.rowposition, "itemCd"));
						fn_ticketsearchDetail();//식권판매 관리 조회
					}
				}
			}else{
				ds_list.copyData(ds_dataset);
			}
			ds_list.addColumn("chgSeq","string","255");
			ds_list.addColumn("chgDd","string","255");
			searchboolean = true;
			
			//티켓용 데이터셋 삭제
			if(ds_list_ticket.rowcount > 0){
				ds_list_ticket.clearData();
			}
			//alert("마감여부 조회"):
			fn_beforeDt();//마감여부 조회
			
            break;
            
        case "selectUpjangCcCdInfo" :
           if(ds_cccd.rowcount > 0){
			ds_search.setColumn(0, "ccCd", ds_cccd.getColumn(0, "ccCd"));
           }
           break;
        
        // 저장
        case "save" :
			gfn_alert("msg.save.success");	// 저장 되었습니다.
			fn_search();
			ds_list_ticket.clearData();
			
			var cCnt = 0;
			//마감된 경우 자동입력안되게 처리 추가 20190605 김호석
			fn_beforeDt();//마감여부 조회	
			for(var i=0; i<ds_beforeDt.rowcount; i++){
				if(ds_beforeDt.getColumn(i, "dtCnt") == "Y"){
					//gfn_alert("1111111마감이 완료되어 자동 입력할 수 없습니다.");
					cCnt = cCnt + 1;
					break;  
				}
			}
			
			//마감여부에 따라
			if (cCnt == 0) {
				if(delFlag == false){
					if(chk_Auto.value){
						fn_insert();
					}
				}
			}
			delFlag = false;
            break;    
        case "selectTmpSeq" :
			if(ds_tmpSeq.getRowCount() > 0){
				ds_list.setColumn(sRow,"tmpSeq",ds_tmpSeq.getColumn(0,"tmpSeq"));
			}
			break;
		case "searchTicketDetail" :
			break;		
				
		case "salsType" :
		    if(ds_search.getColumn(0, "sysClass") == "15"){
				ds_advanceClass.filter(" code == '001' || code == '002' || code == '003' || code == '004' ")
		    }else if(ds_search.getColumn(0, "sysClass") == "11"){
				ds_advanceClass.filter(" code == '001' || code == '002' || code == '003' || code == '004' ")
		    }else if(ds_search.getColumn(0, "sysClass") == "12"){ 
				ds_advanceClass.filter(" code == '001' || code == '002' || code == '003' || code == '004' ")				
				cboGubun.index=1;
		    }
		    break;
		    
		case "searchApprv" : 
				// 등록일자 변경시 건별추가 버튼 활성화 처리
				//if(ds_apprv.getColumn(0, "apprvYn") == "Y" && ds_apprv.getColumn(0, "apprvDate") == fv_sToday){
				//승인날짜와 오늘날짜를 비교하면 건별버튼활성화 안되서 조건 수정 2017.09.07 김호석
				if(ds_apprv.getColumn(0, "apprvYn") == "Y"){	
					//alert("11");
					btn_add.visible = true;
					btn_delete.visible = true;
				}else{
					btn_add.visible = false;
					btn_delete.visible = false;
				}
				
				//업장별 마감건인경우  건별취소, 건별입력 버튼은 비활성화 시킴
				mfn_GetCcMonthClsYn("U",edt_upjangNm.getUpjangCode(),gfn_subStr(ds_search.getColumn(0, "occurDate"),0,6),"01");
				
				//if(ds_search.getColumn(0, "occurDate") == "20160229" && ds_search.getColumn(0,"muCd") == "2002")
                if(gfn_subStr(ds_search.getColumn(0, "occurDate"),6,8) == GetLastDay(gfn_subStr(ds_search.getColumn(0, "occurDate")),0,7) && ds_search.getColumn(0,"muCd") == "2002")			
				{
					if (ds_common.getColumn(0,0) == "Y")
					{
						btn_add.visible = false;
						btn_delete.visible = false;
						ds_apprv.getColumn(0, "apprvYn") = "N";
							
					}
					else
					{
// 						btn_add.visible = true;
// 						btn_delete.visible = true;
// 						ds_apprv.getColumn(0, "apprvYn") = "Y";
                        //미마감인데 일반 입력하면 건별처럼 다 마감되어서 수정  20160401 맹수영
				        fn_beforeDt();
				        
	                    for(var i=0; i<ds_beforeDt.rowcount; i++){
	              	        if(ds_beforeDt.getColumn(i, "dtCnt") == "Y")
	              	        {
								//alert("22");
 						       btn_add.visible = true;
 						       btn_delete.visible = true;
					           ds_apprv.getColumn(0, "apprvYn") = "Y";
		                     }
		                     else
		                     {
 						       btn_add.visible = false;
 						       btn_delete.visible =  false;
					           ds_apprv.getColumn(0, "apprvYn") = "N";
		                     }
	                     }																							
					}			
				}	
				break;
		    
		case "closeProc" : 
			var arrRetVal  = fv_retVal.split("|");
		
			if(arrRetVal[0] == "TRUE"){
				//gfn_alert("msg.action.close.success");	// 정상적으로 마감처리 되었습니다.
				gfn_alert("["+arrRetVal[0]+"] "+arrRetVal[1]);
				//fn_insertMas();	// 마감 프로시져 정상처리후 사업장일마감 MAS_CLOSE_MGMT 테이블에 INSERT
				fn_search();
				
			//실패
			}else{
				gfn_alert("["+arrRetVal[0]+"] "+arrRetVal[1]);
			}
		    break;
		    
		//case "beforeDt" :
			// 기획승인 완료여부 체크 : 2015.10.16 추가
		//    fn_searchApprv();
		//    break;
    }
}

//같은 RCP 색칠 ..그리드에 적용
function fn_color(receiptNum){
	if(edtReceiptNum.value == receiptNum){
		
		return "#FAF4C0";
	}
}

/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 팝업 검색 후 호출 메소드( 업장 데이터에 값 세팅)
 *---------------------------------------------------------------------------------------------*/

//MU가 변경될 때에 대한 이벤트
function fn_muItemChangedEvent(obj, evt)
{
    edt_tmNm.setTmCode("");
    edt_upjangNm.setUpjangCode("");
    
    if(obj.value == "2001"){
	    ds_search.setColumn(0, "sysClass", "15");
	}else if(obj.value == "2003"){
	    ds_search.setColumn(0, "sysClass", "12");
	}else if(obj.value == "2002"){
		ds_search.setColumn(0, "sysClass", "11");
	}
	
	fn_comCode("ds_advanceClass","ADVANCE_CLASS");//선수금 구분
	
    return true;
}

//TM이 변경될 때에 대한 이벤트
function fn_tmChangedEvent(obj, data)
{
    edt_upjangNm.setUpjangCode("");
    return true;
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 선수금 구분이 식권 일경우 [식권 판매 관리]  조회
 *---------------------------------------------------------------------------------------------*/
function fn_ticketsearchDetail(){

    // Grid sort 표시 초기화(필수)
    //return;
    var strSvcID    = "searchTicketDetail";
    var strURL      = "fs/fsl/upjangMealTicketRegMgnt/ticketHistory.xdo";
    var strInDs     = "ds_search=ds_search";
    var strOutDs    = "ds_list_ticketD=ds_list_ticketD";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);

}
/*----------------------------------------------------------------------------------------------
 * 설명		: 사업장 CC_CD 조회 및 생성 
 *---------------------------------------------------------------------------------------------*/
function fn_upjangCcCdInfo(){

	if(ds_search.getColumn(0, "upjangCd") != "" && ds_search.getColumn(0, "upjangCd") != null){
		gfn_transaction(this
					,"selectUpjangCcCdInfo"
					,"fs/fsl/upjangSaleRegMgnt/selectUpjangCcCdInfo.xdo"
					,"ds_search=ds_search"
					,"ds_cccd=ds_cccd"
					,""
					,"fn_callBack"
					,false);
	}
	
	fn_comCode("ds_cardlist","CARD_LIST","Y");//카드사
	
}
/*----------------------------------------------------------------------------------------------
 * 설명		: 식권팝업용 번호를  생성한다
 *---------------------------------------------------------------------------------------------*/
function fn_tmpSeq(){
    gfn_transaction(this
					,"selectTmpSeq"
					,"fs/fsl/upjangSaleRegMgnt/selectTmpSeq.xdo"
					,"ds_search=ds_search"
					,"ds_tmpSeq=ds_tmpSeq"
					,""
					,"fn_callBack"
					,false);
}
/*----------------------------------------------------------------------------------------------
 * 설명		: 삭제전 매출등록 여부 확인
 *---------------------------------------------------------------------------------------------*/
function fn_selectSaleRegMgnt(nRow){
	ds_search.setColumn(0, "occurAdvanceNum", ds_list.getColumn(nRow, "occurAdvanceNum"));
	ds_search.setColumn(0, "ticketEndnum", ds_list.getColumn(nRow, "ticketEndnum"));
	ds_search.setColumn(0, "itemCd", ds_list.getColumn(nRow, "itemCd"));
	ds_search.setColumn(0, "receiptNum", ds_list.getColumn(nRow, "receiptNum"));
    gfn_transaction(this
					,"selectSaleRegMgnt"
					,"fs/fsl/upjangMealTicketRegMgnt/selectSaleRegMgnt.xdo"
					,"ds_search=ds_search"
					,"ds_saleRegMgnt=ds_saleRegMgnt"
					,""
					,"fn_callBack"
					,false);
}

/*----------------------------------------------------------------------------------------------
 * 설명		: 마감여부조회
 *---------------------------------------------------------------------------------------------*/
function fn_beforeDt(){
	gfn_transaction(this
					,"beforeDt"
					,"fs/fsl/upjangMealTicketRegMgnt/beforeDt.xdo"
					,"ds_search=ds_search"
					,"ds_beforeDt=ds_beforeDt"
					,""
					,"fn_callBack"
					,false);
}

/*----------------------------------------------------------------------------------------------
 * 설명		: 입금처리여부조회
 *---------------------------------------------------------------------------------------------*/
function fn_beforeRv(){
	//alert(ds_search.getColumn(0, "advanceNum")) ;
	gfn_transaction(this
					,"beforeRv"
					,"fs/fsl/upjangMealTicketRegMgnt/beforeRv.xdo"
					,"ds_search=ds_search"
					,"ds_beforeRv=ds_beforeRv"
					,""
					,"fn_callBack"
					,false);
}


/*----------------------------------------------------------------------------------------------
 * 설명		: 전일자 마감여부조회
 *---------------------------------------------------------------------------------------------*/
function fn_beforeDt2(){

	// 조회전 데이터셋 클리어
	ds_beforeDt2.clearData();
	
	// 전일자 체크는 10월 1일 기준으로 체크
	if(ds_search.getColumn(0, "occurDate") == "20151001") return;
	
	gfn_transaction(this
					,"beforeDt2"
					,"fs/fsl/upjangSaleRegMgnt/beforeDt2.xdo"
					,"ds_search=ds_search"
					,"ds_beforeDt2=ds_beforeDt2"
					,""
					,"fn_callBack"
					,false);
}

/*----------------------------------------------------------------------------------------------
 * 설명		: 사업장 오픈일자 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchOpenDate(){

	if(ds_search.getColumn(0, "upjangCd") != "" && ds_search.getColumn(0, "upjangCd") != null){
		gfn_transaction(this
						,"searchOpenDate"
						,"fs/fsl/upjangSaleRegMgnt/searchOpenDate.xdo"
						,"ds_search=ds_search"
						,"ds_openDate=ds_openDate"
						,""
						,"fn_callBack"
						,false);
	}
}

/************************************************************************************************
 * 설명      : 가수금 조회 팝업
************************************************************************************************/
function fn_suspensePop()
{
	/*
	<Col id="buCd">2000</Col>
			<Col id="buNm">한화&#32;FC</Col>
			<Col id="sapSuspenseNum">1500068863</Col>
			<Col id="receiveDate">20150604</Col>
			<Col id="bankCd">011</Col>
			<Col id="bankCdNm">한미은행</Col>
			<Col id="bankAcctNo">0BA6C440759F3DBE7AD25CA4E29B93D2</Col>
			<Col id="currency">KRW</Col>
			<Col id="receiveGuestNm">신한64767858</Col>
			<Col id="ccCd">300321</Col>
			<Col id="ccNm">프레스센터프레스클럽점</Col>
			<Col id="muCd">2003</Col>
			<Col id="muNm">외식사업부</Col>
			<Col id="sapSlipNum">2900054362</Col>
			<Col id="classCd"/>
			<Col id="notesPublishDate"/>
			<Col id="notesExpireDate"/>
			<Col id="notesNum"/>
			<Col id="publisherNm"/>
			<Col id="recdStatus">L</Col>
			<Col id="receiveAmt">33785430</Col>
			<Col id="applyAmt">1</Col>
			<Col id="balAmt">33785429</Col>
			<Col id="altNum"/>
			<Col id="altSeq"/>
			<Col id="advanceNum"/>
			<Col id="acctCd"/>
			<Col id="custCd"/>
			<Col id="custNm"/>
			<Col id="suspenseAltType"/>
			<Col id="suspenseAltTypeNm"/>
			<Col id="altDate"/>
			<Col id="sapCustCd"/>
			<Col id="sapSendYn"/>
			<Col id="altType"/>
			<Col id="chk">1</Col>
			<Col id="remark">신한가맹점</Col>
			<Col id="rowStatus"/>
			*/
	//ds_search.setColumn(0,"ccCd" , "300136");  //테스트용
	var arrArg = new Array();
	//조회 조건값을 다시 팝업으로 전달.
	arrArg[0] = ds_search.getColumn(0, "muCd");
	arrArg[1] = ds_search.getColumn(0, "muNm");
	arrArg[2] = ds_search.getColumn(0, "schTm");
	arrArg[3] = ds_search.getColumn(0, "schTmNm");
	arrArg[4] = ds_cccd.getColumn(0, "ccCd");
	arrArg[5] = ds_cccd.getColumn(0, "ccNm");
	arrArg[6] = gfn_subStr(ds_search.getColumn(0, "occurDate"),0,6)		//gfn_getYear(cal_occurDate.value)+gfn_getMonth(cal_occurDate.value);
	arrArg[8] = Number(msk_Amt.value);
	arrArg[9] = "UpjangMealTicketRegMgnt";
	//입금일자와 가수금 입금월 비교 추가 20180524 김호석(양경민 요청) -- 다른곳에서도 사용하는 팝업으로 변수값 확인 필요
	arrArg[10] = gfn_subStr(ds_search.getColumn(0, "occurDate"),0,6)	
	
	var strId       = "SuspensePopup";
	var strURL      = "X_SAR::SuspenseDescInquiry.xfdl";
	var objArgument = {arrSchVal:arrArg}; 
	var nWidth      = -1;
	var nHeight     = -1;
	var strStyle    = "";	
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	var bResizable  = true;

 	var arr = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
 
    //trace(arr.saveXML()); 
 
	//계좌가 멀티일때 처리되도록 수정 2017.10.19 김호석 선조치 시작
 	var cCnt = arr.rowcount;
 	//alert(cCnt);
 	var addrw=0;
 	var sumAmt = 0;
 	for(var i=0; i<cCnt; i++){ 	
		sumAmt = sumAmt + arr.getColumn(i, "applyAmt");  	
	}
	
  	//alert(sumAmt);
  	if(Number(msk_Amt.value) != Number(sumAmt)){
		gfn_alert("입력한 금액과 가수금 금액이 다릅니다,\n가수금을 다시 입력하세요.");
		//edt_bankInfo.value = "";
		return false;
	}
 	
  	for(var i=0; i<cCnt; i++){
		
		if (cCnt == 1) {
			suspenseAmt =  arr.getColumn(0, "applyAmt");
			ds_list.setColumn(ds_list.rowposition, "settleRefInfo", arr.getColumn(0, "sapSuspenseNum"));	
			ds_list.setColumn(ds_list.rowposition, "amt", suspenseAmt);
			ds_list.setColumn(ds_list.rowposition, "varSusAmt", suspenseAmt);
		} else {
			ds_list.setColumn(ds_list.rowposition, "uprice", arr.getColumn(i, "applyAmt"));                  //단가
			ds_list.setColumn(ds_list.rowposition, "amt", arr.getColumn(i, "applyAmt"));	                 //금액
			ds_list.setColumn(ds_list.rowposition, "varSusAmt", arr.getColumn(i, "applyAmt"));
			ds_list.setColumn(ds_list.rowposition, "settleRefInfo", arr.getColumn(i, "sapSuspenseNum"));	 //가수금번호
		}
		
		//마지막이 아닌 경우 한줄 추가(복사)
		if (i < cCnt-1) {
			addrw=ds_list.addRow();
			ds_list.copyRow(addrw, ds_list, 0);			
		}
  	}
  	//계좌가 멀티일때 처리되도록 수정 2017.10.19 김호석 선조치 끝
  	
  	/*
	if(arr != undefined){
		suspenseAmt =  arr.getColumn(0, "applyAmt");
		if(Number(msk_Amt.value) != Number(suspenseAmt)){
			gfn_alert("입력한 금액과 가수금 금액이 다릅니다,\n가수금을 다시 입력하세요.");
			//edt_bankInfo.value = "";
			return false;
		}
		ds_list.setColumn(ds_list.rowposition, "settleRefInfo", arr.getColumn(0, "sapSuspenseNum"));	
		ds_list.setColumn(ds_list.rowposition, "amt", suspenseAmt);
		ds_list.setColumn(ds_list.rowposition, "varSusAmt", suspenseAmt);
	}
	*/
	
}

/************************************************************************************************
 * 설명      : 식권 관리 팝업
************************************************************************************************/
function fn_ticketPopup(){
	if(ds_list.getColumn(ds_list.rowposition, "custCd") == "" || ds_list.getColumn(ds_list.rowposition, "custCd") == null){
		gfn_alert("고객사는 필수입력 입니다.");
		//edt_custnm.setFocus();
		return;
	}
	if(cboGubun.value == "" || cboGubun.value == null){
		gfn_alert("구분은 필수입력 입니다.");
		//cboGubun.setFocus();
		return;
	}
	if(msk_Uprice.value == "" || msk_Uprice.value == null){
		gfn_alert("단가는 필수입력 입니다.");
		//msk_Uprice.setFocus();
		return;
	}
	if(msk_Qty.value == "" || msk_Qty.value == null){
		gfn_alert("식수는 필수입력 입니다.");
		//msk_Qty.setFocus();
		return;
	}
	if(cboSettleClass.value == "" || cboSettleClass.value == null){                
		gfn_alert("결재유형은 필수입력 입니다.");
		//cboSettleClass.setFocus();
		return;
	}
	var arrArg = new Array();
	//조회 조건값을 다시 팝업으로 전달.
	arrArg[0] = ds_search.getColumn(0, "upjangCd");
	arrArg[1] = ds_list.getColumn(ds_list.rowposition, "advanceClass");
	arrArg[2] = cboGubun.text;
	arrArg[3] = ds_list.getColumn(ds_list.rowposition, "qty");
	arrArg[4] = ds_list.getColumn(ds_list.rowposition, "uprice");
	arrArg[5] = ds_search.getColumn(0, "taxShetPublishYn");
	arrArg[6] = edt_tmpSeq.value;
	arrArg[7] = ds_search.getColumn(0, "occurDate");
	arrArg[8] = txt_etc.value;
	arrArg[9] = ds_list.getColumn(ds_list.rowposition, "custCd");
	arrArg[10] = ds_search.getColumn(0, "muCd");
	//arrArg[11] = ds_search.getColumn(0, "occurDate"); // 팝업에 등록날짜 전송
	
	var strId       = "UpjangMealTicketMgntPopup";
	var strURL      = "X_FSL::UpjangMealTicketMgntPopup.xfdl";
	var objArgument = {arrSchVal:arrArg}; 
	var nWidth      = -1;
	var nHeight     = -1;
	var strStyle    = "";	
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	var bResizable  = true;
 	
 	var arr = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
  	if(arr != undefined){
 		ds_list.setColumn(ds_list.rowposition,"itemCd",arr["itemCode"]);
 		ds_list.setColumn(ds_list.rowposition,"itemNm",arr["itemCodenm"]);
 		ds_list.setColumn(ds_list.rowposition,"taxShetPublishYn",arr["taxShetPublishYn"]);
 		
 		fn_save();
  	}		
}
function btn_edt_ticket_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_ticketPopup();
}

function edt_ticket_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 13){
		fn_ticketPopup();
	}
}

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/

/*----------------------------------------------------------------------------------------------
 * 설명      : obj enable 컨트롤
 *---------------------------------------------------------------------------------------------*/
function fn_enable(obj,value,del){
	obj.enable = value;
	if(!value && del){//값 제거
		if(!gfn_isNull(obj.value))obj.value = null;
		if(!gfn_isNull(obj.text))obj.text = null;
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 구분 변경
 *---------------------------------------------------------------------------------------------*/
function fn_Gubun(advanceClass , del){
	if(del != true)del = false;
	if(cboGubun.enable == true){
		if(advanceClass == "001" || advanceClass == "002"){//식권
			edt_custnm.enable = true;//고객사
			cboGubun.enable = true;//구분
			edtPost.enable = true;//창고
			btn_postPopup.enable = true;//창고버튼
			cboSettleClass.enable = true;//결재유형
			cboEncClass.enable = true;//카드사
			msk_Qty.enable =true;//식수
			msk_Uprice.enable =true;//단가
			//msk_Amt.enable =true;//금액
			//edt_ticket.enable =true;//자재명
			btn_edt_ticket.enable =true;//자재명
			txt_etc.enable = true;//비고		
		}else if(advanceClass == "003"){//일반
			edt_custnm.enable = true;//고객사
			cboGubun.enable = true;//구분
			edtPost.enable = true;//창고
			btn_postPopup.enable = true;//창고버튼
			cboSettleClass.enable = true;//결재유형
			cboEncClass.enable = true;//카드사
			msk_Qty.enable = true;//식수
			msk_Uprice.enable = true;//단가
			//msk_Amt.enable = true;//금액
			//edt_ticket.enable = false;//자재명
			btn_edt_ticket.enable = false;//자재명
			txt_etc.enable = true;//비고
		}
	}
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 구분값 변경 이벤트.
 *---------------------------------------------------------------------------------------------*/
function cboGubun_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	ds_list.setColumn(ds_list.rowposition,"advanceClass", e.postvalue);
	
	//자재코드 초기화
	edt_ticket.value = "";

	//dealType 세팅
	if(obj.value == "001"){//선수식권
		edt_ticket.enable = true;
		btn_edt_ticket.enable = true;
		msk_Uprice.readonly = false;
 		msk_Qty.readonly = false;
		ds_list.setColumn(ds_list.rowposition,"dealType", "6");
		ds_search.setColumn(0, "itemType", "001");
		ds_signClass.filter(" set1 == '1' || set1 == '2' || set1 == '3' ");
		msk_Uprice.value = "";
		msk_Qty.value = "";
		msk_Amt.value = "";
		//msk_Amt.enable = false;
		ds_search.setColumn(0, "taxShetPublishYn", "");
	}else if(obj.value == "002"){//외상식권
		edt_ticket.enable = true;
		btn_edt_ticket.enable = true;
		cboEncClass.value = "";
		cboEncClass.enable = false;
		msk_Uprice.readonly = false;
 		msk_Qty.readonly = false;		
		ds_list.setColumn(ds_list.rowposition,"dealType", "6");
		ds_search.setColumn(0, "itemType", "002");
		ds_signClass.filter(" set1 == '7' ");
		cboSettleClass.value = "7";
		msk_Uprice.value = "";
		msk_Qty.value = "";
		msk_Amt.value = "";
		//msk_Amt.enable = false;
		ds_search.setColumn(0, "taxShetPublishYn", "");
	}else if(obj.value == "003"){//외상식권
		ds_list.setColumn(ds_list.rowposition,"dealType", "2");
		ds_search.setColumn(0, "itemType", "");
		ds_signClass.filter(" set1 == '1' || set1 == '2' || set1 == '3' ");
		msk_Uprice.readonly = false;
 		msk_Qty.readonly = false;
		edt_ticket.value = "";
		edt_ticket.enable = false;
		btn_edt_ticket.enable = false;
		
		msk_Uprice.value = "";
		msk_Qty.value = "";
		msk_Amt.value = "";
		//msk_Amt.enable = true;
		ds_search.setColumn(0, "taxShetPublishYn", "");
	}else{//004 교환식권
		ds_list.setColumn(ds_list.rowposition,"dealType", "2");
		ds_search.setColumn(0, "itemType", "");
		ds_signClass.filter(" set1 == '1' || set1 == '2' || set1 == '3' ");
		
		edt_ticket.value = "";
		edt_ticket.enable = false;
		btn_edt_ticket.enable = false;
		
		msk_Uprice.value = "";
		msk_Qty.value = "";
		msk_Amt.value = "";
		//msk_Amt.enable = true;
		//교환식권 세금게산서 발행 가능해야함(선택적, 개인이 아닌 거래처인 경우) 2017.07.04 김성권대리 확인	
		ds_search.setColumn(0, "taxShetPublishYn", "Y");
		//ds_search.setColumn(0, "taxShetPublishYn", "N");
		
		fn_chgTicket();
	}
	
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 결제 유형 변경 이벤트.
 *---------------------------------------------------------------------------------------------*/
function cboSettleClass_oncloseup(obj:Combo, e:ComboCloseUpEventInfo)
{
	//자재코드 초기화
	edt_ticket.value = "";
	
	if(cboSettleClass.value == "2"){ // 카드
		fn_comCode("ds_cardlist","CARD_LIST","Y");//카드사
		if(cboGubun.value == "001"){//선수식권 카드 결재면 부가세 Y 선택 불가
			ds_search.setColumn(0, "taxShetPublishYn", "N");
		}
	}else{
		ds_search.setColumn(0, "taxShetPublishYn", "");
	}
	
	
	if(cboSettleClass.value == "3"){ // 가수금
	
		//if(ds_search.getColumn(0,"occurDate") > '20201130'){
			//alert("12월 일자로 가수금 처리 불가(물리적 분리로 SAP처리 불가)");
			//return false;
		//} else {
			//msk_Amt.enable = false;
			edt_bankInfo.value = "";
			//fn_enable(edt_bankInfo,true); 		//계좌번호
			fn_suspensePop();
		//}
		
	}else{
		//msk_Amt.enable = true;
	}
	
	ds_list.setColumn(ds_list.rowposition,"settleClass", e.postvalue);
	fn_settleclass(e.postvalue);
}

/*----------------------------------------------------------------------------------------------
 * 설명      :  결제 유형에 따라 입력 항목 변경(cboGubun.value = 식권001 002/일반003)
 *---------------------------------------------------------------------------------------------*/
function fn_settleclass(settle){
	if(cboSettleClass.enable == true){
		if(settle == "1"){//-> 결재유형(현금) - (???)창고/자재명/고객사/금액/식수/계좌번호/적요만 활성화
			cboEncClass.value = "";
			cboEncClass.enable = false;//카드사
		}else if(settle == "7"){//외상
			cboEncClass.value = "";
			cboEncClass.enable = false;//카드사
		}else if(settle == "2"){//-> 결재유형(카드) - (???)창고/자재명/매입카드사/금액/적요만 활성화
			cboEncClass.enable = true;//카드사
		}else if(settle == "3"){//-> 가수금 - (???)창고/자재명/고객사/금액/식수/적요만 활성화 + CMS조회 팝업
			cboEncClass.value = "";
			cboEncClass.enable = false;//카드사
		}
	}

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 그리드 클릭 이벤트
 *---------------------------------------------------------------------------------------------*/
function grd_list_oncellclick(obj:Grid, e:GridClickEventInfo)
{
			
	if(obj.getCellProperty('Body',e.cell,'text') == "bind:recvDlng"){
			if(ds_list.getColumn(e.row,"recvDlng")=="Y")fn_RcvyDlng();
	}
		
	if(obj.getCellProperty('Body',e.cell,'text') == "bind:saleRcvy"){
			if(ds_list.getColumn(e.row,"saleRcvy")=="Y")fn_saleRcvy();
	}	
	
	if(obj.getCellProperty('Body',e.cell,'text') == "bind:taxYn"){
			if(ds_list.getColumn(e.row,"taxYn")=="Y")fn_publishYnPop(ds_list);
	}	
			
			
	fn_click(e.row);
}

function ds_list_onrowposchanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
		var eRow = e.newrow;
		//fn_click(eRow);
}

function fn_click(row){
	
	//삭제만 가능
	var advanceNum = ds_list.getColumn(row, "occurAdvanceNum");
	if(advanceNum != null && advanceNum != "" && advanceNum != undefined){
		edt_custnm.enable = false;//고객사
		cboGubun.enable = false;//구분
		edtPost.enable = false;//창고
		btn_postPopup.enable = false;//창고버튼
		cboSettleClass.enable = false;//결재유형
		cboEncClass.enable = false;//카드사
		msk_Qty.enable = false;//식수
		msk_Uprice.enable = false;//단가
		//msk_Amt.enable = false;//금액
		//edt_ticket.enable = false;//자재명
		btn_edt_ticket.enable = false;//자재명
		txt_etc.enable = false;//비고
	}else{
		edt_custnm.enable = true;//고객사
		cboGubun.enable = true;//구분
		edtPost.enable = true;//창고
		btn_postPopup.enable = true;//창고버튼
		cboSettleClass.enable = true;//결재유형
		cboEncClass.enable = true;//카드사
		msk_Qty.enable = true;//식수
		msk_Uprice.enable = true;//단가
		//msk_Amt.enable = true;//금액
		//edt_ticket.enable = true;//자재명
		btn_edt_ticket.enable = true;//자재명
		txt_etc.enable = true;//비고
	}
	
	sRow = row;//현재 선택 Row값 저장
	if(!gfn_isNull(ds_list.getColumn(row, "custNm"))){
		edt_custnm.userData = ds_list.getColumn(row, "custNm");//고객사 명 셋팅.
	}
	//구분
	fn_Gubun(ds_list.getColumn(row,"advanceClass") , true);
	
	//결제유형
	fn_settleclass(ds_list.getColumn(row,"settleClass"));
	
	if(ds_list.getColumn(row, "advanceClass") == "001" || ds_list.getColumn(row, "advanceClass") == "002"){
		if(ds_list.getColumn(row, "itemCd") != "" && ds_list.getColumn(row, "itemCd") != null){
			ds_search.setColumn(0, "itemCd", ds_list.getColumn(row, "itemCd"));
			fn_ticketsearchDetail();//식권판매 관리 조회

		}
	}else{
		ds_list_ticketD.clearData();
	}

}


/*----------------------------------------------------------------------------------------------
 * 설명      : 수량 단가 변경시 금액 계산.
 *---------------------------------------------------------------------------------------------*/
function ds_list_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if(e.columnid == "qty" || e.columnid == "uprice"){
		if(!gfn_isNull(msk_Qty.value) && !gfn_isNull(msk_Uprice.value)){
			if(!gfn_isNull(ds_list.getColumn(sRow,"qty")) && !gfn_isNull(ds_list.getColumn(sRow,"uprice"))){
				var amt = Number(ds_list.getColumn(sRow,"qty")) * Number(ds_list.getColumn(sRow,"uprice"));
				ds_list.setColumn(sRow,"amt",amt);
				msk_Amt.value = amt;
			}
		}
		edt_ticket.value = "";
		edt_bankInfo.value = "";
	}
}

/************************************************************************************************
 * 설명      :  조회 여부 확인
************************************************************************************************/
function fn_searchboolean(){
	if(searchboolean){
		return false;
	}else{
		gfn_alert("조회 후 실행해 주세요.");
		return true;
	}	
}

/************************************************************************************************
 * 설명      :  카드정보 세팅
************************************************************************************************/
function cboEncClass_oncloseup(obj:Combo, e:ComboCloseUpEventInfo)
{
	ds_list.setColumn(ds_list.rowposition, "cardComCd", ds_cardlist.getColumn(e.row, "bankCd"));
	ds_list.setColumn(ds_list.rowposition,"frncStorNum",ds_cardlist.getColumn(e.row, "frncStorNum"));
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 검색 조건 변경전 데이터 초기화 여부 확인
 *---------------------------------------------------------------------------------------------*/
function ds_search_cancolumnchange(obj:Dataset, e:DSColChangeEventInfo)
{
	if(ds_list.getRowCount() > 0){
		if(e.columnid == "muCd" || e.columnid == "schTm" || e.columnid == "upjangCd" || e.columnid == "occurDate"){			
			if(gfn_confirm("confirm.before.search")){
				ds_list.clearData();
				searchboolean = false;
			}else{
				return false;
			}
		}
	}	
	return true;
}



function div_Ticket_btn_fullScreen_onclick(obj:Button,  e:ClickEventInfo)
{
    if (div_Ticket.btn_fullScreen.text == "원래대로") 
    {
		div_Ticket.position.top = "533px";
		div_Ticket.btn_fullScreen.text = "전체화면";
		div_Ticket.btn_fullScreen.text = "전체화면";
		Div_list.visible = true;
    }
    else 
    {
		div_Ticket.position.top = "84px";
		div_Ticket.btn_fullScreen.text = "원래대로";
		div_Ticket.btn_fullScreen.text = "원래대로";
		Div_list.visible = false;
	}		
}


/*********************************************************************
*설명      : 엔터 이벤트
**********************************************************************/
//달력 엔터 - 조회
function cal_occurDate_onkeydown(obj:ObjCalendar, e:KeyEventInfo)
{
	if(e.keycode == 13){			
		fn_search();
	}
}

//적요 저장
function txt_etc_onkeydown(obj:Edit, e:KeyEventInfo)
{
	//if(e.keycode == 13 && gfn_isNull(txt_etc.value)){
	//엔터처리 시 저장 되도록 처리 20180611 김호석(문재현대리 요청)
	if(e.keycode == 13){
		//자재코드가 비활성화일경우만 바로 저장 아닌경우는 자재코드 팝업 띄우기
		if (edt_ticket.enable) {
			//자재코드 팝업 띄우기
			fn_ticketPopup();
		} else {
			var rtVal = gfn_confirm("선택된 자료를 등록하시겠습니까?");	// 선택된 자료를 등록 하시겠습니까?
			if(rtVal){
				fn_save();
			}
		}
 	}
 	else
 	{
		txt_etc.setFocus();
 	}
}

//창고 조회
function edtPost_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 13){
		btn_postPopup.click();
	}
}

function btn_close_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_search.getColumn(0, "sysClass") == "15"){
		gfn_openMenuForm("MAG10120E.xfdl","U_MAG","","사업장일마감관리");
	}else if(ds_search.getColumn(0, "sysClass") == "11"){
		gfn_openMenuForm("MAG10120E.xfdl","U_MAG","","사업장일마감관리");
	}else if(ds_search.getColumn(0, "sysClass") == "12"){
		gfn_openMenuForm("CloseMgnt01.xfdl","X_RCM","","일마감");
	}
}

function ds_search_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	// 기획승인이 완료되었는지 체크
	if(e.columnid == "occurDate"){
		fn_searchApprv();
	}
}

/*------------------------------------------------------------------
 * 설 명  : 사업장일마감 기획승인이 완료되었는지 체크
 *----------------------------------------------------------------*/
function fn_searchApprv(){
	// 기획승인이 완료되었는지 체크
	if(gfn_isNull(edt_upjangNm.getUpjangCode())){
		gfn_alert("사업장은 필수입력 사항 입니다.");
		return;
	}else{
		var strSvcID    = "searchApprv";
		var strURL      = "/fs/fsl/upjangMealTicketRegMgnt/selectApprv.xdo";
		var strInDs     = "ds_search=ds_search:A";
		var strOutDs    = "ds_apprv=ds_apprv";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}
}
/*-----------------------------------------------------------
 * 설 명 : 건별추가 버튼 클릭 이벤트
 *----------------------------------------------------------*/
function btn_add_onclick(obj:Button,  e:ClickEventInfo)
{
	//if(ds_apprv.getColumn(0, "apprvYn") == "Y"){
		// 건별추가시 insert 구분자 "add"로 추가
		fn_add("add");
	//}else{
	//	gfn_alert("건별추가를 할 수 없습니다.\n\n기획승인 여부를 확인해주세요.");
	//	return false;
	//}
}

/*-------------------------------------------------------------------
 * 설 명 : 건별삭제 버튼 클릭 이벤트
 *------------------------------------------------------------------*/
function btn_delete_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_list.rowposition < 0 ){
		gfn_alert("삭제할 목록이 없습니다");
		return false;
	}
	
	for(var i=0; i<ds_list.rowcount; i++){
		if(ds_list.getColumn(i, "receiptNum") == undefined){
			if(i != ds_list.rowposition){
				gfn_alert("작성중인 데이터가 있습니다.\n삭제는 저장 후 가능합니다");
				return false;
			}
		}
	}
	
	// 입금처리한 내역이 있는지 확인하기 위해 추가 20190108 김호석
	ds_search.setColumn(0, "advanceNum", ds_list.getColumn(ds_list.rowposition,"advanceNum"));
	
	// 해당월이 월마감이 된경우 매출등록을 할 수 없다.
	mfn_GetClsStatus(gfn_subStr(cal_occurDate.fn_getValue(), 0, 6));
	if (ds_common.rowcount > 0)
	{
		g_Message("EE", "해당월은 월마감이 완료되어 삭제가 불가합니다.");
		return false;
	}
	
	if(ds_list.getColumn(ds_list.rowposition, "occurAdvanceNum") != "" && ds_list.getColumn(ds_list.rowposition, "occurAdvanceNum") != null
		&& ds_list.getColumn(ds_list.rowposition, "occurAdvanceNum") != undefined){
		fn_selectSaleRegMgnt(ds_list.rowposition);//매출등록 여부 확인
		
		if(ds_list.getColumn(ds_list.rowposition, "occurAdvanceNum") == ds_saleRegMgnt.getColumn(0, "occurAdvanceNum")){
			gfn_alert("매출등록이 되어 삭제할 수 없습니다.");
			return;
		}
		if(ds_list.getColumn(ds_list.rowposition, "advanceClass") == "001" || ds_list.getColumn(ds_list.rowposition, "advanceClass") == "002"){
			if(ds_saleRegMgnt.getColumn(0, "maxTicketEndnum") != null && ds_saleRegMgnt.getColumn(0, "maxTicketEndnum") != ""
				&& ds_saleRegMgnt.getColumn(0, "maxTicketEndnum") != undefined){
				gfn_alert("이후에 판매된 식권이존재하여 삭제할 수 없습니다.");
				return;
			}
		}
	}
	
	
	//if(ds_apprv.getColumn(0, "apprvYn") != "Y"){
	//	gfn_alert("건별삭제를 할 수 없습니다.\n\n기획승인 여부를 확인해주세요.");
	//	return false;
	//}
	
	// 삭제하려는 로우가 추가된 행일때
	if(ds_list.getRowType(ds_list.rowposition) == 2){
		var rtVal = gfn_confirm("confirm.before.delete");	// 선택된 자료를 삭제 하시겠습니까?
		if(rtVal){
			if(ds_list_ticket.rowcount > 0){
				for(var i = ds_list_ticket.rowcount-1; i >= 0; i--){
					if(ds_list_ticket.getColumn(i, "tmpSeq") == edt_tmpSeq.value){
						ds_list_ticket.deleteRow(i);
					}
				}
			}
			ds_list.deleteRow(ds_list.rowposition);
		}else{
			return false;
		}
	}else{
		// 건별삭제시 프로시져 호출(건별삭제는 일마감이 완료된건에 한해서만 삭제가 가능)
		if(ds_list.getColumn(ds_list.rowposition, "ddddCloseYn") == "Y"){
			var rtVal = gfn_confirm("confirm.before.delete");	// 선택된 자료를 삭제 하시겠습니까?
			if(rtVal){
				ds_list.deleteRow(ds_list.rowposition);
				if(ds_list_ticket.rowcount > 0){
					for(var i = ds_list_ticket.rowcount-1; i >= 0; i--){
						if(ds_list_ticket.getColumn(i, "tmpSeq") == edt_tmpSeq.value){
							ds_list_ticket.deleteRow(i);
						}
					}
				}
			}else{
				return false;
			}
			
			// 입금처리한 내역이 있는지 확인하기 위해 추가 20190108 김호석
			// 건별삭제할때 마감/입금처리여부 체크
			if(!fn_validChk()) return;
			
			var strSvcID    = "closeProc";
			var strURL      = "/fs/fsl/upjangMealTicketRegMgnt/modifySalsN.xdo";
			var strInDs     = "ds_list=ds_list:U";
			var strOutDs    = "";
			var strArg      = "";
			var strCallback = "fn_callBack";
			var bAsync      = true;
			
			gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
			
		}else{
			gfn_alert("건별삭제는 일마감이 완료된건만 가능합니다");
			return false;
		}
	}
}

function fn_validChk(){
	fn_beforeDt();//마감여부 조회
	
	//if(ds_list.getColumn(ds_list.rowposition, "modifySalsYn") != "A" || ds_list.getRowType(ds_list.rowposition) == 4){
		for(var i=0; i<ds_beforeDt.rowcount; i++){
			if(ds_beforeDt.getColumn(i, "dtCnt") == "N"){
				gfn_alert("미마감건이 존재하여 건별삭제를 할 수 없습니다..");
				fn_search();
				return false;
			}
		}
	fn_beforeRv();//입금처리여부 조회	
	//alert("rvCnt : " + ds_beforeRv.getColumn(0,"rvCnt"));			
	if(ds_beforeRv.getColumn(0, "rvCnt") == "Y"){
		gfn_alert("입금처리건이 존재하여 건별삭제를 할 수 없습니다..");
		fn_search();
		return false;
	}
		
	return true;
	
}
function btn_fullScreen_onclick(obj:Button,  e:ClickEventInfo)
{
	if (Div_list.btn_fullScreen.text == "원래대로") 
    {
		Div_list.position.bottom = "418";
		Div_list.btn_fullScreen.text = "전체화면";
		Div_list.anchor = "left top right";
		//btn_fullScreen.text = "전체화면";
		//div_Ticket.visible = true;
		//Static42
    }
    else 
    {
		Div_list.position.bottom =  form.position.height - 30;
		Div_list.btn_fullScreen.text = "원래대로";
		Div_list.anchor = "all";
		//div_Ticket.visible = false;
		//btn_fullScreen.text = "원래대로";
	}
}



function fn_saleRcvy(){
	var arrArg = new Array();
	//조회 조건값을 다시 팝업으로 전달.
	arrArg[0] = ds_search.getColumn(0, "upjangCd");
	arrArg[1] = ds_search.getColumn(0, "occurDate");
	arrArg[2] = ds_list.getColumn(ds_list.rowposition, "occurAdvanceNum");
	
	var strId       = "UpjangMealSaleRcvyPopup";
	var strURL      = "X_FSL::UpjangMealSaleRcvyPopup.xfdl";
	var objArgument = {arrSchVal:arrArg}; 
	var nWidth      = -1;
	var nHeight     = -1;
	var strStyle    = "";	
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	var bResizable  = true;
 	
 	var arr = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
  	if(arr != undefined){
 		ds_list.setColumn(ds_list.rowposition,"itemCd",arr["itemCode"]);
 		ds_list.setColumn(ds_list.rowposition,"itemNm",arr["itemCodenm"]);
 		ds_list.setColumn(ds_list.rowposition,"taxShetPublishYn",arr["taxShetPublishYn"]);
  	}
}

function fn_RcvyDlng(){
	var arrArg = new Array();
	//조회 조건값을 다시 팝업으로 전달.
	arrArg[0] = ds_search.getColumn(0, "upjangCd");
	arrArg[1] = ds_search.getColumn(0, "occurDate");
	arrArg[2] = ds_list.getColumn(ds_list.rowposition, "occurAdvanceNum");
	
	var strId       = "UpjangMealRcvyDlngPopup";
	var strURL      = "X_FSL::UpjangMealRcvyDlngPopup.xfdl";
	var objArgument = {arrSchVal:arrArg}; 
	var nWidth      = -1;
	var nHeight     = -1;
	var strStyle    = "";	
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	var bResizable  = true;
 	
 	var arr = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
  	if(arr != undefined){
 		ds_list.setColumn(ds_list.rowposition,"itemCd",arr["itemCode"]);
 		ds_list.setColumn(ds_list.rowposition,"itemNm",arr["itemCodenm"]);
 		ds_list.setColumn(ds_list.rowposition,"taxShetPublishYn",arr["taxShetPublishYn"]);
  	}
}

/**
	
		교환식권 리스트 팝업.
	
**/
function fn_chgTicket(){
	var arrArg = new Array();
	//조회 조건값을 다시 팝업으로 전달.
	arrArg[0] = ds_search.getColumn(0, "upjangCd");
	arrArg[1] = ds_search.getColumn(0, "muCd");
	arrArg[2] = ds_search.getColumn(0, "occurDate");
	
	var strId       = "MealTicketChgPopup";
	var strURL      = "X_FSL::MealTicketChgPopup.xfdl";
	var objArgument = {arrSchVal:arrArg}; 
	var nWidth      = -1;
	var nHeight     = -1;
	var strStyle    = "";	
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	var bResizable  = true;
 	
 	var arr = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
  	if(arr != undefined){
 		ds_list.setColumn(ds_list.rowposition,"chgSeq",arr["SEQ"]);
 		ds_list.setColumn(ds_list.rowposition,"chgDd",arr["TRANS_DD"]);
 		ds_list.setColumn(ds_list.rowposition,"uprice",arr["TR_AMT"]);
 		ds_list.setColumn(ds_list.rowposition,"amt",arr["TR_AMT"]);
 		ds_list.setColumn(ds_list.rowposition,"qty",1); 		
 		//ds_list.setColumn(ds_list.rowposition,"taxShetPublishYn","N");
 		ds_list.setColumn(ds_list.rowposition,"taxShetPublishYn",arr["TAX_SHET_PUBLISH_YN"]);
 		msk_Uprice.readonly = true;
 		msk_Qty.readonly = true;
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 세금계산서YN 팝업
 *---------------------------------------------------------------------------------------------*/
function fn_publishYnPop(obj)
{
	//cccd 조회
	//fn_upjangCcCdInfo();

	var arrArg = new Array();
	//조회 조건값을 다시 팝업으로 전달.
	arrArg[0] = "";
	arrArg[1] = obj.getColumn(obj.rowposition, "occurDate");	// occurDate 발생일자
	arrArg[2] = obj.getColumn(obj.rowposition, "advanceNum"); // 업장매출번호
	
	var strId       = "PublishYnPopup";
	var strURL      = "X_FSL::PublishYnPopup.xfdl";
	var objArgument = {arrSchVal:arrArg}; 
	var nWidth      = -1;
	var nHeight     = -1;
	var strStyle    = "";	
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	var bResizable  = true;
 	
 	var arr = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
	
}

function btn_next_onclick(obj:Button,  e:ClickEventInfo)
{
	ds_search.setColumn(0, "occurDate", gfn_addDate(ds_search.getColumn(0, "occurDate"), 1));
	fn_search();
}

function btn_prev_onclick(obj:Button,  e:ClickEventInfo)
{
	ds_search.setColumn(0, "occurDate", gfn_addDate(ds_search.getColumn(0, "occurDate"), -1));
	fn_search();
}

function cboSettleClass_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	//자재코드 초기화
	edt_ticket.value = "";
	
	if(cboSettleClass.value == "2"){ // 카드
		fn_comCode("ds_cardlist","CARD_LIST","Y");//카드사
		if(cboGubun.value == "001"){//선수식권 카드 결재면 부가세 Y 선택 불가
			ds_search.setColumn(0, "taxShetPublishYn", "N");
		}
		//첫번째 기본설정
		//ds_list.setColumn(ds_list.rowposition,"buycpnyCd",ds_cardlist.getColumn(0, "buycpnyCd"));
		
	}else{
		ds_search.setColumn(0, "taxShetPublishYn", "");
	}
	
	
	if(cboSettleClass.value == "3"){ // 가수금
	
		//if(ds_search.getColumn(0,"occurDate") > '20201130'){
			//alert("12월 일자로 가수금 처리 불가(물리적 분리로 SAP처리 불가)");
			//return false;
		//} else {
			//msk_Amt.enable = false;
			edt_bankInfo.value = "";
			//fn_enable(edt_bankInfo,true); 		//계좌번호
			fn_suspensePop();
		//}
	}else{
		//msk_Amt.enable = true;
	}
	
	ds_list.setColumn(ds_list.rowposition,"settleClass", e.postvalue);
	fn_settleclass(e.postvalue);
}

function cboGubun_onkillfocus(obj:Combo, e:KillFocusEventInfo)
{	
/*
	if (gfn_isNull(ds_list.getColumn(ds_list.rowposition, "advanceClass"))) {
		//alert("구분을 선택해주세요.");
		cboGubun.setFocus();		
		cboGubun.dropdown();
	}
*/	
}

function cboSettleClass_onkillfocus(obj:Combo, e:KillFocusEventInfo)
{
/*
	if (gfn_isNull(ds_list.getColumn(ds_list.rowposition, "advanceClass"))) {
		cboGubun.setFocus();		
		cboGubun.dropdown();
		
	} else {
		if (gfn_isNull(ds_list.getColumn(ds_list.rowposition, "settleClass"))) {
			//alert("결제 유형을 선택해주세요.");
			cboSettleClass.setFocus();				
			cboSettleClass.dropdown();	
		
		}
	}
*/
}

function cboEncClass_onkillfocus(obj:Combo, e:KillFocusEventInfo)
{
	
}
]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FMM00100E" onkeydown="frm_OnKeyDown" onload="form_onload" titletext="사업장레시피 일괄복사" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static08" class="sta_WFDA_Labelbg" position="absolute 707 61 1237 88" anchor="left top right"/>
        <Static id="Static49" class="sta_WFDA_Labelbg" position="absolute 74 61 594 88"/>
        <Static id="Static00" class="sta_WFDA_Labelbg" position="absolute 74 87 594 114"/>
        <Static id="Static01" class="sta_WFDA_Labelbg" position="absolute 74 139 594 166"/>
        <Static id="Static05" class="sta_WFDA_Labelbg" position="absolute 74 113 594 140"/>
        <Button id="btn_Left_Del" onclick="btn_Left_Del_OnClick" taborder="13" text="" position="absolute 600 469 621 490" class="btn_WF_leftMove" image=""/>
        <Button id="btn_Right_Add" onclick="btn_Right_Add_OnClick" taborder="11" text="" position="absolute 600 418 621 439" image="" class="btn_WF_rightMove"/>
        <Button id="btn_Search_Source" onclick="fn_SearchList" taborder="7" text="조회" position="absolute 543 35 595 56" class="btn_WF_Custom" image=""/>
        <Grid scrollbars="autoboth" binddataset="ds_Save" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="grd_upjang_recipe_list" useinputpanel="false" selecttype="multirow" oncelldblclick="grd_upjang_recipe_list_OnCellDblClick" onheadclick="grd_List_OnHeadClick" taborder="16" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 625 93 1237 686" anchor="all" autofittype="col">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30"/>
                <Column size="90"/>
                <Column size="372"/>
                <Column size="92"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" text="No."/>
                <Cell col="1" displaytype="text" text="레시피코드"/>
                <Cell col="2" displaytype="text" text="레시피명"/>
                <Cell col="3" displaytype="text" text="복사원본정보"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:right;background:EXPR(decode(EXIST_YN,'Y',strbkColor2,'N',strbkColor1));background2:EXPR(decode(EXIST_YN,'Y',strbkColor2,'N',strbkColor1));" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:center;background:EXPR(decode(EXIST_YN,'Y',strbkColor2,'N',strbkColor1));background2:EXPR(decode(EXIST_YN,'Y',strbkColor2,'N',strbkColor1));" text="bind:RECIPE_CD"/>
                <Cell col="2" displaytype="text" style="align:left;background:EXPR(decode(EXIST_YN,'Y',strbkColor2,'N',strbkColor1));background2:EXPR(decode(EXIST_YN,'Y',strbkColor2,'N',strbkColor1));" text="bind:RECIPE_NAME"/>
                <Cell col="3" displaytype="combo" style="align:center;background:EXPR(decode(EXIST_YN,'Y',strbkColor2,'N',strbkColor1));background2:EXPR(decode(EXIST_YN,'Y',strbkColor2,'N',strbkColor1));" text="bind:ORG_GBN" combodataset="ds_SType" combocodecol="CODE" combodatacol="SET1"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static2" text=": 기존에 없는 레시피" position="absolute 664 688 795 710" class="sta_WF_Bluehelp" anchor="left bottom"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" displayrowcount="15" id="cbo_UP_HALL_CLASS" innerdataset="ds_UP_HALL_CLASS" taborder="10" tooltiptext="식당군" position="absolute 1019 64 1234 85" class="cmb_WF_Essential"/>
        <Static id="Static4" text="식당군" position="absolute 946 61 1017 88" class="sta_WFDA_Label01"/>
        <Static id="Static7" text="레시피대상" position="absolute 0 61 75 88" class="sta_WFDA_Label01"/>
        <Radio codecolumn="CODE" columncount="3" datacolumn="code_name" id="rdo_Recipe_Source" index="2" innerdataset="ds_SType" onitemchanged="rdo_Recipe_Source_OnChanged" taborder="14" position="absolute 78 64 425 85"/>
        <Static id="Static3" text=": 기존에 있는 레시피" position="absolute 845 688 976 710" class="sta_WF_Bluehelp" anchor="left bottom"/>
        <Static id="st_color1" position="absolute 625 690 660 705" anchor="left bottom"/>
        <Static id="st_color2" position="absolute 807 690 842 705" anchor="left bottom"/>
        <Grid scrollbars="autoboth" binddataset="ds_list3" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="grd_list" useinputpanel="false" selecttype="multirow" oncelldblclick="grd_list_OnCellDblClick" onheadclick="grd_List_OnHeadClick" taborder="15" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 171 595 710" anchor="left top bottom" autofittype="col">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="40"/>
                <Column size="120"/>
                <Column size="320"/>
                <Column size="120"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" text="No."/>
                <Cell col="1" displaytype="text" text="레시피코드"/>
                <Cell col="2" displaytype="text" text="레시피명"/>
                <Cell col="3" displaytype="text" text="레시피분류"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:right;background:EXPR(iif((COPY_GBN=='Y'),strbkColor1,&quot;&quot;));background2:EXPR(iif((COPY_GBN=='Y'),strbkColor1,&quot;&quot;));" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:center;background:EXPR(iif((COPY_GBN=='Y'),strbkColor1,&quot;&quot;));background2:EXPR(iif((COPY_GBN=='Y'),strbkColor1,&quot;&quot;));" text="bind:RECIPE_CD"/>
                <Cell col="2" displaytype="text" style="align:left;background:EXPR(iif((COPY_GBN=='Y'),strbkColor1,&quot;&quot;));background2:EXPR(iif((COPY_GBN=='Y'),strbkColor1,&quot;&quot;));" text="bind:RECIPE_NAME"/>
                <Cell col="3" displaytype="text" style="align:center;background:EXPR(iif((COPY_GBN=='Y'),strbkColor1,&quot;&quot;));background2:EXPR(iif((COPY_GBN=='Y'),strbkColor1,&quot;&quot;));" text="bind:CLASS_NAME"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_Upjang1" onclick="fn_edBtn_OnClick" taborder="1" tabstop="false" text="" position="absolute 266 90 287 111" class="btn_WF_popSearch" image=""/>
        <Edit autoselect="true" id="ed_Upjang1" imemode="native" onkeydown="fn_edBtn_OnKeyDown" readonly="true" taborder="0" position="absolute 77 90 267 111"/>
        <Static id="st_Upjang1" text="사   업   장" userdata="strQuery_FMUpjang" position="absolute 0 87 75 114" class="sta_WFDA_Label01"/>
        <Edit id="ed_RECIPE_NAME" taborder="6" position="absolute 366 142 591 163" imemode="hangul" onkeydown="ed_RECIPE_NAME_onkeydown"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" id="cbo_RECIPE_TYPE" index="0" innerdataset="ds_RECIPE_TYPE" type="NOTFILTERED" taborder="4" text="레시피유형" position="absolute 366 116 591 137" displayrowcount="15"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" displayrowcount="15" id="cbo_CUISINE_TYPE" index="0" innerdataset="ds_CUISINE_TYPE" type="NOTFILTERED" taborder="5" text="조리법유형" position="absolute 77 142 287 163"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" displayrowcount="15" id="cbo_RECIPE_CLASS" index="0" innerdataset="ds_RECIPE_CLASS" type="NOTFILTERED" taborder="3" text="레시피분류" position="absolute 77 116 287 137"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" displayrowcount="15" id="cbo_SUBINV_CLASS" innerdataset="ds_SUBINV_CLASS" taborder="2" tooltiptext="식당군" position="absolute 366 90 591 111"/>
        <Static id="Static6" text="레시피  명" position="absolute 289 139 364 166" class="sta_WFDA_Label01"/>
        <Static id="Static9" text="조리법유형" position="absolute 0 139 75 166" class="sta_WFDA_Label01"/>
        <Static id="Static10" text="식   당   군" position="absolute 289 87 364 114" class="sta_WFDA_Label01"/>
        <Static id="Static11" text="레시피유형" position="absolute 289 113 364 140" class="sta_WFDA_Label01"/>
        <Static id="Static12" text="레시피분류" position="absolute 0 113 75 140" class="sta_WFDA_Label01"/>
        <Static id="st_Upjang" text="사   업   장" userdata="strQuery_FMUpjang" position="absolute 625 61 708 88" class="sta_WFDA_Label01"/>
        <Edit autoselect="true" id="ed_Upjang" imemode="native" onkeydown="fn_edBtn_OnKeyDown" readonly="true" taborder="8" position="absolute 710 64 924 85" class="edt_WF_Essential"/>
        <Button id="btn_Upjang" onclick="fn_edBtn_OnClick" taborder="9" tabstop="false" text="" position="absolute 923 64 944 85" class="btn_WF_popSearchEssential" image=""/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="38" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 713" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1245 725" anchor="left bottom"/>
        <Static id="sta_WF_Title00" text="복사 대상 사업장레시피" class="sta_WF_Title01" position="absolute 625 43 859 61"/>
        <Static id="sta_WF_Title01" text="레시피 조회" class="sta_WF_Title01" position="absolute 0 43 170 61"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 56 986 61"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 30 986 43" anchor="left top"/>
        <Static id="Static13" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 618 88 1100 93"/>
        <Static id="Static14" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 166 482 171"/>
        <Static id="Static17" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 624 686 1106 691"/>
        <Static id="Static18" text="w05" class="Guide01_AreaRed" visible="false" position="absolute 620 443 625 488" anchor="left top"/>
        <Static id="Static19" text="w05" class="Guide01_AreaRed" visible="false" position="absolute 595 443 600 488" anchor="left top"/>
        <Button id="btn_Right_AddAll" taborder="12" class="btn_WF_rightMoveAll" position="absolute 600 444 620 464" onclick="btn_Right_AddAll_onclick"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_SType">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="code_name">한화 표준레시피</Col>
            <Col id="SET1">한화표준레시피</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="code_name">본사 표준레시피</Col>
            <Col id="SET1">본사표준레시피</Col>
          </Row>
          <Row>
            <Col id="CODE">3</Col>
            <Col id="code_name">사업장레시피</Col>
            <Col id="SET1">사업장레시피</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_input" oncolumnchanged="ds_input_OnColumnChanged">
        <ColumnInfo>
          <Column id="STYPE1" size="256" type="STRING"/>
          <Column id="STYPE2" size="256" type="STRING"/>
          <Column id="MAIN_UPJANG" size="256" type="INT"/>
          <Column id="UPJANG" size="256" type="INT"/>
          <Column id="SUBINV_CLASS" size="256" type="STRING"/>
          <Column id="RECIPE_CLASS" size="256" type="STRING"/>
          <Column id="RECIPE_TYPE" size="256" type="STRING"/>
          <Column id="CUISINE_TYPE" size="256" type="STRING"/>
          <Column id="RECIPE_NAME" size="256" type="STRING"/>
          <Column id="RECIPE_CD" size="256" type="STRING"/>
          <Column id="UPJANG1" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CUISINE_TYPE"/>
            <Col id="MAIN_UPJANG"/>
            <Col id="RECIPE_CD"/>
            <Col id="RECIPE_CLASS"/>
            <Col id="RECIPE_NAME"/>
            <Col id="RECIPE_TYPE"/>
            <Col id="STYPE1"/>
            <Col id="STYPE2"/>
            <Col id="SUBINV_CLASS"/>
            <Col id="UPJANG"/>
            <Col id="UPJANG1"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_RECIPE_CLASS">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_RECIPE_TYPE">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CUISINE_TYPE">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SUBINV_CLASS">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_in" oncolumnchanged="ds_in_OnColumnChanged">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="INT"/>
          <Column id="SUBINV_CLASS" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="SUBINV_CLASS"/>
            <Col id="UPJANG"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Save">
        <ColumnInfo>
          <Column id="RECIPE_CD" size="20" type="STRING"/>
          <Column id="RECIPE_NAME" size="50" type="STRING"/>
          <Column id="SAVE_GBN" size="1" type="STRING"/>
          <Column id="EXIST_YN" size="256" type="STRING"/>
          <Column id="UPJANG" size="256" type="INT"/>
          <Column id="SUBINV_CLASS" size="256" type="STRING"/>
          <Column id="ORG_GBN" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list1">
        <ColumnInfo>
          <Column id="CLASS_NAME" size="100" type="STRING"/>
          <Column id="CUISINE_NAME" size="100" type="STRING"/>
          <Column id="CUISINE_TYPE" size="20" type="STRING"/>
          <Column id="MAIN_ITEM_CODE1" size="50" type="STRING"/>
          <Column id="MAIN_ITEM_NAME" size="100" type="STRING"/>
          <Column id="RECIPE_CA" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_CAL" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_CD" size="20" type="STRING"/>
          <Column id="RECIPE_CLASS" size="20" type="STRING"/>
          <Column id="RECIPE_FE" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_NAME" size="50" type="STRING"/>
          <Column id="RECIPE_OP_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_PROT" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_TYPE" size="20" type="STRING"/>
          <Column id="RESP_NUT1" size="20" type="STRING"/>
          <Column id="RESP_NUT_NAME" size="100" type="STRING"/>
          <Column id="TYPE_NAME" size="100" type="STRING"/>
          <Column id="UPJANG" size="256" type="INT"/>
          <Column id="SUBINV_CLASS" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list2">
        <ColumnInfo>
          <Column id="CLASS_NAME" size="100" type="STRING"/>
          <Column id="CUISINE_NAME" size="100" type="STRING"/>
          <Column id="CUISINE_TYPE" size="20" type="STRING"/>
          <Column id="MAIN_ITEM_CODE1" size="50" type="STRING"/>
          <Column id="MAIN_ITEM_NAME" size="100" type="STRING"/>
          <Column id="RECIPE_CA" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_CAL" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_CD" size="20" type="STRING"/>
          <Column id="RECIPE_CLASS" size="20" type="STRING"/>
          <Column id="RECIPE_FE" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_NAME" size="50" type="STRING"/>
          <Column id="RECIPE_OP_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_PROT" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_TYPE" size="20" type="STRING"/>
          <Column id="RESP_NUT1" size="20" type="STRING"/>
          <Column id="RESP_NUT_NAME" size="100" type="STRING"/>
          <Column id="TYPE_NAME" size="100" type="STRING"/>
          <Column id="UPJANG" size="256" type="INT"/>
          <Column id="SUBINV_CLASS" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list3">
        <ColumnInfo>
          <Column id="CLASS_NAME" size="100" type="STRING"/>
          <Column id="CUISINE_NAME" size="100" type="STRING"/>
          <Column id="CUISINE_TYPE" size="20" type="STRING"/>
          <Column id="MAIN_ITEM_CODE1" size="50" type="STRING"/>
          <Column id="MAIN_ITEM_NAME" size="100" type="STRING"/>
          <Column id="RECIPE_CA" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_CAL" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_CD" size="20" type="STRING"/>
          <Column id="RECIPE_CLASS" size="20" type="STRING"/>
          <Column id="RECIPE_FE" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_NAME" size="50" type="STRING"/>
          <Column id="RECIPE_OP_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_PROT" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_TYPE" size="20" type="STRING"/>
          <Column id="RESP_NUT1" size="20" type="STRING"/>
          <Column id="RESP_NUT_NAME" size="100" type="STRING"/>
          <Column id="TYPE_NAME" size="100" type="STRING"/>
          <Column id="UPJANG" size="256" type="INT"/>
          <Column id="SUBINV_CLASS" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_UP_HALL_CLASS" onload="ds_UP_HALL_CLASS_OnLoadCompleted">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Recipe"/>
      <Dataset id="ds_com" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
    </Objects>
    <Bind>
      <BindItem id="cbo_UP_HALL_CLASS_value" compid="cbo_UP_HALL_CLASS" propid="value" datasetid="ds_in" columnid="SUBINV_CLASS"/>
      <BindItem id="ed_RECIPE_NAME_value" compid="ed_RECIPE_NAME" propid="value" datasetid="ds_input" columnid="RECIPE_NAME"/>
      <BindItem id="cbo_RECIPE_TYPE_value" compid="cbo_RECIPE_TYPE" propid="value" datasetid="ds_input" columnid="RECIPE_TYPE"/>
      <BindItem id="cbo_CUISINE_TYPE_value" compid="cbo_CUISINE_TYPE" propid="value" datasetid="ds_input" columnid="CUISINE_TYPE"/>
      <BindItem id="cbo_RECIPE_CLASS_value" compid="cbo_RECIPE_CLASS" propid="value" datasetid="ds_input" columnid="RECIPE_CLASS"/>
      <BindItem id="cbo_SUBINV_CLASS_value" compid="cbo_SUBINV_CLASS" propid="value" datasetid="ds_input" columnid="SUBINV_CLASS"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
 ******************************************************************************************
 * 시스템구분   : 메뉴관리/레시피관리/레시피목록조회
 * 프로그램명   : FMM00100E
 * 기      능   : 사업장레시피 일괄복사
  * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-21
 * 비      고   : 
 *		- ds_input				: [input DS] 조회조건 파라미터 DS
 *		- ds_in					: [input DS] 저장조건 파라미터 DS
 *		- ds_SType				: [코드 DS] 레시피대상 DS
 *		- ds_RECIPE_CLASS		: [코드 DS] 레시피분류 DS
 *		- ds_RECIPE_TYPE		: [코드 DS] 레시피유형 DS
 *		- ds_CUISINE_TYPE		: [코드 DS] 조리법유형 DS
 *		- ds_SUBINV_CLASS		: [코드 DS] 식당군 DS
 *		- ds_UP_HALL_CLASS		: [코드 DS] 사업장에 따른 식당군 DS
 *		- ds_list1				: [Main DS] 한화표준레시피목록
 *		- ds_list2				: [Main DS] 본사표준레시피목록
 *		- ds_list3				: [Main DS] 사업장레시피목록
 *		- ds_Save				: [Main DS] 저장레시피목록
 *		- ds_Recipe				: [Check DS] 레시피가 있는지 확인용 DS
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
include "U_lib::lib_conversionCom.xjs";
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"		// X-Framework Lib
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"		// 공통팝업
//@@컨버터에서 주석처리 #include "lib::fm_common.js"			// FM공통
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var strbkColor1 = "#FFFFBB";	// 신규색
var strbkColor2 = "#FFCCFF";	// 수정색
var objds = "ds_list3";			// 연결된 DS
var nLastRow = -1;				// 저장되기전 마지막 로우
var nMaxChkCnt = 500;			// 체크할 최고갯수(500개이상 작업할경우 체크)
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	// 업데이트 DS
	v_ds_check = "ds_Save";
	
	// X-Framework : Action 정보 생성 
	fsp_init(this);
	
	// 초기값
	ed_Upjang.userdata		= application.g_Upjang;
	ed_Upjang.value			= application.g_UpjangNm;
	ed_Upjang1.userdata		= application.g_Upjang;
	ed_Upjang1.value			= application.g_UpjangNm;
	rdo_Recipe_Source.value	= "3";
	st_color1.style.background.color		= strbkColor1;
	st_color2.style.background.color		= strbkColor2;
	ds_in.setColumn(0,"UPJANG",application.g_Upjang);
	
	fn_InitSearch();
	
}

function frm_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
}
//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_search()
{
	// 조회조건체크
	if (gfn_length(ed_Upjang.userdata)==0)
	{
		g_Message("EE", "사업장을 선택하여 주십시오.");
		ed_Upjang.setFocus();
		return;
	}
	if (gfn_length(cbo_UP_HALL_CLASS.value)==0)
	{
		g_Message("EE", "식당군을 선택하여 주십시오.");
		cbo_UP_HALL_CLASS.setFocus();
		return;
	}
	
	// 초기화
	ds_Save.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc, strSqlName;
	
	outData			= "ds_Save=ds_list";
	callBackFnc		= "fn_afterSearch";
	
	otherArg		= "UPJANG=" 		+ wrapQuote(gfn_nvl(ed_Upjang.userdata));
	otherArg		+= " SUBINV_CLASS=" + wrapQuote(gfn_nvl(cbo_UP_HALL_CLASS.value));
	
	// 파라미터셋팅
	
	strSqlName = "fm/fmm:FMM00100E_S007";
	
	fsp_clear(this); 
    fsp_addSearch(this, strSqlName);												// 조회 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Insert()
 * 기      능   : [입력버튼] 입력 시 처리되는 작업
 * 비      고	: 팝업사용
 ******************************************************************************************
 */
function fn_insert()
{
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Save()
 * 기      능   : [저장버튼] 저장 시 처리되는 작업
 ******************************************************************************************
 */
function fn_save()
{ 
	// 저장조건체크
	if(!fn_SaveCheck())
	{
		return;
	}
	
	if (gfn_dsIsUpdated(ds_Save)!=true)
	{
		g_Message("EE", "변경된 내역이 없습니다.");
		return;
	}
	
	var nIstCnt = ds_Save.getCaseCount("rowtype='insert'");	// 저장할 갯수
	
	// 최대체크갯수 보다 저장할 데이터 수가 많은 경우 경고
	if (nIstCnt>= nMaxChkCnt)
	{
		var strMsg = " - 예상소요시간 : " + parseInt(nIstCnt * 0.2) + "초 \n\n";
		strMsg += "계속하시겠습니까?\n";
		strMsg += "(레시피갯수를 줄이시면, 속도가 빨라집니다.)";
		
		if(!g_Confirm("02", strMsg))
		{
			return;
		}
	}
	
	nLastRow = ds_Save.rowposition;
	
	//otherArg	= "g_EmpNo=" 		+ quote(g_EmpNo);
	
	// transaction
    var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	actionName		= "FMM00100E_T001";
	cmdName			= "U_svc::" + "fm/fmm/FMM00100E_T001.jsp";
	inData			= "ds_in=ds_in ds_Save=ds_Save:U";
	outData			= "ds_Save=ds_Save";
	callBackFnc		= "fn_SaveCallback";
	
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc);
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Delete()
 * 기      능   : [삭제버튼] 삭제 시 처리되는 작업
 ******************************************************************************************
 */
function fn_delete()
{
	if (ds_Save.rowcount == 0)
	{
		g_Message("EE", "삭제 할 내역이 없습니다.");
		return;
	}
	
	if (gfn_dsIsUpdated(ds_Save)==true)
	{
		g_Message("EE", "변경된 데이터가 있습니다.\n 저장 후 삭제해십시오.");
		return;
	}
	
	// 삭제확인
	var strMsg,nCnt,nDelCnt;
	
	//nRow = ds_Save.row;
	nCnt = ds_Save.getRowCount();
	nDelCnt = 0;					// 삭제될 데이터 갯수
	
	// 선택된 row 구함(삭제될 데이터수)
	for (i=nCnt-1; i>=0; i--)
	{
		if (!ds_Save.getSelect(i))
		{
			continue;
		}
		
		nDelCnt = nDelCnt + 1;
	}
	
	// 최대체크갯수 보다 삭제할 데이터 수가 많은 경우 경고창, 그외에는 기본 경고창
	if (nDelCnt>= nMaxChkCnt)
	{
		strMsg = " - 예상소요시간 : " + parseInt(nDelCnt * 0.2) + "초 \n\n";
		strMsg += "계속하시겠습니까?\n";
		strMsg += "(삭제된 사업장레시피는 복구할 수 없습니다.)";
	}
	else
	{
		strMsg = "※주의: 선택하신 사업장레시피를 삭제하시겠습니까?\n\n삭제된 사업장레시피는 복구할 수 없습니다.";
	}
	
	if(!g_Confirm("01",strMsg))
	{
		return;
	}
	
	// Data삭제
	//ds_Save.DeleteRow(nRow);
	
	grd_upjang_recipe_list.enableredraw = false;
	for (i=nCnt-1; i>=0; i--)
	{
		if (!ds_Save.getSelect(i))
		{
			continue;
		}
		
		ds_Save.deleteRow(i);
	}
	grd_upjang_recipe_list.enableredraw = true;
	
	// transaction
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	actionName		= "FMM00100E_T002";
	cmdName			= "U_svc::" + "fm/fmm/FMM00100E_T002.jsp";
	inData			= "ds_Save=ds_Save:U";
	
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc);
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Print()
 * 기      능   : [출력버튼] 출력 시 처리되는 작업
 ******************************************************************************************
 */
function fn_print()
{
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function fn_close()
{
	return true;
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Help()
 * 기      능   : [도움말버튼] 도움말
 ******************************************************************************************
 */
function fn_help()
{
	// tit_addSearchActionInfo(this, "fm/fmo:SCC_MENU_SELECT");
	// tit_callService(this, "", "", "ds_cond=ds_cond", "ds_Menu=ds_list", "", "");	
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_InitSearch()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 초기 공통코드조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-15
 ******************************************************************************************
 */
function fn_InitSearch()
{
	// 공통코드 조회
	var v_fil_cond;
	var v_ds = fn_common_code("'FS0002','FS0003','FS0001'","","","all","Y");

	// 레시피유형(ds_RecipeType, GROUP_CODE : 'FS0002')
	//v_fil_cond = "GROUP_CODE == 'FS0002'  AND (LENGTH(CODE)==0 || SET1 != 'Y')";
	v_fil_cond = "(GROUP_CODE == 'FS0002' && SET1 == 'N') || (GROUP_CODE == 'FS0002' && LENGTH(CODE)==0)";
	v_ds.filter(v_fil_cond);
	CopyF(ds_RECIPE_TYPE,v_ds.name);
	cbo_RECIPE_TYPE.index = 0;

	// 조리법유형(ds_CUISINE_TYPE, GROUP_CODE : 'FS0003')
	v_fil_cond = "GROUP_CODE == 'FS0003'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_CUISINE_TYPE,v_ds.name);
	
	ds_CUISINE_TYPE.filter("gfn_isNull(CODE) || SET1==" + wrapQuote(cbo_RECIPE_TYPE.value));
	gfn_initCombo(ds_input, "CUISINE_TYPE", cbo_CUISINE_TYPE);	//조리법유형
	
	// 레시피분류(ds_RECIPE_CLASS, GROUP_CODE : 'FS0001')
	v_fil_cond = "GROUP_CODE == 'FS0001'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_RECIPE_CLASS,v_ds.name);
	cbo_RECIPE_CLASS.index = 0;
	
	// 식당군조회
	http.Sync = true;
    fn_SearchCommon("fm/fmm:FMM00100E_S004","","ds_UP_HALL_CLASS=ds_UP_HALL_CLASS","UPJANG=" + wrapQuote(gfn_nvl(ed_Upjang.userdata)));
    ds_SUBINV_CLASS.copyData(ds_UP_HALL_CLASS);
    http.Sync = false;
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_SearchCommon(sqlId,inDS,outDS,otherArg)
 * 입      력   : sqlId = 실행할 sqlID
				  inDS	= input DS
				  outDS	= out DS
				  otherArg = arg
 * 반      환   : 없음
 * 기      능   : 코드조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-12  
 ******************************************************************************************
 */
function fn_SearchCommon(sqlId,inDS,outDS,otherArg)
{
	fsp_clear(this);
	fsp_addSearch(this, sqlId);
	fsp_callService(this, "", "", inDS, outDS ,otherArg, "", false, true, true);
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_SearchList()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 레시피리스트조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-04-15  
 ******************************************************************************************
 */
function fn_SearchList(obj:Button, e:ClickEventInfo)
{
	// 조회조건체크
	if (rdo_Recipe_Source.value == "2")
	{
		if (gfn_length(ed_Upjang1.userdata)==0)
		{
			g_Message("EE", "사업장을 선택하여 주십시오.");
			ed_Upjang1.setFocus();
			return;
		}
	}
	else if (rdo_Recipe_Source.value == "3")
	{
		if (gfn_length(ed_Upjang1.userdata)==0)
		{
			g_Message("EE", "사업장을 선택하여 주십시오.");
			ed_Upjang1.setFocus();
			return;
		}
		
		if (gfn_length(cbo_SUBINV_CLASS.value)==0)
		{
			g_Message("EE", "식당군을 선택하여 주십시오.");
			cbo_SUBINV_CLASS.setFocus();
			return;
		}
	}
	// 조회조건체크
	if (gfn_length(ed_Upjang.userdata)==0)
	{
		g_Message("EE", "[복사 대상 사업장레시피]에서 사업장을 선택하여 주십시오.");
		ed_Upjang.setFocus();
		return;
	}
	if (gfn_length(cbo_UP_HALL_CLASS.value)==0)
	{
		g_Message("EE", "[복사 대상 사업장레시피]에서 식당군을 선택하여 주십시오.");
		cbo_UP_HALL_CLASS.setFocus();
		return;
	}
	
	// 초기화
	eval(objds).clearData();
	
	ds_input.setColumn(0,"UPJANG",toNumber(ed_Upjang1.userdata));
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc, strSqlName;
	
	inData			= "ds_input=ds_input ds_in=ds_in";
	outData			= objds + "=" + objds;
	callBackFnc		= "fn_afterSearch";
	
	// 파라미터셋팅
	
	strSqlName = "fm/fmm:FMM00100E_S00" + rdo_Recipe_Source.value;
	
	fsp_clear(this); 
    fsp_addSearch(this, strSqlName);												// 조회 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_SearchRecipe(strRecipeCD)
 * 입      력   : strRecipeCD : 조회할레시피코드
 * 반      환   : nCnt : 레시피의 갯수
 * 기      능   : 해당레시피가 사업장레시피에 있는지 체크
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-24  
 ******************************************************************************************
 */
function fn_SearchRecipe(strRecipeCD)
{
	ds_Recipe.clearData();
	
	http.Sync = true;
	fn_SearchCommon("fm/fmm:FMM00100E_S005","ds_in=ds_in","ds_Recipe=ds_Recipe","RECIPE_CD="+wrapQuote(strRecipeCD));
	http.Sync = false;
	
	return ds_Recipe.rowcount;
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSearch()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 사업장 조회 후 실행 함수
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-21  
 ******************************************************************************************
 */
function fn_afterSearch(errCode, errMsg)
{
	if (errCode != 0)
	{
		return;
	}
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_SaveCallback(strSvr,errCode, errMsg
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 사업장 조회 후 실행 함수
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-09  
 ******************************************************************************************
 */
function fn_SaveCallback(errCode, errMsg)
{
	grd_upjang_recipe_list.enableredraw = false;
	ds_Save.rowposition = nLastRow;
	grd_upjang_recipe_list.enableredraw = true;
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_SaveCheck()
 * 입      력   : 없음
 * 반      환   : true/false
 * 기      능   : 저장 체크
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-21  
 ******************************************************************************************
 */
function fn_SaveCheck()
{
	if (gfn_length(gfn_toString(ds_in.getColumn(0,"UPJANG")))== 0)
	{
		g_Message("EE", "사업장을 선택해주십시오.");
		ed_Upjang.setFocus();
		return false;
	}

	if (gfn_length(ds_in.getColumn(0,"SUBINV_CLASS"))== 0)
	{
		g_Message("EE", "식당군을 선택해주십시오.");
		cbo_UP_HALL_CLASS.setFocus();
		return false;
	}
	
	return true;
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_formSetting()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 화면버튼셋팅
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-10  
 ******************************************************************************************
 */
function fn_formSetting()
{
	var strCode = rdo_Recipe_Source.value;
	
	// 대상선택에 따라 셋팅
	if (strCode == "2")				// 본사표준레시피
	{
		ed_Upjang1.enable 			= true;
		btn_Upjang1.enable 			= true;
		cbo_SUBINV_CLASS.enable		= false;
	}
	else if (strCode == "3")		// 사업장레시피
	{
		ed_Upjang1.enable 			= true;
		btn_Upjang1.enable 			= true;
		cbo_SUBINV_CLASS.enable		= true;
	}
	else							// 한화표준레시피
	{
		ed_Upjang1.enable 			= false;
		btn_Upjang1.enable 			= false;
		cbo_SUBINV_CLASS.enable		= false;
	}
	
	objds = "ds_list" + strCode;
	grd_list.binddataset = objds;
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
 /******************************************************************************************
 * 함  수  명   : grd_List_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
 * 기      능   : 그리드헤드 더블클릭시 Sort
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-21  
 ******************************************************************************************
 */
function grd_List_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
}

/*
 ******************************************************************************************
 * 함  수  명   : ed_pop_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
 * 기      능   : 업장엔터시팝업
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-21  
 ******************************************************************************************
 */
function ed_pop_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
{
	if (nChar == 13)
	{
		var objme = eval(obj.userdata);
		objme.click();
	}
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_edBtn_OnClick/fn_edBtn_OnKeyDown/fn_Trigger_edBtn
 * 기      능   : 업장엔터시팝업
 * 작  성  자   : 
 * 작성  일자   : 2008-01-21  
 ******************************************************************************************
 */
function fn_edBtn_OnClick(obj:Button, e:ClickEventInfo)
{
	//[[As-Is 소스
	///*
	var sAddWhere = "";
	
	switch(obj.name)
	{
		case "btn_Upjang":
		case "btn_Upjang1":
			if (application.g_UserKind == '사업장'){
				sAddWhere = " AND A.USE_YN = 'Y' AND A.MAIN_UPJANG = " + g_Main_Upjang;		
				sAddWhere += " AND ( A.UPJANG = " + application.g_Upjang + " OR EXISTS (SELECT 1 FROM FMS_USER_UPJANG B WHERE B.USE_YN = 'Y' AND B.UPJANG = A.UPJANG AND B.SABUN = '" + application.g_EmpNo + "') )";	
			}
			else if (application.g_UserKind == '본사'){		
				sAddWhere = " AND A.USE_YN = 'Y' AND A.MAIN_UPJANG = " + g_Main_Upjang;	
			}
			else if (application.g_UserKind == '본부'){
				sAddWhere = " AND A.USE_YN = 'Y' " ;
			}
			break;
			
		default:
			break;
	}
	//fm공통 팝업클릭 호출
	if (ffn_btn_OnClick(obj, sAddWhere)) fn_Trigger_edBtn(eval(gfn_replace(obj.name,"btn_","ed_")));
	
	if (obj == btn_Upjang)
	{
		ds_in.setColumn(0,"UPJANG",eval(gfn_replace(obj.name,"btn_","ed_")).userdata);
	}
	//*/
	//As-Is 소스]]
	
	//[[To-Be 소스
	/*
	var sAddWhere = {};
	
	SCPopup.option.isMainUpjang = "N";
	
	switch(obj.name)
	{
		case "btn_Upjang":
		case "btn_Upjang1":
			sAddWhere.gUserKind = application.g_UserKind;
			
			if (application.g_UserKind == '사업장')
			{
				sAddWhere.gMainUpjang = g_Main_Upjang;
				sAddWhere.gUpjang = application.g_Upjang;
				sAddWhere.gEmpNo = application.g_EmpNo;
			}
			else if (application.g_UserKind == '본사') sAddWhere.gMainUpjang = g_Main_Upjang;

			break;
		default:
			break;
	}
	//fm공통 팝업클릭 호출
	if (ffn_btn_OnClick(obj, sAddWhere)) fn_Trigger_edBtn(eval(gfn_replace(obj.name,"btn_","ed_")));
	
	if (obj == btn_Upjang)
	{
		ds_in.setColumn(0,"UPJANG",eval(gfn_replace(obj.name,"btn_","ed_")).userdata);
	}
	*/
	//To-Be 소스]]
}

function fn_edBtn_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	ffn_ed_OnKeyDown(obj,e.keycode);
	
	//Del의 경우 뒷처리
	if (e.keycode == 46) fn_Trigger_edBtn(obj);
}

function fn_Trigger_edBtn(obj)
{
	switch(obj.name)
	{
		case "ed_Upjang":
		// 식당군조회
			fn_SearchCommon("fm/fmm:FMM00100E_S004","","ds_UP_HALL_CLASS=ds_UP_HALL_CLASS","UPJANG=" + wrapQuote(gfn_nvl(ed_Upjang.userdata)));
			cbo_UP_HALL_CLASS.index = 0;
			break;
		case "ed_Upjang1":
			// 식당군조회
			fn_SearchCommon("fm/fmm:FMM00100E_S004","","ds_SUBINV_CLASS=ds_UP_HALL_CLASS","UPJANG=" + wrapQuote(gfn_nvl(ed_Upjang1.userdata)));
			cbo_SUBINV_CLASS.index = 0;
			break;			
		default:
			break;
	}
}

 /******************************************************************************************
 * 함  수  명   : ed_RECIPE_NAME_onkeydown(obj,strPreText,nChar,strPostText,LLParam,HLParam)
 * 기      능   : 검색조건 엔터시 조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-24 
 ******************************************************************************************
 */
function ed_RECIPE_NAME_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13)	// 엔터
	{
		fn_SearchList();
	}
}

/******************************************************************************************
 * 함  수  명   : rdo_Recipe_Source_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
 * 기      능   : 레시피대상변경시 폼셋팅
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-24 
 ******************************************************************************************
 */
function rdo_Recipe_Source_OnChanged(obj:Radio, e:ItemChangeEventInfo)
{
	fn_formSetting();
}

/******************************************************************************************
 * 함  수  명   : btn_Right_Add_OnClick(obj)
 * 기      능   : 레시피추가
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-24
 ******************************************************************************************
 */
function btn_Right_Add_OnClick(obj:Button, e:ClickEventInfo)
{
	// 저장가능한지 체크
	if(!fn_SaveCheck())
	{
		return false;
	}
	
	var nCnt,strRecipeCD,strRecipeName,nARow,nRecipeCnt,strExistYN,nFRow,strSaveGbn;
	
	nCnt = eval(objds).getRowCount();
	
	grd_upjang_recipe_list.enableredraw = false;
	
	for (i = 0; i < nCnt; i++)
	{
		if (!eval(objds).getSelect(i))
		{
			continue;
		}
		
		strRecipeCD		= eval(objds).getColumn(i,"RECIPE_CD");
		strRecipeName	= eval(objds).getColumn(i,"RECIPE_NAME");
		strSaveGbn		= eval(objds).getColumn(i,"SAVE_GBN");
		nRecipeCnt 		= fn_SearchRecipe(strRecipeCD);
		
		if ( nRecipeCnt == 0)		// 레시피가없는경우
		{
			strExistYN = "N";
		}
		else										// 레시피가 있는경우
		{
			strExistYN = "Y";
			
			var strMsg 	= "[" + strRecipeCD + "] " + strRecipeName +"\n";
			strMsg 		+= "이미 사업장레시피가 있습니다." +"\n";
			strMsg 		+= "표준레시피로 변경하시겠습니까?";
			
			if (!g_Confirm("03",strMsg))
			{
				continue;
			}
		}
		
		// 현재 저장list에 있는 경우 기존것 삭제후 다시 추가
		nFRow = ds_Save.findRowExpr("RECIPE_CD=="+wrapQuote(strRecipeCD) + "&& SAVE_GBN==" + wrapQuote(strSaveGbn));
		if (nFRow >= 0)
		{
			ds_Save.deleteRow(nFRow);
		}
		
		nARow = ds_Save.addRow();	
		
		// copy
		ds_Save.copyRow(nARow, eval(objds), i,"RECIPE_CD=RECIPE_CD,RECIPE_NAME=RECIPE_NAME,UPJANG=UPJANG,SUBINV_CLASS=SUBINV_CLASS,SAVE_GBN=SAVE_GBN,ORG_GBN=SAVE_GBN");
		
		// 셋팅
		ds_Save.setColumn(nARow,"EXIST_YN",strExistYN);
		eval(objds).setColumn(i,"COPY_GBN","Y");
	}
	
	grd_upjang_recipe_list.enableredraw = true;
}

/******************************************************************************************
 * 함  수  명   : btn_Left_Del_OnClick(obj)
 * 기      능   : 레시피삭제
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-24
 ******************************************************************************************
 */
function btn_Left_Del_OnClick(obj:Button, e:ClickEventInfo)
{
	var nCnt,strRecipeCD,strSAVE_GBN,nFRow,objlistDs,strRowType,strRecipeNm;
	
	nCnt = ds_Save.getRowCount();
	
	var selectArr = gfn_split(mfn_Get_MultiSelectStr(ds_Save),",");
	var selectCnt = selectArr.length;
	
	grd_upjang_recipe_list.enableredraw = false;
	
	for (i=selectCnt-1; i>=0; i--)
	{
		strRowType	= GetRowType(ds_Save,selectArr[i]);
		strRecipeCD = ds_Save.getColumn(selectArr[i],"RECIPE_CD");
		strRecipeNm	= ds_Save.getColumn(selectArr[i],"RECIPE_NAME");
		strSAVE_GBN = ds_Save.getColumn(selectArr[i],"SAVE_GBN");
		objlistDs = "ds_list"+strSAVE_GBN;
		
		if (strRowType == "insert")
		{
			// 셋팅
			nFRow = eval(objlistDs).findRow("RECIPE_CD",strRecipeCD);
			if (nFRow >= 0)
			{
				eval(objlistDs).setColumn(nFRow,"COPY_GBN","N");
			}
			
			ds_Save.deleteRow(selectArr[i]);
		}
		else
		{
			g_Message("EE", strRecipeNm + "는 저장된 사업장 레시피입니다.\n삭제하시려면 상단의 삭제버튼을 클릭하세요.");
			continue;
		}
	}
	
	grd_upjang_recipe_list.enableredraw = true;
}
/******************************************************************************************
 * 함  수  명   : ds_UP_HALL_CLASS_OnLoadCompleted(obj,nErrorCode,strErrorMsg,nReason)
 * 기      능   : 처음항목
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-24
 ******************************************************************************************
 */
function ds_UP_HALL_CLASS_OnLoadCompleted(obj:Dataset, e:DSLoadEventInfo)
{
	if (e.reason == 0)
	{
		cbo_UP_HALL_CLASS.index = 0;
	}
}

/******************************************************************************************
 * 함  수  명   : ds_in_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
 * 기      능   : 복사대상사업장레시피 조건 변경시
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-24
 ******************************************************************************************
 */
function ds_in_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if (gfn_dsIsUpdated(ds_Save)==true)
	{
		if (g_Confirm("02","변경된 데이터가 있습니다.\n데이터를 저장하시겠습니까?\n(기존에 입력한 자료는 사라집니다.)"))
		{
			http.Sync = true;
			fn_save();
			http.Sync = false;
		}
	}
	ds_Save.clearData();		// 조건이 변경된 경우 초기화
	
	if (e.columnid == "UPJANG")
	{
		fn_SearchCommon("fm/fmm:FMM00100E_S004","","ds_UP_HALL_CLASS=ds_UP_HALL_CLASS","UPJANG=" + wrapQuote(gfn_nvl(ed_Upjang.userdata)));
	}
	
	if (e.columnid == "SUBINV_CLASS")
	{
		ds_list1.clearData();
		ds_list2.clearData();
		ds_list3.clearData();
		ds_input.setColumn(0,"RECIPE_CLASS","");
		fn_SearchCommon("fm/fmm:FMM00100E_S006","ds_in=ds_in","ds_RECIPE_CLASS=ds_RECIPE_CLASS","");
	}
}

/******************************************************************************************
 * 함  수  명   : grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
 * 기      능   : 더블클릭시 추가
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-24
 ******************************************************************************************
 */
function grd_list_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
	btn_Right_Add.click();
}

/******************************************************************************************
 * 함  수  명   : grd_upjang_recipe_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
 * 기      능   : 더블클릭시 삭제
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-24
 ******************************************************************************************
 */
function grd_upjang_recipe_list_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
	btn_Left_Del.click();
}

/******************************************************************************************
 * 함  수  명   : ds_input_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
 * 기      능   : 검색조건 변경
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-24
 ******************************************************************************************
 */
function ds_input_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if (e.columnid == "RECIPE_TYPE")	// 레시피유형변경시
	{
		if (gfn_length(e.newvalue)==0)
		{
			ds_CUISINE_TYPE.filter("");
		}
		else
		{
			ds_CUISINE_TYPE.filter("gfn_isNull(CODE) || SET1==" + wrapQuote(e.newvalue));
		}
		cbo_CUISINE_TYPE.index = 0;
	}
}

/******************************************************************************************
 * 함  수  명   : btn_Right_AddAll_onclick(obj:Button,  e:ClickEventInfo)
 * 기      능   : 전체추가
 * 작  성  자   : 김경은
 * 작성  일자   : 2015-05-12
 ******************************************************************************************
 */
function btn_Right_AddAll_onclick(obj:Button,  e:ClickEventInfo)
{
	if (g_Confirm("","전체 레시피를 추가 하시겠습니까?"))
	{
		var bSelect = grd_list.selectAll();
		if(bSelect) btn_Right_Add_OnClick(); 
	}	
}




]]></Script>
  </Form>
</FDL>

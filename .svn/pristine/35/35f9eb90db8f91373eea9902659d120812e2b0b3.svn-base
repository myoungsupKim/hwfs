<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FMP00161P" onkeydown="fn_FormKeyDown" onload="form_onload" ontimer="FMP00161P_OnTimer" titletext="주요상품 검색" position="absolute 0 0 790 590" scrollbars="none">
    <Layouts>
      <Layout>
        <Tab id="tab_list" onchanged="tab_list_OnChanged" preload="true" taborder="2" position="absolute 15 82 775 575" showextrabutton="false">
          <Tabpages>
            <Tabpage id="tab1" taborder="1" text="주요상품" position="absolute 2 24 759 456" scrollbars="none">
              <Layouts>
                <Layout>
                  <Static id="Static02" class="sta_WFDA_Labelbg" position="absolute 102 10 749 37"/>
                  <Grid autoenter="select" binddataset="ds_List1" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="gd_list" useinputpanel="false" selecttype="row" oncellclick="gd_list_OnCellClick" onselectchanged="tab_list_tab1_gd_list_OnCellPosChanged" onheadclick="gd_list_OnHeadClick" taborder="11" tabstop="true" usecontextmenu="true" visible="true" wheelscrollrow="1" position="absolute 10 42 748 455">
                    <Formats>
                      <Format id="Default">
                        <Columns>
                          <Column size="30"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="40"/>
                          <Column size="70"/>
                          <Column size="69"/>
                          <Column size="50"/>
                          <Column size="80"/>
                          <Column size="100"/>
                          <Column size="88"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                          <Row size="22" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="소분류"/>
                          <Cell col="2" displaytype="text" text="상품코드"/>
                          <Cell col="3" displaytype="text" text="상품명"/>
                          <Cell col="4" displaytype="text" text="규격"/>
                          <Cell col="5" displaytype="text" text="원산지"/>
                          <Cell col="6" displaytype="text" text="단위"/>
                          <Cell col="7" displaytype="text" text="판매단가"/>
                          <Cell col="8" displaytype="text" style="align:center;" text="마감일"/>
                          <Cell col="9" displaytype="text" text="수량"/>
                          <Cell col="10" displaytype="text" text="금액"/>
                          <Cell col="11" displaytype="text" text="비고"/>
                          <Cell col="12" displaytype="text" text="이미지유무"/>
                        </Band>
                        <Band id="body">
                          <Cell celltype="head" displaytype="text" style="align:right;" expr="expr:currow + 1"/>
                          <Cell col="1" displaytype="text" style="background:EXPR(fn_SetRowColor(PR_QTY));align:left;" text="bind:CLASS_NAME3"/>
                          <Cell col="2" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(PR_QTY));" text="bind:ITEM_CODE"/>
                          <Cell col="3" displaytype="text" style="background:EXPR(fn_SetRowColor(PR_QTY));align:left;" text="bind:ITEM_NAME"/>
                          <Cell col="4" displaytype="text" style="background:EXPR(fn_SetRowColor(PR_QTY));align:left;" text="bind:ITEM_SIZE"/>
                          <Cell col="5" displaytype="text" style="background:EXPR(fn_SetRowColor(PR_QTY));align:left;" text="bind:ORIGIN_TYPE"/>
                          <Cell col="6" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(PR_QTY));" text="bind:PO_UOM"/>
                          <Cell col="7" displaytype="number" style="align: ;background:EXPR(fn_SetRowColor(PR_QTY));" text="bind:OP_PRICE" mask="#,##0"/>
                          <Cell col="8" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(PR_QTY));" text="bind:D_DAY_DISP"/>
                          <Cell col="9" displaytype="number" edittype="text" editfilter="number" style="align:right;background:lightyellow;background2:lightyellow;" text="bind:PR_QTY" mask="#,##0.0" editlimit="10" editautoselect="true"/>
                          <Cell col="10" displaytype="number" style="align: ;background:EXPR(fn_SetRowColor(PR_QTY));" text="bind:OP_AMOUNT" mask="#,##0"/>
                          <Cell col="11" displaytype="text" edittype="normal" style="align:left;background:lightyellow;background2:lightyellow;" text="bind:PR_REMARK" editimemode="native" editautoselect="true"/>
                          <Cell col="12" displaytype="text" style="align:left;background:#ffffffff;background2:#ffffff;" text="bind:IMG_YN" editimemode="native"/>
                        </Band>
                        <Band id="summary">
                          <Cell displaytype="text" style="align:left;"/>
                          <Cell col="1" displaytype="text" style="align:center;"/>
                          <Cell col="2" displaytype="text" style="align:center;"/>
                          <Cell col="3" displaytype="text" style="align:left;"/>
                          <Cell col="4" displaytype="text" style="align:center;"/>
                          <Cell col="5" displaytype="text" style="align:center;" text="발주건수"/>
                          <Cell col="6" displaytype="number" style="align: ;" expr="expr:getCaseCount(&quot;PR_QTY&gt;0&quot;)" mask="#,##0"/>
                          <Cell col="7" displaytype="text" style="align:center;" text="합  계"/>
                          <Cell col="8" displaytype="text" style="align:center;"/>
                          <Cell col="9" displaytype="number" style="align: ;" expr="expr:getSum(&quot;PR_QTY&quot;)" mask="#,##0.0"/>
                          <Cell col="10" displaytype="number" style="align: ;" expr="expr:getSum(&quot;OP_AMOUNT&quot;)" mask="#,##0"/>
                          <Cell col="11" displaytype="text" style="align:left;" text="(VAT별도)"/>
                          <Cell col="12" displaytype="text" style="align:left;" text="(VAT별도)"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Edit autoselect="true" id="ed_Item" imemode="hangul" onkeydown="ed_Item_OnKeyDown" taborder="8" position="absolute 105 13 691 34"/>
                  <Static id="st_Otcust" text="상품명" position="absolute 10 10 103 37" class="sta_WFDA_Label01"/>
                  <Static id="Static12" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 10 430" anchor="top right"/>
                  <Static id="Static13" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 759 10" anchor="left bottom"/>
                  <Static id="Static21" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 37 749 42"/>
                  <Static id="Static00" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 748 0 758 430" anchor="top right"/>
                  <Static id="Static01" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 455 759 465" anchor="left bottom"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tab2" taborder="5" text="분류별 조회" position="absolute 2 24 759 456" scrollbars="none">
              <Layouts>
                <Layout>
                  <Static id="Static02" class="sta_WFDA_Labelbg" position="absolute 68 10 748 37"/>
                  <Edit autoselect="true" id="ed_Item" imemode="hangul" onkeydown="ed_Item_OnKeyDown" taborder="4" position="absolute 564 13 691 34"/>
                  <Static id="st_Otcust" text="상품명" position="absolute 502 10 562 37" class="sta_WFDA_Label01"/>
                  <Combo codecolumn="CLASS_CODE" datacolumn="CLASS_NAME" displayrowcount="10" id="cbo_Class2" imemode="native" innerdataset="ds_Class2" onitemchanged="cbo_Class2_OnChanged" onkeydown="cbo_Class2_OnKeyDown" taborder="1" position="absolute 72 13 172 34"/>
                  <Static id="Static23" text="중분류" position="absolute 10 10 70 37" class="sta_WFDA_Label01"/>
                  <Static id="Static28" text="소분류" position="absolute 174 10 234 37" class="sta_WFDA_Label01"/>
                  <Combo codecolumn="CLASS_CODE" datacolumn="CLASS_NAME" displayrowcount="10" id="cbo_Class3" imemode="native" innerdataset="ds_Class3" onitemchanged="cbo_Class2_OnChanged" onkeydown="cbo_Class2_OnKeyDown" taborder="2" position="absolute 236 13 336 34"/>
                  <Static id="Static0" text="세분류" position="absolute 338 10 398 37" class="sta_WFDA_Label01"/>
                  <Combo codecolumn="CLASS_CODE" datacolumn="CLASS_NAME" displayrowcount="10" id="cbo_Class4" imemode="native" innerdataset="ds_Class4" onkeydown="cbo_Class2_OnKeyDown" taborder="3" position="absolute 400 13 500 34"/>
                  <Grid autoenter="select" binddataset="ds_List2" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="gd_list" useinputpanel="false" selecttype="row" oncellclick="gd_list_OnCellClick" onselectchanged="tab_list_tab2_gd_list_OnCellPosChanged" onheadclick="gd_list_OnHeadClick" taborder="5" tabstop="true" usecontextmenu="true" visible="true" wheelscrollrow="1" position="absolute 10 42 748 455">
                    <Formats>
                      <Format id="Default">
                        <Columns>
                          <Column size="30"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="40"/>
                          <Column size="70"/>
                          <Column size="69"/>
                          <Column size="50"/>
                          <Column size="80"/>
                          <Column size="100"/>
                          <Column size="100"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                          <Row size="22" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="소분류"/>
                          <Cell col="2" displaytype="text" text="상품코드"/>
                          <Cell col="3" displaytype="text" text="상품명"/>
                          <Cell col="4" displaytype="text" text="규격"/>
                          <Cell col="5" displaytype="text" text="원산지"/>
                          <Cell col="6" displaytype="text" text="단위"/>
                          <Cell col="7" displaytype="text" text="판매단가"/>
                          <Cell col="8" displaytype="text" style="align:center;" text="마감일"/>
                          <Cell col="9" displaytype="text" text="수량"/>
                          <Cell col="10" displaytype="text" text="금액"/>
                          <Cell col="11" displaytype="text" text="비고"/>
                          <Cell col="12" displaytype="text" text="이미지유무"/>
                        </Band>
                        <Band id="body">
                          <Cell celltype="head" displaytype="text" style="align:right;" expr="expr:currow + 1"/>
                          <Cell col="1" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:CLASS_NAME3"/>
                          <Cell col="2" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:ITEM_CODE"/>
                          <Cell col="3" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:ITEM_NAME"/>
                          <Cell col="4" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:ITEM_SIZE"/>
                          <Cell col="5" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:ORIGIN_TYPE"/>
                          <Cell col="6" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:PO_UOM"/>
                          <Cell col="7" displaytype="number" style="background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:OP_PRICE" mask="#,##0"/>
                          <Cell col="8" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:D_DAY_DISP"/>
                          <Cell col="9" displaytype="number" edittype="text" editfilter="number" style="align:right;background:lightyellow;background2:lightyellow;" text="bind:PR_QTY" mask="#,##0.0" editlimit="10" editautoselect="true"/>
                          <Cell col="10" displaytype="number" style="background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:OP_AMOUNT" mask="#,##0"/>
                          <Cell col="11" displaytype="text" edittype="normal" style="align:left;background:lightyellow;background2:lightyellow;" text="bind:PR_REMARK" editimemode="native" editautoselect="true"/>
                          <Cell col="12" displaytype="text" style="align:left;background:#ffffffff;background2:#ffffffff;" text="bind:IMG_YN" editimemode="native"/>
                        </Band>
                        <Band id="summary">
                          <Cell displaytype="text" style="align:left;"/>
                          <Cell col="1" displaytype="text" style="align:center;"/>
                          <Cell col="2" displaytype="text" style="align:center;"/>
                          <Cell col="3" displaytype="text" style="align:left;"/>
                          <Cell col="4" displaytype="text" style="align:center;"/>
                          <Cell col="5" displaytype="text" style="align:center;" text="발주건수"/>
                          <Cell col="6" displaytype="number" style="align: ;" expr="expr:getCaseCount(&quot;PR_QTY&gt;0&quot;)" mask="#,##0"/>
                          <Cell col="7" displaytype="text" style="align:center;" text="합  계"/>
                          <Cell col="8" displaytype="text" style="align:center;"/>
                          <Cell col="9" displaytype="number" style="align: ;" expr="expr:getSum(&quot;PR_QTY&quot;)" mask="#,##0.0"/>
                          <Cell col="10" displaytype="number" style="align: ;" expr="expr:getSum(&quot;OP_AMOUNT&quot;)" mask="#,##0"/>
                          <Cell col="11" displaytype="text" style="align:left;" text="(VAT별도)"/>
                          <Cell col="12" displaytype="text" style="align:left;" text="(VAT별도)"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static12" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 10 430" anchor="top right"/>
                  <Static id="Static13" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 759 10" anchor="left bottom"/>
                  <Static id="Static21" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 37 749 42"/>
                  <Static id="Static00" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 748 0 758 430" anchor="top right"/>
                  <Static id="Static01" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 455 759 465" anchor="left bottom"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tab3" taborder="5" text="즐겨찾기 조회" position="absolute 2 24 759 456" scrollbars="none">
              <Layouts>
                <Layout>
                  <Static id="Static02" class="sta_WFDA_Labelbg" position="absolute 68 10 748 37"/>
                  <Static id="st_Otcust" text="즐겨찾기 그룹" position="absolute 10 10 103 37" class="sta_WFDA_Label01"/>
                  <Combo codecolumn="FAVOR_GROUP" datacolumn="FAVOR_NAME" displayrowcount="10" id="cbo_Fav" imemode="none" innerdataset="ds_Fav" onitemchanged="cbo_SubinvP_OnChanged" onkeydown="ed_Item_OnKeyDown" taborder="0" position="absolute 105 13 690 34"/>
                  <Grid autoenter="select" binddataset="ds_List3" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="gd_list" useinputpanel="false" selecttype="row" oncellclick="gd_list_OnCellClick" onselectchanged="tab_list_tab3_gd_list_OnCellPosChanged" onheadclick="gd_list_OnHeadClick" taborder="1" tabstop="true" usecontextmenu="true" visible="true" wheelscrollrow="1" position="absolute 10 42 748 455">
                    <Formats>
                      <Format id="Default">
                        <Columns>
                          <Column size="30"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="40"/>
                          <Column size="70"/>
                          <Column size="69"/>
                          <Column size="50"/>
                          <Column size="80"/>
                          <Column size="100"/>
                          <Column size="69"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                          <Row size="22" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="소분류"/>
                          <Cell col="2" displaytype="text" text="상품코드"/>
                          <Cell col="3" displaytype="text" text="상품명"/>
                          <Cell col="4" displaytype="text" text="규격"/>
                          <Cell col="5" displaytype="text" text="원산지"/>
                          <Cell col="6" displaytype="text" text="단위"/>
                          <Cell col="7" displaytype="text" text="판매단가"/>
                          <Cell col="8" displaytype="text" style="align:center;" text="마감일"/>
                          <Cell col="9" displaytype="text" text="수량"/>
                          <Cell col="10" displaytype="text" text="금액"/>
                          <Cell col="11" displaytype="text" text="비고"/>
                          <Cell col="12" displaytype="text" text="이미지유무"/>
                        </Band>
                        <Band id="body">
                          <Cell celltype="head" displaytype="text" style="align:right;" expr="expr:currow + 1"/>
                          <Cell col="1" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:CLASS_NAME3"/>
                          <Cell col="2" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:ITEM_CODE"/>
                          <Cell col="3" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:ITEM_NAME"/>
                          <Cell col="4" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:ITEM_SIZE"/>
                          <Cell col="5" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:ORIGIN_TYPE"/>
                          <Cell col="6" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:PO_UOM"/>
                          <Cell col="7" displaytype="number" style="background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:OP_PRICE" mask="#,##0"/>
                          <Cell col="8" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:D_DAY_DISP"/>
                          <Cell col="9" displaytype="number" edittype="text" editfilter="number" style="align:right;background:lightyellow;background2:lightyellow;" text="bind:PR_QTY" mask="#,##0.0" editlimit="10" editautoselect="true"/>
                          <Cell col="10" displaytype="number" style="background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:OP_AMOUNT" mask="#,##0"/>
                          <Cell col="11" displaytype="text" edittype="normal" style="align:left;background:lightyellow;background2:lightyellow;" text="bind:PR_REMARK" editimemode="native" editautoselect="true"/>
                          <Cell col="12" displaytype="text" style="align:left;" text="bind:IMG_YN" editimemode="native"/>
                        </Band>
                        <Band id="summary">
                          <Cell displaytype="text" style="align:left;"/>
                          <Cell col="1" displaytype="text" style="align:center;"/>
                          <Cell col="2" displaytype="text" style="align:center;"/>
                          <Cell col="3" displaytype="text" style="align:left;"/>
                          <Cell col="4" displaytype="text" style="align:center;"/>
                          <Cell col="5" displaytype="text" style="align:center;" text="발주건수"/>
                          <Cell col="6" displaytype="number" style="align: ;" expr="expr:getCaseCount(&quot;PR_QTY&gt;0&quot;)" mask="#,##0"/>
                          <Cell col="7" displaytype="text" style="align:center;" text="합  계"/>
                          <Cell col="8" displaytype="text" style="align:center;"/>
                          <Cell col="9" displaytype="number" style="align: ;" expr="expr:getSum(&quot;PR_QTY&quot;)" mask="#,##0.0"/>
                          <Cell col="10" displaytype="number" style="align: ;" expr="expr:getSum(&quot;OP_AMOUNT&quot;)" mask="#,##0"/>
                          <Cell col="11" displaytype="text" style="align:left;" text="(VAT별도)"/>
                          <Cell col="12" displaytype="text" style="align:left;" text="(VAT별도)"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static13" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 759 10" anchor="left bottom"/>
                  <Static id="Static12" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 10 430" anchor="top right"/>
                  <Static id="Static00" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 748 0 758 430" anchor="top right"/>
                  <Static id="Static21" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 37 749 42"/>
                  <Static id="Static01" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 455 759 465" anchor="left bottom"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tab4" taborder="5" text="지난발주 복사" position="absolute 2 24 759 456" scrollbars="none">
              <Layouts>
                <Layout>
                  <Static id="Static02" class="sta_WFDA_Labelbg" position="absolute 68 10 748 37"/>
                  <Grid autoenter="select" binddataset="ds_List4" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="gd_list" useinputpanel="false" oncellclick="gd_list_OnCellClick" onselectchanged="tab_list_tab4_gd_list_OnCellPosChanged" onheadclick="gd_list_OnHeadClick" taborder="6" tabstop="true" usecontextmenu="true" useselcolor="false" visible="true" wheelscrollrow="1" position="absolute 10 42 748 455" selecttype="row">
                    <Formats>
                      <Format id="Default">
                        <Columns>
                          <Column size="30"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="40"/>
                          <Column size="70"/>
                          <Column size="80"/>
                          <Column size="50"/>
                          <Column size="80"/>
                          <Column size="100"/>
                          <Column size="74"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                          <Row size="22" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="소분류"/>
                          <Cell col="2" displaytype="text" text="상품코드"/>
                          <Cell col="3" displaytype="text" text="상품명"/>
                          <Cell col="4" displaytype="text" text="규격"/>
                          <Cell col="5" displaytype="text" text="원산지"/>
                          <Cell col="6" displaytype="text" text="단위"/>
                          <Cell col="7" displaytype="text" text="판매단가"/>
                          <Cell col="8" displaytype="text" style="align:center;" text="마감일"/>
                          <Cell col="9" displaytype="text" text="수량"/>
                          <Cell col="10" displaytype="text" text="금액"/>
                          <Cell col="11" displaytype="text" text="비고"/>
                          <Cell col="12" displaytype="text" text="이미지유무"/>
                        </Band>
                        <Band id="body">
                          <Cell celltype="head" displaytype="text" style="align:right;" expr="expr:currow + 1"/>
                          <Cell col="1" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:CLASS_NAME3"/>
                          <Cell col="2" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:ITEM_CODE"/>
                          <Cell col="3" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:ITEM_NAME"/>
                          <Cell col="4" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:ITEM_SIZE"/>
                          <Cell col="5" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:ORIGIN_TYPE"/>
                          <Cell col="6" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:PO_UOM"/>
                          <Cell col="7" displaytype="number" style="background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:OP_PRICE" mask="#,##0"/>
                          <Cell col="8" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:D_DAY_DISP"/>
                          <Cell col="9" displaytype="number" edittype="text" editfilter="number" style="align:right;background:lightyellow;background2:lightyellow;" text="bind:PR_QTY" mask="#,##0.0" editlimit="10" editautoselect="true"/>
                          <Cell col="10" displaytype="number" style="background:EXPR(fn_SetRowColor(PR_QTY));background2:EXPR(fn_SetRowColor(PR_QTY));" text="bind:OP_AMOUNT" mask="#,##0"/>
                          <Cell col="11" displaytype="text" edittype="normal" style="align:left;background:lightyellow;background2:lightyellow;" text="bind:PR_REMARK" editimemode="native" editautoselect="true"/>
                          <Cell col="12" displaytype="text" style="align:left;background:#ffffffff;background2:#ffffff;" text="bind:IMG_YN" editimemode="native"/>
                        </Band>
                        <Band id="summary">
                          <Cell displaytype="text" style="align:left;"/>
                          <Cell col="1" displaytype="text" style="align:center;"/>
                          <Cell col="2" displaytype="text" style="align:center;"/>
                          <Cell col="3" displaytype="text" style="align:left;"/>
                          <Cell col="4" displaytype="text" style="align:center;"/>
                          <Cell col="5" displaytype="text" style="align:center;" text="발주건수"/>
                          <Cell col="6" displaytype="number" style="align: ;" expr="expr:getCaseCount(&quot;PR_QTY&gt;0&quot;)" mask="#,##0"/>
                          <Cell col="7" displaytype="text" style="align:center;" text="합  계"/>
                          <Cell col="8" displaytype="text" style="align:center;"/>
                          <Cell col="9" displaytype="number" style="align: ;" expr="expr:getSum(&quot;PR_QTY&quot;)" mask="#,##0.0"/>
                          <Cell col="10" displaytype="number" style="align: ;" expr="expr:getSum(&quot;OP_AMOUNT&quot;)" mask="#,##0"/>
                          <Cell col="11" displaytype="text" style="align:left;" text="(VAT별도)"/>
                          <Cell col="12" displaytype="text" style="align:left;" text="(VAT별도)"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="st_Otcust" text="입고일자" position="absolute 492 10 572 37" class="sta_WFDA_Label01"/>
                  <MaskEdit id="me_NeedDateP" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkeydown="ed_Item_OnKeyDown" onkillfocus="g_Date_OnKillFocus" taborder="3" type="string" position="absolute 574 13 674 34" class="msk_WF_Cal"/>
                  <Button id="btn_NeedDateP" onclick="g_CalButton_OnClick" taborder="4" tabstop="false" text="" userdata="tab_list.tab4.me_NeedDateP" position="absolute 651 13 674 34" class="btn_WF_cal" image=""/>
                  <Static id="st_UpjangP" text="사업장" userdata="strQuery_FMUpjang" position="absolute 10 10 90 37" class="sta_WFDA_Label01"/>
                  <Edit autoselect="true" id="ed_UpjangP" imemode="native" onkeydown="fn_edBtn_OnKeyDown" readonly="true" taborder="1" position="absolute 92 13 226 34"/>
                  <Button id="btn_UpjangP" onclick="fn_edBtn_OnClick" taborder="1" tabstop="false" text="" position="absolute 225 13 246 34" class="btn_WF_popSearch" image=""/>
                  <Static id="Static6" text="식당(창고)" position="absolute 248 10 328 37" class="sta_WFDA_Label01"/>
                  <Combo codecolumn="SUBINV_CODE" datacolumn="SUBINV_NAME" displayrowcount="10" id="cbo_SubinvP" imemode="none" innerdataset="ds_SubinvP" onitemchanged="cbo_SubinvP_OnChanged" taborder="2" position="absolute 330 13 490 34"/>
                  <Static id="Static12" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 10 430" anchor="top right"/>
                  <Static id="Static13" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 759 10" anchor="left bottom"/>
                  <Static id="Static21" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 37 749 42"/>
                  <Static id="Static00" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 748 0 758 430" anchor="top right"/>
                  <Static id="Static01" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 455 759 465" anchor="left bottom"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Button id="btn_close" onclick="btn_close_OnClick" taborder="3" text="닫 기" position="absolute 730 10 775 35" class="btn_WF_Custom" image=""/>
        <Button id="btn_save" onclick="btn_save_OnClick" taborder="1" text="추 가" position="absolute 683 10 728 35" class="btn_WF_Custom" image=""/>
        <Static id="st_NeedDate" text="입고예정일 : 0000-00-00" position="absolute 15 40 398 67" class="sta_WFDA_Label03" style="align:center middle;"/>
        <Static id="st_Days" text="마감시간 : 00일 00시간 00분 전" position="absolute 397 40 775 67" class="sta_WFDA_Label03" style="align:center middle;"/>
        <Static id="Static2" text="선발주 상품은 미리 주문하세요." position="absolute 556 88 775 103" class="sta_WF_DiscPoint"/>
        <TextArea id="ta_Sql" readonly="true" taborder="8" visible="false" position="absolute 663 43 772 64"/>
        <Static id="st_Week" text="(월)" position="absolute 291 44 351 63" style="font:굴림,9,bold;"/>
        <Static id="Static01" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 15 590"/>
        <Static id="Static15" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 15 0 775 10"/>
        <Static id="Static02" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 775 0 790 590" positionstep="0"/>
        <Static id="Static04" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 528 35 775 40"/>
        <Static id="Static20" text="W102" visible="false" position="absolute 728 10 730 35" anchor="top right" style="background:#ff000055;align:center middle;"/>
        <Static id="Static11" text="h15" visible="false" position="absolute 15 67 775 82" style="background:#ff000055;align:center middle;"/>
        <Static id="Static03" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 15 575 775 590"/>
        <Button id="btn_search" taborder="9" tabstop="false" text="검색" onclick="btn_search_OnClick" onkeydown="btn_search_OnKeyDown" class="btn_WF_Find" position="absolute 709 122 761 143"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_Cond">
        <ColumnInfo>
          <Column id="ITEM_NAME" size="100" type="STRING"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="UPJANG" size="22" type="INT"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="QTY_CONTROL_YN" size="1" type="STRING"/>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="AP_UNITPRICE_UPJANG" size="22" type="INT"/>
          <Column id="OTCUST_PRICE_UPJANG" size="22" type="INT"/>
          <Column id="ITEM_CLASS2" size="8" type="STRING"/>
          <Column id="ITEM_CLASS3" size="8" type="STRING"/>
          <Column id="ITEM_CLASS4" size="8" type="STRING"/>
          <Column id="FAVOR_GROUP" size="50" type="STRING"/>
          <Column id="NEED_DATEP" size="8" type="STRING"/>
          <Column id="UPJANGP" size="22" type="INT"/>
          <Column id="SUBINV_CODEP" size="8" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Class2"/>
      <Dataset id="ds_Class3"/>
      <Dataset id="ds_Class4"/>
      <Dataset id="ds_Fav">
        <ColumnInfo>
          <Column id="FAVOR_GROUP" size="50" type="STRING"/>
          <Column id="FAVOR_NAME" size="100" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List1" cancolumnchange="ds_List_CanColumnChange" oncolumnchanged="ds_List_OnColumnChanged">
        <ColumnInfo>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="CENTER_FLAG" size="1" type="STRING"/>
          <Column id="CLS_STATUS" size="50" type="STRING"/>
          <Column id="CUSTCD" size="22" type="INT"/>
          <Column id="INVAT_FLAG" size="1" type="STRING"/>
          <Column id="ITEM_CODE" size="50" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="LINE_STATUS" size="50" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="OTCUSTCD" size="50" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" type="STRING"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="POINT_FLAG" size="1" type="STRING"/>
          <Column id="PR_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" type="STRING"/>
          <Column id="PR_UPJANG" size="22" type="INT"/>
          <Column id="RC_UPJANG" size="22" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="TAX_CODE" size="3" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" type="INT"/>
          <Column id="D_DAY_DISP" size="50" type="STRING"/>
          <Column id="CLASS_NAME3" size="100" type="STRING"/>
          <Column id="D_TIMES" size="4" type="INT"/>
          <Column id="IMAGE_PATH" size="200" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="CORN_YN" size="1" type="STRING"/>
          <Column id="SPICE_YN" size="1" type="STRING"/>
          <Column id="IMG_YN" size="1" type="STRING"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CtUpj">
        <ColumnInfo>
          <Column id="AP_UNITPRICE_UPJANG" size="22" type="INT"/>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="OTCUST_PRICE_UPJANG" size="22" type="INT"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List2" cancolumnchange="ds_List_CanColumnChange" oncolumnchanged="ds_List_OnColumnChanged">
        <ColumnInfo>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="CENTER_FLAG" size="1" type="STRING"/>
          <Column id="CLS_STATUS" size="50" type="STRING"/>
          <Column id="CUSTCD" size="22" type="INT"/>
          <Column id="INVAT_FLAG" size="1" type="STRING"/>
          <Column id="ITEM_CODE" size="50" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="LINE_STATUS" size="50" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="OTCUSTCD" size="50" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" type="STRING"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="POINT_FLAG" size="1" type="STRING"/>
          <Column id="PR_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" type="STRING"/>
          <Column id="PR_UPJANG" size="22" type="INT"/>
          <Column id="RC_UPJANG" size="22" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="TAX_CODE" size="3" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" type="INT"/>
          <Column id="D_DAY_DISP" size="50" type="STRING"/>
          <Column id="CLASS_NAME3" size="100" type="STRING"/>
          <Column id="D_TIMES" size="4" type="INT"/>
          <Column id="IMAGE_PATH" size="200" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="CORN_YN" size="1" type="STRING"/>
          <Column id="SPICE_YN" size="1" type="STRING"/>
          <Column id="IMG_YN" size="1" type="STRING"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List3" cancolumnchange="ds_List_CanColumnChange" oncolumnchanged="ds_List_OnColumnChanged">
        <ColumnInfo>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="CENTER_FLAG" size="1" type="STRING"/>
          <Column id="CLS_STATUS" size="50" type="STRING"/>
          <Column id="CUSTCD" size="22" type="INT"/>
          <Column id="INVAT_FLAG" size="1" type="STRING"/>
          <Column id="ITEM_CODE" size="50" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="LINE_STATUS" size="50" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="OTCUSTCD" size="50" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" type="STRING"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="POINT_FLAG" size="1" type="STRING"/>
          <Column id="PR_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" type="STRING"/>
          <Column id="PR_UPJANG" size="22" type="INT"/>
          <Column id="RC_UPJANG" size="22" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="TAX_CODE" size="3" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" type="INT"/>
          <Column id="D_DAY_DISP" size="50" type="STRING"/>
          <Column id="CLASS_NAME3" size="100" type="STRING"/>
          <Column id="D_TIMES" size="4" type="INT"/>
          <Column id="IMAGE_PATH" size="200" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="CORN_YN" size="1" type="STRING"/>
          <Column id="SPICE_YN" size="1" type="STRING"/>
          <Column id="IMG_YN" size="1" type="STRING"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List4" cancolumnchange="ds_List_CanColumnChange" oncolumnchanged="ds_List_OnColumnChanged">
        <ColumnInfo>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="CENTER_FLAG" size="1" type="STRING"/>
          <Column id="CLS_STATUS" size="50" type="STRING"/>
          <Column id="CUSTCD" size="22" type="INT"/>
          <Column id="INVAT_FLAG" size="1" type="STRING"/>
          <Column id="ITEM_CODE" size="50" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="LINE_STATUS" size="50" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="OTCUSTCD" size="50" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" type="STRING"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="POINT_FLAG" size="1" type="STRING"/>
          <Column id="PR_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" type="STRING"/>
          <Column id="PR_UPJANG" size="22" type="INT"/>
          <Column id="RC_UPJANG" size="22" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="TAX_CODE" size="3" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" type="INT"/>
          <Column id="D_DAY_DISP" size="50" type="STRING"/>
          <Column id="CLASS_NAME3" size="100" type="STRING"/>
          <Column id="D_TIMES" size="4" type="INT"/>
          <Column id="IMAGE_PATH" size="200" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="CORN_YN" size="1" type="STRING"/>
          <Column id="SPICE_YN" size="1" type="STRING"/>
          <Column id="IMG_YN" size="1" type="STRING"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SubinvP"/>
    </Objects>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 식재영업/발주관리/상품검색
 * 프로그램명   : FMP00162P.XML
 * 기      능   : 상품검색
 * 작  성  자   : 박은규
 * 작성  일자   : 2008-01-10
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::fm_common.js"			// FM공통

//var fa_Upjang, fa_SubinvCode, fa_NeedDate, fa_Consum, fa_Qty_Ctl, fa_TabIdx;
var fa_Sql;

function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	//초기화
	fsp_init(this);
   	//ta_Sql.Visible = (global.g_AuthLevel == "999");

	tab_list.tab4.ed_UpjangP.userdata = opener.ed_Upjang.userdata;
	tab_list.tab4.ed_UpjangP.value     = opener.ed_Upjang.value;
	Copy(ds_SubinvP,opener.ds_Subinv);
	tab_list.tab4.cbo_SubinvP.value   = opener.cbo_Subinv.value;
	tab_list.tab4.me_NeedDateP.value  = gfn_addDate(fa_NeedDate,-7);  //addDate(fn_CurrDateWeek(),-7);
	
	//분류세팅
	fn_sql_common("C", strQuery_FMItemClass	," AND A.USE_YN = 'Y' AND A.CLASS_TYPE = 'M' AND A.CLASS_CODE LIKE 'F%' "," ORDER BY A.CLASS_CODE","all",tab_list.tab2.cbo_Class2,-1,ds_Class2); tab_list.tab2.cbo_Class2.index = 0;
	fn_sql_common("C", strQuery_FMItemClass	," AND A.USE_YN = 'Y' AND A.CLASS_TYPE = 'S' AND A.CLASS_CODE LIKE 'F%' "," ORDER BY A.CLASS_CODE","all",tab_list.tab2.cbo_Class3,-1,ds_Class3); tab_list.tab2.cbo_Class3.index = 0;
	fn_sql_common("C", strQuery_FMItemClass	," AND A.USE_YN = 'Y' AND A.CLASS_TYPE = 'D' AND A.CLASS_CODE LIKE 'F%' "," ORDER BY A.CLASS_CODE","all",tab_list.tab2.cbo_Class4,-1,ds_Class4); tab_list.tab2.cbo_Class4.index = 0;
	
	//즐겨찾기그룹
	fn_SetFav();
	//센터단가업장정보
	fn_SetCtUpj();
	//헤더설정
	//st_NeedDate.text = "입고예정일 : " + opener.me_NeedDate.text + " (월)";
	st_NeedDate.text = "입고예정일 : " + opener.me_NeedDate.text;
	st_Week.text = "(" + ffn_DayToWeek(opener.me_NeedDate.value) + ")";
	if (st_Week.text == "(토)")
		st_Week.style.color = "blue";
	else if (st_Week.text == "(일)")
		st_Week.style.color = "red";
	else
		st_Week.style.color = "default";

	fn_SetTitle();
	//타이머... 
	//setTimer(666,30000); //일단 30초 세팅 임시주석
	
	//플래쉬
	//Flash10.Movie = "IMG::WorkingCercle.swf";
	//Flash10.Play();

	tab_list.tabindex = toNumber(fa_TabIdx);
	if (tab_list.tabindex == 0)
		tab_list.tab1.ed_Item.setFocus();
	else if (tab_list.tabindex == 1)
		//tab_list.tab2.cbo_Class2.SetFocus();
		tab_list.tab2.ed_Item.setFocus();
	else if (tab_list.tabindex == 2)
		tab_list.tab3.cbo_Fav.setFocus();
	else if (tab_list.tabindex == 3)
		tab_list.tab4.me_NeedDateP.setFocus();
}

function fn_search()
{
	// 초기화
	ds_Cond.clearData();
	eval("ds_List" + gfn_toString(tab_list.tabindex+1)).clearData();
	ds_Cond.addRow();
	ds_Cond.setColumn(0, "UPJANG",        fa_Upjang);
	ds_Cond.setColumn(0, "SUBINV_CODE",   fa_SubinvCode);
	ds_Cond.setColumn(0, "NEED_DATE",     fa_NeedDate);
	ds_Cond.setColumn(0, "CONSUM_YN",     fa_Consum);
	ds_Cond.setColumn(0, "QTY_CONTROL_YN",fa_Qty_Ctl);
	ds_Cond.setColumn(0, "CENTER_CODE",   ds_CtUpj.getColumn(0,"CENTER_CODE"));
	ds_Cond.setColumn(0, "AP_UNITPRICE_UPJANG",     ds_CtUpj.getColumn(0,"AP_UNITPRICE_UPJANG"));
	ds_Cond.setColumn(0, "OTCUST_PRICE_UPJANG",     ds_CtUpj.getColumn(0,"OTCUST_PRICE_UPJANG"));
	if (tab_list.tabindex == 0)
		ds_Cond.setColumn(0, "ITEM_NAME",     tab_list.tab1.ed_Item.text);
	else if (tab_list.tabindex == 1)
	{
		ds_Cond.setColumn(0, "ITEM_CLASS2",   tab_list.tab2.cbo_Class2.value);
		ds_Cond.setColumn(0, "ITEM_CLASS3",   tab_list.tab2.cbo_Class3.value);
		ds_Cond.setColumn(0, "ITEM_CLASS4",   tab_list.tab2.cbo_Class4.value);
		ds_Cond.setColumn(0, "ITEM_NAME",     tab_list.tab2.ed_Item.text);
	}
	else if (tab_list.tabindex == 2)
		ds_Cond.setColumn(0, "FAVOR_GROUP",   tab_list.tab3.cbo_Fav.value);
	else if (tab_list.tabindex == 3)
	{
		if (ffn_ChkNull(tab_list.tab4.me_NeedDateP.value))
		{
			g_Message("EE", "복사대상 일자를 선택하세요."); tab_list.tab4.me_NeedDateP.setFocus(); return;
		}
		if (ffn_ChkNull(tab_list.tab4.ed_UpjangP.userdata))
		{
			g_Message("EE", "복사대상 업장을 선택하세요."); tab_list.tab4.ed_UpjangP.setFocus(); return;
		}
		if (ffn_ChkNull(tab_list.tab4.cbo_SubinvP.value))
		{
			g_Message("EE", "복사대상 식당을 선택하세요."); tab_list.tab4.cbo_SubinvP.setFocus(); return;
		}
		ds_Cond.setColumn(0, "NEED_DATEP",    tab_list.tab4.me_NeedDateP.value);
		ds_Cond.setColumn(0, "UPJANGP",       tab_list.tab4.ed_UpjangP.userdata);
		ds_Cond.setColumn(0, "SUBINV_CODEP",  tab_list.tab4.cbo_SubinvP.value);
	}
/*
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    inData		= "ds_Cond=ds_Cond";
    outData		= "ds_List" + toString(tab_list.TabIndex+1) + "=ds_List";
    callBackFnc	= "fn_CallBack_Search";
	
	//action 정보 초기화 
	tit_clearActionInfo(this); 
    // 서버에서 조회할 정보 추가 
	tit_addSearchActionInfo(this, "fm/fmp:FMP00161P_S00" + toString(tab_list.TabIndex+1));
	// 서버 호출 
    tit_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
*/
	// 조회
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMP00160E_T004";
	strURL   = "U_svc::" + "fm/fmp/FMP00160E_T004.jsp";
	// 데이터셋 설정
	strInDatasets  = "ds_Cond=ds_Cond";
	strOutDatasets = "ds_List" + gfn_toString(tab_list.tabindex+1)+ "=ds_List";
	// 파라메터 설정
	strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
	strArgument += " strIndex=" + wrapQuote(gfn_toString(tab_list.tabindex+1));
	// 콜백함수 지정
	strCallbackFunc = "fn_CallBack_Search";
	// 서버 호출 
	//Transaction(strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc);
	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, false);
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
//콜백
//function fn_CallBack_Search(SvcID, errCode, errMsg)
function fn_CallBack_Search(errCode, errMsg)
{
ta_Sql.value = fa_Sql;
	if (errCode == 0)
	{
		if (eval("ds_List" + gfn_toString(tab_list.tabindex+1)).rowcount == 0)
			g_Message("EE","검색된 상품이 없습니다.");
		else
		{
			//창고가 식재/소모품 통합창고인 경우 주문통제 점검
			if (ffn_ChkNull(fa_Consum)) fn_SetOrdCtrl();
			eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).gd_list.setFocus();
			eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).gd_list.setCellPos(7);
		}
	}
	else
		g_Message("EE","주문상품 조회하는 중에 오류가 발생하였습니다! \n 관리자에게 문의하세요.");
}

function fn_SetOrdCtrl()
{
	var nRow;
	for (i=eval("ds_List" + gfn_toString(tab_list.tabindex+1)).rowcount-1; i>=0; i--)
	{
		//주문통제(주문일자)
		nRow = opener.ds_OrdCtrl.findRowExpr("CTRL_TYPE=='주문'&&ITEM_TYPE==iif('" + eval("ds_List" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"CONSUM_YN") + "','Y','소모품','식자재')");
		if (nRow >= 0)
		{
			if (opener.ds_OrdCtrl.getColumn(nRow,ToUpper(gds_currdate.getColumn(0, "WEEK_ENG"))) == "Y")
				eval("ds_List" + gfn_toString(tab_list.tabindex+1)).deleteRow(i);
		}
		//주문통제(입고일자)
		nRow = opener.ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE==iif('" + eval("ds_List" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"CONSUM_YN") + "','Y','소모품','식자재')");
		if (nRow >= 0)
		{
			if (opener.ds_OrdCtrl.getColumn(nRow,ToUpper(ffn_DayToWeek(fa_NeedDate,"1"))) == "Y")
				eval("ds_List" + gfn_toString(tab_list.tabindex+1)).deleteRow(i);
		}
	}
}

function fn_FormKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
	//ESC키는 닫기
	if ( e.keycode == 27 ) close();
	//임시로...'F12'입력시 타이머 작동중지
	if (e.keycode == 123) killTimer(666);
}

function fn_CopyRow(obj)
{
	if (obj.rowcount < 1) return;
	if (obj.findRowExpr("PR_QTY>0") < 0) return;
	
	for (i=0; i<obj.rowcount; i++)
	{
		if (obj.getColumn(i,"PR_QTY") <= 0) continue;
		//이미 등록여부
		if ( opener.ds_List.findRowExpr("ITEM_CODE=="+wrapQuote(obj.getColumn(i,"ITEM_CODE"))) >= 0 )
		{
			if (! g_Confirm("01", obj.getColumn(i,"ITEM_CODE") + ' ' + obj.getColumn(i,"ITEM_NAME") + '\n이미 주문등록한 상품입니다.\n\n추가주문 하시겠습니까?!')) continue;
		}
		opener.ds_List.addRow();
		opener.ds_List.copyRow(opener.ds_List.rowposition, obj, i);
	}
	//for (i=obj.rowcount-1; i>=0; i--)
		//if (obj.GetColumn(i,"PR_QTY") > 0) obj.DeleteRow(i);
}

function fn_SetFav()
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_Fav=ds_List";
    otherArg	= "UPJANG=" + wrapQuote(fa_Upjang);
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_FAVORITE_GROUP_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	if (ds_Fav.rowcount > 0) tab_list.tab3.cbo_Fav.index = 0;
}

function fn_SetCtUpj()
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_CtUpj=ds_List";
    otherArg	= "UPJANG=" + wrapQuote(fa_Upjang);
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_GET_CTUPJ_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	if (ds_CtUpj.rowcount <= 0)
	{
		g_Message("EE","업장기초정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
		close();
	}
}

function fn_SetSubinvP()
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 초기화
	ds_SubinvP.clearData();
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_SubinvP=ds_List";
    otherArg	= "UPJANG=" + wrapQuote(tab_list.tab4.ed_UpjangP.userdata);
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_PO_SUBINV_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	//기본창고지정
	if (ds_SubinvP.rowcount > 0) tab_list.tab4.cbo_SubinvP.index = 0;
}

function fn_SetRowColor(nQty)
{
	if (numFormat(nQty,1)== "0.0")
		return "white";
	else
		return "thistle";
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
function btn_close_OnClick(obj:Button, e:ClickEventInfo)
{
	close();
}

function gd_list_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
}

function btn_search_OnClick(obj:Button, e:ClickEventInfo)
{
	fn_search();
}

function btn_search_OnKeyDown(obj:Button, e:KeyEventInfo)
{
	if ( e.keycode == 13 ) btn_search_OnClick(obj);
}

function ed_Item_OnKeyDown(obj, e)
{
	if ( e.keycode == 13 ) fn_search();
}

function cbo_Class2_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	if (obj == tab_list.tab2.cbo_Class2)
	{
		// 소분류 데이터셋 필터
		ds_Class3.filter("gfn_left(CLASS_CODE,3)=="+wrapQuote(gfn_left(e.postvalue,3))+"||CLASS_CODE==''");
		tab_list.tab2.cbo_Class3.index = 0;
		// 세분류 데이터셋 필터
		ds_Class4.filter("gfn_left(CLASS_CODE,3)=="+wrapQuote(gfn_left(e.postvalue,3))+"||CLASS_CODE==''");
		tab_list.tab2.cbo_Class4.index = 0;
	}
	else if (obj == tab_list.tab2.cbo_Class3)
	{
		ds_Class4.filter("gfn_left(CLASS_CODE,5)=="+wrapQuote(gfn_left(e.postvalue,5))+"||CLASS_CODE==''");
		tab_list.tab2.cbo_Class4.index=0;
	}
}

function cbo_Class2_OnKeyDown(obj:Combo, e:KeyEventInfo)
{
	ffn_SetComboNull(obj, e.keycode);
}

function tab_list_OnChanged(obj:Tab, e:TabIndexChangeEventInfo)
{
	switch(e.postindex)
	{
		case 0:
			tab_list.tab1.ed_Item.setFocus();
			break;
		case 1:
			//tab_list.tab2.cbo_Class2.SetFocus();
			tab_list.tab2.ed_Item.setFocus();
			break;
		case 2:
			tab_list.tab3.cbo_Fav.setFocus();
			break;
		case 3:
			tab_list.tab4.me_NeedDateP.setFocus();
			break;
		default:
			break;
	}
}

function ds_List_CanColumnChange(obj:Dataset, e:DSColChangeEventInfo)
{
	//수량체크
	if (e.columnid == "PR_QTY")
	{
		//(-)발주여부
		if ( toNumber(e.newvalue) < 0 )
		{
			g_Message("EE","(-)발주는 불가합니다.");
			return false;
		}
		//수량통제 안하는 업장의 경우 이하 패스...
		//if (fa_Qty_Ctl = "N") return true;
		//
		//수량통제 안하는 업장의 경우 소숫점발주가 Y이면 무조건 최소발주량/발주승수량을 무조건 0.1로 세팅하여 조회
		if ( toNumber(e.newvalue) > 0 )
		{
			//최소발주량 체크
			if ( (toNumber(obj.getColumn(e.row,"MIN_ORD_QTY")) > 0) && (toNumber(obj.getColumn(e.row,"MIN_ORD_QTY")) > toNumber(e.newvalue)) )
			{
				g_Message("EE","해당 상품은 최소발주량이 " + obj.getColumn(e.row,"MIN_ORD_QTY") + "입니다.");
				return false;
			}
			//최대발주량 체크
			if ( (toNumber(obj.getColumn(e.row,"MAX_ORD_QTY")) > 0) && (toNumber(obj.getColumn(e.row,"MAX_ORD_QTY")) < toNumber(e.newvalue)) )
			{
				g_Message("EE","해당 상품은 최대발주량이 " + obj.getColumn(e.row,"MAX_ORD_QTY") + "입니다.");
				return false;
			}
			//소숫점발주여부
			if ( (obj.getColumn(e.row,"POINT_FLAG") != "Y") && (Math.ceil(toNumber(e.newvalue)) != toNumber(e.newvalue)) )
			{
				g_Message("EE","해당 상품은 소숫점발주가 불가합니다.");
				return false;
			}
			//발주승수량
			if ( (toNumber(obj.getColumn(e.row,"MULTIPLIER_QTY")) > 0) && ((Math.round(toNumber(e.newvalue) * 1000) % Math.round(toNumber(obj.getColumn(e.row,"MULTIPLIER_QTY")) * 1000)) <> 0) )
			{
				g_Message("EE","해당 상품은 발주승수량이 " + obj.getColumn(e.row,"MULTIPLIER_QTY") + "입니다.");
				return false;
			}
		}
		
		//3개월치 최대발주량 초과시 알람
		if ( toNumber(e.newvalue) >  toNumber(obj.getColumn(e.row,"MAX_SO_QTY")) )
		{
			g_Message("EE","해당 상품은 최근 3개월 최대발주량 " + obj.getColumn(e.row,"MAX_SO_QTY") + " 을 초과 하였습니다. ");
		}
	}
	return true;
}

function ds_List_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	//금액계산
	if (e.columnid == "PR_QTY")
	{
		var nAmt = Math.round(toNumber(obj.getColumn(e.row,"SALE_PRICE")) * toNumber(e.newvalue));
		obj.setColumn(e.row, "SALE_AMOUNT", nAmt);
		nAmt = Math.round(toNumber(obj.getColumn(e.row,"OP_PRICE")) * toNumber(e.newvalue));
		obj.setColumn(e.row, "OP_AMOUNT", nAmt);
	}
}

function btn_save_OnClick(obj:Button, e:ClickEventInfo)
{
	fn_CopyRow(eval("ds_List" + gfn_toString(tab_list.tabindex + 1)));
}

function FMP00162P_OnTimer(obj,nEventID)
{
	if (nEventID == 666) fn_SetTitle();
}

function fn_SetTitle()
{
	fn_CurrDateWeek();
	
	var sChkDate, sDay, sTime;
	if ( gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4)>= opener.ds_Days.getColumn(0,"D_TIMES") )
	{
		sChkDate = gfn_addDate(fa_NeedDate, (-1 * (toNumber(opener.ds_Days.getColumn(0,"D_DAYS")) + 1)));
		sTime = G_fn_GapTime("1", gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4), opener.ds_Days.getColumn(0,"D_TIMES"), "");
	}
	else
	{
		sChkDate = gfn_addDate(fa_NeedDate, (-1 * toNumber(opener.ds_Days.getColumn(0,"D_DAYS"))));
		sTime = G_fn_GapTime("0", gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4), opener.ds_Days.getColumn(0,"D_TIMES"), "");
	}
	if (parseInt(gds_currdate.getColumn(0, "YMD")) <= parseInt(sChkDate))
		sDay = G_fn_CalcDay(gds_currdate.getColumn(0, "YMD"), sChkDate);
	else
		sDay = G_fn_CalcDay(sChkDate, gds_currdate.getColumn(0, "YMD")) * (-1);
	
	if ((toNumber(sDay) >= 0) && (toNumber(sDay) < 10)) sDay = "0" + sDay;
	st_Days.text = "마감시간 : " + sDay + "일 " + gfn_left(sTime,2)+ "시간 " + gfn_right(sTime,2)+ "분 전";
}

function fn_edBtn_OnClick(obj:Button, e:ClickEventInfo)
{
	var sAddWhere = "";
	var sOnBoard = "tab_list.tab4.";

	switch(obj.name)
	{
		case "btn_UpjangP":
			sAddWhere = " AND A.USE_YN = 'Y'";
			//본사인 경우 해당 사업장 조회
			if (application.g_UserKind == '본사')
				sAddWhere += " AND A.MAIN_UPJANG = " + application.g_Main_Upjang;
			//사업장인 경우 관리업장만 조회
			else if (application.g_UserKind == '사업장')
				sAddWhere += " AND ( A.UPJANG = " + application.g_Upjang + " OR EXISTS (SELECT 1 FROM FMS_USER_UPJANG B WHERE B.USE_YN = 'Y' AND B.UPJANG = A.UPJANG AND B.SABUN = '" + application.g_EmpNo + "') )";
			
			break;

		default:
			break;
	}
	//fm공통 팝업클릭 호출
	if (ffn_btn_OnClick(obj, sAddWhere, sOnBoard)) fn_Trigger_edBtn(eval(sOnBoard + "ed_" + gfn_subStr(obj.name, 4)));
}

function fn_edBtn_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	var sOnBoard = "tab_list.tab4.";

	ffn_ed_OnKeyDown(obj,e.keycode,sOnBoard);
	//Del의 경우 뒷처리
	if (e.keycode == 46) fn_Trigger_edBtn(eval(sOnBoard + "ed_" + gfn_subStr(obj.name, 3)));
}

function fn_Trigger_edBtn(obj)
{
	switch(obj)
	{
		case tab_list.tab4.ed_UpjangP:
			//초기화
			ds_List4.clearData();
			//창고세팅
			fn_SetSubinvP();

			break;
			
		default:

			break;
	}
}

function gd_list_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	//2010/03/23 수량 입력 클릭 시 공백 처리 == by Noh Kyu Wan ==
	if (e.cell == 9)
	{	    
	    if (ds_List1.getColumn(e.row,"PR_QTY") <> 0)
	    {}
	    else	    
		ds_List1.setColumn(e.row,"PR_QTY","");		
		
	    if (ds_List2.getColumn(e.row,"PR_QTY") <> 0)
	    {}
	    else	    
		ds_List2.setColumn(e.row,"PR_QTY","");		
				
	    if (ds_List3.getColumn(e.row,"PR_QTY") <> 0)
	    {}
	    else	    
		ds_List3.setColumn(e.row,"PR_QTY","");						
		
	    if (ds_List4.getColumn(e.row,"PR_QTY") <> 0)
	    {}
	    else	    
		ds_List4.setColumn(e.row,"PR_QTY","");				
	}	
	
	
	if (eval(obj.binddataset).rowcount < 1) return;
	if (e.row < 0) return;
	if (e.cell <> 1) return;
	
	/************ 이미지팝업 주석
	if (eval(obj.binddataset).getColumn(e.row, "OTCUSTCD") == "0000")
		gfn_dialog("", "U_SCC::SCC91000P.xfdl","fa_Image="+wrapQuote(gfmsImgPathH + eval(obj.binddataset).getColumn(e.row, "IMAGE_PATH")));
	else
		gfn_dialog("", "U_SCC::SCC91000P.xfdl","fa_Image="+wrapQuote(gfmsImgPathO + eval(obj.binddataset).getColumn(e.row, "IMAGE_PATH")));
	*************/	
}

function cbo_SubinvP_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	//초기화
	if (obj == tab_list.tab3.cbo_Fav)
		ds_List3.clearData();
	else if (obj == tab_list.tab4.cbo_SubinvP)
		ds_List4.clearData();
	//데이타셑 위치변경
	eval(obj.innerdataset).rowposition = e.postindex;
}

function tab_list_tab4_me_NeedDateP_OnKillFocus(obj)
{
	//g_Date_OnKillFocus(obj);
	g_Date_OnKillFocus(tab_list.tab4.me_NeedDateP);
}

function tab_list_tab1_gd_list_OnCellPosChanged(obj:Grid, e:GridSelectEventInfo)
{
	//2010/03/23 수량 입력 클릭 시 공백 처리 == by Noh Kyu Wan ==
	if (e.cell == 9)
	{
	    if (ds_List1.getColumn(e.row,"PR_QTY") <> 0)
	    {}
	    else	    
		ds_List1.setColumn(e.row,"PR_QTY","");		
	}		
}

function tab_list_tab2_gd_list_OnCellPosChanged(obj:Grid, e:GridSelectEventInfo)
{
	//2010/03/23 수량 입력 클릭 시 공백 처리 == by Noh Kyu Wan ==
	if (e.cell == 9)
	{
	    if (ds_List2.getColumn(e.row,"PR_QTY") <> 0)
	    {}
	    else	    
		ds_List2.setColumn(e.row,"PR_QTY","");		
	}		
}

function tab_list_tab3_gd_list_OnCellPosChanged(obj:Grid, e:GridSelectEventInfo)
{
	//2010/03/23 수량 입력 클릭 시 공백 처리 == by Noh Kyu Wan ==
	if (e.cell == 9)
	{
	    if (ds_List3.getColumn(e.row,"PR_QTY") <> 0)
	    {}
	    else	    
		ds_List3.setColumn(e.row,"PR_QTY","");		
	}		
}

function tab_list_tab4_gd_list_OnCellPosChanged(obj:Grid, e:GridSelectEventInfo)
{
	//2010/03/23 수량 입력 클릭 시 공백 처리 == by Noh Kyu Wan ==
	if (e.cell == 9)
	{
	    if (ds_List4.getColumn(e.row,"PR_QTY") <> 0)
	    {}
	    else	    
		ds_List4.setColumn(e.row,"PR_QTY","");		
	}		
}
]]></Script>
  </Form>
</FDL>

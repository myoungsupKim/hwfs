<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSM00370V" onkeydown="frm_OnKeyDown" onload="form_onload" titletext="식재료율실적조회(관리)" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static29" class="sta_WFSA_Labelbg" position="absolute 0 30 1236 123" anchor="left top right"/>
        <Grid scrollbars="autoboth" binddataset="ds_list" cellsizingtype="both" enable="true" id="grd_list" useinputpanel="false" oncelldblclick="grd_list_OnCellDblClick" onheadclick="grd_onHeadClick" taborder="1" tabstop="false" usecontextmenu="true" userdata="식재료율실적조회_관리" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 136 1236 710" readonly="true" selecttype="row" autofittype="none" anchor="all">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="20" band="left"/>
                <Column size="36" band="left"/>
                <Column size="36" band="left"/>
                <Column size="53" band="left"/>
                <Column size="53" band="left"/>
                <Column size="125" band="left"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="구분"/>
                <Cell col="2" rowspan="2" displaytype="text" text="지역"/>
                <Cell col="3" rowspan="2" displaytype="text" text="직군"/>
                <Cell col="4" rowspan="2" displaytype="text" text="상세직군"/>
                <Cell col="5" rowspan="2" displaytype="text" text="사업장"/>
                <Cell col="6" colspan="6" displaytype="text" text="매출액"/>
                <Cell col="12" colspan="4" displaytype="text" text="식재료비실적"/>
                <Cell col="16" colspan="6" displaytype="text" text="식재료율(%)"/>
                <Cell col="22" rowspan="2" displaytype="text" text="재고금액"/>
                <Cell col="23" colspan="3" displaytype="text" text="재고비율(%)"/>
                <Cell row="1" col="6" displaytype="text" text="당월계획"/>
                <Cell row="1" col="7" displaytype="text" text="기간전망"/>
                <Cell row="1" col="8" text="기간예상"/>
                <Cell row="1" col="9" displaytype="text" text="기간실적"/>
                <Cell row="1" col="10" displaytype="text" text="계획대비"/>
                <Cell row="1" col="11" displaytype="text" text="전망대비"/>
                <Cell row="1" col="12" displaytype="text" text="계"/>
                <Cell row="1" col="13" displaytype="text" text="전산구매"/>
                <Cell row="1" col="14" displaytype="text" text="현지구매"/>
                <Cell row="1" col="15" displaytype="text" text="직원식대(예상)"/>
                <Cell row="1" col="16" displaytype="text" text="당월계획"/>
                <Cell row="1" col="17" displaytype="text" text="기간전망"/>
                <Cell row="1" col="18" displaytype="text" text="기간예상"/>
                <Cell row="1" col="19" displaytype="text" text="기간실적"/>
                <Cell row="1" col="20" displaytype="text" text="계획대비"/>
                <Cell row="1" col="21" displaytype="text" text="전망대비"/>
                <Cell row="1" col="23" displaytype="text" text="월말목표"/>
                <Cell row="1" col="24" displaytype="text" text="실적"/>
                <Cell row="1" col="25" displaytype="text" text="차이"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:left;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:OPEN_TYPE"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:LOC_NAME"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:JOB_NAME"/>
                <Cell col="4" displaytype="text" style="align:left;" text="bind:SUB_JOB_NAME"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:UPJANGNM"/>
                <Cell col="6" displaytype="number" style="align: ;" text="bind:PLAN_TRX_AMT"/>
                <Cell col="7" displaytype="number" style="align: ;" text="bind:PROSPECT_TRX_AMT"/>
                <Cell col="8" displaytype="number" style="align: ;" text="bind:EXPECT_SALE"/>
                <Cell col="9" displaytype="number" style="align: ;" text="bind:RESULT_TRX_AMT"/>
                <Cell col="10" displaytype="number" style="align: ;" text="bind:AMT_PLAN_COMP_RATE" mask="#,##0.0%"/>
                <Cell col="11" displaytype="number" style="align: ;" text="bind:AMT_PRO_COMP_RATE" mask="#,##0.0%"/>
                <Cell col="12" displaytype="number" style="align: ;" text="bind:TOTAL_COST"/>
                <Cell col="13" displaytype="number" style="align: ;" text="bind:TRANS_COST_AMT"/>
                <Cell col="14" displaytype="number" style="align: ;" text="bind:LOCAL_COST_AMT"/>
                <Cell col="15" displaytype="number" style="align: ;" text="bind:EMP_COST_AMT"/>
                <Cell col="16" displaytype="number" style="align: ;" text="bind:PLAN_RATE"/>
                <Cell col="17" displaytype="number" style="align: ;" text="bind:PROSPECT_RATE"/>
                <Cell col="18" displaytype="number" style="align: ;" text="bind:EXPECT_RATE"/>
                <Cell col="19" displaytype="number" style="align: ;" text="bind:RESULT_RATE"/>
                <Cell col="20" displaytype="text" style="align: ;color:EXPR(iif(COST_PLAN_COMP_RATE==0, &quot;-1&quot;, iif(COST_PLAN_COMP_RATE&gt;0, &quot;#FF0000&quot;, &quot;#0000FF&quot;)));" text="bind:COST_PLAN_COMP_RATE" expr="expr:iif(COST_PLAN_COMP_RATE==0, &quot;0%P&quot;, iif(COST_PLAN_COMP_RATE&gt;0, &quot;↑&quot; + Math.abs(COST_PLAN_COMP_RATE) + &quot;%P&quot;, &quot;↓&quot;+ Math.abs(COST_PLAN_COMP_RATE) + &quot;%P&quot;))"/>
                <Cell col="21" displaytype="text" style="align: ;color:EXPR(iif(COST_PROSPECT_COMP_RATE==0, &quot;-1&quot;, iif(COST_PROSPECT_COMP_RATE&gt;0, &quot;#FF0000&quot;, &quot;#0000FF&quot;)));" text="bind:COST_PROSPECT_COMP_RATE" expr="expr:iif(COST_PROSPECT_COMP_RATE==0, &quot;0%P&quot;, iif(COST_PROSPECT_COMP_RATE&gt;0, &quot;↑&quot; + Math.abs(COST_PROSPECT_COMP_RATE) + &quot;%P&quot;, &quot;↓&quot;+ Math.abs(COST_PROSPECT_COMP_RATE) + &quot;%P&quot;))"/>
                <Cell col="22" displaytype="number" style="align: ;" text="bind:STOCK_AMT"/>
                <Cell col="23" displaytype="number" style="align: ;" text="bind:GOAL_STOCK_RATE" mask="#,##0.0%"/>
                <Cell col="24" displaytype="number" style="align: ;" text="bind:RESULT_STOCK_RATE" mask="#,##0.0%"/>
                <Cell col="25" displaytype="number" style="align: ;" text="bind:STOCK_GAP" mask="#,##0.0%"/>
              </Band>
              <Band id="summary">
                <Cell displaytype="text" style="align:left;"/>
                <Cell col="1" displaytype="text" style="align:left;"/>
                <Cell col="2" displaytype="text" style="align:left;"/>
                <Cell col="3" displaytype="text" style="align:left;"/>
                <Cell col="4" displaytype="text" style="align:left;"/>
                <Cell col="5" displaytype="text" style="align:left;"/>
                <Cell col="6" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getSum(&quot;PLAN_TRX_AMT&quot;))"/>
                <Cell col="7" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getSum(&quot;PROSPECT_TRX_AMT&quot;))"/>
                <Cell col="8" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getSum(&quot;EXPECT_SALE&quot;))"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getSum(&quot;RESULT_TRX_AMT&quot;))"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(Math.round(getSum(&quot;RESULT_TRX_AMT&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1))" mask="#,##0.0%"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(Math.round(getSum(&quot;RESULT_TRX_AMT&quot;)/getSum(&quot;PROSPECT_TRX_AMT&quot;)*100,1))" mask="#,##0.0%"/>
                <Cell col="12" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getSum(&quot;TOTAL_COST&quot;))"/>
                <Cell col="13" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getSum(&quot;TRANS_COST_AMT&quot;))"/>
                <Cell col="14" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getSum(&quot;LOCAL_COST_AMT&quot;))"/>
                <Cell col="15" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getSum(&quot;EMP_COST_AMT&quot;))"/>
                <Cell col="16" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(Math.round(getSum(&quot;PLAN_COST&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1))"/>
                <Cell col="17" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(Math.round(getSum(&quot;PROSPECT_COST&quot;)/getSum(&quot;PROSPECT_TRX_AMT&quot;)*100,1))"/>
                <Cell col="18" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(Math.round(getSum(&quot;EXPECT_COST&quot;)/getSum(&quot;EXPECT_SALE&quot;)*100,1))"/>
                <Cell col="19" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1))"/>
                <Cell col="20" displaytype="text" style="align:right;color:EXPR(iif((fn_clearNaN(Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1))-fn_clearNaN(Math.round(getSum(&quot;PLAN_COST&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1)))==0, &quot;-1&quot;, iif((Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PLAN_COST&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1))&gt;0, &quot;#FF0000&quot;, &quot;#0000FF&quot;)));" expr="expr:fn_clearNaN(iif((Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PLAN_COST&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1)))==0, &quot;0%P&quot;, iif((Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PLAN_COST&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1))&gt;0, &quot;↑&quot; + (Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PLAN_COST&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1)) + &quot;%P&quot;, &quot;↓&quot;+ Math.abs(Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PLAN_COST&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1)) + &quot;%P&quot;)))"/>
                <Cell col="21" displaytype="text" style="align:right;color:EXPR(iif((fn_clearNaN(Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1))-fn_clearNaN(Math.round(getSum(&quot;PROSPECT_COST&quot;)/getSum(&quot;PROSPECT_TRX_AMT&quot;)*100,1)))==0, &quot;-1&quot;, iif((Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PROSPECT_COST&quot;)/getSum(&quot;PROSPECT_TRX_AMT&quot;)*100,1))&gt;0, &quot;#FF0000&quot;, &quot;#0000FF&quot;)));" expr="expr:fn_clearNaN(iif((Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PROSPECT_COST&quot;)/getSum(&quot;PROSPECT_TRX_AMT&quot;)*100,1))==0, &quot;0%P&quot;, iif((Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PROSPECT_COST&quot;)/getSum(&quot;PROSPECT_TRX_AMT&quot;)*100,1))&gt;0, &quot;↑&quot; + (Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PROSPECT_COST&quot;)/getSum(&quot;PROSPECT_TRX_AMT&quot;)*100,1)) + &quot;%P&quot;, &quot;↓&quot;+ Math.abs(Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PROSPECT_COST&quot;)/getSum(&quot;PROSPECT_TRX_AMT&quot;)*100,1)) + &quot;%P&quot;)))"/>
                <Cell col="22" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getSum(&quot;STOCK_AMT&quot;))"/>
                <Cell col="23" displaytype="text" style="align:left;"/>
                <Cell col="24" displaytype="text" style="align:left;"/>
                <Cell col="25" displaytype="text" style="align:left;"/>
              </Band>
            </Format>
            <Format id="Default0">
              <Columns>
                <Column size="20" band="left"/>
                <Column size="125" band="left"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="100"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="운영부서"/>
                <Cell col="2" colspan="6" displaytype="text" text="매출액"/>
                <Cell col="8" colspan="4" displaytype="text" text="식재료비실적"/>
                <Cell col="12" colspan="6" displaytype="text" text="식재료율(%)"/>
                <Cell col="18" rowspan="2" displaytype="text" text="재고금액"/>
                <Cell row="1" col="2" displaytype="text" text="당월계획"/>
                <Cell row="1" col="3" displaytype="text" text="기간전망"/>
                <Cell row="1" col="4" text="기간예상"/>
                <Cell row="1" col="5" displaytype="text" text="기간실적"/>
                <Cell row="1" col="6" displaytype="text" text="계획대비"/>
                <Cell row="1" col="7" displaytype="text" text="전망대비"/>
                <Cell row="1" col="8" displaytype="text" text="계"/>
                <Cell row="1" col="9" displaytype="text" text="전산구매"/>
                <Cell row="1" col="10" displaytype="text" text="현지구매"/>
                <Cell row="1" col="11" displaytype="text" text="직원식대(예상)"/>
                <Cell row="1" col="12" displaytype="text" text="당월계획"/>
                <Cell row="1" col="13" displaytype="text" text="기간전망"/>
                <Cell row="1" col="14" displaytype="text" text="기간예상"/>
                <Cell row="1" col="15" displaytype="text" text="기간실적"/>
                <Cell row="1" col="16" displaytype="text" text="계획대비"/>
                <Cell row="1" col="17" displaytype="text" text="전망대비"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:left;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:TM_NM"/>
                <Cell col="2" displaytype="number" style="align: ;" text="bind:PLAN_TRX_AMT"/>
                <Cell col="3" displaytype="number" style="align: ;" text="bind:PROSPECT_TRX_AMT"/>
                <Cell col="4" displaytype="number" style="align: ;" text="bind:EXPECT_SALE"/>
                <Cell col="5" displaytype="number" style="align: ;" text="bind:RESULT_TRX_AMT"/>
                <Cell col="6" displaytype="number" style="align: ;" text="bind:AMT_PLAN_COMP_RATE" mask="#,##0.0%"/>
                <Cell col="7" displaytype="number" style="align: ;" text="bind:AMT_PRO_COMP_RATE" mask="#,##0.0%"/>
                <Cell col="8" displaytype="number" style="align: ;" text="bind:TOTAL_COST"/>
                <Cell col="9" displaytype="number" style="align: ;" text="bind:TRANS_COST_AMT"/>
                <Cell col="10" displaytype="number" style="align: ;" text="bind:LOCAL_COST_AMT"/>
                <Cell col="11" displaytype="number" style="align: ;" text="bind:EMP_COST_AMT"/>
                <Cell col="12" displaytype="number" style="align: ;" text="bind:PLAN_RATE"/>
                <Cell col="13" displaytype="number" style="align: ;" text="bind:PROSPECT_RATE"/>
                <Cell col="14" displaytype="number" style="align: ;" text="bind:EXPECT_RATE"/>
                <Cell col="15" displaytype="number" style="align: ;" text="bind:RESULT_RATE"/>
                <Cell col="16" displaytype="text" style="align: ;color:EXPR(iif(COST_PLAN_COMP_RATE==0, &quot;-1&quot;, iif(COST_PLAN_COMP_RATE&gt;0, &quot;#FF0000&quot;, &quot;#0000FF&quot;)));" text="bind:COST_PLAN_COMP_RATE" expr="expr:iif(COST_PLAN_COMP_RATE==0, &quot;0%P&quot;, iif(COST_PLAN_COMP_RATE&gt;0, &quot;↑&quot; + Math.abs(COST_PLAN_COMP_RATE) + &quot;%P&quot;, &quot;↓&quot;+ Math.abs(COST_PLAN_COMP_RATE) + &quot;%P&quot;))"/>
                <Cell col="17" displaytype="text" style="align: ;color:EXPR(iif(COST_PROSPECT_COMP_RATE==0, &quot;-1&quot;, iif(COST_PROSPECT_COMP_RATE&gt;0, &quot;#FF0000&quot;, &quot;#0000FF&quot;)));" text="bind:COST_PROSPECT_COMP_RATE" expr="expr:iif(COST_PROSPECT_COMP_RATE==0, &quot;0%P&quot;, iif(COST_PROSPECT_COMP_RATE&gt;0, &quot;↑&quot; + Math.abs(COST_PROSPECT_COMP_RATE) + &quot;%P&quot;, &quot;↓&quot;+ Math.abs(COST_PROSPECT_COMP_RATE) + &quot;%P&quot;))"/>
                <Cell col="18" displaytype="number" style="align: ;" text="bind:STOCK_AMT"/>
              </Band>
              <Band id="summary">
                <Cell displaytype="text" style="align:left;"/>
                <Cell col="1" displaytype="text" style="align:left;"/>
                <Cell col="2" displaytype="number" style="align: ;" expr="expr:getSum(&quot;PLAN_TRX_AMT&quot;)"/>
                <Cell col="3" displaytype="number" style="align: ;" expr="expr:getSum(&quot;PROSPECT_TRX_AMT&quot;)"/>
                <Cell col="4" displaytype="number" style="align: ;" expr="expr:getSum(&quot;EXPECT_SALE&quot;)"/>
                <Cell col="5" displaytype="number" style="align: ;" expr="expr:getSum(&quot;RESULT_TRX_AMT&quot;)"/>
                <Cell col="6" displaytype="number" style="align: ;" expr="expr:Math.round(getSum(&quot;RESULT_TRX_AMT&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1)" mask="#,##0.0%"/>
                <Cell col="7" displaytype="number" style="align: ;" expr="expr:Math.round(getSum(&quot;RESULT_TRX_AMT&quot;)/getSum(&quot;PROSPECT_TRX_AMT&quot;)*100,1)" mask="#,##0.0%"/>
                <Cell col="8" displaytype="number" style="align: ;" expr="expr:getSum(&quot;TOTAL_COST&quot;)"/>
                <Cell col="9" displaytype="number" style="align: ;" expr="expr:getSum(&quot;TRANS_COST_AMT&quot;)"/>
                <Cell col="10" displaytype="number" style="align: ;" expr="expr:getSum(&quot;LOCAL_COST_AMT&quot;)"/>
                <Cell col="11" displaytype="number" style="align: ;" expr="expr:getSum(&quot;EMP_COST_AMT&quot;)"/>
                <Cell col="12" displaytype="number" style="align: ;" expr="expr:Math.round(getSum(&quot;PLAN_COST&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1)"/>
                <Cell col="13" displaytype="number" style="align: ;" expr="expr:Math.round(getSum(&quot;PROSPECT_COST&quot;)/getSum(&quot;PROSPECT_TRX_AMT&quot;)*100,1)"/>
                <Cell col="14" displaytype="number" style="align: ;" expr="expr:Math.round(getSum(&quot;EXPECT_COST&quot;)/getSum(&quot;EXPECT_SALE&quot;)*100,1)"/>
                <Cell col="15" displaytype="number" style="align: ;" expr="expr:Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)"/>
                <Cell col="16" displaytype="text" style="align: ;color:EXPR(iif((Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PLAN_COST&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1))==0, &quot;-1&quot;, iif((Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PLAN_COST&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1))&gt;0, &quot;#FF0000&quot;, &quot;#0000FF&quot;)));" expr="expr:iif((Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PLAN_COST&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1))==0, &quot;0%P&quot;, iif((Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PLAN_COST&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1))&gt;0, &quot;↑&quot; + Math.abs(Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PLAN_COST&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1)) + &quot;%P&quot;, &quot;↓&quot;+ Math.abs(Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PLAN_COST&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1)) + &quot;%P&quot;))"/>
                <Cell col="17" displaytype="text" style="align: ;color:EXPR(iif((Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PLAN_COST&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1))==0, &quot;-1&quot;, iif((Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PLAN_COST&quot;)/getSum(&quot;PLAN_TRX_AMT&quot;)*100,1))&gt;0, &quot;#FF0000&quot;, &quot;#0000FF&quot;)));" expr="expr:iif((Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PROSPECT_COST&quot;)/getSum(&quot;PROSPECT_TRX_AMT&quot;)*100,1))==0, &quot;0%P&quot;, iif((Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PROSPECT_COST&quot;)/getSum(&quot;PROSPECT_TRX_AMT&quot;)*100,1))&gt;0, &quot;↑&quot; + Math.abs(Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PROSPECT_COST&quot;)/getSum(&quot;PROSPECT_TRX_AMT&quot;)*100,1)) + &quot;%P&quot;, &quot;↓&quot;+ Math.abs(Math.round(getSum(&quot;TOTAL_COST&quot;)/getSum(&quot;RESULT_TRX_AMT&quot;)*100,1)-Math.round(getSum(&quot;PROSPECT_COST&quot;)/getSum(&quot;PROSPECT_TRX_AMT&quot;)*100,1)) + &quot;%P&quot;))"/>
                <Cell col="18" displaytype="number" style="align: ;" expr="expr:getSum(&quot;STOCK_AMT&quot;)"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Radio id="rdo_PRICE_TYPE" index="0" taborder="14" value="0" position="absolute 733 66 832 87" codecolumn="codecolumn" datacolumn="datacolumn" columncount="2">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">관리</Col>
                <Col id="datacolumn">관리</Col>
              </Row>
              <Row>
                <Col id="codecolumn">재무</Col>
                <Col id="datacolumn">재무</Col>
              </Row>
            </Rows>
          </Dataset>
        </Radio>
        <Static id="Static0" text="사업구분" position="absolute 15 42 79 63" class="sta_WFSA_label"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" displayrowcount="10" id="cbo_SAUP_TYPE" index="0" innerdataset="ds_SAUP_TYPE" taborder="3" tooltiptext="사업구분" position="absolute 83 40 183 61"/>
        <Static id="Static3" text="직군" position="absolute 213 42 283 63" class="sta_WFSA_label"/>
        <Combo codecolumn="JOB_CD" datacolumn="JOB_NAME" displayrowcount="10" id="cbo_Job" index="0" innerdataset="@ds_Job" taborder="4" tooltiptext="직군" position="absolute 288 40 388 61"/>
        <Static id="Static03" text="운영부서" position="absolute 418 42 488 63" class="sta_WFSA_label"/>
        <Edit autoselect="true" id="ed_TmNm" ontextchanged="ed_TmNm_OnChanged" onkeydown="ed_TmNm_OnKeyDown" readonly="true" taborder="5" tooltiptext="운영부서" position="absolute 485 40 615 61"/>
        <Button id="btn_Tm" onclick="btn_Tm_OnClick" taborder="6" tabstop="false" text="" position="absolute 614 40 636 61" class="btn_WF_popSearch" image=""/>
        <Static id="Static4" text="사업장" position="absolute 729 42 801 63" class="sta_WFSA_label"/>
        <Edit autoselect="true" id="ed_UpjangNm" ontextchanged="ed_UpjangNm_OnChanged" onkeydown="ed_UpjangNm_OnKeyDown" readonly="true" taborder="7" tooltiptext="사업장" position="absolute 785 40 944 61"/>
        <Button id="btn_Upjang" onclick="btn_Upjang_OnClick" taborder="8" tabstop="false" text="" position="absolute 943 40 965 61" class="btn_WF_popSearch" image=""/>
        <Static id="Static1" text="기간" position="absolute 418 68 488 89" class="sta_WFSA_label"/>
        <MaskEdit id="me_START_DATE" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="12" tooltiptext="시작일" type="string" position="absolute 485 66 564 87" style="align:center;"/>
        <Button id="btn_FromDate" onclick="g_CalButton_OnClick" taborder="15" tabstop="false" userdata="me_START_DATE" position="absolute 563 66 585 87" class="btn_WF_cal" text="" image=""/>
        <Static id="Static8" text="~" position="absolute 587 67 596 88"/>
        <MaskEdit id="me_END_DATE" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="13" tooltiptext="종료일" type="string" position="absolute 599 66 678 87" style="align:center;"/>
        <Button id="btn_ToDate" onclick="g_CalButton_OnClick" taborder="16" tabstop="false" userdata="me_END_DATE" position="absolute 677 66 699 87" class="btn_WF_cal" text="" image=""/>
        <Static id="Static2" text="지역" position="absolute 15 68 79 89" class="sta_WFSA_label"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" displayrowcount="10" id="cbo_Loc" index="0" innerdataset="@ds_Loc" taborder="10" position="absolute 83 66 183 87"/>
        <Static id="Static5" text="신규/기존" position="absolute 213 68 283 89" class="sta_WFSA_label"/>
        <Combo codecolumn="OPEN_CODE" datacolumn="OPEN_NAME" displayrowcount="10" id="cbo_Open" index="0" innerdataset="ds_Open" taborder="11" position="absolute 288 66 388 87" value="전체" text="전체"/>
        <Static id="Static6" text="단위: 원(VAT 별도)" visible="false" position="absolute 730 99 863 120" style="border:0 none transparent ;"/>
        <CheckBox id="chk0" taborder="27" value="false" position="absolute 876 66 964 87" falsevalue="0" truevalue="1"/>
        <CheckBox id="chk1" taborder="28" value="false" position="absolute 965 66 1053 87" falsevalue="0" truevalue="1"/>
        <CheckBox id="chk2" taborder="29" value="false" position="absolute 1054 66 1142 87" falsevalue="0" truevalue="1"/>
        <CheckBox id="chk3" taborder="30" value="false" position="absolute 876 98 964 119" falsevalue="0" truevalue="1"/>
        <CheckBox id="chk4" taborder="31" value="false" position="absolute 965 98 1053 119" truevalue="1" falsevalue="0"/>
        <CheckBox id="chk5" taborder="32" value="false" position="absolute 1054 98 1142 119" truevalue="1" falsevalue="0"/>
        <CheckBox id="chk_HIS" taborder="9" text=" 2012년도 이전자료 조회" value="false" position="absolute 995 40 1144 61"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="34" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 1 123 451 136"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 123 450 128"/>
        <Static id="Static34" text="W10" visible="false" position="absolute 73 30 83 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static35" text="W30" visible="false" position="absolute 183 40 213 87" style="background:#ff000055;align:center middle;"/>
        <Static id="Static43" text="W10" visible="false" position="absolute 0 30 1237 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static44" text="W10" visible="false" position="absolute 0 87 1237 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static45" text="W15" visible="false" position="absolute 0 30 15 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static51" text="W05." visible="false" position="absolute 0 61 1237 66" style="background:#ff000055;align:center middle;"/>
        <Static id="Static14" text="W10" visible="false" position="absolute 278 30 288 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static17" text="W30" visible="false" position="absolute 388 40 418 87" style="background:#ff000055;align:center middle;"/>
        <Static id="Static18" text="W10" visible="false" position="absolute 475 30 485 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static19" text="W30" visible="false" position="absolute 699 40 729 87" style="background:#ff000055;align:center middle;"/>
        <Static id="Static20" text="W10" visible="false" position="absolute 775 30 785 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static30" text="h06" onclick="Static03_onclick" class="Guide01_AreaRed" visible="false" position="absolute 1093 123 1237 129" anchor="top right"/>
        <Static id="Static31" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 1093 149 1237 154" anchor="top right"/>
        <Static id="Static07" text="h13" class="Guide01_AreaRed" visible="false" position="absolute -1 352 449 365"/>
        <Static id="Static09" text="W30" visible="false" position="absolute 965 40 995 87" style="background:#ff000055;align:center middle;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_Job">
        <ColumnInfo>
          <Column id="JOB_CD" size="256" type="STRING"/>
          <Column id="JOB_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="JOB_CD">000</Col>
            <Col id="JOB_NAME">- 전체 -</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_SAUP_TYPE">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_input">
        <ColumnInfo>
          <Column id="SAUP_TYPE" size="256" type="STRING"/>
          <Column id="TM_CD" size="256" type="STRING"/>
          <Column id="TM_NM" size="256" type="STRING"/>
          <Column id="JOB_CD" size="256" type="STRING"/>
          <Column id="SUB_JOB_CD" size="256" type="STRING"/>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="UPJANG_NM" size="256" type="STRING"/>
          <Column id="START_DATE" size="256" type="STRING"/>
          <Column id="END_DATE" size="256" type="STRING"/>
          <Column id="PRICE_TYPE" size="256" type="STRING"/>
          <Column id="LOC_CD" size="256" type="STRING"/>
          <Column id="OPEN_TYPE" size="256" type="STRING"/>
          <Column id="CHK_HIS" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CHK_HIS"/>
            <Col id="END_DATE"/>
            <Col id="JOB_CD"/>
            <Col id="LOC_CD"/>
            <Col id="OPEN_TYPE">전체</Col>
            <Col id="PRICE_TYPE">관리</Col>
            <Col id="SAUP_TYPE"/>
            <Col id="START_DATE"/>
            <Col id="SUB_JOB_CD"/>
            <Col id="TM_CD"/>
            <Col id="TM_NM"/>
            <Col id="UPJANG"/>
            <Col id="UPJANG_NM"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Loc">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE"/>
            <Col id="CODE_NAME"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Open">
        <ColumnInfo>
          <Column id="OPEN_CODE" size="256" type="STRING"/>
          <Column id="OPEN_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="OPEN_CODE">전체</Col>
            <Col id="OPEN_NAME">전체</Col>
          </Row>
          <Row>
            <Col id="OPEN_CODE">신규</Col>
            <Col id="OPEN_NAME">신규</Col>
          </Row>
          <Row>
            <Col id="OPEN_CODE">기존</Col>
            <Col id="OPEN_NAME">기존</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list">
        <ColumnInfo>
          <Column id="AMT_PRO_COMP_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="AMT_PLAN_COMP_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="COST_PLAN_COMP_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="COST_PROSPECT_COMP_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="EMP_COST_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="EXPECT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="GOAL_STOCK_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="JOB_NAME" size="20" type="STRING"/>
          <Column id="LOCAL_COST_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="PLAN_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="PLAN_TRX_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="PROSPECT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="PROSPECT_TRX_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="RESULT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="RESULT_STOCK_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="RESULT_TRX_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="STOCK_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="STOCK_GAP" size="22" type="BIGDECIMAL"/>
          <Column id="SUB_JOB_NAME" size="20" type="STRING"/>
          <Column id="TOTAL_COST" size="22" type="BIGDECIMAL"/>
          <Column id="TRANS_COST_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="50" type="STRING"/>
          <Column id="TM_CD" size="256" type="STRING"/>
          <Column id="TM_NM" size="256" type="STRING"/>
          <Column id="LOC_NAME" size="256" type="STRING"/>
          <Column id="OPEN_TYPE" size="256" type="STRING"/>
          <Column id="EXPECT_SALE" size="22" type="BIGDECIMAL"/>
          <Column id="EXPECT_COST" size="22" type="BIGDECIMAL"/>
          <Column id="PLAN_COST" size="22" type="BIGDECIMAL"/>
          <Column id="PROSPECT_COST" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_common"/>
    </Objects>
    <Bind>
      <BindItem id="rdo_PRICE_TYPE_value" compid="rdo_PRICE_TYPE" propid="value" datasetid="ds_input" columnid="PRICE_TYPE"/>
      <BindItem id="cbo_SAUP_TYPE_value" compid="cbo_SAUP_TYPE" propid="value" datasetid="ds_Input" columnid="SAUP_TYPE"/>
      <BindItem id="cbo_Job_value" compid="cbo_Job" propid="value" datasetid="ds_Input" columnid="JOB_CD"/>
      <BindItem id="ed_TmNm_value" compid="ed_TmNm" propid="value" datasetid="ds_Input" columnid="TM_NM"/>
      <BindItem id="ed_UpjangNm_value" compid="ed_UpjangNm" propid="value" datasetid="ds_Input" columnid="UPJANG_NM"/>
      <BindItem id="me_START_DATE_value" compid="me_START_DATE" propid="value" datasetid="ds_input" columnid="START_DATE"/>
      <BindItem id="me_END_DATE_value" compid="me_END_DATE" propid="value" datasetid="ds_input" columnid="END_DATE"/>
      <BindItem id="cbo_Loc_value" compid="cbo_Loc" propid="value" datasetid="ds_input" columnid="LOC_CD"/>
      <BindItem id="cbo_Open_value" compid="cbo_Open" propid="value" datasetid="ds_input" columnid="OPEN_TYPE"/>
      <BindItem id="chk_HIS_value" compid="chk_HIS" propid="value" datasetid="ds_input" columnid="CHK_HIS"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : IFIS/메뉴관리/ 공통/기본템플릿  
 * 프로그램명   : 공통 기본 템플릿
 * 기      능   : 공통 기본 템플릿 제공
 * 작  성  자   : 한화 S&C SI 사업부 프로젝트 팀 박종세=박용대
 * 작성  일자   : 2007-12-04
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
                1)박은규 2012-11-05 CSR#(CH201210_00143) 요청자:박현정(FS기획팀)
                  sc조회조건 추가(공통:MA0046)
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//========================================================================================= 
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::lib_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"
//@@컨버터에서 주석처리 #include "lib::fs_common.js"
//@@컨버터에서 주석처리 #include "lib::po_common.js"

//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================

//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	   //폼 초기화
		fn_InitForm(obj);
}

//폼 초기화
function fn_InitForm(obj)
{
	// action 정보 생성 초기화 
	fsp_init(this);		
	
	//PO 정보호출
	//fn_PoCommon();
	
	// 폼 데이터 초기화
	fn_InitData(false);
}

// 폼데이터 초기화 
function fn_InitData(blnAllClear)
{



	// 권한에 따른 버튼 활성화 및 디폴트값 설정
	// fn_SetAuth(strEdDept, strBtnDept, strEdUpjang, strBtnUpjang)
	//fn_SetAuth("ed_TmNm", "btn_Tm", "ed_UpjangNm", "btn_Upjang");
	fn_SetAuth2("ed_TmNm", "btn_Tm", "ed_UpjangNm", "btn_Upjang", "ds_input", "TM_CD", "TM_NM", "UPJANG", "UPJANGNM");
	
	// AuthLevel 설정
	//if( g_AuthLevel == "12" ) { // 리더
		// ed_Leader = g_Name;
		// ed_Leader.UserData = g_EmpNo;
		// ed_Leader.Enable = false;
		// btn_Leader.Enable = false;
	// } else if( g_AuthLevel == "14" ) {	// 소팀장
		// ed_Team = g_Name;
		// ed_Team.UserData = g_EmpNo;
		// ed_Team.Enable = false;
		// btn_Team.Enable = false;
	// }
	
	//권한에 따라 포커스 설정
	// if( ed_Tm.Enable ) {
		// ed_Tm.SetFocus();
	// } else {
		// if( ed_Team.Enable ) {
			// ed_Team.SetFocus();
		// } else {
			// if( ed_Leader.Enable ) {
				// ed_Leader.SetFocus();
			// } else {
				// if( ed_Upjang.Enable ) {
					// ed_Upjang.SetFocus();
				// } else {
					// me_From.SetFocus();
				// }
			// }
		// }
	// }




    //직군콤보
	fn_SetComboBox();
	
	
	//지역가져오기
	//공통코드조회
	var v_fil_cond;
	var v_ds = fn_common_code("'MA0040'","","","all","Y");

	// 지역(ds_LOC, GROUP_CODE : 'MA0040')
	v_fil_cond = "GROUP_CODE == 'MA0040'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_Loc,v_ds.name);	
	
	cbo_Loc.index = 0;
	
	//날짜 초기화
	//this.me_START_DATE.Value = left(today(),6)+"01";
	this.me_START_DATE.value = gfn_today();
	this.me_END_DATE.value   = gfn_today();

	//사업부 체크박스 설정(SC)
//============================================================================================
//(2012-11-05 추가) 시작
// 박은규 2012-11-05 CSR#(CH201210_00143) 요청자:박현정(FS기획팀)
// sc조회조건 추가(공통:MA0046)
//============================================================================================
	fn_SetChkBox();
//============================================================================================
//(2012-11-05 추가) 끝
//============================================================================================
    
    //백업테이블 조회 설정
    this.chk_HIS.value = 'N';
}

//초기화 콜백함수
function fn_After_InitData()
{
	
}

//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*------------------------------------------------------------
	1. Function ID : fn_Search()
	2. 개       요 : 업무프로세스에 따른 조회작업
	3. 기       능 : 검색버튼 입력 시 처리되는 작업
	4. 인 수 설 명:
*------------------------------------------------------------*/
function fn_search()
{

	//시작일
	if(!mfn_Chk_Obj_MustInput(me_START_DATE)) return false;   	
	//종료일
	if(!mfn_Chk_Obj_MustInput(me_END_DATE)) return false;   
	
	//시작일과 종료일이 다른 달일 경우 에러발생
	if(gfn_left(me_START_DATE.value,6)<>gfn_left(me_END_DATE.value,6))
	{
		g_Message("EE", "시작일과 종료일은 같은 달이어야 합니다.");
		return false;
	}
		
	//운영부서 미 선택시
	if(gfn_length(ed_TmNm.value)==0)
	{
		this.grd_list.formatid = "Default0";
	}
	
	//운영부서 선택시
	if((gfn_length(ed_TmNm.value)<>0)||(gfn_length(ed_UpjangNm.value)<>0))
	{
		this.grd_list.formatid = "Default";
		//ds_input.SetColumn(0,"TM_CD",ed_TmNm.UserData);
	}
	
	//백업테이블 조회 설정
	ds_input.setColumn(0, "CHK_HIS", chk_HIS.value);
	
	// 초기화
	ds_list.clearData();
	var actionName, cmdName, inData, outData, otherArg, callBackFnc; 
	
	
	ds_input.setColumn(0,"LOC_CD", gfn_nvl(cbo_Loc.value));
	ds_input.setColumn(0,"JOB_CD", gfn_nvl(cbo_Job.value));
	
	//trace(ds_input.saveXML());

	actionName		= "FSM00370V_S001";
	cmdName			= "U_svc::" + "fs/fsm/FSM00370V_S001.jsp";
	inData			= "ds_input=ds_input";
	outData			= "ds_list=ds_list";
	callBackFnc		= "fn_After_Search";
//============================================================================================
//(2012-11-05 추가) 시작
// 박은규 2012-11-05 CSR#(CH201210_00143) 요청자:박현정(FS기획팀)
// sc조회조건 추가(공통:MA0046)
//============================================================================================
	//SC조회조건
	var chkObj, strSCLst;
	
	strSCLst='';
	
	for(var i=0; i<ds_common.rowcount; i++) //총 체크박스 6개
	{
		chkObj = eval("chk"+i);
		
		
	//	trace('chk => ' + chkObj.value);
		
		if (chkObj.value == 1)  strSCLst  += ",'" + gfn_nvl(chkObj.userdata) + "'";
	}
	otherArg = "strSCLst=" +  wrapQuote(gfn_subStr(strSCLst,1)) ;
	
	
	//trace('otherArg => ' + otherArg);
	
	//trace(ds_input.saveXML());
	
//============================================================================================
//(2012-11-05 추가) 끝
//============================================================================================

	jsp_transaction(this, actionName, cmdName, inData, outData, otherArg, callBackFnc, false, false, true);
}

// 조회 후 콜백 함수 
function fn_After_Search(cd,errmsg)
{
	if (cd!=0)
		g_Message("EE","시스템오류 ! 전산 담당자에게 문의 하세요.");
	else
	{
		if (ds_list.rowcount <= 0) {
			g_Message("EE","조회된 내용이 없습니다.");
			return false;
			}
			
		cbo_Loc.index = 0;
	}
}

// 조회 조건 검색
function fn_Chk_SearchKey()
{
   //체크로직- 틀리면 return false;    
   return true;
}


/*------------------------------------------------------------
	1. Function ID : fn_Print()
	2. 개       요 : 업무프로세스에 따른 인쇄 처리
	3. 기       능 : 인쇄버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*------------------------------------------------------------*/
function fn_print()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Close()
	2. 개       요 : 업무프로세스에 따른 폼 종료 
	3. 기       능 : 닫기버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*------------------------------------------------------------*/
function fn_Close()
{
	this.close();
}

/*------------------------------------------------------------
	1. Function ID : fn_Help()
	2. 개       요 : 업무프로세스에 따른 도움말 
	3. 기       능 : 도움말버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*------------------------------------------------------------*/
function fn_help()
{
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*------------------------------------------------------------
	1. Function    : fn_SetComboBox()
	2. Description : 검색조건 ComboBox Setting
	3. Arguments   : 
	4. History     : 2008. 02. 05 - 최초작성
*------------------------------------------------------------*/
function fn_SetComboBox()
{
	//----------------------------------------------
	//	사업구분콤보
	//----------------------------------------------
	var v_ds;
	var v_fil_cond;
	
	v_ds = fn_common_code("'MA0001'","","","non","Y");

	//-->FS0022 :코너
	v_fil_cond = "CODE <> '004'";
	v_ds.filter(v_fil_cond);
    CopyF(ds_SAUP_TYPE,v_ds.name);	

    ds_input.setColumn(0,"SAUP_TYPE",ds_SAUP_TYPE.getColumn(ds_SAUP_TYPE.rowposition, "CODE"));

	cbo_SAUP_TYPE.index=0;	


	//----------------------------------------------
	// 직군 ComboBox
	//----------------------------------------------
	var v_Args = "";

	fsp_clear(this);
	ds_Job.clearData();
	fsp_addSearch(this,"fs/fsa:FSA00060V_S001");
	fsp_callService(this,"","","","ds_Job=ds_Job",v_Args,"fn_CallBackComboBox","",true);
}

function fn_CallBackComboBox(errCode, errMsg)
{	
	if( errCode != 0 ) {
		return;
	} else {
	}
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
/*------------------------------------------------------------
	1. Function    : btn_Tm_OnClick(obj)
	2. Description : 운영부서(팀) 조회 팝업
	3. Arguments   : 
	4. History     : 2008. 02. 05 - 최초작성
*------------------------------------------------------------*/
function btn_Tm_OnClick(obj:Button, e:ClickEventInfo)
{
	var v_SearchName = "";
	if( gfn_length(gfn_trim(ed_TmNm.value))!= 0 ) {
		v_SearchName = gfn_trim(ed_TmNm.value);
	}
	
	fn_sql_common_setup(strQuery_Team,
						strQuery_TeamKeyField,
						strQuery_TeamValueField,
						strQuery_TeamKeyFieldNM,
						strQuery_TeamValueFieldNM,
						"",
						v_SearchName,
						"",
						strQuery_TeamCaption,
						"TM_CD;TM_NM");
	
    if( gds_sql_common.getColumn(0, "ret_code") != "" ) {
		ds_input.setColumn(0, "TM_CD", gds_sql_common.getColumn(0, "ret_code"));
		ds_input.setColumn(0, "TM_NM", gds_sql_common.getColumn(0, "ret_name"));
		ed_TmNm.value = gds_sql_common.getColumn(0, "ret_name");
		btn_Tm.setFocus();
    } else {
		ds_input.setColumn(0, "TM_CD", "");
		ds_input.setColumn(0, "TM_NM", "");
    }
}
/*------------------------------------------------------------
	1. Function    : btn_Upjang_OnClick(obj)
	2. Description : 사업장 조회 팝업
	3. Arguments   : 
	4. History     : 2008. 02. 05 - 최초작성
*------------------------------------------------------------*/
function btn_Upjang_OnClick(obj:Button, e:ClickEventInfo)
{
	var v_SearchName = "";
	if( gfn_length(gfn_trim(ed_UpjangNm.value))!= 0 ) {
		v_SearchName = gfn_trim(ed_UpjangNm.value);
	}
	
	var v_Query = " SELECT UPJANG, UPJANGNM FROM MAC_UPJANG_V WHERE 1 = 1 ";
	if( gfn_length(gfn_trim(ds_input.getColumn(0,"TM_CD")))!= 0 ) {
		v_Query += " AND TM_CD = '" + gfn_trim(ds_input.getColumn(0,"TM_CD"))+ "' ";
	}
	
	fn_sql_common_setup(v_Query,
						"UPJANG",
						"UPJANGNM",
						"업장코드",
						"업장명",
						"",
						v_SearchName,
						"",
						"사업장조회",
						"UPJANG;UPJANGNM");

    if( gds_sql_common.getColumn(0, "ret_code") != "" ) {
		ds_input.setColumn(0, "UPJANG",   gds_sql_common.getColumn(0, "ret_code"));
		ds_input.setColumn(0, "UPJANG_NM", gds_sql_common.getColumn(0, "ret_name"));
		ed_UpjangNm.value = gds_sql_common.getColumn(0, "ret_name");
		btn_Upjang.setFocus();
    } else {
		ds_input.setColumn(0, "UPJANG",   "");
		ds_input.setColumn(0, "UPJANG_NM", "");
    }
}
/*------------------------------------------------------------
	1. Function    : ed_TmNm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
	2. Description : 운영부서(팀) EditBox 엔터키 입력시 운영부서(팀) 조회 팝업 호출
	3. Arguments   : 
	4. History     : 2008. 02. 05 - 최초작성
*------------------------------------------------------------*/
function ed_TmNm_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if( e.keycode == "13" ) btn_Tm.click();
	if( e.keycode == "46" ) { ed_TmNm.value = ""; ed_TmNm.userdata = ""; }
}
/*------------------------------------------------------------
	1. Function    : ed_UpjangNm_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
	2. Description : 사업장 EditBox 엔터키 입력시 사업장 조회 팝업 호출
	3. Arguments   : 
	4. History     : 2008. 02. 05 - 최초작성
*------------------------------------------------------------*/
function ed_UpjangNm_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if( e.keycode == "13" ) btn_Upjang.click();
	if( e.keycode == "46" ) { ed_UpjangNm.value = ""; ed_UpjangNm.userdata = ""; }
}



/*------------------------------------------------------------
	1. Function    : grd_list_OnCellDblClick(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
	2. Description : 그리드 더블클릭
	3. Arguments   : 
	4. History     : 2008. 02. 04 - 최초작성
*------------------------------------------------------------*/
function grd_list_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{

	//운영팀 리스트가 나온 화면이라면
	if(grd_list.formatid=="Default0")
	{
	
	    //==> 운영팀 내의 업장 리스트가 나오도록 조회한다. ds_input TM_NM TM_CD를 세팅한다.
	    
	    //trace(ds_list.saveXML());
	    
		var TM_NM =	ds_list.getColumn(e.row, "TM_NM");
		var TM_CD = ds_list.getColumn(e.row, "TM_CD");
		 
		ds_input.setColumn(0, "TM_NM", TM_NM);
		ds_input.setColumn(0, "TM_CD", TM_CD);
	    ed_TmNm.value = TM_NM;

		//업장 리스트가 나온 화면으로 전환한다.
		fn_search();
	
		//함수에서 나옴.
		return;
	}


	//업장   리스트가 나온 화면이라면
	if(grd_list.formatid=="Default")
	{
		var strURL = "U_FSM::FSM00371V.xfdl";
		
		var UPJANG     = ds_list.getColumn(e.row, "UPJANG");
		var UPJANG_NM  = ds_list.getColumn(e.row, "UPJANGNM");
		
		var START_DATE = me_START_DATE.value;
		var END_DATE   = me_END_DATE.value;
		var PRICE_TYPE = rdo_PRICE_TYPE.value;
		
		
		var strInArgument = {p_UPJANG:UPJANG,p_UPJANG_NM:UPJANG_NM,p_START_DATE:START_DATE,p_END_DATE:END_DATE,p_PRICE_TYPE:PRICE_TYPE};
	
		gfn_dialog("", strURL,strInArgument);
		
		//함수에서 나옴.
		return;
	}
}




//업장이름이 없으면.... 데이터넷도 지운다.
function ed_UpjangNm_OnChanged(obj:Edit, e:TextChangedEventInfo)
{
	if(gfn_length(e.posttext)==0)
	{
		ds_input.setColumn(0,"UPJANG","");
		ds_input.setColumn(0,"UPJANG_NM","");
		
	}
	
}

//팀이름이 없으면... 데이터셋도 지운다.
function ed_TmNm_OnChanged(obj:Edit, e:TextChangedEventInfo)
{
	if(gfn_length(e.posttext)==0)
	{
		ds_input.setColumn(0,"TM_CD","");
		ds_input.setColumn(0,"TM_NM","");
		
	}
}

// function grd_onHeadClick(obj,nCell,nX,nY,nPivotIndex)
// {
	// G_GridSort(ds_list, obj, nCell);
// }

//============================================================================================
//(2012-11-05 추가) 시작
// 박은규 2012-11-05 CSR#(CH201210_00143) 요청자:박현정(FS기획팀)
// sc조회조건 추가(공통:MA0046)
//============================================================================================
function fn_SetChkBox()
{
	fn_sql_common("P", "SELECT A.CODE, A.CODE_NAME FROM SCC_COMMON_CODE A WHERE GROUP_CODE = 'MA0046' AND A.USE_YN = 'Y'", "", " ORDER BY A.SORT_SEQ");
	
	if (ds_common.rowcount <= 0) return;
	//
	var chkObj;
	
	//trace(ds_common.rowcount);
	
    for(var i=0; i<6; i++) //총 체크박스 6개
	{
		chkObj = eval("chk"+i);
		//
		chkObj.enable = false;
		chkObj.visible = false; 
	}
	
	for(var i=0; i<ds_common.rowcount; i++) //총 체크박스 6개
	{
		chkObj = eval("chk"+i);
		//
		chkObj.enable = true;
		chkObj.visible = true;
		
		if (i < ds_common.rowcount)
		{
 
			chkObj.text     =  ds_common.getColumn(i, "CODE_NAME");
			chkObj.userdata =  ds_common.getColumn(i, "CODE");
 
		}
	}
}
//============================================================================================
//(2012-11-05 추가) 끝
//============================================================================================

function frm_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
	//엔터시 조회
	if ( (e.keycode == 13) && (e.fromreferenceobject == rdo_PRICE_TYPE) ) fn_search();
}
]]></Script>
  </Form>
</FDL>

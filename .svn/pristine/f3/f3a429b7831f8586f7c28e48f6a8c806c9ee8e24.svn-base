<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="GainRateSummary" classname="sam_MasterDetail" position="absolute 0 0 1252 725" titletext="이익율 집계(실적기준)" onload="form_onload">
    <Layouts>
      <Layout>
        <cmpPageObj id="cmpPageObj" titletext="cmpPageObj" taborder="1" scrollbars="none" class="sta_paging_Bg" position="absolute 0 439 1017 463" anchor="left top right"/>
        <Static id="Static06" text="w15" visible="false" position="absolute 1237 0 1252 710" class="Guide01_AreaRed" anchor="top right"/>
        <Static id="Static71" visible="false" position="absolute 0 710 1252 725" class="Guide01_AreaRed" text="h15" anchor="left bottom"/>
        <Div id="div_cmnBtn" taborder="18" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" anchor="left top right" position="absolute 0 0 1237 30" positiontype="position"/>
        <Static id="Static29" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 97" anchor="left top right"/>
        <Static id="Static43" text="W10" visible="false" position="absolute 14 30 277 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static44" text="W10" visible="false" position="absolute 14 87 277 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static45" text="W15" visible="false" position="absolute -1 30 14 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static28" text="관리부서" class="sta_WFSA_label" position="absolute 15 40 77 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 74 40 84 61" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 514 41 534 62" anchor="left top"/>
        <Static id="Static51" text="W05." visible="false" position="absolute 0 61 538 66" style="background:#ff000055;align:center middle;"/>
        <Static id="Static03" text="물류센터" class="sta_WFSA_label" position="absolute 534 42 596 63" anchor="left top"/>
        <Static id="Static00" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 593 41 603 62" anchor="left top"/>
        <Static id="Static01" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 759 40 789 61" anchor="left top"/>
        <Static id="Static02" text="본     사" class="sta_WFSA_label" position="absolute 14 66 76 87" anchor="left top"/>
        <Static id="Static04" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 73 66 83 87" anchor="left top"/>
        <Static id="Static05" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 243 66 263 87" anchor="left top"/>
        <Static id="Static07" text="사업장" class="sta_WFSA_label" position="absolute 261 66 323 87" anchor="left top"/>
        <Static id="Static08" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 320 66 330 87" anchor="left top"/>
        <Static id="Static10" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 514 66 534 87" anchor="left top"/>
        <Static id="Static12" text="납품업체" class="sta_WFSA_label" position="absolute 533 66 595 87" anchor="left top"/>
        <Static id="Static13" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 593 66 603 87" anchor="left top"/>
        <Static id="Static14" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 735 66 754 87" anchor="left top"/>
        <Static id="Static85" text="~" class="sta_WF_Dash" position="absolute 977 40 993 61"/>
        <Static id="Static17" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 862 41 872 62" anchor="left top"/>
        <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 97 450 112" anchor="left top"/>
        <Tab id="Tab_BuySale" anchor="all" taborder="15" tabindex="0" scrollbars="autoboth" position="absolute 0 112 1237 710" style="showextrabutton:false;" onchanged="Tab_BuySale_onchanged">
          <Tabpages>
            <Tabpage id="tabpage1" text="거래처별집계">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" taborder="0" binddataset="ds_list0" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 15 1225 560" anchor="all" autofittype="none">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="144"/>
                          <Column size="68"/>
                          <Column size="120"/>
                          <Column size="0"/>
                          <Column size="0"/>
                          <Column size="101"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="88"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="85"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="83"/>
                          <Column size="90"/>
                          <Column size="74"/>
                          <Column size="87"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                          <Cell col="1" rowspan="2" text="관리부서" taborder="undefined"/>
                          <Cell col="2" rowspan="2" text="본사" taborder="undefined"/>
                          <Cell col="3" rowspan="2" text="본사명" taborder="undefined"/>
                          <Cell col="4" rowspan="2" text="사업장" taborder="undefined"/>
                          <Cell col="5" rowspan="2" text="사업장명" taborder="undefined"/>
                          <Cell col="6" rowspan="2" text="구매원가" taborder="undefined"/>
                          <Cell col="7" colspan="3" text="구매" taborder="undefined"/>
                          <Cell col="10" colspan="3" text="전략" taborder="undefined"/>
                          <Cell col="13" colspan="3" text="영업" taborder="undefined"/>
                          <Cell col="16" colspan="2" text="합계" taborder="undefined"/>
                          <Cell col="18" text="매출"/>
                          <Cell row="1"/>
                          <Cell row="1" col="7" text="구매금액"/>
                          <Cell row="1" col="8" text="추가이익액"/>
                          <Cell row="1" col="9" text="추가이익율"/>
                          <Cell row="1" col="10" text="전략금액"/>
                          <Cell row="1" col="11" text="추가이익액"/>
                          <Cell row="1" col="12" text="추가이익율"/>
                          <Cell row="1" col="13" text="영업금액"/>
                          <Cell row="1" col="14" text="추가이익엑"/>
                          <Cell row="1" col="15" text="추가이익율"/>
                          <Cell row="1" col="16" text="추가이익액"/>
                          <Cell row="1" col="17" text="추가이익율"/>
                          <Cell row="1" col="18" text="부가세"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" displaytype="text" text="bind:ccNm"/>
                          <Cell col="2" displaytype="text" style="align:center middle;" text="bind:mainUpjang"/>
                          <Cell col="3" displaytype="text" style="align:left middle;" text="bind:mainUpjangnm"/>
                          <Cell col="4" displaytype="text" style="align:center middle;" text="bind:upjang"/>
                          <Cell col="5" displaytype="text" style="align:left middle;" text="bind:upjangnm"/>
                          <Cell col="6" displaytype="number" style="align:right middle;" text="bind:unitAmount"/>
                          <Cell col="7" displaytype="number" text="bind:transAmount"/>
                          <Cell col="8" displaytype="number" style="align:right middle;" text="bind:transMargin"/>
                          <Cell col="9" displaytype="number" style="align:right middle;" text="expr:gfn_round(gfn_parseFloat((transMargin / saleAmount) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="10" displaytype="number" text="bind:strategyAmount"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" text="bind:strategyMargin"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" text="expr:gfn_round(gfn_parseFloat((strategyMargin / saleAmount) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="13" displaytype="number" text="bind:saleAmount"/>
                          <Cell col="14" displaytype="number" text="bind:saleMargin"/>
                          <Cell col="15" displaytype="number" style="align:right middle;" text="expr:gfn_round(gfn_parseFloat((saleMargin / saleAmount) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="16" displaytype="number" text="bind:sumMargin"/>
                          <Cell col="17" displaytype="number" text="expr:gfn_round(gfn_parseFloat((sumMargin / saleAmount) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="18" displaytype="number" text="bind:saleVat"/>
                        </Band>
                        <Band id="summary">
                          <Cell/>
                          <Cell col="1"/>
                          <Cell col="2" colspan="4" style="align:right middle;" text="합   계 :" taborder="undefined"/>
                          <Cell col="6" displaytype="number" style="align:right middle;" expr="expr:getSumNF('unitAmount')"/>
                          <Cell col="7" displaytype="number" expr="expr:getSumNF('transAmount')"/>
                          <Cell col="8" displaytype="number" style="align:right middle;" expr="expr:getSumNF('transMargin')"/>
                          <Cell col="9" displaytype="number" style="align:right middle;" expr="expr:gfn_round(gfn_parseFloat((getSumNF('transMargin') / getSumNF('saleAmount')) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="10" displaytype="number" expr="expr:getSumNF('strategyAmount')"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" expr="expr:getSumNF('strategyMargin')"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" expr="expr:gfn_round(gfn_parseFloat((getSumNF('strategyMargin') / getSumNF('saleAmount')) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="13" displaytype="number" expr="expr:getSumNF('saleAmount')"/>
                          <Cell col="14" displaytype="number" expr="expr:getSumNF('saleMargin')"/>
                          <Cell col="15" displaytype="number" style="align:right middle;" expr="expr:gfn_round(gfn_parseFloat((getSumNF('saleMargin') / getSumNF('saleAmount')) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="16" displaytype="number" expr="expr:getSumNF('sumMargin')"/>
                          <Cell col="17" displaytype="number" expr="expr:gfn_round(gfn_parseFloat((getSumNF('sumMargin') / getSumNF('saleAmount')) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="18" displaytype="number" expr="expr:getSumNF('saleVat')"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Grid id="Grid00" taborder="1" useinputpanel="false" position="absolute 146 277 1092 425" binddataset="ds_list0" cellsizingtype="col" visible="false">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                        </Columns>
                        <Rows>
                          <Row band="head" size="24"/>
                          <Row band="body" size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell col="0" disptype="normal" text="ccNm"/>
                          <Cell col="1" disptype="normal" text="mainUpjang"/>
                          <Cell col="2" disptype="normal" text="mainUpjangnm"/>
                          <Cell col="3" disptype="normal" text="upjang"/>
                          <Cell col="4" disptype="normal" text="upjangnm"/>
                          <Cell col="5" disptype="normal" text="saleAmount"/>
                          <Cell col="6" disptype="normal" text="saleVat"/>
                          <Cell col="7" disptype="normal" text="saleSum"/>
                          <Cell col="8" disptype="normal" text="unitAmount"/>
                          <Cell col="9" disptype="normal" text="transAmount"/>
                          <Cell col="10" disptype="normal" text="strategyAmount"/>
                          <Cell col="11" disptype="normal" text="transMargin"/>
                          <Cell col="12" disptype="normal" text="strategyMargin"/>
                          <Cell col="13" disptype="normal" text="saleMargin"/>
                          <Cell col="14" disptype="normal" text="sumMargin"/>
                        </Band>
                        <Band id="body">
                          <Cell col="0" disptype="normal" text="bind:ccNm"/>
                          <Cell col="1" disptype="normal" text="bind:mainUpjang"/>
                          <Cell col="2" disptype="normal" text="bind:mainUpjangnm"/>
                          <Cell col="3" disptype="normal" text="bind:upjang"/>
                          <Cell col="4" disptype="normal" text="bind:upjangnm"/>
                          <Cell col="5" disptype="normal" text="bind:saleAmount"/>
                          <Cell col="6" disptype="normal" text="bind:saleVat"/>
                          <Cell col="7" disptype="normal" text="bind:saleSum"/>
                          <Cell col="8" disptype="normal" text="bind:unitAmount"/>
                          <Cell col="9" disptype="normal" text="bind:transAmount"/>
                          <Cell col="10" disptype="normal" text="bind:strategyAmount"/>
                          <Cell col="11" disptype="normal" text="bind:transMargin"/>
                          <Cell col="12" disptype="normal" text="bind:strategyMargin"/>
                          <Cell col="13" disptype="normal" text="bind:saleMargin"/>
                          <Cell col="14" disptype="normal" text="bind:sumMargin"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Button id="Button00" taborder="2" text="Button00" position="absolute 548 116 643 148" onclick="Tab_BuySale_tabpage1_Button00_onclick" visible="false"/>
                  <Grid id="Grid01" taborder="3" useinputpanel="false" position="absolute 680 110 1019 203" binddataset="ds_center00" visible="false">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="80"/>
                          <Column size="80"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell/>
                          <Cell col="1" text="centerCode"/>
                          <Cell col="2" text="centerName"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="checkbox" text="bind:chk"/>
                          <Cell col="1" text="bind:centerCode"/>
                          <Cell col="2" text="bind:centerName"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage2" text="자재별집계">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" taborder="0" binddataset="ds_list1" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 15 1225 559" anchor="all" autofittype="none">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="39"/>
                          <Column size="114"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="94"/>
                          <Column size="159"/>
                          <Column size="88"/>
                          <Column size="40"/>
                          <Column size="101"/>
                          <Column size="101"/>
                          <Column size="100"/>
                          <Column size="91"/>
                          <Column size="81"/>
                          <Column size="100"/>
                          <Column size="90"/>
                          <Column size="81"/>
                          <Column size="100"/>
                          <Column size="97"/>
                          <Column size="86"/>
                          <Column size="100"/>
                          <Column size="76"/>
                          <Column size="105"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" rowspan="2" text="관리부서" taborder="undefined"/>
                          <Cell col="2" rowspan="2" text="대분류" taborder="undefined"/>
                          <Cell col="3" rowspan="2" text="중분류" taborder="undefined"/>
                          <Cell col="4" rowspan="2" text="자재코드" taborder="undefined"/>
                          <Cell col="5" rowspan="2" text="자재명" taborder="undefined"/>
                          <Cell col="6" rowspan="2" text="규격" taborder="undefined"/>
                          <Cell col="7" rowspan="2" text="단위" taborder="undefined"/>
                          <Cell col="8" text="구매원가" taborder="undefined"/>
                          <Cell col="9" rowspan="2" text="매입금액" taborder="undefined"/>
                          <Cell col="10" colspan="3" text="구매" taborder="undefined"/>
                          <Cell col="13" colspan="3" text="전략" taborder="undefined"/>
                          <Cell col="16" colspan="3" text="영업" taborder="undefined"/>
                          <Cell col="19" colspan="2" text="합계" taborder="undefined"/>
                          <Cell col="21" text="매출"/>
                          <Cell row="1"/>
                          <Cell row="1" col="8" text="(평균)" taborder="undefined"/>
                          <Cell row="1" col="10" text="구매금액"/>
                          <Cell row="1" col="11" text="추가이익액"/>
                          <Cell row="1" col="12" text="추가이익율"/>
                          <Cell row="1" col="13" text="전략금액"/>
                          <Cell row="1" col="14" text="추가이익액"/>
                          <Cell row="1" col="15" text="추가이익율"/>
                          <Cell row="1" col="16" text="영업금액"/>
                          <Cell row="1" col="17" text="추가이익액"/>
                          <Cell row="1" col="18" text="추가이익율"/>
                          <Cell row="1" col="19" text="추가이익액"/>
                          <Cell row="1" col="20" text="추가이익율"/>
                          <Cell row="1" col="21" text="부가세"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:NO" expr="currow+1"/>
                          <Cell col="1" displaytype="text" text="bind:ccNm"/>
                          <Cell col="2" displaytype="text" text="bind:classM"/>
                          <Cell col="3" displaytype="text" text="bind:classS"/>
                          <Cell col="4" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                          <Cell col="5" displaytype="text" edittype="none" text="bind:itemName"/>
                          <Cell col="6" displaytype="text" text="bind:itemSize"/>
                          <Cell col="7" text="bind:transUom"/>
                          <Cell col="8" displaytype="number" style="align:right middle;" text="bind:unitPrice"/>
                          <Cell col="9" displaytype="number" style="align:right middle;" text="bind:unitAmount"/>
                          <Cell col="10" displaytype="number" text="bind:transAmount"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" text="bind:transMargin"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" text="expr:gfn_round(gfn_parseFloat((transMargin / saleAmount) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="13" displaytype="number" text="bind:strategyAmount"/>
                          <Cell col="14" displaytype="number" style="align:right middle;" text="bind:strategyMargin"/>
                          <Cell col="15" displaytype="number" style="align:right middle;" text="expr:gfn_round(gfn_parseFloat((strategyMargin / saleAmount) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="16" displaytype="number" text="bind:saleAmount"/>
                          <Cell col="17" displaytype="number" style="align:right middle;" text="bind:saleMargin"/>
                          <Cell col="18" displaytype="number" style="align:right middle;" text="expr:gfn_round(gfn_parseFloat((saleMargin / saleAmount) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="19" displaytype="number" text="bind:sumMargin"/>
                          <Cell col="20" displaytype="number" text="expr:gfn_round(gfn_parseFloat((sumMargin / saleAmount) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="21" displaytype="number" text="bind:saleVat"/>
                        </Band>
                        <Band id="summary">
                          <Cell/>
                          <Cell col="1" colspan="8" style="align:right;" text="합   계 :" taborder="undefined"/>
                          <Cell col="9" displaytype="number" style="align:right middle;" expr="expr:getSumNF('unitAmount')"/>
                          <Cell col="10" displaytype="number" expr="expr:getSumNF('transAmount')"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" expr="expr:getSumNF('transMargin')"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" expr="expr:gfn_round(gfn_parseFloat((getSumNF('transMargin') / getSumNF('saleAmount')) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="13" displaytype="number" expr="expr:getSumNF('strategyAmount')"/>
                          <Cell col="14" displaytype="number" style="align:right middle;" expr="expr:getSumNF('strategyMargin')"/>
                          <Cell col="15" displaytype="number" style="align:right middle;" expr="expr:gfn_round(gfn_parseFloat((getSumNF('strategyMargin') / getSumNF('saleAmount')) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="16" displaytype="number" expr="expr:getSumNF('saleAmount')"/>
                          <Cell col="17" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleMargin')"/>
                          <Cell col="18" displaytype="number" style="align:right middle;" expr="expr:gfn_round(gfn_parseFloat((getSumNF('saleMargin') / getSumNF('saleAmount')) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="19" displaytype="number" expr="expr:getSumNF('sumMargin')"/>
                          <Cell col="20" displaytype="number" expr="expr:gfn_round(gfn_parseFloat((getSumNF('sumMargin') / getSumNF('saleAmount')) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="21" displaytype="number" expr="expr:getSumNF('saleVat')"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Grid id="Grid00" taborder="1" useinputpanel="false" position="absolute 119 153 1154 377" binddataset="ds_list1" cellsizingtype="col" visible="false">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                        </Columns>
                        <Rows>
                          <Row band="head" size="24"/>
                          <Row band="body" size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell col="0" disptype="normal" text="ccNm"/>
                          <Cell col="1" disptype="normal" text="classM"/>
                          <Cell col="2" disptype="normal" text="classS"/>
                          <Cell col="3" disptype="normal" text="itemCode"/>
                          <Cell col="4" disptype="normal" text="itemName"/>
                          <Cell col="5" disptype="normal" text="itemSize"/>
                          <Cell col="6" disptype="normal" text="transUom"/>
                          <Cell col="7" disptype="normal" text="saleAmount"/>
                          <Cell col="8" disptype="normal" text="saleVat"/>
                          <Cell col="9" disptype="normal" text="saleSum"/>
                          <Cell col="10" disptype="normal" text="unitPrice"/>
                          <Cell col="11" disptype="normal" text="unitAmount"/>
                          <Cell col="12" disptype="normal" text="transAmount"/>
                          <Cell col="13" disptype="normal" text="strategyAmount"/>
                          <Cell col="14" disptype="normal" text="transMargin"/>
                          <Cell col="15" disptype="normal" text="strategyMargin"/>
                          <Cell col="16" disptype="normal" text="saleMargin"/>
                          <Cell col="17" disptype="normal" text="sumMargin"/>
                        </Band>
                        <Band id="body">
                          <Cell col="0" disptype="normal" text="bind:ccNm"/>
                          <Cell col="1" disptype="normal" text="bind:classM"/>
                          <Cell col="2" disptype="normal" text="bind:classS"/>
                          <Cell col="3" disptype="normal" text="bind:itemCode"/>
                          <Cell col="4" disptype="normal" text="bind:itemName"/>
                          <Cell col="5" disptype="normal" text="bind:itemSize"/>
                          <Cell col="6" disptype="normal" text="bind:transUom"/>
                          <Cell col="7" disptype="normal" text="bind:saleAmount"/>
                          <Cell col="8" disptype="normal" text="bind:saleVat"/>
                          <Cell col="9" disptype="normal" text="bind:saleSum"/>
                          <Cell col="10" disptype="normal" text="bind:unitPrice"/>
                          <Cell col="11" disptype="normal" text="bind:unitAmount"/>
                          <Cell col="12" disptype="normal" text="bind:transAmount"/>
                          <Cell col="13" disptype="normal" text="bind:strategyAmount"/>
                          <Cell col="14" disptype="normal" text="bind:transMargin"/>
                          <Cell col="15" disptype="normal" text="bind:strategyMargin"/>
                          <Cell col="16" disptype="normal" text="bind:saleMargin"/>
                          <Cell col="17" disptype="normal" text="bind:sumMargin"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage3" text="영업사원별집계">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" taborder="0" binddataset="ds_list2" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 15 1225 560" anchor="all" autofittype="none">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="94"/>
                          <Column size="140"/>
                          <Column size="137"/>
                          <Column size="74"/>
                          <Column size="154"/>
                          <Column size="70"/>
                          <Column size="147"/>
                          <Column size="104"/>
                          <Column size="100"/>
                          <Column size="92"/>
                          <Column size="81"/>
                          <Column size="100"/>
                          <Column size="89"/>
                          <Column size="81"/>
                          <Column size="100"/>
                          <Column size="88"/>
                          <Column size="80"/>
                          <Column size="95"/>
                          <Column size="80"/>
                          <Column size="101"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                          <Cell col="1"/>
                          <Cell col="2" rowspan="2" text="관리부서" taborder="undefined"/>
                          <Cell col="3" rowspan="2" text="영업사원" taborder="undefined"/>
                          <Cell col="4" rowspan="2" text="본사" taborder="undefined"/>
                          <Cell col="5" rowspan="2" text="본사명" taborder="undefined"/>
                          <Cell col="6" rowspan="2" text="사업장" taborder="undefined"/>
                          <Cell col="7" rowspan="2" text="사업장명" taborder="undefined"/>
                          <Cell col="8" rowspan="2" text="구매원가" taborder="undefined"/>
                          <Cell col="9" colspan="3" text="구매" taborder="undefined"/>
                          <Cell col="12" colspan="3" text="전략" taborder="undefined"/>
                          <Cell col="15" colspan="3" text="영업" taborder="undefined"/>
                          <Cell col="18" colspan="2" text="합계" taborder="undefined"/>
                          <Cell col="20" text="매출"/>
                          <Cell row="1"/>
                          <Cell row="1" col="1"/>
                          <Cell row="1" col="9" text="구매금액"/>
                          <Cell row="1" col="10" text="추가이익액"/>
                          <Cell row="1" col="11" text="추가이익율"/>
                          <Cell row="1" col="12" text="전략금액"/>
                          <Cell row="1" col="13" text="추가이익액"/>
                          <Cell row="1" col="14" text="추가이익율"/>
                          <Cell row="1" col="15" text="영업금액"/>
                          <Cell row="1" col="16" text="추가이익액"/>
                          <Cell row="1" col="17" text="추가이익율"/>
                          <Cell row="1" col="18" text="추가이익액"/>
                          <Cell row="1" col="19" text="추가이익율"/>
                          <Cell row="1" col="20" text="부가세"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" displaytype="text" text="bind:lineName"/>
                          <Cell col="2" displaytype="text" text="bind:ccNm"/>
                          <Cell col="3" style="align:left;" text="bind:partSalesSabun"/>
                          <Cell col="4" displaytype="text" style="align:center;" text="bind:mainUpjang"/>
                          <Cell col="5" style="align:left;" text="bind:mainUpjangnm"/>
                          <Cell col="6" displaytype="text" text="bind:upjang"/>
                          <Cell col="7" displaytype="text" text="bind:upjangnm"/>
                          <Cell col="8" displaytype="number" text="bind:unitAmount"/>
                          <Cell col="9" displaytype="number" text="bind:transAmount"/>
                          <Cell col="10" displaytype="number" text="bind:transMargin"/>
                          <Cell col="11" displaytype="number" text="expr:gfn_round(gfn_parseFloat((transMargin / saleAmount) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="12" displaytype="number" text="bind:strategyAmount"/>
                          <Cell col="13" displaytype="number" text="bind:strategyMargin"/>
                          <Cell col="14" displaytype="number" text="expr:gfn_round(gfn_parseFloat((strategyMargin / saleAmount) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="15" displaytype="number" text="bind:saleAmount"/>
                          <Cell col="16" displaytype="number" text="bind:saleMargin"/>
                          <Cell col="17" displaytype="number" text="expr:gfn_round(gfn_parseFloat((saleMargin / saleAmount) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="18" displaytype="number" text="bind:sumMargin"/>
                          <Cell col="19" displaytype="number" text="expr:gfn_round(gfn_parseFloat((sumMargin / saleAmount) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="20" displaytype="number" text="bind:saleVat"/>
                        </Band>
                        <Band id="summary">
                          <Cell colspan="6" style="align:right middle;" text="합   계 :" taborder="undefined"/>
                          <Cell col="6"/>
                          <Cell col="7"/>
                          <Cell col="8" displaytype="number" expr="expr:getCaseSum(&quot;lineName==''&quot;,&quot;unitAmount&quot;)"/>
                          <Cell col="9" displaytype="number" expr="expr:getCaseSum(&quot;lineName==''&quot;,&quot;transAmount&quot;)"/>
                          <Cell col="10" displaytype="number" expr="expr:getCaseSum(&quot;lineName==''&quot;,&quot;transMargin&quot;)"/>
                          <Cell col="11" displaytype="number" expr="expr:gfn_round(gfn_parseFloat((getCaseSum(&quot;lineName==''&quot;,&quot;transMargin&quot;) / getCaseSum(&quot;lineName==''&quot;,&quot;saleAmount&quot;)) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="12" displaytype="number" expr="expr:getCaseSum(&quot;lineName==''&quot;,&quot;strategyAmount&quot;)"/>
                          <Cell col="13" displaytype="number" expr="expr:getCaseSum(&quot;lineName==''&quot;,&quot;strategyMargin&quot;)"/>
                          <Cell col="14" displaytype="number" expr="expr:gfn_round(gfn_parseFloat((getCaseSum(&quot;lineName==''&quot;,&quot;strategyMargin&quot;) / getCaseSum(&quot;lineName==''&quot;,&quot;saleAmount&quot;)) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="15" displaytype="number" expr="expr:getCaseSum(&quot;lineName==''&quot;,&quot;saleAmount&quot;)"/>
                          <Cell col="16" displaytype="number" expr="expr:getCaseSum(&quot;lineName==''&quot;,&quot;saleMargin&quot;)"/>
                          <Cell col="17" displaytype="number" expr="expr:gfn_round(gfn_parseFloat((getCaseSum(&quot;lineName==''&quot;,&quot;saleMargin&quot;) / getCaseSum(&quot;lineName==''&quot;,&quot;saleAmount&quot;)) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="18" displaytype="number" expr="expr:getCaseSum(&quot;lineName==''&quot;,&quot;sumMargin&quot;)"/>
                          <Cell col="19" displaytype="number" expr="expr:gfn_round(gfn_parseFloat((getCaseSum(&quot;lineName==''&quot;,&quot;sumMargin&quot;) / getCaseSum(&quot;lineName==''&quot;,&quot;saleAmount&quot;)) * 100), 2)" mask="#,##0.#0"/>
                          <Cell col="20" displaytype="number" expr="expr:getCaseSum(&quot;lineName==''&quot;,&quot;saleVat&quot;)"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Static id="Static15" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 1 139 1236 154" anchor="left top"/>
        <Static id="Static19" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1 154 11 717"/>
        <Static id="Static20" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1226 154 1236 699"/>
        <Static id="Static35" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 11 699 1246 709" anchor="left top"/>
        <ObjCalendar id="cal_FDate" titletext="캘린더" taborder="4" onkeydown="cal_saleDate_onkeydown" text="20150101" scrollbars="none" position="absolute 872 41 972 62"/>
        <ObjCalendar id="cal_TDate" titletext="캘린더" taborder="5" onkeydown="cal_saleDate_onkeydown" text="20150101" scrollbars="none" position="absolute 991 41 1091 62"/>
        <Combo id="cbo_centerCode" taborder="3" innerdataset="ds_center" codecolumn="centerCode" datacolumn="centerName" class="cmb_WF_Essential" position="absolute 603 40 760 61" anchor="left top" enable="true" onitemchanged="cbo_centerCode_onitemchanged" tabstop="false" type="dropdown"/>
        <TmSearchComponent id="comp_tm" titletext="팀 검색용 Component" taborder="0" text="TmSearchComponent00" position="absolute 84 40 241 61" bindDataset="ds_search" bindTmCdColumn="schTm" bindTmNmColumn="schTmNm" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tm" eventBeforeTrigger="" onkeydown="comp_tm_onkeydown"/>
        <UpjangSearchComponent id="comp_mainUpjang" titletext="업장 검색용 Component" taborder="6" onkeydown="comp_mainUpjang_onkeydown" text="UpjangSearchComponent00" position="absolute 83 66 241 87" bindDataset="ds_search" bindUpjangCodeColumn="schMainUpjang" bindUpjangNameColumn="schMainUpjangNm" eventBeforeTrigger="" eventAfterTrigger="fn_mainUpjang" roleSetId="FmsMainUpjang"/>
        <UpjangSearchComponent id="comp_upjang" titletext="업장 검색용 Component" taborder="7" text="UpjangSearchComponent03" position="absolute 329 66 514 87" bindDataset="ds_search" bindUpjangCodeColumn="schUpjang" bindUpjangNameColumn="schUpjangNm" eventBeforeTrigger="" eventAfterTrigger="" roleSetId="FmsUpjang"/>
        <Edit id="edt_cust" taborder="8" readonly="true" onkeydown="edt_cust_onkeydown" position="absolute 603 66 741 87" style=":disabled {cursor:arrowwait;}" userdata=""/>
        <Button id="btn_cust" taborder="9" tabstop="false" onclick="fn_edBtn_OnClick" class="btn_WF_popSearch" position="absolute 740 66 761 87"/>
        <MuSearchComponent id="comp_mu" titletext="사업부 선택 Component" taborder="17" text="MuSearchComponent00" class="cmb_WF_Essential" position="absolute 573 99 675 120" bindDataset="ds_search" bindMuCdColumn="schMu" appendText="NOT" onItemChangedEvent="" visible="false"/>
        <Static id="Static21" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 242 40 262 61" anchor="left top"/>
        <Static id="Static22" text="CC" class="sta_WFSA_label" position="absolute 261 41 323 62" anchor="left top" visible="true"/>
        <Static id="Static23" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 320 42 330 63" anchor="left top"/>
        <Edit id="edt_ccCd" taborder="1" readonly="true" position="absolute 329 41 495 62" anchor="left top" onkeydown="edt_ccCd_onkeydown" visible="true"/>
        <Button id="btn_ccCd" taborder="2" class="btn_WF_popSearch" position="absolute 493 41 514 62" visible="true"/>
        <CheckBox id="chk_1" taborder="12" text="ck물류비제외" truevalue="1" position="absolute 1124 34 1222 55" userdata="001" onclick="chk_1_onclick"/>
        <CheckBox id="chk_2" taborder="13" text="지급수수료제외" truevalue="1" position="absolute 1124 53 1231 74" userdata="001" onclick="chk_2_onclick"/>
        <CheckBox id="chk_3" taborder="14" text="장려금제외" truevalue="1" position="absolute 1124 72 1203 93" userdata="001" onclick="chk_3_onclick"/>
        <Combo id="cbo_gubun" taborder="16" codecolumn="codecolumn" datacolumn="datacolumn" index="0" position="absolute 453 100 570 121" anchor="left top" value="1" text="거래명세서기준" visible="false">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">1</Col>
                <Col id="datacolumn">거래명세서기준</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2</Col>
                <Col id="datacolumn">회계수정일기준</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="Static16" text="조회기간" class="sta_WFSA_label" position="absolute 801 42 863 63" anchor="left top"/>
        <Static id="notice00" text="본사 및 사업장조건 미지정 시 속도가 느려집니다." class="sta_WF_DiscInfo" position="absolute 910 119 1228 137" anchor="top right"/>
        <CheckBox id="chk_hidden" taborder="19" text="금액항목 숨기기" truevalue="1" position="absolute 789 116 907 137" userdata="001" onclick="chk_hidden_onclick" anchor="top right"/>
        <Static id="st_ORD_SABUNQuery" text="영업담당" class="sta_WFSA_label" position="absolute 801 66 876 87" userdata="strMAQuery_SABUN"/>
        <Edit id="edt_ORD_SABUNQuery" taborder="10" readonly="true" autoselect="true" onkeydown="edt_sabun_onkeydown" position="absolute 872 66 1004 87"/>
        <Button id="edtBtn_ORD_SABUNQuery" taborder="11" tabstop="false" onclick="edtBtn_ORD_SABUNQuery_onclick" class="btn_WF_popSearch" position="absolute 1003 66 1023 87"/>
        <Radio id="rdo_view" taborder="20" codecolumn="codecolumn" datacolumn="datacolumn" onitemchanged="rdo_view_onitemchanged" visible="true" position="absolute 303 119 494 135" style="textpadding:0 8 0 5;" direction="vertical">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">1</Col>
                <Col id="datacolumn">본사별집계</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2</Col>
                <Col id="datacolumn">업장별집계</Col>
              </Row>
            </Rows>
          </Dataset>
        </Radio>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_list0" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="mainUpjangnm" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="upjangnm" type="STRING" size="256"/>
          <Column id="saleAmount" type="STRING" size="256"/>
          <Column id="saleVat" type="STRING" size="256"/>
          <Column id="saleSum" type="STRING" size="256"/>
          <Column id="unitAmount" type="STRING" size="256"/>
          <Column id="transAmount" type="STRING" size="256"/>
          <Column id="strategyAmount" type="STRING" size="256"/>
          <Column id="transMargin" type="STRING" size="256"/>
          <Column id="strategyMargin" type="STRING" size="256"/>
          <Column id="saleMargin" type="STRING" size="256"/>
          <Column id="sumMargin" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_center" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="centerName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schCenter" type="STRING" size="256"/>
          <Column id="schToDate" type="STRING" size="256"/>
          <Column id="schFromDate" type="STRING" size="256"/>
          <Column id="schMu" type="STRING" size="256"/>
          <Column id="schTm" type="STRING" size="256"/>
          <Column id="schCc" type="STRING" size="256"/>
          <Column id="schCcNm" type="STRING" size="256"/>
          <Column id="schMainUpjang" type="STRING" size="256"/>
          <Column id="schUpjang" type="STRING" size="256"/>
          <Column id="schCustCd" type="STRING" size="256"/>
          <Column id="tabIndex" type="STRING" size="256"/>
          <Column id="schCustNm" type="STRING" size="256"/>
          <Column id="schUpjangNm" type="STRING" size="256"/>
          <Column id="schMainUpjangNm" type="STRING" size="256"/>
          <Column id="schTmNm" type="STRING" size="256"/>
          <Column id="schCenterName" type="STRING" size="256"/>
          <Column id="schView" type="STRING" size="256"/>
          <Column id="schChk1" type="STRING" size="256"/>
          <Column id="schChk2" type="STRING" size="256"/>
          <Column id="schChk3" type="STRING" size="256"/>
          <Column id="schGubun" type="STRING" size="256"/>
          <Column id="schPrice" type="STRING" size="256"/>
          <Column id="schSabun" type="STRING" size="256"/>
          <Column id="schSabunNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list1" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="classM" type="STRING" size="256"/>
          <Column id="classS" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="transUom" type="STRING" size="256"/>
          <Column id="saleAmount" type="STRING" size="256"/>
          <Column id="saleVat" type="STRING" size="256"/>
          <Column id="saleSum" type="STRING" size="256"/>
          <Column id="unitPrice" type="STRING" size="256"/>
          <Column id="unitAmount" type="STRING" size="256"/>
          <Column id="transAmount" type="STRING" size="256"/>
          <Column id="strategyAmount" type="STRING" size="256"/>
          <Column id="transMargin" type="STRING" size="256"/>
          <Column id="strategyMargin" type="STRING" size="256"/>
          <Column id="saleMargin" type="STRING" size="256"/>
          <Column id="sumMargin" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="lineName" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="partSalesSabun" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="mainUpjangnm" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="upjangnm" type="STRING" size="256"/>
          <Column id="saleAmount" type="STRING" size="256"/>
          <Column id="saleVat" type="STRING" size="256"/>
          <Column id="saleSum" type="STRING" size="256"/>
          <Column id="unitAmount" type="STRING" size="256"/>
          <Column id="transAmount" type="STRING" size="256"/>
          <Column id="strategyAmount" type="STRING" size="256"/>
          <Column id="transMargin" type="STRING" size="256"/>
          <Column id="strategyMargin" type="STRING" size="256"/>
          <Column id="saleMargin" type="STRING" size="256"/>
          <Column id="sumMargin" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">0</Col>
            <Col id="delYn">0</Col>
            <Col id="savYn">0</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">0</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_searchValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schGubun" type="STRING" size="256"/>
          <Column id="schFromDate" type="STRING" size="256"/>
          <Column id="schToDate" type="STRING" size="256"/>
          <Column id="schCenter" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="schGubun">title:조회구분,required:true</Col>
            <Col id="schFromDate">title:기간[시작일],required:true</Col>
            <Col id="schToDate">title:기간[종료일],required:true</Col>
            <Col id="schCenter">title:물류센터,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_center00" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="centerName" type="STRING" size="256"/>
          <Column id="chk" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="centerCode">300001</Col>
            <Col id="centerName">경인센터</Col>
          </Row>
          <Row>
            <Col id="centerCode">300002</Col>
            <Col id="centerName">납부센터</Col>
          </Row>
          <Row>
            <Col id="centerCode">300003</Col>
            <Col id="centerName">제주센터</Col>
          </Row>
          <Row>
            <Col id="centerCode">300004</Col>
            <Col id="centerName">호남센터</Col>
          </Row>
          <Row>
            <Col id="centerCode">300005</Col>
            <Col id="centerName">송탄센터</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item1" compid="edt_cust" propid="userdata" datasetid="ds_search" columnid="schCust"/>
      <BindItem id="item3" compid="edt_cust" propid="UserData" datasetid="ds_search" columnid="GUBUN"/>
      <BindItem id="item0" compid="edt_cust" propid="value" datasetid="ds_search" columnid="schCustNm"/>
      <BindItem id="item2" compid="cbo_centerCode" propid="value" datasetid="ds_search" columnid="schCenter"/>
      <BindItem id="item4" compid="cbo_centerCode" propid="text" datasetid="ds_search" columnid="schCenterName"/>
      <BindItem id="item5" compid="edt_ccCd" propid="value" datasetid="ds_search" columnid="schCcNm"/>
      <BindItem id="item7" compid="chk_1" propid="value" datasetid="ds_search" columnid="schChk1"/>
      <BindItem id="item8" compid="chk_2" propid="value" datasetid="ds_search" columnid="schChk2"/>
      <BindItem id="item9" compid="chk_3" propid="value" datasetid="ds_search" columnid="schChk3"/>
      <BindItem id="item10" compid="cbo_gubun" propid="value" datasetid="ds_search" columnid="schGubun"/>
      <BindItem id="item12" compid="edt_ORD_SABUNQuery" propid="value" datasetid="ds_search" columnid="schSabunNm"/>
      <BindItem id="item6" compid="rdo_view" propid="value" datasetid="ds_search" columnid="schView"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : GainRateSummary
  파 일 명 : GainRateSummary.xfdl
  기    능 : 식재영업 > 이익율 집계(실적기준)

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
[침고]
1) FMS_TRANSACTION_V 관련
매입원가 = FMS_TRANSACTION_V, UNIT_PRICE
구매단가 = FMS_TRANSACTION_V, TRANS_MPRICE
영업단가 = FMS_TRANSACTION_V, SALE_PRICE
2) PO_CONTRACT_FSALE 관련
매입원가 = PO_CONTRACT_FSALE, PO_PRICE
구매단가 = PO_CONTRACT_FSALE, ADD_PRICE
전략단가 = PO_CONTRACT_FSALE, STRATEGY_PRICE
영업단가 = PO_CONTRACT_FSALE, SALE_PRICE
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "U_lib::lib_conversionCom.xjs";
include "lib::lib_com.xjs";


/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();
var tabIndex = 0;

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{	
	fn_searchCenter();
	ds_search.addRow();
	ds_search.setColumn(0,"tabIndex",tabIndex);
	cal_FDate.fn_initMonthCal(this, gfn_today(), "", ds_search, "schFromDate", "Y");		//검색 시작 일
	cal_TDate.fn_initMonthCal(this, gfn_today(), "", ds_search, "schToDate", "Y");		//검색 종료 일

	ds_search.setColumn(0,"schView","1");		// 본사
	ds_search.setColumn(0,"schGubun", "1");		// 조회일자구분

	// 기본적으로 단가기준은 관리단가
	ds_search.setColumn(0,"schPrice", "1");		// 단가구분


	comp_mu.setMuCode('2004')
	// 팀 초기화
	comp_tm.applyAuthLevel(comp_mu);
	// 본사
	comp_mainUpjang.applyAuthLevel(comp_tm);
	comp_mainUpjang.setMainUpjang(true);
	// 사업장(식재사업)
	comp_upjang.applyAuthLevel(comp_tm);
	comp_upjang.applyMainUpjang(comp_mainUpjang);
	
	SCPopup.bind(this, "CcCode", "edt_ccCd", "btn_ccCd", null, {muCd:"", tmCd:""}, {before:"fn_ccBeforeEvent", after:"fn_ccAfterEvent"});
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{
	// 변경사항 체크(입력 프로그램일때 변경되는 Dataset 전체 기술)
// 	if (gfn_dsIsUpdated(ds_list) == true) 
// 	{
// 		// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
//         if (!gfn_confirm("confirm.before.movepage")) return false;
//     }
//     
    // 조회프로그램에도 Return true; 기술해 주세요!
	return true;
}


/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
	// 변경사항 체크
	//if (gfn_dsIsUpdated(ds_list) == true) 
	//{
	//	var retValue = gfn_confirm("confirm.before.search");	// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
	//	if (retValue == false) return;
	//}

	// 조회시 Validation Check
	if (gfn_validCheck(ds_search, ds_searchValid, true) == false) return;
	
	
	// 기간 CHECK
	if (cal_FDate.text > cal_TDate.text) {
 		gfn_alert("msg.err.validator.date.great");	// 종료일이 시작일보다 빠릅니다.
 		cal_FDate.setFocus();
		return;
	}
	
	// 동일한 월에 대해서만 조회가능
	if (gfn_subStr(cal_FDate.text, 0, 6) != gfn_subStr(cal_TDate.text, 0, 6))
	{
		gfn_alert("기간은 동일한 월을 지정하여 주십시요.");
 		cal_FDate.setFocus();
		return;
	}	

    // Grid sort 표시 초기화(필수)
    if(tabIndex == 0)gfn_clearSortMark(Tab_BuySale.tabpage1.grd_list);
    else if(tabIndex == 1)gfn_clearSortMark(Tab_BuySale.tabpage2.grd_list);
    else if(tabIndex == 2)gfn_clearSortMark(Tab_BuySale.tabpage3.grd_list);
    
	// 조건 : 영업담당
	if (ffn_ChkNull(ds_search.getColumn(ds_search.rowposition, "schSabunNm")))
		ds_search.setColumn(ds_search.rowposition,"schSabun","");
	else
		ds_search.setColumn(ds_search.rowposition,"schSabun",edt_ORD_SABUNQuery.userdata);
    
	var strSvcID    = "search";
	var strURL      = "fm/fmf/gainRateSummary/selectList.xdo";
    var strInDs     = "ds_search=ds_search";
    var strOutDs    = "ds_list"+tabIndex+"=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
	
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {
        case "search" :    		// 코드분류 조회
            //trace(ds_list.saveXML());
            break;
            		
		// 센터 조회
        case "searchCenter" :
            //trace(ds_center.saveXML());
            fn_center_init();
            break;            
    }
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/

/*----------------------------------------------------------------------------------------------
 * 설명      : CC 조회 이벤트 before, after
 *---------------------------------------------------------------------------------------------*/
function fn_ccBeforeEvent(p)
{
	p.option.muCd = ds_search.getColumn(0, "schMu");
	p.option.tmCd = ds_search.getColumn(0, "schTm");
	return true;
}

function fn_ccAfterEvent(p)
{
	ds_search.setColumn(0, "schCc", edt_ccCd.userdata);
	ds_search.setColumn(0, "schCcNm", edt_ccCd.value);
	return true;
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 센터정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchCenter()
{
    var strSvcID    = "searchCenter";
    var strURL      = "fm/fms/upriceContractUpjangSet/selectCenter.xdo";
    var strInDs     = "";
    var strOutDs    = "ds_center=ds_center";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 센터 COMBO 초기화 
 *---------------------------------------------------------------------------------------------*/
function fn_center_init()
{
	var defVal = "";
	//ds_center.filter("centerCode != '*'");
	// COMBO 에 첫번째 Row에 기본값을 SET
	if (ds_center.getRowCount() > 0) {
		defVal = ds_center.getColumn(0, "centerCode");
	}
	cbo_centerCode.value = defVal;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 협력업체 검색 팝업 이벤트  
 *---------------------------------------------------------------------------------------------*/
function fn_edBtn_OnClick(obj:Button,  e:ClickEventInfo)
{

	// 팝업창을 호출한다	
	var strId       = "SaleCustSearch";
	var strURL      = "X_FMS::SalePriceCustSearchPop.xfdl";
	var objArgument = {
		P_DATASET : ds_search
	};
	
	var nWidth      = 513;
	var nHeight     = 495;
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	
	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
	
	if (arrRtn instanceof Object)
	{
		edt_cust.value    = arrRtn["custNm"];
		edt_cust.userdata = arrRtn["custCd"];
		ds_search.setColumn(0,"schCustCd",arrRtn["custCd"]);
		obj.userdata       = arrRtn["custNm"];
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 메인업장 변경시 업장 값 초기화
 *---------------------------------------------------------------------------------------------*/
function fn_mainUpjang()
{
	comp_upjang.setUpjangCode("");
	comp_upjang.setUpjangName("");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 메인업장, 업장 값 초기화
 *---------------------------------------------------------------------------------------------*/
function fn_upjangDelete()
{
	fn_mainUpjang();
	comp_mainUpjang.setUpjangCode("");
	comp_mainUpjang.setUpjangName("");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 
 *---------------------------------------------------------------------------------------------*/
function fn_tm()
{
	//fn_upjangDelete();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 매입매출 집계 - 이익율 계산
 *---------------------------------------------------------------------------------------------*/
function fn_marginSet(row)
{
	var v_saleTot = 0; 	// 매출금액
	var v_margin = 0;	// 이익액	
	var v_calcRate = 0;
	
	v_saleTot = ds_list5.getColumn(row, "saleTot");
	v_margin = ds_list5.getColumn(row, "margin");
	

	if (v_saleTot == "0") return 0;
	
	v_calcRate = (v_margin / v_saleTot) * 100;
	v_calcRate = gfn_round(v_calcRate, 2);
	
	return v_calcRate;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 매입매출 집계 - 순수이익율 계산
 *---------------------------------------------------------------------------------------------*/
function fn_marginSumSet(row)
{
	var v_saleTot = 0; 		// 매출금액
	var v_marginSum = 0;	// 순수이익액	
	var v_calcRate = 0;
	
	v_saleTot = ds_list5.getColumn(row, "saleTot");
	v_marginSum = ds_list5.getColumn(row, "marginSum");
	

	if (v_saleTot == "0") return 0;
	
	v_calcRate = (v_marginSum / v_saleTot) * 100;
	v_calcRate = gfn_round(v_calcRate, 2);
	
	return v_calcRate;
}




/*----------------------------------------------------------------------------------------------
 * 설명      : 매입결과보고자료 - 이익율 계산
 *---------------------------------------------------------------------------------------------*/
function fn_elRateSet(row)
{
	var v_saleAmt = 0; 	// 매출금액(부가세 제외)
	var v_elAmt = 0; 	// 이익액(부가세 제외)
	var v_calcRate = 0;
	
	v_saleAmt = ds_list6.getColumn(row, "saleAmt");
	v_elAmt = ds_list6.getColumn(row, "elAmt");
	
	if (v_saleAmt == "0") return 0;
	
	if (ds_list6.getColumn(row, "transAmt") == "0") return 0;
	
	v_calcRate = (v_elAmt / v_saleAmt) * 100;
	v_calcRate = gfn_round(v_calcRate, 2);
	
	return v_calcRate;
}


/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : form에서 Key Down시 단축키들 지정(공통에서 자동생성, 화면에 스크립트 작성시 화면 스크립트만 실행됨)
 *---------------------------------------------------------------------------------------------*/
// function form_onkeydown(obj:Form, e:KeyEventInfo)
// {
// 	gfn_formKeyDown(obj, e);
// }

/*----------------------------------------------------------------------------------------------
 * 설명      : Grid Header Click시 정렬(공통에서 자동생성, 화면에 스크립트 작성시 화면 스크립트만 실행됨)
 *---------------------------------------------------------------------------------------------*/
// function grd_list_onheadclick(obj:Grid, e:GridClickEventInfo)
// {
// 	gfn_gridSort(obj, e);
// }

/*----------------------------------------------------------------------------------------------
 * 설명      : 코드 key Down시
 *---------------------------------------------------------------------------------------------*/
function edt_gubun_onkeydown(obj:Edit, e:KeyEventInfo)
{
	//trace("edt_gubun_onkeydown : e.altKey : " + e.altKey + " / e.ctrlKey : " + e.ctrlKey + " / e.keycode : " + e.keycode);
	// function fs_fn_edt_OnKeyDown(obj, nChar, strTabObj) 함수와 동일

	gfn_edtKeyDown(obj, e);
	
	// Enter 키 시 추가 기능
	if(e.keycode == 13) 
	{
		// 조회
		//fn_search();
		//return true;		// gfn_formKeyDown 실행 안함
	}
}


function edt_cust_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 13){
		fn_search();
	}
	if(e.keycode == 46){
		obj.value = "";
		obj.userData = "";
		ds_search.setColumn(0,"schCustCd","");
		ds_search.setColumn(0,"schCustNm","");
	}
}


function comp_mainUpjang_onkeydown(obj:UpjangSearchComponent, e:KeyEventInfo)
{
	if(e.keycode == 46){
		fn_upjangDelete();	// 메인업장, 업장 초기화
	}
}

function comp_tm_onkeydown(obj:TmSearchComponent, e:KeyEventInfo)
{
	if(e.keycode == 46){
		//fn_upjangDelete();	// 메인업장, 업장 초기화 : 제외
		comp_tm.setTmCode("");
		comp_tm.setTmName("");
	}
}

function edt_ccCd_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 46){
		fn_upjangDelete();	// 메인업장, 업장 초기화
		ds_search.setColumn(0, "schCc", "");
		ds_search.setColumn(0, "schCcNm", "");
	}
}

function chk_1_onclick(obj:CheckBox,  e:ClickEventInfo)
{
	if (chk_1.value) ds_search.setColumn(0, "schChk1", "1");
	else ds_search.setColumn(0, "schChk1", "");
}

function chk_2_onclick(obj:CheckBox,  e:ClickEventInfo)
{
	if (chk_2.value) ds_search.setColumn(0, "schChk2", "1");
	else ds_search.setColumn(0, "schChk2", "");
}

function chk_3_onclick(obj:CheckBox,  e:ClickEventInfo)
{
	if (chk_3.value) ds_search.setColumn(0, "schChk3", "1");
	else ds_search.setColumn(0, "schChk3", "");
}

function Tab_BuySale_onchanged(obj:Tab, e:TabIndexChangeEventInfo)
{
	tabIndex =e.postindex;//선택된 탭 인덱스 저장
	ds_search.setColumn(0,"tabIndex",e.postindex);

	if (tabIndex == 0) {
		rdo_view.visible = true;
	} else {
		rdo_view.visible = false;
	}

}

function chk_hidden_onclick(obj:CheckBox,  e:ClickEventInfo)
{
	if (chk_hidden.value) {
		// 거래처별
		this.Tab_BuySale.tabpage1.grd_list.setFormatColProperty(7,"size",0);
		this.Tab_BuySale.tabpage1.grd_list.setFormatColProperty(10,"size",0);
		this.Tab_BuySale.tabpage1.grd_list.setFormatColProperty(13,"size",0);
		// 자재별
		this.Tab_BuySale.tabpage2.grd_list.setFormatColProperty(10,"size",0);
		this.Tab_BuySale.tabpage2.grd_list.setFormatColProperty(13,"size",0);
		this.Tab_BuySale.tabpage2.grd_list.setFormatColProperty(16,"size",0);
		// 영업사원별
		this.Tab_BuySale.tabpage3.grd_list.setFormatColProperty(9,"size",0);
		this.Tab_BuySale.tabpage3.grd_list.setFormatColProperty(12,"size",0);
		this.Tab_BuySale.tabpage3.grd_list.setFormatColProperty(15,"size",0);
	} else {
		// 거래처별
		this.Tab_BuySale.tabpage1.grd_list.setFormatColProperty(7,"size",100);
		this.Tab_BuySale.tabpage1.grd_list.setFormatColProperty(10,"size",100);
		this.Tab_BuySale.tabpage1.grd_list.setFormatColProperty(13,"size",100);
		// 자재별
		this.Tab_BuySale.tabpage2.grd_list.setFormatColProperty(10,"size",100);
		this.Tab_BuySale.tabpage2.grd_list.setFormatColProperty(13,"size",100);
		this.Tab_BuySale.tabpage2.grd_list.setFormatColProperty(16,"size",100);
		// 영업사원별
		this.Tab_BuySale.tabpage3.grd_list.setFormatColProperty(9,"size",100);
		this.Tab_BuySale.tabpage3.grd_list.setFormatColProperty(12,"size",100);
		this.Tab_BuySale.tabpage3.grd_list.setFormatColProperty(15,"size",100);
	}
}

// 영업담당 이벤트
function edt_sabun_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 13){
		fn_search();
	}
	if(e.keycode == 46){
		edt_ORD_SABUNQuery.value = "";
		edt_ORD_SABUNQuery.userData = "";
		ds_search.setColumn(0,"schSabun","");
		ds_search.setColumn(0,"schSabunNm","");
	}
	
}

// 영업담당 팝업처리
function edtBtn_ORD_SABUNQuery_onclick(obj:Button,  e:ClickEventInfo)
{
	var str_Where = "";
	var str_DeptId = "";

	if (obj.name == "edtBtn_ORD_SABUNQuery") {
		str_Where += "  AND (V.SABUN IN (SELECT PART_SALES_SABUN FROM FMS_UPJANG " + str_DeptId + ")) ";
		
	}
	
	fn_edtBtn_OnClick(obj, str_Where);
}

function Tab_BuySale_tabpage1_Button00_onclick(obj:Button,  e:ClickEventInfo)
{
	var v_class = "300001,300002,300003";
	var v_arr_class = "";
	
	v_arr_class = v_class.split(",");	
	for(var k=0; k < v_arr_class.length ; k++){
		var nfindRow = ds_center00.findRowExpr("centerCode=='" + v_arr_class[k] + "'");
		if (nfindRow != -1) {
			ds_center00.setColumn(nfindRow, "chk", 1);
		}
		trace(v_arr_class[k]);
	}
	
}

// 자재분류별 집계, 매입매출집계 HEAD 타이틀 변경
function rdo_view_onitemchanged(obj:Radio, e:ItemChangeEventInfo)
{
	var v_view = ds_search.getColumn(0, "schView");
	
 	if (v_view == "1") {	
 		Tab_BuySale.tabpage1.grd_list.setFormatColProperty(4,"size",0);
 		Tab_BuySale.tabpage1.grd_list.setFormatColProperty(5,"size",0);
 	} else {
 		Tab_BuySale.tabpage1.grd_list.setFormatColProperty(4,"size",75);
 		Tab_BuySale.tabpage1.grd_list.setFormatColProperty(5,"size",120);
 	}
	
}
]]></Script>
  </Form>
</FDL>

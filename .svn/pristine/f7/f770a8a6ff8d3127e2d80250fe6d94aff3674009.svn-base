<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="FMP00080E" onactivate="FMP00080E_OnActivate" ondeactivate="FMP00080E_OnDeactivate" onkeydown="fn_FormKeyDown" onload="form_onload" ontimer="FMP00080E_OnTimer" titletext="발주요청자조회" position="absolute 0 0 996 593" scrollbars="none" onsize="FMP00080E_onsize">
    <Layouts>
      <Layout>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 981 103" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 1009 40"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 98"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 1000 71"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 240 40 270 100"/>
        <Grid autoenter="select" binddataset="ds_List" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="gd_list" useinputpanel="false" taborder="8" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 124 981 580" selecttype="row" anchor="all" autofittype="none" autofitminwidth="981">
          <Formats>
            <Format id="ORI">
              <Columns>
                <Column size="25"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="140"/>
                <Column size="100"/>
                <Column size="0"/>
                <Column size="35"/>
                <Column size="60"/>
                <Column size="80"/>
                <Column size="60"/>
                <Column size="90"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="60"/>
                <Column size="50"/>
                <Column size="60"/>
                <Column size="120"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="0"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="20"/>
                <Row size="22" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" text="관리부서"/>
                <Cell col="2" text="본사코드"/>
                <Cell col="3" text="본사명"/>
                <Cell col="4" text="사업장코드"/>
                <Cell col="5" text="사업장명"/>
                <Cell col="6" displaytype="text" text="상품코드"/>
                <Cell col="7" displaytype="text" text="상품명"/>
                <Cell col="8" displaytype="text" text="규격"/>
                <Cell col="9" displaytype="text" text="원산지"/>
                <Cell col="10" displaytype="text" text="단위"/>
                <Cell col="11" displaytype="text" text="보관유형"/>
                <Cell col="12" displaytype="text" text="단가"/>
                <Cell col="13" displaytype="text" text="수량"/>
                <Cell col="14" displaytype="text" text="금액"/>
                <Cell col="15" displaytype="text" text="부가세"/>
                <Cell col="16" displaytype="text" text="합계"/>
                <Cell col="17" displaytype="text" text="비고"/>
                <Cell col="18" text="발주요청자"/>
                <Cell col="19" displaytype="text" text="발주상태"/>
                <Cell col="20" displaytype="text" text="마감"/>
                <Cell col="21" displaytype="text" text="마감일"/>
                <Cell col="22" displaytype="text" text="주문번호"/>
                <Cell col="23" displaytype="text" text="발주구분"/>
                <Cell col="24" text="발주시간"/>
                <Cell col="25" text="등록자"/>
                <Cell col="26" text="등록자"/>
              </Band>
              <Band id="body">
                <Cell celltype="head" displaytype="text" style="align:right;backgroundimage:EXPR(expr_GetRowTypeImg(currow));" expr="expr:currow + 1"/>
                <Cell col="1" edittype="none" style="align:left;background:white;background2:white;" text="bind:CC_NM"/>
                <Cell col="2" displaytype="text" edittype="none" style="background:white;background2:white;" text="bind:MAIN_UPJANG"/>
                <Cell col="3" edittype="none" style="align:left;background:white;background2:white;" text="bind:MAIN_UPJANGNM"/>
                <Cell col="4" displaytype="text" edittype="none" style="background:white;background2:white;" text="bind:UPJANG"/>
                <Cell col="5" edittype="none" style="align:left;background:white;background2:white;" text="bind:UPJANGNM"/>
                <Cell col="6" displaytype="text" edittype="none" style="align:center;background:white;background2:white;" text="bind:ITEM_CODE"/>
                <Cell col="7" displaytype="text" edittype="none" style="align:left;background:white;background2:white;" text="bind:ITEM_NAME"/>
                <Cell col="8" displaytype="text" edittype="none" style="align:left;background:white;background2:white;" text="bind:ITEM_SIZE"/>
                <Cell col="9" displaytype="text" edittype="none" style="align:left;background:white;background2:white;" text="bind:ORIGIN_TYPE"/>
                <Cell col="10" displaytype="text" edittype="none" style="align:center;background:white;background2:white;" text="bind:PO_UOM"/>
                <Cell col="11" displaytype="text" edittype="none" style="align:left;background:white;background2:white;" text="bind:KEEPING_TYPE"/>
                <Cell col="12" displaytype="number" edittype="none" style="background:white;background2:white;" text="bind:OP_PRICE" mask="#,##0"/>
                <Cell col="13" displaytype="number" edittype="none" editfilter="expr:setfilterExpr(iif(CLS_STATUS=='마감',&quot;none&quot;,&quot;number&quot;))" style="background:white;background2:white;" text="bind:PR_QTY" mask="#,##0.0" editautoselect="true"/>
                <Cell col="14" displaytype="number" edittype="none" style="background:white;background2:white;" text="bind:OP_AMOUNT" mask="#,##0"/>
                <Cell col="15" displaytype="number" edittype="none" style="background:white;background2:white;" expr="expr:Math.round(iif(TAX_CODE==&quot;100&quot;,0.1,0)* OP_AMOUNT)" mask="#,##0"/>
                <Cell col="16" displaytype="number" edittype="none" style="background:white;background2:white;" expr="expr:Math.round(iif(TAX_CODE==&quot;100&quot;,1.1,1)* OP_AMOUNT)" mask="#,##0"/>
                <Cell col="17" displaytype="text" edittype="none" editfilter="expr:setfilterExpr(iif(CLS_STATUS=='마감',&quot;none&quot;,&quot;normal&quot;))" style="align:left;background:white;background2:white;" text="bind:PR_REMARK" editlimit="300" editimemode="native" editautoselect="true"/>
                <Cell col="18" edittype="none" style="background:white;background2:white;" text="bind:T_ORDER"/>
                <Cell col="19" displaytype="text" edittype="none" style="align:center;background:white;background2:white;color:EXPR(iif(PO_LINE_STATUS==&quot;발주취소&quot; || PO_LINE_STATUS == &quot;결의반려&quot;, &quot;red&quot;, &quot;black&quot;));color2:EXPR(iif(PO_LINE_STATUS==&quot;발주취소&quot; || PO_LINE_STATUS == &quot;결의반려&quot;, &quot;red&quot;, &quot;black&quot;));" text="bind:PO_LINE_STATUS"/>
                <Cell col="20" displaytype="text" edittype="none" style="align:center;background:white;background2:white;" text="bind:CLS_STATUS"/>
                <Cell col="21" displaytype="text" edittype="none" style="align:center;background:white;background2:white;" text="bind:D_DAY_DISP"/>
                <Cell col="22" displaytype="text" edittype="none" style="align:center;background:white;background2:white;" text="bind:PR_NUM"/>
                <Cell col="23" displaytype="text" edittype="none" style="align:left;background:white;background2:white;" text="bind:DOCU_SOURCE"/>
                <Cell col="24" edittype="none" style="background:white;background2:white;" text="bind:APPROVE_TIME"/>
                <Cell col="25" edittype="none" style="background:white;background2:white;" text="bind:CREATE_BY"/>
                <Cell col="26" edittype="none" style="background:white;background2:white;" text="bind:REGNM"/>
              </Band>
              <Band id="summary">
                <Cell displaytype="text" style="align:left;"/>
                <Cell col="1"/>
                <Cell col="2"/>
                <Cell col="3"/>
                <Cell col="4"/>
                <Cell col="5"/>
                <Cell col="6" displaytype="text" style="align:center;" text="합  계"/>
                <Cell col="7" displaytype="number" style="align: ;" expr="expr:getCaseCount(&quot;PR_QTY&gt;0&quot;)" mask="#,##0"/>
                <Cell col="8" displaytype="text" style="align:left;" text="건"/>
                <Cell col="9" displaytype="text" style="align:left;"/>
                <Cell col="10" displaytype="text" style="align:left;"/>
                <Cell col="11" displaytype="text" style="align:left;"/>
                <Cell col="12" displaytype="number" style="align:right middle;" expr="expr:getSum(&quot;OP_PRICE&quot;)" mask="#,##0"/>
                <Cell col="13" displaytype="number" style="align: ;" expr="expr:getSum(&quot;PR_QTY&quot;)" mask="#,##0.0"/>
                <Cell col="14" displaytype="number" style="align: ;" expr="expr:getSum(&quot;OP_AMOUNT&quot;)" mask="#,##0"/>
                <Cell col="15" displaytype="number" style="align: ;" expr="expr:getCaseSum(&quot;TAX_CODE=='100'&quot;,&quot;Math.round(OP_AMOUNT/10)&quot;)" mask="#,##0"/>
                <Cell col="16" displaytype="number" style="align: ;" expr="expr:getSum(&quot;Math.round(iif(TAX_CODE=='100',1.1,1)* OP_AMOUNT)&quot;)" mask="#,##0"/>
                <Cell col="17" displaytype="text" style="align:left;"/>
                <Cell col="18"/>
                <Cell col="19" displaytype="text" style="align:left;"/>
                <Cell col="20" displaytype="text" style="align:left;"/>
                <Cell col="21" displaytype="text" style="align:left;"/>
                <Cell col="22" displaytype="text" style="align:left;"/>
                <Cell col="23" displaytype="text" style="align:left;"/>
                <Cell col="24"/>
                <Cell col="25"/>
                <Cell col="26"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static2" text="발주내역" position="absolute 0 107 123 125" class="sta_WF_Title01"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="52" url="cmn::CmnBtn.xfdl" text="Div0" scrollbars="none" position="absolute 0 0 981 30"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 981 0 996 593" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 578 981 593" anchor="left bottom"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 73 40 84 96"/>
        <Static id="Static10" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 340 40 350 61"/>
        <Static id="Static59" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute -1 119 449 124" anchor="left top"/>
        <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 90 1000 105" anchor="left top"/>
        <Static id="st_MainUpjang" text="본     사" class="sta_WFSA_label" position="absolute 14 70 77 91" userdata="strQuery_FMMainUpjang"/>
        <Edit id="ed_MainUpjang" taborder="53" readonly="true" autoselect="true" onkeydown="fn_edBtn_OnKeyDown" position="absolute 84 70 239 91"/>
        <Button id="btn_MainUpjang" taborder="54" tabstop="false" onclick="fn_edBtn_OnClick" class="btn_WF_popSearch" position="absolute 236 70 257 91"/>
        <Edit id="ed_Upjang" taborder="55" readonly="true" onkeydown="fn_edBtn_OnKeyDown" position="absolute 338 70 505 91"/>
        <Button id="btn_Upjang" taborder="56" tabstop="false" onclick="fn_edBtn_OnClick" class="btn_WF_popSearch" position="absolute 504 70 525 91"/>
        <Static id="st_Upjang" text="사업장" class="sta_WFSA_label" position="absolute 278 70 335 91" userdata="strQuery_FMUpjang"/>
        <Static id="Static28" text="관리부서" class="sta_WFSA_label" position="absolute 15 40 77 61" anchor="left top"/>
        <TmSearchComponent id="comp_tm" titletext="팀 검색용 Component" taborder="57" onkeydown="comp_tm_onkeydown" text="TmSearchComponent00" position="absolute 84 40 257 61" bindDataset="ds_Cond" bindTmCdColumn="schTm" bindTmNmColumn="schTmNm" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tm" eventBeforeTrigger=""/>
        <Static id="Static26" text="CC" class="sta_WFSA_label" position="absolute 278 41 340 62" anchor="left top"/>
        <Edit id="edt_ccCd" taborder="58" readonly="true" onkeydown="edt_ccCd_onkeydown" position="absolute 338 40 505 61" anchor="left top"/>
        <Button id="btn_ccCd" taborder="59" class="btn_WF_popSearch" position="absolute 504 40 525 61"/>
        <Static id="Static15" text="구매유형" class="sta_WFSA_label" position="absolute 536 39 598 60" anchor="left top"/>
        <Combo id="cbo_type" taborder="60" value="00" innerdataset="ds_type" codecolumn="poType" datacolumn="typeName" onitemchanged="cbo_type_onitemchanged" position="absolute 603 40 765 61" anchor="left top"/>
        <Static id="Static00" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 525 40 536 96"/>
        <Static id="Static01" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 765 40 776 96"/>
        <Static id="Static30" text="담당CS" class="sta_WFSA_label" position="absolute 778 41 833 62" anchor="left top"/>
        <PersonalSearchComponent id="comp_csSawon" titletext="사원 검색용 Component" taborder="61" onclick="PersonalSearchComponent00_onclick" text="PersonalSearchComponent00" position="absolute 840 40 981 61" bindDataset="ds_Cond" bindSabunColumn="csSabun" bindNmKorColumn="csNm" qoMuCd="" qoTmCd="" qoTmNm="" eventAfterTrigger="" eventBeforeTrigger="" qoCcCd="" qoCcNm=""/>
        <Static id="Static22" text="조회기간" class="sta_WFSA_label" position="absolute 537 71 613 92" anchor="left top" onclick="Static22_onclick"/>
        <ObjCalendar id="cal_rDate1" titletext="캘린더" taborder="62" text="20150101" scrollbars="none" position="absolute 608 71 696 92"/>
        <Static id="Static58" text="~" position="absolute 695 71 711 90" style="align:center middle;"/>
        <ObjCalendar id="cal_rDate2" titletext="캘린더" taborder="63" text="20150101" scrollbars="none" position="absolute 710 71 798 92"/>
        <CheckBox id="cbReqNm" taborder="64" position="absolute 815 70 923 90" text="발주요청자" value="true"/>
        <Edit id="edReqNm" taborder="65" position="absolute 818 164 960 185" visible="false"/>
        <Grid id="Grid00" taborder="66" binddataset="ds_Cond" useinputpanel="false" visible="false" position="absolute 30 394 650 487">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="ITEM_NAME"/>
                <Cell col="1" disptype="normal" text="NEED_DATE"/>
                <Cell col="2" disptype="normal" text="MAIN_UPJANG"/>
                <Cell col="3" disptype="normal" text="UPJANG"/>
                <Cell col="4" disptype="normal" text="SUBINV_CODE"/>
                <Cell col="5" disptype="normal" text="CONSUM_YN"/>
                <Cell col="6" disptype="normal" text="QTY_CONTROL_YN"/>
                <Cell col="7" disptype="normal" text="CENTER_CODE"/>
                <Cell col="8" disptype="normal" text="AP_UNITPRICE_UPJANG"/>
                <Cell col="9" disptype="normal" text="OTCUST_PRICE_UPJANG"/>
                <Cell col="10" disptype="normal" text="FAVOR_GROUP"/>
                <Cell col="11" disptype="normal" text="NEED_DATEP"/>
                <Cell col="12" disptype="normal" text="UPJANGP"/>
                <Cell col="13" disptype="normal" text="SUBINV_CODEP"/>
                <Cell col="14" disptype="normal" text="ITEM_CLASS2"/>
                <Cell col="15" disptype="normal" text="ITEM_CLASS3"/>
                <Cell col="16" disptype="normal" text="ITEM_CLASS4"/>
                <Cell col="17" disptype="normal" text="ITEM_CODE"/>
                <Cell col="18" disptype="normal" text="NEED_DATET"/>
                <Cell col="19" disptype="normal" text="UPJANGT"/>
                <Cell col="20" disptype="normal" text="SUBINV_CODET"/>
                <Cell col="21" disptype="normal" text="schTm"/>
                <Cell col="22" disptype="normal" text="schTmNm"/>
                <Cell col="23" disptype="normal" text="schMu"/>
                <Cell col="24" disptype="normal" text="schRdate1"/>
                <Cell col="25" disptype="normal" text="schRdate2"/>
                <Cell col="26" disptype="normal" text="schCc"/>
                <Cell col="27" disptype="normal" text="schCcNm"/>
                <Cell col="28" disptype="normal" text="csNm"/>
                <Cell col="29" disptype="normal" text="csSabun"/>
                <Cell col="30" disptype="normal" text="schType"/>
                <Cell col="31" disptype="normal" text="schChk"/>
                <Cell col="32" disptype="normal" text="schRqNm"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:ITEM_NAME"/>
                <Cell col="1" disptype="normal" text="bind:NEED_DATE"/>
                <Cell col="2" disptype="normal" text="bind:MAIN_UPJANG"/>
                <Cell col="3" disptype="normal" text="bind:UPJANG"/>
                <Cell col="4" disptype="normal" text="bind:SUBINV_CODE"/>
                <Cell col="5" disptype="normal" text="bind:CONSUM_YN"/>
                <Cell col="6" disptype="normal" text="bind:QTY_CONTROL_YN"/>
                <Cell col="7" disptype="normal" text="bind:CENTER_CODE"/>
                <Cell col="8" disptype="normal" text="bind:AP_UNITPRICE_UPJANG"/>
                <Cell col="9" disptype="normal" text="bind:OTCUST_PRICE_UPJANG"/>
                <Cell col="10" disptype="normal" text="bind:FAVOR_GROUP"/>
                <Cell col="11" disptype="normal" text="bind:NEED_DATEP"/>
                <Cell col="12" disptype="normal" text="bind:UPJANGP"/>
                <Cell col="13" disptype="normal" text="bind:SUBINV_CODEP"/>
                <Cell col="14" disptype="normal" text="bind:ITEM_CLASS2"/>
                <Cell col="15" disptype="normal" text="bind:ITEM_CLASS3"/>
                <Cell col="16" disptype="normal" text="bind:ITEM_CLASS4"/>
                <Cell col="17" disptype="normal" text="bind:ITEM_CODE"/>
                <Cell col="18" disptype="normal" text="bind:NEED_DATET"/>
                <Cell col="19" disptype="normal" text="bind:UPJANGT"/>
                <Cell col="20" disptype="normal" text="bind:SUBINV_CODET"/>
                <Cell col="21" disptype="normal" text="bind:schTm"/>
                <Cell col="22" disptype="normal" text="bind:schTmNm"/>
                <Cell col="23" disptype="normal" text="bind:schMu"/>
                <Cell col="24" disptype="normal" text="bind:schRdate1"/>
                <Cell col="25" disptype="normal" text="bind:schRdate2"/>
                <Cell col="26" disptype="normal" text="bind:schCc"/>
                <Cell col="27" disptype="normal" text="bind:schCcNm"/>
                <Cell col="28" disptype="normal" text="bind:csNm"/>
                <Cell col="29" disptype="normal" text="bind:csSabun"/>
                <Cell col="30" disptype="normal" text="bind:schType"/>
                <Cell col="31" disptype="normal" text="bind:schChk"/>
                <Cell col="32" disptype="normal" text="bind:schRqNm"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <MuSearchComponent id="comp_mu" titletext="사업부 선택 Component" taborder="67" text="MuSearchComponent00" class="cmb_WF_Essential" visible="false" position="absolute 1265 154 1367 175" bindDataset="ds_Cond" bindMuCdColumn="schMu" appendText="NOT" onItemChangedEvent=""/>
        <Static id="notice" text="본사 및 사업장조건 미지정 시 속도가 느려집니다." class="sta_WF_DiscInfo" position="absolute 660 108 978 126" anchor="top right"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_Cond">
        <ColumnInfo>
          <Column id="ITEM_NAME" size="100" type="STRING"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="MAIN_UPJANG" type="STRING" size="256"/>
          <Column id="UPJANG" size="22" type="STRING"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="QTY_CONTROL_YN" size="1" type="STRING"/>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="AP_UNITPRICE_UPJANG" size="22" type="INT"/>
          <Column id="OTCUST_PRICE_UPJANG" size="22" type="INT"/>
          <Column id="FAVOR_GROUP" size="50" type="STRING"/>
          <Column id="NEED_DATEP" size="8" type="STRING"/>
          <Column id="UPJANGP" size="22" type="INT"/>
          <Column id="SUBINV_CODEP" size="8" type="STRING"/>
          <Column id="ITEM_CLASS2" size="8" type="STRING"/>
          <Column id="ITEM_CLASS3" size="8" type="STRING"/>
          <Column id="ITEM_CLASS4" size="8" type="STRING"/>
          <Column id="ITEM_CODE" size="256" type="STRING"/>
          <Column id="NEED_DATET" type="STRING" size="256"/>
          <Column id="UPJANGT" type="STRING" size="256"/>
          <Column id="SUBINV_CODET" type="STRING" size="256"/>
          <Column id="schTm" type="STRING" size="256"/>
          <Column id="schTmNm" type="STRING" size="256"/>
          <Column id="schMu" type="STRING" size="256"/>
          <Column id="schRdate1" type="STRING" size="256"/>
          <Column id="schRdate2" type="STRING" size="256"/>
          <Column id="schCc" type="STRING" size="256"/>
          <Column id="schCcNm" type="STRING" size="256"/>
          <Column id="csNm" type="STRING" size="256"/>
          <Column id="csSabun" type="STRING" size="256"/>
          <Column id="schType" type="STRING" size="256"/>
          <Column id="schChk" type="STRING" size="256"/>
          <Column id="schRqNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Subinv">
        <ColumnInfo>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="SUBINV_NAME_DISP" size="100" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Days">
        <ColumnInfo>
          <Column id="D_DAYS" size="22" type="INT"/>
          <Column id="D_TIMES" size="4" type="STRING"/>
          <Column id="DAYS" size="50" type="STRING"/>
          <Column id="D_OVER_DAYS" size="22" type="INT"/>
          <Column id="QTY_CONTROL_YN" size="1" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_OrdCtrl">
        <ColumnInfo>
          <Column id="CTRL_TYPE" size="50" type="STRING"/>
          <Column id="FRI" size="1" type="STRING"/>
          <Column id="ITEM_TYPE" size="50" type="STRING"/>
          <Column id="MON" size="1" type="STRING"/>
          <Column id="SAT" size="1" type="STRING"/>
          <Column id="SUN" size="1" type="STRING"/>
          <Column id="THU" size="1" type="STRING"/>
          <Column id="TUE" size="1" type="STRING"/>
          <Column id="WED" size="1" type="STRING"/>
          <Column id="CHK_TYPE" size="100" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CrdInfo">
        <ColumnInfo>
          <Column id="CREDIT_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="CREDIT_AMOUNT_CONTROL_YN" size="1" prop="default" type="STRING"/>
          <Column id="CREDIT_AMOUNT_TOT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="CREDIT_AVAIL_AMT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="CREDIT_EXT_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="CREDIT_EXT_DAYS" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="CREDIT_OVER_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="CREDIT_RMN_AMT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="CREDIT_TURN_CONTROL_YN" size="1" prop="default" type="STRING"/>
          <Column id="CREDIT_TURN_DAYS" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="CREDIT_TURN_DAYS_TOT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="L_BILL_DATE" size="8" prop="default" type="STRING"/>
          <Column id="L_BILL_DATE_DISP" size="50" prop="default" type="STRING"/>
          <Column id="LAST_TURN_CNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="PO_AMT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="PR_AMT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="RMN_AMT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="TR_AMT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="BOND_AMT" size="22" prop="default" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Fav">
        <ColumnInfo>
          <Column id="FAVOR_GROUP" size="50" type="STRING"/>
          <Column id="FAVOR_NAME" size="100" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CtUpj">
        <ColumnInfo>
          <Column id="AP_UNITPRICE_UPJANG" size="22" type="INT"/>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="OTCUST_PRICE_UPJANG" size="22" type="INT"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List">
        <ColumnInfo>
          <Column id="CC_NM" type="STRING" size="256"/>
          <Column id="MAIN_UPJANG" type="STRING" size="256"/>
          <Column id="MAIN_UPJANGNM" type="STRING" size="256"/>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="UPJANGNM" type="STRING" size="256"/>
          <Column id="REGNM" type="STRING" size="256"/>
          <Column id="CENTER_CODE" size="22" prop="default" type="INT"/>
          <Column id="CENTER_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="CLS_STATUS" size="50" prop="default" type="STRING"/>
          <Column id="CUSTCD" size="22" prop="default" type="INT"/>
          <Column id="INVAT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="ITEM_CODE" size="50" prop="default" type="STRING"/>
          <Column id="ITEM_NAME" size="200" prop="default" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" prop="default" type="STRING"/>
          <Column id="LINE_STATUS" size="50" prop="default" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" prop="default" type="STRING"/>
          <Column id="OTCUSTCD" size="50" prop="default" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="PO_UOM" size="10" prop="default" type="STRING"/>
          <Column id="POINT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="PR_ID" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="PR_NUM" size="50" prop="default" type="STRING"/>
          <Column id="PR_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" prop="default" type="STRING"/>
          <Column id="PR_UPJANG" size="22" prop="default" type="INT"/>
          <Column id="RC_UPJANG" size="22" prop="default" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" prop="default" type="STRING"/>
          <Column id="TAX_CODE" size="3" prop="default" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" prop="default" type="BIGDECIMAL"/>
          <Column id="D_TIMES" size="4" prop="default" type="BIGDECIMAL"/>
          <Column id="D_DAY_DISP" size="200" prop="default" type="STRING"/>
          <Column id="IMAGE_PATH" size="200" prop="default" type="STRING"/>
          <Column id="OP_AMOUNT_OLD" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="DOCU_SOURCE" size="256" prop="default" type="STRING"/>
          <Column id="KEEPING_TYPE" type="STRING" size="256"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="ORIGIN_TYPE" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="PO_LINE_STATUS" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
          <Column id="APPROVE_TIME" type="STRING" size="256"/>
          <Column id="CREATE_BY" type="STRING" size="256"/>
          <Column id="PR_REMARK_RECENT" type="STRING" size="256"/>
          <Column id="T_ORDER" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SubinvP"/>
      <Dataset id="ds_Class2"/>
      <Dataset id="ds_Class3"/>
      <Dataset id="ds_Class4"/>
      <Dataset id="ds_Excel"/>
      <Dataset id="ds_ErrLst">
        <ColumnInfo>
          <Column id="errmsg" size="500" type="STRING"/>
          <Column id="errcode" size="100" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Excel_IN">
        <ColumnInfo>
          <Column id="UPJANG" size="255" type="STRING"/>
          <Column id="ITEM_CODE" size="256" type="STRING"/>
          <Column id="NEED_DATE" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="ITEM_CODE"/>
            <Col id="NEED_DATE"/>
            <Col id="UPJANG"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Excel_OUT"/>
      <Dataset id="ds_Green">
        <ColumnInfo>
          <Column id="BALANCE_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="GREEN_AMT" size="200" type="STRING"/>
          <Column id="USE_YN" size="2" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Green_Proc">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="256" type="STRING"/>
          <Column id="CUSER" size="256" type="STRING"/>
          <Column id="OUT_RTN_MESSAGE" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_WeekendTime">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="SET1" type="STRING" size="256"/>
          <Column id="SET2" type="STRING" size="256"/>
          <Column id="SET3" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_save_out" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codename" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">0</Col>
            <Col id="delYn">0</Col>
            <Col id="savYn">0</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">0</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_type" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="poType" type="STRING" size="256"/>
          <Column id="typeName" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item9" compid="edt_ccCd" propid="value" datasetid="ds_Cond" columnid="schCcNm"/>
      <BindItem id="item1" compid="cbo_type" propid="value" datasetid="ds_Cond" columnid="schType"/>
      <BindItem id="item0" compid="cal_rDate1" propid="text" datasetid="ds_Cond" columnid="schRdate1"/>
      <BindItem id="item2" compid="cal_rDate2" propid="text" datasetid="ds_Cond" columnid="schRdate2"/>
      <BindItem id="item3" compid="cbReqNm" propid="value" datasetid="ds_Cond" columnid="schChk"/>
      <BindItem id="item4" compid="edReqNm" propid="value" datasetid="ds_Cond" columnid="schRqNm"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
include "lib::lib_com.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 식재영업/발주관리/상품 발주
 * 프로그램명   : FMP00080E.XML
 * 기      능   : 상품 발주
 * 작  성  자   : 박은규
 * 작성  일자   : 2008-01-17
                   2017-02-23 : 추가요청 수정 (CH201702_00663)
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
*/
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"				// 시스템 공통
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"		//JAVA 코딩시
//@@컨버터에서 주석처리 #include "LIB::tit_comm_0001.js"		// X-Framework Lib
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"		// 공통팝업
//@@컨버터에서 주석처리 #include "lib::fm_common.js"			// FM공통
//=========================================================================================
// [ PART 2 ]    
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var fa_Sql;
var fa_sDay;
var fa_DocSrc = '07 FM(상품)';
var fa_DocSrc1 = '07 FM';             //구 푸드엠 주문내용  ---> 상품발주로 간주
var fa_DocSrc2 = '01 BO';             //통합영업 주문내용   ---> 상품발주로 간주
var fa_DocSrc3 = '07 FM(모바일)';    //모바일 주문내용
var pre_need_date = gfn_addDate(gfn_today(),1);  				  //날짜 변경전 이전 날짜 기억
var fa_weekendTimeCheck = "N"; // 주말 발주 통제 여부
var fa_startTime; // 통제시작시간
var fa_endTime; // 통제종료시간

//최초등록시 주문번호 채번, 이후에는 같은 주문번호로 발주되도록 함
var fn_gubunNewOrOld = "NEW";
var fn_maxPrNum = "";
var fn_maxApproveNum = "";
var fn_maxBefApproveNum = "";
var fn_dsListCnt = 0;
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);
	
	//초기화
	fn_init(this);
	v_ds_check = "ds_List";
	
	gd_list.formatid = "ORI";
	
	fn_searchType();
	
	cbReqNm.value = true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	v_ds_check = "";

	//조회조건을 초기화한다.
	var nRow= ds_Cond.addRow();
	ds_Cond.setColumn(nRow, "schRdate1", gfn_today().substr(0,6) + '01');						// 보정기간 : 현재일자
	ds_Cond.setColumn(nRow, "schRdate2", gfn_today());						// 보정기간 : 현재일자
	
	// 일자 SET
	cal_rDate1.fn_initMonthCal(this, "", "", ds_Cond, "schRdate1", "Y");	
	cal_rDate2.fn_initMonthCal(this, "", "", ds_Cond, "schRdate2", "Y");	

	comp_mu.setMuCode('2004')
	// 팀 초기화
	comp_tm.applyAuthLevel(comp_mu);
	
	ed_MainUpjang.userdata = application.g_Main_Upjang;
	ed_MainUpjang.value     = application.g_Main_UpjangNm;
   	//사용자 정보(업장) 받아서 화면에 뿌리기.
	ed_Upjang.userdata     = application.g_Upjang;
	ed_Upjang.value         = application.g_UpjangNm;

	SCPopup.bind(this, "CcCode", "edt_ccCd", "btn_ccCd", null, {muCd:"", tmCd:""}, {before:"fn_ccBeforeEvent", after:"fn_ccAfterEvent"});
}

function fn_InitService()
{
	////////// 1. 센터단가업장정보 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc, trId;
	trId  = "searchCtUpj";
    outData		= "ds_CtUpj=ds_List";
    otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);
    callBackFnc = "fn_CallbakInitService";
	fsp_clear(this); 
	fsp_addSearch(this, "fm/fmz:FMZ_GET_CTUPJ_S001");
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc, "", "", "", trId);
}

function fn_CallbakInitService(errCode, errMsg, svcId)
{	
	if (errCode == 0)
	{
	    
	    switch(svcId)
		{
			case "searchCtUpj":
				
				if (ds_CtUpj.rowcount <= 0)
				{
					g_Message("EE","업장기초정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
					return;
				}
				
				////////// 2. 창고 조회
				ds_Subinv.clearData();
				var actionName, cmdName, inData, outData, otherArg, callBackFnc, trId;
				trId  = "searchSubinv";
				outData		= "ds_Subinv=ds_List";
				otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);
				callBackFnc = "fn_CallbakInitService";
				
				fsp_clear(this); 
				fsp_addSearch(this, "fm/fmz:FMZ_PO_SUBINV_S001");
				fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc, true, "", "", trId);
	            
				break;
			
			case "searchSubinv":
				//기본창고지정
	            if (ds_Subinv.rowcount > 0) cbo_Subinv.index = 0;
	            
	            tab_list.tab4.ed_UpjangP.userdata = ed_Upjang.userdata;
				tab_list.tab4.ed_UpjangP.value     = ed_Upjang.value;
				Copy(ds_SubinvP,ds_Subinv);
				tab_list.tab4.cbo_SubinvP.value   = cbo_Subinv.value;
				tab_list.tab4.me_NeedDateP.value  = gfn_addDate(me_NeedDate.value,-7);
	            
	            ////////// 3. 디데이 조회
				ds_Days.clearData();
				var actionName, cmdName, inData, outData, otherArg, callBackFnc, trId;
				trId  = "searchDays";
				outData		= "ds_Days=ds_List";
				otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata) + " SUBINV_CODE=" + wrapQuote(cbo_Subinv.value) + " NEED_DATE=" + wrapQuote(me_NeedDate.value);
				callBackFnc = "fn_CallbakInitService";
				fsp_clear(this); 
				fsp_addSearch(this, "fm/fmz:FMZ_GETDAYS_S001");
				fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc, "", "", "", trId);
				
				////////// 4. 주문통제 조회
				ds_OrdCtrl.clearData();
				var actionName, cmdName, inData, outData, otherArg, callBackFnc, trId;
				trId  = "searchOrdCtrl";
				outData		= "ds_OrdCtrl=ds_List";
				otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);
				callBackFnc = "fn_CallbakInitService";
				fsp_clear(this); 
				fsp_addSearch(this, "fm/fmz:FMZ_ORD_CTRL_S001");
				fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc, "", "", "", trId);
				
				////////// 5. 사업장이 여신관리하는지 여부 조회
				var dsObjin, dsObjot;
				create("Dataset", "ds_Dummyin");
				create("Dataset", "ds_Dummyot");
				dsObjin = eval("ds_Dummyin");
				dsObjin.addColumn("UPJANG", "INT", 22);
				dsObjin.addColumn("NEED_DATE", "STRING", 8);
				dsObjot = eval("ds_Dummyot");
				dsObjot.addColumn("CRD_YN", "STRING", 1);
				ds_Dummyin.clearData();
				ds_Dummyot.clearData();
				ds_Dummyin.addRow();
				ds_Dummyin.setColumn(0, "UPJANG",         ed_Upjang.userdata);
				ds_Dummyin.setColumn(0, "NEED_DATE",      me_NeedDate.value);
				var actionName, cmdName, inData, outData, otherArg, callBackFnc, trId;
				trId  = "searchCreditChk";
				inData		= "ds_Cond=ds_Dummyin";
				outData		= "ds_Dummyot=ds_List";
				fsp_clear(this); 
				fsp_addSearch(this, "fm/fmz:FMZ_CREDIT_CHKYN_S001");
				fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc, "", "", "", trId);
				
				break;
				
			case "searchDays":
				
				//디데이 표시
				if (ds_Days.rowcount > 0) {
					st_Days.text = "(발주 마감 : " + ds_Days.getColumn(0,"DAYS") + ")";
				} else {
					g_Message("EE","발주마감정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
				}
	            
				break;	
				
			case "searchCreditChk":
				
				/*여신정보조회(비동기조회)*/
				fn_GetCredit(false);
				
				/*자동조회*/
				fn_search();
				
				/*
				if (ds_Dummyot.rowcount > 0) {
					
					////////// 6. 여신정보 조회
					ds_Cond.clearData();
					ds_CrdInfo.clearData();
					ds_Cond.addRow();
					ds_Cond.setColumn(0, "UPJANG",         ed_Upjang.userdata);
					ds_Cond.setColumn(0, "NEED_DATE",      me_NeedDate.value);
					var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, trId;
					strSvcID = "searchCreditInfo";
					//strURL   = "U_svc::" + "fm/fmz/FMZ_CREDIT_INFO_T001.jsp";
					strURL   = "U_svc::" + "fm/fmz/FMZ_CREDIT_INFO_PRT_T003.jsp";
					strInDatasets  = "ds_Cond=ds_Cond";
					strOutDatasets = "ds_CrdInfo=ds_List";
					strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
					strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
					strCallbackFunc = "fn_CallbakInitService";
					jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, "", "", "");
					
				} else {
					//여신정보 초기화
					ds_CrdInfo.clearData();
					ed_Credit.value = "무 제 한";
					return;
				}
				
				//ds임시생성 해제
				Destroy("ds_Dummyin");
				Destroy("ds_Dummyot");
				*/
				break;
				
						
			case "searchCreditInfo":
				
				//여신 표시
				/*
				if (ds_CrdInfo.rowcount > 0) 
				{
					if (ds_CrdInfo.getColumn(0,"CREDIT_AMOUNT_CONTROL_YN") == "Y")
					{
						ed_Credit.value = gfn_numFormat(gfn_trim(ds_CrdInfo.getColumn(0,"CREDIT_RMN_AMT")))+ " 원";
						ed_Bond.value = gfn_numFormat(gfn_trim(ds_CrdInfo.getColumn(0,"BOND_AMT")))+ " 원";
					}	
					else
						ed_Credit.value = "무 제 한";
				}
				else
				{
					g_Message("EE","업장여신정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
					return;
				}
				
				//최종 발주정보
				//fn_GetLastOrd();
				
				//자동조회
				fn_search();
				*/
				break;	
				
			default:
				break;
		}
	    
	} else {
		g_Message("EE",fn_AlertMsg("002"));
	}
}

//=========================================================================================
// [ PART 4 ] 
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*------------------------------------------------------------(60)
	1. Function ID : fn_Search()
	2. 개       요 : 업무프로세스에 따른 조회작업
	3. 기       능 : 검색조건에 해당하는 정보를 조회
	4. 인 수 설 명 : 
*/
function fn_search()
{
	//필수항목 
	//if (fn_ChkManNull()) return;

	// 초기화
	ds_List.clearData();
	ds_Cond.setColumn(0, "MAIN_UPJANG",   ed_MainUpjang.userdata);
	ds_Cond.setColumn(0, "UPJANG",        ed_Upjang.userdata);
	
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMP00081E_T002";
	strURL   = "U_svc::" + "fm/fmp/FMP00081E_T002.jsp";
	// 데이터셋 설정
	strInDatasets  = "ds_Cond=ds_Cond";
	strOutDatasets = "ds_List=ds_List";
	// 파라메터 설정
	strArgument  = "";
	// 콜백함수 지정
	strCallbackFunc = "fn_CallBack_Search";
	// 서버 호출 
	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true); 
}
function fn_NeedDateCheck()
{
	//ds임시생성
	var dsObjin, dsObjot;
		
	create("Dataset", "ds_Dummyin");
	create("Dataset", "ds_Dummyot");
	
	dsObjin = eval("ds_Dummyin");
	dsObjin.addColumn("UPJANG", "INT", 22);
	dsObjin.addColumn("NEED_DATE", "STRING", 8);
	dsObjot = eval("ds_Dummyot");
	dsObjot.addColumn("CNT", "INT", 22);
	
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 초기화
	ds_Dummyin.clearData();
	ds_Dummyot.clearData();
	ds_Dummyin.addRow();
	ds_Dummyin.setColumn(0, "UPJANG",         ed_Upjang.userdata);
	ds_Dummyin.setColumn(0, "NEED_DATE",      me_NeedDate.value);
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    inData		= "ds_Cond=ds_Dummyin";
    outData		= "ds_Dummyot=ds_List";
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_ORD_CTRL_S002");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	var bYn = (ds_Dummyot.getColumn(0, "CNT") > 0);
	//ds임시생성 해제
	Destroy("ds_Dummyin");
	Destroy("ds_Dummyot");
	
	return bYn;
}

/*------------------------------------------------------------
	1. Function ID : fn_Insert()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_insert()
{
}
/*------------------------------------------------------------
	1. Function ID : fn_Delete()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_delete()
{
	if (ds_List.rowcount < 1)
	{
		g_Message("EE", fn_AlertMsg("006"));
		return;
	}
	
	if (ds_List.rowposition < 0  || ds_List.getSelect(ds_List.rowposition) == false)
	{
		g_Message("EE", "삭제할 상품을 선택하세요.");
		return;
	}
	//if (ds_List.GetColumn(ds_List.row,"LINE_STATUS") <> "004")
	if (ds_List.getColumn(ds_List.rowposition,"CLS_STATUS") == "마감")
	{
		g_Message("EE", "해당상품은 마감이 완료되어 삭제가 불가합니다.");
		return;
	}
	//발주가능 체크
	if (! fn_OrdChk()) return;
	//기존 자료인 경우 디데이 체크
	if (GetRowType(ds_List,ds_List.rowposition)<> 'insert')
	{
		if (fn_GetDayStatus(ds_List.getColumn(ds_List.rowposition,"D_DAYS"), ds_List.getColumn(ds_List.rowposition,"D_TIMES")) == "0")
		{
			g_Message("EE","해당 상품은 마감시간(D-Days)이 초과되어 삭제가 불가합니다.");
			return;
		}
	}
	//
	if (! g_Confirm("01", '선택하신 주문상품을 삭제하시겠습니까?!')) return;
	
	if (GetRowType(ds_List,ds_List.rowposition)== 'insert')
	{
		ds_List.deleteRow(ds_List.rowposition);
		return;
	}
	
	//실제 Table자료 삭제 시 Table에서 즉시 삭제처리
	//필수항목 
	if (fn_ChkManNull()) return;
	//
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMP00160E_T003";
	strURL   = "U_svc::" + "fm/fmp/FMP00160E_T003.jsp";
	// 데이터셋 설정U
	strInDatasets  = "";
	strOutDatasets = "";
	// 파라메터 설정
	strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
	strArgument += " sDocSrc=" + wrapQuote(fa_DocSrc);
	strArgument += " sPrID=" + wrapQuote(ds_List.getColumn(ds_List.rowposition,"PR_ID"));
	strArgument += " sPrNum=" + wrapQuote(ds_List.getColumn(ds_List.rowposition,"PR_NUM"));
	strArgument += " sOtcustCD=" + wrapQuote(ds_List.getColumn(ds_List.rowposition,"OTCUSTCD"));
	strArgument += " sMenuFlag=" + wrapQuote("N");
	strArgument += " sUpjang=" + wrapQuote(ds_List.getColumn(ds_List.rowposition,"RC_UPJANG"));
	strArgument += " sMenuCD=" + wrapQuote(ds_List.getColumn(ds_List.rowposition,"NEED_DATE") + "-" + ds_List.getColumn(ds_List.rowposition,"SUBINV_CODE"));
	strArgument += " sItemCode=" + wrapQuote(ds_List.getColumn(ds_List.rowposition,"ITEM_CODE"));
	strArgument += " sPrUpjang=" + wrapQuote(ed_Upjang.userdata);
	strArgument += " sPrSabun=" + wrapQuote(g_EmpNo);
	// 콜백함수 지정
	strCallbackFunc = "fn_CallBack_Delete";
	// 서버 호출 
	//Transaction(strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc);
	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
}
/*------------------------------------------------------------
	1. Function ID : fn_Save(confirmYn)
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : confirmYn = null 이면 저장하시겠습니까라는 창을 띄움
	                 confirmYn = 1 이면 저장하시겠습니까라는 창을 안띄움
*/
function fn_save(confirmYn)
{
	//저장 버튼 누른 후 팝업 상태에서 마감시간 이후 저장 체크를 위한 변경
	//[HISTORY] : 수정일 > 2009/01/19
	//            수정자 > 노규완
	//            수정 내용 > 저장 Confirm 팝업 메시지를 제일 먼저 띄어 줌.
	
/*
	//입고통제일 체크 
	if (fn_NeedDateCheck()) 
	{
	    g_Message("EE","해당일자는 입고통제일 입니다.");
		return;
	}	
*/
	
	/*시스템 통제 시간 체크 - 특정일자에 사용을 할 수 없게 한다.*/
	mfn_GetSystemWorkCheck("PO");
	if (ds_common.getColumn(0, 0) == "Y")
	{
		g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
		return false; 
	}

	if (ed_Credit.value == "여신정보갱신중")
	{
		alert("여신정보갱신중입니다. 조금만 기다려주세요");
		return;
	}
	
	// 저장 전 사용자 메세지 전달
	if (! g_Confirm("", "주문내역을 저장하시겠습니까?"))
	{
		return;
	}
	
	//발주량 0상품 확인
	var nRow;
	nRow = ds_List.findRowExpr("PR_QTY==0");
	if (nRow >= 0)
	{
		if (! g_Confirm("02", "발주량이 0인 상품이 있습니다.\n\n그대로 저장하시겠습니까?"))
		{
			ds_List.rowposition = nRow;
			gd_list.setFocus();
			gd_list.setCellPos(ffn_Get_HeaderTitleColIdx(gd_list,"수량"));
			return;
		}
	}
	

	
	//현재시간 초기화. 
	//발주가능, 데이타체크에서 현재시간을 통해 계산하기때문에
	fn_SetTimer();
	//필수항목 
	if (fn_ChkManNull()) return;
	//발주가능 체크(창고)
	if (! fn_OrdChk()) return;
	// 데이타체크(여신및 상품별 디데이체크)
	var sRtn = fn_ChkData();
	if (sRtn != null)
	{
		g_Message("EE", sRtn);
		return;
	}
	
/*
   	// action 정보 초기화 
    tit_clearActionInfo(this);
	// 초기화
	ds_Cond.ClearData();
	ds_Cond.AddRow();
	ds_Cond.SetColumn(0, "SUBINV_CODE",    cbo_Subinv.Value);
	ds_Cond.SetColumn(0, "NEED_DATE",      me_NeedDate.Value);
    // 서비스셋팅
    var actionName, cmdName, inData, outData, otherArg, callBackFnc;
    var singleSql, insertSql, updateSql, deleteSql, saveFlagColumn, keySqlName, keyIncrement, callbackSql;
    inData		= "ds_IUD=ds_List:U ds_Cond=ds_Cond";
    outData		= "ds_List=ds_List";
    callBackFnc	= "fn_CallBack_Save";
	// 파라미터셋팅
    insertSql	= "fm/fmp:FMP00160E_I001";
    updateSql	= "fm/fmp:FMP00160E_U001";
    deleteSql	= "fm/fmp:FMP00160E_D001";
//    keySqlName	= "fm/fmz:FMZ_PR_NUM_S002";
//    keyIncrement= 0;
    callbackSql	= "fm/fmp:FMP00160E_S002";
	// 서버에서 작업할 정보 추가
	tit_addSearchActionInfo(this, "fm/fmz:FMZ_PR_NUM_S002", true);
	tit_addSaveActionInfo(this, insertSql, updateSql, deleteSql, saveFlagColumn, keySqlName, keyIncrement, callbackSql);
	// 서버 호출
	tit_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
*/

	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMP00160E_T001";
	strURL   = "U_svc::" + "fm/fmp/FMP00160E_T001.jsp";
	// 데이터셋 설정U
	strInDatasets  = "ds_IUD=ds_List:U";
	strOutDatasets = "ds_save_out=ds_save_out";
	
	// 파라메터 설정
	strArgument  = "sSubinv=" + wrapQuote(cbo_Subinv.value);
	strArgument += " sNeedDate=" + wrapQuote(me_NeedDate.value);
	strArgument += " g_Upjang=" + wrapQuote(g_Upjang);
	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
	strArgument += " sDocSrc=" + wrapQuote(fa_DocSrc);
	strArgument += " sPrUpjang=" + wrapQuote(ed_Upjang.userdata);
	strArgument += " sPrSabun=" + wrapQuote(g_EmpNo);
	// 신규일경우 기존대로 새로운 주문번호 생성:NEW , 동일업장, 창고 및 입고일자에 주문건수가 있을경우 상품추가시  주문번호를 새로 생성하지 않는다:OLD
	strArgument += " sGubunNewOrOld=" + wrapQuote(fn_gubunNewOrOld);
	strArgument += " sMaxPrNum=" + wrapQuote(fn_maxPrNum);
	strArgument += " sMaxApproveNum=" + wrapQuote(fn_maxApproveNum);
// [속도개선 Project 시작] 2017. 8. 3. 김호석 여신금액 집계 프로시저 추가
	strArgument += " scrnId=" + wrapQuote("FMP00081E");   // 화면ID
	strArgument += " scrnName=" + wrapQuote("발주자요청자조회");  // 화면명
// [속도개선 Project   끝] 2017. 8. 3. 김호석
		
	// 콜백함수 지정
	strCallbackFunc = "fn_CallBack_Save";
	//바이너리 통신 설정
	//http.Compress = true;
	//http.CompressMethod = "ZLIB";
	////http.XmlFormat = false;
	//바이너리 통신 설정	
	// 서버 호출 
	//Transaction(strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc);
	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
}
/*------------------------------------------------------------
	1. Function ID : fn_Print()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_print()
{
	//gd_listE.ExportExcelEx("단가표");
}
/*------------------------------------------------------------
	1. Function ID : fn_Close()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_Close()
{
	This.close();
}
/*------------------------------------------------------------
	1. Function ID : fn_Help()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_help()
{
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*------------------------------------------------------------
	1. Function ID : fn_AlertMsg(cd)
	2. 개       요 : 메세지 처리
	3. 기       능 : 화면에 나타나는 메시지 코드및 텍스트 리턴
	4. 인 수 설 명 : cd : 원하는 메시지 코드
*/
function fn_AlertMsg(cd)
{
	var v_Msg="";
	switch(cd)
	{
		case "000":
			v_Msg= "이(가) 저장되었습니다.";
			break;
		case "001":
			v_Msg= "버튼이 정의 되어 있지않습니다.";
			break;
		case "002":
			v_Msg="서비스 오류:시스템 관리자에게 문의하십시오";
			break;
		case "003":
			v_Msg="필수항목은 반드시 선택하시기 바랍니다.";
			break;	
		case "004":
			v_Msg="작업대상 본사를 선택하세요.";
			break;
		case "005":
			v_Msg="을(를) 입력하세요";
			break;
		case "006":
			v_Msg="삭제할 데이터가 없습니다.";
			break;
		case "007":
			v_Msg="변경된 데이터가 없습니다.";
			break;
		case "008":
			v_Msg="시스템ID가 없습니다.";
			break;			
/*			
		case "":
			v_Msg="";
			break;
*/			
		default:
			break;			
	}
	return v_Msg;
}
//콜백
function fn_CallBack_Search(errCode, errMsg)
{
	if (errCode == 0)
	{
		if (ds_List.rowcount < 1)
		{
			g_Message("EE","조회한 내용이 없습니다.");
		}
	}
	else
		g_Message("EE",fn_AlertMsg("002"));
}

function fn_ChkManNull()
{
	if (ffn_ChkNull(ed_Upjang.userdata))
	{
		g_Message("EE", "사업장" + fn_AlertMsg("005"));
		if (ed_Upjang.enable) ed_Upjang.setFocus();
		return true;
	}
		if (ffn_ChkNull(ed_MainUpjang.userdata))
	{
		g_Message("EE", "메인업장" + fn_AlertMsg("005"));
		if (ed_MainUpjang.enable) ed_MainUpjang.setFocus();
		return true;
	}
	return false;
}
function fn_ChkData()
{
	//변경여부 확인
	if ( (! gfn_dsIsUpdated(ds_List)) )
	{
		return fn_AlertMsg("007");
	}
	//여신정보 재조회
	fn_GetCredit(true);
	//여신한도초과여부
	//if (ed_Credit.Text != "무 제 한")
	if (ds_CrdInfo.rowcount > 0)
	{
		//여신금액
		if (ds_CrdInfo.getColumn(0,"CREDIT_AMOUNT_CONTROL_YN") == "Y")
		{
			var nAmt = 0;
			
			for (i=0; i<ds_List.rowcount; i++) {
				nAmt += Math.round((toNumber(ds_List.getColumn(i,"OP_AMOUNT")) - toNumber(ds_List.getColumn(i,"OP_AMOUNT_OLD"))) * iif(ds_List.getColumn(i,"TAX_CODE")=="100",1.1,1));
			}
				
			if ( nAmt > toNumber(ds_CrdInfo.getColumn(0,"CREDIT_AVAIL_AMT")) && ds_List.getSum("OP_AMOUNT") != ds_List.getSum("OP_AMOUNT_OLD") )
			{
				return "주문가능한 여신한도를 초과하여 주문이 불가합니다.";
			}
		}
		//여신회전일
		if (ds_CrdInfo.getColumn(0,"CREDIT_TURN_CONTROL_YN") == "Y")
		{
			if (toNumber(ds_CrdInfo.getColumn(0,"LAST_TURN_CNT")) >= 0)
			{
				if (toNumber(ds_CrdInfo.getColumn(0,"LAST_TURN_CNT")) > toNumber(ds_CrdInfo.getColumn(0,"CREDIT_TURN_DAYS_TOT")))
				{
					return ds_CrdInfo.getColumn(0,"L_BILL_DATE_DISP") + "에 매출채권이 존재하여 주문이 불가합니다.";
				}
			}
		}
	}
	//상품별 디데이 체크
	for (i=0; i<ds_List.rowcount; i++)
	{
		if (GetRowType(ds_List,i)<> 'normal')
		{
			//수량 0인건 어차피 지울꺼니 패스...
			//if ( NumFormat(ds_List.GetColumn(i,"PR_QTY"),1) == "0.0" ) continue;
			if (( GetRowType(ds_List,i)== 'insert' ) && ( gfn_numFormat(gfn_trim(ds_List.getColumn(i,"PR_QTY")),1)== "0" )) continue;
			//기존자료이거나 무통제면 패스...
			if ( numFormat(ds_List.getColumn(i,"D_DAYS"))== "0" ) continue;
			//디데이체크
/*			
			if ( addDate(gds_currdate.GetColumn(0,"YMD"),ds_List.GetColumn(i,"D_DAYS")) > me_NeedDate.Value )
			{
				ds_List.row = i;
				return ("[" + ds_List.GetColumn(i,"ITEM_NAME") + "]상품은 주문일자(D-" + ds_List.GetColumn(i,"D_DAYS") + ")를 초과하여 주문이 불가합니다.");
			}
			else if ( addDate(gds_currdate.GetColumn(0,"YMD"),ds_List.GetColumn(i,"D_DAYS")) = me_NeedDate.Value )
			{
				//디타임체크
				if ( substr(gds_currdate.GetColumn(0, "YMD_TM"),8,4) > ds_List.GetColumn(i,"D_TIMES") )
				{
					ds_List.row = i;
					return ("[" + ds_List.GetColumn(i,"ITEM_NAME") + "]상품은 주문시간(" + right("0"+ds_List.GetColumn(i,"D_TIMES"),4) + ")을 초과하여 주문이 불가합니다.");
				}
			}
*/
			if (fn_GetDayStatus(ds_List.getColumn(i,"D_DAYS"), ds_List.getColumn(i,"D_TIMES")) == "0")
			{
				ds_List.rowposition = i;
				return ("[" + ds_List.getColumn(i,"ITEM_NAME") + "]상품은 마감시간(D-Days)을 초과하여 주문이 불가합니다.");
			}
		}
        //-----------------------------------------------------------------------------------
		//--- 체크로직 추가 
		//    수정일    : 2010/10/28 BY 노규완
		//    수정내용  : 상품 수량 입력 시 기존에는 라인별로 최대발주량 체크 하였으나,
		//                추가 상품으로 동일 상품을 등록 한 다음 최대 발주량만 넘지 않으면 
		//                추가로 상품이 저장 되는 문제가 발생하여, 입고 예정일 기준으로 
		//                동일 상품의 총 합계를 체크 하여 최대 발주량을 넘는지 체크 한다.
		//    수정일    : 2013/08/01 BY 박용대
		//    수정내용  : 상품을 저장할때 아이리스에서 취소한 목록들이 발주내역에 올라오게되는데
		//                이것들이 최대 발주량계산에 포함되어 있어 발주상태가 003,005인 항목을
		//                제외하고 CASESUM 하는 부분을 추가.
		//-----------------------------------------------------------------------------------
		if ((ds_List.getColumn(i,"MAX_ORD_QTY") > 0) && ( ds_List.getCaseSum("ITEM_CODE=='"+ds_List.getColumn(i,"ITEM_CODE")+"'&& ((LINE_STATUS <> '005' && LINE_STATUS <> '002') && LINE_STATUS <> '003') && DOCU_SOURCE <> '01 BO'","PR_QTY") > ds_List.getColumn(i,"MAX_ORD_QTY")))  
		{   
		    if (toNumber(ds_List.getColumn(i,"PR_NUM")) <> 0)
		    {
		        //동일상품의 다른 주문날짜일 경우 합산은 최대발주량을 넘어도 상관없다.
		        if ( ds_List.getCaseSum("PR_NUM=='"+ds_List.getColumn(i,"PR_NUM")+"'","PR_QTY") <= ds_List.getColumn(i,"MAX_ORD_QTY"))
		            continue;
		    }
       	    ds_List.rowposition = i;
		    return ("[" + ds_List.getColumn(i,"ITEM_NAME") + "] 상품이 최대 발주량" + ds_List.getColumn(i,"MAX_ORD_QTY") + ")를 초과하여 주문이 불가합니다.");
		}		
	}
	//수량 0인거 제거...
// 	for (i=ds_List.rowcount-1; i>=0; i--)
// 	{
// 		if ( gfn_numFormat(gfn_trim(ds_List.getColumn(i,"PR_QTY")),1)== "0" ) ds_List.deleteRow(i);
// 	}

	// 저장 시 수량이 0 이거나 NULL 인 자재 삭제 처리
	for( var i = ds_List.getRowCount()-1; i >= 0; i-- ) {		
		if( ds_List.getColumn(i, "PR_QTY") == 0 || gfn_length(gfn_trim(ds_List.getColumn(i, "PR_QTY"))) == 0 ) {
			ds_List.deleteRow(i);
		}		
	}
}
function fn_FormKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
	//입고예정일에서 엔터시 조회
	//if ( (nChar == 13) && (objSenderObj == me_NeedDate) ) fn_Search();
	//임시로...'F12'입력시 타이머 작동중지
	if (e.keycode == 123) killTimer(777);
}	

function fn_edBtn_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	ffn_ed_OnKeyDown(obj,e.keycode);
	//Del의 경우 뒷처리
	if (e.keycode == 46) fn_Trigger_edBtn(obj);
}
function fn_Trigger_edBtn(obj)
{
	switch(obj)
	{
		case ed_Upjang:
			if (! ffn_ChkNull(obj.userdata))   //사업장
			break;
			
		case ed_MainUpjang:			           //본사 값을 지울 때.
			if (! ffn_ChkNull(obj.userdata))
			ed_Upjang.userdata = "";
			ed_Upjang.value = "";
			break;
		
		case ed_ItemNm:
			if (! ffn_ChkNull(obj.userdata))
			break;
		default:
			break;
	}
}
function fn_ResetData()
{
	ds_Subinv.clearData();
	//ds_SubinvP.ClearData();
	st_Days.text = "(발주 마감 : - -)";
	st_Timer.text = "";
	ed_Credit.value = "";
	me_Pdate.value = "";
	ed_Pcnt.value = "";
	ed_Pamt.value = "";
	ed_Bond.value = "";
	cbo_Subinv.value = "";
	ds_List.clearData();
	ds_List1.clearData();
	ds_List2.clearData();
	ds_List3.clearData();
	ds_List4.clearData();
	//
	me_NeedDate.value  = gfn_addDate(gds_currdate.getColumn(0, "YMD"),1);
}
function fn_SetSubinv(ds_Obj)
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 초기화
	ds_Obj.clearData();
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= ds_Obj.name + "=ds_List";
    if (ds_Obj == ds_Subinv)
    {
		otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);
    } else if (ds_Obj == ds_SubinvP) {
		otherArg	= "UPJANG=" + wrapQuote(tab_list.tab4.ed_UpjangP.userdata);
    } 
		
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_PO_SUBINV_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	//기본창고지정
    if (ds_Obj == ds_Subinv)
    {
		if (ds_Obj.rowcount > 0) cbo_Subinv.index = 0;
	}
	else if (ds_Obj == ds_SubinvP)
	{
		if (ds_Obj.rowcount > 0) tab_list.tab4.cbo_SubinvP.index = 0;
	}
}
function fn_GetDays()
{
	// 초기화(디데이)
	ds_Days.clearData();
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_Days=ds_List";
    otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata) + " SUBINV_CODE=" + wrapQuote(cbo_Subinv.value) + " NEED_DATE=" + wrapQuote(me_NeedDate.value);
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_GETDAYS_S001");
	// 서버 호출 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	http.Sync = false;
	//디데이 표시
	if (ds_Days.rowcount > 0)
		st_Days.text = "(발주 마감 : " + ds_Days.getColumn(0,"DAYS") + ")";
	else
	{
		g_Message("EE","발주마감정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
		//close();
	}
	// 초기화(주문통제)
	ds_OrdCtrl.clearData();
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_OrdCtrl=ds_List";
    otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_ORD_CTRL_S001");
	// 서버 호출 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	http.Sync = false;
}


function fn_GetCredit_callback(errCode, errMsg)
{
ta_Sql.value = fa_Sql;
		if (errCode == 0)
	{
		//여신 표시
		if (ds_CrdInfo.rowcount > 0) 
		{
			if (ds_CrdInfo.getColumn(0,"CREDIT_AMOUNT_CONTROL_YN") == "Y")
			{
				ed_Credit.value = gfn_numFormat(ds_CrdInfo.getColumn(0,"CREDIT_RMN_AMT"))+ " 원";
				ed_Bond.value = gfn_numFormat(ds_CrdInfo.getColumn(0,"BOND_AMT"))+ " 원";
			}
			else
				ed_Credit.value = "무 제 한";
		}
		else
		{
			//g_Message("EE","업장여신정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
			//close();
		}
	}
	else
		g_Message("EE",fn_AlertMsg("002"));	
}
function fn_GetCrdYn()
{
	//ds임시생성
	var dsObjin, dsObjot;
		
	create("Dataset", "ds_Dummyin");
	create("Dataset", "ds_Dummyot");
	
	dsObjin = eval("ds_Dummyin");
	dsObjin.addColumn("UPJANG", "INT", 22);
	dsObjin.addColumn("NEED_DATE", "STRING", 8);
	dsObjot = eval("ds_Dummyot");
	dsObjot.addColumn("CRD_YN", "STRING", 1);
	
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 초기화
	ds_Dummyin.clearData();
	ds_Dummyot.clearData();
	ds_Dummyin.addRow();
	ds_Dummyin.setColumn(0, "UPJANG",         ed_Upjang.userdata);
	ds_Dummyin.setColumn(0, "NEED_DATE",      me_NeedDate.value);
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    inData		= "ds_Cond=ds_Dummyin";
    outData		= "ds_Dummyot=ds_List";
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_CREDIT_CHKYN_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	var bYn = (ds_Dummyot.rowcount > 0);
	//ds임시생성 해제
	Destroy("ds_Dummyin");
	Destroy("ds_Dummyot");
	return  bYn;
}
function fn_GetLastOrd()
{
	//ds임시생성
	var dsObjin, dsObjot;
		
	create("Dataset", "ds_Dummyin");
	create("Dataset", "ds_Dummyot");
	
	dsObjin = eval("ds_Dummyin");
	dsObjin.addColumn("SUBINV_CODE", "STRING", 8);
	dsObjin.addColumn("NEED_DATE", "STRING", 8);
	dsObjin.addColumn("DOCU_SOURCE", "STRING", 50);
	dsObjot = eval("ds_Dummyot");
	dsObjot.addColumn("NEED_DATE", "STRING", 8);
	dsObjot.addColumn("CNT", "DECIMAL", 22);
	dsObjot.addColumn("AMT", "DECIMAL", 22);
	
	// 초기화
	dsObjin.clearData();
	dsObjot.clearData();
	dsObjin.addRow();
	dsObjin.setColumn(0, "SUBINV_CODE",    cbo_Subinv.value);
	dsObjin.setColumn(0, "NEED_DATE",      me_NeedDate.value);
	dsObjin.setColumn(0, "DOCU_SOURCE",    fa_DocSrc);
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    inData		= "ds_Cond=ds_Dummyin";
    outData		= "ds_Dummyot=ds_List";
	otherArg    = "DocSrc1=" + wrapQuote(fa_DocSrc1);
	otherArg   += " DocSrc2=" + wrapQuote(fa_DocSrc2);
	callBackFnc = "fn_GetLastOrd_callback";
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmp:FMP00160E_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 

}

function fn_GetLastOrd_callback(errCode, errMsg)
{
	if (errCode == 0)
	{
		//최근 발주 표시
		if (ds_Dummyot.rowcount > 0)
		{
			//trace(ds_Dummyot.saveXML());
			me_Pdate.value = ds_Dummyot.getColumn(ds_Dummyot.rowcount-1,"NEED_DATE");
			ed_Pcnt.value = '총 (' + gfn_numFormat(ds_Dummyot.getColumn(ds_Dummyot.rowcount-1,"CNT"))+ ') 건';
			ed_Pamt.value = gfn_numFormat(ds_Dummyot.getColumn(ds_Dummyot.rowcount-1,"AMT"))+ ' 원';
		}
		else
		{
			me_Pdate.value = "";
			ed_Pcnt.value = "";
			ed_Pamt.value = "";
		}
		//ds임시생성 해제
		Destroy("ds_Dummyin");
		Destroy("ds_Dummyot");
	}
	else
		g_Message("EE",fn_AlertMsg("002"));
}

function fn_OrdChk()
{
	fn_GetDays();
	fn_CurrDateWeek();

	//입고통제일 체크 
	if (fn_NeedDateCheck()) 
	{
	    g_Message("EE","해당일자는 입고통제일 입니다.");
   	    ds_List.clearData();
	    ds_List1.clearData();

		return false;
	}

	//발주통제일자
	if (toNumber(ds_Days.getColumn(0,"D_OVER_DAYS")) > 0)
	{
		if (me_NeedDate.value > gfn_addDate(gds_currdate.getColumn(0, "YMD"),toNumber(ds_Days.getColumn(0,"D_OVER_DAYS"))))
		{
			g_Message("EE", ds_Days.getColumn(0,"D_OVER_DAYS") + "일을 초과하여 입고예정일을 지정할 수 없습니다.");
			return false;
		}
	}
	//발주제한일자
	if (toNumber(ds_Days.getColumn(0,"D_DAYS")) > 0)
	{
		if (me_NeedDate.value < gfn_addDate(gds_currdate.getColumn(0, "YMD"),toNumber(ds_Days.getColumn(0,"D_DAYS"))))
		{
			g_Message("EE", "발주마감은 " + ds_Days.getColumn(0,"DAYS") + "입니다.");
			return false;
		}
		if (me_NeedDate.value == gfn_addDate(gds_currdate.getColumn(0, "YMD"),toNumber(ds_Days.getColumn(0,"D_DAYS"))))
		{
			if (gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,6)> ds_Days.getColumn(0,"D_TIMES"))
			{
				g_Message("EE", "발주마감은 " + ds_Days.getColumn(0,"DAYS") + "입니다.");
				return false;
			}
		}
	}
	//창고가 식재 또는 소모품 전용창고인 경우 주문통제 점검
	if (! ffn_ChkNull(ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN")))
	{
		//주문통제(주문일자)
		var nRow;
		nRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='주문'&&ITEM_TYPE==decode('" + ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN") + "','Y','소모품','식자재')");
		if (nRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(nRow,ToUpper(gds_currdate.getColumn(0, "WEEK_ENG"))) == "Y")
			{
				g_Message("EE", gds_currdate.getColumn(0, "WEEK_KOR") + "요일은 주문불가 요일입니다.");
				return false;
			}
		}
		//주문통제(입고일자)
		nRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE==decode('" + ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN") + "','Y','소모품','식자재')");
		if (nRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(nRow,ToUpper(ffn_DayToWeek(me_NeedDate.value,"1"))) == "Y")
			{
				g_Message("EE", ffn_DayToWeek(me_NeedDate.value) + "요일은 입고불가 요일입니다." + "\n\n" + "입고예정일을 변경하세요.");
				return false;
			}
		}
	}else{
		//주문통제(입고일자)
		nRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE=='공통'");
		if (nRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(nRow,ToUpper(ffn_DayToWeek(me_NeedDate.value,"1"))) == "Y")
			{
				g_Message("EE", ffn_DayToWeek(me_NeedDate.value) + "요일은 입고불가 요일입니다." + "\n\n" + "입고예정일을 변경하세요.");
				return false;
			}
		}	
	}
	//
	return true;
}
function fn_SetFav()
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_Fav=ds_List";
    otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_FAVORITE_GROUP_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	if (ds_Fav.rowcount > 0) tab_list.tab2.cbo_Fav.index = 0;
}
function fn_SetCtUpj()
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_CtUpj=ds_List";
    otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_GET_CTUPJ_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	if (ds_CtUpj.rowcount <= 0)
	{
		g_Message("EE","업장기초정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
		//close();
	}
}
function fn_CopyRow(obj,nRow)
{
	if ( ds_List.findRowExpr("ITEM_CODE=="+wrapQuote(obj.getColumn(nRow,"ITEM_CODE"))) >= 0 )
	{
		if (! g_Confirm("01", '이미 주문등록한 상품입니다.\n\n추가주문 하시겠습니까?!')) return;
	}
	ds_List.addRow();
	ds_List.copyRow(ds_List.rowposition, obj, nRow);
	//기본적으로 신청수량은 기본 0으로 설정한다.
	ds_List.setColumn(ds_List.rowposition, "PR_QTY", 0);
	
	// for only 화성네트웍스-상지대학교부속한방병원[162851]
	if ( obj.getColumn(obj.rowposition, "RC_UPJANG") == "162851" ) {
		ds_List.setColumn(ds_List.rowposition, "PR_REMARK", obj.getColumn(obj.rowposition, "PR_REMARK_RECENT"));
	}
	//obj.DeleteRow(nRow);
}
function fn_SetRowImg(nDdays,nDtimes,sWeekItemCode,sUnuseYn,sValSptYn,sPoStatus,sDangaWeekStatus)
{
	//품목별 D-Day설정과 전체 D-Day설정을 비교하여 빠른것을 기준으로 한다.
	var nDdays1 = greatest(toNumber(nDdays), toNumber(ds_Days.getColumn(0,"D_DAYS")));
	var nDtimes1;
	if ( toNumber(nDdays) > toNumber(ds_Days.getColumn(0,"D_DAYS")) )
		nDtimes1 = nDtimes;
	else if ( toNumber(nDdays) == toNumber(ds_Days.getColumn(0,"D_DAYS")) )
		nDtimes1 = least(nDtimes,ds_Days.getColumn(0,"D_TIMES"));
	else if ( toNumber(nDdays) < toNumber(ds_Days.getColumn(0,"D_DAYS")) )
		nDtimes1 = ds_Days.getColumn(0,"D_TIMES");
	
	if (sUnuseYn=="UK" || sValSptYn=="TK" || sPoStatus =="HE" || sDangaWeekStatus =="FE") //구매불용, 구매중지, 수발주스케쥴, 단가업장 수발주 스케쥴
	{
		return "theme://convertImages\\img_RC.png";
	}else{
		return decode(fn_GetDayStatus(nDdays,nDtimes,sWeekItemCode),"0","theme://convertImages\\img_RC.png","1","theme://convertImages\\img_YC.png","2","theme://convertImages\\img_GC.png","");
	}
}

function fn_SetRowColor(nDdays,nDtimes,sWeekItemCode,sUnuseYn,sValSptYn,sPoStatus,sDangaWeekStatus)
{
	var bDayStatus;
	
	if(fn_GetDayStatus(nDdays,nDtimes,sWeekItemCode) == "0")
	{
		bDayStatus = true;
	}else{
		bDayStatus = false;
	}
	
	if(sUnuseYn=="UK" || sValSptYn=="TK" || bDayStatus || sPoStatus =="HE" || sDangaWeekStatus =="FE") //구매불용, 구매중지, 수발주스케쥴, 단가업장 수발주 스케쥴 
	{
		return "thistle";
	}else{
		return "white";
	}
}

function fn_GetDayStatus(nDdays,nDtimes,sWeekItemCode)
{
	//리조트 물류스케주울 체크
	if (! ffn_ChkNull(sWeekItemCode)) return "0";
	//무통제면 패스...
	if ( numFormat(nDdays)== "0" )	return "2";
	//디데이체크
	if ( gfn_addDate(gds_currdate.getColumn(0,"YMD"),nDdays)> me_NeedDate.value )
		return "0";
	else if ( gfn_addDate(gds_currdate.getColumn(0,"YMD"),nDdays)== me_NeedDate.value )
	{
		//디타임체크
		if ( gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4)> nDtimes )
			return "0";
		else if ( G_fn_GapTime(0, gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4), nDtimes, "") <= "0030" )
			return "1";
		else
			return "2";
	}
	else
		return "2";
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
function gd_list_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	var strHeadClass = obj.getCellProperty("head", e.col,"class");
    if(strHeadClass == "head_Excel")
    {
		// 출력용 그리드
		gfn_exportExcel(tab_list.tabpages["tab"+parseInt(tab_list.tabindex+1)].gd_list_excel);
		return;
    } else {
		gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
	}
}

// 발주내역 그리드
function gd_list_OnHeadClick1(obj:Grid, e:GridClickEventInfo)
{
	gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
}

function cbo_Subinv_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	if(gfn_dsIsUpdated(ds_List)==true)
	{
		if(g_Confirm("02","변경된 내역이 있습니다. 변경된 내역을 저장하시겠습니까?"))
		{
			fn_save(1);
		}
	}
	
	//데이타셑 위치변경
	eval(obj.innerdataset).rowposition = e.postindex;
	//초기화
	if (obj == cbo_Subinv)
	{
		me_Pdate.value = "";
		ed_Pcnt.value = "";
		ed_Pamt.value = "";
		ds_List.clearData();
		ds_List1.clearData();
		ds_List2.clearData();
		ds_List3.clearData();
		ds_List4.clearData();
		//최종 발주정보
		//fn_GetLastOrd();
		//디데이
		fn_GetDays();
		//자동조회
		fn_search();
	} else if (obj == tab_list.tab2.cbo_Fav) {
		ds_List2.clearData();
	} else if (obj == tab_list.tab4.cbo_SubinvP) {
		ds_List4.clearData();
	} 
}

function me_NeedDate_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{
	//변경되면 포커스를 잃고 글로벌 함수 실행(여기서 글자수를 체크하여 제대로 된 데이터 넘김)
	//g_Date_OnKillFocus(obj);
	
	//변경된 사항이 있는지 확인
	if(gfn_dsIsUpdated(ds_List)==true)
	{
		g_Message("EE","변경된 내역이 있습니다. 저장해 주십시요");
		me_NeedDate.value = pre_need_date;	//변경전의 날짜를 되돌림
		return;
	}else{
	
		//발주가능 체크
		if (! fn_OrdChk())
		{
			btn_NeedDate.setFocus();
			return;
		}
		
		// 상단그리드 초기화
		fn_setInitForm();
		
		fn_search();
	}
	
}



function ds_List_CanColumnChange(obj:Dataset, e:DSColChangeEventInfo)
{
	//수량체크
	if (e.columnid == "PR_QTY")
	{
		//(-)발주여부
		if ( toNumber(e.newvalue) < 0 )
		{
			g_Message("EE","(-)발주는 불가합니다.");
			return false;
		}
		//발주마감체크
		fn_CurrDateWeek();
		if (fn_GetDayStatus(obj.getColumn(e.row,"D_DAYS"), obj.getColumn(e.row,"D_TIMES")) == "0")
		{
			g_Message("EE","해당 상품은 마감시간(D-Days)이 초과되어 수정이 불가합니다.");
			return false;
		}
		//수량통제 안하는 업장의 경우 이하 패스...
		//if (ds_Days.GetColumn(0,"QTY_CONTROL_YN") = "N") return;
		//
		//수량통제 안하는 업장의 경우 소숫점발주가 Y이면 무조건 최소발주량/발주승수량을 무조건 0.1로 세팅하여 조회
		if ( toNumber(e.newvalue) > 0 )
		{
			//최소발주량 체크
			if ( (toNumber(obj.getColumn(e.row,"MIN_ORD_QTY")) > 0) && (toNumber(obj.getColumn(e.row,"MIN_ORD_QTY")) > toNumber(e.newvalue)) )
			{
				g_Message("EE","해당 상품은 최소발주량이 " + obj.getColumn(e.row,"MIN_ORD_QTY") + "입니다.");
				return false;
			}
			//최대발주량 체크
			if ( (toNumber(obj.getColumn(e.row,"MAX_ORD_QTY")) > 0) && (toNumber(obj.getColumn(e.row,"MAX_ORD_QTY")) < toNumber(e.newvalue)) )
			{
				g_Message("EE","해당 상품은 최대발주량이 " + obj.getColumn(e.row,"MAX_ORD_QTY") + "입니다.");
				return false;
			}
			//소숫점발주여부
			if ( (obj.getColumn(e.row,"POINT_FLAG") != "Y") && (Math.ceil(toNumber(e.newvalue)) != toNumber(e.newvalue)) )
			{
				g_Message("EE","해당 상품은 소숫점발주가 불가합니다.");
				return false;
			}
			//발주승수량
			if ( (toNumber(obj.getColumn(e.row,"MULTIPLIER_QTY")) > 0) && ((Math.round(toNumber(e.newvalue) * 1000) % Math.round(toNumber(obj.getColumn(e.row,"MULTIPLIER_QTY")) * 1000)) <> 0) )
			{
				g_Message("EE","해당 상품은 발주승수량이 " + obj.getColumn(e.row,"MULTIPLIER_QTY") + "입니다.");
				return false;
			}
		}
		
		//alert(obj.getRowType(e.row) +" : "+ toNumber(e.newvalue));
		
		//3개월치 최대발주량 초과시 알람
		if ( toNumber(e.newvalue) >  toNumber(obj.getColumn(e.row,"MAX_SO_QTY")) )
		{
			g_Message("EE","해당 상품은 최근 3개월 최대발주량 " + obj.getColumn(e.row,"MAX_SO_QTY") + " 을 초과 하였습니다. ");
		}
		
	}
	return true;
}

function fn_CLS_STATUS_Setting()
{
    if (fa_sDay >= 0) return;
    
    ds_List.updatecontrol = false;
	for (i=0; i<ds_List.rowcount; i++)
	{
		if (ds_List.getColumn(i, "OTCUSTCD") != "0000")
		{
			ds_List.setColumn(i, "CLS_STATUS", "마감");
			ds_List.setRowType(i, Dataset.ROWTYPE_NORMAL);
		}
	}
	ds_List.updatecontrol = true;	
}
function ed_Item_OnKeyDown(obj, e)
{
	if ( e.keycode == 13 ) fn_SearchItem();
}
function btn_search_OnClick(obj:Button, e:ClickEventInfo)
{
	fn_SearchItem();
}
function btn_search_OnKeyDown(obj:Button, e:KeyEventInfo)
{
	if ( e.keycode == 13 ) btn_search_OnClick(obj);
}
function gd_list_OnCellDblClick(obj:Grid, e)
{
	/*
	  주문시점의 업장, 창고, 입고일자를 저장한다.
	  왜냐하면 주문을 하고 발주내역에 등록이 된 뒤에
	  날짜를 변경하면 발주된된 데이터에 대해서 
	  변경을 하겠습니까? 라고 확인메세지를 주는데
	  여기서 아니오라고 해도 업장과 창고 입고일자는 
	  바뀌어 버리기 때문에(공통함수라서) 
	  아니오 일때는 주문시점의 데이터를 다시 불러와야함
	*/
	pre_need_date = me_NeedDate.value;
	

	if (obj == gd_list) return;
	if (eval(obj.binddataset).rowcount < 1) return;
	if (e.row < 0) return;
	
	//리조트 물류스케주울 체크
	if (! ffn_ChkNull(eval(obj.binddataset).getColumn(e.row,"WEEK_ITEM_CODE")))
	{
		g_Message("EE","해당 상품은 요일통제 상품입니다!");
		return;
	}
	//주문통제체크	
	if (!ffn_ChkNull(eval(obj.binddataset).getColumnInfo("LIMIT_ITEM"))) {	
		if (! ffn_ChkNull(eval(obj.binddataset).getColumn(e.row,"LIMIT_ITEM")))
		{
			g_Message("EE","해당 상품은 주문통제 상품입니다!" + "\n\n" + "통제내용:" + eval(obj.binddataset).getColumn(e.row,"LIMIT_REASON"));
			return;
		}
	}
	
	if(tab_list.tabindex == 0)	//상품조회
	{
		//금지자재 및 불용자재 체크	
		//trace(ds_List1.getColumn(ds_List1.rowposition,"UNUSE_YN"));
		//trace(ds_List1.getColumn(ds_List1.rowposition,"VAL_STP_YN"));

		if (ds_List1.getColumn(ds_List1.rowposition,"UNUSE_YN") == "UK" || ds_List1.getColumn(ds_List1.rowposition,"VAL_STP_YN") == "TK" ) 
		{	
			g_Message("EE","해당 상품은 주문불가 상품입니다!");
			return;
		}	
		
		//단가업장 수발주 요일 제한 상품 체크
		if (ds_List1.getColumn(ds_List1.rowposition,"DANGAWEEK_STATUS") == "FE")
		{
			g_Message("EE","해당 상품은 단가업장 수발주 요일 제한 상품입니다!");
			return;
		}	
	}
	
	if(tab_list.tabindex == 1)	//즐겨찾기상품
	{
		//금지자재 및 불용자재 체크	
		//trace(ds_List2.getColumn(ds_List2.rowposition,"UNUSE_YN"));
		//trace(ds_List2.getColumn(ds_List2.rowposition,"VAL_STP_YN"));

		if (ds_List2.getColumn(ds_List2.rowposition,"UNUSE_YN") == "UK" || ds_List2.getColumn(ds_List2.rowposition,"VAL_STP_YN") == "TK" ) 
		{	
			g_Message("EE","해당 상품은 주문불가 상품입니다!");
			return;
		}	
		
		//단가업장 수발주 요일 제한 상품 체크
		if (ds_List2.getColumn(ds_List2.rowposition,"DANGAWEEK_STATUS") == "FE")
		{
			g_Message("EE","해당 상품은 단가업장 수발주 요일 제한 상품입니다!");
			return;
		}	
	}

	//발주마감체크
	if (fn_GetDayStatus(eval(obj.binddataset).getColumn(e.row,"D_DAYS"), eval(obj.binddataset).getColumn(e.row,"D_TIMES")) == "0")
	{
		//g_Message("EE","마감시간이 초과되어 주문이 불가합니다.");
		return;
	}
	//창고가 식재/소모품 통합창고인 경우 주문통제 점검
	if (ffn_ChkNull(ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN")))
	{
		//주문통제(주문일자)
		var jRow;
		jRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='주문'&&ITEM_TYPE==iif('" + eval(obj.binddataset).getColumn(e.row,"CONSUM_YN") + "','Y','소모품','식자재')");
		if (jRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(jRow,ToUpper(gds_currdate.getColumn(0, "WEEK_ENG"))) == "Y")
			{
				g_Message("EE", gds_currdate.getColumn(0, "WEEK_KOR") + "요일은 " + ds_OrdCtrl.getColumn(jRow,"ITEM_TYPE") + " 주문불가 요일입니다.");
				return;
			}
		}
		//주문통제(입고일자)
		jRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE==iif('" + eval(obj.binddataset).getColumn(e.row,"CONSUM_YN") + "','Y','소모품','식자재')");
		if (jRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(jRow,ToUpper(ffn_DayToWeek(me_NeedDate.value,"1"))) == "Y")
			{
				g_Message("EE", ffn_DayToWeek(me_NeedDate.value) + "요일은 " + ds_OrdCtrl.getColumn(jRow,"ITEM_TYPE") + " 입고불가 요일입니다." + "\n\n" + "입고예정일을 변경하세요.");
				return;
			}
		}
	}else{
		//주문통제(입고일자)
		jRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE=='공통'");
		if (jRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(jRow,ToUpper(ffn_DayToWeek(me_NeedDate.value,"1"))) == "Y")
			{
				g_Message("EE", ffn_DayToWeek(me_NeedDate.value) + "요일은 " + ds_OrdCtrl.getColumn(jRow,"ITEM_TYPE") + " 입고불가 요일입니다." + "\n\n" + "입고예정일을 변경하세요.");
				return;
			}
		}	
	}
	
	// 최초등록시 주문번호 채번, 이후에는 같은 주문번호가 나오도록 함
	// 조회건수가 1건이라도 있을경우
	ds_List.filter("OTCUSTCD=='0000'");
	
	if (fn_dsListCnt > 0)
	{
		for (i=0; i<ds_List.rowcount; i++)
		{
			fn_gubunNewOrOld = "OLD";	
			
			if(!gfn_isNull(ds_List.getColumn(i, "PR_NUM")) && ds_List.getColumn(i, "OTCUSTCD") == "0000")
			{
				fn_maxPrNum = ds_List.getColumn(i, "PR_NUM");
			}
			
			if(!gfn_isNull(ds_List.getColumn(i, "APPROVE_NUM")))
			{
				fn_maxApproveNum = ds_List.getColumn(i, "APPROVE_NUM");	
			}			
		}
	}
	else
	{
		fn_maxPrNum = "";
		fn_maxApproveNum = "";
		fn_gubunNewOrOld = "NEW";
	}
	
	ds_List.filter("");
	
	//라인복사
	fn_CopyRow(eval(obj.binddataset), e.row);
	
	//obj.SetFocus();
	
	gd_list.setFocus();
	gd_list.setCellPos(8);
	
}

function tab_list_tab1_gd_list_OnEnterDown(obj,nRow,nCell,strVal,nPivotIndex)
{
	//2007버젼의 CyGridU.dll에 있는 오류를 수정하기 위해 온 엔터 다운코드를 제거함.
	//오류내용 : 1번째 그리드를 선택하고 엔터를 누르면 2번째 레코드 nRow가 넘어가는 현상
	//때문에 keyDown 함수에 구현함.
}


var fa_Chk;
function btn_CallPop_OnClick(obj:Button, e:ClickEventInfo)
{
/*
	if (object(obj.UserData).rowcount < 1) return;
	if (object(obj.UserData).row < 0) return;
	if (! g_Confirm("02","해당 상품을 " + obj.Text + "하시겠습니까?!")) return;
	
	//필수항목 
	if (fn_ChkManNull()) return;
	//
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMP00080E_T002";
	strURL   = "S_FMP::FMP00080E_T002.jsp";
	// 데이터셋 설정U
	strInDatasets  = "";
	strOutDatasets = "";
	// 파라메터 설정
	strArgument  = "g_Upjang=" + quote(g_Upjang);
	strArgument += " g_EmpNo=" + quote(g_EmpNo);
	strArgument += " sUpjang=" + quote(ed_Upjang.UserData);
	strArgument += " sFavGroup=" + quote(tab_list.tab2.cbo_Fav.Value);
	strArgument += " sItemCode=" + quote(object(obj.UserData).GetColumn(object(obj.UserData).row,"ITEM_CODE"));
	if (obj.UserData == "ds_List2")
		strArgument += " sGB='0'";
	else
		strArgument += " sGB='1'";
	
	// 콜백함수 지정
	strCallbackFunc = "";
	// 서버 호출 
	http.Sync = true;
	Transaction(strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc);
	http.Sync = false;
	//결과
	if (! ffn_ChkNull(fa_Chk)) g_Message("EE",fa_Chk);
*/
	//해당 작업화면 링크
	if (obj.userdata == "ds_List2")
		gfn_openMenuForm("FMP00860E.xfdl","U_FMP","","즐겨찾기 상품등록");
	else if (obj.userdata == "ds_List3")
		gfn_openMenuForm("FMP00890E.xfdl","U_FMP","","주간발주 상품등록");
	else if (obj.userdata == "ds_List4")	//지난발주 복사일 경우
	{
		for (var i=0; i<eval(obj.userdata).rowcount; i++)	//선택된 상품에 대해 추가 작업을 함.
		{
			if (eval(obj.userdata).getSelect(i))
			{
				var e = new EventInfo();
				e.row = i;
				gd_list_OnCellDblClick(tab_list.tab4.gd_list,e);
			}
		}
	}
}
function tab_list_OnChanged(obj:Tab, e:TabIndexChangeEventInfo)
{
	eval("tab_list.tab" + gfn_toString(e.postindex + 1)).ed_Item.setFocus();
	
	if(e.postindex == '1')
	{
		//즐겨찾기그룹
		fn_SetFav();
	};
}
function gd_list_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	
	if(tab_list.tabindex=='0') //상품추가 탭에서
	{
		//즐겨찾기 추가 버튼을 누를 때
		if(e.cell == 14)
		{
			//alert(obj +"|"+ nRow +"|"+ nCell +"|"+ nX +"|"+ nY +"|"+ nPivotIndex);
			var strParam = {};
			strParam["fa_ItemCode"] = eval(obj.binddataset).getColumn(e.row, "ITEM_CODE");
			strParam["fa_ItemName"] = eval(obj.binddataset).getColumn(e.row, "ITEM_NAME");
			strParam["fa_Upjang"] = ed_Upjang.userdata;
			
			
			gfn_dialog("", "U_FMP::FMP00080P.xfdl", strParam);
		}
	}else if(tab_list.tabindex=='1') //즐겨찾기 탭에서
	{
		//즐겨찾기 삭제 버튼을 누를 때
		if(e.cell == 14)
		{
			//삭제확인
			if (! g_Confirm("01", '선택하신 즐겨찾기 상품을 삭제하시겠습니까?!')) return;
			fn_deleteFav(e.row);
		}
	}
	
	//2010/03/22 수량 입력 클릭 시 공백 처리 == by Noh Kyu Wan ==
	if (e.cell == 8)
	{
	    if (ds_List.getColumn(e.row,"PR_QTY") <> 0)
	    {}
	    else	    
		ds_List.setColumn(e.row,"PR_QTY","");		
     }			
	
	if (eval(obj.binddataset).rowcount < 1) return;
	if (e.row < 0) return;
	if (e.cell <> 1) return;
	
	//상품이미지
/*
	if (object(obj.BindDataset).GetColumn(nRow, "OTCUSTCD") = "0000")
		gfn_dialog("", "U_SCC::SCC91000P.xml","fa_Image="+quote(gfmsImgPathH + object(obj.BindDataset).GetColumn(nRow, "IMAGE_PATH")));
	else
		gfn_dialog("", "U_SCC::SCC91000P.xml","fa_Image="+quote(gfmsImgPathO + object(obj.BindDataset).GetColumn(nRow, "IMAGE_PATH")));
*/
	
	/******************* 구매 자재팝업으로 변경*/
// 	var strParam = {};
// 	strParam["fa_CenterCode"] = gfn_trim(eval(obj.binddataset).getColumn(e.row, "CENTER_CODE"));
// 	strParam["fa_Custcd"] = gfn_trim(eval(obj.binddataset).getColumn(e.row, "CUSTCD"));
// 	strParam["fa_ItemCode"] = gfn_trim(eval(obj.binddataset).getColumn(e.row, "ITEM_CODE"));
// 	if (gfn_length(eval(obj.binddataset).getColumn(e.row, "IMAGE_PATH"))<= 0)
// 		strParam["fa_Image"] = '';
// 	else
// 	{
// 		if (eval(obj.binddataset).getColumn(e.row, "OTCUSTCD") == "0000")
// 		{
// 			strParam["fa_Image"] = gfn_trim(gfmsImgPathH + eval(obj.binddataset).getColumn(e.row, "IMAGE_PATH"));
// 		}
// 		else
// 		{
// 			//기존에 쓰던 서버가 바뀌어서 강제로 변경함.
// 			var ImgPath = "http://203.233.82.50/hwfs/upload/fm/item/";
// 			strParam["fa_Image"] = gfn_trim(ImgPath + eval(obj.binddataset).getColumn(e.row, "IMAGE_PATH"));
// 			//trace("pppppp : " + strParam);
// 		}
// 	}
	var arrParam = new Array();
	
	arrParam[0] = eval(obj.binddataset).getColumn(e.row, "ITEM_CODE");
	
	var rtnVal = gfn_dialog("FMP00010P"			// dialogId
				   , "U_FMP::FMP00010P.xfdl"		// Url
				   , {fv_Contents:arrParam}					// 배열
				   , null, null, null, null, null, false, true, -1);
				   
	//strParam["fa_ItemPrice"] = eval(obj.binddataset).getColumn(e.row, "OP_PRICE");
// 	strParam["fa_ItemCode"] = eval(obj.binddataset).getColumn(e.row, "ITEM_CODE");
// 	gfn_dialog("", "U_FMP::FMP00010P.xfdl", strParam);
	/********************/
	
	//20150824 구매자재팝업 사용 X
	//자재상세팝업 호출 : 두번째 파라미터는 아이템코드 
	//SCSysIf.eprocPopup(SCSysIf.EPROC_ITEM_POPUP, gfn_trim(eval(obj.binddataset).getColumn(e.row, "ITEM_CODE")));
}
function cbo_Class2_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	trace(ds_Class3.saveXML());
	trace(e.postvalue);
	trace(obj);
	
	if(gfn_isNull(e.postvalue))
	{
		trace("null");
	}
	
	if (obj == tab_list.tab1.cbo_Class2)
	{
		if(gfn_isNull(e.postvalue))	//전체일경우 필터해제
		{
			ds_Class3.filter("");
			ds_Class4.filter("");
			tab_list.tab1.cbo_Class3.index = 0;
			tab_list.tab1.cbo_Class4.index = 0;
		}
		else
		{
			// 소분류 데이터셋 필터
			ds_Class3.filter("gfn_left(CLASS_CODE,3)=="+wrapQuote(gfn_left(e.postvalue,3))+"||CLASS_CODE==''");
			tab_list.tab1.cbo_Class3.index = 0;
			// 세분류 데이터셋 필터
			ds_Class4.filter("gfn_left(CLASS_CODE,3)=="+wrapQuote(gfn_left(e.postvalue,3))+"||CLASS_CODE==''");
			tab_list.tab1.cbo_Class4.index = 0;
		}
	}
	else if (obj == tab_list.tab1.cbo_Class3)
	{
		if(gfn_isNull(e.postvalue))	//전체일경우 필터해제
		{
			ds_Class4.filter("");
			tab_list.tab1.cbo_Class4.index = 0;
		}
		else
		{
			ds_Class4.filter("gfn_left(CLASS_CODE,5)=="+wrapQuote(gfn_left(e.postvalue,5))+"||CLASS_CODE==''");
			tab_list.tab1.cbo_Class4.index=0;
		}
	}	
}
function cbo_Class2_OnKeyDown(obj:Combo, e:KeyEventInfo)
{
	ffn_SetComboNull(obj, e.keycode);	
}
function gd_list_OnEnterDown(obj:Grid, e:GridEditEventInfo)
{	
	//********************************************************************************************
	// 기능 추가 : CSR Number <26200> 
	// 변 경 자  : 노규완
	// 수정 일자 : 2009-04-10 
	// 수정 내역 : 기존 상품 조회 추가 시 마우스 포커스 이동이 수량 -> 비고.
	//             그리드에 등록 된 마지막 Row의 비고란에서 Enter값이 들어 오면 
	//             마우스 포커스가 상품검색란으로 이동 시켜 준다.
	//********************************************************************************************	
	//trace(ds_List.getCountNF() +"::"+ (ds_List.rowposition + 1) + "::" + gd_list.getCellPos());

	if ( obj == gd_list );	
	{
		if ( (ds_List.getCountNF() == ds_List.rowposition + 1) && (gd_list.getCellPos() == 10) )	
		{
		  if (tab_list.tabindex == 0)  tab_list.tab1.ed_Item.setFocus();
		  if (tab_list.tabindex == 1)  tab_list.tab2.ed_Item.setFocus();
		  if (tab_list.tabindex == 2)  tab_list.tab3.ed_Item.setFocus();
		  if (tab_list.tabindex == 3)  tab_list.tab4.ed_Item.setFocus();
		}	
	}	
}
//gd_list_OnEnterDown을 대체함.
function gd_list_onkeydown(obj:Grid, e:KeyEventInfo)
{
	if (e.keycode == 13) {		
		if ((ds_List.getCountNF() == ds_List.rowposition + 1) && (gd_list.getCellPos() == 12)) {
			//trace(ds_List.getCountNF() +"::"+ (ds_List.rowposition + 1) + "::" + gd_list.getCellPos());
			if (tab_list.tabindex == 0)  tab_list.tab1.ed_Item.setFocus();
			if (tab_list.tabindex == 1)  tab_list.tab2.ed_Item.setFocus();
			if (tab_list.tabindex == 2)  tab_list.tab3.ed_Item.setFocus();
			if (tab_list.tabindex == 3)  tab_list.tab4.ed_Item.setFocus();
			return true; //Focus 이상으로 추가함.
		}	
	}
}
function gd_list_OnCellPosChanged(obj:Grid, e:GridSelectEventInfo)
{
	//2010/03/22 수량 입력 클릭 시 공백 처리 == by Noh Kyu Wan ==
	if (e.cell == 8)
	{
	    if (ds_List.getColumn(e.row,"PR_QTY") <> 0)
	    {}
	    else	    
		ds_List.setColumn(e.row,"PR_QTY","");		
     }	
}
//************************************************************************************************
// Excel 상품 일괄 발주 기능 추가  2010/06/25 by 노규완
//************************************************************************************************
function fn_Excel_Import(obj:Button, e:ClickEventInfo)
{	
	//필수항목 
	if (fn_ChkManNull()) return;
	//발주가능 체크
	if (! fn_OrdChk())
	{
		btn_NeedDate.setFocus();
		return;
	}	
	
	if (ed_Upjang.userdata == ""){
		g_Message("EE","사업장 코드를 반드시 입력 하시기 바랍니다.");
		return;
	}
	if (cbo_Subinv.value == ""){
		g_Message("EE","창고 코드를 반드시 입력 하시기 바랍니다.");
		return;
	}	
	
	//엑셀 임포트
	fd_Excel.Type = "OPEN";
	fd_Excel.Filter = "All(*.*)|*.*|Excel File(*.xls)|*.xls|";
	
	if( fd_Excel.Open() )
	{		
		var nX = parseInt(this.position.width/2) - parseInt(dv_Prg.position.width/2);		
		var nY = parseInt(this.position.height/2) - parseInt(dv_Prg.position.height/2);		
		dv_Prg.move(nX, nY);
	
		dv_Prg.visible = true;
		var sFullFileName = fd_Excel.FilePath + '\\' + fd_Excel.FileName;
		gd_list.enableredraw = false;
		ds_Excel.clearData();
		//ext_ExcelImportByIndex(파일풀패스, 시트순번, 깡통데이타셑);
		ext_ExcelImportByIndex(sFullFileName, 0, "ds_Excel");
		
		
		
		fn_SetImpData();
		gd_list.enableredraw = true;
	}	
}

function div_Error_btn_Hidden_OnClick(obj:Button, e:ClickEventInfo)
{
	div_Error.visible = false;
}
//*************************************************************
// 2010-08-05  보조금 관련 추가 ( 사업장 보조금 관리 유무조회)
//*************************************************************
function fn_Green_Upjang()
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_Green=ds_Green";
    otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);	
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "sc/scc:SCC_GREEN_USER");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/	
	
	//*********************************************************************
	//	me_Pdate   Width : 160  --> 80
	//	Static28  : Width : 95  , Left : 268     --> Left : 190
	//	ed_Pcnt : Width 110 , Left : 365  -->   Width 90  , Left :  287
	//	ed_Pamt : Width : 224 , Left : 477   -> Width : 130 , Left : 378	
	//*********************************************************************
	if (ds_Green.getColumn(0,"USE_YN") == 'Y')
	{
		me_Pdate.position.width = 80;                      //최종발주일자 edit 사이즈 변경
		Static28.position.left = 190;                       //최종발주정보 Static 위치 변경
		ed_Pcnt.position.width = 90;  ed_Pcnt.position.left = 287;   //최종발주 카운터 사이즈 및 위치 변경
		ed_Pamt.position.width = 130; ed_Pamt.position.left = 378;   //최종발주 금액 사이즈 및 위치 변경
		Sta_Green.visible = true;                  //보조금 잔액 Static 화면 보이기
		ed_Green.visible = true;				   //보조금 잔액 금액 표시 화면 보이기.
	}
}
//*************************************************************
// 2010-08-05  보조금 관련 추가 ( 사업장 보조금 잔액 조회)
//*************************************************************
function fn_Green_Amt()
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_Green=ds_Green";
    otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);
	otherArg	+=" NEED_DATE="+ wrapQuote(gfn_trim(me_NeedDate.value));        	
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "sc/scc:SCC_GREEN_AMT");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/	
	ed_Green.value = numFormat(ds_Green.getColumn(0,"BALANCE_AMT"))+ " 원";	
}
//*****************************************************************************
// 2010-08-05  보조금 관련 추가 (로그인 사업장 보조금 재 생성 프로시져 호출)
//*****************************************************************************
function  fn_Create_Green_Amt()
{
	var t_timeout;
	// action 정보 초기화
	fsp_clear(this);	

	// 데이타체크
	ds_Green_Proc.clearData();	
	ds_Green_Proc.addRow();				

	ds_Green_Proc.setColumn(0,"UPJANG",ed_Upjang.userdata);				
	ds_Green_Proc.setColumn(0,"NEED_DATE",me_NeedDate.value);
	ds_Green_Proc.setColumn(0,"CUSER", g_EmpNo);		
	http.Sync = true;			

	t_timeout = application.httptimeout;
	application.httptimeout=2000; //1800초 

	//setCapture();

	fsp_addSingle(this, "sc/scc:SCC_GREEN_PROC");
	fsp_callService(this, "", "", "ds_Green_Proc=ds_Green_Proc:A", "",  "", "");

	application.httptimeout=t_timeout; //60초

	http.Sync = false;
}

function btn_RcpConf_OnClick(obj:Button, e:ClickEventInfo)
{
	dv_RcpConf.visible = (! dv_RcpConf.visible);
}

function dv_RcpConf_me_RcpDateT_onkillfocus(obj:MaskEdit, e:KillFocusEventInfo)
{
	dv_RcpConf.me_RcpDateF.value = gfn_addDate(obj.value,-1);
}

function dv_MultiUpj_btn_Hidden_OnClick(obj:Button, e:ClickEventInfo)
{
	if (ffn_ChkNull(ed_Upjang.userdata))
	{
		g_Message("EE", "사업장을 선택하세요!");
		return;
	}
	if (ffn_ChkNull(dv_RcpConf.me_RcpDateF.value))
	{
		g_Message("EE", "입금확인일자를 지정하세요!");
		return;
	}
	if (ffn_ChkNull(dv_RcpConf.me_RcpDateT.value))
	{
		g_Message("EE", "입금확인일자를 지정하세요!");
		return;
	}
	/*
	//ds임시생성
	var dsObjin;
	create("Dataset", "ds_Dummyin");
	dsObjin = eval("ds_Dummyin");
	dsObjin.addColumn("RCP_DATEF", "STRING", 8);
	dsObjin.addColumn("RCP_DATET", "STRING", 8);
	dsObjin.addColumn("UPJANG", "STRING", 6);
	// 초기화
	ds_Dummyin.clearData();
	ds_Dummyin.addRow();
	ds_Dummyin.setColumn(0, "RCP_DATEF",  dv_RcpConf.me_RcpDateF.value);
	ds_Dummyin.setColumn(0, "RCP_DATET",  dv_RcpConf.me_RcpDateT.value);
	ds_Dummyin.setColumn(0, "UPJANG",    ed_Upjang.userdata);
	// 트랜잭션 호출
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMZ_CREDIT_INFO_T002";
	strURL   = "U_svc::" + "fm/fmz/FMZ_CREDIT_INFO_T002.jsp";
	// 데이터셋 설정
	strInDatasets  = "ds_Cond=ds_Dummyin";
	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
	//ds임시생성 해제
	Destroy("ds_Dummyin");
	*/
	//과거에는 아이리스 인터페이스 프로시져를 통해 입금 여부를 실시간으로 가져왔으나
	//지금은 SAP와 연동되어서 바로 받아오기 때문에 그냥 여신을 다시 한번 재조회 하면 됨.
	
	//여신정보
	fn_GetCredit(false);
	dv_RcpConf.visible = false;
	g_Message("01","실시간 입금확인이 완료되었습니다.");
}


function tab_list_tab1_gd_list_OnKeyDown(obj:Grid, e:KeyEventInfo)
{
	var nRow = ds_List1.rowposition;
	var nCell = '0';
	var nPivotIndex = '-1';
	
	//엔터키일때 입력
	if(e.keycode == '13')
	{
		var e = new EventInfo();
		e.row = this[obj.binddataset].rowposition;
	
		gd_list_OnCellDblClick(obj,e);
		
		return true; //Form의 onkeydown 이벤트를 발생시키지 않는다
	}
}

function tab_list_tab2_gd_list_OnKeyDown(obj:Grid, e:KeyEventInfo)
{
	var nRow = ds_List2.rowposition;
	var nCell = '0';
	var nPivotIndex = '-1';
	
	//엔터키일때 입력
	if(e.keycode == '13')
	{
		var e = new EventInfo();
		e.row = this[obj.binddataset].rowposition;
		gd_list_OnCellDblClick(obj,e);
	}
}

function tab_list_tab3_gd_list_OnKeyDown(obj:Grid, e:KeyEventInfo)
{
	var nRow = ds_List3.rowposition;
	var nCell = '0';
	var nPivotIndex = '-1';
	
	//엔터키일때 입력
	if(e.keycode == '13')
	{
		var e = new EventInfo();
		e.row = this[obj.binddataset].rowposition;
	
		gd_list_OnCellDblClick(obj,e);
	}
}





function fn_setInitForm()
{
	if (tab_list.tabindex == 0){
		cbo_Type.index = 1;
		tab_list.tab1.ed_Item.value = ""; 
		tab_list.tab1.chk_Only.value = "1";
		tab_list.tab1.cbo_Class2.index = 0;
		tab_list.tab1.cbo_Class3.index = 0;
		tab_list.tab1.cbo_Class4.index = 0;
		ds_List1.clearData();
		tab_list.tab1.ed_Item.setFocus();
	}else if (tab_list.tabindex == 1){
		cbo_Type.index = 1;
		tab_list.tab2.ed_Item.value = ""; 
		tab_list.tab2.chk_Only.value = "1";
		tab_list.tab2.cbo_Fav.index = 0;
		ds_List2.clearData();
		tab_list.tab2.ed_Item.setFocus();
	}else if (tab_list.tabindex == 2){
		cbo_Type.index = 1;
		tab_list.tab3.ed_Item.value = ""; 
		tab_list.tab3.chk_Only.value = "1";
		ds_List3.clearData();
		tab_list.tab3.ed_Item.setFocus();
	}else if (tab_list.tabindex == 3){
		cbo_Type.index = 1;
		tab_list.tab4.ed_Item.value = ""; 
		ds_List4.clearData();
		tab_list.tab4.ed_Item.setFocus();
	}
}

// FICS 발주제한요일, 시간 설정 조회
function fn_getWeekendTime()
{
	fn_CurrDateWeek();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_WeekendTime=ds_List";
    callBackFnc = "callBackWeekendTime"
    //action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	//fsp_addSearch(this, "fm/fmz:FMZ_GET_WEEKENDTIME_S001");
	fsp_addSearch(this, "fm/fmz:FMZ_GET_WEEKENDTIME_S001");
	
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
}

function callBackWeekendTime(errCode, errMsg)
{
	if (errCode == 0)
	{
	    fn_setWeekendTime();
	} else {
		g_Message("EE",fn_AlertMsg("002"));
	}
}

// FICS 발주제한요일, 시간 설정에 따른 화면 제어 	
function fn_setWeekendTime()
{
	var sCurWeekCd = gds_currdate.getColumn(0, "WEEK_CD");
	var sCurTm = gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4);
	var nRow = ds_WeekendTime.findRow("CODE", sCurWeekCd);
	
	if ( nRow > -1 ) {
		
		fa_startTime = ds_WeekendTime.getColumn(nRow, "SET2");
		fa_endTime = ds_WeekendTime.getColumn(nRow, "SET3");
		
		if ( sCurTm >= fa_startTime && sCurTm <= fa_endTime ) {
			
			// 발주 통제 함
			fa_weekendTimeCheck = "Y"; 
			
			//tab_list.tab2.enable = false;
			//tab_list.tab3.enable = false;
			//tab_list.tab4.enable = false;
			
		} else {
		    // 발주 통제 안함
			fa_weekendTimeCheck = "N"; 
			
			//tab_list.tab2.enable = true;
			//tab_list.tab3.enable = true;
			//tab_list.tab4.enable = true;
		}
		
		//trace("fn_setWeekendTime 상품발주: "+fa_weekendTimeCheck);
	}
}

// 발주제한에 따른 탭페이지 제어
function tab_list_canchange(obj:Tab, e:TabIndexChangeEventInfo)
{
	if ( e.postindex == 2 || e.postindex == 3 ) {
		if ( fa_weekendTimeCheck == "Y" ) {
			g_Message("EE", "발주통제 시간입니다.");
			return false;
		}
	} 	
}

function gd_list_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	if ( e.cell == 1 ) {
		var arrParam = new Array();
		arrParam[0] = eval(obj.binddataset).getColumn(e.row, "ITEM_CODE");
		var rtnVal = gfn_dialog("FMP00010P"			// dialogId
					   , "U_FMP::FMP00010P.xfdl"		// Url
					   , {fv_Contents:arrParam}					// 배열
					   , null, null, null, null, null, false, true, -1);
	}
	
}





function Button00_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_OrdWeek();
}

function me_NeedDate_ontextchanged(obj:MaskEdit,  e:TextChangedEventInfo)
{
	
}



function fn_isHoliday(sDate)
{
	var i;
	var aHolidays;
	
	aHolidays = gfn_getHolidays(parseInt(gfn_today().substr(0,4), 10));

	for( i = 0 ; i < aHolidays.length ; i++ )
	{
		if( aHolidays[i].substr(0,8) == sDate )
			return aHolidays[i].substr(8);
	}

	return "";	
}

/*
       <달력 포커스 및 조회 총정리>     2015.12.19 박용대

1. 숫자 입력 후 탭이동 : me_NeedDate_canchange -> me_NeedDate_onkillfocus
                           (fn_search())            (fn_search()) 
                           (색적용)

2. 숫자 입력 후 엔터   : me_NeedDate_onkeydown -> me_NeedDate_onkillfocus
						   (색적용)      			(fn_search()) 

3. 달력컴포넌트를 사용 : me_NeedDate_canchange
						   (fn_search())
						   (색적용)
						   
※ 구조상 탭이동은 조회가 두번 겹칠수 밖에 없음. 2,3번의 케이스가 훨신 많기 때문에 1번은 무시함
※ mi->xplatform으로 바뀌면서 onchanged 이벤트가 canchange 이벤트로 바뀌면서 obj를 제대로 못가져옴. 강제셋팅
*/

function me_NeedDate_onkeydown(obj:MaskEdit, e:KeyEventInfo)
{
	if (e.keycode == 13) 
	{
		//trace("me_NeedDate_onkeydown");
		g_Date_OnKillFocus(obj); 
	
		//초기화
		//	me_Pdate.Value = "";
		//	ed_Pcnt.Text = "";
		//	ed_Pamt.Text = "";
		ds_List.clearData();
		//최종 발주정보
		//fn_GetLastOrd();
		//디데이
		fn_GetDays();
		//날짜변경
		st_Week.text = "(" + ffn_DayToWeek(me_NeedDate.value) + ")";
		
		//날짜색변경
		if (st_Week.text == "(토)")
			st_Week.style.color = "blue";
		else if (st_Week.text == "(일)")
			st_Week.style.color = "red";
		else
			st_Week.style.color = "black";
		//공휴일색변경	
		if(gfn_length(fn_isHoliday(me_NeedDate.value))>0)
		{
			st_Week.style.color = "red";
		}
	}
}


function me_NeedDate_onkillfocus(obj:MaskEdit, e:KillFocusEventInfo)
{
	//trace("me_NeedDate_onkillfocus");
	//변경되면 포커스를 잃고 글로벌 함수 실행(여기서 글자수를 체크하여 제대로 된 데이터 넘김)
	g_Date_OnKillFocus(obj);
	
	//변경된 사항이 있는지 확인
	if(gfn_dsIsUpdated(ds_List)==true)
	{
		g_Message("EE","변경된 내역이 있습니다. 저장해 주십시요");
		me_NeedDate.value = pre_need_date;	//변경전의 날짜를 되돌림
		return;
	}else{
		// 상단그리드 초기화
		fn_setInitForm();
		fn_search();
	}
}


function me_NeedDate_canchange(obj:MaskEdit,  e:ChangeEventInfo)
{
	//trace("me_NeedDate_canchange");
	
	//날짜변경
	st_Week.text = "(" + ffn_DayToWeek(me_NeedDate.value) + ")";
	//날짜색변경

	if (st_Week.text == "(토)")
		st_Week.style.color = "blue";
	else if (st_Week.text == "(일)")
		st_Week.style.color = "red";
	else
		st_Week.style.color = "black";
	//공휴일색변경	
	if(gfn_length(fn_isHoliday(me_NeedDate.value))>0)
	{
		st_Week.style.color = "red";
	}

	
	//변경되면 포커스를 잃고 글로벌 함수 실행(여기서 글자수를 체크하여 제대로 된 데이터 넘김)
	g_Date_OnKillFocus(me_NeedDate);
		
	//변경된 사항이 있는지 확인
	if(gfn_dsIsUpdated(ds_List)==true)
	{
		g_Message("EE","변경된 내역이 있습니다. 저장해 주십시요");
		me_NeedDate.value = pre_need_date;	//변경전의 날짜를 되돌림
		return;
	}else{
		// 상단그리드 초기화
		fn_setInitForm();
		fn_search();
	}

}


function sp_line_onmove(obj:Splitter, e:MoveEventInfo)
{
	Image1.position.top = e.y + 22;
	Image1.position.height = 15;
	Image2.position.top = e.y + 22;
	Image2.position.height = 15;
	Image3.position.top = e.y + 22;
	Image3.position.height = 15;
	Static4.position.top = e.y + 24;
	Static4.position.height = 12;
	Static5.position.top = e.y + 24;
	Static5.position.height = 12;
	Static7.position.top = e.y + 24;
	Static7.position.height = 12;
	Static9.position.top = e.y + 24;
	Static9.position.height = 12;
	
	Static14.position.top = e.y + 16;
	Static14.position.height = 27;
	
	Static2.position.top = e.y + 56;
	Static2.position.height = 18;
	Static44.position.top = e.y + 56;
	Static44.position.height = 15;
	
	gd_list.position.top = e.y + 74;	
}

function fn_tm()
{
	trace("fn_tm");
	//fn_upjangDelete();
}
function comp_tm_onkeydown(obj:TmSearchComponent, e:KeyEventInfo)
{
	if(e.keycode == 46){
		//fn_upjangDelete();	// 메인업장, 업장 초기화 : 제외
		comp_tm.setTmCode("");
		comp_tm.setTmName("");
	}
}

function edt_ccCd_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 46){
		//fn_upjangDelete();	// 메인업장, 업장 초기화
		ds_Cond.setColumn(0, "schCc", "");
		ds_Cond.setColumn(0, "schCcNm", "");
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : CC 조회 이벤트 before, after
 *---------------------------------------------------------------------------------------------*/
function fn_ccBeforeEvent(p)
{
	p.option.muCd = ds_Cond.getColumn(0, "schMu");
	p.option.tmCd = ds_Cond.getColumn(0, "schTm");
	return true;
}

function fn_ccAfterEvent(p)
{
	ds_Cond.setColumn(0, "schCc", edt_ccCd.userdata);
	ds_Cond.setColumn(0, "schCcNm", edt_ccCd.value);
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 구매유형정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchType()
{
    var strSvcID    = "searchType";
    var strURL      = "fm/fmo/orderRequest/selectType.xdo";
    var strInDs     = "";
    var strOutDs    = "ds_type=ds_type";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 구매유형 COMBO 초기화 
 *---------------------------------------------------------------------------------------------*/
function fn_type_init()
{
	var defVal = "";
	//ds_type.filter("poType != '29'");
	
	// 전체 추가
	//ds_type.insertRow(0);
	//ds_type.setColumn(0,"typeName", "전체");
	//ds_type.setColumn(0,"poType", "");
	
	// COMBO 에 첫번째 Row에 기본값을 SET
	if (ds_type.getRowCount() > 0) {
		defVal = ds_type.getColumn(0, "poType");
	}
	//trace("poType : " + defVal);
	cbo_type.value = defVal;
}

function fn_edBtn_OnClick(obj:Button, e:ClickEventInfo)
{
	var sAddWhere = "";
	switch(obj.name)
	{   
		// 1. 본사를 선택 했을 경우.
		case "btn_MainUpjang":
			if (application.g_UserKind == '본부')
			{
				sAddWhere = " AND A.MAIN_UPJANG = A.UPJANG ";
				//fm공통 팝업클릭 호출
				if (ffn_btn_OnClick(obj, sAddWhere)) fn_Trigger_edBtn(eval("ed_" + gfn_subStr(obj.name, 4)));								
				break;
			}
			else if (application.g_UserKind == '본사')
			{
				sAddWhere = " AND A.USE_YN = 'Y' AND A.MAIN_UPJANG = A.UPJANG AND A.MAIN_UPJANG = " + g_Main_Upjang;
				//fm공통 팝업클릭 호출
				if (ffn_btn_OnClick(obj, sAddWhere)) fn_Trigger_edBtn(eval("ed_" + gfn_subStr(obj.name, 4)));								
				break;
			}
			else if (application.g_UserKind == '사업장')
			{
				sAddWhere = " AND A.USE_YN = 'Y' AND A.MAIN_UPJANG = A.UPJANG AND A.MAIN_UPJANG = " + g_Main_Upjang;
				//fm공통 팝업클릭 호출
				if (ffn_btn_OnClick(obj, sAddWhere)) fn_Trigger_edBtn(eval("ed_" + gfn_subStr(obj.name, 4)));								
				break;
			}
		// 2.사업장을 선택 했을 경우.
		case "btn_Upjang":
			if (application.g_UserKind == '사업장'){
				sAddWhere = " AND A.USE_YN = 'Y' AND A.MAIN_UPJANG = " + g_Main_Upjang;
				sAddWhere += " AND ( A.UPJANG = " + application.g_Upjang + " OR EXISTS (SELECT 1 FROM FMS_USER_UPJANG B WHERE B.USE_YN = 'Y' AND B.UPJANG = A.UPJANG AND B.SABUN = '" + application.g_EmpNo + "') )";
				//fm공통 팝업클릭 호출
				if (ffn_btn_OnClick(obj, sAddWhere)) fn_Trigger_edBtn(eval("ed_" + gfn_subStr(obj.name, 4)));
				
				// 해당 창고 정보 Combo Box 데이터 추출
				fn_sql_common("C",strQuery_FMS_SUBINV," AND B.UPJANG = " + gfn_toString(ed_Upjang.userdata)+ " UNION ALL SELECT '' AS SUBINV_CODE, '- 전체 -' AS SUBINV_NAME_DISP FROM DUAL ORDER BY SUBINV_CODE DESC" ,"","",cbo_Subinv,-1,ds_Subinv);
				// 공급업체 Combo Box 데이터 추출
				fn_sql_common("C",strQuery_FMOtcust,"AND A.USE_YN = 'Y' AND EXISTS (SELECT 1 FROM FMP_OTCUST_LINK B, FMS_UPJANG C WHERE B.OTCUSTCD = A.OTCUSTCD AND B.USE_YN = 'Y' AND B.UPJANG = C.MAIN_UPJANG AND C.UPJANG = " + ed_Upjang.userdata + ") UNION ALL SELECT '' AS OTCUSTCD, '- 전체 -' AS OTCUSTNM FROM DUAL ORDER BY OTCUSTCD DESC","","",cbo_Otcust,-1,ds_Otcust);				
				cbo_Otcust.index = 0;
				if (ds_Otcust.findRowExpr("OTCUSTCD=='0000'") >= 0) cbo_Otcust.value = "0000";
				break;
			}
			else if (application.g_UserKind == '본사'){
				sAddWhere = " AND A.USE_YN = 'Y' AND A.MAIN_UPJANG = " + g_Main_Upjang;				
				if (ffn_btn_OnClick(obj, sAddWhere)) fn_Trigger_edBtn(eval("ed_" + gfn_subStr(obj.name, 4)));
				
				// 해당 창고 정보 Combo Box 데이터 추출
				fn_sql_common("C",strQuery_FMS_SUBINV," AND B.UPJANG = " + gfn_toString(ed_Upjang.userdata)+ " UNION ALL SELECT '' AS SUBINV_CODE, '- 전체 -' AS SUBINV_NAME_DISP FROM DUAL ORDER BY SUBINV_CODE DESC" ,"","",cbo_Subinv,-1,ds_Subinv);
				// 공급업체 Combo Box 데이터 추출
				fn_sql_common("C",strQuery_FMOtcust,"AND A.USE_YN = 'Y' AND EXISTS (SELECT 1 FROM FMP_OTCUST_LINK B, FMS_UPJANG C WHERE B.OTCUSTCD = A.OTCUSTCD AND B.USE_YN = 'Y' AND B.UPJANG = C.MAIN_UPJANG AND C.UPJANG = " + ed_Upjang.userdata + ") UNION ALL SELECT '' AS OTCUSTCD, '- 전체 -' AS OTCUSTNM FROM DUAL ORDER BY OTCUSTCD DESC","","",cbo_Otcust,-1,ds_Otcust);
				cbo_Otcust.index = 0;
				if (ds_Otcust.findRowExpr("OTCUSTCD=='0000'") >= 0) cbo_Otcust.value = "0000";
				break;
			}
			else if (application.g_UserKind == '본부'){
				sAddWhere = " AND A.USE_YN = 'Y' AND A.MAIN_UPJANG =  " + ed_MainUpjang.userdata ;
				if (ffn_btn_OnClick(obj, sAddWhere)); //fn_Trigger_edBtn(eval("ed_" + gfn_subStr(obj.name, 4)));
				// 해당 창고 정보 Combo Box 데이터 추출
				fn_sql_common("C",strQuery_FMS_SUBINV," AND B.UPJANG = " + gfn_toString(ed_Upjang.userdata)+ " UNION ALL SELECT '' AS SUBINV_CODE, '- 전체 -' AS SUBINV_NAME_DISP FROM DUAL ORDER BY SUBINV_CODE DESC" ,"","",cbo_Subinv,-1,ds_Subinv);
				// 공급업체 Combo Box 데이터 추출
				fn_sql_common("C",strQuery_FMOtcust,"AND A.USE_YN = 'Y' AND EXISTS (SELECT 1 FROM FMP_OTCUST_LINK B, FMS_UPJANG C WHERE B.OTCUSTCD = A.OTCUSTCD AND B.USE_YN = 'Y' AND B.UPJANG = C.MAIN_UPJANG AND C.UPJANG = " + ed_Upjang.userdata + ") UNION ALL SELECT '' AS OTCUSTCD, '- 전체 -' AS OTCUSTNM FROM DUAL ORDER BY OTCUSTCD DESC","","",cbo_Otcust,-1,ds_Otcust);
				cbo_Otcust.index = 0;
				if (ds_Otcust.findRowExpr("OTCUSTCD=='0000'") >= 0) cbo_Otcust.value = "0000";				
				break;
			}
		default:
			   break;
	}
}


]]></Script>
  </Form>
</FDL>

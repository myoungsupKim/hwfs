<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="OrderRequestUpload" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1155 713" titletext="주문신청업로드" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1140 0 1155 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 697 1150 712" anchor="left bottom"/>
        <Static id="Static18" text="주문신청내역" class="sta_WF_Title01" position="absolute 15 93 465 111" anchor="left top"/>
        <Static id="Static20" text="글자기준간격 h08" class="Guide01_AreaRed" visible="false" position="absolute 0 106 450 114" anchor="left top"/>
        <Grid id="grd_list" taborder="2" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 14 114 1140 480" anchor="all" autofittype="none" binddataset="ds_list" autosizingtype="none" onheadclick="grd_list_onheadclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="85"/>
                <Column size="166"/>
                <Column size="76"/>
                <Column size="69"/>
                <Column size="73"/>
                <Column size="135"/>
                <Column size="152"/>
                <Column size="68"/>
                <Column size="63"/>
                <Column size="193"/>
                <Column size="181"/>
                <Column size="300"/>
                <Column size="69"/>
                <Column size="400"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" class="grd_WF_Essential" text="창고코드"/>
                <Cell col="2" text="창고명"/>
                <Cell col="3" class="grd_WF_Essential" text="발주일"/>
                <Cell col="4" class="grd_WF_Essential" text="입고일"/>
                <Cell col="5" class="grd_WF_Essential" text="자재코드"/>
                <Cell col="6" text="자재명"/>
                <Cell col="7" text="규격"/>
                <Cell col="8" text="구매단위"/>
                <Cell col="9" class="grd_WF_Essential" text="수량"/>
                <Cell col="10" text="비고"/>
                <Cell col="11" text="사업장"/>
                <Cell col="12" text="오류메시지"/>
                <Cell col="13" text="구매상세"/>
                <Cell col="14" text="오류메시지"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:subinvCode"/>
                <Cell col="2" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:subinvName"/>
                <Cell col="3" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prDate"/>
                <Cell col="4" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:needDate"/>
                <Cell col="5" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemCode"/>
                <Cell col="6" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemName"/>
                <Cell col="7" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemSize"/>
                <Cell col="8" displaytype="text" style="align:center;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemUnit"/>
                <Cell col="9" displaytype="number" edittype="masknumber" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prQty" mask="#,##0.#0"/>
                <Cell col="10" displaytype="text" edittype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prRemark"/>
                <Cell col="11" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:rcUpjangNm"/>
                <Cell col="12" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:red;color2:red;" text="bind:msg"/>
                <Cell col="13" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:poMsg"/>
                <Cell col="14" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:blue;color2:blue;" text="bind:msg2"/>
              </Band>
            </Format>
            <Format id="down">
              <Columns>
                <Column size="85"/>
                <Column size="76"/>
                <Column size="69"/>
                <Column size="73"/>
                <Column size="135"/>
                <Column size="152"/>
                <Column size="68"/>
                <Column size="63"/>
                <Column size="193"/>
                <Column size="208"/>
                <Column size="300"/>
                <Column size="215"/>
                <Column size="300"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="grd_WF_Essential" text="창고코드"/>
                <Cell col="1" class="grd_WF_Essential" text="발주일"/>
                <Cell col="2" class="grd_WF_Essential" text="입고일"/>
                <Cell col="3" class="grd_WF_Essential" text="자재코드"/>
                <Cell col="4" text="자재명"/>
                <Cell col="5" text="규격"/>
                <Cell col="6" text="구매단위"/>
                <Cell col="7" class="grd_WF_Essential" text="수량"/>
                <Cell col="8" text="비고"/>
                <Cell col="9" text="사업장"/>
                <Cell col="10" text="오류메시지"/>
                <Cell col="11" text="구매상세오류"/>
                <Cell col="12" text="오류메시지"/>
              </Band>
              <Band id="body">
                <Cell style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:subinvCode"/>
                <Cell col="1" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prDate"/>
                <Cell col="2" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:needDate"/>
                <Cell col="3" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemCode"/>
                <Cell col="4" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemName"/>
                <Cell col="5" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemSize"/>
                <Cell col="6" displaytype="text" style="align:center;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemUnit"/>
                <Cell col="7" displaytype="number" edittype="none" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prQty" mask="#,##0.#0"/>
                <Cell col="8" displaytype="text" edittype="none" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prRemark"/>
                <Cell col="9" displaytype="text" style="align:left middle;" text="bind:rcUpjangNm"/>
                <Cell col="10" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:red;color2:red;" text="bind:msg"/>
                <Cell col="11" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:poMsg"/>
                <Cell col="12" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:blue;color2:blue;" text="bind:msg2"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static25" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 1056 110 1140 115" anchor="top right"/>
        <Static id="Static00" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1100 10"/>
        <Static id="sta_title" text="07.식자재_식재영업(FS) 구매신청 업로드" class="sta_WF_Title" position="absolute 15 16 341 40"/>
        <Static id="Static03" text="아이콘기준 h08" class="Guide01_AreaRed" visible="false" position="absolute 15 32 215 40"/>
        <Static id="Static17" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 15 10 215 16"/>
        <Button id="btn_delete" taborder="6" text="삭제" onclick="fn_delete" class="btn_WF_CRUD" position="absolute 1001 10 1046 35" anchor="top right"/>
        <Button id="btn_save" taborder="7" text="저장" onclick="fn_save" class="btn_WF_CRUD" position="absolute 1048 10 1093 35" anchor="top right"/>
        <Button id="btn_close" taborder="8" text="닫기" onclick="btn_close_onclick" class="btn_WF_CRUD" position="absolute 1095 10 1140 35" anchor="top right"/>
        <Static id="Static14" text="W102" visible="false" position="absolute 1093 10 1095 35" anchor="top right" style="background:#ff000055;align:center middle;"/>
        <Static id="Static16" text="W102" visible="false" position="absolute 1046 10 1048 35" anchor="top right" style="background:#ff000055;align:center middle;"/>
        <Button id="btn_excel" taborder="5" text="엑셀" class="btn_WF_CRUD" position="absolute 954 10 999 35" anchor="top right" onclick="fn_excel"/>
        <Static id="Static21" text="W102" visible="false" position="absolute 999 10 1001 35" anchor="top right" style="background:#ff000055;align:center middle;"/>
        <Static id="Static41" text="엑셀 업로드 후 저장 버튼을 눌러 처리합니다." onclick="Static41_onclick" class="sta_WF_DiscInfo" position="absolute 747 93 1046 113" anchor="top right"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 40 1140 81" anchor="left top right"/>
        <Static id="Static12" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 15 341"/>
        <Static id="Static09" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 234 41 327 51" anchor="left top"/>
        <Static id="Static13" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 81 51 91 72" anchor="left top"/>
        <Static id="Static27" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 191 51 221 77" anchor="left top"/>
        <Static id="Static30" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 285 51 295 72" anchor="left top"/>
        <ObjCalendar id="cal_prDate" anchor="left top" titletext="캘린더" taborder="0" scrollbars="none" enable="false" position="absolute 91 51 191 72"/>
        <Static id="Static52" text="신청일자" class="sta_WFSA_label" position="absolute 18 51 94 72" anchor="left top"/>
        <Static id="Static31" text="입고일자" class="sta_WFSA_label" position="absolute 222 51 298 72" anchor="left top"/>
        <ObjCalendar id="cal_needDate" anchor="left top" titletext="캘린더" taborder="1" scrollbars="none" enable="false" position="absolute 295 51 395 72"/>
        <ProgressBar id="pbr_status" taborder="3" text="엑셀업로드 진행 작업" max="100" min="0" position="absolute 774 49 1140 73" anchor="top right"/>
        <Static id="Static19" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 81 450 94"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 690 81 1140 94"/>
        <Grid id="grd_list2" taborder="9" binddataset="ds_sample" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 844 342 1128 464" anchor="left top right" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="136"/>
                <Column size="173"/>
                <Column size="60"/>
                <Column size="80"/>
                <Column size="200"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="창고코드"/>
                <Cell col="1" text="발주일"/>
                <Cell col="2" text="입고일"/>
                <Cell col="3" text="자재코드"/>
                <Cell col="4" text="자재명"/>
                <Cell col="5" text="규격"/>
                <Cell col="6" text="단위"/>
                <Cell col="7" text="수량"/>
                <Cell col="8" text="비고"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center middle;" text="bind:subinvCode"/>
                <Cell col="1" displaytype="text" style="align:center middle;" text="bind:prDate"/>
                <Cell col="2" displaytype="text" style="align:center middle;" text="bind:needDate"/>
                <Cell col="3" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                <Cell col="4" displaytype="text" text="bind:itemName"/>
                <Cell col="5" displaytype="text" text="bind:itemSize"/>
                <Cell col="6" displaytype="text" style="align:center middle;" text="bind:itemUnit"/>
                <Cell col="7" displaytype="normal" style="align:right middle;" text="bind:prQty"/>
                <Cell col="8" displaytype="text" text="bind:prRemark"/>
              </Band>
            </Format>
            <Format id="down">
              <Columns>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="136"/>
                <Column size="173"/>
                <Column size="60"/>
                <Column size="80"/>
                <Column size="200"/>
              </Columns>
              <Rows>
                <Row size="24"/>
              </Rows>
              <Band id="body">
                <Cell displaytype="text" style="align:center middle;" text="bind:subinvCode"/>
                <Cell col="1" displaytype="text" style="align:center middle;" text="bind:prDate"/>
                <Cell col="2" displaytype="text" style="align:center middle;" text="bind:needDate"/>
                <Cell col="3" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                <Cell col="4" displaytype="text" text="bind:itemName"/>
                <Cell col="5" displaytype="text" text="bind:itemSize"/>
                <Cell col="6" displaytype="text" style="align:center middle;" text="bind:itemUnit"/>
                <Cell col="7" displaytype="normal" style="align:right middle;" text="bind:prQty"/>
                <Cell col="8" displaytype="text" text="bind:prRemark"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_template" taborder="4" text="엑셀템플릿" class="btn_WF_Function" visible="true" position="absolute 1063 90 1140 110" anchor="top right" onclick="btn_template_onclick"/>
        <Grid id="grd_listErr" taborder="10" binddataset="ds_listErr" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 14 490 1140 696" anchor="all">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="85"/>
                <Column size="166"/>
                <Column size="76"/>
                <Column size="69"/>
                <Column size="73"/>
                <Column size="135"/>
                <Column size="152"/>
                <Column size="68"/>
                <Column size="63"/>
                <Column size="193"/>
                <Column size="181"/>
                <Column size="300"/>
                <Column size="213"/>
                <Column size="400"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" class="grd_WF_Essential" text="창고코드"/>
                <Cell col="2" text="창고명"/>
                <Cell col="3" class="grd_WF_Essential" text="발주일"/>
                <Cell col="4" class="grd_WF_Essential" text="입고일"/>
                <Cell col="5" class="grd_WF_Essential" text="자재코드"/>
                <Cell col="6" text="자재명"/>
                <Cell col="7" text="규격"/>
                <Cell col="8" text="구매단위"/>
                <Cell col="9" class="grd_WF_Essential" text="수량"/>
                <Cell col="10" text="비고"/>
                <Cell col="11" text="사업장"/>
                <Cell col="12" text="오류메시지"/>
                <Cell col="13" text="구매상세"/>
                <Cell col="14" text="오류메시지"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:subinvCode"/>
                <Cell col="2" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:subinvName"/>
                <Cell col="3" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prDate"/>
                <Cell col="4" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:needDate"/>
                <Cell col="5" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemCode"/>
                <Cell col="6" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemName"/>
                <Cell col="7" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemSize"/>
                <Cell col="8" displaytype="text" style="align:center;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemUnit"/>
                <Cell col="9" displaytype="number" edittype="masknumber" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prQty" mask="#,##0.#0"/>
                <Cell col="10" displaytype="text" edittype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prRemark"/>
                <Cell col="11" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:rcUpjangNm"/>
                <Cell col="12" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:red;color2:red;" text="bind:msg"/>
                <Cell col="13" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:poMsg"/>
                <Cell col="14" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:blue;color2:blue;" text="bind:msg2"/>
              </Band>
            </Format>
            <Format id="down">
              <Columns>
                <Column size="85"/>
                <Column size="76"/>
                <Column size="69"/>
                <Column size="73"/>
                <Column size="135"/>
                <Column size="152"/>
                <Column size="68"/>
                <Column size="63"/>
                <Column size="193"/>
                <Column size="208"/>
                <Column size="300"/>
                <Column size="215"/>
                <Column size="300"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="grd_WF_Essential" text="창고코드"/>
                <Cell col="1" class="grd_WF_Essential" text="발주일"/>
                <Cell col="2" class="grd_WF_Essential" text="입고일"/>
                <Cell col="3" class="grd_WF_Essential" text="자재코드"/>
                <Cell col="4" text="자재명"/>
                <Cell col="5" text="규격"/>
                <Cell col="6" text="구매단위"/>
                <Cell col="7" class="grd_WF_Essential" text="수량"/>
                <Cell col="8" text="비고"/>
                <Cell col="9" text="사업장"/>
                <Cell col="10" text="오류메시지"/>
                <Cell col="11" text="구매상세오류"/>
                <Cell col="12" text="오류메시지"/>
              </Band>
              <Band id="body">
                <Cell style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:subinvCode"/>
                <Cell col="1" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prDate"/>
                <Cell col="2" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:needDate"/>
                <Cell col="3" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemCode"/>
                <Cell col="4" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemName"/>
                <Cell col="5" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemSize"/>
                <Cell col="6" displaytype="text" style="align:center;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemUnit"/>
                <Cell col="7" displaytype="number" edittype="none" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prQty" mask="#,##0.#0"/>
                <Cell col="8" displaytype="text" edittype="none" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prRemark"/>
                <Cell col="9" displaytype="text" style="align:left middle;" text="bind:rcUpjangNm"/>
                <Cell col="10" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:red;color2:red;" text="bind:msg"/>
                <Cell col="11" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:poMsg"/>
                <Cell col="12" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:blue;color2:blue;" text="bind:msg2"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="Grid00" taborder="11" useinputpanel="false" position="absolute 229 344 812 470" binddataset="ds_excel" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="subinvCode"/>
                <Cell col="1" disptype="normal" text="prDate"/>
                <Cell col="2" disptype="normal" text="needDate"/>
                <Cell col="3" disptype="normal" text="itemCode"/>
                <Cell col="4" disptype="normal" text="itemName"/>
                <Cell col="5" disptype="normal" text="itemSize"/>
                <Cell col="6" disptype="normal" text="itemUnit"/>
                <Cell col="7" disptype="normal" text="prQty"/>
                <Cell col="8" disptype="normal" text="prRemark"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:subinvCode"/>
                <Cell col="1" disptype="normal" text="bind:prDate"/>
                <Cell col="2" disptype="normal" text="bind:needDate"/>
                <Cell col="3" disptype="normal" text="bind:itemCode"/>
                <Cell col="4" disptype="normal" text="bind:itemName"/>
                <Cell col="5" disptype="normal" text="bind:itemSize"/>
                <Cell col="6" disptype="normal" text="bind:itemUnit"/>
                <Cell col="7" disptype="normal" text="bind:prQty"/>
                <Cell col="8" disptype="normal" text="bind:prRemark"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item2" compid="cal_prDate" propid="text" datasetid="ds_search" columnid="schPrDate"/>
      <BindItem id="item3" compid="cal_needDate" propid="text" datasetid="ds_search" columnid="schNeedDate"/>
    </Bind>
    <Objects>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_search_oncolumnchanged">
        <ColumnInfo>
          <Column id="schType" type="STRING" size="256"/>
          <Column id="schTypeNm" type="STRING" size="256"/>
          <Column id="schSabun" type="STRING" size="256"/>
          <Column id="schPrDate" type="STRING" size="256"/>
          <Column id="schNeedDate" type="STRING" size="256"/>
          <Column id="schPrUpjang" type="STRING" size="256"/>
          <Column id="schPrDeptId" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="rcUpjang" type="STRING" size="256"/>
          <Column id="rcUpjangNm" type="STRING" size="256"/>
          <Column id="invatFlag" type="STRING" size="256"/>
          <Column id="outvatFlag" type="STRING" size="256"/>
          <Column id="stockFlag" type="STRING" size="256"/>
          <Column id="minOrdQty" type="STRING" size="256"/>
          <Column id="maxOrdQty" type="STRING" size="256"/>
          <Column id="multiplierQty" type="STRING" size="256"/>
          <Column id="pointFlag" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
          <Column id="error" type="STRING" size="256"/>
          <Column id="msg" type="STRING" size="256"/>
          <Column id="msg2" type="STRING" size="256"/>
          <Column id="cenFlag" type="STRING" size="256"/>
          <Column id="subFlag" type="STRING" size="256"/>
          <Column id="subInfoFlag" type="STRING" size="256"/>
          <Column id="itemFlag" type="STRING" size="256"/>
          <Column id="cusFlag" type="STRING" size="256"/>
          <Column id="poCnt" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="poStatus" type="STRING" size="256"/>
          <Column id="poMsg" type="STRING" size="256"/>
          <Column id="fmpStatus" type="STRING" size="256"/>
          <Column id="poNoStatus" type="STRING" size="256"/>
          <Column id="ordFlag" type="STRING" size="256"/>
          <Column id="ordDaysFlag" type="STRING" size="256"/>
          <Column id="headYn" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="creditYn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_excel" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listRow" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="rcUpjang" type="STRING" size="256"/>
          <Column id="rcUpjangNm" type="STRING" size="256"/>
          <Column id="invatFlag" type="STRING" size="256"/>
          <Column id="outvatFlag" type="STRING" size="256"/>
          <Column id="stockFlag" type="STRING" size="256"/>
          <Column id="minOrdQty" type="STRING" size="256"/>
          <Column id="maxOrdQty" type="STRING" size="256"/>
          <Column id="multiplierQty" type="STRING" size="256"/>
          <Column id="pointFlag" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
          <Column id="error" type="STRING" size="256"/>
          <Column id="msg" type="STRING" size="256"/>
          <Column id="msg2" type="STRING" size="256"/>
          <Column id="cenFlag" type="STRING" size="256"/>
          <Column id="subFlag" type="STRING" size="256"/>
          <Column id="subInfoFlag" type="STRING" size="256"/>
          <Column id="itemFlag" type="STRING" size="256"/>
          <Column id="cusFlag" type="STRING" size="256"/>
          <Column id="poCnt" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="poStatus" type="STRING" size="256"/>
          <Column id="poMsg" type="STRING" size="256"/>
          <Column id="fmpStatus" type="STRING" size="256"/>
          <Column id="poNoStatus" type="STRING" size="256"/>
          <Column id="ordFlag" type="STRING" size="256"/>
          <Column id="ordDaysFlag" type="STRING" size="256"/>
          <Column id="headYn" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="creditYn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_excelRow" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_saveRow" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="rcUpjang" type="STRING" size="256"/>
          <Column id="invatFlag" type="STRING" size="256"/>
          <Column id="outvatFlag" type="STRING" size="256"/>
          <Column id="stockFlag" type="STRING" size="256"/>
          <Column id="minOrdQty" type="STRING" size="256"/>
          <Column id="maxOrdQty" type="STRING" size="256"/>
          <Column id="multiplierQty" type="STRING" size="256"/>
          <Column id="pointFlag" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
          <Column id="error" type="STRING" size="256"/>
          <Column id="msg" type="STRING" size="256"/>
          <Column id="cenFlag" type="STRING" size="256"/>
          <Column id="subFlag" type="STRING" size="256"/>
          <Column id="itemFlag" type="STRING" size="256"/>
          <Column id="cusFlag" type="STRING" size="256"/>
          <Column id="poCnt" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="poStatus" type="STRING" size="256"/>
          <Column id="poMsg" type="STRING" size="256"/>
          <Column id="fmpStatus" type="STRING" size="256"/>
          <Column id="poNoStatus" type="STRING" size="256"/>
          <Column id="ordFlag" type="STRING" size="256"/>
          <Column id="ordDaysFlag" type="STRING" size="256"/>
          <Column id="headYn" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="creditYn" type="STRING" size="256"/>
          <Column id="oldRow" type="STRING" size="256"/>
          <Column id="prNum" type="STRING" size="256"/>
          <Column id="approveNum" type="STRING" size="256"/>
          <Column id="prDeptId" type="STRING" size="256"/>
          <Column id="prUpjang" type="STRING" size="256"/>
          <Column id="poType" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_save" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="rcUpjang" type="STRING" size="256"/>
          <Column id="invatFlag" type="STRING" size="256"/>
          <Column id="outvatFlag" type="STRING" size="256"/>
          <Column id="stockFlag" type="STRING" size="256"/>
          <Column id="minOrdQty" type="STRING" size="256"/>
          <Column id="maxOrdQty" type="STRING" size="256"/>
          <Column id="multiplierQty" type="STRING" size="256"/>
          <Column id="pointFlag" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
          <Column id="error" type="STRING" size="256"/>
          <Column id="msg" type="STRING" size="256"/>
          <Column id="cenFlag" type="STRING" size="256"/>
          <Column id="subFlag" type="STRING" size="256"/>
          <Column id="itemFlag" type="STRING" size="256"/>
          <Column id="cusFlag" type="STRING" size="256"/>
          <Column id="poCnt" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="poStatus" type="STRING" size="256"/>
          <Column id="poMsg" type="STRING" size="256"/>
          <Column id="fmpStatus" type="STRING" size="256"/>
          <Column id="poNoStatus" type="STRING" size="256"/>
          <Column id="ordFlag" type="STRING" size="256"/>
          <Column id="ordDaysFlag" type="STRING" size="256"/>
          <Column id="headYn" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="creditYn" type="STRING" size="256"/>
          <Column id="oldRow" type="STRING" size="256"/>
          <Column id="prNum" type="STRING" size="256"/>
          <Column id="approveNum" type="STRING" size="256"/>
          <Column id="prDeptId" type="STRING" size="256"/>
          <Column id="prUpjang" type="STRING" size="256"/>
          <Column id="poType" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_type" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="poType" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_upload" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sample" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100217</Col>
            <Col id="itemName">수수</Col>
            <Col id="itemSize">[상품]</Col>
            <Col id="itemUnit">KG</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100226</Col>
            <Col id="itemName">기장조</Col>
            <Col id="itemSize">[상품]</Col>
            <Col id="itemUnit">KG</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100227</Col>
            <Col id="itemName">메조</Col>
            <Col id="itemSize">[상품]</Col>
            <Col id="itemUnit">KG</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100229</Col>
            <Col id="itemName">차조</Col>
            <Col id="itemSize">[상품]</Col>
            <Col id="itemUnit">KG</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100244</Col>
            <Col id="itemName">흑임자 두보식품</Col>
            <Col id="itemSize">[500g/EA, EA] </Col>
            <Col id="itemUnit">EA</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100247</Col>
            <Col id="itemName">검정깨</Col>
            <Col id="itemUnit">EA</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100249</Col>
            <Col id="itemName">흑임자가루</Col>
            <Col id="itemUnit">EA</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100708</Col>
            <Col id="itemName">배추</Col>
            <Col id="itemSize">[3통/망] [상] [망작?</Col>
            <Col id="itemUnit">BOX</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100710</Col>
            <Col id="itemName">알배기배추</Col>
            <Col id="itemSize">[약간청색] </Col>
            <Col id="itemUnit">KG</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100799</Col>
            <Col id="itemName">깻잎, 나물 </Col>
            <Col id="itemSize">[상]</Col>
            <Col id="itemUnit">KG</Col>
            <Col id="prQty">1</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">0</Col>
            <Col id="delYn">1</Col>
            <Col id="savYn">1</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">1</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_listErr" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="rcUpjang" type="STRING" size="256"/>
          <Column id="rcUpjangNm" type="STRING" size="256"/>
          <Column id="invatFlag" type="STRING" size="256"/>
          <Column id="outvatFlag" type="STRING" size="256"/>
          <Column id="stockFlag" type="STRING" size="256"/>
          <Column id="minOrdQty" type="STRING" size="256"/>
          <Column id="maxOrdQty" type="STRING" size="256"/>
          <Column id="multiplierQty" type="STRING" size="256"/>
          <Column id="pointFlag" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
          <Column id="error" type="STRING" size="256"/>
          <Column id="msg" type="STRING" size="256"/>
          <Column id="msg2" type="STRING" size="256"/>
          <Column id="cenFlag" type="STRING" size="256"/>
          <Column id="subFlag" type="STRING" size="256"/>
          <Column id="subInfoFlag" type="STRING" size="256"/>
          <Column id="itemFlag" type="STRING" size="256"/>
          <Column id="cusFlag" type="STRING" size="256"/>
          <Column id="poCnt" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="poStatus" type="STRING" size="256"/>
          <Column id="poMsg" type="STRING" size="256"/>
          <Column id="fmpStatus" type="STRING" size="256"/>
          <Column id="poNoStatus" type="STRING" size="256"/>
          <Column id="ordFlag" type="STRING" size="256"/>
          <Column id="ordDaysFlag" type="STRING" size="256"/>
          <Column id="headYn" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="creditYn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : OrderRequestUpload
  파 일 명 : OrderRequestUpload.xfdl
  기    능 : 식재영업 / 주문관리 / 주문신청 / 구매신청업로드

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.06.17   최성연   최초 생성
  
  1) 공통 버튼 정의
  - 엑셀, 삭제, 저장,  닫기, 도움말 활성화
  
  2) 검토사항
  가) 파라미터
  - 구매유형 : 타이틀 표시, 식자재_식재영업(FS) 건만 처리 가능
  - 로그인정보 : 신청자 정보 조회

  나) 저장 처리 
  - 엑셀업로드 시 에러가 발생한 건에 대한 처리
  - 저장 시 여신잔액에 대한 CHECK 후 여신 잔액한도 내이면 저장, 아니면 에러 표시
  - 신청번호는 동일하게 부여 (1개로 처리)
  - 최종 저장 시 여신관련 오류가 발생하면 이전 저장건에 대한 모든 자료를 삭제 처리
  * APPLY_SD :  PO_CONTRACT_FSALE 정보에서 가져옴, 데이타 이관시 고려해야 함... 
  
  
  3) 처리순서
  - 엑셀 업로드 시에 CHECK 사항
    가) 기본필수 입력 CHECK
    나) 창고, 업장 CHECK
    다) 계약정보 연계 여부
    라) D-DAYS, D-TIMES GET
    마) 구매수발주제한 CHECK, 식재수발주제한 CHECK
    바) 여신관련 잔액 CHECK    
   

*/
/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "U_lib::lib_conversionCom.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_processCnt = 0;			//처리건수
var fv_objColInfo;				//데이터셋 컬럼정보
var fv_closeFlag = "";			//닫기 버튼 클릭 시 작업여부를 CHECK 하여 Parent 창에서
var fv_dDays;					//구매유형_D-DAY
var fv_dTimes;					//구매유형-D-TIMES

// 엑셀업로드 관련 변수
var fv_excelRowCnt;				//현재대상 Row Count
var fv_excelRow;				//현재대상 Row Index
var fv_errorFlag;				//에러발생 여부(Y/N)
var fv_errorMsg;				//에러발생 메시지

// 저장 관련 변수
var fv_prNum = "";				//저장 시 주문신청번호를 미리 SET
var fv_approveNum = "";			//저장 시 신청승인번호를 미리 SET
var fv_prNumFlag = false;		//주문신청, 승인번호 SET 상태여부
var fv_saveRowCnt;				//저장대상 Row Count
var fv_saveRow;					//저장대상 Row Index
var fv_row;						//저장대상 ROW ID 

var fv_ret;						//트랜잭션 리턴 값 (E:오류)
var fv_retMsg;					//트랜잭션 리턴 메시지(오류시)
var fv_saveFlag = true;			//중복 저장 방지 상태 true(저장) false(저장불가)

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();

	// 구매유형 SET
	fn_searchType();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	// Argument Dataset으로 받기
 	try {
 		//trace("P_DATASET Dataset :\n" + P_DATASET.saveXML());
		ds_search.setColumn(0, "schType", P_DATASET.getColumn(0, "schType"));
		ds_search.setColumn(0, "schTypeNm", P_DATASET.getColumn(0, "schTypeNm"));
		ds_search.setColumn(0, "schSabun", P_DATASET.getColumn(0, "schSabun"));
		ds_search.setColumn(0, "schPrDate", P_DATASET.getColumn(0, "schPrDate"));
		ds_search.setColumn(0, "schNeedDate", P_DATASET.getColumn(0, "schNeedDate"));

		// 로그인정보 SET
		ds_search.setColumn(0, "schPrDeptId", g_Deptid);
		ds_search.setColumn(0, "schPrUpjang", g_Upjang);
		

		// 입고일선택
		cal_prDate.fn_initMonthCal(this, "", "", ds_search, "schPrDate", "Y");	
		cal_needDate.fn_initMonthCal(this, "", "", ds_search, "schNeedDate", "Y");	
		
		// 화면 제목 표시
		sta_title.text = ds_search.getColumn(ds_search.rowposition, "schType") + "." + ds_search.getColumn(ds_search.rowposition, "schTypeNm");

 	} catch(err) {
 	
 	}
 	btn_save.enable = false;
 	btn_delete.enable = false;
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close(retResult)
{	
    var retVal = new Array();
    retVal[0] = retResult;
    close(retVal);
}


/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 * 선택한 ROW 삭제
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{
	var nRowCnt = ds_list.getRowCount();	// DataSet Count
	var nRow = ds_list.rowposition;

	if(nRow == -1) 
	{
		gfn_alert("msg.err.grid.noselect", "삭제할 row");	// 선택된 항목이 없습니다.
		return;
	}
	
	
	// 해당 ROW를 삭제
	ds_list.deleteRow(nRow);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 * 저장 !!!!!!
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
	if(!fv_saveFlag){
		gfn_alert("엑셀파일을 재업로드 해주시기 바랍니다.");
		return;
	}
	
	var nRowCnt = ds_list.getRowCount();	// DataSet Count
	var iCnt = 0;
	var sMsg = "";

	// 오류상태의 행 또는 삭제된 행을 제외하고 ROW COUNT
	// 생성 CHECK 개수 
	for (var i = 0 ; i < nRowCnt ; i++)
	{
		// Dataset이 오류가 아닌 자료
		if (ds_list.getColumn(i, "error")!="Y")
		{
			if (ds_list.getRowType(i) <> Dataset.ROWTYPE_DELETE) {
				iCnt++;
			}
		}
	}
	
	// 저장할 자료 여부 CHECK
	if(iCnt == 0) 
	{
		gfn_alert("msg.save.nodata", "저장할 데이터");	// 저장할 데이터가 없습니다.
		return;
	}
	
	
	
	// 기본 CHECK 진행
	if (!fn_itemCheck()) return;
	
	sMsg = "주문신청내역를 저장합니다.\n\n계속 진행 하시겠습니까?\n";
	sMsg = sMsg + " - 오류가 없는 정상적인 자료에 대하여 저장합니다.\n";
	sMsg = sMsg + " ※ 여신관리여부에 따라 여신정보(잔액)을 체크합니다.";
	
	
	if (!gfn_confirm(sMsg, "", "C")) return;
	
	
	// KeySet : 주문신청번호, 신청승인번호 SET
	fn_searchPrNum(false);
	
	if (fv_prNumFlag==false) return;
	
	
	// Progress Bar 처리 
	fn_processSet();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
}


/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		if(strSvcID=="saveUpload")
		{
			fv_errorFlag="Y";
			fv_errorMsg = strErrorMsg;
			fn_processStep();
			return;
		}
		else 
		{
			return;
		}
	}

    
    switch(strSvcID)
    {
    
		// 구매유형조회
        case "searchType" :
            //trace(ds_type.saveXML());
            fn_type_init();
            break;
    
    
		// 업로드한 엑셀에 대한 기본정보를 SET
		case "searchUpload" :
            if (ds_listRow.getRowCount() == 0) {
				//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				gfn_loadDatasetInfo (ds_listRow, fv_objColInfo);
            }
			fv_errorFlag="";
			fv_errorMsg="";
			fn_processStepUpload();
			break;
			
		// 주문신청번호 및 승인번호를 미리 SET
		case "searchPrNum" :
			if ((fv_prNum == "") ||  (fv_approveNum == "")) {
				fv_prNumFlag = false;
				var sMsg = "신규 주문신청번호 설정 오류입니다.\r작업을 취소합니다.";
				gfn_alert(sMsg, "", "A");
			} else {
				fv_prNumFlag = true;
			}
			break;	
			
        // 저장
        case "saveUpload" :
			if (fv_processCnt > 0) {	
				fv_closeFlag = "OK";
				fv_errorFlag="";
				fv_errorMsg="";
			}
			//gfn_alert("msg.save.success");	// 저장 되었습니다.
			fn_processStep();
            break;  			
        case "saveGroup" :
			if(fv_errorFlag == "Y"){				//에러발생 여부(Y/N)
				gfn_alert(fv_errorMsg);
				fv_errorFlag = "";
			}else{
				gfn_alert("msg.action.success");	// 처리 되었습니다.
			}
			fv_saveFlag = false;//저장후 다시 저장 불가.
			btn_save.enable = fv_saveFlag;
			btn_delete.enable = fv_saveFlag;
			break;
    }
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 구매유형정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchType()
{
    var strSvcID    = "searchType";
    var strURL      = "fm/fmo/orderRequest/selectType.xdo";
    var strInDs     = "";
    var strOutDs    = "ds_type=ds_type";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 구매유형 DataSet 초기화 
 *---------------------------------------------------------------------------------------------*/
function fn_type_init()
{
	var v_poType = ds_search.getColumn(ds_search.rowposition, "schType");
	
	// 조건의 구매유형만 선택되게
	var nRow = ds_type.findRowExpr("poType=='" + v_poType + "'");
	
	fv_dDays = ds_type.getColumn(nRow, "dDays");
	fv_dTimes = ds_type.getColumn(nRow, "dTimes");
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 주문신청번호, 신청승인번호를 미리 SET
 *---------------------------------------------------------------------------------------------*/
function fn_searchPrNum(bAsync)
{
    var strSvcID    = "searchPrNum";
    var strURL      = "fm/fmo/orderRequest/selectPrNum.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    //var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 엑셀 버튼 클릭 시
 *---------------------------------------------------------------------------------------------*/
function fn_excel()
{
	// 파일 선택
	var strFileName = gfn_excelFileDialog("LOAD", "EXCEL");

	if (strFileName.length == 0)
	{
		this.setWaitCursor(false);
		return;
	}

	// 오류 Dataset Clear
	ds_listErr.clearData();

	fv_saveFlag = false;
	btn_save.enable = fv_saveFlag;
	btn_delete.enable = fv_saveFlag;	

	this.setWaitCursor(true);
	
	/*********************************************************************************************
	** argument             : strFileName		파일명 (경로 포함)
	**                        strDsName			Import 대상 Dataset Name
	**                        nStartRow			Import 시작 행(사용된 Range 기준, 1 base)
	**						  bKeepColInfo		Dataset의 컬럼 정보를 유지할지 여부
	*********************************************************************************************/
	var rtn = gfn_importExcel(strFileName, "ds_upload", 1, true);
	
	this.setWaitCursor(false);

	if (ds_upload.getRowCount()>0) {
		// 엑셀업로드 DataSet 처리
		fn_processSetUpload();
	}
	else {
		gfn_alert("msg.err.grid.nodata");	// 데이타가 없습니다
	}

}

/*----------------------------------------------------------------------------------------------
 * 설명      : Progress Bar 초기화
 *---------------------------------------------------------------------------------------------*/
function fn_processInit()
{
	pbr_status.text = "엑셀 업로드 진행작업";
	pbr_status.pos = 0;
}


/*----------------------------------------------------------------------------------------------
 * 설명      : Progress Bar - 엑셀업로드 용
 *---------------------------------------------------------------------------------------------*/
function fn_processSetUpload()
{
	var iCnt = 0;

	ds_excel.clearData();

	// 엑셀업로드용 DataSet Filter : 창고코드, 발주일, 입고일, 자재코드 값이 없으면 삭제 
	for (var i = 0 ; i < ds_upload.getRowCount() ; i++)
	{
		if (!(gfn_nvl(ds_upload.getColumn(i, "subinvCode"), "") == "") && 
		   (!gfn_nvl(ds_upload.getColumn(i, "itemCode"), "") == "") )
		{
			// Null 처리
			if (gfn_nvl(ds_upload.getColumn(i, "prDate"), "") == "") ds_upload.setColumn(i, "prDate", "");
			if (gfn_nvl(ds_upload.getColumn(i, "needDate"), "") == "") ds_upload.setColumn(i, "needDate", "");
			if (gfn_nvl(ds_upload.getColumn(i, "itemName"), "") == "") ds_upload.setColumn(i, "itemName", "");
			if (gfn_nvl(ds_upload.getColumn(i, "itemSize"), "") == "") ds_upload.setColumn(i, "itemSize", "");
			if (gfn_nvl(ds_upload.getColumn(i, "itemUnit"), "") == "") ds_upload.setColumn(i, "itemUnit", "");
			if (gfn_nvl(ds_upload.getColumn(i, "prRemark"), "") == "") ds_upload.setColumn(i, "prRemark", "");
		
			// 결과를 ds_excel로 복사
			ds_excel.addRow();
			iRow = ds_excel.rowposition;
			ds_excel.copyRow(iRow, ds_upload, i);
			// 조회조건의 신청일자, 입고일자를 엑셀내역에 SET
			ds_excel.setColumn(iRow, "prDate", ds_search.getColumn(ds_search.rowposition, "schPrDate"));
			ds_excel.setColumn(iRow, "needDate", ds_search.getColumn(ds_search.rowposition, "schNeedDate"));
		}
	}
	
	var nRowCnt = ds_excel.getRowCount();	// 엑셀 DataSet Count


	// 표시할 Dataset Clear
	ds_list.clearData();

	// 생성 대상 ROW
	fv_excelRowCnt = nRowCnt;

	trace("fv_excelRowCnt : " + fv_excelRowCnt);

	if(fv_excelRowCnt>0)
	{
		// progress bar 초기 set
		pbr_status.max = fv_excelRowCnt;
		pbr_status.step = 1;
	
		// 최초 process 실행 호출
		fv_excelRow = 0;
		fn_processUpload(fv_excelRow);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명    : 주문상세정보 조회 로직 처리, 1 Row 씩 처리
 * arg : 처리 Index(row id)
 *---------------------------------------------------------------------------------------------*/
function fn_processUpload(arg)
{
	var retFlag;

	// 최초 실행 시 첫번째 Row
	if (arg=="") arg = 0;

	// 선택 Row 가 최대 Row보다 클 경우 종료
	if ((arg+1) > fv_excelRowCnt) {
		gfn_alert("msg.action.success");	// 처리 되었습니다.
		fv_saveFlag = true;
		btn_save.enable = fv_saveFlag;
		btn_delete.enable = fv_saveFlag;		
		return;
	}

	// 초기화
	fv_errorFlag="";
	fv_errorMsg="";
	

	// 기본필수 입력 CHECK
	retFlag = fn_excelCheck(arg);
	
	trace("arg : " + arg + ",retFlag : " + retFlag);
	
	

	// CHECK 오류가 없으면 Transaction 실행
	if (retFlag) {
	
		// Transaction 처리
		var strSvcID    = "searchUpload";
		var strURL      = "fm/fmo/orderRequest/selectUpload.xdo";
		var strInDs     = "ds_excelRow=ds_excelRow:A";
		var strOutDs    = "ds_listRow=ds_listRow";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	
	} else {
		// Transaction 없이 CallBack 함수 호출
		fn_processStepUpload();
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명     : 엑셀 업로드 필수입력 체크 함수
 * 파라미터 : 선택된 행
 *---------------------------------------------------------------------------------------------*/
function fn_excelCheck(arg)
{
	// 창고코드, 발주일자, 입고일자, 자재코드, 수량 CHECK 
	if (gfn_nvl(ds_excel.getColumn(arg, "subinvCode"), "")=="") {
		fv_errorFlag = "Y";
		fv_errorMsg = "창고코드 누락";
	}  
	if (!gfn_isDate(ds_excel.getColumn(arg, "prDate"))) {
		if (fv_errorFlag == "Y") fv_errorMsg = fv_errorMsg + ",";
		fv_errorFlag = "Y";
		fv_errorMsg = fv_errorMsg + "발주일자 누락 또는 오류";
	} 
	if (!gfn_isDate(ds_excel.getColumn(arg, "needDate"))) {
		if (fv_errorFlag == "Y") fv_errorMsg = fv_errorMsg + ",";
		fv_errorFlag = "Y";
		fv_errorMsg = fv_errorMsg + "입고일자 누락 또는 오류";
	} 
	if (gfn_nvl(ds_excel.getColumn(arg, "itemCode"), "")=="") {
		if (fv_errorFlag == "Y") fv_errorMsg = fv_errorMsg + ",";
		fv_errorFlag = "Y";
		fv_errorMsg = fv_errorMsg + "자재코드 누락";
	} 
	if (!gfn_isNum(ds_excel.getColumn(arg, "prQty"))) {
		if (fv_errorFlag == "Y") fv_errorMsg = fv_errorMsg + ",";
		fv_errorFlag = "Y";
		fv_errorMsg = fv_errorMsg + "신청수량 누락 및 오류";
	}

	// 에러 발생시 현재 엑셀의 Dataset을 ds_list로 복사 : 오류상태 표시
	if (fv_errorFlag=="Y") {
		var iIdx = ds_listErr.addRow();
		
		ds_listErr.setColumn(iIdx, "subinvCode", gfn_nvl(ds_excel.getColumn(arg, "subinvCode").toUpperCase(),""));
		ds_listErr.setColumn(iIdx, "prDate", gfn_nvl(ds_excel.getColumn(arg, "prDate"),""));
		ds_listErr.setColumn(iIdx, "needDate", gfn_nvl(ds_excel.getColumn(arg, "needDate"),""));
		ds_listErr.setColumn(iIdx, "itemCode", gfn_nvl(ds_excel.getColumn(arg, "itemCode").toUpperCase(),""));
		ds_listErr.setColumn(iIdx, "itemName", gfn_nvl(ds_excel.getColumn(arg, "itemName"),""));
		ds_listErr.setColumn(iIdx, "itemSize", gfn_nvl(ds_excel.getColumn(arg, "itemSize"),""));
		ds_listErr.setColumn(iIdx, "itemUnit", gfn_nvl(ds_excel.getColumn(arg, "itemUnit").toUpperCase(),""));
		ds_listErr.setColumn(iIdx, "prQty", ds_excel.getColumn(arg, "prQty"));
		ds_listErr.setColumn(iIdx, "prRemark", gfn_nvl(ds_excel.getColumn(arg, "prRemark"),""));
		ds_listErr.setColumn(iIdx, "error", "Y"); 
		ds_listErr.setColumn(iIdx, "msg", fv_errorMsg);
		return false;
	} else {
	// 에러가 없으면 Transaction을 위한 조건DataSet을 생성한다
		ds_excelRow.clearData();
		var iIdx = ds_excelRow.addRow();
		ds_excelRow.setColumn(iIdx, "subinvCode", gfn_nvl(ds_excel.getColumn(arg, "subinvCode").toUpperCase(),""));
		ds_excelRow.setColumn(iIdx, "prDate", gfn_nvl(ds_excel.getColumn(arg, "prDate"),""));
		ds_excelRow.setColumn(iIdx, "needDate", gfn_nvl(ds_excel.getColumn(arg, "needDate"),""));
		ds_excelRow.setColumn(iIdx, "itemCode", gfn_nvl(ds_excel.getColumn(arg, "itemCode").toUpperCase(),""));
		ds_excelRow.setColumn(iIdx, "itemName", gfn_nvl(ds_excel.getColumn(arg, "itemName"),""));
		ds_excelRow.setColumn(iIdx, "itemSize", gfn_nvl(ds_excel.getColumn(arg, "itemSize"),""));
		ds_excelRow.setColumn(iIdx, "itemUnit", gfn_nvl(ds_excel.getColumn(arg, "itemUnit").toUpperCase(),""));
		ds_excelRow.setColumn(iIdx, "prQty", ds_excel.getColumn(arg, "prQty"));
		ds_excelRow.setColumn(iIdx, "prRemark", gfn_nvl(ds_excel.getColumn(arg, "prRemark"),""));
	}

	return true;
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 엑셀업로드 Callback 후 작업진행 여부 CHECK 및 프로세스 호출
 *---------------------------------------------------------------------------------------------*/
function fn_processStepUpload()
{
	// Transaction을 처리한 자료
	trace("fv_errorFlag : " + fv_errorFlag);
	if (fv_errorFlag=="") {
		if (ds_listRow.getRowCount() > 0) {
			// 결과를 ds_list로 복사
			ds_list.addRow();
			iRow = ds_list.rowposition;
			ds_list.copyRow(iRow, ds_listRow, 0);
			// Error 체크
			fn_errorFlag(iRow);		
		}
	}


	// 해당 ROW POSITION 위치 : 최종 ROW
	ds_list.rowposition = ds_list.getRowCount() - 1;


	// Progress Bar SET
	pbr_status.text = "엑셀 업로드 진행작업  ("+(fv_excelRow+1)+"/"+ fv_excelRowCnt+")";
	pbr_status.pos = fv_excelRow+1;
	pbr_status.stepIt();
	this.updateWindow(); // 이 부분 추가
	//trace("iRow : " + iRow);

	//다음 Transaction 처리 실행
	fv_excelRow++;
		
	//trace("fv_excelRow : " + fv_excelRow); 
	fn_processUpload(fv_excelRow);
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 엑셀업로드 Dataset에 대한 error flag 표시
 * Dataset Copy 진행 시 호출
 *---------------------------------------------------------------------------------------------*/
function fn_errorFlag(row)
{
	// 오류 검증용 CHECK 필드
	var v_cenFlag = ds_list.getColumn(row, "cenFlag");
	var v_subFlag = ds_list.getColumn(row, "subFlag");
	var v_subInfoFlag = ds_list.getColumn(row, "subInfoFlag");
	var v_itemFlag = ds_list.getColumn(row, "itemFlag");
	var v_cusFlag = ds_list.getColumn(row, "cusFlag");
	var v_poCnt = ds_list.getColumn(row, "poCnt");
	var v_poStatus = ds_list.getColumn(row, "poStatus");
	var v_poMsg = ds_list.getColumn(row, "poMsg");
	var v_fmpStatus = ds_list.getColumn(row, "fmpStatus");
	var v_rcUpjang = gfn_nvl(ds_list.getColumn(row, "rcUpjang"), "");
	var v_poNoStatus = ds_list.getColumn(row, "poNoStatus");

	var v_error = ""; 
	var v_msg = "";
	
	if (v_cenFlag=="E") {
		v_error = "Y";
		v_msg = "센터정보 오류";		
	} 
	if (v_subFlag=="E") {
		if (v_error=="Y") v_msg = v_msg + ",";
		v_error = "Y";
		v_msg = v_msg + "창고정보 오류";		
	} 
	if (v_subFlag!="E") {
		if (v_subInfoFlag == "E1") {
			if (v_error=="Y") v_msg = v_msg + ",";
			v_error = "Y";
			v_msg = v_msg + "예산통제부서 오류";		
		}
		if (v_subInfoFlag == "E2") {
			if (v_error=="Y") v_msg = v_msg + ",";
			v_error = "Y";
			v_msg = v_msg + "입고계정 오류";		
		}
	} 
	if (v_itemFlag=="E") {
		if (v_error=="Y") v_msg = v_msg + ",";
		v_error = "Y";
		v_msg = v_msg + "자재정보 오류";		
	} 
	// 업장정보 오류
 	if (v_rcUpjang=="") {
 		if (v_error=="Y") v_msg = v_msg + ",";
 		v_error = "Y";
 		v_msg = v_msg + "업장정보 오류";		
 	} 
	
	// 납품업체 정보는 PO_CONTRACT_F 에 현재 테스트할 식재업장이 X
	
 	if (v_cusFlag=="E") {
 		if (v_error=="Y") v_msg = v_msg + ",";
 		v_error = "Y";
 		v_msg = v_msg + "업체정보 오류";		
 	} 
	if (v_poCnt=="" || v_poCnt=="0") {
		if (v_error=="Y") v_msg = v_msg + ",";
		v_error = "Y";
		v_msg = v_msg + "식재 판매단가 오류";		
	} 
	
	if (v_poStatus!="HK") {
		if (v_error=="Y") v_msg = v_msg + ",";
		v_error = "Y";
		v_msg = v_msg + "구매수발주 제한";
	} 
	
	if (v_fmpStatus!="N") {
		if (v_error=="Y") v_msg = v_msg + ",";
		v_error = "Y";
		v_msg = v_msg + "식재수발주 제한";		
	}
	if (v_poNoStatus!="N") {
		if (v_error=="Y") v_msg = v_msg + ",";
		v_error = "Y";
		v_msg = v_msg + "구매 매입단가 오류";
	}
	

	// 값 SET
	ds_list.setColumn(row, "error", v_error);
	ds_list.setColumn(row, "msg", v_msg);
	ds_list.setColumn(row, "poStatus", v_poStatus);		// 구매상세 오류 메시지 표시
	
	// 자재별 CHECK
	fn_itemErrorCheck(row);
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 엑셀업로드 Dataset에 대한 error flag 표시
 * Dataset Copy 진행 시 호출
 *---------------------------------------------------------------------------------------------*/
function fn_itemErrorCheck(row)
{
	// 입고예정일
	var sNeedDate = ds_list.getColumn(row, "needDate");		// 선택한 구매신청건의 입고일자
	
	var v_error = ""; 
	var v_msg = "";
	
	// 0. 구매유형에 대한 입고일자 통제
	if (fn_getDayStatus(fv_dDays, fv_dTimes, sNeedDate) == "0")
	{
		v_error = "Y";
		v_msg = "입고일자 통제";		
	}
	// 1.주문통제요일 CHECK
	if (ds_list.getColumn(row, "ordFlag")=="Y") 
	{
		if (v_error=="Y") v_msg = v_msg + ",";
		v_error = "Y";
		v_msg = v_msg + "주문불가 요일("+gfn_getDayName(ds_list.getColumn(row, "needDate"))+")";		
	}
	// 2.주문통제일자 CHECK
	if (ds_list.getColumn(row, "ordDaysFlag")=="Y") 
	{
		if (v_error=="Y") v_msg = v_msg + ",";
		v_error = "Y";
		v_msg = v_msg + "입고불가 일자";		
	}
	// 3.자재별 주문통제 CHECK
	if ( gfn_nvl(ds_list.getColumn(row,"dDays"), "0")!= "0" ) 
	{
		// D-DAY, D_TIME CHECK
		//if (fn_getDayStatus(ds_list.getColumn(row,"dDays"), ds_list.getColumn(row,"dTimes"), ds_list.getColumn(row,"needDate")) == "0")
		//{
		//	if (v_error=="Y") v_msg = v_msg + ",";
		//v_error = "Y";
			//v_msg = v_msg + "마감시간 초과(D-DAY)";		
		//}
	}
	// 4.(-)주문에 대한 CHECK
	if ( toNumber(ds_list.getColumn(row,"prQty")) < 0 )
	{
		if (v_error=="Y") v_msg = v_msg + ",";
		v_error = "Y";
		v_msg = v_msg + "(-)발주불가";		
	}
	/*
	// 5.최소발주량 체크
	if ( (toNumber(ds_list.getColumn(row,"minOrdQty")) > 0) && (toNumber(ds_list.getColumn(row,"minOrdQty")) > toNumber(ds_list.getColumn(row,"prQty"))) )
	{
		if (v_error=="Y") v_msg = v_msg + ",";
		v_error = "Y";
		v_msg = v_msg + "최소발주량("+ds_list.getColumn(row,"minOrdQty")+")";		
	}
	*/
	// 6.최대발주량 체크
	if ( (toNumber(ds_list.getColumn(row,"maxOrdQty")) > 0) && (toNumber(ds_list.getColumn(row,"maxOrdQty")) < toNumber(ds_list.getColumn(row,"prQty"))) )
	{
		if (v_error=="Y") v_msg = v_msg + ",";
		v_error = "Y";
		v_msg = v_msg + "최대발주량("+ds_list.getColumn(row,"maxOrdQty")+")";		
	}
	// 7.소숫점발주여부
	/* 2015-10-02
	if ( (ds_list.getColumn(row,"pointFlag") != "Y") && (Math.ceil(toNumber(ds_list.getColumn(row,"prQty"))) != toNumber(ds_list.getColumn(row,"prQty"))) )
	{
		if (v_error=="Y") v_msg = v_msg + ",";
		v_error = "Y";
		v_msg = v_msg + "소숫점발주 불가";
	}
	*/
	// 8.발주승수량
	/*	2015-09-21 제거
	if ( (toNumber(ds_list.getColumn(row,"multiplierQty")) > 0) && ((Math.round(toNumber(ds_list.getColumn(row,"prQty")) * 1000) % Math.round(toNumber(ds_list.getColumn(row,"multiplierQty")) * 1000)) <> 0) )
	{
		if (v_error=="Y") v_msg = v_msg + ",";
		v_error = "Y";
		v_msg = v_msg + "발주승수량("+ds_list.getColumn(row,"multiplierQty")+")";
	}
	*/

	// 값 SET
	if (v_error=="Y" || ds_list.getColumn(row,"error") == "Y") {
		//ds_list.setColumn(row, "error", v_error);
		ds_list.setColumn(row, "msg2", v_msg);
		
		var nRow = ds_listErr.addRow();
		ds_listErr.copyRow(nRow,ds_list,row);
		ds_list.deleteRow(row);
	}
}



/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 시 필수조건 CHECK  ===> 사용 X
 * 주문통제 및 자재별 필수 CHECK
 * 엑셀업로드 이후 정상적인 자료 기준으로 CHECK
 *---------------------------------------------------------------------------------------------*/
function fn_itemCheck()
{
	var nRowCnt = ds_list.getRowCount();	// DataSet Count
	var v_itemCode = "";
	var sMsg = "";

	for (var i = 0 ; i < nRowCnt ; i++)
	{
		// 업로드 시 에러가 발생한 자료는 제외
		if (ds_list.getColumn(i, "error")=="Y") continue;

		// 입고예정일
		var sNeedDate = ds_list.getColumn(i, "needDate");		// 선택한 구매신청건의 입고일자

		/*
		// 0. 구매유형에 대한 입고일자 통제
		if (fn_getDayStatus(fv_dDays, fv_dTimes, sNeedDate) == "0")
		{
			var sDate = gds_currdate.getColumn(0, "YMD_TM");
			sDate = gfn_getFormat(sDate, "@@@@-@@-@@") + " " + gfn_getFormat(gfn_subStr(sDate, 8, 6), "@@:@@:@@");
		
			ds_list.rowposition = i;
			sMsg = "▶현재시간 : " + sDate + "\n\n";
			sMsg = sMsg + ds_search(ds_search.rowposition, "schTypeNm") + " 구매유형 입고일 기준\n";
			sMsg = sMsg + " => (D_DAY = " + fv_dDays + "일" + fv_dTimes + "시)\n"
			sMsg = sMsg + "※ 입고일이 " + gfn_getFormat(NeedDate,"@@@@-@@-@@") + " 이전 날짜로는\n";
			sMsg = sMsg + "  구매신청을 할 수 없습니다.";
			gfn_alert(sMsg, "", "A");
			return false;
		}

		*/
		
		// 1.입고통제요일 CHECK
		if (ds_list.getColumn(i, "ordFlag")=="Y") 
		{
			ds_list.rowposition = i;
			sMsg = "해당 업장의 " + gfn_getDayName(ds_list.getColumn(i, "needDate")) + "요일은 입고불가 요일입니다.\r입고일자를 변경하세요.";
			gfn_alert(sMsg, "", "A");
			return false;
		}
		
		// 2.주문통제일자 CHECK
		if (ds_list.getColumn(i, "ordDaysFlag")=="Y") 
		{
			ds_list.rowposition = i;
			sMsg = "해당 업장의 " + gfn_getFormat(ds_list.getColumn(i, "needDate"), "@@@@-@@-@@") + "일은 입고불가 일자입니다.\r입고일자를 변경하세요.";
			gfn_alert(sMsg, "", "A");
			return false;
		}

		// 3.자재별 주문통제 CHECK
		if ( gfn_nvl(ds_list.getColumn(i,"dDays"), "0")!= "0" ) 
		{
			/*
			// D-DAY, D_TIME CHECK
			if (fn_getDayStatus(ds_list.getColumn(i,"dDays"), ds_list.getColumn(i,"dTimes"), ds_list.getColumn(i,"needDate")) == "0")
			{
				ds_list.rowposition = i;
				sMsg = "[" + ds_list.getColumn(i,"itemName") + "] 자재는 마감시간(D-Days)을 초과하여 주문이 불가합니다.";
				sMsg = sMsg + " - 창고 : (" + ds_list.getColumn(i,"subinvCode") + ")" + ds_list.getColumn(i,"subinvName") + "\n";
				sMsg = sMsg + " - 자재 : (" + ds_list.getColumn(i,"itemCode") + ")" + ds_list.getColumn(i,"itemName") + "\n";
				sMsg = sMsg + " - 입고일 : " + gfn_getFormat(ds_list.getColumn(i,"needDate"), "@@@@-@@-@@") + "\n";
				sMsg = sMsg + " - D-DAY : " + ds_list.getColumn(i,"dDays") + ", D-TIME : " + ds_list.getColumn(i,"dDays") + "\n";
				gfn_alert(sMsg, "", "A");
				return false;
			}
			*/
		}
		
		// 4.(-)주문에 대한 CHECK
		if ( toNumber(ds_list.getColumn(i,"prQty")) < 0 )
		{
			ds_list.rowposition = i;
			sMsg = "(-)발주는 불가합니다.";
  			sMsg = sMsg + " - 창고 : (" + ds_list.getColumn(i,"subinvCode") + ")" + ds_list.getColumn(i,"subinvName") + "\n";
  			sMsg = sMsg + " - 자재 : (" + ds_list.getColumn(i,"itemCode") + ")" + ds_list.getColumn(i,"itemName") + "\n";
			gfn_alert(sMsg, "", "A");
			return false;
		}
		/*
  		// 5.최소발주량 체크
  		if ( (toNumber(ds_list.getColumn(i,"minOrdQty")) > 0) && (toNumber(ds_list.getColumn(i,"minOrdQty")) > toNumber(ds_list.getColumn(i,"prQty"))) )
  		{
  			ds_list.rowposition = i;
  			sMsg = "해당 자재는 최소발주량이 " + ds_list.getColumn(i,"minOrdQty") + " 입니다.";
  			sMsg = sMsg + " - 창고 : (" + ds_list.getColumn(i,"subinvCode") + ")" + ds_list.getColumn(i,"subinvName") + "\n";
  			sMsg = sMsg + " - 자재 : (" + ds_list.getColumn(i,"itemCode") + ")" + ds_list.getColumn(i,"itemName") + "\n";
  			gfn_alert(sMsg, "", "A");
  			return false;
  		}
		*/
		// 6.최대발주량 체크
		if ( (toNumber(ds_list.getColumn(i,"maxOrdQty")) > 0) && (toNumber(ds_list.getColumn(i,"maxOrdQty")) < toNumber(ds_list.getColumn(i,"prQty"))) )
		{
			ds_list.rowposition = i;
			sMsg = "해당 자재는 최대발주량이 " + ds_list.getColumn(i,"maxOrdQty") + " 입니다.";
			gfn_alert(sMsg, "", "A");
			return false;
		}
		// 7.소숫점발주여부
		/*	2015-10-02 제거
		if ( (ds_list.getColumn(i,"pointFlag") != "Y") && (Math.ceil(toNumber(ds_list.getColumn(i,"prQty"))) != toNumber(ds_list.getColumn(i,"prQty"))) )
		{
			ds_list.rowposition = i;
			sMsg = "해당 자재는 소숫점 발주가 불가합니다.";
			gfn_alert(sMsg, "", "A");
			return false;
		}
		*/
		// 8.발주승수량
		/*	2015-09-21 제거
		if ( (toNumber(ds_list.getColumn(i,"multiplierQty")) > 0) && ((Math.round(toNumber(ds_list.getColumn(i,"prQty")) * 1000) % Math.round(toNumber(ds_list.getColumn(i,"multiplierQty")) * 1000)) <> 0) )
		{
			ds_list.rowposition = i;
			sMsg = "해당 자재는 발주승수량이 " + ds_list.getColumn(i,"multiplierQty") + " 입니다.";
			gfn_alert(sMsg, "", "A");
			return false;
		}
		*/
		
	}

	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 구매유형별 D-DAY CHECK FUNCTION
 * D_TIMES(PO_TYPE 관련)은 2자리인 경우 뒤에 "00"을 붙인다
 *---------------------------------------------------------------------------------------------*/
function fn_getDayStatus(nDdays, nDtimes, sNeedDate)
{
	fsp_init(this);			// 고도화관련 Frame 관련 SET
	fn_CurrDateWeek();

	if (gfn_length(nDtimes)==2) nDtimes = nDtimes + "00";

	//trace("nDtimes : " + nDtimes);
	//trace("YMD_TM : " + gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4));

	//trace("nDdays : " + nDdays);
	
	// 무통제면 패스...
	if (gfn_nvl(nDdays, "0")== "0" ) return "2";
	// 디데이체크
	if (gfn_addDate(gds_currdate.getColumn(0,"YMD"),nDdays) > sNeedDate )
		return "0";
	else if ( gfn_addDate(gds_currdate.getColumn(0,"YMD"),nDdays) == sNeedDate )
	{
		// 디타임체크
		if ( gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4)> nDtimes )
			return "0";
		else if ( G_fn_GapTime(0, gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4), nDtimes, "") <= "0030" )
			return "1";
		else
			return "2";
	}
	else
		return "2";
}

/*----------------------------------------------------------------------------------------------
 * 설명      : Progress Bar - 저장 용
 *---------------------------------------------------------------------------------------------*/
function fn_processSet()
{
	var nRowCnt = ds_list.getRowCount();	// DataSet Count
	var iCnt = 0;
	var iRow = 0;

	// 저장할 Dataset Clear
	ds_save.clearData();

	// 저장 대상 개수 
	for (var i = 0 ; i < nRowCnt ; i++)
	{
		// 업로드 시 오류가 아닌 자료만 처리
		if (ds_list.getColumn(i, "error")!="Y")
		{
			// 삭제된 행은 제외
			if (ds_list.getRowType(i) <> Dataset.ROWTYPE_DELETE) {
		
				iCnt++;
				
				// 결과를 ds_list로 복사
				ds_save.addRow();
				iRow = ds_save.rowposition;
				ds_save.copyRow(iRow, ds_list, i);			
				
				// Key값 SET
				ds_save.setColumn(iRow, "prNum", fv_prNum);
				ds_save.setColumn(iRow, "approveNum", fv_approveNum);
				
				// 조건 Dataset 관련 처리
				ds_save.setColumn(iRow, "poType", ds_search.getColumn(ds_search.rowposition, "schType"));
				ds_save.setColumn(iRow, "prDeptId", ds_search.getColumn(ds_search.rowposition, "schPrDeptId"));
				ds_save.setColumn(iRow, "prUpjang", ds_search.getColumn(ds_search.rowposition, "schPrUpjang"));
				
				// transaction 처리 후 ds_list의 row 위치를 지정
				ds_save.setColumn(iRow, "oldRow", i);
			}
		}
	}

	// 저장 대상 ROW
	fv_saveRowCnt = iCnt;

	//trace("fv_saveRowCnt : " + fv_saveRowCnt);

	if(fv_saveRowCnt>0)
	{
		// progress bar 초기 set
		pbr_status.max = fv_saveRowCnt;
		pbr_status.step = 1;
	
		// 최초 process 실행 호출
		fv_saveRow = 0;
		fn_process(fv_saveRow);
	}

}


/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 로직 처리, 1 Row 씩 처리
 * arg : 처리 Index(row id)
 *---------------------------------------------------------------------------------------------*/
function fn_process(arg)
{
	// 최초 실행 시 첫번째 Row
	if (arg=="") arg = 0;

	// 선택 Row 가 최대 Row보다 클 경우 종료
	if ((arg+1) > fv_saveRowCnt) {
		fn_saveGroup();
		return;
	}
	
	// saveRow Dataset Clear
	ds_saveRow.clearData();
	
	// saveRow Dataset 에 복사 
	var iIdx = ds_saveRow.addRow();
	
	ds_saveRow.copyRow(iIdx, ds_save, arg);		
	// Find Row Value 지정	
	fv_row = ds_save.getColumn(arg, "oldRow");	
	// 
	
	// Transaction 처리
	var strSvcID    = "saveUpload";
	var strURL      = "fm/fmo/orderRequest/saveUpload.xdo";
	var strInDs     = "ds_saveRow=ds_saveRow:A";
	var strOutDs    = "";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 로직 처리, 1 Row 씩 처리
 * arg : 처리 Index(row id)
 *---------------------------------------------------------------------------------------------*/
function fn_saveGroup()
{
	// Transaction 처리
	var strSvcID    = "saveGroup";
	var strURL      = "fm/fmo/orderRequest/saveGroup.xdo";
	var strInDs     = "ds_saveRow=ds_saveRow:A";
	var strOutDs    = "";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : Callback 후 작업진행 여부 CHECK 및 프로세스 호출
 *---------------------------------------------------------------------------------------------*/
function fn_processStep()
{
	if(fv_errorFlag=="Y")
	{
		// ERROR 발생 시 결과 표시 후 중단
		fn_error();
		// 해당 ROW POSITION 위치 : 오류발생 ROW
		ds_list.rowposition = fv_row;
		return;
	}

	// ds_list 검색
	//var nRow = ds_save.findRowExpr("oldRow=="+fv_row);
	
	var msg = "";
	
	//trace("fv_errorFlag : " + fv_errorFlag);

	// 에러가 발생하지 않은 경우에 표시

	if (fv_errorFlag != "Y")
	{
		// 여신관련 CHECK 오류
		if (fv_ret == "E") {
			ds_list.setColumn(fv_row, "error", "Y");
			ds_list.setColumn(fv_row, "msg", fv_retMsg);		// 오류메시지 표시
		} else {
			ds_list.setColumn(fv_row, "error", "");
			ds_list.setColumn(fv_row, "msg", fv_retMsg);		
		}
	}
	
	// 해당 ROW POSITION 위치 : 최종 ROW
	ds_list.rowposition = fv_row;
	
	
	// Progress Bar SET
	pbr_status.text = "주문신청 진행작업 ("+(fv_saveRow+1)+"/"+ fv_saveRowCnt+")";
	
	
	pbr_status.pos = fv_saveRow+1;
	pbr_status.stepIt();
	this.updateWindow(); // 이 부분 추가
	//trace("iRow : " + iRow);

	//다음 Transaction 처리 실행
	fv_saveRow++;
		

	fn_process(fv_saveRow);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 시스템오류 발생 시 오류메시지 저장
 *---------------------------------------------------------------------------------------------*/
function fn_error()
{
	trace("작업종료");
	//Error 메시지 출력
 	var msg = "주문신청 시 오류발생";
	ds_list.setColumn(fv_row, "error", "Y");
	ds_list.setColumn(fv_row, "msg", msg);				// 오류메시지 표시
	ds_list.setColumn(fv_row, "msg2", fv_errorMsg);		// 오류메시지 표시
	
	// 에러표시 후 작업중단 창 표시
	var sMsg = "주문신청 시 오류가 발생했습니다.\n\n";
	sMsg = sMsg + "※ 기 진행중인 신청자료는 모두 취소됩니다.\n";
	sMsg = sMsg + "  오류 메시지를 확인한 후 재 작업하세요";
	gfn_alert(sMsg, "", "A");
}


/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 닫기버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_close_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_close(fv_closeFlag);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 엑셀템플릿 버튼 클릭 이벤트 - 엑셀 업로드용 export
 *---------------------------------------------------------------------------------------------*/
function btn_template_onclick(obj:Button,  e:ClickEventInfo)
{
	grd_list2.setFormat("down")
	gfn_exportExcel(grd_list2); 
}


function Button00_onclick(obj:Button,  e:ClickEventInfo)
{
	//grd_list2.binddataset = ds_list;
	//grd_list.binddataset = ds_sample;
	grd_list.setFormat("down")
	gfn_exportExcel(grd_list);
	grd_list.setFormat("default")
}

/*----------------------------------------------------------------------------------------------
 * 설명      : Grid Header Click시 이벤트
 *              Merge Head 기준으로 재정의
 *---------------------------------------------------------------------------------------------*/
function grd_list_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	var nCell = e.cell;   

	//엑셀 CLASS 
	if(obj.getCellProperty("Head" ,nCell ,"class") == "head_Excel")
	{
		grd_list.setFormat("down")
		gfn_exportExcel(grd_list);
		grd_list.setFormat("default")
	} else gfn_gridSort(obj, e);	
}


]]></Script>
  </Form>
</FDL>

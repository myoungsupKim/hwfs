<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="WorkForm" onkeydown="fn_form_OnKeyDown" onload="form_onload" titletext="전도금 정산관리" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static21" class="sta_WFDA_Labelbg" position="absolute 0 331 1237 358"/>
        <Static id="Static19" class="sta_WFDA_Labelbg" position="absolute 0 305 1237 332"/>
        <Static id="Static18" class="sta_WFDA_Labelbg" position="absolute 0 279 1237 306"/>
        <Static id="Static17" class="sta_WFDA_Labelbg" position="absolute 0 253 1237 280"/>
        <Static id="Static15" class="sta_WFDA_Labelbg" position="absolute 0 216 1237 243"/>
        <Static id="Static14" class="sta_WFDA_Labelbg" position="absolute 0 190 1237 217"/>
        <Static id="Static13" class="sta_WFDA_Labelbg" position="absolute 0 164 1237 191"/>
        <Static id="Static12" class="sta_WFDA_Labelbg" position="absolute 0 138 1237 165"/>
        <Static id="Static11" class="sta_WFDA_Labelbg" position="absolute 622 86 1237 139"/>
        <Static id="Static01" class="sta_WFDA_Labelbg" position="absolute 0 112 623 139"/>
        <Static id="Static10" class="sta_WFDA_Labelbg" position="absolute 0 86 623 113"/>
        <Div id="div_cmnBtn" taborder="1" text="Div0" url="cmn::CmnBtn.xfdl" position="absolute 0 0 1237 30" anchor="left top right" scrollbars="none"/>
        <Static id="st_Back1" position="absolute 0 30 1237 71" class="sta_WFSA_Labelbg" anchor="left top right"/>
        <Static id="st_UPJANGQuery" text="업  장" userdata="strMAQuery_Upjang" position="absolute 15 40 74 61" class="sta_WFSA_label"/>
        <Static id="st_Name2" text="정산처리월" position="absolute 345 40 423 61" class="sta_WFSA_label"/>
        <Button id="edtBtn_UPJANGQuery" onclick="edtBtn_UPJANGQuery_OnClick" taborder="32" position="absolute 295 40 315 61" class="btn_WF_popSearch" text="" image=""/>
        <Edit id="edt_UPJANGQuery" ontextchanged="edt_UPJANGQuery_OnChanged" onkeydown="edt_UPJANGQuery_OnKeyDown" readonly="true" taborder="2" position="absolute 68 40 296 61" userdata=""/>
        <Button id="btn_PO_Detail" onclick="btn_PO_Detail_OnClick" taborder="47" text="현지구매상세입력" position="absolute 929 40 1054 61" class="btn_WF_Custom" image="" anchor="top right"/>
        <Button id="btn_Nopay" onclick="btn_Nopay_OnClick" taborder="46" text="미지급지불처리" position="absolute 1056 40 1169 61" class="btn_WF_Custom" image="" anchor="top right"/>
        <Button id="btn_JanQuery" onclick="btn_JanQuery_OnClick" taborder="41" text="잔액조회" position="absolute 1171 40 1236 61" class="btn_WF_Custom" image="" anchor="top right"/>
        <Static id="Static00" text="업      장" position="absolute 0 86 80 113" class="sta_WFDA_Label01"/>
        <Static id="Static2" text="예산부서" position="absolute 0 112 80 139" class="sta_WFDA_Label01"/>
        <Static id="Static8" text="정산일자" position="absolute 332 86 412 113" class="sta_WFDA_Label01"/>
        <Static id="Static20" text="계      정" position="absolute 332 112 412 139" class="sta_WFDA_Label01"/>
        <Edit enable="false" id="edt_UPJANG" imemode="none" onkeydown="edt_UPJANG_OnKeyDown" readonly="true" taborder="4" position="absolute 82 89 310 110" class="edt_WF_Essential"/>
        <Button enable="false" id="edtBtn_UPJANG" onclick="edtBtn_UPJANG_OnClick" taborder="33" position="absolute 309 89 330 110" class="btn_WF_popSearchEssential" text="" image=""/>
        <TextArea lengthunit="asciii" id="ta_SPECIAL_AGREE" maxlength="200" readonly="true" taborder="42" position="absolute 625 89 965 136"/>
        <Edit id="edt_ACCTCD" imemode="native" onkeydown="edt_ACCTCD_OnKeyDown" readonly="true" taborder="6" position="absolute 414 115 600 136" class="edt_WF_Essential"/>
        <Edit enable="false" id="edt_BUDDEPT_ID" onkeydown="edt_BUDDEPT_ID_OnKeyDown" readonly="true" taborder="5" position="absolute 82 115 310 136" class="edt_WF_Essential"/>
        <Button id="edtBtn_ACCTCD" onclick="edtBtn_ACCTCD_OnClick" taborder="35" position="absolute 599 115 620 136" class="btn_WF_popSearchEssential" text="" image=""/>
        <Static id="Static26" text="정산구분" position="absolute 0 138 80 165" class="sta_WFDA_Label01"/>
        <Static id="Static27" text="발행금액" position="absolute 0 164 80 191" class="sta_WFDA_Label01"/>
        <Static id="Static29" text="적     요" position="absolute 0 190 80 217" class="sta_WFDA_Label01"/>
        <Static id="Static32" text="거 래 처" position="absolute 332 138 412 165" class="sta_WFDA_Label01"/>
        <Static id="Static35" text="공 급 가" position="absolute 332 164 412 191" class="sta_WFDA_Label01"/>
        <Static id="Static39" text="발 행 일" position="absolute 622 138 702 165" class="sta_WFDA_Label01"/>
        <Static id="Static40" text="부 가 세" position="absolute 622 164 702 191" class="sta_WFDA_Label01"/>
        <Static id="Static41" text="미지급금" position="absolute 622 190 702 217" class="sta_WFDA_Label01"/>
        <Combo displayrowcount="10" id="cbo_ADJ_KIND" innerdataset="ds_cbo_ADJ_KIND" onitemchanged="cbo_ADJ_KIND_OnChanged" taborder="7" position="absolute 82 141 330 162" class="cmb_WF_Essential"/>
        <Edit lengthunit="asciii" id="edt_ADJ_DESC" imemode="native" maxlength="200" taborder="12" position="absolute 82 193 621 214" class="edt_WF_Essential"/>
        <MaskEdit enable="false" id="me_AMT" taborder="31" position="absolute 82 167 330 188" mask="###,##"/>
        <MaskEdit id="me_ADJ_AMT" ontextchanged="me_ADJ_AMT_OnChanged" taborder="10" position="absolute 414 167 600 188" class="msk_WF_Essential" mask="###,##"/>
        <MaskEdit id="me_VAT" mask="###,##" ontextchanged="me_VAT_OnChanged" taborder="11" position="absolute 704 167 806 188" class="msk_WF_Essential"/>
        <MaskEdit id="me_NOPAY_AMT" mask="###,##" taborder="13" position="absolute 704 193 806 214"/>
        <Edit id="edt_CUSTCD" imemode="native" onsetfocus="edt_CUSTCD_OnFocus" onkeydown="edt_CUSTCD_OnKeyDown" readonly="true" taborder="8" position="absolute 414 141 600 162" class="edt_WF_Essential"/>
        <Button id="edtBtn_CUSTCD" onclick="edtBtn_CUSTCD_OnClick" taborder="36" position="absolute 599 141 620 162" class="btn_WF_popSearchEssential" text="" image=""/>
        <Static id="Static34" text="   (중고업장 세금계산서)      매입일반 여부" position="absolute 808 138 968 191" wordwrap="both" class="sta_WFDA_Label01"/>
        <Combo displayrowcount="10" enable="false" id="cbo_BULGONG_YN" imemode="none" taborder="17" position="absolute 811 193 966 214" codecolumn="codecolumn" datacolumn="datacolumn">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">Y</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">N</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="Static42" text="접대비유형" position="absolute 0 253 80 280" class="sta_WFDA_Label01"/>
        <Static id="Static43" text="주     소" position="absolute 0 279 80 306" class="sta_WFDA_Label01"/>
        <Static id="Static44" text="사업자번호" position="absolute 332 253 412 280" class="sta_WFDA_Label01"/>
        <Static id="Static45" text="접 대 비" position="absolute 332 279 412 306" class="sta_WFDA_Label01"/>
        <Static id="Static46" text="상      호" position="absolute 622 253 702 280" class="sta_WFDA_Label01"/>
        <Static id="Static47" text="봉 사 료" position="absolute 622 279 702 306" class="sta_WFDA_Label01"/>
        <Combo displayrowcount="10" id="cbo_RCP_GUBUN" taborder="18" position="absolute 82 256 330 277" class="cmb_WF_Essential"/>
        <MaskEdit id="me_RCP_SAUPNO" mask="###-##-#####" taborder="19" type="string" position="absolute 414 256 496 277" class="msk_WF_Essential"/>
        <Edit id="edt_RCP_CUSTNM" imemode="native" taborder="20" position="absolute 704 256 806 277" class="edt_WF_Essential"/>
        <Edit id="edt_RCP_DRNAME" imemode="native" taborder="24" position="absolute 811 282 968 303" class="edt_WF_Essential"/>
        <MaskEdit id="me_SVC_AMT" mask="###,##" taborder="23" position="absolute 704 282 806 303" class="msk_WF_Essential"/>
        <MaskEdit id="me_RCP_AMT" taborder="22" position="absolute 414 282 600 303" class="msk_WF_Essential"/>
        <Edit lengthunit="asciii" id="edt_RCP_ADDR" imemode="native" maxlength="100" taborder="21" position="absolute 82 282 330 303" class="edt_WF_Essential"/>
        <Static id="Static48" text="대   표   자" position="absolute 808 253 968 280" wordwrap="both" class="sta_WFDA_Label01"/>
        <Static id="st_Aditem1" text="관리항목1" position="absolute 0 305 80 332" class="sta_WFDA_Label01"/>
        <Static id="st_Aditem2" text="관리항목2" position="absolute 0 331 80 358" class="sta_WFDA_Label01"/>
        <Static id="st_Aditem3" text="관리항목3" position="absolute 332 305 412 332" class="sta_WFDA_Label01"/>
        <Static id="st_Aditem4" text="관리항목4" position="absolute 332 331 412 355" class="sta_WFDA_Label01"/>
        <Static id="st_Project" text="프로젝트" userdata="PROJECT" position="absolute 622 305 702 332" class="sta_WFDA_Label01"/>
        <Static id="st_Budcls" text="관리유형" userdata="BUD_CLS" position="absolute 622 331 702 355" class="sta_WFDA_Label01"/>
        <Edit id="edt_ADITEM2" imemode="native" onkeydown="edt_ADITEM2_OnKeyDown" readonly="true" taborder="26" position="absolute 82 334 310 355" class="edt_WF_Essential"/>
        <Button id="edtBtn_ADITEM2" onclick="edtBtn_ADITEM2_OnClick" taborder="38" position="absolute 309 334 330 355" class="btn_WF_popSearchEssential" text="" image=""/>
        <Edit id="edt_ADITEM4" imemode="native" onkeydown="edt_ADITEM4_OnKeyDown" readonly="true" taborder="28" position="absolute 414 334 600 355" class="edt_WF_Essential"/>
        <Edit id="edt_ADITEM3" imemode="native" onkeydown="edt_ADITEM3_OnKeyDown" readonly="true" taborder="27" position="absolute 414 308 600 329" class="edt_WF_Essential"/>
        <Button id="edtBtn_ADITEM3" onclick="edtBtn_ADITEM3_OnClick" taborder="39" position="absolute 599 308 620 329" class="btn_WF_popSearchEssential" text="" image=""/>
        <Button id="edtBtn_ADITEM4" onclick="edtBtn_ADITEM4_OnClick" taborder="40" position="absolute 599 334 620 355" class="btn_WF_popSearchEssential" text="" image=""/>
        <Edit id="edt_BUD_CLS" imemode="native" onkeydown="edt_BUD_CLS_OnKeyDown" readonly="true" taborder="30" position="absolute 704 334 862 355" class="edt_WF_Essential"/>
        <Edit id="edt_PROJECT_ID" imemode="native" onkeydown="edt_PROJECT_ID_OnKeyDown" readonly="true" taborder="29" position="absolute 704 308 862 329" class="edt_WF_Essential"/>
        <Button id="edtBtn_PROJECT_ID" onclick="edtBtn_PROJECT_ID_OnClick" taborder="43" position="absolute 861 308 882 329" class="btn_WF_popSearchEssential" text="" image=""/>
        <Button id="edtBtn_BUD_CLS" onclick="edtBtn_BUD_CLS_OnClick" taborder="44" position="absolute 861 334 882 355" class="btn_WF_popSearchEssential" text="" image=""/>
        <Edit id="edt_ADITEM1" imemode="native" onkeydown="edt_ADITEM1_OnKeyDown" readonly="true" taborder="25" position="absolute 82 308 310 329" class="edt_WF_Essential"/>
        <ImageViewer id="Image19" image="" taborder="62" position="absolute 7 217 15 237" class="img_WF_essential" text=""/>
        <Grid autofittype="col" binddataset="ds_list" cellsizingtype="both" enable="true" cellsizebandtype="allband" id="grid_Slip" useinputpanel="false" autofitminwidth="100" onheadclick="grid_Slip_OnHeadClick" taborder="45" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 389 1237 687" readonly="true" selecttype="row" anchor="all">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="27"/>
                <Column size="54"/>
                <Column size="82"/>
                <Column size="70"/>
                <Column size="99"/>
                <Column size="66"/>
                <Column size="61"/>
                <Column size="118"/>
                <Column size="81"/>
                <Column size="79"/>
                <Column size="59"/>
                <Column size="66"/>
                <Column size="64"/>
                <Column size="78"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="정산번호"/>
                <Cell col="2" displaytype="text" text="전표번호"/>
                <Cell col="3" displaytype="text" text="정산일자"/>
                <Cell col="4" displaytype="text" text="계정"/>
                <Cell col="5" displaytype="text" text="정산구분"/>
                <Cell col="6" displaytype="text" text="거래처"/>
                <Cell col="7" displaytype="text" text="적요"/>
                <Cell col="8" displaytype="text" text="발생금액"/>
                <Cell col="9" displaytype="text" text="공급가"/>
                <Cell col="10" displaytype="text" text="부가세"/>
                <Cell col="11" displaytype="text" text="미지급금"/>
                <Cell col="12" displaytype="text" text="지급처리"/>
                <Cell col="13" displaytype="text" text="미지급잔액"/>
              </Band>
              <Band id="body">
                <Cell style="align:center middle;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align: ;" text="bind:ADV_ID"/>
                <Cell col="2" displaytype="text" style="align: ;" text="bind:SLIP_NO"/>
                <Cell col="3" displaytype="text" style="align: ;" text="bind:ADJ_DATE" mask="####-##-##"/>
                <Cell col="4" displaytype="text" style="align: ;" text="bind:ACCTNM"/>
                <Cell col="5" displaytype="text" style="align: ;" text="bind:ADJ_KINDNM"/>
                <Cell col="6" displaytype="text" style="align: ;" text="bind:CUSTNM"/>
                <Cell col="7" displaytype="text" style="align: ;" text="bind:ADJ_DESC"/>
                <Cell col="8" displaytype="number" style="align: ;" text="bind:AMT"/>
                <Cell col="9" displaytype="number" style="align: ;" text="bind:ADJ_AMT"/>
                <Cell col="10" displaytype="number" style="align: ;" text="bind:VAT"/>
                <Cell col="11" displaytype="number" style="align: ;" text="bind:NOPAY_AMT"/>
                <Cell col="12" displaytype="number" style="align: ;" text="bind:NOPAY_AMT_BEFOREPAY"/>
                <Cell col="13" displaytype="number" style="align: ;" text="bind:NOPAY_AMT_JAN"/>
              </Band>
              <Band id="summary">
                <Cell style="align:left;"/>
                <Cell col="1" colspan="7" style="align:center;" text="합계"/>
                <Cell col="8" displaytype="number" style="align:right;" expr="expr:getSum('AMT')"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:getSum('ADJ_AMT')"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="expr:getSum('VAT')"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:getSum('NOPAY_AMT')"/>
                <Cell col="12" displaytype="number" style="align:right;" expr="expr:getSum('NOPAY_AMT_BEFOREPAY')"/>
                <Cell col="13" displaytype="number" style="align:right;" expr="expr:getSum('NOPAY_AMT_JAN')"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <MaskEdit id="cal_ADJ_DATEQuery" mask="####-##" ontextchanged="cal_ADJ_DATEQuery_OnChanged" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Month_OnKillFocus" taborder="3" type="string" position="absolute 425 40 541 61" class="msk_WF_Cal"/>
        <Button id="edtBtn_Date" onclick="edtBtn_Date_OnClick" taborder="69" tabstop="false" userdata="cal_ADJ_DATEQuery" position="absolute 540 40 560 61" class="btn_WF_popSearch" text="" image=""/>
        <MaskEdit id="cal_TAX_DATE" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="9" type="string" position="absolute 704 141 786 162" class="msk_WF_EssentialCal"/>
        <Button id="btn_TAX_DATE" onclick="edtBtn_Date_OnClick" taborder="70" tabstop="false" userdata="cal_TAX_DATE" position="absolute 785 141 806 162" class="btn_WF_popSearchEssential" text="" image=""/>
        <MaskEdit id="cal_ADJ_DATE" mask="####-##-##" ontextchanged="cal_ADJ_DATE_OnChanged" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="71" type="string" position="absolute 414 89 600 110" class="msk_WF_EssentialCal"/>
        <Button id="btn_ADJ_DATE" onclick="edtBtn_Date_OnClick" taborder="72" tabstop="false" userdata="cal_ADJ_DATE" position="absolute 599 89 620 110" class="btn_WF_popSearchEssential" text="" image=""/>
        <Static id="Static3" text="세금계산서No" position="absolute 332 216 420 243" class="sta_WFDA_Label01"/>
        <Edit lengthunit="asciii" id="edt_TAXNO" imemode="native" maxlength="30" taborder="15" position="absolute 422 219 581 240"/>
        <Static id="Static4" text="전자세금계산서여부" position="absolute 0 216 120 243" class="sta_WFDA_Label01"/>
        <Combo displayrowcount="10" id="cbo_TAX_IF_GB" imemode="none" onitemchanged="cbo_TAX_IF_GB_OnChanged" taborder="14" position="absolute 122 219 330 240" codecolumn="codecolumn" datacolumn="datacolumn">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">Y</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">N</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="Static5" text="역발행여부" position="absolute 637 216 717 243" class="sta_WFDA_Label01"/>
        <Combo displayrowcount="10" id="cbo_TAX_SEND_GB" imemode="none" taborder="16" position="absolute 719 219 821 240" codecolumn="codecolumn" datacolumn="datacolumn">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">2</Col>
                <Col id="datacolumn">Y</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1</Col>
                <Col id="datacolumn">N</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <MPFileDialog Filter="Xml File(*.xml)|*.xml|" id="fileDialog_EBill" taborder="113" position="absolute 984 160 1008 184"/>
        <Button enable="false" id="btn_ImgInsert" onclick="btn_ImgInsert_OnClick" taborder="76" text="첨부" position="absolute 583 219 635 241" class="btn_WF_CRUD" image=""/>
        <MPFile id="file_EBill" taborder="115" position="absolute 984 88 1008 112"/>
        <Static id="Static6" text="매점 상품을 구입시 매월 증빙이 세금계산서, 계산서 일 경우 당월 25일 이전 날짜로 발행 받습니다. (수불마감시 수불창고와 회계원장 상이함 방지)" position="absolute 182 371 1075 386" class="sta_WF_DiscInfo"/>
        <Static id="Static7" text="전자세금계산서의 경우 첨부파일이 존재시 반드시 첨부하셔야 합니다." position="absolute 6 695 884 710" class="sta_WF_DiscPoint" anchor="left bottom"/>
        <Button id="btn_Sch_Enroll" onclick="btn_Sch_Enroll_OnClick" taborder="117" text="스케쥴등록" position="absolute 1081 364 1158 386" class="btn_WF_Custom" image="" anchor="top right"/>
        <Button id="btn_Sch_Check" onclick="btn_Sch_Check_OnClick" taborder="118" text="스케쥴체크" position="absolute 1160 364 1237 386" class="btn_WF_Custom" image="" anchor="top right"/>
        <Button id="btn_Mon_Set" onclick="btn_Mon_Set_OnClick" taborder="119" text="계산서월설정" visible="false" position="absolute 838 40 927 61" class="btn_WF_Custom" image="" anchor="top right"/>
        <Div id="div_Exp" taborder="120" text="Div0" visible="false" position="absolute 992 192 1131 232" scrollbars="none">
          <Layouts>
            <Layout>
              <Static id="Static01" position="absolute 0 0 138 35" class="sta_WFSA_Labelbg"/>
              <CheckBox id="chkNonMachul" onclick="div_Exp_chkNonMachul_OnClick" taborder="1" text="세금계산서입력가능" value="false" position="absolute 6 5 132 30"/>
            </Layout>
          </Layouts>
        </Div>
        <Button id="edtBtn_SupAmt" onclick="edtBtn_SupAmt_OnClick" taborder="121" visible="false" position="absolute 599 167 620 188" class="btn_WF_popSearchEssential" text="" image=""/>
        <Static id="Static09" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 71 450 86" anchor="left top"/>
        <Static id="Static22" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 384 450 389" anchor="left top"/>
        <Static id="Static24" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 358 450 371" anchor="left top"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Static id="Static23" text="정  산  현  황" class="sta_WF_Title01" position="absolute 0 371 138 389" anchor="left top"/>
        <Static id="Static25" text="h8" class="Guide01_AreaRed" visible="false" position="absolute 0 687 1252 695" anchor="left bottom"/>
        <Static id="Static36" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 58 40 68 61" anchor="left top"/>
        <Static id="Static28" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 415 40 425 61" anchor="left top"/>
        <Static id="Static16" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 243 450 253" anchor="left top"/>
        <Button id="edtBtn_ADITEM1" onclick="edtBtn_ADITEM1_OnClick" taborder="37" position="absolute 309 308 330 329" text="" image="" class="btn_WF_popSearchEssential"/>
        <Button enable="false" id="edtBtn_BUDDEPT_ID" onclick="edtBtn_BUDDEPT_ID_OnClick" taborder="34" position="absolute 309 115 330 136" class="btn_WF_popSearchEssential" text="" image=""/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond">
        <ColumnInfo>
          <Column id="UPJANG" type="INT" size="256"/>
          <Column id="ADJ_DATE" type="STRING" size="256"/>
          <Column id="ACCTCD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cbo_ADJ_KIND"/>
      <Dataset id="ds_cbo_RCP_GUBUN"/>
      <Dataset id="ds_MA_ADV_LINE" onrowposchanged="ds_list_OnRowPosChanged">
        <ColumnInfo>
          <Column id="ACCTCD" size="7" type="STRING"/>
          <Column id="ACCTNM" size="60" type="STRING"/>
          <Column id="ADITEM1" size="50" type="STRING"/>
          <Column id="ADITEM1NM" size="4000" type="STRING"/>
          <Column id="ADITEM2" size="50" type="STRING"/>
          <Column id="ADITEM2NM" size="4000" type="STRING"/>
          <Column id="ADITEM3" size="50" type="STRING"/>
          <Column id="ADITEM3NM" size="4000" type="STRING"/>
          <Column id="ADITEM4" size="50" type="STRING"/>
          <Column id="ADITEM4NM" size="4000" type="STRING"/>
          <Column id="ADJ_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="ADJ_DATE" size="8" type="STRING"/>
          <Column id="ADJ_DESC" size="200" type="STRING"/>
          <Column id="ADJ_KIND" size="3" type="STRING"/>
          <Column id="ADJ_KINDNM" size="100" type="STRING"/>
          <Column id="ADV_ID" size="22" type="BIGDECIMAL"/>
          <Column id="ADV_KIND" size="3" type="STRING"/>
          <Column id="AMT" size="22" type="BIGDECIMAL"/>
          <Column id="ATTR01" size="20" type="STRING"/>
          <Column id="ATTR02" size="20" type="STRING"/>
          <Column id="ATTR03" size="20" type="STRING"/>
          <Column id="ATTR04" size="20" type="STRING"/>
          <Column id="ATTR05" size="20" type="STRING"/>
          <Column id="BUD_CLS" size="20" type="STRING"/>
          <Column id="BUDCLSNM" size="60" type="STRING"/>
          <Column id="BUDDEPT_ID" size="22" type="BIGDECIMAL"/>
          <Column id="BUDDEPT_IDNM" size="101" type="STRING"/>
          <Column id="BULGONG_YN" size="1" type="STRING"/>
          <Column id="COST_ALT_YN" size="1" type="STRING"/>
          <Column id="COST_GADATE" size="8" type="STRING"/>
          <Column id="COST_GALINE" size="22" type="BIGDECIMAL"/>
          <Column id="COST_GAMU" size="2" type="STRING"/>
          <Column id="COST_GANO" size="22" type="BIGDECIMAL"/>
          <Column id="CUSTCD" size="22" type="BIGDECIMAL"/>
          <Column id="CUSTNM" size="74" type="STRING"/>
          <Column id="GADATE" size="8" type="STRING"/>
          <Column id="GALINE" size="22" type="BIGDECIMAL"/>
          <Column id="GAMU" size="2" type="STRING"/>
          <Column id="GANO" size="22" type="BIGDECIMAL"/>
          <Column id="NOPAY_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="PROJECT_ID" size="20" type="STRING"/>
          <Column id="PROJECTNM" size="60" type="STRING"/>
          <Column id="RCP_ADDR" size="100" type="STRING"/>
          <Column id="RCP_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="RCP_CUSTNM" size="50" type="STRING"/>
          <Column id="RCP_DRNAME" size="30" type="STRING"/>
          <Column id="RCP_GUBUN" size="3" type="STRING"/>
          <Column id="RCP_GUBUNNM" size="80" type="STRING"/>
          <Column id="RCP_SAUPNO" size="10" type="STRING"/>
          <Column id="SVC_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="TAX_DATE" size="8" type="STRING"/>
          <Column id="UPJANG" size="22" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="50" type="STRING"/>
          <Column id="VAT" size="22" type="BIGDECIMAL"/>
          <Column id="NOPAY_AMT_BEFOREPAY" size="256" type="BIGDECIMAL"/>
          <Column id="NOPAY_AMT_JAN" size="256" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listInput">
        <ColumnInfo>
          <Column id="ACCTCD" size="7" type="STRING"/>
          <Column id="ACCTNM" size="60" type="STRING"/>
          <Column id="ADITEM1" size="50" type="STRING"/>
          <Column id="ADITEM1NM" size="4000" type="STRING"/>
          <Column id="ADITEM2" size="50" type="STRING"/>
          <Column id="ADITEM2NM" size="4000" type="STRING"/>
          <Column id="ADITEM3" size="50" type="STRING"/>
          <Column id="ADITEM3NM" size="4000" type="STRING"/>
          <Column id="ADITEM4" size="50" type="STRING"/>
          <Column id="ADITEM4NM" size="4000" type="STRING"/>
          <Column id="ADJ_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="ADJ_DATE" size="8" type="STRING"/>
          <Column id="ADJ_DESC" size="200" type="STRING"/>
          <Column id="ADJ_KIND" size="3" type="STRING"/>
          <Column id="ADJ_KINDNM" size="100" type="STRING"/>
          <Column id="ADV_ID" size="22" type="BIGDECIMAL"/>
          <Column id="ADV_KIND" size="3" type="STRING"/>
          <Column id="AMT" size="22" type="BIGDECIMAL"/>
          <Column id="ATTR01" size="20" type="STRING"/>
          <Column id="ATTR02" size="20" type="STRING"/>
          <Column id="ATTR03" size="20" type="STRING"/>
          <Column id="ATTR04" size="20" type="STRING"/>
          <Column id="ATTR05" size="20" type="STRING"/>
          <Column id="BUD_CLS" size="20" type="STRING"/>
          <Column id="BUDCLSNM" size="60" type="STRING"/>
          <Column id="BUDDEPT_ID" size="22" type="BIGDECIMAL"/>
          <Column id="BUDDEPT_IDNM" size="101" type="STRING"/>
          <Column id="BULGONG_YN" size="1" type="STRING"/>
          <Column id="COST_ALT_YN" size="1" type="STRING"/>
          <Column id="COST_GADATE" size="8" type="STRING"/>
          <Column id="COST_GALINE" size="22" type="BIGDECIMAL"/>
          <Column id="COST_GAMU" size="2" type="STRING"/>
          <Column id="COST_GANO" size="22" type="BIGDECIMAL"/>
          <Column id="CUSTCD" size="22" type="BIGDECIMAL"/>
          <Column id="CUSTNM" size="74" type="STRING"/>
          <Column id="GADATE" size="8" type="STRING"/>
          <Column id="GALINE" size="22" type="BIGDECIMAL"/>
          <Column id="GAMU" size="2" type="STRING"/>
          <Column id="GANO" size="22" type="BIGDECIMAL"/>
          <Column id="NOPAY_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="PROJECT_ID" size="20" type="STRING"/>
          <Column id="PROJECTNM" size="60" type="STRING"/>
          <Column id="RCP_ADDR" size="100" type="STRING"/>
          <Column id="RCP_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="RCP_CUSTNM" size="50" type="STRING"/>
          <Column id="RCP_DRNAME" size="30" type="STRING"/>
          <Column id="RCP_GUBUN" size="3" type="STRING"/>
          <Column id="RCP_GUBUNNM" size="80" type="STRING"/>
          <Column id="RCP_SAUPNO" size="10" type="STRING"/>
          <Column id="SVC_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="TAX_DATE" size="8" type="STRING"/>
          <Column id="UPJANG" size="22" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="50" type="STRING"/>
          <Column id="VAT" size="22" type="BIGDECIMAL"/>
          <Column id="NOPAY_AMT_BEFOREPAY" size="256" type="BIGDECIMAL"/>
          <Column id="NOPAY_AMT_JAN" size="256" type="BIGDECIMAL"/>
          <Column id="TAXNO" size="256" type="STRING"/>
          <Column id="TAX_IF_GB" size="256" type="STRING"/>
          <Column id="TAX_SEND_GB" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ACCTCD_Property">
        <ColumnInfo>
          <Column id="BUD_CLS" size="256" type="STRING"/>
          <Column id="JUBDAE" size="256" type="STRING"/>
          <Column id="MANAYN1" size="256" type="STRING"/>
          <Column id="MANAYN2" size="256" type="STRING"/>
          <Column id="MANAYN3" size="256" type="STRING"/>
          <Column id="MANAYN4" size="256" type="STRING"/>
          <Column id="PROJECT" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_RCP_DetailAuto"/>
      <Dataset id="ds_list" onrowposchanged="ds_list_OnRowPosChanged">
        <ColumnInfo>
          <Column id="ACCTCD" size="7" type="STRING"/>
          <Column id="ACCTNM" size="60" type="STRING"/>
          <Column id="ADITEM1" size="50" type="STRING"/>
          <Column id="ADITEM1NM" size="4000" type="STRING"/>
          <Column id="ADITEM2" size="50" type="STRING"/>
          <Column id="ADITEM2NM" size="4000" type="STRING"/>
          <Column id="ADITEM3" size="50" type="STRING"/>
          <Column id="ADITEM3NM" size="4000" type="STRING"/>
          <Column id="ADITEM4" size="50" type="STRING"/>
          <Column id="ADITEM4NM" size="4000" type="STRING"/>
          <Column id="ADJ_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="ADJ_DATE" size="8" type="STRING"/>
          <Column id="ADJ_DESC" size="200" type="STRING"/>
          <Column id="ADJ_KIND" size="3" type="STRING"/>
          <Column id="ADJ_KINDNM" size="100" type="STRING"/>
          <Column id="ADV_ID" size="22" type="BIGDECIMAL"/>
          <Column id="ADV_KIND" size="3" type="STRING"/>
          <Column id="AMT" size="22" type="BIGDECIMAL"/>
          <Column id="ATTR01" size="20" type="STRING"/>
          <Column id="ATTR02" size="20" type="STRING"/>
          <Column id="ATTR03" size="20" type="STRING"/>
          <Column id="ATTR04" size="20" type="STRING"/>
          <Column id="ATTR05" size="20" type="STRING"/>
          <Column id="BUD_CLS" size="20" type="STRING"/>
          <Column id="BUDCLSNM" size="60" type="STRING"/>
          <Column id="BUDDEPT_ID" size="22" type="BIGDECIMAL"/>
          <Column id="BUDDEPT_IDNM" size="101" type="STRING"/>
          <Column id="BULGONG_YN" size="1" type="STRING"/>
          <Column id="COST_ALT_YN" size="1" type="STRING"/>
          <Column id="COST_GADATE" size="8" type="STRING"/>
          <Column id="COST_GALINE" size="22" type="BIGDECIMAL"/>
          <Column id="COST_GAMU" size="2" type="STRING"/>
          <Column id="COST_GANO" size="22" type="BIGDECIMAL"/>
          <Column id="CUSTCD" size="22" type="BIGDECIMAL"/>
          <Column id="CUSTNM" size="74" type="STRING"/>
          <Column id="GADATE" size="8" type="STRING"/>
          <Column id="GALINE" size="22" type="BIGDECIMAL"/>
          <Column id="GAMU" size="2" type="STRING"/>
          <Column id="GANO" size="22" type="BIGDECIMAL"/>
          <Column id="NOPAY_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="PROJECT_ID" size="20" type="STRING"/>
          <Column id="PROJECTNM" size="60" type="STRING"/>
          <Column id="RCP_ADDR" size="100" type="STRING"/>
          <Column id="RCP_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="RCP_CUSTNM" size="50" type="STRING"/>
          <Column id="RCP_DRNAME" size="30" type="STRING"/>
          <Column id="RCP_GUBUN" size="3" type="STRING"/>
          <Column id="RCP_GUBUNNM" size="80" type="STRING"/>
          <Column id="RCP_SAUPNO" size="10" type="STRING"/>
          <Column id="SVC_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="TAX_DATE" size="8" type="STRING"/>
          <Column id="UPJANG" size="22" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="50" type="STRING"/>
          <Column id="VAT" size="22" type="BIGDECIMAL"/>
          <Column id="NOPAY_AMT_BEFOREPAY" size="256" type="BIGDECIMAL"/>
          <Column id="NOPAY_AMT_JAN" size="256" type="BIGDECIMAL"/>
          <Column id="TAXNO" size="256" type="STRING"/>
          <Column id="TAX_IF_GB" size="256" type="STRING"/>
          <Column id="TAX_SEND_GB" size="256" type="STRING"/>
          <Column id="SLIP_NO" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Commodity">
        <ColumnInfo>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="SUBINV_NAME" size="256" type="STRING"/>
          <Column id="ITEM_CODE" size="12" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="SALE_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="ACCTCD" size="7" type="STRING"/>
          <Column id="BUD_CLS" size="6" type="STRING"/>
          <Column id="CUSTCD" size="22" type="BIGDECIMAL"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="REMARK" size="300" type="STRING"/>
          <Column id="SOURCE_ID" size="22" type="BIGDECIMAL"/>
          <Column id="SOURCE_TYPE" size="50" type="STRING"/>
          <Column id="TAX_CODE" size="3" type="STRING"/>
          <Column id="TR_NUM" size="50" type="STRING"/>
          <Column id="TRANS_DATE" size="8" type="STRING"/>
          <Column id="TRANS_DEPT_ID" size="22" type="BIGDECIMAL"/>
          <Column id="TRANS_ID" size="22" type="BIGDECIMAL"/>
          <Column id="TRANS_MPRICE" size="22" type="BIGDECIMAL"/>
          <Column id="TRANS_MU_CD" size="2" type="STRING"/>
          <Column id="TRANS_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="TRANS_TYPE" size="50" type="STRING"/>
          <Column id="TRANS_UOM" size="10" type="STRING"/>
          <Column id="TRANS_UPJANG" size="22" type="BIGDECIMAL"/>
          <Column id="TRANS_UPRICE" size="22" type="BIGDECIMAL"/>
          <Column id="UNIT_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="UOM_CODE" size="10" type="STRING"/>
          <Column id="UOM_CONVERT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="UOM_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="ADV_ID" size="22" type="BIGDECIMAL"/>
          <Column id="BUDDEPT_ID" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_EBill">
        <ColumnInfo>
          <Column id="IssueDateTime" size="256" type="STRING"/>
          <Column id="IssueID" size="256" type="STRING"/>
          <Column id="PurposeCode" size="256" type="STRING"/>
          <Column id="InvoicerParty_ID" size="256" type="STRING"/>
          <Column id="InvoiceeParty_ID" size="256" type="STRING"/>
          <Column id="ChargeTotalAmount" size="256" type="BIGDECIMAL"/>
          <Column id="TaxTotalAmount" size="256" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Exp"/>
      <Dataset id="ds_able"/>
      <Dataset id="ds_close"/>
    </Objects>
    <Bind>
      <BindItem id="edt_ACCTCD_value" compid="edt_ACCTCD" propid="value" datasetid="ds_listInput" columnid="ACCTNM"/>
      <BindItem id="cbo_ADJ_KIND_value" compid="cbo_ADJ_KIND" propid="value" datasetid="ds_listInput" columnid="ADJ_KIND"/>
      <BindItem id="edt_ADJ_DESC_value" compid="edt_ADJ_DESC" propid="value" datasetid="ds_listInput" columnid="ADJ_DESC"/>
      <BindItem id="me_AMT_value" compid="me_AMT" propid="value" datasetid="ds_listInput" columnid="AMT"/>
      <BindItem id="me_ADJ_AMT_value" compid="me_ADJ_AMT" propid="value" datasetid="ds_listInput" columnid="ADJ_AMT"/>
      <BindItem id="me_VAT_value" compid="me_VAT" propid="value" datasetid="ds_listInput" columnid="VAT"/>
      <BindItem id="me_NOPAY_AMT_value" compid="me_NOPAY_AMT" propid="value" datasetid="ds_listInput" columnid="NOPAY_AMT"/>
      <BindItem id="edt_CUSTCD_value" compid="edt_CUSTCD" propid="value" datasetid="ds_listInput" columnid="CUSTNM"/>
      <BindItem id="cbo_BULGONG_YN_value" compid="cbo_BULGONG_YN" propid="value" datasetid="ds_listInput" columnid="BULGONG_YN"/>
      <BindItem id="cbo_RCP_GUBUN_value" compid="cbo_RCP_GUBUN" propid="value" datasetid="ds_listInput" columnid="RCP_GUBUN"/>
      <BindItem id="me_RCP_SAUPNO_value" compid="me_RCP_SAUPNO" propid="value" datasetid="ds_listInput" columnid="RCP_SAUPNO"/>
      <BindItem id="edt_RCP_CUSTNM_value" compid="edt_RCP_CUSTNM" propid="value" datasetid="ds_listInput" columnid="RCP_CUSTNM"/>
      <BindItem id="edt_RCP_DRNAME_value" compid="edt_RCP_DRNAME" propid="value" datasetid="ds_listInput" columnid="RCP_DRNAME"/>
      <BindItem id="me_SVC_AMT_value" compid="me_SVC_AMT" propid="value" datasetid="ds_listInput" columnid="SVC_AMT"/>
      <BindItem id="me_RCP_AMT_value" compid="me_RCP_AMT" propid="value" datasetid="ds_listInput" columnid="RCP_AMT"/>
      <BindItem id="edt_RCP_ADDR_value" compid="edt_RCP_ADDR" propid="value" datasetid="ds_listInput" columnid="RCP_ADDR"/>
      <BindItem id="edt_ADITEM2_value" compid="edt_ADITEM2" propid="value" datasetid="ds_listInput" columnid="ADITEM2NM"/>
      <BindItem id="edt_ADITEM3_value" compid="edt_ADITEM3" propid="value" datasetid="ds_listInput" columnid="ADITEM3NM"/>
      <BindItem id="edt_BUD_CLS_value" compid="edt_BUD_CLS" propid="value" datasetid="ds_listInput" columnid="BUDCLSNM"/>
      <BindItem id="edt_PROJECT_ID_value" compid="edt_PROJECT_ID" propid="value" datasetid="ds_listInput" columnid="PROJECTNM"/>
      <BindItem id="edt_ADITEM1_value" compid="edt_ADITEM1" propid="value" datasetid="ds_listInput" columnid="ADITEM1NM"/>
      <BindItem id="cal_TAX_DATE_value" compid="cal_TAX_DATE" propid="value" datasetid="ds_listInput" columnid="TAX_DATE"/>
      <BindItem id="edt_TAXNO_value" compid="edt_TAXNO" propid="value" datasetid="ds_listInput" columnid="TAXNO"/>
      <BindItem id="cbo_TAX_IF_GB_value" compid="cbo_TAX_IF_GB" propid="value" datasetid="ds_listInput" columnid="TAX_IF_GB"/>
      <BindItem id="cbo_TAX_SEND_GB_value" compid="cbo_TAX_SEND_GB" propid="value" datasetid="ds_listInput" columnid="TAX_SEND_GB"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : FS시스템/영업관리/전도금정산
 * 프로그램명   : MAA10030E.XML
 * 기      능   : 전도금정산 UI Form
 * 작  성  자   : 황승한
 * 작성  일자   : 2007-11-16
 * ----------------------------------------------------------------------------------------
 * HISTORY    : 1. CSR24685 정산시 계정별 관리항목 체크기능 추가 2009.02.13 황승한
                   SR201309_03108 저장시 계정 중 [예금(업장전도금)]은 26일 이후 데이터 처리시
                2. 매점상품과 같이 25일안으로 날짜 수정후 저장되게 수정 2013.09.25 김장욱
                3. 전도금 정산시 세금계산서로 등록하는 건은 정산처리월과 세금계산서의 발행일의
                   월이 같은 달이어야 한다. 2014.06.02 김장욱
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::ma_common.js"


//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var
  f_CurrDate,
  f_PopupCode1, f_PopupCode2, f_PopupCode3,
  f_Saved_ADV_ID;
  
var f_ROLE_YN;  

var f_clkcnt = 0;
//=========================================================================================S
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);


	//init_btn_setup();	// Button 초기화
	fsp_init(this);
	
	//g_AuthLevel = "14";
	
    
    // 권한이 팀장이상이면 전도금신청 마감관리 버튼을 보이게 한다.
    if (g_AuthLevel > "14"){
		btn_Mon_Set.visible = true;
	}
	/*
	#############################################################################################################
	공통코드 SETTING
	#############################################################################################################
	*/


	//정산구분####################################################################################################
	fn_sql_common("C", strMAQuery_ADJ_KIND,""," ORDER BY CODE ","",cbo_ADJ_KIND,-1,ds_cbo_ADJ_KIND);
	//정산구분####################################################################################################


	//접대비유형####################################################################################################
	fn_sql_common("C", strMAQuery_RCP_GUBUN,""," ORDER BY SCODE ","",cbo_RCP_GUBUN,-1,ds_cbo_RCP_GUBUN);
	//접대비유형####################################################################################################


	edt_UPJANGQuery.userdata = g_Upjang;
	edt_UPJANGQuery.value     = g_UpjangNm;

	edt_UPJANG.userdata      = g_Upjang;
	edt_UPJANG.value          = g_UpjangNm;

	edt_BUDDEPT_ID.userdata  = g_Deptid;
	edt_BUDDEPT_ID.value      = g_UpjangNm;

	f_CurrDate = fn_CurrDateWeek();
	
	cal_ADJ_DATE.value        = f_CurrDate;	
	//cal_ADJ_DATEQuery.Text   = Substr(GetDate(), 0, 8);
	cal_ADJ_DATEQuery.value   = gfn_subStr(f_CurrDate, 0, 6);

	cbo_BULGONG_YN.enable    = false;

 
	fn_insert();
	
    f_ROLE_YN = fn_GetLocalUserRole(ds_cond);
    if (f_ROLE_YN == "Y"){
    
    }
    else {  
    	
		//사업장 권한 셋팅#############################################################################
		fn_SetAuth("","","edt_UPJANGQuery", "edtBtn_UPJANGQuery");
		fn_SetAuth("","","edt_UPJANG", "edtBtn_UPJANG");
		//사업장 권한 셋팅#############################################################################
    }
    
	fn_GetIsGHRValidCheck(ds_cond, edt_UPJANGQuery.userdata);
	/*
	#############################################################################################################
	공통코드 SETTING
	#############################################################################################################
	*/

}



function callbackCombo(){
        //alert(ds_MAS_UPJANG_MPRICEORG.SaveXML());
        /*
		Tab_UPJANG.tab5.st_JOBNM.Text      = "";
		Tab_UPJANG.tab5.st_SUB_JOBNM.Text  = "";

		Tab_UPJANG.tab5.st_JOBNM.Text      = Tab_UPJANG.tab2.cbo_JOB_CD.Text;
		Tab_UPJANG.tab5.st_SUB_JOBNM.Text  = Tab_UPJANG.tab2.cbo_SUB_JOB_CD.Text;
		*/
}


function fn_callback_SetINVEST_AMT(){
        //alert(ds_MAS_UPJANG_MPRICEORG.SaveXML());
		/*
		ds_list.SetColumn(ds_list.row, "TOT_INVEST_AMT", ds_INVEST_AMT.GetColumn(ds_INVEST_AMT.row, "TOT_INVEST_AMT"));
		ds_list.SetColumn(ds_list.row, "GUARANTY_AMT", ds_INVEST_AMT.GetColumn(ds_INVEST_AMT.row, "GUARANTY_AMT"));
		ds_list.SetColumn(ds_list.row, "DEPRN_RESERVE_AMT", ds_INVEST_AMT.GetColumn(ds_INVEST_AMT.row, "DEPRN_RESERVE_AMT"));
		*/
}


//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
function fn_search()
{

	if ( (edt_UPJANGQuery.userdata == "") || (cal_ADJ_DATEQuery.value == "") )
		return;

    
    //ds_EBill.clearData();
    
    fn_DataSetAllClear();
	//정산정보GET############################################################
    fsp_clear(this);
	fsp_addSearch(this, "ma/maa:MAA10030E_S001");

	ds_cond.clear();
	ds_list.clear();	
	ds_cond.addColumn("UPJANG","INT",6);
	ds_cond.addColumn("ADJ_DATE","VARCHAR",256);
	ds_cond.addRow();
	
	


	ds_cond.setColumn(ds_cond.rowposition, "UPJANG",  edt_UPJANGQuery.userdata);
	ds_cond.setColumn(ds_cond.rowposition, "ADJ_DATE",  gfn_subStr(cal_ADJ_DATEQuery.value, 0, 6));
//trace(ds_cond.saveXML());
    http.Sync = true;
	fsp_callService(this, "", "", "ds_cond=ds_cond","ds_list=ds_list","","fn_SearchDetail");
	http.Sync = false;
	//정산정보GET############################################################
}

function fn_SearchDetail(int_TabIndex)
{
	/*
	if (Length(Tab_UPJANG.tab1.st_CC_CD.Value) == 0)
		return;


	//업장정보GET############################################################
    tit_clearActionInfo(this);
	tit_addSearchActionInfo(this, "ma/mas:MAS10020E_S002");

	ds_cond.Clear();
	ds_cond.AddColumn("CC_CD","VARCHAR",256);
	ds_cond.AddRow();

	ds_cond.SetColumn(ds_cond.Row, "CC_CD",  Tab_UPJANG.tab1.st_CC_CD.Value);


	tit_callService(this, "", "", "ds_cond=ds_cond","ds_deptHis=ds_list","","");
	//업장정보GET############################################################


	//정수기보유현황GET#####################################################
    tit_clearActionInfo(this);
	tit_addSearchActionInfo(this, "ma/mas:MAS10020E_S003");

	ds_cond.Clear();
	ds_cond.AddColumn("UPJANG","NUMERIC",6);
	ds_cond.AddRow();

	ds_cond.SetColumn(ds_cond.Row, "UPJANG",  edt_UPJANG.UserData);


	tit_callService(this, "", "", "ds_cond=ds_cond","ds_purifier=ds_list","","");
	//정수기보유현황GET#####################################################


	//영업유형GET###########################################################
    tit_clearActionInfo(this);
	tit_addSearchActionInfo(this, "ma/mas:MAS10020E_S004");

	ds_cond.Clear();
	ds_cond.AddColumn("UPJANG","INT",6);
	ds_cond.AddRow();

	ds_cond.SetColumn(ds_cond.Row, "UPJANG",  edt_UPJANG.UserData);


	tit_callService(this, "", "", "ds_cond=ds_cond","ds_MAS_UPJANG_TYPE=ds_list","","");
	//영업유형GET###########################################################

	//인원형황GET###########################################################
    tit_clearActionInfo(this);
	tit_addSearchActionInfo(this, "ma/mas:MAS10020E_S005");

	ds_cond.Clear();
	ds_cond.AddColumn("CC_CD","STRING",256);
	ds_cond.AddRow();

	ds_cond.SetColumn(ds_cond.Row, "CC_CD",  Tab_UPJANG.tab1.st_CC_CD.Value);


	tit_callService(this, "", "", "ds_cond=ds_cond","ds_FS_HR_PERSONAL=ds_list","","");



    tit_clearActionInfo(this);
	tit_addSearchActionInfo(this, "ma/mas:MAS10020E_S006");

	ds_cond.Clear();
	ds_cond.AddColumn("CC_CD","STRING",256);
	ds_cond.AddRow();

	ds_cond.SetColumn(ds_cond.Row, "CC_CD",  Tab_UPJANG.tab1.st_CC_CD.Value);


	tit_callService(this, "", "", "ds_cond=ds_cond","ds_FS_HR_PERSONAL_HIS=ds_list","","");
	//인원형황GET###########################################################

	//식단가유형GET########################################################
    tit_clearActionInfo(this);
	tit_addSearchActionInfo(this, "ma/mas:MAS10020E_S007");
	tit_addSearchActionInfo(this, "ma/mas:MAS10020E_S008");

	ds_cond.Clear();
	ds_cond.AddColumn("UPJANG","INT",6);
	ds_cond.AddRow();

	ds_cond.SetColumn(ds_cond.Row, "UPJANG",  edt_UPJANG.UserData);


	tit_callService(this, "", "", "ds_cond=ds_cond","ds_MAS_UPJANG_MPRICE=ds_list ds_MAS_UPJANG_MPRICEORG=ds_MAS_UPJANG_MPRICEORG","","callbackCombo");
	//식단가유형GET########################################################


	//고객사현황(1)GET#####################################################
    tit_clearActionInfo(this);
	tit_addSearchActionInfo(this, "ma/mas:MAS10020E_S012");

	ds_cond.Clear();
	ds_cond.AddColumn("UPJANG","INT",6);
	ds_cond.AddRow();

	ds_cond.SetColumn(ds_cond.Row, "UPJANG",  edt_UPJANG.UserData);


	tit_callService(this, "", "", "ds_cond=ds_cond","ds_SCO_UPJANG_CUST=ds_list","","callbackAfterSearch(" + int_TabIndex + ")");
	//고객사현황(1)GET#####################################################


	//고객사현황(2)GET#####################################################
    tit_clearActionInfo(this);
	tit_addSearchActionInfo(this, "ma/mas:MAS10020E_S013");
	tit_addSearchActionInfo(this, "ma/mas:MAS10020E_S014");

	ds_cond.Clear();
	ds_cond.AddColumn("UPJANG","INT",6);
	ds_cond.AddRow();

	ds_cond.SetColumn(ds_cond.Row, "UPJANG",  edt_UPJANG.UserData);


	tit_callService(this, "", "", "ds_cond=ds_cond","ds_SCO_UPJANG_CUSTCHG=ds_list ds_cbo_SCO_UPJANG_CUSTCHG_CUST=ds_cbo_SCO_UPJANG_CUSTCHG_CUST","","callbackAfterSearch(" + int_TabIndex + ")");
	//고객사현황(2)GET#####################################################

	//Data Clear 및 Enalbe Setting##########################################
	ds_INVEST_AMT.ClearData();
	ds_FS_HR_PERSONAL_HIS.ClearData();
	ds_GUARANTY_AMT_His.ClearData();

	Tab_UPJANG.tab2.cbo_SAUP_TYPE.Enable  = False;
	Tab_UPJANG.tab2.cbo_JOB_CD.Enable     = False;
	Tab_UPJANG.tab2.cbo_SUB_JOB_CD.Enable = False;

	if (ds_list.Rowcount > 0){

		if (Length(ds_list.GetColumn(ds_list.row, "SAUP_TYPE")) == 0){

			Tab_UPJANG.tab2.cbo_SAUP_TYPE.Enable   = True;
		}
		if (Length(ds_list.GetColumn(ds_list.row, "JOB_CD")) == 0){

			Tab_UPJANG.tab2.cbo_JOB_CD.Enable      = True;
		}
		if (Length(ds_list.GetColumn(ds_list.row, "SUB_JOB_CD")) == 0){

			Tab_UPJANG.tab2.cbo_SUB_JOB_CD.Enable  = True;
		}
	}
	//Data Clear 및 Enalbe Setting##########################################

	*/
}


function fn_AfterSaveSearch(errCode, errMsg)
{
	if (errCode != 0){
	
		return;
	}
	
	g_Message("02");
	
	fn_search();
	
	for(i=0;i<ds_list.rowcount;i++){
	
		if (f_Saved_ADV_ID == ds_list.getColumn(i, "ADV_ID")){
					
			ds_list.rowposition = i;
		}
	}
}

function fn_AfterDeleteSearch(errCode, errMsg)
{
	if (errCode != 0){
	    fn_search();	
		return;
	}
	
	g_Message("01");
	ds_listInput.clearData();
	fn_search();	
	
	
}

function fn_insert()
{
    //DataSet초기화############################
	ds_listInput.clearData();
	
	ds_Commodity.clearData();

	ds_MA_ADV_LINE.clearData();

	ds_RCP_DetailAuto.clearData();
	
	ds_EBill.clearData();
	//DataSet초기화############################	
		
		 

	//edtBtn Component 초기화############################
	Set_edtBtn_UserData("Clear");
	//edtBtn Component 초기화############################

	ds_listInput.addRow();
    
    if (
         (f_ROLE_YN == "Y") &&
         (numFormat(edt_UPJANGQuery.userdata)!= "0")
       )  
    {
    

	}
	else 
	{
	
		edt_UPJANGQuery.userdata = g_Upjang;
		edt_UPJANGQuery.value     = g_UpjangNm;	
	}	

	edt_UPJANG.userdata      = edt_UPJANGQuery.userdata;
	edt_UPJANG.value          = edt_UPJANGQuery.value;
	ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG", edt_UPJANG.userdata);
	ds_listInput.setColumn(ds_listInput.rowposition, "UPJANGNM", edt_UPJANG.value);


	edt_BUDDEPT_ID.userdata  = g_Deptid;
	edt_BUDDEPT_ID.value      = g_UpjangNm;
	ds_listInput.setColumn(ds_listInput.rowposition, "BUDDEPT_ID", edt_BUDDEPT_ID.userdata);
	ds_listInput.setColumn(ds_listInput.rowposition, "BUDDEPT_IDNM", edt_BUDDEPT_ID.value);

	cal_ADJ_DATE.value        = gfn_subStr(getDate(), 0, 8);
	ds_listInput.setColumn(ds_listInput.rowposition, "ADJ_DATE", cal_ADJ_DATE.value);



	cbo_BULGONG_YN.enable    = false;
	ds_listInput.setColumn(ds_listInput.rowposition, "BULGONG_YN", "N");
	
	
	//전자세금계산서:관련항목  default처리#########################
	ds_listInput.setColumn(ds_listInput.rowposition, "TAXNO",        "");	
	ds_listInput.setColumn(ds_listInput.rowposition, "TAX_IF_GB",   "N");
	ds_listInput.setColumn(ds_listInput.rowposition, "TAX_SEND_GB", "1");
	
	//전자세금계산서:관련항목  default처리#########################
	
	
	
	
	
	
	
	

	/*권한에 따라 처리한다.
	edt_UPJANG.Enable        = True;
	edtBtn_UPJANG.Enable     = True;
   권한에 따라 처리한다.*/
	edt_BUDDEPT_ID.enable    = true;
	edtBtn_BUDDEPT_ID.enable = true;
   
   
	cal_ADJ_DATE.enable      = true;
	btn_ADJ_DATE.enable      = true;


	edt_ACCTCD.enable        = true;
	edtBtn_ACCTCD.enable     = true;

	edt_ACCTCD.setFocus();
}
function fn_delete()
{
    if (!before_DeleteCheck("Master") ){

		return;
    }
}
//=======================================
// 저장 이벤트
//=======================================
function fn_save()
{
	//======================추가 종료========================
    if (!before_SaveCheck("Master") ){
		return;
    }
}

function fn_print()
{
}
function fn_Close()
{
	this.close();
}
function fn_help()
{
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================

/*
 ******************************************************************************************
 * 함  수  명   : Common_Btn_common_OnClick
 * 입      력   : obj  = Form Component
 * 반      환   : 없음
 * 기      능   :
 * 작  성  자   : 구종화
 * 작성  일자   : 2007-11-16
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================

function Common_Btn_common_OnClick(obj)
{

	switch(obj.name)
	{
		case "btn_Search":
		    //alert("d");
			fn_search();
			break;
		case "btn_Insert":
			fn_insert();
			break;
		case "btn_Delete":
			fn_delete();
			break;
		case "btn_Save":
			fn_save();
			break;
		case "btn_Print":
			//fn_Print();
			break;
		case "btn_Close":
			fn_Close();
			break;
		case "btn_Help":
			//fn_Help();
			break;
		default:
			break;
	}

}


function before_SaveCheck(str_Gubun)
{

		//권한에 따른 저장/삭제 가능체크#########################################################################
/*
		if (
		    (f_ROLE_YN != "Y") &&
		    (!fn_GetSaveAuthBy_AuthLevel(edt_UPJANG.UserData))
		   ) return false;
*/
		//권한에 따른 저장/삭제 가능체크#########################################################################
		
	
	var n_VAT = gfn_isNull(ds_listInput.getColumn(ds_listInput.rowposition, "VAT")) ? 0 : ds_listInput.getColumn(ds_listInput.rowposition, "VAT");	//  VAT 값이 0으로 초기값 세팅
	var n_NOPAY_AMT = gfn_isNull(ds_listInput.getColumn(ds_listInput.rowposition, "NOPAY_AMT")) ? 0 : ds_listInput.getColumn(ds_listInput.rowposition, "NOPAY_AMT");	//  NOPAY_AMT 값이 0으로 초기값 세팅
	
 		if (ds_listInput.rowcount == 0){

			return;
		}

	    if (str_Gubun == "Master"){

			if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID"))== "0"){
				
				SetRowType(ds_listInput,0, "Insert");
			}
			else{
			
				SetRowType(ds_listInput,0, "Update");
			}
			
  			if (GetRowType(ds_listInput,ds_listInput.rowposition)== "insert"){

				ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG", edt_UPJANG.userdata);
				ds_listInput.setColumn(ds_listInput.rowposition, "BUDDEPT_ID", edt_BUDDEPT_ID.userdata);
				ds_listInput.setColumn(ds_listInput.rowposition, "ADJ_DATE", cal_ADJ_DATE.value);
			}
			

			
			//불공구분세팅......................................................
  			if ( 
					(
						(gfn_subStr(ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD"), 0, 6)== "505071") ||
						(ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120223")
					) &&
					(ds_listInput.getColumn(ds_listInput.rowposition, "BULGONG_YN") == "Y")
			   ) 
			{
			   
				ds_listInput.setColumn(ds_listInput.rowposition, "BULGONG_YN", "Y");
			}
			else {
			
				ds_listInput.setColumn(ds_listInput.rowposition, "BULGONG_YN", "N");
			};			    
			//불공구분세팅......................................................
			
			//전도금구분-입금:I,정산:O 세팅...................................
  			if (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "008")
			{
			   
				ds_listInput.setColumn(ds_listInput.rowposition, "ADV_KIND", "I");
			}
			else {
			
				ds_listInput.setColumn(ds_listInput.rowposition, "ADV_KIND", "O");
			};				
			//전도금구분-입금:I,정산:O 세팅...................................
        			
            
            if (
                (cbo_BULGONG_YN.enable) &&
                (fn_GetSCHOOL_YN(ds_cond, 
				 	             ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG")) == "Y") &&
                (ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120223") &&
                (ds_listInput.getColumn(ds_listInput.rowposition, "BULGONG_YN") == "N")
               )
            {

			   g_Message("EE", "매점상품은  (중고업장 세금계산서) 매입일반 여부가 N일수 없습니다.");			   
			   return false;

			}; 
            
			if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0"){

			   g_Message("EE", "업장을 선택하여 주십시요.");
			   edt_UPJANG.setFocus();
			   return false;

			};

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE"))== 0){

			   g_Message("EE", "정산일자를 선택하여 주십시요.");
			   cal_ADJ_DATE.setFocus();
			   return false;

			};

			//alert(ds_listInput.GetColumn(ds_listInput.row, "ACCTCD"));
            //alert(length(ds_listInput.GetColumn(ds_listInput.row, "ACCTCD")));
			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD"))== 0){

			   g_Message("EE", "계정을 선택하여 주십시요.");
			   edt_ACCTCD.setFocus();
			   return false;

			};

			if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "BUDDEPT_ID"))== 0){

			   g_Message("EE", "예산부서를 선택하여 주십시요.");
			   edt_BUDDEPT_ID.setFocus();
			   return false;

			};


            //미지급금(FS업장전도금) 계정일 경우 조회 및 삭제만 가능..........
            if (ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "2110314"){

			   g_Message("EE", "미지급금(FS업장전도금) 계정은 조회 및 삭제만이 가능합니다.");
			   return false;
			 };



  		    //정산구분 체크.......................................................
			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND"))== 0){

			   g_Message("EE", "정산구분을 선택하여 주십시요.");
			   cbo_ADJ_KIND.setFocus();
			   return false;
			 };
		    //정산구분 체크.......................................................


			if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_AMT"))== "0")
            {

					g_Message("EE", "공급가가 없습니다. 확인하여 주십시요.");
					me_ADJ_AMT.setFocus();
					return false;
            }

			//기타사항 체크.....................................
            if (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "007"){

				g_Message("EE", "미지급금 정산은 미지급지불 화면에서 처리하여 주십시요.");
				cbo_ADJ_KIND.setFocus();
			    return false;
			}

            if (
                 (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "008") &&
                 (numFormat(fn_GetIsADV_Profit(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD")))== "0")
               )
            {

				g_Message("EE", "잡이익 대상 계정이 아닙니다. 정산구분을 확인하여 주십시요");
				cbo_ADJ_KIND.setFocus();
			    return false;
			}

            if (
                 (numFormat(fn_GetIsADV_Profit(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD")))!= "0") &&
                 (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") != "008")
               )
            {

				g_Message("EE", "잡이익 대상 계정입니다. 정산구분에서 잡이익을 선택하여 주십시요");
				cbo_ADJ_KIND.setFocus();
			    return false;
			}

            if (
                 (numFormat(n_NOPAY_AMT)!= "0") &&
                 (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "008")

               )
            {

				g_Message("EE", "잡이익 대상 계정입니다. 미지급금을 확인하여 주십시요");
				me_NOPAY_AMT.setFocus();
			    return false;
			}

            if (
                 (ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120311") &&
                 (ds_listInput.getColumn(ds_listInput.rowposition, "ADITEM1") == "001") &&
                 (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "002")
               )
            {

				g_Message("EE", "식재료 과세는 계산서로 정산하실수 없습니다. 정산구분을 확인하여 주십시요.");
				cbo_ADJ_KIND.setFocus();
			    return false;
			}

            if (
                 (ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120311") &&
                 (ds_listInput.getColumn(ds_listInput.rowposition, "ADITEM1") == "002") &&
                 (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") != "002")
               )
            {

				g_Message("EE", "식재료 면세는 계산서로 정산하셔야 합니다. 정산구분을 확인하여 주십시요.");
				cbo_ADJ_KIND.setFocus();
			    return false;
			}

            if (
                 ( (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "001") ||
                   (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "009") ) &&
                 (numFormat(n_VAT)== "0")
               )
            {

				g_Message("EE", "세금계산서 혹은 현금영수증의 부가세가 없습니다. 확인하여 주십시요.");
				me_VAT.setFocus();
			    return false;
			}

            if (
                 ( (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") != "001") &&
                   (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") != "009") ) &&
                 (numFormat(n_VAT)!= "0")
               )
            {

				g_Message("EE", "해당 정산구분은 부가세가 해당없습니다. 확인하여 주십시요.");
			    return false;
			}




			//매점상품/식재료 현지구매 체크.....................................
			if (
			     (ds_Commodity.rowcount == 0) &&
			     (
			       (ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120223")
			     )
		       )
		      {

					g_Message("EE", "현지구매상세를 입력하여 주십시요.");
					return false;
			 };
			 
			//식재료 현지구매는 2008년07월부터 적용한다.###########################################
			if (
			     (ds_Commodity.rowcount == 0) &&
			     (
			       (ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120311") &&
			       (
			         (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE") > "20080631") &&
			         (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE") <= "20081231")
			       )
			     )
		       )
		      {						 			
			
					g_Message("EE", "현지구매상세를 입력하여 주십시요.");
					return false;
			 };			 	
			//식재료 현지구매는 2008년07월부터 적용한다.###########################################
			
		 
			//식재료 계정 현지구매 2009.01.01부터 이전으로 돌아감 => 100%원가처리 return................
			//불공제 창고로 인해 현지구매와 구매 단수차이 및 부가세 금액차이 맞출수 없슴의 사유.....
			if (
				 (ds_Commodity.rowcount != 0) &&
				 (
				   (ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120311") &&
				   (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE") >= "20090101")
				 )
			   )
			  {

					g_Message("EE", "식재료 현지구매는 2009년 01월 부터 구매 연동없이 관리됩니다." + "\n" +
									"해당월에 100% 원가처리됩니다." + "\n" +
						  "확인하여 주십시요.");
					return false;
			 };			 	
			//식재료 계정 현지구매 2009.01.01부터 이전으로 돌아감 => 100%원가처리 return................
			//불공제 창고로 인해 현지구매와 구매 단수차이 및 부가세 금액차이 맞출수 없슴의 사유.....
									 
			    			 
    			 
			//매점상품/식재료 현지구매 체크.....................................

            if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "AMT"))== "0")
            {

				if (
					 (me_ADJ_AMT.enable == false) &&
					 ( 					 
					   (ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120223")  //매점상품					    
					 )  //식재료
				   )
				{

					g_Message("EE", "현지구매 상세정보를 입력하여 주십시요.");
					return false;
				}
				else if (
							 (me_ADJ_AMT.enable == false) &&
							 ( 
							   (ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120311") &&  //식재료
							   (
							      (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE") > "20080631") &&
							      (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE") <= "20081231")
							   ) 
							 ) 
				        )
				{

					g_Message("EE", "현지구매 상세정보를 입력하여 주십시요.");
					return false;
				}				
				else {

					g_Message("EE", "금액을 입력하여 주십시요.");
					return false;
				}
			}
			
			//=========================================================================================
			// (2013-09-25 변경) 시작
			// 김장욱 2013-09-25 예금(업장전도금)(1110115)도 매점상품과 같은 로직반영
			//=========================================================================================
			//매점상품은 26~말일 평달에는 매입불가처리, 3 6 9 12월은 26~말일 내역을 31일 전표화 한번 더 하므로, 가능처리
		    //if (ds_listInput.GetColumn(ds_listInput.row, "ACCTCD") == "1120223")
		    if ((ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120223") || 
		        (ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1110115"))
			//=========================================================================================
			// (2013-09-25 변경) 끝
			//=========================================================================================		        
		    {
		    								
				//if ( 
				//     (toNumber(substr(ds_listInput.GetColumn(ds_listInput.row, "ADJ_DATE"), 4, 2)) % toNumber(3)) != 0
				//   )
				//{
					
					if (gfn_subStr(ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE"), 6, 2)>= "26")
					{
						
						g_Message("EE", "매점상품과 예금(업장전도금)은 26일 이후로 등록할 수 없습니다." + "\n" +
									    "회계팀으로 문의하여 주십시요." + "\n" +
								        "확인하여 주십시요.");
						return false;											
					}				
				//}				
			}
			//매점상품은 26~말일 평달에는 매입불가처리, 3 6 9 12월은 26~말일 내역을 31일 전표화 한번 더 하므로, 가능처리

            if (ds_listInput.getColumn(ds_listInput.rowposition, "AMT") !=
                 (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_AMT") + n_VAT))
            {

				g_Message("EE", "발생금액 = (공급가 + 부가세) 여야 합니다. 확인하여 주십시요.");
			    return false;
			}


            if (
                 (ds_listInput.getColumn(ds_listInput.rowposition, "AMT") <  n_NOPAY_AMT) &&
                 (numFormat(n_NOPAY_AMT)!= "0")
               )
            {

				g_Message("EE", "발생금액보다 미지급금이 클수 없습니다. 확인하여 주십시요");
				me_NOPAY_AMT.setFocus();
			    return false;
			}

            if (gfn_length(gfn_trim(ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DESC")))== 0)
            {

				g_Message("EE", "적요를 입력하여 주십시요.");
				edt_ADJ_DESC.setFocus();
			    return false;
			}

            if (
                 (st_Aditem1.userdata != "") &&
                 (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ADITEM1"))== 0)
               )
            {

				g_Message("EE", "관리항목1을 선택하여 주십시요.");
				edt_ADITEM1.setFocus();
			    return false;
			}

            if (
                 (st_Aditem2.userdata != "") &&
                 (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ADITEM2"))== 0)
               )
            {

				g_Message("EE", "관리항목2을 선택하여 주십시요.");
				edt_ADITEM2.setFocus();
			    return false;
			}

            if (
                 (st_Aditem3.userdata != "") &&
                 (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ADITEM3"))== 0)
               )
            {

				g_Message("EE", "관리항목3을 선택하여 주십시요.");
				edt_ADITEM3.setFocus();
			    return false;
			}

            if (
                 (st_Aditem4.userdata != "") &&
                 (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ADITEM4"))== 0)
               )
            {

				g_Message("EE", "관리항목4을 선택하여 주십시요.");
				edt_ADITEM4.setFocus();
			    return false;
			}

            if (
                 (st_Project.userdata != "") &&
                 (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "PROJECT"))== 0)
               )
            {

				g_Message("EE", "프로젝트를 선택하여 주십시요.");
				edt_PROJECT_ID.setFocus();
			    return false;
			}

            if (
                 (st_Budcls.userdata != "") &&
                 (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "BUD_CLS"))== 0)
               )
            {

				g_Message("EE", "관리유형을 선택하여 주십시요.");
				edt_BUD_CLS.setFocus();
			    return false;
			}

			//세금계산서/계산서일 경우 거래처 선택으로.....................
            if (
                 (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "001") ||
                 (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "002") ||
                 (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "009")
               )
            {
//alert(ds_listInput.GetColumn(ds_listInput.row, "CUSTCD"));
				if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD"))== "0")
				{

					g_Message("EE", "거래처를 선택하여 주십시요.");
					edt_CUSTCD.setFocus();
					return false;
				}

				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TAX_DATE"))== 0)
				{

					g_Message("EE", "세금계산서 발행일을 선택하여 주십시요.");
					cal_TAX_DATE.setFocus();
					return false;
				}
				
	
				//======================추가 시작========================
				// 전도금정산 마감기능 추가
				// 20141002 이숙자 요청 by 김장욱 SR#(CH201409_00076)
				//-------------------------------------------------------
				if(closeYn()){
					g_Message("EE", "전도금 정산이 마감되었습니다. 회계팀에 문의해 주세요.");
					return;
				}				

	
				if (gfn_subStr(ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE"), 0, 6)!=
					gfn_subStr(ds_listInput.getColumn(ds_listInput.rowposition, "TAX_DATE"), 0, 6)){
				
			
				
					if (!g_Confirm("02", "정산일과 세금계산서(계산서)발행일의\n월이 상이합니다." + "\n" +
								         "발행일을 확인하셨습니까?")){
						return false;
					}             
				}
						
			}
			//세금계산서/계산서일 경우 거래처 선택으로.....................
			
			//전자세금계산서:체크##############################################
            if (
                 (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "001") || //세금계산서/계산서
                 (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "002")
               )
            {

				if (gfn_length(gfn_trim(ds_listInput.getColumn(ds_listInput.rowposition, "TAXNO")))== 0)
				{

					g_Message("EE", "세금계산서No을 입력하여 주십시요.");
					edt_TAXNO.setFocus();
					return false;
				}
				
				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TAX_IF_GB"))== 0)
				{

					g_Message("EE", "전자세금계산서여부 를 선택하여 주십시요.");
					cbo_TAX_IF_GB.setFocus();
					return false;
				}
					
					
				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TAX_SEND_GB"))== 0)
				{

					g_Message("EE", "역발행여부 를 선택하여 주십시요.");
					cbo_TAX_SEND_GB.setFocus();
					return false;
				}
				
				
				//첨부파일 검증##########################################################
				if (
					 (f_ROLE_YN != "Y") &&
					 (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE") >= "20100401") &&
					 (ds_listInput.getColumn(ds_listInput.rowposition, "TAX_IF_GB") == "Y")
					)
				{
				
				    
					//첨부파일존재 검증###############################################################
					// if (ds_EBill.rowcount == 0)
					// {
					
						// g_Message("EE", "전자세금계산서 첨부파일이 존재하지 않습니다.\n확인하여 주십시요.");		
						// return false;					
					// }
					//첨부파일존재 검증###############################################################
									
					
					if (ds_EBill.rowcount > 0){
					
						//발행일자 검증###############################################################
						if (ds_listInput.getColumn(ds_listInput.rowposition, "TAX_DATE") !=  ds_EBill.getColumn(ds_EBill.rowposition, "IssueDateTime"))
						{
						
							g_Message("EE", "전자세금계산서 첨부파일과 발행일자가 상이합니다.\n확인하여 주십시요.");		
							return false;					
						}
						//발행일자 검증###############################################################
					
						//발행번호 검증###############################################################
						if (ds_listInput.getColumn(ds_listInput.rowposition, "TAXNO") !=  ds_EBill.getColumn(ds_EBill.rowposition, "IssueID"))
						{
						
							g_Message("EE", "전자세금계산서 첨부파일과 발행번호가 상이합니다.\n확인하여 주십시요.");		
							return false;					
						}
						//발행번호 검증###############################################################
						
						
						//고객사 검증###############################################################
						if (fn_GetTaxInvoiceTradeSettlement(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD")) !=  ds_EBill.getColumn(ds_EBill.rowposition, "InvoicerParty_ID"))
						{
						
							g_Message("EE", "전자세금계산서 첨부파일과 고객사가 상이합니다.\n확인하여 주십시요.");		
							return false;					
						}
						//고객사 검증###############################################################		
									
						//공급가 검증###############################################################
						if (toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_AMT")) != toNumber(ds_EBill.getColumn(ds_EBill.rowposition, "ChargeTotalAmount")))
						{
						
							g_Message("EE", "전자세금계산서 첨부파일과 공급가가 상이합니다.\n확인하여 주십시요.");		
							return false;					
						}
						//공급가 검증###############################################################			
												
						//부가세 검증###############################################################
						if (toNumber(n_VAT) != toNumber(ds_EBill.getColumn(ds_EBill.rowposition, "TaxTotalAmount")))
						{
						
							g_Message("EE", "전자세금계산서 첨부파일과 부가세가 상이합니다.\n확인하여 주십시요.");		
							return false;					
						}
						//부가세 검증###############################################################												
					}				
				}
				//첨부파일 검증##########################################################
				
				
				
				//부가세전자세금계산서 2011년 전자세금계산서 의무화에 따른 체크####
				if (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "001")  //세금계산서
				{
					var str_TAX_IF_GBError;
					str_TAX_IF_GBError = "";
					
					str_TAX_IF_GBError = fn_GetIs_GA_TAX_IF_GB_CHK_FUNError(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD"), 
																					 ds_listInput.getColumn(ds_listInput.rowposition, "TAX_DATE"), 
																					 ds_listInput.getColumn(ds_listInput.rowposition, "TAX_IF_GB"), 
																					 ds_listInput.getColumn(ds_listInput.rowposition, "TAX_SEND_GB")); 
					
					if (gfn_length(str_TAX_IF_GBError)!= 0){
					
							g_Message("EE", "[전자세금계산서관련] " + str_TAX_IF_GBError + "\n확인하여 주십시요.");		
							// 면세사업자일 경우도 계산서 발행이 되게 한다. FC회계팀 이숙자 20140509 SR은 나중에 올림.
							// 수도광열비(가스료, 전기료)를 병원에서 대납해줌. 실세금계산서는 업장으로 발행이 됨.
							if(str_TAX_IF_GBError ==! "해당거래처는 세금계산서를 발행할 수 없습니다."){
								return false;							
							}

					}
				}
				//부가세전자세금계산서 2011년 전자세금계산서 의무화에 따른 체크####
			}
			else {
			
			
				if (gfn_length(gfn_trim(ds_listInput.getColumn(ds_listInput.rowposition, "TAXNO")))!= 0)
				{

					g_Message("EE", "세금계산서No가 올수 없습니다.");
					edt_TAXNO.setFocus();
					return false;
				}
							
				if (ds_listInput.getColumn(ds_listInput.rowposition, "TAX_IF_GB") == "Y")
				{

					g_Message("EE", "전자세금계산서여부 가 Y 일수 없습니다.");
					cbo_TAX_IF_GB.setFocus();
					return false;
				}		
									
				if (ds_listInput.getColumn(ds_listInput.rowposition, "TAX_SEND_GB") == "2")
				{

					g_Message("EE", "역발행여부 가 Y 일수 없습니다.");
					cbo_TAX_SEND_GB.setFocus();
					return false;
				}										
			
			}

			//전자세금계산서:체크##############################################
			
			//--------------------------------------------------------------------------
			// 세금계산서/계산서/현금영수증의 정산처리월과 발행일의 월이 같은지 체크한다.(시작)########
			// 20140603 FC회계팀 이숙자 요청()
			//--------------------------------------------------------------------------
			if (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "001" || 
				ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "002" || 
				ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "009"
			    )  // 세금계산서/계산서/현금영수증
			{
				if(fn_TaxBillInputYn()){
					g_Message("EE", "세금계산서/계산서/현금영수증의 경우 정산처리월과 발행일의 월이 다를경우 등록할 수 없습니다. 확인하여 주십시요.\n" + 
					                "궁금한 사항은 회계팀으로 문의하여 주십시요."
					         );
					return false;
				}
			}
			//--------------------------------------------------------------------------
			// 세금계산서의 정산처리월과 발행일의 월이 같은지 체크한다.(종료)########
			//--------------------------------------------------------------------------
				

		    //접대비 세부사항 체크...........................................
			if (cbo_RCP_GUBUN.enable == true)
			{

				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_GUBUN"))== 0)
				{

					g_Message("EE", "접대비유형을 선택하여 주십시요.");
					cbo_RCP_GUBUN.setFocus();
					return false;
				}

				if (gfn_length(gfn_trim(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_SAUPNO")))== 0)
				{

					g_Message("EE", "사업자등록번호를 입력하여 주십시요.");
					me_RCP_SAUPNO.setFocus();
					return false;
				}

				if (gfn_length(gfn_trim(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_CUSTNM")))== 0)
				{

					g_Message("EE", "상호를 입력하여 주십시요.");
					edt_RCP_CUSTNM.setFocus();
					return false;
				}

				if (gfn_length(gfn_trim(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_DRNAME")))== 0)
				{

					g_Message("EE", "대표자명을 입력하여 주십시요.");
					edt_RCP_DRNAME.setFocus();
					return false;
				}

				if (gfn_length(gfn_trim(ds_listInput.getColumn(ds_listInput.rowposition, "RCP_ADDR")))== 0)
				{

					g_Message("EE", "주소를 입력하여 주십시요.");
					edt_RCP_ADDR.setFocus();
					return false;
				}

				if (
				     ds_listInput.getColumn(ds_listInput.rowposition, "AMT") !=
				     (ds_listInput.getColumn(ds_listInput.rowposition, "RCP_AMT") +
				      ds_listInput.getColumn(ds_listInput.rowposition, "SVC_AMT"))
				   )
				{

					g_Message("EE", "(접대비 + 봉사료) = 발생금액 이어야 합니다. 확인하여 주십시요.");
					me_RCP_AMT.setFocus();
					return false;
				}

				if (
				     (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "001") ||
				     (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "002")
				   )
				{

					if (
						 (ds_listInput.getColumn(ds_listInput.rowposition, "RCP_GUBUN") != "003") &&
						 (ds_listInput.getColumn(ds_listInput.rowposition, "RCP_GUBUN") != "004")
					   )
					{

						g_Message("EE", cbo_ADJ_KIND.text + "  정산은 접대비유형을 세금계산서항목 중에서 선택하여야 합니다.");
						cbo_RCP_GUBUN.setFocus();
						return false;
					}
				}

				if (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") == "009")
				{

					if (ds_listInput.getColumn(ds_listInput.rowposition, "RCP_GUBUN") != "008")
					{

						g_Message("EE", cbo_ADJ_KIND.text + "  정산은 접대비유형을 현금영수증 항목 중에서 선택하여야 합니다.");
						cbo_RCP_GUBUN.setFocus();
						return false;
					}
				}

				if (
				     (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") != "001") &&
				     (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") != "002")
				   )
				{

					if (
						 (ds_listInput.getColumn(ds_listInput.rowposition, "RCP_GUBUN") == "003") ||
						 (ds_listInput.getColumn(ds_listInput.rowposition, "RCP_GUBUN") == "004")
					   )
					{

						g_Message("EE", cbo_ADJ_KIND.text + "  정산은 접대비유형을 세금계산서항목 중에서 선택하실수 없습니다.");
						cbo_RCP_GUBUN.setFocus();
						return false;
					}
				}

				if (
				     (ds_listInput.getColumn(ds_listInput.rowposition, "RCP_GUBUN") == "008") &&
				     (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND") != "009")
				   )
				{

					g_Message("EE", cbo_ADJ_KIND.text + "  정산은 접대비유형을 현금영수증 항목 중에서 선택하실수 없습니다.");
					cbo_RCP_GUBUN.setFocus();
					return false;
				}


				if (
				     (ds_listInput.getColumn(ds_listInput.rowposition, "RCP_GUBUN") == "001") ||
				     (ds_listInput.getColumn(ds_listInput.rowposition, "RCP_GUBUN") == "003") ||
				     (ds_listInput.getColumn(ds_listInput.rowposition, "RCP_GUBUN") == "005")
				   )
				{

					if (ds_listInput.getColumn(ds_listInput.rowposition, "AMT") > 50000)
					{

						g_Message("EE", cbo_RCP_GUBUN.text + "  유형은 5만원을 초과할수 없습니다.");
						me_ADJ_AMT.setFocus();
						return false;
					}
				}

				if (
				     (ds_listInput.getColumn(ds_listInput.rowposition, "RCP_GUBUN") == "002") ||
				     (ds_listInput.getColumn(ds_listInput.rowposition, "RCP_GUBUN") == "004") ||
				     (ds_listInput.getColumn(ds_listInput.rowposition, "RCP_GUBUN") == "006")
				   )
				{

					if (ds_listInput.getColumn(ds_listInput.rowposition, "AMT") <= 50000)
					{

						g_Message("EE", cbo_RCP_GUBUN.text + "  유형은 5만원이하 일수 없습니다.");
						me_ADJ_AMT.setFocus();
						return false;
					}
				}
			}
			//접대비 세부사항 체크...........................................


			//매점상품/식재료 현지구매 상세내역 check......................
			if (
					(ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120223") || //매점상품
					(
					   (ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120311") &&   //식재료
					   (
					     (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE") > "20080631") &&
					     (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE") <= "20081231")
					   )
					)   
			   )
			{

					if (ds_Commodity.rowcount == 0)
					{

						g_Message("EE", "매점상품 혹은 식재료의 상품상세내역을 입력하여 주십시요");
						return false;
					}

					for (i=0;i< ds_Commodity.rowcount;i++)
					{


						if (
						     (gfn_length(ds_Commodity.getColumn(i, "ITEM_CODE"))!= 0) &&
						     (
						       (numFormat(ds_Commodity.getColumn(i, "TRANS_QTY"))== "0") ||
						       (numFormat(ds_Commodity.getColumn(i, "TRANS_UPRICE"))== "0")
						     )
						   )
						{

								g_Message("EE", "현지구매상세 정보에 수량 혹은 단가 정보가 없습니다.");
								return false;
						}
						
						if (
						    (ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120311")    //식재료
						   ) 
						{
							if  ( 
							       (
									 (ds_listInput.getColumn(ds_listInput.rowposition, "ADITEM1") == "001") &&
									 (ds_Commodity.getColumn(i, "TAX_CODE") != "100")
								   )  ||
								   (
									 (ds_listInput.getColumn(ds_listInput.rowposition, "ADITEM1") == "002") &&
									 (ds_Commodity.getColumn(i, "TAX_CODE") != "210")
								   )
								)
						    {
						    
                                g_Message("EE", "현지구매상세 정보와 관리항목1의\n과/면세 정보가 일치하지 않습니다.\n" +
                                                "확인하여 주십시요.");
								return false;
						    }					
						
						}
						    
						    
					}
		    }
		    //매점상품/식재료 현지구매 상세내역 check......................


            //전도금 잔액 체크..................................
            var real_JanAmt;
            real_JanAmt = 0;         
            real_JanAmt  = fn_GetRemainder(ds_cond,  "잔액체크",
													 ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"),
                                                     ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID"),
                                                     ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND"),
                                                     ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_AMT") + n_VAT - n_NOPAY_AMT );
//trace(real_JanAmt);
            if (numFormat(real_JanAmt)!= "0"){

				g_Message("EE", "전도금 " +  numFormat(real_JanAmt)+ " 원이 부족합니다.");
			    return false;
		    }
            //전도금 잔액 체크..................................

			//계정날짜범위강제입력권한 저장가능사용자 권한 Query ##########
			//alert(ds_listInput.GetColumn(ds_listInput.row, "ACCTCD"));
            if (!fn_GetIsACCTCD_DATE_Save(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD"), ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE"))){

 			   g_Message("EE", "해당계정은 사용기간이 맞지않는 계정코드입니다.");
			   return false;
			 };

            //일마감 및 전표마감 체크...........................
			
			//마감체크###############################################
			if (!fn_CheckMAClosing(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"), ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE"), "003"))
				return false;                
			//마감체크###############################################
			            
            var str_SlipClose;
            str_SlipClose = fn_GetUpjangSlipClose("전표체크", ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID"),
																		 ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"),
																		 ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD"),
																		 ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE"));

            if (gfn_length(str_SlipClose)!= 0){

				g_Message("EE", str_SlipClose);
				return false;
            }

            str_SlipClose = "";
            str_SlipClose = fn_GetUpjangSlipClose("계정별월마감체크", ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID"),
																		          ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"),
																				  ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD"),
																				  ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE"));

            if (gfn_length(str_SlipClose)!= 0){

				g_Message("EE", str_SlipClose);
				return false;
            }
            
            if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID"))!= "0"){
            
				
				real_JanAmt = 0;
				real_JanAmt  = fn_GetRemainder(ds_cond,  "미지급금액체크",
														 ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"),
														 ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID"),
														 ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND"),
														 ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_AMT") + n_VAT - n_NOPAY_AMT );
	
				if (numFormat(ds_cond.getColumn(ds_cond.rowposition, "JANAMT"))!= "0"){
		
					g_Message("EE", "해당 데이터는 미지급지불한 건이 있으므로 변경할 수 없습니다." + "\n" +
						  "삭제의 경우 먼저 미지급지급 정산을 삭제하신 후 삭제하여 주십시요.");
				    return false;
				}				
			}
			
            //현지구매창고마감체크#############################################################################
            if (ds_Commodity.rowcount > 0){
            
				str_SlipClose = "";
				str_SlipClose = fn_GetPO_CLOSE("전도금현지구매체크", ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"),
																				 ds_Commodity,
																				 ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE"));
	
				if (gfn_length(str_SlipClose)!= 0){
	
					g_Message("EE", str_SlipClose);
					return false;
				}
			}
		    //현지구매창고마감체크#############################################################################		
			
			//일마감 및 전표마감 체크...........................

		}



		//전도금 저장#############################################################
	    if (str_Gubun == "Master"){

		    var real_NEW_ADV_ID;
			//신규 ADV_ID취득.............................................
			if (GetRowType(ds_listInput,ds_listInput.rowposition)== "insert"){
				real_NEW_ADV_ID = fn_GetNEW_MAS_ADVANCE_S(ds_cond);
				//alert('real_NEW_ADV_ID : ' + real_NEW_ADV_ID);
			}

			//현지구매TR_NUM .............................................
			if ((ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120223") ||//매점상품,식재료 계정일 경우
				((ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120311") &&
				  (  (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE") > "20080631") &&
				     (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE") <= "20081231")
				  )
				)  
			   )
			{			
				var real_TR_NUM, real_TRANS_ID, real_DEPT_ID;
				
				real_TR_NUM  = fn_GetPO_TR_NUM(ds_cond);
				real_DEPT_ID = fn_GetDEPT_IDPerUPJANG(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"));
				
				
				for (i=0;i<ds_Commodity.rowcount;i++){
					
					if (GetRowType(ds_listInput,ds_listInput.rowposition)== "insert"){
						ds_Commodity.setColumn(i, "ADV_ID", real_NEW_ADV_ID);						
					}
					
					//현지구매TRANS_ID ###################################				
					real_TRANS_ID = fn_GetPO_TRANS_ID(ds_cond);				
					
					//alert("fn_GetPO_TRANS_ID:" + real_TRANS_ID);
						
					ds_Commodity.setColumn(i, "TRANS_ID", real_TRANS_ID);	
					ds_Commodity.setColumn(i, "SOURCE_ID", real_TRANS_ID);
					
					ds_Commodity.setColumn(i, "TR_NUM", real_TR_NUM);					
					ds_Commodity.setColumn(i, "TRANS_DATE", ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE"));
					ds_Commodity.setColumn(i, "TRANS_DEPT_ID", real_DEPT_ID);
					ds_Commodity.setColumn(i, "ACCTCD", ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD"));
					ds_Commodity.setColumn(i, "BUD_CLS", ds_listInput.getColumn(ds_listInput.rowposition, "BUD_CLS"));
					ds_Commodity.setColumn(i, "CUSTCD", ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD"));
					ds_Commodity.setColumn(i, "REMARK", "FS전도금 " + ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DESC"));
					ds_Commodity.setColumn(i, "BUDDEPT_ID", ds_listInput.getColumn(ds_listInput.rowposition, "BUDDEPT_ID"));	
				}						
			}

			// action 정보 초기화
			fsp_clear(this);			
			
			//전도금정산 저장............................................................................
			if (GetRowType(ds_listInput,ds_listInput.rowposition)== "insert"){
			
			    ds_listInput.setColumn(ds_listInput,"ADV_ID", real_NEW_ADV_ID);	
			    	
			    	//alert('INSERT');
			    
				fsp_addSingle(this, "ma/maa:MAA10030E_I001");
			}
			else if (GetRowType(ds_listInput,ds_listInput.rowposition)== "update"){
			
			    
				fsp_addSingle(this, "ma/maa:MAA10030E_U001");
			}
			
			//현지구매 삭제/저장..........................................................................
			if (
					(ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120223") ||//매점상품,식재료 계정일 경우
					( 
					  (ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120311") &&
					  (
					     (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE") > "20080631")&&
					     (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE") <= "20081231")
					  )
					)  
			   )
			{
			    
				fsp_addSingle(this, "ma/maa:MAA10030E_D002");
				fsp_addSingle(this, "ma/maa:MAA10030E_D003");
				
				fsp_addMulti(this, "ma/maa:MAA10030E_I002" );
				fsp_addMulti(this, "ma/maa:MAA10030E_I003" );							
			}				
			

			f_Saved_ADV_ID = ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID");
			fsp_callService(this, "", "", "ds_cond=ds_listInput:A ds_Commodity=ds_Commodity:A", "",  "", "fn_AfterSaveSearch");			
	    }
		return true;

}


function before_DeleteCheck(str_Gubun)
{

		
		//권한에 따른 저장/삭제 가능체크#########################################################################
/*
		if (
		    (f_ROLE_YN != "Y") &&
		    (!fn_GetSaveAuthBy_AuthLevel(ds_listInput.GetColumn(ds_listInput.row, "UPJANG")))
		   ) return false;
*/
		//권한에 따른 저장/삭제 가능체크#########################################################################		
 		var n_VAT = gfn_isNull(ds_listInput.getColumn(ds_listInput.rowposition, "VAT")) ? 0 : ds_listInput.getColumn(ds_listInput.rowposition, "VAT");	//  VAT 값이 0으로 초기값 세팅
 		var n_NOPAY_AMT = gfn_isNull(ds_listInput.getColumn(ds_listInput.rowposition, "NOPAY_AMT")) ? 0 : ds_listInput.getColumn(ds_listInput.rowposition, "NOPAY_AMT");	//  NOPAY_AMT 값이 0으로 초기값 세팅
 		
 		if ( 
			(ds_listInput.rowcount == 0) ||
			(numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID"))== "0")
		   )
		{

			return;
		}

	    if (str_Gubun == "Master"){

trace("1");
			SetRowType(ds_listInput,ds_listInput.rowposition,"delete");
			SetRowType(ds_Commodity,ds_listInput.rowposition,"delete");
trace("2");			
			
            //일마감 및 전표마감 체크...........................
            var str_SlipClose;
            str_SlipClose = fn_GetUpjangSlipClose("전표체크", ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID"),
																		 ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"),
																		 ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD"),
																		 ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE"));

            if (gfn_length(str_SlipClose)!= 0){

				g_Message("EE", str_SlipClose);
				return false;
            }

            str_SlipClose = "";
            str_SlipClose = fn_GetUpjangSlipClose("계정별월마감체크", ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID"),
																		          ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"),
																				  ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD"),
																				  ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE"));

            if (gfn_length(str_SlipClose)!= 0){

				g_Message("EE", str_SlipClose);
				return false;
            }
            
            if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID"))!= "0"){
            
				/*
				str_SlipClose = "";
				str_SlipClose = fn_GetUpjangSlipClose("미지급금액체크", ds_cond, ds_listInput.GetColumn(ds_listInput.row, "ADV_ID"),
																				   ds_listInput.GetColumn(ds_listInput.row, "UPJANG"),
																				   ds_listInput.GetColumn(ds_listInput.row, "ACCTCD"),
																				   ds_listInput.GetColumn(ds_listInput.row, "ADJ_DATE"));
	
				if (length(str_SlipClose) != 0){
	
					alert(str_SlipClose);
					return false;
				}
				*/
					
				var real_JanAmt = 0;
				real_JanAmt  = fn_GetRemainder(ds_cond,  "미지급금액체크",
														 ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"),
														 ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID"),
														 ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_KIND"),
														 ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_AMT") + n_VAT - n_NOPAY_AMT );
	
				if (numFormat(ds_cond.getColumn(ds_cond.rowposition, "JANAMT"))!= "0"){
		
					g_Message("EE", "해당 데이터는 미지급지불한 건이 있으므로 변경할 수 없습니다." + "\n" +
						  "삭제의 경우 먼저 미지급지급 정산을 삭제하신 후 삭제하여 주십시요.");
					return false;
				}				
				
							
			}
			//일마감 및 전표마감 체크...........................
			
			//삭제전 Confirm......................................						
			if (ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "2110314")//미지급금(FS업장전도금) 일경우 MA_ADV_LINE 삭제..
			{	
				
				if (!g_Confirm("01", "미지급금(FS업장전도금) 삭제는" + "\n" + 
				                     "해당 지급내역을 함께 삭제합니다." + "\n" + 
				                     "삭제하시겠습니까?"))
				{
				     return false;
				}
			}
			else
			{
			
				if (!g_Confirm("01", "정산내역을 삭제하시겠습니까?"))
				{
				     return false;
				}			
			}
			//삭제전 Confirm......................................
					
					

            //현지구매창고마감체크#############################################################################
            var str_SlipClose;
            if (ds_Commodity.rowcount > 0){
            
				str_SlipClose = "";
				str_SlipClose = fn_GetPO_CLOSE("전도금현지구매체크", ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"),
																				 ds_Commodity,
																				 ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE"));
	
				if (gfn_length(str_SlipClose)!= 0){
	
					g_Message("EE", str_SlipClose);
					return false;
				}
			}
		    //현지구매창고마감체크#############################################################################
		        						    					
		}



		
	    if (str_Gubun == "Master"){
			
			// action 정보 초기화
			fsp_clear(this);			
			
			//미지급금(FS업장전도금) 일경우 MA_ADV_LINE 삭제............................................
			if (ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "2110314"){
			
				fsp_addSingle(this, "ma/maa:MAA10030E_D001");				
			}

			//현지구매 삭제...............................................................................
			if (
					(ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120223") ||//매점상품,식재료 계정일 경우
					(
					   (ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120311") &&			
					   (
							 (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE") > "20080631")&&
							 (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE") <= "20081231")
					   )				
					)				
			   )
			{
				
				fsp_addMulti(this, "ma/maa:MAA10030E_D002" );
				fsp_addMulti(this, "ma/maa:MAA10030E_D003" );
			}			

			//전도금정산 삭제.............................................................................
			fsp_addSingle(this, "ma/maa:MAA10030E_D004");					

			f_Saved_ADV_ID = ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID");
			fsp_callService(this, "", "", "ds_cond=ds_listInput:A", "",  "", "fn_AfterDeleteSearch");									
	    }
		return true;

}



function edtBtn_UPJANGQuery_OnClick(obj:Button, e:ClickEventInfo)
{
    
	fn_edtBtn_OnClick(obj);
	fn_DataSetAllClear();
	fn_GetIsGHRValidCheck(ds_cond, edt_UPJANGQuery.userdata);
}


function edtBtn_UPJANG_OnClick(obj:Button, e:ClickEventInfo)
{

	fn_sql_common_setup(strMAQuery_Upjang,
						strMAQuery_UpjangKeyField,
						strMAQuery_UpjangValueField,
						strMAQuery_UpjangKeyFieldNM,
						strMAQuery_UpjangValueFieldNM,
						"",
						"",
						""	,
						strMAQuery_UpjangCaption,
						strMAQuery_UpjangAllField);

	if (gds_sql_common.getColumn(0, "ret_code") != ""){

		edt_UPJANG.userdata = gds_sql_common.getColumn(0, "ret_code");
		edt_UPJANG.value     = gds_sql_common.getColumn(0, "ret_name");

	}
}



function edtBtn_BUDDEPT_ID_OnClick(obj:Button, e:ClickEventInfo)
{
    var strMAQuery_NewAuthDEPT_ID = "";
    strMAQuery_NewAuthDEPT_ID = strMAQuery_DEPT_ID;
    
	switch(g_AuthLevel)
	{
		case "00":  //일반관리자
			strMAQuery_NewAuthDEPT_ID = strMAQuery_NewAuthDEPT_ID + " AND DEPT_ID IN (SELECT DEPT_ID FROM SCO_UPJANG_MST_V WHERE UPJANG = '" + g_Upjang + "') ";
			break;	
		case "10":  //영양사
			strMAQuery_NewAuthDEPT_ID = strMAQuery_NewAuthDEPT_ID + " AND DEPT_ID IN (SELECT DEPT_ID FROM SCO_UPJANG_MST_V WHERE UPJANG = '" + g_Upjang + "') ";
			break;
		case "12":  //리더영양사
			strMAQuery_NewAuthDEPT_ID = strMAQuery_NewAuthDEPT_ID + " AND DEPT_ID IN (SELECT DEPT_ID FROM SCO_UPJANG_MST_V WHERE LEADER_SABUN = '" + g_EmpNo + "') ";
			break;
		case "14": //소팀장
			strMAQuery_NewAuthDEPT_ID = strMAQuery_NewAuthDEPT_ID + " AND DEPT_ID IN (SELECT DEPT_ID FROM SCO_UPJANG_MST_V WHERE TM_CD = '" + g_Tm_Cd + "') ";
			break;
		case "16": //팀장
			strMAQuery_NewAuthDEPT_ID = strMAQuery_NewAuthDEPT_ID + " AND DEPT_ID IN (SELECT DEPT_ID FROM SCO_UPJANG_MST_V WHERE TM_CD = '" + g_Tm_Cd + "') "; 
			break;
		case "18": //경영자
			strMAQuery_NewAuthDEPT_ID = strMAQuery_NewAuthDEPT_ID;
			break;	
		case "99": //전산관리자(현업)
			strMAQuery_NewAuthDEPT_ID = strMAQuery_NewAuthDEPT_ID;
			break;	
		case "999": //전산관리자(전산)
			strMAQuery_NewAuthDEPT_ID = strMAQuery_NewAuthDEPT_ID;
			break;						
		default:
			strMAQuery_NewAuthDEPT_ID = strMAQuery_NewAuthDEPT_ID + " AND DEPT_ID IN (SELECT DEPT_ID FROM SCO_UPJANG_MST_V WHERE UPJANG = '" + g_Upjang + "') ";
			break;
	}
	
	fn_sql_common_setup(strMAQuery_NewAuthDEPT_ID,
						strMAQuery_DEPT_IDKeyField,
						strMAQuery_DEPT_IDValueField,
						strMAQuery_DEPT_IDKeyFieldNM,
						strMAQuery_DEPT_IDValueFieldNM,
						"",
						"",
						" AND (V.EXP_CD='Y') ",
						strMAQuery_DEPT_IDCaption,
						strMAQuery_DEPT_IDAllField);

	if (gds_sql_common.getColumn(0, "ret_code") != ""){

		edt_BUDDEPT_ID.userdata = gds_sql_common.getColumn(0, "ret_code");
		edt_BUDDEPT_ID.value     = gds_sql_common.getColumn(0, "ret_name");
	}
}

function edtBtn_ACCTCD_OnClick(obj:Button, e:ClickEventInfo)
{
	var str_LIKE = "";
	var str_Check = "";
	
	if (cal_ADJ_DATE.value <= "20081231"){
		
		str_Check = " AND (ACCTCD IN (SELECT CODE FROM SCC_COMMON_CODE WHERE GROUP_CODE = 'MA0043')) ";
		
	}
	else {
	
		str_Check = " AND (DRD1='1') ";
	}
	

	
	fn_sql_common_setup(strMAQuery_Acctcd,
						strMAQuery_AcctcdKeyField,
						strMAQuery_AcctcdValueField,
						strMAQuery_AcctcdKeyFieldNM,
						strMAQuery_AcctcdValueFieldNM,
						"",
						"",
						str_Check,
						strMAQuery_AcctcdCaption,
						"ACCTCD;ACCTNM6");

	if (gds_sql_common.getColumn(0, "ret_code") != ""){
		
		edt_ACCTCD.userdata = gds_sql_common.getColumn(0, "ret_code");
		edt_ACCTCD.value    = gds_sql_common.getColumn(0, "ret_name");
		
		trace(gds_sql_common.getColumn(0, "ret_name"));
		//trace(edt_ACCTCD.value);		

		Set_ACCTCD_OnChange(edt_ACCTCD.userdata, edt_ACCTCD.value);
		
		edt_ACCTCD.value    = gds_sql_common.getColumn(0, "ret_name");
		ds_listInput.setColumn(ds_listInput.rowposition, "ACCTNM", edt_ACCTCD.value);
		
		cbo_ADJ_KIND.setFocus();
	}
	
	//==========================시작=============================
	// 20140829 정승화(SR201408_04325) by 김장욱
	// 잡급처리시 E-HR에서 연계된 일용직List를 보여주고 
	// 1)적요, 2)발행금액,공급가액, 3)정산일자를 자동으로 넣어주고
	// 수정하지 못하게 한다.
	//-----------------------------------------------------------
	
	// 잡급대체가계정(9410119)이면 공급가액을 선택하게 한다.
	if (edt_ACCTCD.userdata == "9410119") {
		edtBtn_SupAmt.visible = true;	// 공급가버튼
		me_ADJ_AMT.enable   = false;	// 공급가액
		edt_ADJ_DESC.enable = false;	// 적요
		cal_ADJ_DATE.value   = "";		// 정산일자 초기화
		cal_ADJ_DATE.enable = false;	// 정산일자
		//btn_ADJ_DATE.Visible = false;	// 정산일자 달력팝업
		
		gfn_alert("잡급대체가계정 입력은 공급가 버튼 조회후 선택(자동입력)해 주세요. (회계팀문의)");
	}else{
		edtBtn_SupAmt.visible = false;
		me_ADJ_AMT.enable = true;
		edt_ADJ_DESC.enable = true;
		cal_ADJ_DATE.enable = true;
		btn_ADJ_DATE.visible = true;
	}
	//==========================끝===============================
}


function edtBtn_CUSTCD_OnClick(obj:Button, e:ClickEventInfo)
{
    var F_ArrCol          = new Array(-1);
    var F_ArrColType      = new Array(-1);

	fn_sql_common_setup(strMAQuery_Vat_AdvCustAll,
						strMAQuery_Vat_AdvCustAllKeyField,
						strMAQuery_Vat_AdvCustAllValueField,
						strMAQuery_Vat_AdvCustAllKeyFieldNM,
						strMAQuery_Vat_AdvCustAllValueFieldNM,
						"",
						"",
						"  AND (SAUPNO <> '9999999999') AND (SAUPNO NOT IN (SELECT SUBSTR(SAUPNO, 1, 10) FROM HLDC_ST_UPJANG WHERE SAUPNO IS NOT NULL)) ",
						strMAQuery_Vat_AdvCustAllCaption,
						strMAQuery_Vat_AdvCustAllAllField);

	if (gds_sql_common.getColumn(0, "ret_code") != ""){

		edt_CUSTCD.userdata = gds_sql_common.getColumn(0, "ret_code");
		edt_CUSTCD.value     = gds_sql_common.getColumn(0, "ret_name");

		ds_listInput.setColumn(ds_listInput.rowposition, "CUSTCD", edt_CUSTCD.userdata);
		ds_listInput.setColumn(ds_listInput.rowposition, "CUSTNM", edt_CUSTCD.value);

        //관리항목 거래처 자동세팅####################################
		for (i=1;i<5;i++){
			if ( (eval("st_Aditem" + i).text == "거래처") &&
				 (gfn_length(edt_CUSTCD.userdata)!= 0)
			   )
			{
				eval("edt_ADITEM" + i).userdata    = edt_CUSTCD.userdata;
				eval("edt_ADITEM" + i).value        = edt_CUSTCD.value;

				ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM" + i, edt_CUSTCD.userdata);
				ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM" + i + "NM", edt_CUSTCD.value);
			}
		}
        //관리항목 거래처 자동세팅####################################

		//접대비세부자동세팅###########################################
	    if (cbo_RCP_GUBUN.enable  == true){

			F_ArrCol = [];
			F_ArrCol[0] = "SAUPNO";
			F_ArrCol[1] = "CUSTNM";
			F_ArrCol[2] = "DRNAME1";
			F_ArrCol[3] = "ADDR";
			F_ArrCol[4] = "CUSTCD";


			F_ArrColType[0] = "STRING";
			F_ArrColType[1] = "STRING";
			F_ArrColType[2] = "STRING";
			F_ArrColType[3] = "STRING";
			F_ArrColType[4] = "INT";

			frm_InitSearchDS(ds_cond, ds_RCP_DetailAuto, F_ArrCol, F_ArrColType, "CUSTCD", edt_CUSTCD.userdata, "ma/maa:MAA10030E_S003");

			if (ds_RCP_DetailAuto.rowcount > 0){

				me_RCP_SAUPNO.enable  = false;
				edt_RCP_CUSTNM.enable = false;
				edt_RCP_ADDR.enable   = false;
				edt_RCP_DRNAME.enable = false;


				me_RCP_SAUPNO.value    = ds_RCP_DetailAuto.getColumn(ds_RCP_DetailAuto.rowposition, "SAUPNO");
				edt_RCP_CUSTNM.value   = ds_RCP_DetailAuto.getColumn(ds_RCP_DetailAuto.rowposition, "CUSTNM");
				edt_RCP_ADDR.value     = ds_RCP_DetailAuto.getColumn(ds_RCP_DetailAuto.rowposition, "ADDR");
				edt_RCP_DRNAME.value   = ds_RCP_DetailAuto.getColumn(ds_RCP_DetailAuto.rowposition, "DRNAME1");
			}
		}
	    //접대비세부자동세팅###########################################

	}
	
}


function ds_list_OnRowPosChanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{


	ds_listInput.clearData();
	var row = ds_listInput.addRow();
	ds_listInput.copyRow(row, ds_list, e.newrow);
	ds_listInput.applyChange();

	//edtBtn Component 복사############################
	Set_edtBtn_UserData("Copy");
	//edtBtn Component 복사############################
	
	//현지구매  복사##################################
	Set_ds_Commodity(ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID"));
    //현지구매  복사##################################
    
	Set_ACCTCD_OnChangeDetail();

	edt_UPJANG.enable        = false;
	edtBtn_UPJANG.enable     = false;

	edt_BUDDEPT_ID.enable    = false;
	edtBtn_BUDDEPT_ID.enable = false;

	cal_ADJ_DATE.enable      = false;
	btn_ADJ_DATE.enable      = false;

	edt_ACCTCD.enable        = false;
	edtBtn_ACCTCD.enable     = false;

	Setcbo_ADJ_KIND_Change();

	edt_ADJ_DESC.setFocus();
	
	btn_ImgInsert.enable = false;
	
	
	if (
	    (ds_listInput.rowcount > 0) &&
	    (ds_listInput.getColumn(ds_listInput.rowposition, "TAX_IF_GB") == "Y")
	   ) 
	{   
		btn_ImgInsert.enable = true;
	}
	
}

function Set_ds_Commodity(real_ADV_ID)
{

	ds_Commodity.clearData();
	
	if (numFormat(real_ADV_ID)== "0"){
		
		return;
	}
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/maa:MAA10034P_S001");
	
	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "", "ds_Commodity=ds_list","ADV_ID=" + wrapQuote(real_ADV_ID));	
	http.Sync = false;
}


//edtBtn Component 세팅/초기화####################################################################
function Set_edtBtn_UserData(str_Gubun)
{

	if (str_Gubun == "Copy"){

		//edtBtn Component 초기화############################
		edt_UPJANG.userdata       = ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG");
		edt_UPJANG.value			  = ds_listInput.getColumn(ds_listInput.rowposition, "UPJANGNM");

		edt_BUDDEPT_ID.userdata   = ds_listInput.getColumn(ds_listInput.rowposition, "BUDDEPT_ID");
		edt_BUDDEPT_ID.value		  = ds_listInput.getColumn(ds_listInput.rowposition, "BUDDEPT_IDNM");

		cal_ADJ_DATE.value        = ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE");

		edt_ACCTCD.userdata       = ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD");
		edt_ADITEM1.userdata      = ds_listInput.getColumn(ds_listInput.rowposition, "ADITEM1");
		edt_ADITEM2.userdata   	  = ds_listInput.getColumn(ds_listInput.rowposition, "ADITEM2");
		edt_ADITEM3.userdata   	  = ds_listInput.getColumn(ds_listInput.rowposition, "ADITEM3");
		edt_ADITEM4.userdata      = ds_listInput.getColumn(ds_listInput.rowposition, "ADITEM4");

		edt_BUDDEPT_ID.userdata   = ds_listInput.getColumn(ds_listInput.rowposition, "BUDDEPT_ID");
		edt_CUSTCD.userdata   	  = ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD");
		edt_PROJECT_ID.userdata   = ds_listInput.getColumn(ds_listInput.rowposition, "PROJECT_ID");
		edt_BUD_CLS.userdata      = ds_listInput.getColumn(ds_listInput.rowposition, "PROJECT_ID");

		edt_UPJANG.userdata   	  = ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG");
		
		
	

				
			
		//edtBtn Component 초기화############################
	}
	else if (str_Gubun == "Clear"){

		//edtBtn Component 초기화############################
		edt_ACCTCD.userdata       = "";
		edt_ACCTCD.value          = "";

		edt_ADITEM1.userdata      = "";
		edt_ADITEM1.value          = "";
		st_Aditem1.userdata       = "";
		st_Aditem1.text           = "";


		edt_ADITEM2.userdata   	  = "";
		edt_ADITEM2.value     	  = "";
		st_Aditem2.userdata       = "";
		st_Aditem2.text           = "";

		edt_ADITEM3.userdata   	  = "";
		edt_ADITEM3.value     	  = "";
		st_Aditem3.userdata       = "";
		st_Aditem3.text           = "";

		edt_ADITEM4.userdata      = "";
		edt_ADITEM4.value          = "";
		st_Aditem4.userdata       = "";
		st_Aditem4.text           = "";

		edt_BUD_CLS.userdata      = "";
		edt_BUD_CLS.value          = "";
		st_Budcls.userdata        = "";
		st_Budcls.text            = "";

		edt_PROJECT_ID.userdata    = "";
		edt_PROJECT_ID.value        = "";
		st_Project.userdata        = "";
		st_Project.text            = "";


		//edt_BUDDEPT_ID.UserData    = "";
		//edt_BUDDEPT_ID.Text        = "";


		edt_CUSTCD.userdata   	   = "";
		edt_CUSTCD.value      	   = "";

		//edt_UPJANG.UserData   	   = "";
		//edt_UPJANG.Text       	   = "";
		//edtBtn Component 초기화############################
	}

}
//edtBtn Component 세팅/초기화####################################################################



//잔액조회 POPUP################################################################
function btn_JanQuery_OnClick(obj:Button, e:ClickEventInfo)
{
	if ( (edt_UPJANGQuery.userdata != "") && (cal_ADJ_DATEQuery.value != "") ){

		gfn_dialog("", "U_MAA::MAA10030P.xfdl","");
	}

}
//잔액조회 POPUP################################################################








function Set_ACCTCD_OnChange(str_ACCTCD, str_ACCTNM)
{

	//DATASET 초기화###################################################################
	ds_listInput.clearData();

	ds_Commodity.clearData();

	ds_MA_ADV_LINE.clearData();

	ds_RCP_DetailAuto.clearData();
	
	ds_EBill.clearData();
    //DATASET 초기화###################################################################


	//edtBtn Component 초기화############################
	Set_edtBtn_UserData("Clear");
	//edtBtn Component 초기화############################

	ds_listInput.addRow();

	edt_ACCTCD.userdata   = str_ACCTCD;
	edt_ACCTCD.value       = str_ACCTNM;
	ds_listInput.setColumn(ds_listInput.rowposition, "ACCTCD", edt_ACCTCD.userdata);
	ds_listInput.setColumn(ds_listInput.rowposition, "ACCTNM", edt_ACCTCD.value);
	

	//DATASET 초기화###################################################################

	//alert("dd");
	Set_ACCTCD_OnChangeDetail();

    //cbo_ADJ_KIND.SetFocus();
}




function Set_ACCTCD_OnChangeDetail()
{
    var F_ArrCol          = new Array(-1);
    var F_ArrColType      = new Array(-1);
	/*
	##############################################################################################################################
	계정별 관리항목, 프로젝트, 관리유형세팅##################################################################################
 	##############################################################################################################################
    */

	F_ArrCol = [];
	F_ArrCol[0] = "ACCTCD";
	F_ArrColType[0] = "STRING";

    ds_ACCTCD_Property.clearData();
	frm_InitSearchDS(ds_cond, ds_ACCTCD_Property, F_ArrCol, F_ArrColType, "ACCTCD", edt_ACCTCD.userdata, "ma/maa:MAA10030E_S002");

	if (ds_ACCTCD_Property.rowcount == 0) return;

	//접대비세부항목 Eable 처리##############################################
	cbo_RCP_GUBUN.enable  = false;
	me_RCP_SAUPNO.enable  = false;
	edt_RCP_CUSTNM.enable = false;
	edt_RCP_DRNAME.enable = false;
	edt_RCP_ADDR.enable   = false;
	me_RCP_AMT.enable     = false;
	me_SVC_AMT.enable     = false;

	if (
	     (ds_ACCTCD_Property.getColumn(ds_ACCTCD_Property.rowposition, "JUBDAE") == "1") ||
	     (ds_ACCTCD_Property.getColumn(ds_ACCTCD_Property.rowposition, "JUBDAE") == "2")
	   )
	{

		cbo_RCP_GUBUN.enable  = true;
		me_RCP_SAUPNO.enable  = true;
		edt_RCP_CUSTNM.enable = true;
		edt_RCP_DRNAME.enable = true;
		edt_RCP_ADDR.enable   = true;
		me_RCP_AMT.enable     = true;
		me_SVC_AMT.enable     = true;
	}
	//접대비세부항목 Eable 처리##############################################


	//괸리항목 Eable 처리#####################################################
	st_Aditem1.userdata    = "";
	st_Aditem1.text        = "";
	edt_ADITEM1.enable     = false;
	edtBtn_ADITEM1.enable  = false;

	st_Aditem2.userdata    = "";
	st_Aditem2.text        = "";
	edt_ADITEM2.enable     = false;
	edtBtn_ADITEM2.enable  = false;

	st_Aditem3.userdata    = "";
	st_Aditem3.text        = "";
	edt_ADITEM3.enable     = false;
	edtBtn_ADITEM3.enable  = false;

	st_Aditem4.userdata    = "";
	st_Aditem4.text        = "";
	edt_ADITEM4.enable     = false;
	edtBtn_ADITEM4.enable  = false;

	st_Project.userdata    = "";
	st_Project.text        = "";
	edt_PROJECT_ID.enable     = false;
	edtBtn_PROJECT_ID.enable  = false;

	st_Budcls.userdata     = "";
	st_Budcls.text         = "";
	edt_BUD_CLS.enable     = false;
	edtBtn_BUD_CLS.enable  = false;

	for (i=1;i<5;i++){

		if (gfn_length(ds_ACCTCD_Property.getColumn(ds_ACCTCD_Property.rowposition, "PARACD" + i))!= 0)
		{
		//alert("a:" + ds_ACCTCD_Property.GetColumn(ds_ACCTCD_Property.row, "PARACD" + i) + ":");
			eval("st_Aditem" + i).userdata    = ds_ACCTCD_Property.getColumn(ds_ACCTCD_Property.rowposition, "PARACD" + i);
            eval("st_Aditem" + i).text        = GetAditemByNameFS(eval("st_Aditem" + i).userdata);
            eval("edt_ADITEM" + i).enable     = true;
            eval("edtBtn_ADITEM" + i).enable  = true;

		}
	}

	if (gfn_length(ds_ACCTCD_Property.getColumn(ds_ACCTCD_Property.rowposition, "PROJECT"))!= 0)
	{
		st_Project.userdata       = "PROJECT";
		st_Project.text           = "프로젝트";
		edt_PROJECT_ID.enable     = true;
	    edtBtn_PROJECT_ID.enable  = true;

	}

	if (gfn_length(ds_ACCTCD_Property.getColumn(ds_ACCTCD_Property.rowposition, "BUD_CLS"))!= 0)
	{
		st_Budcls.userdata     = "BUD_CLS";
		st_Budcls.text         = "관리유형";
	    edt_BUD_CLS.enable     = true;
	    edtBtn_BUD_CLS.enable  = true;
	}
	//괸리항목 Eable 처리#####################################################


    //미지급금(FS업장전도금) 계정일경우 조회 및 삭제만 가능.................
    div_cmnBtn.btn_save.enable = true;
    if (edt_ACCTCD.userdata == "2110314"){

		div_cmnBtn.btn_save.enable = false;
    }
    //미지급금(FS업장전도금) 계정일경우 조회 및 삭제만 가능.................


    //기존의 현지구매 QUERY.....................................................
    me_ADJ_AMT.enable = true;


    if (
        (edt_ACCTCD.userdata == "1120223") || //매점상품, 식재료 계정일 경우
        (
          (edt_ACCTCD.userdata == "1120311") &&
          ( 
             (cal_ADJ_DATE.value  >  "20080631") &&
             (cal_ADJ_DATE.value  <=  "20081231")
          )
        )  
       )
    {

        //GetMA_ADV_PO_TRANSACTION(grdCommodity, edtBtn_ACCTCD.LabelCaption, lbl_ADV_ID.Caption);
        me_ADJ_AMT.enable = false;
    }
    //기존의 현지구매 QUERY.....................................................

	/*
	##############################################################################################################################
	계정별 관리항목, 프로젝트, 관리유형세팅##################################################################################
 	##############################################################################################################################
    */
    
    fn_ImportantImgSetting(this);
}


function me_ADJ_AMT_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{
	me_AMT.value = gfn_parseFloat(toNumber(me_ADJ_AMT.value)) + gfn_parseFloat(toNumber(me_VAT.value));
}

function me_VAT_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{
	me_AMT.value = gfn_parseFloat(toNumber(me_ADJ_AMT.value)) + gfn_parseFloat(toNumber(me_VAT.value));
}


//관리항목명 리턴 ################################################################
function GetAditemByNameFS(str_AditemCode)
{
    /*

    002 거래처
    009 카드번호
    010 사원
    017 기간
    021 발생일자
    033 과세/면세

    */
//alert(str_AditemCode);
    if (str_AditemCode =="002") {
        return   "거래처";
    }
    else if (str_AditemCode =="009") {
        return   "카드번호";
    }
    else if (str_AditemCode =="010") {
        return   "사원";
    }
    else if (str_AditemCode =="017") {
        return   "기간";
    }
    else if (str_AditemCode =="021") {
        return   "발생일자";
    }
    else if (str_AditemCode =="033") {
        return   "과세/면세";
    }
    else if (str_AditemCode =="049") {
        return   "기부금코드";
    }
    else if (str_AditemCode =="PROJECT") {
        return   "프로젝트";
    }
    else if (str_AditemCode =="BUD_CLS") {
        return   "관리유형";
    }

}
//관리항목명 리턴 ##############################################################







//-----------------------------------------------
// 정산구분 Change event
//-----------------------------------------------
function cbo_ADJ_KIND_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{

	var real_BeforeADJ_AMT;

	real_BeforeADJ_AMT = me_ADJ_AMT.value;

	//KJW Set_ACCTCD_OnChange(edt_ACCTCD.UserData, edt_ACCTCD.Text);
	cbo_ADJ_KIND.value = e.postvalue;

    //매점상품계정, 식재료은 상세내역의 공급가합을 그대로 유지.......
    if (
        (edt_ACCTCD.userdata == "1120223") || //매점상품, 식재료 계정일 경우
        (edt_ACCTCD.userdata == "1120311")
       )
    {
        me_ADJ_AMT.value = real_BeforeADJ_AMT;

    }
    //매점상품계정, 식재료은 상세내역의 공급가합을 그대로 유지.......

    Setcbo_ADJ_KIND_Change();
    ds_listInput.setColumn(ds_listInput.rowposition, "BULGONG_YN", "N");
    

	if (cbo_ADJ_KIND.value == "009")
	{

		gfn_alert("현금영수증카드 수령후 본사사업자번호로 등록을 하셨습니까? 다시 한번 확인부탁드립니다.");
	}	
}



function Setcbo_ADJ_KIND_Change()
{


    //세무 정보관련 항목일때................
    edt_CUSTCD.enable    = false;
    edtBtn_CUSTCD.enable = false;
    cal_TAX_DATE.enable  = false;
    btn_TAX_DATE.enable  = false;
    
    btn_ImgInsert.enable = false;

    if (cbo_RCP_GUBUN.enable  == true){

		me_RCP_SAUPNO.enable  = true;
        edt_RCP_CUSTNM.enable = true;
        edt_RCP_ADDR.enable   = true;
        edt_RCP_DRNAME.enable = true;
    }

    if (
        (cbo_ADJ_KIND.value == "001") || //세무 정보관련 항목일 경우
        (cbo_ADJ_KIND.value == "002") ||
        (cbo_ADJ_KIND.value == "009")
       )
    {

		edt_CUSTCD.enable     =  true;
		edtBtn_CUSTCD.enable  =  true;
		cal_TAX_DATE.enable   =  true;
		btn_TAX_DATE.enable   = true;

        me_RCP_SAUPNO.enable  = false;
        edt_RCP_CUSTNM.enable = false;
        edt_RCP_ADDR.enable   = false;
        edt_RCP_DRNAME.enable = false;
    };
    //세무 정보관련 항목일때................



    //세금계산서 일때 부가세란 Enable.........
    cbo_BULGONG_YN.enable      = false;
    me_VAT.enable              = false;
    if (
        (cbo_ADJ_KIND.value == "001") || //세금계산서  항목일 경우
        (cbo_ADJ_KIND.value == "009")
       )
    {

        me_VAT.enable    = true;

        //임차료 매입일반 대상구분 Diabled.............................
        if (gfn_length(edt_ACCTCD.userdata)!= 0)
        {

            if (
                (gfn_subStr(edt_ACCTCD.userdata, 0, 6)== "505071") ||
                (edt_ACCTCD.userdata == "1120223")
               )
            {

                cbo_BULGONG_YN.enable = true;
            };
        };
        //임차료 매입일반 대상구분 Diabled.............................
    }
    
	//전자세금계산서:##################################
	edt_TAXNO.enable       = false;
	cbo_TAX_IF_GB.enable   = false;
	cbo_TAX_SEND_GB.enable = false;
	
    if (
        (cbo_ADJ_KIND.value == "001") || //세금계산서/계산서  항목일 경우
        (cbo_ADJ_KIND.value == "002")
       )
    {


		edt_TAXNO.enable       = true;
		cbo_TAX_IF_GB.enable   = true;
		cbo_TAX_SEND_GB.enable = true;
    }
    else {
    
		//전자세금계산서:관련항목  default처리#########################
		ds_listInput.setColumn(ds_listInput.rowposition, "TAXNO",        "");
		ds_listInput.setColumn(ds_listInput.rowposition, "TAX_IF_GB",   "N");
		ds_listInput.setColumn(ds_listInput.rowposition, "TAX_SEND_GB", "1");
		
		//전자세금계산서:관련항목  default처리#########################
    }
	    

    //접대비유형 변경...................................................
    if (cbo_RCP_GUBUN.enable  == true){

		str_JubdaeGubun = "";
		if (
			(cbo_ADJ_KIND.value == "001") ||
			(cbo_ADJ_KIND.value == "002")
		   )
		{

			str_JubdaeGubun = " AND (SCODE IN ('003', '004')) ";
		}
		else if (cbo_ADJ_KIND.value == "009")
		{

			str_JubdaeGubun = " AND (SCODE IN ('008')) ";
		}
		else {

			str_JubdaeGubun = " AND (SCODE NOT IN ('003', '004')) ";
		}


		//접대비유형####################################################################################################
		fn_sql_common("C", strMAQuery_RCP_GUBUN, str_JubdaeGubun," ORDER BY SCODE ","",cbo_RCP_GUBUN,-1,ds_cbo_RCP_GUBUN);
		//접대비유형####################################################################################################
	}
	//접대비유형 변경...................................................
	
	fn_ImportantImgSetting(this);
}




function fn_GetIsADV_Profit(objOutDs, str_ACCTCD)
{
    objOutDs.clear();
    objOutDs.addColumn("CNT","INT",256);


	// action 정보 초기화
    fsp_clear(this);

    // 서버에서 조회할 정보 추가
	fsp_addSearch(this, "ma/maa:MAA10030E_S005");

	// 서버 호출
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","ACCTCD=" + wrapQuote(str_ACCTCD),"");
	http.Sync = false;

	return objOutDs.getColumn(objOutDs.rowposition, "CNT");
}

function WorkForm_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
{
    //fn_form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam);
    /*
	var SetNextComp = "";
	if ( nChar == 13 ) {
			SetNextComp = GetNextComponent();
			SetNextComp.SetFocus();	
	}
	*/
	
}

function edtBtn_PROJECT_ID_OnClick(obj:Button, e:ClickEventInfo)
{
	fn_ADITEM_Popup(st_Project, edt_PROJECT_ID, 0);
}

function edtBtn_ADITEM1_OnClick(obj:Button, e:ClickEventInfo)
{

	fn_ADITEM_Popup(st_Aditem1, edt_ADITEM1, 1);
}






/*
 ******************************************************************************************
 * 시스템구분   : FS시스템/영업관리/전도금정산
 * 프로그램명   : MAA10030E.XML
 * 기      능   : 관리항목별 Popup
 * 작  성  자   : 황승한
 * 작성  일자   : 2007-11-16
 * ----------------------------------------------------------------------------------------
 * HISTORY    : CSR24685 정산시 계정별 관리항목 체크기능 추가 2009.02.13 황승한
 ******************************************************************************************
 */
function fn_ADITEM_Popup(st_Aditem, edt_ADITEM, i)
{

    //계정별 관리항목 mismatching  방지위해 2009.02.13 황승한######################
    if (gfn_length(st_Aditem.userdata)== 0){
		
		g_Message("EE", "관리항목이 없습니다.\n" + "계정을 먼저 선택하여 주십시요.");
		return;
    }
    //계정별 관리항목 mismatching  방지위해 2009.02.13 황승한######################
    
    
    
	var F_ArrCol;

	f_PopupCode1 = "";
	f_PopupCode2 = "";
	//alert(st_Aditem.UserData);
	F_ArrCol = fn_GetAditemConst(st_Aditem.userdata);

	if (
		(st_Aditem.userdata == "PROJECT") ||
		(st_Aditem.userdata == "BUD_CLS")
	   )
	{
			if (st_Aditem.userdata == "PROJECT"){
			
			if(st_Project.text == "프로젝트")
			{
				F_ArrCol[6] = "PROJECT_ID;PROJECT_NM";
			}
			else
			{
				F_ArrCol[6] = "";
			}

				fn_sql_common_setup(F_ArrCol[0],
									F_ArrCol[1],
									F_ArrCol[2],
									F_ArrCol[3],
									F_ArrCol[4],
									"",
									"",
									" AND (ACCTCD = '" + ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") + "') ",
									F_ArrCol[5],
									F_ArrCol[6]);
trace("1");
				if (gds_sql_common.getColumn(0, "ret_code") != ""){

					edt_ADITEM.userdata  = gds_sql_common.getColumn(0, "ret_code");
					edt_ADITEM.value      = gds_sql_common.getColumn(0, "ret_name");

					ds_listInput.setColumn(ds_listInput.rowposition, "PROJECT",   edt_ADITEM.userdata);
					ds_listInput.setColumn(ds_listInput.rowposition, "PROJECTNM", edt_ADITEM.text);
				}
			}
			else if (st_Aditem.userdata == "BUD_CLS"){
			
			if(st_Budcls.text == "관리유형")
			{
				F_ArrCol[6] = "BUD_CLS;BUDCLS_NM";
			}
			else
			{
				F_ArrCol[6] = "";
			}

				fn_sql_common_setup(F_ArrCol[0],
									F_ArrCol[1],
									F_ArrCol[2],
									F_ArrCol[3],
									F_ArrCol[4],
									"",
									"",
									" AND (ACCTCD = '" + ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") + "') ",
									F_ArrCol[5],
									F_ArrCol[6]);
trace("2");
				if (gds_sql_common.getColumn(0, "ret_code") != ""){

					edt_ADITEM.userdata  = gds_sql_common.getColumn(0, "ret_code");
					edt_ADITEM.value      = gds_sql_common.getColumn(0, "ret_name");

					ds_listInput.setColumn(ds_listInput.rowposition, "BUD_CLS",   edt_ADITEM.userdata);
					ds_listInput.setColumn(ds_listInput.rowposition, "BUDCLSNM",  edt_ADITEM.text);
				}
			}
	}
	else {

		if (
			 (F_ArrCol[0] == "기간") ||
			 (F_ArrCol[0] == "발생일자")
		   )
		{

			if (F_ArrCol[0] == "기간"){

				f_PopupCode1 = gfn_subStr(edt_ADITEM.userdata, 0, 8);
				f_PopupCode2 = gfn_subStr(edt_ADITEM.userdata, 9, 8);
				
				var sParam = {f_PopupCode1:f_PopupCode1, f_PopupCode2:f_PopupCode2};
				gfn_dialog("", "U_MAA::MAA10031P.xfdl",sParam);

				if (gfn_length(f_PopupCode1)!= 0){

					edt_ADITEM.userdata  = f_PopupCode1 + "-" + f_PopupCode2;
					edt_ADITEM.value      = f_PopupCode1 + "-" + f_PopupCode2;
				}

				ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM" + i,   edt_ADITEM.userdata);
				ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM" + i + "NM", edt_ADITEM.text);
			}
			else if (F_ArrCol[0] == "발생일자"){

				f_PopupCode1 = gfn_subStr(edt_ADITEM.userdata, 0, 8);
				
				var sParam = {f_PopupCode1:f_PopupCode1};
				gfn_dialog("", "U_MAA::MAA10032P.xfdl",sParam);

				if (gfn_length(f_PopupCode1)!= 0){

					edt_ADITEM.userdata  = f_PopupCode1;
					edt_ADITEM.value      = f_PopupCode1;
				}

				ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM" + i,   edt_ADITEM.userdata);
				ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM" + i + "NM", edt_ADITEM.text);
			}
		}
		else {
		
			if(eval("st_Aditem" + i + ".text") == "거래처")
			{
				F_ArrCol[6] = "CUSTCD;CUSTNM";
			}
			else if(eval("st_Aditem" + i + ".text") == "사원")
			{
				F_ArrCol[6] = "SABUN;NM_KOR";
			}
			else if(eval("st_Aditem" + i + ".text") == "과세/면세")
			{
				F_ArrCol[6] = "SCODE;SNM";
			}			
			else if(eval("st_Aditem" + i + ".text") == "기부금코드")
			{
				F_ArrCol[6] = "SNM;DESCRIPTION1";
			}
			else if(eval("st_Aditem" + i + ".text") == "카드번호")
			{
				F_ArrCol[6] = "SNM;DESCRIPTION1";
			}
			else if(eval("st_Aditem" + i + ".text") == "기간")
			{
				F_ArrCol[6] = "CUSTCD;CUSTNM";
			}
			else if(eval("st_Aditem" + i + ".text") == "발생일자")
			{
				F_ArrCol[6] = "CUSTCD;CUSTNM";
			}
			else
			{
				F_ArrCol[6] = "";
			}
			
 //trace(F_ArrCol[5]);
 //trace(F_ArrCol[6]);
 //trace(eval("st_Aditem" + i + ".text"));
			fn_sql_common_setup(F_ArrCol[0],
								F_ArrCol[1],
								F_ArrCol[2],
								F_ArrCol[3],
								F_ArrCol[4],
								"",
								"",
								"",
								F_ArrCol[5],
								F_ArrCol[6]
								);
trace("3");
			if (gds_sql_common.getColumn(0, "ret_code") != ""){

				edt_ADITEM.userdata  = gds_sql_common.getColumn(0, "ret_code");
				edt_ADITEM.value      = gds_sql_common.getColumn(0, "ret_name");

				ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM" + i,   edt_ADITEM.userdata);
				ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM" + i + "NM", edt_ADITEM.text);
			}
		}
	}

}
function edtBtn_ADITEM2_OnClick(obj:Button, e:ClickEventInfo)
{

	fn_ADITEM_Popup(st_Aditem2, edt_ADITEM2, 2);
}

function edtBtn_ADITEM3_OnClick(obj:Button, e:ClickEventInfo)
{
	fn_ADITEM_Popup(st_Aditem3, edt_ADITEM3, 3);
}

function edtBtn_ADITEM4_OnClick(obj:Button, e:ClickEventInfo)
{
	fn_ADITEM_Popup(st_Aditem4, edt_ADITEM4, 4);
}

function edtBtn_BUD_CLS_OnClick(obj:Button, e:ClickEventInfo)
{
	fn_ADITEM_Popup(st_Budcls, edt_BUD_CLS, 0);
}

function edt_ACCTCD_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	
    fn_edt_OnKeyDown(obj,e.keycode);	
		
	if (e.keycode == 46){
			
		
		edt_ACCTCD.userdata = "";
		edt_ACCTCD.value = "";
		Set_ACCTCD_OnChange(edt_ACCTCD.userdata, edt_ACCTCD.value);	
	}	
}

function edt_CUSTCD_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
    fn_edt_OnKeyDown(obj,e.keycode);	
	
	if (e.keycode == 46){
	
		ds_listInput.setColumn(ds_listInput.rowposition, "CUSTCD", "");	
		ds_listInput.setColumn(ds_listInput.rowposition, "CUSTNM", "");	
	}
	
}

function edt_ADITEM1_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13){

		edtBtn_ADITEM1.click();
	}	
	else if (e.keycode == 46){
	
		ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM1", "");	
		ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM1NM", "");	
	}	
}

function edt_ADITEM2_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13){

		edtBtn_ADITEM2.click();
	}		
	else if (e.keycode == 46){
	
		ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM2", "");	
		ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM2NM", "");	
	}		
}

function edt_ADITEM3_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13){

		edtBtn_ADITEM3.click();

	}	
	else if (e.keycode == 46){
	
		ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM3", "");	
		ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM3NM", "");	
	}				
}

function edt_ADITEM4_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13){

		edtBtn_ADITEM4.click();

	}		
	else if (e.keycode == 46){
	
		ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM4", "");	
		ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM4NM", "");	
	}	
}

function edt_PROJECT_ID_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13){

		edtBtn_PROJECT_ID.click();

	}	
	else if (e.keycode == 46){
	
		ds_listInput.setColumn(ds_listInput.rowposition, "PROJECT_ID", "");	
		ds_listInput.setColumn(ds_listInput.rowposition, "PROJECTNM", "");	
	}			
}

function edt_BUD_CLS_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13){

		edtBtn_BUD_CLS.click();

	}		
	else if (e.keycode == 46){
	
		ds_listInput.setColumn(ds_listInput.rowposition, "BUD_CLS", "");	
		ds_listInput.setColumn(ds_listInput.rowposition, "BUDCLSNM", "");	
	}	
}

function edt_CUSTCD_OnFocus(obj:Edit, e:SetFocusEventInfo)
{
	if (gfn_length(cbo_ADJ_KIND.value)== 0){
		
		cbo_ADJ_KIND.setFocus();
	}
}

//---------------------------------------------------------
// 전도금 잔액계산
//---------------------------------------------------------
function fn_GetRemainder(objOutDs, str_Gubun, real_UPJANG, real_ADV_ID, str_ADJ_KIND, real_CURR_AMT)
{
	
		real_ADV_ID = gfn_isNull(real_ADV_ID) ? "0" : real_ADV_ID;
		
		objOutDs.clear();
		objOutDs.addColumn("JANAMT","INT",256);
	
	
		// action 정보 초기화
		fsp_clear(this);
	
		// 서버에서 조회할 정보 추가
		fsp_addSearch(this, "ma/maa:MAA10030E_S004");
	
		// 서버 호출
		http.Sync = true;
		fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","GUBUN=" +wrapQuote(str_Gubun) + " UPJANG=" + wrapQuote(real_UPJANG) +" ADV_ID=" + wrapQuote(real_ADV_ID) +" ADJ_KIND=" + wrapQuote(str_ADJ_KIND) +" CURR_AMT=" + wrapQuote(real_CURR_AMT),"");
		http.Sync = false;
	
		return objOutDs.getColumn(objOutDs.rowposition, "JANAMT");	
}

function fn_GetIs_GA_TAX_IF_GB_CHK_FUNError(objOutDs, str_VAT_CUSTCD, str_SUPDATE, str_TAX_IF_GB, str_TAX_SEND_GB)
{

        if (
			(gfn_subStr(str_SUPDATE, 0, 4)< "2011") ||
		    (toNumber(str_VAT_CUSTCD) == 0)  
		   )
		{
		  
			return "";
		}
        
		objOutDs.clear();
		objOutDs.addColumn("TAX_IF_GB_CHK","STRING",256);
	
	
		// action 정보 초기화
		fsp_clear(this);
	
		// 서버에서 조회할 정보 추가
		fsp_addSearch(this, "ma/maa:MAA10030E_S014");
	
		// 서버 호출
		http.Sync = true;
		fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","VAT_CUSTCD=" +wrapQuote(str_VAT_CUSTCD) + " SUPDATE=" + wrapQuote(str_SUPDATE) +" TAX_IF_GB=" + wrapQuote(str_TAX_IF_GB) +" TAX_SEND_GB=" + wrapQuote(str_TAX_SEND_GB),"");
		http.Sync = false;
	
		return objOutDs.getColumn(objOutDs.rowposition, "TAX_IF_GB_CHK");	
}


function fn_GetUpjangSlipClose(str_Gubun, objOutDs, str_ADV_ID, real_UPJANG, str_ACCTCD, str_ADJ_DATE)
{


	/*
	If not IsCloseDate(str_Upjang, '04', str_Date) Then
	begin

	  Result := '해당일자는 이미 마감되었읍니다. 단지 조회만 가능합니다.';
	  Exit;
	end;
	If not IsClosePreDate(str_Upjang, '04', str_Date) Then
	begin

	  Result := '등록일자 이전 날짜에 대해 일일마감이 처리되지 않은 것이 있습니다.' + #13#10#13#10 + '일일마감에서 처리되지 않은 일자에 대해 마감처리를 완료하시기 바랍니다.';
	  Exit;
	end;
	*/

		str_ADV_ID = gfn_isNull(str_ADV_ID) ? "0" : str_ADV_ID;
		

    if (str_Gubun == "전표체크"){

		objOutDs.clear();
		objOutDs.addColumn("GAMU","STRING",256);
		objOutDs.addColumn("COST_GAMU","STRING",256);



		// action 정보 초기화
		fsp_clear(this);

		// 서버에서 조회할 정보 추가
		fsp_addSearch(this, "ma/maa:GetUpjangSlipClose");

		// 서버 호출
		http.Sync = true;
		fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","ADV_ID=" + wrapQuote(str_ADV_ID),"");
		http.Sync = false;

		if (gfn_length(objOutDs.getColumn(objOutDs.rowposition, "GAMU"))!= 0){

			return "해당 전도금 정산은 이미 전도금전표화된 항목입니다.";
		}
		else if (gfn_length(objOutDs.getColumn(objOutDs.rowposition, "COST_GAMU"))!= 0){

			return "해당 전도금 정산은 이미 원가대체전표화된 항목입니다.";
		}
     }
     else if (str_Gubun == "계정별월마감체크"){

		objOutDs.clear();
		objOutDs.addColumn("ENDGUBUN","STRING",256);


		// action 정보 초기화
		fsp_clear(this);

		// 서버에서 조회할 정보 추가
		fsp_addSearch(this, "ma/mac:GetAcctcdEndgubun");

		// 서버 호출
		http.Sync = true;
		fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","ACCTCD=" + wrapQuote(str_ACCTCD) + " ENDMONTH=" + wrapQuote(gfn_subStr(str_ADJ_DATE, 0, 6)),"");
		http.Sync = false;

		if (
		    (objOutDs.rowcount ==0) ||
		    (objOutDs.getColumn(objOutDs.rowposition, "ENDGUBUN") == "N")
		   )
		{


		}
		else {
			return "해당 계정에 대하여 회계월마감 되었습니다.";
		}
     }

}

//현지구매창고마감체크#############################################################################
function fn_GetPO_CLOSE(str_Gubun, objOutDs, real_UPJANG, param_ds_Commodity, str_DATE)
{
    /*
    var param_ds_CommodityGroup;
    
    param_ds_CommodityGroup = param_ds_Commodity;
    param_ds_CommodityGroup.GroupKey("SUBINV_CODE");
    */
    
    if (str_Gubun == "전도금현지구매체크"){


		
		for (i=0;i<param_ds_Commodity.rowcount;i++){
		
			objOutDs.clear();
			objOutDs.addColumn("LV_RETURN","STRING",256);
					
			// action 정보 초기화
			fsp_clear(this);
	
			// 서버에서 조회할 정보 추가
			fsp_addSearch(this, "ma/mac:GetPO_CLOSE");
	
			// 서버 호출
			http.Sync = true;
			fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","GUBUN=" + wrapQuote(str_Gubun) + 
			                                                           " UPJANG=" + wrapQuote(real_UPJANG) + 
			                                                           " SUBINV_CODE=" + wrapQuote(param_ds_Commodity.getColumn(i, "SUBINV_CODE")) + 
			                                                           " DATE=" + wrapQuote(str_DATE)
			                                                          ,"");
			http.Sync = false;
	
			if (gfn_length(objOutDs.getColumn(objOutDs.rowposition, "LV_RETURN"))!= 0){
	
				return objOutDs.getColumn(objOutDs.rowposition, "LV_RETURN");
			}
		}
     }
}
//현지구매창고마감체크#############################################################################

//현지구매TR_NUM ####################################################################################
function fn_GetPO_TR_NUM(objOutDs)
{


		objOutDs.clear();
		objOutDs.addColumn("TR_NUM","INT",256);
				
		// action 정보 초기화
		fsp_clear(this);

		// 서버에서 조회할 정보 추가
		fsp_addSearch(this, "ma/maa:MAA10030E_S009");

		// 서버 호출
		http.Sync = true;
		fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","","");
		http.Sync = false;

		if (gfn_length(objOutDs.getColumn(objOutDs.rowposition, "TR_NUM"))!= 0){

			return objOutDs.getColumn(objOutDs.rowposition, "TR_NUM");
		}

}
//현지구매TR_NUM ####################################################################################

//현지구매TRANS_ID ##################################################################################
function fn_GetPO_TRANS_ID(objOutDs)
{


		objOutDs.clear();
		objOutDs.addColumn("TRANS_ID","INT",256);
				
		// action 정보 초기화
		fsp_clear(this);

		// 서버에서 조회할 정보 추가
		fsp_addSearch(this, "ma/maa:MAA10030E_S010");

		// 서버 호출
		http.Sync = true;
		fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","","");
		http.Sync = false;

		if (numFormat(objOutDs.getColumn(objOutDs.rowposition, "TRANS_ID"))!= "0"){

			return objOutDs.getColumn(objOutDs.rowposition, "TRANS_ID");
		}

}
//현지구매TRANS_ID ##################################################################################





//신규 ADV_ID취득###################################################################################
function fn_GetNEW_MAS_ADVANCE_S(objOutDs)
{
	
		objOutDs.clear();
		objOutDs.addColumn("MAS_ADVANCE_S","INT",256);
					
		// action 정보 초기화
		fsp_clear(this);

		// 서버에서 조회할 정보 추가
		fsp_addSearch(this, "ma/maa:MAA10030E_S006");

		// 서버 호출
		http.Sync = true;
		fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","","");
		http.Sync = false;

		return objOutDs.getColumn(objOutDs.rowposition, "MAS_ADVANCE_S");
	
}
//신규 ADV_ID취득###################################################################################


function edt_UPJANG_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
    fn_edt_OnKeyDown(obj,e.keycode);	
		
	if (e.keycode == 46){
	
			obj.userdata = "";
			obj.value     = "";			
    }
}

function edt_BUDDEPT_ID_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
    fn_edt_OnKeyDown(obj,e.keycode);	
		
	if (e.keycode == 46){
	
			obj.userdata = "";
			obj.value     = "";			
    }
}

function btn_Nopay_OnClick(obj:Button, e:ClickEventInfo)
{
    if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0"){    

        g_Message("EE", "업장을 선택하여 주십시요.");
        edt_UPJANG.setFocus();
        return;
    }
    
	f_PopupCode1 = ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG");
	var sParam = {f_PopupCode1:f_PopupCode1};
    gfn_dialog("", "U_MAA::MAA10033P.xfdl",sParam);

    fn_search();			 
}

function btn_PO_Detail_OnClick(obj:Button, e:ClickEventInfo)
{
        
    ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG", edt_UPJANG.userdata);
    ds_listInput.setColumn(ds_listInput.rowposition, "ADJ_DATE", cal_ADJ_DATE.value);


	//매점상품,식재료 계정 이외 return............................................
	if(
		(ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") != "1120223") &&
		(ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") != "1120311")
	  )
	{
	
		return;
	}
	//매점상품,식재료 계정 이외 return............................................



     
    if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0"){    

        g_Message("EE", "업장을 선택하여 주십시요.");
        edt_UPJANG.setFocus();
        return;
    }
    
    if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE"))== 0){    

        g_Message("EE", "정산일자가 선택되어 있지 않습니다." + "\n" + 
			  "확인하여 주십시요.");
        cal_ADJ_DATE.setFocus();
        return;
    }    
    
    
    
    //식재료 현지구매는 2008년07월부터 적용한다.###########################################
    if (
         (ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD")   == "1120311") && 
         (ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE") <= "20080631")
       )  
    {
    
        g_Message("EE", "식재료 현지구매는 2008년 07월 부터 관리됩니다." + "\n" + 
			  "확인하여 주십시요.");        
        return;		
    }    
    //식재료 현지구매는 2008년07월부터 적용한다.###########################################
    

    	
	//식재료 계정 현지구매 2009.01.01부터 이전으로 돌아감 => 100%원가처리 return................
	//불공제 창고로 인해 현지구매와 구매 단수차이 및 부가세 금액차이 맞출수 없슴의 사유.....	
	if(
		(ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD") == "1120311") &&
		(ds_listInput.getColumn(ds_listInput.rowposition, "ADJ_DATE") >= "20090101")
	  )
	{

	
        g_Message("EE", "식재료 현지구매는 2009년 01월 부터 구매 연동없이 관리됩니다." + "\n" + 
                        "해당월에 100% 원가처리됩니다." + "\n" + 
			  "확인하여 주십시요.");   	
		return;
	}
	//식재료 계정 현지구매 2009.01.01부터 이전으로 돌아감 => 100%원가처리 return................
	//불공제 창고로 인해 현지구매와 구매 단수차이 및 부가세 금액차이 맞출수 없슴의 사유.....
	    
	    
	    
    
    
	f_PopupCode1 = ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID");				
	f_PopupCode2 = ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG");			
	f_PopupCode3 = ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD");			
	
	var sParam = {f_PopupCode1:f_PopupCode1, f_PopupCode2:f_PopupCode2, f_PopupCode3:f_PopupCode3};
	gfn_dialog("", "U_MAA::MAA10034P.xfdl",sParam);
	
	/*
	var ds_Temp;
    ds_Temp = gfn_dialog("", "U_MAA::MAA10034P.xml","f_PopupCode1=" + f_PopupCode1 + " f_PopupCode2=" + f_PopupCode2);
    
    if (length(ds_Temp) != 0){
		ds_Commodity = ds_Temp;
    }
    */
    
}


function cal_ADJ_DATE_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{


//alert(edt_ADJ_DESC.TEXT.IndexOf('('));
    if (
          (gfn_length(cal_ADJ_DATE.value)!= 0) &&
          (edt_ACCTCD.userdata == "1120311") &&
		  (cal_ADJ_DATE.value  >  "20080631") &&
		  (cal_ADJ_DATE.value  <=  "20081231")      
       )
    {

        //GetMA_ADV_PO_TRANSACTION(grdCommodity, edtBtn_ACCTCD.LabelCaption, lbl_ADV_ID.Caption);
        me_ADJ_AMT.enable = false;
    }
    
    if (
          (gfn_length(cal_ADJ_DATE.value)!= 0) &&
          (edt_ACCTCD.userdata == "1120311") &&
          (
            (cal_ADJ_DATE.value  <=  "20080631")||
            (cal_ADJ_DATE.value  >=  "20090101")
          ) 
       )
    {

        //GetMA_ADV_PO_TRANSACTION(grdCommodity, edtBtn_ACCTCD.LabelCaption, lbl_ADV_ID.Caption);
        me_ADJ_AMT.enable = true;
    }
        
        

	if ( (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID"))!= "0")||
	     (gfn_length(cal_ADJ_DATE.value)== 0) ||
	     (gfn_length(cal_TAX_DATE.value)== 0)
	   )
	{
		
		return;
	}

	if (gfn_subStr(cal_ADJ_DATE.value, 0, 6)!=
	    gfn_subStr(cal_TAX_DATE.value, 0, 6)){
	
		if (!g_Confirm("04", "정산일과 발행일의 월이 상이합니다." + "\n" +
		                     "발행일을 확인하셨습니까?")){
			ds_listInput.setColumn(ds_listInput.rowposition, "TAX_DATE", "");
		}             
	}	
	
	
}

function cal_ADJ_DATEQuery_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{

	fn_DataSetAllClear();	
}




function fn_DataSetAllClear()
{

	ds_list.clearData();

	ds_listInput.clearData();

	ds_Commodity.clearData();

	ds_MA_ADV_LINE.clearData();

	ds_RCP_DetailAuto.clearData();

	ds_EBill.clearData();
}

function edtBtn_Date_OnClick(obj:Button, e:ClickEventInfo)
{	
	
	
	g_CalButton_OnClick(obj);
	
	// 잡급대체가계정(9410119)이면 일자변경한것을 반영한다.
	if (edt_ACCTCD.userdata == "9410119") {
		ds_listInput.setColumn(ds_listInput.rowposition, "ADJ_DESC", gfn_subStr(edt_ADJ_DESC.value, 0, gfn_indexOf(edt_ADJ_DESC.value,'(')+1)+ cal_ADJ_DATE.value + ", " + gfn_subStr(edt_ADJ_DESC.value, gfn_indexOf(edt_ADJ_DESC.value,',')+1));
	}	
	if ( (gfn_length(cal_ADJ_DATE.value)== 0) ||
	     (gfn_length(cal_TAX_DATE.value)== 0)
	   )
	{
		
		return;
	}

	if (gfn_subStr(cal_ADJ_DATE.value, 0, 6)!=
	    gfn_subStr(cal_TAX_DATE.value, 0, 6)){
	
		if (!g_Confirm("04", "정산일과 발행일의 월이 상이합니다." + "\n" +
		                     "발행일을 확인하셨습니까?")){
			ds_listInput.setColumn(ds_listInput.rowposition, "TAX_DATE", "");
		}             
	}
	

}

function edt_UPJANGQuery_OnChanged(obj:Edit, e:TextChangedEventInfo)
{
	fn_DataSetAllClear();
}



function edt_UPJANGQuery_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
    fn_edt_OnKeyDown(obj,e.keycode);	
		
	if (e.keycode == 46){
	
			obj.userdata = "";
			obj.value     = "";			
    }
}




function grid_Slip_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	
	
	if (obj.getCellProperty("head",e.cell,"class") == "head_Excel"){
		gfn_exportExcel(obj, this.titletext);
	}
	else {
	
		gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);	
		//ds_list_OnRowPosChanged(obj,-1,0);	
	}
	//obj.ExportExcel(this.Title, , False);	
}


function fn_GetIsGHRValidCheck(objOutDs, real_UPJANG)
{
	var str_ConfirmMessage;
	
	ta_SPECIAL_AGREE.value = "";
	
	objOutDs.clear();
	objOutDs.addColumn("UPJANGNM","STRING",256);
	objOutDs.addColumn("PAY_YMD","STRING",256);
	objOutDs.addColumn("GHR_AMT","INT",256);
	objOutDs.addColumn("ADV_AMT","INT",256);
	objOutDs.addColumn("CHA_AMT","INT",256);
	
				
	// action 정보 초기화
	fsp_clear(this);

	// 서버에서 조회할 정보 추가
	fsp_addSearch(this, "ma/maa:MAA10030E_S011");

	// 서버 호출
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","UPJANG=" + wrapQuote(real_UPJANG),"");
	http.Sync = false;
    
    str_ConfirmMessage = "";
	if (objOutDs.rowcount > 0)
	{
	    for (i=0;i<objOutDs.rowcount;i++){
	    
			if (objOutDs.getColumn(i, "CHA_AMT") != 0)
			{
			
					str_ConfirmMessage += "[" + objOutDs.getColumn(i, "PAY_YMD") + "에 잡급등록정보가 EHR과 차이가 납니다.]\n" +
										 "=> (EHR잡급등록확인메시지)단, 오늘 등록(전도금정산-EHR)하셨다면 내일은 메시지가 뜨지 않습니다.\n" +
										 "인사금액합계(E-HR 프로그램): " + objOutDs.getColumn(i, "GHR_AMT") + "\n" +
										 "잡급대체정산합계(푸드아이) : " + objOutDs.getColumn(i, "ADV_AMT") + "\n" +
										 "EHR등록확인요망! (EHR등록정보는 익일 오전에 자동반영=>전표생성시 자동반영)\n\n";				
					
							 
			}
		}
		
		ta_SPECIAL_AGREE.value = str_ConfirmMessage;			
	}
	

}

function fn_GetLocalUserRole(objOutDs)
{
    
    //잔액체크#####################################################################
    objOutDs.clear();
    objOutDs.addColumn("ROLE_YN","STRING",256);	       
    
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/maa:MAA10010E_S006");
	
	//alert(str_ACCTCD);
	//alert(str_DATE_STD);
	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list",""
	                                                           ,"");	
	http.Sync = false;
	
                          	
	
	//alert(objOutDs.GetColumn(objOutDs.row, "ACCTCD_DATE") );
	return objOutDs.getColumn(objOutDs.rowposition, "ROLE_YN");
	//잔액체크#####################################################################
	
}


function fn_GetSCHOOL_YN(objOutDs, real_UPJANG)
{
    
    //잔액체크#####################################################################
    objOutDs.clear();
    objOutDs.addColumn("SCHOOL_YN","STRING",256);	       
    
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/maa:MAA10030E_S012");
	
	//alert(str_ACCTCD);
	//alert(str_DATE_STD);
	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","UPJANG=" + wrapQuote(real_UPJANG)
	                                                           ,"");	
	http.Sync = false;
	
                          	
	
	//alert(objOutDs.GetColumn(objOutDs.row, "ACCTCD_DATE") );
	return objOutDs.getColumn(objOutDs.rowposition, "SCHOOL_YN");
	//잔액체크#####################################################################
	
}




function fn_GetTaxInvoiceTradeSettlement(objOutDs, real_CUSTCD)
{
    
    //잔액체크#####################################################################
    objOutDs.clear();
    objOutDs.addColumn("EQUAL_SAUPNO","STRING",256);	       
    
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/maa:MAA10030E_S013");
	
	//alert(str_ACCTCD);
	//alert(str_DATE_STD);
	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","CUSTCD=" + wrapQuote(real_CUSTCD)
	                                                           ,"");	
	http.Sync = false;
	
                          	
	
	//alert(objOutDs.GetColumn(objOutDs.row, "ACCTCD_DATE") );
	return objOutDs.getColumn(objOutDs.rowposition, "EQUAL_SAUPNO");
	//잔액체크#####################################################################
	
}



function btn_ImgInsert_OnClick(obj:Button, e:ClickEventInfo)
{
	if (ds_listInput.getRowCount()==0)
	{
		return;
	}

	if(fileDialog_EBill.Open()==false)
	{
		return;
	}


	file_EBill.FileName = fileDialog_EBill.FilePath + "\\" + fileDialog_EBill.FileName;
	file_EBill.Open(); 
	
	var xslfile = file_EBill.Read(-1, "utf-8");
	
	file_EBill.Close(); 
	
	var XMLDoc = createObject("Microsoft.XMLDOM");  
	 
	XMLDoc.async = false;
		
	//xml; string8??? load?? ??
	XMLDoc.loadXML(xslfile);
	
	//trace(XMLDoc.xml);
	
	//root node? ????
	var root = XMLDoc.documentElement;

	ds_EBill.clearData();
	ds_EBill.addRow();
	
	/*//발행일자################################################
	var nodeList = root.getElementsByTagName("ExchangedDocument");
	
	for(var j=0;j<nodeList.length;j++)
	{	
		var node = nodeList[j];
		
		var childNodes = node.childNodes;
		
		for(var i=0; i < childNodes.length; i++)
		{
			// var strTmp = childNodes[i].text;
			// if(strTmp == null) strTmp = "null";
				// trace(childNodes[i].nodeName + "==" + strTMP );
			
			
			if (childNodes[i].nodeName == "IssueDateTime"){
				
				ds_listInput.SetColumn(ds_listInput.row, "TAX_DATE", substr(childNodes[i].text, 0, 8));	
				ds_EBill.SetColumn(ds_EBill.row, "IssueDateTime", substr(childNodes[i].text, 0, 8));	
			}			
		}
	}
	//발행일자################################################
	*/

	//발행번호################################################
	var nodeList = root.getElementsByTagName("TaxInvoiceDocument");
	
	for(var j=0;j<nodeList.length;j++)
	{	
		var node = nodeList[j];
		
		var childNodes = node.childNodes;
		
		for(var i=0; i < childNodes.length; i++)
		{		
			
			if (childNodes[i].nodeName == "IssueID"){
				
				ds_listInput.setColumn(ds_listInput.rowposition, "TAXNO", childNodes[i].text);		
				ds_EBill.setColumn(ds_EBill.rowposition, "IssueID", childNodes[i].text);	
			}		

			//발행일자################################################
			if (childNodes[i].nodeName == "IssueDateTime"){
				
				ds_listInput.setColumn(ds_listInput.rowposition, "TAX_DATE", childNodes[i].text);		
				ds_EBill.setColumn(ds_EBill.rowposition, "IssueDateTime", childNodes[i].text);	
			}
			//발행일자################################################	
				
			if (childNodes[i].nodeName == "PurposeCode"){
				
				// if (sTest = '01') then
				   // edtBtn_BAL_GUBUN.Text := '영수'
				// else if  (sTest = '02') then
				   // edtBtn_BAL_GUBUN.Text := '청구';				
			}						
		}
	}
	//발행번호################################################
	
	//고객사체크################################################
	var nodeList = root.getElementsByTagName("TaxInvoiceTradeSettlement");
	
	for(var j=0;j<nodeList.length;j++)
	{	
		var node = nodeList[j];
		
		var childNodes = node.childNodes;
		
		for(var i=0; i < childNodes.length; i++)
		{		
			
			//if (childNodes[i].nodeName == "InvoiceeParty"){ //매출일경우
			if (childNodes[i].nodeName == "InvoicerParty"){ //매입일경우
											
				var grandChildNodes = childNodes[i].childNodes;
				
				for(var i=0; i < grandChildNodes.length; i++)
				{		
					
					if (grandChildNodes[i].nodeName == "ID"){
												
					    ds_EBill.setColumn(ds_EBill.rowposition, "InvoicerParty_ID", grandChildNodes[i].text);										
					}		
						
				}
										
			}		
				
		}
	}
	//고객사체크################################################
	
	//총공급가/부가세체크######################################
	var nodeList = root.getElementsByTagName("TaxInvoiceTradeSettlement");
	
	for(var j=0;j<nodeList.length;j++)
	{	
		var node = nodeList[j];
		
		var childNodes = node.childNodes;
		
		for(var i=0; i < childNodes.length; i++)
		{		
			
			if (childNodes[i].nodeName == "SpecifiedMonetarySummation"){ 
											
				var grandChildNodes = childNodes[i].childNodes;
				
				for(var i=0; i < grandChildNodes.length; i++)
				{		
					
					if (grandChildNodes[i].nodeName == "ChargeTotalAmount"){
						
						//ds_listInput.SetColumn(ds_listInput.row, "ADJ_AMT", toNumber(grandChildNodes[i].text));
						ds_EBill.setColumn(ds_EBill.rowposition, "ChargeTotalAmount", toNumber(grandChildNodes[i].text));		
						
						//me_AMT.Value = ToNumber(me_ADJ_AMT.Value) + ToNumber(me_VAT.Value);
		
					}		
					
					if (grandChildNodes[i].nodeName == "TaxTotalAmount"){
						
						//ds_listInput.SetColumn(ds_listInput.row, "VAT", toNumber(grandChildNodes[i].text));	
						ds_EBill.setColumn(ds_EBill.rowposition, "TaxTotalAmount", toNumber(grandChildNodes[i].text));		
						
						//me_AMT.Value = ToNumber(me_ADJ_AMT.Value) + ToNumber(me_VAT.Value);
			
					}							
				}
										
			}		
				
		}
	}
	//총공급가/부가세체크######################################
	
	destroyObject(XMLDoc);
}		



function cbo_TAX_IF_GB_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	btn_ImgInsert.enable = false;
	
	if (
        (cbo_ADJ_KIND.value == "001") || //세무 정보관련 항목일 경우
        (cbo_ADJ_KIND.value == "002")
       )
    {
	
		if (e.postvalue == "Y") btn_ImgInsert.enable = true;
		return;
	}
	
	if (e.postvalue == "N") ds_EBill.clearData();
}


//스케쥴 등록#############################################################################
function btn_Sch_Enroll_OnClick(obj:Button, e:ClickEventInfo)
{
	if (ds_listInput.rowcount == 0) return;

    if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0"){    

        g_Message("EE", "업장을 선택하여 주십시요.");
        edt_UPJANG.setFocus();
        return;
    }
    
	f_PopupCode1 = ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID");				
	f_PopupCode2 = ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG");			
// // 	trace(f_PopupCode1 );
// // 	trace(f_PopupCode2 );
    var arg = {f_PopupCode1:f_PopupCode1, f_PopupCode2:f_PopupCode2};
	gfn_dialog("", "U_MAA::MAA10035P.xfdl",arg);
	
}

function btn_Sch_Check_OnClick(obj:Button, e:ClickEventInfo)
{
			
    if (edt_UPJANGQuery.userdata == ""){    

        g_Message("EE", "업장을 선택하여 주십시요.");
        edt_UPJANGQuery.setFocus();
        return;
    }
    
	f_PopupCode1 = ds_listInput.getColumn(ds_listInput.rowposition, "ADV_ID");				
	f_PopupCode2 = ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG");			
	
    var arg = {f_PopupCode1:f_PopupCode1, f_PopupCode2:f_PopupCode2};
	gfn_dialog("", "U_MAA::MAA10036P.xfdl",arg);
	
}
//스케쥴 등록#############################################################################

//=========================================================================
// 세금계산서 월셋팅 이벤트
// 정산처리월과 발행월이 같은지 체크한다.
// 업장에 따라 옵션으로 설정하여 월이 다른것도 처리가능하게 할수 있다.
// 20140602 FC회계팀 이숙자 요청()
//=========================================================================
function btn_Mon_Set_OnClick(obj:Button, e:ClickEventInfo)
{
	f_clkcnt++;
	
	// 설정버튼을 toggle로 설정한다.
	if(f_clkcnt%2 == 1){
		div_Exp.position.left = "818";
		div_Exp.position.top  = "62";
		div_Exp.visible = true;
	}else{
		div_Exp.visible = false;
		return false;
	}
	
	// 초기화
	ds_Exp.clearData();
		
	ds_Exp.addColumn("UPJANG", "INT",    256);
	ds_Exp.addColumn("USER",   "STRING", 256);
	
	ds_Exp.addRow();
	ds_Exp.setColumn(0, "UPJANG",  edt_UPJANGQuery.userdata);
	ds_Exp.setColumn(0, "USER",    g_EmpNo);	
	
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/maa:MAA10030E_S015");

	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "ds_Exp=ds_Exp", "ds_able=ds_list", "", "");	
	http.Sync = false;

	if(ds_able.getColumn(0, "ABLE_YN") == "N"){
		div_Exp.chkNonMachul.value = false;
	}else{
		div_Exp.chkNonMachul.value = true;
	}
	//div_Exp.chkNonMachul.Value = ds_able.GetColumn(0, "ABLE_YN");	
}

//=========================================================================
// 세금계산서 정산시 정산처리월과 발생월이 다르면 등록이 안되게 수정
// 설정에 따라서 등록이 가능할수 있게 프로그램 수정
// 20140602 FC회계팀 이숙자 요청()
//-------------------------------------------------------------------------
// 계산서월설정 이벤트 
//=========================================================================
function div_Exp_chkNonMachul_OnClick(obj:CheckBox, e:ClickEventInfo)
{
	if(edt_UPJANGQuery.value == ""){
		gfn_alert("업장을 선택해 주세요!");
		return;
	}
	
	if(div_Exp.chkNonMachul.value == true){
		if (! g_Confirm("02", '정산처리월과 발행월이 다른 세금계산서를 정산처리할 수 있게 설정 하시겠습니까?')) return;
		// 초기화
		ds_Exp.clearData();
		
		ds_Exp.addColumn("UPJANG", "INT",    256);
		ds_Exp.addColumn("USER",   "STRING", 256);
	
		ds_Exp.addRow();
		ds_Exp.setColumn(0, "UPJANG",  edt_UPJANGQuery.userdata);
		ds_Exp.setColumn(0, "USER",    g_EmpNo);
		fsp_clear(this);
		
		fsp_addSingle(this, "ma/maa:MAA10030E_I005");
		
		http.Sync = true;
		
		// 서버 호출 
		fsp_callService(this, "", "", "ds_Exp=ds_Exp", "ds_able=ds_list",  "", "fn_CallBack_chkTrue");
		
		http.Sync = false;
	}else{
		if (! g_Confirm("02", '정산처리월과 발행월이 같은 세금계산서를 정산처리할 수 있게 설정 하시겠습니까?')) return;
		// 초기화
		ds_Exp.clearData();
		
		ds_Exp.addColumn("UPJANG", "INT",    256);
		ds_Exp.addColumn("USER",   "STRING", 256);
	
		ds_Exp.addRow();
		ds_Exp.setColumn(0, "UPJANG",  edt_UPJANGQuery.userdata);
		ds_Exp.setColumn(0, "USER",    g_EmpNo);
		fsp_clear(this);
		
		fsp_addSingle(this, "ma/maa:MAA10030E_D005");
	
		http.Sync = true;
		
		// 서버 호출 
		fsp_callService(this, "", "", "ds_Exp=ds_Exp", "ds_able=ds_list",  "", "fn_CallBack_chkTrue");
		
		http.Sync = false;	
	}	
}

//========================================================
// 계산서월설정 chkbox 클릭이벤트 Callback함수
//========================================================
function fn_CallBack_chkTrue(errCode, errMsg){
	if (errCode != 0){
		g_Message("EE", errMsg);		
		return;
	}
}

//===================================================================================
// 전도금정산처리월과 세금계산서의 발행월이 달라도 입력이 가능한 업장인지 알아온다.
//===================================================================================
function fn_TaxBillInputYn(){
	var f_AbleYn;
	
	// 초기화
	ds_Exp.clearData();
		
	ds_Exp.addColumn("UPJANG", "INT",    256);
	ds_Exp.addColumn("USER",   "STRING", 256);
	
	ds_Exp.addRow();
	ds_Exp.setColumn(0, "UPJANG",  edt_UPJANGQuery.userdata);
	ds_Exp.setColumn(0, "USER",    g_EmpNo);	
	
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/maa:MAA10030E_S015");

	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "ds_Exp=ds_Exp", "ds_able=ds_list", "", "");	
	http.Sync = true;

	f_AbleYn = ds_able.getColumn(0, "ABLE_YN");	
	
	
	// 	f_AbleYn = "Y"이면 월이 달라도 등록이 가능한 업장이다.
	if(f_AbleYn == "N"){
		//return true;
		if(gfn_subStr(cal_ADJ_DATEQuery.value, 0, 6)== gfn_subStr(cal_TAX_DATE.value, 0, 6)){
			return false;
		}else{
			return true;
		}
	}else{
		// 정산처리월과 발생일의 월이 같은지 확인한다. 
		// (같으면 상관없고 다르면 입력못하게 한다.)
		return false;
		
	}
}

//======================================================================
// 공급가액 버튼 클릭이벤트
// 계정을 '잡급대체가계정'로 선택하면 버튼이 보이고 그렇지 않으면 숨김 
//======================================================================
function edtBtn_SupAmt_OnClick(obj:Button, e:ClickEventInfo)
{
	//alert("공급가액 눌렀냐?");
	// 정산일자 = 지급일자
	// 공급가액 = 지급액
	// 발행금액 = 지급액
	// 적요 = 이름(금액, 지급일자)
/*
    if (NumFormat(ds_listInput.GetColumn(ds_listInput.row, "UPJANG")) == "0"){    
		g_Message("EE", "업장을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_UPJANGQuery.SetFocus();
        return False;
    }
    if (length(ds_listInput.GetColumn(ds_listInput.row, "RCP_DATE")) == 0){    
		g_Message("EE", "입금일자가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 						       
        me_RCP_DATE.SetFocus();
        return False;
    }
*/
	
	ds_listInput.setColumn(ds_listInput.rowposition, "AMT", "");		
	ds_listInput.setColumn(ds_listInput.rowposition, "ACNTCD",  "");
	ds_listInput.setColumn(ds_listInput.rowposition, "SUS_SEQ", "");
	//gfn_dialog("", "U_MAS::MAA10037P.xml", "str_CMSGUBUN=" + "입금대체" + " str_DATE=" + ds_listInput.GetColumn(ds_listInput.row, "RCP_DATE"));
	var sParam = {str_CMSGUBUN:"입금대체", str_DATE:ds_listInput.GetColumn(ds_listInput.row, "RCP_DATE")};
	gfn_dialog("", "U_MAA::MAA10037P.xml", sParam);
	//edt_AMT.SetFocus();
	return true;	
}


// 전도금정산 마감기능 추가
function closeYn(){
	// 초기화
	ds_Exp.clearData();
		
	ds_Exp.addColumn("UPJANG",   "INT",    256);
	ds_Exp.addColumn("INPUT_YM", "STRING", 256);
	
	ds_Exp.addRow();
	ds_Exp.setColumn(0, "UPJANG",   edt_UPJANGQuery.userdata);
	//ds_Exp.SetColumn(0, "INPUT_YM", cal_TAX_DATE.Value);	
	ds_Exp.setColumn(0, "INPUT_YM", cal_ADJ_DATE.value);	


	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/maa:MAA10030E_S016");

	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "ds_Exp=ds_Exp", "ds_able=ds_list", "", "");	
	http.Sync = false;

	if(ds_able.getColumn(0, "CLOSE_YN") == "N"){
		return false;
	}else if(ds_able.getColumn(0, "CLOSE_YN") == ""){
		return false;
	}else{
		return true;
	}

	return false;
}
]]></Script>
  </Form>
</FDL>

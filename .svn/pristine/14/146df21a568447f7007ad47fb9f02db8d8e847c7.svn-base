<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSP00200V" onkeydown="frm_OnKeyDown" onload="form_onload" titletext="구매검수내역" position="absolute 0 0 1252 725" scrollbars="none" onsize="FSP00200V_onsize">
    <Layouts>
      <Layout>
        <Button id="btn_Print1" taborder="18" tabstop="false" text="검수증(일별)" position="absolute 870 101 970 123" class="btn_WF_Print" image="" anchor="top right" onclick="btn_Print1_onclick"/>
        <Button id="btn_Print2" taborder="20" tabstop="false" text="거래명세서(업체일별)" position="absolute 972 101 1115 123" class="btn_WF_Print" image="" anchor="top right" onclick="btn_Print2_onclick"/>
        <Button id="btn_Print3" taborder="21" tabstop="false" text="거래명세서(일반)" userdata="검수증_거래처일반.asp" position="absolute 1117 101 1237 123" class="btn_WF_Print" image="" anchor="top right" onclick="btn_Print3_onclick"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="37" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static29" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 97" anchor="left top right"/>
        <Static id="Static43" text="W10" visible="false" position="absolute 14 30 1229 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static44" text="W10" visible="false" position="absolute 14 87 1229 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static45" text="W15" visible="false" position="absolute 0 30 15 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static51" text="W05." visible="false" position="absolute 14 61 1231 66" style="background:#ff000055;align:center middle;"/>
        <Static id="st_ContractStart" text="검수구분" class="sta_WFSA_label" position="absolute 736 40 798 61" anchor="left top"/>
        <Static id="Static05" text="W30" visible="false" position="absolute 1190 40 1220 61" style="background:#ff000055;align:center middle;"/>
        <Static id="st_title1" text="검수창고" class="sta_WFSA_label" position="absolute 920 40 990 61" anchor="left top"/>
        <Static id="Static08" text="W30" visible="false" position="absolute 387 66 417 87" style="background:#ff000055;align:center middle;"/>
        <Static id="st_ContractStart03" text="검수일자" class="sta_WFSA_label" position="absolute 15 66 77 87" anchor="left top"/>
        <Combo id="cbo_search_type" index="0" type="filter" taborder="3" position="absolute 804 40 890 61" class="cmb_WF_Essential" codecolumn="codecolumn" datacolumn="datacolumn" value="S" text="창고입고">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">S</Col>
                <Col id="datacolumn">창고입고</Col>
              </Row>
              <Row>
                <Col id="codecolumn">D</Col>
                <Col id="datacolumn">부서입고</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <CheckBox id="chk1" taborder="11" tabstop="false" text="거래처" value="false" position="absolute 417 66 475 87" falsevalue="false" truevalue="true"/>
        <Edit autoselect="true" enable="false" id="edt_cust_code" imemode="none" onkeydown="ed_pop_OnKeyDown" readonly="true" taborder="7" userdata="btn_cust_popup" position="absolute 481 66 687 87"/>
        <Button enable="false" id="btn_cust_popup" onclick="btn_pop2_OnClick" taborder="12" tabstop="false" text="" position="absolute 686 66 707 87" class="btn_WF_popSearch" image=""/>
        <Edit autoselect="true" id="edt_search_code" imemode="none" onkeydown="ed_pop_OnKeyDown" readonly="true" taborder="4" userdata="btn_pop1" position="absolute 988 40 1170 61" class="edt_WF_Essential" oneditclick="edt_search_code_oneditclick"/>
        <Button id="btn_pop1" onclick="btn_pop1_OnClick" taborder="8" tabstop="false" text="" position="absolute 1169 40 1190 61" class="btn_WF_popSearch" image=""/>
        <CheckBox enable="false" id="chk2" taborder="13" tabstop="false" text="부서검수전체(비품부서+창고부서)조회" value="false" position="absolute 737 66 964 87" truevalue="1" falsevalue="0"/>
        <CheckBox id="chk3" taborder="14" tabstop="false" text="거래처별조회" value="false" position="absolute 971 66 1063 87" falsevalue="0" truevalue="1" visible="false"/>
        <MaskEdit id="msk_start_dt" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="5" type="string" userdata="btn_FROM_DT" position="absolute 84 66 164 87" class="msk_WF_Essential"/>
        <Button id="btn_FROM_DT" onclick="g_CalButton_OnClick" taborder="9" tabstop="false" userdata="msk_start_dt" position="absolute 163 66 184 87" class="btn_WF_calEssential" text="" image=""/>
        <Static id="st_1" text="~" position="absolute 190 69 198 85"/>
        <MaskEdit id="msk_end_dt" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="6" type="string" userdata="btn_TO_DT" position="absolute 205 66 285 87" class="msk_WF_Essential"/>
        <Button id="btn_TO_DT" onclick="g_CalButton_OnClick" taborder="10" tabstop="false" userdata="msk_end_dt" position="absolute 284 66 305 87" class="btn_WF_calEssential" text="" image=""/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 123 1226 128"/>
        <Static id="Static13" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Static id="Static01" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 96 1226 101"/>
        <Grid id="grd_detail" taborder="38" binddataset="ds_detail" wheelscrollrow="1" autoenter="select" cellsizingtype="both" autofittype="col" onrbuttonup="grd_detail_OnRButtonUp" onheadclick="grd_List_OnHeadClick" position="absolute 0 427 1237 710" anchor="all" oncelldblclick="grd_detail_oncelldblclick" class="grd_WF_LineNone" oncellclick="grd_detail_oncellclick">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30"/>
                <Column size="80"/>
                <Column size="210"/>
                <Column size="120"/>
                <Column size="50"/>
                <Column size="50"/>
                <Column size="130"/>
                <Column size="130"/>
                <Column size="60"/>
                <Column size="150"/>
                <Column size="150"/>
                <Column size="40"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="자재코드"/>
                <Cell col="2" displaytype="text" text="자재명"/>
                <Cell col="3" displaytype="text" text="규격"/>
                <Cell col="4" displaytype="text" text="단위"/>
                <Cell col="5" displaytype="text" text="과세"/>
                <Cell col="6" colspan="3" displaytype="text" text="거래처"/>
                <Cell col="9" colspan="2" displaytype="text" text="창고(검수부서)"/>
                <Cell col="11" rowspan="2" taborder="undefined"/>
                <Cell row="1" col="2" colspan="2" displaytype="text" text="계정과목"/>
                <Cell row="1" col="4" colspan="2" displaytype="text" text="수량"/>
                <Cell row="1" col="6" displaytype="text" text="단가"/>
                <Cell row="1" col="7" displaytype="text" text="금액"/>
                <Cell row="1" col="8" displaytype="text" text="구분"/>
                <Cell row="1" col="9" displaytype="text" text="마감전표"/>
                <Cell row="1" col="10" displaytype="text" text="비고"/>
              </Band>
              <Band id="body">
                <Cell rowspan="2" displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" rowspan="2" displaytype="text" style="align:center;" text="bind:ITEM_CODE" suppress="0"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:ITEM_NAME" suppress="0"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:ITEM_SIZE"/>
                <Cell col="4" displaytype="text" style="align:center;" text="bind:TRANS_UOM"/>
                <Cell col="5" displaytype="combo" style="align:center;" text="bind:TAX_CODE" combodataset="ds_tax" combocodecol="CODE" combodatacol="CODE_NAME"/>
                <Cell col="6" colspan="3" displaytype="text" style="align:left;" text="bind:CUSTNM"/>
                <Cell col="9" colspan="2" displaytype="text" style="align:left;" text="bind:CC_NM"/>
                <Cell col="11" rowspan="2" displaytype="image" text="expr:EPRO_FILE_GRP != null ? 'theme://convertImages\\ico_Save.png' : ''" taborder="undefined"/>
                <Cell row="1" col="2" colspan="2" displaytype="text" style="align:left;" text="bind:ACCTNM"/>
                <Cell row="1" col="4" colspan="2" displaytype="number" style="align:right;" text="bind:TRANS_QTY"/>
                <Cell row="1" col="6" displaytype="number" style="align:right;" text="bind:TRANS_MPRICE"/>
                <Cell row="1" col="7" displaytype="number" style="align:right;" text="bind:TRANS_MAMOUNT"/>
                <Cell row="1" col="8" displaytype="text" style="align:center;" text="bind:TRANS_GUBUN"/>
                <Cell row="1" col="9" displaytype="text" style="align:left;" text="bind:GANO"/>
                <Cell row="1" col="10" displaytype="text" style="align:left;" text="bind:REMARK"/>
              </Band>
            </Format>
            <Format id="Default0">
              <Columns>
                <Column size="25"/>
                <Column size="100"/>
                <Column size="187"/>
                <Column size="45"/>
                <Column size="110"/>
                <Column size="50"/>
                <Column size="85"/>
                <Column size="76"/>
                <Column size="85"/>
                <Column size="102"/>
                <Column size="79"/>
                <Column size="79"/>
                <Column size="79"/>
                <Column size="79"/>
                <Column size="79"/>
              </Columns>
              <Rows>
                <Row size="25" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="자재코드"/>
                <Cell col="2" displaytype="text" text="자재명"/>
                <Cell col="3" displaytype="text" text="규격"/>
                <Cell col="4" displaytype="text" text="계정과목"/>
                <Cell col="5" displaytype="text" text="단위"/>
                <Cell col="6" displaytype="text" text="과세"/>
                <Cell col="7" displaytype="text" text="수량"/>
                <Cell col="8" displaytype="text" text="거래처"/>
                <Cell col="9" displaytype="text" text="단가"/>
                <Cell col="10" displaytype="text" text="금액"/>
                <Cell col="11" displaytype="text" text="구분"/>
                <Cell col="12" displaytype="text" text="창고(검수부서)"/>
                <Cell col="13" displaytype="text" text="마감전표"/>
                <Cell col="14" displaytype="text" text="비고"/>
                <Cell col="15" displaytype="text" text="금액"/>
                <Cell col="16" displaytype="text" text="구분"/>
                <Cell col="17" displaytype="text" text="마감전표"/>
                <Cell col="18" displaytype="text" text="비고"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:ITEM_CODE"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:ITEM_NAME"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:ITEM_SIZE"/>
                <Cell col="4" displaytype="text" style="align:left;" text="bind:ACCTNM"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:TRANS_UOM"/>
                <Cell col="6" displaytype="combo" style="align:left;" text="bind:TAX_CODE" combodataset="ds_TAX" combocodecol="CODE" combodatacol="CODE_NAME"/>
                <Cell col="7" displaytype="number" style="align:left;" text="bind:TRANS_QTY"/>
                <Cell col="8" displaytype="text" style="align:left;" text="bind:CUSTNM"/>
                <Cell col="9" displaytype="number" style="align:left;" text="bind:TRANS_MPRICE"/>
                <Cell col="10" displaytype="text" style="align:left;" text="bind:TRANS_MPRICE"/>
                <Cell col="11" displaytype="text" style="align:left;" text="bind:TRANS_GUBUN"/>
                <Cell col="12" displaytype="text" style="align:left;" text="bind:CC_NM"/>
                <Cell col="13" displaytype="text" style="align:left;" text="bind:GANO"/>
                <Cell col="14" displaytype="text" style="align:left;" text="bind:REMARK"/>
                <Cell col="15" displaytype="number" style="align:left;" text="bind:TRANS_MAMOUNT"/>
                <Cell col="16" displaytype="text" style="align:left;" text="bind:TRANS_GUBUN"/>
                <Cell col="17" displaytype="text" style="align:left;" text="bind:GANO"/>
                <Cell col="18" displaytype="text" style="align:left;" text="bind:REMARK"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static00" text="W30" visible="false" position="absolute 707 66 737 87" style="background:#ff000055;align:center middle;"/>
        <Static id="Static25" text="사업부" class="sta_WFSA_label" position="absolute 14 41 84 62"/>
        <MuSearchComponent id="cbo_mu" titletext="사업부 선택 Component" taborder="0" text="MuSearchComponent00" class="cmb_WF_Essential" position="absolute 79 40 207 61" bindDataset="ds_condi" bindMuCdColumn="MU_CD" appendText="" onItemChangedEvent="fn_muChange"/>
        <Static id="Static02" text="팀" class="sta_WFSA_label" position="absolute 237 40 257 61"/>
        <TmSearchComponent id="edt_tm" titletext="팀 검색용 Component" taborder="1" text="TmSearchComponent00" position="absolute 265 40 387 61" bindDataset="ds_condi" bindTmCdColumn="TM_CD" bindTmNmColumn="" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tmChange" eventBeforeTrigger="" class="edt_WF_Essential"/>
        <Static id="Static12" text="W30" visible="false" position="absolute 387 40 417 61" style="background:#ff000055;align:center middle;"/>
        <Static id="st_UPJANG" text="사업장" class="sta_WFSA_label" position="absolute 417 40 490 61" anchor="left top" userdata=""/>
        <UpjangSearchComponent id="edt_upjang" titletext="업장 검색용 Component" taborder="2" text="UpjangSearchComponent00" position="absolute 481 40 707 61" tooltiptext="입고업장" bindDataset="ds_condi" bindUpjangCodeColumn="UPJANG" bindUpjangNameColumn="" eventBeforeTrigger="" eventAfterTrigger="fn_changUpjang" roleSetId="" class="edt_WF_Essential"/>
        <Static id="Static03" text="W30" visible="false" position="absolute 707 40 737 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static04" text="W30" visible="false" position="absolute 890 40 920 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static06" text="W30" visible="false" position="absolute 207 40 237 61" style="background:#ff000055;align:center middle;"/>
        <Grid id="grd_master" taborder="39" useinputpanel="false" position="absolute 0 128 1237 407" class="grd_WF_LineNone" binddataset="ds_master" anchor="all" autofittype="col" oncelldblclick="grd_master_oncelldblclick">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="22"/>
                <Column size="100"/>
                <Column size="200"/>
                <Column size="0"/>
                <Column size="400"/>
                <Column size="150"/>
                <Column size="150"/>
                <Column size="150"/>
                <Column size="0"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="검수일자"/>
                <Cell col="2" text="검수부서"/>
                <Cell col="3" text="거래처"/>
                <Cell col="4" text="제목"/>
                <Cell col="5" text="검수금액"/>
                <Cell col="6" text="부가세"/>
                <Cell col="7" text="검수총액"/>
                <Cell col="8" text="마감전표"/>
              </Band>
              <Band id="body">
                <Cell style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="date" style="align:center;" text="bind:TRANS_DATE"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:CC_NM"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:CUSTNM"/>
                <Cell col="4" displaytype="text" style="align:left;" text="bind:ITEM_TITLE"/>
                <Cell col="5" displaytype="number" style="align:right;" text="bind:TRANS_MAMOUNT"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:TRANS_MVAT"/>
                <Cell col="7" displaytype="number" style="align:right;" text="bind:TOT_AMT"/>
                <Cell col="8" displaytype="text" style="align:left;" text="bind:GANO"/>
              </Band>
              <Band id="summary">
                <Cell colspan="5" style="align:center;" text="합계"/>
                <Cell col="5" displaytype="number" style="align:right;" expr="expr:getSum('TRANS_MAMOUNT')"/>
                <Cell col="6" displaytype="number" style="align:right;" expr="expr:getSum('TRANS_MVAT')"/>
                <Cell col="7" displaytype="number" style="align:right;" expr="expr:getSum('TOT_AMT')"/>
                <Cell col="8" style="align:left;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Splitter id="sp_line" min="128" max="590" type="vertical" class="spt_WF_2" position="absolute 0 412 1237 422" anchor="left top right">
          <Formats>
            <Format id="default">
              <SplitterItems id="items">
                <SplitterItem id="item00" bindtype="resize" position="leftortop" offset="5" componentid="grd_master"/>
                <SplitterItem id="item01" bindtype="resize" position="rightorbottom" offset="5" componentid="grd_detail"/>
              </SplitterItems>
            </Format>
          </Formats>
        </Splitter>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_condi" oncolumnchanged="ds_condi_OnColumnChanged">
        <ColumnInfo>
          <Column id="MU_CD" type="STRING" size="256"/>
          <Column id="TM_CD" type="STRING" size="256"/>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="SEARCH_TYPE" size="256" type="STRING"/>
          <Column id="SEARCH_CODE" size="256" type="STRING"/>
          <Column id="START_DT" size="256" type="STRING"/>
          <Column id="END_DT" size="256" type="STRING"/>
          <Column id="CUSTCD" size="256" type="STRING"/>
          <Column id="CHK1" size="256" type="STRING"/>
          <Column id="CHK2" size="256" type="STRING"/>
          <Column id="CHK3" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CHK1">0</Col>
            <Col id="CHK2">0</Col>
            <Col id="CHK3">0</Col>
            <Col id="CUSTCD"/>
            <Col id="START_DT"/>
            <Col id="SEARCH_CODE"/>
            <Col id="SEARCH_TYPE">S</Col>
            <Col id="END_DT"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_tax"/>
      <Dataset id="ds_detail"/>
      <Dataset id="ds_master">
        <ColumnInfo>
          <Column id="TRANS_DATE" type="string" size="8"/>
          <Column id="TRANS_DEPT_ID" type="string" size="18"/>
          <Column id="CC_NM" type="string" size="201"/>
          <Column id="ITEM_TITLE" type="string" size="544"/>
          <Column id="TRANS_MAMOUNT" type="bigdecimal" size="39"/>
          <Column id="TRANS_MVAT" type="bigdecimal" size="39"/>
          <Column id="TOT_AMT" type="bigdecimal" size="39"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="cbo_STYPE_value" compid="cbo_search_type" propid="value" datasetid="ds_condi" columnid="SEARCH_TYPE"/>
      <BindItem id="me_FROM_DT_value" compid="msk_start_dt" propid="value" datasetid="ds_condi" columnid="START_DT"/>
      <BindItem id="me_TO_DT_value" compid="msk_end_dt" propid="value" datasetid="ds_condi" columnid="END_DT"/>
      <BindItem id="chk2_value" compid="chk2" propid="value" datasetid="ds_condi" columnid="CHK2"/>
      <BindItem id="chk3_value" compid="chk3" propid="value" datasetid="ds_condi" columnid="CHK3"/>
      <BindItem id="chk1_value" compid="chk1" propid="value" datasetid="ds_condi" columnid="CHK1"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 구매관리/입고관리/구매검수내역
 * 프로그램명   : FSP00200V.XML
 * 기      능   : 구매검수내역
 * 작  성  자   : 정영철
 * 작성  일자   : 2015-06-10
 * 비      고   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *				2017.03.27	kihoon	[CH201703_00631] 구매 파일 다운로드
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::lib_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"
//@@컨버터에서 주석처리 #include "lib::fs_common.js"
//@@컨버터에서 주석처리 #include "lib::po_common.js"
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(this);
	
	// X-Framework : Action 정보 생성 
	fsp_init(this);
	
	// FSP공통함수 호출
	fn_PoCommon();
	
	fn_init();
}

function fn_init()
{
 	// 초기값 셋팅
 	var f_CurrDate 	= fn_CurrDateWeek();
	msk_start_dt.value  = f_CurrDate;			
	msk_end_dt.value    = f_CurrDate;
	
	// 공통코드
	v_ds = fn_common_code("'SC0002'","","","non", "Y");
	
	// 세금코드
	v_fil_cond = "GROUP_CODE == 'SC0002'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_tax, v_ds.name);
	
	edt_tm.applyAuthLevel(cbo_mu);
	edt_upjang.applyAuthLevel(edt_tm);
	
	// 검수구분 포커스 설정
	cbo_search_type.setFocus();
}

//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_search()
{
	var sSvcID;			// 서비스 ID
	var sUrl;			// jsp 경로
	var sInDs;			// 입력 데이터셋
	var sOutDs;			// 출력 데이터셋
	var sArg;			// 추가 파라미터
	var sCallFunc;		// 콜백함수명
	
	fsp_clear(this);	// Action 호출 정보 초기화하기
	
	// 입력 데이터셋 셋팅
	sSvcID		= "SEARCH";
	sUrl		= "U_svc::" + "fs/fsp/FSP00200V_T001.jsp";
	sInDs		= "ds_condi=ds_condi";
	sOutDs		= "ds_master=ds_out";
	sCallFunc 	= "fn_transation_callback";
	
	// 유효성 체크
	if(!fn_transation_validation(sSvcID)){return false;}
	
	// 데이터셋 초기화
	ds_master.clearData();
	ds_detail.clearData();
	
	// 트랜잭션
	jsp_transaction(this, sSvcID, sUrl, sInDs, sOutDs, sArg, sCallFunc, true, false, false);
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_searchDetail(nRow)
{
	var sSvcID;			// 서비스 ID
	var sUrl;			// jsp 경로
	var sInDs;			// 입력 데이터셋
	var sOutDs;			// 출력 데이터셋
	var sArg;			// 추가 파라미터
	var sCallFunc;		// 콜백함수명
	var sTransDate;
	
	fsp_clear(this);	// Action 호출 정보 초기화하기
	
	sTransDate = ds_master.getColumn(nRow, "TRANS_DATE");
	// 입력 데이터셋 셋팅
	sSvcID		= "SEARCH_DETAIL";
	sUrl		= "U_svc::" + "fs/fsp/FSP00200V_T002.jsp";
	sInDs		= "ds_condi=ds_condi";
	sArg        = 
	sArg        = "p_trans_date=" + wrapQuote(sTransDate);
	sOutDs		= "ds_detail=ds_out";
	sCallFunc 	= "fn_transation_callback";
	
	// 유효성 체크
	if(!fn_transation_validation(sSvcID)){return false;}
	
	// 데이터셋 초기화
	ds_detail.clearData();
	
	// 트랜잭션
	jsp_transaction(this, sSvcID, sUrl, sInDs, sOutDs, sArg, sCallFunc, true, false, false);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 콜백함수
 *---------------------------------------------------------------------------------------------*/
function fn_transation_callback(nErrorCode, sErrorMag, sSvcID)
{
	var sResult = "";
	var sMsg    = "";
	if(nErrorCode != 0) {return ;}
	
	switch(sSvcID){
		
		case "SEARCH" :	// 구매유형
			if (ds_master.rowcount < 1){
				g_Message("EE","조회된 자료가 없습니다.");
			}
			break;
		
		case "SEARCH_DETAIL" :	// 구매유형
			if (ds_detail.rowcount < 1){
				g_Message("EE","조회된 자료가 없습니다.");
			}
			break;
	}
}

/*----------------------------------------------------------------------------------------------
 * 함  수  명   : fn_transation_validation()
 * 기      능   : 조회 전 유효성체크
*----------------------------------------------------------------------------------------------*/
function fn_transation_validation(sSvcID)
{
	if(!mfn_Chk_Obj_MustInput(msk_start_dt)) 	return false;  	// 시작일 	
	if(!mfn_Chk_Obj_MustInput(msk_end_dt)) 	return false; 	// 종료일
	if(!fn_dateBetweenCheck(msk_start_dt, msk_end_dt)) {	// 시작일 종료일 체크
		return false;
	}
	
	if(!mfn_Chk_Obj_IsNotNull(cbo_mu.cbo_mu)){
 				g_Message("EE", "※ 사업부을 선택하세요");
 				cbo_mu.cbo_mu.class = "cmb_WF_Error";
 				cbo_mu.setFocus();
 				return false; 	
 	}
 	cbo_mu.cbo_mu.class = "cmb_WF_Essential";
	
	if(!mfn_Chk_Obj_IsNotNull(edt_tm.edt_tmCd)){
 				g_Message("EE", "※ 팀을 선택하세요");
 				edt_tm.edt_tmCd.class = "edt_WF_Error";
 				edt_tm.setFocus();
 				return false; 	
 	}
 	edt_tm.edt_tmCd.class = "edt_WF_Essential";
	
	if(!mfn_Chk_Obj_IsNotNull(edt_upjang.edt_upjangCd)){
 				g_Message("EE", "※ 사업장을 선택하세요");
 				edt_upjang.edt_upjangNm.class = "edt_WF_Error";
 				edt_upjang.setFocus();
 				return false; 	
 	}
 	edt_upjang.edt_upjangNm.class = "edt_WF_Essential";
	
	if(!mfn_Chk_Obj_IsNotNull(edt_search_code)){
		g_Message("EE", "※ "+ st_title1.text+"을 선택하세요");
		edt_search_code.class = "edt_WF_Error";
		edt_search_code.setFocus();
		return false; 	
	}
	edt_search_code.class = "edt_WF_Essential";

    return true;
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Insert()
 * 기      능   : [입력버튼] 입력 시 처리되는 작업
 * 비      고	: 팝업사용
 ******************************************************************************************
 */
function fn_insert()
{
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Save()
 * 기      능   : [저장버튼] 저장 시 처리되는 작업
 ******************************************************************************************
 */
function fn_save()
{
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function fn_Close()
{
	this.close();
}



/*
 ******************************************************************************************
 * 함  수  명   : fn_Excel()
 * 기      능   : [엑셀버튼] 엑셀 변환 시 처리되는 작업
 ******************************************************************************************
 */
function fn_Excel()
{
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================

/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSearch()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 조회 후 실행 함수
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-03  
 ******************************************************************************************
 */
function fn_afterSearch(errCode, errMsg)
{
	if (errCode !=0) return;
	
	if (chk3.value==1)
	{
		grd_list.setFormatColProperty(3,"size",0);
		grd_list.setFormatColProperty(4,"size",130);
	}
	else
	{
		grd_list.setFormatColProperty(3,"size",130);
		grd_list.setFormatColProperty(4,"size",0);
	}
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================

/*
 ******************************************************************************************
 * 함  수  명   : btn_pop1_OnClick(obj)
 * 기      능   : 팝업버튼 클릭-검수창고/검수부서조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-11
 ******************************************************************************************
 */
function btn_pop1_OnClick(obj:Button, e:ClickEventInfo)
{
	var strQuery,strQuery_KeyField,strQuery_ValueField,strQuery_KeyFieldNM,strQuery_ValueFieldNM,strQuery_Caption,strQuery_AllField;
	
	var sUpjang = ds_condi.getColumn(0, "UPJANG");
	if (cbo_search_type.value == "S")		// 창고
	{
		strQuery = "SELECT A.SUBINV_CODE, ";
		//strQuery += "       DECODE(A.USE_YN, 'N' , '폐장' )||A.SUBINV_CODE||' '||A.SUBINV_NAME||' ( '|| REPLACE(B.UPJANGNM,'단체급식 ')||' ) ' AS SUBINV_NAME ";
		strQuery += "       DECODE(A.USE_YN, 'N' , '폐장' )||' '||A.SUBINV_NAME AS SUBINV_NAME ";
		strQuery += "  FROM HLDC_PO_SUBINVENTORY A, ";
		strQuery += "       HLDC_ST_UPJANG B ";
		strQuery += " WHERE A.UPJANG = B.UPJANG ";
		strQuery += "   AND A.UPJANG = "+ sUpjang +" ";
		strQuery_KeyField		= "SUBINV_CODE";
		strQuery_ValueField		= "DECODE(A.USE_YN, 'N' , '폐장' )||' '||A.SUBINV_NAME ";
		
		NM 	= "창고코드";
		strQuery_ValueFieldNM 	= "창고명";
		strQuery_Caption		= "창고정보조회";
		
		fn_sql_common_setup( strQuery
						,strQuery_KeyField
						,strQuery_ValueField
						,strQuery_KeyFieldNM
						,strQuery_ValueFieldNM
						,""
						,""
						,""
						,strQuery_Caption
						,"SUBINV_CODE;SUBINV_NAME"
						);
	}
	else							// 부서
	{
		strQuery = "SELECT A.DEPT_ID, ";
		strQuery += "       A.DEPT_NAME";
		strQuery += "  FROM ";
		strQuery += "       ( ";
		strQuery += "       SELECT B.DEPT_ID, ";
		//strQuery += "              DECODE(B.DEPT_USE, 'N' , ' (구) ' )||' ( '||B.CC_CD||' ) '||B.MU_NM||''||B.CC_NM||' ( '||TO_CHAR(B.DEPT_ID)||' ) ' AS DEPT_NAME ,";
		strQuery += "              DECODE(B.DEPT_USE, 'N' , ' (구) ' )||' '||B.CC_NM AS DEPT_NAME ,";
		strQuery += "              B.DEPT_USE AS USE_YN ";
		strQuery += "         FROM ";
		strQuery += "              ( ";
		strQuery += "              SELECT A.UPJANG ";
		strQuery += "                FROM HLDC_PO_SUBINVENTORY A ";
		strQuery += "               WHERE A.USE_YN = 'Y' ";
		strQuery += "             UNION ALL ";
 		strQuery += "             SELECT " + sUpjang + " AS UPJANG  ";
		strQuery += "                FROM DUAL ";
 		strQuery += "             ) A , ";
		strQuery += "              HLDC_SC_DEPT_V B, ";
		strQuery += "              HLDC_ST_UPJANG C ";
		strQuery += "        WHERE A.UPJANG = C.UPJANG ";
		strQuery += "          AND A.UPJANG = " + sUpjang;
		strQuery += "          AND C.DEPT_ID = B.DEPT_ID ";
		strQuery += "        GROUP BY B.DEPT_ID, ";
		strQuery += "              DECODE(B.DEPT_USE, 'N' , ' (구) ' )||' '||B.CC_NM , ";
		strQuery += "              B.DEPT_USE ";
		strQuery += "       ) A ";
		strQuery += " WHERE (1 = 1) ";
		strQuery += "   AND A.USE_YN = 'Y' ";
		
		strQuery_KeyField		= "DEPT_ID";
		strQuery_ValueField		= "DEPT_NAME";
		strQuery_KeyFieldNM 	= "부서코드";
		strQuery_ValueFieldNM 	= "부서명";
		strQuery_Caption		= "부서정보조회";
		
		fn_sql_common_setup( strQuery
						,strQuery_KeyField
						,strQuery_ValueField
						,strQuery_KeyFieldNM
						,strQuery_ValueFieldNM
						,""
						,""
						,""
						,strQuery_Caption
						,"DEPT_ID;DEPT_NAME"
						);
	}
	edt_search_code.value = gds_sql_common.getColumn(0, "ret_name");
	ds_condi.setColumn(0,"SEARCH_CODE", gds_sql_common.getColumn(0, "ret_code")); 
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Popup
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 검수창고/검수부서조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-11
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function btn_pop2_OnClick(obj:Button, e:ClickEventInfo)
{
	var strQuery,strQuery_KeyField,strQuery_ValueField,strQuery_KeyFieldNM,strQuery_ValueFieldNM,strQuery_Caption,strQuery_AllField;
	
	if (chk1.value)		// 거래처체크
	{
		// 조회조건체크
		if(!fn_transation_validation())
		{
			return;
		}
	
		strQuery = "SELECT DISTINCT A.CUSTCD, B.VD_NM||'('||B.BIZ_REG_NO ||')' CUSTNM ";
		strQuery += "  FROM HLDC_PO_TRANSACTION A, VO_FC_VENDOR B ";
		strQuery += " WHERE A.CUSTCD = B.VD_CD ";
		strQuery += "   AND A.TRANS_DATE BETWEEN '" + ds_condi.getColumn(0,"START_DT") + "' AND '" + ds_condi.getColumn(0,"END_DT") + "' ";
		if (cbo_search_type.value == "S")		// 창고입고
		{
			strQuery += "    AND A.SUBINV_CODE = '" + ds_condi.getColumn(0,"SEARCH_CODE") + "' ";
		}
		else							// 부서입고
		{
			strQuery += "    AND A.TRANS_DEPT_ID = '" + ds_condi.getColumn(0,"SEARCH_CODE") + "' ";
			
			if (chk2.value)		// 부서검수 전체 체크시
			{
				strQuery += "    AND A.SUBINV_CODE > ' ' ";
			}
			else				// 부서검수 전체 미체크시
			{
				strQuery += "    AND A.SUBINV_CODE IS NULL ";
			}
		}
		strQuery += "    AND A.TRANS_TYPE = 'I001' ";
	}
	else					// 거래처 체크안함.
	{
		strQuery	= strPOQuery_CUST;
	}
	
	
	fn_sql_common_setup( strQuery
						,strPOQuery_CUSTKeyField
						,strPOQuery_CUSTValueField
						,strPOQuery_CUSTKeyFieldNM
						,strPOQuery_CUSTValueFieldNM
						,""
						,""
						,""
						,strPOQuery_CUSTCaption
						,"CUSTCD;CUSTNM"
						);
	
	edt_cust_code.value = gds_sql_common.getColumn(0, "ret_name");
	ds_condi.setColumn(0,"CUSTCD", gds_sql_common.getColumn(0, "ret_code"));
}

/*
 ******************************************************************************************
 * 함  수  명   : ed_pop_OnKeyDown(obj,nChar,bShift,bCtrl, bAlt,LLParam,HLParam)
 * 기      능   : edit엔터시 팝업호출
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-18  
 ******************************************************************************************
 */
function ed_pop_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13)
	{
		var objme = eval(obj.userdata);
		objme.click();
	}
	 else if( e.keycode == 46 ) {
		switch(obj.name) {
			case "edt_search_code" :
				ds_condi.setColumn(0, "SEARCH_CODE", "");
				edt_search_code.value = "";
				break;
				
			case "edt_cust_code" :
				ds_condi.setColumn(0, "CUSTCD", "");
				edt_cust_code.value = "";
				break;
			default :
				break;
		}
	}
}

/*
 ******************************************************************************************
 * 함  수  명   : ds_condi_OnColumnChanged()
 * 기      능   : 검색조건변경시
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-03  
 ******************************************************************************************
 */
function ds_condi_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	switch(e.columnid)
	{
		// 검수구분
		case "SEARCH_TYPE" : 
			st_title1.text = e.newvalue == "S" ? "검수창고" : "검수부서";
			chk2.enable    = e.newvalue == "S" ? false      : true;
			ds_condi.setColumn(0, "SEARCH_CODE", "");
			ds_condi.setColumn(0, "CUSTCD", "");
			edt_search_code.value = "";
			edt_cust_code.value = "";
			break;
		
		// 거래처체크박스
		case "CHK1" : 
			if(e.newvalue == "false") 
			{
				ds_condi.setColumn(0, "CUSTCD", "");
				edt_cust_code.value = "";
			}
			edt_cust_code.enable  = chk1.value;
			btn_cust_popup.enable = edt_cust_code.enable;
			if(chk1.value) edt_cust_code.setFocus();
			break;
			
		case "default" : 
			
			break;
	}
}
/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
	1. Function    : fn_dateBetweenCheck
	2. Description : 기간 달력 시작일 종료일 체크
	3. Arguments   : objFr-시작일 컴퍼넌트, objTo-종료일 컴퍼넌트
	4. History     : 2008. 02. 04 - 최초작성
	                 2015. 06. 03 - 고도화
 *---------------------------------------------------------------------------------------------*/
function fn_dateBetweenCheck(objFr, objTo)
{
	var sDtFr = objFr.value;	// 시작일
	var sDtTo = objTo.value;	// 종료일
	
	if(sDtFr > sDtTo){
		gfn_alert("msg.err.validator.date.great", "");
		objTo.value = objFr.value;
		objFr.setFocus();
		return false;
	}
	return true;
}
// 폼 온키다운 이벤트
function frm_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e);
	if ( (e.keycode == 13) && (e.fromreferenceobject == msk_end_dt)) fn_search();
}

// 상세 그리드에서 마우스 오른쪽 버튼 클릭 이벤트
function grd_detail_OnRButtonUp(obj:Grid, e:GridMouseEventInfo)
{
	if(grd_detail.formatid == "Default")
	{
		grd_detail.formatid = "Default0";
	}else{
		grd_detail.formatid = "Default";
	}	
}

// 부서코드 변경시 팀코드, 업장 초기화
function fn_muChange(obj, event)
{
	edt_tm.setTmCode("");
	edt_upjang.setUpjangCode("");
	ds_condi.setColumn(0, "SEARCH_CODE", "");
	ds_condi.setColumn(0, "CUSTCD", "");
	edt_search_code.value = "";
	edt_cust_code.value = "";
	
}

// 팀코드 변경시 업장코드 초기화
function fn_tmChange(obj, data)
{
	edt_upjang.setUpjangCode("");
	ds_condi.setColumn(0, "SEARCH_CODE", "");
	ds_condi.setColumn(0, "CUSTCD", "");
	edt_search_code.value = "";
	edt_cust_code.value = "";
}

function fn_changUpjang()
{
	ds_condi.setColumn(0, "SEARCH_CODE", "");
	ds_condi.setColumn(0, "CUSTCD", "");
	edt_search_code.value = "";
	edt_cust_code.value = "";
}

//검수증일별 출력
function btn_Print1_onclick(obj:Button,  e:ClickEventInfo)
{
	if (ds_detail.rowcount <= 0)
	{
		g_Message("EE", "출력오류 : 출력 할 내역이 없습니다.");
		return;
	}
	
	//레포트에 전달할 파라메터 생성
	var arrParams	= SCReport.newParams ();
 	SCReport.setParams (arrParams, SCReport.RPT_NAME, "/IFIS/FSP00200V_R01.ozr");
	
	//출력 옵션 설정
	//-창 타이틀 (디폴트는 "ReportViewer")
	SCReport.setParams (arrParams, SCReport.RPT_TITLE, "검수증(일별)");

	//레포트에 맞게 전달되는 개발자 정의 파라미터
	SCReport.setParams (arrParams, "TRANS_DATE"  , ds_detail.getColumn(ds_detail.rowposition, "TRANS_DATE"));
	SCReport.setParams (arrParams, "TRANS_UPJANG", ds_condi.getColumn(0, "UPJANG"));
	SCReport.setParams (arrParams, "SUBINV_CODE" , ds_detail.getColumn(ds_detail.rowposition, "SUBINV_CODE"));
	
	if(chk1.value == "true")
		SCReport.setParams (arrParams, "CUSTCD"      , ds_condi.getColumn(0, "CUSTCD"));
	else
		SCReport.setParams (arrParams, "CUSTCD"      , "");
	
	SCReport.setParams (arrParams, "zoom", 150);
	//--------------------------------------------------
	SCReport.viewReport (this, arrParams);
}

// 거래명세서 업체일병 출력
function btn_Print2_onclick(obj:Button,  e:ClickEventInfo)
{
	if (ds_detail.rowcount <= 0)
	{
		g_Message("EE", "출력오류 : 출력 할 내역이 없습니다.");
		return;
	}
	
	//레포트에 전달할 파라메터 생성
	var arrParams	= SCReport.newParams ();
 	SCReport.setParams (arrParams, SCReport.RPT_NAME, "/IFIS/FSP00200V_R02.ozr");
	
	//출력 옵션 설정
	//-창 타이틀 (디폴트는 "ReportViewer")
	SCReport.setParams (arrParams, SCReport.RPT_TITLE, "거래명세서(업체일별)");

	//레포트에 맞게 전달되는 개발자 정의 파라미터
	SCReport.setParams (arrParams, "TRANS_UPJANG", ds_detail.getColumn(ds_detail.rowposition, "TRANS_UPJANG"));
	SCReport.setParams (arrParams, "TRANS_DATE"  , ds_detail.getColumn(ds_detail.rowposition, "TRANS_DATE"));
	SCReport.setParams (arrParams, "SUBINV_CODE" , ds_detail.getColumn(ds_detail.rowposition, "SUBINV_CODE"));
	
	if(chk1.value == "true")
		SCReport.setParams (arrParams, "CUSTCD"      , ds_condi.getColumn(0, "CUSTCD"));
	else
		SCReport.setParams (arrParams, "CUSTCD"      , "");

	SCReport.setParams (arrParams, "URL_PATH"    , application.services.get_item("svc").url + "upload/hwpo/");

	SCReport.setParams (arrParams, "zoom", 150);
	//--------------------------------------------------
	SCReport.viewReport (this, arrParams);
}

function btn_Print3_onclick(obj:Button,  e:ClickEventInfo)
{
	if (ds_detail.rowcount <= 0)
	{
		g_Message("EE", "출력오류 : 출력 할 내역이 없습니다.");
		return;
	}
	
	//레포트에 전달할 파라메터 생성
	var arrParams	= SCReport.newParams ();
 	SCReport.setParams (arrParams, SCReport.RPT_NAME, "/IFIS/FSP00200V_R03.ozr");
	
	//출력 옵션 설정
	//-창 타이틀 (디폴트는 "ReportViewer")
	SCReport.setParams (arrParams, SCReport.RPT_TITLE, "거래명세서(일반)");

	//레포트에 맞게 전달되는 개발자 정의 파라미터
	
	SCReport.setParams (arrParams, "TRANS_DATE"  , ds_detail.getColumn(ds_detail.rowposition, "TRANS_DATE"));
	SCReport.setParams (arrParams, "TRANS_UPJANG", ds_detail.getColumn(ds_detail.rowposition, "TRANS_UPJANG"));
	SCReport.setParams (arrParams, "SUBINV_CODE" , ds_detail.getColumn(ds_detail.rowposition, "SUBINV_CODE"));

	if(chk1.value == "true")
		SCReport.setParams (arrParams, "CUSTCD"      , ds_condi.getColumn(0, "CUSTCD"));
	else
		SCReport.setParams (arrParams, "CUSTCD"      , "");

	SCReport.setParams (arrParams, "URL_PATH"    , application.services.get_item("svc").url + "/upload/hwpo/");
	//SCReport.setParams (arrParams, "URL_PATH"    , "http://172.16.1.75:8091/upload/hwpo/");
	
	SCReport.setParams (arrParams, "zoom", 150);
	//--------------------------------------------------
	SCReport.viewReport (this, arrParams);
}

// 마스터 그리드 더블클릭시 상세 조회
function grd_master_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	fn_searchDetail(e.row);
}

// 화면 사이즈 변경시 스플리터 최대값 최소값 변경
function FSP00200V_onsize(obj:Form, e:SizeEventInfo)
{
	var nSpt  = sp_line.position.y;
	var nForm = this.position.bottom;
	
	if(nForm -35 <  nSpt && nSpt > 153)
	{
		sp_line.position.y = nForm -35;
	}
	sp_line.max = this.position.bottom - 35;
	sp_line.min = 128;
}

// 구매시스템 자재상세 팝업
function grd_detail_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	SCSysIf.eprocPopup (SCSysIf.EPROC_ITEM_POPUP, ds_detail.getColumn(e.row, "ITEM_CODE"));
}

function grd_detail_oncellclick(obj:Grid, e:GridClickEventInfo) {
	if ( e.cell != -1 ) {
		var eproFileGrp = this.objects[obj.binddataset].getColumn(e.row, "EPRO_FILE_GRP");
		if ( obj.getCellProperty("body", e.cell, "displaytype") == "image" && !gfn_isNull(eproFileGrp) ) {
				gfn_openPopup("cmn::CmnFileDownPop.xfdl", true, -1, -1, {P_EPRO_FILE_GRP:eproFileGrp});
		}
	}
}
]]></Script>
  </Form>
</FDL>

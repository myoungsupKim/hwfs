<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="btn_DetailView" onkeydown="fn_form_OnKeyDown" onload="form_onload" titletext="매점매출관리" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="sta_detail09" class="sta_WFDA_Labelbg" position="absolute 624 505 775 532"/>
        <Static id="sta_detail02" class="sta_WFDA_Labelbg" position="absolute 853 453 1237 480" anchor="left right"/>
        <Static id="sta_detail01" class="sta_WFDA_Labelbg" position="absolute 624 453 775 480"/>
        <Static id="sta_detail00" class="sta_WFDA_Labelbg" position="absolute 366 453 546 480"/>
        <Static id="sta_detail14" class="sta_WFDA_Labelbg" position="absolute 79 453 288 480"/>
        <Grid autoenter="select" binddataset="ds_list" cellsizingtype="both" readonly="false" enable="true" cellsizebandtype="allband" id="grid_List" useinputpanel="false" onexpanddown="grid_List_OnExpandEdit" onheadclick="grid_List_OnHeadClick" taborder="19" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 547 1237 710" selecttype="row" autofittype="col" anchor="all">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="27"/>
                <Column size="146"/>
                <Column size="142"/>
                <Column size="227"/>
                <Column size="44"/>
                <Column size="59"/>
                <Column size="45"/>
                <Column size="113"/>
                <Column size="217"/>
                <Column size="40"/>
                <Column size="40"/>
                <Column size="40"/>
                <Column size="40"/>
                <Column size="40"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="매출유형"/>
                <Cell col="2" displaytype="text" text="창고"/>
                <Cell col="3" displaytype="text" text="고객사"/>
                <Cell col="4" displaytype="text" text="과세"/>
                <Cell col="5" displaytype="text" text="단가"/>
                <Cell col="6" displaytype="text" text="식수"/>
                <Cell col="7" displaytype="text" text="금액"/>
                <Cell col="8" displaytype="text" text="적요"/>
                <Cell col="9" displaytype="text" text="입금"/>
                <Cell col="10" displaytype="text" text="대체"/>
                <Cell col="11" displaytype="text" text="발행"/>
                <Cell col="12" displaytype="text" text="자동"/>
                <Cell col="13" displaytype="text" text="마감"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:TYPE_NAME"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:SUBINV_CODENM"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:CUSTCDNM"/>
                <Cell col="4" displaytype="text" style="align:center;" text="bind:TAX_KINDNM"/>
                <Cell col="5" displaytype="number" style="align:right;" text="bind:PRICE"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:QTY"/>
                <Cell col="7" displaytype="number" style="align:right;" text="bind:AMT"/>
                <Cell col="8" displaytype="text" style="align:left;" text="bind:TRX_DESC"/>
                <Cell col="9" displaytype="text" edittype="expand" style="align:left;background:EXPR(fn_GetBackColorClose(&quot;1&quot;, CROSS_YN));" text="bind:RCP_YN" expandshow="expr:iif(RCP_YN=='Y', 'show','hide')"/>
                <Cell col="10" displaytype="text" style="align:left;background:EXPR(fn_GetBackColorClose(&quot;1&quot;, SUBST_YN));background2:EXPR(fn_GetBackColorClose(&quot;2&quot;, SUBST_YN));" text="bind:SUBST_YN" expandshow="expr:iif(SUBST_YN=='Y', 'True', 'False')"/>
                <Cell col="11" displaytype="text" style="align:left;background:EXPR(fn_GetBackColorClose(&quot;1&quot;, BIL_YN));background2:EXPR(fn_GetBackColorClose(&quot;2&quot;, BIL_YN));" text="bind:BIL_YN" expandshow="expr:iif(BIL_YN=='Y', 'True', 'False')"/>
                <Cell col="12" displaytype="text" edittype="expand" style="align:left;background:EXPR(fn_GetBackColorClose(&quot;1&quot;, AUTO_YN));background2:EXPR(fn_GetBackColorClose(&quot;2&quot;, AUTO_YN));" text="bind:AUTO_YN" expandshow="expr:iif(AUTO_YN=='Y', 'show', 'hide')"/>
                <Cell col="13" displaytype="text" style="align:center;background:EXPR(fn_GetBackColorClose(&quot;1&quot;, CLS_YN));background2:EXPR(fn_GetBackColorClose(&quot;2&quot;, CLS_YN));" text="bind:CLS_YN"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="st_TRX_TYPE" text="매출유형" userdata="strMAQuery_UPJANG_TYPE_CD" position="absolute 0 453 80 480" class="sta_WFDA_Label01"/>
        <Static id="st_TRX_DESC" text="적요" position="absolute 0 505 80 532" class="sta_WFDA_Label01"/>
        <Static id="st_PRICE" text="단가" position="absolute 0 479 80 506" class="sta_WFDA_Label01"/>
        <Static id="st_SUBINV_CODE" text="창고" userdata="strMAQuery_SUBINV_CODE" position="absolute 287 453 367 480" class="sta_WFDA_Label01"/>
        <Static id="st_CUSTCD" text="고객사" userdata="strMAQuery_UPJANG_CUST" position="absolute 545 453 625 480" class="sta_WFDA_Label01"/>
        <Static id="st_TRX_ID" text="매출코드" position="absolute 774 453 854 480" class="sta_WFDA_Label01"/>
        <Edit id="edt_TRX_TYPE" imemode="none" onkeydown="edt_TRX_TYPE_OnKeyDown" readonly="true" taborder="3" position="absolute 82 456 265 477" class="edt_WF_Essential"/>
        <Button id="edtBtn_TRX_TYPE" onclick="edtBtn_TRX_TYPE_OnClick" taborder="15" tabstop="false" position="absolute 264 456 285 477" class="btn_WF_popSearchEssential" text="" image=""/>
        <Edit id="edt_SUBINV_CODE" onkeydown="edt_TRX_TYPE_OnKeyDown" readonly="true" taborder="4" position="absolute 369 456 523 477" class="edt_WF_Essential"/>
        <Button id="edtBtn_SUBINV_CODE" onclick="edtBtn_TRX_TYPE_OnClick" taborder="17" tabstop="false" position="absolute 522 456 543 477" class="btn_WF_popSearchEssential" text="" image=""/>
        <Edit id="edt_CUSTCD" onkeydown="edt_TRX_TYPE_OnKeyDown" readonly="true" taborder="5" position="absolute 627 456 752 477" class="edt_WF_Essential"/>
        <Button id="edtBtn_CUSTCD" onclick="edtBtn_TRX_TYPE_OnClick" taborder="18" tabstop="false" position="absolute 751 456 772 477" class="btn_WF_popSearchEssential" text="" image=""/>
        <Edit enable="false" id="edt_TRX_ID" readonly="true" taborder="22" position="absolute 856 456 965 477"/>
        <Grid autoenter="select" binddataset="ds_MAS_CORNER_MST" cellsizingtype="both" readonly="false" enable="true" cellsizebandtype="allband" id="grid_MAS_CORNER_MST" useinputpanel="false" onheadclick="grid_MAS_CORNER_MST_OnHeadClick" taborder="39" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 102 1237 422" selecttype="row" autofittype="col" anchor="all">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="27"/>
                <Column size="186"/>
                <Column size="370"/>
                <Column size="134"/>
                <Column size="136"/>
                <Column size="110"/>
                <Column size="118"/>
                <Column size="95"/>
                <Column size="43"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="자재코드"/>
                <Cell col="2" displaytype="text" text="자재명"/>
                <Cell col="3" displaytype="text" text="과세구분"/>
                <Cell col="4" displaytype="text" text="판매단가"/>
                <Cell col="5" displaytype="text" text="수량"/>
                <Cell col="6" displaytype="text" text="금액"/>
                <Cell col="7" displaytype="text" text="매출코드"/>
                <Cell col="8" displaytype="text" text="선택"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:ITEM_CODE"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:ITEM_CODENM"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:TAX_KINDNM"/>
                <Cell col="4" displaytype="number" style="align:right;" text="bind:SALE_PRICE" mask="#,##0"/>
                <Cell col="5" displaytype="number" edittype="expr:setEditExpr(iif(numFormat(TRX_ID)!= &quot;0&quot; || IMPORT_YN == &quot;Y&quot;, 'none', 'number'))" editfilter="expr:setfilterExpr(iif(numFormat(TRX_ID)!= &quot;0&quot; || IMPORT_YN == &quot;Y&quot;, 'none', 'number'))" style="align:right;background:azure;background2:azure;" text="bind:QTY"/>
                <Cell col="6" displaytype="number" edittype="expr:setEditExpr(iif(numFormat(TRX_ID)!= &quot;0&quot; || IMPORT_YN == &quot;Y&quot;, 'none', 'number'))" editfilter="expr:setfilterExpr(iif(numFormat(TRX_ID)!= &quot;0&quot; || IMPORT_YN == &quot;Y&quot;, 'none', 'number'))" style="align:right;background:azure;background2:azure;" text="bind:AMT"/>
                <Cell col="7" displaytype="text" style="align:left;" text="bind:TRX_ID"/>
                <Cell col="8" displaytype="expr:fn_GetChkYN(currow)" edittype="expr:setEditExpr(fn_GetChkYN(currow))" editfilter="expr:setfilterExpr(fn_GetChkYN(currow))" style="align:center;background:#fff9d6ff;background2:#FFF9D6;" text="bind:CHK"/>
              </Band>
              <Band id="summary">
                <Cell style="align:left;"/>
                <Cell col="1" colspan="4" style="align:center;" text="합계"/>
                <Cell col="5" displaytype="number" style="align:right;" expr="expr:getSum('QTY')"/>
                <Cell col="6" displaytype="number" style="align:right;" expr="expr:getSum('AMT')"/>
                <Cell col="7" style="align:left;"/>
                <Cell col="8" style="align:left;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_Excel" onclick="btn_Excel_OnClick" taborder="38" tabstop="false" text="판매실적 업로드" position="absolute 845 77 944 97" class="btn_WF_Custom" image="" anchor="right"/>
        <Button id="btn_DetailNew" onclick="btn_DetailNew_OnClick" taborder="59" text="수기등록" position="absolute 1056 77 1115 97" class="btn_WF_Custom" image="" anchor="right"/>
        <Button id="btn_DetailDelete" onclick="btn_DetailDelete_OnClick" taborder="60" text="수기삭제" position="absolute 1178 77 1237 97" class="btn_WF_Custom" image="" anchor="right"/>
        <Button id="btn_DetailSave" onclick="btn_DetailSave_OnClick" taborder="61" text="수기저장" position="absolute 1117 77 1176 97" class="btn_WF_Custom" image="" anchor="right"/>
        <Button id="btn_ExcelDelete" onclick="btn_ExcelDelete_OnClick" taborder="62" tabstop="false" text="업로드삭제" position="absolute 946 77 1045 97" class="btn_WF_Custom" image="" anchor="right"/>
        <Button id="btn_Template" onclick="btn_Template_OnClick" taborder="63" tabstop="false" text="업로드양식다운" position="absolute 744 77 843 97" class="btn_WF_Custom" image="" anchor="right"/>
        <Grid autoenter="select" binddataset="ds_Template" cellsizingtype="both" readonly="false" enable="true" cellsizebandtype="allband" id="grd_Template" useinputpanel="false" onheadclick="grid_MAS_CORNER_MST_OnHeadClick" taborder="64" tabstop="true" usecontextmenu="true" useselcolor="true" visible="false" wheelscrollrow="1" position="absolute 828 260 1236 404" selecttype="row">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="162"/>
                <Column size="162"/>
                <Column size="118"/>
                <Column size="98"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" text="바코드"/>
                <Cell col="1" displaytype="text" text="상품명"/>
                <Cell col="2" displaytype="text" text="판매수량"/>
                <Cell col="3" displaytype="text" text="판매금액"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:left;" text="bind:바코드"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:상품명"/>
                <Cell col="2" displaytype="number" edittype="expr:setEditExpr(iif(numFormat(TRX_ID)!= &quot;0&quot; || IMPORT_YN == &quot;Y&quot;, 'none', 'number'))" editfilter="expr:setfilterExpr(iif(numFormat(TRX_ID)!= &quot;0&quot; || IMPORT_YN == &quot;Y&quot;, 'none', 'number'))" style="align:right;" text="bind:판매수량" mask="#,##0"/>
                <Cell col="3" displaytype="number" style="align:right;" text="bind:판매금액"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="st_UPJANGQuery" text="업장" class="sta_WFSA_label" position="absolute 16 40 86 61" userdata="strMAQuery_Upjang"/>
        <Edit id="edt_UPJANGQuery" taborder="65" readonly="true" onkeydown="edt_UPJANGQuery_OnKeyDown" ontextchanged="edt_UPJANGQuery_OnChanged" position="absolute 59 40 228 61" class="edt_WF_Essential"/>
        <Button id="edtBtn_UPJANGQuery" taborder="66" tabstop="false" onclick="edtBtn_UPJANGQuery_OnClick" class="btn_WF_popSearchEssential" position="absolute 227 40 248 61"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="67" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 93 40"/>
        <Static id="Static09" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 93 71"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61"/>
        <Static id="Static11" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 248 40 278 61"/>
        <Static id="Static12" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 49 40 59 61"/>
        <Static id="Static16" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 450 84"/>
        <Static id="Static22" text="판매내역" class="sta_WF_Title01" position="absolute 0 84 450 102"/>
        <Static id="Static17" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 97 450 102"/>
        <Static id="Static1" text="매출일자" position="absolute 278 40 360 61" class="sta_WFSA_label"/>
        <MaskEdit id="me_TRX_DATE" mask="####-##-##" ontextchanged="me_TRX_DATE_OnChanged" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" taborder="2" type="string" position="absolute 346 40 424 61" class="msk_WF_EssentialCal"/>
        <Button id="edtBtn_Date" onclick="g_CalButton_OnClick" taborder="14" tabstop="false" position="absolute 423 40 444 61" class="btn_WF_popSearchEssential" text="" image="" userdata="me_TRX_DATE"/>
        <Static id="Static04" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 336 40 346 61"/>
        <CheckBox id="chk_Auto" taborder="24" text="자동저장기능" value="false" visible="false" position="absolute 1000 42 1107 60" anchor="right"/>
        <Static id="Static0" text="[단위:식,원,VAT포함]" position="absolute 1111 46 1238 59" anchor="right"/>
        <MPFileDialog id="fd_Excel" taborder="58" position="absolute 1255 40 1279 64"/>
        <Static id="Static13" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1093 71 1237 77" anchor="top right"/>
        <Static id="Static19" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 1093 97 1237 102" anchor="top right"/>
        <Static id="Static02" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 422 450 435"/>
        <Static id="Static10" text="매출내역" class="sta_WF_Title01" position="absolute 0 435 450 453"/>
        <Static id="Static14" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 448 450 453"/>
        <Static id="sta_detail03" class="sta_WFDA_Labelbg" position="absolute 79 479 288 506"/>
        <Static id="sta_detail04" class="sta_WFDA_Labelbg" position="absolute 366 479 546 506"/>
        <Static id="sta_detail05" class="sta_WFDA_Labelbg" position="absolute 624 479 775 506"/>
        <Static id="sta_detail06" class="sta_WFDA_Labelbg" position="absolute 853 479 1237 506" anchor="left right"/>
        <Static id="sta_detail07" class="sta_WFDA_Labelbg" position="absolute 79 505 546 532"/>
        <Static id="sta_detail10" class="sta_WFDA_Labelbg" position="absolute 853 505 1237 532" anchor="left right"/>
        <Static id="st_QTY" text="식수" position="absolute 287 479 367 506" class="sta_WFDA_Label01"/>
        <Static id="st_AMT" text="금액" position="absolute 545 479 625 506" class="sta_WFDA_Label01"/>
        <Static id="st_TAX_KIND" text="과세여부" userdata="strMAQuery_GwaGubun" position="absolute 774 479 854 506" class="sta_WFDA_Label01"/>
        <Edit enable="false" id="edt_TAX_KIND" onkeydown="edt_TRX_TYPE_OnKeyDown" readonly="true" taborder="9" position="absolute 856 482 944 503"/>
        <Button id="edtBtn_TAX_KIND" onclick="edtBtn_TRX_TYPE_OnClick" taborder="21" tabstop="false" position="absolute 943 482 964 503" class="btn_WF_popSearch" text="" image=""/>
        <MaskEdit enable="false" id="me_PRICE" mask="###,##0" taborder="6" value="MaskEdit00" position="absolute 82 482 285 503" class="msk_WF_Essential"/>
        <MaskEdit enable="false" id="me_QTY" mask="###,##0" taborder="7" value="MaskEdit00" position="absolute 370 482 543 503" class="msk_WF_Essential"/>
        <MaskEdit enable="false" id="me_AMT" mask="###,##0" taborder="8" value="MaskEdit00" position="absolute 628 482 772 503" class="msk_WF_Essential"/>
        <Edit lengthunit="asciii" id="edt_TRX_DESC" imemode="native" maxlength="100" onkeydown="edt_TRX_DESC_OnKeyDown" taborder="10" position="absolute 82 508 543 529" class="edt_WF_Essential"/>
        <Static id="st_ADITEM1" text="식구분" userdata="strMAQuery_MGUBUN" position="absolute 545 505 625 532" class="sta_WFDA_Label01"/>
        <Static id="st_TCK_WTD_SEQ" text="식권차수" position="absolute 774 505 854 532" class="sta_WFDA_Label01"/>
        <Edit enable="false" id="edt_TCK_WTD_SEQ" onkeydown="edt_TRX_TYPE_OnKeyDown" readonly="true" taborder="12" position="absolute 856 508 944 529" class="edt_WF_Essential"/>
        <Button enable="false" id="edtBtn_TCK_WTD_SEQ" onclick="edtBtn_TCK_WTD_SEQ_OnClick" taborder="20" tabstop="false" position="absolute 943 508 964 529" class="btn_WF_popSearchEssential" text="" image=""/>
        <Edit id="edt_ADITEM1" imemode="none" onkeydown="edt_ADITEM1_OnKeyDown" readonly="true" taborder="11" position="absolute 627 508 752 529" class="edt_WF_Essential"/>
        <Button id="edtBtn_ADITEM1" onclick="edtBtn_TRX_TYPE_OnClick" taborder="23" tabstop="false" position="absolute 751 508 772 529" class="btn_WF_popSearchEssential" text="" image=""/>
        <Static id="Static15" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 532 450 547"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond"/>
      <Dataset id="ds_list" onrowposchanged="ds_list_OnRowPosChanged">
        <ColumnInfo>
          <Column id="ADITEM1" size="255" type="STRING"/>
          <Column id="ADITEM1NM" size="255" type="STRING"/>
          <Column id="ALT_AMT" size="0" type="BIGDECIMAL"/>
          <Column id="AMT" size="0" type="BIGDECIMAL"/>
          <Column id="AUTO_GUBUN" size="255" type="STRING"/>
          <Column id="AUTO_KIND" size="255" type="STRING"/>
          <Column id="CR_ACCTCD" size="255" type="STRING"/>
          <Column id="CUSTCD" size="0" type="BIGDECIMAL"/>
          <Column id="CUSTCDNM" size="255" type="STRING"/>
          <Column id="DR_ACCTCD" size="255" type="STRING"/>
          <Column id="GADATE" size="255" type="STRING"/>
          <Column id="GALINE" size="0" type="BIGDECIMAL"/>
          <Column id="GAMU" size="255" type="STRING"/>
          <Column id="GANO" size="0" type="BIGDECIMAL"/>
          <Column id="PRICE" size="0" type="BIGDECIMAL"/>
          <Column id="QTY" size="0" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="255" type="STRING"/>
          <Column id="SUBINV_CODENM" size="255" type="STRING"/>
          <Column id="TAX_KIND" size="255" type="STRING"/>
          <Column id="TAX_KINDNM" size="255" type="STRING"/>
          <Column id="TCK_WTD_SEQ" size="0" type="BIGDECIMAL"/>
          <Column id="TRX_DATE" size="255" type="STRING"/>
          <Column id="TRX_DESC" size="255" type="STRING"/>
          <Column id="TRX_ID" size="0" type="BIGDECIMAL"/>
          <Column id="TRX_TYPE" size="255" type="STRING"/>
          <Column id="TYPE_NAME" size="255" type="STRING"/>
          <Column id="UPJANG" size="0" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="255" type="STRING"/>
          <Column id="RCP_YN" size="256" type="STRING"/>
          <Column id="BIL_YN" size="256" type="STRING"/>
          <Column id="CLS_YN" size="256" type="STRING"/>
          <Column id="SUBST_YN" size="256" type="STRING"/>
          <Column id="PARENT_ID" size="256" type="BIGDECIMAL"/>
          <Column id="AUTO_YN" size="256" type="STRING"/>
          <Column id="CROSS_YN" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listInput" cancolumnchange="ds_listInput_CanColumnChange" oncolumnchanged="ds_listInput_OnColumnChanged">
        <ColumnInfo>
          <Column id="ADITEM1" size="255" type="STRING"/>
          <Column id="ADITEM1NM" size="255" type="STRING"/>
          <Column id="ALT_AMT" size="0" type="BIGDECIMAL"/>
          <Column id="AMT" size="0" type="BIGDECIMAL"/>
          <Column id="AUTO_GUBUN" size="255" type="STRING"/>
          <Column id="AUTO_KIND" size="255" type="STRING"/>
          <Column id="CR_ACCTCD" size="255" type="STRING"/>
          <Column id="CUSTCD" size="0" type="BIGDECIMAL"/>
          <Column id="CUSTCDNM" size="255" type="STRING"/>
          <Column id="DR_ACCTCD" size="255" type="STRING"/>
          <Column id="GADATE" size="255" type="STRING"/>
          <Column id="GALINE" size="0" type="BIGDECIMAL"/>
          <Column id="GAMU" size="255" type="STRING"/>
          <Column id="GANO" size="0" type="BIGDECIMAL"/>
          <Column id="PRICE" size="0" type="BIGDECIMAL"/>
          <Column id="QTY" size="0" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="255" type="STRING"/>
          <Column id="SUBINV_CODENM" size="255" type="STRING"/>
          <Column id="TAX_KIND" size="255" type="STRING"/>
          <Column id="TAX_KINDNM" size="255" type="STRING"/>
          <Column id="TCK_WTD_SEQ" size="0" type="BIGDECIMAL"/>
          <Column id="TRX_DATE" size="255" type="STRING"/>
          <Column id="TRX_DESC" size="255" type="STRING"/>
          <Column id="TRX_ID" size="0" type="BIGDECIMAL"/>
          <Column id="TRX_TYPE" size="255" type="STRING"/>
          <Column id="TYPE_NAME" size="255" type="STRING"/>
          <Column id="UPJANG" size="0" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="255" type="STRING"/>
          <Column id="RCP_YN" size="256" type="STRING"/>
          <Column id="BIL_YN" size="256" type="STRING"/>
          <Column id="CLS_YN" size="256" type="STRING"/>
          <Column id="SUBST_YN" size="256" type="STRING"/>
          <Column id="PARENT_ID" size="256" type="BIGDECIMAL"/>
          <Column id="AUTO_YN" size="256" type="STRING"/>
          <Column id="CROSS_YN" size="256" type="STRING"/>
          <Column id="TYPE_CD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Type">
        <ColumnInfo>
          <Column id="ADITEM1_CD" size="20" type="STRING"/>
          <Column id="ADITEM1_CDNM" size="100" type="STRING"/>
          <Column id="ADITEM1_CHK_YN" size="20" type="STRING"/>
          <Column id="ADITEM1_CHK_YNNM" size="100" type="STRING"/>
          <Column id="ADITEM2_CD" size="20" type="STRING"/>
          <Column id="ADITEM2_CDNM" size="100" type="STRING"/>
          <Column id="ADITEM2_CHK_YN" size="20" type="STRING"/>
          <Column id="ADITEM2_CHK_YNNM" size="100" type="STRING"/>
          <Column id="ALL_YN" size="20" type="STRING"/>
          <Column id="AUTO_AMT_YN" size="20" type="STRING"/>
          <Column id="BIZ_CHK_YN" size="20" type="STRING"/>
          <Column id="BIZ_CHK_YNNM" size="100" type="STRING"/>
          <Column id="BOND_CHK_YN" size="20" type="STRING"/>
          <Column id="CMP_ACCTCD" size="20" type="STRING"/>
          <Column id="CMP_ACCTCDNM" size="60" type="STRING"/>
          <Column id="CMP_AUTO_YN" size="20" type="STRING"/>
          <Column id="CMP_CLASS" size="20" type="STRING"/>
          <Column id="CMP_CLASSNM" size="100" type="STRING"/>
          <Column id="CMP_GRP" size="20" type="STRING"/>
          <Column id="CMP_GRPNM" size="100" type="STRING"/>
          <Column id="CMP_SPLS_ACCTCD" size="20" type="STRING"/>
          <Column id="CMP_SPLS_ACCTCDNM" size="60" type="STRING"/>
          <Column id="CMP_SPLS_YN" size="20" type="STRING"/>
          <Column id="CMP_TYPE" size="20" type="STRING"/>
          <Column id="CMP_TYPENM" size="200" type="STRING"/>
          <Column id="CR_ACCTCD" size="20" type="STRING"/>
          <Column id="CR_ACCTCDNM" size="60" type="STRING"/>
          <Column id="CUST_CHK_YN" size="20" type="STRING"/>
          <Column id="CUST_CHK_YNNM" size="100" type="STRING"/>
          <Column id="DR_ACCTCD" size="20" type="STRING"/>
          <Column id="DR_ACCTCDNM" size="60" type="STRING"/>
          <Column id="FEE_ACCTCD" size="20" type="STRING"/>
          <Column id="FEE_ACCTCDNM" size="60" type="STRING"/>
          <Column id="FEE_REG_YN" size="20" type="STRING"/>
          <Column id="SUBINV_CHK_YN" size="20" type="STRING"/>
          <Column id="SUBINV_CHK_YNNM" size="100" type="STRING"/>
          <Column id="TYPE_CD" size="20" type="STRING"/>
          <Column id="TYPE_GRP" size="20" type="STRING"/>
          <Column id="TYPE_GRPNM" size="100" type="STRING"/>
          <Column id="TYPE_NAME" size="200" type="STRING"/>
          <Column id="TYPE_TYPE" size="20" type="STRING"/>
          <Column id="TYPE_TYPENM" size="100" type="STRING"/>
          <Column id="USE_YN" size="1" type="STRING"/>
          <Column id="TYPE_CLASS" size="256" type="STRING"/>
          <Column id="TYPE_DESC" size="256" type="STRING"/>
          <Column id="TCK_YN" size="1" type="STRING"/>
          <Column id="ITEM_TYPE" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_MAS_TRX_LINE">
        <ColumnInfo>
          <Column id="RCP_ID" size="256" type="BIGDECIMAL"/>
          <Column id="AMT" size="256" type="BIGDECIMAL"/>
          <Column id="TRX_ID" size="256" type="BIGDECIMAL"/>
          <Column id="SOURCE_FR" size="256" type="STRING"/>
          <Column id="SOURCE_TO" size="256" type="STRING"/>
          <Column id="LINE_DATE" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listInput_Exc">
        <ColumnInfo>
          <Column id="ADITEM1" size="255" type="STRING"/>
          <Column id="ADITEM1NM" size="255" type="STRING"/>
          <Column id="ALT_AMT" size="0" type="BIGDECIMAL"/>
          <Column id="AMT" size="0" type="BIGDECIMAL"/>
          <Column id="AUTO_GUBUN" size="255" type="STRING"/>
          <Column id="AUTO_KIND" size="255" type="STRING"/>
          <Column id="CR_ACCTCD" size="255" type="STRING"/>
          <Column id="CUSTCD" size="0" type="BIGDECIMAL"/>
          <Column id="CUSTCDNM" size="255" type="STRING"/>
          <Column id="DR_ACCTCD" size="255" type="STRING"/>
          <Column id="GADATE" size="255" type="STRING"/>
          <Column id="GALINE" size="0" type="BIGDECIMAL"/>
          <Column id="GAMU" size="255" type="STRING"/>
          <Column id="GANO" size="0" type="BIGDECIMAL"/>
          <Column id="PRICE" size="0" type="BIGDECIMAL"/>
          <Column id="QTY" size="0" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="255" type="STRING"/>
          <Column id="SUBINV_CODENM" size="255" type="STRING"/>
          <Column id="TAX_KIND" size="255" type="STRING"/>
          <Column id="TAX_KINDNM" size="255" type="STRING"/>
          <Column id="TCK_WTD_SEQ" size="0" type="BIGDECIMAL"/>
          <Column id="TRX_DATE" size="255" type="STRING"/>
          <Column id="TRX_DESC" size="255" type="STRING"/>
          <Column id="TRX_ID" size="0" type="BIGDECIMAL"/>
          <Column id="TRX_TYPE" size="255" type="STRING"/>
          <Column id="TYPE_NAME" size="255" type="STRING"/>
          <Column id="UPJANG" size="0" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="255" type="STRING"/>
          <Column id="RCP_YN" size="256" type="STRING"/>
          <Column id="BIL_YN" size="256" type="STRING"/>
          <Column id="CLS_YN" size="256" type="STRING"/>
          <Column id="SUBST_YN" size="256" type="STRING"/>
          <Column id="PARENT_ID" size="256" type="BIGDECIMAL"/>
          <Column id="AUTO_YN" size="256" type="STRING"/>
          <Column id="CROSS_YN" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listInput_AutoLine">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="BIGDECIMAL"/>
          <Column id="ID" size="256" type="BIGDECIMAL"/>
          <Column id="AMT" size="256" type="BIGDECIMAL"/>
          <Column id="DATE" size="256" type="STRING"/>
          <Column id="CUSTCD" size="256" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="256" type="STRING"/>
          <Column id="CMP_CLASS" size="256" type="STRING"/>
          <Column id="CMP_GRP" size="256" type="STRING"/>
          <Column id="CMP_TYPE" size="256" type="STRING"/>
          <Column id="CMP_ACCTCD" size="256" type="STRING"/>
          <Column id="ALL_YN" size="256" type="STRING"/>
          <Column id="RTN" size="256" type="STRING"/>
          <Column id="RTNMSG" size="256" type="STRING"/>
          <Column id="GUBUN" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listInput_AutoLineReturn">
        <ColumnInfo>
          <Column id="RTN" size="256" type="STRING"/>
          <Column id="RTNMSG" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_MAS_TICKET_MST">
        <ColumnInfo>
          <Column id="TICKET_SEQ" size="256" type="BIGDECIMAL"/>
          <Column id="QTY" size="256" type="BIGDECIMAL"/>
          <Column id="TRX_ID" size="256" type="BIGDECIMAL"/>
          <Column id="TICKET_GROUP_SEQ" size="256" type="STRING"/>
          <Column id="TRX_DATE" size="256" type="STRING"/>
          <Column id="PRICE" size="256" type="STRING"/>
          <Column id="TRX_DESC" size="256" type="STRING"/>
          <Column id="UPJANG" size="256" type="BIGDECIMAL"/>
          <Column id="ITEM_CODE" size="256" type="STRING"/>
          <Column id="ITEM_TYPE" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_MAS_CORNER_MST" cancolumnchange="ds_MAS_CORNER_MST_CanColumnChange" oncolumnchanged="ds_MAS_CORNER_MST_OnColumnChanged">
        <ColumnInfo>
          <Column id="AMT" size="0" type="BIGDECIMAL"/>
          <Column id="DTL_ID" size="0" type="BIGDECIMAL"/>
          <Column id="IMPORT_YN" size="255" type="STRING"/>
          <Column id="ITEM_CODE" size="255" type="STRING"/>
          <Column id="ITEM_CODENM" size="255" type="STRING"/>
          <Column id="MST_ID" size="0" type="BIGDECIMAL"/>
          <Column id="QTY" size="0" type="BIGDECIMAL"/>
          <Column id="RCP_ID" size="0" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="0" type="BIGDECIMAL"/>
          <Column id="TAX_KIND" size="255" type="STRING"/>
          <Column id="TAX_KINDNM" size="255" type="STRING"/>
          <Column id="TRX_ID" size="0" type="BIGDECIMAL"/>
          <Column id="UPJANG" size="0" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="255" type="STRING"/>
          <Column id="CHK" size="256" type="STRING"/>
          <Column id="TRX_DATE" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_MAS_CORNER_MST_Dummy"/>
      <Dataset id="ds_listInputRCP">
        <ColumnInfo>
          <Column id="ACNTCD" size="255" type="STRING"/>
          <Column id="ADITEM1" size="255" type="STRING"/>
          <Column id="ADITEM1NM" size="255" type="STRING"/>
          <Column id="ALT_AMT" size="0" type="BIGDECIMAL"/>
          <Column id="AMT" size="0" type="BIGDECIMAL"/>
          <Column id="AUTO_GUBUN" size="255" type="STRING"/>
          <Column id="AUTO_KIND" size="255" type="STRING"/>
          <Column id="CLS_YN" size="255" type="STRING"/>
          <Column id="CMS_YN" size="255" type="STRING"/>
          <Column id="CR_ACCTCD" size="255" type="STRING"/>
          <Column id="CUSTCD" size="0" type="BIGDECIMAL"/>
          <Column id="CUSTCDNM" size="255" type="STRING"/>
          <Column id="DR_ACCTCD" size="255" type="STRING"/>
          <Column id="FEE" size="0" type="BIGDECIMAL"/>
          <Column id="FEE_ACCTCD" size="255" type="STRING"/>
          <Column id="GADATE" size="255" type="STRING"/>
          <Column id="GALINE" size="0" type="BIGDECIMAL"/>
          <Column id="GAMU" size="255" type="STRING"/>
          <Column id="GANO" size="0" type="BIGDECIMAL"/>
          <Column id="PARENT_ID" size="0" type="BIGDECIMAL"/>
          <Column id="PARTIAL_SEQ" size="0" type="BIGDECIMAL"/>
          <Column id="PRICE" size="0" type="BIGDECIMAL"/>
          <Column id="QTY" size="0" type="BIGDECIMAL"/>
          <Column id="RCP_DATE" size="255" type="STRING"/>
          <Column id="RCP_DESC" size="255" type="STRING"/>
          <Column id="RCP_ID" size="0" type="BIGDECIMAL"/>
          <Column id="RCP_TYPE" size="255" type="STRING"/>
          <Column id="SUBINV_CODE" size="255" type="STRING"/>
          <Column id="SUBINV_CODENM" size="255" type="STRING"/>
          <Column id="SUBST_YN" size="255" type="STRING"/>
          <Column id="SUS_SEQ" size="0" type="BIGDECIMAL"/>
          <Column id="TICKET_SEQ" size="0" type="BIGDECIMAL"/>
          <Column id="TRX_YN" size="255" type="STRING"/>
          <Column id="TYPE_NAME" size="255" type="STRING"/>
          <Column id="UPJANG" size="0" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="255" type="STRING"/>
          <Column id="AUTO_YN" size="256" type="STRING"/>
          <Column id="RMT_YN" size="256" type="STRING"/>
          <Column id="CROSS_YN" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_MAS_TRX_LINERCP">
        <ColumnInfo>
          <Column id="RCP_ID" size="256" type="BIGDECIMAL"/>
          <Column id="AMT" size="256" type="BIGDECIMAL"/>
          <Column id="TRX_ID" size="256" type="BIGDECIMAL"/>
          <Column id="SOURCE_FR" size="256" type="STRING"/>
          <Column id="SOURCE_TO" size="256" type="STRING"/>
          <Column id="LINE_DATE" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Template" onrowposchanged="ds_list_OnRowPosChanged">
        <ColumnInfo>
          <Column id="바코드" size="255" type="STRING"/>
          <Column id="판매수량" size="255" type="BIGDECIMAL"/>
          <Column id="판매금액" size="255" type="BIGDECIMAL"/>
          <Column id="상품명" size="255" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="바코드">01010000000(예시)</Col>
            <Col id="상품명">디스플러스</Col>
            <Col id="판매금액">1500</Col>
            <Col id="판매수량">1</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_condGetTitle"/>
    </Objects>
    <Bind>
      <BindItem id="edt_TRX_TYPE_value" compid="edt_TRX_TYPE" propid="value" datasetid="ds_listInput" columnid="TYPE_NAME"/>
      <BindItem id="edt_SUBINV_CODE_value" compid="edt_SUBINV_CODE" propid="value" datasetid="ds_listInput" columnid="SUBINV_CODENM"/>
      <BindItem id="edt_CUSTCD_value" compid="edt_CUSTCD" propid="value" datasetid="ds_listInput" columnid="CUSTCDNM"/>
      <BindItem id="edt_TCK_WTD_SEQ_value" compid="edt_TCK_WTD_SEQ" propid="value" datasetid="ds_listInput" columnid="TCK_WTD_SEQ"/>
      <BindItem id="edt_TAX_KIND_value" compid="edt_TAX_KIND" propid="value" datasetid="ds_listInput" columnid="TAX_KINDNM"/>
      <BindItem id="edt_TRX_ID_value" compid="edt_TRX_ID" propid="value" datasetid="ds_listInput" columnid="TRX_ID"/>
      <BindItem id="edt_TRX_DESC_value" compid="edt_TRX_DESC" propid="value" datasetid="ds_listInput" columnid="TRX_DESC"/>
      <BindItem id="me_PRICE_value" compid="me_PRICE" propid="value" datasetid="ds_listInput" columnid="PRICE"/>
      <BindItem id="me_QTY_value" compid="me_QTY" propid="value" datasetid="ds_listInput" columnid="QTY"/>
      <BindItem id="me_AMT_value" compid="me_AMT" propid="value" datasetid="ds_listInput" columnid="AMT"/>
      <BindItem id="edt_ADITEM1_value" compid="edt_ADITEM1" propid="value" datasetid="ds_listInput" columnid="ADITEM1NM"/>
      <BindItem id="item19" compid="sta_detail14" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item0" compid="sta_detail00" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item1" compid="sta_detail01" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item2" compid="sta_detail02" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item3" compid="sta_detail03" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item4" compid="sta_detail04" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item5" compid="sta_detail05" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item6" compid="sta_detail06" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item7" compid="sta_detail07" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item9" compid="sta_detail09" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item10" compid="sta_detail10" propid="text" datasetid="ds_view" columnid="D_1"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : FS시스템/시스템공통/템플릿 1
 * 프로그램명   : Sam_Form_Basic1.XML
 * 기      능   : 표준 UI Form
 * 작  성  자   : 구종화
 * 작성  일자   : 2007-11-16
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::ma_common.js"


//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var f_Saved_ID,
	f_AfterCallServerCheck;
	
var f_NewDataCheck;		
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

    var F_ArrCol          = new Array(-1);
    var F_ArrColType      = new Array(-1);
    
	//init_btn_setup();	// Button 초기화
	fsp_init(this);


	/*
	#############################################################################################################
	공통코드 SETTING
	#############################################################################################################
	*/	
	edt_UPJANGQuery.userdata = g_Upjang;
	edt_UPJANGQuery.value     = g_UpjangNm;
			

    f_CurrDate = fn_CurrDateWeek();
	me_TRX_DATE.value   = f_CurrDate;		
	//me_TRX_DATE.Value   = "20070911";		

    //fn_Insert();
    
    //사업장 권한 셋팅#############################################################################
	fn_SetAuth("","","edt_UPJANGQuery", "edtBtn_UPJANGQuery");
    //사업장 권한 셋팅#############################################################################    
	/*
	#############################################################################################################
	공통코드 SETTING
	#############################################################################################################
	*/
}





//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
function fn_search()
{
	if (!before_SelectCheck())
		return;


	//매출리스트############################################################
    fsp_clear(this);
    
	fsp_addSearch(this, "ma/mas:MAS10160E_S003");	
	
	fsp_addSearch(this, "ma/mas:MAS10160E_S001");	

	ds_cond.clear();
	ds_cond.addColumn("UPJANG","INT",256);
	ds_cond.addColumn("TRX_DATE","STRING",256);
			
	ds_cond.addRow();
		
	ds_cond.setColumn(ds_cond.rowposition, "UPJANG",    edt_UPJANGQuery.userdata);
	ds_cond.setColumn(ds_cond.rowposition, "TRX_DATE",  me_TRX_DATE.value);
					
	fn_DataSetAllClear();

    http.Sync = true;
	fsp_callService(this, "", "", "ds_cond=ds_cond","ds_list=ds_list ds_MAS_CORNER_MST=ds_MAS_CORNER_MST","","fn_SearchDetail()");
	http.Sync = false;	
	//매출리스트############################################################
		
	//일마감체크#####################################################################
	if (!fn_IsCloseDate(ds_cond, edt_UPJANGQuery.userdata, me_TRX_DATE.value, "001")){
	 	 
		for (i=0;i<ds_list.rowcount;i++){
			
			ds_list.setColumn(i, "CLS_YN", "Y");
		}
	 }    
	//일마감체크#####################################################################
	
	grid_MAS_CORNER_MST.setFormatColProperty(fn_Get_HeaderTitleColIdx(grid_MAS_CORNER_MST, "선택"),"size",43);		
}

function fn_insert()
{
	if (!before_SelectCheck()) return;
	
	ds_listInput.clearData();

	//edtBtn Component 초기화############################
	Set_edtBtn_UserData("Clear");	
	//edtBtn Component 초기화############################

	ds_listInput.addRow();
	ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG", edt_UPJANGQuery.userdata);	  
	ds_listInput.setColumn(ds_listInput.rowposition, "UPJANGNM", edt_UPJANGQuery.value);
	ds_listInput.setColumn(ds_listInput.rowposition, "TRX_DATE", me_TRX_DATE.value);	   
	
	var e = new EventInfo;
	e.row = 0;
	e.columnid = "TRX_TYPE";
	e.oldvalue = "";
	e.newvalue = ds_listInput.getColumn(ds_listInput.rowposition, "TRX_TYPE");
	e.colidx = 0; 
	ds_listInput_OnColumnChanged(ds_listInput,e);
	//Setds_listInput_OnColumnChanged();
		 
	//Disabled항목 Enabled처리####################################
	edt_TRX_TYPE.enable       = true;
	edtBtn_TRX_TYPE.enable    = true;
	
	edt_SUBINV_CODE.enable    = true;
	edtBtn_SUBINV_CODE.enable = true;
	
	edt_CUSTCD.enable         = true;
	edtBtn_CUSTCD.enable      = true;	
			
	edtBtn_TCK_WTD_SEQ.enable      = false;			
    //Disabled항목 Enabled처리####################################
		 
	edt_TRX_TYPE.setFocus();
}

function fn_delete()
{
    if (!before_DeleteCheck("Master") ){

		return;
    }
}

function fn_save()
{

	//수정일때 Confirm체크##################################
	if (
		 (ds_listInput.rowcount > 0) &&
		 (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"))!= "0")
	   )
	{	        
		g_Message("EE", "기존 매점매출(자동) 데이터를 수정하려면\n삭제 후 신규 등록해야만 합니다.\n" +
						"확인하여 주십시요.");                
		return false;   
	}
	//수정일때 Confirm체크##################################
	        
    if (!before_SaveCheck("Master") ){


        if (f_NewDataCheck){
			
			ds_listInput.setColumn(ds_listInput.rowposition, "TRX_ID", "");
        }        
        
		return;
    }
}


function fn_print()
{
}
function fn_Close()
{
	this.close();
}
function fn_help()
{
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================

function fn_SearchDetail(int_TabIndex)
{
	/*
	if (Length(Tab_UPJANG.tab1.st_CC_CD.Value) == 0)
		return;


	//업장정보GET############################################################
    tit_clearActionInfo(this);
	tit_addSearchActionInfo(this, "ma/mas:MAS10020E_S002");

	ds_cond.Clear();
	ds_cond.AddColumn("CC_CD","VARCHAR",256);
	ds_cond.AddRow();

	ds_cond.SetColumn(ds_cond.Row, "CC_CD",  Tab_UPJANG.tab1.st_CC_CD.Value);


	tit_callService(this, "", "", "ds_cond=ds_cond","ds_deptHis=ds_list","","");
	//업장정보GET############################################################



	*/
}

function before_SelectCheck()
{

	if (numFormat(edt_UPJANGQuery.userdata)== "0")
	{
	
		gfn_alert("업장을 지정하여 주십시요.");
		edt_UPJANGQuery.setFocus();
		return false;
	}

	if (gfn_length(me_TRX_DATE.value)== 0)
	{
	
		gfn_alert("매출일자를 지정하여 주십시요.");
		me_TRX_DATE.setFocus();
		return false;
	}
		
	return true;
}


function before_SaveCheck(str_Gubun)
{

		//권한에 따른 저장/삭제 가능체크#########################################################################
		if (!fn_GetSaveAuthBy_AuthLevel(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))) return false;
		//권한에 따른 저장/삭제 가능체크#########################################################################
		        
        /*
        업무구분별로 addAction 지정세팅##########################################        
        */
        
        f_Saved_ID = 0;
        f_NewDataCheck = false;
        
        //자동비교여부가 'N'일 경우 입금비교 팝업창을 띄운다.
		ds_MAS_TRX_LINE.clearData();		
		
        //자동비교일경우 입금내역에 대해 자동으로 라인저장여부
		ds_listInput_AutoLine.clearData();
		ds_listInput_AutoLineReturn.clearData();
		
		//초과금액을 처리해야 하는경우
		ds_listInput_Exc.clearData();
		
		
		//식권관리유형일 경우 식권비교 팝업창을 띄운다.
		ds_MAS_TICKET_MST.clearData();
		
        /*
        업무구분별로 addAction 지정세팅##########################################        
        */
		
		
 		if (ds_listInput.rowcount == 0){

			return;
		}

	    if (str_Gubun == "Master"){

			if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0")
			{
			
				g_Message("EE", "업장을 지정하여 주십시요.");
				edt_UPJANGQuery.setFocus();
				return false;
			}
		
			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_DATE"))== 0)
			{
			
				g_Message("EE", "매출일자가 누락되었습니다.");
				me_TRX_DATE.setFocus();
				return false;
			}
	        
	        //입력일때 Confirm체크##################################
	        if ( 
	             (ds_listInput.rowcount > 0) &&
                 (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"))== "0") &&
	             (chk_Auto.value == "0") 
	           )
	        {
				if (!g_Confirm("02")) return false;	             
	        }     
	        //입력일때 Confirm체크##################################
	             
	             
	        //수정일때 Confirm체크##################################
            if (
                 (ds_listInput.rowcount > 0) &&
                 (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"))!= "0")
               )
            {	        
				g_Message("EE", "기존 매점매출(자동) 데이터를 수정하려면\n삭제 후 신규 등록해야만 합니다.\n" +
				                "확인하여 주십시요.");                
				return false;   
			}
	        //수정일때 Confirm체크##################################
	        	        
	        	        
	        
			//각 구분별 대체 마감체크##############################
            if (
                 (ds_listInput.rowcount > 0) &&
                 (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"))!= "0")
               )
            {			
				if (!fn_GetALT_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"), ds_listInput.getColumn(ds_listInput.rowposition, "DR_ACCTCD"))) return false;
			}
			//각 구분별 대체 마감체크##############################	        
					        
			//마감체크###############################################
			if (!fn_CheckMAClosing(ds_cond, edt_UPJANGQuery.userdata, me_TRX_DATE.value, "001"))
				return false;                
			//마감체크###############################################
			
			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_TYPE"))== 0){
				
				g_Message("EE", "매출유형이 누락되었습니다.\n" +
				                "확인하여 주십시요.");
                edt_TRX_TYPE.setFocus();
				return false;                
			}
			
			if (ds_Type.getColumn(0, "SUBINV_CHK_YN") == "R"){
	
				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "SUBINV_CODE"))== 0){
		
					g_Message("EE", "창고가 누락되었습니다.\n" +
									"확인하여 주십시요.");
					edt_SUBINV_CODE.setFocus();
					return false;     
				}
			}
			
			
			if (ds_Type.getColumn(0, "CUST_CHK_YN") == "R"){
	
				if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD"))== "0"){
		
					g_Message("EE", "고객사가 누락되었습니다.\n" +
									"확인하여 주십시요.");
					edt_CUSTCD.setFocus();
					return false;     
				}
			}
		
			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TAX_KIND"))== 0){
				
				g_Message("EE", "과세여부가 누락되었습니다.\n" +
				                "확인하여 주십시요.");
                edt_TAX_KIND.setFocus();
				return false;                
			}		
		
		
		
			if (ds_Type.getColumn(0, "AUTO_AMT_YN") == "Y"){
	
				if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "PRICE"))== "0"){
		
					g_Message("EE", "단가가 누락되었습니다.\n" +
									"확인하여 주십시요.");
					me_PRICE.setFocus();
					return false;     
				}
				
				if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "QTY"))== "0"){
		
					g_Message("EE", "식수가 누락되었습니다.\n" +
									"확인하여 주십시요.");
					me_QTY.setFocus();
					return false;     
				}	
							
				if (
				    (ds_listInput.getColumn(ds_listInput.rowposition, "PRICE") <= 10) &&
				    (ds_listInput.getColumn(ds_listInput.rowposition, "QTY")   >  1000)
				   )
				{
		
					g_Message("EE", "단가와 식수 설정이 비정상적입니다.n" +
									"확인하여 주십시요.");
					me_PRICE.setFocus();
					return false;     
				}							
			}	
				
			if (toNumber(numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "AMT"))) <= 0){
	
				g_Message("EE", "금액이 누락되었습니다.\n" +
								"확인하여 주십시요.");
				me_AMT.setFocus();
				return false;     
			}				
			
	
			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_DESC"))== 0){
				
				//alert(ds_listInput.GetColumn(ds_listInput.row, "TRX_DESC"));
				g_Message("EE", "적요가 누락되었습니다.\n" +
				                "확인하여 주십시요.");
                edt_TRX_DESC.setFocus();
				return false;                
			}			
		
		
			if (ds_Type.getColumn(0, "ADITEM1_CHK_YN") == "R"){
	
				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ADITEM1"))== 0){
		
					g_Message("EE", "식구분이 누락되었습니다.\n" +
									"확인하여 주십시요.");
					edt_ADITEM1.setFocus();
					return false;     
				}
			}		
		
		

		    // 입금액 비교 작업 시작 ###################################################
		    var real_TrxAmt = ds_listInput.getColumn(ds_listInput.rowposition, "AMT");
		    var real_JANAMT = 0;
			var real_ExcAmt = 0;
				
			if (ds_Type.getColumn(0, "CMP_CLASS") != "N"){			
				
	            real_JANAMT = fn_GetBalance(ds_cond, 
											ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"), 
											ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"), 
											ds_listInput.getColumn(ds_listInput.rowposition, "TRX_DATE"), 											
											ds_Type.getColumn(0, "CMP_CLASS"), 
											ds_Type.getColumn(0, "CMP_GRP"), 
											ds_Type.getColumn(0, "CMP_TYPE"), 
											ds_Type.getColumn(0, "CMP_ACCTCD"), 
											ds_Type.getColumn(0, "ALL_YN"), 											
											ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD"), 
											ds_listInput.getColumn(ds_listInput.rowposition, "SUBINV_CODE"));
											
				
				//alert(real_TrxAmt);
				//alert(real_JANAMT);
				
				real_ExcAmt = real_TrxAmt - real_JANAMT;
				if (
				    (real_ExcAmt > 0) && //초과금액
				    (ds_Type.getColumn(0, "CMP_SPLS_YN") == "N") //초과금액처리여부
				   )
				{
		
					g_Message("EE", "매출액이 입금액을 초과했습니다.\n" +
									"확인하여 주십시요.");
					me_AMT.setFocus();
					return false;     
				}
				
				// 초과금액 비교 후 매출액 다시 설정.
				if (real_ExcAmt > 0)
				{
					real_TrxAmt = real_TrxAmt - real_ExcAmt; 
				}
				

				if (real_TrxAmt < 0)
			    {
					g_Message("EE", "매출액이 -일수는 없습니다.\n" +
									"확인하여 주십시요.");
					me_AMT.setFocus();
					return false;   		    			    
			    }
			    
			    //alert(real_JANAMT);
				if (real_JANAMT > 0)
				{
				
					//자동비교여부가 'N'일 경우 입금비교 팝업창을 띄운다.
					if (ds_Type.getColumn(0, "CMP_AUTO_YN") == "N")
					{
						
						if(!fn_OpenLineWindow(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"), real_TrxAmt)) return false;
					}
					//자동비교일경우 입금내역에 대해 자동으로 라인저장
					else {
										
						if(!fn_InsertAutoLine(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"), real_TrxAmt)) return false;
					}				
				}
				
				//초과금액을 처리해야 하는경우
				if (
				    (real_ExcAmt > 0) &&
				    (ds_Type.getColumn(0, "CMP_SPLS_YN") == "Y")
				   )
				{

					if(!fn_SaveExcTrxData(real_ExcAmt)) return false;					
				}				
				
			}
			// 입금액 비교 작업 시작 ###################################################						
			
			
			
			//식권관리유형일 경우 식권비교 팝업창을 띄운다.#########################
			if (ds_Type.getColumn(0, "TCK_YN") == "Y"){
	
				if(!fn_OpenTicketLineWindow("INSERT", ds_listInput.getColumn(ds_listInput.rowposition, "QTY"))) return false;
			}	
			//식권관리유형일 경우 식권비교 팝업창을 띄운다.#########################
						
						
			//TRX_ID 지정#################################################################
            if (
					(real_TrxAmt > 0)||
					(
						(real_ExcAmt > 0) &&
						(ds_Type.getColumn(0, "CMP_SPLS_YN") == "Y")
					)
               )               
			{
				if(!fn_SaveTrxData(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"))) return false;
			}


		}			

        
		//저장#############################################################
	    if (str_Gubun == "Master"){


		    //입금액 비교 작업 시작 ###############################저장전 중복확인
		    var real_TrxAmt = ds_listInput.getColumn(ds_listInput.rowposition, "AMT");
			var real_JANAMT = 0;
			var real_ExcAmt = 0;		    
			
			if (ds_Type.getColumn(0, "CMP_CLASS") != "N"){
				

	            real_JANAMT = fn_GetBalance(ds_cond, 
											ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"), 
											ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"), 
											ds_listInput.getColumn(ds_listInput.rowposition, "TRX_DATE"), 											
											ds_Type.getColumn(0, "CMP_CLASS"), 
											ds_Type.getColumn(0, "CMP_GRP"), 
											ds_Type.getColumn(0, "CMP_TYPE"), 
											ds_Type.getColumn(0, "CMP_ACCTCD"), 
											ds_Type.getColumn(0, "ALL_YN"), 											
											ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD"), 
											ds_listInput.getColumn(ds_listInput.rowposition, "SUBINV_CODE"));
											
				real_ExcAmt = real_TrxAmt - real_JANAMT;
				if (
				    (real_ExcAmt > 0) && //초과금액
				    (ds_Type.getColumn(0, "CMP_SPLS_YN") == "N") //초과금액처리여부
				   )
				{
		
					g_Message("EE", "매출액이 입금액을 초과했습니다.\n" +
									"확인하여 주십시요.");
					me_AMT.setFocus();
					return false;     
				}
				
				// 초과금액 비교 후 매출액 다시 설정.
				if (real_ExcAmt > 0)
				{
					real_TrxAmt = real_TrxAmt - real_ExcAmt; 
				}
				
				if (real_TrxAmt < 0)
			    {
					g_Message("EE", "매출액이 -일수는 없습니다.\n" +
									"확인하여 주십시요.");
					me_AMT.setFocus();
					return false;   		    			    
			    }
			}
			//입금액 비교 작업 시작 ###############################저장전 중복확인
			
			
			//각 구분별 대체 마감체크##############################저장전 중복확인
            if (
                 (ds_listInput.rowcount > 0) &&
                 (numFormat(f_Saved_ID)!= "0")
               )
            {			
				if (!fn_GetALT_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"), ds_listInput.getColumn(ds_listInput.rowposition, "DR_ACCTCD"))) return false;
			}
			//각 구분별 대체 마감체크##############################저장전 중복확인
			
			
			//대체잔액체크##########################################저장전 중복확인
			if (ds_MAS_TRX_LINE.rowcount > 0){
				if (!fn_GetBalanceLine(ds_cond, ds_MAS_TRX_LINE, "입금잔액체크"))
					return false;   
	        }    
			//대체잔액체크##########################################저장전 중복확인			
			
			
			//식권잔액체크##########################################저장전 중복확인
			if (ds_MAS_TICKET_MST.rowcount > 0){
			    
			    var real_MAS_TICKET_MST_GROUP_S;
			    			
				real_MAS_TICKET_MST_GROUP_S = fn_GetMAS_TICKET_MST_GROUP_S(ds_cond);
								
				for (i=0;i<ds_MAS_TICKET_MST.rowcount;i++){
					
					ds_MAS_TICKET_MST.setColumn(i, "TICKET_GROUP_SEQ", real_MAS_TICKET_MST_GROUP_S);			
					ds_MAS_TICKET_MST.setColumn(i, "TRX_ID", ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"));
					ds_MAS_TICKET_MST.setColumn(i, "TRX_DATE", ds_listInput.getColumn(ds_listInput.rowposition, "TRX_DATE"));					
					ds_MAS_TICKET_MST.setColumn(i, "TRX_DESC", ds_listInput.getColumn(ds_listInput.rowposition, "TRX_DESC"));					
				}
				
				if (!fn_GetBalanceLine(ds_cond, ds_MAS_TICKET_MST, "식권회수잔액체크"))
					return false;   				
				
				ds_listInput.setColumn(ds_listInput.rowposition, "TCK_WTD_SEQ", real_MAS_TICKET_MST_GROUP_S);	
	        }    
			//식권잔액체크##########################################저장전 중복확인			
			
			



			
			ds_listInput.setColumn(ds_listInput.rowposition, "AUTO_GUBUN", "Y");
			ds_listInput.setColumn(ds_listInput.rowposition, "AUTO_KIND",  "001");	
			
			
			//입금저장-매점현금매출/매점신용카드매출######################################################################
			if (
			     (ds_listInput.getColumn(ds_listInput.rowposition, "TRX_TYPE") == "T006") ||
			     (ds_listInput.getColumn(ds_listInput.rowposition, "TRX_TYPE") == "T022")
			   )  
			{
						
				ds_listInputRCP.clearData();
				
				ds_listInputRCP.addRow();
				
				ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "RCP_ID",       fn_GetNewRCP_ID());
				ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "UPJANG",       ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"));
				ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "SUBINV_CODE",  ds_listInput.getColumn(ds_listInput.rowposition, "SUBINV_CODE"));
				ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "RCP_DATE",     ds_listInput.getColumn(ds_listInput.rowposition, "TRX_DATE"));							
				ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "CUSTCD",       ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD"));
				ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "PRICE",        ds_listInput.getColumn(ds_listInput.rowposition, "PRICE"));
				ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "QTY",          ds_listInput.getColumn(ds_listInput.rowposition, "QTY"));
				ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "AMT",          ds_listInput.getColumn(ds_listInput.rowposition, "AMT"));

				ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "ACNTCD",       fn_GetUpjangAcntcd(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"), "1110114"));
				
				ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "RCP_DESC",     ds_listInput.getColumn(ds_listInput.rowposition, "TRX_DESC"));
				
				if (ds_listInput.getColumn(ds_listInput.rowposition, "TRX_TYPE") == "T006"){
				
					ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "RCP_TYPE",     "R003");				
					ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "DR_ACCTCD",    "1110114");//현금
					ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "CR_ACCTCD",    "1110411");//외상매출금
				}
				
				if (ds_listInput.getColumn(ds_listInput.rowposition, "TRX_TYPE") == "T022"){
				
					ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "RCP_TYPE",     "R016");				
					ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "DR_ACCTCD",    "1110815");//미수금(신용카드)
					ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "CR_ACCTCD",    "1110411");//외상매출금
				}

				
				ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "AUTO_GUBUN",   ds_listInput.getColumn(ds_listInput.rowposition, "AUTO_GUBUN"));
				ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "AUTO_KIND",    ds_listInput.getColumn(ds_listInput.rowposition, "AUTO_KIND"));
				
			
				
				
				
				//MAS_TRX_LINE 저장########################################################
				ds_MAS_TRX_LINERCP.clearData();
				ds_MAS_TRX_LINERCP.addRow();
				
				ds_MAS_TRX_LINERCP.setColumn(ds_MAS_TRX_LINERCP.rowposition, "TRX_ID",       ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"));
				ds_MAS_TRX_LINERCP.setColumn(ds_MAS_TRX_LINERCP.rowposition, "RCP_ID",       ds_listInputRCP.getColumn(ds_listInputRCP.rowposition, "RCP_ID"));
				ds_MAS_TRX_LINERCP.setColumn(ds_MAS_TRX_LINERCP.rowposition, "AMT",          ds_listInput.getColumn(ds_listInput.rowposition, "AMT"));
				ds_MAS_TRX_LINERCP.setColumn(ds_MAS_TRX_LINERCP.rowposition, "SOURCE_FR",    "RCP");
				ds_MAS_TRX_LINERCP.setColumn(ds_MAS_TRX_LINERCP.rowposition, "SOURCE_TO",    "TRX");
				ds_MAS_TRX_LINERCP.setColumn(ds_MAS_TRX_LINERCP.rowposition, "LINE_DATE",    ds_listInput.getColumn(ds_listInput.rowposition, "TRX_DATE"));
								
				//MAS_TRX_LINE 저장########################################################
				
				
		    }
		    //입금저장-매점현금매출/매점신용카드매출######################################################################

            //매점상품매출 데이터 UPDATE#####################################################################################
            for (i=0;i<ds_MAS_CORNER_MST.rowcount;i++){
                
                ds_MAS_CORNER_MST_Dummy.clearData();
		        Copy(ds_MAS_CORNER_MST_Dummy,ds_MAS_CORNER_MST);
		        				
		        ds_MAS_CORNER_MST_Dummy.filter("CHK=='1' && gfn_numFormat(TRX_ID)=='0'");
		        
		        for (j=0;j<ds_MAS_CORNER_MST_Dummy.rowcount;j++){
		        					
					ds_MAS_CORNER_MST_Dummy.setColumn(j, "TRX_ID", ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"));
					
					if (ds_listInputRCP.rowcount > 0){
					
						ds_MAS_CORNER_MST_Dummy.setColumn(j, "RCP_ID", ds_listInputRCP.getColumn(ds_listInputRCP.rowposition, "RCP_ID"));
					}
				}						
            }   
            //매점상품매출 데이터 UPDATE#####################################################################################



			
			// action 정보 초기화
			fsp_clear(this);	  		
										    		        
	    
            //기존 라인 및 매출 데이터 삭제.            
            if (
                 (ds_listInput.rowcount > 0) &&
                 (numFormat(f_Saved_ID)!= "0")
               )
            {
  
			    fsp_addSingle(this, "ma/mas:MAS10080E_D003");
				fsp_addSingle(this, "ma/mas:MAS10080E_D002");
				fsp_addSingle(this, "ma/mas:MAS10080E_D001");
            }   
            
            
       

            //매출 저장
            if (real_TrxAmt > 0){
            
				ds_listInput.setColumn(ds_listInput.rowposition, "AMT", real_TrxAmt);
				ds_listInputRCP.setColumn(ds_listInputRCP.rowposition, "AMT", real_TrxAmt);
				ds_MAS_TRX_LINERCP.setColumn(ds_MAS_TRX_LINERCP.rowposition, "AMT", real_TrxAmt);         
				
				fsp_addSingle(this, "ma/mas:MAS10080E_I001");
            }                  		
			
            //자동비교여부가 'N'일 경우 입금비교 팝업창
            if (ds_MAS_TRX_LINE.rowcount > 0){
            
				fsp_addMulti(this, "ma/mas:MAS10080E_I002");
            }
            
            //자동비교일경우 입금내역에 대해 자동으로 라인저장
            //alert(ds_listInput_AutoLine.SaveXML());
            if (ds_listInput_AutoLine.rowcount > 0){
          
			    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "ID", ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"));
				fsp_addSingle(this, "ma/mas:MAS10080E_I003");
            }      
                  			
            //초과금액을 처리해야 하는경우
            if (ds_listInput_Exc.rowcount > 0){
            
				ds_listInput_Exc.setColumn(ds_listInput_Exc.rowposition, "PARENT_ID", ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"));
				fsp_addSingle(this, "ma/mas:MAS10080E_I004");
            }     
                              			
            //식권관리유형일 경우 식권비교 팝업창
            if (ds_MAS_TICKET_MST.rowcount > 0){
                				
				fsp_addMulti(this, "ma/mas:MAS10080E_I005");
            }   
            	            			
            	            			
            //매점상품매출 데이터 저장########################################
            if (ds_MAS_CORNER_MST_Dummy.rowcount > 0){
             	            	            			
				fsp_addMulti(this, "ma/mas:MAS10160E_U001");            	            	            			
			}
			
			
			//입금저장-매점현금매출/매점신용카드매출######################################################################
			if (ds_listInputRCP.rowcount > 0){
						
				fsp_addSingle(this, "ma/mas:MAS10160E_I002");
				
				//MAS_TRX_LINE 저장########################################################
				if (ds_MAS_TRX_LINERCP.rowcount > 0){
							
					fsp_addSingle(this, "ma/mas:MAS10160E_I003");
				}					
				//MAS_TRX_LINE 저장########################################################				
            }			
		    //입금저장-매점현금매출/매점신용카드매출######################################################################
			
			
		    
            //매점상품매출 데이터 저장########################################
			
			f_Saved_ID = ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID");
			fsp_callService(this, "", "", "ds_cond=ds_listInput:A ds_listInput_Exc=ds_listInput_Exc:A ds_listInput_AutoLine=ds_listInput_AutoLine:A " +
			                              "ds_MAS_TRX_LINE=ds_MAS_TRX_LINE:A ds_MAS_TICKET_MST=ds_MAS_TICKET_MST:A ds_MAS_CORNER_MST_Dummy=ds_MAS_CORNER_MST_Dummy:A " +
			                              "ds_listInputRCP=ds_listInputRCP:A ds_MAS_TRX_LINERCP=ds_MAS_TRX_LINERCP:A", "ds_listInput_AutoLineReturn=ds_listInput_AutoLineReturn",  "", "fn_AfterSaveSearch()");
	    }
	   
	    
		return true;
}


function fn_AfterSaveSearch(errCode, errMsg)
{
	if (errCode != 0){
		
		g_Message("EE");		
		return;
	}
		

	fn_search();	
	fn_insert();
	
	http.Sync = true;
	if (chk_Auto.value == "0") ds_list.rowposition = ds_list.findRowExpr("TRX_ID==" + f_Saved_ID);
	http.Sync = false;
	/*
	for(i=0;i<ds_list.rowcount;i++){
	
		if (f_Saved_ID == ds_list.GetColumn(i, "TRX_ID")){
					
			ds_list.row = i;
		}
	}
	*/
	
}

/*
 ******************************************************************************************
 * 함  수  명   : Common_Btn_common_OnClick
 * 입      력   : obj  = Form Component
 * 반      환   : 없음
 * 기      능   : 
 * 작  성  자   : 구종화
 * 작성  일자   : 2007-11-16
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================

function Common_Btn_common_OnClick(obj)
{

	switch(obj.name)
	{
		case "btn_search":
		    //alert("d");
			fn_search();
			break;
		case "btn_ins":
			fn_insert();
			break;
		case "btn_del":
			fn_delete();
			break;
		case "btn_save":
			fn_save();
			break;
		case "btn_Print":
			//fn_Print();
			break;
		case "btn_close":
			fn_Close();
			break;
		case "btn_Help":
			//fn_Help();
			break;
		default:
			break;
	}

}


function WorkForm_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
{
	
	gfn_formKeyDown(obj, e); //(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam);
}





function edt_UPJANGQuery_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	fn_edt_OnKeyDown(obj,e.keycode);	
			
	if (e.keycode == 46){
			
		if (obj.name == "edt_UPJANGQuery"){
				
			fn_DataSetAllClear();				
		}		
	}
}


function fn_DataSetAllClear()
{

	ds_list.clearData();	

	ds_listInput.clearData();	
	
	ds_Type.clearData();	
	
	//자동비교여부가 'N'일 경우 입금비교 팝업창을 띄운다.
	ds_MAS_TRX_LINE.clearData();		
	
	//자동비교일경우 입금내역에 대해 자동으로 라인저장여부
	ds_listInput_AutoLine.clearData();
	ds_listInput_AutoLineReturn.clearData();
	
	//초과금액을 처리해야 하는경우
	ds_listInput_Exc.clearData();
	
	//식권관리유형일 경우 식권비교 팝업창을 띄운다.
	ds_MAS_TICKET_MST.clearData();


	ds_MAS_CORNER_MST.clearData();
	ds_MAS_CORNER_MST_Dummy.clearData();
	ds_listInputRCP.clearData();
	ds_MAS_TRX_LINERCP.clearData();
}	



function edtBtn_Date_OnClick(obj:Button, e:ClickEventInfo)
{
	var retDate = gfn_dialog("", "U_SCC::SCC_CALENDAR.xfdl", "fa_Date=" + wrapQuote(me_TRX_DATE.value), -1, -1, "Title=false Status=false AutoSize=true Resize=false");
	
	me_TRX_DATE.value = retDate;
	
	fn_DataSetAllClear();	
}


function edtBtn_UPJANGQuery_OnClick(obj:Button, e:ClickEventInfo)
{
    
	fn_edtBtn_OnClick(obj);
	fn_DataSetAllClear();		
}

function grid_List_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	
	
	if (obj.getCellProperty("head",e.cell,"backgroundimage") == "ico_Excel"){
		gfn_exportExcel(obj, this.titletext);
	}
	else {
	
		
			gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);	
			var e1 = new EventInfo;
			e1.oldrow = -1;
			e1.newrow = 0;
			ds_list_OnRowPosChanged(obj,e1);	

	}
	//obj.ExportExcel(this.Title, , False);	
}

function me_TRX_DATE_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{

	fn_DataSetAllClear();	
}


function edtBtn_TRX_TYPE_OnClick(obj:Button, e:ClickEventInfo)
{   


    if (
        (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0") 
       )     
    return;
    
    var str_Where = "";
    
    //매출유형####################################################################################
    if (obj.name == "edtBtn_TRX_TYPE"){	
		
		str_Where += "  AND (A.TYPE_TYPE = 'T') AND  (V.UPJANG = " + edt_UPJANGQuery.userdata + ") AND (V.TYPE_CD IN (SELECT CODE FROM SCC_COMMON_CODE WHERE GROUP_CODE = 'MA0124')) ";
    }
    
    //창고코드####################################################################################
    if (obj.name == "edtBtn_SUBINV_CODE"){	
		
		str_Where += " AND  (UPJANG = " + edt_UPJANGQuery.userdata + ")";
		
		//식재료매출일경우 식재료 창고만 뜬다.
		if (ds_Type.getColumn(0, "CR_ACCTCD") == "4010221"){
			
			str_Where += "  AND (SUBINV_CODE LIKE 'C%')";
		}	
        //매점상품매출 혹은 일반상품 매출일 경우 매점창고만 뜨게 한다.
		else if (
		         (ds_Type.getColumn(0, "CR_ACCTCD") == "4010233") ||
		         (ds_Type.getColumn(0, "CR_ACCTCD") == "4010231")
		        )
		{
			
			str_Where += "  AND (SUBINV_CODE LIKE 'A20%')";
		}
		else {		
		
		}		      
    }   
     
    //고객사코드####################################################################################
    if (obj.name == "edtBtn_CUSTCD"){	
		
		str_Where += " AND  (A.UPJANG = " + edt_UPJANGQuery.userdata + ")";			
    }         
 
        
	fn_edtBtn_OnClick(obj, str_Where);

    if (gfn_length(eval("edt_" + gfn_subStr(obj.name, 7)).userdata)!= 0)
	ds_listInput.setColumn(ds_listInput.rowposition, gfn_subStr(obj.name, 7), eval("edt_" + gfn_subStr(obj.name, 7)).userdata);	
			    		
}

function edt_TRX_TYPE_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	fn_edt_OnKeyDown(obj,e.keycode);	
	
	if (e.keycode == 46)
	ds_listInput.setColumn(ds_listInput.rowposition, gfn_subStr(obj.name, 4), "");			
}



function ds_list_OnRowPosChanged(obj, e)
{
    if (ds_list.rowcount == 0) return;
    
	ds_listInput.clearData();
	var row = ds_listInput.addRow();
	ds_listInput.copyRow(row, ds_list, e.newrow);
	ds_listInput.applyChange();

	//edtBtn Component 복사############################
	Set_edtBtn_UserData("Clear");
	Set_edtBtn_UserData("Copy");
	
	ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG", edt_UPJANGQuery.userdata);	   
	ds_listInput.setColumn(ds_listInput.rowposition, "UPJANGNM", edt_UPJANGQuery.value);
	ds_listInput.setColumn(ds_listInput.rowposition, "TRX_DATE", me_TRX_DATE.value);	
	//edtBtn Component 복사############################
	
	
	Setds_listInput_OnColumnChanged();
	//edt_TYPE_CD.Enable        = False;

	//edt_TYPE_NAME.SetFocus();
}

//edtBtn Component 세팅/초기화####################################################################
function Set_edtBtn_UserData(str_Gubun)
{

	if (str_Gubun == "Copy"){

		//edtBtn Component 초기화############################  		 
		for (i=0;i<components.length;i++){
							
			if (
				(gfn_subStr(components[i].name, 0, 3)== "st_") &&
				(gfn_subStr(components[i].userdata, 0, 10)== "strMAQuery")
			   )	
			{

			    if (gfn_length(eval("edt_" + gfn_subStr(components[i].name, 3)).Column)!= 0)
				eval("edt_" + gfn_subStr(components[i].name, 3)).userdata = ds_listInput.getColumn(ds_listInput.rowposition, gfn_subStr(components[i].name, 3));
			}
		}		 
		//edtBtn Component 초기화############################
	}
	else if (str_Gubun == "Clear"){

		//edtBtn Component 초기화############################
		for (i=0;i<components.length;i++){
				
				
			if (
				(gfn_subStr(components[i].name, 0, 3)== "st_") &&
				(gfn_subStr(components[i].userdata, 0, 10)== "strMAQuery")
			   )	
			{
				if (gfn_length(components[i].Column)!= 0)
				eval("edt_" + gfn_subStr(components[i].name, 3)).userdata = "";
			}
		}  
		//edtBtn Component 초기화############################
	}
}

function Setds_listInput_OnColumnChanged()
{
	var e = new EventInfo;
	e.row = 0;
	e.columnid = "TRX_TYPE";
	e.oldvalue = "";
	e.newvalue = ds_listInput.getColumn(ds_listInput.rowposition, "TRX_TYPE");
	e.colidx = 0;
	ds_listInput_OnColumnChanged(ds_listInput,e);
	
	var e1 = new EventInfo;
	e1.row = 0;
	e1.columnid = "SUBINV_CODE";
	e1.oldvalue = "";
	e1.newvalue = ds_listInput.getColumn(ds_listInput.rowposition, "SUBINV_CODE");
	e1.colidx = 0;
	ds_listInput_OnColumnChanged(ds_listInput,e1);
	/*
	ds_listInput_OnColumnChanged(ds_listInput,0,"BIZ_CHK_YN","",ds_listInput.GetColumn(ds_listInput.row, "BIZ_CHK_YN"),0);
	ds_listInput_OnColumnChanged(ds_listInput,0,"FEE_REG_YN","",ds_listInput.GetColumn(ds_listInput.row, "FEE_REG_YN"),0);
	ds_listInput_OnColumnChanged(ds_listInput,0,"ADITEM1_CHK_YN","",ds_listInput.GetColumn(ds_listInput.row, "ADITEM1_CHK_YN"),0);
	ds_listInput_OnColumnChanged(ds_listInput,0,"ADITEM2_CHK_YN","",ds_listInput.GetColumn(ds_listInput.row, "ADITEM2_CHK_YN"),0);
	*/
}

function ds_listInput_OnColumnChanged(obj:Dataset, e)
{
	var F_ArrCol          = new Array(-1);
	var F_ArrColType      = new Array(-1);
	
	if (e.columnid == "TRX_TYPE"){
	
		//alert(ds_list.GetRowType(ds_list.row));
		//Combo DATASET Composition#########################
		F_ArrCol = [];
		
		F_ArrCol[0]     = "TYPE_CD";		
		F_ArrColType[0] = "STRING";
		
	    frm_InitSearchDS(ds_cond, ds_Type, F_ArrCol, F_ArrColType, "TYPE_CD", ds_listInput.getColumn(ds_listInput.rowposition, "TRX_TYPE"), "ma/mae:MAE10020E_S001");	
	  
	    
		edt_SUBINV_CODE.enable    = false;
		edtBtn_SUBINV_CODE.enable = false;
		
		edt_CUSTCD.enable      = false;
		edtBtn_CUSTCD.enable   = false;
		
		//me_AMT.Enable    = True;
		
		edt_ADITEM1.enable    = false;
		edtBtn_ADITEM1.enable = false;
	
						
	    if (e.colidx == -1){
	
			ds_listInput.setColumn(ds_listInput.rowposition, "SUBINV_CODE", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "SUBINV_CODENM", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "CUSTCD", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "CUSTCDNM", "");			
			ds_listInput.setColumn(ds_listInput.rowposition, "PRICE", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "QTY", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "AMT", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "TAX_KIND", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "TAX_KINDNM", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "TRX_DESC", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM1", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "ADITEM1NM", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "TCK_WTD_SEQ", "");	
					
            if (gfn_length(e.newvalue)== 0) ds_Type.clearData();	
            
            //매출유형변경시 매점판매선택 초기화##################        				
			for (i=0;i<ds_MAS_CORNER_MST.rowcount;i++){
		
				if (ds_MAS_CORNER_MST.getColumn(i, "CHK") == "1") ds_MAS_CORNER_MST.setColumn(i, "CHK", "0");
			}     
			//매출유형변경시 매점판매선택 초기화##################       				
		}
		
		if (ds_Type.getColumn(0, "SUBINV_CHK_YN") == "R"){
		
			edt_SUBINV_CODE.enable    = true;
			edtBtn_SUBINV_CODE.enable = true;
		}
		
		if (ds_Type.getColumn(0, "SUBINV_CHK_YN") == "O"){
		
			edt_SUBINV_CODE.enable    = true;
			edtBtn_SUBINV_CODE.enable = true;
		}		
		
		if (ds_Type.getColumn(0, "CUST_CHK_YN") == "R"){
		
			edt_CUSTCD.enable      = true;
			edtBtn_CUSTCD.enable   = true;
		}
						
		if (ds_Type.getColumn(0, "CUST_CHK_YN") == "O"){
		
			edt_CUSTCD.enable      = true;
			edtBtn_CUSTCD.enable   = true;
		}
								
								
		if (ds_Type.getColumn(0, "AUTO_AMT_YN") == "Y"){
		
			me_AMT.enable    = false;
		}
										
		if (ds_Type.getColumn(0, "ADITEM1_CHK_YN") == "R"){
		
			edt_ADITEM1.enable    = true;
			edtBtn_ADITEM1.enable = true;
		}
												
		if (ds_Type.getColumn(0, "ADITEM1_CHK_YN") == "O"){
		
			edt_ADITEM1.enable    = true;
			edtBtn_ADITEM1.enable = true;
		}				
			
	
	    if (
	        (e.row >= 0) &&
	        (ds_Type.rowcount > 0)
	       )
	    {
			             
			ds_listInput.setColumn(e.row, "DR_ACCTCD", ds_Type.getColumn(ds_Type.rowposition, "DR_ACCTCD"));
			ds_listInput.setColumn(e.row, "CR_ACCTCD", ds_Type.getColumn(ds_Type.rowposition, "CR_ACCTCD"));			
		}	
				
		             
	}

	if (e.columnid == "SUBINV_CODE"){
	
		F_ArrCol = [];
		
		F_ArrCol[0]     = "SUBINV_CODE";		
		F_ArrColType[0] = "STRING";
		
	    frm_InitSearchDS(ds_cond, ds_cond, F_ArrCol, F_ArrColType, "SUBINV_CODE", ds_listInput.getColumn(ds_listInput.rowposition, "SUBINV_CODE"), "ma/mas:MAS10080E_S002");	

	
		edt_TAX_KIND.enable    = false;
		edtBtn_TAX_KIND.enable = false;
	    
		
		if (ds_listInput.getColumn(ds_listInput.rowposition, "TYPE_CD") != "T018"){
		
		    //불공제창고일경우 면세처리#########################################
			if (ds_cond.getColumn(0, "OUTVAT_FLAG") == "Y"){
			
				edt_TAX_KIND.userdata = "410";
				edt_TAX_KIND.value     = "면세";	
							
                ds_listInput.setColumn(ds_listInput.rowposition, "TAX_KIND", edt_TAX_KIND.userdata);							
			}
			//불공제창고일경우 면세처리#########################################
			
			
			//불공제창고가 아니면서 식재료창고이면 과세처리###################
			else {
			
				if (gfn_subStr(ds_listInput.getColumn(ds_listInput.rowposition, "SUBINV_CODE"), 0, 1)== "C"){
				
					edt_TAX_KIND.userdata = "310";
					edt_TAX_KIND.value     = "과세";		
							
					ds_listInput.setColumn(ds_listInput.rowposition, "TAX_KIND", edt_TAX_KIND.userdata);	
				}	
				else {
				
					edt_TAX_KIND.enable    = true;
					edtBtn_TAX_KIND.enable = true;				
				}
			}
			//불공제창고가 아니면서 식재료창고이면 과세처리###################
			
		}
		// 고객사에 식재료 영업행위를 하는 경우
        // 사용자가 과/면세를 선택할 수 있도록 한다.
		else {
		
			edt_TAX_KIND.enable    = true;
			edtBtn_TAX_KIND.enable = true;
		}
	

	}
		
	if (e.columnid == "PRICE"){
		    		
		//me_AMT.Value = Round(ds_listInput.GetColumn(ds_listInput.row, "PRICE") * ds_listInput.GetColumn(ds_listInput.row, "QTY"));
	}	
	
	if (e.columnid == "QTY"){
	
		//me_AMT.Value = Round(ds_listInput.GetColumn(ds_listInput.row, "PRICE") * ds_listInput.GetColumn(ds_listInput.row, "QTY"));
	}	
	
	edtBtn_TCK_WTD_SEQ.enable = false;
	if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"))!= "0"){
	
		edt_TRX_TYPE.enable       = false;
		edtBtn_TRX_TYPE.enable    = false;
		
		edt_SUBINV_CODE.enable    = false;
		edtBtn_SUBINV_CODE.enable = false;
		
		edt_CUSTCD.enable      = false;
		edtBtn_CUSTCD.enable   = false;
		
					
		if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "TCK_WTD_SEQ"))!= "0")
		edtBtn_TCK_WTD_SEQ.enable = true;	
	}
		
    fn_ImportantImgSetting(this);
    
    //단가, 식수 선택요소 이미지 세팅#######################
    //img_imp_me_PRICE.visible = false;
    //img_imp_me_QTY.visible   = false;
    
    if (ds_Type.getColumn(0, "AUTO_AMT_YN") == "Y"){
    
		//img_imp_me_PRICE.visible = true;
		//img_imp_me_QTY.visible   = true;    
    }
    //단가, 식수 선택요소 이미지 세팅#######################    
}

//각 구분별 대체마감체크############################################################
function fn_GetALT_CLOSE(objOutDs, real_TRX_ID, str_DR_ACCTCD)
{

    //대체마감체크#####################################################################
    var str_CloseErr = "";
    
    objOutDs.clear();
    objOutDs.addColumn("RCP_YN","STRING",256);	       
    objOutDs.addColumn("SUBST_YN","STRING",256);	       
    objOutDs.addColumn("BIL_YN","STRING",256);	      
    objOutDs.addColumn("AUTO_YN","STRING",256);	         
    objOutDs.addColumn("CLS_YN","STRING",256);	 
    
    objOutDs.addColumn("TICKET_YN","STRING",256);
    
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/mas:MAS10080E_S004");
	
	f_AfterCallServerCheck = true;
	
	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","TRX_ID=" + real_TRX_ID + 
															   " DR_ACCTCD=" + wrapQuote(str_DR_ACCTCD)
	                                                           ,"fn_AfterCallServiceCheck()");	
	http.Sync = false;
	
    if (!f_AfterCallServerCheck) return false;

	if (objOutDs.getColumn(objOutDs.rowposition, "RCP_YN") == "Y"){
	   
		if (
			 (ds_listInput.getColumn(ds_listInput.rowposition, "TRX_TYPE") == "T006") ||
			 (ds_listInput.getColumn(ds_listInput.rowposition, "TRX_TYPE") == "T022")
		   )  
		{
			str_CloseErr = "";
		}
		else {
		
			str_CloseErr = "매출액의 일부 혹은 전부가\n입금되었으므로\n수정/삭제할 수 없습니다.";
		}
	}

	if (objOutDs.getColumn(objOutDs.rowposition, "SUBST_YN") == "Y") str_CloseErr = "영업대체된 데이터는\n수정/삭제할 수 없습니다.";				

	if (objOutDs.getColumn(objOutDs.rowposition, "BIL_YN") == "Y")   str_CloseErr = "(세금)계산서가 발행된 데이터는\n수정/삭제할 수 없습니다.";			    

	//if (objOutDs.GetColumn(objOutDs.row, "AUTO_YN") == "Y")  str_CloseErr = "자동등록된 데이터는\n수정/삭제할 수 없습니다.\n해당 화면에서 취소하신후 다시 작업\n하여주십시요.";			    
			                          	
	if (objOutDs.getColumn(objOutDs.rowposition, "CLS_YN") == "Y")   str_CloseErr = "마감된 데이터는\n수정/삭제할 수 없습니다.";				
	
	if (objOutDs.getColumn(objOutDs.rowposition, "TICKET_YN") == "Y") str_CloseErr = "해당매출 이후에 해당식권의 회수폐기가\n발생하였으므로\n수정/삭제할 수 없습니다.";
	
	if (gfn_length(str_CloseErr )!= 0){
	
		g_Message("EE", str_CloseErr + "\n" +
						"확인하여 주십시요.");			 
		return false;        
	}

	return true;
	//대체마감체크#####################################################################
 
}			 
//각 구분별 대체마감체크############################################################
			 
			 

/*
 ******************************************************************************************
 * 함  수  명   : fn_GetBalance
 * 입      력   : real_UPJANG : 업장코드
	              str_DATE : 일자
	             
 * 반      환   :  값 리턴
 * 기      능   : 영업잔액체크
 * 작  성  자   : 황승한
 * 작성  일자   : 2007-11-28
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
*/
function fn_GetBalance(objOutDs, real_UPJANG, real_ID, str_DATE, str_CMP_CLASS, str_CMP_GRP, str_CMP_TYPE, str_CMP_ACCTCD, str_ALL_YN, real_CUSTCD, str_SUBINV_CODE)
{

    
    //잔액체크#####################################################################
    objOutDs.clear();
    objOutDs.addColumn("JANAMT","INT",256);	       
    
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/mas:GetMAS_GETBALANCE");
	
	//alert(str_ACCTCD);
	//alert(str_DATE_STD);
	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","V_GUBUN=" + wrapQuote("입금잔액체크") + 
															   " V_UPJANG=" + wrapQuote(real_UPJANG) + 
	                                                           " V_ID=" + wrapQuote(real_ID) + 
	                                                           " V_DATE=" + wrapQuote(str_DATE) +
	                                                           " V_CMP_CLASS=" + wrapQuote(str_CMP_CLASS) +
	                                                           " V_CMP_GRP=" + wrapQuote(str_CMP_GRP) +
	                                                           " V_CMP_TYPE=" + wrapQuote(str_CMP_TYPE) +
	                                                           " V_CMP_ACCTCD=" + wrapQuote(str_CMP_ACCTCD) +
	                                                           " V_ALL_YN=" + wrapQuote(str_ALL_YN) +
	                                                           " V_CUSTCD=" + wrapQuote(real_CUSTCD) +
	                                                           " V_SUBINV_CODE=" + wrapQuote(str_SUBINV_CODE)
	                                                           ,"");	
	http.Sync = false;
	
                          	
	
	//alert(objOutDs.GetColumn(objOutDs.row, "ACCTCD_DATE") );
	return objOutDs.getColumn(objOutDs.rowposition, "JANAMT");
	//잔액체크#####################################################################
	
}



//자동비교여부가 'N'일 경우 입금비교 팝업창을 띄운다.#########################
function fn_OpenLineWindow(real_TRX_ID, real_TrxAmt)
{

    if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0"){    

		g_Message("EE", "업장을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_UPJANGQuery.setFocus();
        return false;
    }
    
    if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_DATE"))== 0){    

		g_Message("EE", "매출일자가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 						       
        me_TRX_DATE.setFocus();
        return false;
    }    

    var sParam = {real_TrxAmt:real_TrxAmt};
	gfn_dialog("", "U_MAS::MAS10080P.xfdl", sParam);
	
	if (ds_MAS_TRX_LINE.rowcount == 0) return false;
	
	return true;
    
}
//자동비교여부가 'N'일 경우 입금비교 팝업창을 띄운다.#########################

//자동비교일경우 입금내역에 대해 자동으로 라인저장.###########################
function fn_InsertAutoLine(real_TRX_ID, real_TrxAmt)
{

    if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0"){    

		g_Message("EE", "업장을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_UPJANGQuery.setFocus();
        return false;
    }
    
    if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_DATE"))== 0){    

		g_Message("EE", "매출일자가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 						       
        me_TRX_DATE.setFocus();
        return false;
    }    

    //ds_listInput_AutoLine.ClearData();
    //alert("fn_InsertAutoLine");
    ds_listInput_AutoLine.addRow();
    
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "GUBUN", "입금자동대체");
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "UPJANG", ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "ID", ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "AMT", real_TrxAmt);
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "DATE", ds_listInput.getColumn(ds_listInput.rowposition, "TRX_DATE"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "CUSTCD", ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "SUBINV_CODE", ds_listInput.getColumn(ds_listInput.rowposition, "SUBINV_CODE"));
    
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "CMP_CLASS", ds_Type.getColumn(ds_Type.rowposition, "CMP_CLASS"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "CMP_GRP", ds_Type.getColumn(ds_Type.rowposition, "CMP_GRP"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "CMP_TYPE", ds_Type.getColumn(ds_Type.rowposition, "CMP_TYPE"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "CMP_ACCTCD", ds_Type.getColumn(ds_Type.rowposition, "CMP_ACCTCD"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "ALL_YN", ds_Type.getColumn(ds_Type.rowposition, "ALL_YN"));
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "RTN", "");
    ds_listInput_AutoLine.setColumn(ds_listInput_AutoLine.rowposition, "RTNMSG", "");    
    //alert(ds_listInput_AutoLine.SaveXML());
    return true;
}
//자동비교일경우 입금내역에 대해 자동으로 라인저장.###########################








//초과금액을 처리해야 하는경우.##################################################
function fn_SaveExcTrxData(real_ExcAmt)
{

    if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0"){    

		g_Message("EE", "업장을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_UPJANGQuery.setFocus();
        return false;
    }
    
    if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_DATE"))== 0){    

		g_Message("EE", "매출일자가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 						       
        me_TRX_DATE.setFocus();
        return false;
    }    


    Copy(ds_listInput_Exc,ds_listInput);
    
   

    if (real_ExcAmt != ds_listInput.getColumn(ds_listInput.rowposition, "AMT")){
    
		ds_listInput_Exc.setColumn(ds_listInput_Exc.rowposition, "PRICE", 0);
		ds_listInput_Exc.setColumn(ds_listInput_Exc.rowposition, "QTY", 0);
    }       
    
    ds_listInput_Exc.setColumn(ds_listInput_Exc.rowposition, "DR_ACCTCD", ds_Type.getColumn(ds_Type.rowposition, "CMP_SPLS_ACCTCD"));
    
    ds_listInput_Exc.setColumn(ds_listInput_Exc.rowposition, "AMT", real_ExcAmt);
            
    return true;
}
//초과금액을 처리해야 하는경우.##################################################




//TRX_ID 세팅#######################################################################
function fn_SaveTrxData(real_TRX_ID)
{

    if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0"){    

		g_Message("EE", "업장을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_UPJANGQuery.setFocus();
        return false;
    }
    
    if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_DATE"))== 0){    

		g_Message("EE", "매출일자가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 						       
        me_TRX_DATE.setFocus();
        return false;
    }    

    f_Saved_ID = ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID");
    
    if (numFormat(real_TRX_ID)== "0"){
    
		ds_cond.clear();
		ds_cond.addColumn("MAS_TRX_S","INT",256);
					
		// action 정보 초기화
		fsp_clear(this);

		// 서버에서 조회할 정보 추가
		fsp_addSearch(this, "ma/mas:MAS10080E_S003");

		// 서버 호출
		http.Sync = true;
		fsp_callService(this, "", "", "", ds_cond.name + "=ds_list","","");
		http.Sync = false;
		
		real_TRX_ID = ds_cond.getColumn(ds_cond.rowposition, "MAS_TRX_S");
		ds_listInput.setColumn(ds_listInput.rowposition, "TRX_ID", real_TRX_ID);
		
		f_Saved_ID  = 0;
		f_NewDataCheck = true;
    }
    
		
	//수기입금 대체###########################
	for (i=0;i<ds_MAS_TRX_LINE.rowcount;i++){
		
			ds_MAS_TRX_LINE.setColumn(i, "TRX_ID", real_TRX_ID);
			ds_MAS_TRX_LINE.setColumn(i, "SOURCE_FR", "TRX");
			ds_MAS_TRX_LINE.setColumn(i, "SOURCE_TO", "RCP");
			ds_MAS_TRX_LINE.setColumn(i, "LINE_DATE", ds_listInput.getColumn(ds_listInput.rowposition, "TRX_DATE"));						
			
	}
	//수기입금 대체###########################   
	 
	//자동비교 대체###########################
	for (i=0;i<ds_listInput_AutoLine.rowcount;i++){
		
			ds_listInput_AutoLine.setColumn(i, "TRX_ID", real_TRX_ID);
	}
	//자동비교 대체###########################
	
  
    return true;
}
//TRX_ID 세팅#######################################################################



function edt_UPJANGQuery_OnChanged(obj:Edit, e:TextChangedEventInfo)
{
	fn_DataSetAllClear();		
}


function edt_TRX_DESC_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13){
				
		if (
		    (!edt_ADITEM1.enable)
		   )
		{
		    div_cmnBtn.setFocus();
			fn_save();
		}
	}	
}



function edt_ADITEM1_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
    //Http.Sync = True;
	fn_edt_OnKeyDown(obj,e.keycode);	
	//Http.Sync = False;

	if (e.keycode == 13){
				
		//if (!edt_TCK_WTD_SEQ.Enable){
		
			div_cmnBtn.setFocus();
			fn_save();
		//}
	}
	
}


function grid_List_OnExpandEdit(obj:Grid, e:GridMouseEventInfo)
{
	if (numFormat(ds_list.getColumn(ds_list.rowposition, "TRX_ID"))== "0") return;
	
	var str_MenuIDText = "",
		str_MenuIDTextDetail = "",
		str_XMLADDRESS1 = "",
		str_XMLADDRESS2 = "",
		str_ColumnTitle = "",		
		real_TRX_ID = ds_list.getColumn(ds_list.rowposition, "TRX_ID");
		
    str_ColumnTitle = gfn_replace(gfn_replace(fn_Get_ColHeaderTitle(obj, e.cell), "▼"), "▲");	
    if (str_ColumnTitle == "입금"){
		
		str_MenuIDText = "매출-입금내역";
		str_MenuIDTextDetail = "[해당매출을입금대체]/[해당매출이입금대체]한내역";
		str_XMLADDRESS1 = "ma/mas:MAS10081P_S001";
		str_XMLADDRESS2 = "ma/mas:MAS10081P_S005";
	}
	else if (str_ColumnTitle == "대체"){
	
		str_MenuIDText = "매출-영업대체내역";
		str_MenuIDTextDetail = "[해당매출을영업대체]한내역입니다.";
		str_XMLADDRESS1 = "ma/mas:MAS10081P_S002";
		str_XMLADDRESS2 = "ma/mas:MAS10081P_S005";
	}
	else if (str_ColumnTitle == "발행"){
	
		str_MenuIDText = "매출-세금계산서발행내역";
		str_MenuIDTextDetail = "[해당매출을세금계산서발행]한내역입니다.";
		str_XMLADDRESS1 = "ma/mas:MAS10081P_S003";	
		str_XMLADDRESS2 = "NONE";
	}	
	else if (str_ColumnTitle == "자동"){
	
		str_MenuIDText = "매출-자동내역";
		str_MenuIDTextDetail = "[자동으로등록]된내역입니다.";
		str_XMLADDRESS1 = "ma/mas:MAS10081P_S004";	
		str_XMLADDRESS2 = "NONE";
	}
	
	var sParam = {str_MenuIDText:str_MenuIDText, str_MenuIDTextDetail:str_MenuIDTextDetail, str_XMLADDRESS1:str_XMLADDRESS1, str_XMLADDRESS2:str_XMLADDRESS2, TRID:real_TRX_ID};
	gfn_dialog("", "U_MAS::MAS10081P.xfdl", sParam);
	//gfn_dialog("", "U_MAS::MAS10081P.xfdl", "str_MenuIDText=" + str_MenuIDText + " str_MenuIDTextDetail=" + str_MenuIDTextDetail + " str_XMLADDRESS1=" + str_XMLADDRESS1 + " str_XMLADDRESS2=" + str_XMLADDRESS2 + " TRID=" + real_TRX_ID);	
}




//삭제처리###########################################################################
function before_DeleteCheck(str_GUBUN)
{

	//권한에 따른 저장/삭제 가능체크#########################################################################
	if (!fn_GetSaveAuthBy_AuthLevel(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))) return false;
	//권한에 따른 저장/삭제 가능체크#########################################################################
		
	if ( 
		(ds_listInput.rowcount == 0) ||
		(numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"))== "0") ||
		(!g_Confirm("01"))
	   )
	{

		return false;
	}
	
	//각 구분별 대체 마감체크##############################
    if (!fn_GetALT_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"), ds_listInput.getColumn(ds_listInput.rowposition, "DR_ACCTCD"))) return false;	
	//각 구분별 대체 마감체크##############################	        
					
	//마감체크###############################################
	if (!fn_CheckMAClosing(ds_cond, edt_UPJANGQuery.userdata, me_TRX_DATE.value, "001"))
		return false;                
	//마감체크###############################################
				       		
	
	// action 정보 초기화
	fsp_clear(this);			
	
	//기존 라인 및 매출 데이터 삭제.
	fsp_addSingle(this, "ma/mas:MAS10080E_D003");
	fsp_addSingle(this, "ma/mas:MAS10080E_D002");
	fsp_addSingle(this, "ma/mas:MAS10080E_D001");
	
	
	//입금저장-매점현금매출/매점신용카드매출######################################################################
	//alert(ds_listInput.GetColumn(ds_listInput.row, "TRX_TYPE"));
	if (
		 (ds_listInput.getColumn(ds_listInput.rowposition, "TRX_TYPE") == "T006") ||
		 (ds_listInput.getColumn(ds_listInput.rowposition, "TRX_TYPE") == "T022")
	   )  
	{
		
		fsp_addSingle(this, "ma/mas:MAS10160E_D004");		
		fsp_addSingle(this, "ma/mas:MAS10160E_D003");		
	}	
	
	//기존 매점상품판매 데이터 UPDATE
	fsp_addSingle(this, "ma/mas:MAS10160E_U002");
	   
	http.Sync = true;
	fsp_callService(this, "", "", "ds_cond=ds_listInput:A",  "", "", "fn_AfterDeleteSearch()");		
	http.Sync = false;		
	
	return true;
}


function fn_AfterDeleteSearch(errCode, errMsg)
{
	if (errCode != 0){

		g_Message("EE");
		return;
	}

    g_Message("01");
    
	fn_search();
	fn_insert();

}
//삭제처리###########################################################################



//마감항목 배경색처리###############################################################
function fn_GetBackColorClose(ColorGubun, YN)
{

   	if (YN == "Y")
   	{
		return "thistle";
	}
	else
	{
		if (ColorGubun == "1")
		return "white";
		else
		return "#F6FCFC";
	}

}
//마감항목 배경색처리###############################################################




function ds_listInput_CanColumnChange(obj:Dataset, e:DSColChangeEventInfo)
{
	if (
	    (e.columnid == "AMT")||
	    (e.columnid == "QTY")||
	    (e.columnid == "PRICE")
	   )
	{
	
		if (toNumber(e.newvalue) < 0){
		
			g_Message("EE", "-금액을 입력할 수 없습니다.\n" +
							"확인하여 주십시요.");			
                        			
			eval("me_" + e.columnid).value = "";
			eval("me_" + e.columnid).setFocus();			
			
			
			return false;  		

						
		}
	}	
	
	if (
	    (e.columnid == "TAX_KIND")
	   )
	{
	
		for (i=0;i<ds_MAS_CORNER_MST.rowcount;i++){
		
			if (ds_MAS_CORNER_MST.getColumn(i, "TRX_ID") == ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID")){
			
			    if (ds_MAS_CORNER_MST.getColumn(i, "CHK") == "0") continue;
			    
				//DECODE(V.TAX_KIND,'100','과세','210','면세','220','영세')
				if (
				     (e.newvalue == "310") &&
				     (ds_MAS_CORNER_MST.getColumn(i, "TAX_KIND") != "100")
				   )
				{
				
					g_Message("EE", i + 1 + "행과 매출의 과세여부가 일치하지 않습니다.\n" +
					         		"확인하여 주십시요.");	
					
					edt_TAX_KIND.userdata = "";
					edt_TAX_KIND.value    = "";
					         		
					return false;           						
				}
				
				if (
				     (e.newvalue == "410") &&
				     (ds_MAS_CORNER_MST.getColumn(i, "TAX_KIND") != "210")
				   )
				{
				
					g_Message("EE", i + "행과 매출의 과세여부가 일치하지 않습니다.\n" +
					         		"확인하여 주십시요.");	
					
					edt_TAX_KIND.userdata = "";
					edt_TAX_KIND.value    = "";
										
					return false;           						
				}				
				
				if (
				     (e.newvalue == "350") &&
				     (ds_MAS_CORNER_MST.getColumn(i, "TAX_KIND") != "220")
				   )
				{
				
					g_Message("EE", i + 1 + "행과 매출의 과세여부가 일치하지 않습니다.\n" +
					         		"확인하여 주십시요.");	
					
					edt_TAX_KIND.userdata = "";
					edt_TAX_KIND.value    = "";
										
					return false;           						
				}					
			}
		}
			
		if (toNumber(e.newvalue) < 0){
		
			g_Message("EE", "-금액을 입력할 수 없습니다.\n" +
							"확인하여 주십시요.");			
                        			
			eval("me_" + e.columnid).value = "";
			eval("me_" + e.columnid).setFocus();			
			
			
			return false;  		

						
		}
	}	
	
}

//식권관리유형일 경우 식권비교 팝업창을 띄운다.#########################
function edtBtn_TCK_WTD_SEQ_OnClick(obj:Button, e:ClickEventInfo)
{
   
    if (
        (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0") 
       )     
    return;
       
    if (
        (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "TCK_WTD_SEQ"))== "0") 
       )     
    return;
         
    fn_OpenTicketLineWindow("SELECT", ds_listInput.getColumn(ds_listInput.rowposition, "QTY"));
}
//식권관리유형일 경우 식권비교 팝업창을 띄운다.#########################



//식권관리유형일 경우 식권비교 팝업창을 띄운다.#########################
function fn_OpenTicketLineWindow(str_Gubun, real_WW_QTY)
{

    if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0"){    

		g_Message("EE", "업장을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_UPJANGQuery.setFocus();
        return false;
    }
    
    if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_DATE"))== 0){    

		g_Message("EE", "매출일자가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 						       
        me_TRX_DATE.setFocus();
        return false;
    }    

    
    var sParam = {str_Gubun:str_Gubun, real_WW_QTY:real_WW_QTY};
    gfn_dialog("", "U_MAS::MAS10271E.xfdl", sParam);
	
	
	if (ds_MAS_TICKET_MST.rowcount == 0) return false;
	
	return true;
    
}
//식권관리유형일 경우 식권비교 팝업창을 띄운다.#########################


function fn_AfterCallServiceCheck(errCode, errMsg)
{
	if (errCode != 0){

		g_Message("EE");
		
		f_AfterCallServerCheck = false;
		fn_insert();
		return false;
	}
}

function btn_Excel_OnClick(obj:Button, e:ClickEventInfo)
{
	if (!before_SelectCheck()) return false;
	
	//엑셀 임포트
	fd_Excel.Type = "OPEN";
	fd_Excel.Filter = "All(*.*)|*.*|Excel File(*.xls)|*.xls|";
	
	if( fd_Excel.Open() )
	{
		var sFullFileName = fd_Excel.FilePath + '\\' + fd_Excel.FileName;
		grid_MAS_CORNER_MST.enableredraw = false;
		ds_MAS_CORNER_MST_Dummy.clearData();
		//ext_ExcelImportByIndex(파일풀패스, 시트순번, 깡통데이타셑);
		ext_ExcelImportByIndex(sFullFileName, 0, "ds_MAS_CORNER_MST_Dummy");
				
		if (!fn_GetBeforeData("Y", edt_UPJANGQuery.userdata, me_TRX_DATE.value)){
		
			grid_MAS_CORNER_MST.enableredraw = true;
			return false;		
		}
		
		fn_SetImpData();
		grid_MAS_CORNER_MST.enableredraw = true;
	}
}


function fn_SetImpData()
{
    var j = 0,
        int_MST_ID;
    
    ds_MAS_CORNER_MST.clearData();
	for (i = 0; i < ds_MAS_CORNER_MST_Dummy.rowcount; i++)
	{
		
		if (
		     (gfn_length(ds_MAS_CORNER_MST_Dummy.getColumn(i, "Col01"))!= 0) &&
		     (toNumber(ds_MAS_CORNER_MST_Dummy.getColumn(i, "Col04")) != 0)
		   )  
		{
		    
		    if (!fn_GetTitleData(edt_UPJANGQuery.userdata, me_TRX_DATE.value, ds_MAS_CORNER_MST_Dummy.getColumn(i,"Col01"), ds_MAS_CORNER_MST_Dummy.getColumn(i,"Col02"))){
		    							       		
				return false;		    
		    }
		    
		    
		    if (j == 0){
		    
				int_MST_ID = fn_GetNewCornerMST_ID();
		    }
		    
		    ds_MAS_CORNER_MST.addRow();
		    
			ds_MAS_CORNER_MST.setColumn(j, "ITEM_CODE",    ds_condGetTitle.getColumn(0,"ITEM_CODE"));
			ds_MAS_CORNER_MST.setColumn(j, "SALE_PRICE",   toNumber(ds_condGetTitle.getColumn(0,"SALE_PRICE")));
			ds_MAS_CORNER_MST.setColumn(j, "QTY",          toNumber(ds_MAS_CORNER_MST_Dummy.getColumn(i,"Col03")));
			ds_MAS_CORNER_MST.setColumn(j, "AMT",          toNumber(ds_MAS_CORNER_MST_Dummy.getColumn(i,"Col04")));
			
			ds_MAS_CORNER_MST.setColumn(j, "ITEM_CODENM",  ds_condGetTitle.getColumn(0,"ITEM_CODENM"));
			ds_MAS_CORNER_MST.setColumn(j, "TAX_KIND",     ds_condGetTitle.getColumn(0,"TAX_KIND"));
			ds_MAS_CORNER_MST.setColumn(j, "TAX_KINDNM",   ds_condGetTitle.getColumn(0,"TAX_KINDNM"));			
			
			ds_MAS_CORNER_MST.setColumn(j, "MST_ID", int_MST_ID);
			
			ds_MAS_CORNER_MST.setColumn(j, "UPJANG",   edt_UPJANGQuery.userdata);
			ds_MAS_CORNER_MST.setColumn(j, "TRX_DATE", me_TRX_DATE.value);
			
			ds_MAS_CORNER_MST.setColumn(j, "IMPORT_YN", "Y");
			
			ds_MAS_CORNER_MST.setColumn(j, "CHK",        "0");
			
			
			j++;
		}
	}


    fn_Save_MAS_CORNER_MST();
}

function fn_AfterImpData(errCode, errMsg)
{

	if (errCode != 0){
		
		g_Message("EE", "저장에 실패하였습니다.");		
		return;
	}
		

	g_Message("02", "저장이 완료되었습니다.");
	fn_search();
	
}


//기존존재체크#######################################################################
function fn_GetBeforeData(str_IMPORT_YN, real_UPJANG, str_TRX_DATE)
{

		ds_cond.clear();
		ds_cond.addColumn("EXIST_YN","STRING",256);
		ds_cond.addColumn("TRX_ID_EXIST_YN","STRING",256);
		ds_cond.addColumn("IMPORT_YN","STRING",256);
		
					
		// action 정보 초기화
		fsp_clear(this);

		// 서버에서 조회할 정보 추가
		fsp_addSearch(this, "ma/mas:MAS10160E_S005");

		// 서버 호출
		http.Sync = true;
		fsp_callService(this, "", "", "", ds_cond.name + "=ds_list","UPJANG=" + wrapQuote(real_UPJANG) +
		                                                         " TRX_DATE=" + wrapQuote(str_TRX_DATE)
																 ,"");
		http.Sync = false;
  
        var str_Judge = ds_cond.getColumn(0, "EXIST_YN") + ds_cond.getColumn(0, "TRX_ID_EXIST_YN") + ds_cond.getColumn(0, "IMPORT_YN");  
        
        if (ds_cond.getColumn(0, "IMPORT_YN") == "Y"){
        
        
			if (str_IMPORT_YN == "Y"){
			
				g_Message("02", "기존 판매실적업로드자료가 존재합니다.\n기존데이터를 삭제하고\n다시 업로드하시기 바랍니다.");
				return false;			
			}
			else if (str_IMPORT_YN == "N"){
			
				g_Message("EE", "기존 판매실적업로드자료가 존재합니다.\n해당일자에 대해 수기등록할 수 없습니다.\n" + 
								"판매실적업로드 자료를 삭제하시고\n수기등록 하여 주시기 바랍니다.");
				return false;			
			}
			
        }
        
        
        if (ds_cond.getColumn(0, "EXIST_YN") == "Y"){
        
        
			if (str_IMPORT_YN == "Y"){
			
				//g_Message("02", "기존 수기등록 데이터가 존재합니다.\n기존 수기등록 데이터를 삭제하고\n다시 업로드하시기 바랍니다.");
				//return False;			
			}
        }
                
     
        return true;
}
//기존존재체크#######################################################################



//명칭세팅#######################################################################
function fn_GetTitleData(real_UPJANG, str_START_DATE, str_BARCODE, str_ITEM_NAME)
{

		ds_condGetTitle.clear();
		
					
		// action 정보 초기화
		fsp_clear(this);

		// 서버에서 조회할 정보 추가
		fsp_addSearch(this, "ma/mas:MAS10160E_S002");

		// 서버 호출
		http.Sync = true;
		fsp_callService(this, "", "", "", ds_condGetTitle.name + "=ds_list","UPJANG="      + wrapQuote(real_UPJANG) +
																		  " START_DATE=" + wrapQuote(str_START_DATE) +
																		  " BARCODE="    + wrapQuote(str_BARCODE) 
																		 ,"");
		http.Sync = false;
  
        var str_ErrorCode = "";
        
        if (ds_condGetTitle.getColumn(0, "EXIST_YN") == "N"){
        
			str_ErrorCode = "해당 바코드(" + str_BARCODE + " :\n" + str_ITEM_NAME + ") 에\n해당하는 자재코드가 없습니다.\n확인하여 주십시요.";
        }
        
        if (ds_condGetTitle.getColumn(0, "EXIST_YN") == "MANY"){
        
			str_ErrorCode = "해당 바코드(" + str_BARCODE + " :\n" + str_ITEM_NAME + ") 에\n해당하는 자재코드가\n한개 이상 중복됩니다.\n확인하여 주십시요.";
        }
        
        if (toNumber(ds_condGetTitle.getColumn(0, "SALE_PRICE")) == 0){
        
			str_ErrorCode = "해당 바코드(" + str_BARCODE + " :\n" + str_ITEM_NAME + ") 에\n해당하는 자재코드의\n판매단가가 0입니다.\n확인하여 주십시요.";
        }        
                
        if (gfn_length(str_ErrorCode)!= 0){
         
            g_Message("EE", str_ErrorCode);
			return false;
        }
        else {
        
			return true;
		}
}
//명칭세팅#######################################################################


//MST ID세팅#####################################################################
function fn_GetNewCornerMST_ID()
{

		ds_cond.clear();
		ds_cond.addColumn("MAS_CORNER_MST_S","INT",256);
							
		// action 정보 초기화
		fsp_clear(this);

		// 서버에서 조회할 정보 추가
		fsp_addSearch(this, "ma/mas:MAS10160E_S004");

		// 서버 호출
		http.Sync = true;
		fsp_callService(this, "", "", "", ds_cond.name + "=ds_list",""
																 ,"");
		http.Sync = false;        
        
        return ds_cond.getColumn(0, "MAS_CORNER_MST_S");
}
//MST ID세팅#####################################################################

function ds_MAS_CORNER_MST_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
    if (ds_MAS_CORNER_MST.rowcount == 0) return;
    
	if (
	    (e.columnid == "CHK") ||
	    (e.columnid == "AMT")
	   )
	{
	     
	    fn_CheckAmt(e.row);
	}	
	
	if (
	    (e.columnid == "SALE_PRICE") ||
	    (e.columnid == "QTY")
	   )
	{
	     
	    if (-1 == -1){
	    
				ds_MAS_CORNER_MST.setColumn( e.row, "AMT", toNumber(ds_MAS_CORNER_MST.getColumn(e.row, "SALE_PRICE")) * toNumber(ds_MAS_CORNER_MST.getColumn(e.row, "QTY")) );
	    }
	}	
		
	
	
}


function fn_CheckAmt(nRow)
{
    

	    
	    //선택금액합계세팅#################################
	    var real_TotQty = 0;
		for (i=0;i<ds_MAS_CORNER_MST.rowcount;i++){
		
			if (ds_MAS_CORNER_MST.getColumn(i, "CHK") == "1"){
			
				real_TotQty += ds_MAS_CORNER_MST.getColumn(i, "AMT");
			}
		}
		
		me_AMT.value = real_TotQty;
		//선택금액합계세팅#################################

}


function ds_MAS_CORNER_MST_CanColumnChange(obj:Dataset, e:DSColChangeEventInfo)
{
	if (
	    (e.columnid == "SALE_PRICE") ||
	    (e.columnid == "QTY") ||
	    (e.columnid == "AMT")
	   )
	{

		if (toNumber(e.newvalue) < 0){
		
			g_Message("EE", "-를 입력할 수 없습니다.\n" +
							"확인하여 주십시요.");	
	  			
			return false;  								
		}

	}	
	


	if (
			(e.columnid == "CHK") &&
			(e.newvalue == "1") &&
			(
			   (ds_listInput.rowcount == 0) ||
			   (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_TYPE"))== 0)
			)   
	   )
	{

			g_Message("EE", "매출유형을 먼저 선택하여 주십시요.\n" +
							"확인하여 주십시요.");	
	  			
			return false;  								
	}		

	if (
	    (e.columnid == "CHK") &&
	    (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"))!= "0")
	   )
	{

			g_Message("EE", "기존매출 수정은 삭제후 신규 입력가능합니다.\n" +
							"확인하여 주십시요.");	
	  			
			return false;  											
	}		
	
	if (
			(e.columnid == "CHK") &&
			(e.newvalue == "1") 
	   )
    {

		for (i=0;i<ds_MAS_CORNER_MST.rowcount;i++){
	
			
			if (   
				  (i != e.row) &&
				  (ds_MAS_CORNER_MST.getColumn(i, "CHK") == "1") &&
				  (ds_MAS_CORNER_MST.getColumn(i, "TAX_KIND") != ds_MAS_CORNER_MST.getColumn(e.row, "TAX_KIND"))
			   )
			{
			
					g_Message("EE", "같은 과세구분끼리 매출을 발생하여 주십시요.\n" +
									"확인하여 주십시요.");										
					return false;           						
				
			}
		}
	}
		

}


function grid_MAS_CORNER_MST_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	
	
	if (obj.getCellProperty("head",e.cell,"backgroundimage") == "ico_Excel"){
		gfn_exportExcel(obj, this.titletext);
	}
	else {
	
		if (fn_Get_ColHeaderTitle(obj, e.cell) == "선택"){
			
			
			if (
			     (ds_listInput.rowcount == 0) ||
			     (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_TYPE"))== 0)
			   )
			{
						  
					g_Message("EE", "매출유형을 먼저 선택하여 주십시요.\n" +
									"확인하여 주십시요.");										
					return false;    
			}
			
			if (
			     (ds_listInput.rowcount > 0) &&
			     (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "TRX_ID"))!= "0")
			   )
			{
						  
					g_Message("EE", "기존매출 수정은 삭제후 신규 입력가능합니다.\n" +
									"신규매출등록은 입력버튼을 누른신후\n매출유형을 선택후 작업하여 주십시요.\n" +
									"확인하여 주십시요.");										
					return false;    
			}
						
						
			var j=0;
			for (i=0;i<ds_MAS_CORNER_MST.rowcount;i++){
				
				if (numFormat(ds_MAS_CORNER_MST.getColumn(i, "TRX_ID"))== "0") {
				
					if  (
					      (j == 0) ||
					      (ds_MAS_CORNER_MST.getColumn(i, "TAX_KIND") ==  ds_MAS_CORNER_MST.getColumn(j, "TAX_KIND"))
					    )
					{
					    if (j == 0){
					    
							ds_listInput.setColumn(ds_listInput.rowposition, "TAX_KIND", "");
							ds_listInput.setColumn(ds_listInput.rowposition, "TAX_KINDNM", "");
							
					    }
					    
						ds_MAS_CORNER_MST.setColumn(i, "CHK", "1");	
					
						j = i;
				    }
				}
			}
			
			obj.setCellProperty("head",e.cell,"text","선택(v)"); 
		}
		else if (fn_Get_ColHeaderTitle(obj, e.cell) == "선택(v)"){
			
			for (i=0;i<ds_MAS_CORNER_MST.rowcount;i++){
						
				if (numFormat(ds_MAS_CORNER_MST.getColumn(i, "TRX_ID"))== "0") {
					
					ds_MAS_CORNER_MST.setColumn(i, "CHK", "0");			
				}
			}
			
			obj.setCellProperty("head",e.cell,"text","선택"); 
		}
	    else {
		
			gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);		
		}
	}
	//obj.ExportExcel(this.Title, , False);	
}


//RCP ID세팅#####################################################################
function fn_GetNewRCP_ID()
{
		var real_RCP_ID;
		
		ds_cond.clear();
		ds_cond.addColumn("MAS_RCP_S","INT",256);
					
		// action 정보 초기화
		fsp_clear(this);

		// 서버에서 조회할 정보 추가
		fsp_addSearch(this, "ma/mas:MAS10100E_S002");

		// 서버 호출
		http.Sync = true;
		fsp_callService(this, "", "", "", ds_cond.name + "=ds_list","","");
		http.Sync = false;
		
		real_RCP_ID = ds_cond.getColumn(ds_cond.rowposition, "MAS_RCP_S");
		
		return real_RCP_ID;
}		
//RCP ID세팅#####################################################################



function btn_DetailNew_OnClick(obj:Button, e:ClickEventInfo)
{
	if (!before_SelectCheck()) return false;
	
	if (!fn_GetBeforeData("N", edt_UPJANGQuery.userdata, me_TRX_DATE.value)) return false;	
		
	//gfn_dialog("", "U_MAS::MAS10150P.xml", "f_Parent_Gubun='매점판매수기등록' f_TRX_DATE=" + quote(me_TRX_DATE.Value));	
	
	grid_MAS_CORNER_MST.setFormatColProperty(fn_Get_HeaderTitleColIdx(grid_MAS_CORNER_MST, "선택"),"size",0);	
	
	

	//매출리스트############################################################
    fsp_clear(this);
    
	fsp_addSearch(this, "ma/mas:MAS10160E_S007");			

	ds_cond.clear();
	ds_cond.addColumn("UPJANG","INT",256);
	ds_cond.addColumn("TRX_DATE","STRING",256);
			
	ds_cond.addRow();
		
	ds_cond.setColumn(ds_cond.rowposition, "UPJANG",    edt_UPJANGQuery.userdata);
	ds_cond.setColumn(ds_cond.rowposition, "TRX_DATE",  me_TRX_DATE.value);
					
	fn_DataSetAllClear();

    http.Sync = true;
	fsp_callService(this, "", "", "ds_cond=ds_cond","ds_list=ds_list ds_MAS_CORNER_MST=ds_MAS_CORNER_MST","","fn_SearchDetail()");
	http.Sync = false;	
	//매출리스트############################################################
		
	//일마감체크#####################################################################
	if (!fn_IsCloseDate(ds_cond, edt_UPJANGQuery.userdata, me_TRX_DATE.value, "001")){
	 	 
		for (i=0;i<ds_list.rowcount;i++){
			
			ds_list.setColumn(i, "CLS_YN", "Y");
		}
	 }    
	//일마감체크#####################################################################	
		
}


function fn_Save_MAS_CORNER_MST(){

	
    if (ds_MAS_CORNER_MST.rowcount > 0){
    
		var int_MST_ID;
		for (j=0;j<ds_MAS_CORNER_MST.rowcount;j++){
		
			if (j == 0){
			
				int_MST_ID = fn_GetNewCornerMST_ID();
			}
			
			ds_MAS_CORNER_MST.setColumn(j, "MST_ID", int_MST_ID);
		}
			
		// action 정보 초기화
		fsp_clear(this);	  		
						
		fsp_addMulti(this, "ma/mas:MAS10160E_I001");

        http.Sync = true;
		fsp_callService(this, "", "", "ds_cond=ds_MAS_CORNER_MST:A",  "", "", "fn_AfterImpData()");
		http.Sync = false;

	}	
	
	fn_search();
}

function btn_DetailSave_OnClick(obj:Button, e:ClickEventInfo)
{
	if (!before_SelectCheck()) return false;
	
	if (!fn_GetBeforeData("N", edt_UPJANGQuery.userdata, me_TRX_DATE.value)){
			
		return false;		
	}
	
	//g_debug("ds_MAS_CORNER_MST");
	var int_MST_ID = -1;	 
	var int_MST_TargetRow = ds_MAS_CORNER_MST.findRowExpr("gfn_numFormat(MST_ID)!='0'");
    
    if (int_MST_TargetRow != -1) int_MST_ID = ds_MAS_CORNER_MST.getColumn(int_MST_TargetRow, "MST_ID");
    
    
	for (i=ds_MAS_CORNER_MST.rowcount-1;i>=0;i--){
	

		if (
			   (
				 (toNumber(ds_MAS_CORNER_MST.getColumn(i, "QTY")) != 0) &&
				 (toNumber(ds_MAS_CORNER_MST.getColumn(i, "AMT")) == 0)
			   ) ||
			   (
				 (toNumber(ds_MAS_CORNER_MST.getColumn(i, "QTY")) == 0) &&
				 (toNumber(ds_MAS_CORNER_MST.getColumn(i, "AMT")) != 0)
			   ) ||
			   (
				 (toNumber(ds_MAS_CORNER_MST.getColumn(i, "QTY")) != 0) &&
				 (toNumber(ds_MAS_CORNER_MST.getColumn(i, "AMT")) != 0) &&
				 (toNumber(ds_MAS_CORNER_MST.getColumn(i, "SALE_PRICE")) == 0)
			   )
		    )   
			   
		{
		
					g_Message("EE", i + 1 + "행에 판매단가, 수량 혹은 금액이 0입니다.\n" +
									"확인하여 주십시요.");										
					return false;    
		}
				
        
		if (
			   (
				 (toNumber(ds_MAS_CORNER_MST.getColumn(i, "QTY")) == 0) &&
				 (toNumber(ds_MAS_CORNER_MST.getColumn(i, "AMT")) == 0)
			   ) ||
			   (
				 (toNumber(ds_MAS_CORNER_MST.getColumn(i, "TRX_ID")) != 0)
			   ) 
		    )   
			   
		{
		            
					ds_MAS_CORNER_MST.deleteRow(i);
		}				
	}	

    
    if (ds_MAS_CORNER_MST.rowcount > 0){
    
		var i, j;
		
					
		for (j=0;j<ds_MAS_CORNER_MST.rowcount;j++){
		
			if (int_MST_ID != -1){
				
				
			}
			else if (j == 0){
			
				int_MST_ID = fn_GetNewCornerMST_ID();
			}
			

			ds_MAS_CORNER_MST.setColumn(j, "MST_ID", int_MST_ID);
						
		}	
				
		
		fsp_clear(this);	
		
		//기존 라인 및 매출 데이터 삭제.
		fsp_addMulti(this, "ma/mas:MAS10160E_D002");
		fsp_addMulti(this, "ma/mas:MAS10160E_I001");
				
		
		http.Sync = true;
		fsp_callService(this, "", "", "ds_cond=ds_MAS_CORNER_MST:A", "",  "", "fn_AfterSaveSearch()");
		http.Sync = false;
	}

}

function btn_DetailDelete_OnClick(obj:Button, e:ClickEventInfo)
{
	if (!before_SelectCheck()) return false;
	
	if (ds_MAS_CORNER_MST.getColumn(ds_MAS_CORNER_MST.rowposition, "IMPORT_YN") == "Y"){
	
		g_Message("EE", ds_MAS_CORNER_MST.rowposition + 1 + "행의 자료는 판매실적업로드자료입니다.\n" +
								"판매실적업로드자료는 \n업로드 삭제로 작업하여 주십시요.\n" +
						        "확인하여 주십시요.");										
		return false;  	
	}
	
	if (numFormat(ds_MAS_CORNER_MST.getColumn(ds_MAS_CORNER_MST.rowposition, "TRX_ID"))!= "0"){
	
		g_Message("EE", ds_MAS_CORNER_MST.rowposition + 1 + "행의 자료는 매출발생자료입니다.\n" +
								"먼저 매출을 삭제한후 \n자료를 삭제하여 주십시요.\n" +
						        "확인하여 주십시요.");										
		return false;  	
	}
		
	if ( 
		(ds_MAS_CORNER_MST.rowcount == 0) ||
		(numFormat(ds_MAS_CORNER_MST.getColumn(ds_MAS_CORNER_MST.rowposition, "TRX_ID"))!= "0") ||		
		(!g_Confirm("01"))
	   )
	{

		return false;
	}
	
	if (numFormat(ds_MAS_CORNER_MST.getColumn(ds_MAS_CORNER_MST.rowposition, "DTL_ID"))!= "0"){
		
		ds_cond.clear();
		ds_cond.addColumn("EXIST_YN","STRING",256);
		ds_cond.addColumn("TRX_ID_EXIST_YN","STRING",256);
		ds_cond.addColumn("IMPORT_YN","STRING",256);
		
					
		// action 정보 초기화
		fsp_clear(this);
	
		// 서버에서 조회할 정보 추가
		fsp_addSearch(this, "ma/mas:MAS10160E_S006");
	
		// 서버 호출
		http.Sync = true;
		fsp_callService(this, "", "", "", ds_cond.name + "=ds_list","DTL_ID=" + wrapQuote(ds_MAS_CORNER_MST.getColumn(ds_MAS_CORNER_MST.rowposition, "DTL_ID"))
																 ,"");
		http.Sync = false;
	

	
		if (ds_cond.getColumn(0, "IMPORT_YN") == "Y"){
				
			g_Message("EE", ds_MAS_CORNER_MST.rowposition + 1 + "행의 자료는 판매실적업로드자료입니다.\n" +
									"판매실적업로드자료는 \n업로드 삭제로 작업하여 주십시요.\n" +
									"확인하여 주십시요.");										
			return false;  			
		}			
	
		if (ds_cond.getColumn(0, "TRX_ID_EXIST_YN") == "Y"){
				
			g_Message("EE", ds_MAS_CORNER_MST.rowposition + 1 + "행의 자료는 매출발생자료입니다.\n" +
									"먼저 매출을 삭제한후 \n자료를 삭제하여 주십시요.\n" +
									"확인하여 주십시요.");										
			return false;  	 			
		}			    
		
							
		
		// action 정보 초기화
		fsp_clear(this);			
		
		//기존 라인 및 매출 데이터 삭제.
		fsp_addSingle(this, "ma/mas:MAS10160E_D002");
	
		   
		http.Sync = true;
		fsp_callService(this, "", "", "",  "", "DTL_ID=" + wrapQuote(ds_MAS_CORNER_MST.getColumn(ds_MAS_CORNER_MST.rowposition, "DTL_ID")), "fn_AfterDeleteSearch()");		
		http.Sync = false;		
		
		return true;	
	}
	else {
	
	
		ds_MAS_CORNER_MST.deleteRow(ds_MAS_CORNER_MST.rowposition);
		
	}

}

function btn_ExcelDelete_OnClick(obj:Button, e:ClickEventInfo)
{
	if (!before_SelectCheck()) return false;
	
		
	if ( 
		(ds_MAS_CORNER_MST.rowcount == 0) ||
		(!g_Confirm("01"))
	   )
	{

		return false;
	}
	
	
	ds_cond.clear();
	ds_cond.addColumn("EXIST_YN","STRING",256);
	ds_cond.addColumn("TRX_ID_EXIST_YN","STRING",256);
	ds_cond.addColumn("IMPORT_YN","STRING",256);
	
				
	// action 정보 초기화
	fsp_clear(this);

	// 서버에서 조회할 정보 추가
	fsp_addSearch(this, "ma/mas:MAS10160E_S005");

	// 서버 호출
	http.Sync = true;
	fsp_callService(this, "", "", "", ds_cond.name + "=ds_list","UPJANG=" + wrapQuote(edt_UPJANGQuery.userdata) +
															 " TRX_DATE=" + wrapQuote(me_TRX_DATE.value)
															 ,"");
	http.Sync = false;
			

	if (ds_cond.getColumn(0, "IMPORT_YN") != "Y"){
			
		g_Message("EE", "판매실적업로드자료가 아닙니다.\n" +
						"수기삭제로 작업하여 주십시요.\n" +
						"확인하여 주십시요.");										
		return false;  			
    }	
    
	if (ds_cond.getColumn(0, "TRX_ID_EXIST_YN") == "Y"){
			
		g_Message("EE", "기존 매출발생자료입니다.\n" +
						"먼저 매출을 삭제한후 \n자료를 삭제하여 주십시요.\n" +
						"확인하여 주십시요.");										
		return false;  	 			
    }			    
    
			       		
	
	// action 정보 초기화
	fsp_clear(this);			
	
	//기존 라인 및 매출 데이터 삭제.
	fsp_addSingle(this, "ma/mas:MAS10160E_D001");

	   
	http.Sync = true;
	fsp_callService(this, "", "", "",  "", "UPJANG=" + wrapQuote(edt_UPJANGQuery.userdata) +
										   " TRX_DATE=" + wrapQuote(me_TRX_DATE.value)
										 , "fn_AfterDeleteSearch()");		
	http.Sync = false;		
	
	return true;	

}


function btn_Template_OnClick(obj:Button, e:ClickEventInfo)
{
	gfn_exportExcel(grd_Template, "업로드양식");
}



function fn_GetChkYN(currow)
{

	if (
	    (numFormat(ds_MAS_CORNER_MST.getColumn(currow, "TRX_ID"))== "0") &&
	    (numFormat(ds_MAS_CORNER_MST.getColumn(currow, "MST_ID"))!= "0")
	   )
	{

		return "checkbox";
	}
	else 
	{
		return "none";
	}
}

]]></Script>
  </Form>
</FDL>

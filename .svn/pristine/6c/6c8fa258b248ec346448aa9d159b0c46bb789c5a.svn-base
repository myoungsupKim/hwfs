<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="IncomeLicDtl" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 989 593" titletext="수입 면허 상세" scrollbars="autoboth" onload="form_onload" onclose="IncomeLicDtl_onclose">
    <Layouts>
      <Layout>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 575 989 593" anchor="left bottom"/>
        <Static id="Static31" class="sta_WFDA_Labelbg" position="absolute 15 66 974 93" anchor="left top"/>
        <Static id="Static49" class="sta_WFDA_Labelbg" position="absolute 15 40 974 67" anchor="left top" style="align:left middle;"/>
        <Static id="Static67" class="sta_WFDA_Labelbg" position="absolute 15 92 974 119" anchor="left top"/>
        <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 15 119 465 134" anchor="left top"/>
        <Static id="Static26" text="수입문서번호" class="sta_WFDA_Label01" position="absolute 15 40 109 67" anchor="left top"/>
        <Static id="Static27" text="신고일" class="sta_WFDA_Label01" position="absolute 478 40 572 67" anchor="left top"/>
        <Edit id="edt_entryNum" taborder="8" position="absolute 111 43 228 64" anchor="left top" enable="true" readonly="true" style="background:#ecececff; :disabled {background:#ecececff;}"/>
        <Static id="Static03" text="세관" class="sta_WFDA_Label01" position="absolute 230 66 324 93" anchor="left top"/>
        <Static id="Static46" text="신고번호" class="sta_WFDA_Label01" position="absolute 230 40 324 67" anchor="left top"/>
        <Static id="Static04" text="징수형태" class="sta_WFDA_Label01" position="absolute 726 40 820 67" anchor="left top"/>
        <Static id="Static50" text="도착항" class="sta_WFDA_Label01" position="absolute 993 16 1087 43" anchor="left top" visible="false"/>
        <Static id="Static01" text="해외거래처" class="sta_WFDA_Label01" position="absolute 15 92 109 119" anchor="left top"/>
        <Edit id="edt_arrivPortPortCd" taborder="27" enable="true" position="absolute 1089 19 1238 40" anchor="left top" readonly="true" style="background:#ecececff; :disabled {background:#ecececff;}" visible="false"/>
        <Static id="Static05" class="sta_WFDA_Label01" position="absolute 15 66 109 93" anchor="left top" text="관세사"/>
        <Static id="Static02" text="수리일" class="sta_WFDA_Label01" position="absolute 478 66 572 93" anchor="left top"/>
        <Edit id="edt_splrNm" taborder="11" enable="true" position="absolute 111 95 228 116" anchor="left top" readonly="true" style="background:#ecececff; :disabled {background:#ecececff;}"/>
        <MaskEdit id="edt_incomeLicNum" taborder="0" position="absolute 326 43 476 64" anchor="left top" canchange="edt_incomeLicNum_canchange" mask="#####-##-######A" type="string" style="align:center middle;" limitbymask="none" class="msk_WF_Essential"/>
        <Combo id="cbo_coletType" taborder="2" position="absolute 822 43 971 64" anchor="left top" class="cmb_WF_Essential">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn"/>
                <Col id="datacolumn">**검색조건 선택**</Col>
              </Row>
              <Row>
                <Col id="codecolumn"/>
                <Col id="datacolumn">P/O No</Col>
              </Row>
              <Row>
                <Col id="codecolumn"/>
                <Col id="datacolumn">L/C No</Col>
              </Row>
              <Row>
                <Col id="codecolumn"/>
                <Col id="datacolumn">품명</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="Static10" text="통관환율" class="sta_WFDA_Label01" position="absolute 726 66 820 93" anchor="left top"/>
        <Grid id="grd_entryItemDetailList" taborder="214" binddataset="ds_entryItemDetailList" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 15 152 974 575" anchor="all" onexpandup="grd_entryItemDetailList_onexpandup">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="47"/>
                <Column size="112"/>
                <Column size="212"/>
                <Column size="174"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="85"/>
                <Column size="96"/>
                <Column size="77"/>
                <Column size="77"/>
                <Column size="43"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="85"/>
                <Column size="65"/>
                <Column size="65"/>
                <Column size="104"/>
                <Column size="104"/>
                <Column size="101"/>
                <Column size="150"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="P/O No"/>
                <Cell col="2" class="grd_WF_Essential" text="품목명"/>
                <Cell col="3" style="background:#566572ff URL('theme://images/new/grd_WF_Essential.png') left top;" class="grd_WF_Essential" text="창고명"/>
                <Cell col="4" style="background:#566572ff URL('theme://images/new/grd_WF_Essential.png') left top;" class="grd_WF_Essential" text="보관료"/>
                <Cell col="5" style="background: ;" class="grd_WF_Essential" text="입출고비"/>
                <Cell col="6" text="과세가격"/>
                <Cell col="7" displaytype="normal" edittype="none" style="color: ;" class="grd_WF_Essential" text="관세율" taborder="undefined"/>
                <Cell col="8" style="background:#566572ff URL('theme://images/new/grd_WF_Essential.png') left top;" class="grd_WF_Essential" text="통관수량"/>
                <Cell col="9" style="background: ;" text="통관중량"/>
                <Cell col="10" text="단위"/>
                <Cell col="11" text="단가"/>
                <Cell col="12" text="원물금액"/>
                <Cell col="13" text="중량"/>
                <Cell col="14" text="화폐"/>
                <Cell col="15" text="HS Code"/>
                <Cell col="16" text="P/O 수량"/>
                <Cell col="17" text="P/O 중량"/>
                <Cell col="18" text="통관누적수량"/>
                <Cell col="19" text="통관누적중량"/>
                <Cell col="20" text="P/O item 번호"/>
                <Cell col="21" class="grd_WF_Essential" text="품목코드"/>
              </Band>
              <Band id="body">
                <Cell displaytype="normal" style="align: ;" text="bind:rnum"/>
                <Cell col="1" text="bind:poOrderNum"/>
                <Cell col="2" style="align:left;" text="bind:itemNm" suppress="0"/>
                <Cell col="3" displaytype="text" edittype="expand" style="align:left;" text="bind:whNm" expandshow="show" expandsize="21"/>
                <Cell col="4" displaytype="number" edittype="masknumber" text="bind:chargCost" mask="#,##0.00"/>
                <Cell col="5" displaytype="number" edittype="masknumber" text="bind:ioutCost" mask="#,##0.00"/>
                <Cell col="6" displaytype="number" edittype="masknumber" style="color:sandybrown;" text="bind:taxPrice" mask="#,##0"/>
                <Cell col="7" displaytype="number" edittype="masknumber" style="align:right middle;padding:0 0 0 0;" text="bind:gvrntaxRate" mask="#,##0.000" editdisplay="display" expandshow="show" expandsize="21"/>
                <Cell col="8" displaytype="number" edittype="masknumber" text="bind:entryReqQuantity" mask="#,##0"/>
                <Cell col="9" displaytype="number" edittype="masknumber" text="bind:entryReqWgt" mask="#,##0.00"/>
                <Cell col="10" text="bind:unit"/>
                <Cell col="11" displaytype="number" text="bind:uprice" mask="#,##0.##"/>
                <Cell col="12" displaytype="number" text="bind:entryReqWonwtrAmt" mask="#,##0.00"/>
                <Cell col="13" displaytype="number" text="bind:entryReqWgt" mask="#,##0.00"/>
                <Cell col="14" text="bind:clAmountUnit"/>
                <Cell col="15" displaytype="text" style="align:center middle;" text="bind:hsCd"/>
                <Cell col="16" displaytype="number" text="bind:poQuantity" mask="#,##0"/>
                <Cell col="17" displaytype="number" text="bind:poWgt" mask="#,##0.00"/>
                <Cell col="18" displaytype="number" text="bind:entryAccumQuantity" mask="#,##0"/>
                <Cell col="19" displaytype="number" text="bind:entryAccumWgt" mask="#,##0.00"/>
                <Cell col="20" displaytype="number" text="bind:poItemSeq"/>
                <Cell col="21" displaytype="normal" edittype="none" text="bind:itemCd" expandshow="hide" suppress="0"/>
              </Band>
              <Band id="summary">
                <Cell colspan="3" style="align:center;" text="합계" taborder="undefined"/>
                <Cell col="3"/>
                <Cell col="4" displaytype="number" expr="expr:getSum(&quot;chargCost&quot;)" mask="#,##0.00"/>
                <Cell col="5" displaytype="number" expr="expr:getSum(&quot;ioutCost&quot;)" mask="#,##0.00"/>
                <Cell col="6" displaytype="number" expr="expr:getSum(&quot;taxPrice&quot;)" mask="#,##0"/>
                <Cell col="7" displaytype="number"/>
                <Cell col="8" displaytype="number" expr="expr:getSum(&quot;entryReqQuantity&quot;)" mask="#,##0"/>
                <Cell col="9" displaytype="number" expr="expr:getSum(&quot;entryReqWgt&quot;)" mask="#,##0.00"/>
                <Cell col="10"/>
                <Cell col="11" displaytype="number" expr="expr:getSum(&quot;uprice&quot;)"/>
                <Cell col="12" displaytype="number" expr="expr:getSum(&quot;entryReqWonwtrAmt&quot;)" mask="#,##0.00"/>
                <Cell col="13" displaytype="number" expr="expr:getSum(&quot;entryReqWgt&quot;)" mask="#,##0.00"/>
                <Cell col="14"/>
                <Cell col="15"/>
                <Cell col="16" displaytype="number" expr="expr:getSum(&quot;poQuantity&quot;)" mask="#,##0"/>
                <Cell col="17" displaytype="number" expr="expr:getSum(&quot;poWgt&quot;)" mask="#,##0.00"/>
                <Cell col="18" displaytype="number" expr="expr:getSum(&quot;entryAccumQuantity&quot;)" mask="#,##0"/>
                <Cell col="19" displaytype="number" expr="expr:getSum(&quot;entryAccumWgt&quot;)" mask="#,##0.00"/>
                <Cell col="20"/>
                <Cell col="21" colspan="2" style="align:center;" taborder="undefined"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 15 147 974 152" anchor="left top"/>
        <Static id="Static22" text="품목" class="sta_WF_Title01" position="absolute 15 134 298 152" anchor="left top"/>
        <Button id="Button00" taborder="7" onclick="fn_addRow" class="btn_WF_GrdPlus" position="absolute 936 127 954 147" anchor="top right"/>
        <Button id="Button01" taborder="216" onclick="fn_deleteRow" class="btn_WF_GrdMinus" position="absolute 956 127 974 147" anchor="top right"/>
        <ObjCalendar id="cal_incomeNewhghtDate" titletext="캘린더" taborder="1" text="ObjCalendar00" scrollbars="none" position="absolute 574 43 724 64"/>
        <ObjCalendar id="cal_licDate" titletext="캘린더" taborder="5" text="ObjCalendar00" scrollbars="none" position="absolute 574 69 724 90"/>
        <MaskEdit id="edt_entryExchangeRate" taborder="6" mask="#,##0.00" canchange="edt_proposalExchangeRate_canchange" class="msk_WF_Essential" position="absolute 822 69 971 90" anchor="left top" style="align:right middle;"/>
        <Edit id="edt_newhghtCustomsNm" taborder="12" readonly="true" autoselect="true" position="absolute 326 69 456 90" enable="true" style="background:#fff6e9ff URL('theme://images/new/img_WF_EssentialBg.png') left top; :disabled {background:#ecececff;}" class="edt_WF_Essential"/>
        <Button id="btn_newhghtCustomsNm" taborder="4" tabstop="false" class="btn_WF_popSearch" position="absolute 455 69 476 90" onclick="btn_newhghtCustomsNm_onclick"/>
        <Edit id="edt_tariffHouseNm" taborder="13" readonly="true" autoselect="true" position="absolute 111 69 208 90" enable="true" style="background:#ecececff; :disabled {background:#ecececff;}" class="edt_WF_Essential"/>
        <Button id="btn_tariffHouseNm" taborder="3" tabstop="false" class="btn_WF_popSearch" position="absolute 207 69 228 90" onclick="btn_tariffHouseNm_onclick"/>
        <Static id="Static00" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 15 588"/>
        <Static id="Static15" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 15 0 635 10"/>
        <Static id="sta_title" text="수입 면허 상세" class="sta_WF_Title" position="absolute 15 16 215 40"/>
        <Static id="Static07" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 15 10 215 16"/>
        <Static id="Static08" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 727 35 974 40"/>
        <Static id="Static09" text="아이콘기준 h08" class="Guide01_AreaRed" visible="false" position="absolute 15 32 215 40"/>
        <Static id="Static11" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 974 0 989 462"/>
        <Button id="btn_close" taborder="217" text="닫기" onclick="fn_close" class="btn_WF_CRUD" position="absolute 929 10 974 35" anchor="top right"/>
        <Static id="Static20" text="W102" visible="false" position="absolute 927 10 929 35" anchor="top right" style="background:#ff000055;align:center middle;"/>
        <Button id="btn_save" taborder="218" text="저장" onclick="fn_save" class="btn_WF_CRUD" position="absolute 882 10 927 35" anchor="top right"/>
        <Static id="Static06" text="W102" visible="false" position="absolute 880 10 882 35" anchor="top right" style="background:#ff000055;align:center middle;"/>
        <Static id="Static17" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 954 127 956 147" anchor="top right"/>
        <Static id="Static48" text="B/L No" class="sta_WFDA_Label01" position="absolute 230 92 324 119" anchor="left top"/>
        <Edit id="edt_blNum" taborder="9" enable="true" position="absolute 326 95 476 116" anchor="left top" oneditclick="Edit13_oneditclick" readonly="true" style="background:#ecececff; :disabled {background:#ecececff;}"/>
        <Button id="btn_whAllReg" taborder="219" text="창고일괄등록" onclick="btn_whAllReg_onclick" class="btn_WF_Function" position="absolute 850 127 934 147" anchor="top right"/>
        <Static id="Static12" text="결재환율" class="sta_WFDA_Label01" position="absolute 478 92 572 119" anchor="left top"/>
        <Combo id="cbo_signExchangeRate" taborder="220" class="cmb_WF_Essential" position="absolute 575 95 724 116" anchor="left top" innerdataset="@ds_signExchangeRateList" codecolumn="code" datacolumn="codeNm"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item0" compid="grd_entryItemDetailList" propid="" datasetid="ds_분할선적허용" columnid="Column0"/>
      <BindItem id="item1" compid="grd_entryItemDetailList" propid="" datasetid="ds_분할선적허용" columnid="Column1"/>
      <BindItem id="item2" compid="grd_entryItemDetailList" propid="" datasetid="ds_분할선적허용" columnid="Column2"/>
      <BindItem id="item3" compid="grd_entryItemDetailList" propid="" datasetid="ds_분할선적허용" columnid="Column3"/>
      <BindItem id="item4" compid="grd_entryItemDetailList" propid="" datasetid="ds_분할선적허용" columnid="Column4"/>
      <BindItem id="item5" compid="grd_entryItemDetailList" propid="" datasetid="ds_분할선적허용" columnid="Column5"/>
      <BindItem id="item6" compid="grd_entryItemDetailList" propid="" datasetid="ds_분할선적허용" columnid="Column6"/>
      <BindItem id="item7" compid="grd_entryItemDetailList" propid="" datasetid="ds_분할선적허용" columnid="Column7"/>
      <BindItem id="item8" compid="grd_entryItemDetailList" propid="" datasetid="ds_분할선적허용" columnid="Column8"/>
      <BindItem id="item9" compid="grd_entryItemDetailList" propid="" datasetid="ds_분할선적허용" columnid="Column9"/>
      <BindItem id="item10" compid="grd_entryItemDetailList" propid="" datasetid="ds_분할선적허용" columnid="Column10"/>
      <BindItem id="item11" compid="grd_entryItemDetailList" propid="" datasetid="ds_분할선적허용" columnid="Column11"/>
      <BindItem id="item12" compid="grd_entryItemDetailList" propid="" datasetid="ds_분할선적허용" columnid="Column12"/>
      <BindItem id="item13" compid="grd_entryItemDetailList" propid="" datasetid="ds_분할선적허용" columnid="Column13"/>
      <BindItem id="item14" compid="grd_entryItemDetailList" propid="" datasetid="ds_분할선적허용" columnid="Column14"/>
      <BindItem id="item15" compid="grd_entryItemDetailList" propid="" datasetid="ds_분할선적허용" columnid="Column15"/>
      <BindItem id="item16" compid="grd_entryItemDetailList" propid="" datasetid="ds_분할선적허용" columnid="Column16"/>
      <BindItem id="item17" compid="edt_incomeLicNum" propid="value" datasetid="ds_entryMst" columnid="incomeLicNum"/>
      <BindItem id="item19" compid="edt_entryNum" propid="value" datasetid="ds_entryMst" columnid="entryNum"/>
      <BindItem id="item20" compid="cbo_coletType" propid="value" datasetid="ds_entryMst" columnid="coletType"/>
      <BindItem id="item21" compid="edt_blNum" propid="value" datasetid="ds_entryMst" columnid="blNum"/>
      <BindItem id="item22" compid="edt_arrivPortPortCd" propid="value" datasetid="ds_entryMst" columnid="arrivPortPortNm"/>
      <BindItem id="item23" compid="edt_splrNm" propid="value" datasetid="ds_entryMst" columnid="splrNm"/>
      <BindItem id="item49" compid="edt_entryExchangeRate" propid="value" datasetid="ds_entryMst" columnid="entryExchangeRate"/>
      <BindItem id="item26" compid="edt_newhghtCustomsNm" propid="value" datasetid="ds_entryMst" columnid="newhghtCustomsNm"/>
      <BindItem id="item18" compid="edt_tariffHouseNm" propid="value" datasetid="ds_entryMst" columnid="tariffHouseNm"/>
      <BindItem id="item24" compid="cbo_signExchangeRate" propid="value" datasetid="ds_entryMst" columnid="signExchangeRate"/>
    </Bind>
    <Objects>
      <Dataset id="ds_entryItemDetailList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_entryItemDetailList_oncolumnchanged">
        <ColumnInfo>
          <Column id="entryNum" type="STRING" size="14"/>
          <Column id="entryItemSeq" type="BIGDECIMAL" size="22"/>
          <Column id="poOrderNum" type="STRING" size="16"/>
          <Column id="itemSeq" type="BIGDECIMAL" size="22"/>
          <Column id="itemCd" type="STRING" size="53"/>
          <Column id="itemNm" type="STRING" size="200"/>
          <Column id="unit" type="STRING" size="50"/>
          <Column id="uprice" type="BIGDECIMAL" size="22"/>
          <Column id="entryReqQuantity" type="BIGDECIMAL" size="22"/>
          <Column id="entryReqWgt" type="BIGDECIMAL" size="22"/>
          <Column id="entryReqWonwtrAmt" type="BIGDECIMAL" size="22"/>
          <Column id="taxPrice" type="BIGDECIMAL" size="22"/>
          <Column id="gvrntaxRate" type="BIGDECIMAL" size="22"/>
          <Column id="whCd" type="STRING" size="50"/>
          <Column id="origin" type="STRING" size="50"/>
          <Column id="chargCost" type="BIGDECIMAL" size="22"/>
          <Column id="ioutCost" type="BIGDECIMAL" size="22"/>
          <Column id="incomeDtrDsctNum" type="STRING" size="20"/>
          <Column id="estNo" type="STRING" size="20"/>
          <Column id="cuser" type="STRING" size="20"/>
          <Column id="cdate" type="DATETIME" size="7"/>
          <Column id="uuser" type="STRING" size="20"/>
          <Column id="udate" type="DATETIME" size="7"/>
          <Column id="hsCd" type="STRING" size="256"/>
          <Column id="whNm" type="STRING" size="256"/>
          <Column id="poQuantity" type="BIGDECIMAL" size="256"/>
          <Column id="poWgt" type="BIGDECIMAL" size="256"/>
          <Column id="entryAccumQuantity" type="BIGDECIMAL" size="256"/>
          <Column id="entryAccumWgt" type="BIGDECIMAL" size="256"/>
          <Column id="clAmountUnit" type="STRING" size="256"/>
          <Column id="poItemSeq" type="STRING" size="256"/>
          <Column id="entryQuantity" type="BIGDECIMAL" size="256"/>
          <Column id="entryWgt" type="BIGDECIMAL" size="256"/>
          <Column id="entryEndQuantity" type="BIGDECIMAL" size="256"/>
          <Column id="entryEndWgt" type="BIGDECIMAL" size="256"/>
          <Column id="originNationCd" type="STRING" size="256"/>
          <Column id="originNationNm" type="STRING" size="256"/>
          <Column id="rnum" type="STRING" size="256"/>
          <Column id="deliverNum" type="STRING" size="256"/>
          <Column id="kgConvertRate" type="STRING" size="256"/>
          <Column id="set1" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="entryNum" type="STRING" size="256"/>
          <Column id="flag" type="STRING" size="256"/>
          <Column id="exchangeRateDate" type="STRING" size="256"/>
          <Column id="amountUnit" type="STRING" size="256"/>
          <Column id="incomeLicNum" type="STRING" size="256"/>
          <Column id="unit" type="STRING" size="256"/>
          <Column id="poOrderNum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_entryMst" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="entryNum" type="STRING" size="14"/>
          <Column id="poOrderNum" type="STRING" size="16"/>
          <Column id="blNum" type="STRING" size="53"/>
          <Column id="lcNum" type="STRING" size="53"/>
          <Column id="incomeLicNum" type="STRING" size="53"/>
          <Column id="clAmountUnit" type="STRING" size="50"/>
          <Column id="entryExchangeRate" type="STRING" size="22"/>
          <Column id="incomeNewhghtDate" type="STRING" size="8"/>
          <Column id="licDate" type="STRING" size="8"/>
          <Column id="newhghtCustomsCd" type="STRING" size="50"/>
          <Column id="newhghtCustomsNm" type="STRING" size="256"/>
          <Column id="tariffHouseCd" type="STRING" size="50"/>
          <Column id="tariffHouseNm" type="STRING" size="256"/>
          <Column id="coletType" type="STRING" size="50"/>
          <Column id="deliverYn" type="STRING" size="50"/>
          <Column id="cuser" type="STRING" size="20"/>
          <Column id="cdate" type="DATETIME" size="7"/>
          <Column id="uuser" type="STRING" size="20"/>
          <Column id="udate" type="DATETIME" size="7"/>
          <Column id="arrivPortPortCd" type="STRING" size="256"/>
          <Column id="arrivPortPortNm" type="STRING" size="256"/>
          <Column id="splrNm" type="STRING" size="256"/>
          <Column id="signExchangeRate" type="FLOAT" size="256"/>
        </ColumnInfo>
        <Rows/>
      </Dataset>
      <Dataset id="ds_itemList00" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_itemList_oncolumnchanged">
        <ColumnInfo>
          <Column id="proposalSeq" type="STRING" size="256"/>
          <Column id="itemCd" type="STRING" size="256"/>
          <Column id="itemNm" type="STRING" size="256"/>
          <Column id="brand" type="STRING" size="256"/>
          <Column id="hsCd" type="STRING" size="256"/>
          <Column id="unit" type="STRING" size="256"/>
          <Column id="quantity" type="BIGDECIMAL" size="256"/>
          <Column id="uprice" type="BIGDECIMAL" size="256"/>
          <Column id="wonwtrAmt" type="BIGDECIMAL" size="256"/>
          <Column id="wgt" type="BIGDECIMAL" size="256"/>
          <Column id="taxYn" type="STRING" size="256"/>
          <Column id="cuser" type="STRING" size="256"/>
          <Column id="cdate" type="STRING" size="256"/>
          <Column id="uuser" type="STRING" size="256"/>
          <Column id="udate" type="STRING" size="256"/>
          <Column id="poProposalNum" type="STRING" size="256"/>
          <Column id="origin" type="STRING" size="256"/>
          <Column id="gradeStand" type="STRING" size="256"/>
          <Column id="offer" type="BIGDECIMAL" size="256"/>
          <Column id="offer2" type="BIGDECIMAL" size="256"/>
          <Column id="wholeSale" type="BIGDECIMAL" size="256"/>
          <Column id="wholeSale2" type="BIGDECIMAL" size="256"/>
          <Column id="gvrntaxRate" type="BIGDECIMAL" size="256"/>
          <Column id="buyAmt" type="BIGDECIMAL" size="256"/>
          <Column id="buyPrice" type="BIGDECIMAL" size="256"/>
          <Column id="proposalExchangeRate" type="BIGDECIMAL" size="256"/>
          <Column id="comm" type="BIGDECIMAL" size="256"/>
          <Column id="whCost" type="BIGDECIMAL" size="256"/>
          <Column id="intRate" type="BIGDECIMAL" size="256"/>
          <Column id="salsUprice" type="BIGDECIMAL" size="256"/>
          <Column id="salsAmt" type="BIGDECIMAL" size="256"/>
          <Column id="salsGainAmt" type="BIGDECIMAL" size="256"/>
          <Column id="salsGainRat" type="BIGDECIMAL" size="256"/>
          <Column id="drctGainAmt" type="BIGDECIMAL" size="256"/>
          <Column id="drctGainRat" type="BIGDECIMAL" size="256"/>
          <Column id="expectBlPaym" type="BIGDECIMAL" size="256"/>
          <Column id="entryOtherAmt" type="BIGDECIMAL" size="256"/>
          <Column id="remark" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_entryItemDetailListValid" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_groupList_oncolumnchanged">
        <ColumnInfo>
          <Column id="itemCd" type="STRING" size="255"/>
          <Column id="itemNm" type="STRING" size="255"/>
          <Column id="whCd" type="STRING" size="256"/>
          <Column id="chargCost" type="STRING" size="256"/>
          <Column id="ioutCost" type="STRING" size="256"/>
          <Column id="entryReqQuantity" type="STRING" size="256"/>
          <Column id="gvrntaxRate" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="itemCd">title:품목코드,required:true</Col>
            <Col id="itemNm">title:품목명,required:true</Col>
            <Col id="whCd">title:창고명,required:true</Col>
            <Col id="chargCost">title:보관료,required:true</Col>
            <Col id="ioutCost">title:입출고비,required:true</Col>
            <Col id="entryReqQuantity">title:통관수량,required:true</Col>
            <Col id="gvrntaxRate">title:관세율,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_entryMstValid" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="incomeLicNum" type="STRING" size="256"/>
          <Column id="entryExchangeRate" type="STRING" size="256"/>
          <Column id="coletType" type="STRING" size="256"/>
          <Column id="incomeNewhghtDate" type="STRING" size="256"/>
          <Column id="licDate" type="STRING" size="256"/>
          <Column id="newhghtCustomsCd" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="coletType">title:징수형태,required:true,focus:cbo_coletType</Col>
            <Col id="incomeLicNum">title:면허번호,required:true,focus:edt_incomeLicNum</Col>
            <Col id="entryExchangeRate">title:통관환율,required:true,focus:edt_entryExchangeRate</Col>
            <Col id="incomeNewhghtDate">title:수입신고일자,required:true,focus:cal_incomeNewhghtDate</Col>
            <Col id="licDate">title:면허일자,required:true,focus:cal_licDate</Col>
            <Col id="newhghtCustomsCd">title:세관,required:true,focus:edt_newhghtCustomsNm</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_signExchangeRateList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="14"/>
          <Column id="codeNm" type="STRING" size="16"/>
        </ColumnInfo>
        <Rows/>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : 수입 면허 상세
  파 일 명 : IncomeLicDtl.xfdl
  기    능 : Design 및 Script Template 

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.01.12   kksoo   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "lib::FTCommon.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_iProcessCnt = 0; //저장에 대한 처리건수를 저장한다.(AuthMgmtController에서 할당함.)
var fv_entryNum;
var fv_flag;
var fv_poOrderNum;
var fv_focFlag;
var fv_exchangeRate;		//환율
var fv_exchangeRateBasis;	//환율 기준(1 or 100)
var fv_dupIncomeLicNumYn;

var fv_copyFlag = true;
var fv_set1;	//실단위
var fv_currRow;
/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	// Grid내의 input field를 자동 선택 제어 함수
	FTCommon.setGridAutoSelect (this, true);
	
	ds_search.addRow();
	
	fv_entryNum = gfn_nvl(entryNum, "");
	fv_flag = gfn_nvl(flag, "");
	fv_focFlag = gfn_nvl(flag, "");
	fv_poOrderNum = gfn_nvl(poOrderNum, "");
	
	cal_incomeNewhghtDate.fn_initMonthCal(this, "", "fn_incomeNewhghtDateCallBack", ds_entryMst, "incomeNewhghtDate","Y");	//수입신고일자	
	cal_licDate.fn_initMonthCal(this, "", "fn_calendarCallBack", ds_entryMst, "licDate","Y");	//면허일자	
	
	SCCombo.bind2(this, "ComCode", "cbo_coletType", null, {groupCode:"COLET_TYPE", useYn:"Y", defVal:"", isLast:true, lastEvent:"fn_doSearch"});	 	 //징수형태
	
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function searchSignExchangeRate(poOrderNum)
{
    //코드목록을 초기화한다.
    ds_signExchangeRateList.clearData();
	ds_search.setColumn(0, "poOrderNum", poOrderNum);
	
    var strSvcID    = "selectEntryDtl";
    var strURL      = "ft/fdm/entryMst/searchSignExchangeRate.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_search=ds_search ds_signExchangeRateList=ds_signExchangeRateList";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 콤보코드 최종 callback 함수
 *---------------------------------------------------------------------------------------------*/
function fn_doSearch()
{
	edt_incomeLicNum.setFocus();
	
	if ( fv_entryNum == "" ) 
	{
		ds_entryMst.insertRow(0);
		cbo_coletType.value = "14";	//신고·사후납부(무담보) 	--> 기본값으로 셋팅(제일 많이 쓰는 징수형태입니다.)
	} 
	else 
	{
	
		searchSignExchangeRate(fv_poOrderNum);	//결재환율 조회
		fn_search();
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
 	// v_ds_check 미사용시 변경사항 체크
 	if (gfn_dsIsUpdated(ds_entryMst) || gfn_dsIsUpdated(ds_entryItemDetailList) ) 
 	{
		// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
 		var retValue = gfn_confirm("confirm.before.search");
 		if (retValue == false) return;
 	}
    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_entryItemDetailList);
    
    //코드목록을 초기화한다.
    ds_entryMst.clearData();
    ds_entryItemDetailList.clearData();

	ds_search.setColumn(0, "entryNum", fv_entryNum);
	ds_search.setColumn(0, "flag", fv_flag);
	
    var strSvcID    = "selectEntryDtl";
    var strURL      = "ft/fdm/entryMst/selectEntryDtl.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_search=ds_search ds_entryMst=ds_entryMst ds_entryItemDetailList=ds_entryItemDetailList";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {
		//품의 조회
        case "selectEntryDtl" :
			//cal_incomeNewhghtDate.fn_initMonthCal(this, "", "fn_incomeNewhghtDateCallBack", ds_entryMst, "incomeNewhghtDate","Y");	//수입신고일자
			//cal_licDate.fn_initMonthCal(this, "", "fn_calendarCallBack", ds_entryMst, "licDate","Y");	//면허일자
			//alert(gfn_nvl(ds_entryItemDetailList.getColumn(0,"deliverNum")),'');
			if ( gfn_nvl(ds_entryItemDetailList.getColumn(0,"deliverNum"),'') != "" )	  //입고된 내역이 있으면 저장 못한다.
			{
				btn_save.enable = false;
			}
			 
			if ( gfn_nvl(ds_entryMst.getColumn(0,"signExchangeRate"),'') == "" )	  //입고된 내역이 있으면 저장 못한다.
			{
				cbo_signExchangeRate.index = 0;
			}
            break;
        // 저장
        case "save" :
			if (fv_iProcessCnt > 0) {
				gfn_alert("msg.save.success");	// 저장 되었습니다.
				fv_flag = "UPDATE";
				fn_search();
			}
            break;
        case "getExchangeRate":
			if ( fv_exchangeRate != "" )
			{
				ds_entryMst.setColumn(0, "entryExchangeRate", fv_exchangeRate / fv_exchangeRateBasis  );
			}
			break;
        case "dupIncomeLicNumChk":
			//alert(fv_dupIncomeLicNumYn);
			if ( fv_dupIncomeLicNumYn == 'Y' )
			{
				gfn_alert("수입면허번호 :"+edt_incomeLicNum.value+"은 중복됩니다.");
				ds_entryMst.setColumn(0, "incomeLicNum", "" );
				edt_incomeLicNum.setFocus();
			}
			break;
        case "getUnitInfo":
			if ( fv_set1 != "" )
			{
				ds_entryItemDetailList.setColumn(fv_currRow, "set1", fv_set1  );
			}
			break;	            
    }
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
	//v_ds_check 미사용시 변경사항 체크
 	if ( !gfn_dsIsUpdated(ds_entryMst) && !gfn_dsIsUpdated(ds_entryItemDetailList) )
 	{
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}
	
	// 저장시 Validation Check
	if (gfn_validCheck(ds_entryMst, ds_entryMstValid) == false)	return;
	if (gfn_validCheck(ds_entryItemDetailList, ds_entryItemDetailListValid) == false)	return;

	if ( toNumber(ds_entryMst.getColumn(0,"incomeNewhghtDate" )) > toNumber(ds_entryMst.getColumn(0,"licDate" )) )
	{
		gfn_alert("수리일은 신고일보다 빠를 수 없습니다.");
		return;
	}

	if (  fv_flag == "NEW" && ds_entryItemDetailList.getRowCount() ==0)
	{
		gfn_alert("+ 버튼을 클릭하여 수입면허 품목을 선택하세요");
		return;
	}

	ds_search.setColumn(0, "flag", fv_flag);
	
	if (!gfn_confirm("confirm.before.save")) return false;
	
	edt_incomeLicNum.value =edt_incomeLicNum.text;
	
    var strSvcID    = "save";
    var strURL      = "ft/fdm/entryMst/saveEntryDtl.xdo";
    var strInDs     = "ds_search=ds_search ds_entryMst=ds_entryMst:U ds_entryItemDetailList=ds_entryItemDetailList:A";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 행추가
 *---------------------------------------------------------------------------------------------*/
function fn_addRow(obj:Button,  e:ClickEventInfo)
{

	fv_copyFlag = false;
	//if (gfn_validCheck(ds_entryMst, ds_entryMstValid) == false)	return;

	var arrParam = new Array();
	arrParam[0] = gfn_nvl(ds_entryMst.getColumn(0, "incomeNewhghtDate"), "");	// 관세율 계산은 신고일 기준
	arrParam[1] = gfn_nvl(ds_entryMst.getColumn(0, "poOrderNum"), "");	// 전송할 파라미터 2
	
	var  arrRtn = gfn_dialog("IncomeLicItemSlctPop"				// dialogId                                                                                          
					   , "X_FDM::IncomeLicItemSlctPop.xfdl"			// 품목찾기 팝업 호출                                                                            
					   , {fv_Contents:arrParam}			// 배열
					   , null, null, null, null, null, false, true, -1);                                                                                             
	if ( arrRtn !=null && arrRtn.rowcount > 0 )                                                                                                                                  
	{                                         
		for ( var i=0; i<arrRtn.rowcount; i++ )
		{
		
			var chkDup = true;	
			for ( var j=0; j<ds_entryItemDetailList.getRowCount(); j++ )
			{
				if ( (arrRtn.getColumn(i, "poOrderNum") == ds_entryItemDetailList.getColumn(j, "poOrderNum")) && (arrRtn.getColumn(i, "itemCd")== ds_entryItemDetailList.getColumn(j, "itemCd")  && arrRtn.getColumn(i, "itemSeq")== ds_entryItemDetailList.getColumn(j, "itemSeq")) )
				{
					gfn_alert("P/O No["+arrRtn.getColumn(i, "poOrderNum")+"] 품목코드["+arrRtn.getColumn(i, "itemCd")+"] 이 중복됨니다.");
					chkDup  = false;
					break;
				}

			}			
			
 			if (chkDup)	  //중복된 데이타 빼고 추가
 			{			
				if ( i == 0 )
				{
					ds_entryMst.setColumn(0, "poOrderNum", arrRtn.getColumn(i, "poOrderNum"));
					ds_entryMst.setColumn(0, "blNum", arrRtn.getColumn(i, "blNum"));
					ds_entryMst.setColumn(0, "lcNum", arrRtn.getColumn(i, "lcNum"));
					ds_entryMst.setColumn(0, "arrivPortPortNm", arrRtn.getColumn(i, "arrivPortPortNm"));
					ds_entryMst.setColumn(0, "splrNm", arrRtn.getColumn(i, "splrNm"));
					ds_entryMst.setColumn(0, "clAmountUnit", arrRtn.getColumn(i, "amountUnit"));
					ds_entryMst.setColumn(0, "tariffHouseCd", arrRtn.getColumn(i, "tariffHouseCd"));
					ds_entryMst.setColumn(0, "tariffHouseNm", arrRtn.getColumn(i, "tariffHouseNm"));
					
					fn_incomeNewhghtDateCallBack();	   //통관 환율조회
					
					searchSignExchangeRate(arrRtn.getColumn(i, "poOrderNum"));	//결재환율 조회
				}
				var insRow = ds_entryItemDetailList.insertRow(ds_entryItemDetailList.getRowCount()+i);
				if ( ds_entryMst.getColumn(0, "entryNum") != "" )
				{
					ds_entryItemDetailList.setColumn(insRow, "entryNum", ds_entryMst.getColumn(0, "entryNum"));
				}
				ds_entryItemDetailList.setColumn(insRow, "itemCd", arrRtn.getColumn(i, "itemCd"));
				ds_entryItemDetailList.setColumn(insRow, "itemSeq", arrRtn.getColumn(i, "itemSeq"));
				ds_entryItemDetailList.setColumn(insRow, "itemNm", arrRtn.getColumn(i, "itemNm"));
				ds_entryItemDetailList.setColumn(insRow, "whCd", arrRtn.getColumn(i, "whCd"));
				ds_entryItemDetailList.setColumn(insRow, "whNm", arrRtn.getColumn(i, "whNm"));
				ds_entryItemDetailList.setColumn(insRow, "chargCost", arrRtn.getColumn(i, "chargCost"));					//창고보관비
				ds_entryItemDetailList.setColumn(insRow, "ioutCost", arrRtn.getColumn(i, "ioutCost"));						//입출고비
				ds_entryItemDetailList.setColumn(insRow, "hsCd", arrRtn.getColumn(i, "hsCd"));								//HS코드
				ds_entryItemDetailList.setColumn(insRow, "poQuantity", arrRtn.getColumn(i, "quantity"));					//PO수량	
				ds_entryItemDetailList.setColumn(insRow, "poWgt", arrRtn.getColumn(i, "wgt"));					//PO수량	
				ds_entryItemDetailList.setColumn(insRow, "entryAccumQuantity", arrRtn.getColumn(i, "entryAccumQuantity"));	//통관누적수량
				ds_entryItemDetailList.setColumn(insRow, "entryAccumWgt", arrRtn.getColumn(i, "entryAccumWgt"));	//통관누적수량

				ds_entryItemDetailList.setColumn(insRow, "entryEndQuantity", arrRtn.getColumn(i, "entryEndQuantity"));		//통관완료수량
				ds_entryItemDetailList.setColumn(insRow, "entryEndWgt", arrRtn.getColumn(i, "entryEndWgt"));		//통관완료수량

				ds_entryItemDetailList.setColumn(insRow, "entryQuantity", arrRtn.getColumn(i, "entryQuantity"));			//통관수량
				ds_entryItemDetailList.setColumn(insRow, "entryWgt", arrRtn.getColumn(i, "entryWgt"));			//통관수량
				ds_entryItemDetailList.setColumn(insRow, "unit", arrRtn.getColumn(i, "unit"));								//단위
				ds_entryItemDetailList.setColumn(insRow, "uprice", arrRtn.getColumn(i, "uprice"));							//단가

				var set1 = gfn_nvl(arrRtn.getColumn(i, "set1"));
				var kgConvertRate = toNumber(gfn_nvl(arrRtn.getColumn(i, "kgConvertRate")));
				var entryQuantity = toNumber(gfn_nvl(arrRtn.getColumn(i, "entryQuantity")));
				var entryWgt = toNumber(gfn_nvl(arrRtn.getColumn(i, "entryWgt")));
				var uprice = toNumber(gfn_nvl(arrRtn.getColumn(i, "uprice")));
				var uprice = gfn_nvl(ds_entryItemDetailList.getColumn(insRow, "uprice"));
				
				ds_entryItemDetailList.setColumn(insRow, "entryReqWonwtrAmt", arrRtn.getColumn(i, "wonwtrAmt"));							//원물금액
				ds_entryItemDetailList.setColumn(insRow, "entryReqWgt", arrRtn.getColumn(i, "entryWgt"));						//중량
				ds_entryItemDetailList.setColumn(insRow, "entryReqQuantity", arrRtn.getColumn(i, "entryQuantity"));			//요청수량 
				ds_entryItemDetailList.setColumn(insRow, "clAmountUnit", arrRtn.getColumn(i, "amountUnit"));				//화폐단위
				ds_entryItemDetailList.setColumn(insRow, "poOrderNum", arrRtn.getColumn(i, "poOrderNum"));					//PO NO
				ds_entryItemDetailList.setColumn(insRow, "poItemSeq", arrRtn.getColumn(i, "itemSeq"));						//PO ITEM SEQ
				ds_entryItemDetailList.setColumn(insRow, "gvrntaxRate", arrRtn.getColumn(i, "gvrntaxRate"));				//관세율
				ds_entryItemDetailList.setColumn(insRow, "origin", arrRtn.getColumn(i, "origin"));							//원산지
				ds_entryItemDetailList.setColumn(insRow, "incomeDtrDsctNum", arrRtn.getColumn(i, "incomeDtrDsctNum"));		//수입 유통 식별 번호
				ds_entryItemDetailList.setColumn(insRow, "estNo", arrRtn.getColumn(i, "estNo"));							//estNo
				ds_entryItemDetailList.setColumn(insRow, "originNationCd", arrRtn.getColumn(i, "originNationCd"));			//원산지코드
				ds_entryItemDetailList.setColumn(insRow, "originNationNm", arrRtn.getColumn(i, "originNm"));				//원산지코드

				ds_entryItemDetailList.getColumn(i, "entryReqWonwtrAmt");
				//축산일 경우는 중량을 수량으로 데이타가 들어옴  : 수량으로 계산 
				var taxPrice = 	toNumber(ds_entryItemDetailList.getColumn(i, "entryReqWonwtrAmt")) * toNumber(ds_entryMst.getColumn(0, "entryExchangeRate")) * toNumber(arrRtn.getColumn(i, "gvrntaxRate")); //USD금액 * 관세율/100
				ds_entryItemDetailList.setColumn(insRow, "taxPrice", Math.round( taxPrice ) );	
			}
		}
	} 
	fv_copyFlag = true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 품목 행삭제
 *---------------------------------------------------------------------------------------------*/
function fn_deleteRow(obj:Button,  e:ClickEventInfo)
{
	if (ds_entryItemDetailList.rowposition == -1) return;
	var bSucc = ds_entryItemDetailList.deleteRow(ds_entryItemDetailList.rowposition);
}


function fn_calendarCallBack() {
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 품목 그리드 품목 팝업 expand시
 *---------------------------------------------------------------------------------------------*/
function grd_entryItemDetailList_onexpandup(obj:Grid, e:GridMouseEventInfo)
{
	if(e.row <= -1) return;
    var sColumn = gfn_getCellColId(obj, e.col);

	//Expand 클릭시
	if (sColumn == "gvrntaxRate")
	{
		var arrParam = new Array();
		arrParam[0] = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "originNationNm"), "");	// 전송할 파라미터 1
		arrParam[1] = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "itemNm"), "");	// 전송할 파라미터 2
		var  arrRtn = gfn_dialog("PortAirPop"					// dialogId
						   , "X_FSI::TermbyGvrntaxRatePop.xfdl"	// 기간별 관세율 팝업 호출
						   , {fv_Contents:arrParam}				// 배열
						   , null, null, null, null, null, false, true, -1);
		if ( arrRtn instanceof Object )
		{

			ds_entryItemDetailList.setColumn(ds_entryItemDetailList.rowposition, "itemCd", arrRtn["itemCd"]  );
			ds_entryItemDetailList.setColumn(ds_entryItemDetailList.rowposition, "itemNm", arrRtn["itemNm"]  );	
			ds_entryItemDetailList.setColumn(ds_entryItemDetailList.rowposition, "gvrntaxRate", arrRtn["gvrntaxRate"]  );	
			
		}
		
	}
	//창고명 클릭시
	else if (sColumn == "whNm")
	{
		var arrParam = new Array();
		arrParam[1] = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "whNm"), "");	// 전송할 파라미터 2
		arrParam[3] = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "itemNm"), "");	// 전송할 파라미터 2
		var  arrRtn = gfn_dialog("WhItemChargAmtPop"				// dialogId
						   , "X_FSI::WhItemChargAmtPop.xfdl"		// 국가/공항 팝업 호출
						   , {fv_Contents:arrParam}			// 배열
						   , null, null, null, null, null, false, true, -1);
		if ( arrRtn instanceof Object )
		{
			ds_entryItemDetailList.setColumn(ds_entryItemDetailList.rowposition, "whCd", arrRtn["whCd"]  ); 
			ds_entryItemDetailList.setColumn(ds_entryItemDetailList.rowposition, "whNm", arrRtn["whNm"]  );	
			ds_entryItemDetailList.setColumn(ds_entryItemDetailList.rowposition, "chargCost", arrRtn["chargCost"]  );	
			ds_entryItemDetailList.setColumn(ds_entryItemDetailList.rowposition, "ioutCost", arrRtn["ioutCost"]  );	
			//ds_entryItemDetailList.setColumn(ds_entryItemDetailList.rowposition, "itemCd", arrRtn["itemCd"]  );	
			//ds_entryItemDetailList.setColumn(ds_entryItemDetailList.rowposition, "itemNm", arrRtn["itemNm"]  );	
			
		}
	}	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 그리드 컬럼 변경시
 *---------------------------------------------------------------------------------------------*/
function ds_entryItemDetailList_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{

	if ( !fv_copyFlag ) return;

	
	
	if(e.columnid == "entryReqWgt" )
	{
        fv_currRow = e.row;
		fn_getUnitInfo( gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "unit")) );

		var kgConvertRate = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "kgConvertRate"));
		var quantity = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "entryReqQuantity"));
		var unit = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "unit"));
		
		var poQuantity = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "poQuantity"));
		var poWgt = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "poWgt"));
		var avgWgt = poWgt/poQuantity;	//평균중량

		var avgQuantity = obj.getOrgColumn(ds_entryItemDetailList.rowposition, "entryReqQuantity");
		var avgWgt = obj.getOrgColumn(ds_entryItemDetailList.rowposition, "entryReqWgt");
		avgWgt = avgWgt/avgQuantity;	//평균중량
		

		if(e.columnid == "entryReqQuantity" )
		{
			ds_entryItemDetailList.setColumn(e.row, "entryReqWgt", entryQuantity * avgWgt );		
		}				

		if ( unit == 'KG' ) 
		{
			base = ds_entryItemDetailList.getColumn(e.row, "entryReqWgt");
		} else
		{
			base = ds_entryItemDetailList.getColumn(e.row, "entryReqQuantity");
		}	
		
		
		var uprice = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "uprice"));
		ds_entryItemDetailList.setColumn(e.row, "entryReqWonwtrAmt", base * uprice);
	}
	
	if(e.columnid == "entryReqQuantity"  || e.columnid == "uprice"  
	|| e.columnid == "unit" 
	) 
	{
        fv_currRow = e.row;
		fn_getUnitInfo( gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "unit")) );
		var kgConvertRate = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "kgConvertRate"));
		var unit = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "unit"));
		var quantity = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "entryReqQuantity"));
		var uprice = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "uprice"));
		var set1 = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "set1"));

		var poQuantity = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "poQuantity"));
		var poWgt = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "poWgt"));
		var avgWgt = poWgt/poQuantity;	//평균중량
		//alert(poWgt+"/"+poQuantity+"="+poWgt/poQuantity);		
		ds_entryItemDetailList.setColumn(e.row, "entryReqWgt", quantity * avgWgt );
		
		
		//alert(unit+"//"+kgConvertRate+"//"+quantity+"//"+(kgConvertRate * quantity));
		var base;
		//계산 기준 : KG이면 중량 단위가 BOX나 BDL이면 수량	
		if ( set1 == 'KG') 
		{
			//ds_entryItemDetailList.setColumn(e.row, "entryReqWgt", kgConvertRate * quantity );
			base = ds_entryItemDetailList.getColumn(e.row, "entryReqWgt");
		} else
		{
			base = ds_entryItemDetailList.getColumn(e.row, "entryReqQuantity");
		}	
		//alert(ds_entryItemDetailList.getColumn(fv_currRow, "set1")+"//"+base +"//"+ uprice); 
		var uprice = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "uprice"));
		ds_entryItemDetailList.setColumn(e.row, "entryReqWonwtrAmt", base * uprice);

		var entryAccumQuantity = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "entryAccumQuantity"));	//통관누적수량
		var entryAccumWgt = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "entryAccumWgt"));				//통관누적중량
		var entryReqQuantity = toNumber(gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "entryReqQuantity")));
		var entryReqWgt = toNumber(gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "entryReqWgt")));

		var orgEntryReqQuantity = toNumber(gfn_nvl(ds_entryItemDetailList.getOrgColumn(e.row, "entryReqQuantity")));
		var orgEntryReqWgt = toNumber(gfn_nvl(ds_entryItemDetailList.getOrgColumn(e.row, "entryReqWgt")));
		
		var poQuantity = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "poQuantity"));	//PO수량
		var poWgt = gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "poWgt"));	//PO수량
		
		//alert(entryAccumQuantity +"//"+ entryReqQuantity +"//"+orgEntryReqQuantity+"//"+ poWgt );
		
	    if ( (entryAccumQuantity + (entryReqQuantity - orgEntryReqQuantity) ) > poQuantity )
	    {
			gfn_alert("PO수량 이상 통관할 수 없습니다.");
			ds_entryItemDetailList.setColumn(e.row, "entryReqQuantity", ds_entryItemDetailList.getOrgColumn(e.row, "entryReqQuantity") );
			return;
	    }
	    if ( (entryAccumWgt + (entryReqWgt - orgEntryReqWgt) ) > poWgt )
	    {
			gfn_alert("PO중량 이상 통관할 수 없습니다.");
			ds_entryItemDetailList.setColumn(e.row, "entryReqWgt", ds_entryItemDetailList.getOrgColumn(e.row, "entryReqWgt") );
			return;
	    }
	}
	//if(e.columnid == "gvrntaxRate" )	//관세율
	//{
		//축산일 경우는 중량을 수량으로 데이타가 들어옴  : 수량으로 계산 
		var entryReqWonwtrAmt = toNumber(ds_entryItemDetailList.getColumn(e.row, "entryReqWonwtrAmt"));
		var gvrntaxRate = toNumber(ds_entryItemDetailList.getColumn(e.row, "gvrntaxRate"));
		var entryExchangeRate = toNumber(ds_entryMst.getColumn(0, "entryExchangeRate"));
		var taxPrice = 	entryReqWonwtrAmt * entryExchangeRate *  gvrntaxRate /100 ; //USD금액 * 통관환율 * 관세율/100
		ds_entryItemDetailList.setColumn(e.row, "taxPrice", Math.round( taxPrice ) );	
	//}
	
	var entryQuantity = toNumber(gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "entryReqQuantity")));
	var entryWgt = toNumber(gfn_nvl(ds_entryItemDetailList.getColumn(e.row, "entryReqWgt")));

	var orgEntryQuantity = toNumber(gfn_nvl(ds_entryItemDetailList.getOrgColumn(e.row, "entryReqQuantity")));
	var orgEntryWgt = toNumber(gfn_nvl(ds_entryItemDetailList.getOrgColumn(e.row, "entryReqWgt")));

	if ( entryQuantity == orgEntryQuantity && entryWgt != orgEntryWgt)
	{
		gfn_alert("모든 통관수량이 통관시 통관중량도 모든 통관중량으로 통관되어야 합니다.");
		ds_entryItemDetailList.setColumn(e.row, "entryReqWgt", orgEntryWgt);	
	}
	if ( entryWgt == orgEntryWgt && entryQuantity != orgEntryQuantity)
	{
		gfn_alert("모든 통관중량이 통관시 통관수량도 모든 통관수량으로 통관되어야 합니다.");
		ds_entryItemDetailList.setColumn(e.row, "entryReqQuantity", orgEntryQuantity);	
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      :단위변경시 단위에 해당하는 실단위 가져오기
 *---------------------------------------------------------------------------------------------*/
function fn_getUnitInfo(unit)
{
	ds_search.setColumn(0, "unit", unit);
	
    var strSvcID    = "getUnitInfo";
    var strURL      = "ft/ftp/getUnitInfo.xdo";
    var strInDs     = "ds_search=ds_search";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = false;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);	
}

/*----------------------------------------------------------------------------------------------
 * 설명      :환율조회
 *---------------------------------------------------------------------------------------------*/
function fn_incomeNewhghtDateCallBack()
{
	if ( gfn_nvl(ds_entryMst.getColumn(ds_entryMst.rowposition, "incomeNewhghtDate"),"") =="" || gfn_nvl(ds_entryMst.getColumn(ds_entryMst.rowposition, "clAmountUnit"),"") =="" ) 
	{
		return;
	}
	
	ds_search.setColumn(0, "exchangeRateDate", ds_entryMst.getColumn(ds_entryMst.rowposition, "incomeNewhghtDate"));
	ds_search.setColumn(0, "amountUnit", ds_entryMst.getColumn(ds_entryMst.rowposition, "clAmountUnit"));
	
    var strSvcID    = "getExchangeRate";
    var strURL      = "ft/ftp/getExchangeRate.xdo";
    var strInDs     = "ds_search=ds_search";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync, false);	
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function fn_close(obj:Button, e:ClickEventInfo)
{
	if ( fv_iProcessCnt > 0 )	//변경사항 있을시 부모창 재조회
	{
		if ( fv_flag == "NEW" ) 
		{
			opener.parent.fv_popIProcessCnt  = fv_iProcessCnt;
		}
		else
		{
			this.opener.fv_popIProcessCnt  = fv_iProcessCnt;
		}
	} 
	this.close();
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function IncomeLicDtl_onclose(obj:Form, e:CloseEventInfo)
{
	if ( fv_iProcessCnt > 0 )	//변경사항 있을시 부모창 재조회
	{
		if ( fv_focFlag == "NEW" ) 
		{
			opener.parent.fv_popIProcessCnt  = fv_iProcessCnt;
		}
		else
		{
			this.opener.fv_popIProcessCnt  = fv_iProcessCnt;
		}
		return;
	} 
	this.close();
}

/*
 ******************************************************************************************
 * 함  수  명   : edt_incomeLicNum_ontextchanged()
 * 기      능   : 면허번호 중복체크
 ******************************************************************************************
 */
function edt_incomeLicNum_canchange(obj:MaskEdit,  e:ChangeEventInfo)
{
	ds_search.setColumn(0, "incomeLicNum", edt_incomeLicNum.text);
 	
    var strSvcID    = "dupIncomeLicNumChk";
    var strURL      = "ft/fdm/entryMst/dupIncomeLicNumChk.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_search=ds_search";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = false;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 세관버튼 선택시
 *---------------------------------------------------------------------------------------------*/
function btn_newhghtCustomsNm_onclick(obj:Button,  e:ClickEventInfo)
{
	var arrParam = new Array();
	arrParam[0] = gfn_nvl(ds_entryMst.getColumn(e.row, "newhghtCustomsCd"), "");		// 전송할 파라미터 1
	arrParam[1] = gfn_nvl(ds_entryMst.getColumn(e.row, "newhghtCustomsNm"), "");		// 전송할 파라미터 2
	arrParam[2] = "40";	// 세관
	var  arrRtn = gfn_dialog("ContrtPop"				// dialogId
					   , "X_FSI::ContrtPop.xfdl"		// 거래처 팝업 호출
					   , {fv_Contents:arrParam}			// 배열
					   , null, null, null, null, null, false, true, -1);
	if ( arrRtn instanceof Object )
	{
		ds_entryMst.setColumn(0, "newhghtCustomsCd", arrRtn["vdCd"]  );
		ds_entryMst.setColumn(0, "newhghtCustomsNm", arrRtn["vdNmLoc"]  );	
		
	}		
	
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 관세사버튼 선택시
 *---------------------------------------------------------------------------------------------*/
function btn_tariffHouseNm_onclick(obj:Button,  e:ClickEventInfo)
{
	var arrParam = new Array();
	arrParam[0] = gfn_nvl(ds_entryMst.getColumn(e.row, "tariffHouseCd"), "");		// 전송할 파라미터 1
	arrParam[1] = gfn_nvl(ds_entryMst.getColumn(e.row, "tariffHouseNm"), "");		// 전송할 파라미터 2
	arrParam[2] = "30";	// 관세사
	var  arrRtn = gfn_dialog("ContrtPop"				// dialogId
					   , "X_FSI::ContrtPop.xfdl"		// 거래처 팝업 호출
					   , {fv_Contents:arrParam}			// 배열
					   , null, null, null, null, null, false, true, -1);
	if ( arrRtn instanceof Object )
	{
		ds_entryMst.setColumn(0, "tariffHouseCd", arrRtn["vdCd"]  );
		ds_entryMst.setColumn(0, "tariffHouseNm", arrRtn["vdNmLoc"]  );	
		
	}		
}

/*----------------------------------------------------------------------------------------------
 * 설명      :창고일괄등록 버튼 클릭시
 *---------------------------------------------------------------------------------------------*/
function btn_whAllReg_onclick(obj:Button,  e:ClickEventInfo)
{
	if ( ds_entryItemDetailList.rowcount  == 0 ) return;
	
	var arrParam = new Array();
	arrParam[2] = "50";	// 창고
	var  arrRtn = gfn_dialog("ContrtPop"				// dialogId
					   , "X_FSI::ContrtPop.xfdl"		// 매출처 팝업 호출
					   , {fv_Contents:arrParam}			// 배열
					   , null, null, null, null, null, false, true, -1);
	if ( arrRtn instanceof Object )
	{
		
		for ( var i=0; i<ds_entryItemDetailList.getRowCount(); i++)
		{
				ds_entryItemDetailList.setColumn(i, "whCd", arrRtn["vdCd"]  );
				ds_entryItemDetailList.setColumn(i, "whNm", arrRtn["vdNmLoc"]  );	
		}
	}		
}

function edt_proposalExchangeRate_canchange(obj:MaskEdit,  e:ChangeEventInfo)
{
	for ( var i=0; i<ds_entryItemDetailList.getRowCount(); i++ )
	{
		//축산일 경우는 중량을 수량으로 데이타가 들어옴  : 수량으로 계산 
		var entryReqWonwtrAmt = toNumber(ds_entryItemDetailList.getColumn(i, "entryReqWonwtrAmt"));
		var gvrntaxRate = toNumber(ds_entryItemDetailList.getColumn(i, "gvrntaxRate"));
		var entryExchangeRate = toNumber(ds_entryMst.getColumn(0, "entryExchangeRate"));
		var taxPrice = 	entryReqWonwtrAmt * entryExchangeRate *  gvrntaxRate /100 ; //USD금액 * 통관환율 * 관세율/100
		ds_entryItemDetailList.setColumn(i, "taxPrice", Math.round( taxPrice ) );	
	}
}
]]></Script>
  </Form>
</FDL>

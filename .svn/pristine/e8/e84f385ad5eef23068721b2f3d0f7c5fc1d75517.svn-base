<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="form" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" scrollbars="autoboth" onload="form_onload" onkeydown="form_onkeydown">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="1" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30" tabstop="false"/>
        <OrgChoiceComponent id="OrgChoiceComponent00" titletext="조직을 선택하는 Component" taborder="15" text="OrgChoiceComponent00" position="absolute 286 176 412 197"/>
        <Button id="Button00" taborder="3" text="DownShopInfo" position="absolute 7 46 127 96" onclick="Button00_onclick"/>
        <Button id="Button04" taborder="8" text="승인" position="absolute 616 67 767 98" onclick="Button04_onclick"/>
        <Grid id="Grid01" taborder="10" useinputpanel="false" position="absolute 4 106 1233 520" binddataset="ds_approvalList">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="refSys"/>
                <Cell col="1" disptype="normal" text="refNo"/>
                <Cell col="2" disptype="normal" text="seq"/>
                <Cell col="3" disptype="normal" text="reqDocCd"/>
                <Cell col="4" disptype="normal" text="reqWcc"/>
                <Cell col="5" disptype="normal" text="reqCardNo"/>
                <Cell col="6" disptype="normal" text="reqDiv"/>
                <Cell col="7" disptype="normal" text="reqApprovalDt"/>
                <Cell col="8" disptype="normal" text="reqApprovalNo"/>
                <Cell col="9" disptype="normal" text="reqAmt"/>
                <Cell col="10" disptype="normal" text="reqCharge"/>
                <Cell col="11" disptype="normal" text="reqVat"/>
                <Cell col="12" disptype="normal" text="reqPosNo"/>
                <Cell col="13" disptype="normal" text="docCd"/>
                <Cell col="14" disptype="normal" text="resCd"/>
                <Cell col="15" disptype="normal" text="tid"/>
                <Cell col="16" disptype="normal" text="wcc"/>
                <Cell col="17" disptype="normal" text="cardDataEnc"/>
                <Cell col="18" disptype="normal" text="cardNoEnc"/>
                <Cell col="19" disptype="normal" text="div"/>
                <Cell col="20" disptype="normal" text="amt"/>
                <Cell col="21" disptype="normal" text="charge"/>
                <Cell col="22" disptype="normal" text="vat"/>
                <Cell col="23" disptype="normal" text="approvalNo"/>
                <Cell col="24" disptype="normal" text="approvalDt"/>
                <Cell col="25" disptype="normal" text="issueCpnCd"/>
                <Cell col="26" disptype="normal" text="cardCpnNm"/>
                <Cell col="27" disptype="normal" text="memberCd"/>
                <Cell col="28" disptype="normal" text="purchaseCpnCd"/>
                <Cell col="29" disptype="normal" text="purchaseCpnNm"/>
                <Cell col="30" disptype="normal" text="posNo"/>
                <Cell col="31" disptype="normal" text="dscDiv"/>
                <Cell col="32" disptype="normal" text="msg"/>
                <Cell col="33" disptype="normal" text="cuser"/>
                <Cell col="34" disptype="normal" text="cdate"/>
                <Cell col="35" disptype="normal" text="uuser"/>
                <Cell col="36" disptype="normal" text="udate"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:refSys"/>
                <Cell col="1" disptype="normal" text="bind:refNo"/>
                <Cell col="2" disptype="normal" text="bind:seq"/>
                <Cell col="3" disptype="normal" text="bind:reqDocCd"/>
                <Cell col="4" disptype="normal" text="bind:reqWcc"/>
                <Cell col="5" disptype="normal" text="bind:reqCardNo"/>
                <Cell col="6" disptype="normal" text="bind:reqDiv"/>
                <Cell col="7" disptype="normal" text="bind:reqApprovalDt"/>
                <Cell col="8" disptype="normal" text="bind:reqApprovalNo"/>
                <Cell col="9" disptype="normal" text="bind:reqAmt"/>
                <Cell col="10" disptype="normal" text="bind:reqCharge"/>
                <Cell col="11" disptype="normal" text="bind:reqVat"/>
                <Cell col="12" disptype="normal" text="bind:reqPosNo"/>
                <Cell col="13" disptype="normal" text="bind:docCd"/>
                <Cell col="14" disptype="normal" text="bind:resCd"/>
                <Cell col="15" disptype="normal" text="bind:tid"/>
                <Cell col="16" disptype="normal" text="bind:wcc"/>
                <Cell col="17" disptype="normal" text="bind:cardDataEnc"/>
                <Cell col="18" disptype="normal" text="bind:cardNoEnc"/>
                <Cell col="19" disptype="normal" text="bind:div"/>
                <Cell col="20" disptype="normal" text="bind:amt"/>
                <Cell col="21" disptype="normal" text="bind:charge"/>
                <Cell col="22" disptype="normal" text="bind:vat"/>
                <Cell col="23" disptype="normal" text="bind:approvalNo"/>
                <Cell col="24" disptype="normal" text="bind:approvalDt"/>
                <Cell col="25" disptype="normal" text="bind:issueCpnCd"/>
                <Cell col="26" disptype="normal" text="bind:cardCpnNm"/>
                <Cell col="27" disptype="normal" text="bind:memberCd"/>
                <Cell col="28" disptype="normal" text="bind:purchaseCpnCd"/>
                <Cell col="29" disptype="normal" text="bind:purchaseCpnNm"/>
                <Cell col="30" disptype="normal" text="bind:posNo"/>
                <Cell col="31" disptype="normal" text="bind:dscDiv"/>
                <Cell col="32" disptype="normal" text="bind:msg"/>
                <Cell col="33" disptype="normal" text="bind:cuser"/>
                <Cell col="34" disptype="normal" text="bind:cdate"/>
                <Cell col="35" disptype="normal" text="bind:uuser"/>
                <Cell col="36" disptype="normal" text="bind:udate"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="Button05" taborder="11" text="조회" position="absolute 515 67 608 98" onclick="Button05_onclick"/>
        <Button id="Button06" taborder="12" text="취소" position="absolute 774 67 925 98" onclick="Button06_onclick"/>
        <Edit id="Edit00" taborder="19" position="absolute 251 72 495 92"/>
        <ActiveX id="kicc" visible="false" position="absolute 4 545 192 624" progid="{93137A73-7A61-4911-8018-C758BBE73F53}" useautobitmapcache="1" anchor="default" style="background:white;" taborder="20" Color="#ffffffff" OnRcvData="kicc_OnRcvData"/>
        <Static id="Static03" text="REF NO" class="sta_WFSA_label" position="absolute 176 71 236 92" anchor="left top"/>
        <ObjCalendar id="ObjCalendar00" titletext="캘린더" taborder="21" text="ObjCalendar00" scrollbars="none" position="absolute 1006 68 1106 89"/>
        <Calendar id="Calendar00" taborder="22" position="absolute 842 40 992 60" style="popupsize:300 300;"/>
        <UpjangSearchComponent id="UpjangSearchComponent00" titletext="업장 검색용 Component" taborder="23" text="UpjangSearchComponent00" position="absolute 501 596 648 624" bindDataset="" bindUpjangCodeColumn="" bindUpjangNameColumn="" eventBeforeTrigger="fn_beforeStUpjang" eventAfterTrigger="" roleSetId="StUpjang"/>
        <Edit id="Edit01" taborder="24" position="absolute 749 595 860 621" class="edt_WF_Essential"/>
      </Layout>
    </Layouts>
    <Bind/>
    <Objects>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">Y</Col>
            <Col id="insYn">Y</Col>
            <Col id="delYn">0</Col>
            <Col id="savYn">0</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">0</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_approvalList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="refSys" type="STRING" size="50"/>
          <Column id="refNo" type="STRING" size="50"/>
          <Column id="seq" type="BIGDECIMAL" size="22"/>
          <Column id="reqDocCd" type="STRING" size="2"/>
          <Column id="reqWcc" type="STRING" size="1"/>
          <Column id="reqCardNo" type="STRING" size="40"/>
          <Column id="reqDiv" type="STRING" size="2"/>
          <Column id="reqApprovalDt" type="STRING" size="6"/>
          <Column id="reqApprovalNo" type="STRING" size="12"/>
          <Column id="reqAmt" type="BIGDECIMAL" size="22"/>
          <Column id="reqCharge" type="BIGDECIMAL" size="22"/>
          <Column id="reqVat" type="BIGDECIMAL" size="22"/>
          <Column id="reqPosNo" type="STRING" size="20"/>
          <Column id="docCd" type="STRING" size="2"/>
          <Column id="resCd" type="STRING" size="4"/>
          <Column id="tid" type="STRING" size="8"/>
          <Column id="wcc" type="STRING" size="1"/>
          <Column id="cardDataEnc" type="STRING" size="200"/>
          <Column id="cardNoEnc" type="STRING" size="200"/>
          <Column id="div" type="STRING" size="2"/>
          <Column id="amt" type="BIGDECIMAL" size="22"/>
          <Column id="charge" type="BIGDECIMAL" size="22"/>
          <Column id="vat" type="BIGDECIMAL" size="22"/>
          <Column id="approvalNo" type="STRING" size="12"/>
          <Column id="approvalDt" type="STRING" size="12"/>
          <Column id="issueCpnCd" type="STRING" size="3"/>
          <Column id="cardCpnNm" type="STRING" size="20"/>
          <Column id="memberCd" type="STRING" size="12"/>
          <Column id="purchaseCpnCd" type="STRING" size="3"/>
          <Column id="purchaseCpnNm" type="STRING" size="20"/>
          <Column id="posNo" type="STRING" size="20"/>
          <Column id="dscDiv" type="STRING" size="1"/>
          <Column id="msg" type="STRING" size="2000"/>
          <Column id="cuser" type="STRING" size="20"/>
          <Column id="cdate" type="DATETIME" size="7"/>
          <Column id="uuser" type="STRING" size="20"/>
          <Column id="udate" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : Template
  파 일 명 : Template.xfdl
  기    능 : Design 및 Script Template 

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2014.11.01   김윤기   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "lib::SCKicc.xjs";
/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
}

function fn_close()
{	
	// v_ds_check 미사용시 변경사항 체크(입력 프로그램일때 변경되는 Dataset 전체 기술)
	if (gfn_dsIsUpdated(ds_list) == true) 
	{
		// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
        if (!gfn_confirm("confirm.before.movepage")) return false;
    }
    
	// 조회프로그램에도 Return true; 기술해 주세요!
	return true;
}
function fn_search()
{
}
function fn_insert()
{
}
function fn_delete()
{
}
function fn_save()
{
}
function fn_print()
{
}
function fn_help()
{
}

/* *************************************************************************************** */
// 기  능 : 저장 완료 callback 함수
/* *************************************************************************************** */
function fn_callback(svcId, errCd, errMsg) {
	if (errCd < 0) 
	{
		return;
	}
	
	switch (svcId) {
		case "selectApprovalData" :
			
			break;
	}
}


// /////////////////////////////////////////////////
function Button05_onclick(obj:Button,  e:ClickEventInfo)
{
	var strSvcID    = "selectApprovalData";
	var strURL      = "sc/cmn/kiccApproval/selectList.xdo";
	var strInDs     = "";
	var strOutDs    = "ds_approvalList=ds_approvalList";
	var strArg      = "refSys=BMS refNo="+Edit00.value;
	var strCallback = "fn_callback";
	var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

function Button00_onclick(obj:Button,  e:ClickEventInfo)
{
	var ret, sE;
	ret = kicc.DownShopInfo("1168119948", "02", "0802327", "1000", "02151515151", 0, sE, "203.233.72.21", 4110);
	
	alert(ret);
}

function Button04_onclick(obj:Button,  e:ClickEventInfo)
{
	var rtn = SCKicc.approval("TMP", Edit00.value, 10000);
	
	if (rtn instanceof Object) {
		//refNo, resCd (0000:성공, 그외는 실패)
		if (rtn.resCd == "0000") {
			//업무정보 저장....
		}
		else {
			gfn_alert(rtn.msg);
		}
	}
	else {
		gfn_alert("결재를 취소했습니다.");
	}
}

function Button06_onclick(obj:Button,  e:ClickEventInfo)
{
	Edit00.value = SCKicc.cancel(ds_approvalList.getColumn(ds_approvalList.rowposition, "refSys"), ds_approvalList.getColumn(ds_approvalList.rowposition, "refNo"), ds_approvalList.getColumn(ds_approvalList.rowposition, "seq"));
}


function fn_beforeStUpjang(o, c) {
	c.setIncludeVirtureUpjang(true);
	return true;
}





]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="TestInfoReg" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="시험정보등록" scrollbars="autoboth" onload="form_onload" onmousewheel="grd_specmArticleList_onheadclick">
    <Layouts>
      <Layout>
        <Static id="Static93" class="sta_WFDA_Labelbg" position="absolute 551 275 1237 302" anchor="top right"/>
        <Static id="Static23" class="sta_WFDA_Labelbg" position="absolute 1907 125 2557 152" anchor="left top" visible="false"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 691" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="65" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30">
          <Layouts>
            <Layout/>
          </Layouts>
        </Div>
        <Static id="Static18" text="접수정보" class="sta_WF_Title01" position="absolute 0 29 450 47" anchor="left top"/>
        <Static id="Static20" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 42 1242 47" anchor="left top"/>
        <Static id="Static26" text="의뢰번호" class="sta_WFDA_Label01" position="absolute 0 47 94 74" anchor="left top"/>
        <Static id="Static49" class="sta_WFDA_Labelbg" position="absolute 93 47 1237 74" anchor="left top right"/>
        <Edit id="edt_reqNum" taborder="0" position="absolute 96 50 203 71" anchor="left top" readonly="true"/>
        <Static id="Static00" text="의뢰일자" class="sta_WFDA_Label01" position="absolute 205 47 299 74" anchor="left top"/>
        <Static id="Static19" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 74 450 89" anchor="left top"/>
        <Static id="Static03" text="의뢰업체" class="sta_WF_Title01" position="absolute 0 88 450 106" anchor="left top"/>
        <Static id="Static04" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 101 450 106" anchor="left top"/>
        <Static id="Static05" text="의뢰사업장" class="sta_WFDA_Label01" position="absolute 0 106 81 133" anchor="left top"/>
        <Static id="Static07" class="sta_WFDA_Labelbg" position="absolute 80 106 1237 133" anchor="left top right"/>
        <Edit id="edt_upjangNm" taborder="3" position="absolute 82 110 225 131" anchor="left top" class="edt_WF_Essential" updatebindingvalue="default" readonly="true"/>
        <Static id="Static08" text="사업자명" class="sta_WFDA_Label01" position="absolute 2147 24 2241 51" anchor="left top" visible="false"/>
        <Static id="Static09" text="사업자번호" class="sta_WFDA_Label01" position="absolute 2413 24 2507 51" anchor="left top" visible="false"/>
        <Button id="btn_searchUpjang" taborder="66" class="btn_WF_popSearch" position="absolute 224 110 245 131" anchor="left top" onclick="btn_searchUpjang_onclick" enable="false"/>
        <Edit id="edt_ceo" taborder="4" position="absolute 2243 27 2411 48" anchor="left top" readonly="true" visible="false"/>
        <MaskEdit id="edt_bizNo" taborder="5" type="string" mask="@@@-@@-@@@@@" limitbymask="none" enable="true" position="absolute 2509 27 2626 48" style="align:center middle;" readonly="true" visible="false"/>
        <Static id="Static10" text="세부업장명" class="sta_WFDA_Label01" position="absolute 2628 24 2722 51" anchor="left top" visible="false"/>
        <Edit id="edt_pclsUpjangNm" taborder="6" position="absolute 2724 27 2880 48" anchor="left top" visible="false"/>
        <Static id="Static14" class="sta_WFDA_Labelbg" position="absolute 1907 99 2342 126" anchor="left top" visible="false"/>
        <Static id="Static11" text="의뢰자이메일" class="sta_WFDA_Label01" position="absolute 1886 50 1980 77" anchor="left top" visible="false"/>
        <Edit id="edt_reqUserEmail" taborder="8" position="absolute 1982 53 2145 74" anchor="left top" visible="false"/>
        <Static id="Static24" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 160 450 175" anchor="left top"/>
        <Static id="Static27" text="검체목록" class="sta_WF_Title01" position="absolute 0 179 450 197" anchor="left top"/>
        <Static id="Static28" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 192 450 197" anchor="left top"/>
        <Static id="Static29" text="검체정보" class="sta_WF_Title02" position="absolute 545 178 995 196" anchor="top right"/>
        <Static id="Static30" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 545 165 795 178" anchor="left top"/>
        <Static id="Static31" text="글자기준간격 h07" class="Guide01_AreaRed" visible="false" position="absolute 545 190 795 197" anchor="left top"/>
        <Static id="Static32" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 541 172 550 460"/>
        <Static id="Static34" class="sta_WFDA_Labelbg" position="absolute 551 197 1237 224" anchor="top right"/>
        <Static id="Static33" text="접수번호" class="sta_WFDA_Label01" position="absolute 551 197 645 224" anchor="top right"/>
        <Edit id="edt_acceptNum" taborder="13" position="absolute 647 200 746 221" anchor="top right" enable="true" readonly="true"/>
        <Static id="Static35" text="접수일자" class="sta_WFDA_Label01" position="absolute 748 197 842 224" anchor="top right"/>
        <Static id="Static36" text="검체명" class="sta_WFDA_Label01" position="absolute 942 197 1036 224" anchor="top right"/>
        <Edit id="edt_specmNm" taborder="16" position="absolute 1107 200 1214 221" anchor="top right" tooltiptext="자재코드검색" class="edt_WF_Essential"/>
        <Static id="Static37" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 873 192 1237 197" anchor="top right"/>
        <Static id="Static38" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1153 166 1237 172" anchor="top right"/>
        <Static id="Static39" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1146 172 1148 192" anchor="top right"/>
        <Button id="btn_delSpecm" taborder="67" text="검체정보삭제" class="btn_WF_Function" position="absolute 1148 172 1237 192" anchor="top right" onclick="btn_delSpecm_onclick"/>
        <Static id="Static40" text="접수명" class="sta_WFDA_Label01" position="absolute 407 47 501 74" anchor="left top"/>
        <Edit id="edt_acceptnm" taborder="2" position="absolute 503 50 837 71" anchor="left top" imemode="hangul" class="edt_WF_Essential"/>
        <Static id="Static41" class="sta_WFDA_Labelbg" position="absolute 551 249 1237 276" anchor="top right"/>
        <Static id="Static42" text="비용" class="sta_WFDA_Label01" position="absolute 551 249 645 276" anchor="top right"/>
        <Combo id="cbo_costClass" taborder="20" position="absolute 647 252 723 273" anchor="top right" index="-1" value="0" class="cmb_WF_Essential"/>
        <Static id="Static43" text="검사구분" class="sta_WFDA_Label01" position="absolute 551 275 645 302" anchor="top right"/>
        <Combo id="cbo_insptClass" taborder="25" position="absolute 647 278 700 299" anchor="top right" index="-1" class="cmb_WF_Essential"/>
        <Static id="Static44" text="검사용도(목적)" class="sta_WFDA_Label01" position="absolute 702 275 796 302" anchor="top right"/>
        <Combo id="cbo_insptPurp1" taborder="26" position="absolute 798 278 942 299" anchor="top right" index="-1" class="cmb_WF_Essential"/>
        <Button id="btn_searchSpecmPop" taborder="68" class="btn_WF_popSearch" position="absolute 1213 200 1234 221" anchor="top right" onclick="btn_searchSpecmPop_onclick"/>
        <Static id="Static45" class="sta_WFDA_Labelbg" position="absolute 1660 556 2346 583" anchor="top right" visible="false"/>
        <Static id="Static46" text="검사분류" class="sta_WFDA_Label01" position="absolute 1660 556 1754 583" anchor="top right" visible="false"/>
        <CheckBox id="chk_legalBasis" taborder="48" text="법적기준" position="absolute 1756 559 1829 579" enable="false" truevalue="1" falsevalue="0" anchor="top right" readonly="false" visible="false"/>
        <CheckBox id="chk_insideBasis" taborder="49" text="내부기준" position="absolute 1836 559 1909 579" enable="false" falsevalue="0" truevalue="1" anchor="top right" readonly="false" visible="false"/>
        <Static id="Static48" class="sta_WFDA_Labelbg" position="absolute 1660 582 2346 609" anchor="top right" visible="false"/>
        <Static id="Static50" text="위해등급" class="sta_WFDA_Label01" position="absolute 1836 582 1930 609" anchor="top right" enable="true" visible="false"/>
        <CheckBox id="chk_micbio1Grade" taborder="52" text="1등급" position="absolute 1932 585 2005 605" enable="false" falsevalue="0" truevalue="1" anchor="top right" readonly="false" visible="false"/>
        <CheckBox id="chk_micbio2Grade" taborder="53" text="2등급" position="absolute 1988 585 2061 605" enable="false" anchor="top right" readonly="false" falsevalue="0" truevalue="1" visible="false"/>
        <CheckBox id="chk_micbio3Grade" taborder="54" text="3등급" position="absolute 2044 585 2117 605" enable="false" anchor="top right" readonly="false" falsevalue="0" truevalue="1" visible="false"/>
        <CheckBox id="chk_micbio4Grade" taborder="55" text="4등급" position="absolute 2100 585 2173 605" enable="false" anchor="top right" readonly="false" falsevalue="0" truevalue="1" visible="false"/>
        <CheckBox id="chk_micbio5Grade" taborder="56" text="5등급" position="absolute 2156 585 2229 605" enable="false" value="false" anchor="top right" readonly="false" falsevalue="0" truevalue="1" visible="false"/>
        <Static id="Static51" class="sta_WFDA_Labelbg" position="absolute 551 301 1237 328" anchor="top right"/>
        <Static id="Static52" text="검사대상" class="sta_WFDA_Label01" position="absolute 551 301 645 328" anchor="top right"/>
        <Combo id="cbo_insptObj1" taborder="29" position="absolute 647 304 787 325" anchor="top right" index="-1" class="cmb_WF_Essential"/>
        <Combo id="cbo_insptObj2" taborder="30" position="absolute 789 304 929 325" anchor="top right" index="-1" class="cmb_WF_Essential"/>
        <Combo id="cbo_insptObj3" taborder="31" position="absolute 931 304 1071 325" anchor="top right" index="0" value="0" text="이슈(기획)" class="cmb_WF_Essential"/>
        <Combo id="cbo_insptObj4" taborder="32" position="absolute 1073 304 1234 325" anchor="top right"/>
        <Static id="Static53" class="sta_WFDA_Labelbg" position="absolute 551 327 1237 354" anchor="top right"/>
        <Static id="Static54" text="긴급여부" class="sta_WFDA_Label01" position="absolute 551 327 645 354" anchor="top right"/>
        <Static id="Static55" text="유통업체" class="sta_WFDA_Label01" position="absolute 788 327 882 354" anchor="top right"/>
        <Static id="Static56" text="접수시품온" class="sta_WFDA_Label01" position="absolute 1689 384 1783 411" anchor="top right" visible="false"/>
        <Edit id="edt_acceptcityTempr" taborder="35" position="absolute 1785 387 1881 408" anchor="top right" visible="false"/>
        <Edit id="edt_dtrVendor" taborder="34" position="absolute 884 330 1024 351" anchor="top right"/>
        <Static id="Static57" class="sta_WFDA_Labelbg" position="absolute 551 353 1237 380" anchor="top right"/>
        <Static id="Static58" text="규격" class="sta_WFDA_Label01" position="absolute 551 353 645 380" anchor="top right"/>
        <Edit id="edt_stand" taborder="36" position="absolute 647 356 722 377" anchor="top right"/>
        <Static id="Static59" text="단위" class="sta_WFDA_Label01" position="absolute 724 353 818 380" anchor="top right"/>
        <Static id="Static60" text="원산지" class="sta_WFDA_Label01" position="absolute 874 353 968 380" anchor="top right"/>
        <Edit id="edt_unit" taborder="37" position="absolute 820 356 872 377" anchor="top right"/>
        <Static id="Static61" text="보관기준" class="sta_WFDA_Label01" position="absolute 1737 410 1831 437" anchor="top right" visible="false"/>
        <Static id="Static62" class="sta_WFDA_Labelbg" position="absolute 551 379 1237 406" anchor="top right"/>
        <Static id="Static65" text="제조일자" class="sta_WFDA_Label01" position="absolute 551 379 645 406" anchor="top right"/>
        <Static id="Static66" text="유통기한" class="sta_WFDA_Label01" position="absolute 761 379 855 406" anchor="top right"/>
        <Edit id="edt_dtrlimtMts" taborder="42" position="absolute 962 382 1006 403" anchor="top right"/>
        <Static id="Static63" text="개월" position="absolute 1009 387 1035 400" anchor="top right"/>
        <Edit id="edt_dtrlimtDd" taborder="43" position="absolute 1035 382 1063 403" anchor="top right"/>
        <Static id="Static64" text="일" position="absolute 1066 387 1092 400" anchor="top right"/>
        <Combo id="cbo_chargBasis" taborder="39" index="-1" position="absolute 1833 413 1897 434" anchor="top right" visible="false"/>
        <Static id="Static69" class="sta_WFDA_Labelbg" position="absolute 551 431 1237 458" anchor="top right"/>
        <Static id="Static70" text="검체입고시&#13;&#10;세부사항" class="sta_WFDA_Label01" position="absolute 551 431 645 458" anchor="top right"/>
        <Static id="Static72" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 1653 524 2103 539" anchor="top right"/>
        <Static id="Static74" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 1653 551 2103 556" anchor="top right"/>
        <Static id="Static76" class="sta_WFDA_Labelbg" position="absolute 644 223 1237 250" anchor="top right"/>
        <Static id="Static68" text="검체유형" class="sta_WFDA_Label01" position="absolute 551 223 645 250" anchor="top right"/>
        <Combo id="cbo_specmType" taborder="17" innerdataset="@ds_specmType" codecolumn="code" index="-1" position="absolute 647 226 723 247" anchor="top right" class="cmb_WF_Essential" datacolumn="codeName"/>
        <Edit id="edt_specmTypeNm" taborder="18" position="absolute 725 226 920 247" anchor="top right" enable="true" class="edt_WF_Essential"/>
        <Static id="Static67" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 450 450 465" anchor="left top"/>
        <Static id="Static75" text="적용기준규격 및 시험항목" class="sta_WF_Title01" position="absolute 0 469 450 487" anchor="left top"/>
        <Static id="Static77" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 482 450 487" anchor="left top"/>
        <Grid id="grd_testArticleList" taborder="69" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 0 487 1237 705" anchor="all" binddataset="ds_testArticleList" autofittype="none" onexpanddown="grd_testArticleList_onexpanddown" fillareatype="none" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" onheadclick="grd_testArticleList_onheadclick" oncellclick="grd_testArticleList_oncellclick" oncelldblclick="grd_testArticleList_oncelldblclick" selecttype="row" onenterdown="grd_testArticleList_onenterdown" onkeyup="grd_testArticleList_onkeyup">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="44"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="94"/>
                <Column size="200"/>
                <Column size="67"/>
                <Column size="65"/>
                <Column size="69"/>
                <Column size="0"/>
                <Column size="73"/>
                <Column size="160"/>
                <Column size="25"/>
                <Column size="80"/>
                <Column size="25"/>
                <Column size="80"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="20"/>
                <Column size="120"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="bind:seqNum"/>
                <Cell col="2" class="grd_WF_Essential" text="검체유형구분"/>
                <Cell col="3" text="검체번호"/>
                <Cell col="4" text="코드"/>
                <Cell col="5" class="grd_WF_Essential" text="시험항목"/>
                <Cell col="6" class="grd_WF_Essential" text="법적기준"/>
                <Cell col="7" class="grd_WF_Essential" text="내부기준"/>
                <Cell col="8" text="검사분야"/>
                <Cell col="9" text="소요기간"/>
                <Cell col="10" text="부적합분류"/>
                <Cell col="11" text="기준 규격"/>
                <Cell col="12" displaytype="checkbox" edittype="checkbox" taborder="undefined"/>
                <Cell col="13" displaytype="normal" edittype="none" style="line: ;" class="grd_WF_Essential" text="식약처수수료" taborder="undefined"/>
                <Cell col="14" colspan="2" text="내부수수료" taborder="undefined"/>
                <Cell col="16" colspan="2" text="수수료3" taborder="undefined"/>
                <Cell col="18" colspan="2" text="수수료4" taborder="undefined"/>
                <Cell col="20" colspan="2" text="수수료5" taborder="undefined"/>
                <Cell col="22" displaytype="checkbox"/>
                <Cell col="23" class="grd_WF_Essential" text="검사자"/>
                <Cell col="24" displaytype="checkbox"/>
                <Cell col="25" class="grd_WF_Essential" text="검사방법"/>
                <Cell col="26" text="지시사항"/>
                <Cell col="27" text="시험구분"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" text="bind:seqNum"/>
                <Cell col="2" displaytype="combo" text="bind:specmType" combodataset="ds_specmType" combocodecol="code" combodatacol="codeName"/>
                <Cell col="3" text="bind:seqNum"/>
                <Cell col="4" text="bind:articleCd"/>
                <Cell col="5" displaytype="text" edittype="normal" text="bind:articleNm" expandshow="show" expandsize="21"/>
                <Cell col="6" displaytype="checkbox" edittype="checkbox" text="bind:legalBasis"/>
                <Cell col="7" displaytype="checkbox" edittype="checkbox" text="bind:insideBasis"/>
                <Cell col="8" displaytype="combo" text="bind:insptFld" combodataset="ds_insptFld" combocodecol="code" combodatacol="codeName"/>
                <Cell col="9" text="bind:takeTerm"/>
                <Cell col="10" displaytype="combo" text="bind:notFitClsfi" combodataset="ds_notFitClsfi" combocodecol="code" combodatacol="codeName"/>
                <Cell col="11" displaytype="text" edittype="none" style="align: ;" text="bind:basisStand" combodataset="ds_검체물성" combocodecol="cd" combodatacol="cdNm"/>
                <Cell col="12" displaytype="checkbox" edittype="checkbox" class="radio" text="bind:comm1UseYn"/>
                <Cell col="13" displaytype="number" edittype="none" text="bind:comm1" mask="@,@@@" editdisplay="edit" editlimitbymask="decimal"/>
                <Cell col="14" displaytype="checkbox" edittype="checkbox" class="radio" text="bind:comm2UseYn"/>
                <Cell col="15" displaytype="number" edittype="none" text="bind:comm2" mask="@,@@@" editdisplay="edit" editlimitbymask="decimal"/>
                <Cell col="16" displaytype="checkbox" edittype="checkbox" class="radio" text="N"/>
                <Cell col="17" displaytype="number" edittype="none" text="0" mask="@,@@@" editdisplay="edit" editlimitbymask="decimal"/>
                <Cell col="18" displaytype="checkbox" edittype="checkbox" class="radio" text="N"/>
                <Cell col="19" displaytype="number" edittype="none" text="0" mask="@,@@@" editdisplay="edit" editlimitbymask="decimal"/>
                <Cell col="20" displaytype="checkbox" edittype="checkbox" class="radio" text="N"/>
                <Cell col="21" displaytype="number" edittype="none" text="0" mask="@,@@@" editdisplay="edit" editlimitbymask="decimal"/>
                <Cell col="22" colspan="2" celltype="none" displaytype="combo" edittype="combo" text="bind:sabun" editautoselect="true" editautoskip="false" taborder="undefined" combodataset="ds_insptUser" combocodecol="sabun" combodatacol="userNm" combotype="filter"/>
                <Cell col="24" colspan="2" displaytype="combo" edittype="combo" text="bind:insptMethod" taborder="undefined" combodataset="ds_insptMethod" combocodecol="code" combodatacol="codeName"/>
                <Cell col="26" displaytype="text" edittype="text" style="align: ;" text="bind:jobOrder"/>
                <Cell col="27" text="bind:testClass"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_addSpecm" taborder="70" text="검체정보입력" class="btn_WF_Function" position="absolute 1057 172 1146 192" anchor="top right" onclick="btn_addSpecm_onclick"/>
        <Static id="Static81" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1055 170 1057 190" anchor="top right"/>
        <Static id="Static78" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 757 483 1237 488" anchor="top right" positionstep="0"/>
        <Static id="Static79" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 2288 637 2346 643" anchor="top right" positionstep="0"/>
        <Button id="btn_addTestArticle" taborder="63" class="btn_WF_GrdPlus" position="absolute 1199 463 1217 483" anchor="top right" positionstep="0" tooltiptext="추가" onclick="btn_addTestArticle_onclick"/>
        <Button id="btn_delTestArticle" taborder="64" class="btn_WF_GrdMinus" position="absolute 1219 463 1237 483" anchor="top right" positionstep="0" tooltiptext="삭제" onclick="btn_delTestArticle_onclick"/>
        <Static id="Static80" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1217 463 1219 483" anchor="top right"/>
        <Static id="Static73" text="검사정보 및 위험도등급" class="sta_WF_Title02" position="absolute 1654 539 2104 557" anchor="top right" visible="false"/>
        <Static id="Static83" text="장기보존여부" class="sta_WFDA_Label01" position="absolute 725 249 819 276" anchor="top right"/>
        <Combo id="cbo_longstorageYn" taborder="23" index="-1" position="absolute 821 252 1234 273" anchor="top right"/>
        <Static id="Static84" text="검체물성" class="sta_WFDA_Label01" position="absolute 1388 280 1490 307" anchor="top right" visible="false"/>
        <Combo id="cbo_specmWtrlstNm" taborder="21" index="-1" position="absolute 1492 283 1603 304" anchor="top right" visible="false"/>
        <Static id="Static87" text="채취상태" class="sta_WFDA_Label01" position="absolute 1605 280 1699 307" anchor="top right" visible="false"/>
        <Static id="Static88" text="검사전검체상태" class="sta_WFDA_Label01" position="absolute 1710 306 1812 333" anchor="top right" visible="false"/>
        <Combo id="cbo_pickStatus" taborder="22" index="-1" position="absolute 1701 283 1897 304" anchor="top right" visible="false"/>
        <Combo id="cbo_insptbeforeSpecmStatus" taborder="24" index="-1" position="absolute 1814 309 1897 330" anchor="top right" visible="false"/>
        <Static id="Static47" text="검사분야1" class="sta_WFDA_Label01" position="absolute 1660 582 1754 609" anchor="top right" visible="false"/>
        <Static id="Static85" class="sta_WFDA_Labelbg" position="absolute 1660 608 2346 635" anchor="top right" visible="false"/>
        <Static id="Static91" text="위해등급" class="sta_WFDA_Label01" position="absolute 1836 608 1930 635" anchor="top right" visible="false"/>
        <CheckBox id="chk_phychem1Grade" taborder="57" text="1등급" position="absolute 1932 611 2005 631" enable="false" falsevalue="0" truevalue="1" anchor="top right" readonly="false" visible="false"/>
        <CheckBox id="chk_phychem2Grade" taborder="58" text="2등급" position="absolute 1988 611 2061 631" enable="false" falsevalue="0" truevalue="1" anchor="top right" readonly="false" visible="false"/>
        <CheckBox id="chk_phychem3Grade" taborder="59" text="3등급" position="absolute 2044 611 2117 631" enable="false" falsevalue="0" truevalue="1" anchor="top right" readonly="false" visible="false"/>
        <CheckBox id="chk_phychem4Grade" taborder="60" text="4등급" position="absolute 2100 611 2173 631" enable="false" value="false" falsevalue="0" truevalue="1" anchor="top right" readonly="false" visible="false"/>
        <CheckBox id="chk_phychem5Grade" taborder="61" text="5등급" position="absolute 2156 611 2229 631" enable="false" falsevalue="0" truevalue="1" anchor="top right" readonly="false" visible="false"/>
        <Static id="Static92" text="검사분야2" class="sta_WFDA_Label01" position="absolute 1660 608 1754 635" anchor="top right" visible="false"/>
        <Static id="Static01" text="검체유형세부" class="sta_WFDA_Label01" position="absolute 942 223 1036 250" anchor="top right"/>
        <Edit id="edt_specmTypePclsNm" taborder="19" position="absolute 1260 248 1436 269" anchor="top right" tooltiptext="검체유형세부" readonly="true" visible="false"/>
        <Button id="btn_searchSpecmTypePclsPop" taborder="71" class="btn_WF_popSearch" position="absolute 1435 248 1456 269" anchor="top right" onclick="btn_searchSpecmTypePclsPop_onclick" visible="false"/>
        <Combo id="cbo_specmClass" taborder="15" index="-1" position="absolute 1038 200 1105 221" anchor="top right" class="cmb_WF_Essential" innerdataset="@ds_specmClass" datacolumn="codeName" codecolumn="code" onitemchanged="cbo_specmClass_onitemchanged"/>
        <Button id="btn_coppySpecm" taborder="72" text="검체정보복사" class="btn_WF_Function" position="absolute 969 172 1055 192" anchor="top right" onclick="btn_coppySpecm_onclick"/>
        <CheckBox id="chk_micbio" taborder="50" text="미생물" position="absolute 1756 585 1829 605" enable="false" falsevalue="0" truevalue="1" anchor="top right" readonly="false" visible="false"/>
        <CheckBox id="chk_phychem" taborder="51" text="이화학" position="absolute 1756 611 1829 631" enable="false" falsevalue="0" truevalue="1" anchor="top right" readonly="false" visible="false"/>
        <Static id="Static02" class="Guide01_AreaRed" visible="false" position="absolute 1006 382 1010 403" anchor="top right"/>
        <Static id="Static12" class="Guide01_AreaRed" visible="false" position="absolute 1063 382 1067 403" anchor="top right"/>
        <Static id="Static15" class="Guide01_AreaRed" visible="false" position="absolute 1031 382 1035 403" anchor="top right"/>
        <Static id="Static16" text="성적서발급" class="sta_WFDA_Label01" position="absolute 1059 107 1133 134" anchor="left top"/>
        <Static id="Static17" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 967 170 969 190" anchor="top right"/>
        <Button id="btn_addEtcSpecm" taborder="73" text="입력검체등록" class="btn_WF_Function" position="absolute 881 172 967 192" anchor="top right" onclick="btn_addEtcSpecm_onclick"/>
        <Static id="Static13" text="의뢰자&#13;&#10;전화번호" class="sta_WFDA_Label01" position="absolute 461 106 530 133" anchor="left top"/>
        <TelephoneComponent id="edt_reqUserTelno" titletext="전화번호Component(전화번호,휴대폰 번호-개인정보보안적용컴포넌트)" taborder="10" text="TelephoneComponent00" position="absolute 531 110 671 132" bindDataset="ds_testReqAccept" bindTelNo1Column="reqUserTelno1" bindTelNo2Column="reqUserTelno2" bindTelNo3Column="reqUserTelno3"/>
        <Static id="Static25" text="의뢰자명" class="sta_WFDA_Label01" position="absolute 247 107 316 134" anchor="left top"/>
        <Edit id="edt_reqUserNm" taborder="7" class="edt_WF_Essential" position="absolute 318 110 460 131" anchor="left top" imemode="hangul"/>
        <Static id="Static86" class="sta_WFDA_Labelbg" position="absolute 1 132 1237 170" anchor="left top right"/>
        <Static id="Static22" text="의뢰자비고" class="sta_WFDA_Label01" position="absolute 0 132 94 170" anchor="left top"/>
        <TextArea id="txt_reqUserRemark" taborder="12" scrollbars="fixedvert" wordwrap="word" position="absolute 96 134 655 168" anchor="left top"/>
        <Static id="Static89" text="시험항목에 대한 검사정보 및 위험도등급 요약 입니다." class="sta_WF_DiscInfo" position="absolute 2003 538 2345 553" anchor="top right" visible="false"/>
        <Button id="btn_buyHistory" taborder="74" text="구매이력정보" class="btn_WF_Function" position="absolute 793 172 879 192" anchor="top right" onclick="btn_buyHistory_onclick"/>
        <Static id="Static90" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 879 170 881 190" anchor="top right"/>
        <Edit id="edt_origin" taborder="38" position="absolute 970 356 1072 377" anchor="top right"/>
        <Combo id="cbo_insptPurp2" taborder="27" index="-1" class="cmb_WF_Essential" position="absolute 944 278 1085 299" anchor="top right"/>
        <Combo id="cbo_insptPurp3" taborder="28" index="-1" class="cmb_WF_Essential" position="absolute 1087 278 1234 299" anchor="top right"/>
        <Button id="btn_searchSpecmTypePop" taborder="75" class="btn_WF_popSearch" position="absolute 919 226 940 247" anchor="top right" onclick="btn_searchSpecmTypePop_onclick"/>
        <Grid id="grd_specmArticleList" taborder="76" binddataset="ds_specmArticleList" autoenter="select" useinputpanel="false" cellsizingtype="col" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" position="absolute 0 197 541 458" anchor="left top right" oncellclick="grd_specmArticleList_oncellclick" onheadclick="grd_specmArticleList_onheadclick" onkeyup="grd_specmArticleList_onkeyup" onenterdown="grd_specmArticleList_onenterdown">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="39"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="100"/>
                <Column size="87"/>
                <Column size="284"/>
                <Column size="78"/>
                <Column size="97"/>
                <Column size="94"/>
                <Column size="94"/>
                <Column size="94"/>
                <Column size="207"/>
                <Column size="114"/>
                <Column size="114"/>
                <Column size="114"/>
                <Column size="114"/>
                <Column size="115"/>
                <Column size="117"/>
                <Column size="84"/>
                <Column size="84"/>
                <Column size="40"/>
                <Column size="40"/>
                <Column size="300"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell style="align: ;" class="head_Excel"/>
                <Cell col="1"/>
                <Cell col="2" text="검체번호"/>
                <Cell col="3" text="접수번호"/>
                <Cell col="4" text="검체코드"/>
                <Cell col="5" text="검체명"/>
                <Cell col="6" text="비용"/>
                <Cell col="7" text="검사구분"/>
                <Cell col="8" text="검사용도1"/>
                <Cell col="9" text="검사용도2"/>
                <Cell col="10" text="검사용도3"/>
                <Cell col="11" text="장기보존여부"/>
                <Cell col="12" text="검사대상1"/>
                <Cell col="13" text="검사대상2"/>
                <Cell col="14" text="검사대상3"/>
                <Cell col="15" text="검사대상4"/>
                <Cell col="16" text="제조업체"/>
                <Cell col="17" text="유통업체"/>
                <Cell col="18" text="제조일자"/>
                <Cell col="19" colspan="3" text="유통기한" taborder="undefined"/>
                <Cell col="22" text="검체입고시세부사항"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" text="bind:seqNum"/>
                <Cell col="2" text="bind:seqNum"/>
                <Cell col="3" text="bind:acceptNum"/>
                <Cell col="4" text="bind:specmCd"/>
                <Cell col="5" displaytype="text" text="bind:specmNm"/>
                <Cell col="6" displaytype="combo" edittype="none" text="bind:costClass" combodataset="ds_costClass" combocodecol="code" combodatacol="codeName"/>
                <Cell col="7" displaytype="combo" text="bind:insptClass" combodataset="ds_insptClass" combocodecol="code" combodatacol="codeName"/>
                <Cell col="8" displaytype="combo" text="bind:insptPurp1" combodataset="ds_insptPurp1" combocodecol="code" combodatacol="codeName"/>
                <Cell col="9" displaytype="combo" text="bind:insptPurp2" combodataset="ds_insptPurp2" combocodecol="code" combodatacol="codeName"/>
                <Cell col="10" displaytype="combo" text="bind:insptPurp3" combodataset="ds_insptPurp3" combocodecol="code" combodatacol="codeName"/>
                <Cell col="11" displaytype="combo" text="bind:longstorageYn" combodataset="ds_longstorageYn" combocodecol="code" combodatacol="codeName"/>
                <Cell col="12" displaytype="combo" text="bind:insptObj1" combodataset="ds_insptObj1" combocodecol="code" combodatacol="codeName"/>
                <Cell col="13" displaytype="combo" text="bind:insptObj2" combodataset="ds_insptObj2" combocodecol="code" combodatacol="codeName"/>
                <Cell col="14" displaytype="combo" text="bind:insptObj3" combodataset="ds_insptObj3" combocodecol="code" combodatacol="codeName"/>
                <Cell col="15" displaytype="combo" text="bind:insptObj4" combodataset="ds_insptObj4" combocodecol="code" combodatacol="codeName"/>
                <Cell col="16" text="bind:mfgwon"/>
                <Cell col="17" text="bind:dtrVendor"/>
                <Cell col="18" displaytype="date" text="bind:mfgdd" calendardisplaynulltype="none"/>
                <Cell col="19" displaytype="date" text="bind:dtrlimt" calendardisplaynulltype="none"/>
                <Cell col="20" text="bind:dtrlimtMts"/>
                <Cell col="21" text="bind:dtrlimtDd"/>
                <Cell col="22" displaytype="text" style="align:left;" text="bind:specmDeliverPclsfact"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <ObjCalendar id="cal_mfgdd" anchor="top right" titletext="캘린더" taborder="40" text="ObjCalendar00" scrollbars="none" position="absolute 647 382 759 403"/>
        <ObjCalendar id="cal_dtrlimt" anchor="top right" titletext="캘린더" taborder="41" text="ObjCalendar00" scrollbars="none" position="absolute 857 382 960 403"/>
        <Static id="Static95" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1197 463 1199 483" anchor="top right"/>
        <Button id="btn_selectTestArticle" taborder="62" text="매핑시험항목조회" class="btn_WF_Function" position="absolute 1092 463 1197 483" anchor="top right" onclick="btn_selectTestArticle_onclick"/>
        <ObjCalendar id="cal_acceptdd" anchor="top right" titletext="캘린더" taborder="14" text="ObjCalendar00" scrollbars="none" position="absolute 844 200 940 221" enable="true"/>
        <ObjCalendar id="cal_reqDate" anchor="left top" titletext="캘린더" taborder="1" text="ObjCalendar00" scrollbars="none" position="absolute 301 50 405 71"/>
        <Static id="Static96" text="시험항목은 중복될 수 없습니다." class="sta_WF_DiscPoint" position="absolute 222 470 436 485" anchor="left top"/>
        <Static id="Static97" text="검체목록은 중복될 수 없습니다." class="sta_WF_DiscPoint" position="absolute 113 179 367 194" anchor="left top"/>
        <Static id="sta_orgNm" position="absolute 189 84 1120 106" anchor="default"/>
        <Static id="Static98" text="의뢰업장 조직 : " position="absolute 97 87 190 104"/>
        <Static id="Static100" text="의뢰업체정보가 [외부]면서 업장구분이 [식재영업/계열사/협력업체]인 경우에 매출처리 됩니다." class="sta_WF_DiscInfo" position="absolute 93 30 688 45" anchor="left top"/>
        <Static id="Static21" text="내/외부 구분" class="sta_WFDA_Label01" position="absolute 882 107 970 134" anchor="left top"/>
        <Combo id="cbo_insideExtrClass" taborder="9" index="-1" class="cmb_WF_Essential" position="absolute 973 110 1057 131" anchor="left top"/>
        <Static id="Static101" text="업장 구분" class="sta_WFDA_Label01" position="absolute 676 107 748 134" anchor="left top"/>
        <Edit id="edt_acceptClassNm" taborder="79" readonly="true" position="absolute 752 110 880 131" anchor="left top"/>
        <Static id="Static102" text="℃" position="absolute 1884 392 1894 405" anchor="top right" visible="false"/>
        <Edit id="edt_specmDeliverPclsfact" taborder="47" position="absolute 647 434 1234 455" anchor="top right"/>
        <Static id="Static99" class="sta_WFDA_Labelbg" position="absolute 551 405 1237 432" anchor="top right"/>
        <Static id="Static103" text="제조업체" class="sta_WFDA_Label01" position="absolute 551 405 645 432" anchor="top right"/>
        <Static id="Static104" text="제조국가" class="sta_WFDA_Label01" position="absolute 788 405 882 432" anchor="top right"/>
        <Static id="Static105" text="제조소재지" class="sta_WFDA_Label01" position="absolute 1651 462 1745 489" anchor="top right" visible="false"/>
        <Edit id="edt_mfgNation" taborder="45" position="absolute 884 408 986 429" anchor="top right"/>
        <Edit id="edt_mfgLocation" taborder="46" position="absolute 1747 465 1897 486" anchor="top right" visible="false"/>
        <Edit id="edt_mfgwon" taborder="44" position="absolute 647 408 786 429" anchor="top right"/>
        <Combo id="cbo_urgentYn" taborder="80" value="0" innerdataset="@ds_urgentYn" codecolumn="code" datacolumn="codeName" position="absolute 647 330 786 351" anchor="top right"/>
        <Static id="Static94" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 873 101 1237 106" anchor="top right"/>
        <Button id="btn_preAcceptReqInfoPop" taborder="81" text="기 접수내역 조회" class="btn_WF_Function" position="absolute 1128 81 1237 101" anchor="top right" visible="false" onclick="btn_preAcceptReqInfoPop_onclick"/>
        <Static id="Static109" text="(반드시 매출거래처로 등록되어야 함)" position="absolute 685 28 904 47" anchor="left top" style="color:red;font:arial,9,bold;"/>
        <Static id="Static106" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1090 463 1092 483" anchor="top right"/>
        <Button id="btn_selectSpecmTest" taborder="82" text="검체시험항목조회" class="btn_WF_Function" position="absolute 985 463 1090 483" anchor="top right" onclick="btn_selectSpecmTest_onclick"/>
        <Combo id="cbo_specmTypePcls" taborder="83" position="absolute 1038 226 1234 247" anchor="top right" innerdataset="@ds_specmTypePcls" datacolumn="codeName" codecolumn="code"/>
        <Static id="Static107" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1169 51 1171 71" anchor="top right"/>
        <Button id="btn_saveTemp" taborder="84" class="btn_WF_Function" position="absolute 1171 51 1237 71" anchor="top right" text="임시저장" onclick="btn_saveTemp_onclick"/>
        <Button id="btn_loadTemp" taborder="85" text="불러오기" class="btn_WF_Function" position="absolute 1103 51 1169 71" anchor="top right" onclick="btn_loadTemp_onclick"/>
        <Button id="btn_excelUpload" taborder="86" text="엑셀등록" onclick="tab_resultList_tabpage_btn_excelUpload_onclick" class="btn_WF_Function" position="absolute 727 172 792 192" anchor="top right"/>
        <Static id="Static82" text="상신 유형" class="sta_WFDA_Label01" position="absolute 840 47 928 74" anchor="left top"/>
        <Combo id="cbo_approvalClass" taborder="87" index="-1" class="cmb_WF_Essential" position="absolute 931 50 1048 71" anchor="left top"/>
        <Combo id="cbo_inspectRptIssue" taborder="88" class="cmb_WF_Essential" position="absolute 1137 110 1233 131" anchor="left top"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item0" compid="txt_reqUserRemark" propid="value" datasetid="ds_testReqAccept" columnid="reqUserRemark"/>
      <BindItem id="item2" compid="edt_acceptNum" propid="value" datasetid="ds_specmArticleList" columnid="acceptNum"/>
      <BindItem id="item4" compid="edt_specmNm" propid="value" datasetid="ds_specmArticleList" columnid="specmNm"/>
      <BindItem id="item6" compid="cbo_insptPurp1" propid="value" datasetid="ds_specmArticleList" columnid="insptPurp1"/>
      <BindItem id="item7" compid="cbo_insptClass" propid="value" datasetid="ds_specmArticleList" columnid="insptClass"/>
      <BindItem id="item8" compid="cbo_costClass" propid="value" datasetid="ds_specmArticleList" columnid="costClass"/>
      <BindItem id="item5" compid="cbo_insptObj1" propid="value" datasetid="ds_specmArticleList" columnid="insptObj1"/>
      <BindItem id="item11" compid="cbo_specmType" propid="value" datasetid="ds_specmArticleList" columnid="specmType"/>
      <BindItem id="item10" compid="edt_specmTypeNm" propid="value" datasetid="ds_specmArticleList" columnid="specmTypeNm"/>
      <BindItem id="item13" compid="edt_specmTypePclsNm" propid="value" datasetid="ds_specmArticleList" columnid="specmTypePclsNm"/>
      <BindItem id="item12" compid="edt_origin" propid="value" datasetid="ds_specmArticleList" columnid="origin"/>
      <BindItem id="item14" compid="cbo_insptPurp2" propid="value" datasetid="ds_specmArticleList" columnid="insptPurp2"/>
      <BindItem id="item15" compid="cbo_insptPurp3" propid="value" datasetid="ds_specmArticleList" columnid="insptPurp3"/>
      <BindItem id="item23" compid="cal_mfgdd" propid="text" datasetid="ds_specmArticleList" columnid="mfgdd"/>
      <BindItem id="item9" compid="cal_dtrlimt" propid="text" datasetid="ds_specmArticleList" columnid="dtrlimt"/>
      <BindItem id="item17" compid="cbo_specmClass" propid="value" datasetid="ds_specmArticleList" columnid="specmClass"/>
      <BindItem id="item18" compid="cbo_longstorageYn" propid="value" datasetid="ds_specmArticleList" columnid="longstorageYn"/>
      <BindItem id="item19" compid="cbo_insptObj2" propid="value" datasetid="ds_specmArticleList" columnid="insptObj2"/>
      <BindItem id="item20" compid="cbo_insptObj3" propid="value" datasetid="ds_specmArticleList" columnid="insptObj3"/>
      <BindItem id="item21" compid="cbo_insptObj4" propid="value" datasetid="ds_specmArticleList" columnid="insptObj4"/>
      <BindItem id="item22" compid="edt_mfgwon" propid="value" datasetid="ds_specmArticleList" columnid="mfgwon"/>
      <BindItem id="item24" compid="edt_dtrVendor" propid="value" datasetid="ds_specmArticleList" columnid="dtrVendor"/>
      <BindItem id="item25" compid="edt_acceptcityTempr" propid="value" datasetid="ds_specmArticleList" columnid="acceptcityTempr"/>
      <BindItem id="item26" compid="edt_stand" propid="value" datasetid="ds_specmArticleList" columnid="stand"/>
      <BindItem id="item27" compid="edt_unit" propid="value" datasetid="ds_specmArticleList" columnid="unit"/>
      <BindItem id="item28" compid="cbo_chargBasis" propid="value" datasetid="ds_specmArticleList" columnid="chargBasis"/>
      <BindItem id="item29" compid="edt_dtrlimtMts" propid="value" datasetid="ds_specmArticleList" columnid="dtrlimtMts"/>
      <BindItem id="item30" compid="edt_dtrlimtDd" propid="value" datasetid="ds_specmArticleList" columnid="dtrlimtDd"/>
      <BindItem id="item31" compid="cbo_specmWtrlstNm" propid="value" datasetid="ds_specmArticleList" columnid="specmWtrlstNm"/>
      <BindItem id="item32" compid="cbo_pickStatus" propid="value" datasetid="ds_specmArticleList" columnid="pickStatus"/>
      <BindItem id="item33" compid="cbo_insptbeforeSpecmStatus" propid="value" datasetid="ds_specmArticleList" columnid="insptbeforeSpecmStatus"/>
      <BindItem id="item3" compid="cal_acceptdd" propid="text" datasetid="ds_specmArticleList" columnid="acceptdd"/>
      <BindItem id="item34" compid="cal_reqDate" propid="text" datasetid="ds_testReqAccept" columnid="reqDate"/>
      <BindItem id="item35" compid="edt_reqNum" propid="value" datasetid="ds_testReqAccept" columnid="reqNum"/>
      <BindItem id="item36" compid="edt_acceptnm" propid="value" datasetid="ds_testReqAccept" columnid="acceptnm"/>
      <BindItem id="item37" compid="edt_upjangNm" propid="value" datasetid="ds_testReqAccept" columnid="upjangNm"/>
      <BindItem id="item38" compid="edt_ceo" propid="value" datasetid="ds_testReqAccept" columnid="ceo"/>
      <BindItem id="item39" compid="edt_bizNo" propid="value" datasetid="ds_testReqAccept" columnid="bizNo"/>
      <BindItem id="item40" compid="edt_pclsUpjangNm" propid="value" datasetid="ds_testReqAccept" columnid="pclsUpjangNm"/>
      <BindItem id="item41" compid="edt_reqUserNm" propid="value" datasetid="ds_testReqAccept" columnid="reqUserNm"/>
      <BindItem id="item42" compid="edt_reqUserEmail" propid="value" datasetid="ds_testReqAccept" columnid="reqUserEmail"/>
      <BindItem id="item43" compid="cbo_insideExtrClass" propid="value" datasetid="ds_testReqAccept" columnid="insideExtrClass"/>
      <BindItem id="item44" compid="edt_reqUserTelno" propid="text" datasetid="ds_testReqAccept" columnid="reqUserTelno"/>
      <BindItem id="item60" compid="chk_legalBasis" propid="value" datasetid="ds_specmArticleList" columnid="legalBasis"/>
      <BindItem id="item46" compid="chk_insideBasis" propid="value" datasetid="ds_specmArticleList" columnid="insideBasis"/>
      <BindItem id="item47" compid="chk_micbio" propid="value" datasetid="ds_specmArticleList" columnid="micbio"/>
      <BindItem id="item61" compid="chk_phychem" propid="value" datasetid="ds_specmArticleList" columnid="phychem"/>
      <BindItem id="item48" compid="chk_micbio1Grade" propid="value" datasetid="ds_specmArticleList" columnid="micbio1Grade"/>
      <BindItem id="item49" compid="chk_micbio2Grade" propid="value" datasetid="ds_specmArticleList" columnid="micbio2Grade"/>
      <BindItem id="item50" compid="chk_micbio3Grade" propid="value" datasetid="ds_specmArticleList" columnid="micbio3Grade"/>
      <BindItem id="item62" compid="chk_micbio4Grade" propid="value" datasetid="ds_specmArticleList" columnid="micbio4Grade"/>
      <BindItem id="item63" compid="chk_micbio5Grade" propid="value" datasetid="ds_specmArticleList" columnid="micbio5Grade"/>
      <BindItem id="item64" compid="chk_phychem1Grade" propid="value" datasetid="ds_specmArticleList" columnid="phychem1Grade"/>
      <BindItem id="item65" compid="chk_phychem2Grade" propid="value" datasetid="ds_specmArticleList" columnid="phychem2Grade"/>
      <BindItem id="item66" compid="chk_phychem3Grade" propid="value" datasetid="ds_specmArticleList" columnid="phychem3Grade"/>
      <BindItem id="item67" compid="chk_phychem4Grade" propid="value" datasetid="ds_specmArticleList" columnid="phychem4Grade"/>
      <BindItem id="item68" compid="chk_phychem5Grade" propid="value" datasetid="ds_specmArticleList" columnid="phychem5Grade"/>
      <BindItem id="item51" compid="sta_orgNm" propid="text" datasetid="ds_testReqAccept" columnid="orgNm"/>
      <BindItem id="item52" compid="edt_acceptClassNm" propid="value" datasetid="ds_testReqAccept" columnid="acceptClassNm"/>
      <BindItem id="item1" compid="edt_specmDeliverPclsfact" propid="value" datasetid="ds_specmArticleList" columnid="specmDeliverPclsfact"/>
      <BindItem id="item16" compid="edt_mfgNation" propid="value" datasetid="ds_specmArticleList" columnid="mfgNation"/>
      <BindItem id="item54" compid="edt_mfgLocation" propid="value" datasetid="ds_specmArticleList" columnid="mfgLocation"/>
      <BindItem id="item53" compid="cbo_urgentYn" propid="value" datasetid="ds_specmArticleList" columnid="mfgVendor"/>
      <BindItem id="item55" compid="cbo_specmTypePcls" propid="value" datasetid="ds_specmArticleList" columnid="specmTypePcls"/>
      <BindItem id="item56" compid="cbo_approvalClass" propid="value" datasetid="ds_testReqAccept" columnid="approvalClass"/>
      <BindItem id="item57" compid="cbo_inspectRptIssue" propid="value" datasetid="ds_testReqAccept" columnid="inspectRptIssue"/>
    </Bind>
    <Objects>
      <Dataset id="ds_specmArticleListValid" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="specmClass" type="STRING" size="50"/>
          <Column id="specmCd" type="STRING" size="256"/>
          <Column id="specmNm" type="STRING" size="100"/>
          <Column id="specmType" type="STRING" size="10"/>
          <Column id="specmTypeNm" type="STRING" size="256"/>
          <Column id="insptClass" type="STRING" size="50"/>
          <Column id="insptPurp1" type="STRING" size="50"/>
          <Column id="insptPurp2" type="STRING" size="50"/>
          <Column id="insptPurp3" type="STRING" size="50"/>
          <Column id="insptObj1" type="STRING" size="50"/>
          <Column id="insptObj2" type="STRING" size="50"/>
          <Column id="insptObj3" type="STRING" size="256"/>
          <Column id="costClass" type="STRING" size="256"/>
          <Column id="specmDeliverPclsfact" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="specmClass">title:검체구분,required:true</Col>
            <Col id="specmNm">title:검체명,required:true,maxlengthB:400</Col>
            <Col id="specmType">title:검체유형,required:true</Col>
            <Col id="specmTypeNm">title:검체유형명,required:true</Col>
            <Col id="insptClass">title:검사구분,required:true</Col>
            <Col id="insptPurp1">title:검체목적1,required:true</Col>
            <Col id="insptPurp2">title:검체목적2,required:true</Col>
            <Col id="insptPurp3">title:검체목적3,required:true</Col>
            <Col id="insptObj1">title:검체대상1,required:true</Col>
            <Col id="insptObj2">title:검체대상2,required:true</Col>
            <Col id="costClass">title:비용구분,required:true</Col>
            <Col id="specmCd">title:검체코드,required:true</Col>
            <Col id="insptObj3">title:검체대상3,required:true</Col>
            <Col id="specmDeliverPclsfact">title:검체입고시세부사항,maxlengthB:4000</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_specmArticleList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="seqNum" type="STRING" size="256"/>
          <Column id="reqNum" type="STRING" size="256"/>
          <Column id="acceptNum" type="STRING" size="256"/>
          <Column id="acceptdd" type="STRING" size="256"/>
          <Column id="specmCd" type="STRING" size="50"/>
          <Column id="specmClass" type="STRING" size="50"/>
          <Column id="specmNm" type="STRING" size="100"/>
          <Column id="specmType" type="STRING" size="10"/>
          <Column id="specmTypeNm" type="STRING" size="256"/>
          <Column id="mgrpCd" type="STRING" size="10"/>
          <Column id="mcalssCd" type="STRING" size="10"/>
          <Column id="sclassCd" type="STRING" size="10"/>
          <Column id="specmTypePcls" type="STRING" size="50"/>
          <Column id="specmTypePclsNm" type="STRING" size="256"/>
          <Column id="costClass" type="STRING" size="50"/>
          <Column id="insptMtod" type="STRING" size="10"/>
          <Column id="insptClass" type="STRING" size="50"/>
          <Column id="insptPurp1" type="STRING" size="50"/>
          <Column id="insptPurp2" type="STRING" size="50"/>
          <Column id="insptPurp3" type="STRING" size="50"/>
          <Column id="specmWtrlstNm" type="STRING" size="50"/>
          <Column id="longstorageYn" type="STRING" size="50"/>
          <Column id="insptbeforeSpecmStatus" type="STRING" size="50"/>
          <Column id="pickStatus" type="STRING" size="50"/>
          <Column id="insptObj1" type="STRING" size="50"/>
          <Column id="insptObj2" type="STRING" size="50"/>
          <Column id="insptObj3" type="STRING" size="50"/>
          <Column id="insptObj4" type="STRING" size="50"/>
          <Column id="mfgwon" type="STRING" size="100"/>
          <Column id="dtrVendor" type="STRING" size="100"/>
          <Column id="acceptcityTempr" type="STRING" size="50"/>
          <Column id="stand" type="STRING" size="200"/>
          <Column id="unit" type="STRING" size="50"/>
          <Column id="origin" type="STRING" size="200"/>
          <Column id="chargBasis" type="STRING" size="50"/>
          <Column id="mfgdd" type="STRING" size="8"/>
          <Column id="dtrlimt" type="STRING" size="8"/>
          <Column id="dtrlimtMts" type="STRING" size="50"/>
          <Column id="dtrlimtDd" type="STRING" size="50"/>
          <Column id="specmDeliverPclsfact" type="STRING" size="4000"/>
          <Column id="legalBasis" type="STRING" size="1"/>
          <Column id="insideBasis" type="STRING" size="1"/>
          <Column id="micbio" type="STRING" size="1"/>
          <Column id="phychem" type="STRING" size="1"/>
          <Column id="micbio1Grade" type="STRING" size="1"/>
          <Column id="micbio2Grade" type="STRING" size="1"/>
          <Column id="micbio3Grade" type="STRING" size="1"/>
          <Column id="micbio4Grade" type="STRING" size="1"/>
          <Column id="micbio5Grade" type="STRING" size="1"/>
          <Column id="phychem1Grade" type="STRING" size="1"/>
          <Column id="phychem2Grade" type="STRING" size="1"/>
          <Column id="phychem3Grade" type="STRING" size="1"/>
          <Column id="phychem4Grade" type="STRING" size="1"/>
          <Column id="phychem5Grade" type="STRING" size="1"/>
          <Column id="mfgVendor" type="STRING" size="256"/>
          <Column id="mfgNation" type="STRING" size="256"/>
          <Column id="mfgLocation" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">N</Col>
            <Col id="insYn">Y</Col>
            <Col id="delYn">Y</Col>
            <Col id="savYn">Y</Col>
            <Col id="prtYn">N</Col>
            <Col id="exlYn">N</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_specmClass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_specmType" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_costClass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_insptClass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_insptPurp1" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_insptPurp2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_insptPurp3" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_longstorageYn" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_insptbeforeSpecmStatus" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_pickStatus" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_specmWtrlstNm" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_insptObj1" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_insptObj2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_insptObj3" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_insptObj4" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_chargBasis" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="specmCd" type="STRING" size="256"/>
          <Column id="specmType" type="STRING" size="256"/>
          <Column id="mgrpCd" type="STRING" size="256"/>
          <Column id="mcalssCd" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="insptPurp2" type="STRING" size="256"/>
          <Column id="longstorageYn" type="STRING" size="256"/>
          <Column id="authCd" type="STRING" size="256"/>
          <Column id="seqNum" type="STRING" size="256"/>
          <Column id="reqNum" type="STRING" size="256"/>
          <Column id="acceptClass" type="STRING" size="256"/>
          <Column id="edtSearch" type="STRING" size="256"/>
          <Column id="maskAuth" type="STRING" size="256"/>
          <Column id="specmClass" type="STRING" size="256"/>
          <Column id="specmTypePcls" type="STRING" size="256"/>
          <Column id="tempSeq" type="STRING" size="256"/>
          <Column id="Column0" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_retval" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="retVal" type="STRING" size="256"/>
          <Column id="specmCd" type="STRING" size="256"/>
          <Column id="procCnt" type="STRING" size="256"/>
          <Column id="reqNum" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_testArticleList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onvaluechanged="ds_testArticleList_onvaluechanged">
        <ColumnInfo>
          <Column id="seqNum" type="STRING" size="256"/>
          <Column id="specmCd" type="STRING" size="256"/>
          <Column id="reqNum" type="STRING" size="256"/>
          <Column id="acceptNum" type="STRING" size="256"/>
          <Column id="specmType" type="STRING" size="256"/>
          <Column id="mgrpCd" type="STRING" size="256"/>
          <Column id="mcalssCd" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="articleCd" type="STRING" size="256"/>
          <Column id="articleNm" type="STRING" size="256"/>
          <Column id="insptFld" type="STRING" size="256"/>
          <Column id="takeTerm" type="STRING" size="256"/>
          <Column id="notFitClsfi" type="STRING" size="256"/>
          <Column id="basisStand" type="STRING" size="256"/>
          <Column id="comm1UseYn" type="STRING" size="256"/>
          <Column id="comm1" type="STRING" size="256"/>
          <Column id="comm2UseYn" type="STRING" size="256"/>
          <Column id="comm2" type="STRING" size="256"/>
          <Column id="comm3UseYn" type="STRING" size="256"/>
          <Column id="comm3" type="STRING" size="256"/>
          <Column id="comm4UseYn" type="STRING" size="256"/>
          <Column id="comm4" type="STRING" size="256"/>
          <Column id="comm5UseYn" type="STRING" size="256"/>
          <Column id="comm5" type="STRING" size="256"/>
          <Column id="commCalc" type="STRING" size="256"/>
          <Column id="sabun" type="STRING" size="256"/>
          <Column id="insptMethod" type="STRING" size="256"/>
          <Column id="jobOrder" type="STRING" size="256"/>
          <Column id="testClass" type="STRING" size="256"/>
          <Column id="legalBasis" type="STRING" size="1"/>
          <Column id="insideBasis" type="STRING" size="1"/>
          <Column id="micbio" type="STRING" size="1"/>
          <Column id="phychem" type="STRING" size="1"/>
          <Column id="micbio1Grade" type="STRING" size="1"/>
          <Column id="micbio2Grade" type="STRING" size="1"/>
          <Column id="micbio3Grade" type="STRING" size="1"/>
          <Column id="micbio4Grade" type="STRING" size="1"/>
          <Column id="micbio5Grade" type="STRING" size="1"/>
          <Column id="phychem1Grade" type="STRING" size="1"/>
          <Column id="phychem2Grade" type="STRING" size="1"/>
          <Column id="phychem3Grade" type="STRING" size="1"/>
          <Column id="phychem4Grade" type="STRING" size="1"/>
          <Column id="phychem5Grade" type="STRING" size="1"/>
          <Column id="manageSabun" type="STRING" size="256"/>
          <Column id="manageNm" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows/>
      </Dataset>
      <Dataset id="ds_testArticleListValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_groupList_oncolumnchanged">
        <ColumnInfo>
          <Column id="articleNm" type="STRING" size="255"/>
          <Column id="insptFld" type="STRING" size="255"/>
          <Column id="takeTerm" type="STRING" size="256"/>
          <Column id="notFitClsfi" type="STRING" size="256"/>
          <Column id="basisStand" type="STRING" size="256"/>
          <Column id="sabun" type="STRING" size="256"/>
          <Column id="insptMethod" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="articleNm">title:시험항목,required:true</Col>
            <Col id="insptFld">title:검사분야,required:true</Col>
            <Col id="basisStand">title:기준규격,required:true</Col>
            <Col id="takeTerm">title:소요기간,required:true</Col>
            <Col id="notFitClsfi">title:부적합분류,required:true</Col>
            <Col id="sabun">title:검사자,required:true</Col>
            <Col id="insptMethod">title:검사방법,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_testReqAccept" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="reqNum" type="STRING" size="11"/>
          <Column id="reqDate" type="STRING" size="8"/>
          <Column id="acceptnm" type="STRING" size="400"/>
          <Column id="upjang" type="STRING" size="22"/>
          <Column id="upjangNm" type="STRING" size="400"/>
          <Column id="orgNm" type="STRING" size="256"/>
          <Column id="pclsUpjangNm" type="STRING" size="1000"/>
          <Column id="bizNo" type="STRING" size="50"/>
          <Column id="acceptClassNm" type="STRING" size="256"/>
          <Column id="reqUserNm" type="STRING" size="100"/>
          <Column id="reqUserTelno1" type="STRING" size="256"/>
          <Column id="reqUserTelno2" type="STRING" size="256"/>
          <Column id="reqUserTelno3" type="STRING" size="100"/>
          <Column id="reqUserEmail" type="STRING" size="200"/>
          <Column id="reqUserRemark" type="STRING" size="4000"/>
          <Column id="insideExtrClass" type="STRING" size="50"/>
          <Column id="approvalClass" type="STRING" size="50"/>
          <Column id="insptReqPlce" type="STRING" size="400"/>
          <Column id="inspectRptIssue" type="STRING" size="50"/>
          <Column id="progressStatus" type="STRING" size="50"/>
          <Column id="lastDecision" type="STRING" size="50"/>
          <Column id="acceptClass" type="STRING" size="50"/>
          <Column id="ceo" type="STRING" size="200"/>
          <Column id="vdCd" type="STRING" size="256"/>
          <Column id="tempSeq" type="STRING" size="256"/>
          <Column id="loginSabun" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_insptFld" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_notFitClsfi" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_insptMethod" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_insptUser" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="sabun" type="STRING" size="256"/>
          <Column id="userNm" type="STRING" size="256"/>
          <Column id="insptFld" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_testArticleListTmp" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="seqNum" type="STRING" size="256"/>
          <Column id="specmCd" type="STRING" size="256"/>
          <Column id="reqNum" type="STRING" size="256"/>
          <Column id="acceptNum" type="STRING" size="256"/>
          <Column id="specmType" type="STRING" size="256"/>
          <Column id="mgrpCd" type="STRING" size="256"/>
          <Column id="mcalssCd" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="articleCd" type="STRING" size="256"/>
          <Column id="articleNm" type="STRING" size="256"/>
          <Column id="insptFld" type="STRING" size="256"/>
          <Column id="takeTerm" type="STRING" size="256"/>
          <Column id="notFitClsfi" type="STRING" size="256"/>
          <Column id="basisStand" type="STRING" size="256"/>
          <Column id="comm1UseYn" type="STRING" size="256"/>
          <Column id="comm1" type="STRING" size="256"/>
          <Column id="comm2UseYn" type="STRING" size="256"/>
          <Column id="comm2" type="STRING" size="256"/>
          <Column id="comm3UseYn" type="STRING" size="256"/>
          <Column id="comm3" type="STRING" size="256"/>
          <Column id="comm4UseYn" type="STRING" size="256"/>
          <Column id="comm4" type="STRING" size="256"/>
          <Column id="comm5UseYn" type="STRING" size="256"/>
          <Column id="comm5" type="STRING" size="256"/>
          <Column id="commCalc" type="STRING" size="256"/>
          <Column id="sabun" type="STRING" size="256"/>
          <Column id="insptMethod" type="STRING" size="256"/>
          <Column id="jobOrder" type="STRING" size="256"/>
          <Column id="testClass" type="STRING" size="256"/>
          <Column id="legalBasis" type="STRING" size="1"/>
          <Column id="insideBasis" type="STRING" size="1"/>
          <Column id="micbio" type="STRING" size="1"/>
          <Column id="phychem" type="STRING" size="1"/>
          <Column id="micbio1Grade" type="STRING" size="1"/>
          <Column id="micbio2Grade" type="STRING" size="1"/>
          <Column id="micbio3Grade" type="STRING" size="1"/>
          <Column id="micbio4Grade" type="STRING" size="1"/>
          <Column id="micbio5Grade" type="STRING" size="1"/>
          <Column id="phychem1Grade" type="STRING" size="1"/>
          <Column id="phychem2Grade" type="STRING" size="1"/>
          <Column id="phychem3Grade" type="STRING" size="1"/>
          <Column id="phychem4Grade" type="STRING" size="1"/>
          <Column id="phychem5Grade" type="STRING" size="1"/>
          <Column id="seq" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows/>
      </Dataset>
      <Dataset id="ds_testReqAcceptValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="reqDate" type="STRING" size="8"/>
          <Column id="acceptnm" type="STRING" size="400"/>
          <Column id="upjang" type="BIGDECIMAL" size="22"/>
          <Column id="upjangNm" type="STRING" size="400"/>
          <Column id="reqUserNm" type="STRING" size="100"/>
          <Column id="insideExtrClass" type="STRING" size="50"/>
          <Column id="approvalClass" type="STRING" size="50"/>
          <Column id="inspectRptIssue" type="STRING" size="50"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="reqDate">title:의뢰일자,required:true</Col>
            <Col id="acceptnm">title:접수명,required:true</Col>
            <Col id="upjang">title:업장,required:true</Col>
            <Col id="upjangNm">title:업장명,required:true</Col>
            <Col id="reqUserNm">title:의뢰자명,required:true</Col>
            <Col id="insideExtrClass">title:내외부구분,required:true</Col>
            <Col id="approvalClass">title:상신구분,required:true</Col>
            <Col id="inspectRptIssue">title:성적서발급,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_insideExtrClass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_approvalClass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inspectRptIssue" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_paramValue" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="str1" type="STRING" size="256"/>
          <Column id="str2" type="STRING" size="256"/>
          <Column id="str3" type="STRING" size="256"/>
          <Column id="str4" type="STRING" size="256"/>
          <Column id="str5" type="STRING" size="256"/>
          <Column id="str6" type="STRING" size="256"/>
          <Column id="str7" type="STRING" size="256"/>
          <Column id="str8" type="STRING" size="256"/>
          <Column id="str9" type="STRING" size="256"/>
          <Column id="str10" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_upjangList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="orgPath" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="255"/>
          <Column id="upjangnm" type="STRING" size="255"/>
          <Column id="saupno" type="STRING" size="256"/>
          <Column id="ceo" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_addSpecmArticleListValid" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="specmClass" type="STRING" size="50"/>
          <Column id="specmNm" type="STRING" size="100"/>
          <Column id="specmType" type="STRING" size="10"/>
          <Column id="specmTypeNm" type="STRING" size="256"/>
          <Column id="insptClass" type="STRING" size="50"/>
          <Column id="insptPurp1" type="STRING" size="50"/>
          <Column id="insptPurp2" type="STRING" size="50"/>
          <Column id="insptPurp3" type="STRING" size="50"/>
          <Column id="insptObj1" type="STRING" size="50"/>
          <Column id="insptObj2" type="STRING" size="50"/>
          <Column id="insptObj3" type="STRING" size="256"/>
          <Column id="costClass" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="specmClass">title:검체구분,required:true</Col>
            <Col id="specmNm">title:검체명,required:true</Col>
            <Col id="specmType">title:검체유형,required:true</Col>
            <Col id="specmTypeNm">title:검체유형명,required:true</Col>
            <Col id="insptClass">title:검사구분,required:true</Col>
            <Col id="insptPurp1">title:검체목적1,required:true</Col>
            <Col id="insptPurp2">title:검체목적2,required:true</Col>
            <Col id="insptPurp3">title:검체목적3,required:true</Col>
            <Col id="insptObj1">title:검체대상1,required:true</Col>
            <Col id="insptObj2">title:검체대상2,required:true</Col>
            <Col id="costClass">title:비용구분,required:true</Col>
            <Col id="insptObj3">title:검체대상3,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_specmArticleListTmp" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="specmCd" type="STRING" size="50"/>
          <Column id="specmClass" type="STRING" size="50"/>
          <Column id="specmNm" type="STRING" size="100"/>
          <Column id="specmType" type="STRING" size="10"/>
          <Column id="specmTypeNm" type="STRING" size="256"/>
          <Column id="mgrpCd" type="STRING" size="10"/>
          <Column id="mcalssCd" type="STRING" size="10"/>
          <Column id="sclassCd" type="STRING" size="10"/>
          <Column id="specmTypePcls" type="STRING" size="50"/>
          <Column id="specmTypePclsNm" type="STRING" size="256"/>
          <Column id="costClass" type="STRING" size="50"/>
          <Column id="insptMtod" type="STRING" size="10"/>
          <Column id="insptClass" type="STRING" size="50"/>
          <Column id="insptPurp1" type="STRING" size="50"/>
          <Column id="insptPurp2" type="STRING" size="50"/>
          <Column id="insptPurp3" type="STRING" size="50"/>
          <Column id="specmWtrlstNm" type="STRING" size="50"/>
          <Column id="longstorageYn" type="STRING" size="50"/>
          <Column id="insptbeforeSpecmStatus" type="STRING" size="50"/>
          <Column id="pickStatus" type="STRING" size="50"/>
          <Column id="insptObj1" type="STRING" size="50"/>
          <Column id="insptObj2" type="STRING" size="50"/>
          <Column id="insptObj3" type="STRING" size="50"/>
          <Column id="insptObj4" type="STRING" size="50"/>
          <Column id="mfgwon" type="STRING" size="100"/>
          <Column id="dtrVendor" type="STRING" size="100"/>
          <Column id="acceptcityTempr" type="STRING" size="50"/>
          <Column id="stand" type="STRING" size="50"/>
          <Column id="unit" type="STRING" size="50"/>
          <Column id="origin" type="STRING" size="200"/>
          <Column id="chargBasis" type="STRING" size="50"/>
          <Column id="mfgdd" type="STRING" size="8"/>
          <Column id="dtrlimt" type="STRING" size="8"/>
          <Column id="dtrlimtMts" type="STRING" size="50"/>
          <Column id="dtrlimtDd" type="STRING" size="50"/>
          <Column id="specmDeliverPclsfact" type="STRING" size="4000"/>
          <Column id="mfgVendor" type="STRING" size="256"/>
          <Column id="mfgNation" type="STRING" size="256"/>
          <Column id="mfgLocation" type="STRING" size="256"/>
          <Column id="seq" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_etcSpecmArticleList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="seqNum" type="STRING" size="256"/>
          <Column id="reqNum" type="STRING" size="256"/>
          <Column id="acceptNum" type="STRING" size="256"/>
          <Column id="acceptdd" type="STRING" size="256"/>
          <Column id="specmCd" type="STRING" size="50"/>
          <Column id="specmClass" type="STRING" size="50"/>
          <Column id="specmNm" type="STRING" size="100"/>
          <Column id="specmType" type="STRING" size="10"/>
          <Column id="specmTypeNm" type="STRING" size="256"/>
          <Column id="mgrpCd" type="STRING" size="10"/>
          <Column id="mcalssCd" type="STRING" size="10"/>
          <Column id="sclassCd" type="STRING" size="10"/>
          <Column id="specmTypePcls" type="STRING" size="50"/>
          <Column id="specmTypePclsNm" type="STRING" size="256"/>
          <Column id="costClass" type="STRING" size="50"/>
          <Column id="insptMtod" type="STRING" size="10"/>
          <Column id="insptClass" type="STRING" size="50"/>
          <Column id="insptPurp1" type="STRING" size="50"/>
          <Column id="insptPurp2" type="STRING" size="50"/>
          <Column id="insptPurp3" type="STRING" size="50"/>
          <Column id="specmWtrlstNm" type="STRING" size="50"/>
          <Column id="longstorageYn" type="STRING" size="50"/>
          <Column id="insptbeforeSpecmStatus" type="STRING" size="50"/>
          <Column id="pickStatus" type="STRING" size="50"/>
          <Column id="insptObj1" type="STRING" size="50"/>
          <Column id="insptObj2" type="STRING" size="50"/>
          <Column id="insptObj3" type="STRING" size="50"/>
          <Column id="insptObj4" type="STRING" size="50"/>
          <Column id="mfgwon" type="STRING" size="100"/>
          <Column id="dtrVendor" type="STRING" size="100"/>
          <Column id="acceptcityTempr" type="STRING" size="50"/>
          <Column id="stand" type="STRING" size="200"/>
          <Column id="unit" type="STRING" size="50"/>
          <Column id="origin" type="STRING" size="200"/>
          <Column id="chargBasis" type="STRING" size="50"/>
          <Column id="mfgdd" type="STRING" size="8"/>
          <Column id="dtrlimt" type="STRING" size="8"/>
          <Column id="dtrlimtMts" type="STRING" size="50"/>
          <Column id="dtrlimtDd" type="STRING" size="50"/>
          <Column id="specmDeliverPclsfact" type="STRING" size="4000"/>
          <Column id="legalBasis" type="STRING" size="1"/>
          <Column id="insideBasis" type="STRING" size="1"/>
          <Column id="micbio" type="STRING" size="1"/>
          <Column id="phychem" type="STRING" size="1"/>
          <Column id="micbio1Grade" type="STRING" size="1"/>
          <Column id="micbio2Grade" type="STRING" size="1"/>
          <Column id="micbio3Grade" type="STRING" size="1"/>
          <Column id="micbio4Grade" type="STRING" size="1"/>
          <Column id="micbio5Grade" type="STRING" size="1"/>
          <Column id="phychem1Grade" type="STRING" size="1"/>
          <Column id="phychem2Grade" type="STRING" size="1"/>
          <Column id="phychem3Grade" type="STRING" size="1"/>
          <Column id="phychem4Grade" type="STRING" size="1"/>
          <Column id="phychem5Grade" type="STRING" size="1"/>
          <Column id="mfgVendor" type="STRING" size="256"/>
          <Column id="mfgNation" type="STRING" size="256"/>
          <Column id="mfgLocation" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_transItemList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="transUpjang" type="STRING" size="256"/>
          <Column id="transUpjangNm" type="STRING" size="256"/>
          <Column id="transDate" type="STRING" size="256"/>
          <Column id="specmCd" type="STRING" size="50"/>
          <Column id="specmClass" type="STRING" size="50"/>
          <Column id="specmNm" type="STRING" size="100"/>
          <Column id="specmType" type="STRING" size="10"/>
          <Column id="specmTypeNm" type="STRING" size="256"/>
          <Column id="mgrpCd" type="STRING" size="10"/>
          <Column id="mcalssCd" type="STRING" size="10"/>
          <Column id="sclassCd" type="STRING" size="10"/>
          <Column id="specmTypePcls" type="STRING" size="50"/>
          <Column id="specmTypePclsNm" type="STRING" size="256"/>
          <Column id="costClass" type="STRING" size="50"/>
          <Column id="insptMtod" type="STRING" size="10"/>
          <Column id="insptClass" type="STRING" size="50"/>
          <Column id="insptPurp1" type="STRING" size="50"/>
          <Column id="insptPurp2" type="STRING" size="50"/>
          <Column id="insptPurp3" type="STRING" size="50"/>
          <Column id="specmWtrlstNm" type="STRING" size="50"/>
          <Column id="longstorageYn" type="STRING" size="50"/>
          <Column id="insptbeforeSpecmStatus" type="STRING" size="50"/>
          <Column id="pickStatus" type="STRING" size="50"/>
          <Column id="insptObj1" type="STRING" size="50"/>
          <Column id="insptObj2" type="STRING" size="50"/>
          <Column id="insptObj3" type="STRING" size="50"/>
          <Column id="insptObj4" type="STRING" size="50"/>
          <Column id="mfgwon" type="STRING" size="100"/>
          <Column id="dtrVendor" type="STRING" size="100"/>
          <Column id="acceptcityTempr" type="STRING" size="50"/>
          <Column id="stand" type="STRING" size="50"/>
          <Column id="unit" type="STRING" size="50"/>
          <Column id="origin" type="STRING" size="200"/>
          <Column id="chargBasis" type="STRING" size="50"/>
          <Column id="mfgdd" type="STRING" size="8"/>
          <Column id="dtrlimt" type="STRING" size="8"/>
          <Column id="dtrlimtMts" type="STRING" size="50"/>
          <Column id="dtrlimtDd" type="STRING" size="50"/>
          <Column id="specmDeliverPclsfact" type="STRING" size="4000"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_urgentYn" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_specmTypePcls" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_testArticleListTmp00" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="false" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="seqNum" type="STRING" size="256"/>
          <Column id="specmCd" type="STRING" size="256"/>
          <Column id="reqNum" type="STRING" size="256"/>
          <Column id="acceptNum" type="STRING" size="256"/>
          <Column id="specmType" type="STRING" size="256"/>
          <Column id="mgrpCd" type="STRING" size="256"/>
          <Column id="mcalssCd" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="articleCd" type="STRING" size="256"/>
          <Column id="articleNm" type="STRING" size="256"/>
          <Column id="insptFld" type="STRING" size="256"/>
          <Column id="takeTerm" type="STRING" size="256"/>
          <Column id="notFitClsfi" type="STRING" size="256"/>
          <Column id="basisStand" type="STRING" size="256"/>
          <Column id="comm1UseYn" type="STRING" size="256"/>
          <Column id="comm1" type="STRING" size="256"/>
          <Column id="comm2UseYn" type="STRING" size="256"/>
          <Column id="comm2" type="STRING" size="256"/>
          <Column id="comm3UseYn" type="STRING" size="256"/>
          <Column id="comm3" type="STRING" size="256"/>
          <Column id="comm4UseYn" type="STRING" size="256"/>
          <Column id="comm4" type="STRING" size="256"/>
          <Column id="comm5UseYn" type="STRING" size="256"/>
          <Column id="comm5" type="STRING" size="256"/>
          <Column id="commCalc" type="STRING" size="256"/>
          <Column id="sabun" type="STRING" size="256"/>
          <Column id="insptMethod" type="STRING" size="256"/>
          <Column id="jobOrder" type="STRING" size="256"/>
          <Column id="testClass" type="STRING" size="256"/>
          <Column id="legalBasis" type="STRING" size="1"/>
          <Column id="insideBasis" type="STRING" size="1"/>
          <Column id="micbio" type="STRING" size="1"/>
          <Column id="phychem" type="STRING" size="1"/>
          <Column id="micbio1Grade" type="STRING" size="1"/>
          <Column id="micbio2Grade" type="STRING" size="1"/>
          <Column id="micbio3Grade" type="STRING" size="1"/>
          <Column id="micbio4Grade" type="STRING" size="1"/>
          <Column id="micbio5Grade" type="STRING" size="1"/>
          <Column id="phychem1Grade" type="STRING" size="1"/>
          <Column id="phychem2Grade" type="STRING" size="1"/>
          <Column id="phychem3Grade" type="STRING" size="1"/>
          <Column id="phychem4Grade" type="STRING" size="1"/>
          <Column id="phychem5Grade" type="STRING" size="1"/>
          <Column id="seq" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows/>
      </Dataset>
      <Dataset id="ds_excelDtlList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="A" type="STRING" size="256"/>
          <Column id="B" type="STRING" size="256"/>
          <Column id="C" type="STRING" size="256"/>
          <Column id="D" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_specmnm">
        <ColumnInfo>
          <Column id="SPECM_NM" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : TestInfoReg
  파 일 명 : TestInfoReg.xfdl
  기    능 : 시험정보등록

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.03.20   jshoon   최초 생성
*/
// 검사자 정보 추가 : 데이터셋에 추가 ds_testArticleList 처리:맹수영 요청:최준열 20160817  (CH201608_00315)
//2018.02.01 김명섭 [CH201802_00006] 임시저장 기능 등 개선
//2018.02.20 김명섭 [CH201802_00108]
// - 검체정보복사 개선: (asis)그리드 하단에 추가 (tobe)현재 선택 row 하단에 추가
// - 검체정보복사 후 시험항목복사 처리 추가
//2018.04.11 김명섭
// - 의뢰업체 정보 관리 항목 삭제: 사업자명, 사업자번호, 세부업장명, 의뢰자이메일 항목 삭제
/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "lib::LimsUtil.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_iProcessCnt = 0;  	// 저장건수를 저장한다.(Controller Class에서만 할당함.)
var curDate = gfn_today();
var strInsptReqPlce = "";	// 검사의뢰처(접수거래처), 공통코드:시스템구분(IFIS,FICS,SPOON,FTIS,LIMS,FSMOBILE) -- 사용안함... 타 팀에서 이 화면에 입력을 하지 못한다.
var codeList = "INSIDE_EXTR_CLASS,SPECM_CLASS,SPECM_TYPE,COST_CLASS,INSPT_CLASS,INSPT_PURP_1,INSPT_PURP_2,INSPT_PURP_3,LONGSTORAGE_YN,INSPTBEFORE_SPECM_STATUS,PICK_STATUS,SPECM_WTRLST_NM,INSPT_OBJ_1,INSPT_OBJ_2,INSPT_OBJ_3,INSPT_OBJ_4,CHARG_BASIS,INSPT_FLD,NOT_FIT_CLSFI,INSPT_METHOD,URGENT_YN,SPECM_TYPE_PCLS,APPROVAL_CLASS,INSPECT_RPT_ISSUE";
var iSpecmSeqNum = 0;
var v_arg;
var articleChggb;

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{
    // Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
    gfn_formOnLoad(this, false);		// 검체유형 GRID에는 공통 이벤트 제외
    this.onkeydown.addHandler(gfn_formKeyDown);

    // 화면에 default readonly component의 색상을 회색으로 변경 한다.
    for (var i = 0, iLen = this.components.length; i < iLen; i++) {
        if (this.components[i].readonly == true) {
            this.components[i].style.backgroundColor = "#ecececff";
        }
    }

    // 파라미터 Get
    v_arg = gfn_getScreenParams();
    //trace("g_SystemId >>>>>>>>>> " + g_SystemId);
    //trace("v_arg >>>>>>>>>>>>>>>>>>>>>>>>>> " + v_arg);

    // 초기값 셋팅
    fn_init();
    
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 협력업체 위생관리에서 호출 시 실행
 *---------------------------------------------------------------------------------------------*/
function fn_getScreenParams(arrArg)
{
    v_arg = arrArg;

    if (typeof v_arg != "undefined" && v_arg != null && v_arg != "")
    {
        if (v_arg[0] == "IFIS")
        {
            //fn_insert();

            ds_paramValue.clearData();

//             var nRow = ds_paramValue.addRow();
//             ds_paramValue.setColumn(nRow, "str1", v_arg[0]);	// 검사의뢰처 구분
//             ds_paramValue.setColumn(nRow, "str2", v_arg[1]);	// 점검표코드
//             ds_paramValue.setColumn(nRow, "str3", v_arg[2]);	// 양식코드
//             ds_paramValue.setColumn(nRow, "str4", v_arg[3]);	// 업체코드
//             ds_paramValue.setColumn(nRow, "str5", v_arg[4]);	// 점검일
//             ds_paramValue.setColumn(nRow, "str6", v_arg[5]);	// 구매 VENDOR CODE
            //trace(ds_paramValue.saveXML());

            //fn_searchUpjang();
        }
    }
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
    // 공통코드 세팅은 selectInsptUserList callback에서 지정
    cal_reqDate.fn_initMonthCal(this, curDate, "fn_calendarCallBack", ds_testReqAccept, "reqDate", "Y");
    cal_acceptdd.fn_initMonthCal(this, curDate, "fn_calendarCallBack", ds_specmArticleList, "acceptdd", "Y");
    cal_mfgdd.fn_initMonthCal(this, curDate, "fn_calendarCallBack", ds_specmArticleList, "mfgdd");
    cal_dtrlimt.fn_initMonthCal(this, curDate, "fn_calendarCallBack", ds_specmArticleList, "dtrlimt");

    fn_selectInsptUser();	// 검사항목리스트에 보여질 검사자 조회 후 DataSet Setting

    div_cmnBtn.btn_insert.enable = true;
    div_cmnBtn.btn_delete.enable = false;
    div_cmnBtn.btn_save.enable = false;

    //20210518015 - 1
    //cbo_insideExtrClass.enable = false;
    //cbo_costClass.enable = false;
    //cbo_insptObj3.enable = false;
    
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 달력 조회 후 callback function
 *---------------------------------------------------------------------------------------------*/
function fn_calendarCallBack()
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 공통코드 binding 조회 후 callback function
 *---------------------------------------------------------------------------------------------*/
function fn_codeBatchCallback()
{
    ds_longstorageYn.insertRow(0);
    ds_longstorageYn.setColumn(0, "code", "");
    ds_longstorageYn.setColumn(0, "codeName", "");
    
    ds_specmTypePcls.insertRow(0);
    ds_specmTypePcls.setColumn(0, "code", "");
    ds_specmTypePcls.setColumn(0, "codeName", "");

    fn_getScreenParams(v_arg);
    // 타 모듈에서 화면 전환 시 넘어오는 parameter가 있으면 처리 한다.
// 	if (typeof v_arg != "undefined" && v_arg != null && v_arg != "")
// 	{
// 		if (v_arg[0] == "IFIS")
// 		{
// 			var nRow = ds_paramValue.addRow();
// 			ds_paramValue.setColumn(nRow, "str1", v_arg[0]);	// 검사의뢰처 구분
// 			ds_paramValue.setColumn(nRow, "str2", v_arg[1]);	// 점검표코드
// 			ds_paramValue.setColumn(nRow, "str3", v_arg[2]);	// 양식코드
// 			ds_paramValue.setColumn(nRow, "str4", v_arg[3]);	// 업체코드
// 			ds_paramValue.setColumn(nRow, "str5", v_arg[4]);	// 점검일
// 			ds_paramValue.setColumn(nRow, "str6", v_arg[5]);	// 구매 VENDOR CODE
// 			//trace(ds_paramValue.saveXML());
// 			fn_searchUpjang();
// 		}
// 	}
//
    // 거래중인식재료(자재)는 입력을 막는다.
    edt_specmNm.readonly = true;
    LimsUtil.setComponentAuth(this, false);

    // 입력상태로 변경
    //fn_insert();

    //fn_search("R-150520016");	// 테스트용

    // rowType이 '1'(신규)인 경우 체크박스를 활성화 시킨다.
    //LimsUtil.setGrdCheckBoxCallback(grd_testArticleList, ["legalBasis","insideBasis"]);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{
    // v_ds_check 미사용시 변경사항 체크(입력 프로그램일때 변경되는 Dataset 전체 기술)
    if (gfn_dsIsUpdated(ds_testReqAccept) ||
        gfn_dsIsUpdated(ds_specmArticleList) ||
        gfn_dsIsUpdated(ds_testArticleList))
    {
        // 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
        if (!gfn_confirm("confirm.before.movepage")) return false;
    }

    // 조회프로그램에도 Return true; 기술해 주세요!
    return true;
}

/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 (필수-공통버튼에서 호출됨) - 테스트용
 *---------------------------------------------------------------------------------------------*/
function fn_search(reqNum)
{
    ds_search.setColumn(0, "reqNum", reqNum);
    ds_search.setColumn(0, "maskAuth", SCAuth.getMaskAuth(this));

    ds_testReqAccept.clearData();		// 의뢰정보 DataSet 초기화
    ds_specmArticleList.clearData();	// 검체정보 DataSet 초기화
    ds_testArticleList.filter("");
    ds_testArticleList.clearData();		// 시험정보 DataSet 초기화
    ds_testArticleListTmp.clearData();	// 시험정보 Temp DataSet 초기화
    ds_testArticleListTmp.filter("");

    var strSvcID    = "selectList";
    var strURL      = "ls/lrm/testInfoReg/selectList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_testReqAccept=ds_testReqAccept ds_specmArticleList=ds_specmArticleList ds_testArticleListTmp=ds_testArticleListTmp";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{
    // 입력버튼 클릭 시 DataSet, Grid 초기화
    gfn_clearSortMark(grd_specmArticleList);
    gfn_clearSortMark(grd_testArticleList);

    ds_testReqAccept.clearData();		// 의뢰정보 DataSet 초기화
    ds_specmArticleList.clearData();	// 검체정보 DataSet 초기화
    ds_testArticleList.filter("");
    ds_testArticleList.clearData();		// 시험정보 DataSet 초기화
    ds_testArticleListTmp.clearData();	// 시험정보 Temp DataSet 초기화
    ds_testArticleListTmp.filter("");

    iSpecmSeqNum = 0;	// 검체순번 초기화

    var objSkipComp = [
        "edt_reqNum"
       ,"edt_upjangNm"
       ,"edt_ceo"
       ,"edt_bizNo"
       ,"edt_acceptClassNm"
       ,"edt_acceptNum"
       ,"edt_specmTypeNm"
       ,"edt_specmNm"
       ,"edt_specmTypePclsNm"
       ,"chk_legalBasis"
       ,"chk_insideBasis"
       ,"chk_micbio1Grade"
       ,"chk_micbio2Grade"
       ,"chk_micbio3Grade"
       ,"chk_micbio4Grade"
       ,"chk_micbio5Grade"
       ,"chk_phychem1Grade"
       ,"chk_phychem2Grade"
       ,"chk_phychem3Grade"
       ,"chk_phychem4Grade"
       ,"chk_phychem5Grade"
       ,"chk_micbio"
       ,"chk_phychem"
    ];
    LimsUtil.setComponentAuth(this, true, objSkipComp);

    div_cmnBtn.btn_insert.enable = false;
    div_cmnBtn.btn_delete.enable = true;
    div_cmnBtn.btn_save.enable = true;

    ds_testReqAccept.addRow();
    cal_reqDate.fn_setValue(curDate);

    // 검체정보 입력
    //btn_addSpecm_onclick();
    
    //20210518015 - 1
    cbo_insideExtrClass.index = 0;
    cbo_costClass.index = 0;
    cbo_insptObj3.index = 0;
    
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{
    // 자료를 삭제 하시겠습니까?
    if (!gfn_confirm("접수정보 전체가 삭제됩니다.\n정말 삭제하시겠습니까?")) return false;

    // 입력버튼 클릭 시 DataSet, Grid 초기화
    gfn_clearSortMark(grd_specmArticleList);
    gfn_clearSortMark(grd_testArticleList);

    ds_testReqAccept.clearData();		// 의뢰정보 DataSet 초기화
    ds_specmArticleList.clearData();	// 검체정보 DataSet 초기화
    ds_testArticleList.filter("");
    ds_testArticleList.clearData();		// 시험정보 DataSet 초기화
    ds_testArticleListTmp.clearData();	// 시험정보 Temp DataSet 초기화
    ds_testArticleListTmp.filter("");

    iSpecmSeqNum = 0;	// 검체순번 초기화

    div_cmnBtn.btn_insert.enable = true;
    div_cmnBtn.btn_delete.enable = false;
    div_cmnBtn.btn_save.enable = false;

    LimsUtil.setComponentAuth(this, false);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
    if (ds_testReqAccept.rowposition == -1)
    {
        gfn_alert("접수정보를 입력하여 주십시오.");
        return;
    }
    
    if (gfn_validCheck(ds_testReqAccept, ds_testReqAcceptValid, true) == false) return;

    // 각 검체의 시험정보가 존재하는지 체크
    var chkSpecmNm = fn_checkTestInfo();
    if (chkSpecmNm != "")
    {
        gfn_alert("[" + chkSpecmNm + "] 검체에 대한 시험항목정보를 입력하여 주십시오.");
        return;
    }

    // 접수명 특수문자 포함여부 체크
    //2018.04.11: 특수문자 체크 수정
    //if (gfn_isSpecialChar(edt_acceptnm.value))
    if (fn_isSpecialChar(edt_acceptnm.value))
    {
        gfn_alert("접수명에 특수문자가 포함되어 있습니다.\n\n접수명은 성적서파일명으로도 사용되기 때문에 특수문자를 포함하지 마십시오.");
        return;
    }

    if (ds_specmArticleList.rowposition == -1)
    {
        gfn_alert("검체정보를 입력하여 주십시오.");
        return;
    }

    for (var i = 0; i < ds_specmArticleList.rowcount; i++)
    {
        if (gfn_isNull(ds_specmArticleList.getColumn(i, "specmCd")))
        {
            gfn_alert("검체항목을 선택하여 주십시오.\n검체정보를 새로 등록하는 경우 먼저 [입력검체등록]을 클릭하여 저장해 주십시오.");
            return;
        }
    }

    if (ds_testArticleList.rowposition == -1)
    {
        gfn_alert("시험정보를 입력하여 주십시오.");
        return;
    }

    // 검체 중복 체크
    if (!fn_dupCheckSpecmInfo())
    {
        gfn_alert("중복등록된 검체정보가 있습니다.");
        return;
    }

    // 시험항목 중복 체크
    if (!fn_dupCheckTestInfo())
    {
        gfn_alert("중복등록된 시험정보가 있습니다.");
        return;
    }

    // 법적 / 내부기준 체크
    for (var i = 0; i < ds_testArticleList.rowcount; i++)
    {
        if (!fn_basisCheck(ds_testArticleList, i))
        {
            gfn_alert("법적기준 또는 내부기준을 선택하여 주십시오.");
            ds_testArticleList.rowposition = i;
            return;
        }
        if (!fn_basisDupCheck(ds_testArticleList, i))
        {
            gfn_alert("법적기준 또는 내부기준을 둘중 하나만 선택하여 주십시오.");
            ds_testArticleList.rowposition = i;
            return;
        }
    }

    // 수수료 체크
    if (!fn_commCheckTestInfo())
    {
        gfn_alert("수수료선택이 안된 시험정보가 있습니다.");
        return;
    }
    
	// 접수정보
	ds_testReqAccept.setRowType(0, Dataset.ROWTYPE_INSERT);
	
	// 검체정보
	for (var i = 0; i < ds_specmArticleList.getRowCount(); i++) {
		ds_specmArticleList.setRowType(i, Dataset.ROWTYPE_INSERT);
	}
	
	//2018.06.16 김명섭 수수료3~5 데이터 초기화
	for (var i = 0; i < ds_testArticleList.rowcount; i++)
	{
		ds_testArticleList.setColumn(i,"comm3UseYn","N");
		ds_testArticleList.setColumn(i,"comm3","0");
		ds_testArticleList.setColumn(i,"comm4UseYn","N");
		ds_testArticleList.setColumn(i,"comm4","0");
		ds_testArticleList.setColumn(i,"comm5UseYn","N");
		ds_testArticleList.setColumn(i,"comm5","0");
	}			
	
	// 시험정보 Temp 세팅
	ds_testArticleListTmp.copyData(ds_testArticleList);
	ds_testArticleListTmp.filter("");
	
	for (var j = 0; j < ds_testArticleListTmp.getRowCount(); j++) {
		ds_testArticleListTmp.setRowType(j, Dataset.ROWTYPE_INSERT);
	}

    // 저장시 Validation Check
    if (gfn_validCheck(ds_specmArticleList, ds_specmArticleListValid, true) == false)	return;
    if (gfn_validCheck(ds_testArticleListTmp, ds_testArticleListValid, true) == false) return;
    
    // 자료를 저장 하시겠습니까?
    if (!gfn_confirm("confirm.before.save")) return false;

    // 접수거래처 세팅
    if (gfn_isNull(strInsptReqPlce))
    {
        if (typeof v_arg != "undefined" && v_arg != null && v_arg != "")
            strInsptReqPlce = v_arg[0];
        else
            strInsptReqPlce = "LIMS";
            
        ds_testReqAccept.setColumn(ds_testReqAccept.rowposition, "insptReqPlce", strInsptReqPlce);
    }

    // mask권한 Parameter
    ds_search.setColumn(0, "maskAuth", SCAuth.getMaskAuth(this));
    
    iSpecmSeqNum = 0;	// 검체순번 초기화

    var strSvcID    = "saveList";
    var strURL      = "ls/lrm/testInfoReg/saveList.xdo";
    var strInDs     = "ds_search=ds_search:A ds_testReqAccept=ds_testReqAccept:U ds_specmArticleList=ds_specmArticleList:U ds_testArticleList=ds_testArticleListTmp:U ds_paramValue=ds_paramValue";
    var strOutDs    = "ds_retval=ds_retval ds_testReqAccept=ds_testReqAccept ds_specmArticleList=ds_specmArticleList ds_testArticleListTmp=ds_testArticleListTmp";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

   gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
    // 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
    if (nErrorCode < 0)
    {
        return;
    }

    switch(strSvcID)
    {
        // 시험담당자 조회
        case "selectInsptUserList" :
            //trace(ds_insptUser.saveXML());

            // 공통코드 세팅
            LimsUtil.selectCodeBatchList(this, null, codeList);

            break;
        // 시험항목 조회
        case "selectTestArticleList" :
			//2018.06.16 김명섭 수수료3~5 데이터 초기화
            for (var i = 0; i < ds_testArticleListTmp.rowcount; i++)
            {
				ds_testArticleListTmp.setColumn(i,"comm3UseYn","N");
				ds_testArticleListTmp.setColumn(i,"comm3","0");
				ds_testArticleListTmp.setColumn(i,"comm4UseYn","N");
				ds_testArticleListTmp.setColumn(i,"comm4","0");
				ds_testArticleListTmp.setColumn(i,"comm5UseYn","N");
				ds_testArticleListTmp.setColumn(i,"comm5","0");
            }			
            // Filter된 DataSet 삭제
            fn_deleteTestArticle();

            // appendData는 그리드의 Focus를 잃어 버리기때문에
            // 아래와 같이 처리하여 append 후 첫 Row에 Focus를 준다.
            var nLastRow = ds_testArticleList.getRowCount();
            ds_testArticleList.appendData(ds_testArticleListTmp);
            ds_testArticleList.rowposition = nLastRow - 1;

            // appendData는 상태가 normal이므로 임의로 상태값을 변경 한다.
            for (var i = 0; i < ds_testArticleList.rowcount; i++)
            {
                ds_testArticleList.setRowType(i, Dataset.ROWTYPE_INSERT);
            }

            // 검사정보 체크
            fn_testArticleInfoCheck();

            fn_searchDetail();
            break;
        // 저장
        case "saveList" :
            if (fv_iProcessCnt > 0) gfn_alert("msg.save.success");	// 저장 되었습니다.

            // 시험정보 DataSet Clear
            ds_testArticleList.clearData();
            ds_testArticleList.copyData(ds_testArticleListTmp);
            ds_testArticleList.applyChange();

            // 검사정보 체크
            fn_testArticleInfoCheck();

            fn_searchDetail();

            div_cmnBtn.btn_insert.enable = true;
            div_cmnBtn.btn_delete.enable = false;
            div_cmnBtn.btn_save.enable = false;

			// 활성화 component
			var objSkipComp = [
			   ,"btn_selectSpecmTest"
			];
			LimsUtil.setComponentAuth(this, false, objSkipComp);
            strInsptReqPlce = "";

            // 저장된 의뢰번호로 재 조회 한다.
            //fn_search(ds_retval.getColumn(0, "reqNum"));

            break;
        // 조회
        case "selectList" :
            // 시험정보 DataSet Clear
            ds_testArticleList.clearData();

            //trace(ds_testArticleListTmp.saveXML());
            ds_testArticleList.copyData(ds_testArticleListTmp);

            // 검사정보 체크
            fn_testArticleInfoCheck();

            fn_searchDetail();

            //trace(ds_testArticleList.saveXML());

// 			div_cmnBtn.btn_insert.enable = false;
// 			div_cmnBtn.btn_delete.enable = false;
// 			div_cmnBtn.btn_save.enable = false;

            LimsUtil.setComponentAuth(this, false);

            break;
        // 기 접수등록내역 조회
        case "searchPreAcceptReq" :
			//2018.06.16 김명섭 수수료3~5 데이터 초기화
            for (var i = 0; i < ds_testArticleListTmp.rowcount; i++)
            {
				ds_testArticleListTmp.setColumn(i,"comm3UseYn","N");
				ds_testArticleListTmp.setColumn(i,"comm3","0");
				ds_testArticleListTmp.setColumn(i,"comm4UseYn","N");
				ds_testArticleListTmp.setColumn(i,"comm4","0");
				ds_testArticleListTmp.setColumn(i,"comm5UseYn","N");
				ds_testArticleListTmp.setColumn(i,"comm5","0");
            }			
            // 시험정보 DataSet Clear
            ds_testArticleList.clearData();
            ds_testArticleList.copyData(ds_testArticleListTmp);

            // 검사정보 체크
            fn_testArticleInfoCheck();
            
			// 접수정보 세팅
			ds_testReqAccept.setRowType(0, Dataset.ROWTYPE_INSERT);
            ds_testReqAccept.setColumn(0, "reqNum", "");
            ds_testReqAccept.setColumn(0, "lastDecision", "");
            ds_testReqAccept.setColumn(0, "acceptClass", "");
            ds_testReqAccept.setColumn(0, "progressStatus", "");
            ds_testReqAccept.setColumn(0, "reqDate", curDate.replace("-",""));
            
            // 검체정보 세팅
            for (var i = 0; i < ds_specmArticleList.getRowCount(); i++) {
				ds_specmArticleList.setColumn(i, "reqNum", "");
				ds_specmArticleList.setColumn(i, "acceptNum", "");
				ds_specmArticleList.setColumn(i, "acceptdd", curDate.replace("-",""));
			}
			
			// 시험정보 세팅
			for (var j = 0; j < ds_testArticleList.getRowCount(); j++) {
				ds_testArticleList.setColumn(j, "reqNum", "");
				ds_testArticleList.setColumn(j, "acceptNum", "");
			}
			
			// 시험정보 Temp 세팅
			for (var j = 0; j < ds_testArticleListTmp.getRowCount(); j++) {
				ds_testArticleListTmp.setColumn(j, "reqNum", "");
				ds_testArticleListTmp.setColumn(j, "acceptNum", "");
			}

			fn_searchDetail();

            break;
            
        // 기타검체유형정보 등록
        case "saveEtcSpecmArticleList" :
            if (fv_iProcessCnt > 0) gfn_alert("msg.save.success");	// 저장 되었습니다.
            // 새로 등록된 검체코드를 등록한다.
            if (ds_retval.rowposition != -1)
            {
                //trace("specmCd >>>>>>> " + ds_retval.getColumn(0, "specmCd"));
                ds_specmArticleList.setColumn(ds_specmArticleList.rowposition, "specmCd", ds_retval.getColumn(0, "specmCd"));
// 				var nRow = ds_specmArticleList.rowposition;
// 				var nIdx = ds_specmArticleList.addRow();
// 				ds_specmArticleList.copyRow(nIdx, ds_specmArticleList, nRow);
// 				// 원본의검체명은 원상복귀
// 				//ds_specmArticleList.setColumn(nRow, "specmNm", ds_specmArticleList.getOrgColumn(nRow, "specmNm"));
// 				// 복사 후 받아온 검체코드 세팅
// 				ds_specmArticleList.setColumn(nIdx, "seqNum", iSpecmSeqNum++);
// 				ds_specmArticleList.setColumn(nIdx, "specmCd", ds_retval.getColumn(0, "specmCd"));
//
// 				fn_deleteTestArticle();
// 				fn_searchDetail();
            }

            for (var i = 0; i < ds_specmArticleList.rowcount; i++)
            {
                 ds_specmArticleList.setRowType(i, Dataset.ROWTYPE_INSERT);
            }
//
// 			ds_testArticleList.clearData();
            break;
        case "selectUpjangList" :
            if (ds_paramValue.rowposition != -1)
            {
                if (ds_paramValue.getColumn(ds_paramValue.rowposition, "str1") == "IFIS")
                {
                    ds_testReqAccept.setColumn(ds_testReqAccept.rowposition, "upjang", ds_upjangList.getColumn(0, "upjang"));
                    ds_testReqAccept.setColumn(ds_testReqAccept.rowposition, "upjangNm", ds_upjangList.getColumn(0, "upjangnm"));
                    ds_testReqAccept.setColumn(ds_testReqAccept.rowposition, "acceptClass", '105');	// 협력업체 업장
                    ds_testReqAccept.setColumn(ds_testReqAccept.rowposition, "orgNm", ds_upjangList.getColumn(0, "orgPath"));
                    ds_testReqAccept.setColumn(ds_testReqAccept.rowposition, "vdCd", ds_paramValue.getColumn(ds_paramValue.rowposition, "str6"));

                    sta_orgNm.text = ds_upjangList.getColumn(0, "orgPath");
                    edt_ceo.value = ds_upjangList.getColumn(0, "ceo");
                    edt_bizNo.value = ds_upjangList.getColumn(0, "saupno");
                    //trace(ds_testReqAccept.saveXML());
                }
            }
        // 자재코드 조회 시 등록된 기타검체가 있으면 조회하여 해당 내역을 화면에 출력 한다.
        case "selectSpecmMappging" :
            //ds_specmArticleList.copyData(ds_specmArticleListTmp);	// 요거는 건드리지 말아야 할 필드까지 초기화 시킨다.
            //LimsUtil.setArrParamBind(ds_specmArticleList, LimsUtil.setPopupParam(ds_specmArticleListTmp));
            //trace(ds_specmArticleListTmp.saveXML());
            LimsUtil.setDataSetToDataSetBind(ds_specmArticleList, ds_specmArticleListTmp);
            break;
            
		case "selectLoadTemp" :
			//2018.06.16 김명섭 수수료3~5 데이터 초기화
            for (var i = 0; i < ds_testArticleListTmp.rowcount; i++)
            {
				ds_testArticleListTmp.setColumn(i,"comm3UseYn","N");
				ds_testArticleListTmp.setColumn(i,"comm3","0");
				ds_testArticleListTmp.setColumn(i,"comm4UseYn","N");
				ds_testArticleListTmp.setColumn(i,"comm4","0");
				ds_testArticleListTmp.setColumn(i,"comm5UseYn","N");
				ds_testArticleListTmp.setColumn(i,"comm5","0");
            }			

            // 시험정보
            ds_testArticleList.clearData();
            ds_testArticleList.copyData(ds_testArticleListTmp);
            fn_testArticleInfoCheck();

			// 접수정보 세팅
            ds_testReqAccept.setColumn(0, "reqNum", "");
            ds_testReqAccept.setColumn(0, "lastDecision", "");
            ds_testReqAccept.setColumn(0, "acceptClass", "");
            ds_testReqAccept.setColumn(0, "progressStatus", "");
            ds_testReqAccept.setColumn(0, "reqDate", curDate.replace("-",""));
            ds_testReqAccept.setRowType(0, Dataset.ROWTYPE_INSERT);
            
            // 검체정보 세팅
            for (var i = 0; i < ds_specmArticleList.getRowCount(); i++) {
				ds_specmArticleList.setColumn(i, "reqNum", "");
				ds_specmArticleList.setColumn(i, "acceptNum", "");
				ds_specmArticleList.setColumn(i, "acceptdd", curDate.replace("-",""));
				ds_specmArticleList.setRowType(i, Dataset.ROWTYPE_INSERT);
			}
			
			// 시험정보 세팅
			for (var j = 0; j < ds_testArticleList.getRowCount(); j++) {
				ds_testArticleList.setColumn(j, "reqNum", "");
				ds_testArticleList.setColumn(j, "acceptNum", "");
				ds_testArticleList.setRowType(j, Dataset.ROWTYPE_INSERT);
			}
			
			// 시험정보 Temp 세팅
			for (var j = 0; j < ds_testArticleListTmp.getRowCount(); j++) {
				ds_testArticleListTmp.setColumn(j, "reqNum", "");
				ds_testArticleListTmp.setColumn(j, "acceptNum", "");
				ds_testArticleListTmp.setRowType(j, Dataset.ROWTYPE_INSERT);
			}

			//검체목록 클릭 시 입력된 시험항목 Filter 조회
			fn_searchDetail();

            break;            
            
		case "saveTemp" :
            if (fv_iProcessCnt > 0) gfn_alert("msg.save.success");	// 저장 되었습니다.

            // 시험정보 DataSet Clear
            ds_testArticleList.clearData();
            ds_testArticleList.copyData(ds_testArticleListTmp);
            ds_testArticleList.applyChange();

            // 검사정보 체크
            fn_testArticleInfoCheck();

			//검체목록 클릭 시 입력된 시험항목 Filter 조회
            fn_searchDetail();

            div_cmnBtn.btn_insert.enable = true;
            div_cmnBtn.btn_delete.enable = false;
            div_cmnBtn.btn_save.enable = true;

			/*
			// 활성화 component
			var objSkipComp = [
			   ,"btn_selectSpecmTest"
			   ,"btn_loadTemp"
			   ,"btn_saveTemp"
			];
			LimsUtil.setComponentAuth(this, false, objSkipComp);
            strInsptReqPlce = "";
            */
            
            break;
            
        case "selectspecmSearch" :

 			break;

    
        case "selectexlTestArticleList" :
            for (var i = 0; i < ds_testArticleListTmp.rowcount; i++)
            {
				ds_testArticleListTmp.setColumn(i,"comm3UseYn","N");
				ds_testArticleListTmp.setColumn(i,"comm3","0");
				ds_testArticleListTmp.setColumn(i,"comm4UseYn","N");
				ds_testArticleListTmp.setColumn(i,"comm4","0");
				ds_testArticleListTmp.setColumn(i,"comm5UseYn","N");
				ds_testArticleListTmp.setColumn(i,"comm5","0");
            }			
            // Filter된 DataSet 삭제
            fn_deleteTestArticle();

            // appendData는 그리드의 Focus를 잃어 버리기때문에
            // 아래와 같이 처리하여 append 후 첫 Row에 Focus를 준다.
            var nLastRow = ds_testArticleList.getRowCount();
            ds_testArticleList.appendData(ds_testArticleListTmp);
            ds_testArticleList.rowposition = nLastRow - 1;

            // appendData는 상태가 normal이므로 임의로 상태값을 변경 한다.
            for (var i = 0; i < ds_testArticleList.rowcount; i++)
            {
                ds_testArticleList.setRowType(i, Dataset.ROWTYPE_INSERT);
            }

            // 검사정보 체크
            fn_testArticleInfoCheck();

            fn_searchDetail();
            break;
    }
}

/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 시험 담당자 조회
 *---------------------------------------------------------------------------------------------*/
function fn_selectInsptUser()
{
    ds_search.setColumn(0, "authCd", "101");	// 담당자권한 코드중 검사자

    var strSvcID    = "selectInsptUserList";
    var strURL      = "ls/lcm/userMgmt/selectUserList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_insptUser=ds_userList";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync, false);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 타 모듈에서 넘어오는 업장코드 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchUpjang()
{
    ds_search.setColumn(0, "acceptClass", '105');	// 협력업체
    ds_search.setColumn(0, "edtSearch", ds_paramValue.getColumn(0, "str4"));	// 거래처 코드

    var strSvcID    = "selectUpjangList";
    var strURL      = "ls/lrm/testInfoReg/selectUpjangList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_upjangList=ds_upjangList";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync, false);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 사업장 팝업 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_searchUpjang_onclick(obj:Button,  e:ClickEventInfo)
{
    var arrParam = new Array();

    var rtnVal = gfn_dialog("UpjangInqueryPop"				// dialogId
                       , "X_LRM::UpjangInqueryPop.xfdl"			// Url
                       , {fv_Contents:arrParam}			// 배열
                       , null, null, null, null, null, false, true, -1);

    if (typeof rtnVal != "undefined" && rtnVal != null && gfn_getObjkeyLength(rtnVal) > 0)
    {
        ds_testReqAccept.setColumn(ds_testReqAccept.rowposition, "upjang", rtnVal.upjang);
        ds_testReqAccept.setColumn(ds_testReqAccept.rowposition, "upjangNm", rtnVal.upjangnm);
        ds_testReqAccept.setColumn(ds_testReqAccept.rowposition, "acceptClass", rtnVal.acceptClass);
        ds_testReqAccept.setColumn(ds_testReqAccept.rowposition, "orgNm", rtnVal.orgPath);
        edt_acceptClassNm.value = rtnVal.acceptClassNm;

        sta_orgNm.text = rtnVal.orgPath;
        edt_ceo.value = rtnVal.ceo;
        edt_bizNo.value = rtnVal.saupno;
    }
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 검체유형 팝업 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_searchSpecmTypePop_onclick(obj:Button,  e:ClickEventInfo)
{
    if (cbo_specmType.index == -1)
    {
        gfn_alert("검체유형을 선택하여 주십시오.");
        return;
    }

    var arrParam = new Array();
    arrParam[0] = cbo_specmType.value;
    arrParam[1] = "";
    //2018.05.31 김명섭 검체유형수정가능(edt_specmTypeNm속성변경: readonly=true삭제)
    //arrParam[2] = ds_specmArticleList.getColumn(ds_specmArticleList.rowposition, "mgrpCd");
    //arrParam[3] = ds_specmArticleList.getColumn(ds_specmArticleList.rowposition, "mcalssCd");

    var rtnVal = gfn_dialog("SpecmTypeInqueryPop"				// dialogId
                       , "X_LCM::SpecmTypeInqueryPop.xfdl"			// Url
                       , {fv_Contents:arrParam}			// 배열
                       , null, null, null, null, null, false, true, -1);

    if (typeof rtnVal != "undefined" && rtnVal != null && gfn_getObjkeyLength(rtnVal) > 0)
    {
        edt_specmTypeNm.value = rtnVal.mgrpNm + " / " + rtnVal.mcalssNm + " / " + rtnVal.sclassNm;

        // Popup에서 넘어온 객체의 값을 DataSet에 Binding 시킨다.
        LimsUtil.setArrParamBind(ds_specmArticleList, rtnVal);

// 		ds_specmArticleList.setColumn(ds_specmArticleList.rowposition, "mgrpCd", rtnVal.mgrpCd);
// 		ds_specmArticleList.setColumn(ds_specmArticleList.rowposition, "mcalssCd", rtnVal.mcalssCd);
// 		ds_specmArticleList.setColumn(ds_specmArticleList.rowposition, "sclassCd", rtnVal.sclassCd);
    }
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 검체유형세부 팝업 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_searchSpecmTypePclsPop_onclick(obj:Button,  e:ClickEventInfo)
{
    var arrParam = new Array();

    var rtnVal = gfn_dialog("SpecmTypeDtlInqueryPop"				// dialogId
                       , "X_LRM::SpecmTypeDtlInqueryPop.xfdl"			// Url
                       , {fv_Contents:arrParam}			// 배열
                       , null, null, null, null, null, false, true, -1);

    if (typeof rtnVal != "undefined" && rtnVal != null && gfn_getObjkeyLength(rtnVal) > 0)
    {
        edt_specmTypePclsNm.value = rtnVal.codeName;
        ds_specmArticleList.setColumn(ds_specmArticleList.rowposition, "specmTypePcls", rtnVal.code);
    }
}

/***************************************************************************
 * 설명    		: 검체유형 팝업 조회
 ***************************************************************************/
function btn_searchSpecmPop_onclick(obj:Button,  e:ClickEventInfo)
{
    if (cbo_specmClass.index == -1)
    {
        gfn_alert("검체분류를 선택하여 주십시오.");
        return;
    }

    var arrParam = new Array();

    arrParam[0] = cbo_specmClass.value;

    var rtnVal = gfn_dialog("SpecmListInqueryPop"				// dialogId
                       , "X_LRM::SpecmListInqueryPop.xfdl"			// Url
                       , {fv_Contents:arrParam}			// 배열
                       , null, null, null, null, null, false, true, -1);

    //trace(gfn_jsonObjectToString(rtnVal));

    if (typeof rtnVal != "undefined" && rtnVal != null && gfn_getObjkeyLength(rtnVal) > 0)
    {
        edt_stand.value       = rtnVal.stand;
        edt_unit.value        = rtnVal.unit;
        edt_origin.value      = rtnVal.origin;
        cbo_chargBasis.value  = rtnVal.chargBasis;

        edt_specmTypeNm.value = "";

        // Popup에서 넘어온 객체의 값을 DataSet에 Binding 시킨다.
        LimsUtil.setArrParamBind(ds_specmArticleList, rtnVal);

        // 중복검체 체크
        if (!fn_dupCheckSpecmInfo())
        {
            gfn_alert("중복등록된 검체정보가 있습니다.");
            //ds_specmArticleList.deleteRow(ds_specmArticleList.rowposition);
            // 시험항목 삭제
            fn_deleteTestArticle();
            fn_searchDetail();
            return;
        }
        else
        {
            // 등록제품(거래중인식재료)는 자재에서 조회되기 때문에
            // 별도로 기타검체에 데이터가 있는지 조회하여 보여준다.
            if (cbo_specmClass.value == "101")
            {
                fn_specmSearch();
            }
        }

        // 선택된 검체에 대한 Filter
        fn_searchDetail();
        //ds_testArticleList.filter("seqNum == '" + ds_specmArticleList.getColumn(ds_specmArticleList.rowposition, "seqNum") + "'");	// 검체코드 일련번호
        //ds_testArticleList.rowposition = 0;
    }
}

/***************************************************************************
 * 설명    		: 선택된 검체에 대해 기타검체유형에 매핑된 검체정보 조회
 ***************************************************************************/
function fn_specmSearch(tranGubun)
{
    // 임시 Dataset을 초기화한다.
    ds_specmArticleListTmp.clearData();

    // 검체목록에서 선택된 검체로 조회 한다.
    ds_search.setColumn(0, "specmCd", ds_specmArticleList.getColumn(ds_specmArticleList.rowposition, "specmCd"));

    var strSvcID    = "selectSpecmMappging";
    var strURL      = "ls/lcm/etcSpecmArticleMgmt/selectList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_specmArticleListTmp=ds_etcSpecmArticleList";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = (tranGubun == undefined?true:false);

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/***************************************************************************
 * 설명    		: 시험항목 조회 버튼 클릭
 ***************************************************************************/
function btn_selectTestArticle_onclick(obj:Button,  e:ClickEventInfo)
{
    fn_selectTestArticleMapp();
}

/***************************************************************************
 * 설명    		: 검체목록을 조건으로 시험항목 조회
 ***************************************************************************/
function fn_selectTestArticleMapp()
{
    if (ds_specmArticleList.rowcount == -1)
    {
        gfn_alert("검체정보를 입력하여 주십시오.");
        return;
    }

    // 중복검체 체크
    if (!fn_dupCheckSpecmInfo())
    {
        gfn_alert("중복등록된 검체정보가 있습니다.");
        return;
    }

    var nRow = ds_specmArticleList.rowposition;
    if (gfn_isNull(ds_specmArticleList.getColumn(nRow, "specmCd")))
    {
        gfn_alert("검체항목을 선택하여 주십시오.\n검체정보를 새로 등록하는 경우 먼저 [입력검체등록]을 클릭하여 저장해 주십시오.");
        return;
    }
    if (gfn_isNull(ds_specmArticleList.getColumn(nRow, "specmType")))
    {
        gfn_alert("공전유형을 선택하여 주십시오.");
        return;
    }
    if (gfn_isNull(ds_specmArticleList.getColumn(nRow, "mgrpCd")) ||
        gfn_isNull(ds_specmArticleList.getColumn(nRow, "mcalssCd")) ||
        gfn_isNull(ds_specmArticleList.getColumn(nRow, "sclassCd"))
       )
    {
        gfn_alert("검체유형을 선택하여 주십시오.");
        return;
    }
// 	if (gfn_isNull(ds_specmArticleList.getColumn(nRow, "longstorageYn")))
// 	{
// 		gfn_alert("장기보존여부를 선택하여 주십시오.");
// 		return;
// 	}
    if (gfn_isNull(ds_specmArticleList.getColumn(nRow, "insptPurp2")))
    {
        gfn_alert("검사목적2를 선택하여 주십시오.");
        return;
    }

    if (!gfn_confirm("기 등록된 시험항목 데이터가 초기화 됩니다.\n조회 하시겠습니까?", "", "C")) return;

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_testArticleList);

    // Dataset을 초기화한다.
    ds_testArticleListTmp.clearData();
    ds_testArticleListTmp.filter("");

    // Filter된 Dataset삭제
    fn_deleteTestArticle();

    ds_search.setColumn(0, "seqNum"       , ds_specmArticleList.getColumn(nRow, "seqNum"));
    ds_search.setColumn(0, "specmCd"      , ds_specmArticleList.getColumn(nRow, "specmCd"));
    ds_search.setColumn(0, "specmType"    , ds_specmArticleList.getColumn(nRow, "specmType"));
    ds_search.setColumn(0, "mgrpCd"       , ds_specmArticleList.getColumn(nRow, "mgrpCd"));
    ds_search.setColumn(0, "mcalssCd"     , ds_specmArticleList.getColumn(nRow, "mcalssCd"));
    ds_search.setColumn(0, "sclassCd"     , ds_specmArticleList.getColumn(nRow, "sclassCd"));
    ds_search.setColumn(0, "insptPurp2"   , ds_specmArticleList.getColumn(nRow, "insptPurp2"));
    ds_search.setColumn(0, "longstorageYn", ds_specmArticleList.getColumn(nRow, "longstorageYn"));
    ds_search.setColumn(0, "specmTypePcls", ds_specmArticleList.getColumn(nRow, "specmTypePcls"));

    var strSvcID    = "selectTestArticleList";
    var strURL      = "ls/lrm/testInfoReg/selectTestArticleList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_testArticleListTmp=ds_testArticleList";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
 
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/***************************************************************************
 * 설명   : 검체정보 저장 시 중복 등록 체크
 ***************************************************************************/
function fn_dupCheckSpecmInfo()
{
    var dupCnt = 0;
    var hm = new jHashMap();
    for (var i = 0; i < ds_specmArticleList.rowcount; i++)
    {
        if (hm.containsKey(ds_specmArticleList.getColumn(i, "specmCd")))
        {
            dupCnt++;
            break;
        }
        else
        {
            hm.put(ds_specmArticleList.getColumn(i, "specmCd"));
        }
    }

    if (dupCnt > 0) return false;
    else            return true;
}

/***************************************************************************
 * 설명   : 시험정보 저장 시 중복 등록 체크
 ***************************************************************************/
function fn_dupCheckTestInfo()
{
    var dupCnt = 0;
    var hm = new jHashMap();

    ds_testArticleListTmp.clearData();
    ds_testArticleListTmp.copyData(ds_testArticleList);
    ds_testArticleListTmp.applyChange();
    ds_testArticleListTmp.filter("");

    var nCheckCnt = 0;
    for (var j = 0; j < ds_specmArticleList.rowcount; j++)
    {
        nCheckCnt = 0;
        ds_testArticleListTmp.filter("seqNum == '" + ds_specmArticleList.getColumn(j, "seqNum") + "'");	// 검체코드 일련번호

        for (var i = 0; i < ds_testArticleListTmp.rowcount; i++)
        {
           if (hm.containsKey(ds_testArticleListTmp.getColumn(i, "seqNum")+ds_testArticleListTmp.getColumn(i, "articleCd")))
            {
                dupCnt++;
                break;
            }
            else
            {
                hm.put(ds_testArticleListTmp.getColumn(i, "seqNum")+ds_testArticleListTmp.getColumn(i, "articleCd"));
            }
        }

        if (dupCnt > 0) break;
    }

    if (dupCnt > 0) return false;
    else            return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 법적기준, 내부기준 입력 체크
 *---------------------------------------------------------------------------------------------*/
function fn_basisCheck(objDs, nRowIdx)
{
    if ((gfn_isNull(objDs.getColumn(nRowIdx, "legalBasis")) && gfn_isNull(objDs.getColumn(nRowIdx, "insideBasis"))) ||
        (objDs.getColumn(nRowIdx, "legalBasis") == '0' && objDs.getColumn(nRowIdx, "insideBasis") == '0')
       ) return false;
    else return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 법적기준, 내부기준 중복 체크
 *---------------------------------------------------------------------------------------------*/
function fn_basisDupCheck(objDs, nRowIdx)
{
    if (objDs.getColumn(nRowIdx, "legalBasis") == '1' && objDs.getColumn(nRowIdx, "insideBasis") == '1') return false;
    else return true;
}

/***************************************************************************
 * 설명   : 수수료구분이 유상인 경우 선택 체크
 ***************************************************************************/
function fn_commCheckTestInfo()
{
    ds_testArticleListTmp.clearData();
    ds_testArticleListTmp.filter("");
    ds_testArticleListTmp.copyData(ds_testArticleList);
    ds_testArticleListTmp.applyChange();

    var nCheckCnt = 0;
    for (var j = 0; j < ds_specmArticleList.rowcount; j++)
    {
        if (ds_specmArticleList.getColumn(j, "costClass") == '102')	// 유상
        {
            ds_testArticleListTmp.filter("seqNum == '" + ds_specmArticleList.getColumn(j, "seqNum") + "'");	// 검체코드 일련번호
            //trace(ds_testArticleListTmp.rowcount);
            nCheckCnt = 0;
            for (var i = 0; i < ds_testArticleListTmp.rowcount; i++)
            {
                if ((gfn_isNull(ds_testArticleListTmp.getColumn(i, "comm1UseYn")) || ds_testArticleListTmp.getColumn(i, "comm1UseYn") == "0") &&
                    (gfn_isNull(ds_testArticleListTmp.getColumn(i, "comm2UseYn")) || ds_testArticleListTmp.getColumn(i, "comm2UseYn") == "0")
                    //(gfn_isNull(ds_testArticleListTmp.getColumn(i, "comm3UseYn")) || ds_testArticleListTmp.getColumn(i, "comm3UseYn") == "0") &&
                    //(gfn_isNull(ds_testArticleListTmp.getColumn(i, "comm4UseYn")) || ds_testArticleListTmp.getColumn(i, "comm4UseYn") == "0") &&
                    //(gfn_isNull(ds_testArticleListTmp.getColumn(i, "comm5UseYn")) || ds_testArticleListTmp.getColumn(i, "comm5UseYn") == "0")
                   )
                {
                    nCheckCnt++;
                }
            }
            //trace("nCheckCnt >>>> " + nCheckCnt);
            if (nCheckCnt > 0) return false;
        }
    }
    return true;
}

/***************************************************************************
 * 설명    		: Filter된 DataSet 삭제
 ***************************************************************************/
function fn_deleteTestArticle()
{
    // Filter된 Dataset삭제
    var strSeqNum = ds_specmArticleList.getColumn(ds_specmArticleList.rowposition, "seqNum");
    for (var i = ds_testArticleList.rowcount; i >= 0; i--)
    {
        if (strSeqNum == ds_testArticleList.getColumn(i, "seqNum"))
        {
            ds_testArticleList.deleteRow(i);	// 특정 검체코드 삭제
        }
    }
}

/***************************************************************************
 * 설명    		: 검사정보 체크
 ***************************************************************************/
function fn_testArticleInfoCheck()
{
    var nRow = ds_specmArticleList.rowcount;
    var nCnt = ds_testArticleListTmp.rowcount;

    //trace("ds_testArticleListTmp Cnt >>>>> " + nCnt);
    for (var i = 0; i < nRow; i++)
    {
        for (var j = 0; j < nCnt; j++)
        {
            //trace(ds_specmArticleList.getColumn(i, "seqNum") + " , " + ds_testArticleListTmp.getColumn(j, "seqNum"));
            if (ds_specmArticleList.getColumn(i, "seqNum") == ds_testArticleListTmp.getColumn(j, "seqNum"))
            {
                if (ds_testArticleListTmp.getColumn(j, "legalBasis") == '1') ds_specmArticleList.setColumn(i, "legalBasis", "1");
                if (ds_testArticleListTmp.getColumn(j, "insideBasis") == '1') ds_specmArticleList.setColumn(i, "insideBasis", "1");

                if (ds_testArticleListTmp.getColumn(j, "micbio") == '1') ds_specmArticleList.setColumn(i, "micbio", "1");
                if (ds_testArticleListTmp.getColumn(j, "phychem") == '1') ds_specmArticleList.setColumn(i, "phychem", "1");

                if (ds_testArticleListTmp.getColumn(j, "micbio1Grade") == '1') ds_specmArticleList.setColumn(i, "micbio1Grade", "1");
                if (ds_testArticleListTmp.getColumn(j, "micbio2Grade") == '1') ds_specmArticleList.setColumn(i, "micbio2Grade", "1");
                if (ds_testArticleListTmp.getColumn(j, "micbio3Grade") == '1') ds_specmArticleList.setColumn(i, "micbio3Grade", "1");
                if (ds_testArticleListTmp.getColumn(j, "micbio4Grade") == '1') ds_specmArticleList.setColumn(i, "micbio4Grade", "1");
                if (ds_testArticleListTmp.getColumn(j, "micbio5Grade") == '1') ds_specmArticleList.setColumn(i, "micbio5Grade", "1");

                if (ds_testArticleListTmp.getColumn(j, "phychem1Grade") == '1') ds_specmArticleList.setColumn(i, "phychem1Grade", "1");
                if (ds_testArticleListTmp.getColumn(j, "phychem2Grade") == '1') ds_specmArticleList.setColumn(i, "phychem2Grade", "1");
                if (ds_testArticleListTmp.getColumn(j, "phychem3Grade") == '1') ds_specmArticleList.setColumn(i, "phychem3Grade", "1");
                if (ds_testArticleListTmp.getColumn(j, "phychem4Grade") == '1') ds_specmArticleList.setColumn(i, "phychem4Grade", "1");
                if (ds_testArticleListTmp.getColumn(j, "phychem5Grade") == '1') ds_specmArticleList.setColumn(i, "phychem5Grade", "1");
            }
        }
    }
}

/***************************************************************************
 * 설명    		: 검체목록 추가
 ***************************************************************************/
function btn_addSpecm_onclick(obj:Button,  e:ClickEventInfo)
{
    if (ds_testReqAccept.rowposition == -1)
    {
        gfn_alert("접수정보를 입력하여 주십시오.");
        return;
    }

    var nIdx = ds_specmArticleList.insertRow(ds_specmArticleList.rowposition + 1);
    //trace("추가 ==> " + ds_specmArticleList.rowcount);
    ds_specmArticleList.setColumn(nIdx, "seqNum", iSpecmSeqNum++);
    ds_specmArticleList.setColumn(nIdx, "specmCd", "");
    ds_specmArticleList.setColumn(nIdx, "specmNm", "");

    cal_acceptdd.fn_setValue(curDate);
    cbo_costClass.index = 0;
    
    cbo_insptObj3.index = 0;
    
    ds_specmArticleList.setRowType(nIdx, Dataset.ROWTYPE_INSERT);
    
    //fn_deleteTestArticle();	// 시험항목 삭제
    fn_searchDetail();
}

/***************************************************************************
 * 설명    		: 검체목록 삭제
 ***************************************************************************/
function btn_delSpecm_onclick(obj:Button,  e:ClickEventInfo)
{
    fn_deleteTestArticle();
    ds_specmArticleList.deleteRow(ds_specmArticleList.rowposition);

    fn_searchDetail();
}

/***************************************************************************
 * 설명    		: 검체목록 다음행에 복사
 ***************************************************************************/
function btn_coppySpecm_onclick(obj:Button,  e:ClickEventInfo)
{
	if (ds_specmArticleList.rowposition == -1) return;
    if (!gfn_confirm("중복데이터에 주의하여 검체정보를 새로 입력하여 주십시오.\n복사 하시겠습니까?", "", "C")) return;

    var nRow = ds_specmArticleList.rowposition;
    //2018.02.20 김명섭 [CH201802_00108]
    //var nIdx = ds_specmArticleList.addRow();
    var nIdx = ds_specmArticleList.insertRow(ds_specmArticleList.rowposition + 1);
    ds_specmArticleList.copyRow(nIdx, ds_specmArticleList, nRow);

    //trace("복사 ==> " + ds_specmArticleList.rowcount);
    ds_specmArticleList.setColumn(nIdx, "seqNum", iSpecmSeqNum++);
    ds_specmArticleList.setColumn(nIdx, "specmCd", "");
    ds_specmArticleList.setColumn(nIdx, "specmNm", "");
/*
    //2018.02.20 김명섭 [CH201802_00108]
    if (ds_testArticleList.getRowCount() > 0) {
		if (!gfn_confirm("시험항목을 복사 하시겠습니까?", "", "C")) return;

		ds_testArticleListTmp00.clearData();	// 시험정보 Temp00 DataSet 초기화
		ds_testArticleListTmp00.filter("");

		// 시험정보 Temp00 세팅
		ds_testArticleListTmp00.copyData(ds_testArticleList);
		ds_testArticleListTmp00.filter("");
    }
*/
    fn_deleteTestArticle();
    fn_searchDetail();

}

/***************************************************************************
 * 설명    		: 검체목록 head 클릭
 ***************************************************************************/
function grd_specmArticleList_onheadclick(obj:Grid, e:GridClickEventInfo)
{
    if (obj.readonly == true) return;
    gfn_gridSort(obj, e);
}

/***************************************************************************
 * 설명    		: 검체목록 클릭
 ***************************************************************************/
function grd_specmArticleList_oncellclick(obj:Grid, e:GridClickEventInfo)
{
    fn_searchDetail();	// 입력된 시험항목 Filter 조회
}

/***************************************************************************
 * 설명    		: 검체목록 클릭 시 입력된 시험항목 Filter 조회
 ***************************************************************************/
function fn_searchDetail()
{
    ds_testArticleList.filter("seqNum == '" + ds_specmArticleList.getColumn(ds_specmArticleList.rowposition, "seqNum") + "'");	// 검체코드 일련번호
    ds_testArticleList.rowposition = 0;

    //this.vscrollbar.pos = 190;	// 검체목록 클릭 시 스크롤 하단으로 이동

//     grd_testArticleList.setFocus();
//     grd_testArticleList.setCellPos(0);
//     grd_testArticleList.showEditor(true);
//     grd_testArticleList.showEditor(false);
}

/***************************************************************************
 * 설명    		: 시험항목 head 클릭
 ***************************************************************************/
function grd_testArticleList_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	var objDs;
	
    if (obj.readonly == true) return;
   
    if(e.cell == 18) {	//검사자체크박스(18)
		for (var i = 1; i < ds_testArticleList.rowcount; i++)
		{
			ds_testArticleList.setColumn(i, 25, ds_testArticleList.getColumn(0,25));
		}
	} else if(e.cell == 20) {	//검사항목체크박스(20)
		for (var i = 1; i < ds_testArticleList.rowcount; i++)
		{
			ds_testArticleList.setColumn(i, 26, ds_testArticleList.getColumn(0,26));
		}
    } else {
        if (e.cell == 6) //법적기준
        {
            objDs = eval(obj.binddataset);
            for (var i = 0; i < objDs.rowcount; i++)
			{
				//if (objDs.getColumn(i, "legalBasis") == "1") objDs.setColumn(i, "legalBasis", "0");
				//else objDs.setColumn(i, "legalBasis", "1");
				objDs.setColumn(i, "legalBasis", "1");
				objDs.setColumn(i, "insideBasis", "0");
			}
			return;
        }
        if (e.cell == 7) //내부기준
        {
            objDs = eval(obj.binddataset);
            for (var i = 0; i < objDs.rowcount; i++)
			{
				//if (objDs.getColumn(i, "insideBasis") == "1") objDs.setColumn(i, "insideBasis", "0");
				//else objDs.setColumn(i, "insideBasis", "1");
				objDs.setColumn(i, "insideBasis", "1");
				objDs.setColumn(i, "legalBasis", "0");
			}
			return;
        }
        
		gfn_gridSort(obj, e);
		if (e.cell != 12) return;

		gfn_setGridItemCheckAll(obj, e, "comm1UseYn");
    }
}

/***************************************************************************
 * 설명    		: 시험항목 클릭
 ***************************************************************************/
function grd_testArticleList_oncellclick(obj:Grid, e:GridClickEventInfo)
{
    gfn_setGridRadioEventHandler(obj, e);

	if(e.col == 22)
	{
		// 검사분야에 따른 검사자 Filter
		ds_insptUser.filter("insptFld == '" + ds_testArticleList.getColumn(ds_testArticleList.rowposition, "insptFld") + "'");
	}
}

/***************************************************************************
 * 설명    		: 시험항목 그리드 Popup 조회버튼 클릭
 ***************************************************************************/
function grd_testArticleList_onexpanddown(obj:Grid, e:GridMouseEventInfo)
{
    fn_checkTestArticlePop(obj, e);
}

/***************************************************************************
 * 설명    		: 시험항목 그리드 추가 버튼 클릭
 ***************************************************************************/
function btn_addTestArticle_onclick(obj:Button,  e:ClickEventInfo)
{
    if (ds_specmArticleList.rowposition == -1)
    {
        gfn_alert("검체정보를 입력하여 주십시오.");
        return;
    }

	var arrParam = new Array();
	var rtnDs= gfn_dialog("TestArticleInqueryMultiPop"					// dialogId
					   , "X_LRM::TestArticleInqueryMultiPop.xfdl"		// Url
					   , {fv_Contents:arrParam}			// 배열
					   , null, null, null, null, null, false, true, -1);

	//팝업에서 다중선택한 데이터를 추가하도록 기능 변경(20171120 유선미)
	for(var i = 0; i < rtnDs.getRowCount(); i++)
	{
		var nRow = ds_testArticleList.addRow();

		ds_testArticleList.setColumn(nRow, "specmType"	, cbo_specmType.value);
		ds_testArticleList.setColumn(nRow, "seqNum"		, ds_specmArticleList.getColumn(ds_specmArticleList.rowposition, "seqNum"));
		ds_testArticleList.setColumn(nRow, "specmCd"	, ds_specmArticleList.getColumn(ds_specmArticleList.rowposition, "specmCd"));
		ds_testArticleList.setColumn(nRow, "testClass"	, "TEST");	// 시험항목에서 등록을 표시, 장기보존은 'LONG'
		
		if (ds_testArticleList.getColumn(nRow, "insptMethod") == null) {
			ds_testArticleList.setColumn(nRow, "insptMethod", "101");  //검사방법 시험공전으로 초기 세팅  요청자:최준열  20160801 처리자: 맹수영
		}

		ds_testArticleList.setColumn(nRow, "articleCd"	, rtnDs.getColumn(i, "articleCd"));
		ds_testArticleList.setColumn(nRow, "articleNm"	, rtnDs.getColumn(i, "articleNm"));
		ds_testArticleList.setColumn(nRow, "insptFld"	, rtnDs.getColumn(i, "insptFld"));
		ds_testArticleList.setColumn(nRow, "takeTerm"	, rtnDs.getColumn(i, "takeTerm"));
		ds_testArticleList.setColumn(nRow, "notFitClsfi", rtnDs.getColumn(i, "notFitClsfi"));
		ds_testArticleList.setColumn(nRow, "basisStand"	, rtnDs.getColumn(i, "basisStand"));
		ds_testArticleList.setColumn(nRow, "comm1"		, rtnDs.getColumn(i, "comm1"));
		ds_testArticleList.setColumn(nRow, "comm2"		, rtnDs.getColumn(i, "comm2"));
		//2018.06.15 김명섭 수수료3~5 초기화
		//ds_testArticleList.setColumn(nRow, "comm3"		, rtnDs.getColumn(i, "comm3"));
		//ds_testArticleList.setColumn(nRow, "comm4"		, rtnDs.getColumn(i, "comm4"));
		//ds_testArticleList.setColumn(nRow, "comm5"		, rtnDs.getColumn(i, "comm5"));
		ds_testArticleList.setColumn(nRow, "comm3"		, "0");
		ds_testArticleList.setColumn(nRow, "comm4"		, "0");
		ds_testArticleList.setColumn(nRow, "comm5"		, "0");
		ds_testArticleList.setColumn(nRow, "commCalc"	, rtnDs.getColumn(i, "commCalc"));
		
		if (rtnDs.getColumn(i, "manageSabun") != "")
		{
			ds_testArticleList.setColumn(nRow, "manageNm"	, rtnDs.getColumn(i, "manageNm"));
			ds_testArticleList.setColumn(nRow, "sabun"		, rtnDs.getColumn(i, "manageSabun"));
			ds_insptUser.setColumn(nRow, "userNm"			, rtnDs.getColumn(i, "manageNm"));
			ds_insptUser.setColumn(nRow, "sabun"			, rtnDs.getColumn(i, "manageSabun"));
		}
		
		// 검사방법 자동 세팅 추가  처리:맹수영  요청: 최준열  20160913
		if (rtnDs.getColumn(i, "insptMethod") != "")
		{
			ds_testArticleList.setColumn(nRow, "insptMethod", rtnDs.getColumn(i, "insptMethod"));           
		}   
		
		ds_testArticleList.setRowType(nRow, Dataset.ROWTYPE_INSERT);	
	}
}

/***************************************************************************
 * 설명    		: 시험항목 그리드 삭제 버튼 클릭
 ***************************************************************************/
function btn_delTestArticle_onclick(obj:Button,  e:ClickEventInfo)
{
    ds_testArticleList.deleteRow(ds_testArticleList.rowposition);
}

/***************************************************************************
 * 설명    		: 시험항목 그리드 Popup 더블 클릭
 ***************************************************************************/
function grd_testArticleList_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
    fn_checkTestArticlePop(obj, e);
}

/***************************************************************************
 * 설명    		: 시험항목 Popup
 ***************************************************************************/
function fn_checkTestArticlePop(obj, e)
{
    if (e.cell == 5)
    {
		//2018.01.31 김명섭 [CH201802_00006] 기등록 시험정보 시험항목 변경 가능하도록 개선
        //if (ds_testArticleList.getRowType(ds_testArticleList.rowposition) == "2")
        //{
            var arrParam = new Array();
            //arrParam[0] = gfn_nvl(ds_testArticleList.getColumn(ds_testArticleList.rowposition, "articleNm"), "");	// 시험항목명

            var rtnVal = gfn_dialog("TestArticleInqueryPop"				// dialogId
                               , "X_LRM::TestArticleInqueryPop.xfdl"			// Url
                               , {fv_Contents:arrParam}			// 배열
                               , null, null, null, null, null, false, true, -1);

            if (typeof rtnVal != "undefined" && rtnVal != null && gfn_getObjkeyLength(rtnVal) > 0)
            {
                ds_testArticleList.setColumn(ds_testArticleList.rowposition, "articleCd", rtnVal.articleCd);
                ds_testArticleList.setColumn(ds_testArticleList.rowposition, "articleNm", rtnVal.articleNm);
                ds_testArticleList.setColumn(ds_testArticleList.rowposition, "insptFld", rtnVal.insptFld);
                ds_testArticleList.setColumn(ds_testArticleList.rowposition, "takeTerm", rtnVal.takeTerm);
                ds_testArticleList.setColumn(ds_testArticleList.rowposition, "notFitClsfi", rtnVal.notFitClsfi);
                ds_testArticleList.setColumn(ds_testArticleList.rowposition, "basisStand", rtnVal.basisStand);
                ds_testArticleList.setColumn(ds_testArticleList.rowposition, "comm1", rtnVal.comm1);
                ds_testArticleList.setColumn(ds_testArticleList.rowposition, "comm2", rtnVal.comm2);
                //2018.06.15 김명섭 수수료3~5 초기화
                //ds_testArticleList.setColumn(ds_testArticleList.rowposition, "comm3", rtnVal.comm3);
                //ds_testArticleList.setColumn(ds_testArticleList.rowposition, "comm4", rtnVal.comm4);
                //ds_testArticleList.setColumn(ds_testArticleList.rowposition, "comm5", rtnVal.comm5);
                ds_testArticleList.setColumn(ds_testArticleList.rowposition, "comm3", "0");
                ds_testArticleList.setColumn(ds_testArticleList.rowposition, "comm4", "0");
                ds_testArticleList.setColumn(ds_testArticleList.rowposition, "comm5", "0");
                ds_testArticleList.setColumn(ds_testArticleList.rowposition, "commCalc", rtnVal.commCalc);
                // 검사자 정보 추가  처리:맹수영 요청:최준열 20160817  (CH201608_00315)
                if (rtnVal.manageSabun != "")
                {
					ds_testArticleList.setColumn(ds_testArticleList.rowposition, "manageNm", rtnVal.manageNm);
					ds_testArticleList.setColumn(ds_testArticleList.rowposition, "sabun", rtnVal.manageSabun);
					ds_insptUser.setColumn(ds_testArticleList.rowposition, "userNm", rtnVal.manageNm);
					ds_insptUser.setColumn(ds_testArticleList.rowposition, "sabun", rtnVal.manageSabun);
                }
                // 검사방법 자동 세팅 추가  처리:맹수영  요청: 최준열  20160913
                if (rtnVal.insptMethod != "")
                {
					ds_testArticleList.setColumn(ds_testArticleList.rowposition, "insptMethod", rtnVal.insptMethod);           
                }       
            }
        //}
        //else
        //{
        //    gfn_alert("기 등록된 데이터는 수정하실 수 없습니다.\n삭제 후 재 등록 바랍니다.");
        //}
    }
}

/***************************************************************************
 * 설명    		: 등록된 검체정보를 기타검체유형에 등록 한다.
 ***************************************************************************/
function btn_addEtcSpecm_onclick(obj:Button,  e:ClickEventInfo)
{
    if (ds_specmArticleList.rowposition == -1)
    {
        gfn_alert("검체유형 데이터를 먼저 입력하여 주십시오.");
        return;
    }
    //trace("specmCd >>> " + ds_specmArticleList.getColumn(ds_specmArticleList.rowposition, "specmCd"));
    // 등록제품(거래중인 식재료)가 아닌경우 입력검체 등록 시 기 등록되어 있는 검체면 막는다.
    // 등록제품(거래중인 식재료)는 자재 품목코드가 등록 검체 코드가 된다.
    if (ds_specmArticleList.getColumn(ds_specmArticleList.rowposition, "specmCd") != "" && cbo_specmClass.value != "101")
    {
        gfn_alert("새로운 검체정보를 등록하시려면 검체정보 복사 후 입력하여 주십시오.");
        return;
    }

    // 2018.02.01 김명섭 [CH201802_00006] 임시저장 후 입력검체등록 시 변경내역없음 alert 주석처리
    //if (!gfn_dsIsUpdated(ds_specmArticleList))
    //{
    //    gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
    //    return;
    //}

    // 저장시 Validation Check
    if (LimsUtil.rowValidCheck(ds_specmArticleList, ds_addSpecmArticleListValid) == false)	return;
    
    // 자료를 저장 하시겠습니까?
    if (!gfn_confirm("입력된 검체정보는 새로운 검체정보로 등록이 됩니다.\n검체정보를 등록 하시겠습니까?")) return false;

    // 특정 row의 검체를 등록하기 위해 임의의 Dataset에 row를 복사하여 처리한다.
    ds_etcSpecmArticleList.clearData();
    var nRow = ds_etcSpecmArticleList.addRow();
    ds_etcSpecmArticleList.copyRow(nRow, ds_specmArticleList, ds_specmArticleList.rowposition);

    ds_etcSpecmArticleList.setRowType(ds_etcSpecmArticleList.rowposition, Dataset.ROWTYPE_INSERT);

    var strSvcID    = "saveEtcSpecmArticleList";
    var strURL      = "ls/lcm/etcSpecmArticleMgmt/saveList.xdo";
    var strInDs     = "ds_etcSpecmArticleList=ds_etcSpecmArticleList:U";
    var strOutDs    = "ds_retval=ds_retval";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/***************************************************************************
 * 설명   : 검체가 한개 이상인 경우 시험항목 정보의 입력을 체크 한다.
 ***************************************************************************/
function fn_checkTestInfo()
{
    ds_testArticleListTmp.clearData();
    ds_testArticleListTmp.copyData(ds_testArticleList);
    ds_testArticleListTmp.applyChange();
    ds_testArticleListTmp.filter("");

    var nCheckCnt = 0;
    var chkSpecmNm = "";
    for (var j = 0; j < ds_specmArticleList.rowcount; j++)
    {
        chkSpecmNm = "";
        ds_testArticleListTmp.filter("seqNum == '" + ds_specmArticleList.getColumn(j, "seqNum") + "'");	// 검체코드 일련번호
        if (ds_testArticleListTmp.rowcount == 0)
        {
            chkSpecmNm = ds_specmArticleList.getColumn(j, "specmNm");
            break;
        }
    }
    return chkSpecmNm;
}

/***************************************************************************
 * 설명    		: Object VScroll 미세조정
 ***************************************************************************/
function TestInfoReg_onmousewheel(obj:Form, e:MouseWheelEventInfo)
{
    obj.vscrollbar.pos -= e.amount / 6; // <= 조절 범위 임의 지정
    return true;
}

/***************************************************************************
 * 설명    		: 검체유형 변경시
 ***************************************************************************/
function cbo_specmClass_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
    // 거래중인 식재료(자재) 인경우는 Text 입력을 막는다.
	ds_specmArticleList.setColumn(ds_specmArticleList.rowposition, "specmCd", "");
	ds_specmArticleList.setColumn(ds_specmArticleList.rowposition, "specmNm", "");

    edt_specmNm.value = "";
    if (obj.value == "101") {
        edt_specmNm.readonly = true;
    } else {
        edt_specmNm.readonly = false;
    }
}

/***************************************************************************
 * 설명    		: 구매이력정보 버튼 클릭
 ***************************************************************************/
function btn_buyHistory_onclick(obj:Button,  e:ClickEventInfo)
{
    var arrParam = new Array();
    var rtnVal = gfn_dialog("ItemTransSpecmListInqueryPop"				// dialogId
                       , "X_LRM::ItemTransSpecmListInqueryPop.xfdl"			// Url
                       , {fv_Contents:arrParam}			// 배열
                       , null, null, null, null, null, false, true, -1);
}

/***************************************************************************
 * 설명    		: 구매이력정보의 선택된 품목을 검체 정보에 세팅 한다.
 ***************************************************************************/
function fn_setTransItemList(outDs)
{
    outDs.filter("chk == '1'");
    ds_transItemList.copyData(outDs, true);  // 필터된 DataSet copy

    var nIdx = -1;
    for (var i = 0; i < ds_transItemList.getRowCount(); i++)
    {
        nIdx = ds_specmArticleList.addRow();

        //trace("추가 ==> " + ds_specmArticleList.rowcount);
        ds_specmArticleList.setColumn(nIdx, "seqNum", iSpecmSeqNum++);
        ds_specmArticleList.setColumn(nIdx, "acceptdd", curDate);

        ds_specmArticleList.setColumn(nIdx, "specmClass", ds_transItemList.getColumn(i, "specmClass"));
        ds_specmArticleList.setColumn(nIdx, "specmCd", ds_transItemList.getColumn(i, "specmCd"));
        ds_specmArticleList.setColumn(nIdx, "specmNm", ds_transItemList.getColumn(i, "specmNm"));
        ds_specmArticleList.setColumn(nIdx, "costClass", '102');	// 유상으로 세팅
        ds_specmArticleList.setColumn(nIdx, "stand", ds_transItemList.getColumn(i, "stand"));
        ds_specmArticleList.setColumn(nIdx, "unit", ds_transItemList.getColumn(i, "unit"));
        ds_specmArticleList.setColumn(nIdx, "mfgdd", ds_transItemList.getColumn(i, "mfgdd"));
        ds_specmArticleList.setColumn(nIdx, "origin", ds_transItemList.getColumn(i, "origin"));
        ds_specmArticleList.setColumn(nIdx, "specmType", ds_transItemList.getColumn(i, "specmType"));
        ds_specmArticleList.setColumn(nIdx, "mcalssCd", ds_transItemList.getColumn(i, "mcalssCd"));
        ds_specmArticleList.setColumn(nIdx, "mgrpCd", ds_transItemList.getColumn(i, "mgrpCd"));

        // 선택된 검체에 대한 Filter
        ds_testArticleList.filter("seqNum == '" + ds_specmArticleList.getColumn(nIdx, "seqNum") + "'");	// 검체코드 일련번호

        // 기 등록된 검체정보 조회
        // loop안에서 조회를 해야하기 때문에 동기화 처리
        fn_specmSearch("2");
    }
}

/***************************************************************************
 * 설명    		: 기 접수내역 조회 팝업
 ***************************************************************************/
function btn_preAcceptReqInfoPop_onclick(obj:Button,  e:ClickEventInfo)
{
	var arrParam = new Array();
    var rtnVal = gfn_dialog("PreAcceptReqInfoPop"				// dialogId
                       , "X_LRM::PreAcceptReqInfoPop.xfdl"			// Url
                       , {fv_Contents:arrParam}			// 배열
                       , null, null, null, null, null, false, true, -1);
    if (typeof rtnVal != "undefined" && rtnVal != null && gfn_getObjkeyLength(rtnVal) > 0)
    {
		//trace(gfn_jsonObjectToString(rtnVal));
		fn_searchPreAcceptReq(rtnVal.reqNum);
    }
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 기 접수등로 내역 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchPreAcceptReq(reqNum)
{
	// 자료를 삭제 하시겠습니까?
    if (!gfn_confirm("접수정보 전체가 초기화됩니다.\n기 접수내역을 세팅 하시겠습니까?")) return false;

    // 입력버튼 클릭 시 DataSet, Grid 초기화
    gfn_clearSortMark(grd_specmArticleList);
    gfn_clearSortMark(grd_testArticleList);

    ds_testReqAccept.clearData();		// 의뢰정보 DataSet 초기화
    ds_specmArticleList.clearData();	// 검체정보 DataSet 초기화
    ds_testArticleList.filter("");
    ds_testArticleList.clearData();		// 시험정보 DataSet 초기화
    ds_testArticleListTmp.clearData();	// 시험정보 Temp DataSet 초기화
    ds_testArticleListTmp.filter("");

    iSpecmSeqNum = 0;	// 검체순번 초기화
    
    ds_search.setColumn(0, "reqNum", reqNum);
    ds_search.setColumn(0, "maskAuth", SCAuth.getMaskAuth(this));

    var strSvcID    = "searchPreAcceptReq";
    var strURL      = "ls/lrm/testInfoReg/selectList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_testReqAccept=ds_testReqAccept ds_specmArticleList=ds_specmArticleList ds_testArticleListTmp=ds_testArticleListTmp";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 검체 시험항목 조회
 *---------------------------------------------------------------------------------------------*/
function btn_selectSpecmTest_onclick(obj:Button,  e:ClickEventInfo)
{
	if (ds_specmArticleList.rowcount == -1 || gfn_isNull(ds_specmArticleList.getColumn(0, "specmCd")))
    {
        gfn_alert("검체정보를 등록하여 주십시오.");
        return;
    }
    if (ds_testArticleListTmp.rowcount == -1)
    {
        gfn_alert("시험정보를 등록하여 주십시오.");
        return;
    }

	var objArg = {
		specmDs : ds_specmArticleList,
		testDs  : ds_testArticleListTmp
	};
    var rtnVal = gfn_dialog("SpecmTestInfoInqueryPop"				// dialogId
                       , "X_LRM::SpecmTestInfoInqueryPop.xfdl"			// Url
                       , objArg			// 배열
                       , null, null, null, null, null, false, true, -1);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 임시저장버튼 클릭(20171106 유선미)
 *---------------------------------------------------------------------------------------------*/
function btn_saveTemp_onclick(obj:Button,  e:ClickEventInfo)
{
    if (gfn_validCheck(ds_testReqAccept, ds_testReqAcceptValid, true) == false) return;

/* 2018.01.31 김명섭 [CH201802_00006] 임시저장은 의뢰/접수정보만 입력하면 저장되도록 개선

    // 각 검체의 시험정보가 존재하는지 체크
    var chkSpecmNm = fn_checkTestInfo();
    if (chkSpecmNm != "")
    {
        gfn_alert("[" + chkSpecmNm + "] 검체에 대한 시험항목정보를 입력하여 주십시오.");
        return;
    }

    // 접수명 특수문자 포함여부 체크
    if (gfn_isSpecialChar(edt_acceptnm.value))
    {
        gfn_alert("접수명에 특수문자가 포함되어 있습니다.\n접수명은 성적서파일명으로도 사용되기 때문에 특수문자를 포함하지 마십시오.");
        return;
    }

    if (ds_specmArticleList.rowposition == -1)
    {
        gfn_alert("검체정보를 입력하여 주십시오.");
        return;
    }

    for (var i = 0; i < ds_specmArticleList.rowcount; i++)
    {
        if (gfn_isNull(ds_specmArticleList.getColumn(i, "specmCd")))
        {
            gfn_alert("검체항목을 선택하여 주십시오.\n검체정보를 새로 등록하는 경우 먼저 [입력검체등록]을 클릭하여 저장해 주십시오.");
            return;
        }
    }

    if (ds_testArticleList.rowposition == -1)
    {
        gfn_alert("시험정보를 입력하여 주십시오.");
        return;
    }

    // 검체 중복 체크
    if (!fn_dupCheckSpecmInfo())
    {
        gfn_alert("중복등록된 검체정보가 있습니다.");
        return;
    }

    // 시험항목 중복 체크
    if (!fn_dupCheckTestInfo())
    {
        gfn_alert("중복등록된 시험정보가 있습니다.");
        return;
    }

    // 법적 / 내부기준 체크
    for (var i = 0; i < ds_testArticleList.rowcount; i++)
    {
        if (!fn_basisCheck(ds_testArticleList, i))
        {
            gfn_alert("법적기준 또는 내부기준을 선택하여 주십시오.");
            ds_testArticleList.rowposition = i;
            return;
        }
        if (!fn_basisDupCheck(ds_testArticleList, i))
        {
            gfn_alert("법적기준 또는 내부기준을 둘중 하나만 선택하여 주십시오.");
            ds_testArticleList.rowposition = i;
            return;
        }
    }

    // 수수료 체크
    if (!fn_commCheckTestInfo())
    {
        gfn_alert("수수료선택이 안된 시험정보가 있습니다.");
        return;
    }

    if (!gfn_dsIsUpdated(ds_testReqAccept) && !gfn_dsIsUpdated(ds_specmArticleList) && !gfn_dsIsUpdated(ds_testArticleList))
    {
        gfn_alert("msg.save.nochange");	
        return;
    }

    // 시험정보의 Validation을 체크하기 위해 임의의 DataSet에 담아 체크한다.    
    ds_testArticleListTmp.copyData(ds_testArticleList);
    ds_testArticleListTmp.filter("");
    
    // 검체정보 validation
    if (!gfn_validCheck(ds_specmArticleList, ds_specmArticleListValid, true)) return;
    
    // 시험정보 validation
    if (!gfn_validCheck(ds_testArticleListTmp, ds_testArticleListValid, true)) return;
    
2018.01.31 김명섭 [CH201802_00006] 임시저장은 의뢰/접수정보만 입력하면 저장되도록 개선 */

    ds_testArticleListTmp.copyData(ds_testArticleList);
    ds_testArticleListTmp.filter("");

//trace(ds_specmArticleList.rowcount);
//trace(ds_testArticleListTmp.rowcount);

    // 자료를 저장 하시겠습니까?
    if (!gfn_confirm("confirm.before.save")) return false;

    // 접수거래처 세팅
    if (gfn_isNull(strInsptReqPlce))
    {
        if (typeof v_arg != "undefined" && v_arg != null && v_arg != "")
            strInsptReqPlce = v_arg[0];
        else
            strInsptReqPlce = "LIMS";
            
        ds_testReqAccept.setColumn(ds_testReqAccept.rowposition, "insptReqPlce", strInsptReqPlce);
    }

    // mask권한 Parameter
    ds_search.setColumn(0, "maskAuth", SCAuth.getMaskAuth(this));
    
    iSpecmSeqNum = 0;	// 검체순번 초기화

    var strSvcID    = "saveTemp";
    var strURL      = "ls/lrm/testInfoReg/saveTemp.xdo";
    var strInDs     = "ds_search=ds_search:A ds_testReqAccept=ds_testReqAccept ds_specmArticleList=ds_specmArticleList ds_testArticleList=ds_testArticleListTmp";
    var strOutDs    = "ds_retval=ds_retval ds_testReqAccept=ds_testReqAccept ds_specmArticleList=ds_specmArticleList ds_testArticleListTmp=ds_testArticleListTmp";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 임시저장 불러오기 팝업 클릭(20171106 유선미)
 *---------------------------------------------------------------------------------------------*/
function btn_loadTemp_onclick(obj:Button,  e:ClickEventInfo)
{
	var arrParam = new Array();
    var rtnVal = gfn_dialog("LoadTestInfoTempPop"				// dialogId
                       , "X_LRM::LoadTestInfoTempPop.xfdl"			// Url
                       , {fv_Contents:arrParam}			// 배열
                       , null, null, null, null, null, false, true, -1);
    if (typeof rtnVal != "undefined" && rtnVal != null && gfn_getObjkeyLength(rtnVal) > 0)
    {
		fn_searchLoadTemp(rtnVal.tempSeq);
    }
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 임시저장 불러오기(20171106 유선미)
 *---------------------------------------------------------------------------------------------*/
function fn_searchLoadTemp(tempSeq)
{
	// 자료를 삭제 하시겠습니까?
    if (!gfn_confirm("접수정보 전체가 초기화됩니다.\n임시저장 내역을 불러오시겠습니까?")) return false;

    // 입력버튼 클릭 시 DataSet, Grid 초기화
    gfn_clearSortMark(grd_specmArticleList);
    gfn_clearSortMark(grd_testArticleList);

    iSpecmSeqNum = 0;	// 검체순번 초기화
    
    ds_search.setColumn(0, "tempSeq", tempSeq);
    ds_search.setColumn(0, "maskAuth", SCAuth.getMaskAuth(this));

    var strSvcID    = "selectLoadTemp";
    var strURL      = "ls/lrm/testInfoReg/selectLoadTemp.xdo";
    var strInDs     = "ds_search=ds_search";
    var strOutDs    = "ds_testReqAccept=ds_testReqAccept ds_specmArticleList=ds_specmArticleList ds_testArticleListTmp=ds_testArticleListTmp";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/**
 * @class 특수문자가 있는지 Check한다.
 * @param strValue  - 대상문자열
 * @return Boolean 형의 특수문자존재 여부
 */
function fn_isSpecialChar(strValue) {
    for (var i = 0; i < strValue.length; i++) {
        var strChar = strValue.charAt(i);
        var ch = strChar.charCodeAt();
        //trace("strChar:"+strChar);
        //trace("ch:"+ch);
        //'(',')' 허용
        if ( (ch >= 33 && ch <= 39) || (ch >= 42 && ch <= 47) || (ch >= 58 && ch <= 64) || (ch >= 91 && ch <= 96) || (ch >= 123 && ch <= 126) ) {
            return true;
        }
    }
    
    return false;
}

function grd_specmArticleList_onkeyup(obj:Grid, e:KeyEventInfo)
{
	fn_searchDetail();	// 입력된 시험항목 Filter 조회
}

function grd_testArticleList_onenterdown(obj:Grid, e:GridEditEventInfo)
{
	if(articleChggb == "Y") return;

	var rCnt = ds_testArticleList.rowcount;
	var rPos = ds_testArticleList.rowposition;

	if( rPos+1 == rCnt) {	//그리드 마지막 로우 엔터 시 항목 추가
		btn_addTestArticle_onclick();
	} else {	//그리드 하단 포커스 이동
		ds_testArticleList.rowposition = rPos + 1;
	}
}

function grd_testArticleList_onkeyup(obj:Grid, e:KeyEventInfo)
{
	var keyn = e.keycode;
	//delete 키인 시 선택 로우 삭제
	if(keyn == 46) {
		if(obj.currentcol == 5) return;	//시험항목
		ds_testArticleList.deleteRow(ds_testArticleList.rowposition);
	}
}

function ds_testArticleList_onvaluechanged(obj:Dataset,  e:DSColChangeEventInfo)
{
	if(e.columnid == "articleNm" && typeof e.oldvalue != "undefined" && e.newvalue <> e.oldvalue)
	{
		if(articleChggb == "Y") return;

		articleChggb = "Y";

		var arrParam = new Array();
		arrParam[0] = e.newvalue;	// 시험항목명

		var rtnVal = gfn_dialog("TestArticleInqueryPop"				// dialogId
						   , "X_LRM::TestArticleInqueryPop.xfdl"			// Url
						   , {fv_Contents:arrParam}			// 배열
						   , null, null, null, null, null, false, true, -1);

		if (typeof rtnVal != "undefined" && rtnVal != null && gfn_getObjkeyLength(rtnVal) > 0)
		{
			ds_testArticleList.setColumn(ds_testArticleList.rowposition, "articleCd", rtnVal.articleCd);
			ds_testArticleList.setColumn(ds_testArticleList.rowposition, "articleNm", rtnVal.articleNm);
			ds_testArticleList.setColumn(ds_testArticleList.rowposition, "insptFld", rtnVal.insptFld);
			ds_testArticleList.setColumn(ds_testArticleList.rowposition, "takeTerm", rtnVal.takeTerm);
			ds_testArticleList.setColumn(ds_testArticleList.rowposition, "notFitClsfi", rtnVal.notFitClsfi);
			ds_testArticleList.setColumn(ds_testArticleList.rowposition, "basisStand", rtnVal.basisStand);
			ds_testArticleList.setColumn(ds_testArticleList.rowposition, "comm1", rtnVal.comm1);
			ds_testArticleList.setColumn(ds_testArticleList.rowposition, "comm2", rtnVal.comm2);
			//2018.06.15 김명섭 수수료3~5 초기화
			//ds_testArticleList.setColumn(ds_testArticleList.rowposition, "comm3", rtnVal.comm3);
			//ds_testArticleList.setColumn(ds_testArticleList.rowposition, "comm4", rtnVal.comm4);
			//ds_testArticleList.setColumn(ds_testArticleList.rowposition, "comm5", rtnVal.comm5);
			ds_testArticleList.setColumn(ds_testArticleList.rowposition, "comm3", "0");
			ds_testArticleList.setColumn(ds_testArticleList.rowposition, "comm4", "0");
			ds_testArticleList.setColumn(ds_testArticleList.rowposition, "comm5", "0");
			ds_testArticleList.setColumn(ds_testArticleList.rowposition, "commCalc", rtnVal.commCalc);
			// 검사자 정보 추가  처리
			if (rtnVal.manageSabun != "")
			{
				ds_testArticleList.setColumn(ds_testArticleList.rowposition, "manageNm", rtnVal.manageNm);
				ds_testArticleList.setColumn(ds_testArticleList.rowposition, "sabun", rtnVal.manageSabun);
				ds_insptUser.setColumn(ds_testArticleList.rowposition, "userNm", rtnVal.manageNm);
				ds_insptUser.setColumn(ds_testArticleList.rowposition, "sabun", rtnVal.manageSabun);
			}
			// 검사방법 자동 세팅 추가  처리
			if (rtnVal.insptMethod != "")
			{
				ds_testArticleList.setColumn(ds_testArticleList.rowposition, "insptMethod", rtnVal.insptMethod);           
			}       
		}
		else
		{
			ds_testArticleList.setColumn(ds_testArticleList.rowposition, "articleNm", e.oldvalue);
		}
		articleChggb = "N";
	}
}

/* 검체정보 엑셀업로드  Start */
function tab_resultList_tabpage_btn_excelUpload_onclick(obj:Button,  e:ClickEventInfo)
{
    if (ds_testReqAccept.rowposition == -1)
    {
        gfn_alert("접수정보를 입력하여 주십시오.");
        return;
    }

	this.setWaitCursor(true, true);
	
	var strFileName = gfn_excelFileDialog("LOAD", "EXCEL");

	if (strFileName.length == 0)
	{
		this.setWaitCursor(false, true);
		return;
	}

	ds_excelDtlList.clearData();
	
 	var rtn = gfn_importExcel(strFileName, "ds_excelDtlList", 3, 1);	//3번째 라인부터 데이터 처리
 	
	this.setWaitCursor(false, true);

	var insIdx = ds_specmArticleList.getRowCount();
	var nIdx;
	var j;
	var okCnt = 0;
	var errCnt = 0;
	var dupCnt = 0;
	
	for(var i = 0; i < ds_excelDtlList.getRowCount(); i++)
	{
	
		nIdx = ds_specmArticleList.insertRow(insIdx++);
		ds_specmArticleList.setColumn(nIdx, "seqNum", iSpecmSeqNum++);
		ds_specmArticleList.setColumn(nIdx, "specmCd", "");
		ds_specmArticleList.setColumn(nIdx, "specmNm", "");
		ds_specmArticleList.setColumn(nIdx, "acceptdd", ds_excelDtlList.getColumn(i,"A"));
		for(j = 0; j < ds_specmClass.getRowCount(); j++)
		{
			if(ds_specmClass.getColumn(j,"codeName") == ds_excelDtlList.getColumn(i,"B"))
			{
				ds_specmArticleList.setColumn(nIdx, "specmClass", ds_specmClass.getColumn(j,"code"));
				break;
			}
		}
		
		ds_search.setColumn(0, "specmClass", ds_specmArticleList.getColumn(nIdx, "specmClass"));
		ds_search.setColumn(0, "specmCd", ds_excelDtlList.getColumn(i,"C"));
		ds_search.setColumn(0, "edtSearch", ds_excelDtlList.getColumn(i,"C"));
		ds_search.setColumn(0, "mgrpCd", "");
		ds_search.setColumn(0, "mcalssCd", "");
		ds_search.setColumn(0, "sclassCd", "");
		ds_search.setColumn(0, "specmType", "");
		
		fn_exlspecmSearch();

		if(ds_specmArticleListTmp.getRowCount() == 1)
		{
			LimsUtil.setDataSetToDataSetBind(ds_specmArticleList, ds_specmArticleListTmp);
			
			// 중복검체 체크
			if (!fn_dupCheckSpecmInfo())
			{
				dupCnt++;
				ds_specmArticleList.deleteRow(nIdx);
			}
			else
			{
				okCnt++;
				// 등록제품(거래중인식재료)는 자재에서 조회되기 때문에
				// 별도로 기타검체에 데이터가 있는지 조회하여 보여준다.
				if(ds_specmArticleList.getColumn(nIdx, "specmClass") == "101")
				{
					ds_search.setColumn(0, "specmClass", "");
					fn_exlspecmSearch();
				}
				
				ds_specmArticleList.setRowType(nIdx, Dataset.ROWTYPE_INSERT);
				
				//시험항목매핑
				if(ds_excelDtlList.getColumn(i,"D") == "Y")
				{
					fn_exlselectTestArticleMapp();
				}
			}
		}
		else
		{
			errCnt++;
		}

	}
	gfn_alert("처리건수: "+okCnt+" 오류건수: "+errCnt+" 중복건수: "+dupCnt);
}

//검체정보조회
function fn_exlspecmSearch()
{
    ds_specmArticleListTmp.clearData();
    
    var strSvcID    = "selectspecmSearch";
	var	strURL      = "ls/lcm/etcSpecmArticleMgmt/selectList.xdo";
	var	strOutDs    = "ds_specmArticleListTmp=ds_etcSpecmArticleList";
    var strInDs     = "ds_search=ds_search:A";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = false; //동기방식

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

//시험항목매핑
function fn_exlselectTestArticleMapp()
{
    if (ds_specmArticleList.rowcount == -1)
    {
        return;
    }

    var nRow = ds_specmArticleList.rowposition;
    if (gfn_isNull(ds_specmArticleList.getColumn(nRow, "specmCd")))
    {
        return;
    }
    if (gfn_isNull(ds_specmArticleList.getColumn(nRow, "specmType")))
    {
        return;
    }
    if (gfn_isNull(ds_specmArticleList.getColumn(nRow, "mgrpCd")) ||
        gfn_isNull(ds_specmArticleList.getColumn(nRow, "mcalssCd")) ||
        gfn_isNull(ds_specmArticleList.getColumn(nRow, "sclassCd"))
       )
    {
        return;
    }

    if (gfn_isNull(ds_specmArticleList.getColumn(nRow, "insptPurp2")))
    {
        return;
    }

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_testArticleList);

    // Dataset을 초기화한다.
    ds_testArticleListTmp.clearData();
    ds_testArticleListTmp.filter("");

    // Filter된 Dataset삭제
    fn_deleteTestArticle();

    ds_search.setColumn(0, "seqNum"       , ds_specmArticleList.getColumn(nRow, "seqNum"));
    ds_search.setColumn(0, "specmCd"      , ds_specmArticleList.getColumn(nRow, "specmCd"));
    ds_search.setColumn(0, "specmType"    , ds_specmArticleList.getColumn(nRow, "specmType"));
    ds_search.setColumn(0, "mgrpCd"       , ds_specmArticleList.getColumn(nRow, "mgrpCd"));
    ds_search.setColumn(0, "mcalssCd"     , ds_specmArticleList.getColumn(nRow, "mcalssCd"));
    ds_search.setColumn(0, "sclassCd"     , ds_specmArticleList.getColumn(nRow, "sclassCd"));
    ds_search.setColumn(0, "insptPurp2"   , ds_specmArticleList.getColumn(nRow, "insptPurp2"));
    ds_search.setColumn(0, "longstorageYn", ds_specmArticleList.getColumn(nRow, "longstorageYn"));
    ds_search.setColumn(0, "specmTypePcls", ds_specmArticleList.getColumn(nRow, "specmTypePcls"));

    var strSvcID    = "selectexlTestArticleList";
    var strURL      = "ls/lrm/testInfoReg/selectTestArticleList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_testArticleListTmp=ds_testArticleList";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = false;
 
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}
/* 검체정보 엑셀업로드  End */
]]></Script>
  </Form>
</FDL>

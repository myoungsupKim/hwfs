<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FMS00180E" onkeydown="frm_OnKeyDown" onload="form_onload" titletext="여신연장 요청" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="sta_detail00" class="sta_WFDA_Labelbg" position="absolute 198 112 1237 139" anchor="left top right"/>
        <Static id="sta_detail01" class="sta_WFDA_Labelbg" position="absolute 198 138 1237 165" anchor="left top right"/>
        <Static id="sta_detail02" class="sta_WFDA_Labelbg" position="absolute 198 164 1237 191" anchor="left top right"/>
        <Static id="sta_detail25" class="sta_WFDA_Labelbg" position="absolute 198 86 1237 113" anchor="left top right"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Grid autoenter="select" binddataset="ds_List" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="grd_List" useinputpanel="false" oncellclick="grd_List_OnCellClick" onheadclick="grd_List_OnHeadClick" taborder="15" tabstop="false" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 206 1237 710" selecttype="row" autofittype="col" anchor="all">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="25"/>
                <Column size="90"/>
                <Column size="170"/>
                <Column size="185"/>
                <Column size="95"/>
                <Column size="95"/>
                <Column size="95"/>
                <Column size="95"/>
                <Column size="147"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="40"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="요청일자"/>
                <Cell col="2" rowspan="2" displaytype="text" text="본    사"/>
                <Cell col="3" rowspan="2" displaytype="text" text="사 업 장"/>
                <Cell col="4" rowspan="2" displaytype="text" text="여신 회전&#13;&#10;연  장  일"/>
                <Cell col="5" rowspan="2" displaytype="text" text="여      신&#13;&#10;연장 금액"/>
                <Cell col="6" rowspan="2" displaytype="text" text="연장 적용&#13;&#10;시  작  일"/>
                <Cell col="7" rowspan="2" displaytype="text" text="연장 적용&#13;&#10;종  료  일"/>
                <Cell col="8" rowspan="2" displaytype="text" text="비    고"/>
                <Cell col="9" colspan="2" displaytype="text" text="승 인 자"/>
                <Cell col="11" rowspan="2" displaytype="text" text="삭 제"/>
                <Cell row="1" col="9" displaytype="text" text="승인자"/>
                <Cell row="1" col="10" displaytype="text" text="승인 여부"/>
              </Band>
              <Band id="body">
                <Cell displaytype="number" style="align:center;" expr="expr:currow + 1"/>
                <Cell col="1" displaytype="date" style="align:center;" text="bind:REQ_DATE" calendardisplaynulltype="none"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:MAIN_UPJANGNM"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:UPJANGNM"/>
                <Cell col="4" displaytype="number" style="align:right;" text="bind:CREDIT_EXT_DAYS"/>
                <Cell col="5" displaytype="number" style="align:left;" text="bind:CREDIT_EXT_AMOUNT"/>
                <Cell col="6" displaytype="date" style="align:center;" text="bind:SUPPLY_START" calendardisplaynulltype="none"/>
                <Cell col="7" displaytype="date" style="align:center;" text="bind:SUPPLY_END" calendardisplaynulltype="none"/>
                <Cell col="8" displaytype="text" style="align:left;" text="bind:REMARK"/>
                <Cell col="9" displaytype="text" style="align:center;" text="bind:APPR_NAME"/>
                <Cell col="10" displaytype="combo" style="align:center;" text="bind:APPR_YN" combodataset="ds_Appr" combocodecol="CODE" combodatacol="NAME"/>
                <Cell col="11" displaytype="checkbox" edittype="checkbox" style="align:center;" text="bind:DEL_YN"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Div id="div_cmnBtn" taborder="22" tabstop="false" text="Div0" url="cmn::CmnBtn.xfdl" position="absolute 0 0 1237 30" anchor="left top right" scrollbars="none"/>
        <Static id="Static02" text="요청부서" position="absolute 15 40 79 61" class="sta_WFSA_label"/>
        <Static id="Static18" text="요 청 자" position="absolute 307 40 367 61" class="sta_WFSA_label"/>
        <Static id="Static19" text="요청일자" position="absolute 624 40 686 61" class="sta_WFSA_label"/>
        <Static id="Static00" text="대 상 정 보" position="absolute 0 86 88 113" class="sta_WFDA_Label03"/>
        <Static id="Static1" text="여 신 정 보" position="absolute 0 112 88 139" class="sta_WFDA_Label03"/>
        <Static id="Static2" text="요 청 내 역" position="absolute 0 138 88 191" class="sta_WFDA_Label03"/>
        <Static id="Static3" text="본        사" position="absolute 87 86 199 113" class="sta_WFDA_Label01"/>
        <Static id="Static20" text="여신회전일" position="absolute 87 112 199 139" class="sta_WFDA_Label01"/>
        <Static id="Static21" text="여신회전 연장일" position="absolute 87 138 199 165" class="sta_WFDA_Label01"/>
        <Static id="Static22" text="비         고" position="absolute 87 164 199 191" class="sta_WFDA_Label01"/>
        <Static id="Static28" text="사   업   장" position="absolute 373 86 485 113" class="sta_WFDA_Label01"/>
        <Static id="Static29" text="여 신 금 액" position="absolute 373 112 485 139" class="sta_WFDA_Label01"/>
        <Static id="Static30" text="여신연장 금액" position="absolute 373 138 485 165" class="sta_WFDA_Label01"/>
        <Static id="Static36" text="승  인  자" position="absolute 659 86 771 113" class="sta_WFDA_Label01"/>
        <Static id="Static37" text="여신관리 기준" position="absolute 659 112 771 139" class="sta_WFDA_Label01"/>
        <Static id="Static38" text="연장 적용기간" position="absolute 659 138 771 165" class="sta_WFDA_Label01"/>
        <Edit lengthunit="asciii" id="ed_MainUpjangNm" imemode="english" onkeydown="fn_Pop_OnKeyDown" readonly="true" taborder="4" userdata="btn_MainUpjang" position="absolute 201 89 351 110"/>
        <Button id="btn_MainUpjang" onclick="btn_MainUpjang_OnClick" taborder="17" position="absolute 350 89 371 110" class="btn_WF_popSearch" text="" image=""/>
        <Edit lengthunit="asciii" id="ed_UpjangNm" imemode="english" onkeydown="fn_Pop_OnKeyDown" readonly="true" taborder="5" userdata="btn_Upjang" position="absolute 487 89 637 110"/>
        <Button id="btn_Upjang" onclick="btn_Upjang_OnClick" taborder="18" position="absolute 636 89 657 110" class="btn_WF_popSearch" text="" image=""/>
        <Edit enable="false" id="ed_ApprName" onkeydown="fn_Pop_OnKeyDown" readonly="true" taborder="6" userdata="btn_ApprSabun" position="absolute 773 89 956 110"/>
        <Button enable="false" id="btn_ApprSabun" onclick="btn_ApprSabun_OnClick" taborder="19" position="absolute 955 89 976 110" class="btn_WF_popSearch" text="" image=""/>
        <Combo codecolumn="CODE" datacolumn="NAME" enable="false" id="cbo_CreditStan" innerdataset="ds_CreditStan" taborder="9" position="absolute 773 115 978 136"/>
        <MaskEdit enable="false" id="me_CreditAmount" readonly="true" taborder="8" position="absolute 487 115 638 136" mask="#,###"/>
        <Edit lengthunit="asciii" enable="false" id="ed_CreditTurnDays" imemode="english" maxlength="6" inputtype="number" readonly="true" taborder="7" position="absolute 201 115 351 136" style="align:right;"/>
        <Edit lengthunit="asciii" id="ed_CreditExtDays" imemode="english" maxlength="6" inputtype="number" taborder="10" position="absolute 201 141 351 162" style="align:right;"/>
        <MaskEdit id="me_CreditExtAmount" taborder="11" position="absolute 487 141 638 162" mask="#,###"/>
        <MaskEdit id="me_SupplyDateStart" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkeydown="fn_Pop_OnKeyDown" onkillfocus="g_Date_OnKillFocus" taborder="12" type="string" userdata="btn_SupplyDateStart" position="absolute 773 141 844 162" class="msk_WF_Cal"/>
        <Static id="Static23" text="~" position="absolute 867 146 878 159"/>
        <MaskEdit id="me_SupplyDateEnd" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkeydown="fn_Pop_OnKeyDown" onkillfocus="g_Date_OnKillFocus" taborder="13" type="string" userdata="btn_SupplyDateEnd" position="absolute 880 141 951 162" class="msk_WF_Cal"/>
        <Edit lengthunit="asciii" id="ed_Remark" imemode="english" maxlength="300" taborder="14" position="absolute 201 167 972 188"/>
        <Edit lengthunit="asciii" enable="false" id="ed_ReqDeptNm" imemode="english" readonly="true" taborder="1" position="absolute 82 40 297 61"/>
        <Edit lengthunit="asciii" enable="false" id="ed_ReqName" imemode="english" readonly="true" taborder="2" position="absolute 373 40 614 61"/>
        <MaskEdit id="me_ReqDate" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkeydown="fn_Pop_OnKeyDown" onkillfocus="g_Date_OnKillFocus" taborder="3" trimtype="both" type="string" userdata="btn_ReqDate" position="absolute 693 40 773 61" class="msk_WF_Cal"/>
        <Button id="btn_ReqDate" onclick="g_CalButton_OnClick" taborder="16" userdata="me_ReqDate" position="absolute 772 40 790 61" class="btn_WF_cal" text="" image=""/>
        <Button id="btn_SupplyDateStart" onclick="g_CalButton_OnClick" taborder="20" userdata="me_SupplyDateStart" position="absolute 843 141 864 162" class="btn_WF_cal" text="" image=""/>
        <Button id="btn_SupplyDateEnd" onclick="g_CalButton_OnClick" taborder="21" userdata="me_SupplyDateEnd" position="absolute 950 141 971 162" class="btn_WF_cal" text="" image=""/>
        <Static id="Static0" text="일" position="absolute 353 115 373 136"/>
        <Static id="Static4" text="일" position="absolute 353 141 373 162"/>
        <Static id="Static5" text="원" position="absolute 639 115 659 136"/>
        <Static id="Static6" text="원" position="absolute 639 141 659 162"/>
        <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 71 450 86" anchor="left top"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Static id="Static07" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 191 450 206" anchor="left top"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_List" onrowposchanged="ds_List_OnRowPosChanged"/>
      <Dataset id="ds_Input">
        <ColumnInfo>
          <Column id="REQ_DEPT_ID" size="256" type="STRING"/>
          <Column id="REQ_DEPT_NM" size="256" type="STRING"/>
          <Column id="REQ_SABUN" size="9" type="STRING"/>
          <Column id="REQ_NAME" size="256" type="STRING"/>
          <Column id="REQ_DATE" size="8" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Appr">
        <ColumnInfo>
          <Column id="CODE" size="1" type="STRING"/>
          <Column id="NAME" size="20" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">Y</Col>
            <Col id="NAME">승   인</Col>
          </Row>
          <Row>
            <Col id="CODE">N</Col>
            <Col id="NAME">미승인</Col>
          </Row>
          <Row>
            <Col id="CODE">C</Col>
            <Col id="NAME">반   려</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_CreditStan">
        <ColumnInfo>
          <Column id="CODE" size="1" type="STRING"/>
          <Column id="NAME" size="20" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="NAME">통제안함</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="NAME">여신회전일</Col>
          </Row>
          <Row>
            <Col id="CODE">3</Col>
            <Col id="NAME">여신액</Col>
          </Row>
          <Row>
            <Col id="CODE">4</Col>
            <Col id="NAME">회전일+여신액</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_FmsUpjang">
        <ColumnInfo>
          <Column id="CREDIT_TURN_DAYS" size="256" type="INT"/>
          <Column id="CREDIT_TURN_CONTROL_YN" size="1" type="STRING"/>
          <Column id="CREDIT_AMOUNT" size="20" type="INT"/>
          <Column id="CREDIT_AMOUNT_CONTROL_YN" size="1" type="STRING"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="ed_MainUpjangNm_value" compid="ed_MainUpjangNm" propid="value" datasetid="ds_List" columnid="MAIN_UPJANGNM"/>
      <BindItem id="ed_UpjangNm_value" compid="ed_UpjangNm" propid="value" datasetid="ds_List" columnid="UPJANGNM"/>
      <BindItem id="ed_ApprName_value" compid="ed_ApprName" propid="value" datasetid="ds_List" columnid="APPR_NAME"/>
      <BindItem id="cbo_CreditStan_value" compid="cbo_CreditStan" propid="value" datasetid="ds_List" columnid="CREDIT_STAN"/>
      <BindItem id="me_CreditAmount_value" compid="me_CreditAmount" propid="value" datasetid="ds_List" columnid="CREDIT_AMOUNT"/>
      <BindItem id="ed_CreditTurnDays_value" compid="ed_CreditTurnDays" propid="value" datasetid="ds_List" columnid="CREDIT_TURN_DAYS"/>
      <BindItem id="ed_CreditExtDays_value" compid="ed_CreditExtDays" propid="value" datasetid="ds_List" columnid="CREDIT_EXT_DAYS"/>
      <BindItem id="me_CreditExtAmount_value" compid="me_CreditExtAmount" propid="value" datasetid="ds_List" columnid="CREDIT_EXT_AMOUNT"/>
      <BindItem id="me_SupplyDateStart_value" compid="me_SupplyDateStart" propid="value" datasetid="ds_List" columnid="SUPPLY_START"/>
      <BindItem id="me_SupplyDateEnd_value" compid="me_SupplyDateEnd" propid="value" datasetid="ds_List" columnid="SUPPLY_END"/>
      <BindItem id="ed_Remark_value" compid="ed_Remark" propid="value" datasetid="ds_List" columnid="REMARK"/>
      <BindItem id="ed_ReqDeptNm_value" compid="ed_ReqDeptNm" propid="value" datasetid="ds_Input" columnid="REQ_DEPT_NM"/>
      <BindItem id="ed_ReqName_value" compid="ed_ReqName" propid="value" datasetid="ds_Input" columnid="REQ_NAME"/>
      <BindItem id="me_ReqDate_value" compid="me_ReqDate" propid="value" datasetid="ds_Input" columnid="REQ_DATE"/>
      <BindItem id="item25" compid="sta_detail25" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item0" compid="sta_detail00" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item1" compid="sta_detail01" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item2" compid="sta_detail02" propid="text" datasetid="ds_view" columnid="D_1"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 기준정보 > 여신관리
 * 프로그램명   : FMS00180E.XML
 * 기      능   : 여신연장요청
 * 작  성  자   : 손 창 덕
 * 작성  일자   : 2008-03-14
 * 비      고   : 
 *		- ds_Input				: [input DS] 조회조건 파라미터 DS
 *		- ds_List				: 여신연장 리스트
 *		- ds_Appr				: [코드 DS] 승인여부 DS (공통코드 : '승인여부')
 *		- ds_CreditStan			: [코드 DS] 여신관리 기준 DS (공통코드 : '여신관리 기준')
 *		- ds_FmsUpjang			: FMS_UPJANG(여신정보) DS
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "LIB::sc_comon.js";			// 시스템공통 함수
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js";
//@@컨버터에서 주석처리 #include "LIB::sc_sql_common.js";
//@@컨버터에서 주석처리 #include "LIB::tit_comm_0001.js";		// X-Framework Lib
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================

//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	// From UnLoad Check DataSet ex) v_ds_check = "ds_Input;ds_List";
	v_ds_check = "ds_List";
	
	// X-Framework : Action 정보 생성
	fsp_init(this);
	
	// ds_Input Setting
	ds_Input.clearData();
	ds_Input.addRow();
	ds_Input.setColumn(0, "REQ_DEPT_ID", g_Deptid      );
	ds_Input.setColumn(0, "REQ_DEPT_NM", g_DeptNm      );
	ds_Input.setColumn(0, "REQ_SABUN",   g_EmpNo       );
	ds_Input.setColumn(0, "REQ_NAME",    g_Name        );
	ds_Input.setColumn(0, "REQ_DATE",    gfn_today());
	
	// Set Default Cursor
	me_ReqDate.setFocus();
	
	// 자동 조회
	fn_search();
}
//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_search()
{
	if( fn_SearchCheck() ) {
		// 컴포넌트 활성화
		fn_CompEnable(false);
		
		// Result DataSet Clear
		ds_List.clearData();
		
		// callService
		fsp_clear(this);
		fsp_addSearch(this,"fm/fms:FMS00180E_S001");
		fsp_callService(this,"","","ds_Input=ds_Input","ds_List=ds_List","","fn_CallBackSearch");
	}
}
/*------------------------------------------------------------
	1. Function    : fn_SearchCheck()
	2. Description : 검색조건 체크
	3. Arguments   : 
	4. History     : 2008. 04. 03 - 최초작성
*------------------------------------------------------------*/
function fn_SearchCheck()
{
	// 필수 검색조건 체크
	if( gfn_length(gfn_trim(ds_Input.getColumn(0, "REQ_DEPT_ID")))== 0 ) {
		g_Message("EE", "요청부서가 존재하지 않습니다.\n관리자에게 문의하여 주십시요.");
		ed_ReqDeptNm.setFocus();
		return false;
	}
	if( gfn_length(gfn_trim(ds_Input.getColumn(0, "REQ_SABUN")))== 0 ) {
		g_Message("EE", "요청자가 존재하지 않습니다.\n관리자에게 문의하여 주십시요.");
		ed_ReqName.setFocus();
		return false;
	}
	if( gfn_length(gfn_trim(ds_Input.getColumn(0, "REQ_DATE")))== 0 ) {
		g_Message("EE", "요청일자를 선택/입력해 주세요.");
		me_ReqDate.setFocus();
		return false;
	} else {
		if( gfn_length(gfn_trim(ds_Input.getColumn(0, "REQ_DATE")))!= 8 ) {
			g_Message("EE", "올바른 요청일자를 선택/입력해 주세요.");
			me_ReqDate.setFocus();
			return false;
		}
	}
	
	return true;
}
/*------------------------------------------------------------
	1. Function    : fn_CallBackSearch(errCode, errMsg)
	2. Description : fn_Search() CallBack Function
	3. Arguments   : 
	4. History     : 2008. 04. 03 - 최초작성
*------------------------------------------------------------*/
function fn_CallBackSearch(errCode, errMsg)
{	
	if( errCode != 0 ) {
		return;
	} else {
		ds_List.addColumn("DEL_YN", "STRING");
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Insert()
 * 기      능   : [등록버튼] 등록 버튼 클릭 시 처리되는 작업
 ******************************************************************************************
 */
function fn_insert()
{
	// 입력체크(1건만 입력가능)
	if( gfn_dsIsUpdated(ds_List)) {
		if( g_Confirm("04", "변경된 데이터가 있습니다.\n새로운 자료를 입력하시겠습니까?\n(기존에 입력한 자료는 사라집니다.)") ) {
			ds_List.reset();
		} else {
			return;
		}
	}
	
	// 조회날짜 현재날짜로 설정
	me_ReqDate.value = gfn_today();
	
	// DataSet Row 추가
	var nRow = ds_List.addRow();
	
	// 컴포넌트 활성화
	fn_CompEnable(true);
	
	// 초기값 셋팅
	ds_List.setColumn(nRow, "REQ_DATE",   gfn_today());	// 요청일자
	ds_List.setColumn(nRow, "REQ_SABUN",  g_EmpNo       );	// 요청자
	ds_List.setColumn(nRow, "APPR_SABUN", "201201491"   );	// 승인자
	ds_List.setColumn(nRow, "APPR_NAME",  "김동혁"     );	// 승인자명
	ds_List.setColumn(nRow, "APPR_YN",    "N"           );	// 승인여부
	ds_List.setColumn(nRow, "USE_YN",     "Y"           );	// 사용여부
	
	// 삭제 체크박스 비활성화
	grd_List.setCellProperty("body", 11, "edittype", setCellEditVal(grd_List,"body",11,false));
	
	ed_MainUpjangNm.setFocus();
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Save()
 * 기      능   : [저장버튼] 저장 버튼 클릭 시 처리되는 작업
 ******************************************************************************************
 */
function fn_save()
{
	// 변경여부 확인
	if( !gfn_dsIsUpdated(ds_List))
	{
		g_Message("EE", "변경된 데이터가 없습니다.");
		return;
	}
	
	if( !fn_SaveCheck() )
	{
		return;
	}
	
    // 서비스셋팅
    var actionName, cmdName, inData, outData, otherArg, callBackFnc;
    var insertSql, updateSql, deleteSql,saveFlagColumn, keySqlName, keyIncrement, callbackSql;
    
    inData		= "ds_List=ds_List:U";
    outData		= "ds_List=ds_List";
    callBackFnc	= "fn_CallBackSave";
    insertSql 	= "fm/fms:FMS00180E_I001";
    updateSql   = "";
    deleteSql   = "";
    keyIncrement= -1;
    callbackSql	= "";
    
    fsp_clear(this);
    fsp_addSave(this, insertSql, updateSql, deleteSql,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출
}
/*------------------------------------------------------------
	1. Function    : fn_SearchCheck()
	2. Description : 저장조건 체크
	3. Arguments   : 
	4. History     : 2008. 04. 03 - 최초작성
*------------------------------------------------------------*/
function fn_SaveCheck()
{
	var nTotalRow = ds_List.getRowCount();
	
	for( var nCurRow=0; nCurRow<nTotalRow; nCurRow++ ) {
		ds_List.rowposition = nCurRow;
		if( GetRowType(ds_List,nCurRow)== "insert" ) {
			// 필수 입력 사항 확인 
			// 본사코드
			if( gfn_length(gfn_trim(ds_List.getColumn(nCurRow, "MAIN_UPJANG")))== 0
			    || gfn_trim(ds_List.getColumn(nCurRow, "MAIN_UPJANG"))== null ) {
			    g_Message("EE", "본사를 선택해주십시오.");
				ed_MainUpjangNm.setFocus();
				return;
			}
			
			// 사업장코드
			if( gfn_length(gfn_trim(ds_List.getColumn(nCurRow, "UPJANG")))== 0
			    || gfn_trim(ds_List.getColumn(nCurRow, "UPJANG"))== null ) {
				g_Message("EE", "사업장을 선택해주십시오.");
				ed_UpjangNm.setFocus();
				return;
			}
			
			// 승인자
			if( gfn_length(gfn_trim(ds_List.getColumn(nCurRow, "APPR_SABUN")))== 0
			    || gfn_trim(ds_List.getColumn(nCurRow, "APPR_SABUN"))== null ) {
				g_Message("EE", "승인자를 선택해주십시오.");
				ed_ApprSabunNm.setFocus();
				return;
			}
			
			// 여신관리 기준 회전일 사용시
			if( ds_List.getColumn(nCurRow, "CREDIT_TURN_CONTROL_YN") == "Y" ) {
				// 여신회전 연장일
				if( gfn_length(gfn_trim(ds_List.getColumn(nCurRow, "CREDIT_EXT_DAYS")))== 0
					|| gfn_trim(ds_List.getColumn(nCurRow, "CREDIT_EXT_DAYS"))== null ) {
					g_Message("EE", "여신회전 연장일을 입력해주십시오.");
					ed_CreditExtDays.setFocus();
					return;
				}
			}
			
			// 여신관리 기준 여신금액 사용시
			if( ds_List.getColumn(nCurRow, "CREDIT_AMOUNT_CONTROL_YN") == "Y" ) {
				// 여신연장 금액
				if( gfn_length(gfn_trim(ds_List.getColumn(nCurRow, "CREDIT_EXT_AMOUNT")))== 0
					|| gfn_trim(ds_List.getColumn(nCurRow, "CREDIT_EXT_AMOUNT"))== null ) {
					g_Message("EE", "여신연장 금액을 입력해주십시오.");
					me_CreditExtAmount.setFocus();
					return;
				}
			}
			
			// 연장 적용기간
			if( gfn_length(gfn_trim(ds_List.getColumn(nCurRow, "SUPPLY_START")))== 0
				|| gfn_trim(ds_List.getColumn(nCurRow, "SUPPLY_START"))== null ) {
				g_Message("EE", "연장 적용기간 시작일을 선택해주십시오.");
				me_SupplyDateStart.setFocus();
				return;
			}
			if( gfn_length(gfn_trim(ds_List.getColumn(nCurRow, "SUPPLY_END")))== 0
				|| gfn_trim(ds_List.getColumn(nCurRow, "SUPPLY_END"))== null ) {
				g_Message("EE", "연장 적용기간 종료일을 선택해주십시오.");
				me_SupplyDateEnd.setFocus();
				return;
			}
			if( G_fn_GapDay(gfn_today(), ds_List.getColumn(nCurRow, "SUPPLY_START")) < 0 ) {
				g_Message("EE", "당일부터 선택이 가능합니다.");
				ds_List.setColumn(nCurRow, "SUPPLY_START", "");
				me_SupplyDateStart.setFocus();
				return;
			}
			if( G_fn_GapDay(gfn_today(), ds_List.getColumn(nCurRow, "SUPPLY_END")) < 0 ) {
				g_Message("EE", "당일부터 선택이 가능합니다.");
				ds_List.setColumn(nCurRow, "SUPPLY_END", "");
				me_SupplyDateEnd.setFocus();
				return;
			}
			if( G_fn_GapDay(ds_List.getColumn(nCurRow, "SUPPLY_START"), ds_List.getColumn(nCurRow, "SUPPLY_END")) < 0 ) {
				g_Message("EE", "연장 적용기간이 올바르지 않습니다.\n올바른 연장 적용기간을 선택/입력해 주세요 ");
				me_SupplyDateStart.setFocus();
				return;
			}
		}
	}
	
	// 저장확인
	if( !g_Confirm("02") )
	{
		return false;
	}
    
    return true;
}
/*------------------------------------------------------------
	1. Function    : fn_callBackSave(errCode, errMsg)
	2. Description : fn_Save() CallBack Function
	3. Arguments   : 
	4. History     : 2008. 04. 03 - 최초작성
*------------------------------------------------------------*/
function fn_CallBackSave(errCode, errMsg)
{	
	if( errCode != 0 ) {
		return;
	} else {
		g_Message("02");
		fn_search();
	}
}
/* 
 ******************************************************************************************
 * 함  수  명   : fn_Delete()
 * 기      능   : [삭제버튼] 삭제 시 처리되는 작업
 ******************************************************************************************
 */
function fn_delete(nRow)
{
	var nCnt = 0;
	for( var i=0; i<ds_List.getRowCount(); i++ ) {
		if( ds_List.getColumn(i, "DEL_YN") == "1" ) {
			nCnt += 1;
		}
	}
	
	if( nCnt == 0 ) {
		g_Message("EE", "삭제할 데이터가 없습니다.");
		return;
	} else {
		// 삭제확인
		if( g_Confirm("01") )
		{
			// 서비스셋팅
			var actionName, cmdName, inData, outData, otherArg, callBackFnc;
			var insertSql, updateSql, deleteSql,saveFlagColumn, keySqlName, keyIncrement, callbackSql;
			
			inData		= "ds_List=ds_List:U";
			outData		= "ds_List=ds_List";
			callBackFnc	= "fn_CallBackDelete";
			insertSql 	= "";
			updateSql   = "fm/fms:FMS00180E_U001";
			deleteSql   = "";
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_clear(this);
			fsp_addSave(this, insertSql, updateSql, deleteSql,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출
		}
	}
}
/*------------------------------------------------------------
	1. Function    : fn_CallBackDeleteerrCode, errMsg)
	2. Description : fn_Delete() CallBack Function
	3. Arguments   : 
	4. History     : 2008. 04. 03 - 최초작성
*------------------------------------------------------------*/
function fn_CallBackDelete(errCode, errMsg)
{	
	if( errCode != 0 ) {
		return;
	} else {
		g_Message("01");
		fn_search();
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Print()
 * 기      능   : [출력버튼] 출력 시 처리되는 작업
 ******************************************************************************************
 */
function fn_print()
{
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function fn_Close()
{
	this.close();
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Help()
 * 기      능   : [도움말버튼] 도움말
 ******************************************************************************************
 */
function fn_help()
{
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*------------------------------------------------------------
	1. Function    : fn_CompEnable()
	2. Description : 컴포넌트 활성/비활성 관리
	3. Arguments   : 
	4. History     : 2008. 04. 03 - 최초작성
*------------------------------------------------------------*/
function fn_CompEnable(arg)
{
    // 컴포넌트 활성화
	// btn_MainUpjang.Visible      = arg;
	// btn_Upjang.Visible          = arg;
	// btn_ApprSabun.Visible       = arg;
	// btn_SupplyDateStart.Visible = arg;
	// btn_SupplyDateEnd.Visible   = arg;
	
	// ed_CreditExtDays.Readonly   = !arg;	// 여신회전 연장일
	// me_CreditExtAmount.Readonly = !arg;	// 여신연장 금액
	// ed_Remark.Readonly          = !arg;	// 비고
	
    // 컴포넌트 활성화
    ed_MainUpjangNm.enable     = arg;
	btn_MainUpjang.enable      = arg;
	ed_UpjangNm.enable         = arg;
	btn_Upjang.enable          = arg;
	//ed_ApprName.Enable         = arg;
	//btn_ApprSabun.Enable       = arg;
	me_SupplyDateStart.enable  = arg;
	me_SupplyDateEnd.enable    = arg;
	btn_SupplyDateStart.enable = arg;
	btn_SupplyDateEnd.enable   = arg;
	
	ed_CreditExtDays.enable    = arg;	// 여신회전 연장일 true -> false
	me_CreditExtAmount.enable  = arg;	// 여신연장 금액
	ed_Remark.enable           = arg;	// 비고
}
/*------------------------------------------------------------
	1. Function    : fn_SearchFmsUpjangInfo(arg)
	2. Description : 사업장 선택시 여신 정보 검색
	3. Arguments   : 
	4. History     : 2008. 04. 03 - 최초작성
*------------------------------------------------------------*/
function fn_SearchFmsUpjangInfo(arg)
{
	// Result DataSet Clear
	ds_FmsUpjang.clearData();
	
	// CallService
	fsp_clear(this);
	fsp_addSearch(this,"fm/fms:FMS00180E_S002");
	fsp_callService(this,"","","","ds_FmsUpjang=ds_FmsUpjang","UPJANG="+wrapQuote(arg),"fn_callBackFmsUpjangSearch", "", true);
}
/*------------------------------------------------------------
	1. Function    : fn_callBackFmsUpjangSearch(errCode, errMsg)
	2. Description : fn_SearchFmsUpjangInfo() CallBack Function
	3. Arguments   : 
	4. History     : 2008. 04. 03 - 최초작성
*------------------------------------------------------------*/
function fn_callBackFmsUpjangSearch(errCode, errMsg)
{	
	if( errCode != 0 ) {
		return;
	} else {
		//trace(ds_FmsUpjang.SaveXML());
		
		if( GetRowType(ds_List,grd_List.currentrow)== "insert" ) {
			// 여신 정보를 참조하여 여신회전일, 여신금액, 여신관리 기준 셋팅
			var iCreditTurnDays        = ds_FmsUpjang.getColumn(0, "CREDIT_TURN_DAYS"        );
			var sCreditTurnControlYn   = ds_FmsUpjang.getColumn(0, "CREDIT_TURN_CONTROL_YN"  );
			var iCreditAmount          = ds_FmsUpjang.getColumn(0, "CREDIT_AMOUNT"           );
			var sCreditAmountControlYn = ds_FmsUpjang.getColumn(0, "CREDIT_AMOUNT_CONTROL_YN");
			
			ds_List.setColumn(ds_List.rowposition, "CREDIT_TURN_CONTROL_YN", sCreditTurnControlYn);
			ds_List.setColumn(ds_List.rowposition, "CREDIT_AMOUNT_CONTROL_YN", sCreditAmountControlYn);
			
			// 여신회전 연장일
			ed_CreditTurnDays.value = iCreditTurnDays;
			if( sCreditTurnControlYn == "Y" ) {
				ed_CreditExtDays.enable = true;
			} else {
				ed_CreditExtDays.enable = false;
			}
			
			// 여신연장 금액
			me_CreditAmount.value = iCreditAmount;
			if( sCreditAmountControlYn == "Y" ) {
				me_CreditExtAmount.enable = true;
			} else {
				me_CreditExtAmount.enable = false;
			}
			
			// 여신관리 기준
			if( sCreditTurnControlYn == "Y" ) {
				if( sCreditAmountControlYn == "Y" ) {
					cbo_CreditStan.value = "4";
				} else {
					cbo_CreditStan.value = "2";
				}
			} else {
				if( sCreditAmountControlYn == "Y" ) {
					cbo_CreditStan.value = "3";
				} else {
					cbo_CreditStan.value = "1";
				}
			}
		}
	}
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
/*------------------------------------------------------------
	1. Function    : btn_ReqSabun_OnClick(obj)
	2. Description : 요청자 조회
	3. Arguments   : 
	4. History     : 2008. 03. 14 - 최초작성
*------------------------------------------------------------*/
function btn_ReqSabun_OnClick(obj)
{
	fn_SearchSabun("REQ");
}
function btn_ApprSabun_OnClick(obj:Button, e:ClickEventInfo)
{
	fn_SearchSabun("APPR");
}
/*------------------------------------------------------------
	1. Function    : fn_SearchSabun(strGubun)
	2. Description : 요청부서의 요청자/승인자 조회
	3. Arguments   : strGubun - 요청자/승인자 구분
	4. History     : 2008. 03. 14 - 최초작성
*------------------------------------------------------------*/
function fn_SearchSabun(strGubun)
{
	// 부서코드 체크
	if( gfn_length(gfn_trim(ds_Input.getColumn(0, "REQ_DEPT_ID")))== 0 || gfn_trim(ds_Input.getColumn(0, "REQ_DEPT_ID"))== null ) {
		g_Message("EE", "요청부서 정보가 없습니다.");
		ed_ReqDeptNm.setFocus();
		return;
	}
	
	var v_Query = " SELECT A.SABUN, A.NM_KOR FROM HLDC_HR_PERSONAL A, HLDC_SC_DEPT_V B WHERE A.DEPT_ID = '" + ds_Input.getColumn(0, "REQ_DEPT_ID") + "' AND A.DEPT_ID = B.DEPT_ID ";
	
	fn_sql_common_setup(v_Query,
						"A.SABUN",
						"A.NM_KOR",
						"사원번호",
						"사원명",
						"",
						"",
						"",
						"사원조회");

    if( gds_sql_common.getColumn(0, "ret_code") != "" ) {
		if( strGubun == "REQ" ) {
			ds_List.setColumn(ds_List.rowposition, "REQ_SABUN", gds_sql_common.getColumn(0, "ret_code"));
			ds_List.setColumn(ds_List.rowposition, "REQ_NAME",  gds_sql_common.getColumn(0, "ret_name"));
		} else {
			ds_List.setColumn(ds_List.rowposition, "APPR_SABUN", gds_sql_common.getColumn(0, "ret_code"));
			ds_List.setColumn(ds_List.rowposition, "APPR_NAME",  gds_sql_common.getColumn(0, "ret_name"));
			ed_CreditExtDays.setFocus();
		}
    }
}
/*------------------------------------------------------------
	1. Function    : btn_MainUpjang_OnClick(obj)
	2. Description : 본사 조회 팝업
	3. Arguments   : 
	4. History     : 2008. 04. 03 - 최초작성
*------------------------------------------------------------*/
function btn_MainUpjang_OnClick(obj:Button, e:ClickEventInfo)
{
	// 2008. 06. 09 -- 이혜은대리 요청사항
	// 로그인한 영업사원의 "담당 사업장"만 조회되게 해주세요. => 본사와 사업장의 영업사원이 미일치시 본사가 검색되지 않을 수 있음.
	// => 매출처 정보관리 페이지에서 영업사원을 일치시켜줘야 함.
	// PART_SALES_SABUN = g_EmpNo 추가
	var v_Query = " SELECT MAIN_UPJANG, UPJANGNM_DISP AS MAIN_UPJANGNM FROM FMS_UPJANG WHERE MAIN_UPJANG = UPJANG AND USE_YN = 'Y' AND PART_SALES_SABUN = '" + g_EmpNo + "' ";
	
	fn_sql_common_setup(v_Query,
						"MAIN_UPJANG",
						"UPJANGNM_DISP",
						"본사코드",
						"본사명",
						"",
						"",
						"",
						"본사조회",
						"MAIN_UPJANG;MAIN_UPJANGNM");

    if( gds_sql_common.getColumn(0, "ret_code") != "" ) {
		ds_List.setColumn(ds_List.rowposition, "MAIN_UPJANG",   gds_sql_common.getColumn(0, "ret_code"));
		ds_List.setColumn(ds_List.rowposition, "MAIN_UPJANGNM", gds_sql_common.getColumn(0, "ret_name"));
		ds_List.setColumn(ds_List.rowposition, "UPJANG",   "");
		ds_List.setColumn(ds_List.rowposition, "UPJANGNM", "");
		ed_MainUpjangNm.setFocus();
	}
}
/*------------------------------------------------------------
	1. Function    : btn_Upjang_OnClick(obj)
	2. Description : 사업장 조회 팝업
	3. Arguments   : 
	4. History     : 2008. 04. 03 - 최초작성
*------------------------------------------------------------*/
function btn_Upjang_OnClick(obj:Button, e:ClickEventInfo)
{
	if( gfn_length(gfn_trim(ds_List.getColumn(0, "MAIN_UPJANG")))== 0 ) {
		g_Message("EE", "본사를 먼저 선택하세요.");
		ed_MainUpjangNm.setFocus();
		return;
	}
	
	// 2008.05.19 -- 이혜은대리 요청사항
	// 사업장 선택시 매출처정보관리에서 [본사통합관리여부]가 '사용'인 사업장을 선택하면 선택되지 못하게 경고 메시지 띄워주세요.
	// "본사통합관리 사업장은 본사사업장코드로 신청하세요"
	// 메시지 요청이었으나 사업장 검색시 부터 제외시킴
	
	// 2008. 06. 09 -- 이혜은대리 요청사항
	// 로그인한 영업사원의 "담당 사업장"만 조회되게 해주세요.
	// PART_SALES_SABUN = g_EmpNo 추가
	
	var v_Query = " SELECT UPJANG, UPJANGNM_DISP AS UPJANGNM FROM FMS_UPJANG WHERE MAIN_UPJANG = " + ds_List.getColumn(ds_List.rowposition, "MAIN_UPJANG") + " AND USE_YN = 'Y' ";
		v_Query += " AND (HEAD_CREDIT_YN = 'N' OR (HEAD_CREDIT_YN = 'Y' AND MAIN_UPJANG = UPJANG)) ";
		v_Query += " AND PART_SALES_SABUN = '" + g_EmpNo + "' ";
	
	fn_sql_common_setup(v_Query,
						"UPJANG",
						"UPJANGNM_DISP",
						"사업장코드",
						"사업장명",
						"",
						"",
						"",
						"사업장조회",
						"UPJANG;UPJANGNM");

    if( gds_sql_common.getColumn(0, "ret_code") != "" ) {
		ds_List.setColumn(ds_List.rowposition, "UPJANG",   gds_sql_common.getColumn(0, "ret_code"));
		ds_List.setColumn(ds_List.rowposition, "UPJANGNM", gds_sql_common.getColumn(0, "ret_name"));
		// 입력 중 업장을 바꿨을 경우 여신회전 연장일, 여신연장 금액 초기화
		ds_List.setColumn(ds_List.rowposition, "CREDIT_EXT_DAYS",   "");
		ds_List.setColumn(ds_List.rowposition, "CREDIT_EXT_AMOUNT", "");
		// 업장코드를 이용한 여신정보 검색
		fn_SearchFmsUpjangInfo(ds_List.getColumn(ds_List.rowposition, "UPJANG"));
		ed_UpjangNm.setFocus();
    }
}
/*------------------------------------------------------------
	1. Function    : btn_Date_OnClick(obj)
	2. Description : 달력 팝업 호출
	3. Arguments   : 
	4. History     : 2008. 04. 03 - 최초작성
*------------------------------------------------------------*/
// function btn_Date_OnClick(obj:Button, e:ClickEventInfo)
// {
// 	var objme = eval(obj.userdata);
// 	var retDate = gfn_dialog("", "U_SCC::SCC_CALENDAR.xfdl","fa_Date="+wrapQuote(objme.value),-1,-1,"Title=false Status=false");
// 	objme.value  = retDate;
// 	objme.setFocus();
// }
/*------------------------------------------------------------
	1. Function    : grd_List_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
	2. Description : 그리드 정렬 및 엑셀 출력
	3. Arguments   : 
	4. History     : 2008. 04. 03 - 최초작성
*------------------------------------------------------------*/
function grd_List_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	if( e.cell == 0 ) {	// Excel Export
		gfn_exportExcel(obj, "Sheet1");
	} else {
		gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
	}
}
/*------------------------------------------------------------
	1. Function    : ds_List_OnRowPosChanged(obj,nOldRow,nRow)
	2. Description : 그리드 Row 변경시 수정가능여부 체크
	3. Arguments   : 
	4. History     : 2008. 04. 03 - 최초작성
*------------------------------------------------------------*/
function ds_List_OnRowPosChanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	if( GetRowType(ds_List,e.newrow)== "insert" ) {
		grd_List.setCellProperty("body", 11, "edittype", setCellEditVal(grd_List,"body",11,"none"));
		if( gfn_length(gfn_trim(ds_List.getColumn(e.newrow, "UPJANG")))== 6 ) {
			fn_SearchFmsUpjangInfo(ds_List.getColumn(e.newrow, "UPJANG"));
		}
		fn_CompEnable(true);
	} else {
		// 승인 또는 반려의 경우 수정 불가
		if( ds_List.getColumn(e.newrow, "APPR_YN") == "Y" || ds_List.getColumn(e.newrow, "APPR_YN") == "C" ) {
			grd_List.setCellProperty("body", 11, "edittype", setCellEditVal(grd_List,"body",11,"none"));
		} else {
			grd_List.setCellProperty("body", 11, "edittype", setCellEditVal(grd_List,"body",11,"checkbox"));
		}
		fn_CompEnable(false);
	}
}
/*------------------------------------------------------------
	1. Function    : grd_List_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
	2. Description : 삭제필드 클릭시 승인/반려건일 경우 메시지 출력
	3. Arguments   : 
	4. History     : 2008. 04. 03 - 최초작성
*------------------------------------------------------------*/
function grd_List_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	if( e.cell == 11 ) {
		ds_List.rowposition = e.row;
		if( ds_List.getColumn(e.row, "APPR_YN") == "Y" || ds_List.getColumn(e.row, "APPR_YN") == "C" ) {
			g_Message("EE", "처리된 신청은 삭제할 수 없습니다.");
			return;
		}
	}
}
/*------------------------------------------------------------
	1. Function    : frm_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
	2. Description : 폼 공통 엔터키 이벤트
	3. Arguments   : 
	4. History     : 2008. 04. 03 - 최초작성
*------------------------------------------------------------*/
function frm_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
}
/*------------------------------------------------------------
	1. Function    : fn_Pop_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
	2. Description : 팝업 관련 컴포넌트 엔터키 이벤트
	3. Arguments   : 
	4. History     : 2008. 04. 03 - 최초작성
*------------------------------------------------------------*/
function fn_Pop_OnKeyDown(obj, e)
{
	if( e.keycode == 13 ) {
		if( gfn_length(gfn_trim(obj.value))== 0 ) {
			var objme = eval(obj.userdata);
			objme.click();
		}
	} else if( e.keycode == 46 ) {
		switch(obj.name) {
			case "ed_MainUpjangNm" :
				ds_List.setColumn(ds_List.rowposition, "MAIN_UPJANG",   "");
				ds_List.setColumn(ds_List.rowposition, "MAIN_UPJANGNM", "");
				ds_List.setColumn(ds_List.rowposition, "UPJANG",        "");
				ds_List.setColumn(ds_List.rowposition, "UPJANGNM",      "");
				fn_SearchFmsUpjangInfo(ds_List.getColumn(ds_List.rowposition, "UPJANG"));
				break;
			case "ed_UpjangNm" :
				ds_List.setColumn(ds_List.rowposition, "UPJANG",   "");
				ds_List.setColumn(ds_List.rowposition, "UPJANGNM", "");
				fn_SearchFmsUpjangInfo(ds_List.getColumn(ds_List.rowposition, "UPJANG"));
				break;
			case "ed_ApprName" :
				ds_List.setColumn(ds_List.rowposition, "APPR_SABUN", "");
				ds_List.setColumn(ds_List.rowposition, "APPR_NAME",  "");
				break;
			default :
				break;
		}
	}
}

]]></Script>
  </Form>
</FDL>

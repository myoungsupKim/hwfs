<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="CouponSalePop" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1135 484" titletext="쿠폰 판매 처리" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="sta_detail07" class="sta_WFDA_Labelbg" position="absolute 108 158 428 185"/>
        <Static id="sta_detail37" class="sta_WFDA_Labelbg" position="absolute 108 341 428 368"/>
        <Static id="Static22" text="쿠폰 판매 처리" class="sta_WF_Title01" position="absolute 15 13 435 31" anchor="left top"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 15 0 1120 13" anchor="left top"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 15 26 916 31" anchor="left top"/>
        <Static id="sta_detail03" class="sta_WFDA_Labelbg" position="absolute 108 31 428 58"/>
        <Static id="sta_detail02" text="판매금액" class="sta_WFDA_Label01" position="absolute 15 31 109 58" onclick="sta_detail02_onclick"/>
        <Static id="Static37" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 210 35 225 54"/>
        <Static id="Static39" class="Guide01_AreaRed" visible="false" position="absolute 222 31 229 58"/>
        <Static id="sta_detail00" class="sta_WFDA_Labelbg" position="absolute 108 108 428 135"/>
        <Static id="sta_detail01" text="회계일자" class="sta_WFDA_Label01" position="absolute 15 108 109 135"/>
        <Static id="Static79" class="Guide01_AreaRed" visible="false" position="absolute 222 108 229 135"/>
        <Static id="Static80" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 210 111 225 130"/>
        <Static id="sta_detail09" class="sta_WFDA_Labelbg" position="absolute 108 133 428 160"/>
        <Static id="sta_detail11" text="사업부" class="sta_WFDA_Label01" position="absolute 15 133 109 160"/>
        <Static id="Static81" class="Guide01_AreaRed" visible="false" position="absolute 222 132 229 159"/>
        <Static id="Static82" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 210 135 225 154"/>
        <Static id="sta_detail14" class="sta_WFDA_Labelbg" position="absolute 108 159 428 186"/>
        <Static id="sta_detail15" text="원가부서" class="sta_WFDA_Label01" position="absolute 15 159 109 186"/>
        <Static id="Static83" class="Guide01_AreaRed" visible="false" position="absolute 222 159 229 186"/>
        <Static id="Static84" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 210 162 225 181"/>
        <Static id="sta_detail19" class="sta_WFDA_Labelbg" position="absolute 108 211 428 238"/>
        <Static id="sta_detail20" text="지불구분" class="sta_WFDA_Label01" position="absolute 15 211 109 238"/>
        <Static id="Static85" class="Guide01_AreaRed" visible="false" position="absolute 222 211 229 238"/>
        <Static id="Static86" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 210 214 225 233"/>
        <Static id="sta_detail27" class="sta_WFDA_Labelbg" position="absolute 108 56 428 83"/>
        <Static id="sta_detail28" text="공급가액" class="sta_WFDA_Label01" position="absolute 15 56 109 83"/>
        <Static id="Static23" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 210 60 225 79"/>
        <Static id="Static24" class="Guide01_AreaRed" visible="false" position="absolute 222 56 229 83"/>
        <Static id="sta_detail18" class="sta_WFDA_Labelbg" position="absolute 108 82 428 109"/>
        <Static id="sta_detail30" text="부가세금액" class="sta_WFDA_Label01" position="absolute 15 82 109 109"/>
        <Static id="Static25" class="Guide01_AreaRed" visible="false" position="absolute 222 82 229 109"/>
        <Static id="Static29" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 210 85 225 104"/>
        <Static id="Static30" text="1px 겹침" class="Guide05_SizeBlack" visible="false" position="absolute 233 77 293 96" style="opacity:50;"/>
        <Static id="sta_detail05" class="sta_WFDA_Labelbg" position="absolute 108 185 428 212"/>
        <Static id="sta_detail13" text="신고사업장" class="sta_WFDA_Label01" position="absolute 15 185 109 212"/>
        <Static id="Static31" class="Guide01_AreaRed" visible="false" position="absolute 222 185 229 212"/>
        <Static id="Static32" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 210 188 225 207"/>
        <Static id="sta_detail21" class="sta_WFDA_Labelbg" position="absolute 108 418 428 445"/>
        <Static id="sta_detail23" text="매입사" class="sta_WFDA_Label01" position="absolute 15 418 109 445"/>
        <Static id="Static33" class="Guide01_AreaRed" visible="false" position="absolute 222 418 229 445"/>
        <Static id="Static34" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 210 421 225 440"/>
        <Static id="sta_detail24" class="sta_WFDA_Labelbg" position="absolute 108 263 428 290"/>
        <Static id="sta_detail25" text="선수금번호" class="sta_WFDA_Label01" position="absolute 15 263 109 290"/>
        <Static id="Static17" class="Guide01_AreaRed" visible="false" position="absolute 222 263 229 290"/>
        <Static id="Static18" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 210 266 225 285"/>
        <Static id="sta_detail32" class="sta_WFDA_Labelbg" position="absolute 108 237 428 264"/>
        <Static id="sta_detail33" text="거래처" class="sta_WFDA_Label01" position="absolute 15 237 109 264"/>
        <Static id="Static19" class="Guide01_AreaRed" visible="false" position="absolute 222 237 229 264"/>
        <Static id="Static20" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 210 240 225 259"/>
        <Static id="sta_detail35" class="sta_WFDA_Labelbg" position="absolute 108 340 428 367"/>
        <Static id="sta_detail36" text="승인번호" class="sta_WFDA_Label01" position="absolute 15 315 109 342"/>
        <Static id="Static21" class="Guide01_AreaRed" visible="false" position="absolute 222 340 229 367"/>
        <Static id="Static26" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 210 343 225 362"/>
        <Static id="sta_detail38" class="sta_WFDA_Labelbg" position="absolute 108 289 428 316"/>
        <Static id="sta_detail39" text="카드번호" class="sta_WFDA_Label01" position="absolute 15 289 109 316"/>
        <Static id="Static27" class="Guide01_AreaRed" visible="false" position="absolute 222 289 229 316"/>
        <Static id="Static35" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 210 292 225 311"/>
        <Static id="sta_detail44" class="sta_WFDA_Labelbg" position="absolute 108 315 428 342"/>
        <Static id="sta_detail45" text="유효기간" class="sta_WFDA_Label01" position="absolute 15 341 109 368"/>
        <Static id="Static41" class="Guide01_AreaRed" visible="false" position="absolute 222 340 229 367"/>
        <Static id="Static42" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 210 343 225 362"/>
        <Edit id="edt_apprvNum" taborder="9" position="absolute 111 318 227 339" password="true" readonly="false" enable="false"/>
        <Static id="Static09" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1120 0 1135 484" anchor="top right"/>
        <Grid id="Grid01" taborder="32" binddataset="ds_couponSelect" useinputpanel="false" position="absolute 438 31 1120 364" anchor="left top">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="94"/>
                <Column size="158"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="60"/>
                <Column size="159"/>
                <Column size="109"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="쿠폰번호"/>
                <Cell col="1" text="명칭"/>
                <Cell col="2" text="쿠폰금액"/>
                <Cell col="3" text="공급가액"/>
                <Cell col="4" text="부가세금액"/>
                <Cell col="5" text="사용일"/>
                <Cell col="6" text="원가부서"/>
                <Cell col="7" text="원가부서CC"/>
              </Band>
              <Band id="body">
                <Cell text="bind:couponNum"/>
                <Cell col="1" text="bind:couponKindNm"/>
                <Cell col="2" displaytype="number" text="bind:couponAmt"/>
                <Cell col="3" displaytype="number" text="bind:supplyAmt"/>
                <Cell col="4" displaytype="number" text="bind:vatAmt"/>
                <Cell col="5" text="bind:useDate"/>
                <Cell col="6" text="bind:ccNm"/>
                <Cell col="7" text="bind:ccCd"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static53" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 428 30 438 484"/>
        <MaskEdit id="msk_sumCouponAmt" taborder="31" readonly="true" mask="@@@,@@@" enable="false" position="absolute 112 33 212 54" tabstop="false"/>
        <MaskEdit id="msk_sumSupplyAmt" taborder="30" readonly="true" mask="@@@,@@@" enable="false" position="absolute 112 59 212 80" tabstop="false"/>
        <MaskEdit id="msk_sumVatAmt" taborder="29" readonly="true" mask="@@@,@@@" enable="false" position="absolute 112 85 212 106" tabstop="false"/>
        <Radio id="rdo_payType" taborder="4" columncount="4" rowcount="0" innerdataset="@ds_지불구분" codecolumn="지불구분코드" datacolumn="지불구분" class="rdo_WF_Essential" position="absolute 116 216 348 236" index="0" value="1" onitemchanged="rdo_payType_onitemchanged" onitemclick="rdo_payType_onitemclick"/>
        <Static id="sta_detail04" class="sta_WFDA_Labelbg" position="absolute 108 444 428 471"/>
        <Static id="sta_detail06" text="적요" class="sta_WFDA_Label01" position="absolute 15 444 109 471"/>
        <Static id="Static00" class="Guide01_AreaRed" visible="false" position="absolute 222 444 229 471"/>
        <Static id="Static01" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 210 447 225 466"/>
        <Edit id="edt_remark" taborder="14" position="absolute 111 447 425 468" class="edt_WF_Essential"/>
        <Combo id="cbo_receiveBankcd" taborder="13" innerdataset="@ds_buycpnyCd" codecolumn="buycpnyCd" datacolumn="buycpnyNm" index="-1" position="absolute 111 421 315 442" anchor="left top" readonly="false" enable="false"/>
        <Edit id="edt_validYymm" taborder="10" enable="false" position="absolute 111 344 208 365" readonly="false"/>
        <Edit id="edt_advanceNum" taborder="7" position="absolute 112 266 245 287" readonly="true" enable="false"/>
        <Button id="btn_advanceSelect" taborder="28" position="absolute 244 266 265 287" anchor="left top" class="btn_WF_popSearch" onclick="btn_advanceSelect_onclick" enable="false"/>
        <Static id="sta_detail10" class="sta_WFDA_Labelbg" position="absolute 531 395 901 422"/>
        <Static id="sta_detail12" text="쿠폰번호" class="sta_WFDA_Label01" position="absolute 438 395 532 422"/>
        <Static id="Static02" class="Guide01_AreaRed" visible="false" position="absolute 645 395 652 422"/>
        <Static id="Static03" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 633 398 648 417"/>
        <Edit id="edt_couponNum" taborder="15" class="edt_WF_Essential" position="absolute 534 398 632 419"/>
        <Button id="btn_couponNum" taborder="27" class="btn_WF_popSearch" position="absolute 631 398 652 419" anchor="left top" onclick="btn_couponNum_onclick"/>
        <Static id="sta_detail16" class="sta_WFDA_Labelbg" position="absolute 531 421 901 448"/>
        <Static id="sta_detail17" text="쿠폰금액" class="sta_WFDA_Label01" position="absolute 438 421 532 448"/>
        <Static id="Static04" class="Guide01_AreaRed" visible="false" position="absolute 654 421 661 448"/>
        <Static id="Static05" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 633 424 648 443"/>
        <Edit id="edt_couponKindNm" taborder="16" readonly="true" autoselect="true" onkeydown="fn_edBtn_OnKeyDown" position="absolute 654 398 830 419"/>
        <MaskEdit id="msk_couponAmt" taborder="26" mask="@@@,@@@" position="absolute 534 424 631 445" readonly="true" tabstop="false"/>
        <Static id="sta_detail22" text="Net/부가세" class="sta_WFDA_Label01" position="absolute 654 421 748 448"/>
        <MaskEdit id="msk_vatAmt" taborder="25" readonly="true" mask="@@@,@@@" enable="false" position="absolute 845 424 898 445" tabstop="false"/>
        <MaskEdit id="msk_supplyAmt" taborder="24" readonly="true" mask="@@@,@@@" enable="false" position="absolute 750 424 830 445" tabstop="false"/>
        <Static id="Static06" text="/" position="absolute 833 423 843 448"/>
        <Button id="btn_cancleProc" taborder="23" text="판매취소" class="btn_WF_CRUD" position="absolute 356 6 427 29" onclick="btn_cancleProc_onclick" visible="false"/>
        <Static id="sta_detail26" class="sta_WFDA_Labelbg" position="absolute 108 366 428 393"/>
        <Static id="sta_detail29" text="승인금액" class="sta_WFDA_Label01" position="absolute 15 366 109 393"/>
        <Static id="Static07" class="Guide01_AreaRed" visible="false" position="absolute 222 366 229 393"/>
        <Static id="Static08" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 210 369 225 388"/>
        <Static id="sta_detail31" class="sta_WFDA_Labelbg" position="absolute 108 392 428 419"/>
        <Static id="sta_detail34" text="할부기간" class="sta_WFDA_Label01" position="absolute 15 392 109 419"/>
        <Static id="Static10" class="Guide01_AreaRed" visible="false" position="absolute 222 392 229 419"/>
        <Static id="Static11" text="27" class="Guide05_SizeBlack" visible="false" position="absolute 210 395 225 414"/>
        <MaskEdit id="msk_receiveAmt" taborder="11" mask="@@@,@@@" position="absolute 111 369 211 390" readonly="false"/>
        <MaskEdit id="msk_할부기간" taborder="12" position="absolute 111 395 139 416" readonly="false"/>
        <Button id="btn_creditCardSelect" taborder="22" text="승인내역선택" position="absolute 336 292 425 313" onclick="btn_creditCardSelect_onclick" enable="false" visible="false"/>
        <Button id="btn_addRow" taborder="21" text="저장" class="btn_WF_Function" position="absolute 814 451 855 471" onclick="btn_addRow_onclick"/>
        <Button id="btn_delRow" taborder="20" text="삭제" class="btn_WF_Function" position="absolute 858 451 899 471" onclick="btn_delRow_onclick"/>
        <Button id="btn_addCouponNum" taborder="19" text="일괄선택" class="btn_WF_Function" position="absolute 833 398 898 418" onclick="btn_addCouponNum_onclick"/>
        <Button id="btn_saveProc" taborder="18" text="판매처리" class="btn_WF_CRUD" position="absolute 355 6 426 29" onclick="btn_saveProc_onclick"/>
        <Static id="Static12" text="선택된 쿠폰 리스트" class="sta_WF_Title01" position="absolute 439 13 859 31" anchor="left top"/>
        <Static id="Static14" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 15 471 916 484" anchor="left top"/>
        <Static id="Static28" text="쿠폰 선택" class="sta_WF_Title01" position="absolute 439 377 859 395" anchor="left top"/>
        <Static id="Static38" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 438 364 916 377" anchor="left top"/>
        <Static id="Static13" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 438 390 915 395" anchor="left top"/>
        <Combo id="cbo_muCd" taborder="1" value="01" displayrowcount="10" position="absolute 112 136 311 157" anchor="left top" class="cmb_WF_Essential" readonly="true"/>
        <Edit id="edt_ccCd" taborder="2" readonly="true" class="edt_WF_Essential" position="absolute 112 162 162 183"/>
        <Button id="btn_ccCdDtl" taborder="33" class="btn_WF_popSearch" position="absolute 161 162 182 183" anchor="left top" enable="true"/>
        <Edit id="edt_ccNm" taborder="17" readonly="true" autoselect="true" onkeydown="fn_edBtn_OnKeyDown" enable="false" position="absolute 184 162 426 183" tabstop="false"/>
        <Edit id="edt_custCd" taborder="5" position="absolute 112 240 192 261" enable="true" tabstop="true" class="edt_WF_Essential"/>
        <CustSearchComponent id="edt_custNm" titletext="거래처 검색용 Component" taborder="6" text="CustSearchComponent00" position="absolute 193 240 412 261" bindDataset="ds_view" eventBeforeTrigger="" eventAfterTrigger="" bindCustCodeColumn="custCd" bindCustNameColumn="custNm" enable="true" class="edt_WF_Essential"/>
        <UpjangSearchComponent id="edt_upjang" titletext="업장 검색용 Component" taborder="3" text="UpjangSearchComponent00" position="absolute 112 188 269 209" bindDataset="ds_view" bindUpjangCodeColumn="newhghtUpjang" bindUpjangNameColumn="" eventBeforeTrigger="fn_upjangSearchComponentBefore" eventAfterTrigger="fn_upjangSearchComponentAfter" roleSetId="ScoUpjang" class="btn_WF_popSearch"/>
        <ObjCalendar id="cal_procDate" titletext="캘린더" taborder="0" onclick="cal_procDateFr_onclick" scrollbars="none" position="absolute 112 110 213 131"/>
        <Edit id="edt_couponKindCd" taborder="34" readonly="true" autoselect="true" onkeydown="fn_edBtn_OnKeyDown" position="absolute 742 449 808 470" visible="false"/>
        <Edit id="edt_creditCardNum" taborder="8" password="false" readonly="false" enable="false" position="absolute 112 292 332 313"/>
        <Static id="Static36" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 15 484" anchor="top right"/>
        <Grid id="Grid00" taborder="35" useinputpanel="false" position="absolute 452 518 813 744" binddataset="ds_view" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="couponProcNum"/>
                <Cell col="1" disptype="normal" text="procDate"/>
                <Cell col="2" disptype="normal" text="couponProcOccurClass"/>
                <Cell col="3" disptype="normal" text="focYn"/>
                <Cell col="4" disptype="normal" text="custCd"/>
                <Cell col="5" disptype="normal" text="custNm"/>
                <Cell col="6" disptype="normal" text="muCd"/>
                <Cell col="7" disptype="normal" text="ccCd"/>
                <Cell col="8" disptype="normal" text="ccNm"/>
                <Cell col="9" disptype="normal" text="couponAmt"/>
                <Cell col="10" disptype="normal" text="supplyAmt"/>
                <Cell col="11" disptype="normal" text="vatAmt"/>
                <Cell col="12" disptype="normal" text="vatCd"/>
                <Cell col="13" disptype="normal" text="newhghtUpjang"/>
                <Cell col="14" disptype="normal" text="taxBillPublishDate"/>
                <Cell col="15" disptype="normal" text="excAmt"/>
                <Cell col="16" disptype="normal" text="procAmt"/>
                <Cell col="17" disptype="normal" text="payGrp"/>
                <Cell col="18" disptype="normal" text="payType"/>
                <Cell col="19" disptype="normal" text="paySchdDate"/>
                <Cell col="20" disptype="normal" text="remark"/>
                <Cell col="21" disptype="normal" text="upjangCd"/>
                <Cell col="22" disptype="normal" text="receiptNum"/>
                <Cell col="23" disptype="normal" text="posNum"/>
                <Cell col="24" disptype="normal" text="arTypeCd"/>
                <Cell col="25" disptype="normal" text="arNum"/>
                <Cell col="26" disptype="normal" text="batchId"/>
                <Cell col="27" disptype="normal" text="recdStatus"/>
                <Cell col="28" disptype="normal" text="journalzYn"/>
                <Cell col="29" disptype="normal" text="journalzNum"/>
                <Cell col="30" disptype="normal" text="cuser"/>
                <Cell col="31" disptype="normal" text="cdate"/>
                <Cell col="32" disptype="normal" text="uuser"/>
                <Cell col="33" disptype="normal" text="udate"/>
                <Cell col="34" disptype="normal" text="seq"/>
                <Cell col="35" disptype="normal" text="receiveTypeCd"/>
                <Cell col="36" disptype="normal" text="buycpnyCd"/>
                <Cell col="37" disptype="normal" text="selfBuClassCd"/>
                <Cell col="38" disptype="normal" text="creditCardNum"/>
                <Cell col="39" disptype="normal" text="apprvNum"/>
                <Cell col="40" disptype="normal" text="validYymm"/>
                <Cell col="41" disptype="normal" text="receiveBankcd"/>
                <Cell col="42" disptype="normal" text="imnoCrgleftNum"/>
                <Cell col="43" disptype="normal" text="suspenseDate"/>
                <Cell col="44" disptype="normal" text="imnoReceiveSeq"/>
                <Cell col="45" disptype="normal" text="suspenseSrlnum"/>
                <Cell col="46" disptype="normal" text="imnoAltNum"/>
                <Cell col="47" disptype="normal" text="advanceNum"/>
                <Cell col="48" disptype="normal" text="receiveAmt"/>
                <Cell col="49" disptype="normal" text="advanceAltNum"/>
                <Cell col="50" disptype="normal" text="arReceiveCount"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:couponProcNum"/>
                <Cell col="1" disptype="normal" text="bind:procDate"/>
                <Cell col="2" disptype="normal" text="bind:couponProcOccurClass"/>
                <Cell col="3" disptype="normal" text="bind:focYn"/>
                <Cell col="4" disptype="normal" text="bind:custCd"/>
                <Cell col="5" disptype="normal" text="bind:custNm"/>
                <Cell col="6" disptype="normal" text="bind:muCd"/>
                <Cell col="7" disptype="normal" text="bind:ccCd"/>
                <Cell col="8" disptype="normal" text="bind:ccNm"/>
                <Cell col="9" disptype="normal" text="bind:couponAmt"/>
                <Cell col="10" disptype="normal" text="bind:supplyAmt"/>
                <Cell col="11" disptype="normal" text="bind:vatAmt"/>
                <Cell col="12" disptype="normal" text="bind:vatCd"/>
                <Cell col="13" disptype="normal" text="bind:newhghtUpjang"/>
                <Cell col="14" disptype="normal" text="bind:taxBillPublishDate"/>
                <Cell col="15" disptype="normal" text="bind:excAmt"/>
                <Cell col="16" disptype="normal" text="bind:procAmt"/>
                <Cell col="17" disptype="normal" text="bind:payGrp"/>
                <Cell col="18" disptype="normal" text="bind:payType"/>
                <Cell col="19" disptype="normal" text="bind:paySchdDate"/>
                <Cell col="20" disptype="normal" text="bind:remark"/>
                <Cell col="21" disptype="normal" text="bind:upjangCd"/>
                <Cell col="22" disptype="normal" text="bind:receiptNum"/>
                <Cell col="23" disptype="normal" text="bind:posNum"/>
                <Cell col="24" disptype="normal" text="bind:arTypeCd"/>
                <Cell col="25" disptype="normal" text="bind:arNum"/>
                <Cell col="26" disptype="normal" text="bind:batchId"/>
                <Cell col="27" disptype="normal" text="bind:recdStatus"/>
                <Cell col="28" disptype="normal" text="bind:journalzYn"/>
                <Cell col="29" disptype="normal" text="bind:journalzNum"/>
                <Cell col="30" disptype="normal" text="bind:cuser"/>
                <Cell col="31" disptype="normal" text="bind:cdate"/>
                <Cell col="32" disptype="normal" text="bind:uuser"/>
                <Cell col="33" disptype="normal" text="bind:udate"/>
                <Cell col="34" disptype="normal" text="bind:seq"/>
                <Cell col="35" disptype="normal" text="bind:receiveTypeCd"/>
                <Cell col="36" disptype="normal" text="bind:buycpnyCd"/>
                <Cell col="37" disptype="normal" text="bind:selfBuClassCd"/>
                <Cell col="38" disptype="normal" text="bind:creditCardNum"/>
                <Cell col="39" disptype="normal" text="bind:apprvNum"/>
                <Cell col="40" disptype="normal" text="bind:validYymm"/>
                <Cell col="41" disptype="normal" text="bind:receiveBankcd"/>
                <Cell col="42" disptype="normal" text="bind:imnoCrgleftNum"/>
                <Cell col="43" disptype="normal" text="bind:suspenseDate"/>
                <Cell col="44" disptype="normal" text="bind:imnoReceiveSeq"/>
                <Cell col="45" disptype="normal" text="bind:suspenseSrlnum"/>
                <Cell col="46" disptype="normal" text="bind:imnoAltNum"/>
                <Cell col="47" disptype="normal" text="bind:advanceNum"/>
                <Cell col="48" disptype="normal" text="bind:receiveAmt"/>
                <Cell col="49" disptype="normal" text="bind:advanceAltNum"/>
                <Cell col="50" disptype="normal" text="bind:arReceiveCount"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Edit id="edt_acctCd" taborder="36" readonly="true" autoselect="true" onkeydown="fn_edBtn_OnKeyDown" visible="false" position="absolute 662 449 728 470"/>
        <Edit id="edt_vatCd" taborder="37" readonly="true" autoselect="true" onkeydown="fn_edBtn_OnKeyDown" visible="false" position="absolute 574 449 640 470"/>
        <Grid id="Grid02" taborder="38" useinputpanel="false" position="absolute 516 496 936 717" binddataset="ds_view" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="couponProcNum"/>
                <Cell col="1" disptype="normal" text="procDate"/>
                <Cell col="2" disptype="normal" text="couponProcOccurClass"/>
                <Cell col="3" disptype="normal" text="focYn"/>
                <Cell col="4" disptype="normal" text="custCd"/>
                <Cell col="5" disptype="normal" text="custNm"/>
                <Cell col="6" disptype="normal" text="muCd"/>
                <Cell col="7" disptype="normal" text="ccCd"/>
                <Cell col="8" disptype="normal" text="ccNm"/>
                <Cell col="9" disptype="normal" text="couponAmt"/>
                <Cell col="10" disptype="normal" text="supplyAmt"/>
                <Cell col="11" disptype="normal" text="vatAmt"/>
                <Cell col="12" disptype="normal" text="vatCd"/>
                <Cell col="13" disptype="normal" text="newhghtUpjang"/>
                <Cell col="14" disptype="normal" text="taxBillPublishDate"/>
                <Cell col="15" disptype="normal" text="excAmt"/>
                <Cell col="16" disptype="normal" text="procAmt"/>
                <Cell col="17" disptype="normal" text="payGrp"/>
                <Cell col="18" disptype="normal" text="payType"/>
                <Cell col="19" disptype="normal" text="paySchdDate"/>
                <Cell col="20" disptype="normal" text="remark"/>
                <Cell col="21" disptype="normal" text="upjangCd"/>
                <Cell col="22" disptype="normal" text="receiptNum"/>
                <Cell col="23" disptype="normal" text="posNum"/>
                <Cell col="24" disptype="normal" text="arTypeCd"/>
                <Cell col="25" disptype="normal" text="arNum"/>
                <Cell col="26" disptype="normal" text="batchId"/>
                <Cell col="27" disptype="normal" text="recdStatus"/>
                <Cell col="28" disptype="normal" text="journalzYn"/>
                <Cell col="29" disptype="normal" text="journalzNum"/>
                <Cell col="30" disptype="normal" text="cuser"/>
                <Cell col="31" disptype="normal" text="cdate"/>
                <Cell col="32" disptype="normal" text="uuser"/>
                <Cell col="33" disptype="normal" text="udate"/>
                <Cell col="34" disptype="normal" text="seq"/>
                <Cell col="35" disptype="normal" text="receiveTypeCd"/>
                <Cell col="36" disptype="normal" text="buycpnyCd"/>
                <Cell col="37" disptype="normal" text="selfBuClassCd"/>
                <Cell col="38" disptype="normal" text="creditCardNum"/>
                <Cell col="39" disptype="normal" text="apprvNum"/>
                <Cell col="40" disptype="normal" text="validYymm"/>
                <Cell col="41" disptype="normal" text="receiveBankcd"/>
                <Cell col="42" disptype="normal" text="imnoCrgleftNum"/>
                <Cell col="43" disptype="normal" text="suspenseDate"/>
                <Cell col="44" disptype="normal" text="imnoReceiveSeq"/>
                <Cell col="45" disptype="normal" text="suspenseSrlnum"/>
                <Cell col="46" disptype="normal" text="imnoAltNum"/>
                <Cell col="47" disptype="normal" text="advanceNum"/>
                <Cell col="48" disptype="normal" text="receiveAmt"/>
                <Cell col="49" disptype="normal" text="advanceAltNum"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:couponProcNum"/>
                <Cell col="1" disptype="normal" text="bind:procDate"/>
                <Cell col="2" disptype="normal" text="bind:couponProcOccurClass"/>
                <Cell col="3" disptype="normal" text="bind:focYn"/>
                <Cell col="4" disptype="normal" text="bind:custCd"/>
                <Cell col="5" disptype="normal" text="bind:custNm"/>
                <Cell col="6" disptype="normal" text="bind:muCd"/>
                <Cell col="7" disptype="normal" text="bind:ccCd"/>
                <Cell col="8" disptype="normal" text="bind:ccNm"/>
                <Cell col="9" disptype="normal" text="bind:couponAmt"/>
                <Cell col="10" disptype="normal" text="bind:supplyAmt"/>
                <Cell col="11" disptype="normal" text="bind:vatAmt"/>
                <Cell col="12" disptype="normal" text="bind:vatCd"/>
                <Cell col="13" disptype="normal" text="bind:newhghtUpjang"/>
                <Cell col="14" disptype="normal" text="bind:taxBillPublishDate"/>
                <Cell col="15" disptype="normal" text="bind:excAmt"/>
                <Cell col="16" disptype="normal" text="bind:procAmt"/>
                <Cell col="17" disptype="normal" text="bind:payGrp"/>
                <Cell col="18" disptype="normal" text="bind:payType"/>
                <Cell col="19" disptype="normal" text="bind:paySchdDate"/>
                <Cell col="20" disptype="normal" text="bind:remark"/>
                <Cell col="21" disptype="normal" text="bind:upjangCd"/>
                <Cell col="22" disptype="normal" text="bind:receiptNum"/>
                <Cell col="23" disptype="normal" text="bind:posNum"/>
                <Cell col="24" disptype="normal" text="bind:arTypeCd"/>
                <Cell col="25" disptype="normal" text="bind:arNum"/>
                <Cell col="26" disptype="normal" text="bind:batchId"/>
                <Cell col="27" disptype="normal" text="bind:recdStatus"/>
                <Cell col="28" disptype="normal" text="bind:journalzYn"/>
                <Cell col="29" disptype="normal" text="bind:journalzNum"/>
                <Cell col="30" disptype="normal" text="bind:cuser"/>
                <Cell col="31" disptype="normal" text="bind:cdate"/>
                <Cell col="32" disptype="normal" text="bind:uuser"/>
                <Cell col="33" disptype="normal" text="bind:udate"/>
                <Cell col="34" disptype="normal" text="bind:seq"/>
                <Cell col="35" disptype="normal" text="bind:receiveTypeCd"/>
                <Cell col="36" disptype="normal" text="bind:buycpnyCd"/>
                <Cell col="37" disptype="normal" text="bind:selfBuClassCd"/>
                <Cell col="38" disptype="normal" text="bind:creditCardNum"/>
                <Cell col="39" disptype="normal" text="bind:apprvNum"/>
                <Cell col="40" disptype="normal" text="bind:validYymm"/>
                <Cell col="41" disptype="normal" text="bind:receiveBankcd"/>
                <Cell col="42" disptype="normal" text="bind:imnoCrgleftNum"/>
                <Cell col="43" disptype="normal" text="bind:suspenseDate"/>
                <Cell col="44" disptype="normal" text="bind:imnoReceiveSeq"/>
                <Cell col="45" disptype="normal" text="bind:suspenseSrlnum"/>
                <Cell col="46" disptype="normal" text="bind:imnoAltNum"/>
                <Cell col="47" disptype="normal" text="bind:advanceNum"/>
                <Cell col="48" disptype="normal" text="bind:receiveAmt"/>
                <Cell col="49" disptype="normal" text="bind:advanceAltNum"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="sta_detail08" text="쿠폰종류" class="sta_WFDA_Label01" position="absolute 2 531 96 558" visible="false"/>
        <Edit id="edt_couponKindCd00" taborder="39" readonly="true" class="edt_WF_Essential" position="absolute 99 534 158 555" anchor="left top" visible="false"/>
        <Button id="btn_couponKindSch" taborder="40" onclick="btn_couponKindSch_onclick" class="btn_WF_popSearch" position="absolute 157 534 178 555" anchor="left top" visible="false"/>
        <Edit id="edt_couponKindNm00" taborder="41" readonly="true" autoselect="true" onkeydown="fn_edBtn_OnKeyDown" class="edt_WF_Essential" position="absolute 177 534 412 555" visible="false"/>
        <Edit id="edt_ccCd2" taborder="42" readonly="true" autoselect="true" onkeydown="fn_edBtn_OnKeyDown" visible="false" position="absolute 446 448 512 469"/>
        <Edit id="edt_ccNm2" taborder="43" readonly="true" autoselect="true" onkeydown="fn_edBtn_OnKeyDown" visible="false" position="absolute 516 449 582 470"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item1" compid="cbo_muCd" propid="value" datasetid="ds_view" columnid="muCd"/>
      <BindItem id="item8" compid="edt_ccCd" propid="value" datasetid="ds_view" columnid="ccCd"/>
      <BindItem id="item7" compid="edt_custCd" propid="value" datasetid="ds_view" columnid="custCd"/>
      <BindItem id="item2" compid="msk_sumCouponAmt" propid="value" datasetid="ds_view" columnid="couponAmt"/>
      <BindItem id="item3" compid="msk_sumSupplyAmt" propid="value" datasetid="ds_view" columnid="supplyAmt"/>
      <BindItem id="item4" compid="msk_sumVatAmt" propid="value" datasetid="ds_view" columnid="vatAmt"/>
      <BindItem id="item5" compid="edt_remark" propid="value" datasetid="ds_view" columnid="remark"/>
      <BindItem id="item0" compid="cal_procDate" propid="text" datasetid="ds_view" columnid="procDate"/>
      <BindItem id="item6" compid="rdo_payType" propid="value" datasetid="ds_view" columnid="payType"/>
      <BindItem id="item9" compid="edt_advanceNum" propid="value" datasetid="ds_view" columnid="advanceNum"/>
      <BindItem id="item11" compid="edt_apprvNum" propid="value" datasetid="ds_view" columnid="apprvNum"/>
      <BindItem id="item12" compid="edt_validYymm" propid="value" datasetid="ds_view" columnid="validYymm"/>
      <BindItem id="item13" compid="msk_receiveAmt" propid="value" datasetid="ds_view" columnid="receiveAmt"/>
      <BindItem id="item14" compid="cbo_receiveBankcd" propid="value" datasetid="ds_view" columnid="buycpnyCd"/>
      <BindItem id="item15" compid="edt_creditCardNum" propid="value" datasetid="ds_view" columnid="creditCardNum"/>
      <BindItem id="item10" compid="edt_ccNm" propid="value" datasetid="ds_view" columnid="ccNm"/>
      <BindItem id="item16" compid="edt_couponKindCd00" propid="value" datasetid="ds_view" columnid="couponKindCd"/>
      <BindItem id="item17" compid="edt_couponKindNm00" propid="value" datasetid="ds_view" columnid="couponKindNm"/>
    </Bind>
    <Objects>
      <Dataset id="ds_사업부" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="사업부" type="STRING" size="256"/>
          <Column id="사업부명" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="사업부">01</Col>
            <Col id="사업부명">외식사업부</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_신고사업장" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="신고사업장코드" type="STRING" size="256"/>
          <Column id="신고사업장" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="신고사업장코드">10101010101</Col>
            <Col id="신고사업장">한화호텔앤드리조트(주)</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_couponSelect" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="couponKindCd" type="string" size="255"/>
          <Column id="couponKindNm" type="string" size="255"/>
          <Column id="couponNum" type="string" size="255"/>
          <Column id="couponAmt" type="bigdecimal" size="255"/>
          <Column id="supplyAmt" type="bigdecimal" size="255"/>
          <Column id="vatAmt" type="bigdecimal" size="255"/>
          <Column id="useDate" type="STRING" size="256"/>
          <Column id="vatCd" type="STRING" size="256"/>
          <Column id="acctCd" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_지불구분" preload="true" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep">
        <ColumnInfo>
          <Column id="지불구분코드" type="STRING" size="256"/>
          <Column id="지불구분" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="지불구분코드">1</Col>
            <Col id="지불구분">현금</Col>
          </Row>
          <Row>
            <Col id="지불구분코드">2</Col>
            <Col id="지불구분">카드</Col>
          </Row>
          <Row>
            <Col id="지불구분">후불</Col>
            <Col id="지불구분코드">7</Col>
          </Row>
          <Row>
            <Col id="지불구분">선수금</Col>
            <Col id="지불구분코드">P2</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="couponProcNum" type="STRING" size="256"/>
          <Column id="buycpnyCd" type="STRING" size="256"/>
          <Column id="buycpnyNm" type="STRING" size="256"/>
          <Column id="inqueryStartDate" type="string" size="255"/>
          <Column id="inqueryEndDate" type="string" size="255"/>
          <Column id="inqueryMuCd" type="string" size="255"/>
          <Column id="inqueryTmCd" type="string" size="255"/>
          <Column id="inqueryCcCd" type="string" size="255"/>
          <Column id="inqueryCcNm" type="string" size="255"/>
          <Column id="inqueryCustCd" type="bigdecimal" size="255"/>
          <Column id="inqueryCustNm" type="string" size="255"/>
          <Column id="altNum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="couponKindCd" type="string" size="255"/>
          <Column id="couponKindNm" type="string" size="255"/>
          <Column id="couponNum" type="string" size="255"/>
          <Column id="couponAmt" type="bigdecimal" size="255"/>
          <Column id="supplyAmt" type="bigdecimal" size="255"/>
          <Column id="vatAmt" type="bigdecimal" size="255"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_view" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="couponProcNum" type="STRING" size="18"/>
          <Column id="procDate" type="STRING" size="8"/>
          <Column id="couponProcOccurClass" type="STRING" size="2"/>
          <Column id="focYn" type="STRING" size="1"/>
          <Column id="custCd" type="BIGDECIMAL" size="22"/>
          <Column id="custNm" type="STRING" size="60"/>
          <Column id="muCd" type="STRING" size="4"/>
          <Column id="ccCd" type="STRING" size="6"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="couponAmt" type="BIGDECIMAL" size="22"/>
          <Column id="supplyAmt" type="BIGDECIMAL" size="22"/>
          <Column id="vatAmt" type="BIGDECIMAL" size="22"/>
          <Column id="vatCd" type="STRING" size="1"/>
          <Column id="newhghtUpjang" type="STRING" size="12"/>
          <Column id="taxBillPublishDate" type="STRING" size="2"/>
          <Column id="excAmt" type="BIGDECIMAL" size="22"/>
          <Column id="procAmt" type="BIGDECIMAL" size="22"/>
          <Column id="payGrp" type="STRING" size="3"/>
          <Column id="payType" type="STRING" size="3"/>
          <Column id="paySchdDate" type="STRING" size="8"/>
          <Column id="remark" type="STRING" size="300"/>
          <Column id="upjangCd" type="STRING" size="12"/>
          <Column id="receiptNum" type="STRING" size="7"/>
          <Column id="posNum" type="STRING" size="2"/>
          <Column id="arTypeCd" type="STRING" size="4"/>
          <Column id="arNum" type="STRING" size="20"/>
          <Column id="batchId" type="STRING" size="10"/>
          <Column id="recdStatus" type="STRING" size="1"/>
          <Column id="journalzYn" type="STRING" size="1"/>
          <Column id="journalzNum" type="STRING" size="18"/>
          <Column id="cuser" type="STRING" size="10"/>
          <Column id="cdate" type="DATETIME" size="7"/>
          <Column id="uuser" type="STRING" size="10"/>
          <Column id="udate" type="DATETIME" size="7"/>
          <Column id="seq" type="BIGDECIMAL" size="22"/>
          <Column id="receiveTypeCd" type="STRING" size="4"/>
          <Column id="buycpnyCd" type="STRING" size="4"/>
          <Column id="selfBuClassCd" type="STRING" size="18"/>
          <Column id="creditCardNum" type="STRING" size="512"/>
          <Column id="apprvNum" type="STRING" size="20"/>
          <Column id="validYymm" type="STRING" size="6"/>
          <Column id="receiveBankcd" type="STRING" size="2"/>
          <Column id="imnoCrgleftNum" type="STRING" size="30"/>
          <Column id="suspenseDate" type="STRING" size="8"/>
          <Column id="imnoReceiveSeq" type="STRING" size="4"/>
          <Column id="suspenseSrlnum" type="BIGDECIMAL" size="22"/>
          <Column id="imnoAltNum" type="BIGDECIMAL" size="22"/>
          <Column id="advanceNum" type="STRING" size="18"/>
          <Column id="receiveAmt" type="BIGDECIMAL" size="22"/>
          <Column id="advanceAltNum" type="STRING" size="256"/>
          <Column id="arReceiveCount" type="STRING" size="256"/>
          <Column id="couponKindCd" type="STRING" size="256"/>
          <Column id="couponKindNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_viewValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="procDate" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="moveDate" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="payType" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="ccCd">title:원가부서,required:true</Col>
            <Col id="moveDate">title:배포일자,required:true</Col>
            <Col id="remark">title:적요,required:true</Col>
            <Col id="procDate">title:회계일자,required:true</Col>
            <Col id="muCd">title:사업부,required:true</Col>
            <Col id="custCd">title:거래처,required:true</Col>
            <Col id="payType">title:지불구분,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_buycpnyCd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="buycpnyCd" type="STRING" size="256"/>
          <Column id="buycpnyNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listAdvance" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_listAdvance_oncolumnchanged">
        <ColumnInfo>
          <Column id="advanceNum" type="STRING" size="256"/>
          <Column id="seq" type="INT" size="256"/>
          <Column id="occurDate" type="STRING" size="256"/>
          <Column id="fiscalDate" type="STRING" size="256"/>
          <Column id="advanceOccurClass" type="STRING" size="256"/>
          <Column id="advanceTypeCd" type="STRING" size="256"/>
          <Column id="custCd" type="INT" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="acctCd" type="STRING" size="256"/>
          <Column id="batchId" type="STRING" size="256"/>
          <Column id="occurAmtOrg" type="BIGDECIMAL" size="256"/>
          <Column id="applyAmtOrg" type="BIGDECIMAL" size="256"/>
          <Column id="occurSupplyAmt" type="BIGDECIMAL" size="256"/>
          <Column id="occurVatAmt" type="BIGDECIMAL" size="256"/>
          <Column id="applySupplyAmt" type="BIGDECIMAL" size="256"/>
          <Column id="applyVatAmt" type="BIGDECIMAL" size="256"/>
          <Column id="vatCd" type="STRING" size="256"/>
          <Column id="newhghtUpjang" type="STRING" size="256"/>
          <Column id="reservNum" type="STRING" size="256"/>
          <Column id="reservDate" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="guestTelNum" type="STRING" size="256"/>
          <Column id="journalzYn" type="STRING" size="256"/>
          <Column id="journalzNum" type="STRING" size="256"/>
          <Column id="upjangCd" type="STRING" size="256"/>
          <Column id="receiptNum" type="STRING" size="256"/>
          <Column id="mngmvAdvanceNum" type="STRING" size="256"/>
          <Column id="couponProcNum" type="STRING" size="256"/>
          <Column id="recdStatus" type="STRING" size="256"/>
          <Column id="altNum" type="STRING" size="256"/>
          <Column id="altDate" type="STRING" size="256"/>
          <Column id="advanceAltOccurClass" type="STRING" size="256"/>
          <Column id="altTypeCd" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="256"/>
          <Column id="altAmt" type="BIGDECIMAL" size="256"/>
          <Column id="adjustAmt" type="BIGDECIMAL" size="256"/>
          <Column id="excAmt" type="BIGDECIMAL" size="256"/>
          <Column id="payGrp" type="STRING" size="256"/>
          <Column id="payType" type="STRING" size="256"/>
          <Column id="paySchdDate" type="STRING" size="256"/>
          <Column id="posNum" type="STRING" size="256"/>
          <Column id="inqueryStartDate" type="STRING" size="256"/>
          <Column id="inqueryEndDate" type="STRING" size="256"/>
          <Column id="inqueryMuCd" type="STRING" size="256"/>
          <Column id="inqueryTmCd" type="STRING" size="256"/>
          <Column id="inqueryCcCd" type="STRING" size="256"/>
          <Column id="inqueryCustCd" type="INT" size="256"/>
          <Column id="inqueryAdvanceTypeCd" type="STRING" size="256"/>
          <Column id="inqueryAdvanceNum" type="STRING" size="256"/>
          <Column id="advanceAltNum" type="STRING" size="256"/>
          <Column id="receiveNum" type="STRING" size="256"/>
          <Column id="occurAmt" type="BIGDECIMAL" size="256"/>
          <Column id="applyAmt" type="BIGDECIMAL" size="256"/>
          <Column id="balAmt" type="BIGDECIMAL" size="256"/>
          <Column id="rowStatus" type="STRING" size="256"/>
          <Column id="applyAmtSum" type="BIGDECIMAL" size="256"/>
          <Column id="altSupplyAmt" type="BIGDECIMAL" size="256"/>
          <Column id="altVatAmt" type="BIGDECIMAL" size="256"/>
          <Column id="advanceOccurClassNm" type="STRING" size="256"/>
          <Column id="advanceTypeCdNm" type="STRING" size="256"/>
          <Column id="sysClassNm" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="acctNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_advanceData" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="altNum" type="STRING" size="256"/>
          <Column id="altDate" type="STRING" size="256"/>
          <Column id="advanceAltOccurClass" type="STRING" size="256"/>
          <Column id="altTypeCd" type="STRING" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="accCd" type="STRING" size="256"/>
          <Column id="altAmt" type="BIGDECIMAL" size="256"/>
          <Column id="adjustAmt" type="BIGDECIMAL" size="256"/>
          <Column id="excAmt" type="BIGDECIMAL" size="256"/>
          <Column id="payGrp" type="STRING" size="256"/>
          <Column id="payType" type="STRING" size="256"/>
          <Column id="paySchdDate" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="256"/>
          <Column id="batchId" type="STRING" size="256"/>
          <Column id="upjangCd" type="STRING" size="256"/>
          <Column id="posNum" type="STRING" size="256"/>
          <Column id="receiptNum" type="STRING" size="256"/>
          <Column id="couponNum" type="STRING" size="256"/>
          <Column id="custCd" type="INT" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="reservNum" type="STRING" size="256"/>
          <Column id="journalzYn" type="STRING" size="256"/>
          <Column id="journalzNum" type="STRING" size="256"/>
          <Column id="reservDate" type="STRING" size="256"/>
          <Column id="inqueryStartDate" type="STRING" size="256"/>
          <Column id="inqueryEndDate" type="STRING" size="256"/>
          <Column id="inqueryMuCd" type="STRING" size="256"/>
          <Column id="inqueryTmCd" type="STRING" size="256"/>
          <Column id="inqueryCcCd" type="STRING" size="256"/>
          <Column id="inqueryUpjangCd" type="STRING" size="256"/>
          <Column id="inqueryCustCd" type="INT" size="256"/>
          <Column id="inqueryAdvanceTypeCd" type="STRING" size="256"/>
          <Column id="inqueryAdvanceNum" type="STRING" size="256"/>
          <Column id="transCustCd" type="INT" size="256"/>
          <Column id="transCcCd" type="STRING" size="256"/>
          <Column id="recdStatus" type="STRING" size="256"/>
          <Column id="fiscalDate" type="STRING" size="256"/>
          <Column id="transTypeCd" type="STRING" size="256"/>
          <Column id="occurDateFrom" type="STRING" size="256"/>
          <Column id="occurDateTo" type="STRING" size="256"/>
          <Column id="fiscalDateFrom" type="STRING" size="256"/>
          <Column id="fiscalDateTo" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="upjangNm" type="STRING" size="256"/>
          <Column id="inqueryMuNm" type="STRING" size="256"/>
          <Column id="inqueryTmNm" type="STRING" size="256"/>
          <Column id="inqueryCcNm" type="STRING" size="256"/>
          <Column id="inqueryUpjangNm" type="STRING" size="256"/>
          <Column id="inqueryCustNm" type="STRING" size="256"/>
          <Column id="transCustNm" type="STRING" size="256"/>
          <Column id="transCcNm" type="STRING" size="256"/>
          <Column id="advanceNum" type="STRING" size="256"/>
          <Column id="advanceTypeCd" type="STRING" size="256"/>
          <Column id="rowStatus" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codename" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : Template
  파 일 명 : Template.xfdl
  기    능 : Design 및 Script Template 

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2014.11.01   김윤기   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "U_lib::lib_conversionCom.xjs";
include "lib::lib_com.xjs";



/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();


/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	if(p_couponProcNum != ""){
		ds_search.addRow();
		ds_search.setColumn(0, "couponProcNum", p_couponProcNum);
		btn_cancleProc.visible = true;
		btn_saveProc.visible = false;
		fn_search();
	}else{	
		// 초기값 셋팅
		ds_view.addRow();
		ds_view.setColumn(0, "couponProcNum", "0");
		
		//선수금마스터 발생을 위해 셋팅
		ds_view.setColumn(0, "upjangCd"     , g_Upjang);
		fn_init();
	}
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	v_ds_check = "ds_list";

	SCDataset.bind(this, "ComCode", "ds_dataSet", {groupCode:"DATA_SET", code:"DEF_MU_CODE", useYn:"Y"}, "fn_triggerDatasetEvent");	//사업부조회 
	SCPopup.bind(this, "CcCode", 	"edt_ccNm", 	"btn_ccCdDtl", 		null, {}, {after:"fn_popCcCdAfter"}); 	//CC코드팝업(입력)	
	//달력 초기화
	cal_procDate.fn_initMonthCal(this, null, null, ds_view, "procDate","Y");
	
	//레디오 초기화
	rdo_payType_onitemchanged();
	//매입사 가져오기
	ds_search.addRow();
	fn_selectBuycpnyCd();
	
	//쿠폰판매관리의 사업부 넘겨주기 20190318 김호석
	if (gfn_isNull(ds_view.getColumn(0, "muCd"))) {
		ds_view.setColumn(0, "muCd",p_muCd);
	}
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 사업부Combo 조회 후 처리
 *---------------------------------------------------------------------------------------------*/

function fn_triggerDatasetEvent(p, ds)
{
	var g_Mu_Cd = ds_view.getColumn(0, "muCd");

	if (p.oid == "ds_dataSet")
	{	
		
		SCCombo.bind(this, "MU", "cbo_muCd", null, {defVal:g_Mu_Cd}); //사업부 구분 Combo처리
	
	}
}

function fn_popCcCdAfter(p, data){
	//if(data.code != null && data.code != undefined){
	if(gfn_transNullToEmpty(data.code)){
		edt_ccCd.value = data.code;
		edt_ccNm.value = data.codeName;
		ds_view.setColumn(0, "muCd", data.muCd);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{	
//	// v_ds_check 미사용시 변경사항 체크(입력 프로그램일때 변경되는 Dataset 전체 기술)
// 	if (gfn_dsIsUpdated(ds_list) == true) 
// 	{
// 		// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
//         if (!gfn_confirm("confirm.before.movepage")) return false;
//     }
//     
//	// 조회프로그램에도 Return true; 기술해 주세요!
// 	return true;

	// v_ds_check 사용시 변경사항 체크
	if(gfn_length(v_ds_check) != 0)
	{	
		// v_ds_check 설정기준 변경사항 체크
		if (gfn_isDataChange() == true) 
		{		
			// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
			if (!gfn_confirm("confirm.before.movepage")) return false;
		}
	}
    
	// 조회프로그램에도 Return true; 기술해 주세요!
	return true;
}


/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{

    var strSvcID    = "search";
    var strURL      = "rc/rcg/couponSale/selectInfo.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_view=ds_view ds_couponSelect=ds_couponSelect";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{	
	var nRow = ds_list.addRow();	
	
	ds_list.setColumn(nRow, "GUBUN", 'AD');
	ds_list.setColumn(nRow, "INPUT_USER", gfn_getUserId());
	
	// Grid 입력 cell 지정
	grd_list.setFocus();
	grd_list.setCellPos(1);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{
	var nRow = ds_list.rowposition;
	
	if(ds_list.rowposition == -1) 
	{
		gfn_alert("msg.err.grid.noselect", "삭제할 row");	// 선택된 항목이 없습니다.
		return;
	}

	var rtVal = gfn_confirm("confirm.before.delete");	// 선택된 자료를 삭제 하시겠습니까?
	if (rtVal == true) 
	{	
		ds_list.deleteRow(nRow);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
	//수정시 회수된 데이터가 있는지 확인
	if(!gfn_isNull(p_couponProcNum)){
		var uCnt = 0;
		for(i=0; ds_couponSelect.getRowCount() > i; i++){
			if(gfn_isNull(ds_couponSelect.getColumn(i, "useDate"))){
			} else {
				uCnt = uCnt + 1;			
			}				
		}
	}
	if(uCnt > 0){
		alert("회수된 쿠폰 정보가 있습니다.");
		return;
	}
	
	//선택된 쿠폰의 원가부서와 판매처리의 원가부서가 다른지 체크 추가 20190417 김호석	
	for(i=0; ds_couponSelect.getRowCount() > i; i++){			
		if (!(gfn_isNull(ds_couponSelect.getColumn(i, "ccCd")))) {
			if (ds_couponSelect.getColumn(i, "ccCd") != ds_view.getColumn(0, "ccCd")) {					
				alert("원가부서가 다른 쿠폰 번호가 있습니다. 쿠폰번호 : " + ds_couponSelect.getColumn(i, "couponNum"));
				return;
			}				
		}						
	}

	// 저장시 Validation Check	
	if (gfn_validCheck(ds_view, ds_viewValid) == false)	return;
	
	if (ds_couponSelect.rowcount == 0){
	    alert("선택된 쿠폰 리스트가 없습니다");
	    return;
	}
	

	var payType = ds_view.getColumn(0, "payType");
	
	//카드인 경우 매입사 필수 체크 추가 20190418 김호석	
	if (payType == "2"){
		if (gfn_isNull(ds_view.getColumn(0, "buycpnyCd"))) {
			alert("지불구분이 카드인 경우 매입사는 필수 입니다.");		
			return;
		}
	}
	
	//선수금인 경우 값셋팅
	if (payType == "P2"){
	    //선수금 정보
		ds_advanceData.addRow();
	    if (gfn_isNull(p_couponProcNum)){
			ds_advanceData.setColumn(0, "rowStatus",	"INSERT");
			ds_advanceData.setColumn(0, "altTypeCd",               "G03");     // 선수금 대체 유형 코드
		    ds_advanceData.setColumn(0, "advanceAltOccurClass",    "TO08");    // 선수금 대체 발생 구분
	    } else {
	        ds_advanceData.setColumn(0, "rowStatus",	"UPDATE");
	    }
	    ds_advanceData.setColumn(0, "altDate",  ds_view.getColumn(0, "procDate"));
		ds_advanceData.setColumn(0, "muCd"   ,	ds_view.getColumn(0, "muCd"));
		ds_advanceData.setColumn(0, "ccCd"   ,	ds_view.getColumn(0, "ccCd"));
		ds_advanceData.setColumn(0, "remark" ,	ds_view.getColumn(0, "remark"));
		ds_advanceData.setColumn(0, "custCd" ,	ds_view.getColumn(0, "custCd"));
		ds_advanceData.setColumn(0, "altAmt" ,  ds_view.getColumn(0, "couponAmt"));     //선수금대체금액
		
		if (ds_listAdvance.rowcount == 0){
			alert("선수금 내역이 없습니다");
			return
		}
		//입금액과 선수금잔액 비교 ** 쿠폰판매금액 변경이 안되는데 비교가 가능할까?
		if (ds_view.getColumn(0, "couponAmt") > ds_listAdvance.getColumn(0,"occurAmt")){
			alert("판매액이 선수금잔액보다 큽니다");
			return;
		}
		
		//선수금대체상세
		for(var i=0; i<ds_listAdvance.rowcount; i++){
			if(gfn_isNull(p_couponProcNum)){
				ds_listAdvance.setColumn(i, "rowStatus",	"INSERT");
			}else{
				ds_listAdvance.setColumn(i, "rowStatus",	"UPDATE");
			}
			//입력 데이터 세팅
			ds_listAdvance.setColumn(i, "applyAmt",     ds_view.getColumn(0, "couponAmt")); //적용금액
			ds_listAdvance.setColumn(i, "altDate",		ds_view.getColumn(0, "procDate"));  // 대체일자
			ds_listAdvance.setColumn(i, "remark",		ds_view.getColumn(0, "remark"));	// 적요
		}
	}
	
	ds_view.setColumn(0,"couponProcNum", p_couponProcNum);
	//부가세 코드 생성
	//alert(ds_couponSelect.getColumn(0, "vatCd"));
	ds_view.setColumn(0,"vatCd", ds_couponSelect.getColumn(0, "vatCd"));

    var strSvcID    = "save";
    var strURL      = "rc/rcg/couponSale/saveList.xdo";
    var strInDs     = "ds_view=ds_view ds_couponSelect=ds_couponSelect:I ds_listAdvance=ds_listAdvance ds_advanceData=ds_advanceData";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
	
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {
		// 코드분류 조회
        case "search" :
            //그리드에서 교환번호가 넘어왔을경우 초기값 셋팅을 나중에 한다.
			fn_init();
			
			//조회된 값이 선수금인경우
			if (ds_view.getColumn(0,"payType") == "P2"){
			    ds_search.setColumn(0,"inqueryStartDate", ds_view.getColumn(0, "procDate"));
			    ds_search.setColumn(0,"inqueryEndDate", ds_view.getColumn(0, "procDate"));
			    ds_search.setColumn(0,"inqueryMuCd", ds_view.getColumn(0, "muCd"));
			    ds_search.setColumn(0,"inqueryCcCd", ds_view.getColumn(0, "ccCd"));
			    ds_search.setColumn(0,"inqueryCustCd", ds_view.getColumn(0, "custCd"));
			    
			    fn_selectAdvanceAltMst()
			}
            
            break;
        //선수금 대체 마스터
        case "selectAdvanceAltMst" :
            ds_search.setColumn(0, "altNum", ds_view.getColumn(0, "advanceAltNum"));
			fn_searchAdvanceAltDetail();
            break;
            
        // 저장
        case "save" :
			gfn_alert("msg.save.success");	// 저장 되었습니다.
			opener.fn_search();
			close();
            break;
            
        // 취소
        case "cancle" :
			gfn_alert("msg.action.success");	// 취소 처리 되었습니다.
			opener.fn_search();
			close();
            break;
    }
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 매입사를 조회한다.
 *---------------------------------------------------------------------------------------------*/
function fn_selectBuycpnyCd(){
	
	var strSvcID    = "searchBuycpnyCd";
    var strURL      = "sm/ssi/buyCpnyMgnt/selectList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_buycpnyCd=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;		//비동기실행
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 선수금 대체시 조회조건 조회
 *---------------------------------------------------------------------------------------------*/
function fn_selectAdvanceAltMst(){
    var altNum = ds_view.getColumn(0,"advanceAltNum");
    gfn_transaction(this
					,"selectAdvanceAltMst"
					,"sm/cmn/advanceCommon/selectAdvanceAltMst.xdo"
					,""
					,"ds_advanceData=ds_search"
					,"altNum="+altNum
					,"fn_callBack"
					,true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 선수금 대체시 상세 조회조건 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchAdvanceAltDetail(){

	//서비스 쿼리결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장
	fv_objColInfo = gfn_getDatasetInfo (ds_listAdvance);
	
    gfn_transaction(this
					,"searchAdvanceAltDetail"
					,"sm/cmn/advanceCommon/selectAdvanceMst.xdo"
					,"ds_search=ds_search:A"
					,"ds_listAdvance=ds_list"
					,""
					,"fn_callBack"
					,true);
}

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : form에서 Key Down시 단축키들 지정(공통에서 자동생성, 화면에 스크립트 작성시 화면 스크립트만 실행됨)
 *---------------------------------------------------------------------------------------------*/
// function form_onkeydown(obj:Form, e:KeyEventInfo)
// {
// 	gfn_formKeyDown(obj, e);
// }

/*----------------------------------------------------------------------------------------------
 * 설명      : Grid Header Click시 정렬(공통에서 자동생성, 화면에 스크립트 작성시 화면 스크립트만 실행됨)
 *---------------------------------------------------------------------------------------------*/
// function grd_list_onheadclick(obj:Grid, e:GridClickEventInfo)
// {
// 	gfn_gridSort(obj, e);
// }

/*----------------------------------------------------------------------------------------------
 * 쿠폰선택 팝업
 *---------------------------------------------------------------------------------------------*/
function btn_addCouponNum_onclick(obj:Button,  e:ClickEventInfo)
{
	//alert("btn_receive_onclick");
	//쿠폰종류의 원가부서로 고정하기 위해 추가 20190318 김호석->여러종류의 쿠폰을 한번에 판매처리해서 다시 삭제
	//if (gfn_isNull(ds_view.getColumn(0,"couponKindCd"))) {
	//	alert("쿠폰종류 선택이 필수입니다.");
	//	return;
	//}
	
	
	var arrArg = new Array();
	arrArg[0] = "ccc";
	arrArg[1] = "ddd";
		
	var strId       = "CouponSalePopPop";
	var strURL      = "X_RCG::CouponSalePopPop.xfdl";
	var objArgument = {couponKindCd:ds_view.getColumn(0, "couponKindCd"), couponKindNm:ds_view.getColumn(0, "couponKindNm"), couponStatus:"2"};	
	var nWidth      = -1;
	var nHeight     = -1;
	var strStyle    = "";	
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	var bResizable  = true;

	// 리턴값을  Dataset으로 받을 경우
 	var dsObj = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
	if (!gfn_isNull(dsObj)) {
		for (i=0; i< dsObj.getRowCount(); i++)
		{
			var nRow = ds_couponSelect.addRow();
			ds_couponSelect.copyRow(nRow, dsObj, i);
		}
	}
	
 	msk_sumCouponAmt.value = ds_couponSelect.getSum("couponAmt");
 	msk_sumSupplyAmt.value = ds_couponSelect.getSum("supplyAmt");
 	msk_sumVatAmt.value = ds_couponSelect.getSum("vatAmt");
}

function btn_couponNum_onclick(obj:Button,  e:ClickEventInfo)
{
	//쿠폰종류의 원가부서로 고정하기 위해 추가 20190318 김호석->여러종류의 쿠폰을 한번에 판매처리해서 다시 삭제
	//if (gfn_isNull(ds_view.getColumn(0,"couponKindCd"))) {
	//	alert("쿠폰종류 선택이 필수입니다.");
	//	return;
	//}	
	
	var strId       = "CouponNumPopup";
	var strURL      = "X_RCG::CouponNumPopup.xfdl";
	var objArgument = {couponKindCd:ds_view.getColumn(0, "couponKindCd"), couponStatus:"2"};
	var nWidth      = -1;
	var nHeight     = -1;
	var strStyle    = "";	
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	var bResizable  = true;


	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign, bResizable);

	if ( arrRtn instanceof Object )
	{
		edt_couponNum.value = arrRtn["couponNum"];
		edt_couponKindNm.value = arrRtn["couponKindNm"];
		msk_couponAmt.value = arrRtn["couponAmt"];
		msk_supplyAmt.value = arrRtn["supplyAmt"];
		msk_vatAmt.value = arrRtn["vatAmt"];
		edt_couponKindCd.value = arrRtn["couponKindCd"];
		edt_vatCd.value = arrRtn["vatCd"];
		edt_acctCd.value = arrRtn["acctCd"];
		edt_ccCd2.value = arrRtn["ccCd"];
		edt_ccNm2.value = arrRtn["ccNm"];
		//ds_search.setColumn(0, "couponNum", arrRtn["couponNum"]);
	}
}

function btn_addRow_onclick(obj:Button,  e:ClickEventInfo)
{
	if(!gfn_transNullToEmpty(edt_couponNum.value))
	{
		alert("쿠폰번호를 선택해 주세요.");
		return;
	}
	if(ds_couponSelect.findRow("couponNum", edt_couponNum.value, 0, ds_couponSelect.rowcount)>-1)
	{
		gfn_alert("msg.err.overlap.date", edt_couponNum.value);	
		return;
	}
	if(ds_couponSelect.findRow("vatCd", edt_vatCd.value, 0, ds_couponSelect.rowcount)==-1 && ds_couponSelect.rowcount>0)
	{
		alert("쿠폰 판매는 같은 부가세 유형의 쿠폰만 판매가 가능합니다.");
		return;
	}
	
	ds_couponSelect.addRow();
	var  nRow = ds_couponSelect.rowposition;

	ds_couponSelect.setColumn(nRow, "couponNum", edt_couponNum.value);
	ds_couponSelect.setColumn(nRow, "couponKindNm", edt_couponKindNm.value);
	ds_couponSelect.setColumn(nRow, "couponAmt", msk_couponAmt.value);
	ds_couponSelect.setColumn(nRow, "supplyAmt", msk_supplyAmt.value);
	ds_couponSelect.setColumn(nRow, "vatAmt", msk_vatAmt.value);
	ds_couponSelect.setColumn(nRow, "couponKindCd", edt_couponKindCd.value);
	ds_couponSelect.setColumn(nRow, "vatCd", edt_vatCd.value);
	ds_couponSelect.setColumn(nRow, "acctCd", edt_acctCd.value);
	ds_couponSelect.setColumn(nRow, "ccCd", edt_ccCd2.value);
	ds_couponSelect.setColumn(nRow, "ccNm", edt_ccNm2.value);
	
 	msk_sumCouponAmt.value = ds_couponSelect.getSum("couponAmt");
 	msk_sumSupplyAmt.value = ds_couponSelect.getSum("supplyAmt");
 	msk_sumVatAmt.value = ds_couponSelect.getSum("vatAmt");	
}

function btn_delRow_onclick(obj:Button,  e:ClickEventInfo)
{
	var  nRow = ds_couponSelect.rowposition;	
	if(ds_couponSelect.rowposition == -1) 
	{
		gfn_alert("msg.err.grid.noselect", "삭제할 row");	// 선택된 항목이 없습니다.
	}
	ds_couponSelect.deleteRow(nRow);
	
 	msk_sumCouponAmt.value = ds_couponSelect.getSum("couponAmt");
 	msk_sumSupplyAmt.value = ds_couponSelect.getSum("supplyAmt");
 	msk_sumVatAmt.value = ds_couponSelect.getSum("vatAmt");	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 업장 컴포넌트 팝업 호출 Before 이벤트
 *---------------------------------------------------------------------------------------------*/
 function fn_upjangSearchComponentBefore(obj, roleSetClass){
	
//	roleSetClass.setMuCd(cbo_muCd.value);
	
	//지원업장 팝업이 아닐경우 ccCd 조건 추가
//	if(obj.name != "edt_supUpjang"){
//		roleSetClass.setCcCd(edt_ccCd.value);
//	}
	return true;
 }
 
 /*----------------------------------------------------------------------------------------------
 * 설명      : 업장 컴포넌트 팝업 호출 After 이벤트( 값 변경시 중복체크)
 *---------------------------------------------------------------------------------------------*/
function fn_upjangSearchComponentAfter(){
	ds_view.setColumn(0, "newhghtUpjang", null);
	//ds_view.setColumn(0, "upjangNm", null);
}

function btn_saveProc_onclick(obj:Button,  e:ClickEventInfo)
{
	ds_view.setColumn(0, "couponProcOccurClass", "1");
	ds_view.setColumn(0, "journalzYn", "0");
		
	var t_date = ds_view.getColumn(0, "procDate");
	if (gfn_isNull(t_date)) {		
        alert( "회계일자를 입력해주세요");
        return false; 	
	}
	t_date = t_date.substring(0,6);
	var t_cccd = ds_view.getColumn(0, "ccCd")
	
	if (gfn_isNull(ds_view.getColumn(0, "ccCd"))) {		
        alert( "원가부서를 입력해주세요");
        return false; 	
	}
	
    mfn_GetCcMonthClsYn("C",t_cccd, t_date, "01");
    if (ds_common.getColumn(0, 0) == "Y")
    {
        g_Message("EE", "해당월은 월마감이 완료되어 작업할 수 없습니다.");
        return false; 
    }
	
	fn_save();
}

function btn_cancleProc_onclick(obj:Button,  e:ClickEventInfo)
{
	//수정시 회수된 데이터가 있는지 확인
	var uCnt = 0;
	if(!gfn_isNull(p_couponProcNum)){
		for(i=0; ds_couponSelect.getRowCount() > i; i++){
			if(gfn_isNull(ds_couponSelect.getColumn(i, "useDate"))){	
					
			} else {
				uCnt = uCnt + 1;
			}
		}
	}
	if(uCnt > 0){
		alert("회수된 쿠폰 정보가 있습니다.");
		return;
	}
	if(ds_view.getColumn(0,"arReceiveCount") > 0){
		alert("발생된 채권에 대해서 입금 처리 되어 있습니다.");
		return;
	}

	if(!confirm("판매 취소 처리 하시겠습니까?")){
		return; 
	}

	// 저장시 Validation Check	
	if (gfn_validCheck(ds_view, ds_viewValid) == false)	return;
	//초기값 셋팅
	
    var strSvcID    = "cancle";
    var strURL      = "rc/rcg/couponSale/cancleList.xdo";
    var strInDs     = "ds_view=ds_view ds_couponSelect=ds_couponSelect:I ds_listAdvance=ds_listAdvance ds_advanceData=ds_advanceData";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

function rdo_payType_onitemchanged(obj:Radio, e:ItemChangeEventInfo)
{
	if(rdo_payType.value=="1")
	{
	//	edt_custCd.enable=false;
	//	edt_custNm.enable=false;
		btn_advanceSelect.enable=false;
		btn_creditCardSelect.enable=false;
		cbo_receiveBankcd.enable=false;
	}else if(rdo_payType.value=="2"){
	//	edt_custCd.enable=false;
	//	edt_custNm.enable=false;
		btn_advanceSelect.enable=false;
		btn_creditCardSelect.enable=true;
		cbo_receiveBankcd.enable=true;
	}else if(rdo_payType.value=="7"){
	//	edt_custCd.enable=true;
	//	edt_custNm.enable=true;
		btn_advanceSelect.enable=false;
		btn_creditCardSelect.enable=false;
		cbo_receiveBankcd.enable=false;
	}else if(rdo_payType.value=="P2"){
	//	edt_custCd.enable=true;
	//	edt_custNm.enable=true;
		btn_advanceSelect.enable=true;
		cbo_receiveBankcd.enable=false;
		btn_creditCardSelect.enable=false;
	}
	
	if (rdo_payType.value == "2"){
	    edt_creditCardNum.enable = true;
		edt_apprvNum.enable      = true;
		edt_validYymm.enable     = true;
		msk_receiveAmt.enable    = true;
		msk_할부기간.enable     = true;
		cbo_receiveBankcd.enable = true;
	} else {
	    edt_creditCardNum.enable = false;
		edt_apprvNum.enable      = false;
		edt_validYymm.enable     = false;
		msk_receiveAmt.enable    = false;
		msk_할부기간.enable     = false;
		cbo_receiveBankcd.enable = false;
	}
	
	if (gfn_isNull(p_couponProcNum)){
		//value 빈값셋팅
		edt_custCd.value        = "";
		ds_view.setColumn(0, "custNm", "");
		edt_advanceNum.value    = "";
		edt_creditCardNum.value = "";
		edt_apprvNum.value      = "";
		edt_validYymm.value     = "";
		msk_receiveAmt.value    = "";
		msk_할부기간.value     = "";
		cbo_receiveBankcd.value = "";
	} else if (!gfn_isNull(p_couponProcNum)){
	    rdo_payType.enable = false;
	//   edt_custCd.enable=false;
	//	edt_custNm.enable=false;
		edt_advanceNum.enable=false;
		btn_advanceSelect.enable=false;
		btn_creditCardSelect.enable=false;
		edt_apprvNum.enable      = false;
		edt_validYymm.enable     = false;
		msk_receiveAmt.enable    = false;
		msk_할부기간.enable     = false;
		cbo_receiveBankcd.enable=false;
	}
}

function btn_creditCardSelect_onclick(obj:Button,  e:ClickEventInfo)
{
	var strId       = "CardApprvPopup";
	var strURL      = "X_SAR::CardApprvPopup.xfdl";
	var objArgument = {pCardNum:edt_creditCardNum.value};
	var nWidth      = -1;
	var nHeight     = -1;
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	var bResizable  = true;


	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign, bResizable);

	if ( arrRtn instanceof Object )
	{
 		ds_view.setColumn(0, "creditCardNum", arrRtn["cardNum"]);      //카드번호
		ds_view.setColumn(0, "apprvNum", arrRtn["apprvNum"]);          //승인번호
		ds_view.setColumn(0, "validYymm", arrRtn["validYymm"]);        //유효기간
		ds_view.setColumn(0, "receiveAmt", arrRtn["useAmt"]);          //승인금액
		/*ds_view.setColumn(0, "receiveAmt", arrRtn["alltTerm"]);        //할부기간*/
		ds_view.setColumn(0, "receiveBankcd", arrRtn["buycpnyCd"]);    //매입사
		msk_할부기간.value     = arrRtn["alltTerm"];
	}
}

function btn_advanceSelect_onclick(obj:Button,  e:ClickEventInfo)
{
	var arrArg = new Array();
	//조회 조건값을 다시 팝업으로 전달.	
	arrArg[0] = ds_view.getColumn(0, "procDate");
	arrArg[1] = ds_view.getColumn(0, "procDate");
	arrArg[2] = ds_view.getColumn(0, "muCd");
	arrArg[3] = "";
	arrArg[4] = ds_view.getColumn(0, "ccCd");
	arrArg[5] = edt_ccNm.value;
	arrArg[6] = ds_view.getColumn(0, "custCd");
	arrArg[7] = ds_view.getColumn(0, "custNm");

	var strId       = "AdvanceNumPopup";
	var strURL      = "X_SAR::AdvanceNumPopup.xfdl";
	var objArgument = {arrSchVal:arrArg};
	var nWidth      = -1;
	var nHeight     = -1;
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	var bResizable  = true;

	// 리턴값을  Dataset으로 받을 경우
 	var dsObj = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
 
 	for (i=0; i< dsObj.getRowCount(); i++)
	{
		if(ds_listAdvance.findRow("advanceNum", dsObj.getColumn(i, "advanceNum"))==-1){
			var nRow = ds_listAdvance.addRow();
			ds_listAdvance.copyRow(nRow, dsObj, i);
		}
	}
	ds_view.setColumn(0,"advanceNum", ds_listAdvance.getColumn(0, "advanceNum"));
}

function btn_couponKindSch_onclick(obj:Button,  e:ClickEventInfo)
{
	var strId       = "CouponSpeciesPopup";
	var strURL      = "X_RCG::CouponSpeciesPopup.xfdl";
	var objArgument = {searchWord:edt_couponKindNm.value};
	var nWidth      = -1;
	var nHeight     = -1;
	var strStyle    = "";	
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	var bResizable  = true;


	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign, bResizable);
			
	if ( arrRtn instanceof Object )
	{
		ds_view.setColumn(0, "couponKindCd", arrRtn["couponKindCd"]);
		ds_view.setColumn(0, "couponKindNm", arrRtn["couponKindNm"]);
		ds_view.setColumn(0, "ccCd", arrRtn["ccCd"]);
		ds_view.setColumn(0, "ccNm", arrRtn["ccNm"]);
	}	
}
]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="SalePirceIndexPackModify" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="판매단가표 일괄수정" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="7" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30" tabstop="false"/>
        <Static id="Static29" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 97" anchor="left top right"/>
        <Static id="Static45" text="W15" visible="false" position="absolute 0 30 15 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static43" text="W10" visible="false" position="absolute 15 30 278 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static44" text="W10" visible="false" position="absolute 15 87 278 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static28" text="물류센터" class="sta_WFSA_label" position="absolute 16 40 78 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 79 40 89 61" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 249 40 279 61" anchor="left top"/>
        <Static id="Static03" text="적용자재" class="sta_WFSA_label" position="absolute 15 68 99 89" anchor="left top"/>
        <Static id="Static00" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 78 66 88 87" anchor="left top"/>
        <Static id="Static51" text="W05." visible="false" position="absolute 1 61 539 66" style="background:#ff000055;align:center middle;"/>
        <Static id="Static02" text="W05." visible="false" position="absolute 545 61 1083 66" style="background:#ff000055;align:center middle;"/>
        <Static id="Static04" text="구매단가적용일" class="sta_WFSA_label" position="absolute 279 40 386 61" anchor="left top"/>
        <Edit id="edt_itemName" taborder="3" position="absolute 88 66 468 87" style=":disabled {cursor:arrowwait;}" userdata="" readonly="false" class="edt_WF_Essential" onkeydown="edt_itemName_onkeydown"/>
        <Button id="btn_item" taborder="4" tabstop="false" class="btn_WF_popSearchEssential" position="absolute 467 66 488 87" onclick="btn_item_onclick"/>
        <Static id="Static07" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 375 40 385 61" anchor="left top"/>
        <Static id="Static13" text="판매단가시작일" class="sta_WFSA_label" position="absolute 520 40 619 61" anchor="left top"/>
        <Static id="Static14" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 618 40 628 61" anchor="left top"/>
        <Static id="Static19" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 489 40 519 61" anchor="left top"/>
        <Static id="Static60" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 97 450 110" anchor="left top"/>
        <Tab id="tpg" anchor="all" taborder="6" tabindex="0" scrollbars="autoboth" position="absolute 0 110 1237 710" style="showextrabutton:false;" onchanged="tpg_onchanged">
          <Tabpages>
            <Tabpage id="tabpage1" text="판매단가 일괄변경" style="anchor:default;">
              <Layouts>
                <Layout>
                  <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1235 15" anchor="left top"/>
                  <Static id="Static07" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 15 10 571"/>
                  <Static id="Static01" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1224 15 1235 571"/>
                  <Static id="Static35" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 561 1235 571" anchor="left top"/>
                  <Grid id="grd_list" taborder="1" binddataset="ds_list" scrollbars="autoboth" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 23 1225 560" anchor="all" autofittype="col" onheadclick="tpg_tabpage1_grd_list_onheadclick">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="22"/>
                          <Column size="91"/>
                          <Column size="223"/>
                          <Column size="118"/>
                          <Column size="118"/>
                          <Column size="118"/>
                          <Column size="118"/>
                          <Column size="98"/>
                          <Column size="98"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" rowspan="2" text="고객사" taborder="undefined"/>
                          <Cell col="2" rowspan="2" text="고객사명" taborder="undefined"/>
                          <Cell col="3" rowspan="2" text="현)구매단가" taborder="undefined"/>
                          <Cell col="4" rowspan="2" text="단가표)구매단가" taborder="undefined"/>
                          <Cell col="5" rowspan="2" text="단가표)마진율" taborder="undefined"/>
                          <Cell col="6" rowspan="2" text="단가표)판매단가" taborder="undefined"/>
                          <Cell col="7" text="변경적용"/>
                          <Cell col="8" text="판매가고정"/>
                          <Cell row="1"/>
                          <Cell row="1" col="7" displaytype="checkbox" edittype="checkbox"/>
                          <Cell row="1" col="8" displaytype="checkbox" edittype="checkbox"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:NO" expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:center middle;color:EXPR(poPrice==contractPrice?'blue':'black');color2:EXPR(poPrice==contractPrice?'blue':'black');" text="bind:upjang"/>
                          <Cell col="2" displaytype="text" style="align:left middle;color:EXPR(poPrice==contractPrice?'blue':'black');color2:EXPR(poPrice==contractPrice?'blue':'black');" text="bind:upjangNm"/>
                          <Cell col="3" displaytype="number" edittype="none" style="align:right middle;" text="bind:poPrice"/>
                          <Cell col="4" displaytype="number" style="align:right middle;" text="bind:contractPrice"/>
                          <Cell col="5" displaytype="number" style="align:right middle;" text="bind:marginRate" mask="##0.#"/>
                          <Cell col="6" displaytype="number" style="align:right middle;" text="bind:salePrice"/>
                          <Cell col="7" displaytype="checkbox" edittype="checkbox" text="bind:chk1"/>
                          <Cell col="8" displaytype="checkbox" edittype="checkbox" text="bind:chk2"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static33" text="자재는 업장/업체 설정이 되어있어야 합니다." class="sta_WF_DiscInfo" position="absolute 920 5 1220 24" anchor="top right"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage2" text="자재 일괄추가" taborder="0">
              <Layouts>
                <Layout>
                  <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1235 15" anchor="left top"/>
                  <Static id="Static07" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 15 10 571"/>
                  <Static id="Static01" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1224 15 1235 571"/>
                  <Static id="Static35" text="h10" class="Guide01_AreaRed" visible="false" position="absolute -11 561 1224 571" anchor="left top"/>
                  <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
                  <Static id="Static21" class="sta_WFSA_Labelbg01" position="absolute 10 14 612 55" anchor="left top"/>
                  <Static id="Static30" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 612 14 622 698"/>
                  <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 10 55 460 68" anchor="left top"/>
                  <Static id="Static22" text="자재목록(추가 대상)" class="sta_WF_Title01" position="absolute 10 68 209 86" anchor="left top"/>
                  <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 81 460 86" anchor="left top"/>
                  <Grid id="grd_item" taborder="1" binddataset="ds_item" scrollbars="autoboth" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 86 612 562" anchor="left top bottom" autosizingtype="none" autofittype="col" selecttype="multirow">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="22"/>
                          <Column size="80"/>
                          <Column size="122"/>
                          <Column size="203"/>
                          <Column size="63"/>
                          <Column size="109"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" text="자재코드"/>
                          <Cell col="2" text="자재명"/>
                          <Cell col="3" text="규격"/>
                          <Cell col="4" text="원산지"/>
                          <Cell col="5" text="구매단가"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:NO" expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                          <Cell col="2" displaytype="text" style="align:left middle;" text="bind:itemName"/>
                          <Cell col="3" displaytype="text" style="align:left middle;" text="bind:itemSize"/>
                          <Cell col="4" displaytype="text" style="align:left middle;" text="bind:originNat"/>
                          <Cell col="5" displaytype="number" style="align:right middle;" text="bind:contractPriceS"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Grid id="grd_upjang" taborder="2" binddataset="ds_upjang" scrollbars="autoboth" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 622 23 1224 561" anchor="all" autofittype="col" onheadclick="tpg_tabpage2_grd_upjang_onheadclick">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="36"/>
                          <Column size="78"/>
                          <Column size="307"/>
                          <Column size="123"/>
                          <Column size="58"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" text="고객사"/>
                          <Cell col="2" text="고객사명"/>
                          <Cell col="3" text="최종단가생성일"/>
                          <Cell col="4" displaytype="checkbox" edittype="checkbox"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:NO" expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:center middle;" text="bind:priceUpjang"/>
                          <Cell col="2" displaytype="text" style="align:left middle;" text="bind:priceUpjangNm"/>
                          <Cell col="3" displaytype="text" style="align:center middle;" text="bind:contractDate" mask="@@@@-@@-@@"/>
                          <Cell col="4" displaytype="expr:fn_checkSet(currow)" edittype="expr:fn_checkSet(currow)" style="align:center middle;" text="bind:chk"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static45" text="W15" visible="false" position="absolute 10 16 25 57" style="background:#ff000055;align:center middle;"/>
                  <Static id="Static43" text="W10" visible="false" position="absolute 11 14 274 24" style="background:#ff000055;align:center middle;"/>
                  <Static id="Static10" text="W10" visible="false" position="absolute 25 45 288 55" style="background:#ff000055;align:center middle;"/>
                  <Static id="Static28" text="자재검색" class="sta_WFSA_label" position="absolute 26 25 88 46" anchor="left top"/>
                  <Static id="Static13" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 84 24 94 45" anchor="left top"/>
                  <Edit id="edt_itemName2" taborder="3" onkeydown="edt_gubun_onkeydown" position="absolute 94 24 418 45" style=":disabled {cursor:arrowwait;}" userdata="" anchor="left top" readonly="true"/>
                  <Button id="btn_item2" taborder="4" tabstop="false" class="btn_WF_popSearch" position="absolute 417 24 438 45" onclick="tpg_tabpage2_btn_item2_onclick"/>
                  <Static id="Static12" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 437 24 467 45" anchor="left top"/>
                  <Button id="btn_itemAdd" taborder="5" text="자재추가" class="btn_WF_Function" position="absolute 465 23 536 43" anchor="left top" onclick="tpg_tabpage2_btn_itemAdd_onclick"/>
                  <Static id="Static29" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 536 23 538 43" anchor="top right"/>
                  <Button id="btn_itemDel" taborder="6" text="자재삭제" class="btn_WF_Function" position="absolute 538 23 609 43" anchor="left top" onclick="tpg_tabpage2_btn_itemDel_onclick"/>
                  <Static id="Static02" text="W10" visible="false" position="absolute 348 14 611 24" style="background:#ff000055;align:center middle;"/>
                  <Static id="Static33" text="이익율이 설정된 단가업장 및 구매계약정보가 존재해야 생성이 가능합니다." class="sta_WF_DiscInfo" position="absolute 749 5 1220 24" anchor="top right"/>
                  <Static id="Static41" text="구매단가 기준" class="sta_WFSA_label" position="absolute 340 62 434 83" anchor="left top"/>
                  <Combo id="cbo_mode" taborder="7" text="고객사 지정" codecolumn="codecolumn" datacolumn="datacolumn" index="1" position="absolute 460 62 611 83" anchor="left top" value="2">
                    <Dataset id="innerdataset">
                      <ColumnInfo>
                        <Column id="codecolumn" size="256"/>
                        <Column id="datacolumn" size="256"/>
                      </ColumnInfo>
                      <Rows>
                        <Row>
                          <Col id="codecolumn">1</Col>
                          <Col id="datacolumn">고객사 미지정</Col>
                        </Row>
                        <Row>
                          <Col id="codecolumn">2</Col>
                          <Col id="datacolumn">고객사 지정</Col>
                        </Row>
                      </Rows>
                    </Dataset>
                  </Combo>
                  <Static id="Static00" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 430 62 460 83" anchor="left top"/>
                  <Button id="btn_hist" taborder="8" text="생성이력조회" class="btn_WF_Function" position="absolute 621 2 710 22" anchor="left top" onclick="tpg_tabpage2_btn_hist_onclick"/>
                  <Grid id="Grid00" taborder="9" useinputpanel="false" position="absolute 97 270 555 441" binddataset="ds_upjang" visible="false">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                          <Col size="80"/>
                        </Columns>
                        <Rows>
                          <Row band="head" size="24"/>
                          <Row band="body" size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell col="0" disptype="normal" text="upjang"/>
                          <Cell col="1" disptype="normal" text="priceUpjang"/>
                          <Cell col="2" disptype="normal" text="priceUpjangNm"/>
                          <Cell col="3" disptype="normal" text="chk"/>
                          <Cell col="4" disptype="normal" text="marginYn1"/>
                          <Cell col="5" disptype="normal" text="attr09"/>
                          <Cell col="6" disptype="normal" text="attr10"/>
                          <Cell col="7" disptype="normal" text="contractDate"/>
                        </Band>
                        <Band id="body">
                          <Cell col="0" disptype="normal" text="bind:upjang"/>
                          <Cell col="1" disptype="normal" text="bind:priceUpjang"/>
                          <Cell col="2" disptype="normal" text="bind:priceUpjangNm"/>
                          <Cell col="3" disptype="normal" text="bind:chk"/>
                          <Cell col="4" disptype="normal" text="bind:marginYn1"/>
                          <Cell col="5" disptype="normal" text="bind:attr09"/>
                          <Cell col="6" disptype="normal" text="bind:attr10"/>
                          <Cell col="7" disptype="normal" text="bind:contractDate"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage3" text="자재 일괄삭제" taborder="0">
              <Layouts>
                <Layout>
                  <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1235 15" anchor="left top"/>
                  <Static id="Static07" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 15 10 571"/>
                  <Static id="Static01" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1224 15 1235 571"/>
                  <Static id="Static35" text="h10" class="Guide01_AreaRed" visible="false" position="absolute -11 561 1224 571" anchor="left top"/>
                  <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
                  <Static id="Static21" class="sta_WFSA_Labelbg01" position="absolute 10 14 612 55" anchor="left top"/>
                  <Static id="Static30" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 612 14 622 698"/>
                  <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 10 55 612 68" anchor="left top"/>
                  <Static id="Static22" text="자재목록(삭제 대상)" class="sta_WF_Title01" position="absolute 10 68 209 86" anchor="left top"/>
                  <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 81 460 86" anchor="left top"/>
                  <Grid id="grd_item" taborder="1" binddataset="ds_item2" scrollbars="autoboth" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 86 612 562" anchor="left top bottom" autosizingtype="none" autofittype="col" selecttype="multirow">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="22"/>
                          <Column size="80"/>
                          <Column size="122"/>
                          <Column size="203"/>
                          <Column size="63"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" text="자재코드"/>
                          <Cell col="2" text="자재명"/>
                          <Cell col="3" text="규격"/>
                          <Cell col="4" text="원산지"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:NO" expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                          <Cell col="2" displaytype="text" style="align:left middle;" text="bind:itemName"/>
                          <Cell col="3" displaytype="text" style="align:left middle;" text="bind:itemSize"/>
                          <Cell col="4" displaytype="text" style="align:left middle;" text="bind:originNat"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Grid id="grd_upjang" taborder="2" binddataset="ds_upjang2" scrollbars="autoboth" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 622 23 1224 561" anchor="all" autofittype="col" onheadclick="tpg_tabpage3_grd_upjang_onheadclick">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="36"/>
                          <Column size="78"/>
                          <Column size="307"/>
                          <Column size="123"/>
                          <Column size="58"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" text="고객사"/>
                          <Cell col="2" text="고객사명"/>
                          <Cell col="3" text="최종단가생성일"/>
                          <Cell col="4" displaytype="checkbox" edittype="checkbox"/>
                        </Band>
                        <Band id="body">
                          <Cell text="bind:NO" expr="currow+1"/>
                          <Cell col="1" displaytype="text" style="align:center middle;" text="bind:priceUpjang"/>
                          <Cell col="2" displaytype="text" style="align:left middle;" text="bind:priceUpjangNm"/>
                          <Cell col="3" displaytype="text" style="align:center middle;" text="bind:contractDate" mask="@@@@-@@-@@"/>
                          <Cell col="4" displaytype="expr:fn_checkSet2(currow)" edittype="expr:fn_checkSet2(currow)" style="align:center middle;" text="bind:chk"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static45" text="W15" visible="false" position="absolute 10 16 25 57" style="background:#ff000055;align:center middle;"/>
                  <Static id="Static43" text="W10" visible="false" position="absolute 11 14 274 24" style="background:#ff000055;align:center middle;"/>
                  <Static id="Static10" text="W10" visible="false" position="absolute 25 45 288 55" style="background:#ff000055;align:center middle;"/>
                  <Static id="Static28" text="자재검색" class="sta_WFSA_label" position="absolute 26 25 88 46" anchor="left top"/>
                  <Static id="Static13" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 84 24 94 45" anchor="left top"/>
                  <Edit id="edt_itemName2" taborder="3" position="absolute 94 24 418 45" style=":disabled {cursor:arrowwait;}" userdata="" anchor="left top" readonly="true"/>
                  <Button id="btn_item2" taborder="4" tabstop="false" class="btn_WF_popSearch" position="absolute 417 24 438 45" onclick="tpg_tabpage3_btn_item2_onclick"/>
                  <Static id="Static12" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 437 24 467 45" anchor="left top"/>
                  <Button id="btn_itemAdd" taborder="5" text="자재추가" class="btn_WF_Function" position="absolute 465 23 536 43" anchor="left top" onclick="tpg_tabpage3_btn_itemAdd_onclick"/>
                  <Static id="Static29" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 536 23 538 43" anchor="top right"/>
                  <Button id="btn_itemDel" taborder="6" text="자재삭제" class="btn_WF_Function" position="absolute 538 23 609 43" anchor="left top" onclick="tpg_tabpage3_btn_itemDel_onclick"/>
                  <Static id="Static02" text="W10" visible="false" position="absolute 348 14 611 24" style="background:#ff000055;align:center middle;"/>
                  <Static id="Static00" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 430 62 460 83" anchor="left top"/>
                  <Button id="btn_hist" taborder="8" text="생성이력조회" class="btn_WF_Function" position="absolute 621 2 710 22" anchor="left top" onclick="tpg_tabpage2_btn_hist_onclick"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Static id="Static01" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 489 87 519 138"/>
        <Combo id="cbo_centerCode" taborder="0" innerdataset="ds_center" codecolumn="centerCode" datacolumn="centerName" class="cmb_WF_Essential" position="absolute 88 40 248 61" anchor="left top"/>
        <ObjCalendar id="cal_poDate" titletext="캘린더" taborder="1" text="20150101" scrollbars="none" position="absolute 385 40 489 61"/>
        <ObjCalendar id="cal_saleDate" titletext="캘린더" taborder="2" text="20150101" scrollbars="none" position="absolute 628 40 732 61"/>
        <CheckBox id="chk_sabun" taborder="5" text="본인관리 업장만 조회" position="absolute 519 65 657 85" onclick="chk_sabun_onclick"/>
        <Static id="Static12" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 489 66 519 87" anchor="left top"/>
        <Static id="sta_msg" text="자재 일괄 추가(삭제) 시 업장별 기 생성된 판매단가 최종일자에 추가(삭제)됩니다." class="sta_WF_DiscPoint" position="absolute 710 114 1233 134" anchor="top right" visible="false"/>
        <CheckBox id="chk_noceil" taborder="8" text="판매단가 올림 미적용" onclick="chk_noceil_onclick" position="absolute 670 64 808 84" value="false" truevalue="1" falsevalue="0"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item0" compid="edt_itemName" propid="userdata" datasetid="ds_search" columnid="GUBUN"/>
      <BindItem id="item2" compid="edt_itemName" propid="UserData" datasetid="ds_search" columnid="GUBUN"/>
      <BindItem id="item1" compid="tpg.tabpage2.Tab00.tabpage2.edt_gubun00" propid="userdata" datasetid="ds_search" columnid="GUBUN"/>
      <BindItem id="item3" compid="tpg.tabpage2.Tab00.tabpage2.edt_gubun00" propid="UserData" datasetid="ds_search" columnid="GUBUN"/>
      <BindItem id="item4" compid="cbo_centerCode" propid="value" datasetid="ds_search" columnid="schCenter"/>
      <BindItem id="item5" compid="cal_poDate" propid="text" datasetid="ds_search" columnid="schPoDate"/>
      <BindItem id="item6" compid="cal_saleDate" propid="text" datasetid="ds_search" columnid="schSaleDate"/>
      <BindItem id="item7" compid="edt_itemName" propid="value" datasetid="ds_search" columnid="schItemName"/>
    </Bind>
    <Objects>
      <Dataset id="ds_center" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="centerName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_list_oncolumnchanged">
        <ColumnInfo>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="upjangNm" type="STRING" size="256"/>
          <Column id="poPrice" type="STRING" size="256"/>
          <Column id="contractPrice" type="STRING" size="256"/>
          <Column id="marginRate" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="chk1" type="STRING" size="256"/>
          <Column id="chk2" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="poDate" type="STRING" size="256"/>
          <Column id="saleDate" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_item" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_list_oncolumnchanged">
        <ColumnInfo>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="contractPriceS" type="BIGDECIMAL" size="256"/>
          <Column id="originNat" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_upjang" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="priceUpjang" type="STRING" size="256"/>
          <Column id="priceUpjangNm" type="STRING" size="256"/>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="marginYn1" type="STRING" size="256"/>
          <Column id="attr09" type="STRING" size="256"/>
          <Column id="attr10" type="STRING" size="256"/>
          <Column id="contractDate" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_search_oncolumnchanged">
        <ColumnInfo>
          <Column id="schCenter" type="STRING" size="256"/>
          <Column id="schPoDate" type="STRING" size="256"/>
          <Column id="schSaleDate" type="STRING" size="256"/>
          <Column id="schSaleDate2" type="STRING" size="256"/>
          <Column id="schItemCode" type="STRING" size="256"/>
          <Column id="schItemName" type="STRING" size="256"/>
          <Column id="schChkSabun" type="STRING" size="256"/>
          <Column id="schItemCode2" type="STRING" size="256"/>
          <Column id="schPriceUpjang" type="STRING" size="256"/>
          <Column id="schItemCode3" type="STRING" size="256"/>
          <Column id="schChkNoCeil" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_searchValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schCenter" type="STRING" size="256"/>
          <Column id="schPoDate" type="STRING" size="256"/>
          <Column id="schDate" type="STRING" size="256"/>
          <Column id="schItemCode" type="STRING" size="256"/>
          <Column id="schChkSabun" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="schCenter">title:센터,required:true,focus:cbo_centerCode</Col>
            <Col id="schPoDate">title:구매단가적용일,required:true,date;true,focus:cal_poDate</Col>
            <Col id="schDate">title:판매단가개시일,required:true,date;true,focus:cal_date</Col>
            <Col id="schItemCode">title:적용자재,required:true,focus:edt_itemName</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_searchValid2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schCenter" type="STRING" size="256"/>
          <Column id="schPoDate" type="STRING" size="256"/>
          <Column id="schDate" type="STRING" size="256"/>
          <Column id="schItemCode" type="STRING" size="256"/>
          <Column id="schChkSabun" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="schCenter">title:센터,required:true,focus:cbo_centerCode</Col>
            <Col id="schPoDate">title:구매단가적용일,required:true,date;true,focus:cal_poDate</Col>
            <Col id="schDate">title:판매단가개시일,required:true,date;true,focus:cal_date</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_itemRow" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_list_oncolumnchanged">
        <ColumnInfo>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="contractPriceS" type="STRING" size="256"/>
          <Column id="originNat" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listSave" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_list_oncolumnchanged">
        <ColumnInfo>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="upjangNm" type="STRING" size="256"/>
          <Column id="poPrice" type="STRING" size="256"/>
          <Column id="contractPrice" type="STRING" size="256"/>
          <Column id="marginRate" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="chk1" type="STRING" size="256"/>
          <Column id="chk2" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="poDate" type="STRING" size="256"/>
          <Column id="saleDate" type="STRING" size="256"/>
          <Column id="schChkNoCeil" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_upjangSave" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="priceUpjang" type="STRING" size="256"/>
          <Column id="priceUpjangNm" type="STRING" size="256"/>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="marginYn1" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="contractPriceS" type="BIGDECIMAL" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="poDate" type="STRING" size="256"/>
          <Column id="saleDate" type="STRING" size="256"/>
          <Column id="saleDate2" type="STRING" size="256"/>
          <Column id="stdPDate" type="STRING" size="256"/>
          <Column id="attr09" type="STRING" size="256"/>
          <Column id="attr10" type="STRING" size="256"/>
          <Column id="schChkNoCeil" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_item2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="originNat" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_itemRow2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="originNat" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_upjang2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="priceUpjang" type="STRING" size="256"/>
          <Column id="priceUpjangNm" type="STRING" size="256"/>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="marginYn1" type="STRING" size="256"/>
          <Column id="attr09" type="STRING" size="256"/>
          <Column id="attr10" type="STRING" size="256"/>
          <Column id="contractDate" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_upjangSave2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="priceUpjang" type="STRING" size="256"/>
          <Column id="priceUpjangNm" type="STRING" size="256"/>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="marginYn1" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="contractPriceS" type="BIGDECIMAL" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="poDate" type="STRING" size="256"/>
          <Column id="saleDate" type="STRING" size="256"/>
          <Column id="saleDate2" type="STRING" size="256"/>
          <Column id="stdPDate" type="STRING" size="256"/>
          <Column id="attr09" type="STRING" size="256"/>
          <Column id="attr10" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_searchValid3" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schCenter" type="STRING" size="256"/>
          <Column id="schPoDate" type="STRING" size="256"/>
          <Column id="schDate" type="STRING" size="256"/>
          <Column id="schItemCode" type="STRING" size="256"/>
          <Column id="schChkSabun" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="schCenter">title:센터,required:true,focus:cbo_centerCode</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : SalePriceIndexPackModify
  파 일 명 : SalePriceIndexPackModify.xfdl
  기    능 : 식재영업 / 기준관리 / 단가관리 / 판매단가표 일괄수정

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.04.21   최성연   최초 생성
      
  1) 공통 버튼 정의
  - 조회, 저장, 닫기, 도움말 버튼 활성화
  
  2) 특이사항
  - 자재일괄추가/변경 관련하여 추가하고자 하는 자재가 실제 대상 업장에 계약정보가 없는 경우에는
    반영되지 않는다.
    ?? 저장 전에 선택한 자재가 생성할 업장의 계약정보에 존재하는지 CHECK 가 필요한지....검토필요
  
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "U_lib::lib_conversionCom.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_objColInfo;				//데이터셋 컬럼정보
var fv_processCnt = 0;			//처리건수


/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	v_ds_check = "ds_list";
	
	// 센터정보 COMBO 초기화 : 조건
	fn_searchCenter();
	
	//조회조건을 초기화한다.
	var nRow= ds_search.addRow();
	ds_search.setColumn(nRow, "schCenter", "");								// 센터
	ds_search.setColumn(nRow, "schPoDate", gfn_today());					// 구매단가적용일
	ds_search.setColumn(nRow, "schSaleDate", gfn_today());					// 판매단가시작일
 
    chk_noceil.value = "0";  //판매단가 올림여부
    
	// 일자 Obj SET
	cal_poDate.fn_initMonthCal(this, "", "", ds_search, "schPoDate", "Y");		// 구매단가적용일 SET
	cal_saleDate.fn_initMonthCal(this, "", "", ds_search, "schSaleDate", "Y");	// 판매단가개시일 SET
	


	// 현재일자 기준으로 단가종료일 SET
	fn_searchDateSet();	
}


/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
	// 텝페이지별 조회 호출
	if (tpg.tabindex==0) fn_search_tab1();
	else if (tpg.tabindex==1) fn_search_tab2();
	else fn_search_tab3();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
	fsp_init(this);
	var workTime = (fn_CurrDateWeek("tm")).substr(0, 4);
// 	if ( workTime > 1300 && workTime < 1700 ) {
// 		gfn_alert("13시부터 17시까지 판매단가 변경(저장)이 불가능합니다.");
// 		return;
// 	}
// 	
	// 텝페이지별 저장 호출
	if (tpg.tabindex==0) fn_save_tab1();
	else if (tpg.tabindex==1) fn_save_tab2();
	else fn_save_tab3();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
	
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{	
	// v_ds_check 사용시 변경사항 체크
	if(gfn_length(v_ds_check) == 0) 
	{	
		// v_ds_check 설정기준 변경사항 체크
		if (gfn_isDataChange() == true) 
		{		
			// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
			if (!gfn_confirm("confirm.before.movepage")) return false;
		}
	}
    
	// 조회프로그램에도 Return true; 기술해 주세요!
	return true;
}


/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {
		// 센터 조회
        case "searchCenter" :
            //trace(ds_center.saveXML());
            fn_center_init();
            break;
        
		// 고객사 조회
        case "searchList" :
			var workTime = (gfn_todayTime()).substr(8, 4);
			if ( workTime > 1500 && workTime < 1700 ) {
				gfn_alert("15시부터 17시까지 판매단가 강제변경(저장)이 불가능합니다.");
			}
            //trace(ds_list.saveXML());
            if (ds_list.getRowCount() == 0) {
				gfn_alert("msg.search.nodata");	// 조건에 해당하는 자료가 없습니다.
				//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				gfn_loadDatasetInfo (ds_list, fv_objColInfo);
            }
            break;

		// 업장 조회
        case "searchUpjang" :
			var workTime = (gfn_todayTime()).substr(8, 4);
			if ( workTime > 1500 && workTime < 1700 ) {
				gfn_alert("15시부터 17시까지 판매단가 강제변경(저장)이 불가능합니다.");
			}
            //trace(ds_upjang.saveXML());
            if (ds_upjang.getRowCount() == 0) {
				gfn_alert("msg.search.nodata");	// 조건에 해당하는 자료가 없습니다.
				//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				gfn_loadDatasetInfo (ds_upjang, fv_objColInfo);
            }
            break;

		// 업장 조회 : 삭제용
        case "searchUpjang2" :
			var workTime = (gfn_todayTime()).substr(8, 4);
			if ( workTime > 1500 && workTime < 1700 ) {
				gfn_alert("15시부터 17시까지 판매단가 강제변경(저장)이 불가능합니다.");
			}
            //trace(ds_upjang2.saveXML());
            if (ds_upjang2.getRowCount() == 0) {
				gfn_alert("msg.search.nodata");	// 조건에 해당하는 자료가 없습니다.
				//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				gfn_loadDatasetInfo (ds_upjang2, fv_objColInfo);
            }
            break;
        
        
		// 자재추가 조회
        case "searchItemCode" :
            //trace(ds_itemRow.saveXML());
            fn_itemCodeAdd();
            break;

		// 자재추가 조회 : 일괄삭제용
        case "searchItemCode2" :
            //trace(ds_itemRow2.saveXML());
            fn_itemCodeAdd2();
            break;
        
        
        
        // 저장 : 1번째 탭
        case "saveList" :
			trace("처리건수 : " + fv_processCnt);
			if (fv_processCnt > 0) {
				gfn_alert("msg.action.success");	// 처리 되었습니다.
				// 판매단가 업장 목록 재조회
				fn_search_tab1();
			}
			else {
				var sMsg = "처리되지 않았습니다!\n\n";
				gfn_alert(sMsg, "", "A");
			}
            break;    

    
        // 저장 : 2번째 탭
        case "saveList2" :
			//trace("처리건수 : " + fv_processCnt);
			//gfn_alert("msg.save.success");	// 저장 되었습니다.
			if (fv_processCnt > 0) {
				var sMsg = "일괄추가 작업이 완료되었습니다!\n\n";
				sMsg = sMsg + "단가조회에서 일괄추가된 내용을 확인하세요.\n\n";
				sMsg = sMsg + " - 처리건수 : " + fv_processCnt;
				gfn_alert(sMsg, "", "A");
				// 업장 목록 재조회
				fn_search_tab2();
			} else {
				var sMsg = "처리되지 않았습니다!\n\n";
				gfn_alert(sMsg, "", "A");
			}
            break;    
    
        // 저장 : 3번째 탭
        case "saveList3" :
			//trace("처리건수 : " + fv_processCnt);
			//gfn_alert("msg.save.success");	// 저장 되었습니다.
			if (fv_processCnt > 0) {
				var sMsg = "일괄삭제 작업이 완료되었습니다!\n\n";
				sMsg = sMsg + "단가조회에서 일괄삭제된 내용을 확인하세요.\n\n";
				sMsg = sMsg + " - 처리건수 : " + fv_processCnt;
				gfn_alert(sMsg, "", "A");
				// 업장 목록 재조회
				fn_search_tab3();
			} else {
				var sMsg = "처리되지 않았습니다!\n\n";
				gfn_alert(sMsg, "", "A");
			}
            break;    

    
    
    }
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 단가 종료일자 SET
 * 
 *---------------------------------------------------------------------------------------------*/
function fn_searchDateSet()
{
	// 조건 SET 
	var nRow = ds_search.rowposition;

	var sDate = ds_search.getColumn(nRow, "schSaleDate");				// 판매단가개시일

	// 조건 : 기준일자 종료일 SET
	ds_search.setColumn(nRow, "schSaleDate2", fn_dateGet(sDate));		// 판매단가종료일 SET
}


/*----------------------------------------------------------------------------------------------
 * 설명  : 기준일자에 대한 종료일자를 GET한다
 *---------------------------------------------------------------------------------------------*/
function fn_dateGet(sDate)
{
	var v_date;
	
	if (gfn_isNull(sDate)) 
	{
		return "-1";
	}
	
	var nDay  = parseInt(gfn_subStr(sDate,6, 2))
	
	
	if (nDay > 15) {
		v_date = gfn_addMonth(sDate, 1);
		v_date = gfn_subStr(v_date, 0, 6) + "15";		
	} else {
		v_date = sDate;
		v_date = gfn_getLastDate(v_date);
	}
	
	return v_date;
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 자재추가 관련 정보 SELECT
 *---------------------------------------------------------------------------------------------*/
function fn_itemCodeAdd()
{
	var nRowCnt = ds_itemRow.getRowCount();
	var sMsg = "";

	if (nRowCnt == 0) {
		sMsg = "해당 자재에 구매단가 정보가 없습니다.";
		gfn_alert(sMsg, "", "A");
		return;
	}

	// 자재구매정보 존재 시 목록에 추가
	var nRow = ds_item.addRow();
	var bSucc;
	bSucc = ds_item.copyRow(nRow,ds_itemRow,ds_itemRow.rowposition);

	if (bSucc) {
		sMsg = "선택한 자재가 추가되었습니다.";
		gfn_alert(sMsg, "", "A");
		ds_item.selectRow(nRow);
		return;
	}	
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 자재추가 관련 정보 SELECT (일괄삭제용)
 *---------------------------------------------------------------------------------------------*/
function fn_itemCodeAdd2()
{
	var nRowCnt = ds_itemRow2.getRowCount();
	var sMsg = "";

	if (nRowCnt == 0) {
		sMsg = "해당 자재에 구매단가 정보가 없습니다.";
		gfn_alert(sMsg, "", "A");
		return;
	}

	// 자재구매정보 존재 시 목록에 추가
	var nRow = ds_item2.addRow();
	var bSucc;
	bSucc = ds_item2.copyRow(nRow,ds_itemRow2,ds_itemRow2.rowposition);

	if (bSucc) {
		sMsg = "선택한 자재가 추가되었습니다.";
		gfn_alert(sMsg, "", "A");
		ds_item2.selectRow(nRow);
		return;
	}	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 센터정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchCenter()
{
    var strSvcID    = "searchCenter";
    var strURL      = "fm/fms/upriceContractUpjangSet/selectCenter.xdo";
    var strInDs     = "";
    var strOutDs    = "ds_center=ds_center";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 센터 COMBO 초기화 
 *---------------------------------------------------------------------------------------------*/
function fn_center_init()
{
	var defVal = "";
	ds_center.filter("centerCode != '*'");
	// COMBO 에 첫번째 Row에 기본값을 SET
	if (ds_center.getRowCount() > 1) {
		defVal = ds_center.getColumn(0, "centerCode");
	}
	cbo_centerCode.value = defVal;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조회버튼 클릭 시 탭페이지 1번째 
 *---------------------------------------------------------------------------------------------*/
function fn_search_tab1()
{
	// 조건 SET
	var nRow = ds_search.rowposition;

	if(chk_sabun.value) ds_search.setColumn(nRow, "schChkSabun", "1");		// CHECK_1
	else ds_search.setColumn(nRow, "schChkSabun", "");		
	ds_search.setColumn(nRow, "schItemCode", edt_itemName.userdata);		// 자재코드

	// 조회시 Validation Check
	if (gfn_validCheck(ds_search, ds_searchValid, true) == false) return;

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(tpg.tabpage1.grd_list);

   	//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장 
	fv_objColInfo = gfn_getDatasetInfo (ds_list);
    
    var strSvcID    = "searchList";
	var strURL      = "fm/fms/salePriceIndexPackModify/selectList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_list=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);


}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조회버튼 클릭 시 탭페이지 2번째 
 *---------------------------------------------------------------------------------------------*/
function fn_search_tab2()
{
	// 조회시 Validation Check
	if (gfn_validCheck(ds_search, ds_searchValid2, true) == false) return;

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(tpg.tabpage2.grd_upjang);

   	//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장 
	fv_objColInfo = gfn_getDatasetInfo (ds_upjang);
    
    var strSvcID    = "searchUpjang";
	var strURL      = "fm/fms/salePriceIndexPackModify/selectUpjang.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_upjang=ds_upjang";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 조회버튼 클릭 시 탭페이지 3번째 
 *---------------------------------------------------------------------------------------------*/
function fn_search_tab3()
{
	// 조회시 Validation Check
	if (gfn_validCheck(ds_search, ds_searchValid3, true) == false) return;

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(tpg.tabpage3.grd_upjang);

   	//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장 
	fv_objColInfo = gfn_getDatasetInfo (ds_upjang2);
    
    var strSvcID    = "searchUpjang2";
	var strURL      = "fm/fms/salePriceIndexPackModify/selectUpjang2.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_upjang2=ds_upjang2";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 그리드 생성 CHECK 에 대한 활성화/비활성화 처리
 *             단가업장정보에 여부에 따른 CHECK 표시, 2번째 탭
 *---------------------------------------------------------------------------------------------*/
function fn_checkSet(nRow)
{
	var edit_type = "";
	
	if (ds_upjang.getColumn(nRow, "marginYn1")=="Y" && gfn_nvl(ds_upjang.getColumn(nRow, "contractDate"),"")!="") edit_type = "checkbox";
	else edit_type = "none";
		
	return edit_type;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 그리드 생성 CHECK 에 대한 활성화/비활성화 처리
 *             단가업장정보에 여부에 따른 CHECK 표시, 3번째 탭
 *---------------------------------------------------------------------------------------------*/
function fn_checkSet2(nRow)
{
	var edit_type = "";
	
	if (gfn_nvl(ds_upjang2.getColumn(nRow, "contractDate"),"")!="") edit_type = "checkbox";
	else edit_type = "none";
		
	return edit_type;
}



/*----------------------------------------------------------------------------------------------
 * 설명      : 판매단가일괄변경 탭 저장 처리
 *             
 *---------------------------------------------------------------------------------------------*/
function fn_save_tab1()
{
	var nRowCnt = ds_list.getRowCount();	// DataSet Count
	var nRow= ds_search.rowposition;
	
	// 저장할 자료 여부 CHECK
	if(nRowCnt == 0) 
	{
		gfn_alert("msg.save.nodata", "저장할 데이터");	// 저장할 데이터가 없습니다.
		return;
	}

	 // v_ds_check 미사용시 변경사항 체크
 	if (gfn_dsIsUpdated(ds_list) == false)
 	{
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}

	// 저장 시 조건 Check	: 조회조건 기준으로 CHECK
	if (gfn_validCheck(ds_search, ds_searchValid, true) == false) return;


	if( !fn_saveCheck1() ) 
	{
		return;
	}

	// 저장관련 Dataset Clear
	ds_listSave.clearData();
	
	
	// 생성 CHECK 개수 
	for (var i = 0 ; i < nRowCnt ; i++)
	{
		// Dataset이 선택된 것만 적용
		if (ds_list.getColumn(i, "chk1")=="1")
		{
			// save Dataset 에 복사 
			var iIdx = ds_listSave.addRow();

			ds_listSave.setColumn(iIdx, "upjang", ds_list.getColumn(i, "upjang"));			// 업장코드
			ds_listSave.setColumn(iIdx, "upjangNm", ds_list.getColumn(i, "upjangNm"));		// 업장명
			ds_listSave.setColumn(iIdx, "poPrice", ds_list.getColumn(i, "poPrice"));		// 현)구매단가
			ds_listSave.setColumn(iIdx, "contractPrice", ds_list.getColumn(i, "contractPrice"));		// 단가표)구매단가
			ds_listSave.setColumn(iIdx, "marginRate", ds_list.getColumn(i, "marginRate"));				// 단가표)마진율
			ds_listSave.setColumn(iIdx, "salePrice", ds_list.getColumn(i, "salePrice"));				// 단가표)판매단가
			ds_listSave.setColumn(iIdx, "chk1", ds_list.getColumn(i, "chk1"));				// 변경적용 CHECK
			ds_listSave.setColumn(iIdx, "chk2", ds_list.getColumn(i, "chk2"));				// 판매가고정 CHECK
			ds_listSave.setColumn(iIdx, "centerCode", ds_search.getColumn(ds_search.rowposition, "schCenter"));				// 센터코드 : 조건 DATASET 적용
			ds_listSave.setColumn(iIdx, "itemCode", ds_search.getColumn(ds_search.rowposition, "schItemCode"));				// 자재코드 : 조건 DATASET 적용
			ds_listSave.setColumn(iIdx, "poDate", ds_search.getColumn(ds_search.rowposition, "schPoDate"));					// 구매단가적용일 : 조건 DATASET 적용
			ds_listSave.setColumn(iIdx, "saleDate", ds_search.getColumn(ds_search.rowposition, "schSaleDate"));				// 판매단가시작일 : 조건 DATASET 적용
			
			ds_listSave.setColumn(iIdx, "schChkNoCeil", chk_noceil.value  );  //판매단가 올림 미적용 체크 추가  20170504 요청자:정지영
		}
	}
	
	// Transaction 처리
	var strSvcID    = "saveList";
	var strURL      = "fm/fms/salePriceIndexPackModify/saveList.xdo";
	var strInDs     = "ds_listSave=ds_listSave:A";
	var strOutDs    = "";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 시 CHECK , 1번째 탭
 *---------------------------------------------------------------------------------------------*/
function fn_saveCheck1()
{
	var nRowCnt = ds_list.getRowCount();	// DataSet Count
	var iCnt = 0;
	
	// CHECK 저장 여부 CHECK
	for (var i = 0 ; i < nRowCnt ; i++)
	{
		// Dataset이 선택된 것만 적용
		if (ds_list.getColumn(i, "chk1")=="1") iCnt++;
	}
	
	if(iCnt == 0)
	{
		gfn_alert("msg.err.grid.noselect", "선택된 항목");	// 선택된 항목이 없습니다.
		return false;
	}
	
	// 자재코드/명
	var sName = "("+edt_itemName.userdata+")"+edt_itemName.value;		
	
	var sMsg = "선택한 고객사에 대한 변경작업을 실행합니다.\n계속 진행 하시겠습니까?\n\n";
		sMsg = sMsg + " - 적용자재 : " + sName + "\n";
		sMsg = sMsg + " - 선택건수 : " + iCnt + "\n";

	
	if (!gfn_confirm(sMsg, "", "C"))
	{
		return false;
	}
	return true;
}





/*----------------------------------------------------------------------------------------------
 * 설명      : 자재일괄추가/변경 탭 저장 처리 - 2번째 탭
 *            PO_TREAT_UPJANG_V 를 기준으로 생성 (PO_CONTRACT_F 기준, 현재 Test 데이터로 고객사 정보가 별로 없음) 
 *---------------------------------------------------------------------------------------------*/
function fn_save_tab2()
{
	var nRowCnt = ds_upjang.getRowCount();	// DataSet Count
	var nItemCnt = ds_item.getRowCount();	// DataSet Count
	var nRow= ds_search.rowposition;

	// 자재목록 여부 CEHCK
	if(nItemCnt == 0) 
	{
		gfn_alert("msg.err.validator.required", "추가할 자재");	// $1 은(는) 필수 입력 항목입니다.
		return;
	}
	
	// 저장할 자료 여부 CHECK
	if(nRowCnt == 0) 
	{
		gfn_alert("msg.save.nodata", "저장할 데이터");	// 저장할 데이터가 없습니다.
		return;
	}

	 // v_ds_check 미사용시 변경사항 체크
 	if (gfn_dsIsUpdated(ds_upjang) == false)
 	{
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}

	// 저장 시 조건 Check	: 조회조건 기준으로 CHECK
	if (gfn_validCheck(ds_search, ds_searchValid2, true) == false) return;

	if( !fn_saveCheck2() ) 
	{
		return;
	}

	var v_PDate = "";						// 전략이익율 관련 날짜 SET

	if (cal_saleDate.text.substr(6,2) > "15") v_PDate = cal_saleDate.text.substr(0,4) + cal_saleDate.text.substr(4,2) + "16";
	else v_PDate = cal_saleDate.text.substr(0,4) + cal_saleDate.text.substr(4,2) + "01";



	// 저장관련 Dataset Clear
	ds_upjangSave.clearData();
	

	var v_itemCode = "";
	var v_contractPriceS;
	
	// 좌측의 자재목록 개수 만큼 DataSet을 생성한다
	for (var j = 0 ; j < nItemCnt ; j++)
	{	
		v_itemCode = ds_item.getColumn(j, "itemCode");		// 자재코드 SET
		if (gfn_isNull(ds_item.getColumn(j, "contractPriceS"))) v_contractPriceS = "0";
		else v_contractPriceS = ds_item.getColumn(j, "contractPriceS");
	
		// 생성 CHECK 개수 
		for (var i = 0 ; i < nRowCnt ; i++)
		{
			// Dataset이 선택된 것만 적용
			if (ds_upjang.getColumn(i, "chk")=="1")
			{
				if (!gfn_isNull(ds_upjang.getColumn(i, "contractDate"))) 
				{
					// save Dataset 에 복사 
					var iIdx = ds_upjangSave.addRow();
					
					ds_upjangSave.setColumn(iIdx, "upjang", ds_upjang.getColumn(i, "upjang"));						// 업장코드
					ds_upjangSave.setColumn(iIdx, "priceUpjang", ds_upjang.getColumn(i, "priceUpjang"));			// 단가업장코드
					ds_upjangSave.setColumn(iIdx, "priceUpjangNm", ds_upjang.getColumn(i, "priceUpjangNm"));		// 단가업장명
					ds_upjangSave.setColumn(iIdx, "chk", ds_upjang.getColumn(i, "chk"));							// 생성여부
					ds_upjangSave.setColumn(iIdx, "marginYn1", ds_upjang.getColumn(i, "marginYn1"));				// 이익율여부(분류,자재)
					ds_upjangSave.setColumn(iIdx, "itemCode", v_itemCode);											// 자재코드 : 좌측 자재목록
					ds_upjangSave.setColumn(iIdx, "contractPriceS", v_contractPriceS);								// 구매단가 : 좌측 자재목록
					ds_upjangSave.setColumn(iIdx, "centerCode", ds_search.getColumn(ds_search.rowposition, "schCenter"));				// 센터코드 : 조건 DATASET 적용
					ds_upjangSave.setColumn(iIdx, "poDate", ds_search.getColumn(ds_search.rowposition, "schPoDate"));					// 구매단가적용일 : 조건 DATASET 적용
					//ds_upjangSave.setColumn(iIdx, "saleDate", ds_search.getColumn(ds_search.rowposition, "schSaleDate"));				// 판매단가시작일 : 조건 DATASET 적용(구)-2015/10/08
					//ds_upjangSave.setColumn(iIdx, "saleDate2", ds_search.getColumn(ds_search.rowposition, "schSaleDate2"));				// 판매단가종료일 : 조건 DATASET 적용(구)-2015/10/08
					var sDate = ds_upjang.getColumn(i, "contractDate");				// 계약단가시작일
					ds_upjangSave.setColumn(iIdx, "saleDate", sDate);				// 판매단가시작일 : 조건 DATASET 적용
					// 조건 : 기준일자 종료일 SET
					ds_upjangSave.setColumn(iIdx, "saleDate2", fn_dateGet(sDate));	// 판매단가종료일 SET
					ds_upjangSave.setColumn(iIdx, "stdPDate", v_PDate);												// 전략이익율 일자 SET
					ds_upjangSave.setColumn(iIdx, "attr09", ds_upjang.getColumn(i, "attr09"));						// 전략단가제외여부
					ds_upjangSave.setColumn(iIdx, "attr10", ds_upjang.getColumn(i, "attr10"));						// 기획단가제외여부
					
					ds_upjangSave.setColumn(iIdx, "schChkNoCeil", chk_noceil.value  );   //판매단가 올림 미적용 체크 추가  20170504 요청자:정지영
				}
			}
		}	// end for -- i

	}  // end for -- j
	
	// Transaction 처리 
	var strSvcID    = "saveList2";
	var strURL      = "fm/fms/salePriceIndexPackModify/saveList2.xdo";
	var strInDs     = "ds_upjangSave=ds_upjangSave:A";
	var strOutDs    = "";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 자재일괄삭제 탭 저장 처리 - 3번째 탭
 *---------------------------------------------------------------------------------------------*/
function fn_save_tab3()
{
	var nRowCnt = ds_upjang2.getRowCount();	// DataSet Count
	var nItemCnt = ds_item2.getRowCount();	// DataSet Count
	var nRow= ds_search.rowposition;

	// 자재목록 여부 CEHCK
	if(nItemCnt == 0) 
	{
		gfn_alert("msg.err.validator.required", "추가할 자재");	// $1 은(는) 필수 입력 항목입니다.
		return;
	}
	
	// 저장할 자료 여부 CHECK
	if(nRowCnt == 0) 
	{
		gfn_alert("msg.save.nodata", "저장할 데이터");	// 저장할 데이터가 없습니다.
		return;
	}

	 // v_ds_check 미사용시 변경사항 체크
 	if (gfn_dsIsUpdated(ds_upjang2) == false)
 	{
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}

	// 저장 시 조건 Check	: 조회조건 기준으로 CHECK
	if (gfn_validCheck(ds_search, ds_searchValid3, true) == false) return;

	if( !fn_saveCheck3() ) 
	{
		return;
	}

	var v_PDate = "";						// 전략이익율 관련 날짜 SET

	if (cal_saleDate.text.substr(6,2) > "15") v_PDate = cal_saleDate.text.substr(0,4) + cal_saleDate.text.substr(4,2) + "16";
	else v_PDate = cal_saleDate.text.substr(0,4) + cal_saleDate.text.substr(4,2) + "01";

	// 삭제관련 Dataset Clear
	ds_upjangSave2.clearData();
	

	var v_itemCode = "";
	var v_contractPriceS;
	
	// 좌측의 자재목록 개수 만큼 DataSet을 생성한다
	for (var j = 0 ; j < nItemCnt ; j++)
	{	
		v_itemCode = ds_item2.getColumn(j, "itemCode");		// 자재코드 SET
	
		// 생성 CHECK 개수 
		for (var i = 0 ; i < nRowCnt ; i++)
		{
			// Dataset이 선택된 것만 적용
			if (ds_upjang2.getColumn(i, "chk")=="1")
			{
				// save Dataset 에 복사 
				var iIdx = ds_upjangSave2.addRow();
				
				ds_upjangSave2.setColumn(iIdx, "upjang", ds_upjang2.getColumn(i, "upjang"));					// 업장코드
				ds_upjangSave2.setColumn(iIdx, "priceUpjang", ds_upjang2.getColumn(i, "priceUpjang"));			// 단가업장코드
				ds_upjangSave2.setColumn(iIdx, "priceUpjangNm", ds_upjang2.getColumn(i, "priceUpjangNm"));		// 단가업장명
				ds_upjangSave2.setColumn(iIdx, "chk", ds_upjang2.getColumn(i, "chk"));							// 생성여부
				ds_upjangSave2.setColumn(iIdx, "itemCode", v_itemCode);											// 자재코드 : 좌측 자재목록
				ds_upjangSave2.setColumn(iIdx, "centerCode", ds_search.getColumn(ds_search.rowposition, "schCenter"));				// 센터코드 : 조건 DATASET 적용
				var sDate = ds_upjang2.getColumn(i, "contractDate");				// 계약단가시작일
				ds_upjangSave2.setColumn(iIdx, "saleDate", sDate);				// 판매단가시작일 : 조건 DATASET 적용
				ds_upjangSave2.setColumn(iIdx, "poDate", sDate);				// 구매단가적용일 : 조건 DATASET 적용
			}
		}	// end for -- i

	}  // end for -- j


	// Transaction 처리 
	var strSvcID    = "saveList3";
	var strURL      = "fm/fms/salePriceIndexPackModify/saveList3.xdo";
	var strInDs     = "ds_upjangSave2=ds_upjangSave2:A";
	var strOutDs    = "";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 시 CHECK , 2번째 탭
 *---------------------------------------------------------------------------------------------*/
function fn_saveCheck2()
{
	var nRowCnt = ds_upjang.getRowCount();	// DataSet Count
	var iCnt = 0;
	
	// CHECK 저장 여부 CHECK
	for (var i = 0 ; i < nRowCnt ; i++)
	{
		// Dataset이 선택된 것만 적용
		if (ds_upjang.getColumn(i, "chk")=="1") iCnt++;
	}
	
	if(iCnt == 0)
	{
		gfn_alert("msg.err.grid.noselect", "선택된 항목");	// 선택된 항목이 없습니다.
		return false;
	}
	
	var sMsg = "선택한 자재에 대한 추가작업을 실행합니다.\n계속 진행 하시겠습니까?\n\n";
		sMsg = sMsg + " - 선택건수 : " + iCnt + "\n\n";
		sMsg = sMsg + " ※ 해당 업장에 구매계약정보에 없는 자재는 생성되지 않습니다.";

	
	if (!gfn_confirm(sMsg, "", "C"))
	{
		return false;
	}
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 시 CHECK , 3번째 탭
 *---------------------------------------------------------------------------------------------*/
function fn_saveCheck3()
{
	var nRowCnt = ds_upjang2.getRowCount();	// DataSet Count
	var iCnt = 0;
	
	// CHECK 저장 여부 CHECK
	for (var i = 0 ; i < nRowCnt ; i++)
	{
		// Dataset이 선택된 것만 적용
		if (ds_upjang2.getColumn(i, "chk")=="1") iCnt++;
	}
	
	if(iCnt == 0)
	{
		gfn_alert("msg.err.grid.noselect", "선택된 항목");	// 선택된 항목이 없습니다.
		return false;
	}
	
	var sMsg = "선택한 자재에 대한 삭제작업을 실행합니다.\n계속 진행 하시겠습니까?\n\n";
		sMsg = sMsg + " - 선택건수 : " + iCnt + "\n\n";
		sMsg = sMsg + " ※ 해당 업장에 판매단가정보에 없는 자재는 삭제되지 않습니다.";

	
	if (!gfn_confirm(sMsg, "", "C"))
	{
		return false;
	}
	return true;
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 적용자재 검색 팝업 
 *              
 *---------------------------------------------------------------------------------------------*/
function fn_itemSearch(bEnter)
{
	var nRow= ds_search.rowposition;


	// 팝업창을 호출한다	
	var strId       = "PoItemSearch";
	var strURL      = "X_FMS::PoItemSearchPop.xfdl";
	var arrParam = new Array();
// 	var objArgument = {
// 		P_DATASET : ds_search
// 	};
	
	var nWidth      = 513;
	var nHeight     = 495;
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";

	// 적용자재 항목 입력 후 엔터키 이벤트 시
	if (bEnter) {
		arrParam[0] = ds_search.getColumn(nRow, "schItemName");
	}
	
	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, {fv_Contents:arrParam}, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
	
	if (arrRtn instanceof Object)
	{
		edt_itemName.value    = arrRtn["itemName"];
		edt_itemName.userdata = arrRtn["itemCode"];
		btn_item.userdata       = arrRtn["itemName"];
	}
}


/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : form에서 Key Down시 단축키들 지정(공통에서 자동생성, 화면에 스크립트 작성시 화면 스크립트만 실행됨)
 *---------------------------------------------------------------------------------------------*/
// function form_onkeydown(obj:Form, e:KeyEventInfo)
// {
// 	gfn_formKeyDown(obj, e);
// }

/*----------------------------------------------------------------------------------------------
 * 설명      : Grid Header Click시 정렬(공통에서 자동생성, 화면에 스크립트 작성시 화면 스크립트만 실행됨)
 *---------------------------------------------------------------------------------------------*/
// function grd_list_onheadclick(obj:Grid, e:GridClickEventInfo)
// {
// 	gfn_gridSort(obj, e);
// }

/*----------------------------------------------------------------------------------------------
 * 설명      : 적용자재 검색 팝업 이벤트
 *              
 *---------------------------------------------------------------------------------------------*/
function btn_item_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_itemSearch(false);
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 자재 검색 콘트롤 이벤트 - 삭제 시 DATA SET Clear
 *              
 *---------------------------------------------------------------------------------------------*/
function edt_itemName_onkeydown(obj:Edit, e:KeyEventInfo)
{
	// Enter 키
	if(e.keycode == 13) 
	{		
        if (!gfn_isNull(obj.value))
        {
			edt_itemName.updateToDataset();
			fn_itemSearch(true);
		}
	}

	// Del 키
	if(e.keycode == 46) 
	{		
		edt_itemName.value="";
		edt_itemName.userdata="";
		// DataSet Clear
		ds_list.clearData();
	}

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조건관련 Dataset 변경 시 이벤트 처리
 *---------------------------------------------------------------------------------------------*/
function ds_search_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	    switch(e.columnid)
    {
		case "schCenter" :			// 센터코드
			ds_list.clearData();
			break;

		case "schPoDate" :			// 구매단가_기준일자
			ds_list.clearData();
			break;

		case "schSaleDate" :		// 판매단가_기준일자
			fn_searchDateSet();
			ds_list.clearData();
			break;

		case "schItemName" :		// 적용자재
			ds_list.clearData();
			break;
	
	
	}	

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 적용자재 검색 팝업 이벤트
 *              
 *---------------------------------------------------------------------------------------------*/
function tpg_tabpage2_btn_item2_onclick(obj:Button,  e:ClickEventInfo)
{
	// 팝업창을 호출한다	
	var strId       = "PoItemSearch";
	var strURL      = "X_FMS::PoItemSearchPop.xfdl";
	var objArgument = {
		P_DATASET : ds_search
	};
	
	var nWidth      = 513;
	var nHeight     = 495;
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	
	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
	
	if (arrRtn instanceof Object)
	{
		tpg.tabpage2.edt_itemName2.value = arrRtn["itemName"];
		tpg.tabpage2.edt_itemName2.userdata = arrRtn["itemCode"];
		obj.userdata       = arrRtn["itemName"];
	}
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 자재추가 버튼 이벤트
 *              
 *---------------------------------------------------------------------------------------------*/
function tpg_tabpage2_btn_itemAdd_onclick(obj:Button,  e:ClickEventInfo)
{
	var v_itemCode = "";

	// 필수 조건 CHECK
	if (gfn_validCheck(ds_search, ds_searchValid2, true) == false) return;
	
	// 자재 CHECK
	v_itemCode = tpg.tabpage2.edt_itemName2.userdata;
	
	if (v_itemCode=="") {
		gfn_alert("msg.noselect", "자재");	// 자재를 선택해 주십시요.
		tpg.tabpage2.edt_itemName2.setFocus();
		return;	
	}
	
	// 자재중복 CHECK
	var iFindRowIdx = ds_item.findRowExpr("itemCode == '"+v_itemCode+"'", 0, ds_item.rowcount);

	// 중복자료 존재 시
	if (iFindRowIdx != -1) {
		sMsg = "이미 추가된 자재입니다.";
		gfn_alert(sMsg, "", "A");
		return;
	}
	
	// 구매단가 기준 CHECK
	var sPriceUpjang = ""; 
	var sMode = tpg.tabpage2.cbo_mode.value;
		
	if (sMode=="2") {
		if(ds_upjang.rowposition == -1) 
		{
			gfn_alert("msg.noselect", "고객사");	// $1 을(를) 선택해 주십시요.
			return;
		}
		sPriceUpjang = ds_upjang.getColumn(ds_upjang.rowposition, "upjang");	// 선택한 업장 조건 SET
	}
	
	
	// 조건 DataSet 관련 : 추가할 자재코드, 선택한 업장
	ds_search.setColumn(ds_search.rowposition, "schItemCode2", v_itemCode);		// 자재코드(추가용)
	ds_search.setColumn(ds_search.rowposition, "schPriceUpjang", sPriceUpjang);	// 업장(추가용)
	
	// 자재추가 관련 GET	
    var strSvcID    = "searchItemCode";
	var strURL      = "fm/fms/salePriceIndexPackModify/selectItemCode.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_itemRow=ds_itemRow";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 자재삭제 버튼 이벤트
 * 1 ROW 기준             
 *---------------------------------------------------------------------------------------------*/
function tpg_tabpage2_btn_itemDel_onclick222(obj:Button,  e:ClickEventInfo)
{
	// 자재목록에서 삭제 : 선택한 행의 자재를 바로 삭제
	var nRow = ds_item.rowposition;

	if(ds_item.rowposition == -1) 
	{
		gfn_alert("msg.err.grid.noselect", "삭제할 row");	// 선택된 항목이 없습니다.
		return;
	}
	
	var sItemCode = ds_item.getColumn(nRow, "itemCode");
	var sItemName = ds_item.getColumn(nRow, "itemName");
	var sItemSize = ds_item.getColumn(nRow, "itemSize");
	
	var sMsg = "선택한 자재를 삭제합니다.\n계속 진행 하시겠습니까?\n\n";
		sMsg = sMsg + " - 자재코드 : " + sItemCode + "\n";
		sMsg = sMsg + " - 자재명   : " + sItemName + "\n";
		sMsg = sMsg + " - 규격   : " + sItemSize + "\n";
	
	var rtVal = gfn_confirm(sMsg, "", "C");	// 선택된 자료를 삭제 하시겠습니까?

	if (rtVal == true) 
	{	
		var bSucc = ds_item.deleteRow(nRow);
		if (bSucc) gfn_alert("msg.delete.success");	// 삭제 되었습니다.
		else gfn_alert("msg.err.grid.noselect");	// 선택된 항목이 없습니다.	
		return;
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 자재삭제 버튼 이벤트
 *---------------------------------------------------------------------------------------------*/
function tpg_tabpage2_btn_itemDel_onclick(obj:Button,  e:ClickEventInfo)
{
	var nRowCnt = ds_item.getRowCount();	// DataSet Count
	var iCnt = 0;

	
	// 삭제할 자료 CHECK
	for (var i = 0 ; i < nRowCnt ; i++)
	{
 		// Dataset이 선택된 것만 적용
 		if (ds_item.getSelect(i))	
 		{
 			iCnt++;
 		}
	}
	// 삭재 COUNT CHECK
	if(iCnt == 0)
	{
		sMsg = "삭제할 자재정보가 없습니다.";
		gfn_alert(sMsg, "", "A");
		return;
	}	
	
	var sMsg = "선택한 자재를 삭제합니다.\n계속 진행 하시겠습니까?\n\n";
	
	var rtVal = gfn_confirm(sMsg, "", "C");	// 선택된 자료를 삭제 하시겠습니까?

	if (rtVal == true) 
	{	
		// 선택되어진 Dataset에 대한 자료 일괄 삭제
		var nSucc = ds_item.deleteSelectedRows();
		//trace("nSucc : " + nSucc);
		gfn_alert("msg.delete.success");	// 삭제 되었습니다.
		return;
	}
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 탭 변경 이벤트
 *              
 *---------------------------------------------------------------------------------------------*/
function tpg_onchanged(obj:Tab, e:TabIndexChangeEventInfo)
{
	tabIndex =e.postindex;//선택된 탭 인덱스 저장
	
	if (tabIndex == 0) {
		Static13.visible = true;
		cal_saleDate.visible = true;
		sta_msg.visible = false;
	} else {
		Static13.visible = false;
		cal_saleDate.visible = false;
		sta_msg.visible = true;
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 생성이력 조회
 *              
 *---------------------------------------------------------------------------------------------*/
function tpg_tabpage2_btn_hist_onclick(obj:Button,  e:ClickEventInfo)
{
	var rtnVal = gfn_dialog("SalePricePackHistoryPop"					// Dialog ID
							, "X_FMS::SalePricePackHistoryPop.xfdl"	// Form URL
							, null			// 배열
							, null, null, null, null, null, false, true, -1);
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : Grid Header Click시 이벤트
 *              
 *---------------------------------------------------------------------------------------------*/
function tpg_tabpage2_grd_upjang_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	var nCell = e.cell;   
    var nSubCnt = obj.getSubCellCount("head", nCell);
    var vl_chk;
    
	//모두선택/모두해제 체크박스
	if(obj.getCellProperty("Head" ,nCell ,"edittype") == "checkbox")
	{
		//gfn_setGridCheckAll(obj,e);
		var strVal;    
        // Head셋팅
        strVal = obj.getCellProperty("head", nCell, "text");
        if (gfn_isNull(strVal)) strVal = "0";
        
        if (strVal == "0") 
        {
            obj.setCellProperty("head", nCell, "text", '1');
            vl_chk = "1";
        } 
        else {
            obj.setCellProperty("head", nCell, "text", '0');
            vl_chk = "0";
        }
        
		var strVal;    
		strChkVal = gfn_transNullToEmpty(obj.getCellProperty("body", nCell, "text"));
		strChkVal = strChkVal.replace("bind:", "");
        
		// Body셋팅
		for(var i=0 ; i < ds_upjang.rowcount; i++) 
		{
			if (ds_upjang.getColumn(i, "marginYn1")=="Y" && gfn_nvl(ds_upjang.getColumn(i, "contractDate"),"")!="") ds_upjang.setColumn(i, "chk", vl_chk);
			else ds_upjang.setColumn(i, "chk", "0");
		}
        
	} else gfn_gridSort(obj, e);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : Grid Header Click시 이벤트
 *---------------------------------------------------------------------------------------------*/
function tpg_tabpage1_grd_list_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	var nCell = e.cell;   
    var nSubCnt = obj.getSubCellCount("head", nCell);
    var vl_chk;
    
	//모두선택/모두해제 체크박스
	if(obj.getCellProperty("Head" ,nCell ,"edittype") == "checkbox")
	{
		var strVal;    
        // Head셋팅
        strVal = obj.getCellProperty("head", nCell, "text");
        if (gfn_isNull(strVal)) strVal = "0";

        if (strVal == "0") 
        {
            obj.setCellProperty("head", nCell, "text", '1');
            vl_chk = "1";
        } 
        else {
            obj.setCellProperty("head", nCell, "text", '0');
            vl_chk = "0";
        }

		var strChkVal;    
		//strChkVal = gfn_transNullToEmpty(obj.getCellProperty("body", nCell, "text"));
		//strChkVal = strChkVal.replace("bind:", "");
		if (nCell == 10) strChkVal = "chk1";
		else if (nCell == 11) strChkVal = "chk2";
			
		// Body셋팅
		for(var i=0 ; i<ds_list.rowcount; i++) 
		{
			ds_list.setColumn(i, strChkVal, vl_chk);
		}
	
	} else gfn_gridSort(obj, e);
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : Grid Header Click시 이벤트
 *              
 *---------------------------------------------------------------------------------------------*/
function tpg_tabpage3_grd_upjang_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	var nCell = e.cell;   
    var nSubCnt = obj.getSubCellCount("head", nCell);
    var vl_chk;
    
	//모두선택/모두해제 체크박스
	if(obj.getCellProperty("Head" ,nCell ,"edittype") == "checkbox")
	{
		//gfn_setGridCheckAll(obj,e);
		var strVal;    
        // Head셋팅
        strVal = obj.getCellProperty("head", nCell, "text");
        if (gfn_isNull(strVal)) strVal = "0";
        
        if (strVal == "0") 
        {
            obj.setCellProperty("head", nCell, "text", '1');
            vl_chk = "1";
        } 
        else {
            obj.setCellProperty("head", nCell, "text", '0');
            vl_chk = "0";
        }
        
		var strVal;    
		strChkVal = gfn_transNullToEmpty(obj.getCellProperty("body", nCell, "text"));
		strChkVal = strChkVal.replace("bind:", "");
        
		// Body셋팅
		for(var i=0 ; i < ds_upjang2.rowcount; i++) 
		{
			if (ds_upjang2.getColumn(i, "marginYn1")=="Y" && gfn_nvl(ds_upjang2.getColumn(i, "contractDate"),"")!="") ds_upjang2.setColumn(i, "chk", vl_chk);
			else ds_upjang2.setColumn(i, "chk", "0");
		}
        
	} else gfn_gridSort(obj, e);
}



function chk_sabun_onclick(obj:CheckBox,  e:ClickEventInfo)
{
	if (chk_sabun.value) 
		ds_search.setColumn(0, "schChkSabun", "1");
	else
		ds_search.setColumn(0, "schChkSabun", "");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 적용자재 검색 팝업 이벤트 (삭제용)
 *              
 *---------------------------------------------------------------------------------------------*/
function tpg_tabpage3_btn_item2_onclick(obj:Button,  e:ClickEventInfo)
{
	// 팝업창을 호출한다	
	var strId       = "PoItemSearch";
	var strURL      = "X_FMS::PoItemSearchPop.xfdl";
	var objArgument = {
		P_DATASET : ds_search
	};
	
	var nWidth      = 513;
	var nHeight     = 495;
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	
	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
	
	if (arrRtn instanceof Object)
	{
		tpg.tabpage3.edt_itemName2.value = arrRtn["itemName"];
		tpg.tabpage3.edt_itemName2.userdata = arrRtn["itemCode"];
		obj.userdata       = arrRtn["itemName"];
	}
	
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 자재추가 버튼 이벤트 (일괄 삭제용)
 *              
 *---------------------------------------------------------------------------------------------*/
function tpg_tabpage3_btn_itemAdd_onclick(obj:Button,  e:ClickEventInfo)
{
	var v_itemCode = "";

	// 필수 조건 CHECK
	//if (gfn_validCheck(ds_search, ds_searchValid2, true) == false) return;
	
	// 자재 CHECK
	v_itemCode = tpg.tabpage3.edt_itemName2.userdata;
	
	if (v_itemCode=="") {
		gfn_alert("msg.noselect", "자재");	// 자재를 선택해 주십시요.
		tpg.tabpage3.edt_itemName2.setFocus();
		return;	
	}
	
	// 자재중복 CHECK
	var iFindRowIdx = ds_item2.findRowExpr("itemCode == '"+v_itemCode+"'", 0, ds_item.rowcount);

	// 중복자료 존재 시
	if (iFindRowIdx != -1) {
		sMsg = "이미 추가된 자재입니다.";
		gfn_alert(sMsg, "", "A");
		return;
	}
	
// 	// 구매단가 기준 CHECK
// 	var sPriceUpjang = ""; 
// 	var sMode = tpg.tabpage2.cbo_mode.value;
// 		
// 	if (sMode=="2") {
// 		if(ds_upjang.rowposition == -1) 
// 		{
// 			gfn_alert("msg.noselect", "고객사");	// $1 을(를) 선택해 주십시요.
// 			return;
// 		}
// 		sPriceUpjang = ds_upjang.getColumn(ds_upjang.rowposition, "upjang");	// 선택한 업장 조건 SET
// 	}
	
	
	// 조건 DataSet 관련 : 추가할 자재코드, 선택한 업장
	ds_search.setColumn(ds_search.rowposition, "schItemCode3", v_itemCode);		// 자재코드(추가용)
	
	// 자재추가 관련 GET	(일괄삭제용)
    var strSvcID    = "searchItemCode2";
	var strURL      = "fm/fms/salePriceIndexPackModify/selectItemCode2.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_itemRow2=ds_itemRow2";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 자재삭제 버튼 이벤트 (일괄삭제용)
 *---------------------------------------------------------------------------------------------*/
function tpg_tabpage3_btn_itemDel_onclick(obj:Button,  e:ClickEventInfo)
{
	var nRowCnt = ds_item2.getRowCount();	// DataSet Count
	var iCnt = 0;

	
	// 삭제할 자료 CHECK
	for (var i = 0 ; i < nRowCnt ; i++)
	{
 		// Dataset이 선택된 것만 적용
 		if (ds_item2.getSelect(i))	
 		{
 			iCnt++;
 		}
	}
	// 삭재 COUNT CHECK
	if(iCnt == 0)
	{
		sMsg = "삭제할 자재정보가 없습니다.";
		gfn_alert(sMsg, "", "A");
		return;
	}	
	
	var sMsg = "선택한 자재를 삭제합니다.\n계속 진행 하시겠습니까?\n\n";
	
	var rtVal = gfn_confirm(sMsg, "", "C");	// 선택된 자료를 삭제 하시겠습니까?

	if (rtVal == true) 
	{	
		// 선택되어진 Dataset에 대한 자료 일괄 삭제
		var nSucc = ds_item2.deleteSelectedRows();
		//trace("nSucc : " + nSucc);
		gfn_alert("msg.delete.success");	// 삭제 되었습니다.
		return;
	}
}




function chk_noceil_onclick(obj:CheckBox,  e:ClickEventInfo)
{
    if (chk_noceil.value) {
		ds_search.setColumn(0, "schChkNoCeil", "1");
		
	}else{
		ds_search.setColumn(0, "schChkNoCeil", "");
	}
}


]]></Script>
  </Form>
</FDL>

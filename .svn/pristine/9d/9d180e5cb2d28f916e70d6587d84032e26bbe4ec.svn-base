<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="OpPropsal" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="손익추정보고서" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="1" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30" tabstop="false"/>
        <Static id="Static59" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 11 700 1226 710"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 93 40" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 93 71" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static03" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 905 71 983 77" anchor="top right"/>
        <Static id="Static22" text="물건관리카드 목록" class="sta_WF_Title01" position="absolute 0 84 220 102" anchor="default"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 97 1125 102" anchor="left top"/>
        <Static id="Static40" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 348 116 358 671"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 460 71 910 84" anchor="left top"/>
        <Static id="Static20" text="손익 추정" class="sta_WF_Title01" position="absolute 360 84 515 102" anchor="default"/>
        <Static id="Static21" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 295 84" anchor="left top"/>
        <Static id="Static28" text="사업부" class="sta_WFSA_label" position="absolute 15 40 77 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 60 40 70 61" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 230 40 260 61" anchor="left top"/>
        <Static id="Static00" text="팀" class="sta_WFSA_label" position="absolute 260 40 322 61" anchor="left top"/>
        <Static id="Static01" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 279 40 289 61" anchor="left top"/>
        <Static id="Static02" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 446 40 476 61" anchor="left top"/>
        <Static id="Static17" text="물건명" class="sta_WFSA_label" position="absolute 477 40 539 61" anchor="left top"/>
        <Static id="Static18" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 521 40 531 61" anchor="left top"/>
        <Static id="Static12" text="계약만료일" class="sta_WFSA_label" position="absolute 746 41 823 62" anchor="left top"/>
        <Static id="Static24" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 816 41 826 62" anchor="left top"/>
        <Static id="Static27" text="~" class="sta_WF_Dash" position="absolute 930 40 942 61"/>
        <Static id="Static29" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 715 40 745 61" anchor="left top"/>
        <TmSearchComponent id="edt_tmNm" titletext="팀 검색용 Component" taborder="76" class="edt_WF_Essential" position="absolute 289 40 446 62" bindDataset="ds_search" bindTmCdColumn="tmCd" bindTmNmColumn="tmNm" qoBuCd="" qoMuCd="" qoUseYn="Y" eventAfterTrigger="fn_tmChangedEvent" eventBeforeTrigger=""/>
        <MuSearchComponent id="edt_muNm" titletext="사업부 선택 Component" taborder="77" class="cmb_WF_Essential" position="absolute 70 40 229 61" bindDataset="ds_search" bindMuCdColumn="muCd" appendText="전체" onItemChangedEvent="fn_muItemChangedEvent"/>
        <Edit id="edt_searchObjectNm" taborder="78" position="absolute 531 40 715 61" anchor="left top"/>
        <ObjCalendar id="cal_contractEndFrom" titletext="캘린더" taborder="79" scrollbars="none" position="absolute 826 40 926 61"/>
        <ObjCalendar id="cal_contractEndTo" titletext="캘린더" taborder="80" onkeydown="fn_searchEnter" scrollbars="none" position="absolute 945 40 1045 61"/>
        <Grid id="grd_objectList" taborder="81" binddataset="ds_objectList" autoenter="select" useinputpanel="false" cellsizingtype="col" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" oncellclick="grd_list_oncellclick" position="absolute 0 102 348 700" anchor="left top bottom">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="145"/>
                <Column size="100"/>
                <Column size="100"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="물건명"/>
                <Cell col="1" text="업장"/>
                <Cell col="2" text="계약만료일"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:left;" text="bind:objectNm"/>
                <Cell col="1" displaytype="text" style="align:left middle;" text="bind:upjangNm"/>
                <Cell col="2" displaytype="date" text="bind:contractEndDate" mask="yyyy-MM-dd" calendardisplaynulltype="none"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static48" text="손익추정 및 배부율 미등록시, 사업계획/실적 조회 불가" class="sta_WF_DiscInfo" position="absolute 886 80 1236 95" anchor="default" style="color:red;" visible="false"/>
        <Grid id="grd_plinvoiceList" taborder="82" binddataset="ds_plinvoiceList" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 358 134 1237 700" anchor="all" selecttype="currow" onheadclick="grd_plinvoiceList_onheadclick" oncellclick="grd_plinvoiceList_oncellclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="180"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel" taborder="undefined"/>
                <Cell col="1" text="구분"/>
                <Cell col="2" text="계정"/>
                <Cell col="3" text="계정명"/>
                <Cell col="4" text="매출액 대비율"/>
                <Cell col="5" text="합계" taborder="undefined"/>
                <Cell col="6" text="1월" taborder="undefined"/>
                <Cell col="7" text="2월" taborder="undefined"/>
                <Cell col="8" text="3월" taborder="undefined"/>
                <Cell col="9" text="4월" taborder="undefined"/>
                <Cell col="10" text="5월" taborder="undefined"/>
                <Cell col="11" text="6월" taborder="undefined"/>
                <Cell col="12" text="7월" taborder="undefined"/>
                <Cell col="13" text="8월" taborder="undefined"/>
                <Cell col="14" text="9월" taborder="undefined"/>
                <Cell col="15" text="10월" taborder="undefined"/>
                <Cell col="16" text="11월" taborder="undefined"/>
                <Cell col="17" text="12월" taborder="undefined"/>
              </Band>
              <Band id="body">
                <Cell style="background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:chk" expr="currow+1"/>
                <Cell col="1" displaytype="text" style="align:center;background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:acctClass" subsumtext="expr:decode(ds_plinvoiceList.getColumn(currow+1,&quot;acctNum&quot;), &quot;412&quot;, ds_plinvoiceList.getColumn(currow+1,&quot;acctClass&quot;), &quot;422&quot;, ds_plinvoiceList.getColumn(currow+1,&quot;acctClass&quot;), &quot;431&quot;, ds_plinvoiceList.getColumn(currow+1,&quot;acctClass&quot;), &quot;432&quot;, ds_plinvoiceList.getColumn(currow+1,&quot;acctClass&quot;), &quot;&quot;)" suppress="1"/>
                <Cell col="2" displaytype="text" edittype="none" style="align:center;background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:acctCd" subsumtext="expr:decode(ds_plinvoiceList.getColumn(currow+1,&quot;acctNum&quot;), &quot;412&quot;, &quot;소계&quot;, &quot;422&quot;, &quot;소계&quot;, &quot;431&quot;, &quot;소계&quot;, &quot;432&quot;, &quot;소계&quot;, &quot;&quot;)" expandshow="hide" expandsize="20"/>
                <Cell col="3" displaytype="text" edittype="none" style="align:left;background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:acctNm"/>
                <Cell col="4" displaytype="number" style="align:right middle;background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:sailoutRate" mask="###,##0.0#"/>
                <Cell col="5" displaytype="number" edittype="none" style="background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:sumAmt" mask="###,###,##0"/>
                <Cell col="6" displaytype="number" edittype="masknumber" style="background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:janAmt" mask="###,###,##0" editlimit="12"/>
                <Cell col="7" displaytype="number" edittype="masknumber" style="background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:febAmt" mask="###,###,##0" editlimit="12"/>
                <Cell col="8" displaytype="number" edittype="masknumber" style="background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:marAmt" mask="###,###,##0" editlimit="12"/>
                <Cell col="9" displaytype="number" edittype="masknumber" style="background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:aprAmt" mask="###,###,##0" editlimit="12"/>
                <Cell col="10" displaytype="number" edittype="masknumber" style="background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:mayAmt" mask="###,###,##0" editlimit="12"/>
                <Cell col="11" displaytype="number" edittype="masknumber" style="background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:junAmt" mask="###,###,##0" editlimit="12"/>
                <Cell col="12" displaytype="number" edittype="masknumber" style="background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:julAmt" mask="###,###,##0" editlimit="12"/>
                <Cell col="13" displaytype="number" edittype="masknumber" style="background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:augAmt" mask="###,###,##0" editlimit="12"/>
                <Cell col="14" displaytype="number" edittype="masknumber" style="background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:sepAmt" mask="###,###,##0" editlimit="12"/>
                <Cell col="15" displaytype="number" edittype="masknumber" style="background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:octAmt" mask="###,###,##0" editlimit="12"/>
                <Cell col="16" displaytype="number" edittype="masknumber" style="background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:novAmt" mask="###,###,##0" editlimit="12"/>
                <Cell col="17" displaytype="number" edittype="masknumber" style="background:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));background2:EXPR(decode(ds_plinvoiceList.getColumn(currow,&quot;chk&quot;), &quot;&quot;, &quot;#FAF4C0&quot;, &quot;&quot;));" text="bind:decAmt" mask="###,###,##0" editlimit="12"/>
              </Band>
              <Band id="summary">
                <Cell/>
                <Cell col="1" text="매출이익"/>
                <Cell col="2"/>
                <Cell col="3"/>
                <Cell col="4"/>
                <Cell col="5" displaytype="number" style="align:right;" text="expr:getCaseSum(&quot;acctNum =='412'&quot;,&quot;sumAmt&quot;) - getCaseSum(&quot;acctNum =='422'&quot;,&quot;sumAmt&quot;) - getCaseSum(&quot;acctNum =='431'&quot;,&quot;sumAmt&quot;) - getCaseSum(&quot;acctNum =='432'&quot;,&quot;sumAmt&quot;)"/>
                <Cell col="6" displaytype="number" text="expr:getCaseSum(&quot;acctNum =='412'&quot;,&quot;janAmt&quot;) - getCaseSum(&quot;acctNum =='422'&quot;,&quot;janAmt&quot;) - getCaseSum(&quot;acctNum =='431'&quot;,&quot;janAmt&quot;) - getCaseSum(&quot;acctNum =='432'&quot;,&quot;janAmt&quot;)"/>
                <Cell col="7" displaytype="number" text="expr:getCaseSum(&quot;acctNum =='412'&quot;,&quot;febAmt&quot;) - getCaseSum(&quot;acctNum =='422'&quot;,&quot;febAmt&quot;) - getCaseSum(&quot;acctNum =='431'&quot;,&quot;febAmt&quot;) - getCaseSum(&quot;acctNum =='432'&quot;,&quot;febAmt&quot;)"/>
                <Cell col="8" displaytype="number" text="expr:getCaseSum(&quot;acctNum =='412'&quot;,&quot;marAmt&quot;) - getCaseSum(&quot;acctNum =='422'&quot;,&quot;marAmt&quot;) - getCaseSum(&quot;acctNum =='431'&quot;,&quot;marAmt&quot;) - getCaseSum(&quot;acctNum =='432'&quot;,&quot;marAmt&quot;)"/>
                <Cell col="9" displaytype="number" text="expr:getCaseSum(&quot;acctNum =='412'&quot;,&quot;aprAmt&quot;) - getCaseSum(&quot;acctNum =='422'&quot;,&quot;aprAmt&quot;) - getCaseSum(&quot;acctNum =='431'&quot;,&quot;aprAmt&quot;) - getCaseSum(&quot;acctNum =='432'&quot;,&quot;aprAmt&quot;)"/>
                <Cell col="10" displaytype="number" text="expr:getCaseSum(&quot;acctNum =='412'&quot;,&quot;mayAmt&quot;) - getCaseSum(&quot;acctNum =='422'&quot;,&quot;mayAmt&quot;) - getCaseSum(&quot;acctNum =='431'&quot;,&quot;mayAmt&quot;) - getCaseSum(&quot;acctNum =='432'&quot;,&quot;mayAmt&quot;)"/>
                <Cell col="11" displaytype="number" text="expr:getCaseSum(&quot;acctNum =='412'&quot;,&quot;junAmt&quot;) - getCaseSum(&quot;acctNum =='422'&quot;,&quot;junAmt&quot;) - getCaseSum(&quot;acctNum =='431'&quot;,&quot;junAmt&quot;) - getCaseSum(&quot;acctNum =='432'&quot;,&quot;junAmt&quot;)"/>
                <Cell col="12" displaytype="number" text="expr:getCaseSum(&quot;acctNum =='412'&quot;,&quot;julAmt&quot;) - getCaseSum(&quot;acctNum =='422'&quot;,&quot;julAmt&quot;) - getCaseSum(&quot;acctNum =='431'&quot;,&quot;julAmt&quot;) - getCaseSum(&quot;acctNum =='432'&quot;,&quot;julAmt&quot;)"/>
                <Cell col="13" displaytype="number" text="expr:getCaseSum(&quot;acctNum =='412'&quot;,&quot;augAmt&quot;) - getCaseSum(&quot;acctNum =='422'&quot;,&quot;augAmt&quot;) - getCaseSum(&quot;acctNum =='431'&quot;,&quot;augAmt&quot;) - getCaseSum(&quot;acctNum =='432'&quot;,&quot;augAmt&quot;)"/>
                <Cell col="14" displaytype="number" text="expr:getCaseSum(&quot;acctNum =='412'&quot;,&quot;sepAmt&quot;) - getCaseSum(&quot;acctNum =='422'&quot;,&quot;sepAmt&quot;) - getCaseSum(&quot;acctNum =='431'&quot;,&quot;sepAmt&quot;) - getCaseSum(&quot;acctNum =='432'&quot;,&quot;sepAmt&quot;)"/>
                <Cell col="15" displaytype="number" text="expr:getCaseSum(&quot;acctNum =='412'&quot;,&quot;octAmt&quot;) - getCaseSum(&quot;acctNum =='422'&quot;,&quot;octAmt&quot;) - getCaseSum(&quot;acctNum =='431'&quot;,&quot;octAmt&quot;) - getCaseSum(&quot;acctNum =='432'&quot;,&quot;octAmt&quot;)"/>
                <Cell col="16" displaytype="number" text="expr:getCaseSum(&quot;acctNum =='412'&quot;,&quot;novAmt&quot;) - getCaseSum(&quot;acctNum =='422'&quot;,&quot;novAmt&quot;) - getCaseSum(&quot;acctNum =='431'&quot;,&quot;novAmt&quot;) - getCaseSum(&quot;acctNum =='432'&quot;,&quot;novAmt&quot;)"/>
                <Cell col="17" displaytype="number" text="expr:getCaseSum(&quot;acctNum =='412'&quot;,&quot;decAmt&quot;) - getCaseSum(&quot;acctNum =='422'&quot;,&quot;decAmt&quot;) - getCaseSum(&quot;acctNum =='431'&quot;,&quot;decAmt&quot;) - getCaseSum(&quot;acctNum =='432'&quot;,&quot;decAmt&quot;)"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static32" class="sta_WFDA_Labelbg" position="absolute 358 102 826 129"/>
        <Combo id="cbo_reptKind" taborder="86" value="S" innerdataset="@ds_kind" codecolumn="code" datacolumn="codeName" displayrowcount="10" position="absolute 606 105 740 126" index="0" text="수주추진보고서" anchor="default"/>
        <Static id="Static30" text="추정년도" class="sta_WFSA_label" position="absolute 368 106 429 127" anchor="default"/>
        <Calendar id="cal_searchYear" taborder="87" type="spin" dateformat="yyyy" editformat="yyyy" onkeydown="cal_date_onkeydown" position="absolute 436 105 534 125" anchor="default"/>
        <Static id="Static26" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 358 105 368 126" anchor="left top"/>
        <Static id="Static33" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 426 105 436 126" anchor="left top"/>
        <Static id="Static34" text="종류" class="sta_WFSA_label" position="absolute 564 106 600 127" anchor="default"/>
        <Static id="Static35" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 534 105 564 126" anchor="left top"/>
        <Static id="Static36" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 596 105 606 126" anchor="left top"/>
        <Button id="btn_excelUp" taborder="88" text="엑셀 업로드" onclick="fn_importExcel" class="btn_WF_Function" position="absolute 750 104 821 126" anchor="default"/>
        <Static id="Static37" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 740 105 750 126" anchor="left top"/>
        <Static id="Static10" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 370 129 1228 134" anchor="top right"/>
        <Button id="btn_searchDtl" taborder="89" text="조회" onclick="fn_searchPlinvoiceList" class="btn_WF_Function" position="absolute 829 104 890 126"/>
        <Static id="Static13" text="금액단위 : (원)" class="sta_WFSA_label" position="absolute 1126 114 1228 130"/>
        <Grid id="Grid00" taborder="90" useinputpanel="false" position="absolute 20 333 1196 460" binddataset="ds_search" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="muCd"/>
                <Cell col="1" disptype="normal" text="muNm"/>
                <Cell col="2" disptype="normal" text="tmCd"/>
                <Cell col="3" disptype="normal" text="tmNm"/>
                <Cell col="4" disptype="normal" text="maskAuth"/>
                <Cell col="5" disptype="normal" text="authLevel"/>
                <Cell col="6" disptype="normal" text="upjangCd"/>
                <Cell col="7" disptype="normal" text="upjangNm"/>
                <Cell col="8" disptype="normal" text="saupType"/>
                <Cell col="9" disptype="normal" text="objectCd"/>
                <Cell col="10" disptype="normal" text="objectNm"/>
                <Cell col="11" disptype="normal" text="contractEndFrom"/>
                <Cell col="12" disptype="normal" text="contractEndTo"/>
                <Cell col="13" disptype="normal" text="year"/>
                <Cell col="14" disptype="normal" text="proposalKind"/>
                <Cell col="15" disptype="normal" text="srchMuCd"/>
                <Cell col="16" disptype="normal" text="srchTmCd"/>
                <Cell col="17" disptype="normal" text="srchUpjangCd"/>
                <Cell col="18" disptype="normal" text="custUpjangCd"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:muCd"/>
                <Cell col="1" disptype="normal" text="bind:muNm"/>
                <Cell col="2" disptype="normal" text="bind:tmCd"/>
                <Cell col="3" disptype="normal" text="bind:tmNm"/>
                <Cell col="4" disptype="normal" text="bind:maskAuth"/>
                <Cell col="5" disptype="normal" text="bind:authLevel"/>
                <Cell col="6" disptype="normal" text="bind:upjangCd"/>
                <Cell col="7" disptype="normal" text="bind:upjangNm"/>
                <Cell col="8" disptype="normal" text="bind:saupType"/>
                <Cell col="9" disptype="normal" text="bind:objectCd"/>
                <Cell col="10" disptype="normal" text="bind:objectNm"/>
                <Cell col="11" disptype="normal" text="bind:contractEndFrom"/>
                <Cell col="12" disptype="normal" text="bind:contractEndTo"/>
                <Cell col="13" disptype="normal" text="bind:year"/>
                <Cell col="14" disptype="normal" text="bind:proposalKind"/>
                <Cell col="15" disptype="normal" text="bind:srchMuCd"/>
                <Cell col="16" disptype="normal" text="bind:srchTmCd"/>
                <Cell col="17" disptype="normal" text="bind:srchUpjangCd"/>
                <Cell col="18" disptype="normal" text="bind:custUpjangCd"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item11" compid="edt_searchObjectNm" propid="value" datasetid="ds_search" columnid="objectNm"/>
      <BindItem id="item85" compid="cbo_reptKind" propid="value" datasetid="ds_search" columnid="proposalKind"/>
      <BindItem id="item0" compid="cal_searchYear" propid="value" datasetid="ds_search" columnid="year"/>
    </Bind>
    <Objects>
      <Dataset id="ds_objectList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_objectList_onrowposchanged">
        <ColumnInfo>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="objectCd" type="STRING" size="256"/>
          <Column id="objectNm" type="STRING" size="256"/>
          <Column id="contractEndDate" type="STRING" size="256"/>
          <Column id="upjangCd" type="STRING" size="256"/>
          <Column id="upjangNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="tmNm" type="STRING" size="256"/>
          <Column id="maskAuth" type="STRING" size="256"/>
          <Column id="authLevel" type="STRING" size="256"/>
          <Column id="upjangCd" type="STRING" size="256"/>
          <Column id="upjangNm" type="STRING" size="256"/>
          <Column id="saupType" type="STRING" size="256"/>
          <Column id="objectCd" type="STRING" size="256"/>
          <Column id="objectNm" type="STRING" size="256"/>
          <Column id="contractEndFrom" type="STRING" size="256"/>
          <Column id="contractEndTo" type="STRING" size="256"/>
          <Column id="year" type="STRING" size="256"/>
          <Column id="proposalKind" type="STRING" size="256"/>
          <Column id="srchMuCd" type="STRING" size="256"/>
          <Column id="srchTmCd" type="STRING" size="256"/>
          <Column id="srchUpjangCd" type="STRING" size="256"/>
          <Column id="custUpjangCd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_accObjectUpjang" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_accObjectUpjang_onrowposchanged">
        <ColumnInfo>
          <Column id="objectCd" type="STRING" size="256"/>
          <Column id="upjangSeq" type="STRING" size="256"/>
          <Column id="upjangCd" type="STRING" size="256"/>
          <Column id="upjangNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_plinvoiceListValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="acctCd" type="STRING" size="256"/>
          <Column id="acctNm" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="acctCd">title:계정,required:true</Col>
            <Col id="acctNm">title:계정명,required:false</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_kind" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="codeName">수주추진보고서</Col>
            <Col id="code">S</Col>
          </Row>
          <Row>
            <Col id="code">O</Col>
            <Col id="codeName">운영품의서</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_plinvoiceList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="true">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="upjangCd" type="STRING" size="256"/>
          <Column id="objectCd" type="STRING" size="256"/>
          <Column id="year" type="STRING" size="256"/>
          <Column id="proposalKind" type="STRING" size="256"/>
          <Column id="acctClass" type="STRING" size="256"/>
          <Column id="acctNum" type="STRING" size="256"/>
          <Column id="acctCd" type="STRING" size="256"/>
          <Column id="acctNm" type="STRING" size="256"/>
          <Column id="janAmt" type="STRING" size="256"/>
          <Column id="febAmt" type="STRING" size="256"/>
          <Column id="marAmt" type="STRING" size="256"/>
          <Column id="aprAmt" type="STRING" size="256"/>
          <Column id="mayAmt" type="STRING" size="256"/>
          <Column id="junAmt" type="STRING" size="256"/>
          <Column id="julAmt" type="STRING" size="256"/>
          <Column id="augAmt" type="STRING" size="256"/>
          <Column id="sepAmt" type="STRING" size="256"/>
          <Column id="octAmt" type="STRING" size="256"/>
          <Column id="novAmt" type="STRING" size="256"/>
          <Column id="decAmt" type="STRING" size="256"/>
          <Column id="sumAmt" type="STRING" size="256"/>
          <Column id="sailoutAmt" type="STRING" size="256"/>
          <Column id="sailoutRate" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_plinvoiceListExcel" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="acctClass" type="STRING" size="256"/>
          <Column id="acctCd" type="STRING" size="256"/>
          <Column id="acctNm" type="STRING" size="256"/>
          <Column id="sailoutRate" type="STRING" size="256"/>
          <Column id="sumAmt" type="STRING" size="256"/>
          <Column id="janAmt" type="STRING" size="256"/>
          <Column id="febAmt" type="STRING" size="256"/>
          <Column id="marAmt" type="STRING" size="256"/>
          <Column id="aprAmt" type="STRING" size="256"/>
          <Column id="mayAmt" type="STRING" size="256"/>
          <Column id="junAmt" type="STRING" size="256"/>
          <Column id="julAmt" type="STRING" size="256"/>
          <Column id="augAmt" type="STRING" size="256"/>
          <Column id="sepAmt" type="STRING" size="256"/>
          <Column id="octAmt" type="STRING" size="256"/>
          <Column id="novAmt" type="STRING" size="256"/>
          <Column id="decAmt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : Template
  파 일 명 : Template.xfdl
  기    능 : Design 및 Script Template 

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2014.11.01   김윤기   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";


/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();
var fv_sYear = gfn_getYear(fv_sToday);
var fv_objectListColInfo; 		// ds_objectList 데이터셋 컬럼정보
var fv_accObjectUpjangColInfo;	// ds_accObjectUpjang 데이터셋 컬럼정보
var fv_plinvoiceListColInfo;	// ds_plinvoiceList 데이터셋 컬럼정보

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	ds_search.clearData();
	var nRow= ds_search.addRow();
	ds_search.setColumn(nRow, "muCd", g_Mu_Cd);
	ds_search.setColumn(nRow, "muNm", g_Mu_Nm);
	ds_search.setColumn(nRow, "tmCd", g_Tm_Cd);
	ds_search.setColumn(nRow, "tmNm", g_Tm_Nm);	
	ds_search.setColumn(nRow, "upjangCd", g_Upjang);
	ds_search.setColumn(nRow, "upjangNm", g_UpjangNm);
	ds_search.setColumn(nRow,"maskAuth", SCAuth.getMaskAuth(this));
	ds_search.setColumn(nRow, "authLevel", g_AuthLevel);
	ds_search.setColumn(nRow, "year", fv_sYear);
		
	edt_tmNm.applyAuthLevel(edt_muNm);
 //   edt_upjangNm.applyAuthLevel(edt_tmNm);
	
	cal_contractEndFrom.fn_initMonthCal(this, "", "", ds_search, "contractEndFrom");
	cal_contractEndTo.fn_initMonthCal(this, "", "", ds_search, "contractEndTo")
	//cal_contractEndFrom.fn_initMonthCal(this, "", "", ds_search, "contractEndFrom");
	//cal_contractEndTo.fn_initMonthCal(this, "", "", ds_search, "contractEndTo")
	cal_searchYear.value = fv_sYear;
	cbo_reptKind.index = 0;
	
	//trace("ds_search.getColumn(nRow, muNm) >> " + ds_search.getColumn(nRow, "muNm"));
	//trace("index of >> " + gfn_indexOf(ds_search.getColumn(nRow, "muNm"), "FC", 0));
	
	// 급식
	if(gfn_indexOf(ds_search.getColumn(nRow, "muNm"), "FS", 0) >= 0) {
		ds_search.setColumn(0, "saupType", "C");
	// 식재
	}else if(gfn_indexOf(ds_search.getColumn(nRow, "muNm"), "식재", 0) >= 0) {
		ds_search.setColumn(0, "saupType", "E");
	// 외식
	}else if(gfn_indexOf(ds_search.getColumn(nRow, "muNm"), "외식", 0) >= 0) {
		ds_search.setColumn(0, "saupType", "A");
	// FC 사업지원부, 종합전산TFT
	}else if((gfn_indexOf(ds_search.getColumn(nRow, "muNm"), "FC", 0) >= 0) || (gfn_indexOf(ds_search.getColumn(nRow, "tmNm"), "종합전산TFT", 0) >= 0)){
		ds_search.setColumn(0, "saupType", "C");
		grd_plinvoiceList.readonly = true;
		btn_excelUp.visible = false;
	}else{
		grd_objectList.visible = false;
		btn_excelUp.visible = false;
		grd_plinvoiceList.visible = false;
	}
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Close()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 단기 버튼 이벤트
 * 작  성  자   : 백정훈
 * 작성  일자   : 2015-04-03
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_Close()
{
	this.close();
}


/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*
 ******************************************************************************************
 * 함  수  명   : fn_search()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 물건목록  조회
 * 작  성  자   : 백정훈
 * 작성  일자   : 2015-04-03
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_search()
{
 	// v_ds_check 미사용시 변경사항 체크
		
	// 조회시 Validation Check
//	if (gfn_validCheck(ds_search, ds_searchValid, true) == false) return;
	
	if(gfn_isNull(ds_search.getColumn(0, "tmCd"))) {
		gfn_alert("팀이 누락되었습니다.");
 		return;
	}
	
	if (cal_contractEndFrom.text != "" || cal_contractEndTo.text != "") {	
		if (cal_contractEndFrom.text == "") {
			gfn_alert("계약만료 시작일은 필수입력 사항입니다", "A");	
			cal_contractEndFrom.setFocus();
			return false;
		}
		if (cal_contractEndTo.text == "") {
			gfn_alert("계약만료 종료일은 필수입력 사항입니다", "A");	
			cal_contractEndTo.setFocus();
			return false;
		}
	
		if (cal_contractEndFrom.text > cal_contractEndTo.text) {
			gfn_alert("msg.err.validator.date.great");	// 종료일이 시작일보다 빠릅니다.
			cal_contractEndFrom.setFocus();
			return false;
		}
	
	}

	fv_objectListColInfo= gfn_getDatasetInfo(ds_objectList);	
	ds_objectList.clearData();
		
    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_objectList);
	
	var strSvcID    = "search";
    var strURL      = "fs/fso/opProposal/selectObjectList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_objectList=ds_objectList";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = false;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{	
	if(ds_objectList.rowposition>=0 && ds_accObjectUpjang.rowposition>=0) {
// 		var addRw = ds_plinvoiceList.addRow();
// 		ds_plinvoiceList.setColumn(addRw, "muCd", ds_objectList.getColumn(ds_objectList.rowposition, "muCd"));
// 		ds_plinvoiceList.setColumn(addRw, "objectCd", ds_accObjectUpjang.getColumn(ds_accObjectUpjang.rowposition, "objectCd"));
// 		ds_plinvoiceList.setColumn(addRw, "year", ds_search.getColumn(0, "year"));
// 		ds_plinvoiceList.setColumn(addRw, "tmCd", ds_objectList.getColumn(ds_objectList.rowposition, "tmCd"));
// 		ds_plinvoiceList.setColumn(addRw, "upjangCd", ds_accObjectUpjang.getColumn(ds_accObjectUpjang.rowposition, "upjangCd"));
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{
//	ds_plinvoiceList.deleteRow(ds_plinvoiceList.rowposition);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
	// v_ds_check 미사용시 변경사항 체크
 	if(!gfn_dsIsUpdated(ds_plinvoiceList)) {
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}
	
	// 저장시 Validation Check	
	if (gfn_validCheck(ds_plinvoiceList, ds_plinvoiceListValid) == false)	return;
	
	if(gfn_isNull(ds_search.getColumn(0, "year"))) { 
		gfn_alert("추정년도는 필수 항목입니다.");
 		return;
	}else if(gfn_isNull(ds_search.getColumn(0, "proposalKind"))) {
		gfn_alert("종류는 필수 항목입니다.");
 		return;
	}
	
	for(var i=0; i<ds_plinvoiceList.rowcount; i++) {
		if(gfn_isNull(ds_plinvoiceList.getColumn(i, "muCd"))) { ds_plinvoiceList.setColumn(i, "muCd", ds_objectList.getColumn(ds_objectList.rowposition, "muCd")); }
		if(gfn_isNull(ds_plinvoiceList.getColumn(i, "tmCd"))) { ds_plinvoiceList.setColumn(i, "tmCd", ds_objectList.getColumn(ds_objectList.rowposition, "tmCd")); }
		if(gfn_isNull(ds_plinvoiceList.getColumn(i, "upjangCd"))) { ds_plinvoiceList.setColumn(i, "upjangCd", ds_objectList.getColumn(ds_objectList.rowposition, "upjangCd")); }
		if(gfn_isNull(ds_plinvoiceList.getColumn(i, "objectCd"))) { ds_plinvoiceList.setColumn(i, "objectCd", ds_objectList.getColumn(ds_objectList.rowposition, "objectCd")); }
		if(gfn_isNull(ds_plinvoiceList.getColumn(i, "year"))) { ds_plinvoiceList.setColumn(i, "year", cal_searchYear.value); }
		if(gfn_isNull(ds_plinvoiceList.getColumn(i, "proposalKind"))) { ds_plinvoiceList.setColumn(i, "proposalKind", cbo_reptKind.value); }
	}
	
    var strSvcID    = "save";
    var strURL      = "fs/fso/opProposal/savePlinvoiceList.xdo";
    var strInDs     = "ds_plinvoiceList=ds_plinvoiceList:U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
	
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
    if (nErrorCode < 0) {
		return;
    }
	
    switch(strSvcID)
    {
		case "search" :
            if(ds_objectList.getRowCount() == 0){ //서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				gfn_loadDatasetInfo (ds_objectList, fv_objectListColInfo);
				ds_plinvoiceList.clearData();
			}
            break;
            
        case "searchAccObjectUpjang" :
			if(ds_accObjectUpjang.getRowCount() == 0){ //서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				gfn_loadDatasetInfo (ds_accObjectUpjang, fv_accObjectUpjangColInfo);
			}
						
			ds_search.setColumn(0, "custUpjangCd", ds_accObjectUpjang.getColumn(ds_accObjectUpjang.rowposition, "upjangCd"));
			fn_searchPlinvoiceList();
			break;
        
        case "searchPlinvoiceList" :
			if(ds_plinvoiceList.getRowCount() == 0){ //서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				gfn_loadDatasetInfo (ds_plinvoiceList, fv_plinvoiceListColInfo);
			}
			
			// 급식, 외식, FC 사업지원부, 종합전산TFT
			if((gfn_indexOf(ds_search.getColumn(0, "muNm"), "FS", 0) >= 0)
				|| (gfn_indexOf(ds_search.getColumn(0, "muNm"), "외식", 0) >= 0)
				|| (gfn_indexOf(ds_search.getColumn(0, "muNm"), "FC", 0) >= 0) 
				|| (gfn_indexOf(ds_search.getColumn(0, "tmNm"), "종합전산TFT", 0) >= 0)) {
				ds_plinvoiceList.keystring = "G:acctNum";
			// 식재
			}else {
				ds_plinvoiceList.keystring = "";
			}
			
// 			for(var i=0; i<ds_plinvoiceList.rowcount; i++){
// 				if(ds_plinvoiceList.getColumn(i, "acctNum") == "412"){
// 					ds_plinvoiceList.setColumn(i, "acctClass", "");
// 				}
// 			}
			
			break;
        
        
        case "save" :
			gfn_alert("msg.save.success");	// 저장 되었습니다.
			fn_searchPlinvoiceList();
            break;
    }   
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*
 ******************************************************************************************
 * 함  수  명   : fn_searchAccOrderOpProposal()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 담당 마케터 조회
 * 작  성  자   : 백정훈
 * 작성  일자   : 2015-04-03
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_searchDetail() {
	
	fv_accObjectUpjangColInfo= gfn_getDatasetInfo(ds_accObjectUpjang);
	ds_accObjectUpjang.clearData();
	
//	gfn_clearSortMark(grd_accObjectUpjang);
	
	var strSvcID    = "searchAccObjectUpjang";
    var strURL      = "fs/fso/opProposal/selectAccObjectUpjang.xdo";
	var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_accObjectUpjang=ds_accObjectUpjang";    
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = false;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_searchAccOrderOpProposal()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 담당 마케터 조회
 * 작  성  자   : 백정훈
 * 작성  일자   : 2015-04-03
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_searchPlinvoiceList() {
	
	fv_plinvoiceListColInfo= gfn_getDatasetInfo(ds_plinvoiceList);
	ds_plinvoiceList.clearData();	
	gfn_clearSortMark(grd_plinvoiceList);
	
	var strSvcID    = "searchPlinvoiceList";
    var strURL      = "fs/fso/opProposal/selectPlinvoiceList.xdo";
	var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_plinvoiceList=ds_plinvoiceList";    
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
//MU가 변경될 때에 대한 이벤트
function fn_muItemChangedEvent(obj, evt)
{
    edt_tmNm.setTmCode("");	
	ds_search.setColumn(0, "muCd", edt_muNm.getMuCode());
	ds_search.setColumn(0, "muNm", edt_muNm.getMuName());
		
	// 급식
	if(gfn_indexOf(ds_search.getColumn(0, "muNm"), "FS", 0) >= 0) {
		ds_search.setColumn(0, "saupType", "C");
	// 식재
	}else if(gfn_indexOf(ds_search.getColumn(0, "muNm"), "식재", 0) >= 0) {
		ds_search.setColumn(0, "saupType", "E");	
	// 외식
	}else if(gfn_indexOf(ds_search.getColumn(0, "muNm"), "외식", 0) >= 0) {
		ds_search.setColumn(0, "saupType", "A");
	}else if((gfn_indexOf(ds_search.getColumn(0, "muNm"), "FC", 0) >= 0) || (gfn_indexOf(ds_search.getColumn(0, "tmNm"), "종합전산TFT", 0) >= 0)){
		ds_search.setColumn(0, "saupType", "C");
	}else{
		ds_search.setColumn(0, "saupType", "");
	}
}

//TM이 변경될 때에 대한 이벤트
function fn_tmChangedEvent(obj, data)
{
    ds_search.setColumn(0,"tmCd", edt_tmNm.getTmCode());
    ds_search.setColumn(0,"tmNm", edt_tmNm.getTmName());
    
    // 급식
	if(gfn_indexOf(ds_search.getColumn(0, "muNm"), "FS", 0) >= 0) {
		grd_plinvoiceList.readonly = false;
		btn_excelUp.visible = true;
	// 식재
	}else if(gfn_indexOf(ds_search.getColumn(0, "muNm"), "식재", 0) >= 0) {
		grd_plinvoiceList.readonly = false;
		btn_excelUp.visible = true;
	// 외식
	}else if(gfn_indexOf(ds_search.getColumn(0, "muNm"), "외식", 0) >= 0) {
		grd_plinvoiceList.readonly = false;
		btn_excelUp.visible = true;
	// FC 사업지원부, 종합전산TFT
	}else if((gfn_indexOf(ds_search.getColumn(0, "muNm"), "FC", 0) >= 0) || (gfn_indexOf(ds_search.getColumn(0, "tmNm"), "종합전산TFT", 0) >= 0)){
		grd_plinvoiceList.readonly = true;
		btn_excelUp.visible = false;
	}else{
		grd_objectList.visible = false;
		btn_excelUp.visible = false;
		grd_plinvoiceList.visible = false;
	}
}

/*
 ******************************************************************************************
 * 함  수  명   : ds_objectList_onrowposchanged()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 물건목록 row 변경시 이벤트
 * 작  성  자   : 백정훈
 * 작성  일자   : 2015-04-03
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function ds_objectList_onrowposchanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	if(e.newrow >=0) {
 		ds_search.setColumn(0, "srchMuCd", ds_objectList.getColumn(e.newrow, "muCd"));
 		ds_search.setColumn(0, "srchTmCd", ds_objectList.getColumn(e.newrow, "tmCd"));
 		ds_search.setColumn(0, "objectCd", ds_objectList.getColumn(e.newrow, "objectCd"));
 		ds_search.setColumn(0, "srchUpjangCd", ds_objectList.getColumn(e.newrow, "upjangCd"));
 		fn_searchPlinvoiceList();
//		fn_searchDetail();
	}
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_importExcel()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : Excel 업로드
 * 작  성  자   : 백정훈
 * 작성  일자   : 2015-04-03
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_importExcel(obj:Button,  e:ClickEventInfo)
{
	if(ds_objectList.rowcount<=0 || ds_objectList.rowposition < 0) {
		gfn_alert("물건관리카드 목록을 조회하여 주십시요.");
		return;
	}
	
	this.setWaitCursor(true);

	// 파일 선택
	var strFileName = gfn_excelFileDialog("LOAD", "EXCEL");

	if (strFileName.length == 0)
	{
		this.setWaitCursor(false);
		return;
	}
	
	/*********************************************************************************************
	** argument             : strFileName		파일명 (경로 포함)
	**                        strDsName			Import 대상 Dataset Name
	**                        nStartRow			Import 시작 행(사용된 Range 기준, 1 base)
	**						  bKeepColInfo		Dataset의 컬럼 정보를 유지할지 여부
	*********************************************************************************************/
	grd_plinvoiceList.binddataset = "";
	var rtn = gfn_importExcel(strFileName, "ds_plinvoiceListExcel", 2, true);
	
	this.setWaitCursor(false);
	
	var addRw = 0;
	var colcnt = ds_plinvoiceListExcel.getColCount();
	ds_plinvoiceList.clearData();
	for(var i=0; i<ds_plinvoiceListExcel.rowcount; i++) {
		addRw = ds_plinvoiceList.addRow();
		ds_plinvoiceList.setColumn(addRw, "muCd", ds_objectList.getColumn(ds_objectList.rowposition, "muCd"));
		ds_plinvoiceList.setColumn(addRw, "tmCd", ds_objectList.getColumn(ds_objectList.rowposition, "tmCd"));
		ds_plinvoiceList.setColumn(addRw, "upjangCd",ds_objectList.getColumn(ds_objectList.rowposition, "upjangCd")); 
		ds_plinvoiceList.setColumn(addRw, "objectCd", ds_objectList.getColumn(ds_objectList.rowposition, "objectCd"));
		ds_plinvoiceList.setColumn(addRw, "year", cal_searchYear.value);
		ds_plinvoiceList.setColumn(addRw, "proposalKind", cbo_reptKind.value);
		for(var j=0; j<colcnt; j++) {
			ds_plinvoiceList.setColumn(addRw, ds_plinvoiceListExcel.getColID(j),ds_plinvoiceListExcel.getColumn(i, j));
			if(ds_plinvoiceListExcel.getColumn(i, 1) == "매출이익"){
				ds_plinvoiceList.deleteRow(i);
			}
		}
	}
	grd_plinvoiceList.binddataset = "ds_plinvoiceList";
	ds_plinvoiceList.rowposition = 0;
}

function grd_plinvoiceList_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	//지우지마셈
	if(e.col == 0){
		gfn_exportExcel(obj);
	}
}
]]></Script>
  </Form>
</FDL>

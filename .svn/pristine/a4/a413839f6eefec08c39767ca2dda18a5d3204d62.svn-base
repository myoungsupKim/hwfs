<%
/*-----------------------------------------------------------------------------
■ 시스템명     : 경영관리/손익실적
■ 프로그램ID   : MAS40080E_S001.jsp
■ 프로그램명   : 손익(사업부)조회
■ 작성일자     : 2014-04-16
■ 작성자       : 김장욱
■ 이력관리     : 
-----------------------------------------------------------------------------*/
%>

<%@ page contentType="text/html; charset=EUC-KR" %>
<%@ include file = "../../sc/main/common.jsp" %>
<%
	try	{
		PlatformRequest platformRequest = this.proc_input(request);
		in_vl = platformRequest.getData().getVariableList();
		in_dl = platformRequest.getData().getDataSetList();

		//jsp log 서비스 시작 
		logger.startIndividualLog(in_vl.getString("titLogId"));		

		//입력 데이타
		DataSet ds_Cond     = in_dl.get("ds_Cond");
		//입력 파라메터
		String g_Upjang     = nullToBlank(in_vl.getString("g_Upjang"));
		String g_EmpNo      = nullToBlank(in_vl.getString("g_EmpNo"));
		
		//FileLog.println("d:\\aaa.txt", ds_Cond);
		
		//System.out.println("g_Upjang-------------------" + g_Upjang);

		//out 데이타
		DataSet ds_List;
		//sql문 버퍼생성
		StringBuffer sbSql = new StringBuffer();
		
		//System.out.println("======================================> : " + ds_Cond.getString(0, "DIV"));
		
		
		
        sbSql.append("                SELECT DECODE(COUNT(*), 0, 'UPJANG', 'MARKETER') GUBUN                                          \n");
        sbSql.append("                  FROM SCO_FS_HR_PERSONAL_V V                                                                   \n");
        sbSql.append("                 WHERE 1 = 1                                                                                    \n");
        sbSql.append("                   AND EXISTS (SELECT 1 FROM SCC_COMMON_CODE WHERE CODE = V.DEPT_ID AND GROUP_CODE = 'MA1002' AND SET1 = 'FICS') \n");
        sbSql.append("                   AND TM_CD IN (                                                                               \n");
        sbSql.append("                                 SELECT TM_CD                                                                   \n");
        sbSql.append("                                   FROM SCO_UPJANG_MST_V                                                        \n");
        sbSql.append("                                  WHERE TM_CD IN (                                                              \n");
        sbSql.append("                                                  SELECT A.TM_CD                                                \n");
        sbSql.append("                                                    FROM MAS_DUALUPJANG_MGMT V,                                 \n");
        sbSql.append("                                                         SCO_UPJANG_MST_V A                                     \n");
        sbSql.append("                                                   WHERE V.UPJANG   = A.UPJANG                                  \n");
        sbSql.append("                                                     AND V.SABUN    = '" + g_EmpNo + "' /* 파라미터 */                \n");
        sbSql.append("                                                     AND V.USE_YN   = 'Y'                                       \n");
        sbSql.append("                                                   UNION                                                        \n");
        sbSql.append("                                                  SELECT A.TM_CD                                                \n");
        sbSql.append("                                                    FROM SCC_USERINFO V,                                        \n");
        sbSql.append("                                                         SCO_UPJANG_MST_V A                                     \n");
        sbSql.append("                                                   WHERE V.UPJANG = A.UPJANG                                    \n");
        sbSql.append("                                                     AND V.SABUN    = '" + g_EmpNo + "' /* 파라미터 */                \n");
        sbSql.append("                                                 )                                                              \n");
        sbSql.append("                                    AND CLOSE_DATE IS NULL                                                      \n");
        sbSql.append("                                )                                                                               \n");
        
        //out_vl.add("fa_Sql", sbSql.toString());
		//System.out.println(sbSql.toString());
		pstmt = conn.prepareStatement(sbSql.toString());		
		rs = pstmt.executeQuery(); 
		rs.next();
		String strGUBUN = rs.getString("GUBUN");
		rs.close();
		pstmt.close();
		
		// 변수 초기화
		sbSql.delete(0, sbSql.length());
		
		// 점장들의 실적
		if(strGUBUN.equals("UPJANG")){ 
			// 재무단가
			if(ds_Cond.getString(0, "STYPE").equals("U")){
	
		        sbSql.append("/* 사업부별 손익조회 쿼리(매출액) */                                                                                                                                                                                                                                                                       \n");
		        sbSql.append("WITH UPJANG AS (                                                                                                                                                                                                                                                                                           \n");
		        sbSql.append("                SELECT TM_CD                                                                                                                                                                                                                                                                               \n");
		        sbSql.append("                     , TM_NM                                                                                                                                                                                                                                                                               \n");
		        sbSql.append("                     , UPJANG                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                     , UPJANGNM                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                  FROM SCO_UPJANG_MST_V                                                                                                                                                                                                                                                                    \n");
		        sbSql.append("                 WHERE TM_CD IN (                                                                                                                                                                                                                                                                          \n");
		        sbSql.append("                                 SELECT A.TM_CD                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                                   FROM MAS_DUALUPJANG_MGMT V,                                                                                                                                                                                                                                             \n");
		        sbSql.append("                                        SCO_UPJANG_MST_V A                                                                                                                                                                                                                                                 \n");
		        sbSql.append("                                  WHERE V.UPJANG   = A.UPJANG                                                                                                                                                                                                                                              \n");
		        sbSql.append("                                    AND   V.SABUN    = '" + g_EmpNo + "' /* 파라미터 */                                                                                                                                                                                                                          \n");
		        sbSql.append("                                    AND   V.USE_YN   = 'Y'                                                                                                                                                                                                                                                 \n");
		        sbSql.append("                                 UNION                                                                                                                                                                                                                                                                     \n");
		        sbSql.append("                                 SELECT A.TM_CD                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                                   FROM SCC_USERINFO V,                                                                                                                                                                                                                                                    \n");
		        sbSql.append("                                        SCO_UPJANG_MST_V A                                                                                                                                                                                                                                                 \n");
		        sbSql.append("                                  WHERE V.UPJANG = A.UPJANG                                                                                                                                                                                                                                                \n");
		        sbSql.append("                                    AND   V.SABUN    = '" + g_EmpNo + "' /* 파라미터 */                                                                                                                                                                                                                          \n");
		        sbSql.append("                                )                                                                                                                                                                                                                                                                          \n");
		        sbSql.append("                   AND CLOSE_DATE IS NULL                                                                                                                                                                                                                                                                  \n");
		        sbSql.append("               ) /* 소팀장 관리 업장List */                                                                                                                                                                                                                                                                \n");
		        sbSql.append("SELECT AA.GUBUN                                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("     , AA.INPUT_YM                                                                                                                                                                                                                                                                                         \n");
		        sbSql.append("     , AA.TM_CD                                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("     , AA.TM_NM                                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("     , SUM(AA.AMT1) AS AMT1 /* 기본계획 */                                                                                                                                                                                                                                                                 \n");
		        sbSql.append("     , SUM(AA.AMT2) AS AMT2 /* 요망진도 */                                                                                                                                                                                                                                                                 \n");
		        sbSql.append("     , SUM(AA.AMT3) AS AMT3 /* 추정 */                                                                                                                                                                                                                                                                     \n");
		        sbSql.append("     , SUM(AA.AMT4) AS AMT4 /* 월추정 */                                                                                                                                                                                                                                                                   \n");
		        sbSql.append("     , SUM(AA.AMT5) AS AMT5 /* 전년실적 */                                                                                                                                                                                                                                                                 \n");
		        sbSql.append("  FROM (                                                                                                                                                                                                                                                                                                   \n");
		        sbSql.append("        SELECT '매출액' GUBUN                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("             , B.INPUT_YM                                                                                                                                                                                                                                                                                  \n");
		        sbSql.append("             , C.TM_CD                                                                                                                                                                                                                                                                                     \n");
		        sbSql.append("             , C.TM_NM                                                                                                                                                                                                                                                                                     \n");
		        sbSql.append("             , SUM(CASE WHEN B.DOC_GUBUN = 'P' THEN                                                                                                                                                                                                                                                        \n");
		        sbSql.append("                      B.ACT_AMT                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                   ELSE                                                                                                                                                                                                                                                                                    \n");
		        sbSql.append("                      0                                                                                                                                                                                                                                                                                    \n");
		        sbSql.append("                   END) AMT1 /* 매출_기본계획 */                                                                                                                                                                                                                                                           \n");
		        sbSql.append("             , SUM(CASE WHEN B.DOC_GUBUN = 'P' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                                                                                                                                                   \n");
		        sbSql.append("                      B.ACT_AMT                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                   ELSE                                                                                                                                                                                                                                                                                    \n");
		        sbSql.append("                      0                                                                                                                                                                                                                                                                                    \n");
		        sbSql.append("                   END) AMT2 /* 매출_요망진도 */                                                                                                                                                                                                                                                           \n");
		        sbSql.append("             , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                                                                                                                                                   \n");
		        sbSql.append("                      B.ACT_AMT                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                   ELSE                                                                                                                                                                                                                                                                                    \n");
		        sbSql.append("                      0                                                                                                                                                                                                                                                                                    \n");
		        sbSql.append("                   END) AMT3 /* 매출_추정 */                                                                                                                                                                                                                                                               \n");
		        sbSql.append("             , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '00' THEN/* 파라미터 */                                                                                                                                                                                        \n");
		        sbSql.append("                      B.ACT_AMT                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                   ELSE                                                                                                                                                                                                                                                                                    \n");
		        sbSql.append("                      0                                                                                                                                                                                                                                                                                    \n");
		        sbSql.append("                   END) AMT4 /* 매출_월추정 */                                                                                                                                                                                                                                                             \n");
		        sbSql.append("             , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6), 'YYYYMM'), -12), 'YYYYMM') || '00' THEN/* 파라미터 */                                                                                                                                 \n");
		        sbSql.append("                      B.ACT_AMT                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                   ELSE                                                                                                                                                                                                                                                                                    \n");
		        sbSql.append("                      0                                                                                                                                                                                                                                                                                    \n");
		        sbSql.append("                   END) AMT5 /* 매출_전년실적 */                                                                                                                                                                                                                                                           \n");
		        sbSql.append("          FROM MAC_MGMT_ACCT       A                                                                                                                                                                                                                                                                       \n");
		        sbSql.append("             , MAS_DAILY_PL_REPORT B                                                                                                                                                                                                                                                                       \n");
		        sbSql.append("             , UPJANG              C                                                                                                                                                                                                                                                                       \n");
		        sbSql.append("         WHERE A.MGMT_ACCT_CD = B.MGMT_ACCT_CD                                                                                                                                                                                                                                                             \n");
		        sbSql.append("           AND B.INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6)/* 파라미터 */                                                                                                                                                                                                                                         \n");
		        sbSql.append("           AND B.DOC_CD = C.UPJANG                                                                                                                                                                                                                                                                         \n");
		        sbSql.append("           AND A.ACCT_TYPE = 'WP'                                                                                                                                                                                                                                                                          \n");
		        sbSql.append("           AND A.USE_YN = 'Y'                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("           AND A.ATTR02 = '매출액'                                                                                                                                                                                                                                                                         \n");
		        sbSql.append("         GROUP BY B.INPUT_YM, C.TM_CD, C.TM_NM, A.MGMT_ACCT_CD                                                                                                                                                                                                                                             \n");
		        sbSql.append("        UNION ALL                                                                                                                                                                                                                                                                                          \n");
		        sbSql.append("        /* 사업부별 손익조회 쿼리(매출원가) */                                                                                                                                                                                                                                                             \n");
		        sbSql.append("        SELECT '매출원가'                                                                                                                                                                                                                                                                                  \n");
		        sbSql.append("             , B.INPUT_YM                                                                                                                                                                                                                                                                                  \n");
		        sbSql.append("             , DECODE(A.MGMT_ACCT_CD, 'PLB20100', 'PLB20000' /*식음료원가*/, 'PLB20200', 'PLB20000'/*상품원가*/, 'PLB20300', 'PLB20000'/*매점원가*/, 'PLB20400', 'PLB20000'/*외식원가*/, 'PLB30000', 'PLB30000', 'PLB40000', 'PLB40000') MGMT_ACCT_CD /* GROUP BY 하기위해 재료비의 하위계저을 재료비계정으로 치환 */ \n");
		        sbSql.append("             , DECODE(A.MGMT_ACCT_CD, 'PLB20100', '재료비' /*식음료원가*/, 'PLB20200', '재료비'/*상품원가*/, 'PLB20300', '재료비'/*매점원가*/, 'PLB20400', '재료비'/*외식원가*/, 'PLB30000', '노무비', 'PLB40000', '경비') MGMT_ACCT_NM                                                                    \n");
		        sbSql.append("             , ROUND(SUM(CASE WHEN B.DOC_GUBUN = 'P' THEN                                                                                                                                                                                                                                                  \n");
		        sbSql.append("                             CASE WHEN A.ATTR03 = 'Y' THEN /* 출하율 적용계정(식음료원가) */                                                                                                                                                                                                               \n");
		        sbSql.append("                                 B.ACT_AMT/NVL((SELECT DECODE(M_RATE, 0, 100, M_RATE)  FROM MAS_UPJANG_M_RATE_MGMT WHERE INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) AND DOC_CD = B.DOC_CD AND GUBUN = 'P'), 100)*100                                                                                              \n");
		        sbSql.append("                             ELSE                                                                                                                                                                                                                                                                          \n");
		        sbSql.append("                                 B.ACT_AMT                                                                                                                                                                                                                                                                 \n");
		        sbSql.append("                             END                                                                                                                                                                                                                                                                           \n");
		        sbSql.append("                         ELSE                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                            0                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                         END), 0) AMT1 /* 매출원가_기본계획 */                                                                                                                                                                                                                                             \n");
		        sbSql.append("             , ROUND(SUM(CASE WHEN B.DOC_GUBUN = 'P' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                                                                                                                                             \n");
		        sbSql.append("                             CASE WHEN A.ATTR03 = 'Y' THEN /* 출하율 적용계정(식음료원가) */                                                                                                                                                                                                               \n");
		        sbSql.append("                                 B.ACT_AMT/NVL((SELECT DECODE(M_RATE, 0, 100, M_RATE)  FROM MAS_UPJANG_M_RATE_MGMT WHERE INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) AND DOC_CD = B.DOC_CD AND GUBUN = 'P'), 100)*100                                                                                              \n");
		        sbSql.append("                             ELSE                                                                                                                                                                                                                                                                          \n");
		        sbSql.append("                                 B.ACT_AMT                                                                                                                                                                                                                                                                 \n");
		        sbSql.append("                             END                                                                                                                                                                                                                                                                           \n");
		        sbSql.append("                         ELSE                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                            0                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                         END), 0) AMT2 /* 매출원가_요망진도 */                                                                                                                                                                                                                                             \n");
		        sbSql.append("             , ROUND(SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                                                                                                                                             \n");
		        sbSql.append("                             CASE WHEN A.ATTR03 = 'Y' THEN /* 출하율 적용계정(식음료원가) */                                                                                                                                                                                                               \n");
		        sbSql.append("                                 B.ACT_AMT/NVL((SELECT DECODE(M_RATE, 0, 100, M_RATE)  FROM MAS_UPJANG_M_RATE_MGMT WHERE INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) AND DOC_CD = B.DOC_CD AND GUBUN = 'R'), 100)*100                                                                                              \n");
		        sbSql.append("                             ELSE                                                                                                                                                                                                                                                                          \n");
		        sbSql.append("                                 B.ACT_AMT                                                                                                                                                                                                                                                                 \n");
		        sbSql.append("                             END                                                                                                                                                                                                                                                                           \n");
		        sbSql.append("                         ELSE                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                            0                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                         END), 0) AMT3 /* 매출원가_추정 */                                                                                                                                                                                                                                                 \n");
		        sbSql.append("             , ROUND(SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '00' THEN/* 파라미터 */                                                                                                                                                                                  \n");
		        sbSql.append("                             CASE WHEN A.ATTR03 = 'Y' THEN /* 출하율 적용계정(식음료원가) */                                                                                                                                                                                                               \n");
		        sbSql.append("                                 B.ACT_AMT/NVL((SELECT DECODE(M_RATE, 0, 100, M_RATE)  FROM MAS_UPJANG_M_RATE_MGMT WHERE INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) AND DOC_CD = B.DOC_CD AND GUBUN = 'R'), 100)*100                                                                                              \n");
		        sbSql.append("                             ELSE                                                                                                                                                                                                                                                                          \n");
		        sbSql.append("                                 B.ACT_AMT                                                                                                                                                                                                                                                                 \n");
		        sbSql.append("                             END                                                                                                                                                                                                                                                                           \n");
		        sbSql.append("                         ELSE                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                            0                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                         END), 0) AMT4 /* 매출원가_월추정 */                                                                                                                                                                                                                                               \n");
		        sbSql.append("             , ROUND(SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6), 'YYYYMM'), -12), 'YYYYMM') || '00' THEN/* 파라미터 */                                                                                                                           \n");
		        sbSql.append("                             CASE WHEN A.ATTR03 = 'Y' THEN /* 출하율 적용계정(식음료원가) */                                                                                                                                                                                                               \n");
		        sbSql.append("                                 B.ACT_AMT/NVL((SELECT DECODE(M_RATE, 0, 100, M_RATE)  FROM MAS_UPJANG_M_RATE_MGMT WHERE INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) AND DOC_CD = B.DOC_CD AND GUBUN = 'R'), 100)*100                                                                                              \n");
		        sbSql.append("                             ELSE                                                                                                                                                                                                                                                                          \n");
		        sbSql.append("                                 B.ACT_AMT                                                                                                                                                                                                                                                                 \n");
		        sbSql.append("                             END                                                                                                                                                                                                                                                                           \n");
		        sbSql.append("                         ELSE                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                            0                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                         END), 0) AMT5 /* 매출원가_전년실적 */                                                                                                                                                                                                                                             \n");
		        sbSql.append("          FROM MAC_MGMT_ACCT       A                                                                                                                                                                                                                                                                       \n");
		        sbSql.append("             , MAS_DAILY_PL_REPORT B                                                                                                                                                                                                                                                                       \n");
		        sbSql.append("             , UPJANG              C                                                                                                                                                                                                                                                                       \n");
		        sbSql.append("         WHERE A.MGMT_ACCT_CD = B.MGMT_ACCT_CD                                                                                                                                                                                                                                                             \n");
		        sbSql.append("           AND B.INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6)/* 파라미터 */                                                                                                                                                                                                                                         \n");
		        sbSql.append("           AND B.DOC_CD = C.UPJANG                                                                                                                                                                                                                                                                         \n");
		        sbSql.append("           AND A.ACCT_TYPE = 'WP'                                                                                                                                                                                                                                                                          \n");
		        sbSql.append("           AND A.USE_YN = 'Y'                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("           AND A.MGMT_ACCT_CD IN ('PLB20100', 'PLB20200', 'PLB20300', 'PLB20400', 'PLB30000', 'PLB40000') /* 재료비(식음료원가(PLB20100), 상품원가(PLB20200), 매점원가(PLB20300), 외식원가(PLB20400)), 노무비(PLB30000), 경비(PLB40000) */                                                                 \n");
		        sbSql.append("         GROUP BY B.INPUT_YM, A.MGMT_ACCT_CD                                                                                                                                                                                                                                                               \n");
		        sbSql.append("        UNION ALL                                                                                                                                                                                                                                                                                          \n");
		        sbSql.append("        /* 사업부별 손익조회 쿼리(매출이익) : 사업부별 매출액과 매출원가를 다시 구해서 매출이익을 계산한다. */                                                                                                                                                                                             \n");
		        sbSql.append("        SELECT '매출이익' GUBUN                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("             , A10.INPUT_YM                                                                                                                                                                                                                                                                                \n");
		        sbSql.append("             , A10.TM_CD                                                                                                                                                                                                                                                                                   \n");
		        sbSql.append("             , A10.TM_NM                                                                                                                                                                                                                                                                                   \n");
		        sbSql.append("             , SUM(A10.AMT1) - SUM(A10.AMT6) AMT1  /* 기본계획 : 매출액 - 매출원가 */                                                                                                                                                                                                                      \n");
		        sbSql.append("             , SUM(A10.AMT2) - SUM(A10.AMT7) AMT2  /* 요망진도 : 매출액 - 매출원가 */                                                                                                                                                                                                                      \n");
		        sbSql.append("             , SUM(A10.AMT3) - SUM(A10.AMT8) AMT3  /* 추정     : 매출액 - 매출원가 */                                                                                                                                                                                                                      \n");
		        sbSql.append("             , SUM(A10.AMT4) - SUM(A10.AMT9) AMT4  /* 월추정   : 매출액 - 매출원가 */                                                                                                                                                                                                                      \n");
		        sbSql.append("             , SUM(A10.AMT5) - SUM(A10.AMT10) AMT5 /* 전년실적 : 매출액 - 매출원가 */                                                                                                                                                                                                                      \n");
		        sbSql.append("          FROM (                                                                                                                                                                                                                                                                                           \n");
		        sbSql.append("                SELECT '매출액' GUBUN                                                                                                                                                                                                                                                                      \n");
		        sbSql.append("                     , B.INPUT_YM                                                                                                                                                                                                                                                                          \n");
		        sbSql.append("                     , C.TM_CD                                                                                                                                                                                                                                                                             \n");
		        sbSql.append("                     , C.TM_NM                                                                                                                                                                                                                                                                             \n");
		        sbSql.append("                     , SUM(CASE WHEN B.DOC_GUBUN = 'P' THEN                                                                                                                                                                                                                                                \n");
		        sbSql.append("                              B.ACT_AMT                                                                                                                                                                                                                                                                    \n");
		        sbSql.append("                           ELSE                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                              0                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                           END) AMT1 /* 매출_기본계획 */                                                                                                                                                                                                                                                   \n");
		        sbSql.append("                     , SUM(CASE WHEN B.DOC_GUBUN = 'P' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                                                                                                                                           \n");
		        sbSql.append("                              B.ACT_AMT                                                                                                                                                                                                                                                                    \n");
		        sbSql.append("                           ELSE                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                              0                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                           END) AMT2 /* 매출_요망진도 */                                                                                                                                                                                                                                                   \n");
		        sbSql.append("                     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                                                                                                                                           \n");
		        sbSql.append("                              B.ACT_AMT                                                                                                                                                                                                                                                                    \n");
		        sbSql.append("                           ELSE                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                              0                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                           END) AMT3 /* 매출_추정 */                                                                                                                                                                                                                                                       \n");
		        sbSql.append("                     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '00' THEN/* 파라미터 */                                                                                                                                                                                \n");
		        sbSql.append("                              B.ACT_AMT                                                                                                                                                                                                                                                                    \n");
		        sbSql.append("                           ELSE                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                              0                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                           END) AMT4 /* 매출_월추정 */                                                                                                                                                                                                                                                     \n");
		        sbSql.append("                     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6), 'YYYYMM'), -12), 'YYYYMM') || '00' THEN/* 파라미터 */                                                                                                                         \n");
		        sbSql.append("                              B.ACT_AMT                                                                                                                                                                                                                                                                    \n");
		        sbSql.append("                           ELSE                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                              0                                                                                                                                                                                                                                                                            \n");
		        sbSql.append("                           END) AMT5 /* 매출_전년실적 */                                                                                                                                                                                                                                                   \n");
		        sbSql.append("                     , 0 AMT6                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                     , 0 AMT7                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                     , 0 AMT8                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                     , 0 AMT9                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                     , 0 AMT10                                                                                                                                                                                                                                                                             \n");
		        sbSql.append("                  FROM MAC_MGMT_ACCT       A                                                                                                                                                                                                                                                               \n");
		        sbSql.append("                     , MAS_DAILY_PL_REPORT B                                                                                                                                                                                                                                                               \n");
		        sbSql.append("                     , UPJANG              C                                                                                                                                                                                                                                                               \n");
		        sbSql.append("                 WHERE A.MGMT_ACCT_CD = B.MGMT_ACCT_CD                                                                                                                                                                                                                                                     \n");
		        sbSql.append("                   AND B.INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6)/* 파라미터 */                                                                                                                                                                                                                                 \n");
		        sbSql.append("                   AND B.DOC_CD = C.UPJANG                                                                                                                                                                                                                                                                 \n");
		        sbSql.append("                   AND A.ACCT_TYPE = 'WP'                                                                                                                                                                                                                                                                  \n");
		        sbSql.append("                   AND A.USE_YN = 'Y'                                                                                                                                                                                                                                                                      \n");
		        sbSql.append("                   AND A.ATTR02 = '매출액'                                                                                                                                                                                                                                                                 \n");
		        sbSql.append("                 GROUP BY B.INPUT_YM, C.TM_CD, C.TM_NM, A.MGMT_ACCT_CD                                                                                                                                                                                                                                     \n");
		        sbSql.append("                UNION ALL                                                                                                                                                                                                                                                                                  \n");
		        sbSql.append("                /* 사업부별 손익조회 쿼리(매출원가) */                                                                                                                                                                                                                                                     \n");
		        sbSql.append("                SELECT '매출원가'                                                                                                                                                                                                                                                                          \n");
		        sbSql.append("                     , B.INPUT_YM                                                                                                                                                                                                                                                                          \n");
		        sbSql.append("                     , C.TM_CD                                                                                                                                                                                                                                                                             \n");
		        sbSql.append("                     , C.TM_NM                                                                                                                                                                                                                                                                             \n");
		        sbSql.append("                     , 0 AMT1                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                     , 0 AMT2                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                     , 0 AMT3                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                     , 0 AMT4                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                     , 0 AMT5                                                                                                                                                                                                                                                                              \n");
		        sbSql.append("                     , ROUND(SUM(CASE WHEN B.DOC_GUBUN = 'P' THEN                                                                                                                                                                                                                                          \n");
		        sbSql.append("                                     CASE WHEN A.ATTR03 = 'Y' THEN /* 출하율 적용계정(식음료원가) */                                                                                                                                                                                                       \n");
		        sbSql.append("                                         B.ACT_AMT/NVL((SELECT DECODE(M_RATE, 0, 100, M_RATE)  FROM MAS_UPJANG_M_RATE_MGMT WHERE INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) AND DOC_CD = B.DOC_CD AND GUBUN = 'P'), 100)*100                                                                                      \n");
		        sbSql.append("                                     ELSE                                                                                                                                                                                                                                                                  \n");
		        sbSql.append("                                         B.ACT_AMT                                                                                                                                                                                                                                                         \n");
		        sbSql.append("                                     END                                                                                                                                                                                                                                                                   \n");
		        sbSql.append("                                 ELSE                                                                                                                                                                                                                                                                      \n");
		        sbSql.append("                                    0                                                                                                                                                                                                                                                                      \n");
		        sbSql.append("                                 END), 0) AMT6 /* 매출원가_기본계획 */                                                                                                                                                                                                                                     \n");
		        sbSql.append("                     , ROUND(SUM(CASE WHEN B.DOC_GUBUN = 'P' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                                                                                                                                     \n");
		        sbSql.append("                                     CASE WHEN A.ATTR03 = 'Y' THEN /* 출하율 적용계정(식음료원가) */                                                                                                                                                                                                       \n");
		        sbSql.append("                                         B.ACT_AMT/NVL((SELECT DECODE(M_RATE, 0, 100, M_RATE)  FROM MAS_UPJANG_M_RATE_MGMT WHERE INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) AND DOC_CD = B.DOC_CD AND GUBUN = 'P'), 100)*100                                                                                      \n");
		        sbSql.append("                                     ELSE                                                                                                                                                                                                                                                                  \n");
		        sbSql.append("                                         B.ACT_AMT                                                                                                                                                                                                                                                         \n");
		        sbSql.append("                                     END                                                                                                                                                                                                                                                                   \n");
		        sbSql.append("                                 ELSE                                                                                                                                                                                                                                                                      \n");
		        sbSql.append("                                    0                                                                                                                                                                                                                                                                      \n");
		        sbSql.append("                                 END), 0) AMT7 /* 매출원가_요망진도 */                                                                                                                                                                                                                                     \n");
		        sbSql.append("                     , ROUND(SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                                                                                                                                     \n");
		        sbSql.append("                                     CASE WHEN A.ATTR03 = 'Y' THEN /* 출하율 적용계정(식음료원가) */                                                                                                                                                                                                       \n");
		        sbSql.append("                                         B.ACT_AMT/NVL((SELECT DECODE(M_RATE, 0, 100, M_RATE)  FROM MAS_UPJANG_M_RATE_MGMT WHERE INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) AND DOC_CD = B.DOC_CD AND GUBUN = 'R'), 100)*100                                                                                      \n");
		        sbSql.append("                                     ELSE                                                                                                                                                                                                                                                                  \n");
		        sbSql.append("                                         B.ACT_AMT                                                                                                                                                                                                                                                         \n");
		        sbSql.append("                                     END                                                                                                                                                                                                                                                                   \n");
		        sbSql.append("                                 ELSE                                                                                                                                                                                                                                                                      \n");
		        sbSql.append("                                    0                                                                                                                                                                                                                                                                      \n");
		        sbSql.append("                                 END), 0) AMT8 /* 매출원가_추정 */                                                                                                                                                                                                                                         \n");
		        sbSql.append("                     , ROUND(SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '00' THEN/* 파라미터 */                                                                                                                                                                          \n");
		        sbSql.append("                                     CASE WHEN A.ATTR03 = 'Y' THEN /* 출하율 적용계정(식음료원가) */                                                                                                                                                                                                       \n");
		        sbSql.append("                                         B.ACT_AMT/NVL((SELECT DECODE(M_RATE, 0, 100, M_RATE)  FROM MAS_UPJANG_M_RATE_MGMT WHERE INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) AND DOC_CD = B.DOC_CD AND GUBUN = 'R'), 100)*100                                                                                      \n");
		        sbSql.append("                                     ELSE                                                                                                                                                                                                                                                                  \n");
		        sbSql.append("                                         B.ACT_AMT                                                                                                                                                                                                                                                         \n");
		        sbSql.append("                                     END                                                                                                                                                                                                                                                                   \n");
		        sbSql.append("                                 ELSE                                                                                                                                                                                                                                                                      \n");
		        sbSql.append("                                    0                                                                                                                                                                                                                                                                      \n");
		        sbSql.append("                                 END), 0) AMT9 /* 매출원가_월추정 */                                                                                                                                                                                                                                       \n");
		        sbSql.append("                     , ROUND(SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6), 'YYYYMM'), -12), 'YYYYMM') || '00' THEN/* 파라미터 */                                                                                                                   \n");
		        sbSql.append("                                     CASE WHEN A.ATTR03 = 'Y' THEN /* 출하율 적용계정(식음료원가) */                                                                                                                                                                                                       \n");
		        sbSql.append("                                         B.ACT_AMT/NVL((SELECT DECODE(M_RATE, 0, 100, M_RATE)  FROM MAS_UPJANG_M_RATE_MGMT WHERE INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) AND DOC_CD = B.DOC_CD AND GUBUN = 'R'), 100)*100                                                                                      \n");
		        sbSql.append("                                     ELSE                                                                                                                                                                                                                                                                  \n");
		        sbSql.append("                                         B.ACT_AMT                                                                                                                                                                                                                                                         \n");
		        sbSql.append("                                     END                                                                                                                                                                                                                                                                   \n");
		        sbSql.append("                                 ELSE                                                                                                                                                                                                                                                                      \n");
		        sbSql.append("                                    0                                                                                                                                                                                                                                                                      \n");
		        sbSql.append("                                 END), 0) AMT10 /* 매출원가_전년실적 */                                                                                                                                                                                                                                    \n");
		        sbSql.append("                  FROM MAC_MGMT_ACCT       A                                                                                                                                                                                                                                                               \n");
		        sbSql.append("                     , MAS_DAILY_PL_REPORT B                                                                                                                                                                                                                                                               \n");
		        sbSql.append("                     , UPJANG              C                                                                                                                                                                                                                                                               \n");
		        sbSql.append("                 WHERE A.MGMT_ACCT_CD = B.MGMT_ACCT_CD                                                                                                                                                                                                                                                     \n");
		        sbSql.append("                   AND B.INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6)/* 파라미터 */                                                                                                                                                                                                                                 \n");
		        sbSql.append("                   AND B.DOC_CD = C.UPJANG                                                                                                                                                                                                                                                                 \n");
		        sbSql.append("                   AND A.ACCT_TYPE = 'WP'                                                                                                                                                                                                                                                                  \n");
		        sbSql.append("                   AND A.USE_YN = 'Y'                                                                                                                                                                                                                                                                      \n");
		        sbSql.append("                   AND A.MGMT_ACCT_CD IN ('PLB10000', 'PLB20100', 'PLB20200', 'PLB20300', 'PLB20400', 'PLB30000', 'PLB40000') /* 상품매출원가(PLB10000), 재료비(식음료원가(PLB20100), 상품원가(PLB20200), 매점원가(PLB20300), 외식원가(PLB20400)), 노무비(PLB30000), 경비(PLB40000) */                     \n");
		        sbSql.append("                 GROUP BY B.INPUT_YM, C.TM_CD, C.TM_NM                                                                                                                                                                                                                                                     \n");
		        sbSql.append("             ) A10                                                                                                                                                                                                                                                                                         \n");
		        sbSql.append("        GROUP BY A10.INPUT_YM, A10.TM_CD, A10.TM_NM                                                                                                                                                                                                                                                        \n");
		        sbSql.append("     ) AA                                                                                                                                                                                                                                                                                                  \n");
		        sbSql.append(" GROUP BY AA.GUBUN, AA.INPUT_YM, AA.TM_CD, AA.TM_NM                                                                                                                                                                                                                                                        \n");      
		        
		        
			}else{ // 관리단가
				// 
		        sbSql.append("/* 사업부별 손익조회 쿼리(매출액) */                                                                                                                            \n");
		        sbSql.append("WITH UPJANG AS (                                                                                                                                                \n");
		        sbSql.append("                SELECT TM_CD                                                                                                                                    \n");
		        sbSql.append("                     , TM_NM                                                                                                                                    \n");
		        sbSql.append("                     , UPJANG                                                                                                                                   \n");
		        sbSql.append("                     , UPJANGNM                                                                                                                                 \n");
		        sbSql.append("                  FROM SCO_UPJANG_MST_V                                                                                                                         \n");
		        sbSql.append("                 WHERE TM_CD IN (                                                                                                                               \n");
		        sbSql.append("                                 SELECT A.TM_CD                                                                                                                 \n");
		        sbSql.append("                                   FROM MAS_DUALUPJANG_MGMT V,                                                                                                  \n");
		        sbSql.append("                                        SCO_UPJANG_MST_V A                                                                                                      \n");
		        sbSql.append("                                  WHERE V.UPJANG   = A.UPJANG                                                                                                   \n");
		        sbSql.append("                                    AND V.SABUN    = '" + g_EmpNo + "' /* 파라미터 */                                                                                 \n");
		        sbSql.append("                                    AND V.USE_YN   = 'Y'                                                                                                        \n");
		        sbSql.append("                                 UNION                                                                                                                          \n");
		        sbSql.append("                                 SELECT A.TM_CD                                                                                                                 \n");
		        sbSql.append("                                   FROM SCC_USERINFO V,                                                                                                         \n");
		        sbSql.append("                                        SCO_UPJANG_MST_V A                                                                                                      \n");
		        sbSql.append("                                  WHERE V.UPJANG = A.UPJANG                                                                                                     \n");
		        sbSql.append("                                    AND V.SABUN    = '" + g_EmpNo + "' /* 파라미터 */                                                                                 \n");
		        sbSql.append("                                )                                                                                                                               \n");
		        sbSql.append("                   AND CLOSE_DATE IS NULL                                                                                                                       \n");
		        sbSql.append("               ) /* 소팀장 관리 업장List */                                                                                                                     \n");
		        sbSql.append("SELECT '매출액' GUBUN                                                                                                                                           \n");
		        sbSql.append("     , B.INPUT_YM                                                                                                                                               \n");
		        sbSql.append("     , C.TM_CD                                                                                                                                                  \n");
		        sbSql.append("     , C.TM_NM                                                                                                                                                  \n");
		        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'P' THEN                                                                                                                     \n");
		        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
		        sbSql.append("           ELSE                                                                                                                                                 \n");
		        sbSql.append("              0                                                                                                                                                 \n");
		        sbSql.append("           END) AMT1 /* 매출_기본계획 */                                                                                                                        \n");
		        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'P' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                \n");
		        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
		        sbSql.append("           ELSE                                                                                                                                                 \n");
		        sbSql.append("              0                                                                                                                                                 \n");
		        sbSql.append("           END) AMT2 /* 매출_요망진도 */                                                                                                                        \n");
		        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                \n");
		        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
		        sbSql.append("           ELSE                                                                                                                                                 \n");
		        sbSql.append("              0                                                                                                                                                 \n");
		        sbSql.append("           END) AMT3 /* 매출_추정 */                                                                                                                            \n");
		        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '00' THEN/* 파라미터 */                                                     \n");
		        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
		        sbSql.append("           ELSE                                                                                                                                                 \n");
		        sbSql.append("              0                                                                                                                                                 \n");
		        sbSql.append("           END) AMT4 /* 매출_월추정 */                                                                                                                          \n");
		        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6), 'YYYYMM'), -12), 'YYYYMM') || '00' THEN/* 파라미터 */ \n");
		        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
		        sbSql.append("           ELSE                                                                                                                                                 \n");
		        sbSql.append("              0                                                                                                                                                 \n");
		        sbSql.append("           END) AMT5 /* 매출_전년실적 */                                                                                                                        \n");
		        sbSql.append("  FROM MAC_MGMT_ACCT       A                                                                                                                                    \n");
		        sbSql.append("     , MAS_DAILY_PL_REPORT B                                                                                                                                    \n");
		        sbSql.append("     , UPJANG              C                                                                                                                                    \n");
		        sbSql.append(" WHERE A.MGMT_ACCT_CD = B.MGMT_ACCT_CD                                                                                                                          \n");
		        sbSql.append("   AND B.INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6)/* 파라미터 */                                                                                                      \n");
		        sbSql.append("   AND B.DOC_CD = C.UPJANG                                                                                                                                      \n");
		        sbSql.append("   AND A.ACCT_TYPE = 'WP'                                                                                                                                       \n");
		        sbSql.append("   AND A.USE_YN = 'Y'                                                                                                                                           \n");
		        sbSql.append("   AND A.ATTR02 = '매출액'                                                                                                                                      \n");
		        sbSql.append(" GROUP BY B.INPUT_YM, C.TM_CD, C.TM_NM, A.MGMT_ACCT_CD                                                                                                          \n");
		        sbSql.append("UNION ALL                                                                                                                                                       \n");
		        sbSql.append("/* 사업부별 손익조회 쿼리(매출원가) */                                                                                                                          \n");
		        sbSql.append("SELECT '매출원가'                                                                                                                                               \n");
		        sbSql.append("     , B.INPUT_YM                                                                                                                                               \n");
		        sbSql.append("     , A.MGMT_ACCT_CD                                                                                                                                           \n");
		        sbSql.append("     , DECODE(A.MGMT_ACCT_CD, 'PLB20000', '재료비', 'PLB30000', '노무비', 'PLB40000', '경비') MGMT_ACCT_NM                                                      \n");
		        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'P' THEN                                                                                                                     \n");
		        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
		        sbSql.append("           ELSE                                                                                                                                                 \n");
		        sbSql.append("              0                                                                                                                                                 \n");
		        sbSql.append("           END) AMT1 /* 매출원가_기본계획 */                                                                                                                    \n");
		        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'P' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                \n");
		        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
		        sbSql.append("           ELSE                                                                                                                                                 \n");
		        sbSql.append("              0                                                                                                                                                 \n");
		        sbSql.append("           END) AMT2 /* 매출원가_요망진도 */                                                                                                                    \n");
		        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                \n");
		        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
		        sbSql.append("           ELSE                                                                                                                                                 \n");
		        sbSql.append("              0                                                                                                                                                 \n");
		        sbSql.append("           END) AMT3 /* 매출원가_추정 */                                                                                                                        \n");
		        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '00' THEN/* 파라미터 */                                                     \n");
		        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
		        sbSql.append("           ELSE                                                                                                                                                 \n");
		        sbSql.append("              0                                                                                                                                                 \n");
		        sbSql.append("           END) AMT4 /* 매출원가_월추정 */                                                                                                                      \n");
		        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6), 'YYYYMM'), -12), 'YYYYMM') || '00' THEN/* 파라미터 */ \n");
		        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
		        sbSql.append("           ELSE                                                                                                                                                 \n");
		        sbSql.append("              0                                                                                                                                                 \n");
		        sbSql.append("           END) AMT5 /* 매출원가_전년실적 */                                                                                                                    \n");
		        sbSql.append("  FROM MAC_MGMT_ACCT       A                                                                                                                                    \n");
		        sbSql.append("     , MAS_DAILY_PL_REPORT B                                                                                                                                    \n");
		        sbSql.append("     , UPJANG              C                                                                                                                                    \n");
		        sbSql.append(" WHERE A.MGMT_ACCT_CD = B.MGMT_ACCT_CD                                                                                                                          \n");
		        sbSql.append("   AND B.INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6)/* 파라미터 */                                                                                                      \n");
		        sbSql.append("   AND B.DOC_CD = C.UPJANG                                                                                                                                      \n");
		        sbSql.append("   AND A.ACCT_TYPE = 'WP'                                                                                                                                       \n");
		        sbSql.append("   AND A.USE_YN = 'Y'                                                                                                                                           \n");
		        sbSql.append("   AND A.MGMT_ACCT_CD IN ('PLB20000', 'PLB30000', 'PLB40000') /* 재료비, 노무비, 경비 */                                                                        \n");
		        sbSql.append(" GROUP BY B.INPUT_YM, A.MGMT_ACCT_CD                                                                                                                            \n");
		        sbSql.append("UNION ALL                                                                                                                                                       \n");
		        sbSql.append("/* 사업부별 손익조회 쿼리(매출이익) */                                                                                                                          \n");
		        sbSql.append("SELECT '매출이익' GUBUN                                                                                                                                         \n");
		        sbSql.append("     , B.INPUT_YM                                                                                                                                               \n");
		        sbSql.append("     , C.TM_CD                                                                                                                                                  \n");
		        sbSql.append("     , C.TM_NM                                                                                                                                                  \n");
		        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'P' THEN                                                                                                                     \n");
		        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
		        sbSql.append("           ELSE                                                                                                                                                 \n");
		        sbSql.append("              0                                                                                                                                                 \n");
		        sbSql.append("           END) AMT1 /* 매출이익_기본계획 */                                                                                                                    \n");
		        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'P' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                \n");
		        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
		        sbSql.append("           ELSE                                                                                                                                                 \n");
		        sbSql.append("              0                                                                                                                                                 \n");
		        sbSql.append("           END) AMT2 /* 매출이익_요망진도 */                                                                                                                    \n");
		        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                \n");
		        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
		        sbSql.append("           ELSE                                                                                                                                                 \n");
		        sbSql.append("              0                                                                                                                                                 \n");
		        sbSql.append("           END) AMT3 /* 매출이익_추정 */                                                                                                                        \n");
		        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '00' THEN/* 파라미터 */                                                     \n");
		        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
		        sbSql.append("           ELSE                                                                                                                                                 \n");
		        sbSql.append("              0                                                                                                                                                 \n");
		        sbSql.append("           END) AMT4 /* 매출이익_월추정 */                                                                                                                      \n");
		        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6), 'YYYYMM'), -12), 'YYYYMM') || '00' THEN/* 파라미터 */ \n");
		        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
		        sbSql.append("           ELSE                                                                                                                                                 \n");
		        sbSql.append("              0                                                                                                                                                 \n");
		        sbSql.append("           END) AMT5 /* 매출이익_전년실적 */                                                                                                                    \n");
		        sbSql.append("  FROM MAC_MGMT_ACCT       A                                                                                                                                    \n");
		        sbSql.append("     , MAS_DAILY_PL_REPORT B                                                                                                                                    \n");
		        sbSql.append("     , UPJANG              C                                                                                                                                    \n");
		        sbSql.append(" WHERE A.MGMT_ACCT_CD = B.MGMT_ACCT_CD                                                                                                                          \n");
		        sbSql.append("   AND B.INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6)/* 파라미터 */                                                                                                      \n");
		        sbSql.append("   AND B.DOC_CD = C.UPJANG                                                                                                                                      \n");
		        sbSql.append("   AND A.ACCT_TYPE = 'WP'                                                                                                                                       \n");
		        sbSql.append("   AND A.USE_YN = 'Y'                                                                                                                                           \n");
		        sbSql.append("   AND A.ATTR02 = '매출이익'                                                                                                                                    \n");
		        sbSql.append(" GROUP BY B.INPUT_YM, C.TM_CD, C.TM_NM, A.MGMT_ACCT_CD                                                                                                          \n");
			}
		}else{ // 영업사원의 실적
			sbSql.append("/* 사업부별 손익조회 쿼리(매출액) */                                                                                                                            \n");
	        sbSql.append("WITH UPJANG AS (                                                                                                \n");
	        sbSql.append("                SELECT TM_CD                                                                                    \n");
	        sbSql.append("                     , TM_NM                                                                                    \n");
	        sbSql.append("                     , SABUN AS UPJANG                                                                          \n");
	        sbSql.append("                     , NM_KOR  AS UPJANGNM                                                                      \n");
	        sbSql.append("                  FROM SCO_FS_HR_PERSONAL_V V                                                                   \n");
	        sbSql.append("                 WHERE 1 = 1                                                                                    \n");
	        sbSql.append("                   AND EXISTS (SELECT 1 FROM SCC_COMMON_CODE WHERE CODE = V.DEPT_ID AND GROUP_CODE = 'MA1002' AND SET1 = 'FICS') \n");
	        sbSql.append("                   AND TM_CD IN (                                                                               \n");
	        sbSql.append("                                 SELECT TM_CD                                                                   \n");
	        sbSql.append("                                   FROM SCO_UPJANG_MST_V                                                        \n");
	        sbSql.append("                                  WHERE TM_CD IN (                                                              \n");
	        sbSql.append("                                                  SELECT A.TM_CD                                                \n");
	        sbSql.append("                                                    FROM MAS_DUALUPJANG_MGMT V,                                 \n");
	        sbSql.append("                                                         SCO_UPJANG_MST_V A                                     \n");
	        sbSql.append("                                                   WHERE V.UPJANG   = A.UPJANG                                  \n");
	        sbSql.append("                                                     AND V.SABUN    = '" + g_EmpNo + "' /* 파라미터 */                \n");
	        sbSql.append("                                                     AND V.USE_YN   = 'Y'                                       \n");
	        sbSql.append("                                                   UNION                                                        \n");
	        sbSql.append("                                                  SELECT A.TM_CD                                                \n");
	        sbSql.append("                                                    FROM SCC_USERINFO V,                                        \n");
	        sbSql.append("                                                         SCO_UPJANG_MST_V A                                     \n");
	        sbSql.append("                                                   WHERE V.UPJANG = A.UPJANG                                    \n");
	        sbSql.append("                                                     AND V.SABUN    = '" + g_EmpNo + "' /* 파라미터 */                \n");
	        sbSql.append("                                                 )                                                              \n");
	        sbSql.append("                                    AND CLOSE_DATE IS NULL                                                      \n");
	        sbSql.append("                                )                                                                               \n");
	        sbSql.append("               ) /* 소팀장 관리 영업사원List */                                                                 \n");
	        sbSql.append("SELECT '매출액' GUBUN                                                                                                                                           \n");
	        sbSql.append("     , B.INPUT_YM                                                                                                                                               \n");
	        sbSql.append("     , C.TM_CD                                                                                                                                                  \n");
	        sbSql.append("     , C.TM_NM                                                                                                                                                  \n");
	        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'P' THEN                                                                                                                     \n");
	        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
	        sbSql.append("           ELSE                                                                                                                                                 \n");
	        sbSql.append("              0                                                                                                                                                 \n");
	        sbSql.append("           END) AMT1 /* 매출_기본계획 */                                                                                                                        \n");
	        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'P' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                \n");
	        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
	        sbSql.append("           ELSE                                                                                                                                                 \n");
	        sbSql.append("              0                                                                                                                                                 \n");
	        sbSql.append("           END) AMT2 /* 매출_요망진도 */                                                                                                                        \n");
	        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                \n");
	        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
	        sbSql.append("           ELSE                                                                                                                                                 \n");
	        sbSql.append("              0                                                                                                                                                 \n");
	        sbSql.append("           END) AMT3 /* 매출_추정 */                                                                                                                            \n");
	        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '00' THEN/* 파라미터 */                                                     \n");
	        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
	        sbSql.append("           ELSE                                                                                                                                                 \n");
	        sbSql.append("              0                                                                                                                                                 \n");
	        sbSql.append("           END) AMT4 /* 매출_월추정 */                                                                                                                          \n");
	        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6), 'YYYYMM'), -12), 'YYYYMM') || '00' THEN/* 파라미터 */ \n");
	        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
	        sbSql.append("           ELSE                                                                                                                                                 \n");
	        sbSql.append("              0                                                                                                                                                 \n");
	        sbSql.append("           END) AMT5 /* 매출_전년실적 */                                                                                                                        \n");
	        sbSql.append("  FROM MAC_MGMT_ACCT       A                                                                                                                                    \n");
	        sbSql.append("     , MAS_DAILY_PL_REPORT B                                                                                                                                    \n");
	        sbSql.append("     , UPJANG              C                                                                                                                                    \n");
	        sbSql.append(" WHERE A.MGMT_ACCT_CD = B.MGMT_ACCT_CD                                                                                                                          \n");
	        sbSql.append("   AND B.INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6)/* 파라미터 */                                                                                                      \n");
	        sbSql.append("   AND B.DOC_CD = C.UPJANG                                                                                                                                      \n");
	        sbSql.append("   AND A.ACCT_TYPE = 'WP'                                                                                                                                       \n");
	        sbSql.append("   AND A.USE_YN = 'Y'                                                                                                                                           \n");
	        sbSql.append("   AND A.ATTR02 = '매출액'                                                                                                                                      \n");
	        sbSql.append(" GROUP BY B.INPUT_YM, C.TM_CD, C.TM_NM, A.MGMT_ACCT_CD                                                                                                          \n");
	        sbSql.append("UNION ALL                                                                                                                                                       \n");
	        sbSql.append("/* 사업부별 손익조회 쿼리(매출원가) */                                                                                                                          \n");
	        sbSql.append("SELECT '매출원가'                                                                                                                                               \n");
	        sbSql.append("     , B.INPUT_YM                                                                                                                                               \n");
	        sbSql.append("     , A.MGMT_ACCT_CD                                                                                                                                           \n");
	        sbSql.append("     , DECODE(A.MGMT_ACCT_CD, 'PLB20000', '재료비', 'PLB30000', '노무비', 'PLB40000', '경비') MGMT_ACCT_NM                                                      \n");
	        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'P' THEN                                                                                                                     \n");
	        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
	        sbSql.append("           ELSE                                                                                                                                                 \n");
	        sbSql.append("              0                                                                                                                                                 \n");
	        sbSql.append("           END) AMT1 /* 매출원가_기본계획 */                                                                                                                    \n");
	        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'P' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                \n");
	        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
	        sbSql.append("           ELSE                                                                                                                                                 \n");
	        sbSql.append("              0                                                                                                                                                 \n");
	        sbSql.append("           END) AMT2 /* 매출원가_요망진도 */                                                                                                                    \n");
	        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                \n");
	        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
	        sbSql.append("           ELSE                                                                                                                                                 \n");
	        sbSql.append("              0                                                                                                                                                 \n");
	        sbSql.append("           END) AMT3 /* 매출원가_추정 */                                                                                                                        \n");
	        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '00' THEN/* 파라미터 */                                                     \n");
	        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
	        sbSql.append("           ELSE                                                                                                                                                 \n");
	        sbSql.append("              0                                                                                                                                                 \n");
	        sbSql.append("           END) AMT4 /* 매출원가_월추정 */                                                                                                                      \n");
	        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6), 'YYYYMM'), -12), 'YYYYMM') || '00' THEN/* 파라미터 */ \n");
	        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
	        sbSql.append("           ELSE                                                                                                                                                 \n");
	        sbSql.append("              0                                                                                                                                                 \n");
	        sbSql.append("           END) AMT5 /* 매출원가_전년실적 */                                                                                                                    \n");
	        sbSql.append("  FROM MAC_MGMT_ACCT       A                                                                                                                                    \n");
	        sbSql.append("     , MAS_DAILY_PL_REPORT B                                                                                                                                    \n");
	        sbSql.append("     , UPJANG              C                                                                                                                                    \n");
	        sbSql.append(" WHERE A.MGMT_ACCT_CD = B.MGMT_ACCT_CD                                                                                                                          \n");
	        sbSql.append("   AND B.INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6)/* 파라미터 */                                                                                                      \n");
	        sbSql.append("   AND B.DOC_CD = C.UPJANG                                                                                                                                      \n");
	        sbSql.append("   AND A.ACCT_TYPE = 'WP'                                                                                                                                       \n");
	        sbSql.append("   AND A.USE_YN = 'Y'                                                                                                                                           \n");
	        sbSql.append("   AND A.MGMT_ACCT_CD IN ('PLB20000', 'PLB30000', 'PLB40000') /* 재료비, 노무비, 경비 */                                                                        \n");
	        sbSql.append(" GROUP BY B.INPUT_YM, A.MGMT_ACCT_CD                                                                                                                            \n");
	        sbSql.append("UNION ALL                                                                                                                                                       \n");
	        sbSql.append("/* 사업부별 손익조회 쿼리(매출이익) */                                                                                                                          \n");
	        sbSql.append("SELECT '매출이익' GUBUN                                                                                                                                         \n");
	        sbSql.append("     , B.INPUT_YM                                                                                                                                               \n");
	        sbSql.append("     , C.TM_CD                                                                                                                                                  \n");
	        sbSql.append("     , C.TM_NM                                                                                                                                                  \n");
	        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'P' THEN                                                                                                                     \n");
	        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
	        sbSql.append("           ELSE                                                                                                                                                 \n");
	        sbSql.append("              0                                                                                                                                                 \n");
	        sbSql.append("           END) AMT1 /* 매출이익_기본계획 */                                                                                                                    \n");
	        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'P' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                \n");
	        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
	        sbSql.append("           ELSE                                                                                                                                                 \n");
	        sbSql.append("              0                                                                                                                                                 \n");
	        sbSql.append("           END) AMT2 /* 매출이익_요망진도 */                                                                                                                    \n");
	        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD BETWEEN SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '01' AND '" + ds_Cond.getString(0, "INPUT_YMD") + "' THEN/* 파라미터 */                                \n");
	        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
	        sbSql.append("           ELSE                                                                                                                                                 \n");
	        sbSql.append("              0                                                                                                                                                 \n");
	        sbSql.append("           END) AMT3 /* 매출이익_추정 */                                                                                                                        \n");
	        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6) || '00' THEN/* 파라미터 */                                                     \n");
	        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
	        sbSql.append("           ELSE                                                                                                                                                 \n");
	        sbSql.append("              0                                                                                                                                                 \n");
	        sbSql.append("           END) AMT4 /* 매출이익_월추정 */                                                                                                                      \n");
	        sbSql.append("     , SUM(CASE WHEN B.DOC_GUBUN = 'R' AND B.INPUT_DD = TO_CHAR(ADD_MONTHS(TO_DATE(SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6), 'YYYYMM'), -12), 'YYYYMM') || '00' THEN/* 파라미터 */ \n");
	        sbSql.append("              B.ACT_AMT                                                                                                                                         \n");
	        sbSql.append("           ELSE                                                                                                                                                 \n");
	        sbSql.append("              0                                                                                                                                                 \n");
	        sbSql.append("           END) AMT5 /* 매출이익_전년실적 */                                                                                                                    \n");
	        sbSql.append("  FROM MAC_MGMT_ACCT       A                                                                                                                                    \n");
	        sbSql.append("     , MAS_DAILY_PL_REPORT B                                                                                                                                    \n");
	        sbSql.append("     , UPJANG              C                                                                                                                                    \n");
	        sbSql.append(" WHERE A.MGMT_ACCT_CD = B.MGMT_ACCT_CD                                                                                                                          \n");
	        sbSql.append("   AND B.INPUT_YM = SUBSTR('" + ds_Cond.getString(0, "INPUT_YMD") + "', 1, 6)/* 파라미터 */                                                                                                      \n");
	        sbSql.append("   AND B.DOC_CD = C.UPJANG                                                                                                                                      \n");
	        sbSql.append("   AND A.ACCT_TYPE = 'WP'                                                                                                                                       \n");
	        sbSql.append("   AND A.USE_YN = 'Y'                                                                                                                                           \n");
	        sbSql.append("   AND A.ATTR02 = '매출이익'                                                                                                                                    \n");
	        sbSql.append(" GROUP BY B.INPUT_YM, C.TM_CD, C.TM_NM, A.MGMT_ACCT_CD                                                                                                          \n");	
				
		}
		
		

out_vl.add("fa_Sql", sbSql.toString());
		//System.out.println(sbSql.toString());
		pstmt = conn.prepareStatement(sbSql.toString());		
		rs = pstmt.executeQuery(); 
		ds_List = this.makeDataSet(rs, "ds_List");

		pstmt.close();
		rs.close();

		/**종료**/
		out_dl.add(ds_List);
		this.setResultMessage(0, "OK", out_vl);

	}
	catch(Exception ex)
	{
		//ex.printStackTrace();
		//jsp 로그남기기
		logger.debug(ex.getMessage(), ex);		
		this.setResultMessage(-1, ex.toString(),out_vl);
	}
	finally
	{
		if(rs != null) {
			try {
				rs.close();
			}catch(Exception e) {}
		}
		if(pstmt != null) {
			try {
				pstmt.close();
			}catch(Exception e) {}
		}
		if(conn != null) {
			try {
				conn.close();
			}catch(Exception e) {}
		}
		//jsp log 서비스 닫기 
		try {
			logger.endIndividualLog();
		} catch( Exception logE) {
			logE.printStackTrace();
		}		
	}

	proc_output(response,out,out_vl,out_dl);

%>
<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSM00202V" onactivate="FSM00202V_OnActivate" onload="form_onload" titletext="업장식단검색" position="absolute 0 0 784 456" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="sta_detail05" class="sta_WFDA_Labelbg" position="absolute 10 419 774 446" anchor="left bottom"/>
        <Static id="Static58" class="sta_WFSA_Labelbg" position="absolute 10 10 412 155" anchor="left top right"/>
        <Grid autoenter="select" binddataset="ds_list" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="grd_list" useinputpanel="false" oncelldblclick="grd_list_OnCellDblClick" onheadclick="grd_list_OnHeadClick" taborder="7" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 10 167 412 419" selecttype="row" anchor="left top bottom" class="grd_WF_LineNone">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="63"/>
                <Column size="85"/>
                <Column size="63"/>
                <Column size="63"/>
                <Column size="63"/>
                <Column size="600"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" text="제공일" wordwrap="word"/>
                <Cell col="1" displaytype="text" text="식단" wordwrap="word"/>
                <Cell col="2" displaytype="text" text="식단가"/>
                <Cell col="3" displaytype="text" text="제공원가"/>
                <Cell col="4" displaytype="text" text="원가율"/>
                <Cell col="5" displaytype="text" text="구성" wordwrap="word"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" text="bind:MENU_DATE" mask="####-##-##"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:MENU_FEATURE"/>
                <Cell col="2" displaytype="number" style="align:right;" text="bind:SALE_PRICE" mask="#,##0"/>
                <Cell col="3" displaytype="number" style="align:right;" text="bind:CUR_PRICE" mask="#,##0"/>
                <Cell col="4" displaytype="number" style="align:right;" text="bind:COST_RATE2" mask="#,###.0"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:RECIPE_INFO"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static9" text="사업장" position="absolute 25 20 110 44" class="sta_WFSA_label"/>
        <Button id="btn_viewRecipe" onclick="btn_viewRecipe_OnClick" taborder="10" tabstop="false" text="레시피상세보기" position="absolute 12 422 123 444" class="btn_WF_Custom" image="" anchor="left bottom"/>
        <Grid autoenter="select" binddataset="ds_recipeList" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="grd_recipe" useinputpanel="false" onheadclick="grd_recipe_OnHeadClick" taborder="8" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 422 10 742 419" selecttype="row" anchor="all" class="grd_WF_LineNone">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30" band="left"/>
                <Column size="75"/>
                <Column size="140"/>
                <Column size="60"/>
                <Column size="72"/>
                <Column size="72"/>
                <Column size="75"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text"/>
                <Cell col="1" displaytype="text" text="코드" wordwrap="word"/>
                <Cell col="2" displaytype="text" text="레시피명"/>
                <Cell col="3" displaytype="text" text="원가" wordwrap="word"/>
                <Cell col="4" displaytype="text" text="레시피분류" wordwrap="word"/>
                <Cell col="5" displaytype="text" text="레시피유형" wordwrap="word"/>
                <Cell col="6" displaytype="text" text="조리법유형"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="checkbox" style="align:center;" text="bind:CHK"/>
                <Cell col="1" displaytype="text" style="align:center;" text="bind:RECIPE_CD" suppress="2"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:RECIPE_NAME" suppress="3"/>
                <Cell col="3" displaytype="number" style="align:right;" text="bind:CUR_PRICE" mask="#,##0"/>
                <Cell col="4" displaytype="text" style="align:left;" text="bind:RECIPE_CLASS_NM"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:RECIPE_TYPE_NM"/>
                <Cell col="6" displaytype="text" style="align:left;" text="bind:CUISINE_TYPE_NM"/>
              </Band>
            </Format>
            <Format id="Default0">
              <Columns>
                <Column size="30" band="left"/>
                <Column size="75"/>
                <Column size="140"/>
                <Column size="60"/>
                <Column size="72"/>
                <Column size="72"/>
                <Column size="72"/>
                <Column size="75"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text"/>
                <Cell col="1" displaytype="text" text="코드" wordwrap="word"/>
                <Cell col="2" displaytype="text" text="레시피명"/>
                <Cell col="3" displaytype="text" text="원가" wordwrap="word"/>
                <Cell col="4" displaytype="text" text="조리식수" wordwrap="word"/>
                <Cell col="5" displaytype="text" text="레시피분류" wordwrap="word"/>
                <Cell col="6" displaytype="text" text="레시피유형" wordwrap="word"/>
                <Cell col="7" displaytype="text" text="조리방법유형"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="checkbox" style="align:center;" text="bind:CHK"/>
                <Cell col="1" displaytype="text" style="align:center;" text="bind:RECIPE_CD" suppress="2"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:RECIPE_NAME" suppress="3"/>
                <Cell col="3" displaytype="number" style="align:right;" text="bind:CUR_PRICE" mask="#,##0"/>
                <Cell col="4" displaytype="number" style="align:right;" text="bind:EXPECT_SALE_QTY"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:RECIPE_CLASS_NM"/>
                <Cell col="6" displaytype="text" style="align:left;" text="bind:RECIPE_TYPE_NM"/>
                <Cell col="7" displaytype="text" style="align:left;" text="bind:CUISINE_TYPE_NM"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static4" text="제공일" position="absolute 25 123 110 147" class="sta_WFSA_label"/>
        <Static id="Static5" text="~" position="absolute 192 124 201 146"/>
        <Static id="Static6" text="식단특성" position="absolute 25 72 110 96" class="sta_WFSA_label"/>
        <Combo codecolumn="MENU_CD" datacolumn="MENU_FEATURE" id="cbo_menu" index="0" innerdataset="ds_menuList" onchar="cbo_menu_OnChar" onkillfocus="cbo_menu_OnKillFocus" type="filter" taborder="3" position="absolute 92 72 302 93"/>
        <Static id="Static7" text="레시피명" position="absolute 25 98 110 122" class="sta_WFSA_label"/>
        <Combo codecolumn="RECIPE_NAME" datacolumn="RECIPE_NAME" id="cbo_recipe" innerdataset="ds_recipe" type="filter" taborder="4" position="absolute 92 98 302 119" onitemchanged="cbo_recipe_onitemchanged" onkeydown="cbo_recipe_onkeydown" onkillfocus="cbo_recipe_onkillfocus" ontextchanged="cbo_recipe_ontextchanged" userdata="" userchange="0"/>
        <Button id="btn_Search" onclick="fn_commBtn_OnClick" taborder="16" text="조회" position="absolute 346 124 397 146" class="btn_WF_Custom" image=""/>
        <CheckBox id="chk_all" onclick="chk_all_OnClick" taborder="11" tabstop="false" value="false" visible="false" position="absolute 756 15 769 28"/>
        <Static id="Static1" text="식당명" position="absolute 25 46 110 70" class="sta_WFSA_label"/>
        <Combo codecolumn="HALL_CD" datacolumn="HALL_NAME" id="cbo_hallCd" index="0" innerdataset="@ds_hallList" onitemchanged="cbo_hallCd_OnChanged" type="filter" taborder="2" position="absolute 92 46 302 67"/>
        <Edit id="ed_upjangNm" ontextchanged="ed_upjangNm_OnChanged" onkeydown="ed_upjangNm_OnKeyDown" readonly="true" taborder="1" position="absolute 92 20 282 41" class="edt_WF_Essential"/>
        <Button id="btn_upjangCd" onclick="btn_upjangCd_OnClick" taborder="12" tabstop="false" text="" position="absolute 281 20 302 41" class="btn_WF_popSearch" image=""/>
        <Edit lengthunit="asciii" id="ed_upjangCd" imemode="english" maxlength="6" inputtype="number" taborder="13" tabstop="false" visible="false" position="absolute 333 19 391 41"/>
        <MaskEdit id="med_fromDate" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="5" type="string" position="absolute 92 123 171 144" class="msk_WF_Essential"/>
        <MaskEdit id="med_toDate" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="6" type="string" position="absolute 202 123 281 144" class="msk_WF_Essential"/>
        <Radio codecolumn="CODE" columncount="2" datacolumn="CODE_NAME" id="rd_copyType" index="0" innerdataset="ds_recipeType" taborder="17" tooltiptext="[레시피포함] 선택한 레시피 그대로 선택됩니다.&#10;[레시피미포함] 선택한 레시피를 업장표준 레시피로 전환하여 추가됩니다. 업장 표준 레시피가 존재하지 않는 경우에는 표준레시피가 추가됩니다." position="absolute 422 423 742 445" anchor="left bottom"/>
        <Button id="btn_Copy" onclick="btn_Copy_OnClick" taborder="30" position="absolute 752 219 774 241" class="btn_WF_rightMove" text="" image=""/>
        <Static id="Static2" text="* 원가:제공당시의 원가" position="absolute 222 423 408 445" anchor="left bottom"/>
        <Static id="Static03" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 774 0 784 456"/>
        <Static id="Static13" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 742 0 752 456"/>
        <Static id="Static01" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 784 10"/>
        <Static id="Static12" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 412 0 422 456"/>
        <Static id="Static21" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 446 784 456"/>
        <Static id="Static02" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 10 456"/>
        <Static id="Static10" text="W15" visible="false" position="absolute 397 10 412 155" style="background:#ff000055;align:center middle;"/>
        <Static id="Static70" text="W10" visible="false" position="absolute 10 10 412 20" style="background:#ff000055;align:center middle;"/>
        <Static id="Static64" text="W30" visible="false" position="absolute 302 10 332 155" style="background:#ff000055;align:center middle;"/>
        <Static id="Static82" text="W05." visible="false" position="absolute 10 41 412 46" style="background:#ff000055;align:center middle;"/>
        <Static id="Static94" text="W05." visible="false" position="absolute 10 67 412 72" style="background:#ff000055;align:center middle;"/>
        <Static id="Static08" text="W05." visible="false" position="absolute 10 93 412 98" style="background:#ff000055;align:center middle;"/>
        <Static id="Static00" text="W10" visible="false" position="absolute 10 144 412 154" style="background:#ff000055;align:center middle;"/>
        <Static id="Static63" text="W10" onclick="Static63_onclick" visible="false" position="absolute 82 10 92 155" style="background:#ff000055;align:center middle;"/>
        <Static id="Static72" text="W15" visible="false" position="absolute 10 10 25 155" style="background:#ff000055;align:center middle;"/>
        <Static id="Static11" text="W05." visible="false" position="absolute 10 119 412 124" style="background:#ff000055;align:center middle;"/>
        <Button id="btn_fromDate" taborder="31" onclick="g_CalButton_OnClick" class="btn_WF_calEssential" position="absolute 170 123 192 144" userdata="med_fromDate"/>
        <Button id="btn_toDate" taborder="32" onclick="g_CalButton_OnClick" class="btn_WF_calEssential" position="absolute 280 123 302 144" userdata="med_toDate"/>
        <Static id="Static14" text="W10" visible="false" position="absolute 10 154 412 167" style="background:#ff000055;align:center middle;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_menuList">
        <ColumnInfo>
          <Column id="MENU_CD" size="256" type="STRING"/>
          <Column id="MENU_NAME" size="256" type="STRING"/>
          <Column id="MENU_FEATURE" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond" oncolumnchanged="ds_cond_oncolumnchanged">
        <ColumnInfo>
          <Column id="RECIPE_NAME" size="256" type="STRING"/>
          <Column id="MENU_CD" size="256" type="STRING"/>
          <Column id="RECIPE_SEQ" size="256" type="STRING"/>
          <Column id="SINGLE_MENU_CD" size="256" type="STRING"/>
          <Column id="UPJANG" size="6" type="BIGDECIMAL"/>
          <Column id="HALL_CD" size="256" type="STRING"/>
          <Column id="UPJANG_NM" size="256" type="STRING"/>
          <Column id="FROM_DATE" size="256" type="STRING"/>
          <Column id="TO_DATE" size="256" type="STRING"/>
          <Column id="SUBINV_CODE" size="256" type="STRING"/>
          <Column id="MENU_DATE" size="256" type="STRING"/>
          <Column id="MENU_FEATURE" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="FROM_DATE"/>
            <Col id="HALL_CD"/>
            <Col id="MENU_CD"/>
            <Col id="MENU_DATE"/>
            <Col id="MENU_FEATURE"/>
            <Col id="RECIPE_NAME"/>
            <Col id="RECIPE_SEQ"/>
            <Col id="SINGLE_MENU_CD"/>
            <Col id="SUBINV_CODE"/>
            <Col id="TO_DATE"/>
            <Col id="UPJANG"/>
            <Col id="UPJANG_NM"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_recipeList" oncolumnchanged="ds_recipeList_OnColumnChanged">
        <ColumnInfo>
          <Column id="CUISINE_TYPE" size="20" type="STRING"/>
          <Column id="CUISINE_TYPE_NM" size="100" type="STRING"/>
          <Column id="CUR_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_CD" size="20" type="STRING"/>
          <Column id="RECIPE_CLASS" size="20" type="STRING"/>
          <Column id="RECIPE_CLASS_NM" size="100" type="STRING"/>
          <Column id="RECIPE_NAME" size="50" type="STRING"/>
          <Column id="RECIPE_TYPE" size="20" type="STRING"/>
          <Column id="RECIPE_TYPE_NM" size="100" type="STRING"/>
          <Column id="SINGLE_MENU_CD" size="20" type="STRING"/>
          <Column id="CHK" size="1" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_hallList">
        <ColumnInfo>
          <Column id="HALL_CD" size="256" type="STRING"/>
          <Column id="HALL_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list" onrowposchanged="ds_list_OnRowPosChanged">
        <ColumnInfo>
          <Column id="COST_RATE1" size="22" type="BIGDECIMAL"/>
          <Column id="COST_RATE2" size="22" type="BIGDECIMAL"/>
          <Column id="CUR_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="HALL_CD" size="20" type="STRING"/>
          <Column id="HALL_NAME" size="50" type="STRING"/>
          <Column id="MENU_CD" size="20" type="STRING"/>
          <Column id="MENU_DATE" size="8" type="STRING"/>
          <Column id="MENU_FEATURE" size="200" type="STRING"/>
          <Column id="PAST_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_INFO" size="4000" type="STRING"/>
          <Column id="SALE_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="UPJANG" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_copyCond">
        <ColumnInfo>
          <Column id="UPJANG" size="6" type="BIGDECIMAL"/>
          <Column id="SRC_UPJANG" size="256" type="BIGDECIMAL"/>
          <Column id="HALL_CD" size="256" type="STRING"/>
          <Column id="MENU_DATE" size="256" type="STRING"/>
          <Column id="RECIPE_CD" size="256" type="STRING"/>
          <Column id="MENU_CD" size="256" type="STRING"/>
          <Column id="SRC_MENU_CD" size="256" type="STRING"/>
          <Column id="SUBINV_CODE" size="256" type="STRING"/>
          <Column id="EXPECT_SALE_QTY" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="cbo_menu_value" compid="cbo_menu" propid="value" datasetid="ds_cond" columnid="MENU_CD"/>
      <BindItem id="cbo_hallCd_value" compid="cbo_hallCd" propid="value" datasetid="ds_cond" columnid="HALL_CD"/>
      <BindItem id="ed_upjangNm_value" compid="ed_upjangNm" propid="value" datasetid="ds_cond" columnid="UPJANG_NM"/>
      <BindItem id="med_fromDate_value" compid="med_fromDate" propid="value" datasetid="ds_cond" columnid="FROM_DATE"/>
      <BindItem id="med_toDate_value" compid="med_toDate" propid="value" datasetid="ds_cond" columnid="TO_DATE"/>
      <BindItem id="item5" compid="sta_detail05" propid="text" datasetid="ds_view" columnid="D_1"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 메뉴관리/식단관리/표준식단검색 
 * 프로그램명   : FSM00201V.XML
 * 기      능   : 표준식단검색 
 * 작  성  자   : 
 * 작성  일자   : 2007-12-21
 * 비      고   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "LIB::sc_comon.js"
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"
//@@컨버터에서 주석처리 #include "LIB::tit_comm_0001.js"		// X-Framework Lib
//@@컨버터에서 주석처리 #include "LIB::sc_sql_common.js"		// 사업장팝업용 Lib
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================

//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);
	
	// 업데이트 DS
	v_ds_check = "";
	
	// X-Framework : Action 정보 생성 
	fsp_init(this);
	
		// 메인사업장 셋팅
	// ds_cond.SetColumn(0,"UPJANG"   ,parent.ed_upjangCd.value);
	// ds_cond.SetColumn(0,"UPJANG_NM",parent.ed_upjangNm.value);

    // ds_cond.SetColumn(0,"SUBINV_CODE", parent.ds_hallList.GetColumn(0,"SUBINV_CODE"));
    // ds_cond.SetColumn(0, "MENU_DATE" , parent.ds_cond.GetColumn(0,"MENU_DATE"));	
	
	// ed_upjangCd.value = parent.ed_upjangCd.value;
	// ed_upjangNm.value = parent.ed_upjangNm.value;
	
	//ed_upjangNm_OnChanged();  ==> 제거. 데이타셋 이벤트로 처리
	
	med_fromDate.value = gfn_left(gfn_today(),6)+"01";
	med_toDate.value   = gfn_today();
	
	//fn_afterInit();
	//btn_upjangCd_OnClick();
}

//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_Search()
{
    // 필수 입력사항 체크 
    if ( gfn_isNull(ed_upjangNm.value, "사업장", ed_upjangNm) ) {
        return;
    }
    if ( gfn_isNull(cbo_hallCd.value, "식당명", cbo_hallCd) ) {
        return;
    }
    
    if ( med_fromDate.value == "" && med_toDate.value != "") {
        // 필수 
        gfn_alert(gfn_msg(SCCW00002, "제공일"));
        med_fromDate.setFocus();
        return;
    } else if (med_fromDate.value != "" && med_toDate.value == "") {
        // 필수 
        gfn_alert(gfn_msg(SCCW00002, "제공일"));
        med_toDate.setFocus();
        return;
    } else if ( med_fromDate.value != "" && med_toDate.value != "") {
        if ( toNumber(med_fromDate.value ) > toNumber(med_toDate.value) ) {
            gfn_alert("제공일(시작)은 제공일(종료)보다 작거나 같아야 합니다.");
            med_fromDate.setFocus();
            return;
        }
    }
    
    // 사업장 코드 입력
    var v_Row=ds_hallList.findRow("HALL_CD",gfn_trim(cbo_hallCd.value));
    var cd=ds_hallList.getColumn(v_Row,"SUBINV_CODE");
    ds_cond.setColumn(0, "UPJANG", gfn_trim(ed_upjangCd.value));
    ds_cond.setColumn(0,"RECIPE_SEQ",gfn_trim(cbo_recipe.value));
    ds_cond.setColumn(0,"RECIPE_NAME",gfn_trim(cbo_recipe.text));
    ds_cond.setColumn(0,"SUBINV_CODE",gfn_trim(cd));
    ds_cond.setColumn(0,"MENU_DATE",gfn_trim(parent.parent.ds_cond.getColumn(0, "MENU_DATE")));
    ds_cond.setColumn(0,"FROM_DATE",gfn_trim(med_fromDate.value));
    ds_cond.setColumn(0,"TO_DATE",gfn_trim(med_toDate.value));
    ds_cond.setColumn(0,"MENU_FEATURE",gfn_trim(cbo_menu.text));
    // var rValue = cbo_recipe.value;
    // if ( length( rValue ) == 0 ) {
        // ds_cond.setColumn(0, "RECIPE_SEQ", "");
        // ds_cond.setColumn(0, "RECIPE_NAME", "");
    // } else {
        // var row = ds_recipe.findRow("RECIPE_SEQ", rValue);
        // if ( ds_recipe.getColumn(row, "RECIPE_NAME")
                // == ds_recipe.getColumn(row, "RECIPE_SEQ") ) {
            // ds_cond.setColumn(0, "RECIPE_SEQ", "");
            // ds_cond.setColumn(0, "RECIPE_NAME", rValue);
        // } else {
            // ds_cond.setColumn(0, "RECIPE_SEQ", rValue);
            // ds_cond.setColumn(0, "RECIPE_NAME", "");
        // }
    // }
    // var arg="SUBINV_CODE="+	quote(parent.ds_cond.setColumn(0, "SUBINV_CODE"));
			// +" MENU_DATE="+	quote(parent.ds_cond.setColumn(0, "MENU_DATE"));
    // 정보 초기화 
    ds_recipeList.clearData();
    gfn_clearGrid(grd_list);
    gfn_clearGrid(grd_recipe);
    chk_all.value = false;
    
	fsp_clear(this); 
    fsp_addSearch(this, "fs/fsm:FSM00200E_S010");												
    fsp_callService(this, "", "", "ds_cond=ds_cond"
        , "ds_list=ds_list", "", "fn_afterSearch", true);		// 서비스 호출 
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   :  fn_afterInit
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 초기화 callback 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function fn_afterInit(errCode, errMsg) {

    ds_recipe.insertRow(0);
    ds_recipe.setColumn(0, "RECIPE_SEQ", "");
    ds_recipe.setColumn(0, "RECIPE_NAME", " ");
    cbo_recipe.index = 0;
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSearch()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 조회 후 실행 함수
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function fn_afterSearch(errCode, errMsg)
{
    gfn_showMsgGrid(grd_list);
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_afterHallSearch()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 식당 조회 후 실행 함수
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function fn_afterHallSearch(errCode, errMsg) 
{
	if(errCode==-1)
	{
		g_Message("EE","서비스 에러!\n\n전산 담당자에게 문의하세요.");
		return;
	}
	else
	{
		var nRow;
		// ds_hallList.InsertRow(0);
		// ds_hallList.setColumn(0, "HALL_CD", "");
		// ds_hallList.setColumn(0, "HALL_NAME", " ");   
		//g_debug("ds_hallList");
		nRow = ds_hallList.findRow("HALL_CLASS","010");	
		
		//cbo_hallCd.Index = 0;
		cbo_hallCd.index = nRow;
		
		ds_cond.setColumn(0, "HALL_CD", ds_hallList.getColumn(nRow,"HALL_CD"));
		
		//cbo_hallCd_OnChanged(,"999",,,ds_hallList.GetColumn(nRow,"HALL_CD"));
		//		cbo_hallCd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
		
		var e1 = new EventInfo;
		e1.posttext = cbo_hallCd.text;
		e1.postvalue = cbo_hallCd.value;
		e1.preindex = -1;
		e1.postindex = cbo_hallCd.index;

		cbo_hallCd_OnChanged(cbo_hallCd,e1); 
		//cbo_hallCd_OnChanged(cbo_hallCd,cbo_hallCd.value,"",-1,cbo_hallCd.index); 
		
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_afterMenuSearch()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 메뉴 조회 후 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function fn_afterMenuSearch(errCode, errMsg)
{
    ds_menuList.insertRow(0);
    ds_menuList.setColumn(0, "MENU_CD", "");
    ds_menuList.setColumn(0, "MENU_FEATURE", " ");
    
    ds_cond.setColumn(0, "MENU_CD", "");
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : grd_List_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
 * 기      능   : 그리드헤드 더블클릭시 Sort
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function grd_List_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
    gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);    
}
/*
 ******************************************************************************************
 * 함  수  명   : grd_List_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
 * 기      능   : 그리드헤드 더블클릭시 Sort
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function grd_recipe_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
    if ( e.cell != 0 ) {
        gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
    } 
    else
    {
		var iCnt=eval(obj.binddataset).getRowCount();
		var chk=eval(obj.binddataset).findRow("CHK",1);
		if(chk==-1)
		{
			for(i=0;i<iCnt;i++)
			{
				eval(obj.binddataset).setColumn(i,"CHK",1);
			}
		}
		else
		{
			for(i=0;i<iCnt;i++)
			{
				eval(obj.binddataset).setColumn(i,"CHK",0);
			}
		
		}
    }       
}
/*
 ******************************************************************************************
 * 함  수  명   : btn_Copy_OnClick
 * 기      능   : 복사 버튼 선택 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function btn_Copy_OnClick(obj:Button, e:ClickEventInfo)
{
    var fRow = ds_recipeList.findRow("CHK", "1");
    if ( fRow == -1 ) {
        gfn_alert(gfn_msg(SCCW00008, "복사할 레시피") );
        return;
    }
    
    ds_copyCond.clearData();
   
    // 복사할 레시피 정보 생성 
    for ( i = 0; i < ds_recipeList.getRowCount(); i++ ) {
        if( ds_recipeList.getColumn(i, "CHK") == "1" ) {
            var row = ds_copyCond.addRow();
            ds_copyCond.setColumn(row
                , "RECIPE_CD"
                , ds_recipeList.getColumn(i, "RECIPE_CD"));
                
            if ( ds_copyCond.getRowCount() == 1 ) {
                // 복사 대상 
                ds_copyCond.setColumn(0, "UPJANG", parent.parent.ds_cond.getColumn(0, "UPJANG"));
                ds_copyCond.setColumn(0, "MENU_CD", parent.parent.ds_cond.getColumn(0, "MENU_CD"));
                
                ds_copyCond.setColumn(0, "MENU_DATE", parent.parent.ds_cond.getColumn(0, "MENU_DATE"));
                ds_copyCond.setColumn(0, "HALL_CD", parent.parent.ds_cond.getColumn(0, "HALL_CD"));
                
                // 복사 원본 
                ds_copyCond.setColumn(0, "SRC_UPJANG", ds_cond.getColumn(0, "UPJANG"));
                ds_copyCond.setColumn(0, "SRC_MENU_CD", ds_cond.getColumn(0, "SINGLE_MENU_CD"));
                
                ds_copyCond.setColumn(0, "EXPECT_SALE_QTY", parent.parent.ds_cond.getColumn(0, "EXPECT_SALE_QTY"));
            }
        }
    }
    
    
    ds_list.setColumn(0, "SUBINV_CODE", ds_cond.getColumn(0, "SUBINV_CODE"));	//ds_list에 SUBINV_CODE컬럼명이 존재하지않음
    ds_copyCond.setColumn(0, "SUBINV_CODE", ds_cond.getColumn(0, "SUBINV_CODE"));
    
    fsp_clear(this);
    if ( rd_copyType.value == "1"){
        // 레시피 포함 
        fsp_addSingle(this, "fs/fsm:FSM00200E_I015"); //레시피 자재 복사 
        fsp_addSingle(this, "fs/fsm:FSM00200E_I016"); //레시피 조리법 복사 
        fsp_addSingle(this, "fs/fsm:FSM00200E_I014"); //레시피 복사 
    } else {
        // 레시피 미 포함 : 2
        fsp_addSingle(this, "fs/fsm:FSM00200E_I019"); //업장 표준 레시피 자재복사 
        fsp_addSingle(this, "fs/fsm:FSM00200E_I020"); //표준 레시피 자재 복사 
        fsp_addSingle(this, "fs/fsm:FSM00200E_I021"); //업장 표준 레시피 조리법복사 
        fsp_addSingle(this, "fs/fsm:FSM00200E_I022"); //표준 레시피 조리법 복사 
        fsp_addSingle(this, "fs/fsm:FSM00200E_I017"); //업장 표준 레시피 복사 
        fsp_addSingle(this, "fs/fsm:FSM00200E_I018"); //표준 레시피 복사 
    }
    
    fsp_callService(this, "", ""
            , "ds_list=ds_copyCond"
            , ""
            , ""
            , "fn_afterCopy"
            , true);
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_afterCopy
 * 기      능   : 복사 완료 후 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function fn_afterCopy(errCode, errMsg) {
    ds_recipeList.reset();
    fn_selectMenuList(-2);
}
/*
 ******************************************************************************************
 * 함  수  명   : cbo_type_OnChanged
 * 기      능   : 식단명 조회 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function cbo_type_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
    if ( gfn_length( strCode )== 0 ) {
        // 자료만 초기화 시킴. 
        ds_menuList.clearData();
    } else {
        fsp_clear(this);
        fsp_addSearch(this, "fs/fsm:FSM00200E_S001");
        fsp_callService(this, "", "", "ds_cond=ds_cond"
                , "ds_menuList=ds_menuList"
                , "", "", null, true);
    }
}
/*
 ******************************************************************************************
 * 함  수  명   : btn_viewRecipe_OnClick
 * 기      능   : 레시피 보기 버튼 선택 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function btn_viewRecipe_OnClick(obj:Button, e:ClickEventInfo)
{
	// 해당 Row의 레시피 상세 창 보여주기 
	if ( ds_list.rowposition < 0 ) {
        return;
    }
    
    var nRow = ds_list.rowposition;
    
	// 해당 Row의 레시피 상세 창 보여주기 
// 	var arg = "fa_menuCd=" + wrapQuote( ds_list.getColumn(nRow, "MENU_CD"))
//         + " fa_menuNm=" + wrapQuote( ds_list.getColumn(nRow, "MENU_FEATURE"))
//         //+ " fa_menu_date=" + quote( ds_list.getColumn(nRow, "MENU_DATE"))
//         + " fa_menu_date=" + wrapQuote(parent.ds_cond.getColumn(0, "MENU_DATE"))
//         + " fa_mainupjang=" + wrapQuote( parent.ds_cond.getColumn(0, "UPJANG"))
//         + " fa_upjang=" + wrapQuote( ds_list.getColumn(nRow, "UPJANG"))
//         + " fa_subinv=" + wrapQuote( parent.ds_cond.getColumn(0, "SUBINV_CODE"))
//         + " fa_gubun=U";
	var arg = {fa_menuCd:ds_list.getColumn(nRow, "MENU_CD"), fa_menuNm:ds_list.getColumn(nRow, "MENU_FEATURE"),
				fa_menu_date:parent.parent.ds_cond.getColumn(0, "MENU_DATE"), fa_mainupjang:parent.parent.ds_cond.getColumn(0, "UPJANG"),
				fa_upjang:ds_list.getColumn(nRow, "UPJANG"), fa_subinv:parent.parent.ds_cond.getColumn(0, "SUBINV_CODE"), fa_gubun:"U"};
	gfn_openPopup("U_FSM::FSM00204P.xfdl", true, -1, -1, arg);
}
/*
 ******************************************************************************************
 * 함  수  명   : ds_list_OnRowPosChanged
 * 기      능   : 목록에서 row 변경시 레시피 조회 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function ds_list_OnRowPosChanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
    
}
/*
 ******************************************************************************************
 * 함  수  명   : btn_upjangCd_OnClick
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 업장 조회 
 * 작  성  자   : 조은영
 * 작성  일자   : 2007-11-30
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function btn_upjangCd_OnClick(obj:Button, e:ClickEventInfo)
{
    // 2008.06.24 김동표 복수업장 관리 및 업장 그룹 적용 
	var strSQL;
	
	strSQL =  "SELECT A.UPJANG, ";
    strSQL += "   A.UPJANGNM ";
    strSQL += "  FROM SCO_UPJANG_MST_V A ";
    strSQL += " WHERE (1 = 1) ";
    strSQL += "   AND (FICS_YN = 'N' ) ";
    strSQL += "   AND (A.UPJANG = '" + g_Upjang + "'  ";
    strSQL += "    OR A.UPJANG IN ";
    strSQL += "       ( ";
    strSQL += "       SELECT UPJANG ";
    strSQL += "         FROM FSA_UPJANG_GRP A ";
    strSQL += "        WHERE EXISTS ";
    strSQL += "              ( ";
    strSQL += "              SELECT 1 ";
    strSQL += "                FROM FSA_UPJANG_GRP X ";
    strSQL += "               WHERE X.GRP_SEQ = A.GRP_SEQ ";
    strSQL += "                 AND X.UPJANG = '" + g_Upjang + "'  ";
    strSQL += "              ) ";
    strSQL += "       ) ";
    strSQL += "    OR A.UPJANG IN ";
    strSQL += "       ( ";
    strSQL += "       SELECT UPJANG ";
    strSQL += "         FROM MAS_DUALUPJANG_MGMT ";
    strSQL += "        WHERE SABUN = '" + g_EmpNo + "'  ";
    strSQL += "       ) ";
    strSQL += "  ) ";
	// 2008.06.24 복수업장 관리 및 업장 그룹 적용

    fn_sql_common_setup(strSQL, 
						strMAQuery_UpjangKeyField, 
						strMAQuery_UpjangValueField, 
						strMAQuery_UpjangKeyFieldNM, 
						strMAQuery_UpjangValueFieldNM, 
						"", 
						"",
						"",   
						strMAQuery_UpjangCaption);
    
    var upjang = "";
    var upjangNm = "";
    
    if (gds_sql_common.getColumn(0, "ret_code") != "")  {
		upjang = gds_sql_common.getColumn(0, "ret_code");
        upjangNm = gds_sql_common.getColumn(0, "ret_name");
        ed_upjangCd.value = upjang;
        ed_upjangNm.value = upjangNm;
    }
}
/*
 ******************************************************************************************
 * 함  수  명   : ed_upjangNm_OnKeyDown
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 업장 조회 
 * 작  성  자   : 조은영
 * 작성  일자   : 2007-11-30
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function ed_upjangNm_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if ( e.keycode == 13 ) {
        btn_upjangCd.click();
	} else if ( e.keycode == 46 ) {
        ed_upjangCd.value = "";
        ed_upjangNm.value = "";
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : grd_list_OnCellDblClick
 * 기      능   : 상세 레시피 조회 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function grd_list_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
	// 레시피 검색 
	gfn_clearGrid(grd_recipe);
	chk_all.value = false;

	if ( e.row < 0 ) {
        ds_recipeList.CearData();
        return;
	}
	
	ds_cond.setColumn(0, "SINGLE_MENU_CD", ds_list.getColumn(e.row, "MENU_CD"));
	// 레시피 조회 
	fsp_clear(this);
    fsp_addSearch(this, "fs/fsm:FSM00200E_S011");
    fsp_callService(this, "", ""
            , "ds_cond=ds_cond"
            , "ds_recipeList=ds_recipeList"
            , ""
            , "", true);
}
/*
 ******************************************************************************************
 * 함  수  명   : chk_all_OnClick
 * 기      능   : 전체 선택 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function chk_all_OnClick(obj:CheckBox, e:ClickEventInfo)
{
	var v = obj.isChecked();
	ds_recipeList.enableevent = false;
	for( var i = 0; i < ds_recipeList.getRowCount(); i++ ) {
        var fRow = ds_upjangRecipe.findRow("RECIPE_CLASS"
            , ds_recipeList.getColumn(i, "RECIPE_CLASS"));
        if ( fRow >= 0  ) {
            // 이미 구축되어 있는지 여부 
            var row = parent.ds_list.findRow("RECIPE_CD"
                , ds_recipeList.getColumn(i, "RECIPE_CD")); 
            if ( row == -1 ) {
                ds_recipeList.setColumn(i, "CHK", v);
            }    
        }
	}
	
	ds_recipeList.enableevent = true;
}
/*
 ******************************************************************************************
 * 함  수  명   : ds_recipeList_OnColumnChanged
 * 기      능   : 변경 시 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function ds_recipeList_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if ( e.columnid == "CHK" && e.newvalue == "1" ) {
        var fRow = ds_upjangRecipe.findRow("RECIPE_CLASS"
            , ds_recipeList.getColumn(e.row, "RECIPE_CLASS") ) ;
        if ( fRow == -1 ) {
            gfn_alert("선택한 레시피의 레시피유형이 \n업장의 레시피 유형으로 등록되어 있지 않습니다.");
            ds_recipeList.setColumn(e.row, e.columnid, "0");
            return;
        }
        
        // 이미 구축되어 있는지 여부 
        fRow = parent.parent.ds_list.findRow("RECIPE_CD"
            , ds_recipeList.getColumn(e.row, "RECIPE_CD")); 
        if ( fRow != -1 ) {
            gfn_alert("선택한 레시피가 이미 식단 레시피로 등록되어 있습니다.");
            ds_recipeList.setColumn(e.row, e.columnid, "0");
            return;
        } 
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : ds_cond_OnColumnChanged
 * 기      능   : 조회 조건 변경 시 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function ds_cond_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
    switch( strColumnID) {
        case "UPJANG_NM":   // 사업장이 변경될 경우 식당 조회 
            if ( gfn_length(varNewValue)== 0 ) {
                ds_hallList.clearData();
                cbo_hallCd.value = "";
                ds_menuList.clearData();
                cbo_menu.value = "";
            } else {
                // 다시 조회 
                fsp_clear(this);
                fsp_addSearch(this, "fs/fsm:FSM00200E_S002");
                fsp_callService(this, "", ""
                        , ""
                        , "ds_hallList=ds_hallList"
                        , "UPJANG=" + ed_upjangCd.value
                        , "fn_afterHallSearch"
                        , true, true);
            }
            break;
        case "HALL_CD": // 식당이 변경될 경우 식단특성 조회 
            if ( gfn_length(varNewValue)== 0 ) {
                ds_menuList.clearData();
                cbo_menu.value = "";
            } else {
                // 다시 조회 
                fsp_clear(this);
                fsp_addSearch(this, "fs/fsm:FSM00200E_S009");
                fsp_callService(this, "", ""
                        , ""
                        , "ds_menuList=ds_menuList"
                        , "UPJANG=" + ed_upjangCd.value + " HALL_CD=" + wrapQuote(varNewValue)
                        , "fn_afterMenuSearch"
                        , true, true);
                
            }
            break;
    }
}

function ed_upjangNm_OnChanged(obj:Edit, e:TextChangedEventInfo)
{
	fn_Upjang_Find();
}

function ds_cond_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if(e.columnid == "UPJANG_NM"){
		fn_Upjang_Find();
	}	
}


function fn_Upjang_Find()
{
	fsp_clear(this);
	fsp_addSearch(this, "fs/fsm:FSM00200E_S015");
	fsp_callService(this, "", ""
			, ""
			, "ds_hallList=ds_hallList"
			, "UPJANG=" + ed_upjangCd.value
			, "fn_afterHallSearch"
			, true, true);
}
function cbo_hallCd_OnChanged(obj, e)
{
	var hallCd;
	if (e.postvalue == "999") {
		hallCd =""; // hallCd = nNewIndex;
	}
	else {
		//hallCd = ds_hallList.GetColumn(nNewIndex,"HALL_CD");
		hallCd = e.postvalue;
	}
	if(gfn_length(gfn_trim(ed_upjangCd.value))==0)
	{
		ds_menuList.clearData();
		return;
	}
		
	var	nRow = ds_hallList.findRow("HALL_CLASS","010");	
	if(	e.postindex==nRow && nRow!=-1)
	{
		grd_recipe.formatid="default0";
	}
	else
	{
		grd_recipe.formatid="default";
	}
	//  ds_hallList.GetColumn(nNewIndex,"HALL_CD");
	fsp_clear(this);
	fsp_addSearch(this, "fs/fsm:FSM00200E_S009");
	fsp_callService(this, "", ""
			, ""
			, "ds_menuList=ds_menuList"
			, "UPJANG=" + ed_upjangCd.value + " HALL_CD=" + wrapQuote(hallCd)
			, "fn_afterMenuSearch"
			, true, true);	
}

function fn_T1_clear()
{
	ds_list.clearData();
	ds_recipeList.clearData();
}
function FSM00202V_OnActivate(obj:Form, e:ActivateEventInfo)
{
	if(gfn_length(gfn_trim(ed_upjangNm.value))==0)
	{ 
        ed_upjangCd.value=ds_ClearChk.getColumn(0,"UPJANG");
        ed_upjangNm.value=ds_ClearChk.getColumn(0,"UPJANGNM");		
		//fn_Upjang_Find();
	}
}

function cbo_menu_OnChar(obj:Combo, e:CharEventInfo)
{
   if ( e.chartext == 13 ) {
//        fn_Search();
        return;
    }
    
	obj.userdata = e.posttext;
}

function cbo_menu_OnKillFocus(obj:Combo, e:KillFocusEventInfo)
{
    if ( gfn_length( obj.userdata)== 0 ) {
        return;
    }
    
	var dsObj = eval(obj.innerdataset);
	var row = dsObj.findRow("MENU_FEATURE", obj.userdata);
	
	if ( row == -1 ) {
        row = dsObj.addRow();
        dsObj.setColumn(row, "MENU_CD", obj.userdata);
        dsObj.setColumn(row, "MENU_FEATURE", obj.userdata);
        obj.value = obj.userdata;
	}
	
	obj.userdata = "";
}
function cbo_recipe_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
//trace("obj.userchange=="+obj.userchange+":::::e.pretext=="+e.pretext+"::::::e.posttext=="+e.posttext);
	if ( obj.userchange == "2" ) {
		obj.userchange = "0";
		obj.userdata   = e.posttext;
		
		btn_Search.setFocus();
		btn_Search.click();
		cbo_recipe.setFocus();
	} else {
		obj.userchange = "1";
		obj.userdata = e.posttext;
	}
}

function cbo_recipe_onkeydown(obj:Combo, e:KeyEventInfo)
{
if (e.keycode == 13 && obj.userchange == "1") {
		var strValue,nFRow,objDs,strDataColumn;
		
		strValue 		= obj.userdata;
	//	objDs			= eval(obj.innerdataset);
		strDataColumn	= obj.datacolumn;
		
		if (gfn_length(strValue)>0) {
			nFRow = ds_recipe.findRow(strDataColumn,strValue);
			
			if (nFRow == -1)
			{
				var nRow = ds_recipe.addRow();
				ds_recipe.setColumn(nRow,strDataColumn,strValue);
				obj.index = nRow;
			} else {
				obj.index = nFRow;
			}
		}
		btn_Search.setFocus();
		btn_Search.click();
		cbo_recipe.setFocus();
		
	} else if (e.keycode == 38 || e.keycode == 40) {
		if ( obj.isDropdown() ) {
			obj.userchange = "2";
		} else {
			obj.userchange = "1";
		}
	}
}

function cbo_recipe_onkillfocus(obj:Combo, e:KillFocusEventInfo)
{
var strValue,nFRow,objDs,strDataColumn;
	
	strValue 		= obj.userdata;
	//objDs			= eval(obj.innerdataset);
	strDataColumn	= obj.datacolumn;
	
	if (gfn_length(strValue) > 0) {
		nFRow = ds_recipe.findRow(strDataColumn,strValue);
		
		if (nFRow == -1)
		{
			var nRow = ds_recipe.addRow();
			ds_recipe.setColumn(nRow,strDataColumn,strValue);
			obj.value = strValue;
		} else {
			obj.value = strValue;
		}
	} else {
		obj.index 		= 0;
	}
}

function cbo_recipe_ontextchanged(obj:Combo, e:TextChangedEventInfo)
{
	obj.userdata   = e.posttext;
	obj.userchange = "1";
}
]]></Script>
  </Form>
</FDL>

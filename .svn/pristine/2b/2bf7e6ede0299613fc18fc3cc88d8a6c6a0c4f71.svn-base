<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="MAS10340E" onkeydown="fn_form_OnKeyDown" onload="form_onload" titletext="전도금정산자동전표" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Grid autoenter="select" binddataset="ds_list" cellsizingtype="both" readonly="false" enable="true" cellsizebandtype="allband" id="grid_Slip" useinputpanel="false" onheadclick="grid_Slip_OnHeadClick" taborder="12" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 144 1237 696" selecttype="row" autofittype="col" anchor="all">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="27"/>
                <Column size="0"/>
                <Column size="65"/>
                <Column size="146"/>
                <Column size="87"/>
                <Column size="78"/>
                <Column size="78"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="44"/>
                <Column size="225"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="현예산잔액"/>
                <Cell col="2" displaytype="text" text="예산체크"/>
                <Cell col="3" displaytype="text" text="계정코드"/>
                <Cell col="4" displaytype="text" text="귀속부서"/>
                <Cell col="5" displaytype="text" text="예산부서"/>
                <Cell col="6" displaytype="text" text="관리유형"/>
                <Cell col="7" displaytype="text" text="차변"/>
                <Cell col="8" displaytype="text" text="대변"/>
                <Cell col="9" displaytype="text" text="결재"/>
                <Cell col="10" displaytype="text" text="적요"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="number" style="align:left;" text="bind:YAESAN_JAN"/>
                <Cell col="2" displaytype="text" style="align:center;background:EXPR(iif(YAESAN_CHK_DESC == null, 'white', 'red'));background2:EXPR(iif(YAESAN_CHK_DESC == null, '#F6FCFC', 'red'));" text="bind:YAESAN_CHK_DESC"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:ACCTCDNM"/>
                <Cell col="4" displaytype="text" style="align:left;" text="bind:RTNDEPT_IDNM"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:BUDDEPT_IDNM"/>
                <Cell col="6" displaytype="text" style="align:left;" text="bind:BUD_CLS_NM"/>
                <Cell col="7" displaytype="number" style="align:right;" text="bind:DRAMT"/>
                <Cell col="8" displaytype="number" style="align:right;" text="bind:CRAMT"/>
                <Cell col="9" displaytype="text" style="align:left;" text="bind:PAYMENT_GROUP"/>
                <Cell col="10" displaytype="text" style="align:left;" text="bind:DESCRIPTION_NM"/>
              </Band>
              <Band id="summary">
                <Cell colspan="5" displaytype="text" style="align:center;" text="합계"/>
                <Cell col="5" displaytype="number" style="align:left;"/>
                <Cell col="6" displaytype="number" style="align:left;"/>
                <Cell col="7" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('DRAMT')"/>
                <Cell col="8" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('CRAMT')"/>
                <Cell col="9" displaytype="number" style="align:left;"/>
                <Cell col="10" displaytype="number" style="align:left;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static2" text="♨기준일자는 평달의 경우 25일, 분기월(3,6,9,12)의 경우 25일(1차), 해당월 말일자(2차) 입니다." position="absolute 714 128 1301 141" anchor="right"/>
        <Static id="Static3" text="잡급의 경우 ehr상의 지급일자와 전도금정산의 정산일자가 동일하여야 합니다.(ehr에서 강제로 인터페이스할 경우 인사팀 박지우씨에게 요청바랍니다.)" position="absolute 2 696 928 712" anchor="left bottom"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="17" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static09" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 93 40"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 93 71"/>
        <Static id="Static10" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61"/>
        <Static id="Static22" text="전도금정산자동전표" class="sta_WF_Title01" position="absolute 0 126 450 144"/>
        <Static id="Static17" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 113 450 126"/>
        <Static id="Static18" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 139 1242 144"/>
        <Static id="Static14" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 33 40 43 61"/>
        <Static id="Static15" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 571 40 601 61"/>
        <Static id="Static5" text="기준일자" position="absolute 404 40 468 61" class="sta_WFSA_label"/>
        <MaskEdit id="me_Date" mask="####-##-##" ontextchanged="me_Date_OnChanged" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="3" type="string" position="absolute 473 40 551 61" class="msk_WF_EssentialCal"/>
        <Button id="edtBtn_Date" onclick="edtBtn_Date_OnClick" taborder="9" tabstop="false" userdata="me_Date" position="absolute 550 40 571 61" class="btn_WF_popSearchEssential" text="" image=""/>
        <Edit id="edt_UPDEPT_IDQuery" imemode="native" ontextchanged="edt_UPJANGQuery_OnChanged" onkeydown="edt_UPJANGQuery_OnKeyDown" readonly="true" taborder="1" position="absolute 43 40 143 61" class="edt_WF_Essential"/>
        <Button id="edtBtn_UPDEPT_IDQuery" onclick="edtBtn_UPJANGQuery_OnClick" taborder="10" tabstop="false" position="absolute 142 40 163 61" class="btn_WF_popSearchEssential" text="" image=""/>
        <Static id="st_UPDEPT_IDQuery" text="팀" userdata="strMAQuery_UP_DEPT_ID" position="absolute 15 40 39 61" class="sta_WFSA_label"/>
        <Static id="st_UPJANGQuery" text="업장" userdata="strMAQuery_Upjang" position="absolute 193 40 233 61" class="sta_WFSA_label"/>
        <Edit id="edt_UPJANGQuery" imemode="native" ontextchanged="edt_UPJANGQuery_OnChanged" onkeydown="edt_UPJANGQuery_OnKeyDown" readonly="true" taborder="2" position="absolute 236 40 354 61" class="edt_WF_Essential"/>
        <Button id="edtBtn_UPJANGQuery" onclick="edtBtn_UPJANGQuery_OnClick" taborder="14" tabstop="false" position="absolute 353 40 374 61" class="btn_WF_popSearchEssential" text="" image=""/>
        <Static id="Static04" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 226 40 236 61"/>
        <Static id="Static07" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 163 40 193 61"/>
        <Static id="Static11" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 374 40 404 61"/>
        <Static id="Static13" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 463 40 473 61"/>
        <Static id="Static19" class="sta_WFDA_Labelbg" position="absolute 261 86 385 113" anchor="left"/>
        <Static id="Static00" class="sta_WFDA_Labelbg" position="absolute 79 86 183 113" anchor="left"/>
        <Static id="Static01" text="번호" class="sta_WFDA_Label01" position="absolute 182 86 262 113" anchor="left"/>
        <Static id="Static0" text="전표일자" class="sta_WFDA_Label01" position="absolute 0 86 80 113" userdata="strMAQuery_UPJANG_CUST" anchor="left"/>
        <Static id="Static20" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 71 1252 86" anchor="left bottom"/>
        <MaskEdit id="me_GADATE" mask="####-##-##" ontextchanged=" me_GADATE_OnChanged" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="4" type="string" position="absolute 82 89 160 110" anchor="left"/>
        <Button id="Button0" onclick="edtBtn_Date_OnClick" taborder="13" tabstop="false" userdata="me_GADATE" position="absolute 159 89 180 110" class="btn_WF_popSearch" text="" image="" anchor="left"/>
        <MaskEdit id="me_GANO" mask="###,##0" ontextchanged="me_Date_OnChanged" taborder="5" position="absolute 264 89 315 110" anchor="left"/>
        <Button id="btn_InitSlip" onclick="btn_InitSlip_OnClick" taborder="6" text="초기화" position="absolute 318 89 381 110" class="btn_WF_Custom" image="" anchor="left"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond"/>
      <Dataset id="ds_list">
        <ColumnInfo>
          <Column id="ACCTCD" size="7" type="STRING"/>
          <Column id="ADITEM1" size="30" type="STRING"/>
          <Column id="ADITEM2" size="30" type="STRING"/>
          <Column id="ADITEM3" size="30" type="STRING"/>
          <Column id="ADITEM4" size="30" type="STRING"/>
          <Column id="ADITEM5" size="30" type="STRING"/>
          <Column id="ADITEM6" size="30" type="STRING"/>
          <Column id="ADITEM7" size="30" type="STRING"/>
          <Column id="ADITEM8" size="30" type="STRING"/>
          <Column id="ASSET_ADDITION_FLAG" size="1" type="STRING"/>
          <Column id="ATTRIBUTE1" size="30" type="STRING"/>
          <Column id="ATTRIBUTE10" size="2" type="STRING"/>
          <Column id="ATTRIBUTE2" size="2" type="STRING"/>
          <Column id="ATTRIBUTE3" size="10" type="STRING"/>
          <Column id="ATTRIBUTE4" size="50" type="STRING"/>
          <Column id="ATTRIBUTE5" size="2" type="STRING"/>
          <Column id="ATTRIBUTE6" size="2" type="STRING"/>
          <Column id="ATTRIBUTE7" size="2" type="STRING"/>
          <Column id="ATTRIBUTE8" size="2" type="STRING"/>
          <Column id="ATTRIBUTE9" size="2" type="STRING"/>
          <Column id="BUD_CLS" size="6" type="STRING"/>
          <Column id="BUDDEPT_ID" size="22" type="BIGDECIMAL"/>
          <Column id="CARDNO" size="20" type="STRING"/>
          <Column id="CRAMT" size="22" type="BIGDECIMAL"/>
          <Column id="CREATE_BY" size="9" type="STRING"/>
          <Column id="CREATE_DATE" size="7" type="DATE"/>
          <Column id="DCGUBUN" size="1" type="STRING"/>
          <Column id="DESCRIPTION_CD" size="2" type="STRING"/>
          <Column id="DESCRIPTION_NM" size="100" type="STRING"/>
          <Column id="DRAMT" size="22" type="BIGDECIMAL"/>
          <Column id="ENTRY_YAESAN_DATE" size="8" type="STRING"/>
          <Column id="ENTRY_YAESAN_GUBUN" size="1" type="STRING"/>
          <Column id="EUEM_ACNTCD" size="25" type="STRING"/>
          <Column id="EUEM_ACNTCD_FIX" size="25" type="STRING"/>
          <Column id="EUEM_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="EUEM_BALDATE" size="8" type="STRING"/>
          <Column id="EUEM_BILLNO" size="14" type="STRING"/>
          <Column id="EUEM_CUSTCD" size="22" type="BIGDECIMAL"/>
          <Column id="EUEM_GADATE" size="8" type="STRING"/>
          <Column id="EUEM_GALINE" size="22" type="BIGDECIMAL"/>
          <Column id="EUEM_GAMU" size="2" type="STRING"/>
          <Column id="EUEM_GANO" size="22" type="BIGDECIMAL"/>
          <Column id="EUEM_KIND" size="1" type="STRING"/>
          <Column id="EUEM_MANDATE" size="8" type="STRING"/>
          <Column id="EUEM_STATUS" size="1" type="STRING"/>
          <Column id="GADATE" size="8" type="STRING"/>
          <Column id="GADEPT_ID" size="22" type="BIGDECIMAL"/>
          <Column id="GAGUBUN" size="3" type="STRING"/>
          <Column id="GAGUBUN_DETAIL" size="3" type="STRING"/>
          <Column id="GALINE" size="22" type="BIGDECIMAL"/>
          <Column id="GAMU" size="2" type="STRING"/>
          <Column id="GANO" size="22" type="BIGDECIMAL"/>
          <Column id="JUBDAE_ADDRESS" size="80" type="STRING"/>
          <Column id="JUBDAE_BAL_DATE" size="8" type="STRING"/>
          <Column id="JUBDAE_BONGSARYO" size="22" type="BIGDECIMAL"/>
          <Column id="JUBDAE_CNT" size="22" type="BIGDECIMAL"/>
          <Column id="JUBDAE_CUSTNM" size="50" type="STRING"/>
          <Column id="JUBDAE_DRNAME" size="50" type="STRING"/>
          <Column id="JUBDAE_GUBUN" size="3" type="STRING"/>
          <Column id="JUBDAE_JUBDAEBI" size="22" type="BIGDECIMAL"/>
          <Column id="JUBDAE_SAUPNO" size="10" type="STRING"/>
          <Column id="PAYMENT_DUEDATE" size="8" type="STRING"/>
          <Column id="PAYMENT_FORMAT" size="3" type="STRING"/>
          <Column id="PAYMENT_GROUP" size="3" type="STRING"/>
          <Column id="POST_DATE" size="8" type="STRING"/>
          <Column id="POSTING" size="1" type="STRING"/>
          <Column id="PROJECT_ID" size="8" type="STRING"/>
          <Column id="RRN_GUBUN" size="1" type="STRING"/>
          <Column id="RTNDEPT_ID" size="22" type="BIGDECIMAL"/>
          <Column id="SLPAMT" size="22" type="BIGDECIMAL"/>
          <Column id="SUPDATE" size="8" type="STRING"/>
          <Column id="TAXNO" size="30" type="STRING"/>
          <Column id="UPDATE_BY" size="9" type="STRING"/>
          <Column id="UPDATE_DATE" size="7" type="DATE"/>
          <Column id="VAT_CUSTCD" size="22" type="BIGDECIMAL"/>
          <Column id="VAT_UPJANG" size="22" type="BIGDECIMAL"/>
          <Column id="VATAMT" size="22" type="BIGDECIMAL"/>
          <Column id="VATDECD" size="3" type="STRING"/>
          <Column id="VATGUCD" size="3" type="STRING"/>
          <Column id="YIJE_GUBUN" size="1" type="STRING"/>
          <Column id="ACCTCDNM" size="256" type="STRING"/>
          <Column id="RTNDEPT_IDNM" size="256" type="STRING"/>
          <Column id="str_UpGADEPT_ID" size="256" type="STRING"/>
          <Column id="str_DATEBETWEEN" size="256" type="STRING"/>
          <Column id="BUDDEPT_IDNM" size="256" type="STRING"/>
          <Column id="ADV_ID" size="256" type="BIGDECIMAL"/>
          <Column id="TAX_IF_GB" size="256" type="STRING"/>
          <Column id="TAX_SEND_GB" size="256" type="STRING"/>
          <Column id="YAESAN_CHK" size="256" type="STRING"/>
          <Column id="BUD_CLS_NM" size="256" type="STRING"/>
          <Column id="YAESAN_JAN" size="256" type="BIGDECIMAL"/>
          <Column id="YAESAN_CHK_DESC" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Updatecond"/>
      <Dataset id="ds_listSource">
        <ColumnInfo>
          <Column id="ACCTCD" size="255" type="STRING"/>
          <Column id="ACCTCDNM" size="255" type="STRING"/>
          <Column id="ADITEM1" size="255" type="STRING"/>
          <Column id="ADITEM2" size="255" type="STRING"/>
          <Column id="ADITEM3" size="255" type="STRING"/>
          <Column id="ADITEM4" size="255" type="STRING"/>
          <Column id="ADJ_AMT" size="0" type="BIGDECIMAL"/>
          <Column id="ADJ_KIND" size="255" type="STRING"/>
          <Column id="ADV_ID" size="0" type="BIGDECIMAL"/>
          <Column id="ADV_KIND" size="255" type="STRING"/>
          <Column id="BUD_CLS" size="255" type="STRING"/>
          <Column id="BUDDEPT_ID" size="0" type="BIGDECIMAL"/>
          <Column id="BUDDEPT_IDNM" size="255" type="STRING"/>
          <Column id="BULGONG_YN" size="255" type="STRING"/>
          <Column id="CUSTCD" size="0" type="BIGDECIMAL"/>
          <Column id="DESCRIPTION_NM" size="255" type="STRING"/>
          <Column id="NOPAY_AMT" size="0" type="BIGDECIMAL"/>
          <Column id="PROJECT_ID" size="255" type="STRING"/>
          <Column id="RCP_ADDR" size="255" type="STRING"/>
          <Column id="RCP_AMT" size="0" type="BIGDECIMAL"/>
          <Column id="RCP_BALDATE" size="255" type="STRING"/>
          <Column id="RCP_CNT" size="0" type="BIGDECIMAL"/>
          <Column id="RCP_CUSTNM" size="255" type="STRING"/>
          <Column id="RCP_DRNAME" size="255" type="STRING"/>
          <Column id="RCP_GUBUN" size="255" type="STRING"/>
          <Column id="RCP_SAUPNO" size="255" type="STRING"/>
          <Column id="RTNDEPT_ID" size="0" type="BIGDECIMAL"/>
          <Column id="RTNDEPT_IDNM" size="255" type="STRING"/>
          <Column id="SCHOOL_YN" size="255" type="STRING"/>
          <Column id="SVC_AMT" size="0" type="BIGDECIMAL"/>
          <Column id="TAX_DATE" size="255" type="STRING"/>
          <Column id="VAT" size="0" type="BIGDECIMAL"/>
          <Column id="VAT_UPJANG" size="0" type="BIGDECIMAL"/>
          <Column id="GADATE" size="8" type="STRING"/>
          <Column id="GAMU" size="2" type="STRING"/>
          <Column id="GANO" size="22" type="BIGDECIMAL"/>
          <Column id="TAX_IF_GB" size="256" type="STRING"/>
          <Column id="TAX_SEND_GB" size="256" type="STRING"/>
          <Column id="TAXNO" size="256" type="STRING"/>
          <Column id="YAESAN_CHK" size="256" type="STRING"/>
          <Column id="BUD_CLS_NM" size="256" type="STRING"/>
          <Column id="YAESAN_JAN" size="256" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listSourceGHR">
        <ColumnInfo>
          <Column id="RTNDEPT_ID" size="0" type="BIGDECIMAL"/>
          <Column id="ENTER_CD" size="255" type="STRING"/>
          <Column id="ITAX_MON" size="0" type="BIGDECIMAL"/>
          <Column id="PAY_YMD" size="255" type="STRING"/>
          <Column id="RTAX_MON" size="0" type="BIGDECIMAL"/>
          <Column id="SABUN" size="255" type="STRING"/>
          <Column id="TOTAL_MON" size="0" type="BIGDECIMAL"/>
          <Column id="RTNDEPT_IDNM" size="256" type="STRING"/>
          <Column id="GADATE" size="8" type="STRING"/>
          <Column id="GAMU" size="2" type="STRING"/>
          <Column id="GANO" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_HLDC_GA_INTERFACE">
        <ColumnInfo>
          <Column id="GAMU" size="256" type="STRING"/>
          <Column id="GADATE" size="256" type="STRING"/>
          <Column id="GANO" size="256" type="BIGDECIMAL"/>
          <Column id="GUBUN" size="256" type="STRING"/>
          <Column id="MODULE_GUBUN" size="256" type="STRING"/>
          <Column id="UPJANG" size="256" type="BIGDECIMAL"/>
          <Column id="lngRtn" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : FS시스템/시스템공통/템플릿 1
 * 프로그램명   : Sam_Form_Basic1.XML
 * 기      능   : 표준 UI Form
 * 작  성  자   : 구종화
 * 작성  일자   : 2007-11-16
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::ma_common.js"


//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var f_Saved_ID,
	f_CurrDate,
	f_GAMU,
	f_LAST_DATE,
	f_GANO,
	f_ORDNO,
	f_AfterCallServerCheck;
	
var f_ROLE_YN;  

var str_LastDate;
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

    var F_ArrCol          = new Array(-1);
    var F_ArrColType      = new Array(-1);
    
	//init_btn_setup();	// Button 초기화
	fsp_init(this);


	/*
	#############################################################################################################
	공통코드 SETTING
	#############################################################################################################
	*/
			
	edt_UPDEPT_IDQuery.userdata = g_Tm_Cd;
	edt_UPDEPT_IDQuery.value     = g_Tm_Nm;
					
						
	edt_UPJANGQuery.userdata    = g_Upjang;
	edt_UPJANGQuery.value        = g_UpjangNm;
							
    f_CurrDate = fn_CurrDateWeek();
	//me_TRANS_MONTHFR.Value   = Substr(f_CurrDate, 0, 6) + "01";		
	//me_Date.Value   = Substr(f_CurrDate, 0, 6);			  
    
    f_ROLE_YN = fn_GetLocalUserRole(ds_cond);
    if (f_ROLE_YN == "Y"){
    
    }
    else {  
        
		//사업장 권한 셋팅#############################################################################
		fn_SetAuth("edt_UPDEPT_IDQuery","edtBtn_UPDEPT_IDQuery","edt_UPJANGQuery", "edtBtn_UPJANGQuery");
		//사업장 권한 셋팅#############################################################################     
	}
	/*
	#############################################################################################################
	공통코드 SETTING
	#############################################################################################################
	*/
}





//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
function fn_search()
{
	if (!before_SelectCheck())
		return;


	//리스트############################################################
    fsp_clear(this);
    
	fsp_addSearch(this, "ma/mas:MAS10340E_S002");	   
    fsp_addSearch(this, "ma/mas:MAS10340E_S003");	
    
	ds_cond.clear();
	
	ds_cond.addColumn("UPJANG","INT",256);		
	ds_cond.addColumn("TRX_DATE","STRING",256);
				
	ds_cond.addRow();
	
	ds_cond.setColumn(ds_cond.rowposition, "UPJANG",      edt_UPJANGQuery.userdata);	
	
	ds_cond.setColumn(ds_cond.rowposition, "TRX_DATE",    me_Date.value);
	
       					
	fn_DataSetAllClear();

    http.Sync = true;
	fsp_callService(this, "", "", "ds_cond=ds_cond","ds_listSource=ds_listSource ds_listSourceGHR=ds_listSourceGHR","","fn_SearchDetail()");
	http.Sync = false;	
	//리스트############################################################
}

function fn_insert()
{
/*
	if (!before_SelectCheck()) return;
	
	ds_listInput.clearData();

	//edtBtn Component 초기화############################
	Set_edtBtn_UserData("Clear");	
	//edtBtn Component 초기화############################

	ds_listInput.addRow();
	ds_listInput.SetColumn(ds_listInput.row, "UPJANG", edt_UPJANGQuery.UserData);	  
	ds_listInput.SetColumn(ds_listInput.row, "UPJANGNM", edt_UPJANGQuery.Text);
		 		
	ds_listInput_OnColumnChanged(ds_listInput,0,"TRANS_DD","",ds_listInput.GetColumn(ds_listInput.row, "TRANS_DD"),0);
	//Setds_listInput_OnColumnChanged();
		 
	//Disabled항목 Enabled처리####################################
	me_TRANS_DD.Enable        = True;
	
	edt_TRANS_GUBUN.Enable    = True;
	edtBtn_TRANS_GUBUN.Enable = True;
	
	edt_ITEM_TYPE.Enable      = True;
	edtBtn_ITEM_TYPE.Enable   = True;
	
	edt_ITEM_CODE.Enable      = True;
	edtBtn_ITEM_CODE.Enable   = True;
		
	me_TICKET_STARTNUM.Enable = True;
	me_TICKET_ENDNUM.Enable   = True;	
    //Disabled항목 Enabled처리####################################
		 
	me_TRANS_DD.SetFocus();
*/	
}

function fn_delete()
{
/*
    if (!before_DeleteCheck("Master") ){

		return;
    }
*/    
}

function fn_save()
{

    if (!before_SaveCheck("Master") ){
       
        /*
        if (NumFormat(f_Saved_ID) == "0"){
			
			ds_listInput.SetColumn(ds_listInput.row, "TRX_ID", "");
        }
        */
        
		return;
    }
}


function fn_print()
{	
    if (gfn_length(me_GADATE.value)== 0){    

		g_Message("EE", "전표일자가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 
        me_GADATE.setFocus();
        return false;
    }    
	
    if (numFormat(me_GANO.value)== "0"){    

		g_Message("EE", "전표번호가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 
        me_GANO.setFocus();
        return false;
    } 
    
    var strParam;
    
	strParam = "회계관리/전표.asp";			// Page Title
	//strParam += "&url=회계관리/전표.ozr";	    // OZ Report File Name
	//strParam += "&cnt=2";									// Parameters Count
	strParam += "?SLIPNO="  + "'" + "YA" + me_GADATE.value + me_GANO.value + "'";	    // 코드	
	strParam += "&RECEIPT=" + "Y";	// 코드	
	strParam += "&BUNGAE="  + "N";	// 코드		

	var sParam = {fstrParam:strParam};
	gfn_dialog("", "U_SCC::SCCOZREPORT1.xfdl", sParam);
}
function fn_Close()
{
	this.close();
}
function fn_help()
{
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================

function fn_SearchDetail(errCode, errMsg)
{
	if (errCode != 0){

		g_Message("EE");
		
		f_AfterCallServerCheck = false;
		return false;
	}	
	
	//f_LAST_DATE = fn_GetMonthLastDate(ds_cond, me_Date.Value + "01");
	f_LAST_DATE = me_Date.value;
	
	ds_list.enableevent 	= false;
	
	
	
	for(i=0;i<ds_listSource.rowcount;i++){
	
	
		/* ############################ 정산 계정 셋팅 ####################################
		   ##################################################################################
		   ################################################################################## */
		ds_list.addRow();
		
		ds_list.setColumn(ds_list.rowposition, "ACCTCD",   ds_listSource.getColumn(i, "ACCTCD"));
		ds_list.setColumn(ds_list.rowposition, "ACCTCDNM", ds_listSource.getColumn(i, "ACCTCDNM"));
		
		ds_list.setColumn(ds_list.rowposition, "RTNDEPT_ID",   ds_listSource.getColumn(i, "RTNDEPT_ID"));
		ds_list.setColumn(ds_list.rowposition, "RTNDEPT_IDNM", ds_listSource.getColumn(i, "RTNDEPT_IDNM"));
		
		ds_list.setColumn(ds_list.rowposition, "BUDDEPT_ID",   ds_listSource.getColumn(i, "BUDDEPT_ID"));
		ds_list.setColumn(ds_list.rowposition, "BUDDEPT_IDNM", ds_listSource.getColumn(i, "BUDDEPT_IDNM"));		
		
		
		ds_list.setColumn(ds_list.rowposition, "ADITEM1", ds_listSource.getColumn(i, "ADITEM1"));	
		ds_list.setColumn(ds_list.rowposition, "ADITEM2", ds_listSource.getColumn(i, "ADITEM2"));	
		ds_list.setColumn(ds_list.rowposition, "ADITEM3", ds_listSource.getColumn(i, "ADITEM3"));	
		ds_list.setColumn(ds_list.rowposition, "ADITEM4", ds_listSource.getColumn(i, "ADITEM4"));		
				
		ds_list.setColumn(ds_list.rowposition, "PROJECT_ID", ds_listSource.getColumn(i, "PROJECT_ID"));	
		ds_list.setColumn(ds_list.rowposition, "BUD_CLS",    ds_listSource.getColumn(i, "BUD_CLS"));	
			
			
		//예산체크 관련 항목 세팅################################################################	
		ds_list.setColumn(ds_list.rowposition, "BUD_CLS_NM",    ds_listSource.getColumn(i, "BUD_CLS_NM"));	
		ds_list.setColumn(ds_list.rowposition, "YAESAN_CHK",    ds_listSource.getColumn(i, "YAESAN_CHK"));				
		ds_list.setColumn(ds_list.rowposition, "YAESAN_JAN",    ds_listSource.getColumn(i, "YAESAN_JAN"));				
		//예산체크 관련 항목 세팅################################################################			
			
			
		if (ds_listSource.getColumn(i, "ADV_KIND") == "O") 
		{

			//세금계산서 : 중고업장에 매입일반아니거나, 접대비일우 => 불공제처리
			if (
					 (ds_listSource.getColumn(i, "ADJ_KIND") == "001") &&
					 ( 
						( 
						  (ds_listSource.getColumn(i, "SCHOOL_YN")  == "Y") &&
						  (ds_listSource.getColumn(i, "BULGONG_YN") == "N") 
						) ||
						(gfn_subStr(ds_listSource.getColumn(i, "ACCTCD"), 0, 6)== "505181") 
					 ) 
			    )
			{

				ds_list.setColumn(ds_list.rowposition, "DRAMT", toNumber(ds_listSource.getColumn(i, "ADJ_AMT")) + toNumber(ds_listSource.getColumn(i, "VAT")) );



				//불공제매입####################################################################################
				//부가세 정보 세팅..............................................................................
				ds_list.setColumn(ds_list.rowposition, "VAT_UPJANG", ds_listSource.getColumn(i, "VAT_UPJANG"));
				ds_list.setColumn(ds_list.rowposition, "VAT_CUSTCD", ds_listSource.getColumn(i, "CUSTCD"));
				ds_list.setColumn(ds_list.rowposition, "VATGUCD",    "130");			
				ds_list.setColumn(ds_list.rowposition, "VATDECD",    "001");			
				ds_list.setColumn(ds_list.rowposition, "SUPDATE",    ds_listSource.getColumn(i, "TAX_DATE"));
				ds_list.setColumn(ds_list.rowposition, "SLPAMT",     ds_listSource.getColumn(i, "ADJ_AMT"));
				ds_list.setColumn(ds_list.rowposition, "VATAMT",     ds_listSource.getColumn(i, "VAT"));
				
				if (gfn_length(ds_listSource.getColumn(i, "TAXNO"))== 0){
				
					ds_list.setColumn(ds_list.rowposition, "TAXNO",      "99999991");			
				}
				else{
				
					ds_list.setColumn(ds_list.rowposition, "TAXNO",       ds_listSource.getColumn(i, "TAXNO"));			
					ds_list.setColumn(ds_list.rowposition, "TAX_IF_GB",   ds_listSource.getColumn(i, "TAX_IF_GB"));			
					ds_list.setColumn(ds_list.rowposition, "TAX_SEND_GB", ds_listSource.getColumn(i, "TAX_SEND_GB"));								
				}
				//부가세 정보 세팅..............................................................................
				//불공제매입####################################################################################

			}
			
			//현금영수증 : 중고업장에 매입일반아니거나, 접대비일우 => 영수증처리
			else if (
			
						(ds_listSource.getColumn(i, "ADJ_KIND") == "009") &&
						( 
						   ( 
						      (ds_listSource.getColumn(i, "SCHOOL_YN")  == "Y") &&
							  (ds_listSource.getColumn(i, "BULGONG_YN") == "N") 
						   ) ||
						   (gfn_subStr(ds_listSource.getColumn(i, "ACCTCD"), 0, 6)== "505181") 
						) 
					)
			{
			
                ds_list.setColumn(ds_list.rowposition, "DRAMT", toNumber(ds_listSource.getColumn(i, "ADJ_AMT")) + toNumber(ds_listSource.getColumn(i, "VAT")) );

			}
			
			//매입계산서####################################################################################
			else if (ds_listSource.getColumn(i, "ADJ_KIND") == "002")
			{

				ds_list.setColumn(ds_list.rowposition, "DRAMT", toNumber(ds_listSource.getColumn(i, "ADJ_AMT")) );

				//매입계산서####################################################################################
				//부가세 정보 세팅..............................................................................
				ds_list.setColumn(ds_list.rowposition, "VAT_UPJANG", ds_listSource.getColumn(i, "VAT_UPJANG"));
				ds_list.setColumn(ds_list.rowposition, "VAT_CUSTCD", ds_listSource.getColumn(i, "CUSTCD"));
				ds_list.setColumn(ds_list.rowposition, "VATGUCD",    "210");			
				ds_list.setColumn(ds_list.rowposition, "VATDECD",    "");			
				ds_list.setColumn(ds_list.rowposition, "SUPDATE",    ds_listSource.getColumn(i, "TAX_DATE"));
				ds_list.setColumn(ds_list.rowposition, "SLPAMT",     ds_listSource.getColumn(i, "ADJ_AMT"));
				ds_list.setColumn(ds_list.rowposition, "VATAMT",     0);				
														
				if (gfn_length(ds_listSource.getColumn(i, "TAXNO"))== 0){
				
					ds_list.setColumn(ds_list.rowposition, "TAXNO",      "99999991");			
				}
				else{
				
					ds_list.setColumn(ds_list.rowposition, "TAXNO",       ds_listSource.getColumn(i, "TAXNO"));			
					ds_list.setColumn(ds_list.rowposition, "TAX_IF_GB",   ds_listSource.getColumn(i, "TAX_IF_GB"));			
					ds_list.setColumn(ds_list.rowposition, "TAX_SEND_GB", ds_listSource.getColumn(i, "TAX_SEND_GB"));								
				}														
				//부가세 정보 세팅..............................................................................
				//매입계산서####################################################################################
			}
			else
			{

				ds_list.setColumn(ds_list.rowposition, "DRAMT", toNumber(ds_listSource.getColumn(i, "ADJ_AMT")) );				
			}

			ds_list.setColumn(ds_list.rowposition, "CRAMT", 0);		
		}
		else
		{

			ds_list.setColumn(ds_list.rowposition, "DRAMT", 0);					
			ds_list.setColumn(ds_list.rowposition, "CRAMT", toNumber(ds_listSource.getColumn(i, "ADJ_AMT")) );				
		}
            
            
		ds_list.setColumn(ds_list.rowposition, "DESCRIPTION_NM", ds_listSource.getColumn(i, "DESCRIPTION_NM"));
		
		//2110314 미지급금(FS업장전도금) 제외하고 예산관련 ATTRIBUTE2 => 2 로 세팅#############
        if (
            (ds_listSource.getColumn(i, "ACCTCD") == "2110314") &&
            (toNumber(ds_listSource.getColumn(i, "ADJ_AMT")) > 0) 
           )
        {
        
        
        }
        else
        {
             //ds_list.SetColumn(ds_list.row, "ATTRIBUTE2", "2"); => 가실적 예산전표화시 반영으로 변경
        }
        //2110314 미지급금(FS업장전도금) 제외하고 예산관련 ATTRIBUTE2 => 2 로 세팅#############
        
		//접대비 정보 세팅.########################################################################
        if (gfn_length(ds_listSource.getColumn(i, "RCP_GUBUN"))!= 0)
        {
        
        	ds_list.setColumn(ds_list.rowposition, "JUBDAE_GUBUN",     ds_listSource.getColumn(i, "RCP_GUBUN"));
        	ds_list.setColumn(ds_list.rowposition, "JUBDAE_CNT",       ds_listSource.getColumn(i, "RCP_CNT"));
        	ds_list.setColumn(ds_list.rowposition, "JUBDAE_JUBDAEBI",  ds_listSource.getColumn(i, "RCP_AMT"));
        	ds_list.setColumn(ds_list.rowposition, "JUBDAE_BONGSARYO", ds_listSource.getColumn(i, "SVC_AMT"));
        	ds_list.setColumn(ds_list.rowposition, "JUBDAE_CUSTNM",    ds_listSource.getColumn(i, "RCP_CUSTNM"));
        	ds_list.setColumn(ds_list.rowposition, "JUBDAE_SAUPNO",    ds_listSource.getColumn(i, "RCP_SAUPNO"));
        	ds_list.setColumn(ds_list.rowposition, "JUBDAE_ADDRESS",   ds_listSource.getColumn(i, "RCP_ADDR"));
        	ds_list.setColumn(ds_list.rowposition, "JUBDAE_DRNAME",    ds_listSource.getColumn(i, "RCP_DRNAME"));
        	ds_list.setColumn(ds_list.rowposition, "JUBDAE_BAL_DATE",  ds_listSource.getColumn(i, "RCP_BALDATE"));        	        	
        }        
        //접대비 정보 세팅.########################################################################
        
        
        //원본 발생분 업데이트 체크 Setting..................................................
        ds_list.setColumn(ds_list.rowposition, "ADV_ID",  ds_listSource.getColumn(i, "ADV_ID"));                     
            		
		/* ############################ 정산 계정 셋팅 ####################################
		   ##################################################################################
		   ################################################################################## */
				     	   
				     	   
	   /* ############################ 매입부가세 계정 셋팅 ################################
		 #################          1111911 매입부가세 : 관리항목 - 거래처     ############
		 ################################################################################## */					 		 
		if (
				 ( 
					(ds_listSource.getColumn(i, "ADJ_KIND") == "001") ||
					(ds_listSource.getColumn(i, "ADJ_KIND") == "009") 
				 ) &&
				 ( 
					(ds_listSource.getColumn(i, "SCHOOL_YN")  == "N") ||
					(ds_listSource.getColumn(i, "BULGONG_YN") == "Y") 
				 ) &&
				(gfn_subStr(ds_listSource.getColumn(i, "ACCTCD"), 0, 6)!= "505181") 
		   )
		{
		
			ds_list.addRow();
			
			ds_list.setColumn(ds_list.rowposition, "ACCTCD",   "1111911");
			ds_list.setColumn(ds_list.rowposition, "ACCTCDNM", "매입부가세");
			
			ds_list.setColumn(ds_list.rowposition, "RTNDEPT_ID",   ds_listSource.getColumn(i, "RTNDEPT_ID"));
			ds_list.setColumn(ds_list.rowposition, "RTNDEPT_IDNM", ds_listSource.getColumn(i, "RTNDEPT_IDNM"));
			
			ds_list.setColumn(ds_list.rowposition, "BUDDEPT_ID",   ds_listSource.getColumn(i, "BUDDEPT_ID"));
			ds_list.setColumn(ds_list.rowposition, "BUDDEPT_IDNM", ds_listSource.getColumn(i, "BUDDEPT_IDNM"));			
					


			//관리항목............................................				
			ds_list.setColumn(ds_list.rowposition, "ADITEM1", ds_listSource.getColumn(i, "CUSTCD"));
			/*
			ds_list.SetColumn(ds_list.row, "ADITEM2", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD2")));		
			ds_list.SetColumn(ds_list.row, "ADITEM3", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD3")));			
			ds_list.SetColumn(ds_list.row, "ADITEM4", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD4")));			
			ds_list.SetColumn(ds_list.row, "ADITEM5", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD5")));				
			ds_list.SetColumn(ds_list.row, "ADITEM6", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD6")));	
			*/

			ds_list.setColumn(ds_list.rowposition, "DRAMT", ds_listSource.getColumn(i, "VAT"));
			ds_list.setColumn(ds_list.rowposition, "CRAMT", 0);
			
			ds_list.setColumn(ds_list.rowposition, "DESCRIPTION_NM", ds_listSource.getColumn(i, "DESCRIPTION_NM"));
			

			//부가세 정보 세팅..............................................................................
			ds_list.setColumn(ds_list.rowposition, "VAT_UPJANG", ds_listSource.getColumn(i, "VAT_UPJANG"));
			ds_list.setColumn(ds_list.rowposition, "VAT_CUSTCD", ds_listSource.getColumn(i, "CUSTCD"));
			
			//세금계산서일경우
			if (ds_listSource.getColumn(i, "ADJ_KIND") == "001")
			{
			
				ds_list.setColumn(ds_list.rowposition, "VATGUCD",    "100");	
				ds_list.setColumn(ds_list.rowposition, "VATDECD",    "");					
			}
			//현금영수증일경우
			else if (ds_listSource.getColumn(i, "ADJ_KIND") == "009")
			{
			
				ds_list.setColumn(ds_list.rowposition, "VATGUCD",    "120"); //기타공제매입	
				ds_list.setColumn(ds_list.rowposition, "VATDECD",    "006"); //현금영수증	
				
				ds_list.setColumn(ds_list.rowposition, "VAT_UPJANG", 100001); //현금영수증 신고업장 본사처리				
			}
                    						
			ds_list.setColumn(ds_list.rowposition, "SUPDATE",    ds_listSource.getColumn(i, "TAX_DATE"));
			ds_list.setColumn(ds_list.rowposition, "SLPAMT",     ds_listSource.getColumn(i, "ADJ_AMT"));
			ds_list.setColumn(ds_list.rowposition, "VATAMT",     ds_listSource.getColumn(i, "VAT"));
			
			
			if (gfn_length(ds_listSource.getColumn(i, "TAXNO"))== 0){
			
				ds_list.setColumn(ds_list.rowposition, "TAXNO",      "99999991");			
			}
			else{
			
				ds_list.setColumn(ds_list.rowposition, "TAXNO",       ds_listSource.getColumn(i, "TAXNO"));			
				ds_list.setColumn(ds_list.rowposition, "TAX_IF_GB",   ds_listSource.getColumn(i, "TAX_IF_GB"));			
				ds_list.setColumn(ds_list.rowposition, "TAX_SEND_GB", ds_listSource.getColumn(i, "TAX_SEND_GB"));								
			}				
			//부가세 정보 세팅..............................................................................		
		
		}
	   /* ############################ 매입부가세 계정 셋팅 ################################
		 #################          1111911 매입부가세 : 관리항목 - 거래처     ############
		 ################################################################################## */
		 
		 
		 
	   /* ############################ 미지급금(FS업장전도금)  계정 셋팅 #################
		  ################################  2110314 미지급금(FS업장전도금) #################
		  ################################################################################## */		 
		if (toNumber(ds_listSource.getColumn(i, "NOPAY_AMT")) != 0)
		{
		
			ds_list.addRow();
			
			ds_list.setColumn(ds_list.rowposition, "ACCTCD",   "2110314");
			ds_list.setColumn(ds_list.rowposition, "ACCTCDNM", "미지급금(FS업장전도금)");
			
			ds_list.setColumn(ds_list.rowposition, "RTNDEPT_ID",   ds_listSource.getColumn(i, "RTNDEPT_ID"));
			ds_list.setColumn(ds_list.rowposition, "RTNDEPT_IDNM", ds_listSource.getColumn(i, "RTNDEPT_IDNM"));
			
			ds_list.setColumn(ds_list.rowposition, "BUDDEPT_ID",   ds_listSource.getColumn(i, "BUDDEPT_ID"));
			ds_list.setColumn(ds_list.rowposition, "BUDDEPT_IDNM", ds_listSource.getColumn(i, "BUDDEPT_IDNM"));			
					


			//관리항목............................................				
			/*
			ds_list.SetColumn(ds_list.row, "ADITEM1", ds_listSource.GetColumn(i, "CUSTCD"));			
			ds_list.SetColumn(ds_list.row, "ADITEM2", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD2")));		
			ds_list.SetColumn(ds_list.row, "ADITEM3", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD3")));			
			ds_list.SetColumn(ds_list.row, "ADITEM4", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD4")));			
			ds_list.SetColumn(ds_list.row, "ADITEM5", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD5")));				
			ds_list.SetColumn(ds_list.row, "ADITEM6", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD6")));	
			*/
			
			//============================================================================
			// 관리항목 셋팅 변경 시작
			// 20140829 정승화 요청(SR201408_04325) by 김장욱
			// 미지급금의 경우 관리항목1에 거래처번호를 넣는다.
			//============================================================================	
			//alert(ds_listSource.GetColumn(i, "CUSTCD"));
			ds_list.setColumn(ds_list.rowposition, "ADITEM1", ds_listSource.getColumn(i, "CUSTCD"));			
			/*
			ds_list.SetColumn(ds_list.row, "ADITEM2", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD2")));		
			ds_list.SetColumn(ds_list.row, "ADITEM3", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD3")));			
			ds_list.SetColumn(ds_list.row, "ADITEM4", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD4")));			
			ds_list.SetColumn(ds_list.row, "ADITEM5", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD5")));				
			ds_list.SetColumn(ds_list.row, "ADITEM6", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD6")));	
			*/		
			//============================================================================
			// 관리항목 셋팅 변경 종료
			//============================================================================					

			ds_list.setColumn(ds_list.rowposition, "DRAMT", 0);
			ds_list.setColumn(ds_list.rowposition, "CRAMT", toNumber(ds_listSource.getColumn(i, "NOPAY_AMT")));
			
			ds_list.setColumn(ds_list.rowposition, "DESCRIPTION_NM", ds_listSource.getColumn(i, "DESCRIPTION_NM"));			
		}		 
		 
	   /* ############################ 미지급금(FS업장전도금)  계정 셋팅 #################
		  ################################  2110314 미지급금(FS업장전도금) #################
		  ################################################################################## */				 
		 
		 
	}
	
	
	
	
   /* ############################ GHR 잡급 셋팅 #########################################
	  #####################################################################################
	  ################################################################################## */		
	for(i=0;i<ds_listSourceGHR.rowcount;i++){
	

			/*  ############################  5040132 잡급P(일용직)계정 셋팅 ###################
			##################################################################################
			################################################################################## */	
			
			ds_list.addRow();
			
			ds_list.setColumn(ds_list.rowposition, "ACCTCD",   "5040132");
			ds_list.setColumn(ds_list.rowposition, "ACCTCDNM", "잡급P(일용직)");
			
			ds_list.setColumn(ds_list.rowposition, "RTNDEPT_ID",   ds_listSourceGHR.getColumn(i, "RTNDEPT_ID"));
			ds_list.setColumn(ds_list.rowposition, "RTNDEPT_IDNM", ds_listSourceGHR.getColumn(i, "RTNDEPT_IDNM"));
			
			ds_list.setColumn(ds_list.rowposition, "BUDDEPT_ID",   ds_listSourceGHR.getColumn(i, "RTNDEPT_ID"));
			ds_list.setColumn(ds_list.rowposition, "BUDDEPT_IDNM", ds_listSourceGHR.getColumn(i, "RTNDEPT_IDNM"));
					


			//관리항목............................................				
			/*
			ds_list.SetColumn(ds_list.row, "ADITEM1", ds_listSource.GetColumn(i, "CUSTCD"));			
			ds_list.SetColumn(ds_list.row, "ADITEM2", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD2")));		
			ds_list.SetColumn(ds_list.row, "ADITEM3", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD3")));			
			ds_list.SetColumn(ds_list.row, "ADITEM4", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD4")));			
			ds_list.SetColumn(ds_list.row, "ADITEM5", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD5")));				
			ds_list.SetColumn(ds_list.row, "ADITEM6", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD6")));	
			*/

			ds_list.setColumn(ds_list.rowposition, "DRAMT", toNumber(ds_listSourceGHR.getColumn(i, "TOTAL_MON")));
			ds_list.setColumn(ds_list.rowposition, "CRAMT", 0);
			
			ds_list.setColumn(ds_list.rowposition, "DESCRIPTION_NM", "[" + ds_listSourceGHR.getColumn(i, "RTNDEPT_IDNM") + "] "  + "잡급P(일용직)");
	   	    
	   	    //ds_list.SetColumn(ds_list.row, "ATTRIBUTE2", "2"); => 가실적 예산전표화시 반영으로 변경
			/*  ############################  5040132 잡급P(일용직)계정 셋팅 ###################
			##################################################################################
			################################################################################## */	
						

			/*  ############################  2110511 소득세예수금(근로소득)계정 셋팅 ####
            ##################################################################################
            ################################################################################## */	
			if (toNumber(ds_listSourceGHR.getColumn(i, "ITAX_MON")) != 0)
			{
			
				ds_list.addRow();
				
				ds_list.setColumn(ds_list.rowposition, "ACCTCD",   "2110511");
				ds_list.setColumn(ds_list.rowposition, "ACCTCDNM", "소득세예수금(근로소득)");
				
				ds_list.setColumn(ds_list.rowposition, "RTNDEPT_ID",   ds_listSourceGHR.getColumn(i, "RTNDEPT_ID"));
				ds_list.setColumn(ds_list.rowposition, "RTNDEPT_IDNM", ds_listSourceGHR.getColumn(i, "RTNDEPT_IDNM"));
				
				ds_list.setColumn(ds_list.rowposition, "BUDDEPT_ID",   ds_listSourceGHR.getColumn(i, "RTNDEPT_ID"));
				ds_list.setColumn(ds_list.rowposition, "BUDDEPT_IDNM", ds_listSourceGHR.getColumn(i, "RTNDEPT_IDNM"));
						
	
	
				//관리항목............................................				
				/*
				ds_list.SetColumn(ds_list.row, "ADITEM1", ds_listSource.GetColumn(i, "CUSTCD"));			
				ds_list.SetColumn(ds_list.row, "ADITEM2", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD2")));		
				ds_list.SetColumn(ds_list.row, "ADITEM3", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD3")));			
				ds_list.SetColumn(ds_list.row, "ADITEM4", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD4")));			
				ds_list.SetColumn(ds_list.row, "ADITEM5", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD5")));				
				ds_list.SetColumn(ds_list.row, "ADITEM6", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD6")));	
				*/
	
				ds_list.setColumn(ds_list.rowposition, "DRAMT", 0);
				ds_list.setColumn(ds_list.rowposition, "CRAMT", toNumber(ds_listSourceGHR.getColumn(i, "ITAX_MON")));
				
				ds_list.setColumn(ds_list.rowposition, "DESCRIPTION_NM", "[" + ds_listSourceGHR.getColumn(i, "RTNDEPT_IDNM") + "] "  + "소득세예수금(근로소득)");
				
				//ds_list.SetColumn(ds_list.row, "ATTRIBUTE2", "2"); => 가실적 예산전표화시 반영으로 변경
			}
			/*  ############################  2110511 소득세예수금(근로소득)계정 셋팅 ####
            ##################################################################################
            ################################################################################## */	
            						
            						
			/*  ############################  2110521 주민세예수금(근로소득)계정 셋팅 ####
            ##################################################################################
            ################################################################################# */	
			if (toNumber(ds_listSourceGHR.getColumn(i, "RTAX_MON")) != 0)
			{
			
				ds_list.addRow();
				
				ds_list.setColumn(ds_list.rowposition, "ACCTCD",   "2110521");
				ds_list.setColumn(ds_list.rowposition, "ACCTCDNM", "주민세예수금(근로소득)");
				
				ds_list.setColumn(ds_list.rowposition, "RTNDEPT_ID",   ds_listSourceGHR.getColumn(i, "RTNDEPT_ID"));
				ds_list.setColumn(ds_list.rowposition, "RTNDEPT_IDNM", ds_listSourceGHR.getColumn(i, "RTNDEPT_IDNM"));
				
				ds_list.setColumn(ds_list.rowposition, "BUDDEPT_ID",   ds_listSourceGHR.getColumn(i, "RTNDEPT_ID"));
				ds_list.setColumn(ds_list.rowposition, "BUDDEPT_IDNM", ds_listSourceGHR.getColumn(i, "RTNDEPT_IDNM"));
						
	
	
				//관리항목............................................				
				/*
				ds_list.SetColumn(ds_list.row, "ADITEM1", ds_listSource.GetColumn(i, "CUSTCD"));			
				ds_list.SetColumn(ds_list.row, "ADITEM2", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD2")));		
				ds_list.SetColumn(ds_list.row, "ADITEM3", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD3")));			
				ds_list.SetColumn(ds_list.row, "ADITEM4", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD4")));			
				ds_list.SetColumn(ds_list.row, "ADITEM5", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD5")));				
				ds_list.SetColumn(ds_list.row, "ADITEM6", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD6")));	
				*/
	
				ds_list.setColumn(ds_list.rowposition, "DRAMT", 0);
				ds_list.setColumn(ds_list.rowposition, "CRAMT", toNumber(ds_listSourceGHR.getColumn(i, "RTAX_MON")));
				
				ds_list.setColumn(ds_list.rowposition, "DESCRIPTION_NM", "[" + ds_listSourceGHR.getColumn(i, "RTNDEPT_IDNM") + "] "  + "주민세예수금(근로소득)");
				
				//ds_list.SetColumn(ds_list.row, "ATTRIBUTE2", "2"); => 가실적 예산전표화시 반영으로 변경
			}
			/*  ############################  2110521 주민세예수금(근로소득)계정 셋팅 ####
            ##################################################################################
            ################################################################################# */
            	          						
            	          						
            	          						
			/*  ############################  9410119 잡급대체가계정  셋팅 ################
            ##################################################################################
            ################################################################################# */	

			ds_list.addRow();
			
			ds_list.setColumn(ds_list.rowposition, "ACCTCD",   "9410119");
			ds_list.setColumn(ds_list.rowposition, "ACCTCDNM", "잡급대체가계정");
			
			ds_list.setColumn(ds_list.rowposition, "RTNDEPT_ID",   ds_listSourceGHR.getColumn(i, "RTNDEPT_ID"));
			ds_list.setColumn(ds_list.rowposition, "RTNDEPT_IDNM", ds_listSourceGHR.getColumn(i, "RTNDEPT_IDNM"));
			
			ds_list.setColumn(ds_list.rowposition, "BUDDEPT_ID",   ds_listSourceGHR.getColumn(i, "RTNDEPT_ID"));
			ds_list.setColumn(ds_list.rowposition, "BUDDEPT_IDNM", ds_listSourceGHR.getColumn(i, "RTNDEPT_IDNM"));
					


			//관리항목............................................				
			/*
			ds_list.SetColumn(ds_list.row, "ADITEM1", ds_listSource.GetColumn(i, "CUSTCD"));			
			ds_list.SetColumn(ds_list.row, "ADITEM2", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD2")));		
			ds_list.SetColumn(ds_list.row, "ADITEM3", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD3")));			
			ds_list.SetColumn(ds_list.row, "ADITEM4", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD4")));			
			ds_list.SetColumn(ds_list.row, "ADITEM5", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD5")));				
			ds_list.SetColumn(ds_list.row, "ADITEM6", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD6")));	
			*/

			ds_list.setColumn(ds_list.rowposition, "DRAMT", 0);
			ds_list.setColumn(ds_list.rowposition, "CRAMT", toNumber(ds_listSourceGHR.getColumn(i, "TOTAL_MON")) - (toNumber(ds_listSourceGHR.getColumn(i, "ITAX_MON")) + toNumber(ds_listSourceGHR.getColumn(i, "RTAX_MON"))) );
			
			ds_list.setColumn(ds_list.rowposition, "DESCRIPTION_NM", "[" + ds_listSourceGHR.getColumn(i, "RTNDEPT_IDNM") + "] "  + "잡급대체가계정");
			
			//ds_list.SetColumn(ds_list.row, "ATTRIBUTE2", "2"); => 가실적 예산전표화시 반영으로 변경

			/*  ############################  9410119 잡급대체가계정  셋팅 ################
            ##################################################################################
            ################################################################################# */	         	          						
            	   	 
	}
   /* ############################ GHR 잡급 셋팅 #########################################
	  #####################################################################################
	  ################################################################################## */	
	  	
	  	
	  	
	  	
	  	
   /* ############################ 전도금(사업장) 1110112 계정 셋팅 ####################
	  #####################################################################################
	  ################################################################################## */		  	
	if ( (toNumber(ds_list.getSum("DRAMT")) - toNumber(ds_list.getSum("CRAMT"))) != 0)
	{
	
		ds_list.addRow();
		/************************************************************************************
		 * 분기중에 차변과 대변의 금액이 차이 날 경우는 전도금(사업장)으로 처리하고
		 * 분기말에 차변과 대변의 금액이 차이 날 경우는 미지급금(FC업장전도금)으로 처리한다.
		 * 20140423 FC회계팀 유태석 매니저 요청
		 * 20140424 김장욱 수정 시작
		 ***********************************************************************************/
		//ds_list.SetColumn(ds_list.row, "ACCTCD",   "1110112");
		//ds_list.SetColumn(ds_list.row, "ACCTCDNM", "전도금(사업장)");
		// 1차마감일 경우(25일 경우)
		if(gfn_subStr(me_Date.value, 6, 2)!= gfn_subStr(str_LastDate, 6, 2)){
			ds_list.setColumn(ds_list.rowposition, "ACCTCD",   "1110112");
			ds_list.setColumn(ds_list.rowposition, "ACCTCDNM", "전도금(사업장)");
		}else{	// 2차마감일 경우(말일일 경우) = 분기마감
			// 일단 미지급금으로 되는 건 주석처리. 20140630
			// 2014년 9월말에 협업공지 후 다시 하기로 함.
			//ds_list.SetColumn(ds_list.row, "ACCTCD",   "2110314");
			//ds_list.SetColumn(ds_list.row, "ACCTCDNM", "미지급금(FC업장전도금)");
			ds_list.setColumn(ds_list.rowposition, "ACCTCD",   "1110112");
			ds_list.setColumn(ds_list.rowposition, "ACCTCDNM", "전도금(사업장)");
		}
		/************************************************************************************
		 * 20140424 김장욱 수정 종료
		 ***********************************************************************************/		
		ds_list.setColumn(ds_list.rowposition, "RTNDEPT_ID",   ds_list.getColumn(ds_list.rowposition-1, "RTNDEPT_ID"));
		ds_list.setColumn(ds_list.rowposition, "RTNDEPT_IDNM", ds_list.getColumn(ds_list.rowposition-1, "RTNDEPT_IDNM"));
		
		ds_list.setColumn(ds_list.rowposition, "BUDDEPT_ID",   ds_list.getColumn(ds_list.rowposition-1, "RTNDEPT_ID"));
		ds_list.setColumn(ds_list.rowposition, "BUDDEPT_IDNM", ds_list.getColumn(ds_list.rowposition-1, "RTNDEPT_IDNM"));
				


		//관리항목............................................				
		/*
		ds_list.SetColumn(ds_list.row, "ADITEM1", ds_listSource.GetColumn(i, "CUSTCD"));			
		ds_list.SetColumn(ds_list.row, "ADITEM2", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD2")));		
		ds_list.SetColumn(ds_list.row, "ADITEM3", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD3")));			
		ds_list.SetColumn(ds_list.row, "ADITEM4", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD4")));			
		ds_list.SetColumn(ds_list.row, "ADITEM5", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD5")));				
		ds_list.SetColumn(ds_list.row, "ADITEM6", fn_GetAditemAuto(ds_listSource, i, "2", ds_listSource.GetColumn(i, "CR_PARACD6")));	
		*/

		ds_list.setColumn(ds_list.rowposition, "DRAMT", 0);
		ds_list.setColumn(ds_list.rowposition, "CRAMT", toNumber(ds_list.getSum("DRAMT")) - toNumber(ds_list.getSum("CRAMT")) );
		/************************************************************************************
		 * 분기중에 차변과 대변의 금액이 차이 날 경우는 전도금(사업장)으로 처리하고
		 * 분기말에 차변과 대변의 금액이 차이 날 경우는 미지급금(FC업장전도금)으로 처리한다.
		 * 20140423 FC회계팀 유태석 매니저 요청
		 * 20140424 김장욱 수정 시작
		 ***********************************************************************************/		
		//ds_list.SetColumn(ds_list.row, "DESCRIPTION_NM", "[" + ds_list.GetColumn(ds_list.row-1, "RTNDEPT_IDNM") + "] "  + "전도금정산 전표");
		// 1차마감일 경우(25일 경우)
		if(gfn_subStr(me_Date.value, 6, 2)!= gfn_subStr(str_LastDate, 6, 2)){
			ds_list.setColumn(ds_list.rowposition, "DESCRIPTION_NM", "[" + ds_list.getColumn(ds_list.rowposition-1, "RTNDEPT_IDNM") + "] "  + "전도금정산 전표");
		}else{	// 2차마감일 경우(말일일 경우) = 분기마감
			ds_list.setColumn(ds_list.rowposition, "DESCRIPTION_NM", "[" + ds_list.getColumn(ds_list.rowposition-1, "RTNDEPT_IDNM") + "] "  + "전도금정산 전표");
			// 일단 미지급금으로 되는 건 주석처리. 20140630
			// 2014년 9월말에 협업공지 후 다시 하기로 함.
			//ds_list.SetColumn(ds_list.row, "DESCRIPTION_NM", "[" + ds_list.GetColumn(ds_list.row-1, "RTNDEPT_IDNM") + "] "  + "미지급금정산 전표");
		}
		/************************************************************************************
		 * 20140424 김장욱 수정 종료
		 ***********************************************************************************/			
		
		//ds_list.SetColumn(ds_list.row, "ATTRIBUTE2", "2");	
	}
   /* ############################ 전도금(사업장) 1110112 계정 셋팅 ####################
	  #####################################################################################
	  ################################################################################## */		  	

	
	//예산체크 로직 추가##################################################################
	var real_YAESAN_JAN;
	
	for(i=0;i<ds_list.rowcount;i++){
		
		if (ds_list.getColumn(i, "YAESAN_CHK") == "Y"){
		
			real_YAESAN_JAN = toNumber(ds_list.getColumn(i, "YAESAN_JAN"));	
			
			for(j=0;j<ds_list.rowcount;j++){
				
				if (
					(ds_list.getColumn(j, "ACCTCD")     == ds_list.getColumn(i, "ACCTCD")) &&
					(ds_list.getColumn(j, "BUDDEPT_ID") == ds_list.getColumn(i, "BUDDEPT_ID")) &&
					(ds_list.getColumn(j, "PROJECT_ID") == ds_list.getColumn(i, "PROJECT_ID")) &&
					(ds_list.getColumn(j, "BUD_CLS")    == ds_list.getColumn(i, "BUD_CLS"))
				   )					
				{
				
					real_YAESAN_JAN = real_YAESAN_JAN - toNumber(ds_list.getColumn(j, "DRAMT"));
				}
			}	
				
			if (toNumber(real_YAESAN_JAN) < 0){
				
				ds_list.setColumn(i, "YAESAN_CHK_DESC", "예산잔액이 " + real_YAESAN_JAN + " 부족합니다.");
			}
		}
		
	}
	
	//예산체크 로직 추가##################################################################
		
		
	
	ds_list.enableevent 	        = true;
	
}


function fn_GetAditemAuto(objOutDs, int_RowIndex, str_DCGUBUN, str_PARACD){

    /*
    ## 매출 계정 ################################################

    -- 관리항목
    거래처/관리부서/과면세--

    -- 과세 구분
    310	과세
    350	영세
    410	면세

    외상매출금	                    거래처	관리부서	예약번호
    식음료매출액
    매점상품매출(F/S)
    상품매출                       과세/면세
    채권채무상계가계정(FS)
    선수금(사업장)	               거래처
    내부차입금                     계좌번호
    기타매출
    임원급여(기본급)
    직원급여(기본급)
    잡손실

    */


	if (str_PARACD == "002") //거래처
	{       
	

		if (
			   (
				  (str_DCGUBUN == "1") && (objOutDs.getColumn(int_RowIndex, "DR_ACCTCD") == "2110411")
			   ) ||
			   (
				  (str_DCGUBUN == "2") && (objOutDs.getColumn(int_RowIndex, "CR_ACCTCD") == "2110411")
			   ) 
		   )
		{
		
		
			return "999999";//2110411 선수금(사업장) 일경우 거래처 => 기타(거래처) 999999
		}
		else {
		
			return objOutDs.getColumn(int_RowIndex, "CUSTCD");
		}

	}
	else if (str_PARACD == "001") //관리부서
	{
	
		return  objOutDs.getColumn(int_RowIndex, "MANAGE_DEPT_ID");
	}
	else if (str_PARACD == "033") //과세/면세
	{
		return  objOutDs.getColumn(int_RowIndex, "GWA_GUBUN");
	}
	else if (str_PARACD == "008") //계좌번호  (내부차입금)
	{
		return "000-00-779016";
	}

}


function before_SelectCheck()
{
   
	if (gfn_length(edt_UPJANGQuery.userdata)== 0)
	{
	
		gfn_alert("업장을 지정하여 주십시요.");
		edt_UPJANGQuery.setFocus();
		return false;
	}
	    
	if (gfn_length(me_Date.value)== 0)
	{
	
		gfn_alert("기준일자를 지정하여 주십시요.");
		me_Date.setFocus();
		return false;
	}
	
		
		
	// 전역변수로 변경
	// 20140423 김장욱 수정
	//var str_LastDate;
	str_LastDate = fn_GetMonthLastDate(ds_cond, gfn_subStr(me_Date.value, 0, 6)+ "01");
	
	
	if (
		(gfn_subStr(me_Date.value, 6, 2)!= "25") &&
		(gfn_subStr(me_Date.value, 6, 2)!= gfn_subStr(str_LastDate, 6, 2))
	   )	
	{
	
		gfn_alert("기준일자를 확인하여 주십시요." + "\n" +
			  "기준일자는 해당월 25일 혹은 말일자 입니다.");
		me_Date.setFocus();
		return false;
	}	
//alert((toNumber(substr(me_DateFr.Value, 4, 2)) % toNumber(3)));
	if (
		((toNumber(gfn_subStr(me_Date.value, 4, 2)) % toNumber(3)) != 0) &&
		(gfn_subStr(me_Date.value, 6, 2)== gfn_subStr(str_LastDate, 6, 2))
	   )	
	{
	
		gfn_alert("기준일자를 확인하여 주십시요." + "\n" +
			  "분기월을 제외하고는 해당월 25일자 입니다.");
		me_Date.setFocus();
		return false;
	}		
	
	return true;
}


function before_SaveCheck(str_Gubun)
{

		//권한에 따른 저장/삭제 가능체크#########################################################################
		if (
		    //(g_AuthLevel != "99") &&
		    (g_AuthLevel < "99") &&
		    (f_ROLE_YN != "Y") &&
		    (!fn_GetSaveAuthBy_AuthLevel(edt_UPJANGQuery.userdata))
		   ) return false;
		//권한에 따른 저장/삭제 가능체크#########################################################################
		
		
        /*
        업무구분별로 addAction 지정세팅##########################################        
        */
        
        f_Saved_ID = 0;
        

		
        /*
        업무구분별로 addAction 지정세팅##########################################        
        */
		
		
 		if (ds_list.rowcount == 0){

			return;
		}

	    if (str_Gubun == "Master"){

			
	        
	        //입력일때 Confirm체크##################################
	        if ( 
	             (ds_list.rowcount > 0) 
	           )
	        {
				if (!g_Confirm("02", "전도금정산 전표를 생성 하시겠습니까?")) return false;	             
	        }     
	        //입력일때 Confirm체크##################################
	             
	       
	       
            //차대 합계 Verify체크##################################
			if (toNumber(ds_list.getSum('DRAMT')) != toNumber(ds_list.getSum('CRAMT'))){
				
				g_Message("EE", "차대변 합계금액이 일치하지 않습니다.\n" +
				                "확인하여 주십시요.");                
				return false;                
			}
			//차대 합계 Verify체크##################################
						
			

			//예산 CROSSCHECK#########################################    
			for (i=0;i<ds_list.rowcount;i++){
			
				if (gfn_length(ds_list.getColumn(i, "YAESAN_CHK_DESC"))!= 0){
				
					g_Message("EE", "예산통제 대상 계정의 잔액이 부족합니다.\n" +
									"확인하여 주십시요.");   
                    ds_list.rowposition = i;														
					return false;     								
				}			
			}
			
			//예산 CROSSCHECK#########################################    
									
									
									
			//9410119 잡급대체가계정 CROSSCHECK#########################################    
			var real_GHR_Dramt,
			    real_GHR_Cramt;
			
			real_GHR_Dramt = 0;
			real_GHR_Cramt = 0;
			for (i=0;i<ds_list.rowcount;i++){
			
				if (ds_list.getColumn(i, "ACCTCD") == "9410119"){
					
					real_GHR_Dramt += toNumber(ds_list.getColumn(i, "DRAMT"));
					real_GHR_Cramt += toNumber(ds_list.getColumn(i, "CRAMT"));
					
				}			
			}
			
			if (real_GHR_Dramt != real_GHR_Cramt){
			
				g_Message("EE", "잡급대체가계정 차대변이 맞지않습니다.\n" +
								"그룹인사GHR의 잡급등록을 확인하여 주십시요.\n\n" +
								"IFIS전도금  : " + numFormat(real_GHR_Dramt)+ "원\n" +
								"GHR잡급등록 : " + numFormat(real_GHR_Cramt)+ "원\n");
				return false;
			}			
			//9410119 잡급대체가계정 CROSSCHECK#########################################    
						
						
						
						
			//GANO 세팅#######################################################################
			f_GAMU  = "YA";
			f_GANO  = fn_GetHLDC_GA_GETMAXNO("YA", f_LAST_DATE);
			
			f_ORDNO = fn_GetHLDC_GA_GETGAGUBUN_MAXNO(f_GAMU, f_LAST_DATE, f_GANO, "G02", "002");
            
		}			

        
		//저장#############################################################
	    if (str_Gubun == "Master"){


		
		
			
			//전표데이터세팅##########################################
			if (ds_list.rowcount > 0){
			   
				for (i=0;i<ds_list.rowcount;i++){
					
					ds_list.setColumn(i, "GAMU",   "YA");			
					ds_list.setColumn(i, "GADATE", f_LAST_DATE);
					ds_list.setColumn(i, "GANO",   f_GANO);					
					ds_list.setColumn(i, "GALINE", i + 1);		
								
					
					
					ds_list.setColumn(i, "GADEPT_ID",        g_Deptid);	
					ds_list.setColumn(i, "GAGUBUN",          "G02");	
					ds_list.setColumn(i, "GAGUBUN_DETAIL",   "002");		
					
					if (ds_list.getColumn(i, "DRAMT") != 0){
						ds_list.setColumn(i, "DCGUBUN",      "1");		
					}
					else {
						ds_list.setColumn(i, "DCGUBUN",      "2");		
					}						
				}
				
				for (i=0;i<ds_listSource.rowcount;i++){
					
					ds_listSource.setColumn(i, "GAMU",   "YA");			
					ds_listSource.setColumn(i, "GADATE", f_LAST_DATE);
					ds_listSource.setColumn(i, "GANO",   f_GANO);										
				}				
				
				for (i=0;i<ds_listSourceGHR.rowcount;i++){
					
					ds_listSourceGHR.setColumn(i, "GAMU",   "YA");			
					ds_listSourceGHR.setColumn(i, "GADATE", f_LAST_DATE);
					ds_listSourceGHR.setColumn(i, "GANO",   f_GANO);										
				}					
				
				ds_HLDC_GA_INTERFACE.clearData();
				ds_HLDC_GA_INTERFACE.addRow();
				
				ds_HLDC_GA_INTERFACE.setColumn(0, "MODULE_GUBUN",   "전도금정산");	
				ds_HLDC_GA_INTERFACE.setColumn(0, "GUBUN",   "Y");	
				ds_HLDC_GA_INTERFACE.setColumn(0, "GAMU",   "YA");			
				ds_HLDC_GA_INTERFACE.setColumn(0, "GADATE", f_LAST_DATE);
				ds_HLDC_GA_INTERFACE.setColumn(0, "GANO",   f_GANO);	
				ds_HLDC_GA_INTERFACE.setColumn(0, "UPJANG", edt_UPJANGQuery.userdata);
				ds_HLDC_GA_INTERFACE.setColumn(0, "lngRtn",      "");
				
			
	        }    
			//전표데이터세팅##########################################
			
			
			
			// action 정보 초기화
			fsp_clear(this);	  		
										    		        

            //전표데이터 저장.            
   		    fsp_addMulti(this, "ma/mas:MAS10309E_I001");
   		    

            //전표데이터 이관.  
            fsp_addSingle(this, "ma/mas:MAS10309E_I002");//MAS_GA_INTERFACE_PRO          
   		    // tit_addSingleActionInfo(this, "ma/mas:MAS10340E_I002");//GA_DETAIL
   		    // tit_addSingleActionInfo(this, "ma/mas:MAS10340E_I003");//GA_DETAIL_VAT   		    
   		    // tit_addSingleActionInfo(this, "ma/mas:MAS10340E_I004");//GA_DETAIL_JUBDAE
			// tit_addSingleActionInfo(this, "ma/mas:MAS10340E_I005");//GA_MASTER   	
   		    
   		    
   		    //원본데이터 UPDATE.     
   		    fsp_addMulti(this, "ma/mas:MAS10340E_U001");
   		    
   		    // if (ds_listSourceGHR.rowcount > 0)
   		    // tit_addMultiActionInfo(this, "ma/mas:MAS10340E_I001");
   		    
   		    
   		    //전표데이터 이관 UPDATE.     
   		    //tit_addSingleActionInfo(this, "ma/mas:MAS10340E_U002");   		    
   		    
            //원본데이터 UPDATE.     

			//TextArea0.Text = ds_list.SaveXML();
			
			http.Sync = true;
			
			//Timeout 설정처리###########################################
			var t_timeout;
			t_timeout = application.httptimeout;
			application.httptimeout=5000; //1800초
			
			//http.Compress = true;
			//http.CompressMethod = "ZLIB";
			//http.XmlFormat = false;						
			//Timeout 설정처리###########################################
						
			//tit_callService(this, "", "", "ds_cond=ds_list:A ds_listSource=ds_listSource:A ds_listSourceGHR=ds_listSourceGHR:A ds_HLDC_GA_INTERFACE=ds_HLDC_GA_INTERFACE:A", "",  "", "fn_AfterSaveSearch()");
			fsp_callService(this, "", "", "ds_cond=ds_list:A ds_listSource=ds_listSource:A ds_HLDC_GA_INTERFACE=ds_HLDC_GA_INTERFACE:A", "",  "", "fn_AfterSaveSearch()");
			
			//Timeout 설정처리###########################################			
			application.httptimeout=t_timeout; //60초
			
			//http.Compress = false;
			//http.CompressMethod = "";
			//http.XmlFormat = true;								
			//Timeout 설정처리###########################################
            
			http.Sync = false;			
	    }
	   
	    
		return true;
}

function fn_AfterSaveSearch(errCode, errMsg)
{
	if (errCode != 0){
		
		g_Message("EE", errCode + ":" + errMsg);		
		return;
	}
		
    g_Message("02", "전표번호:" + f_GAMU + "-" + f_LAST_DATE + "-" + f_GANO + "\n" + 
                    "저장되었습니다.");
    
	
    g_Message("02", "전표번호:" + f_GAMU + "-" + f_LAST_DATE + "-" + f_GANO + "\n" + 
                    "출력하시기 전에 프린터 상태를 확인하시기 바랍니다.");
                    		
	
	fn_DataSetAllClear();
		
	me_GADATE.value = f_LAST_DATE;
	me_GANO.value   = f_GANO;
		
	fn_print();
	
	//fn_Search();
	
}

/*
 ******************************************************************************************
 * 함  수  명   : Common_Btn_common_OnClick
 * 입      력   : obj  = Form Component
 * 반      환   : 없음
 * 기      능   : 
 * 작  성  자   : 구종화
 * 작성  일자   : 2007-11-16
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================

function Common_Btn_common_OnClick(obj)
{

	switch(obj.name)
	{
		case "btn_search":
		    //alert("d");
			fn_search();
			break;
		case "btn_ins":
			fn_insert();
			break;
		case "btn_del":
			fn_delete();
			break;
		case "btn_save":
			fn_save();
			break;
		case "btn_Print":
			//fn_Print();
			break;
		case "btn_close":
			fn_Close();
			break;
		case "btn_Help":
			//fn_Help();
			break;
		default:
			break;
	}

}


function WorkForm_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
{
	
	gfn_formKeyDown(obj, e); //(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam);
}





function edt_UPJANGQuery_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	fn_edt_OnKeyDown(obj,e.keycode);	
			
			
	if (e.keycode == 46){
	
		if (obj.name == "edt_UPDEPT_IDQuery"){
				
			fn_DataSetAllClear();
		
			//하위 업장정보  Clear#######################################################
			edt_UPJANGQuery.userdata = "";
			edt_UPJANGQuery.value     = "";
			//하위 업장정보  Clear#######################################################		
		}
		
		if (obj.name == "edt_UPJANGQuery"){
				
			fn_DataSetAllClear();				
		}	

	   	
	}
	else {
	
		if (obj.name == "edt_UPDEPT_IDQuery"){
			
		
		}
		
		if (obj.name == "edt_UPJANGQuery"){
				
						
		}			
	}
}



function fn_DataSetAllClear()
{

	ds_list.clearData();
	ds_listSource.clearData();
	ds_Updatecond.clearData();
	ds_listSourceGHR.clearData();	
	ds_HLDC_GA_INTERFACE.clearData();	
}	





function edtBtn_UPJANGQuery_OnClick(obj:Button, e:ClickEventInfo)
{
  var str_Where;
  if (
       (obj.name == "edtBtn_UPJANGQuery") &&
       (gfn_length(gfn_trim(edt_UPDEPT_IDQuery.userdata))!= 0 )  
     )
  str_Where = " AND (TM_CD ='" + edt_UPDEPT_IDQuery.userdata + "')";
  
  fn_edtBtn_OnClick(obj, str_Where);
	
  if (gfn_length(gfn_trim(edt_UPJANGQuery.userdata))== 0 ) {  
	 
	
  }     
  else {     
	 
	if (obj.name == "edtBtn_UPDEPT_IDQuery"){
		
		//하위 업장정보  Clear#######################################################
		edt_UPJANGQuery.userdata = "";
		edt_UPJANGQuery.value     = "";
		//하위 업장정보  Clear#######################################################		

		
		
	}
	
	if (obj.name == "edtBtn_UPJANGQuery"){
			
	}
	 
  }
  
	  
	    	
	fn_DataSetAllClear();		
}








function edt_UPJANGQuery_OnChanged(obj:Edit, e:TextChangedEventInfo)
{
	fn_DataSetAllClear();		
}





//마감항목 배경색처리###############################################################
function fn_GetBackColorClose(LEVEL_NO)
{


		if (LEVEL_NO == 1)
		return "user0";
		else if (LEVEL_NO == 2)
		return "cornsilk";
		else return "default";

}
//마감항목 배경색처리###############################################################









function edtBtn_Date_OnClick(obj:Button, e:ClickEventInfo)
{
	g_CalButton_OnClick(obj);
	fn_DataSetAllClear();		
}








function me_Date_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{
	fn_DataSetAllClear();		
}



function grid_Slip_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	
	
	if (obj.getCellProperty("head", e.cell,"class") == "head_Excel"){
		gfn_exportExcel(obj, this.titletext);
	}
	else {
	
		//G_GridSort(Object(obj.BindDataSet), obj, nCell);	
	}
	//obj.ExportExcel(this.Title, , False);	
}






//전표초기화#####################################################################
function btn_InitSlip_OnClick(obj:Button, e:ClickEventInfo)
{
    
    if (gfn_length(me_GADATE.value)== 0){    

		g_Message("EE", "전표일자가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 
        me_GADATE.setFocus();
        return false;
    }    
	
    if (numFormat(me_GANO.value)== "0"){    

		g_Message("EE", "전표번호가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 
        me_GANO.setFocus();
        return false;
    }  	
    
		    

    //각 구분별 전표초기화 권한체크#########################################################################
    if (
        //(g_AuthLevel != "99") &&
        (g_AuthLevel < "99") &&
        (f_ROLE_YN != "Y")
       )
    {
    
		if (!fn_GetGA_INIT_IsCharge(ds_cond, "YA", me_GADATE.value, me_GANO.value)) return false;
	}
        
    //각 구분별 전표초기화체크###############################################################################
    if (!fn_GetGA_INIT_CLOSE_Local(ds_cond, "Y", "전도금정산전표", "YA", me_GADATE.value, me_GANO.value)) return false;
    
    
    
	// action 정보 초기화
	fsp_clear(this);			
	
	
	//원본데이터 UPDATE.     
	ds_cond.clear();
		
	ds_cond.addColumn("GAMU","STRING",256);       
	ds_cond.addColumn("GADATE","STRING",256);       
	ds_cond.addColumn("GANO","INT",256);       
	
	ds_cond.addRow();
	
	ds_cond.setColumn(0, "GAMU",     "YA");
	ds_cond.setColumn(0, "GADATE",   me_GADATE.value);
	ds_cond.setColumn(0, "GANO",     me_GANO.value);
				
				
	ds_HLDC_GA_INTERFACE.clearData();
	ds_HLDC_GA_INTERFACE.addRow();
	
	ds_HLDC_GA_INTERFACE.setColumn(0, "MODULE_GUBUN",   "전도금정산");	
	ds_HLDC_GA_INTERFACE.setColumn(0, "GUBUN",   "N");	
	ds_HLDC_GA_INTERFACE.setColumn(0, "GAMU",   "YA");			
	ds_HLDC_GA_INTERFACE.setColumn(0, "GADATE", me_GADATE.value);
	ds_HLDC_GA_INTERFACE.setColumn(0, "GANO",   me_GANO.value);		
	ds_HLDC_GA_INTERFACE.setColumn(0, "UPJANG", 0);		
	ds_HLDC_GA_INTERFACE.setColumn(0, "lngRtn",      "");						
								
	//기존 전표데이터 삭제.
	
	//===============================================================================
	// 전표 초기화시 데이터 왜곡현상 발생
	// GA_MASTER, GA_DETAIL에만 데이터 남아 있고 나머지는 초기화가 되는 왜곡현상발생
	// 그래서 MAS10309E_D001, MAS10340E_U003에서 하는 작업을 MAS10309E_I002에서 처리 
	// 되도록 수정함. 
	// 20140423 by 김장욱
	//===============================================================================
	
	//===============================================================================
	// 위의 내용으로 주석처리함.(MAS10309E_I002에서 데이터 처리) 주석처리 시작
	//===============================================================================		
	//tit_addSingleActionInfo(this, "ma/mas:MAS10309E_D001");	
	//===============================================================================
	// 위의 내용으로 주석처리함.(MAS10309E_I002에서 데이터 처리) 주석처리 끝
	//===============================================================================		
	fsp_addSingle(this, "ma/mas:MAS10309E_I002");//MAS_GA_INTERFACE_PRO     
	// tit_addSingleActionInfo(this, "ma/mas:MAS10340E_U004");	
	// tit_addSingleActionInfo(this, "ma/mas:MAS10340E_D002");	
	//===============================================================================
	// 위의 내용으로 주석처리함.(MAS10309E_I002에서 데이터 처리) 주석처리 시작
	//===============================================================================
	//tit_addSingleActionInfo(this, "ma/mas:MAS10340E_U003");	
	//===============================================================================
	// 위의 내용으로 주석처리함.(MAS10309E_I002에서 데이터 처리) 주석처리 끝
	//===============================================================================		
	// tit_addSingleActionInfo(this, "ma/mas:MAS10340E_D001");	
	   
	http.Sync = true;
	
	//Timeout 설정처리###########################################
	var t_timeout;
	t_timeout = application.httptimeout;
	application.httptimeout=2000; //1800초
	//Timeout 설정처리###########################################
	
	fsp_callService(this, "", "", "ds_cond=ds_cond:A ds_HLDC_GA_INTERFACE=ds_HLDC_GA_INTERFACE:A",  "", "", "fn_AfterDeleteSearch()");		
	
	//Timeout 설정처리###########################################
	application.httptimeout=t_timeout; //60초
	//Timeout 설정처리###########################################
				
	http.Sync = false;		
	
	return true;    
    
    
}



//각 구분별 전표초기화 권한체크###############################################################################
function fn_GetGA_INIT_IsCharge(objOutDs, str_GAMU, str_GADATE, real_GANO)
{

    //대체마감체크#####################################################################
    var str_CloseErr = "";
    
    objOutDs.clear();
    objOutDs.addColumn("UPJANG","INT",256);	       
    objOutDs.addColumn("TM_CD","STRING",256);	       

    
        
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/mas:MAS10340E_S004");
		
	
	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","GAMU=" + wrapQuote(str_GAMU) + 
															   " GADATE=" + wrapQuote(str_GADATE) + 
															   " GANO=" + wrapQuote(real_GANO)
	                                                           ,"");	
	http.Sync = false;
	    

	if (objOutDs.rowcount <= 0)
	{
		str_CloseErr = "해당 전표번호로 처리된 전도금 정산내역이 없습니다.";
	}
	else
	{
		if (
			(g_Tm_Cd  != objOutDs.getColumn(0, "TM_CD")) ||
			(g_Upjang != toNumber(objOutDs.getColumn(0, "UPJANG")))
			)
		{
			str_CloseErr = "해당사용자는 소속팀/소속업장과\n전표의 팀/업장코드가 다릅니다.";
		}
	}
	
	if (gfn_length(str_CloseErr )!= 0){
	
		g_Message("EE", str_CloseErr + "\n" +
						"확인하여 주십시요.");			 
		return false;        
	}	
	
	return true;
	//대체마감체크#####################################################################
 
}			 
//각 구분별 전표초기화 권한체크###############################################################################
	
	
function fn_AfterDeleteSearch(errCode, errMsg)
{
	if (errCode != 0){

		g_Message("EE");
		return;
	}

    g_Message("01", "초기화 되었습니다.");
    
    me_GADATE.value = "";
	me_GANO.value   = "";
	
	fn_search();	

}
//전표초기화#####################################################################



//ORDNO 세팅#######################################################################
function fn_GetHLDC_GA_GETGAGUBUN_MAXNO(str_V_GAMU, str_V_GADATE, real_GANO, str_GAGUBUN, str_GAGUBUN_DETAIL)
{

    
    if (gfn_length(str_V_GADATE)== 0){    

		g_Message("EE", "전표일자가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 						               
        return false;
    }    
    
    
    if (numFormat(real_GANO)== "0"){    

		g_Message("EE", "전표번호가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 						               
        return false;
    }    
        
        
    
	ds_cond.clear();
	ds_cond.addColumn("V_ORDNO","INT",256);
				
	// action 정보 초기화
	fsp_clear(this);

	// 서버에서 조회할 정보 추가
	fsp_addSearch(this, "ma/mas:MAS10340E_S005");

	// 서버 호출
	http.Sync = true;
	fsp_callService(this, "", "", "", ds_cond.name + "=ds_list","V_GAMU=" + wrapQuote(str_V_GAMU) + 
	                                                          " V_GADATE=" + wrapQuote(str_V_GADATE) +
	                                                          " V_GANO=" + wrapQuote(real_GANO) +
	                                                          " V_GAGUBUN=" + wrapQuote(str_GAGUBUN) +
	                                                          " V_GAGUBUN_DETAIL=" + wrapQuote(str_GAGUBUN_DETAIL)	                                                          
	                                                         ,"");
	http.Sync = false;

    return ds_cond.getColumn(ds_cond.rowposition, "V_ORDNO");
}
//ORDNO 세팅#######################################################################


function fn_GetLocalUserRole(objOutDs)
{
    
    //잔액체크#####################################################################
    objOutDs.clear();
    objOutDs.addColumn("ROLE_YN","STRING",256);	       
    
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/maa:MAA10010E_S006");
	
	//alert(str_ACCTCD);
	//alert(str_DATE_STD);
	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list",""
	                                                           ,"");	
	http.Sync = false;
	
                          	
	
	//alert(objOutDs.GetColumn(objOutDs.row, "ACCTCD_DATE") );
	return objOutDs.getColumn(objOutDs.rowposition, "ROLE_YN");
	//잔액체크#####################################################################
	
}



//각 구분별 전표초기화체크###############################################################################
function fn_GetGA_INIT_CLOSE_Local(objOutDs, str_DeleteFlag, str_GAGUBUN_TITLE, str_GAMU, str_GADATE, real_GANO)
{

    //대체마감체크#####################################################################
    var str_CloseErr = "";
    
    objOutDs.clear();
    objOutDs.addColumn("GA_ENTRY_GUBUN_YN","STRING",256);	       
    objOutDs.addColumn("GA_CONGUBN_YN","STRING",256);	       
    objOutDs.addColumn("GA_ADV_YN","STRING",256);	      
    
        
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/mas:MAS10340E_S006");
		
	
	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","GAGUBUN_TITLE=" + wrapQuote(str_GAGUBUN_TITLE) + 
															   " GAMU=" + wrapQuote(str_GAMU) + 
															   " GADATE=" + wrapQuote(str_GADATE) + 
															   " GANO=" + wrapQuote(real_GANO)
	                                                           ,"");
	http.Sync = false;


	if (
	     (str_DeleteFlag == "Y") &&
	     (objOutDs.getColumn(objOutDs.rowposition, "GA_ENTRY_GUBUN_YN") == "Y")
	   )
	{
	
		str_CloseErr = "해당전표번호는 회계승인된 전표입니다.";
	}
	
	if (
	     (str_DeleteFlag == "Y") &&
	     (objOutDs.getColumn(objOutDs.rowposition, "GA_CONGUBN_YN") == "Y")
	   )
	{
	
		str_CloseErr = "해당전표번호는 회계승인된 전표입니다.";
	}
	
	if (	
	     ( (str_GAGUBUN_TITLE == "전도금정산전표") && (objOutDs.getColumn(objOutDs.rowposition, "GA_ADV_YN") == "N") ) 
	   )
	{

	     str_CloseErr = "해당전표번호는 [" + str_GAGUBUN_TITLE + "] 가 아닙니다.";
	}
		
	if (gfn_length(str_CloseErr )!= 0){
	
		g_Message("EE", str_CloseErr + "\n" +
						"확인하여 주십시요.");			 
		return false;        
	}

	return true;
	//대체마감체크#####################################################################
 
}			 
//각 구분별 전표초기화체크###############################################################################

function me_GADATE_OnChanged(obj:MaskEdit,  e:TextChangedEventInfo)
{
	fn_DataSetAllClear();		
}
]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSP00010E" onkeydown="frm_OnKeyDown" onload="form_onload" titletext="판촉상품주문" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Grid autoenter="select" binddataset="ds_list" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="gd_list" useinputpanel="false" oncellclick="gd_list_OnCellClick" onheadclick="gd_list_OnHeadClick" onkeydown="gd_list_OnKeyDown" taborder="7" tabstop="true" tooltiptype="inplace,mouseleave" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 365 1237 710" selecttype="row" autofittype="none" anchor="all" onexpandup="gd_list_onexpandup" tooltiptext="&#13;&#10;※ 노란음영은 주문신청 완료한 상품입니다.&#13;&#10;">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="28" band="left"/>
                <Column size="80" band="left"/>
                <Column size="150" band="left"/>
                <Column size="80"/>
                <Column size="60"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="85"/>
                <Column size="103"/>
                <Column size="90"/>
                <Column size="120"/>
                <Column size="70"/>
                <Column size="90"/>
                <Column size="200"/>
                <Column size="100"/>
                <Column size="50"/>
                <Column size="80"/>
                <Column size="50"/>
                <Column size="130"/>
                <Column size="30"/>
                <Column size="30"/>
                <Column size="50"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="200"/>
                <Column size="150"/>
                <Column size="80"/>
                <Column size="200"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="70"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="23"/>
                <Column size="60"/>
                <Column size="50"/>
                <Column size="60"/>
                <Column size="80"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="50"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="30" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="상품코드"/>
                <Cell col="2" rowspan="2" displaytype="text" text="상품명"/>
                <Cell col="3" colspan="5" displaytype="text" text="주 문 정 보"/>
                <Cell col="8" colspan="4" displaytype="text" text="신청자" taborder="undefined"/>
                <Cell col="12" colspan="3" displaytype="text" text="보내는 이"/>
                <Cell col="15" colspan="7" displaytype="text" text="지불정보" taborder="undefined"/>
                <Cell col="22" colspan="4" displaytype="text" text="받는 이"/>
                <Cell col="26" colspan="6" displaytype="text" text="결제자 상세정보" taborder="undefined"/>
                <Cell col="32" rowspan="2" displaytype="text" style="linespace:5;" text="명함동봉&#13;&#10;(Y/N)" taborder="undefined"/>
                <Cell col="33" rowspan="2" displaytype="text" style="linespace:5;" text="해피콜&#13;&#10;(Y/N)" taborder="undefined"/>
                <Cell col="34" rowspan="2" colspan="2" displaytype="text" text="발송요청일" taborder="undefined"/>
                <Cell col="36" colspan="7" displaytype="text" text="마감정보" taborder="undefined"/>
                <Cell row="1" col="3" displaytype="text" text="상품가"/>
                <Cell row="1" col="4" displaytype="text" text="수량"/>
                <Cell row="1" col="5" displaytype="text" text="판매금액"/>
                <Cell row="1" col="6" displaytype="text" text="할인금액"/>
                <Cell row="1" col="7" displaytype="text" text="지불금액"/>
                <Cell row="1" col="8" displaytype="text" text="판매구분"/>
                <Cell row="1" col="9" displaytype="text" text="신청자 사번" taborder="undefined"/>
                <Cell row="1" col="10" displaytype="text" text="신청자 연락처"/>
                <Cell row="1" col="11" displaytype="text" text="사업장"/>
                <Cell row="1" col="12" displaytype="text" text="이름"/>
                <Cell row="1" col="13" displaytype="text" text="연락처"/>
                <Cell row="1" col="14" displaytype="text" text="주소"/>
                <Cell row="1" col="15" displaytype="text" text="방식"/>
                <Cell row="1" col="16" displaytype="text" text="할부"/>
                <Cell row="1" col="17" displaytype="text" text="카드구분"/>
                <Cell row="1" col="18" displaytype="text" text="카드"/>
                <Cell row="1" col="19" displaytype="text" text="카드번호"/>
                <Cell row="1" col="20" displaytype="text" text="MM"/>
                <Cell row="1" col="21" displaytype="text" text="YY"/>
                <Cell row="1" col="22" displaytype="text" text="이름"/>
                <Cell row="1" col="23" displaytype="text" text="연락처"/>
                <Cell row="1" col="24" displaytype="text" text="핸드폰"/>
                <Cell row="1" col="25" displaytype="text" text="주소"/>
                <Cell row="1" col="26" displaytype="text" text="거래처"/>
                <Cell row="1" col="27" displaytype="text" text="사업자번호"/>
                <Cell row="1" col="28" displaytype="text" text="주소"/>
                <Cell row="1" col="29" displaytype="text" text="담당자명"/>
                <Cell row="1" col="30" displaytype="text" text="연락처"/>
                <Cell row="1" col="31" displaytype="text" text="이메일"/>
                <Cell row="1" col="36" displaytype="text" text="주문번호"/>
                <Cell row="1" col="37" displaytype="text" text="마감"/>
                <Cell row="1" col="38" displaytype="text" text="배송구분"/>
                <Cell row="1" col="39" displaytype="text" text="택배사"/>
                <Cell row="1" col="40" displaytype="text" text="송장번호"/>
                <Cell row="1" col="41" displaytype="text" text="정산영수증No"/>
                <Cell row="1" col="42" displaytype="text" text="재고량"/>
              </Band>
              <Band id="body">
                <Cell celltype="head" displaytype="text" style="align:right;backgroundimage:EXPR(expr_GetRowTypeImg(rowposition));" expr="expr:currow + 1"/>
                <Cell col="1" displaytype="text" style="align:center;selectcolor: ;" text="bind:ITEM_CODE" tooltiptext="expr:색맹은 못보나"/>
                <Cell col="2" displaytype="text" edittype="expr:IMG_YN == 'Y' ? 'expand' : 'none'" style="align:left;selectcolor: ;" text="bind:ITEM_NAME" expandshow="expr:IMG_YN == 'Y' ? 'show' : 'hide'" expandsize="24" expandimage="URL('theme://Images/new/grd_WF_Camerabtn.png')"/>
                <Cell col="3" displaytype="number" style="align:right;selectcolor: ;" text="bind:SALE_PRICE" mask="#,##0"/>
                <Cell col="4" displaytype="number" edittype="expr:LINE_STATUS=='주문'?&quot;text&quot;:&quot;none&quot;" editfilter="digit" style="align:right;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:PR_QTY" mask="#,##0" editlimit="9" editautoselect="true"/>
                <Cell col="5" displaytype="number" style="align:right;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:SALE_AMOUNT" mask="#,##0"/>
                <Cell col="6" displaytype="number" style="align:right;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:DC_AMOUNT" mask="#,##0"/>
                <Cell col="7" displaytype="number" style="align:right;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:TOT_AMOUNT" mask="#,##0"/>
                <Cell col="8" displaytype="combo" edittype="expr:LINE_STATUS=='주문'?&quot;combo&quot;:&quot;none&quot;" style="align:center;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:SALE_TYPE" editimemode="native" combodataset="ds_sale" combocodecol="CODE" combodatacol="CODE_NAME"/>
                <Cell col="9" displaytype="text" edittype="expr:LINE_STATUS=='주문'?&quot;expand&quot;:&quot;none&quot;" style="align:left;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:RQ_SABUNNM" editimemode="native" expandshow="expr:LINE_STATUS=='주문'?&quot;show&quot;:&quot;hide&quot;" expandsize="20"/>
                <Cell col="10" edittype="expr:LINE_STATUS=='주문'?&quot;text&quot;:&quot;none&quot;" editfilter="integer" style="align:left;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:RQ_TEL" editlimit="20" editimemode="native" editlengthunit="ascii"/>
                <Cell col="11" displaytype="text" style="align:left;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:UPJANGNM" editimemode="native"/>
                <Cell col="12" edittype="expr:LINE_STATUS=='주문'?&quot;text&quot;:&quot;none&quot;" style="align:left;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:SEND_NAME" editlimit="100" editimemode="hangul" editautoselect="true" editlengthunit="ascii"/>
                <Cell col="13" edittype="expr:LINE_STATUS=='주문'?&quot;text&quot;:&quot;none&quot;" editfilter="integer" style="align:left;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:SEND_TEL" editlimit="20" editimemode="native" editautoselect="true" editlengthunit="ascii"/>
                <Cell col="14" edittype="expr:LINE_STATUS=='주문'?&quot;text&quot;:&quot;none&quot;" style="align:left;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:SEND_ADDR" editlimit="100" editimemode="hangul" editautoselect="true" editlengthunit="ascii"/>
                <Cell col="15" displaytype="combo" edittype="expr:LINE_STATUS=='주문'?&quot;combo&quot;:&quot;none&quot;" style="align:center;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:PAY_METHOD" editimemode="native" combodataset="ds_pay" combocodecol="CODE" combodatacol="CODE_NAME"/>
                <Cell col="16" displaytype="combo" edittype="expr:LINE_STATUS=='주문' &amp;&amp; PAY_METHOD=='2'?&quot;combo&quot;:&quot;none&quot;" style="align:center;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:INST_PERIOD" editimemode="native" combodataset="ds_inst" combocodecol="CODE" combodatacol="CODE_NAME"/>
                <Cell col="17" displaytype="combo" edittype="expr:LINE_STATUS=='주문' &amp;&amp; PAY_METHOD=='2'?&quot;combo&quot;:&quot;none&quot;" style="align:center;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:CARD_CLASS" editimemode="native" combodataset="ds_cardClass" combocodecol="CODE" combodatacol="NAME"/>
                <Cell col="18" displaytype="combo" edittype="expr:LINE_STATUS=='주문' &amp;&amp; PAY_METHOD=='2'?&quot;combo&quot;:&quot;none&quot;" style="align:center;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:CARD_COMP" editimemode="native" combodataset="ds_card" combocodecol="CODE" combodatacol="CODE_NAME"/>
                <Cell col="19" edittype="expr:LINE_STATUS=='주문' &amp;&amp; PAY_METHOD=='2'?&quot;text&quot;:&quot;none&quot;" editfilter="digit" style="align:left;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:CARD_NUM" mask="####-####-####-####" editlimit="16" editimemode="native" editautoselect="true"/>
                <Cell col="20" displaytype="combo" edittype="expr:LINE_STATUS=='주문' &amp;&amp; PAY_METHOD=='2'?&quot;combo&quot;:&quot;none&quot;" style="align:center;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:VALID_THRU_MM" editimemode="native" combodataset="ds_mm" combocodecol="CODE" combodatacol="NAME"/>
                <Cell col="21" displaytype="combo" edittype="expr:LINE_STATUS=='주문' &amp;&amp; PAY_METHOD=='2'?&quot;combo&quot;:&quot;none&quot;" style="align:center;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:VALID_THRU_YY" editimemode="native" combodataset="ds_yy" combocodecol="CODE" combodatacol="NAME"/>
                <Cell col="22" edittype="expr:LINE_STATUS=='주문'?&quot;text&quot;:&quot;none&quot;" style="align:left;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:RECE_NAME" editlimit="100" editimemode="hangul" editautoselect="true" editlengthunit="ascii"/>
                <Cell col="23" edittype="expr:LINE_STATUS=='주문'?&quot;text&quot;:&quot;none&quot;" editfilter="integer" style="align:left;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:RECE_TEL" editlimit="20" editimemode="native" editautoselect="true" editlengthunit="ascii"/>
                <Cell col="24" edittype="expr:LINE_STATUS=='주문'?&quot;text&quot;:&quot;none&quot;" editfilter="integer" style="align:left;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:RECE_HP" editlimit="20" editimemode="native" editautoselect="true" editlengthunit="ascii"/>
                <Cell col="25" edittype="expr:LINE_STATUS=='주문'?&quot;text&quot;:&quot;none&quot;" style="align:left;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:RECE_ADDR" editlimit="100" editimemode="hangul" editautoselect="true" editlengthunit="ascii"/>
                <Cell col="26" edittype="expr:LINE_STATUS=='주문'?&quot;expand&quot;:&quot;none&quot;" style="align:left;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:AR_CUSTNM" editimemode="native" expandshow="expr:LINE_STATUS=='주문'?&quot;show&quot;:&quot;hide&quot;" expandsize="20"/>
                <Cell col="27" edittype="expr:LINE_STATUS=='주문'?&quot;text&quot;:&quot;none&quot;" editfilter="digit" style="align:center;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:AR_SAUPNO" mask="###-##-#####" editlimit="10" editimemode="native" editautoselect="true"/>
                <Cell col="28" edittype="expr:LINE_STATUS=='주문'?&quot;text&quot;:&quot;none&quot;" style="align:left;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:AR_ADDR" editlimit="100" editimemode="hangul" editautoselect="true" editlengthunit="ascii"/>
                <Cell col="29" edittype="expr:LINE_STATUS=='주문'?&quot;text&quot;:&quot;none&quot;" style="align:left;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:AR_NAME" editlimit="100" editimemode="hangul" editautoselect="true" editlengthunit="ascii"/>
                <Cell col="30" edittype="expr:LINE_STATUS=='주문'?&quot;text&quot;:&quot;none&quot;" editfilter="integer" style="align:left;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:AR_TEL" editlimit="20" editimemode="native" editautoselect="true" editlengthunit="ascii"/>
                <Cell col="31" edittype="expr:LINE_STATUS=='주문'?&quot;text&quot;:&quot;none&quot;" style="align:left;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:AR_EMAIL" editlimit="100" editimemode="alpha" editautoselect="true" editlengthunit="ascii"/>
                <Cell col="32" displaytype="combo" edittype="expr:LINE_STATUS=='주문'?&quot;combo&quot;:&quot;none&quot;" style="align:center;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:CONTENT" editimemode="native" combodataset="ds_yn" combocodecol="CD" combodatacol="NM"/>
                <Cell col="33" displaytype="combo" edittype="expr:LINE_STATUS=='주문'?&quot;combo&quot;:&quot;none&quot;" editfilter="digit" style="align:center;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:CALL_YN" editlimit="8" editimemode="native" editautoselect="true" combodataset="ds_yn" combocodecol="CD" combodatacol="NM" calendardisplaynulltype="none"/>
                <Cell col="34" edittype="expr:LINE_STATUS=='주문'?&quot;text&quot;:&quot;none&quot;" editfilter="digit" style="align:center;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:DELI_EXPT_DATE" mask="####-##-##" editlimit="8" editimemode="native" editautoselect="true" calendardisplaynulltype="none"/>
                <Cell col="35" displaytype="normal" edittype="expr:LINE_STATUS=='주문'?&quot;expand&quot;:&quot;none&quot;" style="align:center;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:DELI_EXPT_DATE_CAL" editimemode="native" expandshow="expr:LINE_STATUS=='주문'?&quot;show&quot;:&quot;hide&quot;" expandsize="20" expandimage="URL('theme://images/new/cal_WF_IconN.png')"/>
                <Cell col="36" displaytype="text" style="align:right;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:SP_ID"/>
                <Cell col="37" displaytype="text" style="align:center;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:LINE_STATUS"/>
                <Cell col="38" displaytype="text" style="align:center;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:DELI_TYPE"/>
                <Cell col="39" displaytype="text" style="align:left;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:DELI_COMP"/>
                <Cell col="40" displaytype="text" style="align:center;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:INVOICE_NUM"/>
                <Cell col="41" displaytype="text" style="align:center;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:BILL_NO"/>
                <Cell col="42" displaytype="number" style="align:right;background:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');background2:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');color:EXPR(getRowType(currow)== '1' ? 'black' : 'default');color2:EXPR(getRowType(currow)== '1' ? 'black' : 'default');selectcolor:EXPR(getRowType(currow)== '1' ? '#EECE60' : 'default');" text="bind:STOCK_QTY" mask="#,##0"/>
              </Band>
              <Band id="summary">
                <Cell displaytype="text" style="align:left;"/>
                <Cell col="1" displaytype="text" style="align:center;" text="합  계"/>
                <Cell col="2" displaytype="none" style="align:left;"/>
                <Cell col="3" displaytype="text" style="align:left;"/>
                <Cell col="4" displaytype="number" style="align:right;" expr="expr:getSum(&quot;PR_QTY&quot;)" mask="#,##0"/>
                <Cell col="5" displaytype="number" style="align:right;" expr="expr:getSum(&quot;SALE_AMOUNT&quot;)" mask="#,##0"/>
                <Cell col="6" displaytype="number" style="align:right;" expr="expr:getSum(&quot;DC_AMOUNT&quot;)" mask="#,##0"/>
                <Cell col="7" displaytype="number" style="align:right;" expr="expr:getSum(&quot;TOT_AMOUNT&quot;)" mask="#,##0"/>
                <Cell col="8" displaytype="text" style="align:left;"/>
                <Cell col="9" displaytype="text" style="align:left;"/>
                <Cell col="10" displaytype="text" style="align:left;"/>
                <Cell col="11" displaytype="text" style="align:left;"/>
                <Cell col="12" displaytype="text" style="align:left;"/>
                <Cell col="13" displaytype="text" style="align:left;"/>
                <Cell col="14" displaytype="text" style="align:left;"/>
                <Cell col="15" displaytype="text" style="align:left;"/>
                <Cell col="16" displaytype="text" style="align:left;"/>
                <Cell col="17" displaytype="text" style="align:left;"/>
                <Cell col="18" displaytype="text" style="align:left;"/>
                <Cell col="19" displaytype="text" style="align:left;"/>
                <Cell col="20" colspan="2" displaytype="text" style="align:left;"/>
                <Cell col="22" displaytype="text" style="align:left;"/>
                <Cell col="23" displaytype="text" style="align:left;"/>
                <Cell col="24" displaytype="text" style="align:left;"/>
                <Cell col="25" displaytype="text" style="align:left;"/>
                <Cell col="26" displaytype="text" style="align:left;"/>
                <Cell col="27" displaytype="text" style="align:left;"/>
                <Cell col="28" displaytype="text" style="align:left;"/>
                <Cell col="29" displaytype="text" style="align:left;"/>
                <Cell col="30" displaytype="text" style="align:left;"/>
                <Cell col="31" displaytype="text" style="align:left;"/>
                <Cell col="32" displaytype="none" style="align:left;"/>
                <Cell col="33" displaytype="none" style="align:left;"/>
                <Cell col="34" displaytype="none" style="align:left;"/>
                <Cell col="35" displaytype="none" style="align:left;"/>
                <Cell col="36" displaytype="text" style="align:left;"/>
                <Cell col="37" displaytype="text" style="align:left;"/>
                <Cell col="38" displaytype="text" style="align:left;"/>
                <Cell col="39" displaytype="text" style="align:left;"/>
                <Cell col="40" displaytype="text" style="align:left;"/>
                <Cell col="41" displaytype="text" style="align:left;"/>
                <Cell col="42" displaytype="text" style="align:left;"/>
              </Band>
            </Format>
            <Format id="Default0">
              <Columns>
                <Column size="28" band="left"/>
                <Column size="80" band="left"/>
                <Column size="150" band="left"/>
                <Column size="80"/>
                <Column size="60"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="60"/>
                <Column size="75"/>
                <Column size="17"/>
                <Column size="50"/>
                <Column size="50"/>
                <Column size="80"/>
                <Column size="90"/>
                <Column size="70"/>
                <Column size="60"/>
                <Column size="50"/>
                <Column size="60"/>
                <Column size="80"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="50"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="상품코드"/>
                <Cell col="2" rowspan="2" displaytype="text" text="상품명"/>
                <Cell col="3" colspan="6" displaytype="text" text="주 문 정 보"/>
                <Cell col="9" colspan="3" displaytype="text" text="신청자"/>
                <Cell col="12" displaytype="text" text="보내는 이"/>
                <Cell col="13" displaytype="text" text="받는 이"/>
                <Cell col="14" colspan="2" displaytype="text" text="결제자 상세정보"/>
                <Cell col="16" rowspan="2" displaytype="text" expr="expr:&quot;명함동봉\n(Y/N)&quot;"/>
                <Cell col="17" colspan="7" displaytype="text" text="마감정보"/>
                <Cell row="1" col="3" displaytype="text" text="상품가"/>
                <Cell row="1" col="4" displaytype="text" text="수량"/>
                <Cell row="1" col="5" displaytype="text" text="판매금액"/>
                <Cell row="1" col="6" displaytype="text" text="배송비"/>
                <Cell row="1" col="7" displaytype="text" text="할인금액"/>
                <Cell row="1" col="8" displaytype="text" text="지불금액"/>
                <Cell row="1" col="9" displaytype="text" text="판매구분"/>
                <Cell row="1" col="10" colspan="2" displaytype="text" text="신청자 사번"/>
                <Cell row="1" col="12" displaytype="text" text="이름"/>
                <Cell row="1" col="13" displaytype="text" text="이름"/>
                <Cell row="1" col="14" displaytype="text" text="사업자번호"/>
                <Cell row="1" col="15" displaytype="text" text="담당자명"/>
                <Cell row="1" col="17" displaytype="text" text="주문번호"/>
                <Cell row="1" col="18" displaytype="text" text="마감"/>
                <Cell row="1" col="19" displaytype="text" text="배송구분"/>
                <Cell row="1" col="20" displaytype="text" text="택배사"/>
                <Cell row="1" col="21" displaytype="text" text="송장번호"/>
                <Cell row="1" col="22" displaytype="text" text="정산영수증No"/>
                <Cell row="1" col="23" displaytype="text" text="재고량"/>
              </Band>
              <Band id="body">
                <Cell celltype="head" displaytype="text" style="align:right;backgroundimage:EXPR(expr_GetRowTypeImg(rowposition));" expr="expr:currow + 1"/>
                <Cell col="1" displaytype="text" style="align:center;" text="bind:ITEM_CODE"/>
                <Cell col="2" displaytype="text" edittype="expr:IMG_YN == 'Y' ? 'expand' : 'none'" style="align:left;" text="bind:ITEM_NAME" expandshow="expr:IMG_YN == 'Y' ? 'show' : 'hide'" expandsize="24" expandimage="URL('theme://Images/new/grd_WF_Camerabtn.png')"/>
                <Cell col="3" displaytype="number" style="align:left;" text="bind:SALE_PRICE" mask="#,##0"/>
                <Cell col="4" displaytype="number" edittype="expr:setEditExpr(iif(LINE_STATUS=='마감',&quot;none&quot;,&quot;number&quot;))" editfilter="expr:setfilterExpr(iif(LINE_STATUS=='마감',&quot;none&quot;,&quot;number&quot;))" style="align:left;" text="bind:PR_QTY" mask="#,##0"/>
                <Cell col="5" displaytype="number" style="align:left;" text="bind:SALE_AMOUNT" mask="#,##0"/>
                <Cell col="6" displaytype="number" style="align:left;" text="bind:DELI_FEE" mask="#,##0"/>
                <Cell col="7" displaytype="number" style="align:left;" text="bind:DC_AMOUNT" mask="#,##0"/>
                <Cell col="8" displaytype="number" style="align:left;" text="bind:TOT_AMOUNT" mask="#,##0"/>
                <Cell col="9" displaytype="combo" edittype="expr:setEditExpr(iif(LINE_STATUS=='마감',&quot;none&quot;,&quot;combo&quot;))" editfilter="expr:setfilterExpr(iif(LINE_STATUS=='마감',&quot;none&quot;,&quot;combo&quot;))" style="align:center;" text="bind:SALE_TYPE" editimemode="native" combodataset="ds_sale" combocodecol="CODE" combodatacol="CODE_NAME"/>
                <Cell col="10" displaytype="text" style="align:left;" text="bind:RQ_SABUNNM" editimemode="native"/>
                <Cell col="11" displaytype="text" edittype="expand" style="align:center;" expandshow="show"/>
                <Cell col="12" displaytype="text" edittype="expr:setEditExpr(iif(LINE_STATUS=='마감',&quot;none&quot;,&quot;normal&quot;))" editfilter="expr:setfilterExpr(iif(LINE_STATUS=='마감',&quot;none&quot;,&quot;normal&quot;))" style="align:left;" text="bind:SEND_NAME" editimemode="native"/>
                <Cell col="13" displaytype="text" edittype="expr:setEditExpr(iif(LINE_STATUS=='마감',&quot;none&quot;,&quot;normal&quot;))" editfilter="expr:setfilterExpr(iif(LINE_STATUS=='마감',&quot;none&quot;,&quot;normal&quot;))" style="align:left;" text="bind:RECE_NAME" editimemode="native"/>
                <Cell col="14" displaytype="text" edittype="expr:setEditExpr(iif(LINE_STATUS=='마감',&quot;none&quot;,&quot;normal&quot;))" editfilter="expr:setfilterExpr(iif(LINE_STATUS=='마감',&quot;none&quot;,&quot;normal&quot;))" style="align:center;" text="bind:AR_SAUPNO" mask="###-##-#####" editlimit="10" editimemode="native"/>
                <Cell col="15" displaytype="text" edittype="expr:setEditExpr(iif(LINE_STATUS=='마감',&quot;none&quot;,&quot;normal&quot;))" editfilter="expr:setfilterExpr(iif(LINE_STATUS=='마감',&quot;none&quot;,&quot;normal&quot;))" style="align:left;" text="bind:AR_NAME" editimemode="native"/>
                <Cell col="16" displaytype="combo" edittype="expr:setEditExpr(iif(LINE_STATUS=='마감',&quot;none&quot;,&quot;combo&quot;))" editfilter="expr:setfilterExpr(iif(LINE_STATUS=='마감',&quot;none&quot;,&quot;combo&quot;))" style="align:center;" text="bind:CONTENT" editimemode="native" combodataset="ds_yn" combocodecol="CD" combodatacol="NM"/>
                <Cell col="17" displaytype="text" style="align:right;color:EXPR(iif(LINE_STATUS=='마감',&quot;red&quot;,&quot;default&quot;));" text="bind:SP_ID"/>
                <Cell col="18" displaytype="text" style="align:center;color:EXPR(iif(LINE_STATUS=='마감',&quot;red&quot;,&quot;default&quot;));" text="bind:LINE_STATUS"/>
                <Cell col="19" displaytype="text" style="align:center;" text="bind:DELI_TYPE"/>
                <Cell col="20" displaytype="text" style="align:left;" text="bind:DELI_COMP"/>
                <Cell col="21" displaytype="text" style="align:center;" text="bind:INVOICE_NUM"/>
                <Cell col="22" displaytype="text" style="align:center;" text="bind:BILL_NO"/>
                <Cell col="23" displaytype="number" style="align:left;" text="bind:STOCK_QTY" mask="#,##0"/>
              </Band>
              <Band id="summary">
                <Cell displaytype="text" style="align:left;"/>
                <Cell col="1" displaytype="text" style="align:center;" text="합  계"/>
                <Cell col="2" displaytype="none" style="align:left;"/>
                <Cell col="3" displaytype="text" style="align:left;"/>
                <Cell col="4" displaytype="number" style="align:left;" expr="expr:getSum(&quot;PR_QTY&quot;)" mask="#,##0"/>
                <Cell col="5" displaytype="number" style="align:left;" expr="expr:getSum(&quot;SALE_AMOUNT&quot;)" mask="#,##0"/>
                <Cell col="6" displaytype="number" style="align:left;" expr="expr:getSum(&quot;DELI_FEE&quot;)" mask="#,##0"/>
                <Cell col="7" displaytype="number" style="align:left;" expr="expr:getSum(&quot;DC_AMOUNT&quot;)" mask="#,##0"/>
                <Cell col="8" displaytype="number" style="align:left;" expr="expr:getSum(&quot;TOT_AMOUNT&quot;)" mask="#,##0"/>
                <Cell col="9" displaytype="text" style="align:left;"/>
                <Cell col="10" displaytype="text" style="align:left;"/>
                <Cell col="11" displaytype="text" style="align:left;"/>
                <Cell col="12" displaytype="text" style="align:left;"/>
                <Cell col="13" displaytype="text" style="align:left;"/>
                <Cell col="14" displaytype="text" style="align:left;"/>
                <Cell col="15" displaytype="text" style="align:left;"/>
                <Cell col="16" displaytype="none" style="align:left;"/>
                <Cell col="17" displaytype="text" style="align:left;"/>
                <Cell col="18" displaytype="text" style="align:left;"/>
                <Cell col="19" displaytype="text" style="align:left;"/>
                <Cell col="20" displaytype="text" style="align:left;"/>
                <Cell col="21" displaytype="text" style="align:left;"/>
                <Cell col="22" displaytype="text" style="align:left;"/>
                <Cell col="23" displaytype="text" style="align:left;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid autoenter="select" binddataset="ds_list1" cellmovingtype="col" cellsizingtype="col" enable="true" id="gd_list1" useinputpanel="false" selecttype="row" oncellclick="gd_list_OnCellClick" oncelldblclick="gd_list_OnCellDblClick" onheadclick="gd_list_OnHeadClick" taborder="5" tabstop="false" tooltiptype="default" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 158 1237 326" autofittype="none" anchor="left top right" onkeydown="gd_list1_onkeydown" onexpandup="gd_list1_onexpandup">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30" band="left"/>
                <Column size="100"/>
                <Column size="280"/>
                <Column size="200"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="25" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell/>
                <Cell col="1" text="상품코드"/>
                <Cell col="2" text="상품명"/>
                <Cell col="3" text="구성"/>
                <Cell col="4" text="과/면세"/>
                <Cell col="5" text="상품가"/>
                <Cell col="6" text="묶음수량"/>
                <Cell col="7" colspan="2" text="수량할인/율" taborder="undefined"/>
                <Cell col="9" colspan="2" text="금액할인/율" taborder="undefined"/>
                <Cell col="11" text="재고량"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow + 1"/>
                <Cell col="1" text="bind:ITEM_CODE"/>
                <Cell col="2" edittype="expr:IMG_YN == 'Y' ? 'expand' : 'none'" style="align:left;" text="bind:ITEM_NAME" expandshow="expr:IMG_YN == 'Y' ? 'show' : 'hide'" expandsize="24" expandimage="URL('theme://Images/new/grd_WF_Camerabtn.png')"/>
                <Cell col="3" style="align:left;" text="bind:ITEM_SIZE"/>
                <Cell col="4" style="align:center;" text="bind:TAX_CODE"/>
                <Cell col="5" displaytype="number" style="align:right;" text="bind:SALE_PRICE"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:MAX_ORD_QTY"/>
                <Cell col="7" displaytype="number" style="align:right;" text="bind:QTY_DC_STD"/>
                <Cell col="8" displaytype="number" style="align:right;" text="bind:QTY_DC_RATE" mask="#,##0%"/>
                <Cell col="9" displaytype="number" style="align:right;" text="bind:AMT_DC_STD"/>
                <Cell col="10" displaytype="number" style="align:right;" text="bind:AMT_DC_RATE" mask="#,##0%"/>
                <Cell col="11" displaytype="number" style="align:right;" text="bind:STOCK_QTY"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static3" text="상품가는 VAT가 포함된 금액입니다." position="absolute 245 340 476 361" class="sta_WF_DiscInfo" style="font:Dotum,9,bold;"/>
        <Static id="Static6" text="[Alt + F3] : 상품정보를 제외한 나머지 항목에 대해 윗 라인을 복사합니다." position="absolute 496 340 1008 361" class="sta_WF_DiscInfo" style="font:Dotum,9,bold;"/>
        <Static id="Static9" text="해당 상품목록의 상품코드란을 클릭하면 상품 이미지를 확인하실 수 있습니다." position="absolute 85 85 572 98" class="sta_WF_DiscInfo"/>
        <Button id="btn_ExlImp" onclick="fn_Exl_Import" taborder="6" tabstop="false" text="엑셀업로드" position="absolute 1160 339 1237 360" class="btn_WF_Custom" image="" anchor="top right"/>
        <MPFileDialog id="fd_Excel" taborder="26" position="absolute 1073 339 1097 363"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="29" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 1197 40"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 1205 71"/>
        <Static id="Static22" text="상품검색" class="sta_WF_Title01" position="absolute 0 84 74 102"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 450 84"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 97 450 102"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 160 40 190 61" anchor="left top"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Static id="Static27" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static02" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 392 40 422 61" anchor="left top"/>
        <Static id="Static10" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 250 40 260 61" anchor="left top"/>
        <Static id="Static06" text="주문일자" class="sta_WFSA_label" position="absolute 190 40 263 61" anchor="left top"/>
        <Combo codecolumn="SID" datacolumn="STITLE" id="cb_Season" innerdataset="ds_season_cb" taborder="0" position="absolute 15 40 160 61" index="-1" onitemchanged="cb_Season_onitemchanged"/>
        <MaskEdit id="me_PrDate" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" taborder="1" type="string" position="absolute 260 40 372 61" class="msk_WF_Cal" onkillfocus="g_Date_OnKillFocus" autoselect="true"/>
        <Button id="btn_PrDate" onclick="g_CalButton_OnClick" taborder="2" tabstop="false" text="" userdata="me_PrDate" position="absolute 371 40 392 61" class="btn_WF_cal" image=""/>
        <Static id="st_Me" text="본사 인사팀 가-전산팀" position="absolute 422 40 861 61" style="font:Gulim,9,bold;"/>
        <Static id="Static13" class="sta_WFSA_Labelbg" position="absolute 0 102 1237 143" anchor="left top right"/>
        <Static id="Static14" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 1 102 1198 112"/>
        <Static id="Static17" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1 112 16 133" anchor="left top"/>
        <Static id="Static23" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 133 1205 143"/>
        <Static id="Static26" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 94 112 104 133" anchor="left top"/>
        <Static id="Static28" text="상품명/코드" class="sta_WFSA_label" position="absolute 16 112 97 133" anchor="left top"/>
        <Edit autoselect="true" id="ed_Item" imemode="native" onkeydown="ed_Item_OnKeyDown" taborder="3" position="absolute 104 112 316 133"/>
        <Static id="Static11" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 326 1237 339" anchor="left top"/>
        <Static id="Static12" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 352 1145 357" anchor="left top"/>
        <Static id="Static29" text="주문내역" class="sta_WF_Title01" position="absolute 0 340 314 361" anchor="left top"/>
        <Button id="btn_search" taborder="4" text="검색" class="btn_WF_Custom" position="absolute 319 112 360 133" onclick="btn_search_OnClick" onkeydown="btn_search_OnKeyDown" anchor="default"/>
        <Static id="Static30" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 360 1237 365" anchor="left top"/>
        <Static id="Static00" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1222 112 1237 133" anchor="left top"/>
        <Static id="Static03" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 143 1252 158" anchor="left bottom"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond">
        <ColumnInfo>
          <Column id="SP_DATE" size="8" prop="default" type="STRING"/>
          <Column id="SEASON_NUM" size="256" prop="default" type="STRING"/>
          <Column id="SEASON_NAME" type="STRING" size="256"/>
          <Column id="ITEM_CODE" type="STRING" size="256"/>
          <Column id="ITEM_NAME" size="100" prop="default" type="STRING"/>
          <Column id="ITEM_CLASS3" size="100" prop="default" type="STRING"/>
          <Column id="ITEM_CLASS4" size="100" prop="default" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_list" cancolumnchange="ds_list_CanColumnChange" oncolumnchanged="ds_list_OnColumnChanged">
        <ColumnInfo>
          <Column id="SP_ID" type="BIGDECIMAL" size="39"/>
          <Column id="SEASON_NUM" type="BIGDECIMAL" size="39"/>
          <Column id="ITEM_CODE" type="STRING" size="12"/>
          <Column id="ITEM_NAME" type="STRING" size="601"/>
          <Column id="ITEM_SIZE" type="STRING" size="1000"/>
          <Column id="TAX_CODE" type="STRING" size="2"/>
          <Column id="SALE_PRICE" type="BIGDECIMAL" size="22"/>
          <Column id="PR_QTY" type="BIGDECIMAL" size="14"/>
          <Column id="INIT_QTY" type="BIGDECIMAL" size="14"/>
          <Column id="SALE_AMOUNT" type="BIGDECIMAL" size="21"/>
          <Column id="DC_AMOUNT" type="BIGDECIMAL" size="21"/>
          <Column id="TOT_AMOUNT" type="BIGDECIMAL" size="39"/>
          <Column id="SALE_TYPE" type="STRING" size="50"/>
          <Column id="IMAGE_PATH" type="STRING" size="756"/>
          <Column id="CONTENT" type="STRING" size="1"/>
          <Column id="LINE_STATUS" type="STRING" size="50"/>
          <Column id="PR_SABUN" type="STRING" size="9"/>
          <Column id="RQ_SABUN" type="STRING" size="9"/>
          <Column id="RQ_SABUNNM" type="STRING" size="254"/>
          <Column id="RQ_TEL" type="STRING" size="4000"/>
          <Column id="SEND_NAME" type="STRING" size="100"/>
          <Column id="SEND_TEL" type="STRING" size="4000"/>
          <Column id="SEND_ADDR" type="STRING" size="4000"/>
          <Column id="RECE_NAME" type="STRING" size="100"/>
          <Column id="RECE_TEL" type="STRING" size="4000"/>
          <Column id="RECE_HP" type="STRING" size="4000"/>
          <Column id="RECE_ADDR" type="STRING" size="4000"/>
          <Column id="AR_SAUPNO" type="STRING" size="13"/>
          <Column id="AR_ADDR" type="STRING" size="4000"/>
          <Column id="AR_NAME" type="STRING" size="100"/>
          <Column id="AR_TEL" type="STRING" size="4000"/>
          <Column id="AR_EMAIL" type="STRING" size="4000"/>
          <Column id="PAY_METHOD" type="STRING" size="50"/>
          <Column id="INST_PERIOD" type="STRING" size="20"/>
          <Column id="CARD_CLASS" type="STRING" size="18"/>
          <Column id="CARD_COMP" type="STRING" size="50"/>
          <Column id="CARD_NUM" type="STRING" size="4000"/>
          <Column id="VALID_THRU_MM" type="STRING" size="2"/>
          <Column id="VALID_THRU_YY" type="STRING" size="2"/>
          <Column id="DELI_TYPE" type="STRING" size="18"/>
          <Column id="DELI_COMP" type="STRING" size="18"/>
          <Column id="INVOICE_NUM" type="STRING" size="50"/>
          <Column id="BILL_NO" type="STRING" size="50"/>
          <Column id="MAX_ORD_QTY" type="BIGDECIMAL" size="14"/>
          <Column id="STOCK_QTY" type="BIGDECIMAL" size="39"/>
          <Column id="DELI_FREE_AMT" type="BIGDECIMAL" size="21"/>
          <Column id="QTY_DC_STD" type="BIGDECIMAL" size="14"/>
          <Column id="QTY_DC_RATE" type="BIGDECIMAL" size="14"/>
          <Column id="AMT_DC_STD" type="BIGDECIMAL" size="21"/>
          <Column id="AMT_DC_RATE" type="BIGDECIMAL" size="14"/>
          <Column id="UPJANG" type="BIGDECIMAL" size="39"/>
          <Column id="UPJANGNM" type="STRING" size="108"/>
          <Column id="UPJANG_EDIT" type="STRING" size="1"/>
          <Column id="OPER_ORG_SN" type="BIGDECIMAL" size="39"/>
          <Column id="VD_SN" type="STRING" size="18"/>
          <Column id="CONTRACT_START" type="STRING" size="8"/>
          <Column id="AR_CUSTCD" type="BIGDECIMAL" size="11"/>
          <Column id="AR_CUSTNM" type="STRING" size="200"/>
          <Column id="DELI_EXPT_DATE" type="STRING" size="8"/>
          <Column id="DELI_EXPT_DATE_CAL" type="STRING" size="255"/>
          <Column id="IMG_YN" type="STRING" size="1"/>
          <Column id="CALL_YN" type="STRING" size="1"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list1">
        <ColumnInfo>
          <Column id="ITEM_CODE" type="STRING" size="12"/>
          <Column id="ITEM_NAME" type="STRING" size="601"/>
          <Column id="ITEM_SIZE" type="STRING" size="1000"/>
          <Column id="TAX_CODE" type="STRING" size="2"/>
          <Column id="ITEM_DELI_FEE" type="BIGDECIMAL" size="21"/>
          <Column id="SALE_PRICE" type="BIGDECIMAL" size="22"/>
          <Column id="IMAGE_PATH" type="STRING" size="756"/>
          <Column id="MAX_ORD_QTY" type="BIGDECIMAL" size="14"/>
          <Column id="STOCK_QTY" type="BIGDECIMAL" size="39"/>
          <Column id="QTY_DC_STD" type="BIGDECIMAL" size="14"/>
          <Column id="QTY_DC_RATE" type="BIGDECIMAL" size="14"/>
          <Column id="AMT_DC_STD" type="BIGDECIMAL" size="21"/>
          <Column id="AMT_DC_RATE" type="BIGDECIMAL" size="14"/>
          <Column id="ITEM_NUM" type="STRING" size="50"/>
          <Column id="OPER_ORG_SN" type="BIGDECIMAL" size="39"/>
          <Column id="VD_SN" type="STRING" size="18"/>
          <Column id="CONTRACT_START" type="STRING" size="8"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_pay"/>
      <Dataset id="ds_inst"/>
      <Dataset id="ds_card"/>
      <Dataset id="ds_common">
        <ColumnInfo>
          <Column id="code" size="256" type="STRING"/>
          <Column id="codename" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_mm">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">01</Col>
            <Col id="NAME">01</Col>
          </Row>
          <Row>
            <Col id="CODE">02</Col>
            <Col id="NAME">02</Col>
          </Row>
          <Row>
            <Col id="CODE">03</Col>
            <Col id="NAME">03</Col>
          </Row>
          <Row>
            <Col id="CODE">04</Col>
            <Col id="NAME">04</Col>
          </Row>
          <Row>
            <Col id="CODE">05</Col>
            <Col id="NAME">05</Col>
          </Row>
          <Row>
            <Col id="CODE">06</Col>
            <Col id="NAME">06</Col>
          </Row>
          <Row>
            <Col id="CODE">07</Col>
            <Col id="NAME">07</Col>
          </Row>
          <Row>
            <Col id="CODE">08</Col>
            <Col id="NAME">08</Col>
          </Row>
          <Row>
            <Col id="CODE">09</Col>
            <Col id="NAME">09</Col>
          </Row>
          <Row>
            <Col id="CODE">10</Col>
            <Col id="NAME">10</Col>
          </Row>
          <Row>
            <Col id="CODE">11</Col>
            <Col id="NAME">11</Col>
          </Row>
          <Row>
            <Col id="CODE">12</Col>
            <Col id="NAME">12</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_yy">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">19</Col>
            <Col id="NAME">19</Col>
          </Row>
          <Row>
            <Col id="CODE">20</Col>
            <Col id="NAME">20</Col>
          </Row>
          <Row>
            <Col id="CODE">21</Col>
            <Col id="NAME">21</Col>
          </Row>
          <Row>
            <Col id="CODE">22</Col>
            <Col id="NAME">22</Col>
          </Row>
          <Row>
            <Col id="CODE">23</Col>
            <Col id="NAME">23</Col>
          </Row>
          <Row>
            <Col id="CODE">24</Col>
            <Col id="NAME">24</Col>
          </Row>
          <Row>
            <Col id="CODE">25</Col>
            <Col id="NAME">25</Col>
          </Row>
          <Row>
            <Col id="CODE">26</Col>
            <Col id="NAME">26</Col>
          </Row>
          <Row>
            <Col id="CODE">27</Col>
            <Col id="NAME">27</Col>
          </Row>
          <Row>
            <Col id="CODE">28</Col>
            <Col id="NAME">28</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_sale"/>
      <Dataset id="ds_excel"/>
      <Dataset id="ds_RQ_TEL">
        <ColumnInfo>
          <Column id="RQ_TEL" size="256" type="STRING"/>
          <Column id="RQ_SABUNNM" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list1_excel">
        <ColumnInfo>
          <Column id="ITEM_CODE" size="50" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="TAX_CODE" size="3" type="STRING"/>
          <Column id="SALE_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="ITEM_DELI_FEE" size="50" type="BIGDECIMAL"/>
          <Column id="IMAGE_PATH" size="200" type="STRING"/>
          <Column id="MAX_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="STOCK_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="DELI_FREE_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="QTY_DC_STD" size="22" type="BIGDECIMAL"/>
          <Column id="QTY_DC_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="AMT_DC_STD" size="22" type="BIGDECIMAL"/>
          <Column id="AMT_DC_RATE" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_EXP_CD">
        <ColumnInfo>
          <Column id="EXP_CD" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_RQ_SABUN_Excel_Import_YN">
        <ColumnInfo>
          <Column id="CNT" size="256" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_timeSet"/>
      <Dataset id="ds_yn">
        <ColumnInfo>
          <Column id="CD" size="256" type="STRING"/>
          <Column id="NM" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CD">N</Col>
            <Col id="NM">N</Col>
          </Row>
          <Row>
            <Col id="CD">Y</Col>
            <Col id="NM">Y</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_season">
        <ColumnInfo>
          <Column id="SID" size="256" prop="default" type="STRING"/>
          <Column id="STITLE" size="256" prop="default" type="STRING"/>
          <Column id="SDATE" size="256" prop="default" type="STRING"/>
          <Column id="SDATE_DISP" size="256" prop="default" type="STRING"/>
          <Column id="STIME" size="256" prop="default" type="STRING"/>
          <Column id="STIME_DISP" size="256" prop="default" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_season_cb">
        <ColumnInfo>
          <Column id="SID" size="256" prop="default" type="STRING"/>
          <Column id="STITLE" size="256" prop="default" type="STRING"/>
          <Column id="START_DATE" size="256" prop="default" type="STRING"/>
          <Column id="END_DATE" size="256" prop="default" type="STRING"/>
          <Column id="SDATE" size="256" prop="default" type="STRING"/>
          <Column id="SDATE_DISP" size="256" prop="default" type="STRING"/>
          <Column id="STIME" size="256" prop="default" type="STRING"/>
          <Column id="STIME_DISP" size="256" prop="default" type="STRING"/>
          <Column id="REMARK" size="256" prop="default" type="STRING"/>
          <Column id="USE_YN" size="256" prop="default" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_stock">
        <ColumnInfo>
          <Column id="SEASON_NUM" size="256" prop="default" type="STRING"/>
          <Column id="ITEM_CODE" size="256" prop="default" type="STRING"/>
          <Column id="STOCK_QTY" size="256" prop="default" type="STRING"/>
          <Column id="STOCK_QTY_ITEM" size="256" prop="default" type="STRING"/>
          <Column id="STOCK_QTY_TRANS" size="256" prop="default" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_spDate" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_spDate_oncolumnchanged">
        <ColumnInfo>
          <Column id="SP_DATE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_upjangInfo" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_rqUpjang" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_cardClass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="NAME" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">신용</Col>
            <Col id="NAME">신용</Col>
          </Row>
          <Row>
            <Col id="CODE">체크</Col>
            <Col id="NAME">체크</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_itemList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_exUser" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_lineStatus" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_deliExptDate" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_insideUser" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="me_PrDate" propid="value" datasetid="ds_spDate" columnid="SP_DATE"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
 ******************************************************************************************
 * 시스템구분	: 구매관리>신청관리>판촉상품주문
 * 프로그램명	: FSP00010E.xfdl
 * 기      능	: 판촉상품주문
 * 작  성  자	: 백승현
 * 작성  일자	: 2015-07-06
 * 비      고	:
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
 ************************************************************************************************/
include "U_lib::lib_conversionCom.xjs";
/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
 ************************************************************************************************/
var fa_PR_SABUN_EXP_CD;
var fa_fSearch = true;
var v_spClose;

var v_auth1 = "N";	// 판촉 관리자
var v_auth2 = "N"	// 판촉 정산자
/************************************************************************************************
 * FORM EVENT 영역 (필수)
 ************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(obj, false);

	// FSP Action 정보 생성
	fsp_init(this);

	// 화면 초기화
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 초기화
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	// 업데이트 DS
	v_ds_check = "ds_list";

	//시즌목록코드 불러오기
	fn_getSeasonList();
	cb_Season.index = 0;

	// 시즌 마감 정보조회
	fn_getSeasonInfo();

	// 내부거래 사용자 조회
	fn_getInsideUser();

	// 시즌 발송요청일 기간 조회
	var sDateFr = ds_season.getColumn(0, "ATTR01");
	var sDateTo = ds_season.getColumn(0, "ATTR02");
	
	fn_getDeliExptDate(sDateFr, sDateTo);

	// 주문자 정보
	st_Me.text = application.g_Mu_Nm + " " + application.g_Cc_Nm + " " + application.g_EmpNo + " " + application.g_Name;

	// 현재일 조회
	ds_spDate.enableevent = false;
	me_PrDate.value = fn_CurrDateWeek();
	ds_spDate.enableevent = true;

	// 공통코드
	var v_fil_cond;
	var v_ds = fn_common_code("'022', '023', '024', '028'", "", "", "non", "Y");

	// 결제수단
	v_fil_cond = "GROUP_CODE == '022'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_pay, v_ds.name);

	// 할부기간
	v_fil_cond = "GROUP_CODE == '023'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_inst, v_ds.name);

	// 카드사
	v_fil_cond = "GROUP_CODE == '024'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_card, v_ds.name);

	// 특판판매구분
	v_fil_cond = "GROUP_CODE == '028'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_sale, v_ds.name);

	// 주문자 사번 조회
	fa_PR_SABUN_EXP_CD = fn_getPrSabun();

	gd_list.setFormat("Default");

	// 판촉 정산자
	if( SCAuth.isUserRole("특판02") )
	{
		v_auth1 = "N";
		v_auth2 = "Y";
	}

	// 판촉 관리자
	if( SCAuth.isUserRole("특판03") )
	{
		v_auth1 = "Y";
		v_auth2 = "N";
	}

	// 내부거래가 가능한 사용자 체크하여 필터처리
	if( ds_insideUser.findRow("SABUN", application.g_EmpNo) == -1 )
	{
		// 판매구분
		ds_sale.filter("CODE != '내부거래'");

		// 지불방식
		ds_pay.filter("CODE != 'Z'");
	}
	else
	{
		ds_sale.filter("");
		ds_pay.filter("");
	}

	// 상품목록 조회
	fn_SearchItem();

	// 주문내역 조회
	fn_search();
	
	//2020.01.08 FC 인사기획팀 정유진 대리 요청
	ds_card.filter("CODE != '농협'");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 공통 단축키 이벤트
 *---------------------------------------------------------------------------------------------*/
function frm_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e);

	if( e.keycode == 13 && e.fromreferenceobject == me_PrDate )
		fn_search();
}

/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
 ************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
	if( fn_chkManNull() ) return;

	ds_list.clearData();
	ds_cond.clearData();
	ds_cond.addRow();
	ds_cond.setColumn(0, "SP_DATE", gfn_nvl(ds_spDate.getColumn(0, "SP_DATE"), ""));
	ds_cond.setColumn(0, "SEASON_NUM", gfn_nvl(cb_Season.value, ""));

	var strSvcID = "SEARCH";
	var strURL   = "U_svc::" + "fs/fsp/FSP00010E_T001.jsp";
	var strInDatasets = "ds_cond=ds_cond";
	var strOutDatasets = "ds_list=ds_list";
	var strArgument  = "sType=" + wrapQuote("QryLst");
	var strCallbackFunc = "fn_callback";

	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, true, true, false);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
	// 발주량 0상품 확인
	var nRow = ds_list.findRowExpr("PR_QTY==0");

	if( nRow >= 0 )
	{
		if( !g_Confirm("02", '주문량이 0인 상품이 있습니다!\n해당 상품은 자동삭제 처리됩니다.\n\n그대로 저장하시겠습니까?!') )
		{
			ds_list.rowposition = nRow;
			gd_list.setFocus();
			gd_list.setCellPos(fn_getCellPos(gd_list, "PR_QTY"));
			return;
		}
	}

	// 필수항목
	if( fn_chkManNull() ) return;

	// 데이터 체크
	var sRtn = fn_ChkData();
	if( !gfn_isNull(sRtn) )
	{
		g_Message("EE", sRtn);
		return;
	}

	// 결제방식 체크
	var rtnChk = fn_chkPayType();

	if(rtnChk > 0)
	{
		g_Message("EE", rtnChk + " 행의 결제자 정보를 입력바랍니다." );
		return;
	}

	// 발송요청일 체크
	if( !fn_chkDeliExptDate() )	return;

	//재고량 체크
	var rtnStock = fn_chkStockTotal();
	if(rtnStock > 0)
	{
		g_Message("EE", rtnStock+"번째 상품이 주문량을 초과했습니다.");
		return;
	}

	// 정산자 권한의 사용자는 내부거래를 선택못하게 제어
	

	//같은 상품을 중복발주 했을시 알람을 띄워 줌
	fn_chkSameItem();

	if( !g_Confirm("02", '주문내역을 저장하시겠습니까?!') ) return;

	// 초기화
	ds_cond.clearData();
	ds_cond.addRow();
	ds_cond.setColumn(0, "SP_DATE",   ds_spDate.getColumn(0, "SP_DATE"));
	ds_cond.setColumn(0, "SEASON_NUM",  cb_Season.value);
	ds_cond.setColumn(0, "SEASON_NAME",  cb_Season.text);

	var strSvcID = "SAVE";
	var strURL   = "U_svc::" + "fs/fsp/FSP00010E_T002.jsp";
	var strInDatasets  = "ds_cond=ds_cond ds_list=ds_list:U";
	var strOutDatasets = "";
	var strArgument = "";
	var strCallbackFunc = "fn_callback";

	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, true, true, false);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{
	if( ds_list.rowcount < 1 )
	{
		g_Message("EE", fn_AlertMsg("006"));
		return;
	}

	if( ds_list.rowposition < 0 )
	{
		g_Message("EE", "삭제할 상품을 선택하세요.");
		return;
	}

	var sRowType = ds_list.getRowType(ds_list.rowposition);

	if( sRowType <> 2 )
	{
		if( fn_getLineStatus(ds_list.rowposition) <> '주문' )
		{
			g_Message("EE", "해당 상품은 정산이 완료되어 삭제가 불가합니다!");
			return;
		}
	}

	if(! g_Confirm("01", '선택하신 상품을 삭제하시겠습니까?!')) return;

	// 데이터셋에서 삭제하고 저장시 삭제 로직 실행됨.
	ds_list.deleteRow(ds_list.rowposition);

	// 신규 추가된 행이 아닐시 메세지 처리
	if( sRowType <> 2 )
		g_Message("02", "임시 삭제되었습니다!\n\n저장 후에 실제 삭제가 되오니 착오없으시기 바랍니다.");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 닫기 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_Close()
{
	this.close();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 입력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert(){}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print(){}

/*----------------------------------------------------------------------------------------------
 * 설명      : 엑셀 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_Excel(){}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help(){}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
 ************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수
 *---------------------------------------------------------------------------------------------*/
function fn_callback(nErrorCode, strErrorMsg, strSvcID)
{
	switch( strSvcID )
	{
		// 주문내역 조회
		case "SEARCH":
			if( nErrorCode == 0 )
			{
				if( ds_list.rowcount < 1 )
				{
					// 화면이 처음 열릴때는 메세지 출력 안함
					if( !fa_fSearch )
					{
						g_Message("EE","주문등록한 상품이 없습니다.");
					}

					fa_fSearch = false;
				}
			}
			else
			{
				g_Message("EE", fn_AlertMsg("002"));
			}
			break;

		// 상품목록 조회
		case "ITEM_SEARCH":
			if( nErrorCode == 0 )
			{
				if( ds_list1.rowcount < 1 )
					g_Message("EE", "검색된 상품이 없습니다.");
				else
					gd_list1.setFocus();
			}
			else
			{
				g_Message("EE","상품을 조회하는 중에 오류가 발생하였습니다! \n 관리자에게 문의하세요.");
			}
			break;

		// 주문내역 저장
		case "SAVE":
			if( nErrorCode == 0 )
			{
				fn_search();
				btn_search_OnClick();
				g_Message("02", "주문자료" + fn_AlertMsg("000"));
			}
			else
			{
				g_Message("EE", strErrorMsg);
				fn_search();
				btn_search_OnClick();
			}
			break;
	}
}

/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
 ************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회시 필수항목 체크
 *---------------------------------------------------------------------------------------------*/
function fn_chkManNull()
{
	if( ffn_ChkNull(ds_spDate.getColumn(0, "SP_DATE")) || (gfn_length(ds_spDate.getColumn(0, "SP_DATE")) <  8) )
	{
		g_Message("EE", "주문일자를 정확하게 입력하세요.");
		me_PrDate.setFocus();
		return true;
	}

	return false;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장시 필수항목 체크
 *---------------------------------------------------------------------------------------------*/
function fn_ChkData()
{
	// 데이터셋 변경여부 확인
	if( !gfn_dsIsUpdated(ds_list) )
	{
		return fn_AlertMsg("007");
	}

	// 수량 0인거 제거...
	for( var i = ds_list.rowcount - 1; i >= 0; i-- )
	{
		if( gfn_numFormat(ds_list.getColumn(i, "PR_QTY"), 1) == "0.0" )
			ds_list.deleteRow(i);
	}

	// 마감정보 가져오기
	fn_getSeasonInfo();

	//타임셋 데이터셋에 마감정보 입력
	Copy(ds_timeSet, ds_season);

	if( ds_timeSet.rowcount < 1 )
	{
		return ("마감정보 설정오류 입니다!.");
	}

	// 서버에서 현재일자 조회
	fn_CurrDateWeek();

	// 판매종료일 이후 주문 금지 체크
	if( ds_spDate.getColumn(0, "SP_DATE") > ds_timeSet.getColumn(0, "SDATE") )
	{
		return ("주문일자는 " + ds_timeSet.getColumn(0, "SDATE_DISP") + "까지 가능합니다.");
	}

	// 라인별 체크
	for( var i = 0; i < ds_list.rowcount; i++ )
	{
		if( GetRowType(ds_list, i) == 'normal' )	continue;

		if( ffn_ChkNull(ds_list.getColumn(i, "ITEM_CODE")) )
		{
			ds_list.rowposition = i;
			return "상품코드가 등록되지 않았습니다!";
		}
		
		if( ffn_ChkNull(ds_list.getColumn(i, "UPJANG")) )
		{
			ds_list.rowposition = i;
			return "신청자의 업장정보가 등록되지 않았습니다!\nFC정보기획팀에 문의바랍니다.\n[업장정보확인]";
		}
		
/*
		//판매종료일 이후 주문 금지 체크
		if(me_PrDate.Value > "20120114")
		{
			ds_list.row = i;
			return ("[" + ds_list.GetColumn(i,"ITEM_NAME") + "]상품은 주문가능일자를 초과하였습니다!\n" +
					"주문일자는 2012년01월14일까지 가능합니다.");
		}
*/
		// 디데이체크(13:00시 기준) - 추가 및 수정은 불가... 삭제는 무관
		// 삭제든(수량0 포함) 뭐든 주문을 통으로 막으려면 아래 로직을 for문 위로 올린다.
//		trace("gfn_subStr(gds_currdate.getColumn(0, YMD_TM),0, 12) ===>>> "+ gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"), 0, 12) );
//		trace("me_PrDate.value + ds_timeSet.getColumn(0, STIME) ===>>> "+ (me_PrDate.value + ds_timeSet.getColumn(0, "STIME")) );

		if( gfn_subStr(fn_CurrDateWeek("ymdtm"), 0, 12) > ds_spDate.getColumn(0, "SP_DATE") + ds_timeSet.getColumn(0, "STIME") )
		{
			ds_list.rowposition = i;
			return ("[" + ds_list.getColumn(i,"ITEM_NAME") + "]상품은 주문가능일자를 초과하였습니다!\n" +
					"해당일 주문은 " + ds_timeSet.getColumn(0, "STIME_DISP") + "까지 가능합니다.\n" +
					"수정의 경우 삭제(주문취소)후 주문일을 변경하여 주문하여 주십시요.");
		}

		if( ffn_ChkNull(ds_list.getColumn(i, "SALE_TYPE")) )
		{
			ds_list.rowposition = i;
			return "판매구분을 선택하세요!";
		}
		if( ffn_ChkNull(ds_list.getColumn(i, "RQ_SABUN")) )
		{
			ds_list.rowposition = i;
			return "신청자사번을 입력하세요!";
		}
		if( ffn_ChkNull(ds_list.getColumn(i, "RQ_TEL")) )
		{
			ds_list.rowposition = i;
			return "신청자연락처를 입력하세요!";
		}
		if( ffn_ChkNull(ds_list.getColumn(i, "SEND_NAME")) )
		{
			ds_list.rowposition = i;
			return "보내는 사람를 입력하세요!";
		}
		if( ffn_ChkNull(ds_list.getColumn(i, "SEND_TEL")) )
		{
			ds_list.rowposition = i;
			return "보내는 사람 연락처를 입력하세요!";
		}

		if( ffn_ChkNull(ds_list.getColumn(i, "SEND_ADDR")) )
		{
			ds_list.rowposition = i;
			return "보내는 사람 주소를 입력하세요!";
		}

		if( ffn_ChkNull(ds_list.getColumn(i, "PAY_METHOD")) )
		{
			ds_list.rowposition = i;
			return "결제수단을 선택하세요!";
		}
		if( ffn_ChkNull(ds_list.getColumn(i, "RECE_NAME")) )
		{
			ds_list.rowposition = i;
			return "받는 사람를 입력하세요!";
		}
		if( ffn_ChkNull(ds_list.getColumn(i, "RECE_TEL")) )
		{
			ds_list.rowposition = i;
			return "받는 사람 연락처를 입력하세요!";
		}
		if( ffn_ChkNull(ds_list.getColumn(i, "RECE_HP")) )
		{
			ds_list.rowposition = i;
			return "받는 사람 HP를 입력하세요!";
		}

		if( ffn_ChkNull(ds_list.getColumn(i, "RECE_ADDR")) )
		{
			ds_list.rowposition = i;
			return "받는 사람 주소를 입력하세요!";
		}

		//카드정보 체크하기######################################
		if( ds_list.getColumn(i, "PAY_METHOD") == "2" )	// 카드결제
		{
			if(	   gfn_length(ds_list.getColumn(i, "INST_PERIOD"))		== 0
				|| gfn_length(ds_list.getColumn(i, "CARD_COMP"))		== 0
				|| gfn_length(ds_list.getColumn(i, "CARD_NUM"))			== 0
				|| gfn_length(ds_list.getColumn(i, "VALID_THRU_MM"))	== 0
				|| gfn_length(ds_list.getColumn(i, "VALID_THRU_YY"))	== 0
			  )
			{
				ds_list.rowposition = i;
				return "카드 상세정보를 확인하세요!";
			}
		}

		//카드정보 체크하기######################################
		//내부이용 체크하기######################################
		if( ds_list.getColumn(i, "SALE_TYPE") == "내부거래" )
		{
			if(	ds_list.getColumn(i, "PAY_METHOD") <> "Z" ) // 내부사용
			{
				ds_list.rowposition = i;
				return "내부거래 지불방식을 확인하세요!";
			}
		}

		if( ds_list.getColumn(i, "SALE_TYPE") <> "내부거래" )
		{
			if( ds_list.getColumn(i, "PAY_METHOD") =="Z" ) // 내부사용
			{
				ds_list.rowposition = i;
				return "지불방식을 확인하세요!";
			}
		}
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면에 나타나는 메시지 코드및 텍스트 리턴
 *---------------------------------------------------------------------------------------------*/
function fn_AlertMsg(msgCd)
{
	var v_Msg="";
	switch( msgCd )
	{
		case "000":
			v_Msg= "이(가) 저장되었습니다.";
			break;
		case "001":
			v_Msg= "버튼이 정의 되어 있지않습니다.";
			break;
		case "002":
			v_Msg="서비스 오류:시스템 관리자에게 문의하십시오";
			break;
		case "003":
			v_Msg="필수항목은 반드시 선택하시기 바랍니다.";
			break;
		case "004":
			v_Msg="작업대상 본사를 선택하세요.";
			break;
		case "005":
			v_Msg="을(를) 입력하세요";
			break;
		case "006":
			v_Msg="삭제할 데이터가 없습니다.";
			break;
		case "007":
			v_Msg="변경된 데이터가 없습니다.";
			break;
		case "008":
			v_Msg="시스템ID가 없습니다.";
			break;
		default:
			break;
	}

	return v_Msg;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 상품 조회
 *---------------------------------------------------------------------------------------------*/
function fn_SearchItem(vsItemCode)
{
	if( fn_chkManNull() ) return;

	// 초기화
	ds_list1.clearData();
	ds_cond.clearData();
	ds_cond.addRow();

	if( ffn_ChkNull(vsItemCode) )
	{
		ds_cond.setColumn(0, "SEASON_NUM", gfn_nvl(cb_Season.value, ""));
		ds_cond.setColumn(0, "SP_DATE", ds_spDate.getColumn(0, "SP_DATE"));
		ds_cond.setColumn(0, "ITEM_NAME", ed_Item.value);
	}
	else
	{
		ds_cond.setColumn(0, "SEASON_NUM", gfn_nvl(cb_Season.value,""));
		ds_cond.setColumn(0, "SP_DATE", ds_spDate.getColumn(0, "SP_DATE"));
		ds_cond.setColumn(0, "ITEM_NAME", vsItemCode);
	}

	var strSvcID = "ITEM_SEARCH";
	var strURL   = "U_svc::" + "fs/fsp/FSP00010E_T001.jsp";
	var strInDatasets  = "ds_cond=ds_cond";
	var strOutDatasets = "ds_list1=ds_list";
	var strArgument = "sType='QryItm'";

	var strCallbackFunc = "";
	if( ffn_ChkNull(vsItemCode) )
		strCallbackFunc = "fn_callback";

	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, true, true, false);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 시즌 목록 조회
 *---------------------------------------------------------------------------------------------*/
function fn_getSeasonList()
{
	var strSvcID		= "FSP00005E_T004";
	var strURL			= "U_svc::" + "fs/fsp/FSP00005E_T004.jsp";
	var strInDatasets   = "";
	var strOutDatasets	= "ds_season_cb=ds_season";
	var strArgument     = "";
	var strCallbackFunc	= "";

	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 시즌 정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_getSeasonInfo()
{
	var strSvcID		= "FSP00005E_T006";
	var strURL			= "U_svc::" + "fs/fsp/FSP00005E_T006.jsp";
	var strInDatasets	= "";
	var strOutDatasets	= "ds_season=ds_season";
	var strArgument		= "sSeasonNum='"+cb_Season.value+"'";
	var strCallbackFunc	= "";

	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 주문자사번 EXP_CD Query
 *---------------------------------------------------------------------------------------------*/
function fn_getPrSabun()
{
	var str_EXP_CD = "";

	// 초기화
	ds_EXP_CD.clearData();

	var strSvcID = "FSP00010E_T001";
	var strURL   = "U_svc::" + "fs/fsp/FSP00010E_T001.jsp";
	var strInDatasets  = "ds_cond=ds_cond";
	var strOutDatasets = "ds_EXP_CD=ds_list";
	var strArgument = "sType='PR_SABUN'";
	var strCallbackFunc = "";

	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);

	if( (ds_EXP_CD.rowcount > 0) && (gfn_length(ds_EXP_CD.getColumn(0, "EXP_CD")) != 0) )
		str_EXP_CD = ds_EXP_CD.getColumn(0, "EXP_CD");

	return str_EXP_CD;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 상품리스트 데이터 주문내역으로 복사
 *---------------------------------------------------------------------------------------------*/
function fn_CopyRow(obj, nRow)
{
	if( ds_list.findRowExpr("ITEM_CODE=='" + obj.getColumn(nRow, "ITEM_CODE") + "'") >= 0 )
	{
		if( !g_Confirm("01", '이미 주문등록한 상품입니다.\n\n추가주문 하시겠습니까?!') )	return;
	}

	ds_list.addRow();
	ds_list.copyRow(ds_list.rowposition, obj, nRow);

	ds_list.setColumn(ds_list.rowposition, "SEASON_NUM", cb_Season.value);
	ds_list.setColumn(ds_list.rowposition, "SALE_TYPE", "직원판촉");
	ds_list.setColumn(ds_list.rowposition, "LINE_STATUS", "주문");
	ds_list.setColumn(ds_list.rowposition, "PAY_METHOD", "8");
	ds_list.setColumn(ds_list.rowposition, "PR_QTY", 0);	// 기본적으로 신청수량은 기본 0으로 설정한다.
	ds_list.setColumn(ds_list.rowposition, "CONTENT", "N");	// 명함동봉
	ds_list.setColumn(ds_list.rowposition, "CALL_YN", "N");	// 해피콜
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 상품리스트 데이터 주문내역으로 복사
 *---------------------------------------------------------------------------------------------*/
function fn_Calcul(obj, nRow, strColumnID, varOldValue, varNewValue)
{
	var nAmt = 0;
	var nAmt2 = 0;

	// 수량할인
	if( numFormat(obj.getColumn(nRow, "QTY_DC_STD"), 1) <> "0.0" )
	{
		if( Math.abs(toNumber(obj.getColumn(nRow, "PR_QTY"))) >=  toNumber(obj.getColumn(nRow, "QTY_DC_STD")) )
			nAmt = Math.ceil(Math.abs(toNumber(obj.getColumn(nRow, "SALE_AMOUNT"))) * toNumber(obj.getColumn(nRow, "QTY_DC_RATE")) / 100);
	}

	// 금액할인
	if( numFormat(obj.getColumn(nRow, "AMT_DC_STD"), 1) <> "0.0" )
	{
		if( Math.abs(toNumber(obj.getColumn(nRow, "SALE_AMOUNT"))) >=  toNumber(obj.getColumn(nRow, "AMT_DC_STD")) )
			nAmt2 = Math.ceil(Math.abs(toNumber(obj.getColumn(nRow, "SALE_AMOUNT"))) * toNumber(obj.getColumn(nRow, "AMT_DC_RATE")) / 100);
	}

	// 수량할인과 금액할인 중 큰 값을 할인금액으로 한다.
	obj.setColumn(nRow, "DC_AMOUNT", greatest(nAmt, nAmt2) * fn_Sign(obj.getColumn(nRow, "PR_QTY")));
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신청자 핸드폰 번호 초기세팅--PR_SABUN 의 HR_PERSONAL.COMM_TEL3
 *---------------------------------------------------------------------------------------------*/
function Set_RQ_TEL(str_GUBUN, str_RQ_SABUN)
{
    if( gfn_length(str_RQ_SABUN) == 0)	return "";

    var str_RQ = "";

	// 초기화
	ds_RQ_TEL.clearData();

	var strSvcID = "FSP00010E_T001";
	var strURL   = "U_svc::" + "fs/fsp/FSP00010E_T001.jsp";
	var strInDatasets  = "ds_cond=ds_cond";
	var strOutDatasets = "ds_RQ_TEL=ds_list";
	var strArgument  = "sType='RQ_TEL'";
		strArgument += " RQ_SABUN=" + wrapQuote(str_RQ_SABUN);
	var strCallbackFunc = "";

	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);

	if( str_GUBUN == "RQ_TEL" )
	{
		if( (ds_RQ_TEL.rowcount > 0) && (gfn_length(ds_RQ_TEL.getColumn(0, "RQ_TEL")) != 0) )
			str_RQ = ds_RQ_TEL.getColumn(0, "RQ_TEL");
	}
	else if( str_GUBUN == "RQ_SABUNNM" )
	{
		if( (ds_RQ_TEL.rowcount > 0) && (gfn_length(ds_RQ_TEL.getColumn(0, "RQ_SABUNNM")) != 0) )
			str_RQ = ds_RQ_TEL.getColumn(0, "RQ_SABUNNM");
	}

	return str_RQ;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 지불방식 체크
 *---------------------------------------------------------------------------------------------*/
function fn_chkPayType()
{

//	저장하기 전에 지불방식에 따라 데이터를 체크하는 로직
//	지불정보의 방식이 [계산서발행]일 경우는 [결제자 상세정보] 반드시 입력해야함.
//	리턴값 : 잘못된 라인 번호 리턴

	for( var i = 0; i < ds_list.rowcount; i++ )
	{
		var method = ds_list.getColumn(i, "PAY_METHOD");
		var arCustcd = ds_list.getColumn(i, "AR_CUSTCD");
		var arSaupno = ds_list.getColumn(i, "AR_SAUPNO");
		var arAddr = ds_list.getColumn(i, "AR_ADDR");
		var arName = ds_list.getColumn(i, "AR_NAME");
		var arTel = ds_list.getColumn(i, "AR_TEL");
		var arEmail = ds_list.getColumn(i, "AR_EMAIL");

		// 지불방식이 계산서 발행일 경우 결제자 상세정보를 모두 입력해야함.
		if( method == "E" )
		{
			trace(gfn_length(arEmail));
			// 하나라도 값이 없으면 현재의 row를 리턴
			if( gfn_length(arCustcd) && gfn_length(arSaupno) && gfn_length(arAddr) && gfn_length(arName) && gfn_length(arTel) && gfn_length(arEmail) )
			{

			}
			else
			{
				return i+1;
			}
		}
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장하기 전에 중복으로 의심되는 상품이 있으면 알람을 띄워줌
 *---------------------------------------------------------------------------------------------*/
function fn_chkSameItem()
{
	for( var i = 0; i < ds_list.getRowCount(); i++ )
	{
		if( ds_list.getRowType(i) == 1 )	continue;

		for( var j = i + 1; j < ds_list.getRowCount(); j++ )
		{
			if(	ds_list.getColumn(i, "ITEM_CODE") == ds_list.getColumn(j, "ITEM_CODE") &&
				ds_list.getColumn(i, "PR_QTY") == ds_list.getColumn(j, "PR_QTY") )
			{
				g_Message("EE", "(" + (i+1) + "행)" + ds_list.getColumn(i, "ITEM_NAME") + "상품은 중복발주 되었을수 있습니다. 확인 바랍니다.!");
				return;
			}
			//bind:RECE_ADDR
			
			var item = ds_list.getColumn(i, "ITEM_CODE");
			var addr = ds_list.getColumn(i, "RECE_ADDR");
			if ( ds_list.getCaseCount("ITEM_CODE == '" + item +"' && RECE_ADDR == '" + addr + "'") >= 2 ) {
				g_Message("EE", "(" + (i+1) + "행)" + ds_list.getColumn(i, "ITEM_NAME") + "상품이 동일 주소로 발주됩니다. 확인 바랍니다.!");
			}
		}
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신청자사번 Excel Import시 검증용 Query
 *---------------------------------------------------------------------------------------------*/
function Get_RQ_SABUN_Excel_Import_YN(str_RQ_SABUN)
{
	var bool_YN = false;

	if( gfn_length(str_RQ_SABUN)== 0 )	return bool_YN;

	ds_RQ_SABUN_Excel_Import_YN.clearData();

	var strSvcID = "FSP00010E_T001";
	var strURL   = "U_svc::" + "fs/fsp/FSP00010E_T001.jsp";
	var strInDatasets  = "ds_cond=ds_cond";
	var strOutDatasets = "ds_RQ_SABUN_Excel_Import_YN=ds_list";
	var strArgument  = "sType='RQ_SABUN'";
		strArgument += " RQ_SABUN=" + wrapQuote(str_RQ_SABUN);
		strArgument += " MU_CD="    + wrapQuote(g_Mu_Cd);
		strArgument += " EXP_CD="   + wrapQuote(fa_PR_SABUN_EXP_CD);
	var strCallbackFunc = "";

	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);

	if( (ds_RQ_SABUN_Excel_Import_YN.rowcount > 0) && (toNumber(ds_RQ_SABUN_Excel_Import_YN.getColumn(0, "CNT")) > 0 ) )
		bool_YN = true;

	return bool_YN;
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 상품 재고량 조회
 *---------------------------------------------------------------------------------------------*/
function fn_chkStockTotal()
{
/*
	저장하기 전에 재고를 체크하는데 같은 상품일 경우에는 묶어서 갯수를 합한뒤 체크함
	또한 수정된 상품의 경우 수정량까지 합산하여 계산함
	리턴값 : 재고가 넘는 상품이 있으면 트루, 없으면 폴스
*/

	var v_pr_qty = 0;	//아이템별 주문량합계
	var v_init_qty = 0;	//아이템별 서버주문량합계
	var v_qty = 0;		//아이템별 재고량
	var v_diff = 0;		//수정or추가시 서버와의 차이

	for( var i = 0; i < ds_list.getRowCount(); i++ )
	{
		if( ds_list.getRowType(i) == 1 )	continue;

		fn_get_Stock(cb_Season.value, ds_list.getColumn(i, "ITEM_CODE"));
		v_pr_qty	= toNumber(ds_list.getCaseSum("ITEM_CODE=="+wrapQuote(ds_list.getColumn(i, "ITEM_CODE")), "PR_QTY"));
		v_init_qty	= toNumber(ds_list.getCaseSum("ITEM_CODE=="+wrapQuote(ds_list.getColumn(i, "ITEM_CODE")), "INIT_QTY"));
		v_qty		= toNumber(ds_stock.getColumn(0, "STOCK_QTY"));
		v_diff		= toNumber(v_pr_qty - v_init_qty);

//		trace("주문량/서버량/차이량/재고량");
//		trace(v_pr_qty + "/" + v_init_qty + "/" + v_diff + "/" + v_qty);

		//기존에 데이터를 수정하거나 추가된 양(아이템별)이 재고량보다 많으면 초과주문임
		if( v_diff > v_qty )
		{
			return i + 1;
		}
	}
	return - 1;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 시즌별 상품의 재고량 조회
 *---------------------------------------------------------------------------------------------*/
function fn_get_Stock(seasonNum, itemCode)
{
	ds_stock.clearData();
	ds_cond.clearData();

	ds_cond.addRow();
	ds_cond.setColumn(0,"SEASON_NUM", seasonNum);
	ds_cond.setColumn(0,"ITEM_CODE" , itemCode);

	var strSvcID		= "FSP00010E_T003";
	var strURL			= "U_svc::" + "fs/fsp/FSP00010E_T003.jsp";
	var strInDatasets	= "ds_cond=ds_cond";
	var strOutDatasets	= "ds_stock=ds_list";
	var strArgument;
	var strCallbackFunc	= "";

	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);

	return ds_stock.getColumn(0, "STOCK_QTY");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 그리드 셀의 인덱스 값을 반환
 *---------------------------------------------------------------------------------------------*/
function fn_getCellPos(obj, sColId)
{
	for( var i = 0; i < obj.getCellCount('Body') - 1; i++ )
	{
		if( obj.getCellProperty('Body', i, "text") == "bind:" + sColId )
		{
			return i;
		}
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신청자 사업장 조회
 *---------------------------------------------------------------------------------------------*/
function fn_setUpjang(nRow, sUser, sSeasonNum, oRtn)
{
	v_spClose = "";
	var rtnUpjang = "";

	if( gfn_isNull(sUser) )	return rtnUpjang;

	var strSvcID = "FSP00010E_T001";
	var strURL   = "U_svc::" + "fs/fsp/FSP00010E_T001.jsp";
	var strInDatasets  = "ds_cond=ds_cond";
	var strOutDatasets = "ds_rqUpjang=ds_list";
	var strArgument  = "sType='RQ_UPJANG'";
		strArgument += " SABUN='"+sUser+"'";
		strArgument += " SEASON_NUM='"+sSeasonNum+"'";
		strArgument += " ATTR01='" + ( g_Upjang == gv_upjang ) + "'";
		
		if ( !gfn_isNull(oRtn) ) {
			strArgument += " ATTR02='" + oRtn[2] + "'";	// upjang
		}
		
	var strCallbackFunc = "";

	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);

	if( !gfn_isNull(v_spClose) )
	{
		gfn_alert(v_spClose);
		ds_list.setColumn(ds_list.rowposition, "RQ_SABUN", "");
		ds_list.setColumn(ds_list.rowposition, "RQ_SABUNNM", "");
		ds_list.setColumn(ds_list.rowposition, "RQ_TEL", "");

		return;
	}
	else
	{
		if( ds_rqUpjang.rowcount > 0 )
		{
			ds_list.setColumn(nRow, "UPJANG", ds_rqUpjang.getColumn(0, "UPJANG"));
			rtnUpjang = ds_rqUpjang.getColumn(0, "UPJANGNM");
		}
		else
		{
			ds_list.setColumn(nRow, "UPJANG", "");
			rtnUpjang = "";
		}
	}

	return rtnUpjang;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 시즌 아이템 조회
 *---------------------------------------------------------------------------------------------*/
function fn_getItemList()
{
	ds_itemList.clearData();
	ds_cond.clearData();
	ds_cond.addRow();

	ds_cond.setColumn(0, "SEASON_NUM", gfn_nvl(cb_Season.value,""));
	ds_cond.setColumn(0, "SP_DATE", ds_spDate.getColumn(0, "SP_DATE"));

	var strSvcID = "ITEM_SEARCH";
	var strURL   = "U_svc::" + "fs/fsp/FSP00010E_T001.jsp";
	var strInDatasets  = "ds_cond=ds_cond";
	var strOutDatasets = "ds_itemList=ds_list";
	var strArgument = "sType='QryItm'";

	var strCallbackFunc = "";

	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신청자 정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_getRqUser(sUser)
{
	ds_exUser.clearData();
	ds_cond.clearData();
	ds_cond.addRow();

	ds_cond.setColumn(0, "SEASON_NUM", gfn_nvl(cb_Season.value,""));

	var strSvcID = "EX_USER";
	var strURL   = "U_svc::" + "fs/fsp/FSP00010E_T001.jsp";
	var strInDatasets  = "ds_cond=ds_cond";
	var strOutDatasets = "ds_exUser=ds_list";
	var strArgument  = "sType='EX_USER'";
		strArgument += " SABUN=" + wrapQuote(sUser);

	var strCallbackFunc = "";

	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);

	if( ds_exUser.rowcount == 0 )
		v_spClose = "Not Found";
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 주문 상태 조회
 *---------------------------------------------------------------------------------------------*/
function fn_getLineStatus(nRow)
{
	var strSvcID = "LINE_STATUS";
	var strURL   = "U_svc::" + "fs/fsp/FSP00010E_T001.jsp";
	var strInDatasets  = "ds_cond=ds_cond";
	var strOutDatasets = "ds_lineStatus=ds_list";
	var strArgument  = "sType='LINE_STATUS'";
		strArgument += " str_SpId=" + wrapQuote(ds_list.getColumn(nRow, "SP_ID"));
		strArgument += " str_SeasonNum=" + wrapQuote(ds_list.getColumn(nRow, "SEASON_NUM"));

	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, "", false, false, true);

	var lineStatus = ds_lineStatus.getColumn(0, "LINE_STATUS");

	return lineStatus;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 발송요청일 조회
 *---------------------------------------------------------------------------------------------*/
function fn_getDeliExptDate(sDateFr, sDateTo)
{
	var strSvcID = "DELI_EXPT_DATE";
	var strURL   = "U_svc::" + "fs/fsp/FSP00010E_T001.jsp";
	var strInDatasets  = "ds_cond=ds_cond";
	var strOutDatasets = "ds_deliExptDate=ds_list";
	var strArgument  = "sType='DELI_EXPT_DATE'";
		strArgument += " sDateFr=" + wrapQuote(sDateFr);
		strArgument += " sDateTo=" + wrapQuote(sDateTo);

	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, "", false, false, true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 발송요청일 유효성 체크
 *---------------------------------------------------------------------------------------------*/
function fn_chkDeliExptDate()
{
	var sSpDate   = ds_spDate.getColumn(0, "SP_DATE");			// 주문일
	var sDateFr   = ds_season.getColumn(0, "ATTR01");			// 발송요청 시작일
	var sDateTo   = ds_season.getColumn(0, "ATTR02");			// 발송요청 종료일
	var sDateDiff = toNumber(ds_season.getColumn(0, "ATTR03"));	// 발송요청 기준일
	var rtn     = 0;

	for( var i = 0; i < ds_list.rowcount; i++ )
	{
		var sDeliExptDate = ds_list.getColumn(i, "DELI_EXPT_DATE");

		if( ffn_ChkNull(sDeliExptDate) == true
			|| ds_list.getColumn(i, "LINE_STATUS") <> "주문" )	continue;

		var nRow = ds_deliExptDate.findRow("DELI_EXPT_DATE", sDeliExptDate);

		// 발송요청일 기간 체크
		if( nRow == -1 )
		{
			var sFr = sDateFr.substr(0, 4) + "년 " + sDateFr.substr(4, 2) + "월 " + sDateFr.substr(6, 2) + "일";
			var sTo = sDateTo.substr(0, 4) + "년 " + sDateTo.substr(4, 2) + "월 " + sDateTo.substr(6, 2) + "일";

			ds_list.rowposition = i;

			g_Message("EE", (i + 1) + "행의 발송 요청일 입력 기간은\n" + sFr + "부터" + sTo + " 까지입니다.");
			return false;
		}

		// 공휴일 체크
		if( ds_deliExptDate.getColumn(nRow, "CD_WEEK") == "토"
			|| ds_deliExptDate.getColumn(nRow, "CD_WEEK") == "일"
			|| ds_deliExptDate.getColumn(nRow, "HOLIDAY") == "1"
			|| ds_deliExptDate.getColumn(nRow, "HOLIDAY") == "2" )
		{
			ds_list.rowposition = i;

			g_Message("EE", (i + 1) + "행의 발송 요청일은 주말 또는 공휴일이므로\n발송요청일로 지정할 수 없습니다.");
			return false;
		}

		// 주문일자 기준 배송일 체크
		if( gfn_getDiffDay(sSpDate, sDeliExptDate) < sDateDiff )
		{
			ds_list.rowposition = i;

			g_Message("EE", (i + 1) + "행의 발송 요청일은 주문일 기준 " + sDateDiff + "일 후부터\n입력할 수 있습니다.(주말, 공휴일 제외)");
			return false;
		}
	}

	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 내부거래 사용자 체크
 *---------------------------------------------------------------------------------------------*/
function fn_getInsideUser()
{
	var strSvcID = "";
	var strURL   = "U_svc::" + "fs/fsp/FSP00005E_T007.jsp";
	var strInDatasets  = "";
	var strOutDatasets = "ds_insideUser=ds_list";
	var strArgument  = "sType=" + wrapQuote("search");

	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, "", false, false, true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 캘린더 focus 없어질때 캘린더 value 지정
 *---------------------------------------------------------------------------------------------*/
function fn_set_date(obj, nRow, nCol, sDate)
{
	// 단축값 설정
	var strDate  = sDate;
	var currday  = gfn_today();
	var currleng = 0;

	// 2015.04.01  김재섭수정
	if( gfn_isNull(strDate) )
	{
		currleng = 0;
	}
	else
	{
		currleng = strDate.length;
	}

	switch( currleng )
	{
		case 1:
			obj.setColumn(nRow, nCol, gfn_subStr(currday, 0, 6) + "0" + strDate);
			break;
		case 2:
			obj.setColumn(nRow, nCol, gfn_subStr(currday, 0, 6) + strDate);
			break;
		case 3:
			obj.setColumn(nRow, nCol, gfn_subStr(currday, 0, 4) + "0" + strDate);
			break;
		case 4:
			obj.setColumn(nRow, nCol, gfn_subStr(currday, 0, 4) + strDate);
			break;
		case 5:
			obj.setColumn(nRow, nCol, gfn_subStr(currday, 0, 3) + strDate);
			break;
		case 6:
			obj.setColumn(nRow, nCol, gfn_subStr(currday, 0 ,2) + strDate);
			break;
		case 7:
			obj.setColumn(nRow, nCol, gfn_subStr(currday, 0, 1) + strDate);
			break;
		default :
			return;
			break;
	}
}

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
 ************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 주문일자 변경시 조회
 *---------------------------------------------------------------------------------------------*/
function ds_spDate_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	ds_list.clearData();
	ds_list1.clearData();

	fn_search();
	fn_SearchItem();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 상품명/코드 ENTER키 이벤트
 *---------------------------------------------------------------------------------------------*/
function ed_Item_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if( e.keycode == 13 )
		fn_SearchItem();	// 상품 조회
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 검색 버튼 클릭 이벤트
 *---------------------------------------------------------------------------------------------*/
function btn_search_OnClick(obj:Button,  e:ClickEventInfo)
{
	// 상품 조회
	fn_SearchItem();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 검색 버튼 ENTER키 이벤트
 *---------------------------------------------------------------------------------------------*/
function btn_search_OnKeyDown(obj:Button, e:KeyEventInfo)
{
	if( e.keycode == 13 )
		btn_search_OnClick(obj);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 그리드 셀 클릭 이벤트
 *---------------------------------------------------------------------------------------------*/
function gd_list_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	if( eval(obj.binddataset).rowcount < 1 )	return;

	// 상태값이 주문일때 리턴함
	if( obj.name == 'gd_list' )
	{
		if( ds_list.getColumn(e.row, "LINE_STATUS") <> "주문" )		return;
	}

	obj.dropdownCombo();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 상품 리스트의 선택한 데이터를 주문내역으로 보낸다.
 *---------------------------------------------------------------------------------------------*/
function gd_list_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
	if( ds_list1.rowcount < 1 ) return;

	if( e.row < 0 ) return;

	if( ds_list1.getColumn(e.row, "STOCK_QTY") <= 0 )
	{
		g_Message("EE", eval(obj.binddataset).getColumn(e.row, "ITEM_NAME") + "은(는) 재고량이 부족합니다.");
		return;
	}

	// 라인복사
	fn_CopyRow(eval(obj.binddataset), e.row);

	gd_list.setFocus();
	gd_list.setCellPos(4);
	gd_list.setEditSelect(0, -1);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 상품 리스트의 선택한 데이터를 주문내역으로 보낸다.
 *---------------------------------------------------------------------------------------------*/
function gd_list1_onkeydown(obj:Grid, e:KeyEventInfo)
{
	// 엔터키
	if( e.keycode==13 )
	{
		if( ds_list1.rowcount < 1 )	return;

		if( e.row < 0 ) return;

		if( ds_list1.getColumn(e.row, "STOCK_QTY") <= 0 )
		{
			g_Message("EE", eval(obj.binddataset).getColumn(e.row, "ITEM_NAME") + "은(는) 재고량이 부족합니다.");
			return;
		}

		//라인복사
		fn_CopyRow(eval(obj.binddataset), eval(obj.binddataset).rowposition);

		gd_list.setFocus();
		gd_list.setCellPos(4);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신청자 팝업 호출
 *---------------------------------------------------------------------------------------------*/
function gd_list_onexpandup(obj:Grid, e:GridMouseEventInfo)
{
//	fn_sql_common_setup("SELECT A.SABUN AS SABUN, A.NM_KOR||' ('||B.MU_NM||' '||B.CC_NM||')' AS NM_KOR FROM HLDC_HR_PERSONAL A, HLDC_SC_DEPT_V B WHERE A.DEPT_ID = B.DEPT_ID AND A.PER_DTD IS NULL " ,

	var sCellProperty = obj.getCellProperty("Body", e.cell, "text");
	var sBindNm = sCellProperty.replace("bind:", "");

	// 신청자사번
	if( sBindNm == "RQ_SABUNNM" )
	{
		var strSql  =" SELECT AA.SABUN, AA.NM_KOR, AA.UPJANG FROM (	\n ";
			strSql += "SELECT A.SABUN AS SABUN \n";
			strSql += "     , A.NM_KOR||' ('||B.MU_NM||' '||B.CC_NM||')' AS NM_KOR \n";
			strSql += "     , C.UPJANG \n";
			strSql += "  FROM HLDC_HR_PERSONAL A \n";
			strSql += "     , HLDC_SC_DEPT_V B \n";
			strSql += "     , ST_UPJANG C \n";
			strSql += " WHERE A.DEPT_ID = B.DEPT_ID \n";
			strSql += "   AND A.CC_CD = C.CC_CD \n";
			// 2016.04.14 신청자 조회시 주문자의 인사상 속한 사업장의 사용자만 조회 되도록 변경.
			strSql += "   AND A.GB_JAEJIK <> 'RA' \n";	// 퇴직자 제외
			strSql += "   AND C.UPJANG = '" + g_Upjang + "' \n";	// 업장변경 기능 때문에 gv_upjang이 아니라 g_Upjang 사용
//			strSql += "   AND C.CC_CD = (SELECT CC_CD FROM HLDC_HR_PERSONAL WHERE SABUN = '" + application.g_EmpNo + "') \n";       // 로그인상용자의 인사정보에 있는 CC를 조회해서 가져온다.
			
			// 겸직 구분
			if ( g_Upjang != gv_upjang ) {
				strSql += "	UNION	ALL \n";
				strSql += "	SELECT B.SABUN AS SABUN	\n";
				strSql += "		, (SELECT H.NM_KOR ||' ('||D.MU_NM||' '||D.CC_NM||')' FROM HLDC_HR_PERSONAL H WHERE H.SABUN = '"+ application.g_EmpNo +"') AS NM_KOR	\n";
				strSql += "		, A.UPJANG \n";
				strSql += "		FROM ST_UPJANG A	\n";
				strSql += "			, FMS_USER_UPJANG B	\n";
				strSql += "			, FMS_UPJANG C	\n";
				strSql += "			, HLDC_SC_DEPT_V D 	\n";
				strSql += "		WHERE  B.UPJANG = A.UPJANG	\n";
				strSql += "		AND  C.UPJANG(+) = A.UPJANG	\n";
				strSql += "		AND  D.CC_CD = A.CC_CD	\n";
				strSql += "		AND  B.SABUN = '"+ application.g_EmpNo +"'	\n";
			}
			strSql += "	) AA	\n";
			strSql += "	WHERE 1=1	\n";
			
		var rtn = fn_sql_common_setup(strSql,
							"AA.SABUN",
							"AA.NM_KOR",
							"신청자사번",
							"신청자이름",
							"",
							"",
							"",
							"신청자",
							"SABUN;NM_KOR");
			
		if( gfn_length(gfn_trim(gds_sql_common.getColumn(0, "ret_code")))!= 0 && gfn_length(gfn_trim(gds_sql_common.getColumn(0, "ret_code"))) != null )
		{
			ds_list.setColumn(e.row, "RQ_SABUN", gds_sql_common.getColumn(0, "ret_code"));
			ds_list.setColumn(e.row, "RQ_SABUNNM", gds_sql_common.getColumn(0, "ret_name"));
			ds_list.setColumn(e.row, "RQ_TEL", Set_RQ_TEL("RQ_TEL", gds_sql_common.getColumn(0, "ret_code")));
			// 업장코드는 fn_setUpjang에서 처리
			ds_list.setColumn(e.row, "UPJANGNM", fn_setUpjang(e.row, gds_sql_common.getColumn(0, "ret_code"), ds_list.getColumn(e.row, "SEASON_NUM"), rtn));
		}
	}
	// 거래처
	else if( sBindNm == "AR_CUSTNM" )
	{
		var dataSet = new Dataset();

		//내부용도로 사용되는 업장 검색용 DATASET 이름을 정의한다.
		this.custSearchDatasetName = "ds_" + this.name;
		dataSet.id = this.custSearchDatasetName;
		dataSet.name = this.custSearchDatasetName;
		dataSet.addRow();
		dataSet.addColumn("qid", "STRING", "1000");
		dataSet.addColumn("custGubun", "STRING", "100");
		//[[기본은 매출(002) 거래처만 설정한다.
		dataSet.setColumn(dataSet.rowposition, "qid", "StCust");
		dataSet.setColumn(dataSet.rowposition, "custGubun", "002,003");
		//[[팝업창을 호출한다.

		var strId       = "CustSearch";
		var strURL      = "cmn::CustSearchPop.xfdl";

		var objArgument = {
			P_DATASET    : dataSet,
			P_TITLE      : "거래처",
			P_LABEL_CODE : "거래처코드",
			P_LABEL_NAME : "거래처명"
		};

		var nWidth      = 513;
		var nHeight     = 495;
		var strStyle    = "";
		var nLeft       = -1;
		var nTop        = -1;
		var isModeless  = false;
		var bShowTitle  = true;
		var strAlign    = "-1";

		// 리턴값을 배열로 받을 경우
		var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);

		if (arrRtn instanceof Object)
		{
			ds_list.setColumn(e.row, "AR_CUSTCD", arrRtn.custCode);
			ds_list.setColumn(e.row, "AR_CUSTNM", arrRtn.custName);
			ds_list.setColumn(e.row, "AR_SAUPNO", arrRtn.saupno);
		}
	}
	// 발송요청일
	else if( sBindNm == "DELI_EXPT_DATE_CAL" )
	{
		var sDate =  ds_list.getColumn(e.row, sBindNm.substr(0, sBindNm.length - 4));
		var sValue = "";

		if( gfn_isNull(sDate) )	sValue = gfn_today();
		else	sValue = sDate;

		var rtn = gfn_callCalendarPop(obj, sValue, e.screenX - 67, e.screenY + 11)

		if( !gfn_isNull(rtn) )
			ds_list.setColumn(e.row, sBindNm.substr(0, sBindNm.length - 4), rtn);
	}
	// 상품 이미지 팝업
	else if( sBindNm == "ITEM_NAME" )
	{
		gfn_dialog("", "U_FSP::FSP00000P.xfdl", {fv_itemCode: eval(obj.binddataset).getColumn(e.row, "ITEM_CODE")}, "", "", "", "", "", "", "", "", true);
	}
	// 사업장
	else if( sBindNm == "UPJANGNM" )
	{
		var v_Query  = "SELECT UPJANG, UPJANGNM \n";
			v_Query += "  FROM ST_UPJANG \n";
			v_Query += " WHERE 1 = 1 \n";

		fn_sql_common_setup(v_Query,
						"UPJANG",
						"UPJANGNM",
						"업장코드",
						"업장명",
						"",
						"",
						"",
						"사업장조회",
						"UPJANG;UPJANGNM");

		if( gfn_length(gfn_trim(gds_sql_common.getColumn(0, "ret_code")))!= 0 && gfn_length(gfn_trim(gds_sql_common.getColumn(0, "ret_code"))) != null )
		{
			ds_list.setColumn(e.row, "UPJANG", gds_sql_common.getColumn(0, "ret_code"));
			ds_list.setColumn(e.row, "UPJANGNM", gds_sql_common.getColumn(0, "ret_name") + "(" + gds_sql_common.getColumn(0, "ret_code") + ")");
		}
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 주문내역 그리드 키 다운 이벤트
 *---------------------------------------------------------------------------------------------*/
function gd_list_OnKeyDown(obj:Grid, e:KeyEventInfo)
{
	// 엔터키
/*
	if( e.keycode == 13 )
	{

		if( gd_list.GetCellPos() == 16 )
		{
			if(ffn_ChkNull(ds_list.GetColumn(ds_list.row,"SEND_POSTNO"))) gd_list_OnCellClick(obj,ds_list.row,gd_list.GetCellPos());
		}
		else if(gd_list.GetCellPos() == 28)
		{
			if(ffn_ChkNull(ds_list.GetColumn(ds_list.row,"RECE_POSTNO"))) gd_list_OnCellClick(obj,ds_list.row,gd_list.GetCellPos());
		}
		else if(gd_list.GetCellPos() == 32)
		{
			if(ffn_ChkNull(ds_list.GetColumn(ds_list.row,"AR_POSTNO"))) gd_list_OnCellClick(obj,ds_list.row,gd_list.GetCellPos());
		}
		else if(gd_list.GetCellPos() == 11)
		{
			if(ffn_ChkNull(ds_list.getColumn(ds_list.rowposition, "RQ_SABUN")))	gd_list_OnCellClick(obj, ds_list.rowposition, gd_list.getCellPos());
		}
		else if(gd_list.GetCellPos() == ffn_Get_HeaderTitleColIdx(gd_list,"내용"))
		else if(gd_list.GetCellPos() == 28)
		{
			if(ds_list.row == ds_list.lastrow) ed_Item.SetFocus();
		}
	}
*/
	// 엔터키
	if( e.keycode == 13 )
	{
		if( gd_list.getCellPos() == 11 )
		{
			if(ffn_ChkNull(ds_list.getColumn(ds_list.rowposition, "RQ_SABUN")))	gd_list_OnCellClick(obj, ds_list.rowposition, gd_list.getCellPos());
		}
	}
	// F3키
	else if( e.altKey == true && e.keycode == 114 )
	{
		if( ds_list.rowcount < 1) return;
		if( ds_list.rowposition <= 0 ) return;
		if( ds_list.getColumn(ds_list.rowposition, "LINE_STATUS") != "주문" ) return;

		//라인복사
		var sFields;
		for( var iCol = 0; iCol < ds_list.colcount; iCol++ )
		{
			if( ds_list.getColID(iCol) == "SP_ID" )			continue;
			if( ds_list.getColID(iCol) == "ITEM_CODE" )		continue;
			if( ds_list.getColID(iCol) == "ITEM_NAME" )		continue;
			if( ds_list.getColID(iCol) == "ITEM_SIZE" )		continue;
			if( ds_list.getColID(iCol) == "TAX_CODE" )		continue;
			if( ds_list.getColID(iCol) == "MAX_ORD_QTY" )	continue;
			if( ds_list.getColID(iCol) == "STOCK_QTY" )		continue;
			if( ds_list.getColID(iCol) == "PR_QTY" )		continue;
			if( ds_list.getColID(iCol) == "SALE_PRICE" )	continue;
			if( ds_list.getColID(iCol) == "SALE_AMOUNT" )	continue;
//			if( ds_list.getColID(iCol) == "ITEM_DELI_FEE" )	continue;
//			if( ds_list.getColID(iCol) == "DELI_FEE" )		continue;
			if( ds_list.getColID(iCol) == "DC_AMOUNT" )		continue;
			if( ds_list.getColID(iCol) == "TOT_AMOUNT" )	continue;
			if( ds_list.getColID(iCol) == "IMAGE_PATH" )	continue;
			if( ds_list.getColID(iCol) == "LINE_STATUS" )	continue;
			if( ds_list.getColID(iCol) == "DELI_TYPE" )		continue;
			if( ds_list.getColID(iCol) == "DELI_COMP" )		continue;
			if( ds_list.getColID(iCol) == "INVOICE_NUM" )	continue;
			if( ds_list.getColID(iCol) == "BILL_NO" )		continue;

			sFields = sFields + ds_list.getColID(iCol) + "=" + ds_list.getColID(iCol) + ", ";
		}

		ds_list.copyRow(ds_list.rowposition, ds_list, ds_list.rowposition - 1, gfn_subStr(sFields, 0, gfn_length(sFields) - 2));
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 상품 리스트 그리드 소트 이벤트
 *---------------------------------------------------------------------------------------------*/
function gd_list_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	gfn_gridSort(obj, e);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 주문 내역 데이터 변경전 이벤트
 *---------------------------------------------------------------------------------------------*/
function ds_list_CanColumnChange(obj:Dataset, e:DSColChangeEventInfo)
{
	// 수량체크
	if( e.columnid == "PR_QTY" )
	{
		// 소숫점발주여부
		if( Math.ceil(toNumber(e.newvalue)) != toNumber(e.newvalue) )
		{
			g_Message("EE", "소숫점 주문은 불가합니다.");
			return false;
		}

		// 주문량 초과 체크는 저장 시점에서...
	}

	// 발송요청일
	if( e.columnid == "DELI_EXPT_DATE" )
	{
		return true;
		// 서버에서 현재일 체크
		var today = fn_CurrDateWeek();

		if( e.newvalue <= today )
		{
			g_Message("EE", "발송요청일은 현재일보다 작거나 같을 수 없습니다.");
			return false;
		}
	}

	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 주문 내역 데이터 변경후 이벤트
 *---------------------------------------------------------------------------------------------*/
function ds_list_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	var nAmt;

	// 금액계산
	if( e.columnid == "PR_QTY" )
	{
		// 총 판매금액
		nAmt = Math.round(toNumber(obj.getColumn(e.row, "SALE_PRICE")) * toNumber(obj.getColumn(e.row, "PR_QTY")));
		obj.setColumn(e.row, "SALE_AMOUNT", nAmt);

		// 배송료, 할인액 계산
		fn_Calcul(obj, e.row, e.columnid, e.oldvalue, e.newvalue);

		// 총 매출금액
		//nAmt = toNumber(obj.getColumn(e.row,"SALE_AMOUNT")) + toNumber(obj.getColumn(e.row,"DELI_FEE")) - toNumber(obj.getColumn(e.row,"DC_AMOUNT"));
		nAmt = toNumber(obj.getColumn(e.row,"SALE_AMOUNT")) - toNumber(obj.getColumn(e.row,"DC_AMOUNT"));
		obj.setColumn(e.row, "TOT_AMOUNT", nAmt);
	}

	// 카드결제가 아닐때는 지불정보를 막는다.
	if( e.columnid == "PAY_METHOD" )
	{
	    if( e.newvalue != "2" ) // 카드결제
		{
			obj.setColumn(e.row, "INST_PERIOD", "");
			obj.setColumn(e.row, "CARD_CLASS", "");
			obj.setColumn(e.row, "CARD_COMP", "");
			obj.setColumn(e.row, "CARD_NUM", "");
			obj.setColumn(e.row, "VALID_THRU_YY", "");
			obj.setColumn(e.row, "VALID_THRU_MM", "");
		}
	}
	
	if ( e.columnid == "SALE_TYPE" ) {
		if ( e.newvalue == "내부거래" ) {
			obj.setColumn(e.row, "PAY_METHOD", "Z");
		}
	}

	// 발송요청일
	if( e.columnid == "DELI_EXPT_DATE" )
	{
		fn_set_date(obj, e.row, e.col, e.newvalue);	// 날짜 자동완성
	}

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 엑셀 업로드
 *---------------------------------------------------------------------------------------------*/
function fn_Exl_Import(obj:Button, e:ClickEventInfo)
{
	//엑셀 임포트
	fd_Excel.Type = "OPEN";
	fd_Excel.Filter = "Excel File(*.xls;*.xlsx)|*.xls;*.xlsx|All(*.*)|*.*|";

	if( fd_Excel.Open() )
	{
		var sFullFileName = fd_Excel.FilePath + '\\' + fd_Excel.FileName;
		gd_list.enableredraw = false;
		ds_excel.clearData();
		//ext_ExcelImportByIndex(파일풀패스, 시트순번, 깡통데이타셑);
		ext_ExcelImportByIndex(sFullFileName, 0, "ds_excel");
		fn_SetImpData();
		gd_list.enableredraw = true;
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 엑셀 업로드
 *---------------------------------------------------------------------------------------------*/
function fn_SetImpData()
{
	if( ds_excel.rowcount == 0 || ds_excel.rowcount == 2 )	return;

	// 시즌 아이템 조회
	fn_getItemList();

	// 타이틀은 제외하고 3번째 로우부터 시작함
	for( var i = 2; i < ds_excel.rowcount; i++ )
	{
		// 상품코드 없는 로우 제외
		if( ffn_ChkNull(ds_excel.getColumn(i, "Col02")) )	continue;

		// 아이템코드 소문자를 대문자로 변환
		ds_excel.setColumn(i, "Col02", ds_excel.getColumn(i, "Col02").toUpperCase());

		var fRow = ds_itemList.findRow("ITEM_NUM", ds_excel.getColumn(i, "Col02"));

		// 잘못 입력된 상품코드는 제외함.
		if( fRow < 0 )
		{
			g_Message("EE",(i - 1) + "행 상품은 잘못된 상품코드로 업로드에서 제외됩니다!");
			continue;
		}

		// 내부거래가 가능한 사용자 체크
		if( ds_excel.getColumn(i, "Col09") == "내부거래" )
		{
			if( ds_insideUser.findRow("SABUN", application.g_EmpNo) == -1 )
			{
				g_Message("EE", "내부거래 선택이 불가합니다.\n" + (i - 1) + "행 상품은 업로드에서 제외됩니다!");
				continue;
			}
		}

		var nRow = ds_list.addRow();

		ds_list.setColumn(nRow, "ITEM_CODE",	ds_itemList.getColumn(fRow, "ITEM_CODE"));		// 상품코드
		ds_list.setColumn(nRow, "ITEM_NAME",	ds_itemList.getColumn(fRow, "ITEM_NAME"));		// 상품명
		ds_list.setColumn(nRow, "SALE_PRICE",	ds_itemList.getColumn(fRow, "SALE_PRICE"));		// 상품가
		ds_list.setColumn(nRow, "PR_QTY",		ds_excel.getColumn(i, "Col05"));				// 수량
		ds_list.setColumn(nRow, "SALE_TYPE",	ds_excel.getColumn(i, "Col09"));				// 판매구분

		// 신청자 정보
		if( !ffn_ChkNull(ds_excel.getColumn(i, "Col10")) )
		{
			v_spClose = "";
			fn_getRqUser(ds_excel.getColumn(i, "Col10"));

			if( !gfn_isNull(v_spClose) )
			{
				gfn_alert("신청자 사번이 유효하지 않거나\n주문자와 신청자가 동일한 사업장 소속이 아닙니다.\n"+ (i - 1) + "행 상품은 업로드에서 제외됩니다!");
				ds_list.deleteRow(nRow);
				continue;
			}
			if( ds_exUser.rowcount > 0 )
			{
				ds_list.setColumn(nRow, "RQ_SABUN",		ds_exUser.getColumn(0, "SABUN"));		// 신청자사번
				ds_list.setColumn(nRow, "RQ_SABUNNM",	ds_exUser.getColumn(0, "NM_KOR"));		// 신청자이름
				ds_list.setColumn(nRow, "UPJANG",		ds_exUser.getColumn(0, "UPJANG"));		// 신청자 사업장
				ds_list.setColumn(nRow, "UPJANGNM",		ds_exUser.getColumn(0, "UPJANGNM"));	// 신청자 사업장명

				// 신청자 연락처
				if( ffn_ChkNull(ds_excel.getColumn(i, "Col12")) )
					ds_list.setColumn(nRow, "RQ_TEL",		ds_exUser.getColumn(0, "RQ_TEL"));
				else
					ds_list.setColumn(nRow, "RQ_TEL",		ds_excel.getColumn(i, "Col12"));
			}
			else
			{
				ds_list.setColumn(nRow, "RQ_SABUN",		"");	// 신청자사번
				ds_list.setColumn(nRow, "RQ_SABUNNM",	"");	// 신청자이름
				ds_list.setColumn(nRow, "RQ_TEL",		"");	// 신청자 연락처
				ds_list.setColumn(nRow, "UPJANG",		"");	// 신청자 사업장
				ds_list.setColumn(nRow, "UPJANGNM",		"");	// 신청자 사업장명
			}
		}

		ds_list.setColumn(nRow, "SEND_NAME",		ds_excel.getColumn(i, "Col13"));		// 보내는사람 이름
		ds_list.setColumn(nRow, "SEND_TEL",			ds_excel.getColumn(i, "Col14"));		// 보내는사람 연락처
		ds_list.setColumn(nRow, "SEND_ADDR",		ds_excel.getColumn(i, "Col15"));		// 보내는사람 주소

		// 지불방식
		if( !ffn_ChkNull(ds_excel.getColumn(i, "Col16")) )
		{
			var payMethod = ds_excel.getColumn(i, "Col16");

			if( payMethod == "내부사용" )
			{
				if( ds_excel.getColumn(i, "Col09") == "내부거래" )
					ds_list.setColumn(nRow, "PAY_METHOD", "Z");
				else
					ds_list.setColumn(nRow, "PAY_METHOD", "8");
			}
			else if( payMethod == "직원외상" )
			{
				ds_list.setColumn(nRow, "PAY_METHOD", "8");
			}
			else if( payMethod == "카드결제" )
			{
				ds_list.setColumn(nRow, "PAY_METHOD", "2");
			}
			else if( payMethod == "외상(계산서발행)" )
			{
				ds_list.setColumn(nRow, "PAY_METHOD", "E");
			}
		}

		// 카드정보
		if( ds_list.getColumn(nRow, "SALE_TYPE") <> "내부거래" )
		{
			if( ds_list.getColumn(nRow, "PAY_METHOD") == "2" )
			{
				ds_list.setColumn(nRow, "INST_PERIOD",		ds_excel.getColumn(i, "Col17"));		// 할부
				ds_list.setColumn(nRow, "CARD_CLASS",		ds_excel.getColumn(i, "Col18"));		// 카드구분
				ds_list.setColumn(nRow, "CARD_COMP",		ds_excel.getColumn(i, "Col19"));		// 카드사

				// 카드번호
				if( !ffn_ChkNull(ds_excel.getColumn(i, "Col20")) )
					ds_list.setColumn(nRow, "CARD_NUM",		ds_excel.getColumn(i, "Col20").replace("-", ""));

				// mm
				if( !ffn_ChkNull(ds_excel.getColumn(i, "Col21")) )
				{
					var mm = ds_excel.getColumn(i, "Col21");

					if( mm.length == 1 )
						ds_list.setColumn(nRow, "VALID_THRU_MM", "0" + mm);
					else
						ds_list.setColumn(nRow, "VALID_THRU_MM", mm);
				}

				ds_list.setColumn(nRow, "VALID_THRU_YY",	ds_excel.getColumn(i, "Col22"));		// YY
			}
			else
			{
				ds_list.setColumn(nRow, "INST_PERIOD",		"");	// 할부
				ds_list.setColumn(nRow, "CARD_CLASS",		"");	// 카드구분
				ds_list.setColumn(nRow, "CARD_COMP",		"");	// 카드사
				ds_list.setColumn(nRow, "CARD_NUM",			"");	// 카드번호
				ds_list.setColumn(nRow, "VALID_THRU_MM",	"");	// MM
				ds_list.setColumn(nRow, "VALID_THRU_YY",	"");	// YY
			}
		}
		else
		{
			ds_list.setColumn(nRow, "INST_PERIOD",		"");	// 할부
			ds_list.setColumn(nRow, "CARD_CLASS",		"");	// 카드구분
			ds_list.setColumn(nRow, "CARD_COMP",		"");	// 카드사
			ds_list.setColumn(nRow, "CARD_NUM",			"");	// 카드번호
			ds_list.setColumn(nRow, "VALID_THRU_MM",	"");	// MM
			ds_list.setColumn(nRow, "VALID_THRU_YY",	"");	// YY
		}

		ds_list.setColumn(nRow, "RECE_NAME",		ds_excel.getColumn(i, "Col23"));		// 받는사람 이름
		ds_list.setColumn(nRow, "RECE_TEL",			ds_excel.getColumn(i, "Col24"));		// 받는사람 연락처
		ds_list.setColumn(nRow, "RECE_HP",			ds_excel.getColumn(i, "Col25"));		// 받는사람 핸드폰
		ds_list.setColumn(nRow, "RECE_ADDR",		ds_excel.getColumn(i, "Col26"));		// 받는사람 주소

		// 사업자번호
		if( !ffn_ChkNull(ds_excel.getColumn(i, "Col27")) )
			ds_list.setColumn(nRow, "AR_SAUPNO",	ds_excel.getColumn(i, "Col27").replace("-", ""));

		ds_list.setColumn(nRow, "AR_ADDR",			ds_excel.getColumn(i, "Col28"));				// 주소
		ds_list.setColumn(nRow, "AR_NAME",			ds_excel.getColumn(i, "Col29"));				// 담당자명
		ds_list.setColumn(nRow, "AR_TEL",			ds_excel.getColumn(i, "Col30"));				// 연락처
		ds_list.setColumn(nRow, "AR_EMAIL",			ds_excel.getColumn(i, "Col31"));				// 이메일
		ds_list.setColumn(nRow, "CONTENT",			gfn_nvl(ds_excel.getColumn(i, "Col32"), "N"));	// 명함동봉
		ds_list.setColumn(nRow, "CALL_YN",			gfn_nvl(ds_excel.getColumn(i, "Col33"), "N"));	// 해피콜

		// 발송요청일
		if( !ffn_ChkNull(ds_excel.getColumn(i, "Col41")) )
		{
			var deliExptDate = ds_excel.getColumn(i, "Col41").replace("-", "").substr(0, 8);

			if( !gfn_isDate(deliExptDate) )
			{
				g_Message("EE",(i - 1) + "행 상품의 발송요청일이 잘못 입력됐습니다. \n 발송 요청일을 다시 입력하세요.!");
				ds_list.setColumn(nRow, "DELI_EXPT_DATE",	"");										// 발송요청일
			}
			else
			{
				var yy = deliExptDate.substr(0, 4);
				var md = deliExptDate.substr(4, 4);
	
				ds_list.setColumn(nRow, "DELI_EXPT_DATE",	deliExptDate);								// 발송요청일
			}
		}

		ds_list.setColumn(nRow, "STOCK_QTY",		ds_itemList.getColumn(fRow, "STOCK_QTY"));	// 수량
		ds_list.setColumn(nRow, "LINE_STATUS",		"주문");
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 시즌 변경시 시즌 마감정보 조회
 *---------------------------------------------------------------------------------------------*/
function cb_Season_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	fn_getSeasonInfo();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 상품 이미지 팝업 호출
 *---------------------------------------------------------------------------------------------*/
function gd_list1_onexpandup(obj:Grid, e:GridMouseEventInfo)
{
	var sCellProperty = obj.getCellProperty("Body", e.cell, "text");
	var sBindNm = sCellProperty.replace("bind:", "");

	// 상품 이미지 팝업
	if( sBindNm == "ITEM_NAME" )
	{
		gfn_dialog("", "U_FSP::FSP00000P.xfdl", {fv_itemCode: eval(obj.binddataset).getColumn(e.row, "ITEM_CODE")}, "", "", "", "", "", "", "", "", true);
	}
}]]></Script>
  </Form>
</FDL>

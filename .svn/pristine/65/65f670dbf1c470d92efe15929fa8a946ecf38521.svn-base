<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FMM00350V" onkeydown="fn_form_OnKeyDown" onload="form_onload" titletext="추천식단조회" position="absolute 0 0 996 593" scrollbars="none">
    <Layouts>
      <Layout>
        <Grid selecttype="row" enable="true" id="grd_lst" wheelscrollrow="1" position="absolute 0 102 981 325" readonly="true" anchor="left top right" taborder="8" cellsizingtype="col" useselcolor="false" autofittype="col" oncellclick="grd_lst_oncellclick">
          <Formats>
            <Format id="default"/>
          </Formats>
        </Grid>
        <Calendar dateformat="yyyy/MM/dd" id="cal_to_dt" taborder="15" visible="false" position="absolute 1013 60 1103 82" type="normal" tabstop="false"/>
        <Calendar dateformat="yyyy/MM/dd" id="cal_from_dt" taborder="16" visible="false" position="absolute 1013 36 1103 58" type="normal" tabstop="false"/>
        <Button id="btn_ExcelPrint" onclick="btn_ExcelPrint_OnClick" taborder="6" text="Excel출력" position="absolute 894 77 981 97" class="btn_WF_Excel" image="" anchor="top right"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="24" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 981 30"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 981 0 996 593" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 578 981 593" anchor="left bottom"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 981 71" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 941 40"/>
        <Static id="Static01" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 941 71"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 99 40 109 61"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 217 40 247 61"/>
        <Static id="Static17" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 536 71 986 77"/>
        <Static id="Static18" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 97 986 102"/>
        <Static id="Static5" text="추천식단분류" position="absolute 15 40 102 61" class="sta_WFSA_label"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" displayrowcount="10" id="cbo_FS0029" innerdataset="ds_FS0029" taborder="0" position="absolute 109 40 217 61" class="cmb_WF_Essential" onitemchanged="cbo_OnChanged"/>
        <Static id="Static0" text="원가유형" position="absolute 247 40 309 61" class="sta_WFSA_label"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" displayrowcount="10" id="cbo_FS0030" innerdataset="ds_FS0030" taborder="1" position="absolute 315 40 423 61" class="cmb_WF_Essential" onitemchanged="cbo_OnChanged"/>
        <Static id="Static1" text="식단유형" position="absolute 453 40 513 61" class="sta_WFSA_label"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" displayrowcount="10" id="cbo_FS0031" innerdataset="ds_FS0031" taborder="2" position="absolute 521 40 629 61" class="cmb_WF_Essential" onitemchanged="cbo_OnChanged"/>
        <Static id="Static3" text="날짜" position="absolute 830 40 870 61" class="sta_WFSA_label"/>
        <Button id="btn_GiveCal" onclick="btn_GiveCal_OnClick" taborder="5" tabstop="false" text="" userdata="me_GiveDay" position="absolute 951 40 972 61" class="btn_WF_calEssential" image=""/>
        <Static id="Static02" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 423 40 453 61"/>
        <Static id="Static12" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 305 40 315 61"/>
        <Static id="Static13" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 629 40 659 61"/>
        <Static id="Static14" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 511 40 521 61"/>
        <Static id="Static15" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 865 40 875 61"/>
        <Grid id="grd_lst11" taborder="25" wheelscrollrow="1" readonly="true" useinputpanel="false" cellsizingtype="col" autofittype="col" useselcolor="false" position="absolute 0 358 981 578" anchor="all" oncellclick="grd_lst_oncellclick">
          <Formats>
            <Format id="default"/>
          </Formats>
        </Grid>
        <MaskEdit id="me_GiveDay" taborder="4" type="string" mask="####-##-##" trimtype="both" autoselect="true" class="msk_WF_EssentialCal" position="absolute 874 40 952 61" ontextchanged="me_GiveDay_OnChanged"/>
        <Calendar id="cal_MENU_DATE" taborder="27" dateformat="yyyy-MM-dd" onchanged="cal_MENU_DATE_OnChanged" visible="false" position="absolute 476 72 561 94"/>
        <Static id="Static25" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 690 40 700 61"/>
        <Combo id="cbo_FS0023" taborder="3" innerdataset="ds_FS0023" codecolumn="CODE" datacolumn="CODE_NAME" displayrowcount="10" onitemchanged="cbo_OnChanged" class="cmb_WF_Essential" position="absolute 700 40 800 61"/>
        <Static id="Static2" text="끼니" class="sta_WFSA_label" position="absolute 659 38 747 66"/>
        <Static id="Static26" text="w30" onclick="Static20_onclick" class="Guide01_AreaRed" visible="false" position="absolute 800 40 830 61"/>
        <Static id="Static22" text="차주 식단" onclick="Static22_onclick" class="sta_WF_Title01" position="absolute 0 340 328 355" anchor="left top"/>
        <Button id="btn_ExcelPrint2" taborder="7" text="Excel출력" onclick="btn_ExcelPrint_OnClick" class="btn_WF_Excel" position="absolute 894 333 981 353" anchor="top right"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 353 986 358"/>
        <Static id="Static19" text="금주 식단" onclick="Static22_onclick" class="sta_WF_Title01" position="absolute 0 84 328 99" anchor="left top"/>
        <Splitter id="sp_line" type="vertical" position="absolute 0 326 980 330" anchor="left top right" onmove="sp_line_OnMove">
          <Formats>
            <Format id="default">
              <SplitterItems id="items">
                <SplitterItem id="item00" bindtype="resize" position="leftortop" offset="0" componentid="grd_lst"/>
                <SplitterItem id="item01" bindtype="resize" position="rightorbottom" offset="30" componentid="grd_lst11"/>
                <SplitterItem id="item02" bindtype="move" position="rightorbottom" offset="6" componentid="btn_ExcelPrint2"/>
                <SplitterItem id="item03" bindtype="move" position="rightorbottom" offset="12" componentid="Static22"/>
              </SplitterItems>
            </Format>
          </Formats>
        </Splitter>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="DS_menu"/>
      <Dataset id="DS_head">
        <ColumnInfo>
          <Column id="fday" size="256" type="STRING"/>
          <Column id="we" size="256" type="STRING"/>
          <Column id="we_color" size="256" type="STRING"/>
          <Column id="wcd" size="256" type="STRING"/>
          <Column id="wnm" size="256" type="STRING"/>
          <Column id="wimg" size="256" type="STRING"/>
          <Column id="rem" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_body">
        <ColumnInfo>
          <Column id="fday" size="256" type="STRING"/>
          <Column id="sgbn" size="256" type="STRING"/>
          <Column id="sgbn_nm" size="256" type="STRING"/>
          <Column id="cgbn" size="256" type="STRING"/>
          <Column id="cgbn_nm" size="256" type="STRING"/>
          <Column id="cgbn_cd" size="256" type="STRING"/>
          <Column id="dup_sta" size="256" type="STRING"/>
          <Column id="dup_color" size="256" type="STRING"/>
          <Column id="sseq" size="256" type="STRING"/>
          <Column id="sd_cd" size="256" type="STRING"/>
          <Column id="sd_nm" size="256" type="STRING"/>
          <Column id="sd_won" size="256" type="STRING"/>
          <Column id="meal_price" size="256" type="STRING"/>
          <Column id="RECIPE_COST_RATE" size="256" type="STRING"/>
          <Column id="TERM_MENU_CD" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_body_f">
        <ColumnInfo>
          <Column id="CGBN" size="100" type="STRING"/>
          <Column id="CGBN_CD" size="20" type="STRING"/>
          <Column id="CGBN_NM" size="50" type="STRING"/>
          <Column id="DUP_COLOR" size="3" type="STRING"/>
          <Column id="DUP_STA" size="1" type="STRING"/>
          <Column id="FDAY" size="8" type="STRING"/>
          <Column id="MEAL_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_COST_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="SD_CD" size="20" type="STRING"/>
          <Column id="SD_NM" size="50" type="STRING"/>
          <Column id="SD_WON" size="22" type="BIGDECIMAL"/>
          <Column id="SGBN" size="20" type="STRING"/>
          <Column id="SGBN_NM" size="100" type="STRING"/>
          <Column id="SSEQ" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR">RED</Col>
            <Col id="DUP_STA">Y</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR">RED</Col>
            <Col id="DUP_STA">Y</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR">RED</Col>
            <Col id="DUP_STA">Y</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR">RED</Col>
            <Col id="DUP_STA">Y</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="DS_body_c" keystring="fday:sgbn:cgbn:cgbn_cd:sgbn_nm:cgbn_nm"/>
      <Dataset id="DS_sgbn">
        <ColumnInfo>
          <Column id="CGBN" size="256" type="STRING"/>
          <Column id="CGBN_NM" size="256" type="STRING"/>
          <Column id="CGBN_CD" size="256" type="STRING"/>
          <Column id="SGBN" size="256" type="STRING"/>
          <Column id="SGBN_NM" size="256" type="STRING"/>
          <Column id="CORNER_SEQ" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_menu2">
        <ColumnInfo>
          <Column id="column0" size="256" type="STRING"/>
          <Column id="column1" size="256" type="STRING"/>
          <Column id="column2" size="256" type="STRING"/>
          <Column id="column3" size="256" type="STRING"/>
          <Column id="column4" size="256" type="STRING"/>
          <Column id="column5" size="256" type="STRING"/>
          <Column id="column6" size="256" type="STRING"/>
          <Column id="column7" size="256" type="STRING"/>
          <Column id="column8" size="256" type="STRING"/>
          <Column id="column9" size="256" type="STRING"/>
          <Column id="column10" size="256" type="STRING"/>
          <Column id="column11" size="256" type="STRING"/>
          <Column id="column12" size="256" type="STRING"/>
          <Column id="column13" size="256" type="STRING"/>
          <Column id="column14" size="256" type="STRING"/>
          <Column id="column15" size="256" type="STRING"/>
          <Column id="column16" size="256" type="STRING"/>
          <Column id="column17" size="256" type="STRING"/>
          <Column id="column18" size="256" type="STRING"/>
          <Column id="column19" size="256" type="STRING"/>
          <Column id="column20" size="256" type="STRING"/>
          <Column id="column21" size="256" type="STRING"/>
          <Column id="column22" size="256" type="STRING"/>
          <Column id="column23" size="256" type="STRING"/>
          <Column id="column24" size="256" type="STRING"/>
          <Column id="column25" size="256" type="STRING"/>
          <Column id="column26" size="256" type="STRING"/>
          <Column id="column27" size="256" type="STRING"/>
          <Column id="column28" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list">
        <ColumnInfo>
          <Column id="CD" size="50" type="STRING"/>
          <Column id="CNT" size="22" type="BIGDECIMAL"/>
          <Column id="INFO" size="4000" type="STRING"/>
          <Column id="NM" size="50" type="STRING"/>
          <Column id="TEXTCOLOR" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_FS0029">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_FS0030">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_FS0031">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_input">
        <ColumnInfo>
          <Column id="MENU_DATE" size="256" type="STRING"/>
          <Column id="MENU_SDATE" size="256" type="STRING"/>
          <Column id="MENU_EDATE" size="256" type="STRING"/>
          <Column id="CURR_DATE" size="256" type="STRING"/>
          <Column id="EMP_NO" size="256" type="STRING"/>
          <Column id="MENU_CLASS" size="256" type="STRING"/>
          <Column id="COST_TYPE" size="256" type="STRING"/>
          <Column id="MENU_TYPE" size="256" type="STRING"/>
          <Column id="MEAL" size="256" type="STRING"/>
          <Column id="UPJANG" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="COST_TYPE"/>
            <Col id="CURR_DATE"/>
            <Col id="EMP_NO"/>
            <Col id="MEAL"/>
            <Col id="MENU_CLASS"/>
            <Col id="MENU_DATE"/>
            <Col id="MENU_EDATE"/>
            <Col id="MENU_SDATE"/>
            <Col id="MENU_TYPE"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="DS_menu11">
        <ColumnInfo>
          <Column id="column0" size="256" type="STRING"/>
          <Column id="column1" size="256" type="STRING"/>
          <Column id="column2" size="256" type="STRING"/>
          <Column id="column3" size="256" type="STRING"/>
          <Column id="column4" size="256" type="STRING"/>
          <Column id="column5" size="256" type="STRING"/>
          <Column id="column6" size="256" type="STRING"/>
          <Column id="column7" size="256" type="STRING"/>
          <Column id="column8" size="256" type="STRING"/>
          <Column id="column9" size="256" type="STRING"/>
          <Column id="column10" size="256" type="STRING"/>
          <Column id="column11" size="256" type="STRING"/>
          <Column id="column12" size="256" type="STRING"/>
          <Column id="column13" size="256" type="STRING"/>
          <Column id="column14" size="256" type="STRING"/>
          <Column id="column15" size="256" type="STRING"/>
          <Column id="column16" size="256" type="STRING"/>
          <Column id="column17" size="256" type="STRING"/>
          <Column id="column18" size="256" type="STRING"/>
          <Column id="column19" size="256" type="STRING"/>
          <Column id="column20" size="256" type="STRING"/>
          <Column id="column21" size="256" type="STRING"/>
          <Column id="column22" size="256" type="STRING"/>
          <Column id="column23" size="256" type="STRING"/>
          <Column id="column24" size="256" type="STRING"/>
          <Column id="column25" size="256" type="STRING"/>
          <Column id="column26" size="256" type="STRING"/>
          <Column id="column27" size="256" type="STRING"/>
          <Column id="column28" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_meal">
        <ColumnInfo>
          <Column id="sgbn" size="256" type="STRING"/>
          <Column id="sgbn_nm" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_head2">
        <ColumnInfo>
          <Column id="fday" size="256" type="STRING"/>
          <Column id="we" size="256" type="STRING"/>
          <Column id="we_color" size="256" type="STRING"/>
          <Column id="wcd" size="256" type="STRING"/>
          <Column id="wnm" size="256" type="STRING"/>
          <Column id="wimg" size="256" type="STRING"/>
          <Column id="rem" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_head11">
        <ColumnInfo>
          <Column id="fday" size="256" type="STRING"/>
          <Column id="we" size="256" type="STRING"/>
          <Column id="we_color" size="256" type="STRING"/>
          <Column id="wcd" size="256" type="STRING"/>
          <Column id="wnm" size="256" type="STRING"/>
          <Column id="wimg" size="256" type="STRING"/>
          <Column id="rem" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_FS0023">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="Dataset00" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="SGBN" type="STRING" size="256"/>
          <Column id="SGBN_NM" type="STRING" size="256"/>
          <Column id="CGBN" type="STRING" size="256"/>
          <Column id="CGBN_NM" type="STRING" size="256"/>
          <Column id="CGBN_CD" type="STRING" size="256"/>
          <Column id="SGBN_NO" type="STRING" size="256"/>
          <Column id="TOT_GBN" type="STRING" size="256"/>
          <Column id="SSEQ" type="STRING" size="256"/>
          <Column id="PHF_0111" type="STRING" size="256"/>
          <Column id="DUP_STA_0111" type="STRING" size="256"/>
          <Column id="DUP_COLOR_0111" type="STRING" size="256"/>
          <Column id="SSEQ_0111" type="STRING" size="256"/>
          <Column id="SD_CD_0111" type="STRING" size="256"/>
          <Column id="SD_NM_0111" type="STRING" size="256"/>
          <Column id="SD_WON_0111" type="STRING" size="256"/>
          <Column id="MAIN_ITEM_CODE1_0111" type="STRING" size="256"/>
          <Column id="CUISINE_TYPE_0111" type="STRING" size="256"/>
          <Column id="PHF_0112" type="STRING" size="256"/>
          <Column id="DUP_STA_0112" type="STRING" size="256"/>
          <Column id="DUP_COLOR_0112" type="STRING" size="256"/>
          <Column id="SSEQ_0112" type="STRING" size="256"/>
          <Column id="SD_CD_0112" type="STRING" size="256"/>
          <Column id="SD_NM_0112" type="STRING" size="256"/>
          <Column id="SD_WON_0112" type="STRING" size="256"/>
          <Column id="MAIN_ITEM_CODE1_0112" type="STRING" size="256"/>
          <Column id="CUISINE_TYPE_0112" type="STRING" size="256"/>
          <Column id="PHF_0113" type="STRING" size="256"/>
          <Column id="DUP_STA_0113" type="STRING" size="256"/>
          <Column id="DUP_COLOR_0113" type="STRING" size="256"/>
          <Column id="SSEQ_0113" type="STRING" size="256"/>
          <Column id="SD_CD_0113" type="STRING" size="256"/>
          <Column id="SD_NM_0113" type="STRING" size="256"/>
          <Column id="SD_WON_0113" type="STRING" size="256"/>
          <Column id="MAIN_ITEM_CODE1_0113" type="STRING" size="256"/>
          <Column id="CUISINE_TYPE_0113" type="STRING" size="256"/>
          <Column id="PHF_0114" type="STRING" size="256"/>
          <Column id="DUP_STA_0114" type="STRING" size="256"/>
          <Column id="DUP_COLOR_0114" type="STRING" size="256"/>
          <Column id="SSEQ_0114" type="STRING" size="256"/>
          <Column id="SD_CD_0114" type="STRING" size="256"/>
          <Column id="SD_NM_0114" type="STRING" size="256"/>
          <Column id="SD_WON_0114" type="STRING" size="256"/>
          <Column id="MAIN_ITEM_CODE1_0114" type="STRING" size="256"/>
          <Column id="CUISINE_TYPE_0114" type="STRING" size="256"/>
          <Column id="PHF_0115" type="STRING" size="256"/>
          <Column id="DUP_STA_0115" type="STRING" size="256"/>
          <Column id="DUP_COLOR_0115" type="STRING" size="256"/>
          <Column id="SSEQ_0115" type="STRING" size="256"/>
          <Column id="SD_CD_0115" type="STRING" size="256"/>
          <Column id="SD_NM_0115" type="STRING" size="256"/>
          <Column id="SD_WON_0115" type="STRING" size="256"/>
          <Column id="MAIN_ITEM_CODE1_0115" type="STRING" size="256"/>
          <Column id="CUISINE_TYPE_0115" type="STRING" size="256"/>
          <Column id="PHF_0116" type="STRING" size="256"/>
          <Column id="DUP_STA_0116" type="STRING" size="256"/>
          <Column id="DUP_COLOR_0116" type="STRING" size="256"/>
          <Column id="SSEQ_0116" type="STRING" size="256"/>
          <Column id="SD_CD_0116" type="STRING" size="256"/>
          <Column id="SD_NM_0116" type="STRING" size="256"/>
          <Column id="SD_WON_0116" type="STRING" size="256"/>
          <Column id="MAIN_ITEM_CODE1_0116" type="STRING" size="256"/>
          <Column id="CUISINE_TYPE_0116" type="STRING" size="256"/>
          <Column id="PHF_0117" type="STRING" size="256"/>
          <Column id="DUP_STA_0117" type="STRING" size="256"/>
          <Column id="DUP_COLOR_0117" type="STRING" size="256"/>
          <Column id="SSEQ_0117" type="STRING" size="256"/>
          <Column id="SD_CD_0117" type="STRING" size="256"/>
          <Column id="SD_NM_0117" type="STRING" size="256"/>
          <Column id="SD_WON_0117" type="STRING" size="256"/>
          <Column id="MAIN_ITEM_CODE1_0117" type="STRING" size="256"/>
          <Column id="CUISINE_TYPE_0117" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="SGBN_NO">7</Col>
            <Col id="TOT_GBN"/>
            <Col id="PHF_0111">N</Col>
            <Col id="SSEQ_0111">1</Col>
            <Col id="SD_CD_0111">A00011</Col>
            <Col id="SD_NM_0111">밀쌀밥</Col>
            <Col id="SD_WON_0111">29</Col>
            <Col id="MAIN_ITEM_CODE1_0111">044</Col>
            <Col id="CUISINE_TYPE_0111">002</Col>
          </Row>
          <Row>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="SGBN_NO">7</Col>
            <Col id="TOT_GBN"/>
            <Col id="PHF_0111">N</Col>
            <Col id="SSEQ_0111">2</Col>
            <Col id="SD_CD_0111">A01263</Col>
            <Col id="SD_NM_0111">미더덕된장찌개</Col>
            <Col id="SD_WON_0111">488</Col>
            <Col id="MAIN_ITEM_CODE1_0111">037</Col>
            <Col id="CUISINE_TYPE_0111">024</Col>
          </Row>
          <Row>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="SGBN_NO">7</Col>
            <Col id="TOT_GBN"/>
            <Col id="PHF_0111">N</Col>
            <Col id="SSEQ_0111">3</Col>
            <Col id="SD_CD_0111">A03384</Col>
            <Col id="SD_NM_0111">애플돈육강정</Col>
            <Col id="SD_WON_0111">91</Col>
            <Col id="MAIN_ITEM_CODE1_0111">034</Col>
            <Col id="CUISINE_TYPE_0111">034</Col>
          </Row>
          <Row>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="SGBN_NO">7</Col>
            <Col id="TOT_GBN"/>
            <Col id="PHF_0111">Y</Col>
            <Col id="SSEQ_0111">4</Col>
            <Col id="SD_CD_0111">A03675</Col>
            <Col id="SD_NM_0111">숙주부추무침</Col>
            <Col id="SD_WON_0111">185</Col>
            <Col id="MAIN_ITEM_CODE1_0111">019</Col>
            <Col id="CUISINE_TYPE_0111">035</Col>
          </Row>
          <Row>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="SGBN_NO">7</Col>
            <Col id="TOT_GBN"/>
            <Col id="PHF_0111">N</Col>
            <Col id="SSEQ_0111">5</Col>
            <Col id="SD_CD_0111">A04625</Col>
            <Col id="SD_NM_0111">단배추김치</Col>
            <Col id="SD_WON_0111">251</Col>
            <Col id="MAIN_ITEM_CODE1_0111">012</Col>
            <Col id="CUISINE_TYPE_0111">046</Col>
          </Row>
          <Row>
            <Col id="SGBN"/>
            <Col id="SGBN_NM"/>
            <Col id="CGBN"/>
            <Col id="CGBN_NM"/>
            <Col id="CGBN_CD"/>
            <Col id="SGBN_NO">7</Col>
            <Col id="TOT_GBN">99</Col>
            <Col id="SSEQ">99</Col>
            <Col id="PHF_0111"/>
            <Col id="DUP_STA_0111"/>
            <Col id="DUP_COLOR_0111"/>
            <Col id="SSEQ_0111">5</Col>
            <Col id="SD_CD_0111">A04625</Col>
            <Col id="SD_NM_0111">1,044 원</Col>
            <Col id="SD_WON_0111">1044</Col>
            <Col id="MAIN_ITEM_CODE1_0111"/>
            <Col id="CUISINE_TYPE_0111"/>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="cal_to_dt_value" compid="cal_to_dt" propid="value" datasetid="ds_input" columnid="MENU_EDATE"/>
      <BindItem id="cal_from_dt_value" compid="cal_from_dt" propid="value" datasetid="ds_input" columnid="MENU_SDATE"/>
      <BindItem id="cbo_FS0029_value" compid="cbo_FS0029" propid="value" datasetid="ds_input" columnid="MENU_CLASS"/>
      <BindItem id="cbo_FS0030_value" compid="cbo_FS0030" propid="value" datasetid="ds_input" columnid="COST_TYPE"/>
      <BindItem id="cbo_FS0031_value" compid="cbo_FS0031" propid="value" datasetid="ds_input" columnid="MENU_TYPE"/>
      <BindItem id="cal_MENU_DATE_value" compid="cal_MENU_DATE" propid="value" datasetid="ds_input" columnid="MENU_DATE"/>
      <BindItem id="cbo_FS0023_value" compid="cbo_FS0023" propid="value" datasetid="ds_input" columnid="MEAL"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/**
====================================================================================================(100)
 1. 시    스    템	: 	메뉴관리>식단관리>기간표준식단관리
 2. 서브    시스템 	:   기간표준식단관리
 3. 프로그램  개요 	: 	
 4. 작    성    자 	:  	
 5. 작    성    일 	: 	
====================================================================================================
 6. 수정자/수정일   : 
 7. 수정사유/내역   : 
====================================================================================================
**/
//===========================================================================================(90)
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//******************************************************************************************
include "U_lib::lib_conversionCom.xjs";
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"		// X-Framework Lib
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"		// 사업장팝업용 Lib

//******************************************************************************************
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//******************************************************************************************
var	il_cnt		= 0;	// 기간에 해당되는 일수를 산정
var def_cha		= 2;	// 차감 col pointer
var curr_date	= "";	// 
var in_date		= "";	// 
var week_ck    = ""; 
var in_cond		= "";	// 

//******************************************************************************************
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//******************************************************************************************
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	// X-Framework : Action 정보 생성 
	fsp_init(this);
	
	// 공통코드 조회
	var v_fil_cond;
	var v_ds = fn_common_code("'FS0029','FS0030','FS0031','FS0023'","","","non","Y");
	
	// 기간식단분류(ds_MENU_CLASS1, GROUP_CODE : 'FS0029')
	v_fil_cond = "GROUP_CODE == 'FS0029'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_FS0029,v_ds.name);

	// 원가유형(ds_COST_TYPE, GROUP_CODE : 'FS0030')
	v_fil_cond = "GROUP_CODE == 'FS0030'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_FS0030,v_ds.name);
	
	// 식단유형(ds_MENU_TYPE, GROUP_CODE : 'FS0031')
	v_fil_cond = "GROUP_CODE == 'FS0031'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_FS0031,v_ds.name);
	
	// 끼니(ds_MEAL, GROUP_CODE : 'FS0028')
	v_fil_cond = "GROUP_CODE == 'FS0023' && SET3 == 'Y'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_FS0023,v_ds.name);
	
	ds_input.setColumn(0,"MENU_DATE",fn_CurrDateWeek("YMD"));
	ds_input.setColumn(0,"UPJANG",g_Upjang);
	me_GiveDay.value = cal_MENU_DATE.value;
	//--------------------------------------------------(50)
	// 현재일에 해당하는 주단위 일자범위를 작성
	//--------------------------------------------------

	fn_week_create();
	
	//ds_input.setColumn(0,"MENU_DATE",fn_CurrDateWeek("YMD"));
	//me_GiveDay.value = cal_MENU_DATE.value;
	
	// focus 이동
	cbo_FS0029.index = 0;
	cbo_FS0030.index = 0;
	cbo_FS0031.index = 0;
	cbo_FS0023.index = 0;
	cbo_FS0029.setFocus();
}

//******************************************************************************************
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//******************************************************************************************

/*------------------------------------------------------------(60)
	1. Function ID : fn_Search()
	2. 개       요 : 업무프로세스에 따른 조회작업
	3. 기       능 : 검색조건에 해당하는 정보를 조회
	4. 인 수 설 명 : 
*/
function fn_search()
{
// 	if (gfn_length(week_ck)== 0 ) {
// 		in_date = cal_MENU_DATE.value;
// 		cal_MENU_DATE.value = gfn_addDate(cal_MENU_DATE.value, +7);
// 		fn_week_create();
// 	}
// 	else {
// 		cal_MENU_DATE.value = in_date;
// 		fn_week_create();
// 	}

	
    if(gfn_isNull(me_GiveDay.value)) {
        fn_make_default_grid();       
        return;
    }
    
    cal_MENU_DATE.value = me_GiveDay.value;
    
	if (gfn_length(week_ck)== 0 ) {
		in_date = cal_MENU_DATE.value;
		//cal_MENU_DATE.value = gfn_addDate(cal_MENU_DATE.value, -6);
		cal_MENU_DATE.value = gfn_addDate(cal_MENU_DATE.value, +7);  // 식단 날짜 (차주 부분)
		fn_week_create();
	}
	else {
		cal_MENU_DATE.value = in_date;
		fn_week_create();
	}	
	
	
	//in_date = cal_MENU_DATE.value;
	//cal_MENU_DATE.value = AddDate(cal_MENU_DATE.value, -6);
	//fn_week_create();
	// DS_head
	fn_Sel_DS_head();
	if (DS_head.getRowCount() == 0) {
		grd_lst.enableredraw = false;
		grd_lst.binddataset = "";
		grd_lst.formats = "";
		grd_lst.enableredraw = true;	
		g_Message("EE",	"주간일정 정보가 없습니다.");
		return;
	}
	// DS_sgbn
	fn_Sel_DS_sgbn();
	if (DS_sgbn.rowcount == 0) {
		g_Message("EE",	"식,끼니 정보가 없습니다.");
		return;
	}
	// DS_body
	fn_Sel_DS_body();

	//alert("DS loading OK !!");

	// 작업용 DataSet 마련 - Grid용 DataSet 작성 작업용 (Filter 용)
	//DS_body_f.Clear();
	//DS_body_f.Copy("DS_body");

	if (gfn_length(week_ck)== 0 ) { //차주
	
		Copy(DS_head11,DS_head); 
	
	 	grd_lst11.enableredraw = false;
	 	grd_lst11.binddataset = "";
		fn_make_DS_menu(); 
		
        grd_lst11.binddataset = "";
		fn_make_grdlst11();
	 	grd_lst11.binddataset = "DS_menu11";
	 	grd_lst11.enableredraw = true;
	 	
 		Copy(DS_menu11,DS_menu); 
		fn_junSearch();
	}
	else { //금주
	 
		// Grid에 사용할 DataSet을 작성합니다.
	 	grd_lst.enableredraw = false;
	 	grd_lst.binddataset = "";
		fn_make_DS_menu();
		
		// Grid Format을 작성합니다.
	 	grd_lst.binddataset = "";
		fn_make_grdlst();
	 	grd_lst.binddataset = "DS_menu";
	 	grd_lst.enableredraw = true;

		week_ck = "";
	}
	
	in_cond		= "";
	
	
	DS_menu.rowposition = 0;
	
	/*
	// Grid에 사용할 DataSet을 작성합니다.
	grd_lst.enableredraw = false;
	grd_lst.binddataset = "";
	fn_make_DS_menu();
	
	
	
	// Grid Format을 작성합니다.
	grd_lst.binddataset = "";
	fn_make_grdlst();
	grd_lst.binddataset = "DS_menu";
	grd_lst.enableredraw = true;
	*/
}

// 지난주 식단을 조회한다.
function fn_junSearch()
{
	
	week_ck = "before MENU Search";
	fn_search();
		
}

/*------------------------------------------------------------
	1. Function ID : fn_close()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_close()
{
	return true;
}

/*------------------------------------------------------------
	1. Function ID : fn_Insert()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_insert()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Save()
	2. 개       요 : 업무프로세스에 따른 정보 저장작업
	3. 기       능 : 저장버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_save()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Delete()
	2. 개       요 : 업무프로세스에 따른 정보 삭제작업
	3. 기       능 : 삭제버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_delete()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Print()
	2. 개       요 : 업무프로세스에 따른 선별된 정보를 출력지로 인쇄
	3. 기       능 : 인쇄버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_print()
{
}

//******************************************************************************************
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//******************************************************************************************
/*
 ******************************************************************************************
	1. Function ID : fn_week_create()
	2. 개       요 : 입력일에 해당하는 주의 일자 범위를 작성
	3. 기       능 : 시작일자 입력 시 일자에 해당하는 주의 시작일과 끝나는 일자를
	                 구하고 차주의 시작일인 일요일을 구함.
	                 (금주(월) ∼ 차주(일)까지의 일자를 구함)
	4. 인 수 설 명 : 
 ******************************************************************************************
 */
function fn_week_create()
{
	cal_from_dt.value	= cal_MENU_DATE.value;
	//cal_from_dt.value	= "20070917";
	cal_to_dt.value		= cal_from_dt.value; 
	
	// start Date가 속해있는 주의 시작일자를 계산
	cal_from_dt.value = GetStartofWeek(cal_from_dt); 
	
	// 제공일이 일요일 이면 전주의 일정이 된다.
	if (cal_MENU_DATE.value == cal_from_dt.value) {
		cal_from_dt.value = gfn_addDate(cal_from_dt.value, -1);
 		
		cal_from_dt.value = GetStartofWeek(cal_from_dt);
 		
	}
	// 해당 주의 월요일을 계산
	cal_from_dt.value = gfn_addDate(cal_from_dt.value, 1); 
	
	// start Date 부터 1주의 마지막 Date를 계산 
	cal_to_dt.value	  = gfn_addDate(cal_from_dt.value, 6);
	 
	// 기간에 해당하는 일수를 구함 
	
	var dToDate = gfn_strToDate(cal_to_dt.value);  
	
	var tdFromDate = gfn_addDate(cal_from_dt.value,1);
	
	var dFromDate = gfn_strToDate(tdFromDate); 
		
	il_cnt = gfn_getDiffDay(cal_from_dt.value,cal_to_dt.value) + 1;  
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSearch()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 사업장 조회 후 실행 함수
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-11-20  
 ******************************************************************************************
 */
function fn_afterSearch(errCode, errMsg)
{
	if(errCode!=0)
	{
		g_Message("EE",	"서비스 오류:시스템 관리자에게 문의하십시오");
		return;
	}
	
}

/*
 ******************************************************************************************
	1. Function ID : fn_Sel_DS_head()
	2. 개       요 : 식단표의 Head 구성요소를 작성한다.
	3. 기       능 : 제공일에 해당하는 주의 기준 Head Data를 작성한다.
	4. 인 수 설 명 : 
 ******************************************************************************************
 */
function fn_Sel_DS_head()
{
	// 초기화
	DS_head.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "ds_input=ds_input";
	outData			= "DS_head=DS_head";
	callBackFnc		= "fn_afterSearch";
	
	fsp_clear(this); 
    fsp_addSearch(this, "fm/fmm:FMM00020E_S002");									// 조회 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
	http.Sync = false;

}

/*
 ******************************************************************************************
	1. Function ID : fn_Sel_DS_sgbn()
	2. 개       요 : 식단표의 좌측 기준정보(식,끼니)를 작성한다.
	3. 기       능 : 제공일에 해당하는 주의 좌측 기준정보(식,끼니)를 작성한다.
	4. 인 수 설 명 : 
 ******************************************************************************************
 */
function fn_Sel_DS_sgbn()
{
	// 초기화
	DS_sgbn.clearData();
	
	//trace(DS_sgbn.saveXML());
	
	// 조회
	var v_row = DS_sgbn.addRow();
	DS_sgbn.setColumn(v_row, "SGBN", 		cbo_FS0023.value);
	DS_sgbn.setColumn(v_row, "SGBN_NM", 	cbo_FS0023.text);
	DS_sgbn.setColumn(v_row, "CGBN_CD", 	"001");
	DS_sgbn.setColumn(v_row, "CGBN_NM", 	"");
	DS_sgbn.setColumn(v_row, "CGBN", 		"A");
 	DS_sgbn.setColumn(v_row, "CORNER_SEQ", 	"1");
	//alert(cbo_FS0031.Value);
	if (cbo_FS0031.value != "001") {
		v_row = DS_sgbn.addRow();
		DS_sgbn.setColumn(v_row, "SGBN", 		cbo_FS0023.value);
		DS_sgbn.setColumn(v_row, "SGBN_NM", 	cbo_FS0023.text);
		DS_sgbn.setColumn(v_row, "CGBN_CD", 	"002");
		DS_sgbn.setColumn(v_row, "CGBN_NM", 	"");
		DS_sgbn.setColumn(v_row, "CGBN", 		"B");
		DS_sgbn.setColumn(v_row, "CORNER_SEQ", 	"2");
	}
	
	DS_sgbn.applyChange();
	
	/*
	// 초기화
	DS_sgbn.clearData();
	ds_meal.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "ds_input=ds_input";
	outData			= "ds_meal=ds_meal";
	callBackFnc		= "fn_afterSearch";
	
	fsp_clear(this); 
    fsp_addSearch(this, "fm/fmm:FMM00350V_S002");									// 조회 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
	http.Sync = false;	
	
	// 조회
	
	for(var ii = 0; ii < ds_meal.getRowCount(); ii++) {
		var v_row = DS_sgbn.addRow();
		DS_sgbn.setColumn(v_row, "SGBN", 	ds_meal.getColumn(ii,"SGBN"));
		DS_sgbn.setColumn(v_row, "SGBN_NM", ds_meal.getColumn(ii,"SGBN_NM"));
		DS_sgbn.setColumn(v_row, "CGBN_CD", 	"001");
		DS_sgbn.setColumn(v_row, "CGBN_NM", 	"");
		DS_sgbn.setColumn(v_row, "CGBN", 		"A");
		DS_sgbn.setColumn(v_row, "CORNER_SEQ", 	"1");
		//alert(cbo_FS0031.Value);
		if (cbo_FS0031.value != "001") {
			v_row = DS_sgbn.addRow();
			DS_sgbn.setColumn(v_row, "SGBN", 	ds_meal.getColumn(ii,"SGBN"));
			DS_sgbn.setColumn(v_row, "SGBN_NM",	ds_meal.getColumn(ii,"SGBN_NM"));
			DS_sgbn.setColumn(v_row, "CGBN_CD", 	"002");
			DS_sgbn.setColumn(v_row, "CGBN_NM", 	"");
			DS_sgbn.setColumn(v_row, "CGBN", 		"B");
			DS_sgbn.setColumn(v_row, "CORNER_SEQ", 	"2");
		}
	}	
	DS_sgbn.applyChange();
	*/
}

/*
 ******************************************************************************************
	1. Function ID : fn_Sel_DS_body()
	2. 개       요 : 메뉴정보를 불러온다.
	3. 기       능 : 제공일에 해당하는 주의 메뉴정보를 불러온다.
	4. 인 수 설 명 : 
 ******************************************************************************************
 */
function fn_Sel_DS_body()
{
	// 초기화
	DS_body.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "ds_input=ds_input";
	outData			= "DS_body=DS_body DS_body_f=DS_body";
	callBackFnc		= "fn_afterSearch";
	
	fsp_clear(this); 
    //tit_addSearchActionInfo(this, "fs/fsm:FSM00020E_S003");									// 조회 
    fsp_addSearch(this, "fm/fmm:FMM00350V_S001");									// 조회 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
	http.Sync = false;
}

/*------------------------------------------------------------
	1. Function ID : fn_make_DS_menu()
	2. 개       요 : Grid body에 해당하는 DataSet을 작성
	3. 기       능 : Grid body Format에 맞게 DS_menu DataSet의 Format을 작성하고 DataSet Format에 맞게
	                 Data를 Loading 시킨다.
	4. 인 수 설 명 : 
*/
function fn_make_DS_menu()
{
	DS_menu.enableevent = false;
 	
	DS_menu.clear();  
	
	DS_menu.addColumn('SGBN'   , 'STRING', 256);
	DS_menu.addColumn('SGBN_NM', 'STRING', 256);
	DS_menu.addColumn('CGBN'   , 'STRING', 256);
	DS_menu.addColumn('CGBN_NM', 'STRING', 256);
	DS_menu.addColumn('CGBN_CD', 'STRING', 256);
	DS_menu.addColumn('SGBN_NO', 'STRING', 256);
	DS_menu.addColumn('TOT_GBN', 'STRING', 256);
	DS_menu.addColumn('SSEQ'   , 'STRING', 256);  
	
	for(var ii = 0; ii < il_cnt; ii++)
	{

		DS_menu.addColumn('PHF_'             + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('DUP_STA_'         + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('DUP_COLOR_'       + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('SSEQ_'            + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('SD_CD_'           + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('SD_NM_'           + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('SD_WON_'          + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('MAIN_ITEM_CODE1_' + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('CUISINE_TYPE_'    + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
	}
 
	 DS_menu.enableevent = true; 
 
	var	cnt_ds_total = 0; 
	
	DS_body_f.clearData();
	DS_body_c.clearData();
	
	CopyF(DS_body_f,DS_body);
	
	for(var ii = 0; ii < DS_sgbn.rowcount; ii++) {
	
	
	    DS_body_f.filter();
		DS_body_f.filter("");

		var	fil_cond = "";
		var	max_row	 = 0; 
		
		fil_cond = "SGBN == '"+DS_sgbn.getColumn(ii, "SGBN")+"' && CGBN == '"+DS_sgbn.getColumn(ii, "CGBN")+"' && CGBN_CD == '"+DS_sgbn.getColumn(ii, "CGBN_CD")+"'";

		DS_body_f.filter(fil_cond);		
		DS_body_c.clear();
		
		Copy(DS_body_c,DS_body_f); 
		
        DS_body_c.keystring = "G:+FDAY,+SGBN,+CGBN,+CGBN_CD";
        
        DS_body_c.filter();
        DS_body_c.filter(""); 
		
		DS_body_c.filter("SSEQ <> '99'");  
		
		max_row =  DS_body_c.getMax("SSEQ"); 
		
		max_row = max_row + 1;   
		
		for(var ii = 0; ii < max_row; ii++) {
		    DS_menu.addRow();
		}
		
		if (DS_body_c.rowcount == 0) {
			
			DS_menu.setColumn(0, "SGBN", 	DS_sgbn.getColumn(ii, "SGBN"));
			DS_menu.setColumn(0, "SGBN_NM", DS_sgbn.getColumn(ii, "SGBN_NM"));
			DS_menu.setColumn(0, "CGBN", 	DS_sgbn.getColumn(ii, "CGBN"));
			DS_menu.setColumn(0, "CGBN_NM", DS_sgbn.getColumn(ii, "CGBN_NM"));
			DS_menu.setColumn(0, "CGBN_CD", DS_sgbn.getColumn(ii, "CGBN_CD"));
			DS_menu.setColumn(0, "SGBN_NO", (ii+1));
		}
		else { 
		
			// 생성된 Row에 Data를 setup 한다
			for(var kk = 0; kk < DS_body_c.rowcount; kk++) {
			
				var set_row = cnt_ds_total + DS_body_c.getColumn(kk, "SSEQ") - 1;   
				
				//if (toNumber(DS_body_c.GetColumn(kk, "sseq")) == 99) {
				if (GetRowType(DS_body_c,kk)== "logical") {
					set_row = cnt_ds_total + max_row - 1;
					DS_menu.setColumn(set_row, "TOT_GBN", 	"99"); 
				 	DS_menu.setColumn(set_row, "SSEQ", 	"99");
				}
				else {
					DS_menu.setColumn(set_row, "TOT_GBN", 	"");
				}
				  
					DS_menu.setColumn(set_row, "SGBN", 		DS_body_c.getColumn(kk, "SGBN"));
					DS_menu.setColumn(set_row, "SGBN_NM", 	DS_body_c.getColumn(kk, "SGBN_NM"));
					DS_menu.setColumn(set_row, "CGBN", 		DS_body_c.getColumn(kk, "CGBN"));
					DS_menu.setColumn(set_row, "CGBN_NM", 	DS_body_c.getColumn(kk, "CGBN_NM"));
					DS_menu.setColumn(set_row, "CGBN_CD", 	DS_body_c.getColumn(kk, "CGBN_CD"));
					DS_menu.setColumn(set_row, "SGBN_NO", 	(ii+1));  
					
					if (GetRowType(DS_body_c,kk)== "logical") {
					
						var set_col = gfn_subStr(DS_body_c.getColumn(kk-1, "FDAY"),4,4); 
						
						//trace('L gfn_subStr(DS_body_c.getColumn(kk-1, "FDAY"),4,4) =>' + gfn_subStr(DS_body_c.getColumn(kk-1, "FDAY"),4,4));
						
					    if(DS_body_c.getColumn(kk-1, "FDAY") != "") {
					    
					    
					        //trace(DS_body_c.getColumn(kk, "SGBN_NM") + ' = ' + DS_body_c.getColumn(kk-1, "SGBN_NM"));
					        //trace(DS_body_c.getColumn(kk, "CGBN_NM") + ' = ' + DS_body_c.getColumn(kk-1, "CGBN_NM"));
					    
					    	DS_menu.setColumn(set_row, "SGBN", 		DS_body_c.getColumn(kk-1, "SGBN"));
							DS_menu.setColumn(set_row, "SGBN_NM", 	DS_body_c.getColumn(kk-1, "SGBN_NM"));
							DS_menu.setColumn(set_row, "CGBN", 		DS_body_c.getColumn(kk-1, "CGBN"));
							DS_menu.setColumn(set_row, "CGBN_NM", 	DS_body_c.getColumn(kk-1, "CGBN_NM"));
							DS_menu.setColumn(set_row, "CGBN_CD", 	DS_body_c.getColumn(kk-1, "CGBN_CD"));
					    
							DS_menu.setColumn(set_row, "DUP_STA_"	+ set_col, 	'');
							DS_menu.setColumn(set_row, "DUP_COLOR_"	+ set_col, 	'');
							DS_menu.setColumn(set_row, "SSEQ_"		+ set_col, 	DS_body_c.getColumn(kk-1, "SSEQ"));
							DS_menu.setColumn(set_row, "SD_CD_"		+ set_col, 	DS_body_c.getColumn(kk-1, "SD_CD"));  
						
							var	v_case			= "FDAY=='"+DS_body_c.getColumn(kk-1, "FDAY")+"'&& SGBN == '"+DS_body_c.getColumn(kk-1, "SGBN")+"' && CGBN == '"+DS_body_c.getColumn(kk-1, "CGBN")+"' && CGBN_CD == '"+DS_body_c.getColumn(kk-1, "CGBN_CD")+"'";
							 
							var	v_price 		= DS_body_c.getCaseSum(v_case, "SD_WON");
			
							////DS_menu.setColumn(set_row, "SD_NM_"				+set_col, 	Put_comma(v_price, 0)+" Kcal");
							DS_menu.setColumn(set_row, "SD_NM_"				+set_col, 	Put_comma(v_price, 0)+" 원");
							DS_menu.setColumn(set_row, "SD_WON_"			+set_col, 	v_price);
							DS_menu.setColumn(set_row, "PHF_"				+set_col, 	"");
							DS_menu.setColumn(set_row, "MAIN_ITEM_CODE1_"	+set_col, 	"");
							DS_menu.setColumn(set_row, "CUISINE_TYPE_"		+set_col, 	"");
						}
					}
					else {
					
						var set_col = gfn_subStr(DS_body_c.getColumn(kk, "FDAY"),4,4); 
						
					//	trace('P gfn_subStr(DS_body_c.getColumn(kk-1, "FDAY"),4,4) =>' + gfn_subStr(DS_body_c.getColumn(kk, "FDAY"),4,4));
						
						DS_menu.setColumn(set_row, "DUP_STA_"	+ set_col, 	DS_body_c.getColumn(kk, "DUP_STA"));
						DS_menu.setColumn(set_row, "DUP_COLOR_"	+ set_col, 	DS_body_c.getColumn(kk, "DUP_COLOR"));
						DS_menu.setColumn(set_row, "SSEQ_"		+ set_col, 	DS_body_c.getColumn(kk, "SSEQ"));
						DS_menu.setColumn(set_row, "SD_CD_"		+ set_col, 	DS_body_c.getColumn(kk, "SD_CD")); 
						
						DS_menu.setColumn(set_row, "SD_NM_"				+set_col, 	DS_body_c.getColumn(kk, "SD_NM"));
						DS_menu.setColumn(set_row, "SD_WON_"			+set_col, 	DS_body_c.getColumn(kk, "SD_WON"));
						DS_menu.setColumn(set_row, "PHF_"				+set_col, 	DS_body_c.getColumn(kk, "PHF"));
						DS_menu.setColumn(set_row, "MAIN_ITEM_CODE1_"	+set_col, 	DS_body_c.getColumn(kk, "MAIN_ITEM_CODE1"));
						DS_menu.setColumn(set_row, "CUISINE_TYPE_"		+set_col, 	DS_body_c.getColumn(kk, "CUISINE_TYPE"));
					}
				
			}
		}
		
		// DS_menu Row 위치를 산정하기 위한 누적값
		cnt_ds_total = cnt_ds_total + max_row;
		
	}
	//
	 
	DS_menu.rowposition = 0;
	DS_menu.applyChange(); 
	
	// 식당예상 식재료율을 구하기 위한 dataset을 생성
	DS_menu.filter();
	DS_menu.filter("");
	DS_menu.filter("TOT_GBN == '99'");
	CopyF(DS_menu2,DS_menu);
	DS_menu.filter();
	DS_menu.filter("");
	
	DS_menu.enableevent = true; 
	
}

/*------------------------------------------------------------
	1. Function ID : fn_make_grdlst()
	2. 개       요 : 조건에 맞는 Grid Format을 작성
	3. 기       능 : 검색조건 기간이 유동적으로 구성되므로 조건에 해당하는 정보를 화면으로
	                 출력하기 위해 Grid를 재구성한다.
	4. 인 수 설 명 : 
*/
function fn_make_grdlst()
{
	fn_make_gridFormat(grd_lst); 
}

function fn_make_grdlst11()
{
	fn_make_gridFormat(grd_lst11); 
}

//가변 그리드 포맷생성
function fn_make_gridFormat(objGrid)
{
	// GRID 작성
	var Contents_grd_lst	 = "";
	var Contents_grd_column  = "";
	var Contents_grd_rows    = "";
	var Contents_grd_head    = "";
	var Contents_grd_body    = "";
	var Contents_grd_body1    = "";
	var Contents_grd_summary = "";
	// 
	// Grid를 작성합니다.
	//
	Contents_grd_lst	 = '<Formats>' + '\n';
	Contents_grd_lst    += '<Format id="default">' + '\n';

	// Grid columns를 작성합니다.
	Contents_grd_column  = ' <Columns>' + '\n';
	Contents_grd_column	+= ' <Column size="75" band="left" />' + '\n';
	for(var ii = 0; ii < il_cnt; ii++)
	{
		Contents_grd_column	+= ' <Column size="120" />' + '\n';
		Contents_grd_column	+= ' <Column size="36"  />' + '\n';
	}
	Contents_grd_column += ' </Columns>' + '\n'; 
	
	// Grid rows를 작성합니다.
	Contents_grd_rows  = ' <Rows>' + '\n';
  	Contents_grd_rows += ' <Row size="48" band="head" />' + '\n';
  	Contents_grd_rows += ' <Row size="24" />'             + '\n';
	Contents_grd_rows += ' </Rows>' + '\n';

	// Grid head를 작성합니다.
	Contents_grd_head	 = '  <Band id="head">' + '\n';
	Contents_grd_head	+= '   <cell col="0" displaytype="text" text="일자"  /> ' + '\n';

	var	v_col1 = -1;
	var	v_col2 = 0;
	var	v_day  = "";
	var v_wImg = "";
	
	for(var ii = 0; ii < il_cnt; ii++) { 
	
	    v_col1 	= v_col1 + 2;
 		v_col2 	= v_col2 + 2;
	
		v_day	= gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,2) + "/" + gfn_subStr(DS_head.getColumn(ii, "FDAY"),6,2) + "(" + DS_head.getColumn(ii, "WE") + ")";
		
		if ( !gfn_isNull(DS_head.getColumn(ii,"WIMG")) ) 
		{
			v_wImg = "URL(&apos;theme://convertImages/" + DS_head.getColumn(ii,"WIMG") + ".png&apos;)";
		}
		
		Contents_grd_head	+= '    <cell col="'+ v_col1 + '" style="color:#'+DS_head.getColumn(ii, "WE_COLOR")+';" displaytype="text" text="'+v_day+'" />' + '\n';
		Contents_grd_head	+= '    <cell col="'+ v_col2 + '" style="" displaytype="image" text="'+v_wImg+'" />' + '\n';

		//Contents_grd_head	+= '    <cell   bkcolor="#dce8fcff" color="#'+DS_head.getColumn(ii, "we_color")+'" col="'+v_col1+'" displaytype="text" text="'+v_day+'" />' + '\n';
	    //Contents_grd_head	+= '    <cell   bkimageid="'+v_wImg+'" col="'+v_col2+'" displaytype="image"/>' + '\n';
	}
		
	Contents_grd_head	+= '  </Band>' + '\n';
 
  	// Grid body를 작성합니다.
  	Contents_grd_body	= '  <Band id="body">' + '\n';
    Contents_grd_body	+= ' <cell align="center" style="background:azure;background2:azure;font:굴림,10,bold;linetype:onlyvert;" display="text" expr="expr:iif(gfn_length(CGBN_NM)&#32;==&#32;0,&#32;gfn_nvl(SGBN_NM)+gfn_nvl(CGBN),&#32;gfn_nvl(SGBN_NM)+gfn_nvl(CGBN)+&apos;(&apos;+gfn_nvl(CGBN_NM)+&apos;)&apos;)" suppress="1" suppressalign="middle"/>' + '\n';

   	var	v_col3 = -1;
 	var	v_seq  = "";  
    //var img_Del = "URL('theme://images/new/grd_WF_ExpandImageX.png')"; 
  	
 	for(var ii = 0; ii < il_cnt; ii++) {
 	
		v_col3 =  v_col3 + 2;  
		v_seq  = gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4);
		
		Contents_grd_body	+= '  <cell col="'+ v_col3 + '" colspan="2" style="background:expr(TOT_GBN==&apos;99&apos;?&apos;#FFEFB5&apos;:&apos;azure&apos;);background2:expr(TOT_GBN==&apos;99&apos;?&apos;#FFEFB5&apos;:&apos;azure&apos;);linetype:onlyvert;">' + '\n'; 

 		Contents_grd_body	+= '   <cell displaytype="text" style="font:EXPR(iif(TOT_GBN==&apos;99&apos;,&#32;&apos;굴림,9,bold&apos;,&#32;&apos;굴림,9&apos;));align:left;" text="bind:SD_NM_' + v_seq + '"/>' + '\n';
 		Contents_grd_body	+= '   <cell col="1" displaytype="number" style="align:right;" expr="expr:iif(TOT_GBN==&apos;99&apos;,gfn_nvl(&apos;&apos;),gfn_nvl(SD_WON_' + v_seq + '))"/>' + '\n';

 		Contents_grd_body	+= '  </cell>' + '\n'; 
    }
      
 	Contents_grd_body	+= '  </Band>' + '\n'; 
 
 		
 	Contents_grd_lst	+= Contents_grd_column + Contents_grd_rows + Contents_grd_head + Contents_grd_body + '</Format>' + '\n' + '</Formats>';
//trace(Contents_grd_lst);
	objGrid.formats  = Contents_grd_lst;
 	objGrid.formatid = "default"; 	
	objGrid.nodataimage = gv_noData;
	//objGrid.autofittype = "col";
	//objGrid.selecttype  = "row"; 	
}

// 식단평가에서 duble Click 시
// fa_com : 선택된 콤보 index (0,1,2,3)
// fa_date : 선택된 일자(YYYYMMDD) or 주간(ALL)
// fa_row : ds_list에서 선택된 row
// fa_tit : 선택된 내용에 대한 설명
function fn_dup_color(fa_com, fa_date, fa_row, fa_tit)
{
	st_pyoTitle.text = "식단평가 : " + fa_tit;
	// alert("fn_dup_color 실행 :fa_com:"+fa_com+"/fa_date:"+fa_date+"/fa_row:"+fa_row+"/");
	if (ds_list.getRowCount() == 0) {
		g_Message("EE", "평가 내용이 없습니다.");
		return;
	}
	// return;
	// fa_com -> 평가항목 combo ( 0 : 레시피명 중복횟수 )
	// fa_com -> 평가항목 combo ( 1 : 주재료군 중복횟수 )
	// fa_com -> 평가항목 combo ( 2 : 조리법 중복횟수 )
	// fa_com -> 평가항목 combo ( 3 : PHF 중복횟수 )
	
	// fa_date -> 주간 ( ALL ), 일자버튼 선택시 ( YYYYMMDD )
	// fa_row -> 조회된 내용 중 더블클릭으로 선택한 row (ds_list)
	// fa_tit -> 처리해야될 내용을 타이틀로 표시한다.
	
	var if_col = ""; // 컬러를 적용할 조건 컬럼
	var v_case = ""; // fillter 할 조건
	
	// 색을 적용할 조건 컬럼을 셋팅
	switch(fa_com){
		case 0:
			if_col = "SD_NM";
			break;
		case 1:
			if_col = "MAIN_ITEM_CODE1";	
			break;
		case 2:
			if_col = "CUISINE_TYPE";	
			break;
		case 3:
			if_col = "PHF";	
			break;
        default :
            break;
	}

	// case 조건을 생성
	if (if_col == "PHF") {
		v_case	+= "PHF='Y'";
	}
	else {
		if (gfn_length(gfn_toString(fa_row))> 0) {
			v_case	+= if_col+"='"+ds_list.getColumn(fa_row, "CD")+"'";
			//alert("fa_row선택:/"+ds_list.GetColumn(fa_row, "CD")+"/");
		}
		else {
			v_case += "(";
			for (var ii=0; ii < ds_list.getRowCount(); ii++)
			{
				if (ii <> 0) {
					v_case += " || ";
				}
				v_case += if_col+"='"+ds_list.getColumn(ii, "CD")+"'";
			}
			v_case += ")";
		}
	}
	
	// 특정일을 선택시
	if (gfn_length(gfn_toString(fa_date))== 8) { // 일자 선택 시
		v_case	+= " && FDAY='"+fa_date+"'";
	}
	//
	// alert(v_case);
	// DS_body 상세 정보에서 평가정보를 추출한다.
	Copy(DS_body_f,DS_body);
	DS_body_f.filter(v_case);

	var f_row = 0;
	
	for (var jj=0; jj < DS_body_f.getRowCount(); jj++)
	{
		if (if_col == "PHF") {
			f_row = 0;
		}
		else {
			// alert("CD='"+DS_body_f.GetColumn(jj, if_col)+"'");
			f_row = ds_list.findRowExpr("CD=='"+DS_body_f.getColumn(jj, if_col)+"'");
		}
		//
		//alert(f_row+"/"+ds_list.GetColumn(f_row, "TEXTCOLOR"));
		
		DS_body_f.setColumn(jj, "DUP_COLOR", ds_list.getColumn(f_row, "TEXTCOLOR"));
		DS_body_f.setColumn(jj, "DUP_STA", "Y");
	}
	//
	DS_body_f.filter("");
	
	grd_lst.enableredraw = false;
	grd_lst.binddataset = "";
	
	// DS_menu Dataset을 다시 작성한다.
	fn_make_DS_menu();
	
	grd_lst.binddataset = "DS_menu";
	grd_lst.enableredraw = true;

}
//******************************************************************************************
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//******************************************************************************************

function btn_ExcelPrint_OnClick(obj:Button, e:ClickEventInfo)
{
	//DS_menu.AddRow();
	if ( obj.name == "btn_ExcelPrint" )
	{
		if (DS_menu.getRowCount() == 0) {
			g_Message("EE",	"출력할 메뉴정보가 없습니다.");
			return;
		}
		gfn_exportExcel(grd_lst, "식단표", "", "", "", "", "cellline");
	} else {
		if (DS_menu11.getRowCount() == 0) {
			g_Message("EE",	"출력할 메뉴정보가 없습니다.");
			return;
		}
		gfn_exportExcel(grd_lst11, "식단표", "", "", "", "", "cellline");
	
	}
	
}

function btn_GiveCal_OnClick(obj:Button, e:ClickEventInfo)
{
	g_CalButton_OnClick(obj);	
	cal_MENU_DATE.value = me_GiveDay.value;
}

function me_GiveDay_OnChanged(obj:MaskEdit,  e:TextChangedEventInfo)
{
	cal_MENU_DATE.value = me_GiveDay.value;	
}

function fn_form_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e);
	//엔터시 조회
	if ( (e.keycode == 13) && (e.fromobject == me_GiveDay) ) fn_search();
}

function grd_lst_oncellclick(obj:Grid, e:GridClickEventInfo)
{
    var dataDS;
    var date;

    if( obj.name == "grd_lst" )
    {
		dataDS = DS_menu ;
		date = DS_head.getColumn(e.cell-1, "FDAY");
    }
    else
    {
		dataDS = DS_menu11 ;
		date = gfn_addDate(DS_head.getColumn(e.cell - 1, "FDAY"), 7)
    }

	// 상단 검색조건 변경시는 조회 후  처리하여야 한다.
	if( gfn_length(in_cond) > 0 )
	{
		g_Message("EE",	"검색조건이 변경되었습니다.\n\n조회 후 다음 작업을 진행하실수 있습니다.");
		return;
	}

	if( e.row < 0 || e.cell < 1)	return;

	var msg = date+":"+dataDS.getColumn(dataDS.rowposition, "SGBN_NM")+dataDS.getColumn(dataDS.rowposition, "CGBN")+" 에 대한\n\n레시피 검색을 하시겠습니까?";

	if (g_Confirm("04",	msg) == true)
	{
		// 레시피 검색 및 등록/수정
		var	v_arg	= "";
		var	v_open	= "";
		var	v_rtn	= "";
		var	v_width	= -1;
		var	v_height= -1;
		var	leftPx	= -1;
		var	topPx	= -1;
		var toDt 	= gfn_addDate(ds_input.getColumn(0, "MENU_EDATE"), 7);

		v_arg = {fa_FROM_DT:ds_input.getColumn(0, "MENU_SDATE")
				,fa_TO_DT:toDt
				,fa_MEAL:dataDS.getColumn(dataDS.rowposition, "SGBN")
				,fa_CORNER:dataDS.getColumn(dataDS.rowposition, "CGBN_CD")
				,fa_MENU_DATE:date
				,fa_MENU_CLASS:ds_input.getColumn(0, "MENU_CLASS")
				,fa_COST_TYPE:ds_input.getColumn(0, "COST_TYPE")
				,fa_MENU_TYPE:ds_input.getColumn(0, "MENU_TYPE")};

		v_open	 	= "TitleBar=false Status=false AutoSize=false Resize=false NoMove=false";
		//v_rtn 		= gfn_dialog("", "U_FMM::FMM00430E.xml", v_arg, v_width, v_height, v_open, leftPx, topPx);
		v_rtn 		= gfn_dialog("", "U_FMM::FMM00350P.xfdl", v_arg, 1252, 355);

	}
}

function cbo_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	in_cond		= "update";	
}

function cal_MENU_DATE_OnChanged(obj:Calendar, e:ChangeEventInfo)
{
	in_cond		= "update";	
}]]></Script>
  </Form>
</FDL>

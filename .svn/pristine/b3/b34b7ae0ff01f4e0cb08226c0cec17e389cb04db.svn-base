<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="FSM90700P" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 800" titletext="식단자동생성(병원식)" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 785" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 785 1252 800" anchor="left bottom"/>
        <Static id="Static19" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 15 81 235 94"/>
        <Static id="Static20" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 15 107 1237 112" anchor="left top"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 15 40 1237 81" anchor="left top right"/>
        <Static id="Static28" text="사업장" class="sta_WFSA_label" position="absolute 30 51 92 72" anchor="left top"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 15 40 108 50" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 15 71 108 81" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 15 50 30 71" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 75 50 85 71" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 309 50 339 71" anchor="left top"/>
        <Static id="Static49" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1179 81 1237 87" anchor="top right"/>
        <Grid id="grd_meal" taborder="3" binddataset="ds_mealCorner" useinputpanel="false" autofittype="col" position="absolute 955 112 1237 471" anchor="top right" oncelldblclick="grd_meal_oncelldblclick" autoenter="select">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30"/>
                <Column size="85"/>
                <Column size="156"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox" edittype="checkbox"/>
                <Cell col="1" text="끼니"/>
                <Cell col="2" text="코너"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="checkbox" style="align:center;background:white;background2:white;" text="bind:CHK"/>
                <Cell col="1" style="background:white;background2:white;" text="bind:MEAL_NAME" suppress="1"/>
                <Cell col="2" style="align:left;background:white;background2:white;" text="bind:CORNER_NAME"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static10" text="끼니/코너" class="sta_WF_Title01" position="absolute 955 95 1074 113" anchor="top right"/>
        <Grid id="grd_menuList" taborder="2" binddataset="ds_menuList" useinputpanel="false" autofittype="col" position="absolute 570 112 945 471" anchor="top right" autoenter="select">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30"/>
                <Column size="60"/>
                <Column size="145"/>
                <Column size="65"/>
                <Column size="65"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox" edittype="checkbox"/>
                <Cell col="1" text="코드"/>
                <Cell col="2" text="레시피명"/>
                <Cell col="3" text="구성요소"/>
                <Cell col="4" text="원가"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="checkbox" style="background:white;background2:white;" text="bind:CHK"/>
                <Cell col="1" style="background:white;background2:white;" text="bind:RECIPE_CD"/>
                <Cell col="2" displaytype="text" style="background:white;background2:white;" text="bind:RECIPE_NAME"/>
                <Cell col="3" displaytype="combo" edittype="combo" style="background:white;background2:white;" text="bind:MAJOR_DISH_INFO" combodataset="ds_Const" combocodecol="CD" combodatacol="NM"/>
                <Cell col="4" displaytype="number" style="background:white;background2:white;" text="bind:RECIPE_COST" mask="#,##0"/>
              </Band>
              <Band id="summary">
                <Cell colspan="4" taborder="undefined"/>
                <Cell col="4" displaytype="number" text="expr:getSum('RECIPE_COST')" mask="#,##0"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static17" text="w05" class="Guide01_AreaRed" visible="false" position="absolute 540 81 545 415" anchor="left top"/>
        <Button id="btn_addRecipe" taborder="13" class="btn_WF_rightMove" position="absolute 545 216 565 236" anchor="top right" onclick="btn_addRecipe_onclick"/>
        <Static id="Static13" text="w05" class="Guide01_AreaRed" visible="false" position="absolute 565 81 570 415" anchor="top right"/>
        <Button id="btn_removeRecipe" taborder="14" class="btn_WF_leftMove" position="absolute 545 241 565 261" anchor="top right" onclick="btn_removeRecipe_onclick"/>
        <Static id="Static14" text="식단구성" class="sta_WF_Title01" position="absolute 570 94 686 112" anchor="top right"/>
        <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 15 471 1237 486" anchor="left top"/>
        <Static id="Static40" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 945 81 955 415" anchor="top right"/>
        <Static id="Static00" text="등록기간" class="sta_WFSA_label" position="absolute 610 51 670 72" anchor="left top"/>
        <Static id="Static01" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 668 50 678 71" anchor="left top"/>
        <Static id="Static03" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 456 81 540 87" anchor="top right"/>
        <Button id="btn_setRecipe" taborder="34" text="식단배정" class="btn_WF_Function" position="absolute 1172 87 1237 107" anchor="top right" onclick="btn_setRecipe_onclick"/>
        <ObjCalendar id="cal_startDate" anchor="left top" titletext="캘린더" taborder="35" scrollbars="none" position="absolute 678 50 781 71"/>
        <Static id="Static8" text="~" position="absolute 787 51 796 72"/>
        <ObjCalendar id="cal_endDate" anchor="left top" titletext="캘린더" taborder="36" scrollbars="none" position="absolute 801 50 904 71"/>
        <Edit id="edt_upjang" taborder="37" position="absolute 85 50 309 71" readonly="true"/>
        <Static id="Static16" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1237 10" anchor="left bottom"/>
        <Static id="Static34" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 10 15 785" anchor="top right"/>
        <Static id="Static31" text="레시피검색" class="sta_WF_Title01" position="absolute 15 94 103 112" anchor="left top"/>
        <Static id="Static02" class="sta_WFSA_Labelbg" position="absolute 15 112 538 205" anchor="left top right"/>
        <CheckBox id="chk_stdRecipe" taborder="39" text="표준레시피" value="0" truevalue="1" falsevalue="0" onclick="chk_recipe_onclick" position="absolute 113 90 199 110"/>
        <CheckBox id="chk_upjangRecipe" taborder="40" text="업장표준레시피" value="0" truevalue="1" falsevalue="0" onclick="chk_recipe_onclick" position="absolute 204 90 314 110"/>
        <Static id="Static35" text="W10" visible="false" position="absolute 30 112 525 122" style="background:#ff000055;align:center middle;"/>
        <Static id="Static36" text="W10" visible="false" position="absolute 30 195 525 205" style="background:#ff000055;align:center middle;"/>
        <Static id="Static37" text="W15" visible="false" position="absolute 15 112 30 204" style="background:#ff000055;align:center middle;"/>
        <Static id="Static38" text="W15" visible="false" position="absolute 525 112 540 205" style="background:#ff000055;align:center middle;"/>
        <Static id="Static15" text="W05." visible="false" position="absolute 30 143 525 148" style="background:#ff000055;align:center middle;"/>
        <Combo id="cbo_recipeNm" taborder="0" autoselect="true" imemode="hangul" innerdataset="ds_cboRecipeNm" codecolumn="NM" datacolumn="NM" type="filter" displayrowcount="15" ontextchanged="cbo_recipeNm_ontextchanged" onitemchanged="cbo_recipeNm_onitemchanged" onkillfocus="cbo_recipeNm_onkillfocus" onkeydown="cbo_recipeNm_onkeydown" position="absolute 30 122 191 143" userchange="0"/>
        <Combo id="cbo_recipeClass" taborder="4" innerdataset="ds_cboRecipeClass" codecolumn="CD" datacolumn="NM" position="absolute 197 122 358 143"/>
        <Combo id="cbo_recipeType" taborder="5" innerdataset="ds_cboRecipeType" codecolumn="CODE" datacolumn="CODE_NAME" onitemchanged="cbo_recipeType_onitemchanged" position="absolute 364 122 525 143"/>
        <Combo id="cbo_material" taborder="7" innerdataset="ds_cboMaterial" codecolumn="CODE" datacolumn="CODE_NAME" position="absolute 197 148 358 169"/>
        <Combo id="cbo_element" taborder="8" innerdataset="ds_cboElement" codecolumn="CODE" datacolumn="CODE_NAME" position="absolute 364 148 525 169"/>
        <Combo id="cbo_cuisineType" taborder="6" innerdataset="ds_cboCuisineType" codecolumn="CODE" datacolumn="CODE_NAME" position="absolute 30 148 191 169"/>
        <MaskEdit id="MaskEdit00" taborder="9" position="absolute 68 174 140 195"/>
        <MaskEdit id="MaskEdit01" taborder="10" position="absolute 165 174 237 195"/>
        <Static id="Static18" text="~" position="absolute 141 176 165 195" style="align:center middle;"/>
        <Button id="btn_searchRecipe" taborder="50" text="조회" onclick="btn_searchRecipe_onclick" class="btn_WF_Function" position="absolute 485 87 538 107" anchor="top right"/>
        <Grid id="grd_recipeList" taborder="1" binddataset="ds_recipeList" autoenter="select" useinputpanel="false" oncelldblclick="grd_recipeList_oncelldblclick" onexpanddown="grd_recipeList_onexpanddown" position="absolute 15 217 540 471" style="background:white;" onkeydown="grd_recipeList_onkeydown">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30"/>
                <Column size="54"/>
                <Column size="80"/>
                <Column size="189"/>
                <Column size="80"/>
                <Column size="84"/>
                <Column size="110"/>
                <Column size="110"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="구분"/>
                <Cell col="2" text="코드"/>
                <Cell col="3" text="레시피명"/>
                <Cell col="4" text="원가"/>
                <Cell col="5" text="레시피분류"/>
                <Cell col="6" text="레시피유형"/>
                <Cell col="7" text="조리법유형"/>
                <Cell col="8" text="선호도"/>
              </Band>
              <Band id="body">
                <Cell style="background:white;background2:white;" expr="expr:currow + 1"/>
                <Cell col="1" style="background:white;background2:white;" text="bind:GUBUN"/>
                <Cell col="2" style="padding: ;background:white;background2:white;backgroundimage:EXPR(DI_MON == 1 ? 'theme://images/new/grd_WF_N.png' : '');" text="bind:RECIPE_CD"/>
                <Cell col="3" displaytype="text" edittype="expand" style="background:white;background2:white;backgroundimage: ;" text="bind:RECIPE_NAME" expandshow="show" expandsize="20" expandimage="URL('theme://images/new/grd_WF_Expand.png')"/>
                <Cell col="4" displaytype="number" style="background:white;background2:white;" text="bind:RECIPE_COST"/>
                <Cell col="5" displaytype="combo" style="align:left;background:white;background2:white;" text="bind:RECIPE_CLASS" combodataset="ds_grdRecipeClass" combocodecol="CODE" combodatacol="CODE_NAME"/>
                <Cell col="6" displaytype="combo" style="align:left;background:white;background2:white;" text="bind:RECIPE_TYPE" combodataset="ds_cboRecipeType" combocodecol="CODE" combodatacol="CODE_NAME"/>
                <Cell col="7" displaytype="combo" style="align:left;background:white;background2:white;" text="bind:CUISINE_TYPE" combodataset="ds_cboCuisineType" combocodecol="CODE" combodatacol="CODE_NAME"/>
                <Cell col="8" style="background:white;background2:white;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static22" text="W05." visible="false" position="absolute 30 169 525 174" style="background:#ff000055;align:center middle;"/>
        <Static id="Static23" text="원가" class="sta_WFSA_label" position="absolute 30 175 82 196" anchor="left top"/>
        <ImageViewer id="img_open" taborder="54" image="URL('theme://convertImages/img_OpenBottom.png')" onclick="img_open_onclick" position="absolute 505 205 540 217" style="border:1 solid #cacacaff ;"/>
        <Static id="Static24" text="식당명" class="sta_WFSA_label" position="absolute 339 51 401 72" anchor="left top"/>
        <Static id="Static26" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 384 50 394 71" anchor="left top"/>
        <Static id="Static27" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 569 50 599 71" anchor="left top"/>
        <Combo id="cbo_hall" taborder="55" innerdataset="@ds_cboHall" codecolumn="HALL_CD" datacolumn="HALL_NAME" onitemchanged="cbo_hall_onitemchanged" position="absolute 394 50 569 71"/>
        <Button id="btn_save" taborder="58" text="저장" onclick="fn_save" class="btn_WF_CRUD" position="absolute 1145 10 1190 35" anchor="top right"/>
        <Button id="btn_close" taborder="59" text="닫기" onclick="fn_close" class="btn_WF_CRUD" position="absolute 1192 10 1237 35" anchor="top right"/>
        <Static id="Static12" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 990 35 1237 40"/>
        <Button id="btn_setUnit" taborder="60" text="개별등록" class="btn_WF_Function" position="absolute 418 87 483 107" anchor="top right" onclick="btn_setUnit_onclick"/>
        <Static id="Static29" text="식단 일괄생성시 기존에 등록되어 있던 식단은 삭제되오니 주의하시기 바랍니다." class="sta_WF_DiscPoint" position="absolute 15 18 664 33" anchor="right bottom" style="align:left top;"/>
        <Div id="Div00" taborder="61" text="Div00" position="absolute 13 477 1241 785" style="background:white;">
          <Layouts>
            <Layout>
              <Grid id="grd_previewList" taborder="0" binddataset="ds_grdPreviewList" autoenter="select" useinputpanel="false" selecttype="area" cellsizingtype="col" autofittype="none" onkeydown="grd_previewList_onkeydown" position="absolute 2 27 1226 308" anchor="all" style="background:white;">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="90"/>
                      <Column size="112"/>
                      <Column size="170"/>
                      <Column size="170"/>
                      <Column size="170"/>
                      <Column size="170"/>
                      <Column size="170"/>
                      <Column size="170"/>
                    </Columns>
                    <Rows>
                      <Row size="24" band="head"/>
                      <Row size="24" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell rowspan="2" text="끼니" taborder="undefined"/>
                      <Cell col="1" rowspan="2" text="구성요소" taborder="undefined"/>
                      <Cell col="2" colspan="6" text="코너" taborder="undefined"/>
                      <Cell row="1" col="2" text="코너1"/>
                      <Cell row="1" col="3" text="코너2"/>
                      <Cell row="1" col="4" text="코너3"/>
                      <Cell row="1" col="5" text="코너4"/>
                      <Cell row="1" col="6" text="코너5"/>
                      <Cell row="1" col="7" text="코너6"/>
                    </Band>
                    <Band id="body">
                      <Cell style="background:#fffdecff;background2:#fffdecff;" text="bind:MEAL_NAME" suppress="1"/>
                      <Cell col="1" displaytype="combo" style="background:whitesmoke;background2:whitesmoke;" text="bind:MAJOR_DISH_INFO" combodataset="ds_Const" combocodecol="CD" combodatacol="NM"/>
                      <Cell col="2" style="background:white;background2:white;" text="bind:상식"/>
                      <Cell col="3" style="background:white;background2:white;" text="bind:상식선택식"/>
                      <Cell col="4" style="background:white;background2:white;" text="bind:연식"/>
                      <Cell col="5" style="background:white;background2:white;" text="bind:산모식"/>
                      <Cell col="6" style="background:white;background2:white;" text="bind:소아식"/>
                      <Cell col="7" style="background:white;background2:white;" text="bind:유아식"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Static id="Static21" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 2 22 452 27" anchor="left top"/>
              <Static id="Static25" text="식단 미리보기" class="sta_WF_Title01" position="absolute 2 9 236 27" anchor="left top"/>
              <Button id="btn_init" taborder="1" text="다시작성" onclick="btn_init_onclick" class="btn_WF_Function" position="absolute 1092 2 1157 22" anchor="top right"/>
              <Button id="btn_fullScreen" taborder="2" text="전체화면" class="btn_WF_Function" position="absolute 1159 2 1224 22" anchor="top right" onclick="Div00_btn_fullScreen_onclick"/>
              <Static id="Static44" text="Ctrl + C : 복사하기" class="sta_WF_DiscInfo" position="absolute 116 8 266 23" anchor="left top"/>
              <Static id="Static03" text="Ctrl + V : 붙여넣기" class="sta_WF_DiscInfo" position="absolute 268 8 513 23" anchor="left top"/>
            </Layout>
          </Layouts>
        </Div>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item7" compid="chk_stdRecipe" propid="value" datasetid="ds_recipeCond" columnid="STD_CHK"/>
      <BindItem id="item8" compid="chk_upjangRecipe" propid="value" datasetid="ds_recipeCond" columnid="UPJANG_CHK"/>
      <BindItem id="item0" compid="cbo_recipeClass" propid="value" datasetid="ds_recipeCond" columnid="RECIPE_CLASS"/>
      <BindItem id="item1" compid="cbo_recipeType" propid="value" datasetid="ds_recipeCond" columnid="RECIPE_TYPE"/>
      <BindItem id="item3" compid="cbo_material" propid="value" datasetid="ds_recipeCond" columnid="MAIN_ITEM_CODE1"/>
      <BindItem id="item4" compid="cbo_element" propid="value" datasetid="ds_recipeCond" columnid="RESP_NUT1"/>
      <BindItem id="item2" compid="cbo_cuisineType" propid="value" datasetid="ds_recipeCond" columnid="CUISINE_TYPE"/>
      <BindItem id="item5" compid="cbo_hall" propid="value" datasetid="ds_cond" columnid="HALL_CD"/>
    </Bind>
    <Objects>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="UPJANGNM" type="STRING" size="256"/>
          <Column id="HALL_CD" type="STRING" size="256"/>
          <Column id="HALL_NM" type="STRING" size="256"/>
          <Column id="SUBINV_CODE" type="STRING" size="256"/>
          <Column id="START_DATE" type="STRING" size="256"/>
          <Column id="END_DATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboRecipeNm"/>
      <Dataset id="ds_cboRecipeClass">
        <ColumnInfo>
          <Column id="CD" type="STRING" size="256"/>
          <Column id="NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboRecipeType">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboMaterial">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboElement">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboCuisineType">
        <ColumnInfo>
          <Column id="CODE" size="255" type="STRING"/>
          <Column id="CODE_NAME" size="255" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboMeal" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="MEAL" type="STRING" size="256"/>
          <Column id="MEAL_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboCorner" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CORNER" type="STRING" size="256"/>
          <Column id="CORNER_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboHall" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="HALL_CD" type="STRING" size="256"/>
          <Column id="HALL_NAME" type="STRING" size="256"/>
          <Column id="MENU_CYCLE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_recipeList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="GUBUN" type="STRING" size="256"/>
          <Column id="RECIPE_CD" type="STRING" size="256"/>
          <Column id="RECIPE_NAME" type="STRING" size="256"/>
          <Column id="RECIPE_COST" type="STRING" size="256"/>
          <Column id="RECIPE_CLASS" type="STRING" size="256"/>
          <Column id="RECIPE_TYPE" type="STRING" size="256"/>
          <Column id="CUISINE_TYPE" type="STRING" size="256"/>
          <Column id="PREFER" type="STRING" size="256"/>
          <Column id="DI_MON" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_recipeCond" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="STD_CHK" type="STRING" size="256"/>
          <Column id="UPJANG_CHK" type="STRING" size="256"/>
          <Column id="ENF_CHK" type="STRING" size="256"/>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="SUBINV_CODE" type="STRING" size="256"/>
          <Column id="MENU_DATE" type="STRING" size="256"/>
          <Column id="HALL_CD" type="STRING" size="256"/>
          <Column id="RECIPE_NAME" type="STRING" size="256"/>
          <Column id="RECIPE_NAME1" type="STRING" size="256"/>
          <Column id="RECIPE_NAME2" type="STRING" size="256"/>
          <Column id="RECIPE_NAME3" type="STRING" size="256"/>
          <Column id="RECIPE_NAME4" type="STRING" size="256"/>
          <Column id="RECIPE_NAME5" type="STRING" size="256"/>
          <Column id="RECIPE_CLASS" type="STRING" size="256"/>
          <Column id="RECIPE_TYPE" type="STRING" size="256"/>
          <Column id="CUISINE_TYPE" type="STRING" size="256"/>
          <Column id="MAIN_ITEM_CODE1" type="STRING" size="256"/>
          <Column id="RESP_NUT1" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grdRecipeClass">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_mealCorner" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="MEAL" type="STRING" size="256"/>
          <Column id="MEAL_NAME" type="STRING" size="256"/>
          <Column id="CORNER" type="STRING" size="256"/>
          <Column id="CORNER_NAME" type="STRING" size="256"/>
          <Column id="EXPECT_MEAL_QTY" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_menuList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="GUBUN" type="STRING" size="256"/>
          <Column id="RECIPE_CD" type="STRING" size="256"/>
          <Column id="RECIPE_NAME" type="STRING" size="256"/>
          <Column id="MAJOR_DISH_INFO" type="STRING" size="256"/>
          <Column id="RECIPE_COST" type="BIGDECIMAL" size="256"/>
          <Column id="RECIPE_CLASS" type="STRING" size="256"/>
          <Column id="RECIPE_TYPE" type="STRING" size="256"/>
          <Column id="CUISINE_TYPE" type="STRING" size="256"/>
          <Column id="PREFER" type="STRING" size="256"/>
          <Column id="DI_MON" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Const">
        <ColumnInfo>
          <Column id="CD" type="STRING" size="256"/>
          <Column id="NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sysDate" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_grdPreviewList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="MEAL" type="STRING" size="256"/>
          <Column id="MEAL_NAME" type="STRING" size="256"/>
          <Column id="CORNER" type="STRING" size="256"/>
          <Column id="CORNER_NAME" type="STRING" size="256"/>
          <Column id="MAJOR_DISH_INFO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_bodyList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="MEAL" type="STRING" size="256"/>
          <Column id="MEAL_NAME" type="STRING" size="256"/>
          <Column id="CORNER" type="STRING" size="256"/>
          <Column id="CORNER_NAME" type="STRING" size="256"/>
          <Column id="MAJOR_DISH_INFO" type="STRING" size="256"/>
          <Column id="MAJOR_DISH_INFO_NAME" type="STRING" size="256"/>
          <Column id="GUBUN" type="STRING" size="256"/>
          <Column id="RECIPE_CD" type="STRING" size="256"/>
          <Column id="RECIPE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";

/******************************************************************************************
 * 시스템구분 : 메뉴관리/식단관리
 * 프로그램명 : FSM90700E.XML
 * 기ㅡㅡㅡ능 : 일일식단등록(병원용) - 식단일괄생성
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-07-03
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************/

//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================

//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(this);

	// X-Framework : Action 정보 생성
	fsp_init(this);
	
	// 초기화
	fn_init();
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_init()
 * 기ㅡㅡㅡ능 : 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-07-03
 ******************************************************************************************/
function fn_init()
{
	// 조회조건 초기화
	ds_cond.clearData();
	ds_cond.addRow();

	// 레시피 조회조건 초기화
	ds_recipeCond.clearData();
	ds_recipeCond.addRow();

	// 조회조건값 세팅
	ds_cond.setColumn(0, "UPJANG"     , fa_UPJANG);       // 사업장코드
	ds_cond.setColumn(0, "HALL_CD"    , fa_HALL_CD);      // 식당코드
	ds_cond.setColumn(0, "SUBINV_CODE", fa_SUBINV_CODE);  // 창고코드
	
	// 레시피조회조건값 세팅
	ds_recipeCond.setColumn(0, "UPJANG"     , fa_UPJANG);       // 사업장코드
	ds_recipeCond.setColumn(0, "HALL_CD"    , fa_HALL_CD);      // 식당코드
	ds_recipeCond.setColumn(0, "SUBINV_CODE", fa_SUBINV_CODE);  // 창고코드

	// 식단제공일 초기화
	cal_startDate.fn_initMonthCal(this, fa_FROM_DT, '', ds_cond, 'START_DATE');
	cal_endDate.fn_initMonthCal(this, fa_TO_DT, '', ds_cond, 'END_DATE');
	
	// 업장명 세팅
	edt_upjang.value = fa_UPJANGNM;
	
	chk_stdRecipe.value = 1;
	chk_upjangRecipe.value = 1;
	
	// 공통코드 조회
	var v_ds;
	var v_fil_cond;
	
	v_ds = fn_common_code("'FS0001','FS0002','FS0003','FS0004','FS0006'","","","non","Y");

	// 업장별 사용레시피분류
	fsp_clear(this);
	ds_cboRecipeClass.clearData();
	fsp_addSearch(this,"fs/fsm:FSM00060E_S010");
	fsp_callService(this, "", "", "", "ds_cboRecipeClass=ds_RecipeClass", "UPJANG=" + fa_UPJANG, "fn_callbackRecipeClass", "", true);

	// 레시피분류(GROUP_CODE : 'FS0001')
	v_fil_cond = "GROUP_CODE=='FS0001'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_grdRecipeClass, v_ds.name);

	// 레시피유형(GROUP_CODE : 'FS0002')
	v_fil_cond = "GROUP_CODE=='FS0002'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_cboRecipeType, v_ds.name);
	ds_cboRecipeType.insertRow(0);
	ds_cboRecipeType.setColumn(0, "CODE", "");
	ds_cboRecipeType.setColumn(0, "CODE_NAME", "== 레시피유형 ==");
	cbo_recipeType.value = "";
	
	// 조리법유형(GROUP_CODE : 'FS0003')
	v_fil_cond = "GROUP_CODE=='FS0003'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_cboCuisineType, v_ds.name);
	ds_cboCuisineType.insertRow(0);
	ds_cboCuisineType.setColumn(0, "CODE", "");
	ds_cboCuisineType.setColumn(0, "CODE_NAME", "== 조리법유형 ==");
	cbo_cuisineType.value = "";

	// 주재료군(GROUP_CODE : 'FS0006')
	v_fil_cond = "GROUP_CODE=='FS0006'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_cboMaterial, v_ds.name);
	ds_cboMaterial.insertRow(0);
	ds_cboMaterial.setColumn(0, "CODE", "");
	ds_cboMaterial.setColumn(0, "CODE_NAME", "== 주재료군 ==");
	cbo_material.value = "";
	
	// 대표영양성분(GROUP_CODE : 'FS0004')
	v_fil_cond = "GROUP_CODE=='FS0004'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_cboElement, v_ds.name);
	ds_cboElement.insertRow(0);
	ds_cboElement.setColumn(0, "CODE", "");
	ds_cboElement.setColumn(0, "CODE_NAME", "== 대표영양성분 ==");
	cbo_element.value = "";
	
	fn_search();
}

function fn_callback(errCode, errMsg) 
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오!");
		return;
	}
}

function fn_callbackRecipeClass(errCode, errMsg) 
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오!");
		return;
	}
	ds_cboRecipeClass.insertRow(0);
	ds_cboRecipeClass.setColumn(0, "CD", "");
	ds_cboRecipeClass.setColumn(0, "NM", "== 레시피분류 ==");
	cbo_recipeClass.index = 0;
}

function fn_callbackRecipeNm(errCode, errMsg) 
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오!");
		return;
	}
	ds_cboRecipeNm.setColumn(0, "NM", "== 레시피명 ==");
	cbo_recipeNm.index = 0;
	
	// 식당정보 조회
	fn_hallSearch();
}

//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,출력)
//
//=========================================================================================
function fn_search()
{
	ds_bodyList.clearData();
	ds_mealCorner.clearData();
	ds_grdPreviewList.clearData();

	fsp_clear(this);
	fsp_addSearch(this, "fs/fsr:FSR90010E_S001");	// 레시피명
	fsp_addSearch(this, "sc/scc:SCC_TODAY");        // 시스템일자
	fsp_addSearch(this, "fs/fsm:FSM00060E_S007");   // 병원식구성요소
	fsp_addSearch(this, "fs/fsm:FSM90700P_S001");	// 끼니코너
	fsp_callService(this, "", "", "ds_cond=ds_cond", "ds_cboRecipeNm=ds_RecipeNM ds_sysDate=ds_GetDate ds_Const=ds_Const ds_mealCorner=ds_mealCorner", "", "fn_callbackRecipeNm");
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_save()
 * 기ㅡㅡㅡ능 : 저장
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-07-03
 ******************************************************************************************/
function fn_save()
{
	if(ds_bodyList.getRowCount() == 0)
	{
		g_Message("EE", "저장할 식단이 존재하지 않습니다.");
		return;
	}
	
	if(!g_Confirm("01", "[ 주의 ] 해당 기간에 식단이 존재할 경우 삭제 됩니다.\n\n현재 작성하신 식단으로 등록하시겠습니까?")) return;
	
	jsp_transaction(this, "FSM90700P_T001","U_svc::fs/fsm/FSM90700P_T001.jsp", "ds_cond=ds_cond ds_bodyList=ds_bodyList", "", "", "fn_callbackSave", false, false, false);
}

function fn_callbackSave(errCode, errMsg) 
{
	if(errCode!=0)
	{
		return;
	}

	g_Message("02", "저장 되었습니다.");
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_close()
 * 기ㅡㅡㅡ능 : 닫기
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-07-03
 ******************************************************************************************/
function fn_close()
{
	this.close();
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_hallSearch()
 * 기ㅡㅡㅡ능 : 식당정보 조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_hallSearch()
{
	// 업장이 선택되어 있을 경우에만 조회한다.
	if(gfn_isNull(ds_cond.getColumn(0, "UPJANG"))) return;

	fsp_clear(this); 
	fsp_addSearch(this, "fs/fsc:FSA_HALL_MST_S001");
	fsp_callService(this, "", "", "", "ds_cboHall=gds_Csqlout", "UPJANG=" + wrapQuote(ds_cond.getColumn(0, "UPJANG")), "fn_callbackHallSearch");
}

function fn_callbackHallSearch(errCode, errMsg) 
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오!");
		return;
	}
	
	ds_cboHall.filter("gfn_length(MENU_CYCLE) > 0");
	cbo_hall.value = ds_cond.getColumn(0, "HALL_CD");
	
 	// 창고코드 셋팅
 	ds_cond.setColumn(0, "SUBINV_CODE", ds_cboHall.getColumn(0, "SUBINV_CODE"));
 	
 	// 식단미리보기 그리드 생성
 	fn_drawPreviewGrid();
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// 
//=========================================================================================
/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_searchRecipe_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 식단미리보기 그리드 생성
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-07-03
 ******************************************************************************************/
function fn_drawPreviewGrid()
{
	ds_grdPreviewList.enableevent = false;
	var nRow, nCol;
	ds_grdPreviewList.keystring = "S:+CORNER+MEAL+MAJOR_DISH_INFO";
	ds_grdPreviewList.clear();
	ds_grdPreviewList.addColumn("MEAL"                , "STRING");  // 끼니
	ds_grdPreviewList.addColumn("MEAL_NAME"           , "STRING");  // 끼니코드
	ds_grdPreviewList.addColumn("MAJOR_DISH_INFO"     , "STRING");  // 구성요소
	ds_grdPreviewList.addColumn("MAJOR_DISH_INFO_NAME", "STRING");  // 구성요소명
	
	//ds_bodyList.filter("CORNER=='" + ds_bodyList.getColumn(0, "CORNER") + "' && MAJOR_DISH_INFO=='" + ds_bodyList.getColumn(i, "MAJOR_DISH_INFO") + "'");
	for (var i=0, nRow=-1; i < ds_bodyList.rowcount; i++) 
	{
		var nFindRow = ds_grdPreviewList.findRowExpr("MEAL=='" + ds_bodyList.getColumn(i, "MEAL") + "' && MAJOR_DISH_INFO=='" + ds_bodyList.getColumn(i, "MAJOR_DISH_INFO") + "'");
		if(nFindRow > -1) continue;
		nRow = ds_grdPreviewList.addRow();		
		ds_grdPreviewList.setColumn(nRow, "MEAL"                , ds_bodyList.getColumn(i, "MEAL"));
		ds_grdPreviewList.setColumn(nRow, "MEAL_NAME"           , ds_bodyList.getColumn(i, "MEAL_NAME"));
		ds_grdPreviewList.setColumn(nRow, "MAJOR_DISH_INFO"     , ds_bodyList.getColumn(i, "MAJOR_DISH_INFO"));
		ds_grdPreviewList.setColumn(nRow, "MAJOR_DISH_INFO_NAME", ds_bodyList.getColumn(i, "MAJOR_DISH_INFO_NAME"));
	}
	//ds_bodyList.filter("");

	var sKey = "";
	for (var i=0; i<ds_bodyList.rowcount; i++) 
	{
		sKey = ds_bodyList.getColumn(i, "CORNER");
		ds_grdPreviewList.addColumn("GUBUN" + sKey, "STRING");
		ds_grdPreviewList.addColumn("RECIPE_CD" + sKey, "STRING");
		ds_grdPreviewList.addColumn("RECIPE_NAME" + sKey, "STRING");
		
		var nFindRow = ds_grdPreviewList.findRowExpr("MEAL=='" + ds_bodyList.getColumn(i, "MEAL") + "' && MAJOR_DISH_INFO=='" + ds_bodyList.getColumn(i, "MAJOR_DISH_INFO") + "'");
		if (nFindRow > -1) 
		{
			ds_grdPreviewList.setColumn(nFindRow, "GUBUN" + sKey, gfn_trim(ds_bodyList.getColumn(i, "GUBUN")));		
			ds_grdPreviewList.setColumn(nFindRow, "RECIPE_CD" + sKey, gfn_trim(ds_bodyList.getColumn(i, "RECIPE_CD")));		
			ds_grdPreviewList.setColumn(nFindRow, "RECIPE_NAME" + sKey, gfn_trim(ds_bodyList.getColumn(i, "RECIPE_NAME")));
		}
	}
	
	if(ds_bodyList.rowcount > 0)
	{
		// 그리드 초기화
		for (var i=Div00.grd_previewList.getFormatColCount() - 1; i > 1; i--)
		{
			Div00.grd_previewList.deleteContentsCol('body', i, false);
		}

		// TOP, RIGHT, BOTTEM, LEFT
		var sProp1 = "0 none #c3c3c3ff, 1 dotted #c3c3c3ff, 0 none  #c3c3c3ff, 1 solid  #c3c3c3ff";  // 메뉴 body line
		var sProp2 = "0 none #c3c3c3ff, 1 dotted #c3c3c3ff, 1 solid #c3c3c3ff, 0 none   #c3c3c3ff";  // 메뉴 소계 line
		var sProp3 = "0 none #c3c3c3ff, 1 solid  #c3c3c3ff, 0 none  #c3c3c3ff, 1 dotted #c3c3c3ff";  // 원가 body line
		var sProp4 = "0 none #c3c3c3ff, 1 solid  #c3c3c3ff, 1 solid #c3c3c3ff, 1 dotted #c3c3c3ff";  // 원가 소계 line
		
		var sColId;
		var sCorner;
		for (var i=0, nCol=-1; i < ds_grdPreviewList.colcount; i++)
		{
			sColId = ds_grdPreviewList.getColID(i);
			
			if (sColId.substr(0, 11) == "RECIPE_NAME")
			{
				sCorner = gfn_right(sColId.replace("RECIPE_NAME", ""), 3);
				nCol = Div00.grd_previewList.appendContentsCol();
				if (nCol > -1)
				{
					Div00.grd_previewList.setFormatColProperty(nCol, "size", 170);
					Div00.grd_previewList.setCellProperty("head", fn_getColId(Div00.grd_previewList, nCol), "text", ds_mealCorner.lookup("CORNER", sCorner, "CORNER_NAME"));
					Div00.grd_previewList.setCellProperty("body", nCol, "text", "bind:" + sColId);
					Div00.grd_previewList.setCellProperty("body", nCol, "align", "left");
					Div00.grd_previewList.setCellProperty("body", nCol, "background", "white");
					Div00.grd_previewList.setCellProperty("body", nCol, "background2", "white");
					Div00.grd_previewList.setCellProperty("body", nCol, "line", "EXPR(iif(MEAL_NAME!=ds_grdPreviewList.getColumn(currow+1, 'MEAL_NAME'),'" + sProp2 + "','" + sProp1 + "'))");
				}
			} 
		}
		
		// 그리드 머지 처리
		Div00.grd_previewList.mergeContentsCell("head", 0, 2, 0, ds_grdPreviewList.colcount, 2, false);
		Div00.grd_previewList.setCellProperty("head", 2, "text", "코너");
	}
	
	ds_grdPreviewList.rowposition = -1;
	ds_grdPreviewList.enableevent = true;
}

function fn_getColId(objGrid, nBodyColIdx)
{
	var arrCellIdx = [];
	for (var i=0; i<objGrid.getCellCount("head"); i++) {
		var nHeadColIdx = objGrid.getCellProperty("head", i, "col");
		if (nBodyColIdx == nHeadColIdx) {
			arrCellIdx[arrCellIdx.length] = i;
		}
	}	
	return arrCellIdx[arrCellIdx.length-1];	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_searchRecipe_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 레시피 검색
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-07-03
 ******************************************************************************************/
function btn_searchRecipe_onclick(obj:Button,  e:ClickEventInfo)
{
	// 제공일 세팅 (오늘 기준으로 단가조회)
	ds_recipeCond.setColumn(0, "MENU_DATE", gfn_today());
	
	// 레시피명 세팅
	for(var i=0; i<5; i++) ds_recipeCond.setColumn(0, "RECIPE_NAME" + (i + 1), "");	 // 초기화
	var sRecipeName = gfn_replace(cbo_recipeNm.value, "== 레시피명 ==", "");
	if(!gfn_isNull(sRecipeName))
	{
		ds_recipeCond.setColumn(0,"RECIPE_NAME", sRecipeName);
		var aRecipeName = sRecipeName.split(' ');
		for(var i=0; i<aRecipeName.length; i++)
		{
			ds_recipeCond.setColumn(0, "RECIPE_NAME" + (i + 1), aRecipeName[i]);
		}
	}

	ds_recipeList.clearData();
	fsp_clear(this);
	fsp_addSearch(this,"fs/fsm:FSM90060E_S005");
	fsp_callService(this, "", "", "ds_recipeCond=ds_recipeCond", "ds_recipeList=ds_List", "", "fn_callback", "", false);
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_addRecipe_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 표준/업장 레시피 체크박스 클릭시 두개중에 한개는 반드시 선택되도록 처리
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-07-03
 ******************************************************************************************/
function chk_recipe_onclick(obj:CheckBox,  e:ClickEventInfo)
{
	switch(obj.name)
	{
		case "chk_stdRecipe":
			if(obj.isChecked() != 1)
			{
				chk_upjangRecipe.value = 1;
			}
			break;
		case "chk_upjangRecipe":
			if(obj.isChecked() != 1)
			{
				chk_stdRecipe.value = 1;
			}		
			break;
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : cbo_recipeNm_onitemchanged(obj:Combo, e:TextChangedEventInfo)
 * 기ㅡㅡㅡ능 : 레시피명 컴포넌트 이벤트 처리
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-07-03
 ******************************************************************************************/
function cbo_recipeNm_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	if ( obj.userchange == "2" ) {
		obj.userchange = "0";
		obj.userdata   = e.posttext;
		
		btn_searchRecipe.setFocus();
		btn_searchRecipe.click();	
		cbo_recipeNm.setFocus();
	} else {
		obj.userchange = "1";
		obj.userdata = e.posttext;
	}	
}

function cbo_recipeNm_onkeydown(obj:Combo, e:KeyEventInfo)
{
	if (e.keycode == 13 && obj.userchange == "1") {
		var strValue, nFRow, objDs, strDataColumn;
		
		strValue 		= obj.userdata;
		objDs           = ds_cboRecipeNm;
		strDataColumn	= obj.datacolumn;
		
		if (gfn_length(strValue)>0) {
			nFRow = objDs.findRow(strDataColumn,strValue);
			
			if (nFRow == -1)
			{
				var nRow = objDs.addRow();
				objDs.setColumn(nRow,strDataColumn,strValue);
				obj.index = nRow;
			} else {
				obj.index = nFRow;
			}
		}
		
		btn_searchRecipe.setFocus();
		btn_searchRecipe.click();
		cbo_recipeNm.setFocus();
		
	} else if (e.keycode == 38 || e.keycode == 40) {
		if ( obj.isDropdown() ) {
			obj.userchange = "2";
		} else {
			obj.userchange = "1";
		}
	}	
}

function cbo_recipeNm_onkillfocus(obj:Combo, e:KillFocusEventInfo)
{
    var strValue,nFRow,objDs,strDataColumn;
	
	objDs           = ds_cboRecipeNm;
	strValue 		= obj.userdata;
	strDataColumn	= obj.datacolumn;
	
	if (gfn_length(strValue) > 0) {
		nFRow = objDs.findRow(strDataColumn,strValue);
		
		if (nFRow == -1)
		{
			var nRow = objDs.addRow();
			objDs.setColumn(nRow,strDataColumn,strValue);
			obj.value = strValue;
		} else {
			obj.value = strValue;
		}
	} else {
		obj.index = 0;
	}		
}

function cbo_recipeNm_ontextchanged(obj:Combo, e:TextChangedEventInfo)
{
	obj.userdata   = e.posttext;
	obj.userchange = "1";	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_addRecipe_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 레시피추가
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-07-03
 ******************************************************************************************/
function btn_addRecipe_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_recipeList.rowcount == 0) return;
	
	var nRow = ds_menuList.addRow();
	ds_menuList.copyRow(nRow, ds_recipeList, ds_recipeList.rowposition);
	ds_menuList.setColumn(nRow, "CHK", 1);
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_removeRecipe_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 레시피삭제
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-07-03
 ******************************************************************************************/
function btn_removeRecipe_onclick(obj:Button,  e:ClickEventInfo)
{
	if(ds_menuList.rowcount == 0) return;
	
	var nRow = ds_menuList.rowposition;
	ds_menuList.deleteRow(nRow);
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : grd_recipeList_onkeydown(obj:Grid, e:KeyEventInfo)
 * 기ㅡㅡㅡ능 : 레시피목록에서 엔터키 입력시 레시피 추가
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-07-03
 ******************************************************************************************/
function grd_recipeList_onkeydown(obj:Grid, e:KeyEventInfo)
{
	if (e.keycode == 13) 
	{
		btn_addRecipe.click();
		cbo_recipeNm.setFocus();
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : grd_meal_oncelldblclick(obj:Grid, e:GridClickEventInfo)
 * 기ㅡㅡㅡ능 : 끼니/코너 더블클릭시 해당 끼니에 대해서 체크처리
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-07-03
 ******************************************************************************************/
function grd_meal_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	// 끼니
	if(e.col == 1)
	{
		var sMeal = ds_mealCorner.getColumn(e.row, "MEAL");
		for(var i=ds_mealCorner.getRowCount(); i>=0; i--)
		{
			if(sMeal == ds_mealCorner.getColumn(i, "MEAL"))
			{
				if(ds_mealCorner.getColumn(i, "CHK") == 1) 
				{
					ds_mealCorner.setColumn(i, "CHK", 0);
				} 
				else
				{
					ds_mealCorner.setColumn(i, "CHK", 1);					
				}
			}
		}
	}
	
	// 끼니
	if(e.col == 2)
	{
		var sMeal = ds_mealCorner.getColumn(e.row, "CORNER");
		for(var i=ds_mealCorner.getRowCount(); i>=0; i--)
		{
			if(sMeal == ds_mealCorner.getColumn(i, "CORNER"))
			{
				if(ds_mealCorner.getColumn(i, "CHK") == 1) 
				{
					ds_mealCorner.setColumn(i, "CHK", 0);
				} 
				else
				{
					ds_mealCorner.setColumn(i, "CHK", 1);					
				}
			}
		}
	}	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_setRecipe_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 식단배정
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-07-03
 ******************************************************************************************/
function btn_setRecipe_onclick(obj:Button,  e:ClickEventInfo)
{
	var nRow = -1;
	for(var i=0; i<ds_menuList.getRowCount(); i++)
	{
		if(ds_menuList.getColumn(i, "CHK") == 1)
		{
			if(gfn_isNull(ds_menuList.getColumn(i, "MAJOR_DISH_INFO")))
			{
				g_Message("EE", "구성요소를 선택해주세요.");
				return;
			}
		
			for(var j=0; j<ds_mealCorner.getRowCount(); j++)
			{
				if(ds_mealCorner.getColumn(j, "CHK") == 1)
				{
					// 기존 등록된 정보인지 체크
					var nFindRow = ds_bodyList.findRowExpr("MEAL=='" + ds_mealCorner.getColumn(j, "MEAL") + "' && CORNER=='" + ds_mealCorner.getColumn(j, "CORNER") + "' && MAJOR_DISH_INFO=='" + ds_menuList.getColumn(i, "MAJOR_DISH_INFO") + "'");
					if(nFindRow != -1)
					{
						continue;
					}
				
					nRow = ds_bodyList.addRow();
					ds_bodyList.setColumn(nRow, "MEAL", ds_mealCorner.getColumn(j, "MEAL"));
					ds_bodyList.setColumn(nRow, "MEAL_NAME", ds_mealCorner.getColumn(j, "MEAL_NAME"));
					ds_bodyList.setColumn(nRow, "CORNER", ds_mealCorner.getColumn(j, "CORNER"));
					ds_bodyList.setColumn(nRow, "CORNER_NAME", ds_mealCorner.getColumn(j, "CORNER_NAME"));
					ds_bodyList.setColumn(nRow, "GUBUN", ds_menuList.getColumn(i, "GUBUN"));
					ds_bodyList.setColumn(nRow, "RECIPE_CD", ds_menuList.getColumn(i, "RECIPE_CD"));
					ds_bodyList.setColumn(nRow, "RECIPE_NAME", ds_menuList.getColumn(i, "RECIPE_NAME"));
					ds_bodyList.setColumn(nRow, "MAJOR_DISH_INFO", ds_menuList.getColumn(i, "MAJOR_DISH_INFO"));
				}
			}
		}
	}
	
	ds_bodyList.updateSortGroup("S:+MEAL+MAJOR_DISH_INFO");
	fn_drawPreviewGrid();
	
	// 배정 후 체크박스 초기화
	for(var i=0; i<ds_menuList.getRowCount(); i++)
	{
		ds_menuList.setColumn(i, "CHK", 0);
	}
	
	for(var i=0; i<ds_mealCorner.getRowCount(); i++)
	{
		ds_mealCorner.setColumn(i, "CHK", 0);
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : Div00.grd_previewList_onkeydown(obj:Grid, e:KeyEventInfo)
 * 기ㅡㅡㅡ능 : 식단미리보기 키 이벤트 처리
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-07-03
 ******************************************************************************************/
var nCopyRow = -1;
var nCopyCorner = '';
function grd_previewList_onkeydown(obj:Grid, e:KeyEventInfo)
{
	var nRow = ds_grdPreviewList.rowposition;
	if(nRow < 0) return;

	var nCell = Div00.grd_previewList.getCellPos();
	if (nCell < 1) { return false; }

    // DEL 키코드는 46번이다.
	if(e.keycode == "46")
	{
		var sCorner = Div00.grd_previewList.getCellProperty("body", nCell, "text").replace("bind:RECIPE_NAME","");
		var sMeal = ds_grdPreviewList.getColumn(nRow, "MEAL");
		var sMajorDishInfo = ds_grdPreviewList.getColumn(nRow, "MAJOR_DISH_INFO");

		var nFindRow = ds_bodyList.findRowExpr("CORNER=='" + sCorner + "' && MEAL=='" + sMeal + "' && MAJOR_DISH_INFO=='" + sMajorDishInfo + "'");
		if (nFindRow > -1) {
			ds_bodyList.deleteRow(nFindRow);
		}
		
		ds_grdPreviewList.setColumn(nRow, "GUBUN" + sCorner, "");
		ds_grdPreviewList.setColumn(nRow, "RECIPE_CD" + sCorner, "");
		ds_grdPreviewList.setColumn(nRow, "RECIPE_NAME" + sCorner, "");
	}
	
	// 복사하기 : Ctrl + C 키
	if ( e.keycode == 67 && e.ctrlKey && ToUpperCase(GetType(e.fromreferenceobject))== "GRID" )
	{
		nCopyRow = nRow;
		nCopyCorner = Div00.grd_previewList.getCellProperty("body", nCell, "text").replace("bind:RECIPE_NAME","");
	}
	
	// 붙여넣기 : Ctrl + V 키
	if ( e.keycode == 86 && e.ctrlKey && ToUpperCase(GetType(e.fromreferenceobject))== "GRID" )
	{
		var tCorner = Div00.grd_previewList.getCellProperty("body", nCell, "text").replace("bind:RECIPE_NAME","");
		var tMeal = ds_grdPreviewList.getColumn(nRow, "MEAL");
		var tMajorDishInfo = ds_grdPreviewList.getColumn(nRow, "MAJOR_DISH_INFO");
		var tRecipeCd = ds_grdPreviewList.getColumn(nRow, "RECIPE_CD" + tCorner);
			
		// 중복레시피 체크
		var sRecipeCd = ds_grdPreviewList.getColumn(nCopyRow, "RECIPE_CD" + nCopyCorner);
		var nFindRow = ds_bodyList.findRowExpr("CORNER=='" + tCorner + "' && MEAL=='" + tMeal + "' && RECIPE_CD=='" + sRecipeCd + "'");
		if (nFindRow > -1) {
			g_Message("EE", "이미 선택하신 레시피가 등록되어 있습니다.");
			return; 
		}	
		
		var sGubun = ds_grdPreviewList.getColumn(nCopyRow, "GUBUN" + nCopyCorner);
		var sRecipeCd = ds_grdPreviewList.getColumn(nCopyRow, "RECIPE_CD" + nCopyCorner);
		var sRecipeName = ds_grdPreviewList.getColumn(nCopyRow, "RECIPE_NAME" + nCopyCorner);

		var nFindRow = ds_bodyList.findRowExpr("CORNER=='" + tCorner + "' && MEAL=='" + tMeal + "' && MAJOR_DISH_INFO=='" + tMajorDishInfo + "'");
		if (nFindRow > -1) 
		{
			// 원본 데이터 수정
			fn_setOrgValue(nFindRow, "GUBUN", sGubun);
			fn_setOrgValue(nFindRow, "RECIPE_CD", sRecipeCd);
			fn_setOrgValue(nFindRow, "RECIPE_NAME", sRecipeName);
		}
		else
		{
			// 원본 데이터 추가
			var nAddRow = ds_bodyList.addRow();									
			ds_bodyList.setColumn(nAddRow, "MEAL", tMeal);
			ds_bodyList.setColumn(nAddRow, "MEAL_NAME", ds_grdPreviewList.getColumn(nRow, "MEAL_NAME"));
			ds_bodyList.setColumn(nAddRow, "CORNER", tCorner);
			//ds_bodyList.setColumn(nAddRow, "CORNER_NAME", ds_grdPreviewList.getColumn(nRow, "CORNER_NAME"));
			ds_bodyList.setColumn(nAddRow, "MAJOR_DISH_INFO", tMajorDishInfo);
			ds_bodyList.setColumn(nAddRow, "MAJOR_DISH_INFO_NAME", ds_grdPreviewList.getColumn(nRow, "MAJOR_DISH_INFO_NAME"));
			ds_bodyList.setColumn(nAddRow, "GUBUN", sGubun);
			ds_bodyList.setColumn(nAddRow, "RECIPE_CD", sRecipeCd);
			ds_bodyList.setColumn(nAddRow, "RECIPE_NAME", sRecipeName);
		}

		ds_grdPreviewList.setColumn(nRow, "GUBUN" + tCorner, sGubun);
		ds_grdPreviewList.setColumn(nRow, "RECIPE_CD" + tCorner, sRecipeCd);
		ds_grdPreviewList.setColumn(nRow, "RECIPE_NAME" + tCorner, sRecipeName);
	}	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : function fn_getOrgValue(nRow, sDate, sColId)
 * 기ㅡㅡㅡ능 : 그리드의 원본 데이터셋에서 매칭되는 값을 구한다.
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_getOrgValue(nRow, sCorner, sColId)
{	
	if (gfn_isNull(sCorner)) {return;}

	var sMeal = ds_grdPreviewList.getColumn(nRow, "MEAL");
	var sMajorDishInfo = ds_grdPreviewList.getColumn(nRow, "MAJOR_DISH_INFO");

	var nFindRow = ds_bodyList.findRowExpr("CORNER=='" + sCorner + "' && MEAL=='" + sMeal + "' && MAJOR_DISH_INFO=='" + sMajorDishInfo + "'");
	if (nFindRow > -1) {
		return gfn_trim(ds_bodyList.getColumn(nFindRow, sColId));
	} else {
		return "";
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_setOrgValue(nRow, sDate, sColId, sValue)
 * 기ㅡㅡㅡ능 : 그리드의 원본 데이터셋에서 매칭되는 값을 세팅한다.
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_setOrgValue(nRow, sColId, sValue)
{	
	if (gfn_isNull(sColId)) {return;}
	return ds_bodyList.setColumn(nRow, sColId, sValue);
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_setUnit_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 개별등록
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function btn_setUnit_onclick(obj:Button,  e:ClickEventInfo)
{
	var nCell = Div00.grd_previewList.getCellPos();
	if (nCell < 1) 
	{ 
		g_Message("EE", "식단 미리보기에서 교체 또는 등록할 레시피를 선택해주세요.");
		return; 
	}
	
	var nRow = ds_grdPreviewList.rowposition;
	if(nRow < 0) return;
	
	var tCorner = Div00.grd_previewList.getCellProperty("body", nCell, "text").replace("bind:RECIPE_NAME","");
	var tMeal = ds_grdPreviewList.getColumn(nRow, "MEAL");
	var tMajorDishInfo = ds_grdPreviewList.getColumn(nRow, "MAJOR_DISH_INFO");
	var tRecipeCd = ds_grdPreviewList.getColumn(nRow, "RECIPE_CD" + tCorner);
		
	// 중복레시피 체크
	var sRecipeCd = ds_recipeList.getColumn(ds_recipeList.rowposition, "RECIPE_CD");
	var nFindRow = ds_bodyList.findRowExpr("CORNER=='" + tCorner + "' && MEAL=='" + tMeal + "' && RECIPE_CD=='" + sRecipeCd + "'");
	if (nFindRow > -1) {
		g_Message("EE", "이미 선택하신 레시피가 등록되어 있습니다.");
		return; 
	}	

	var sGubun = ds_recipeList.getColumn(ds_recipeList.rowposition, "GUBUN");
	var sRecipeCd = ds_recipeList.getColumn(ds_recipeList.rowposition, "RECIPE_CD");
	var sRecipeName = ds_recipeList.getColumn(ds_recipeList.rowposition, "RECIPE_NAME");

	var nFindRow = ds_bodyList.findRowExpr("CORNER=='" + tCorner + "' && MEAL=='" + tMeal + "' && MAJOR_DISH_INFO=='" + tMajorDishInfo + "'");
	if (nFindRow > -1) 
	{
		// 원본 데이터 수정
		fn_setOrgValue(nFindRow, "GUBUN", sGubun);
		fn_setOrgValue(nFindRow, "RECIPE_CD", sRecipeCd);
		fn_setOrgValue(nFindRow, "RECIPE_NAME", sRecipeName);
	}
	else
	{
		// 원본 데이터 추가
		var nAddRow = ds_bodyList.addRow();									
		ds_bodyList.setColumn(nAddRow, "MEAL", tMeal);
		ds_bodyList.setColumn(nAddRow, "MEAL_NAME", ds_grdPreviewList.getColumn(nRow, "MEAL_NAME"));
		ds_bodyList.setColumn(nAddRow, "CORNER", tCorner);
		//ds_bodyList.setColumn(nAddRow, "CORNER_NAME", ds_grdPreviewList.getColumn(nRow, "CORNER_NAME"));
		ds_bodyList.setColumn(nAddRow, "MAJOR_DISH_INFO", tMajorDishInfo);
		ds_bodyList.setColumn(nAddRow, "MAJOR_DISH_INFO_NAME", ds_grdPreviewList.getColumn(nRow, "MAJOR_DISH_INFO_NAME"));
		ds_bodyList.setColumn(nAddRow, "GUBUN", sGubun);
		ds_bodyList.setColumn(nAddRow, "RECIPE_CD", sRecipeCd);
		ds_bodyList.setColumn(nAddRow, "RECIPE_NAME", sRecipeName);
	}

	ds_grdPreviewList.setColumn(nRow, "GUBUN" + tCorner, sGubun);
	ds_grdPreviewList.setColumn(nRow, "RECIPE_CD" + tCorner, sRecipeCd);
	ds_grdPreviewList.setColumn(nRow, "RECIPE_NAME" + tCorner, sRecipeName);
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_init_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 식단미리보기 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function btn_init_onclick(obj:Button,  e:ClickEventInfo)
{
	ds_bodyList.clearData();
	ds_grdPreviewList.clearData();
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : Div00_btn_fullScreen_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 전체화면
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function Div00_btn_fullScreen_onclick(obj:Button,  e:ClickEventInfo)
{
    if (Div00.btn_fullScreen.text == "원래대로") 
    {
		Div00.bringToFront();
		Div00.position.top = "477px";
		Div00.btn_fullScreen.text = "전체화면";
    }
    else 
    {
		Div00.bringToPrev();
		Div00.position.top = "87px";
		Div00.btn_fullScreen.text = "원래대로";
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : cbo_hall_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
 * 기ㅡㅡㅡ능 : 식당변경시 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function cbo_hall_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	fn_search();
}]]></Script>
  </Form>
</FDL>

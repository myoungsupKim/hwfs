<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="SapSlipSendRept" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="SAP 전표 전송" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 711" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 711 1252 726" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="10" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30" tabstop="false"/>
        <Static id="Static58" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 98" anchor="left top right"/>
        <Static id="Static70" text="H10" visible="false" position="absolute 15 30 278 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static72" text="W15" visible="false" position="absolute 0 30 15 87" style="background:#ff000055;align:center middle;"/>
        <Grid id="grd_list" taborder="9" binddataset="ds_list" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 0 129 1237 711" anchor="all" autofittype="none" onheadclick="grd_list_onheadclick" style="border:1 solid #53606cff,1 solid #c3c3c3ff,1 solid #c3c3c3ff,1 solid #c3c3c3ff;" oncelldblclick="grd_list_oncelldblclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30"/>
                <Column size="40"/>
                <Column size="100"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="100"/>
                <Column size="40"/>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="180"/>
                <Column size="80"/>
                <Column size="70"/>
                <Column size="80"/>
                <Column size="300"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="180"/>
              </Columns>
              <Rows>
                <Row size="30" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox" edittype="checkbox" text="0"/>
                <Cell col="1" displaytype="normal" text="NO"/>
                <Cell col="2" text="사업부"/>
                <Cell col="3" text="팀"/>
                <Cell col="4" text="업장(CC)"/>
                <Cell col="5" text="전표번호"/>
                <Cell col="6" colspan="2" text="전표유형"/>
                <Cell col="8" text="전기일자"/>
                <Cell col="9" text="차변금액"/>
                <Cell col="10" text="대변금액"/>
                <Cell col="11" text="적요"/>
                <Cell col="12" text="결재상태"/>
                <Cell col="13" text="전송상태"/>
                <Cell col="14" text="전송일자"/>
                <Cell col="15" text="전송결과메세지"/>
                <Cell col="16" text="발행자사번"/>
                <Cell col="17" text="발행자"/>
                <Cell col="18" text="계산서번호"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="checkbox" style="align:center middle;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:chk"/>
                <Cell col="1" displaytype="number" style="align:right;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" expr="currow+1"/>
                <Cell col="2" style="align:left;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:muNm"/>
                <Cell col="3" style="align:left;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:tmNm"/>
                <Cell col="4" style="align:left;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:ccNm"/>
                <Cell col="5" style="align:center middle;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:slipNum"/>
                <Cell col="6" style="align:center middle;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:slipType"/>
                <Cell col="7" style="align:left;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:slipTypeNm"/>
                <Cell col="8" displaytype="text" style="align:center middle;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:slipPeriodDate" mask="####-##-##"/>
                <Cell col="9" displaytype="number" style="align:right middle;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:dAmt"/>
                <Cell col="10" displaytype="number" style="align:right middle;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:cAmt"/>
                <Cell col="11" style="align:left middle;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:remark"/>
                <Cell col="12" style="align:center middle;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:signProgressStatusNm"/>
                <Cell col="13" style="align:center middle;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:slipStatusNm"/>
                <Cell col="14" displaytype="text" style="align:center middle;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:procDate" mask="####-##-##"/>
                <Cell col="15" style="align:left middle;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:resultMsg"/>
                <Cell col="16" style="align:center middle;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:writeEmpSabun"/>
                <Cell col="17" style="align:center middle;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:writeEmpSabunNm"/>
                <Cell col="18" style="align:left middle;background:expr:fn_setBackground(slipStatus);background2:expr:fn_setBackground(slipStatus);" text="bind:taxShetNum"/>
              </Band>
              <Band id="summary">
                <Cell/>
                <Cell col="1"/>
                <Cell col="2"/>
                <Cell col="3"/>
                <Cell col="4"/>
                <Cell col="5"/>
                <Cell col="6"/>
                <Cell col="7"/>
                <Cell col="8"/>
                <Cell col="9" displaytype="number" expr="expr:getSum('dAmt')"/>
                <Cell col="10" displaytype="number" expr="expr:getSum('cAmt')"/>
                <Cell col="11"/>
                <Cell col="12"/>
                <Cell col="13"/>
                <Cell col="14"/>
                <Cell col="15"/>
                <Cell col="16"/>
                <Cell col="17"/>
                <Cell col="18"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static18" text="분개 내역" class="sta_WF_Title01" position="absolute 0 111 450 129" anchor="left top"/>
        <Static id="Static20" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 98 450 111" anchor="left top"/>
        <Static id="Static24" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 124 450 129" anchor="left top"/>
        <Button id="btn_sapSend" taborder="11" text="SAP전송" onclick="btn_sapSend_onclick" class="btn_WF_CRUD" position="absolute 1253 0 1318 25" anchor="left top" visible="false"/>
        <Static id="Static28" text="전기일자" class="sta_WFSA_label" position="absolute 261 66 323 87" anchor="left top" style="align:left middle;" onclick="Static28_onclick"/>
        <Static id="Static13" text="H10" visible="false" position="absolute 0 87 1221 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static12" text="전표유형" class="sta_WFSA_label" position="absolute 15 66 76 87" anchor="left top" style="align:left middle;"/>
        <Combo id="cbo_slipType" taborder="4" innerdataset="@ds_slipType" codecolumn="code" datacolumn="codeName" onitemchanged="cbo_slipType_onitemchanged" position="absolute 86 66 247 87" anchor="left top" displaynulltext="전체" index="-1"/>
        <Button id="btn_gwDraft" taborder="14" text="결재상신" onclick="btn_gwDraft_onclick" class="btn_WF_CRUD" position="absolute 515 0 585 25" anchor="left right"/>
        <Button id="btn_gwDetail" taborder="15" text="결재상세" onclick="btn_gwDetail_onclick" class="btn_WF_CRUD" position="absolute 587 0 657 25" anchor="left right"/>
        <ObjCalendar id="cal_slipPeriodDateFrom" titletext="캘린더" taborder="5" scrollbars="none" class="cal_WF_Essential" position="absolute 330 66 419 87"/>
        <ObjCalendar id="cal_slipPeriodDateTo" titletext="캘린더" taborder="6" scrollbars="none" class="cal_WF_Essential" position="absolute 430 66 519 87"/>
        <Static id="Static00" text="~" position="absolute 420 68 429 87"/>
        <Static id="Static57" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 76 40 86 61" anchor="left top"/>
        <Static id="Static01" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 593 65 603 86" anchor="left top"/>
        <Static id="Static46" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 247 40 262 87" anchor="left top"/>
        <Static id="Static03" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 519 66 534 87" anchor="left top"/>
        <Static id="Static04" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 750 40 780 61" anchor="left top"/>
        <Edit id="edt_tmCd" taborder="26" readonly="true" onkeydown="edt_tmNm_onkeydown" visible="false" position="absolute 407 725 617 746" anchor="left top right" tmCd=""/>
        <Edit id="edt_ccCd" taborder="27" readonly="true" autoselect="true" visible="false" position="absolute 717 725 927 746"/>
        <Edit id="edt_upjang" taborder="28" readonly="true" onkeydown="edt_upjangnm_onkeydown" visible="false" position="absolute 1027 725 1233 746" anchor="left top right" tmCd=""/>
        <Static id="Static02" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1215 805 1230 826" anchor="left top"/>
        <Static id="Static07" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 999 805 1009 826" anchor="left top"/>
        <Static id="Static05" class="Guide01_AreaRed" visible="false" position="absolute 939 805 999 826" anchor="left top" style="background:aqua;"/>
        <Edit id="edt_upjangnm" taborder="29" readonly="true" autoselect="true" onkeydown="edt_upjangnm_onkeydown" ontextchanged="edt_upjangnm_ontextchanged" visible="false" position="absolute 1009 805 1195 826" tmCd=""/>
        <Button id="btn_upjangCd" taborder="30" onclick="btn_upjangCd_onclick" class="btn_WF_popSearch" visible="false" position="absolute 1194 805 1215 826"/>
        <Static id="Static14" text="업장" class="sta_WFSA_label" visible="false" position="absolute 939 805 999 825" style="background:URL('theme://images/new/sta_WFSA_label.png') left middle;align:center middle;"/>
        <Static id="Static11" text="취소사유" class="sta_WFSA_label" position="absolute 534 66 595 87" anchor="left top" style="align:left middle;"/>
        <Edit id="edt_tmNm00" taborder="7" readonly="true" autoselect="true" position="absolute 603 66 785 87" tmCd=""/>
        <Static id="Static08" text="시스템구분" class="sta_WFSA_label" position="absolute 348 795 424 816" anchor="left top" style="align:center middle;" visible="false"/>
        <Combo id="cbo_sysClass" taborder="33" displaynulltext="선택" innerdataset="ds_sysClass" codecolumn="code" datacolumn="codeName" onitemchanged="cbo_sysClass_onitemchanged" class="cmb_WF_Essential" enable="false" position="absolute 430 795 640 816" anchor="left top" visible="false"/>
        <Static id="Static10" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 320 66 330 87" anchor="left top"/>
        <Button id="btn_fiscalSlipCancel" taborder="37" text="전표 I/F 취소" onclick="btn_fiscalSlipCancel_onclick" class="btn_WF_CRUD" position="absolute 756 0 851 25" anchor="left right"/>
        <Button id="btn_fiscalSlipCreate" taborder="38" text="전표 I/F 전송" onclick="btn_fiscalSlipCreate_onclick" class="btn_WF_CRUD" position="absolute 659 0 754 25" anchor="left right" enable="false"/>
        <Button id="btn_cancel" taborder="39" text="전표취소" onclick="btn_cancel_onclick" class="btn_WF_CRUD" position="absolute 391 0 461 25" anchor="left right"/>
        <MuSearchComponent id="MuSearchComponent01" titletext="사업부 선택 Component" taborder="0" text="MuSearchComponent00" class="cmb_WF_Essential" position="absolute 86 40 247 61" bindDataset="ds_search" bindMuCdColumn="muCd" appendText="선택" onItemChangedEvent="fn_muChanged"/>
        <TmSearchComponent id="TmSearchComponent01" titletext="팀 검색용 Component" taborder="1" text="TmSearchComponent00" position="absolute 330 40 519 61" bindDataset="ds_search" bindTmCdColumn="tmCd" bindTmNmColumn="tmNm" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tmChanged" eventBeforeTrigger="fn_tmBeforeEvent" isTeamControl="Y" class="edt_WF_Essential"/>
        <UpjangSearchComponent id="UpjangSearchComponent01" titletext="업장 검색용 Component" taborder="2" text="UpjangSearchComponent00" position="absolute 603 40 785 61" bindDataset="ds_search" bindUpjangCodeColumn="ccCd" bindUpjangNameColumn="ccNm" eventBeforeTrigger="fn_upjangBeforeEvent" eventAfterTrigger="" roleSetId=""/>
        <Static id="Static55" text="사업부" class="sta_WFSA_label" position="absolute 15 40 75 60" style="background:URL('theme://images/new/sta_WFSA_label.png') left middle;align:left middle;"/>
        <Static id="Static09" text="부서" class="sta_WFSA_label" position="absolute 261 39 313 60" anchor="left top"/>
        <Static id="Static15" text="CC" class="sta_WFSA_label" position="absolute 534 40 604 60" style="background:URL('theme://images/new/sta_WFSA_label.png') left middle;align:left middle;"/>
        <Button id="btn_report" taborder="40" text="출력" onclick="fn_report" class="btn_WF_CRUD" position="absolute 463 0 513 25" anchor="left right"/>
        <Static id="Static16" text="결재상태" class="sta_WFSA_label" position="absolute 801 40 862 61" anchor="left top" style="align:left middle;"/>
        <Static id="Static17" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 785 30 801 87" anchor="left top"/>
        <Static id="Static19" text="전송상태" class="sta_WFSA_label" position="absolute 801 66 862 87" anchor="left top" style="align:left middle;"/>
        <Static id="Static21" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 859 32 869 87" anchor="left top"/>
        <Combo id="cbo_signProgressStatus" taborder="3" displaynulltext="전체" innerdataset="@ds_signProgressStatus" codecolumn="code" datacolumn="codeName" onitemchanged="cbo_slipType_onitemchanged" position="absolute 869 40 971 61" anchor="left top" index="-1"/>
        <Static id="Static22" text="W15" visible="false" position="absolute 1221 30 1236 97" style="background:#ff000055;align:center middle;"/>
        <Combo id="cbo_slipStatus" taborder="8" displaynulltext="전체" innerdataset="@ds_slipStatus" codecolumn="code" datacolumn="codeName" onitemchanged="cbo_slipType_onitemchanged" position="absolute 869 66 971 87" anchor="left top" index="-1"/>
        <Static id="stc_taxInchargeId" text="발행자" class="sta_WFSA_label" position="absolute 981 40 1028 61" anchor="left top"/>
        <PersonalSearchComponent id="PersonalSearchComponent00" titletext="사원 검색용 Component" taborder="41" text="PersonalSearchComponent00" position="absolute 1131 40 1235 61" bindDataset="ds_search" bindSabunColumn="writeEmpSabun" bindNmKorColumn="writeEmpSabunNm" qoMuCd="" qoTmCd="" qoTmNm="" eventAfterTrigger="" eventBeforeTrigger="" qoCcCd="" qoCcNm=""/>
        <Static id="stc_taxShetNo" text="계산서번호" class="sta_WFSA_label" position="absolute 981 67 1072 88" anchor="left top"/>
        <Edit id="edt_taxShetNo" taborder="42" autoselect="true" position="absolute 1059 66 1235 87" tmCd=""/>
        <Edit id="edt_supplierInchargeId" taborder="43" readonly="true" ontextchanged="edt_supplierInchargeId_ontextchanged" position="absolute 1059 40 1132 61" anchor="left top"/>
        <Grid id="Grid00" taborder="44" useinputpanel="false" position="absolute 67 374 1207 653" binddataset="ds_list" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="chk"/>
                <Cell col="1" disptype="normal" text="slipNum"/>
                <Cell col="2" disptype="normal" text="slipType"/>
                <Cell col="3" disptype="normal" text="slipTypeNm"/>
                <Cell col="4" disptype="normal" text="slipEvidenceDate"/>
                <Cell col="5" disptype="normal" text="slipPeriodDate"/>
                <Cell col="6" disptype="normal" text="slipText"/>
                <Cell col="7" disptype="normal" text="writeEmpSabun"/>
                <Cell col="8" disptype="normal" text="sysCd"/>
                <Cell col="9" disptype="normal" text="sysNm"/>
                <Cell col="10" disptype="normal" text="elctnSignId"/>
                <Cell col="11" disptype="normal" text="slipStatus"/>
                <Cell col="12" disptype="normal" text="slipStatusNm"/>
                <Cell col="13" disptype="normal" text="signStatus"/>
                <Cell col="14" disptype="normal" text="signInstanceId"/>
                <Cell col="15" disptype="normal" text="signProgressStatus"/>
                <Cell col="16" disptype="normal" text="signProgressStatusNm"/>
                <Cell col="17" disptype="normal" text="remark"/>
                <Cell col="18" disptype="normal" text="fiscalSlipNum"/>
                <Cell col="19" disptype="normal" text="fiscalYear"/>
                <Cell col="20" disptype="normal" text="reverseSlipNum"/>
                <Cell col="21" disptype="normal" text="reverseSlipFiscalYear"/>
                <Cell col="22" disptype="normal" text="reverseSlipDate"/>
                <Cell col="23" disptype="normal" text="slipGrpNum"/>
                <Cell col="24" disptype="normal" text="signType"/>
                <Cell col="25" disptype="normal" text="urgentProcYn"/>
                <Cell col="26" disptype="normal" text="interfaceLogNum"/>
                <Cell col="27" disptype="normal" text="procDate"/>
                <Cell col="28" disptype="normal" text="resultMsg"/>
                <Cell col="29" disptype="normal" text="sapSendYn"/>
                <Cell col="30" disptype="normal" text="sapSlipNum"/>
                <Cell col="31" disptype="normal" text="sapSendTime"/>
                <Cell col="32" disptype="normal" text="slipClassCd"/>
                <Cell col="33" disptype="normal" text="slipPclsClassCd"/>
                <Cell col="34" disptype="normal" text="fileId"/>
                <Cell col="35" disptype="normal" text="dAmt"/>
                <Cell col="36" disptype="normal" text="cAmt"/>
                <Cell col="37" disptype="normal" text="muCd"/>
                <Cell col="38" disptype="normal" text="muNm"/>
                <Cell col="39" disptype="normal" text="tmCd"/>
                <Cell col="40" disptype="normal" text="tmNm"/>
                <Cell col="41" disptype="normal" text="ccCd"/>
                <Cell col="42" disptype="normal" text="ccNm"/>
                <Cell col="43" disptype="normal" text="slipCreationMm"/>
                <Cell col="44" disptype="normal" text="taxShetNum"/>
                <Cell col="45" disptype="normal" text="writeEmpSabunNm"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:chk"/>
                <Cell col="1" disptype="normal" text="bind:slipNum"/>
                <Cell col="2" disptype="normal" text="bind:slipType"/>
                <Cell col="3" disptype="normal" text="bind:slipTypeNm"/>
                <Cell col="4" disptype="normal" text="bind:slipEvidenceDate"/>
                <Cell col="5" disptype="normal" text="bind:slipPeriodDate"/>
                <Cell col="6" disptype="normal" text="bind:slipText"/>
                <Cell col="7" disptype="normal" text="bind:writeEmpSabun"/>
                <Cell col="8" disptype="normal" text="bind:sysCd"/>
                <Cell col="9" disptype="normal" text="bind:sysNm"/>
                <Cell col="10" disptype="normal" text="bind:elctnSignId"/>
                <Cell col="11" disptype="normal" text="bind:slipStatus"/>
                <Cell col="12" disptype="normal" text="bind:slipStatusNm"/>
                <Cell col="13" disptype="normal" text="bind:signStatus"/>
                <Cell col="14" disptype="normal" text="bind:signInstanceId"/>
                <Cell col="15" disptype="normal" text="bind:signProgressStatus"/>
                <Cell col="16" disptype="normal" text="bind:signProgressStatusNm"/>
                <Cell col="17" disptype="normal" text="bind:remark"/>
                <Cell col="18" disptype="normal" text="bind:fiscalSlipNum"/>
                <Cell col="19" disptype="normal" text="bind:fiscalYear"/>
                <Cell col="20" disptype="normal" text="bind:reverseSlipNum"/>
                <Cell col="21" disptype="normal" text="bind:reverseSlipFiscalYear"/>
                <Cell col="22" disptype="normal" text="bind:reverseSlipDate"/>
                <Cell col="23" disptype="normal" text="bind:slipGrpNum"/>
                <Cell col="24" disptype="normal" text="bind:signType"/>
                <Cell col="25" disptype="normal" text="bind:urgentProcYn"/>
                <Cell col="26" disptype="normal" text="bind:interfaceLogNum"/>
                <Cell col="27" disptype="normal" text="bind:procDate"/>
                <Cell col="28" disptype="normal" text="bind:resultMsg"/>
                <Cell col="29" disptype="normal" text="bind:sapSendYn"/>
                <Cell col="30" disptype="normal" text="bind:sapSlipNum"/>
                <Cell col="31" disptype="normal" text="bind:sapSendTime"/>
                <Cell col="32" disptype="normal" text="bind:slipClassCd"/>
                <Cell col="33" disptype="normal" text="bind:slipPclsClassCd"/>
                <Cell col="34" disptype="normal" text="bind:fileId"/>
                <Cell col="35" disptype="normal" text="bind:dAmt"/>
                <Cell col="36" disptype="normal" text="bind:cAmt"/>
                <Cell col="37" disptype="normal" text="bind:muCd"/>
                <Cell col="38" disptype="normal" text="bind:muNm"/>
                <Cell col="39" disptype="normal" text="bind:tmCd"/>
                <Cell col="40" disptype="normal" text="bind:tmNm"/>
                <Cell col="41" disptype="normal" text="bind:ccCd"/>
                <Cell col="42" disptype="normal" text="bind:ccNm"/>
                <Cell col="43" disptype="normal" text="bind:slipCreationMm"/>
                <Cell col="44" disptype="normal" text="bind:taxShetNum"/>
                <Cell col="45" disptype="normal" text="bind:writeEmpSabunNm"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <CheckBox id="chk_bonbu" taborder="45" text="본부전체조회" onclick="chk_0_OnClick" position="absolute 1144 106 1235 124" anchor="top right" style="color:blue;" userdata="007"/>
        <Edit id="Edit00" taborder="46" position="absolute 152 105 200 127" inputtype="digit"/>
        <Edit id="Edit01" taborder="47" position="absolute 224 105 272 127" inputtype="digit"/>
        <Static id="Static23" text=" ~" position="absolute 204 108 224 124"/>
        <Button id="Button00" taborder="48" text="범위선택" position="absolute 288 105 345 127" onclick="Button00_onclick"/>
        <Static id="Static25" text="NO :" class="sta_WFSA_label" position="absolute 108 107 168 127" style="background:URL('theme://images/new/sta_WFSA_label.png') left middle;align:left middle;"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item3" compid="cbo_slipType" propid="value" datasetid="ds_search" columnid="slipType"/>
      <BindItem id="item7" compid="cal_slipPeriodDateFrom" propid="text" datasetid="ds_search" columnid="slipPeriodDateFrom"/>
      <BindItem id="item8" compid="cal_slipPeriodDateTo" propid="text" datasetid="ds_search" columnid="slipPeriodDateTo"/>
      <BindItem id="item1" compid="edt_tmCd" propid="value" datasetid="ds_search" columnid="tmCd"/>
      <BindItem id="item5" compid="edt_ccCd" propid="value" datasetid="ds_search" columnid="ccCd"/>
      <BindItem id="item6" compid="edt_upjang" propid="value" datasetid="ds_search" columnid="upjangCd"/>
      <BindItem id="item9" compid="edt_upjangnm" propid="value" datasetid="ds_search" columnid="upjangNm"/>
      <BindItem id="item10" compid="cbo_sysClass" propid="value" datasetid="ds_search" columnid="sysClass"/>
      <BindItem id="item0" compid="cbo_signProgressStatus" propid="value" datasetid="ds_search" columnid="signProgressStatus"/>
      <BindItem id="item2" compid="cbo_slipStatus" propid="value" datasetid="ds_search" columnid="slipStatus"/>
      <BindItem id="item4" compid="edt_taxShetNo" propid="value" datasetid="ds_search" columnid="taxShetNo"/>
      <BindItem id="item11" compid="edt_supplierInchargeId" propid="value" datasetid="ds_search" columnid="writeEmpSabun"/>
    </Bind>
    <Objects>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">0</Col>
            <Col id="delYn">0</Col>
            <Col id="savYn">0</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">0</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="tmNm" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="slipPeriodDateFrom" type="STRING" size="256"/>
          <Column id="slipPeriodDateTo" type="STRING" size="256"/>
          <Column id="slipType" type="STRING" size="256"/>
          <Column id="signProgressStatus" type="STRING" size="256"/>
          <Column id="slipStatus" type="STRING" size="256"/>
          <Column id="writeEmpSabun" type="STRING" size="256"/>
          <Column id="writeEmpSabunNm" type="STRING" size="256"/>
          <Column id="taxShetNo" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_searchValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="slipPeriodDateFrom" type="STRING" size="256"/>
          <Column id="slipPeriodDateTo" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="muCd">title:사업부,required:true</Col>
            <Col id="tmCd">title:팀,required:false</Col>
            <Col id="slipPeriodDateFrom">title:회계시작일자,comparemin:slipPeriodDateTo:회계종료일자,required:true</Col>
            <Col id="slipPeriodDateTo">title:회계종료일자,comparemax:slipPeriodDateFrom:회계시작일자,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_list_onrowposchanged" canrowposchange="ds_list_canrowposchange">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="slipNum" type="STRING" size="256"/>
          <Column id="slipType" type="STRING" size="256"/>
          <Column id="slipTypeNm" type="STRING" size="256"/>
          <Column id="slipEvidenceDate" type="STRING" size="256"/>
          <Column id="slipPeriodDate" type="STRING" size="256"/>
          <Column id="slipText" type="STRING" size="256"/>
          <Column id="writeEmpSabun" type="STRING" size="256"/>
          <Column id="sysCd" type="STRING" size="256"/>
          <Column id="sysNm" type="STRING" size="256"/>
          <Column id="elctnSignId" type="STRING" size="256"/>
          <Column id="slipStatus" type="STRING" size="256"/>
          <Column id="slipStatusNm" type="STRING" size="256"/>
          <Column id="signStatus" type="STRING" size="256"/>
          <Column id="signInstanceId" type="INT" size="256"/>
          <Column id="signProgressStatus" type="STRING" size="256"/>
          <Column id="signProgressStatusNm" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="256"/>
          <Column id="fiscalSlipNum" type="STRING" size="256"/>
          <Column id="fiscalYear" type="STRING" size="256"/>
          <Column id="reverseSlipNum" type="STRING" size="256"/>
          <Column id="reverseSlipFiscalYear" type="STRING" size="256"/>
          <Column id="reverseSlipDate" type="STRING" size="256"/>
          <Column id="slipGrpNum" type="STRING" size="256"/>
          <Column id="signType" type="STRING" size="256"/>
          <Column id="urgentProcYn" type="STRING" size="256"/>
          <Column id="interfaceLogNum" type="STRING" size="256"/>
          <Column id="procDate" type="STRING" size="256"/>
          <Column id="resultMsg" type="STRING" size="256"/>
          <Column id="sapSendYn" type="STRING" size="256"/>
          <Column id="sapSlipNum" type="STRING" size="256"/>
          <Column id="sapSendTime" type="STRING" size="256"/>
          <Column id="slipClassCd" type="STRING" size="256"/>
          <Column id="slipPclsClassCd" type="STRING" size="256"/>
          <Column id="fileId" type="STRING" size="256"/>
          <Column id="dAmt" type="BIGDECIMAL" size="256"/>
          <Column id="cAmt" type="BIGDECIMAL" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="tmNm" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="slipCreationMm" type="STRING" size="256"/>
          <Column id="taxShetNum" type="STRING" size="256"/>
          <Column id="writeEmpSabunNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_muCd" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sapCancelList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_list_onrowposchanged" canrowposchange="ds_list_canrowposchange">
        <ColumnInfo>
          <Column id="slipNum" type="STRING" size="256"/>
          <Column id="buCd" type="STRING" size="256"/>
          <Column id="sysCd" type="STRING" size="256"/>
          <Column id="fiscalSlipNum" type="STRING" size="256"/>
          <Column id="fiscalYear" type="STRING" size="256"/>
          <Column id="cancelReason" type="STRING" size="256"/>
          <Column id="periodDate" type="STRING" size="256"/>
          <Column id="requestDate" type="STRING" size="256"/>
          <Column id="requestTime" type="STRING" size="256"/>
          <Column id="writeEmpNum" type="STRING" size="256"/>
          <Column id="writeEmpDept" type="STRING" size="256"/>
          <Column id="cancelReasonMemo" type="STRING" size="256"/>
          <Column id="interfaceLogNum" type="STRING" size="256"/>
          <Column id="msg" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_slipType" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="code">6A</Col>
            <Col id="codeName">6A:단체급식매출</Col>
          </Row>
          <Row>
            <Col id="code">6B</Col>
            <Col id="codeName">6B:식재영업매출</Col>
          </Row>
          <Row>
            <Col id="code">6C</Col>
            <Col id="codeName">6C:식재도매매출</Col>
          </Row>
          <Row>
            <Col id="code">6D</Col>
            <Col id="codeName">6D:외식사업매출</Col>
          </Row>
          <Row>
            <Col id="code">6H</Col>
            <Col id="codeName">6H:기타매출(POS외등)</Col>
          </Row>
          <Row>
            <Col id="code">7A</Col>
            <Col id="codeName">7A:입금처리</Col>
          </Row>
          <Row>
            <Col id="code">7B</Col>
            <Col id="codeName">7B:채권 이관</Col>
          </Row>
          <Row>
            <Col id="code">7C</Col>
            <Col id="codeName">7C:선수금발생 관리</Col>
          </Row>
          <Row>
            <Col id="code">7E</Col>
            <Col id="codeName">7E:선수금 이관</Col>
          </Row>
          <Row>
            <Col id="code">7F</Col>
            <Col id="codeName">7F:영업현금 가수금 대체</Col>
          </Row>
          <Row>
            <Col id="code">7H</Col>
            <Col id="codeName">7H:기타 가수금 대체</Col>
          </Row>
          <Row>
            <Col id="code">7I</Col>
            <Col id="codeName">7I:쿠폰(식권)판매/교환/소멸</Col>
          </Row>
          <Row>
            <Col id="code">7J</Col>
            <Col id="codeName">7J:상품권 청구</Col>
          </Row>
          <Row>
            <Col id="code">8A</Col>
            <Col id="codeName">8A:영업환불(영업미지급)</Col>
          </Row>
          <Row>
            <Col id="code">8B</Col>
            <Col id="codeName">8B:원가 이관(직원식대처리)</Col>
          </Row>
          <Row>
            <Col id="code">8C</Col>
            <Col id="codeName">8C:Helper</Col>
          </Row>
          <Row>
            <Col id="code">8D</Col>
            <Col id="codeName">8D:영업기타</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_sysClass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sapSlipCancelList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="slipNum" type="STRING" size="256"/>
          <Column id="buCd" type="STRING" size="256"/>
          <Column id="dtlNum" type="BIGDECIMAL" size="256"/>
          <Column id="slipType" type="STRING" size="256"/>
          <Column id="slipEvidenceDate" type="STRING" size="256"/>
          <Column id="slipPeriodDate" type="STRING" size="256"/>
          <Column id="masterAcct" type="STRING" size="256"/>
          <Column id="drCrClass" type="STRING" size="256"/>
          <Column id="nextBuCd" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="orderNum" type="STRING" size="256"/>
          <Column id="fnctPrvn" type="STRING" size="256"/>
          <Column id="plCenter" type="STRING" size="256"/>
          <Column id="minusPeriodYn" type="STRING" size="256"/>
          <Column id="slipCurrencyAmt" type="BIGDECIMAL" size="256"/>
          <Column id="lcalAmt" type="BIGDECIMAL" size="256"/>
          <Column id="supplyplceNum" type="STRING" size="256"/>
          <Column id="guestNum" type="STRING" size="256"/>
          <Column id="foSupplyplceNum" type="STRING" size="256"/>
          <Column id="foCustNm" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="inltYn" type="STRING" size="256"/>
          <Column id="itemText" type="STRING" size="256"/>
          <Column id="vatCd" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="stdAmt" type="BIGDECIMAL" size="256"/>
          <Column id="taxAmt" type="BIGDECIMAL" size="256"/>
          <Column id="quantity" type="BIGDECIMAL" size="256"/>
          <Column id="unit" type="STRING" size="256"/>
          <Column id="payerName" type="STRING" size="256"/>
          <Column id="expireCalBasisDate" type="STRING" size="256"/>
          <Column id="payMtod" type="STRING" size="256"/>
          <Column id="payCond" type="STRING" size="256"/>
          <Column id="payDfer" type="STRING" size="256"/>
          <Column id="payRef" type="STRING" size="256"/>
          <Column id="lcNum" type="STRING" size="256"/>
          <Column id="membNum" type="STRING" size="256"/>
          <Column id="realUser" type="STRING" size="256"/>
          <Column id="telNum" type="STRING" size="256"/>
          <Column id="useNoMan" type="STRING" size="256"/>
          <Column id="assignNum" type="STRING" size="256"/>
          <Column id="poNum" type="STRING" size="256"/>
          <Column id="attachDept" type="STRING" size="256"/>
          <Column id="mgmtDept" type="STRING" size="256"/>
          <Column id="mgmtArticle" type="STRING" size="256"/>
          <Column id="reasonCd" type="STRING" size="256"/>
          <Column id="crgleftClass" type="STRING" size="256"/>
          <Column id="singlePayYn" type="STRING" size="256"/>
          <Column id="tempCustNm" type="STRING" size="256"/>
          <Column id="bankAcctNo" type="STRING" size="256"/>
          <Column id="bankAcctOwnr" type="STRING" size="256"/>
          <Column id="bankCd" type="STRING" size="256"/>
          <Column id="coPaGuest" type="STRING" size="256"/>
          <Column id="coPaCcCd" type="STRING" size="256"/>
          <Column id="startDate" type="STRING" size="256"/>
          <Column id="endDate" type="STRING" size="256"/>
          <Column id="blDate" type="STRING" size="256"/>
          <Column id="assetNum" type="STRING" size="256"/>
          <Column id="assetLlevelNum" type="STRING" size="256"/>
          <Column id="mgmtGuest" type="STRING" size="256"/>
          <Column id="mgmtSupplyplce" type="STRING" size="256"/>
          <Column id="custRemark" type="STRING" size="256"/>
          <Column id="refDate" type="STRING" size="256"/>
          <Column id="lshipDate" type="STRING" size="256"/>
          <Column id="taxStdAmt" type="STRING" size="256"/>
          <Column id="mmAmt" type="BIGDECIMAL" size="256"/>
          <Column id="taxRate" type="STRING" size="256"/>
          <Column id="intRate" type="STRING" size="256"/>
          <Column id="guOfficeNum" type="STRING" size="256"/>
          <Column id="remark1" type="STRING" size="256"/>
          <Column id="remark2" type="STRING" size="256"/>
          <Column id="addr" type="STRING" size="256"/>
          <Column id="etc" type="STRING" size="256"/>
          <Column id="cardSrlNum" type="STRING" size="256"/>
          <Column id="cardInterfaceNum" type="STRING" size="256"/>
          <Column id="cardNum" type="STRING" size="256"/>
          <Column id="interfaceLogNum" type="STRING" size="256"/>
          <Column id="inputDate" type="STRING" size="256"/>
          <Column id="currency" type="STRING" size="256"/>
          <Column id="slipText" type="STRING" size="256"/>
          <Column id="writeEmpSabun" type="STRING" size="256"/>
          <Column id="sysCd" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="256"/>
          <Column id="fiscalYear" type="STRING" size="256"/>
          <Column id="signType" type="STRING" size="256"/>
          <Column id="signStatus" type="STRING" size="256"/>
          <Column id="slipStatus" type="STRING" size="256"/>
          <Column id="slipMon" type="STRING" size="256"/>
          <Column id="foSupplyplceNum" type="STRING" size="256"/>
          <Column id="foCustNm" type="STRING" size="256"/>
          <Column id="assignNum" type="STRING" size="256"/>
          <Column id="mgmtArticle" type="STRING" size="256"/>
          <Column id="reasonCd" type="STRING" size="256"/>
          <Column id="coPaGuest" type="STRING" size="256"/>
          <Column id="coPaCcCd" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="vatClass" type="BIGDECIMAL" size="256"/>
          <Column id="custCdOrg" type="STRING" size="256"/>
          <Column id="elctntaxBillApprvnum" type="STRING" size="256"/>
          <Column id="suspenseAltType" type="STRING" size="256"/>
          <Column id="taxShetNum" type="STRING" size="256"/>
          <Column id="slipUpjang" type="STRING" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="slipCreationMm" type="STRING" size="256"/>
          <Column id="ccCdOrg" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_signProgressStatus" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_slipStatus" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sapClose" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
    </Objects>
    <InitValue>
      <CheckBox id="chk_bonbu" userdata="007"/>
    </InitValue>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : SapSlipSendRept
  파 일 명 : SapSlipSendRept.xfdl
  기    능 : SAP 전표 전송

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.06.19   JUN   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "lib::SMCommon.xjs";	//영업회계 공통 스크립트

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();
var fv_objColInfo; 		//선수금대체데이터셋 컬럼정보
var v_ds_check = "";
var fv_attachList;  //상신 첨부 파일 목록 (json)
var fv_RefSeq;
var fv_retVal = "";
//var fv_option = {buttons:[{id:"btn_gwDraft", action:"draft"}, {id:"btn_gwDetail", action:"detail"}]}; //결재 관련 버튼 정의

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo){

	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
	
    
     // 본부장 권한 추가 작업 진행 
	if (g_AuthLevel >= "17")   
	{
		chk_bonbu.visible = true;
	} else {
		chk_bonbu.visible = false;
	}
    //본부장 권한 추가 작업 종료     
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init(){
	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	v_ds_check = "ds_list";

	//콤보조회
	fn_setCombo();
	
	//조회조건을 초기화한다.
	fn_clearSearch();
	
    //그룹웨어 연동 초기화
    SCGw.init (this);
    
	ds_search.setColumn(0, "writeEmpSabun", g_EmpNo);
	ds_search.setColumn(0, "writeEmpSabunNm", g_Name);
    //그룹웨어 연동 버튼을 설정
    //SCGw.setUserButton (this, fv_option, ds_list.getColumn(ds_list.rowposition, "signProgressStatus"));
    SCAuth.setUserButton(this, {buttons : [  {id:"btn_cancel", role:"src", ischange:false}
										,{id:"btn_report", role:"src", ischange:false}
                                        ,{id:"btn_gwDraft", role:"src", ischange:false}
                                        ,{id:"btn_gwDetail", role:"src", ischange:false}
                                        ,{id:"btn_fiscalSlipCreate", role:"src", ischange:false}
                                        ,{id:"btn_fiscalSlipCancel", role:"src", ischange:false}
                    ]});
                    
	TmSearchComponent01.applyAuthLevel(MuSearchComponent01);
	UpjangSearchComponent01.setForcedRoleSet("CostCenter");
	UpjangSearchComponent01.applyAuthLevel(TmSearchComponent01);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close(){	
	// v_ds_check 사용시 변경사항 체크
	if(gfn_length(v_ds_check) != 0){	
	
		// v_ds_check 설정기준 변경사항 체크
		if(gfn_isDataChange() == true){
			if(!gfn_confirm("confirm.before.movepage")) return false;	// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
		}
	}
	return true;
}

/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수-공통버튼)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search(){

	// 조회시 Validation Check
	if(!gfn_validCheck(ds_search, ds_searchValid, true)) return;
	//if(!fn_validCheck()) return;

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_list);

	//서비스 쿼리결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장
	fv_objColInfo = gfn_getDatasetInfo (ds_list);
	
	// 본부의 팀전체 조회 옵션 추가 2016.02.16
 	if(chk_bonbu.value == true &&  TmSearchComponent01.getTmCode() != "")  {
 		ds_search.setColumn(0, "tmCd", wrapQuote(gfn_subStr(TmSearchComponent01.getTmCode() ,0,3) ));
 	}

    gfn_transaction(this
					,"search"
					,"sm/srm/sapSlipSendRept/selectList.xdo"
					,"ds_search=ds_search:A"
					,"ds_list=ds_list"
					,""
					,"fn_callBack"
					,true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert(){}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete(){}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save(){}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print(){
	if(ds_list.rowcount > 0) fn_report();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help(){}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg){
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0){
        if (strSvcID == "saveSign") { //상신 후 결재정보 저장 시 오류가 난 경우
			for(var i=0; i<ds_list.rowcount; i++){
				if(ds_list.getColumn(i, "chk") == "1"){
					//alert("instance id=[" + instanceId + "]");
					ds_list.setColumn(i, "signInstanceId",      "");	//결재InstanceId 초기화
					ds_list.setColumn(i, "elctnSignId",      	"");	//결재InstanceId 초기화		
					ds_list.setColumn(i, "signProgressStatus",  "");	//결재진행상태를 초기화
				}
			}
        }
        return;
	}
	
    switch(strSvcID){

   		// 사업부Combo 조회
        case "searchMuCd" :
			fn_setSmSearchDataset("MU", false);
            break;  

   		// 전표유형Combo 조회
        case "cbo_slipType" :
			ds_slipType.insertRow(0);
			ds_slipType.setColumn(0, "code", "");
			ds_slipType.setColumn(0, "codeName", "전체");        
			cbo_slipType.index = 0;
            break;

   		// 결재진행상태Combo 조회
        case "cbo_signProgressStatus" :
			ds_signProgressStatus.insertRow(0);
			ds_signProgressStatus.setColumn(0, "code", "");
			ds_signProgressStatus.setColumn(0, "codeName", "전체");        
			var nRow = ds_signProgressStatus.addRow();
			ds_signProgressStatus.setColumn(nRow, "code", "written");
			ds_signProgressStatus.setColumn(nRow, "codeName", "서면결재");			
			cbo_signProgressStatus.index = 0;
            break;
            
   		// 전송상태Combo 조회
        case "cbo_slipStatus" :
			ds_slipStatus.insertRow(0);
			ds_slipStatus.setColumn(0, "code", "");
			ds_slipStatus.setColumn(0, "codeName", "전체");
			cbo_slipStatus.index = 0;
            break;
 
        //조회
        case "search" :
			if(ds_list.getRowCount() == 0){ //서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				gfn_loadDatasetInfo (ds_list, fv_objColInfo);
			}
            break;

        // 저장
        case "save" :
            gfn_alert("msg.save.success");  // 저장 되었습니다.
            fn_search();
            break;
            
        // 전자결재정보 저장
        case "saveSign" :
            gfn_alert("msg.save.sign.success"); // 저장 되었습니다.
			fn_search();
            break;   
        
        //전표 I/F 전송
        case "saveSapIfcSlip" :
			gfn_alert("전표 I/F 전송이 정상적으로 처리 되었습니다.");
			fn_search();
            break;   

		//전표 I/F 취소
        case "saveSapIfcCancelSlip" :
			gfn_alert("전표 I/F 취소가 정상적으로 처리 되었습니다.");
			fn_search();
            break; 
            
		//전표생성취소 
		case "cancel" :
		
			var arrRetVal  = fv_retVal.split("|");
			
			//성공
			if(arrRetVal[0] == "TRUE"){
				gfn_alert("생성된 전표가 취소되었습니다.");
				fn_search();
				
			//실패
			}else{
				gfn_alert("["+arrRetVal[0]+"] "+arrRetVal[1]);
			}
			break;
    }
    
    //그룹웨어 연동 버튼을 설정
    //SCGw.setUserButton (this, fv_option, ds_list.getColumn(ds_list.rowposition, "signProgressStatus"));
}

/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 콤보/팝업조회
 *---------------------------------------------------------------------------------------------*/
function fn_setCombo(){

	// 조회:결재상태
    gfn_transaction(this
					,"cbo_signProgressStatus"
					,"sm/cmn/common/selectComCode.xdo"
					,""
					,"ds_signProgressStatus=ds_combo"
					,"groupCode=SIGN_PROGRESS_STATUS useYn=Y"
					,"fn_callBack"
					,true);	
						
	// 조회:전송상태
    gfn_transaction(this
					,"cbo_slipStatus"
					,"sm/cmn/common/selectComCode.xdo"
					,""
					,"ds_slipStatus=ds_combo"
					,"groupCode=SLIP_STATUS useYn=Y"
					,"fn_callBack"
					,true);			
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조회조건 초기화
 *---------------------------------------------------------------------------------------------*/
function fn_clearSearch(){
	var nRow= ds_search.addRow();
    ds_search.setColumn(nRow, "muCd",			g_Mu_Cd);
    ds_search.setColumn(nRow, "muNm",           g_Mu_Nm);
    ds_search.setColumn(nRow, "tmCd",           g_Tm_Cd);
    ds_search.setColumn(nRow, "tmNm",           g_Tm_Nm);
    ds_search.setColumn(nRow, "ccCd",           g_Cc_Cd);
    ds_search.setColumn(nRow, "ccNm",           g_Cc_Nm);

	cal_slipPeriodDateFrom.fn_initMonthCal(this, gfn_addDate(fv_sToday, -30), null, ds_search, "slipPeriodDateFrom", "Y");
	cal_slipPeriodDateTo.fn_initMonthCal(this, fv_sToday, null, ds_search, "slipPeriodDateTo");
	
	gfn_setSlipTypeByMuCd(this, "cbo_slipType", "ds_slipType", MuSearchComponent01.getMuCode());	//cbo_muCd.value);

	//조회조건 헤더생성
	//gds_SmSearch.clearData();
	//gds_SmSearch.addRow();

	// 본사FC회계팀 소속의 사용자와 관리자, 전산관리자 권한은 부서필수 제외
	if( g_Cc_Cd == "100540")
	{
		TmSearchComponent01.edt_tmNm.class = "";
		TmSearchComponent01.btn_search.class = "btn_WF_popSearch";
		ds_searchValid.setColumn(0, "tmCd", "title:팀,required:false");
	}

}

/*----------------------------------------------------------------------------------------------
 * 사업부콤보조회
 *---------------------------------------------------------------------------------------------*/
function fn_setMuCd(){
	
	//사업부 com.hwfs.sm.cmn.dao.CommonDAO.selectMuCd
    gfn_transaction(this
					,"searchMuCd"
					,"sm/cmn/common/selectMuCd.xdo"
					,""
					,"ds_muCd=ds_combo"
					,""
					,"fn_callBack"
					,true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조회시 Validation Check
 *---------------------------------------------------------------------------------------------*/
function fn_validCheck(){
/*
	if (gfn_isNull(cbo_muCd.text)){
		gfn_alert("msg.noselect", "사업부");	// $1 을(를) 선택해 주십시요.
		cbo_muCd.setFocus();
		return false;
	}
	if (gfn_isNull(edt_tmNm.value)){
		gfn_alert("msg.noselect", "팀");	// $1 을(를) 선택해 주십시요.
		edt_tmNm.setFocus();
		return false;
	}
*/
/*
	if (gfn_isNull(cbo_slipType.value)){
		gfn_alert("msg.noselect", "전표유형");	// $1 을(를) 선택해 주십시요.
		cbo_slipType.setFocus();
		return false;
	}
*/
	if (gfn_isNull(cal_slipPeriodDateFrom.text)){
		gfn_alert("msg.noinput", "회계시작일자");	// $1 을(를) 입력해 주십시요.
		cal_slipPeriodDateFrom.setFocus();
		return false;
	}
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 입력값 데이터셋 저장(BIND)
 *---------------------------------------------------------------------------------------------*/
function fn_setSmSearchDataset(arg, initYn){

	if(initYn == true){
		//사업부 변경
		if(arg == "MU"){
			edt_tmCd.value		= "";
			edt_tmNm.value		= "";
			edt_ccCd.value		= "";
			edt_ccNm.value		= "";
			edt_upjang.value	= "";
			edt_upjangnm.value	= "";

		//팀 변경	
		}else if(arg == "TM"){
			edt_ccCd.value		= "";
			edt_ccNm.value		= "";
			edt_upjang.value	= "";
			edt_upjangnm.value	= "";
			
		//CC 변경	
		}else if(arg == "CC"){
			edt_upjang.value	= "";
			edt_upjangnm.value	= "";
		}
	}
	gds_SmSearch.setColumn(0, "muCd",		cbo_muCd.value);
	gds_SmSearch.setColumn(0, "muNm",		cbo_muCd.text);
	gds_SmSearch.setColumn(0, "tmCd",		edt_tmCd.value);
	gds_SmSearch.setColumn(0, "tmNm",		edt_tmNm.value);
	gds_SmSearch.setColumn(0, "ccCd",		edt_ccCd.value);
	gds_SmSearch.setColumn(0, "ccNm",		edt_ccNm.value);
	gds_SmSearch.setColumn(0, "upjang",		edt_upjang.value);
	gds_SmSearch.setColumn(0, "upjangnm",	edt_upjangnm.value);
	gds_SmSearch.setColumn(0, "inputVal",	"");
}

/*----------------------------------------------------------------------------------------------
 * 팝업창 호출
 *---------------------------------------------------------------------------------------------*/
 function fn_openPopup(arg){
	var sUrl = "";
	
	if(arg == "TM")				sUrl = "cmn::SmTmSearchPop.xfdl";
	else if(arg == "CC")		sUrl = "cmn::SmCcSearchPop.xfdl";
	else if(arg == "UPJANG")	sUrl = "cmn::SmUpjangSearchPop.xfdl";

	if(arg == "TM"){
		gds_SmSearch.setColumn(0, "inputVal", 	gds_SmSearch.getColumn(0, "tmNm"));
	}else if(arg == "CC"){
		gds_SmSearch.setColumn(0, "inputVal", 	gds_SmSearch.getColumn(0, "ccNm"));
	}else if(arg == "UPJANG"){
		gds_SmSearch.setColumn(0, "inputVal", 	gds_SmSearch.getColumn(0, "upjangnm"));
	}
	
	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog( arg, sUrl, null, 500, 500, "", -1, -1, false, true, "-1");
	
	if (arrRtn instanceof Object){
	
		//팀
		if(arg == "TM"){
			cbo_muCd.value = arrRtn.muCd;
			edt_tmCd.value = arrRtn.tmCd;
			edt_tmNm.value = arrRtn.tmNm;

		//CC
		}else if(arg == "CC"){
			cbo_muCd.value = arrRtn.muCd;
			edt_tmCd.value = arrRtn.tmCd;
			edt_tmNm.value = arrRtn.tmNm;
			edt_ccCd.value = arrRtn.ccCd;
			edt_ccNm.value = arrRtn.ccNm;
		
		//업장
		}else if(arg == "UPJANG"){
			cbo_muCd.value		= arrRtn.muCd;
			edt_tmCd.value		= arrRtn.tmCd;
			edt_tmNm.value		= arrRtn.tmNm;
			edt_ccCd.value		= arrRtn.ccCd;
			edt_ccNm.value		= arrRtn.ccNm;
			edt_upjang.value	= arrRtn.upjang;
			edt_upjangnm.value	= arrRtn.upjangnm;
		}
		fn_setSmSearchDataset(arg, true);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 전자결재 상신에 첨부할 파일 목록 조회 (옵션-결재상신 전 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_searchSignAttachList(){
    gfn_transaction(this
					,"searchSignAttachList"
					,"sm/srm/sapSlipSendRept/selectGwSilpAttachFile.xdo"
					,""
					,""
					,"refSeq=" + wrapQuote(!gfn_isNull(ds_list.getColumn(ds_list.rowposition, "fileId")) ? ds_list.getColumn(ds_list.rowposition, "fileId") : "")
					,"fn_callBack"
					,false);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 전자결재정보를 저장 (옵션-결재상신 처리 후 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_saveSign(){
    gfn_transaction(this
					,"saveSign"
					,"sm/srm/sapSlipSendRept/saveSignInfo.xdo"
					,"ds_list=ds_list:U"	//결재정보가 있는 데이터셋
					,""
					,""
					,"fn_callBack"
					,true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 그룹웨어 상신 처리 후 반환되는 Instance Id를 처리한다. (업무 테이블에 update)
 *---------------------------------------------------------------------------------------------*/
function scgw_ondraftnotify(instanceId){
    for(var i=0; i<ds_list.rowcount; i++){
        if(ds_list.getColumn(i, "chk") == "1"){
            ds_list.setColumn(i, "signInstanceId",      instanceId);            //결재InstanceId 설정
            ds_list.setColumn(i, "elctnSignId",      	instanceId);            //결재InstanceId 설정
            ds_list.setColumn(i, "signProgressStatus",  SCGw.GW_DRAFT_STATUS);  //결재진행상태를 상신으로 설정
        }
    }
    
    //결재정보 저장
    fn_saveSign();
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 전표상태별 버튼 활성/비활성
 *---------------------------------------------------------------------------------------------*/
function fn_buttonControl(nRow){
	
	//전표생성
	if(ds_list.getColumn(nRow, "slipStatus") == "J"){
		
		// btn_cancel.enable = true; 2016.03.03 전표 자동 전송으로 프로세스 변경
		// 전표 생성 상태인 경우 미상신/반려일 때만 전표 취소 가능
		if(gfn_isNull(ds_list.getColumn(nRow, "signProgressStatus")) || ds_list.getColumn(nRow, "signProgressStatus") == "REJECT"  || ds_list.getColumn(nRow, "signProgressStatus") == "CANCEL"){
			btn_cancel.enable = true;
		} else {
			btn_cancel.enable = false;
		}
		
		
		btn_fiscalSlipCreate.enable = false;
		btn_fiscalSlipCancel.enable = false;
		
		//slipType = 7D:대손처리, 7G:채권채무상계는 결재없이 진행
		if(ds_list.getColumn(nRow, "slipType") == "7D"){
			btn_gwDraft.enable 	= false;		
			btn_gwDetail.enable = false;
			btn_report.enable = true;
			btn_fiscalSlipCreate.enable = true; //2016.03.03 전표 자동 전송으로 기능 제거
			//btn_fiscalSlipCreate.enable = false;
		}else{
			if(gfn_isNull(ds_list.getColumn(nRow, "signProgressStatus"))){
				btn_gwDraft.enable = true;
				btn_gwDetail.enable = false;
				btn_report.enable = false;
			}else{
				btn_gwDraft.enable = false;
				btn_gwDetail.enable = true;
				btn_report.enable = false;
			}
			
			if(ds_list.getColumn(nRow, "signProgressStatus") == "COMPLETE"){
				//btn_fiscalSlipCreate.enable = true; 2016.03.03 전표 자동 전송으로 기능 제거
				btn_fiscalSlipCreate.enable = false;
			}else{
				btn_fiscalSlipCreate.enable = false;
				if(ds_list.getColumn(nRow, "signProgressStatus") == "APPROVE" || ds_list.getColumn(nRow, "signProgressStatus") == "DRAFT"){
					btn_gwDraft.enable = false;
				}else{
					btn_gwDraft.enable = true;
				}
			}
		}
		
	//전표요청	
	}else if(ds_list.getColumn(nRow, "slipStatus") == "A"){
		//slipType = 7D:대손처리, 7G:채권채무상계는 결재없이 진행
		if(ds_list.getColumn(nRow, "slipType") == "7D"){
			btn_cancel.enable = false;
			btn_gwDraft.enable = false;
			btn_gwDetail.enable = false;
			btn_report.enable = false;
			btn_fiscalSlipCreate.enable = false;
			btn_fiscalSlipCancel.enable = false;
		}else{
			btn_cancel.enable = false;
			btn_gwDraft.enable = false;
			btn_gwDetail.enable = true;
			btn_report.enable = false;
			btn_fiscalSlipCreate.enable = false;
			btn_fiscalSlipCancel.enable = false;
		}

	//전표확정	
	}else if(ds_list.getColumn(nRow, "slipStatus") == "P" || ds_list.getColumn(nRow, "slipStatus") == "V"){
		//slipType = 7D:대손처리, 7G:채권채무상계는 결재없이 진행
		if(ds_list.getColumn(nRow, "slipType") == "7D"){
			btn_cancel.enable = false;
			btn_gwDraft.enable = false;
			btn_gwDetail.enable = false;
			btn_report.enable = false;
			btn_fiscalSlipCreate.enable = false;
			btn_fiscalSlipCancel.enable = true;
		}else{
			btn_cancel.enable = false;
			btn_gwDraft.enable = false;
			btn_gwDetail.enable = true;
			btn_report.enable = false;
			btn_fiscalSlipCreate.enable = false;
			btn_fiscalSlipCancel.enable = true;
		}
		
	//역분개/생성취소/에러
	}else if(ds_list.getColumn(nRow, "slipStatus") == "R"){
		//slipType = 7D:대손처리, 7G:채권채무상계는 결재없이 진행
		if(ds_list.getColumn(nRow, "slipType") == "7D"){
			btn_cancel.enable = false;
			btn_gwDraft.enable = false;
			btn_gwDetail.enable = false;
			btn_report.enable = false;
			btn_fiscalSlipCreate.enable = false;
			btn_fiscalSlipCancel.enable = false;
		}else{
			btn_cancel.enable = false;
			btn_gwDraft.enable = false;
			btn_gwDetail.enable = true;
			btn_report.enable = false;
			btn_fiscalSlipCreate.enable = false;
			btn_fiscalSlipCancel.enable = false;
		}	
		
	}else if(ds_list.getColumn(nRow, "slipStatus") == "Z" || ds_list.getColumn(nRow, "slipStatus") == "E" || ds_list.getColumn(nRow, "slipStatus") == "C"){
		//slipType = 7D:대손처리, 7G:채권채무상계는 결재없이 진행
		if(ds_list.getColumn(nRow, "slipType") == "7D"){
			btn_cancel.enable = true;
			btn_gwDraft.enable = false;
			btn_gwDetail.enable = false;
			btn_report.enable = false;
			btn_fiscalSlipCreate.enable = false;
			btn_fiscalSlipCancel.enable = false;
		}else{
			btn_cancel.enable = true;
			btn_gwDraft.enable = false;
			btn_gwDetail.enable = true;
			btn_report.enable = false;
			btn_fiscalSlipCreate.enable = false;
			btn_fiscalSlipCancel.enable = false;
		}	
		
	}else{
		btn_cancel.enable = false;
		btn_gwDraft.enable = false;
		btn_gwDetail.enable = false;
		btn_report.enable = false;
		btn_fiscalSlipCancel.enable = false;
		btn_fiscalSlipCancel.enable = false;
	}
	btn_report.enable = true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 그리드의 색상 변화
 *---------------------------------------------------------------------------------------------*/
function fn_setBackground(arg){

	//전표확정/임시전표
	if(arg == "P" || arg == "V"){
		return "#eeffee";	//"paleturquoise";	//#3a77a2ff
		
	//에러/임시전표취소/전표생성취소	
	}else if(arg == "E" || arg == "C" || arg == "Z"){
		return "#ffeeee";	//"lightpink";	//#af5f5fff
	
	//역분개
	}else if(arg == "R"){
		return "#ecececff";
		
	//A:전표요청,B:취소요청,J:전표생성
	}else{
		return "#ffffff";
		
	}
}

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 사업부 변경 EVENT
 *---------------------------------------------------------------------------------------------*/
function cbo_muCd_onitemchanged(obj:Combo, e:ItemChangeEventInfo){
	fn_setSmSearchDataset("MU", true);
	ds_slipType.clearData();
	ds_sysClass.clearData();
	gfn_setSlipTypeByMuCd(this, "cbo_slipType", "ds_slipType", cbo_muCd.value);
}

/*----------------------------------------------------------------------------------------------
 * 전표유형 변경 EVENT
 *---------------------------------------------------------------------------------------------*/
function cbo_slipType_onitemchanged(obj:Combo, e:ItemChangeEventInfo){
	ds_sysClass.clearData();
	
	if( cbo_slipType.value == "6A" || cbo_slipType.value == "6B" || cbo_slipType.value == "6C" ||
		cbo_slipType.value == "6D" || cbo_slipType.value == "6E" || cbo_slipType.value == "6F" ||
		cbo_slipType.value == "6G" || cbo_slipType.value == "6H"){
		cbo_sysClass.enable = true;
		gfn_setSysClassBySlipType(this, "cbo_sysClass", "ds_sysClass", cbo_slipType.value);
	}else{
		cbo_sysClass.enable = false;
	}
}

/*----------------------------------------------------------------------------------------------
 * 팀 팝업버튼 클릭 EVENT
 *---------------------------------------------------------------------------------------------*/
function btn_tmCd_onclick(obj:Button,  e:ClickEventInfo){
	fn_openPopup("TM");
}

/*----------------------------------------------------------------------------------------------
 * 팀 keydown EVENT
 *---------------------------------------------------------------------------------------------*/
function edt_tmNm_onkeydown(obj:Edit, e:KeyEventInfo){
	if(e.keycode == 13){		//Enter 키
		//if(!gfn_isNull(edt_tmNm.value)) parent.fn_search();
	}else if(e.keycode == 46){	//Del 키
		fn_setSmSearchDataset("MU", true);
	}
}

/*----------------------------------------------------------------------------------------------
 * 팀 변경 EVENT
 *---------------------------------------------------------------------------------------------*/
function edt_tmNm_ontextchanged(obj:Edit,  e:TextChangedEventInfo){
	fn_setSmSearchDataset("TM", true);
}

/*----------------------------------------------------------------------------------------------
 * CC 팝업버튼 클릭 EVENT
 *---------------------------------------------------------------------------------------------*/
function btn_ccCd_onclick(obj:Button,  e:ClickEventInfo){
	fn_openPopup("CC");
}

/*----------------------------------------------------------------------------------------------
 * CC keydown EVENT
 *---------------------------------------------------------------------------------------------*/
function edt_ccNm_onkeydown(obj:Edit, e:KeyEventInfo){
	if(e.keycode == 13){		//Enter 키
		//if(!gfn_isNull(edt_ccNm.value)) parent.fn_search();
	}else if(e.keycode == 46){	//Del 키
		fn_setSmSearchDataset("TM", true);
	}
}

/*----------------------------------------------------------------------------------------------
 * CC 변경 EVENT
 *---------------------------------------------------------------------------------------------*/
function edt_ccNm_ontextchanged(obj:Edit,  e:TextChangedEventInfo){
	fn_setSmSearchDataset("CC", true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 그룹웨어 상신 버튼 클릭 시 상신 팝업을 호출한다.
 *---------------------------------------------------------------------------------------------*/
function btn_gwDraft_onclick(obj:Button,  e:ClickEventInfo){

	var arrSlipNum = new Array();	//전표번호
	var cnt = 0;
    
    for(var i=0; i<ds_list.rowcount; i++){
		if(ds_list.getColumn(i, "chk") == "1"){
			if(!gfn_isNull(ds_list.getColumn(i, "signProgressStatus"))){
				alert(i+1 + " 번째 전표는 이미 결재 상신된 데이터입니다.");
				return;
			}
			else
			{
				// sap 월마감 체크
				var muCd = ds_list.getColumn(i, "muCd");
				var ccCd = ds_list.getColumn(i, "ccCd");
				var year = ds_list.getColumn(i, "slipPeriodDate").substr(0, 4);
				var mm = ds_list.getColumn(i, "slipPeriodDate").substr(4, 2);

				if( !fn_sapCloseChk(muCd, ccCd, year, mm) )	return;
			}

			arrSlipNum[cnt] = ds_list.getColumn(i, "slipNum");
			cnt++;
		}
    }

	if(cnt == 0){
		gfn_alert("결재상신 데이터가 없습니다.");
		return;
	}

    //첨부파일 목록을 얻는다. - 업무에 맞게 처리
    fn_searchSignAttachList();
    //alert("fv_attachList:"+fv_attachList);

    //그룹웨어에 전달할 파라메터 생성
    var arrParams = SCGw.newParams();

    //(필수) 결재문서 서비스명 - 문서양식별로 설정된 서비스명 설정
    SCGw.setParams (arrParams, SCGw.GW_SERVICE_NAME, "HWRC_FC_SLA_GR_REQ");

    //(필수) 본문 URL : (주의) .do로 호출해야 하며 GET 방식으로 파라미터를 전달 (id라는 key는 사용 불가)
    var sBodyUrl = "/sm/srm/sapSlipSendRept/makeGwDraftContent.do?slipNum="+arrSlipNum;

    SCGw.setParams(arrParams, SCGw.GW_BODY_URL, sBodyUrl);

    //(필수) 본문 제목 – 문서양식 별로 설정된 업무명
    SCGw.setParams(arrParams, SCGw.GW_BODY_TITLE, "SAP 전표");

    //(필수)문서 방향 : 가로 또는 세로 방향 (GW_VERTICAL, GW_HORIZONTAL)
    SCGw.setParams(arrParams, SCGw.GW_PORTRAIT, SCGw.GW_VERTICAL);

    //(선택)첨부문서 목록 : json 형태 문자열
    SCGw.setParams(arrParams, SCGw.GW_ATTACH_LIST, fv_attachList);

    //그룹웨어 상신 팝업을 호출한다.
    SCGw.sendDraft(this, arrParams);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 그룹웨어 결재상세 버튼 클릭 시 결재상세 팝업을 호출한다.
 *---------------------------------------------------------------------------------------------*/
function btn_gwDetail_onclick(obj:Button,  e:ClickEventInfo){
    //그룹웨어 결재상세 팝업을 호출한다.
    SCGw.sendDetailView(this, ds_list.getColumn(ds_list.rowposition, "signInstanceId"));
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 회계전표 IF 버튼 클릭시
 *---------------------------------------------------------------------------------------------*/
function btn_fiscalSlipCreate_onclick(obj:Button,  e:ClickEventInfo){

	// 2016.03.03 자동 전송 배치 생성에 따른 기능 비활성화
	gfn_alert("전표 I/F 전송 기능은 전자결재 완료 후 시스템에서 자동으로 수행됩니다.");	
	return;
	
	/*
     
	//v_ds_check 미사용시 변경사항 체크
 	if(!gfn_dsIsUpdated(ds_list)){
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}
	
	var chkCnt = ds_list.findRow("chk",'1');
	
	//체크된 항목이 하나도 없으면 경고를 한다.
	if(chkCnt<0){
		gfn_alert("msg.noselect","체크박스");
		return;
	}

	for(var i=0; i<ds_list.rowcount; i++){

		if(ds_list.getColumn(i, "chk") == "1"){
			
			//slipType = 7D:대손처리, 7G:채권채무상계는 결재없이 진행
			if(ds_list.getColumn(i, "slipType") == "7D"){
				if(ds_list.getColumn(i, "slipStatus") != "J"){
					if(ds_list.getColumn(i, "slipStatus") == "P" || ds_list.getColumn(i, "slipStatus") == "V"){
						gfn_alert("ft.gds.alert.slip.reg2");	//전표가 생성되어 있습니다. 전표 I/F취소후 진행하세요.
						ds_list.rowposition = i;
						return;
					}else if(ds_list.getColumn(i, "slipStatus") == "A"){
						gfn_alert("전표요청 중인 전표는 전송할 수 없습니다.");
						ds_list.rowposition = i;
						return;
					}else if(ds_list.getColumn(i, "slipStatus") == "R"){
						gfn_alert("역분개 상태인 전표는 전송할 수 없습니다.");
						ds_list.rowposition = i;
						return;
					}else if(ds_list.getColumn(i, "slipStatus") == "Z"){
						gfn_alert("생성취소된 전표는 전송할 수 없습니다.");
						ds_list.rowposition = i;
						return;
					}else{
						gfn_alert("ft.gds.alert.slip.reg");	//전표가 등록되어 있습니다. 삭제 후 진행하세요.
						ds_list.rowposition = i;
						return;
					}
				}
			}else{
				if(ds_list.getColumn(i, "slipStatus") != "J"){
					if(ds_list.getColumn(i, "slipStatus") == "P" || ds_list.getColumn(i, "slipStatus") == "V"){
						gfn_alert("ft.gds.alert.slip.reg2");	//전표가 생성되어 있습니다. 전표 I/F취소후 진행하세요.
						ds_list.rowposition = i;
						return;
					}else if(ds_list.getColumn(i, "slipStatus") == "A"){
						gfn_alert("전표요청 중인 전표는 전송할 수 없습니다.");
						ds_list.rowposition = i;
						return;
					}else if(ds_list.getColumn(i, "slipStatus") == "R"){
						gfn_alert("역분개 상태인 전표는 전송할 수 없습니다.");
						ds_list.rowposition = i;
						return;
					}else if(ds_list.getColumn(i, "slipStatus") == "Z"){
						gfn_alert("생성취소된 전표는 전송할 수 없습니다.");
						ds_list.rowposition = i;
						return;
					}else{
						gfn_alert("ft.gds.alert.slip.reg");	//전표가 등록되어 있습니다. 삭제 후 진행하세요.
						ds_list.rowposition = i;
						return;
					}
				}
				if(ds_list.getColumn(i, "signProgressStatus") != "COMPLETE"){
					gfn_alert("결재완료 상태인 전표만 전송할 수 있습니다.");
					ds_list.rowposition = i;
					return;
				}
			}
		}
	}

	if(!gfn_confirm("ft.gds.confirm.before.if", " ")) return;  // 전표 I/F하시겠습니까?
	
    gfn_transaction(this
					,"saveSapIfcSlip"
					,"sm/srm/sapSlipSendRept/saveSapIfcSlip.xdo"
					,"ds_list=ds_list:U"
					,""
					,""
					,"fn_callBack"
					,true);
    */	
 
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 회계전표 IF 취소 버튼 클릭시
 *---------------------------------------------------------------------------------------------*/
function btn_fiscalSlipCancel_onclick(obj:Button,  e:ClickEventInfo){
	//v_ds_check 미사용시 변경사항 체크
 	if(!gfn_dsIsUpdated(ds_list)){
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	} 

	var chkCnt = ds_list.findRow("chk","1");
	
	//체크된 항목이 하나도 없으면 경고를 한다.
	if(chkCnt<0){
		gfn_alert("msg.noselect","체크박스");
		return;
	}
	
	var nRow = 0;
	ds_sapCancelList.clearData();
	for(var i=0; i<ds_list.rowcount; i++){
		//if(ds_list.getRowType(i) == Dataset.ROWTYPE_UPDATE){
		if(ds_list.getColumn(i, "chk") == "1"){
			if(ds_list.getColumn(i, "slipStatus") !=  "P" && ds_list.getColumn(i, "slipStatus") !=  "V"){	//전표 생성일때만 취소가능
				gfn_alert("전표 I/F 취소대상이 아닙니다. 체크박스를 확인하세요.");
				ds_list.rowposition = i;
				return;
			}
		}
		var vCancelReason = "";
		if (ds_list.getColumn(i, "slipStatus") ==  "P"){
			vCancelReason = "1";
		}else{
			vCancelReason = "0";
		}
		
		if(ds_list.getColumn(i, "chk") == "1"){
			nRow = ds_sapCancelList.addRow();
			ds_sapCancelList.setColumn(nRow,"slipNum"          ,ds_list.getColumn(i,"slipNum"));
			ds_sapCancelList.setColumn(nRow,"buCd"             ,"2000");
			ds_sapCancelList.setColumn(nRow,"sysCd"            ,ds_list.getColumn(i,"sysCd"));
			ds_sapCancelList.setColumn(nRow,"fiscalSlipNum"    ,ds_list.getColumn(i,"fiscalSlipNum"));
			ds_sapCancelList.setColumn(nRow,"fiscalYear"       ,ds_list.getColumn(i,"fiscalYear"));
			ds_sapCancelList.setColumn(nRow,"cancelReason"     ,vCancelReason);
			ds_sapCancelList.setColumn(nRow,"periodDate"       ,ds_list.getColumn(i,"slipPeriodDate"));
			ds_sapCancelList.setColumn(nRow,"cancelReasonMemo" ,"["+ds_list.getColumn(i,"slipNum")+"] ["+ds_list.getColumn(i,"slipType")+"] 전표취소 테스트");
		}
	}	

	if(!gfn_confirm("ft.gds.confirm.before.ifcancel", " ")) return;  // 전표 I/F 취소 하시겠습니까?

    gfn_transaction(this
					,"saveSapIfcCancelSlip"
					,"sm/srm/sapSlipSendRept/saveSapIfcCancelSlip.xdo"
					,"ds_sapCancelList=ds_sapCancelList:U"
					,""
					,""
					,"fn_callBack"
					,true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 데이터셋 변경에 따른 이벤트
 *---------------------------------------------------------------------------------------------*/
function ds_list_onrowposchanged(obj:Dataset, e:DSRowPosChangeEventInfo){
	fn_buttonControl(ds_list.rowposition);
	
	//그룹웨어 연동 버튼을 설정
	//SCGw.setUserButton (this, fv_option, ds_list.getColumn(ds_list.rowposition, "signProgressStatus"));
	
	//if(ds_list.getColumn(ds_list.rowposition, "chk") == "1"){
		
	//}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 전표생성 취소
 *---------------------------------------------------------------------------------------------*/
function btn_cancel_onclick(obj:Button,  e:ClickEventInfo){

	if(ds_sapSlipCancelList.rowcount > 0) ds_sapSlipCancelList.clearData();

	var cnt = 0;
	var nRow = 0;
	
	for(var i=0; i<ds_list.rowcount; i++){
		if(ds_list.getColumn(i, "chk") == "1"){
			if(ds_list.getColumn(i, "slipStatus") != "J" && ds_list.getColumn(i, "slipStatus") !=  "E" && ds_list.getColumn(i, "slipStatus") !=  "C"){
				gfn_alert("전표생성 취소대상이 아닙니다. 체크박스를 확인하세요.");
				ds_list.rowposition = i;
				return;
			}
			
			// 2016.03.03 전표 자동 전송으로 프로세스 변경
			// 전표 생성 상태인 경우 미상신/반려일 때만 전표 취소 가능
			if(ds_list.getColumn(i, "slipStatus") == "J"){
				if(!gfn_isNull(ds_list.getColumn(i, "signProgressStatus")) && ds_list.getColumn(i, "signProgressStatus") != "REJECT" && ds_list.getColumn(i, "signProgressStatus") !== "CANCEL"){
					gfn_alert("전표생성 취소대상이 아닙니다. 체크박스를 확인하세요.");
					ds_list.rowposition = i;
					return;
				}			
			}

			if(MuSearchComponent01.getMuCode() == "2004"  && ds_list.getColumn(i, "writeEmpSabun") != g_EmpNo){
				gfn_alert("식제 사업부 전표 취소는 전표 발행자만 취소가 가능합니다.");
				ds_list.rowposition = i;
				return;
			}
			nRow = ds_sapSlipCancelList.addRow();
			//alert("slipNum:"+ds_list.getColumn(i, "slipNum"));
			ds_sapSlipCancelList.setColumn(nRow, "slipNum",			ds_list.getColumn(i, "slipNum"));
			//alert("#####"+ds_list.getColumn(nRow, "slipNum")+"#####");
			ds_sapSlipCancelList.setColumn(nRow, "buCd",				"2000");
			//alert("2000");
			ds_sapSlipCancelList.setColumn(nRow, "slipType",			ds_list.getColumn(i, "slipType"));
			//alert("#####"+ds_list.getColumn(nRow, "slipType")+"#####");
			//ds_sapSlipCancelList.setColumn(i, "drCrClass",			ds_list.getColumn(i, "drCrClass"));
			ds_sapSlipCancelList.setColumn(nRow, "ccCd",				ds_list.getColumn(i, "ccCd"));
			//alert("#####"+ds_list.getColumn(nRow, "ccCd")+"#####");
			ds_sapSlipCancelList.setColumn(nRow, "muCd",				ds_list.getColumn(i, "muCd"));
			//alert("#####"+ds_list.getColumn(nRow, "muCd")+"#####");
			cnt++;
		}
	}
	
	if(cnt > 0){
		if(!gfn_confirm("해당 전표를 취소하시겠습니까?")) return;

		gfn_transaction(this
						,"cancel"
						,"sm/srm/sapSlipUpload/cancelSlipList.xdo"
						,"ds_sapSlipCancelList=ds_sapSlipCancelList:U"
						,""
						,""
						,"fn_callBack"
						,true);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 팀(부서)의 팝업을 호출하기 전에 발생되는 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_tmBeforeEvent(obj)
{
	obj.qoMuCd = MuSearchComponent01.getMuCode();	//cbo_mu.value;
	obj.qoUseYn = "Y";
	
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 업장의 팝업을 호출하기 전에 발생되는 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_upjangBeforeEvent(obj, cls)
{
	cls.setTmCd(TmSearchComponent01.getTmCode());	//cls.setTmCd(edt_tm.getTmCode());
	
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 사업부 변경시 부서, CC 초기화 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_muChanged(){
    ds_search.setColumn(0, "tmCd",  "");
    ds_search.setColumn(0, "tmNm",  "");
    ds_search.setColumn(0, "ccCd",  "");
    ds_search.setColumn(0, "ccNm",  "");
	ds_slipType.clearData();
	ds_sysClass.clearData();
	gfn_setSlipTypeByMuCd(this, "cbo_slipType", "ds_slipType", MuSearchComponent01.getMuCode());
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 부서 변경시 CC 초기화 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_tmChanged(){
    ds_search.setColumn(0, "ccCd",  "");
    ds_search.setColumn(0, "ccNm",  "");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 그리드 더블 클릭 이벤트
 *---------------------------------------------------------------------------------------------*/
function grd_list_oncelldblclick(obj:Grid, e:GridClickEventInfo){

	var strSlipNum = ds_list.getColumn(ds_list.rowposition, "slipNum");
	
	gfn_dialog(	"SapSlipSendReptPop"
				,"X_SRM::SapSlipSendReptPop.xfdl"
				,{slipNum:strSlipNum}	//objArgumentList
				,-1		//Width
				,-1		//Height
				,""		//Style
				,-1		//Left
				,-1		//Top
				,false	//Modeless
				,true	//ShowTitle
				,"-1"	//Align
				,true);	//Resizable
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 레포트 출력 클릭 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_report(obj:Button,  e:ClickEventInfo){
	var sSlipType	= ds_list.getColumn(ds_list.rowposition, "slipType");
	var sSlipNum	= ds_list.getColumn(ds_list.rowposition, "slipNum");
	var sSlipStatus	= ds_list.getColumn(ds_list.rowposition, "slipStatus");
	
	//alert(sSlipNum);
	
	if(sSlipType == "7D"){
		if(sSlipStatus == "J"){
			var arrParams = SCReport.newParams ();
			SCReport.setParams(arrParams, "PARAM1", sSlipNum);
			SCReport.setParams(arrParams, SCReport.RPT_NAME, "/hwfs/sm/srm/PrintSlip.ozr");
			SCReport.setParams(arrParams, SCReport.RPT_TITLE, "printSlip");
			SCReport.viewReport(this, arrParams, "", "", "PRT");
		}
	}
}


//본부조회추가
function chk_0_OnClick(obj:CheckBox,  e:ClickEventInfo)
{
// 	if (chk_bonbu.value == true) {		
// 	   UpjangSearchComponent01.text =
// 	   UpjangSearchComponent01.setUpjangName("");
// 	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : sap 월마감 체크
 *---------------------------------------------------------------------------------------------*/
 function fn_sapCloseChk(muCd, ccCd, year, mm)
 {
	var rtn = true;

	var args  = "year=" + wrapQuote(year);
		args += " mm=" + wrapQuote(mm);
		args += " muCd=" + wrapQuote(muCd);
		args += " ccCd=" + wrapQuote(ccCd);

	gfn_transaction(this
					,"sapClose"
					,"sm/srm/sapSlipUpload/selectSapClose.xdo"
					,""
					,"ds_sapClose=ds_sapClose"
					,args
					,""
					,false);

	if( ds_sapClose.getColumn(0, "sapClose") == "Y" )
	{
		gfn_alert("SAP 회계 월마감 되었습니다. 회계팀에 문의하세요.");
		rtn = false;
	}

	return rtn;
}
function Button00_onclick(obj:Button,  e:ClickEventInfo)
{
	var from_no:int  = Edit00.text; //시작번호
	var to_no:int    = Edit01.text; //종료번호
	var result_cnt:int  = ds_list.rowcount; //조회건수
	
	if (from_no -1 > result_cnt) {
		alert("시작번호가 전체 건수보다 클 수 없습니다. 다시 입력해주세요");
		return;
	}
	else if (to_no -1 > result_cnt) {
		alert("종료번호가 전체 건수보다 클 수 없습니다. 다시 입력해주세요");	
	    return;
	}
	else if (from_no > to_no) {
		alert("시작번호가 종료번호보다 클 수 없습니다. 다시 입력해주세요");	
	    return;
	} else {
		for(var i=0; i<result_cnt; i++){	
			ds_list.setColumn(i, "chk","0"); //선택 전체해제
		}		
		for(var i=from_no-1; i<to_no; i++){				
			ds_list.setColumn(i, "chk","1"); //입력한 범위만 선택
			//alert(ds_list.getColumn(i, "chk"));
		}
	}
	
}
]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="HubInterfaceSalePrice" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="허브메카 단가 디데이설정 및 인터페이스 전송" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="11" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30" tabstop="false"/>
        <Static id="Static29" class="sta_WFSA_Labelbg" position="absolute 4 32 1236 75" anchor="left top right"/>
        <Static id="Static45" text="W15" visible="false" position="absolute 0 30 15 82" style="background:#ff000055;align:center middle;"/>
        <Static id="Static43" text="W10" visible="false" position="absolute 14 30 277 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static51" text="W05." visible="false" position="absolute 0 61 538 66" style="background:#ff000055;align:center middle;"/>
        <Static id="Static02" text="W05." visible="false" position="absolute 476 61 1014 66" style="background:#ff000055;align:center middle;"/>
        <Static id="Static10" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 198 40 228 61" anchor="left top"/>
        <Static id="Static14" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 277 41 287 62" anchor="left top"/>
        <Static id="Static22" text="판매단가 목록" class="sta_WF_Title01" position="absolute 0 86 450 104" anchor="left top"/>
        <Static id="Static20" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 123 450 128" anchor="left top"/>
        <Grid id="grd_list" taborder="10" binddataset="ds_list" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 0 105 1237 707" anchor="all" autofittype="none" autosizingtype="none" oncellclick="grd_list_oncellclick" scrollbars="autoboth" selecttype="row" onheadclick="grd_list_onheadclick" formatid="default">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="22"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="150"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="200"/>
                <Column size="85"/>
                <Column size="75"/>
                <Column size="89"/>
                <Column size="89"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="70"/>
                <Column size="50"/>
                <Column size="100"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="아이디" taborder="undefined"/>
                <Cell col="2" text="업장코드"/>
                <Cell col="3" text="단가사업장명"/>
                <Cell col="4" text="단가시작일자"/>
                <Cell col="5" text="상품코드"/>
                <Cell col="6" text="상품명"/>
                <Cell col="7" text="규격"/>
                <Cell col="8" text="단위"/>
                <Cell col="9" text="본사단가"/>
                <Cell col="10" text="운영율단가"/>
                <Cell col="11" text="과세유무"/>
                <Cell col="12" text="구매최소수량"/>
                <Cell col="13" text="구매배수수량"/>
                <Cell col="14" text="소수점발주"/>
                <Cell col="15" text="D-DAY"/>
                <Cell col="16" displaytype="checkbox" edittype="checkbox"/>
                <Cell col="17" text="허브메카D-DAY"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left middle;" text="bind:userid"/>
                <Cell col="2" displaytype="text" style="align:center middle;" text="bind:upjang"/>
                <Cell col="3" displaytype="text" style="align:left middle;" text="bind:upjangnm"/>
                <Cell col="4" displaytype="text" style="align:center middle;" text="bind:startDay"/>
                <Cell col="5" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                <Cell col="6" displaytype="text" style="align:left middle;" text="bind:itemName"/>
                <Cell col="7" displaytype="text" style="align:center middle;" text="bind:itemSize"/>
                <Cell col="8" displaytype="text" style="align:center middle;" text="bind:poUom"/>
                <Cell col="9" displaytype="number" style="align:center middle;" text="bind:contractPrice" edittype="expr:iif(chk=='1', 'normal', 'none')"/>
                <Cell col="10" displaytype="number" style="align:center middle;" text="bind:salePrice" edittype="expr:iif(chk=='1', 'normal', 'none')"/>
                <Cell col="11" displaytype="text" style="align:center middle;" text="bind:taxYn"/>
                <Cell col="12" displaytype="number" style="align:right;" text="bind:minQty" mask="##0.#"/>
                <Cell col="13" displaytype="number" style="align:right;" text="bind:applyQty" mask="##0.#"/>
                <Cell col="14" displaytype="text" style="align:center middle;" text="bind:dotYn"/>
                <Cell col="15" displaytype="text" style="align:center middle;" text="bind:leadTime"/>
                <Cell col="16" displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                <Cell col="17" displaytype="text" style="align:center middle;" text="bind:hubLeadTime" edittype="expr:iif(chk=='1', 'normal', 'none')"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static16" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 73 450 85" anchor="left top"/>
        <Static id="Static21" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1179 73 1237 79" anchor="top right"/>
        <Static id="Static18" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 1179 100 1237 105" anchor="top right"/>
        <Button id="btn_exlUpload" taborder="9" text="엑셀업로드" class="btn_WF_Function" position="absolute 1091 79 1156 99" anchor="top right" onclick="btn_exlUpload_onclick"/>
        <Static id="Static19" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1171 100 1173 120" anchor="top right"/>
        <ObjCalendar id="cal_date" titletext="캘린더" taborder="4" text="20150101" scrollbars="none" position="absolute 102 39 198 60"/>
        <Static id="Static25" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1057 104 1059 124" anchor="top right"/>
        <Static id="Static26" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 991 104 993 124" anchor="top right"/>
        <Static id="Static31" text="W05." visible="false" position="absolute 679 61 1217 66" style="background:#ff000055;align:center middle;"/>
        <Static id="Static32" text="아이디" class="sta_WFSA_label" position="absolute 231 41 329 62" anchor="left top"/>
        <Static id="Static44" text="W10" visible="false" position="absolute 14 62 277 72" style="background:#ff000055;align:center middle;"/>
        <Edit id="edt_UserId" taborder="28" readonly="true" onkeydown="edt_user_onkeydown" class="edt_WF_Essential" position="absolute 286 40 423 61" style=":disabled {cursor:arrowwait;}" userdata=""/>
        <Button id="btn_UserId" taborder="29" tabstop="false" class="btn_WF_popSearchEssential" position="absolute 423 40 444 61" onclick="btn_UserId_onclick"/>
        <Button id="btn_deleteRow" taborder="30" text="삭제" onclick="btn_deleteRow_onclick" class="btn_WF_Function" position="absolute 1045 79 1086 99" anchor="top right"/>
        <Grid id="Grid00" taborder="31" binddataset="ds_upload" useinputpanel="false" visible="false" position="absolute 229 264 812 390">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="100"/>
                <Col size="150"/>
                <Col size="150"/>
                <Col size="150"/>
                <Col size="130"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="upjang"/>
                <Cell col="1" disptype="normal" text="itemCode"/>
                <Cell col="2" disptype="normal" text="itemName"/>
                <Cell col="3" disptype="normal" text="contractPrice"/>
                <Cell col="4" disptype="normal" text="salePrice"/>
                <Cell col="5" disptype="normal" text="hubLeadTime"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="upjang"/>
                <Cell col="1" disptype="normal" text="itemCode"/>
                <Cell col="2" disptype="normal" text="itemName"/>
                <Cell col="3" disptype="normal" text="contractPrice"/>
                <Cell col="4" disptype="normal" text="salePrice"/>
                <Cell col="5" disptype="normal" text="hubLeadTime"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="grd_list2" taborder="32" binddataset="ds_sample" autoenter="select" useinputpanel="false" cellsizingtype="col" visible="false" position="absolute 852 262 1136 384" anchor="left top right">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="90"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="단가업장코드"/>
                <Cell col="1" text="상품코드"/>
                <Cell col="2" text="상품명"/>
                <Cell col="3" text="본사단가"/>
                <Cell col="4" text="운영율단가"/>
                <Cell col="5" text="허브메카 D-DAY"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center middle;background:yellow;background2:yellow;" text="bind:upjang"/>
                <Cell col="1" displaytype="text" style="background:white;background2:white;" text="bind:itemCode"/>
                <Cell col="2" displaytype="text" style="align:center middle;background:white;background2:white;" text="bind:itemName"/>
                <Cell col="3" displaytype="number" style="align:right middle;background:yellow;background2:yellow;" text="bind:contractPrice"/>
                <Cell col="4" displaytype="number" style="align:right middle;background:yellow;background2:yellow;" text="bind:salePrice"/>
                <Cell col="5" displaytype="number" style="align:right middle;background:yellow;background2:yellow;" text="bind:hubLeadTime"/>
              </Band>
            </Format>
            <Format id="down">
              <Columns>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="90"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="단가업장코드"/>
                <Cell col="1" text="상품코드"/>
                <Cell col="2" text="상품명"/>
                <Cell col="3" text="본사단가"/>
                <Cell col="4" text="운영율단가"/>
                <Cell col="5" text="허브메카 D-DAY"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center middle;background:yellow;background2:yellow;" text="bind:upjang"/>
                <Cell col="1" displaytype="text" style="background:white;background2:white;" text="bind:itemCode"/>
                <Cell col="2" displaytype="text" style="align:center middle;background:white;background2:white;" text="bind:itemName"/>
                <Cell col="3" displaytype="number" style="align:right middle;background:yellow;background2:yellow;" text="bind:contractPrice"/>
                <Cell col="4" displaytype="number" style="align:right middle;background:yellow;background2:yellow;" text="bind:salePrice"/>
                <Cell col="5" displaytype="number" style="align:right middle;background:yellow;background2:yellow;" text="bind:hubLeadTime"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_template" taborder="33" text="엑셀템플릿" onclick="btn_template_onclick" class="btn_WF_Function" position="absolute 1160 79 1237 99" anchor="top right"/>
        <Static id="Static07" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 93 39 103 60" anchor="left top"/>
        <Static id="Static03" text="단가개시일" class="sta_WFSA_label" position="absolute 21 41 105 62" anchor="left top"/>
        <CheckBox id="chk_typeB" taborder="34" tabstop="false" text="공급운영단가표 타입B" truevalue="1" position="absolute 478 39 660 63" anchor="left top" style="font:굴림,9,bold;"/>
        <Static id="Static00" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 445 40 475 61" anchor="left top"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item5" compid="cal_date" propid="text" datasetid="ds_search" columnid="schDate"/>
      <BindItem id="item10" compid="edt_UserId" propid="userdata" datasetid="ds_search" columnid="schUserId"/>
    </Bind>
    <Objects>
      <Dataset id="ds_center" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="centerName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_search_oncolumnchanged">
        <ColumnInfo>
          <Column id="schCenter" type="STRING" size="256"/>
          <Column id="schDate" type="STRING" size="256"/>
          <Column id="schUserId" type="STRING" size="256"/>
          <Column id="schTypeB" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_contract" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="contractId" type="STRING" size="256"/>
          <Column id="contractDisp" type="STRING" size="256"/>
          <Column id="contractNm" type="STRING" size="256"/>
          <Column id="contractStart" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_list_oncolumnchanged" cancolumnchange="ds_list_cancolumnchange">
        <ColumnInfo>
          <Column id="userid" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="upjangnm" type="STRING" size="256"/>
          <Column id="startDay" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="poUom" type="STRING" size="256"/>
          <Column id="contractPrice" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="taxYn" type="STRING" size="256"/>
          <Column id="minQty" type="STRING" size="256"/>
          <Column id="applyQty" type="STRING" size="256"/>
          <Column id="dotYn" type="STRING" size="256"/>
          <Column id="leadTime" type="STRING" size="256"/>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="hubLeadTime" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_delete" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="userid" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="upjangnm" type="STRING" size="256"/>
          <Column id="startDay" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="poUom" type="STRING" size="256"/>
          <Column id="contractPrice" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="taxYn" type="STRING" size="256"/>
          <Column id="minQty" type="STRING" size="256"/>
          <Column id="applyQty" type="STRING" size="256"/>
          <Column id="dotYn" type="STRING" size="256"/>
          <Column id="leadTime" type="STRING" size="256"/>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="hubLeadTime" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_save" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="userid" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="upjangnm" type="STRING" size="256"/>
          <Column id="startDay" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="poUom" type="STRING" size="256"/>
          <Column id="contractPrice" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="taxYn" type="STRING" size="256"/>
          <Column id="minQty" type="STRING" size="256"/>
          <Column id="applyQty" type="STRING" size="256"/>
          <Column id="dotYn" type="STRING" size="256"/>
          <Column id="leadTime" type="STRING" size="256"/>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="hubLeadTime" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_upload" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="contractPrice" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="hubLeadTime" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sample" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="contractPrice" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="hubLeadTime" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="upjang">116572</Col>
            <Col id="itemCode">F109959</Col>
            <Col id="itemName">포기김치(국내산/선농)KG약숙</Col>
            <Col id="contractPrice">3780</Col>
            <Col id="salePrice">3780</Col>
            <Col id="hubLeadTime">1</Col>
          </Row>
          <Row>
            <Col id="upjang">116572</Col>
            <Col id="itemCode">F109958</Col>
            <Col id="itemName">포기김치(국내산/선농)KG생</Col>
            <Col id="contractPrice">3780</Col>
            <Col id="salePrice">3780</Col>
            <Col id="hubLeadTime">2</Col>
          </Row>
          <Row>
            <Col id="upjang">116572</Col>
            <Col id="itemCode">F109957</Col>
            <Col id="itemName">겉절이(국내산/선농)KG</Col>
            <Col id="contractPrice">3560</Col>
            <Col id="salePrice">3560</Col>
            <Col id="hubLeadTime">1</Col>
          </Row>
          <Row>
            <Col id="upjang">116572</Col>
            <Col id="itemCode">F313144</Col>
            <Col id="itemName">냉동데친무청시래기(중국산)</Col>
            <Col id="contractPrice">1280</Col>
            <Col id="salePrice">1280</Col>
            <Col id="hubLeadTime">2</Col>
          </Row>
          <Row>
            <Col id="upjang">116572</Col>
            <Col id="itemCode">F313143</Col>
            <Col id="itemName">냉동우엉채(중국산)</Col>
            <Col id="contractPrice">2480</Col>
            <Col id="salePrice">2480</Col>
            <Col id="hubLeadTime">3</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_searchValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schDate" type="STRING" size="256"/>
          <Column id="schUserId" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="schDate">title:단가개시일,required:true,date;true,focus:cal_date</Col>
            <Col id="schUserId">title:허브ID,required:true,date;true,focus:cal_date</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_searchSave" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schCenter" type="STRING" size="256"/>
          <Column id="schDate" type="STRING" size="256"/>
          <Column id="schUserId" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="schCenter">title:센터,required:true,focus:cbo_centerCode</Col>
            <Col id="schDate">title:단가개시일,required:true,date;true,focus:cal_date</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_searchItem" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schCenter" type="STRING" size="256"/>
          <Column id="schDate" type="STRING" size="256"/>
          <Column id="schDate2" type="STRING" size="256"/>
          <Column id="schUpjang" type="STRING" size="256"/>
          <Column id="schCust" type="STRING" size="256"/>
          <Column id="schItemCode" type="STRING" size="256"/>
          <Column id="schContractStart" type="STRING" size="256"/>
          <Column id="schPdate" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_item" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="rowNum" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="contractStart" type="STRING" size="256"/>
          <Column id="contractEnd" type="STRING" size="256"/>
          <Column id="contractPriceS1" type="STRING" size="256"/>
          <Column id="salePrice1" type="STRING" size="256"/>
          <Column id="marginRate1" type="STRING" size="256"/>
          <Column id="centerFlag1" type="STRING" size="256"/>
          <Column id="contractPrice2" type="STRING" size="256"/>
          <Column id="contractStart2" type="STRING" size="256"/>
          <Column id="contractEnd2" type="STRING" size="256"/>
          <Column id="contractPriceS2" type="STRING" size="256"/>
          <Column id="negoPrice2" type="STRING" size="256"/>
          <Column id="strategyPrice" type="STRING" size="256"/>
          <Column id="planningPrice" type="STRING" size="256"/>
          <Column id="salePrice2" type="STRING" size="256"/>
          <Column id="marginRate2" type="STRING" size="256"/>
          <Column id="centerFlag2" type="STRING" size="256"/>
          <Column id="strategyRate" type="STRING" size="256"/>
          <Column id="planningRate" type="STRING" size="256"/>
          <Column id="poContractId" type="STRING" size="256"/>
          <Column id="taxCode" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="stdDate" type="STRING" size="256"/>
          <Column id="stdDate2" type="STRING" size="256"/>
          <Column id="contractId" type="STRING" size="256"/>
          <Column id="contractNm" type="STRING" size="256"/>
          <Column id="stdUpjang" type="STRING" size="256"/>
          <Column id="salePriceStart" type="STRING" size="256"/>
          <Column id="salePriceEnd" type="STRING" size="256"/>
          <Column id="stdPdate" type="STRING" size="256"/>
          <Column id="vdSn" type="STRING" size="256"/>
          <Column id="applySd" type="STRING" size="256"/>
          <Column id="fixedPrice" type="BIGDECIMAL" size="256"/>
          <Column id="upjangGrp" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_deleteItem" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="contractStart2" type="STRING" size="256"/>
          <Column id="stdDate" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listCopy" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="rowNum" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="contractStart" type="STRING" size="256"/>
          <Column id="contractEnd" type="STRING" size="256"/>
          <Column id="contractPriceS1" type="STRING" size="256"/>
          <Column id="salePrice1" type="STRING" size="256"/>
          <Column id="marginRate1" type="STRING" size="256"/>
          <Column id="centerFlag1" type="STRING" size="256"/>
          <Column id="contractStart2" type="STRING" size="256"/>
          <Column id="contractEnd2" type="STRING" size="256"/>
          <Column id="contractPriceS2" type="STRING" size="256"/>
          <Column id="strategyPrice" type="STRING" size="256"/>
          <Column id="planningPrice" type="STRING" size="256"/>
          <Column id="salePrice2" type="BIGDECIMAL" size="256"/>
          <Column id="marginRate2" type="BIGDECIMAL" size="256"/>
          <Column id="centerFlag2" type="STRING" size="256"/>
          <Column id="strategyRate" type="STRING" size="256"/>
          <Column id="planningRate" type="STRING" size="256"/>
          <Column id="poContractId" type="STRING" size="256"/>
          <Column id="taxCode" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="stdDate" type="STRING" size="256"/>
          <Column id="stdDate2" type="STRING" size="256"/>
          <Column id="contractId" type="STRING" size="256"/>
          <Column id="contractNm" type="STRING" size="256"/>
          <Column id="stdUpjang" type="STRING" size="256"/>
          <Column id="salePriceStart" type="STRING" size="256"/>
          <Column id="salePriceEnd" type="STRING" size="256"/>
          <Column id="stdPdate" type="STRING" size="256"/>
          <Column id="vdSn" type="STRING" size="256"/>
          <Column id="applySd" type="STRING" size="256"/>
          <Column id="fixedPrice" type="BIGDECIMAL" size="256"/>
          <Column id="upjangGrp" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_excel" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="rowNum" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="contractStart" type="STRING" size="256"/>
          <Column id="contractEnd" type="STRING" size="256"/>
          <Column id="contractPriceS1" type="STRING" size="256"/>
          <Column id="salePrice1" type="STRING" size="256"/>
          <Column id="marginRate1" type="STRING" size="256"/>
          <Column id="centerFlag1" type="STRING" size="256"/>
          <Column id="contractStart2" type="STRING" size="256"/>
          <Column id="contractEnd2" type="STRING" size="256"/>
          <Column id="contractPriceS2" type="STRING" size="256"/>
          <Column id="strategyPrice" type="STRING" size="256"/>
          <Column id="planningPrice" type="STRING" size="256"/>
          <Column id="salePrice2" type="BIGDECIMAL" size="256"/>
          <Column id="stdMarginRate" type="STRING" size="256"/>
          <Column id="marginRate2" type="BIGDECIMAL" size="256"/>
          <Column id="centerFlag2" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_yn" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="name" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="code">Y</Col>
            <Col id="name">Y</Col>
          </Row>
          <Row>
            <Col id="code">N</Col>
            <Col id="name">N</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_save" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="rowNum" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="contractStart" type="STRING" size="256"/>
          <Column id="contractEnd" type="STRING" size="256"/>
          <Column id="contractPriceS1" type="STRING" size="256"/>
          <Column id="salePrice1" type="STRING" size="256"/>
          <Column id="marginRate1" type="STRING" size="256"/>
          <Column id="centerFlag1" type="STRING" size="256"/>
          <Column id="contractStart2" type="STRING" size="256"/>
          <Column id="contractEnd2" type="STRING" size="256"/>
          <Column id="contractPriceS2" type="STRING" size="256"/>
          <Column id="strategyPrice" type="STRING" size="256"/>
          <Column id="planningPrice" type="STRING" size="256"/>
          <Column id="salePrice2" type="BIGDECIMAL" size="256"/>
          <Column id="stdMarginRate" type="STRING" size="256"/>
          <Column id="marginRate2" type="BIGDECIMAL" size="256"/>
          <Column id="centerFlag2" type="STRING" size="256"/>
          <Column id="strategyRate" type="STRING" size="256"/>
          <Column id="planningRate" type="STRING" size="256"/>
          <Column id="poContractId" type="STRING" size="256"/>
          <Column id="taxCode" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="stdDate" type="STRING" size="256"/>
          <Column id="stdDate2" type="STRING" size="256"/>
          <Column id="contractId" type="STRING" size="256"/>
          <Column id="contractNm" type="STRING" size="256"/>
          <Column id="stdUpjang" type="STRING" size="256"/>
          <Column id="salePriceStart" type="STRING" size="256"/>
          <Column id="salePriceEnd" type="STRING" size="256"/>
          <Column id="stdPdate" type="STRING" size="256"/>
          <Column id="vdSn" type="STRING" size="256"/>
          <Column id="applySd" type="STRING" size="256"/>
          <Column id="fixedPrice" type="BIGDECIMAL" size="256"/>
          <Column id="upjangGrp" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_saveRow" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="rowNum" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="contractStart" type="STRING" size="256"/>
          <Column id="contractEnd" type="STRING" size="256"/>
          <Column id="contractPriceS1" type="STRING" size="256"/>
          <Column id="salePrice1" type="STRING" size="256"/>
          <Column id="marginRate1" type="STRING" size="256"/>
          <Column id="centerFlag1" type="STRING" size="256"/>
          <Column id="contractStart2" type="STRING" size="256"/>
          <Column id="contractEnd2" type="STRING" size="256"/>
          <Column id="contractPriceS2" type="STRING" size="256"/>
          <Column id="strategyPrice" type="STRING" size="256"/>
          <Column id="planningPrice" type="STRING" size="256"/>
          <Column id="salePrice2" type="BIGDECIMAL" size="256"/>
          <Column id="stdMarginRate" type="STRING" size="256"/>
          <Column id="marginRate2" type="BIGDECIMAL" size="256"/>
          <Column id="centerFlag2" type="STRING" size="256"/>
          <Column id="strategyRate" type="STRING" size="256"/>
          <Column id="planningRate" type="STRING" size="256"/>
          <Column id="poContractId" type="STRING" size="256"/>
          <Column id="taxCode" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="stdDate" type="STRING" size="256"/>
          <Column id="stdDate2" type="STRING" size="256"/>
          <Column id="contractId" type="STRING" size="256"/>
          <Column id="contractNm" type="STRING" size="256"/>
          <Column id="stdUpjang" type="STRING" size="256"/>
          <Column id="salePriceStart" type="STRING" size="256"/>
          <Column id="salePriceEnd" type="STRING" size="256"/>
          <Column id="stdPdate" type="STRING" size="256"/>
          <Column id="vdSn" type="STRING" size="256"/>
          <Column id="applySd" type="STRING" size="256"/>
          <Column id="fixedPrice" type="BIGDECIMAL" size="256"/>
          <Column id="upjangGrp" type="STRING" size="256"/>
          <Column id="isLast" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_excelBak" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="rowNum" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="contractStart" type="STRING" size="256"/>
          <Column id="contractEnd" type="STRING" size="256"/>
          <Column id="contractPriceS1" type="STRING" size="256"/>
          <Column id="salePrice1" type="STRING" size="256"/>
          <Column id="marginRate1" type="STRING" size="256"/>
          <Column id="centerFlag1" type="STRING" size="256"/>
          <Column id="contractStart2" type="STRING" size="256"/>
          <Column id="contractEnd2" type="STRING" size="256"/>
          <Column id="contractPriceS2" type="STRING" size="256"/>
          <Column id="strategyPrice" type="STRING" size="256"/>
          <Column id="planningPrice" type="STRING" size="256"/>
          <Column id="salePrice2" type="BIGDECIMAL" size="256"/>
          <Column id="stdMarginRate" type="STRING" size="256"/>
          <Column id="marginRate2" type="BIGDECIMAL" size="256"/>
          <Column id="centerFlag2" type="STRING" size="256"/>
          <Column id="strategyRate" type="STRING" size="256"/>
          <Column id="planningRate" type="STRING" size="256"/>
          <Column id="poContractId" type="STRING" size="256"/>
          <Column id="taxCode" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="stdDate" type="STRING" size="256"/>
          <Column id="stdDate2" type="STRING" size="256"/>
          <Column id="contractId" type="STRING" size="256"/>
          <Column id="contractNm" type="STRING" size="256"/>
          <Column id="stdUpjang" type="STRING" size="256"/>
          <Column id="salePriceStart" type="STRING" size="256"/>
          <Column id="salePriceEnd" type="STRING" size="256"/>
          <Column id="stdPdate" type="STRING" size="256"/>
          <Column id="vdSn" type="STRING" size="256"/>
          <Column id="applySd" type="STRING" size="256"/>
          <Column id="fixedPrice" type="BIGDECIMAL" size="256"/>
          <Column id="upjangGrp" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : HubInterfaceSalePrice
  파 일 명 : HubInterfaceSalePrice.xfdl
  기    능 : 허브메카 I/F용 단가 디데이 셋팅

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2022.06.23   김혜진   최초 생성
  
*/
/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";


/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_processCnt = 0;			//처리건수
var fv_poCnt = 0;				//PO건수(조회여부 CHECK)	
var fv_objColInfo;				//데이터셋 컬럼정보
var fv_Key = "";				//저장 시 Key값 SET(계약번호)
var fv_excelFlag = false;		//엑셀업로드 후 갱신여부 CHECK
var fv_saveFlag = "";			//신규저장 시 CallBack 처리 구분
var fv_editFlag = "";

// 엑셀업로드 관련 변수
var fv_excelRowCnt;				//현재대상 Row Count
var fv_excelRow;				//현재대상 Row Index
var fv_errorFlag;				//에러발생 여부(Y/N)
var fv_errorMsg;				//에러발생 메시지

// 저장 관련 변수
var fv_errorFlag;				//에러발생 여부(Y/N)
var fv_errorMsg;				//에러발생 메시지
var fv_saveRowCnt;				//저장대상 Row Count
var fv_saveRow;					//저장대상 Row Index
var fv_row;						//저장대상 ROW ID 
var fv_ret;						//트랜잭션 리턴 값 (E:오류)
var fv_retMsg;					//트랜잭션 리턴 메시지(오류시)
var fv_saveFlag = true;	
/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
	
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	v_ds_check = "ds_list";

	// 센터정보 COMBO 초기화 : 조건
	//fn_searchCenter();
	
	
	//조회조건을 초기화한다.
	var nRow= ds_search.addRow();
	ds_search.setColumn(nRow, "schCenter", "");								// 센터
	ds_search.setColumn(nRow, "schDate", gfn_today());						// 일자

	// 일자 Obj SET
	cal_date.fn_initMonthCal(this, "", "", ds_search, "schDate", "Y");		// 판매단가개시일 SET

	
	var arrArg = gfn_getScreenParams();
	if( !gfn_isNull(arrArg) ) {
		for( var p in arrArg ) {
			trace(p + "==" + arrArg[p]);
		}
		
		
		ds_search.setColumn(nRow, "schDate", arrArg.startDate);
		ds_search.setColumn(nRow, "schUserId", arrArg.userId);
		
		edt_UserId.value    = arrArg.userNm;
		edt_UserId.userdata = arrArg.userId;

				
		fn_search();
	}
	
}

/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
	
	// 조건 SET
	var nRow = ds_search.rowposition;

	//ds_search.setColumn(0, "schCenter",	cbo_centerCode.value); //센터코드
	ds_search.setColumn(0, "schUserId",	edt_UserId.userdata); //허브ID
	ds_search.setColumn(0, "schDate",	cal_date.text); //단가개시일
	
	
	// 조회시 Validation Check
	if (gfn_validCheck(ds_search, ds_searchValid, true) == false) return;


    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_list);

   	//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장 
	fv_objColInfo = gfn_getDatasetInfo (ds_list);
	
	if (chk_typeB.value) {
		ds_search.setColumn(0,"schTypeB","Y");
	} else {
		ds_search.setColumn(0,"schTypeB","");
	}
	
    //chk_typeB
    var strSvcID    = "search";
	var strURL      = "fm/fms/hubInterfaceSalePrice/selectList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_list=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 * 자재추가 팝업
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{	

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 * 멀티 삭제 가능하게 처리
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{
	
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 * 1 Transaction
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
/*
	var iCnt = ds_list.getCaseCount(" getRowType(rowidx) == Dataset.ROWTYPE_UPDATE || getRowType(rowidx) == Dataset.ROWTYPE_INSERT ||(getOrgColumn(rowidx, 'hubLeadTime') != getColumn(rowidx, 'hubLeadTime'))  ");
	

	if (iCnt == 0) {
		gfn_alert("msg.save.nochange"); //변경된 내역이 없습니다.
		return;
	}
*/	
	if (!gfn_confirm("confirm.before.save")) return false;
	
	
	if( ds_list.findRowExpr( "chk == 1" ) != -1 ) {
	
		ds_save.clearData();
		
		for( var i = 0; i < ds_list.rowcount; i++ ) { 
		
			if( ds_list.getColumn(i,"chk") == 1 ) {
				//ds_list.deleteRow(i);
				var nRow = ds_save.addRow();
				ds_save.copyRow(nRow, ds_list, i);
			}
		}
	
	// Transaction 처리
	var strSvcID    = "saveList";
	var strURL      = "fm/fms/hubInterfaceSalePrice/saveList.xdo";
	var strInDs     = "ds_save=ds_save:A";
	var strOutDs    = "";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}else {
		alert("선택된 값이 없습니다.")
	}
}



/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{	
	// v_ds_check 사용시 변경사항 체크
	if(gfn_length(v_ds_check) == 0) 
	{	
		// v_ds_check 설정기준 변경사항 체크
		if (gfn_isDataChange() == true) 
		{		
			// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
			if (!gfn_confirm("confirm.before.movepage")) return false;
		}
	}
    
	// 조회프로그램에도 Return true; 기술해 주세요!
	return true;
}


/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {
		// 목록 조회
        case "search" :
            //trace(ds_list.saveXML());
            if (ds_list.getRowCount() == 0) {
				//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				gfn_loadDatasetInfo (ds_list, fv_objColInfo);
				gfn_alert("msg.search.nodata");	// 조건에 해당하는 자료가 없습니다.
            } 
            fv_saveFlag = true;
            break;
    

        // 저장 : 1 Transaction
        case "saveList" :
			gfn_alert("msg.save.success");	// 저장 되었습니다.
			// 판매단가 목록 재조회
			fn_search();
            break;    

        // 삭제
        case "deleteHubPrice" :
			gfn_alert("msg.delete.success");	// 삭제 되었습니다.
			// 판매단가 목록 재조회
			fn_search();
            break;    
        // 업로드한 엑셀에 대한 기본정보를 SET
		case "searchUpload" :
			//trace(ds_list.saveXML());
            //if (ds_list.getRowCount() == 0) {
				//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				//gfn_loadDatasetInfo (ds_list, fv_objColInfoList);
            //}else{
				fv_saveFlag = true;//저장후 다시 저장 불가.
				div_cmnBtn.btn_save.enable = fv_saveFlag;
				//btn_delete.enable = fv_saveFlag;
				grd_list.binddataset = ds_list;
				//trace(ds_list.saveXML()); 
            //}	
				if(ds_list.getRowCount() == 0 ){
				gfn_alert("msg.search.nodata");	// 조건에 해당하는 자료가 없습니다.
				}
            break;
    }
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/


/*----------------------------------------------------------------------------------------------
 * 설명      : 센터정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchCenter()
{
    var strSvcID    = "searchCenter";
    var strURL      = "fm/fms/upriceContractUpjangSet/selectCenter.xdo";
    var strInDs     = "";
    var strOutDs    = "ds_center=ds_center";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 센터 COMBO 초기화 
 *---------------------------------------------------------------------------------------------*/
function fn_center_init()
{
	/*var defVal = "";
	ds_center.filter("centerCode != '*'");
	// COMBO 에 첫번째 Row에 기본값을 SET
	if (ds_center.getRowCount() > 0) {
		defVal = ds_center.getColumn(0, "centerCode");
	}
	cbo_centerCode.value = defVal;*/
}

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/


/*----------------------------------------------------------------------------------------------
 * 설명      : 고객사 검색 콘트롤 이벤트 - 삭제 시 DATA SET Clear
 *              
 *---------------------------------------------------------------------------------------------*/
function edt_user_onkeydown(obj:Edit, e:KeyEventInfo)
{
	// Del 키
	if(e.keycode == 46) 
	{	
		// 고객사 정보 초기화
		edt_user.value="";
		edt_user.userdata="";
		ds_search.setColumn(ds_search.rowposition, "schUserId", "");
		//fn_Trigger_edBtn(obj);
	}

	// Enter 키
	if(e.keycode == 13) 
	{		
		fn_UserIdPop();
	}	
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 조건관련 Dataset 변경 시 이벤트 처리
 *---------------------------------------------------------------------------------------------*/
function ds_search_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
    switch(e.columnid)
    {
		/*case "schCenter" :			// 센터정보
			ds_list.clearData();
			break;
*/
    
		case "schDate" :			// 기준일자
			//fn_searchDateSet();
			ds_list.clearData();
			break;
			
		case "schUserId" :			// 허브ID
			ds_list.clearData();
			break;
	}	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 고객사 검색 팝업 이벤트
 *              
 *---------------------------------------------------------------------------------------------*/
function fn_UserIdPop()
{
	// 팝업창을 호출한다	
	var strId       = "HubInterfaceUserPop";
	var strURL      = "X_FMS::HubInterfaceUserPop.xfdl";
	var objArgument = {
		P_DATASET : ds_search
		, v_attr01  : "Y"
	};
	
	var nWidth      = 513;
	var nHeight     = 495;
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	
	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
	
	if (arrRtn instanceof Object)
	{
		edt_UserId.value    = arrRtn["usernm"];
		edt_UserId.userdata = arrRtn["userid"];
		
	}
}

function btn_deleteRow_onclick(obj:Button,  e:ClickEventInfo)
{
	if( ds_list.findRowExpr( "chk == 1" ) != -1 ) {
	
		ds_delete.clearData();
		
		for( var i = 0; i < ds_list.rowcount; i++ ) { 
		
			if( ds_list.getColumn(i,"chk") == 1 ) {
				//ds_list.deleteRow(i);
				var nRow = ds_delete.addRow();
				ds_delete.copyRow(nRow, ds_list, i);
			}
		}
		
	// Transaction 처리
	var strSvcID    = "deleteHubPrice";
	var strURL      = "fm/fms/hubInterfaceSalePrice/deleteHubPrice.xdo";
	var strInDs     = "ds_delete=ds_delete:A";
	var strOutDs    = "";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
		
	} else {
		alert("선택된 값이 없습니다.")
	}
}

function btn_UserId_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_UserIdPop();
}

function btn_exlUpload_onclick(obj:Button,  e:ClickEventInfo)
{
	//ds_search.setColumn(0, "schCenter",	cbo_centerCode.value); //센터코드
	ds_search.setColumn(0, "schUserId",	edt_UserId.userdata); //허브ID
	ds_search.setColumn(0, "schDate",	cal_date.text); //단가개시일
	
	if (gfn_nvl(ds_search.getColumn(0, "schUserId"), "")=="" ) {
		gfn_alert("업로드 할 아이디를 선택 해 주세요.");	
		return;		
	}
	if (gfn_nvl(ds_search.getColumn(0, "schDate"), "")=="" ) {
		gfn_alert("업로드 할 단가개시일을 입력 해 주세요.");	
		return;
	}
	
	// 파일 선택
	var strFileName = gfn_excelFileDialog("LOAD", "EXCEL");

	if (strFileName.length == 0)
	{
		this.setWaitCursor(false);
		return;
	}

	if(ds_list.getRowCount() > 0 ){
		if(!gfn_confirm("저장하지 않은 데이터는 삭제됩니다.\n\n계속하시겠습니까?")){
			return;
		}
	}
	
	grd_list.binddataset = "";
	ds_list.clearData();
	// 오류 Dataset Clear
	//ds_listErr.clearData();

	fv_saveFlag = false;
	//btn_save.enable = fv_saveFlag;
	div_cmnBtn.btn_save.enable = fv_saveFlag;
	//btn_delete.enable = fv_saveFlag;	

	this.setWaitCursor(true);
	
	/*********************************************************************************************
	** argument             : strFileName		파일명 (경로 포함)
	**                        strDsName			Import 대상 Dataset Name
	**                        nStartRow			Import 시작 행(사용된 Range 기준, 1 base)
	**						  bKeepColInfo		Dataset의 컬럼 정보를 유지할지 여부
	*********************************************************************************************/
	ds_upload.filter("");
	var rtn = gfn_importExcel(strFileName, "ds_upload", 2, true);
	ds_upload.filter(" !gfn_isNull(upjang) || !gfn_isNull(itemCode) || !gfn_isNull(hubLeadTime)");
	//trace(ds_upload.getRowCount() + " / " + ds_upload.getCountNF());

	this.setWaitCursor(false);

	if (ds_upload.getRowCount()>0) {
		// 엑셀업로드 DataSet 처리
		fn_processSetUpload();
	}
	else {
		gfn_alert("msg.err.grid.nodata");	// 데이타가 없습니다
	}
}


/*----------------------------------------------------------------------------------------------
 * 설명      : Progress Bar - 엑셀업로드 용
 *---------------------------------------------------------------------------------------------*/
function fn_processSetUpload()
{
	var iCnt = 0;
	var retFlag;		//엑셀 입력 필수값 체크.
	
	fv_errorFlag = "";
	fv_errorMsg = "";

	// 엑셀업로드용 DataSet Filter : 창고코드, 발주일, 입고일, 자재코드 값이 없으면 삭제 
	for (var i = 0 ; i < ds_upload.getRowCount() ; i++)
	{
		// Null 처리

		if (gfn_nvl(ds_upload.getColumn(i, "upjang"), "") == "") ds_upload.setColumn(i, "upjang", "");
		if (gfn_nvl(ds_upload.getColumn(i, "itemCode"), "") == "") ds_upload.setColumn(i, "itemCode", "");
		//if (gfn_nvl(ds_upload.getColumn(i, "itemName"), "") == "") ds_upload.setColumn(i, "itemName", "");
		if (gfn_nvl(ds_upload.getColumn(i, "contractPrice"), "") == "") ds_upload.setColumn(i, "contractPrice", "");
		if (gfn_nvl(ds_upload.getColumn(i, "salePrice"), "") == "") ds_upload.setColumn(i, "salePrice", "");
		if (gfn_nvl(ds_upload.getColumn(i, "hubLeadTime"), "") == "") ds_upload.setColumn(i, "hubLeadTime", "");

		// 기본필수 입력 CHECK
		retFlag = fn_excelCheck(ds_upload,i);
	}
	
	//var nRowCnt = ds_excel.getRowCount();	// 엑셀 DataSet Count
	
	if(ds_list.getRowCount() > 0){
		//fv_objColInfoList = gfn_getDatasetInfo (ds_list);
		//fv_objColInfoListErr = gfn_getDatasetInfo (ds_listErr );
		
		if (fv_errorFlag == "Y") {
			gfn_alert("오류가 발생하였습니다.\n\n수정후 재업로드 해 주세요. : " + fv_errorMsg);	
			return;
		} else {
		
		//trace(ds_list.saveXML());
		var strSvcID    = "searchUpload";
		var strURL      = "fm/fms/hubInterfaceSalePrice/searchUpload.xdo";
		var strInDs     = "ds_list=ds_list:A";
		var strOutDs    = "ds_list=ds_list";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;

		//trace(ds_list.saveXML()); 
		//return;
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
		}
 	}else{
 		grd_list.binddataset = ds_list;
 		gfn_alert("형식에 맞는 주문이 없습니다.\n\n수정후 재업로드 해 주세요.");	
 		return;
 	}
}

/*----------------------------------------------------------------------------------------------
 * 설명     : 엑셀 업로드 필수입력 체크 함수
 * 파라미터 : 선택된 행
 *---------------------------------------------------------------------------------------------*/
function fn_excelCheck(objD,arg)
{

	if ( gfn_nvl(objD.getColumn(arg, "upjang"), "")=="") {
		if (fv_errorFlag == "Y") fv_errorMsg = fv_errorMsg + ",";
		fv_errorFlag = "Y";
		fv_errorMsg = fv_errorMsg + "단가업장 코드 누락";
	}
/*	if ( gfn_nvl(objD.getColumn(arg, "startDay"), "")==""  || !gfn_isNum(objD.getColumn(arg, "startDay"))) {
		if (fv_errorFlag == "Y") fv_errorMsg = fv_errorMsg + ",";
		fv_errorFlag = "Y";
		fv_errorMsg = fv_errorMsg + "단가 시작일자 누락 및 오류";
	}*/
	if ( gfn_nvl(objD.getColumn(arg, "itemCode"), "")=="") {
		if (fv_errorFlag == "Y") fv_errorMsg = fv_errorMsg + ",";
		fv_errorFlag = "Y";
		fv_errorMsg = fv_errorMsg + "상품코드 누락";
	}
	if ( gfn_nvl(objD.getColumn(arg, "contractPrice"), "")=="") {
		if (fv_errorFlag == "Y") fv_errorMsg = fv_errorMsg + ",";
		fv_errorFlag = "Y";
		fv_errorMsg = fv_errorMsg + "본사단가 누락";
	}
	if ( gfn_nvl(objD.getColumn(arg, "salePrice"), "")=="") {
		if (fv_errorFlag == "Y") fv_errorMsg = fv_errorMsg + ",";
		fv_errorFlag = "Y";
		fv_errorMsg = fv_errorMsg + "운영율단가 누락";
	}
	if ( gfn_nvl(objD.getColumn(arg, "hubLeadTime"), "")=="") {
		if (fv_errorFlag == "Y") fv_errorMsg = fv_errorMsg + ",";
		fv_errorFlag = "Y";
		fv_errorMsg = fv_errorMsg + "허브메카 D-DAY 누락";
	}
//alert(fv_errorFlag);	

	// 에러 발생시 현재 엑셀의 Dataset을 ds_list로 복사 : 오류상태 표시
	if (fv_errorFlag=="Y") {
		var iIdx = ds_list.addRow();
		ds_list.setColumn(iIdx, "userid", ds_search.getColumn(ds_search.rowposition, "schUserId"));
		//ds_list.setColumn(iIdx, "startDay",     ds_search.getColumn(ds_search.rowposition, "schDate"));
		ds_list.setColumn(iIdx, "startDay",   ds_search.getColumn(ds_search.rowposition, "schDate"));
		ds_list.setColumn(iIdx, "upjang",   gfn_nvl(objD.getColumn(arg, "upjang"),""));
		ds_list.setColumn(iIdx, "itemCode",   objD.getColumn(arg, "itemCode"));
		ds_list.setColumn(iIdx, "itemName",   fv_errorMsg);
		ds_list.setColumn(iIdx, "contractPrice", objD.getColumn(arg, "contractPrice"));
		ds_list.setColumn(iIdx, "salePrice",    objD.getColumn(arg, "salePrice"));
		ds_list.setColumn(iIdx, "hubLeadTime",    objD.getColumn(arg, "hubLeadTime"));
		//ds_list.setColumn(iIdx, "error", "Y"); 

		return false;
	} else {
	// 에러가 없으면 Transaction을 위한 조건DataSet을 생성한다
		var iIdx = ds_list.addRow();
		ds_list.setColumn(iIdx, "userid",   ds_search.getColumn(ds_search.rowposition, "schUserId"));
		ds_list.setColumn(iIdx, "startDay",  ds_search.getColumn(ds_search.rowposition, "schDate"));
		ds_list.setColumn(iIdx, "upjang",   gfn_trim(objD.getColumn(arg, "upjang")));
		ds_list.setColumn(iIdx, "itemCode", gfn_trim(objD.getColumn(arg, "itemCode")));
		ds_list.setColumn(iIdx, "itemName", gfn_trim(objD.getColumn(arg, "itemName")));
		ds_list.setColumn(iIdx, "contractPrice", gfn_trim(objD.getColumn(arg, "contractPrice")));
		ds_list.setColumn(iIdx, "salePrice",    gfn_trim(objD.getColumn(arg, "salePrice")));
		ds_list.setColumn(iIdx, "hubLeadTime", gfn_lTrim(gfn_lTrim(gfn_trim(objD.getColumn(arg, "hubLeadTime")," "),"D-"),"d-"));
	}

	return true;
}


function btn_template_onclick(obj:Button,  e:ClickEventInfo)
{
	grd_list2.setFormat("down");
	grd_list2.persinfo = "N";
	gfn_exportExcel(grd_list2); 
}
]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="FSP00274P" onkeydown="frm_OnKeyDown" onload="form_onload" titletext="그래프" position="absolute 0 0 740 440" scrollbars="none">
    <Layouts>
      <Layout>
        <ActiveX progid="ShockwaveFlash.ShockwaveFlash.10" id="fu_ct01" position="absolute 15 66 726 426"/>
        <Static id="Static03" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 725 8 740 421"/>
        <Static id="Static01" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 15 405"/>
        <Static id="Static15" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 15 0 715 10"/>
        <Static id="Static04" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 15 425 707 440"/>
        <Static id="Static07" class="sta_WFSA_Labelbg" position="absolute 15 10 725 51" anchor="left top right"/>
        <Static id="Static12" text="W10" visible="false" position="absolute 62 20 72 41" style="background:#ff000055;align:center middle;"/>
        <Static id="Static21" text="W10" visible="false" position="absolute 30 10 709 20" style="background:#ff000055;align:center middle;"/>
        <Static id="Static23" text="W10" visible="false" position="absolute 30 41 715 51" style="background:#ff000055;align:center middle;"/>
        <Static id="Static24" text="W15" visible="false" position="absolute 15 20 30 41" style="background:#ff000055;align:center middle;"/>
        <Static id="Static11" text="h15" visible="false" position="absolute 15 51 381 66" style="background:#ff000055;align:center middle;"/>
        <Static id="Static0" text="분류" class="sta_WFSA_label" position="absolute 30 20 84 41" anchor="left top"/>
        <Static id="Static10" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 199 20 229 41" anchor="left top"/>
        <Radio codecolumn="CODE" columncount="3" datacolumn="code_name" id="rdo_SType" index="-1" innerdataset="ds_SType" onitemchanged="rdo_SType_OnChanged" taborder="6" value="1" position="absolute 72 20 221 41"/>
        <Static id="Static02" text="W10" visible="false" position="absolute 274 20 284 41" style="background:#ff000055;align:center middle;"/>
        <Static id="st_CLASS_CODE1" text="대분류" class="sta_WFSA_label" position="absolute 229 20 283 41" anchor="left top" visible="false"/>
        <Combo codecolumn="CLASS_CODE1" datacolumn="CLASS_NAME1" id="cbo_CLASS_CODE1" index="0" innerdataset="ds_CLASS_CODE1" onitemchanged="cbo_CLASS_CODE1_OnChanged" type="NOTFILTERED" taborder="3" visible="false" position="absolute 284 20 512 41"/>
        <Button id="btn_Close" onclick="fn_Close" taborder="7" text="닫기" position="absolute 668 20 709 41" class="btn_WF_Custom" image=""/>
        <Static id="Static05" text="W15" visible="false" position="absolute 709 20 724 41" style="background:#ff000055;align:center middle;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_Chart1"/>
      <Dataset id="ds_ChartX">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ChartY">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Chart2">
        <ColumnInfo>
          <Column id="OCCUR_DATE" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list">
        <ColumnInfo>
          <Column id="BL_PLUS" size="1" type="STRING"/>
          <Column id="BL_SHOW" size="1" type="STRING"/>
          <Column id="CLASS_CODE1" size="8" type="STRING"/>
          <Column id="CLASS_CODE2" size="8" type="STRING"/>
          <Column id="CLASS_NAME1" size="50" type="STRING"/>
          <Column id="CLASS_NAME2" size="50" type="STRING"/>
          <Column id="IN_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="LEVEL_NO" size="22" type="BIGDECIMAL"/>
          <Column id="OUT_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="PHYSIC_MAMOUNT1" size="22" type="BIGDECIMAL"/>
          <Column id="PHYSIC_MAMOUNT2" size="22" type="BIGDECIMAL"/>
          <Column id="PL_CD" size="8" type="STRING"/>
          <Column id="PL_UP_CD" size="8" type="STRING"/>
          <Column id="RATE" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CLASS_CODE1">
        <ColumnInfo>
          <Column id="CLASS_CODE1" type="STRING" size="256"/>
          <Column id="CLASS_NAME1" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SType">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="code_name">대분류</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="code_name">중분류</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_ChartY_3">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">AMT01</Col>
            <Col id="code_name"/>
          </Row>
          <Row>
            <Col id="CODE">RATE01</Col>
            <Col id="code_name"/>
          </Row>
          <Row>
            <Col id="CODE">AMT02</Col>
            <Col id="code_name"/>
          </Row>
          <Row>
            <Col id="CODE">RATE02</Col>
            <Col id="code_name"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Chart_3">
        <ColumnInfo>
          <Column id="AMT01" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_chart">
        <ColumnInfo>
          <Column id="label" type="STRING" size="256"/>
          <Column id="value" type="STRING" size="256"/>
          <Column id="link" type="STRING" size="256"/>
          <Column id="code" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind/>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 메뉴관리/레시피관리/레시피통계
 * 프로그램명   : FSR00134P.XML
 * 기      능   : 사용횟수 - 그래프보기
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-02-15
 * 비      고   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"		// X-Framework Lib
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"		// 공통팝업
//@@컨버터에서 주석처리 #include "lib::fm_common.js"			// FM공통
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var fstrStype, fstrSTypeSub;
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	// X-Framework : Action 정보 생성 
	fsp_init(this);
	
	fstrStype 		= opener.ds_input.getColumn(0,"STYPE");
	fstrSTypeSub 	= gfn_toString(toNumber(opener.ds_input.getColumn(0,"STYPE")) + 3);
	
	// 부모창의 데이타 가져오기
	var objDa = eval("opener.div_detail" + fstrStype + ".ds_list" + fstrStype);	
	ds_list.copyData(objDa);
	ds_list.keystring = objDa.keystring;

	// 대분류 코드 생성
	var nRow2;
	ds_CLASS_CODE1.clearData();	
	ds_list.filter("");
	for(var i=0; i<ds_list.rowcount; i++) 
	{
		// 원래 데이타가 아닐때만
		if(ds_list.getRowLevel(i) != 0)
		{	
			nRow2 = ds_CLASS_CODE1.addRow();
				
			ds_CLASS_CODE1.setColumn(nRow2, "CLASS_CODE1", ds_list.getColumn(i-1, "CLASS_CODE1"));
			ds_CLASS_CODE1.setColumn(nRow2, "CLASS_NAME1", ds_list.getColumn(i-1, "CLASS_NAME1"));
		}
	}
	cbo_CLASS_CODE1.index = 0;		
				
 	//trace("keystring : " + ds_list.keystring);
 	//trace(ds_list.saveXML());
	
	// 차트 그리기
	fn_Chart_Display2(fstrStype);
}

function frm_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
}

function fn_Chart_Display2(strSType)
{	
	ds_chart.clearData();

	// 기간
	if (strSType == "1" || strSType == "4")		
	{
		if (strSType == "1")
		{
			var strTitle = "대분류별 사용비율";
			var nRow;
			
			ds_list.filter("");
			for(var i=0; i<ds_list.rowcount; i++) 
			{
				// 원래 데이타가 아닐때만
				if(ds_list.getRowLevel(i) != 0)
				{
					nRow = ds_chart.addRow();
						
					ds_chart.setColumn(nRow, "label", ds_list.getColumn(i-1, "CLASS_NAME1"));
					ds_chart.setColumn(nRow, "value", (Math.round((ds_list.getColumn(i,"OUT_AMT")/ds_list.getSum("OUT_AMT"))* 100,1)));
				}
			}
		}
		else
		{
			var strTitle = "중분류별 사용비율";
			var nRow;
			
			ds_list.filter("CLASS_CODE1 == '" + cbo_CLASS_CODE1.value + "'");
			for(var i=0; i<ds_list.rowcount; i++) 
			{
				// 원래 데이타만
				if(ds_list.getRowLevel(i) == 0)
				{
					nRow = ds_chart.addRow();
						
					ds_chart.setColumn(nRow, "label", ds_list.getColumn(i, "CLASS_NAME2"));
					ds_chart.setColumn(nRow, "value", (Math.round((ds_list.getColumn(i, "OUT_AMT")/ds_list.getSum("OUT_AMT"))* 100,1)));
				}
			}		
		}
		
		var arrArg,arrSer;		
		//---------------------------------------------
		// arg1 : 차트속성
		// caption				- 차트제목
		// xAxisName			- X축의 명
		// yAxisName			- Y축의 명
		// showValues			- 0 : 차트에 값 표시 안함
		// formatNumberScale	- 0 : 숫자형식인 경우, 단위표시여부(천(1000)인경우, K로 표시 등등)
		//---------------------------------------------
		arrArg = ["caption",strTitle,"xAxisName","","yAxisName","","showValues","1","formatNumberScale","0","showPercentageValues", "1"];
		
		// gfn_SingleChart(차트Obj,차트종류,차트데이터,X축값컬럼명,Y축값컬럼명,차트속성,차트색상,리턴컬럼명)
		// 색상지정 안하면, 기본 팔레트색으로...
		gfn_SingleChart(fu_ct01,"Doughnut2D",ds_chart,"label","value",arrArg);		
	}
	// 연누계
	else if (strSType == "2" || strSType == "5")
	{
		// 년도 생성
		for(var i=1; i<=12; i++) 
		{
			nRow = ds_chart.addRow();					
			ds_chart.setColumn(nRow, "label", i+'월');
		}
				
		if (strSType == "2")
		{
			var strTitle = "대분류별 사용비율";			
			var nRow;
			var bColChk;
						
			ds_list.filter("");
			var nNum = 1;
			var strSer = "";
			for(var i=0; i<ds_list.rowcount; i++) 
			{
				// 원래 데이타가 아닐때만
				if(ds_list.getRowLevel(i) != 0)
				{
					bColChk = ds_chart.getColumnInfo("value_"+nNum);
					if(gfn_isNull(bColChk)) ds_chart.addColumn("value_"+nNum, "BIGDECIMAL", 39);					
					
					strSer += "\"" +ds_list.getColumn(i-1,"CLASS_NAME1") + "\",\"" + "value_"+ nNum + "\",\"\",";
					
					ds_chart.setColumn(0,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT01")/ds_list.getSum("AMT01"))* 100,1)));
					ds_chart.setColumn(1,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT02")/ds_list.getSum("AMT02"))* 100,1)));
					ds_chart.setColumn(2,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT03")/ds_list.getSum("AMT03"))* 100,1)));
					ds_chart.setColumn(3,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT04")/ds_list.getSum("AMT04"))* 100,1)));
					ds_chart.setColumn(4,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT05")/ds_list.getSum("AMT05"))* 100,1)));
					ds_chart.setColumn(5,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT06")/ds_list.getSum("AMT06"))* 100,1)));
					ds_chart.setColumn(6,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT07")/ds_list.getSum("AMT07"))* 100,1)));
					ds_chart.setColumn(7,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT08")/ds_list.getSum("AMT08"))* 100,1)));
					ds_chart.setColumn(8,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT09")/ds_list.getSum("AMT09"))* 100,1)));
					ds_chart.setColumn(9,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT10")/ds_list.getSum("AMT10"))* 100,1)));
					ds_chart.setColumn(10, "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT11")/ds_list.getSum("AMT11"))* 100,1)));
					ds_chart.setColumn(11, "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT12")/ds_list.getSum("AMT12"))* 100,1)));
					nNum++;
				}
			}
		}
		else
		{
			var strTitle = "중분류별 사용비율";			
			var nRow;
			var bColChk;
			
			ds_list.filter("CLASS_CODE1 == '" + cbo_CLASS_CODE1.value + "'");
			var nNum = 1;
			var strSer = "";
			for(var i=0; i<ds_list.rowcount; i++) 
			{
				// 원래 데이타만
				if(ds_list.getRowLevel(i) == 0)
				{
					bColChk = ds_chart.getColumnInfo("value_"+nNum);
					if(gfn_isNull(bColChk)) ds_chart.addColumn("value_"+nNum, "BIGDECIMAL", 39);					
					
					strSer += "\"" +ds_list.getColumn(i,"CLASS_NAME2") + "\",\"" + "value_"+ nNum + "\",\"\",";
					
					ds_chart.setColumn(0,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT01")/ds_list.getSum("AMT01"))* 100,1)));
					ds_chart.setColumn(1,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT02")/ds_list.getSum("AMT02"))* 100,1)));
					ds_chart.setColumn(2,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT03")/ds_list.getSum("AMT03"))* 100,1)));
					ds_chart.setColumn(3,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT04")/ds_list.getSum("AMT04"))* 100,1)));
					ds_chart.setColumn(4,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT05")/ds_list.getSum("AMT05"))* 100,1)));
					ds_chart.setColumn(5,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT06")/ds_list.getSum("AMT06"))* 100,1)));
					ds_chart.setColumn(6,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT07")/ds_list.getSum("AMT07"))* 100,1)));
					ds_chart.setColumn(7,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT08")/ds_list.getSum("AMT08"))* 100,1)));
					ds_chart.setColumn(8,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT09")/ds_list.getSum("AMT09"))* 100,1)));
					ds_chart.setColumn(9,  "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT10")/ds_list.getSum("AMT10"))* 100,1)));
					ds_chart.setColumn(10, "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT11")/ds_list.getSum("AMT11"))* 100,1)));
					ds_chart.setColumn(11, "value_"+nNum, (Math.round((ds_list.getColumn(i,"AMT12")/ds_list.getSum("AMT12"))* 100,1)));
					nNum++;
				}
			}
		}		
		//trace(ds_chart.saveXML());
		
		var arrArg,arrSer;
		
		//---------------------------------------------
		// arrArg : 차트속성
		// caption		- 차트제목
		// xAxisName	- X축의 명
		// yAxisName	- Y축의 명
		// showValues	- 0 : 차트에 값 표시 안함
		//---------------------------------------------
		arrArg = ["caption",strTitle,"xAxisName","","yAxisName","구성비","showValues","0","rotateYAxisName","0","formatNumberScale","0","useRoundEdges","1","numberSuffix","%"];
		
		//---------------------------------------------
		// arrSer : 그룹속성(3개씩 셋트)
		// [그룹명,Y축값컬럼명,그룹속성, ...]
		// 다중차트는 그룹속성을 설정안함.
		//---------------------------------------------
		strSer = strSer.substr(0,strSer.length-1);
		//trace(strSer);
		arrSer = eval("[" + strSer + "]");
		
		gfn_MultiChart(fu_ct01,"MSLine",ds_chart,"label",arrSer,arrArg,"",null);
	}
	// 전년동월
	else
	{	
		var bColChk;			
		bColChk = ds_chart.getColumnInfo("value_1");
		if(gfn_isNull(bColChk)) ds_chart.addColumn("value_1", "BIGDECIMAL", 39);
		bColChk = ds_chart.getColumnInfo("value_2");
		if(gfn_isNull(bColChk)) ds_chart.addColumn("value_2", "BIGDECIMAL", 39);
		bColChk = ds_chart.getColumnInfo("value_3");
		if(gfn_isNull(bColChk)) ds_chart.addColumn("value_3", "BIGDECIMAL", 39);
		bColChk = ds_chart.getColumnInfo("value_4");
		if(gfn_isNull(bColChk)) ds_chart.addColumn("value_4", "BIGDECIMAL", 39);
					
		if (strSType == "3")
		{
			//trace(ds_list.saveXML());
			var strTitle = "대분류별 전년동월 비교";			
			var nRow;
										
			ds_list.filter("");
			var strSer = "";
			for(var i=0; i<ds_list.rowcount; i++) 
			{
				// 원래 데이타가 아닐때만
				if(ds_list.getRowLevel(i) != 0)
				{
					nRow = ds_chart.addRow();
					ds_chart.setColumn(nRow, "label", ds_list.getColumn(i-1,"CLASS_NAME1"));					
					
					ds_chart.setColumn(nRow, "value_1", ds_list.getColumn(i,"AMT01"));
					ds_chart.setColumn(nRow, "value_2", (Math.round((ds_list.getColumn(i,"AMT01")/ds_list.getSum("AMT01"))* 100,1)));
					ds_chart.setColumn(nRow, "value_3", ds_list.getColumn(i,"AMT02"));
					ds_chart.setColumn(nRow, "value_4", (Math.round((ds_list.getColumn(i,"AMT02")/ds_list.getSum("AMT02"))* 100,1)));
				}
			}
		}
		else
		{
			var strTitle = "중분류별 전년동월 비교";			
			var nRow;
			
			ds_list.filter("CLASS_CODE1 == '" + cbo_CLASS_CODE1.value + "'");
			var nNum = 1;
			var strSer = "";
			for(var i=0; i<ds_list.rowcount; i++) 
			{
				// 원래 데이타만
				if(ds_list.getRowLevel(i) == 0)
				{
					nRow = ds_chart.addRow();
					ds_chart.setColumn(nRow, "label", ds_list.getColumn(i,"CLASS_NAME2"));					
					
					ds_chart.setColumn(nRow, "value_1", ds_list.getColumn(i,"AMT01"));
					ds_chart.setColumn(nRow, "value_2", (Math.round((ds_list.getColumn(i,"AMT01")/ds_list.getSum("AMT01"))* 100,1)));
					ds_chart.setColumn(nRow, "value_3", ds_list.getColumn(i,"AMT02"));
					ds_chart.setColumn(nRow, "value_4", (Math.round((ds_list.getColumn(i,"AMT02")/ds_list.getSum("AMT02"))* 100,1)));
				}
			}
		}
		
		var arrArg,arrSer;
		
		//---------------------------------------------
		// arrArg : 차트속성
		// caption		- 차트제목
		// xAxisName	- X축의 명
		// yAxisName	- Y축의 명
		// showValues	- 0 : 차트에 값 표시 안함
		//---------------------------------------------
		arrArg = ["caption",strTitle,"xAxisName","","yAxisName","","PYAxisName", "금액\n(원)","SYAxisName", "구성비","showValues","0","rotateYAxisName","0","showNames", "1","formatNumberScale","0","useRoundEdges","1","snumberSuffix","%"];
		
		//---------------------------------------------
		// arrSer : 그룹속성(3개씩 셋트)
		// [그룹명,Y축값컬럼명,그룹속성, ...]
		// 그룹속성	- renderAs='Area' : 표시형식을 Area로, renderAs='Line' : 표시형식을 선으로
		//---------------------------------------------
		// Y축 시리즈 셋팅
		var strYear 	= gfn_left(opener.ds_input.getColumn(0,"DATE3"),4);
		var strPreYear	= gfn_left(gfn_addMonth(strYear+"0101",-12),4);
				
		arrSer = [strPreYear+" 금액","value_1","",strPreYear+" 구성비","value_2","parentYAxis='S'",strYear+" 금액","value_3","",strYear+" 구성비","value_4","parentYAxis='S'"];
		
		gfn_MultiChart(fu_ct01,"MSCombiDY2D",ds_chart,"label",arrSer,arrArg,"",null);
	}
}	

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : rdo_SType_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
 * 기      능   : Chart DisPlay
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-02-15  
 ******************************************************************************************
 */
function rdo_SType_OnChanged(obj:Radio, e:ItemChangeEventInfo)
{
	if (e.postvalue == "1")
	{
		st_CLASS_CODE1.visible 	= false;
		cbo_CLASS_CODE1.visible = false;
		
		fn_Chart_Display2(fstrStype);
	}
	else
	{
		st_CLASS_CODE1.visible 	= true;
		cbo_CLASS_CODE1.visible = true;
		
		fn_Chart_Display2(fstrSTypeSub);
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : rdo_SType_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
 * 기      능   : Chart DisPlay
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-02-15  
 ******************************************************************************************
 */
function cbo_CLASS_CODE1_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	fn_Chart_Display2(fstrSTypeSub);
}

function fn_Close(obj:Button,  e:ClickEventInfo)
{
	this.close();
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_ChartData_Make(strSType)
 * 입      력   : strSType :  자료구분
 * 반      환   : 없음
 * 기      능   : chart데이터 생성함수
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-03  
 ******************************************************************************************
 */
function fn_ChartData_Make(strSType)
{
	var strFilter;
	
	// 1. MasterData생성
	if (strSType == "1" || strSType == "2" || strSType == "3")	// 1.1대분류
	{
		strFilter = "LEVEL_NO='1'";
	}
	else														// 1.2중분류
	{
		strFilter = "LEVEL_NO='2' && CLASS_CODE1=" + wrapQuote(cbo_CLASS_CODE1.value);
	}
	ds_list.filter(strFilter);
	
	// 2. ChartData
	if (strSType == "1" || strSType == "4")			// 2.1 기간
	{
		CopyF(ds_Chart1,ds_list);
	}
	else if (strSType == "2" || strSType == "5")	// 2.2 연누계
	{
		CopyF(ds_ChartY,ds_list);
		
		// Chart Data
		for(i=0; i<ds_ChartY.rowcount; i++)
		{
			strCol = "RATE_" + ds_ChartY.getColumn(i,"CLASS_CODE" + iif(strSType == "2","1","2"));
			
			ds_Chart1.addColumn(strCol);
			
			for(j=1; j<=12; j++)
			{
				if (i==0) ds_Chart1.addRow();
				
				nValue = ds_ChartY.getColumn(i,"RATE" + iif(j<10 , "0"+j , j));
				ds_Chart1.setColumn(j-1,strCol,nValue);
			}	
		}
	}
	else											// 2.3 전년동월
	{
		CopyF(ds_ChartX,ds_list);
		CopyF(ds_Chart1,ds_list);
		
	}
}		
			
/*
 ******************************************************************************************
 * 함  수  명   : fn_Chart_Display()
 * 입      력   : strSType :  자료구분
 * 반      환   : 없음
 * 기      능   : Chart
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-02-15  
 ******************************************************************************************
 */
function fn_Chart_Display(strSType)
{	
	var strTitle,strCol;
	fn_ChartData_Make(strSType);
	
	if (strSType == "1" || strSType == "4")		// 기간
	{
		if (strSType == "1")
		{
			strTitle = "대분류별 사용비율";
			strCol	 = "1";
		}
		else
		{
			strTitle = "중분류별 사용비율";
			strCol	 = "2";
		}
		
		fu_ct01.Clear();
	
		// chart기본값 셋팅
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("caption", strTitle);
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("baseFont", "굴림");
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("baseFontSize", "12");
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("showPercentageValues", "1");
	
		var f_xmldata = "";
		var strCode,strName;
	
		/* AddSingleDataset은 지원되지 않는 메서드입니다.*/ fu_ct01.AddSingleDataset("ds_Chart1", "RATE", "CLASS_NAME" + strCol);
		
		f_xmldata = fu_ct01.MakeChartData();
		
		var strDir = AliasToRealPath("%COMPONENT%");
		
		fu_ct01.Movie = strDir + "\\F_Chart\\Doughnut2D.swf";
		
		
		fu_ct01.SetVariable('dataXML', f_xmldata);
		fu_ct01.SetVariable('chartWidth', fu_ct01.position.width);	// chart size 지정
		fu_ct01.SetVariable('chartHeight', fu_ct01.position.height);	// chart size 지정
		
		//fu_ct01.SetVariable('debugMode', "1");			// 디버그모드
		
		fu_ct01.Rewind();
		fu_ct01.Play();
	}
	else if (strSType == "2" || strSType == "5")				// 연누계
	{
		if (strSType == "2")
		{
			strTitle = "대분류별 사용비율";
			strCol	 = "1";
		}
		else
		{
			strTitle = "중분류별 사용비율";
			strCol	 = "2";
		}
		
		fu_ct01.Clear();
	
		// chart기본값 셋팅
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("yAxisName", "구성비");
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("rotateYAxisName", "0");
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("showNames", "1");
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("formatNumberScale", '0');
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("useRoundEdges","1");
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("caption", strTitle);
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("baseFont", "굴림");
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("baseFontSize", "12");
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("numberSuffix", "%");
		
		var f_xmldata = "";
		var strCode,strName;
	
		// X축값셋팅 
		for(i=1; i<=12; i++)
		{
			strCode = iif(i<10 , "0"+i , i);
			/* AddCategory은 지원되지 않는 메서드입니다.*/ fu_ct01.AddCategory(i + "월",'hoverText', i + "월"); 
		}
		
		// Y축 시리즈 셋팅
		//trace(ds_ChartY.SaveXML());
		for(i=0; i<ds_ChartY.rowcount; i++)
		{
			strCode = ds_ChartY.getColumn(i,"CLASS_CODE" + strCol);
			strName = ds_ChartY.getColumn(i,"CLASS_NAME" + strCol);
			/* AddDataset은 지원되지 않는 메서드입니다.*/ fu_ct01.AddDataset("ds_Chart1", "RATE_"+strCode,"seriesName", strName, "color",null, 'showValues', '0');
		}
		
		f_xmldata = fu_ct01.MakeChartData();
	
		
		var strDir = AliasToRealPath("%COMPONENT%");
		
		fu_ct01.Movie = strDir + "\\F_Chart\\MSLine.swf";
		
		
		fu_ct01.SetVariable('dataXML', f_xmldata);
		fu_ct01.SetVariable('chartWidth', fu_ct01.position.width);	// chart size 지정
		fu_ct01.SetVariable('chartHeight', fu_ct01.position.height);	// chart size 지정
		
		//fu_ct01.SetVariable('debugMode', "1");			// 디버그모드
		
		fu_ct01.Rewind();
		fu_ct01.Play();
	}
	else						// 전년동월-대분류
	{
		if (strSType == "3")
		{
			strTitle = "대분류별 전년동월 비교";
			strCol	 = "1";
		}
		else
		{
			strTitle = "중분류별 전년동월 비교";
			strCol	 = "2";
		}
		
		fu_ct01.Clear();
	
		// chart기본값 셋팅
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("PYAxisName", "금액\n(원)");
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("SYAxisName", "구성비");
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("rotateYAxisName", "0");
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("showNames", "1");
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("formatNumberScale", '0');
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("useRoundEdges","1");
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("caption", strTitle);
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("baseFont", "굴림");
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("baseFontSize", "12");
		/* AddPropValue은 지원되지 않는 메서드입니다.*/ fu_ct01.AddPropValue("snumberSuffix", "%");
	
		var f_xmldata = "";
		var strCode,strName;
	
		// X축값셋팅
		for(i=0; i<ds_ChartX.rowcount; i++)
		{
			strName = ds_ChartX.getColumn(i,"CLASS_NAME" + strCol);
			/* AddCategory은 지원되지 않는 메서드입니다.*/ fu_ct01.AddCategory(strName,'hoverText', strName); 
		}
		
		// Y축 시리즈 셋팅
		var strYear 	= gfn_left(parent.ds_input.getColumn(0,"DATE3"),4);
		var strPreYear	= gfn_left(gfn_addMonth(strYear+"0101",-12),4);
		
		/* AddDataset은 지원되지 않는 메서드입니다.*/ fu_ct01.AddDataset("ds_Chart1", "AMT01","seriesName", strPreYear +" 금액", "color",null, 'showValues', '0');
		/* AddDataset은 지원되지 않는 메서드입니다.*/ fu_ct01.AddDataset("ds_Chart1", "RATE01","seriesName", strPreYear +" 구성비", "color",null, 'showValues', '0',"parentYAxis",'S');
		/* AddDataset은 지원되지 않는 메서드입니다.*/ fu_ct01.AddDataset("ds_Chart1", "AMT02","seriesName", strYear +" 금액", "color",null, 'showValues', '0');
		/* AddDataset은 지원되지 않는 메서드입니다.*/ fu_ct01.AddDataset("ds_Chart1", "RATE02","seriesName", strYear +" 구성비", "color",null, 'showValues', '0',"parentYAxis",'S');
		
		f_xmldata = fu_ct01.MakeChartData();
	
		
		var strDir = AliasToRealPath("%COMPONENT%");
		
		fu_ct01.Movie = strDir + "\\F_Chart\\MSCombiDY2D.swf ";
		
		
		fu_ct01.SetVariable('dataXML', f_xmldata);
		fu_ct01.SetVariable('chartWidth', fu_ct01.position.width);	// chart size 지정
		fu_ct01.SetVariable('chartHeight', fu_ct01.position.height);	// chart size 지정
		
		//fu_ct01.SetVariable('debugMode', "1");			// 디버그모드
		
		fu_ct01.Rewind();
		fu_ct01.Play();
	}
}
]]></Script>
  </Form>
</FDL>

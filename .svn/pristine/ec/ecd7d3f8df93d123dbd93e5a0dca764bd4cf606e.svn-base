<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="StdRecipeStcs" onkeydown="frm_OnKeyDown" onload="form_onload" titletext="레시피 통계" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static58" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 123" anchor="left top right"/>
        <Static id="st10" text="사 업 장" position="absolute 437 40 518 61" class="sta_WFSA_label"/>
        <Edit autoselect="true" id="ed_UPJANG_NM" imemode="none" onkeydown="fn_Pop_OnKeyDown" readonly="true" taborder="3" userdata="btn_upjang" position="absolute 557 40 664 61"/>
        <Button id="btn_upjang" onclick="btn_upjang_OnClick" taborder="4" position="absolute 663 40 685 61" class="btn_WF_popSearch" text="" image=""/>
        <MaskEdit id="me_FROM_DT" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkeydown="fn_Pop_OnKeyDown" onkillfocus="g_Date_OnKillFocus" taborder="16" type="string" userdata="btn_FROM_DT" position="absolute 557 92 636 113"/>
        <Button id="btn_FROM_DT" onclick="g_CalButton_OnClick" taborder="17" userdata="me_FROM_DT" position="absolute 635 92 656 113" class="btn_WF_cal" text="" image=""/>
        <MaskEdit id="me_TO_DT" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkeydown="fn_Pop_OnKeyDown" onkillfocus="g_Date_OnKillFocus" taborder="18" type="string" userdata="btn_TO_DT" position="absolute 676 92 755 113"/>
        <Button id="btn_TO_DT" onclick="g_CalButton_OnClick" taborder="19" userdata="me_TO_DT" position="absolute 754 92 775 113" class="btn_WF_cal" text="" image=""/>
        <Static id="Static2" text="제 공 일" position="absolute 17 92 98 113" class="sta_WFSA_label"/>
        <Static id="Static7" text="~" position="absolute 662 92 670 113"/>
        <Combo id="cbo_JOB" index="0" innerdataset="ds_JOB" type="NOTFILTERED" taborder="1" position="absolute 84 40 187 61" displayrowcount="20"/>
        <Static id="Static02" text="직     군" position="absolute 17 40 98 61" class="sta_WFSA_label"/>
        <Static id="Static0" text="상세직군" position="absolute 219 40 300 61" class="sta_WFSA_label"/>
        <Combo id="cbo_SubJob" index="0" innerdataset="ds_SUB_JOB" type="NOTFILTERED" taborder="2" position="absolute 301 40 404 61" displayrowcount="20"/>
        <Static id="Static1" text="식 당 군" position="absolute 717 40 798 61" class="sta_WFSA_label"/>
        <Combo codecolumn="HALL_CLASS" datacolumn="HALL_CLASS_NAME" displayrowcount="20" id="cbo_HALL_CLASS" innerdataset="ds_UP_HALL_CLASS" taborder="5" position="absolute 798 40 901 61"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" id="cbo_MEAL" index="0" innerdataset="ds_MEAL" taborder="6" position="absolute 1001 40 1106 61" displayrowcount="20"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" id="cbo_CORNER" index="0" innerdataset="ds_CORNER" taborder="7" position="absolute 84 66 187 87" displayrowcount="20"/>
        <Static id="Static3" text="코     너" position="absolute 17 66 98 87" class="sta_WFSA_label"/>
        <Static id="Static4" text="끼     니" position="absolute 933 40 1014 61" class="sta_WFSA_label"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" id="cbo_RECIPE_CLASS" index="0" innerdataset="ds_RecipeClass" type="NOTFILTERED" taborder="8" position="absolute 301 66 404 87" displayrowcount="20"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" id="cbo_RECIPE_TYPE" index="0" innerdataset="ds_RECIPE_TYPE" type="NOTFILTERED" taborder="9" position="absolute 557 66 664 87" displayrowcount="20"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" id="cbo_CUISINE_TYPE" index="0" innerdataset="ds_CUISINE_TYPE" type="NOTFILTERED" taborder="10" position="absolute 798 66 901 87" displayrowcount="20"/>
        <Static id="Static5" text="레시피분류" position="absolute 219 66 300 87" class="sta_WFSA_label"/>
        <Static id="Static6" text="레시피유형" position="absolute 437 66 518 87" class="sta_WFSA_label"/>
        <Static id="Static8" text="레시피명" position="absolute 933 66 1014 87" class="sta_WFSA_label"/>
        <Static id="Static9" text="조리법유형" position="absolute 717 66 798 87" class="sta_WFSA_label"/>
        <Edit id="ed_RECIPE_NAME" taborder="11" position="absolute 1001 66 1106 87"/>
        <MaskEdit id="med_FROM_MENU_DATE" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkeydown="fn_Pop_OnKeyDown" onkillfocus="g_Date_OnKillFocus" taborder="12" type="string" userdata="btn_FROM_MENU_DATE" position="absolute 84 92 163 113"/>
        <Button id="btn_FROM_MENU_DATE" onclick="g_CalButton_OnClick" taborder="13" userdata="med_FROM_MENU_DATE" position="absolute 162 92 183 113" class="btn_WF_cal" text="" image=""/>
        <Static id="Static10" text="~" position="absolute 188 92 196 113"/>
        <MaskEdit id="med_TO_MENU_DATE" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkeydown="fn_Pop_OnKeyDown" onkillfocus="g_Date_OnKillFocus" taborder="14" type="string" userdata="btn_TO_MENU_DATE" position="absolute 201 92 280 113"/>
        <Button id="btn_TO_MENU_DATE" onclick="g_CalButton_OnClick" taborder="15" userdata="med_TO_MENU_DATE" position="absolute 279 92 300 113" class="btn_WF_cal" text="" image=""/>
        <Static id="Static11" text="레시피최초개발일" position="absolute 437 92 569 113" class="sta_WFSA_label"/>
        <Tab id="tab_Main" onchanged="tab_Main_OnChanged" onclick="g_Date_OnFocus" preload="true" taborder="20" position="absolute 0 138 1237 710" showextrabutton="false" tabindex="0" anchor="all">
          <Tabpages>
            <Tabpage id="tab1" taborder="1" text="사용횟수" url="U_FSR::FSR00131V.xfdl" position="absolute 2 24 975 502" scrollbars="none"/>
            <Tabpage id="tab2" taborder="32" text="자재평균소요량" url="U_FSR::FSR00132V.xfdl" position="absolute 2 24 975 502" scrollbars="none"/>
            <Tabpage id="tab3" taborder="43" text="자재평균소요량(업장표준레시피)" url="U_FSR::FSR00133V.xfdl" position="absolute 2 24 975 502" scrollbars="none"/>
          </Tabpages>
        </Tab>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="21" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static15" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 123 450 138"/>
        <Static id="Static70" text="W10" visible="false" position="absolute 15 30 278 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static12" text="W10" visible="false" position="absolute 15 113 278 123" style="background:#ff000055;align:center middle;"/>
        <Static id="Static72" text="W15" visible="false" position="absolute 0 30 15 123" style="background:#ff000055;align:center middle;"/>
        <Static id="Static82" text="W05." visible="false" position="absolute 15 61 248 66" style="background:#ff000055;align:center middle;"/>
        <Static id="Static94" text="W05." visible="false" position="absolute 15 87 248 92" style="background:#ff000055;align:center middle;"/>
        <Static id="Static13" text="W10" visible="false" position="absolute 74 40 84 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static14" text="W10" visible="false" position="absolute 74 66 84 87" style="background:#ff000055;align:center middle;"/>
        <Static id="Static16" text="W10" visible="false" position="absolute 74 92 84 113" style="background:#ff000055;align:center middle;"/>
        <Static id="Static17" text="W30" visible="false" position="absolute 187 40 217 113" style="background:#ff000055;align:center middle;"/>
        <Static id="Static19" text="W10" visible="false" position="absolute 291 68 301 89" style="background:#ff000055;align:center middle;"/>
        <Static id="Static20" text="W10" visible="false" position="absolute 291 42 301 63" style="background:#ff000055;align:center middle;"/>
        <Static id="Static21" text="W30" visible="false" position="absolute 404 42 434 115" style="background:#ff000055;align:center middle;"/>
        <Static id="Static22" text="W10" visible="false" position="absolute 547 94 557 115" style="background:#ff000055;align:center middle;"/>
        <Static id="Static23" text="W10" visible="false" position="absolute 547 68 557 89" style="background:#ff000055;align:center middle;"/>
        <Static id="Static24" text="W10" visible="false" position="absolute 547 42 557 63" style="background:#ff000055;align:center middle;"/>
        <Static id="Static25" text="W30" visible="false" position="absolute 685 42 715 115" style="background:#ff000055;align:center middle;"/>
        <Static id="Static26" text="W10" visible="false" position="absolute 788 42 798 63" style="background:#ff000055;align:center middle;"/>
        <Static id="Static27" text="W10" visible="false" position="absolute 788 68 798 89" style="background:#ff000055;align:center middle;"/>
        <Static id="Static28" text="W30" visible="false" position="absolute 901 42 931 115" style="background:#ff000055;align:center middle;"/>
        <Static id="Static29" text="W10" visible="false" position="absolute 991 42 1001 63" style="background:#ff000055;align:center middle;"/>
        <Static id="Static30" text="W10" visible="false" position="absolute 991 68 1001 89" style="background:#ff000055;align:center middle;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_input" oncolumnchanged="ds_input_OnColumnChanged">
        <ColumnInfo>
          <Column id="JOB_CD" size="256" type="STRING"/>
          <Column id="SUB_JOB" size="256" type="STRING"/>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="UPJANG_NM" size="256" type="STRING"/>
          <Column id="HALL_CLASS" size="256" type="STRING"/>
          <Column id="MEAL" size="256" type="STRING"/>
          <Column id="CORNER" size="256" type="STRING"/>
          <Column id="RECIPE_CLASS" size="256" type="STRING"/>
          <Column id="RECIPE_TYPE" size="256" type="STRING"/>
          <Column id="CUISINE_TYPE" size="256" type="STRING"/>
          <Column id="RECIPE_NAME" size="256" type="STRING"/>
          <Column id="FROM_MENU_DATE" size="256" type="STRING"/>
          <Column id="TO_MENU_DATE" size="256" type="STRING"/>
          <Column id="FROM_DT" size="256" type="STRING"/>
          <Column id="TO_DT" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_JOB"/>
      <Dataset id="ds_SUB_JOB"/>
      <Dataset id="ds_UP_HALL_CLASS"/>
      <Dataset id="ds_MEAL2">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CORNER2">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_MEAL1">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CORNER1">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CORNER">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_MEAL">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_RecipeClass">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_RecipeClass1">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_RecipeClass2">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_RECIPE_TYPE">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CUISINE_TYPE">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SUB_JOB1"/>
      <Dataset id="ds_UP_HALL_CLASS1"/>
    </Objects>
    <Bind>
      <BindItem id="ed_UPJANG_NM_value" compid="ed_UPJANG_NM" propid="value" datasetid="ds_input" columnid="UPJANG_NM"/>
      <BindItem id="me_FROM_DT_value" compid="me_FROM_DT" propid="value" datasetid="ds_input" columnid="FROM_DT"/>
      <BindItem id="me_TO_DT_value" compid="me_TO_DT" propid="value" datasetid="ds_input" columnid="TO_DT"/>
      <BindItem id="cbo_JOB_value" compid="cbo_JOB" propid="value" datasetid="ds_input" columnid="JOB_CD"/>
      <BindItem id="cbo_SubJob_value" compid="cbo_SubJob" propid="value" datasetid="ds_input" columnid="SUB_JOB"/>
      <BindItem id="cbo_HALL_CLASS_value" compid="cbo_HALL_CLASS" propid="value" datasetid="ds_input" columnid="HALL_CLASS"/>
      <BindItem id="cbo_MEAL_value" compid="cbo_MEAL" propid="value" datasetid="ds_input" columnid="MEAL"/>
      <BindItem id="cbo_CORNER_value" compid="cbo_CORNER" propid="value" datasetid="ds_input" columnid="CORNER"/>
      <BindItem id="cbo_RECIPE_CLASS_value" compid="cbo_RECIPE_CLASS" propid="value" datasetid="ds_input" columnid="RECIPE_CLASS"/>
      <BindItem id="cbo_RECIPE_TYPE_value" compid="cbo_RECIPE_TYPE" propid="value" datasetid="ds_input" columnid="RECIPE_TYPE"/>
      <BindItem id="cbo_CUISINE_TYPE_value" compid="cbo_CUISINE_TYPE" propid="value" datasetid="ds_input" columnid="CUISINE_TYPE"/>
      <BindItem id="ed_RECIPE_NAME_value" compid="ed_RECIPE_NAME" propid="value" datasetid="ds_input" columnid="RECIPE_NAME"/>
      <BindItem id="med_FROM_MENU_DATE_value" compid="med_FROM_MENU_DATE" propid="value" datasetid="ds_input" columnid="FROM_MENU_DATE"/>
      <BindItem id="med_TO_MENU_DATE_value" compid="med_TO_MENU_DATE" propid="value" datasetid="ds_input" columnid="TO_MENU_DATE"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
 ******************************************************************************************
 * 시스템구분   : 메뉴관리/레시피관리/레시피 통계
 * 프로그램명   : FSR00130V
 * 기      능   : 레시피 통계
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-02-12
 * 비      고   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    : 박용대 2014-09-12 CH201409_00125 요청자:서비스1팀
 *              시스템 과부하로 인해 조회조건 15일로 제한
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
include "U_lib::lib_conversionCom.xjs";
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::lib_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"
//@@컨버터에서 주석처리 #include "lib::fs_common.js"
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);
	
	// 업데이트 DS
	//v_ds_check = "ds_list";
	
	// X-Framework : Action 정보 생성 
	fsp_init(this);
	
	// 공통코드조회
	fn_InitSearch();
	
	// 초기값 셋팅
	var strDt = fn_CurrDateWeek();
	ds_input.setColumn(0,"FROM_MENU_DATE",strDt);							// 일자
	ds_input.setColumn(0,"TO_MENU_DATE",strDt);								// 일자
	//콤보초기화
	gfn_initCombo(ds_input, "JOB_CD", cbo_JOB);
	gfn_initCombo(ds_input, "SUB_JOB", cbo_SubJob);
	gfn_initCombo(ds_input, "HALL_CLASS", cbo_HALL_CLASS);
	gfn_initCombo(ds_input, "MEAL", cbo_MEAL);
	gfn_initCombo(ds_input, "CORNER", cbo_CORNER);
	gfn_initCombo(ds_input, "RECIPE_CLASS", cbo_RECIPE_CLASS);
	gfn_initCombo(ds_input, "RECIPE_TYPE", cbo_RECIPE_TYPE);
	gfn_initCombo(ds_input, "CUISINE_TYPE", cbo_CUISINE_TYPE);
}

function frm_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
}
//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_search()
{

	/*============================================================================================
	(2014-09-12 추가) 시작
	박용대 2014-09-12 CH201409_00125 요청자:서비스1팀
	
	조건없는 조회기간으로 인해 서버의 과부하 발생
	쿼리가 원인인지 확인하기 위해 잠시 막아놓았다가
	파트장님 승인을 받고 형광매니저의 지시로 조회기간 15일 이상 제한함.
	또 변경시에는 파트장님 승인을 득할 것!
	참고로 아직 이 쿼리가 서버 과부하의 원인인지 100% 확인되진 않음
	참고로 해당 쿼리는 tab3의 fn_Search()함수임.
	============================================================================================*/
	var nDiffDays = gfn_getDiffDay(med_FROM_MENU_DATE.value,med_TO_MENU_DATE.value);
	if (  nDiffDays > 15)
	{
		gfn_alert("용량 문제로 인해 조회기간을 15일 이상 제한합니다.");
		return;
	}
	/*============================================================================================
	(2014-09-12 추가) 끝
	============================================================================================*/

	if(tab_Main.tabindex == 0)			// 사용횟수
	{
		tab_Main.tab1.fn_search();
	}
	else if(tab_Main.tabindex == 1)		// 자재평균소요량
	{
		tab_Main.tab2.fn_search();
	}
	else								// 자재평균소요량(업장표준레시피)
	{
		tab_Main.tab3.fn_search();
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Insert()
 * 기      능   : [입력버튼] 입력 시 처리되는 작업
 * 비      고	: 팝업사용
 ******************************************************************************************
 */
function fn_insert()
{
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Save()
 * 기      능   : [저장버튼] 저장 시 처리되는 작업
 ******************************************************************************************
 */
function fn_save()
{
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function fn_close()
{
	return true;
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_InitSearch()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 초기 공통코드조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-15
 ******************************************************************************************
 */
function fn_InitSearch()
{

	//직군코드
	fn_sql_common("C", strMAQuery_MAJOB,"","ORDER BY JOB_CD","",cbo_JOB,-1,ds_JOB);
	ds_JOB.insertRow(0);
	ds_JOB.setColumn(0,"JOB_CD","");
	ds_JOB.setColumn(0,"JOB_NAME","전체");
	cbo_JOB.index = 0;
	
	//SUB 직군코드
	fn_sql_common("C", strMAQuery_MASUBJOB,"","ORDER BY SUB_JOB_CD","",cbo_SubJob,-1,ds_SUB_JOB);
	ds_SUB_JOB.insertRow(0);
	ds_SUB_JOB.setColumn(0,"SUB_JOB_CD","");
	ds_SUB_JOB.setColumn(0,"SUB_JOB_NAME","전체");
	Copy(ds_SUB_JOB1,ds_SUB_JOB);
	cbo_SubJob.index = 0;
	
	// 식당군
	fn_SearchCommon("fs/fsc:FSC_UPJANG_HALL_CLASS_S001","","ds_UP_HALL_CLASS=ds_UP_HALL_CLASS","BLANK='A'");
	ds_UP_HALL_CLASS1.copyData(ds_UP_HALL_CLASS);
	
	// 공통코드 조회
	var v_fil_cond;
	var v_ds = fn_common_code("'FS0001','FS0002','FS0003','FS0023','FS0022'","","","all","Y");
	
	// 끼니(ds_MEAL, GROUP_CODE : 'FS0023')
	v_fil_cond = "GROUP_CODE == 'FS0023'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_MEAL,v_ds.name);
	CopyF(ds_MEAL1,v_ds.name);
	
	// 코너(ds_CORNER, GROUP_CODE : 'FS0022')
	v_fil_cond = "GROUP_CODE == 'FS0022'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_CORNER,v_ds.name);
	CopyF(ds_CORNER1,v_ds.name);
	
	// 레시피분류(ds_RecipeClass, GROUP_CODE : 'FS0001')
	v_fil_cond = "GROUP_CODE == 'FS0001'  && SET1 != 'H'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_RecipeClass,v_ds.name);
	CopyF(ds_RecipeClass1,v_ds.name);
	
	// 레시피유형(ds_RECIPE_TYPE, GROUP_CODE : 'FS0002')
	v_fil_cond = "GROUP_CODE == 'FS0002'  && SET1 != 'Y'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_RECIPE_TYPE,v_ds.name);
	
	// 조리법유형(ds_CUISINE_TYPE, GROUP_CODE : 'FS0003')
	v_fil_cond = "GROUP_CODE == 'FS0003'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_CUISINE_TYPE,v_ds.name);
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_SearchCommon(sqlId,inDS,outDS,otherArg)
 * 입      력   : sqlId = 실행할 sqlID
				  inDS	= input DS
				  outDS	= out DS
				  otherArg = arg
 * 반      환   : 없음
 * 기      능   : 코드조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-12  
 ******************************************************************************************
 */
function fn_SearchCommon(sqlId,inDS,outDS,otherArg)
{
	fsp_clear(this);
	fsp_addSearch(this, sqlId);
	http.Sync = true;
	fsp_callService(this, "", "", inDS, outDS ,otherArg, "");
	http.Sync = false;
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_SearchCheck()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 조회시 필수조회조건 체크
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-10  
 ******************************************************************************************
 */
function fn_SearchCheck()
{
	// 기간 - from
	if (gfn_length(ds_in.getColumn(0,"FROM_DT"))==0)
	{
		g_Message("EE", "기간을 입력하세요.");
		me_FROM_DT.setFocus();
		return false;
	}

	// 기간 -  to
	if (gfn_length(ds_in.getColumn(0,"TO_DT"))==0)
	{
		g_Message("EE", "기간을 입력하세요.");
		me_TO_DT.setFocus();
		return false;
	}

    return true;
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : grd_List_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
 * 기      능   : 그리드헤드 더블클릭시 Sort
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-18  
 ******************************************************************************************
 */
function grd_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_gridSort(obj, e); //(eval(obj.Binddataset), obj, nCell);
}

/*
 ******************************************************************************************
 * 함  수  명   : btn_upjang_OnClick(obj)
 * 기      능   : 팝업버튼 클릭 -> 사업장 조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-03  
 ******************************************************************************************
 */
function btn_upjang_OnClick(obj:Button, e:ClickEventInfo)
{
	var strWhere;
	
	// 직군
	if (gfn_length(cbo_JOB.value)>0)
	{
		strWhere += "  AND JOB_CD='" + cbo_JOB.value + "'";
	}
	// 상세직군
	if (gfn_length(cbo_SubJob.value)>0)
	{
		strWhere += "  AND SUB_JOB_CD='" + cbo_SubJob.value + "'";
	}
		
	fn_sql_common_setup( "SELECT A.UPJANG, A.UPJANGNM FROM MAC_UPJANG_V A WHERE (1=1)"
						,strQuery_UpjangKeyField
						,strQuery_UpjangValueField
						,strQuery_UpjangKeyFieldNM
						,strQuery_UpjangValueFieldNM
						,""
						,""
						,strWhere
						,strQuery_UpjangCaption
						,strQuery_UpjangAllField
						);
						
	ds_input.setColumn(0,"UPJANG_NM",gds_sql_common.getColumn(0, "ret_name"));
	ds_input.setColumn(0,"UPJANG",gds_sql_common.getColumn(0, "ret_code"));
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Pop_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
 * 기      능   : 팝업edit키입력시
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-03  
 ******************************************************************************************
 */
function fn_Pop_OnKeyDown(obj:MaskEdit, e:KeyEventInfo)
{
	if( e.keycode == 13 ) {
		if( gfn_length(gfn_trim(obj.value))== 0 ) {
			var objme = eval(obj.userdata);
			objme.click();
		}
	} else if( e.keycode == 46 ) {
		switch(obj.name) {
			case "ed_UPJANG_NM" :
				ds_input.setColumn(0, "UPJANG",    "");
				ds_input.setColumn(0, "UPJANG_NM", "");
				break;
			default :
				break;
		}
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : tab_Main_OnChanged(obj,nOldIndex,nNewindex)
 * 기      능   : 텝변경시 조회조건 셋팅
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-02-14  
 ******************************************************************************************
 */
function tab_Main_OnChanged(obj:Tab, e:TabIndexChangeEventInfo)
{
	var btp;
	
	if (e.postindex == 2)
	{
		btp = false;
	}
	else
	{
		btp = true;
	}
	
	med_FROM_MENU_DATE.enable = btp;
	btn_FROM_MENU_DATE.enable = btp;
	med_TO_MENU_DATE.enable = btp;
	btn_TO_MENU_DATE.enable = btp;
	cbo_MEAL.enable = btp;
	cbo_CORNER.enable = btp;
}

/*
 ******************************************************************************************
 * 함  수  명   : ds_input_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
 * 기      능   : 조회조건 변경시 조회조건 셋팅
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-02-14  
 ******************************************************************************************
 */
function ds_input_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if (e.columnid == "JOB_CD")	// 직군변경시
	{
		if (gfn_length(e.newvalue)==0)
		{
			Copy(ds_SUB_JOB,ds_SUB_JOB1);
			cbo_SubJob.index = 0;
		}
		else
		{
			//SUB 직군코드
			fn_sql_common("C", strMAQuery_MASUBJOB,"","AND JOB_CD = '" + e.newvalue + "'ORDER BY SUB_JOB_CD","",cbo_SubJob,-1,ds_SUB_JOB);
			ds_SUB_JOB.insertRow(0);
			ds_SUB_JOB.setColumn(0,"SUB_JOB_NAME","전체");
			cbo_SubJob.index = 0;
		}
	}
	
	if (e.columnid == "UPJANG")	// 사업장변경시
	{
		if (gfn_length(e.newvalue)==0)
		{
			Copy(ds_UP_HALL_CLASS,ds_UP_HALL_CLASS1);
			Copy(ds_MEAL,ds_MEAL1);
			Copy(ds_CORNER,ds_CORNER1);
			Copy(ds_RecipeClass,ds_RecipeClass1);
		}
		else
		{
			fn_SearchCommon("fs/fsc:FSC_UPJANG_HALL_CLASS_S001","","ds_UP_HALL_CLASS=ds_UP_HALL_CLASS","BLANK='A' UPJANG='" + e.newvalue + "'");
			fn_SearchCommon("fs/fsc:FSA_HALL_DTL_S001","","ds_MEAL=gds_Csqlout","nullyn='N' UPJANG='" + e.newvalue + "'");
			fn_SearchCommon("fs/fsc:FSA_HALL_DTL_S003","","ds_CORNER=gds_Csqlout","nullyn='N' UPJANG='" + e.newvalue + "'");
			fn_SearchCommon("fs/fsc:FSA_UPJANG_RECIPE_LINK_S002","","ds_RecipeClass=gds_Csqlout","nullyn='N' UPJANG='" + e.newvalue + "'");
		}
	}
	
	if (e.columnid == "MEAL")	// 끼니변경시
	{
		var strWhere,strUpjang;
		
		strUpjang = ds_input.getColumn(e.row,"UPJANG");
		
		if (gfn_length(strUpjang)== 0)
		{
			Copy(ds_CORNER,ds_CORNER1);
		}
		else
		{
			strWhere += "nullyn='N'";
			strWhere += " UPJANG='" + strUpjang + "'";
			
			if (gfn_length(e.newvalue)!=0)
			{
				strWhere += " MEAL='" + e.newvalue + "'";
			}
			
			fn_SearchCommon("fs/fsc:FSA_HALL_DTL_S003","","ds_CORNER=gds_Csqlout",strWhere);
		}
	}
	
	if (e.columnid == "RECIPE_TYPE")	// 레시피유형변경시
	{
		if (gfn_length(e.newvalue)==0)
		{
			ds_CUISINE_TYPE.filter("");
		}
		else
		{
			ds_CUISINE_TYPE.filter("gfn_length(CODE)==0 || SET1==" + wrapQuote(e.newvalue));
		}
	}
}
]]></Script>
  </Form>
</FDL>

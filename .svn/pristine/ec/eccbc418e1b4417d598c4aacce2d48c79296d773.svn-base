<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="SapSlipNonUpoadList" classname="CloseMgnt01" inheritanceid="" position="absolute 0 0 1251 725" titletext="SAP 미발행 전표현황" style="background:white;color:red;" onload="form_onload">
    <Layouts>
      <Layout>
        <Div id="div_cmnBtn" anchor="left top right" taborder="5" tabstop="false" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static58" class="sta_WFSA_Labelbg" position="absolute 0 30 1236 72" anchor="left top right"/>
        <Static id="Static70" text="H10" visible="false" position="absolute 15 30 1220 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static72" text="W15" visible="false" position="absolute 0 30 15 91" style="background:#ff000055;align:center middle;"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1251 725" anchor="left bottom"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1236 0 1251 710" anchor="top right"/>
        <Static id="Static28" text="회계월 " class="sta_WFSA_label" position="absolute 944 40 1014 61" anchor="left top" style="align:left middle;"/>
        <Static id="Static05" text="W15" visible="false" position="absolute 1220 30 1235 76" style="background:#ff000055;align:center middle;"/>
        <Static id="Static13" text="H10" visible="false" position="absolute 0 61 1205 71" style="background:#ff000055;align:center middle;"/>
        <Static id="Static56" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1 40 16 61" anchor="left top"/>
        <Static id="Static57" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 77 40 87 61" anchor="left top"/>
        <Static id="Static55" text="사업부" class="sta_WFSA_label" position="absolute 16 40 76 60" style="background:URL('theme://images/new/sta_WFSA_label.png') left middle;align:left middle;"/>
        <Static id="Static01" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 694 40 704 61" anchor="left top"/>
        <Static id="Static44" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 399 40 408 61" anchor="left top"/>
        <Static id="Static46" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 297 40 327 61" anchor="left top"/>
        <Static id="Static03" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 618 40 648 61" anchor="left top"/>
        <Static id="Static04" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 914 40 944 61" anchor="left top"/>
        <Static id="Static09" text="CC" class="sta_WFSA_label" position="absolute 648 40 718 60" style="background:URL('theme://images/new/sta_WFSA_label.png') left middle;align:left middle;"/>
        <Edit id="edt_tmCd" taborder="31" readonly="true" onkeydown="edt_tmNm_onkeydown" visible="false" position="absolute 407 725 617 746" anchor="left top right" tmCd=""/>
        <Edit id="edt_ccCd" taborder="32" readonly="true" autoselect="true" visible="false" position="absolute 717 725 927 746"/>
        <Edit id="edt_upjang" taborder="33" readonly="true" onkeydown="edt_upjangnm_onkeydown" visible="false" position="absolute 1027 725 1233 746" anchor="left top right" tmCd=""/>
        <ObjCalMonth id="cal_slipMon" titletext="월력" taborder="3" scrollbars="none" position="absolute 1015 40 1091 61"/>
        <Grid id="grd_list" taborder="4" binddataset="ds_list" useinputpanel="false" treeusecheckbox="false" treeinitstatus="expand,all" position="absolute 0 103 1236 710" anchor="all" autofittype="none" selecttype="row" oncelldblclick="grd_list_oncelldblclick" autosizingtype="none" cellsizingtype="col">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30" band="left"/>
                <Column size="50" band="left"/>
                <Column size="180" band="left"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="100"/>
                <Column size="90"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="90"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="90"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="20" band="head"/>
                <Row size="20" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel" taborder="undefined"/>
                <Cell col="1" colspan="2" text="CC" taborder="undefined"/>
                <Cell col="3" colspan="3" text="6A:단체급식매출" taborder="undefined"/>
                <Cell col="6" rowspan="2" text="6B:식재영업&#13;&#10;매출" taborder="undefined"/>
                <Cell col="7" rowspan="2" text="6C:식재도매&#13;&#10;매출" taborder="undefined"/>
                <Cell col="8" colspan="2" text="6D:외식사업매출" taborder="undefined"/>
                <Cell col="10" rowspan="2" text="6E:연구소&#13;&#10;매출" taborder="undefined"/>
                <Cell col="11" rowspan="2" text="6F:특판매출" taborder="undefined"/>
                <Cell col="12" rowspan="2" text="6G:물류매출" taborder="undefined"/>
                <Cell col="13" rowspan="2" text="6H:기타매출&#13;&#10;(POS외등)" taborder="undefined"/>
                <Cell col="14" rowspan="2" text="7A:입금관리" taborder="undefined"/>
                <Cell col="15" rowspan="2" text="7B:채권이관" taborder="undefined"/>
                <Cell col="16" rowspan="2" text="7C:선수금&#13;&#10;발생관리" taborder="undefined"/>
                <Cell col="17" rowspan="2" text="7D:대손처리" taborder="undefined"/>
                <Cell col="18" rowspan="2" text="7E:선수금&#13;&#10;이관" taborder="undefined"/>
                <Cell col="19" rowspan="2" text="7F:영업현금&#13;&#10;가수금대체" taborder="undefined"/>
                <Cell col="20" rowspan="2" text="7G:채권채무&#13;&#10;상계" taborder="undefined"/>
                <Cell col="21" rowspan="2" text="7H:기타입금&#13;&#10;대체" taborder="undefined"/>
                <Cell col="22" rowspan="2" text="7I:쿠폰/식권판매&#13;&#10;쿠폰기간경과" taborder="undefined"/>
                <Cell col="23" rowspan="2" text="7J:상품권&#13;&#10;청구" taborder="undefined"/>
                <Cell col="24" rowspan="2" text="8A:영업환불" taborder="undefined"/>
                <Cell col="25" rowspan="2" text="8B:원가이관&#13;&#10;(직원식대처리)" taborder="undefined"/>
                <Cell col="26" rowspan="2" text="8C:Helper" taborder="undefined"/>
                <Cell col="27" rowspan="2" text="8D:영업기타" taborder="undefined"/>
                <Cell col="28" rowspan="2" text="8O:내부이용&#13;&#10;(FC)" taborder="undefined"/>
                <Cell row="1" col="1" text="코드"/>
                <Cell row="1" col="2" text="코드명" taborder="undefined"/>
                <Cell row="1" col="3" text="FS사업"/>
                <Cell row="1" col="4" text="장례식장"/>
                <Cell row="1" col="5" text="매점POS" taborder="undefined"/>
                <Cell row="1" col="8" text="외식사업" taborder="undefined"/>
                <Cell row="1" col="9" text="외식POS"/>
              </Band>
              <Band id="body">
                <Cell style="align:center middle;" expr="currow+1"/>
                <Cell col="1" text="bind:ccCd"/>
                <Cell col="2" style="align:left middle;" text="bind:ccNm" suppress="0"/>
                <Cell col="3" style="background:EXPR(fn_setCellBgcolor(slip6a11));background2:EXPR(fn_setCellBgcolor(slip6a11));cursor:EXPR(fn_setCellCusor(slip6a11));" text="bind:slip6a11"/>
                <Cell col="4" style="background:EXPR(fn_setCellBgcolor(slip6a16));background2:EXPR(fn_setCellBgcolor(slip6a16));cursor:EXPR(fn_setCellCusor(slip6a16));" text="bind:slip6a16"/>
                <Cell col="5" style="background:EXPR(fn_setCellBgcolor(slip6a20));background2:EXPR(fn_setCellBgcolor(slip6a20));cursor:EXPR(fn_setCellCusor(slip6a20));" text="bind:slip6a20"/>
                <Cell col="6" style="background:EXPR(fn_setCellBgcolor(slip6b));background2:EXPR(fn_setCellBgcolor(slip6b));cursor:EXPR(fn_setCellCusor(slip6b));" text="bind:slip6b"/>
                <Cell col="7" style="background:EXPR(fn_setCellBgcolor(slip6c));background2:EXPR(fn_setCellBgcolor(slip6c));cursor:EXPR(fn_setCellCusor(slip6c));" text="bind:slip6c"/>
                <Cell col="8" style="background:EXPR(fn_setCellBgcolor(slip6d12));background2:EXPR(fn_setCellBgcolor(slip6d12));cursor:EXPR(fn_setCellCusor(slip6d12));" text="bind:slip6d12"/>
                <Cell col="9" style="background:EXPR(fn_setCellBgcolor(slip6d21));background2:EXPR(fn_setCellBgcolor(slip6d21));cursor:EXPR(fn_setCellCusor(slip6d21));" text="bind:slip6d21"/>
                <Cell col="10" style="background:EXPR(fn_setCellBgcolor(slip6e));background2:EXPR(fn_setCellBgcolor(slip6e));cursor:EXPR(fn_setCellCusor(slip6e));" text="bind:slip6e"/>
                <Cell col="11" style="background:EXPR(fn_setCellBgcolor(slip6f));background2:EXPR(fn_setCellBgcolor(slip6f));cursor:EXPR(fn_setCellCusor(slip6f));" text="bind:slip6f"/>
                <Cell col="12" style="background:EXPR(fn_setCellBgcolor(slip6g));background2:EXPR(fn_setCellBgcolor(slip6g));cursor:EXPR(fn_setCellCusor(slip6g));" text="bind:slip6g"/>
                <Cell col="13" style="background:EXPR(fn_setCellBgcolor(slip6h));background2:EXPR(fn_setCellBgcolor(slip6h));cursor:EXPR(fn_setCellCusor(slip6h));" text="bind:slip6h"/>
                <Cell col="14" style="background:EXPR(fn_setCellBgcolor(slip7a));background2:EXPR(fn_setCellBgcolor(slip7a));cursor:EXPR(fn_setCellCusor(slip7a));" text="bind:slip7a"/>
                <Cell col="15" style="background:EXPR(fn_setCellBgcolor(slip7b));background2:EXPR(fn_setCellBgcolor(slip7b));cursor:EXPR(fn_setCellCusor(slip7b));" text="bind:slip7b"/>
                <Cell col="16" style="background:EXPR(fn_setCellBgcolor(slip7c));background2:EXPR(fn_setCellBgcolor(slip7c));cursor:EXPR(fn_setCellCusor(slip7c));" text="bind:slip7c"/>
                <Cell col="17" style="background:EXPR(fn_setCellBgcolor(slip7d));background2:EXPR(fn_setCellBgcolor(slip7d));cursor:EXPR(fn_setCellCusor(slip7d));" text="bind:slip7d"/>
                <Cell col="18" style="background:EXPR(fn_setCellBgcolor(slip7e));background2:EXPR(fn_setCellBgcolor(slip7e));cursor:EXPR(fn_setCellCusor(slip7e));" text="bind:slip7e"/>
                <Cell col="19" style="background:EXPR(fn_setCellBgcolor(slip7f));background2:EXPR(fn_setCellBgcolor(slip7f));cursor:EXPR(fn_setCellCusor(slip7f));" text="bind:slip7f"/>
                <Cell col="20" style="background:EXPR(fn_setCellBgcolor(slip7g));background2:EXPR(fn_setCellBgcolor(slip7g));cursor:EXPR(fn_setCellCusor(slip7g));" text="bind:slip7g"/>
                <Cell col="21" style="background:EXPR(fn_setCellBgcolor(slip7h));background2:EXPR(fn_setCellBgcolor(slip7h));cursor:EXPR(fn_setCellCusor(slip7h));" text="bind:slip7h"/>
                <Cell col="22" style="background:EXPR(fn_setCellBgcolor(slip7i));background2:EXPR(fn_setCellBgcolor(slip7i));cursor:EXPR(fn_setCellCusor(slip7i));" text="bind:slip7i"/>
                <Cell col="23" style="background:EXPR(fn_setCellBgcolor(slip7j));background2:EXPR(fn_setCellBgcolor(slip7j));cursor:EXPR(fn_setCellCusor(slip7j));" text="bind:slip7j"/>
                <Cell col="24" style="background:EXPR(fn_setCellBgcolor(slip8a));background2:EXPR(fn_setCellBgcolor(slip8a));cursor:EXPR(fn_setCellCusor(slip8a));" text="bind:slip8a"/>
                <Cell col="25" style="background:EXPR(fn_setCellBgcolor(slip8b));background2:EXPR(fn_setCellBgcolor(slip8b));cursor:EXPR(fn_setCellCusor(slip8b));" text="bind:slip8b"/>
                <Cell col="26" style="background:EXPR(fn_setCellBgcolor(slip8c));background2:EXPR(fn_setCellBgcolor(slip8c));cursor:EXPR(fn_setCellCusor(slip8c));" text="bind:slip8c"/>
                <Cell col="27" style="background:EXPR(fn_setCellBgcolor(slip8d));background2:EXPR(fn_setCellBgcolor(slip8d));cursor:EXPR(fn_setCellCusor(slip8d));" text="bind:slip8d"/>
                <Cell col="28" style="background:EXPR(fn_setCellBgcolor(slip8o));background2:EXPR(fn_setCellBgcolor(slip8o));cursor:EXPR(fn_setCellCusor(slip8o));" text="bind:slip8o"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static22" text="미발행 내역" class="sta_WF_Title01" position="absolute 0 85 102 102" anchor="left top"/>
        <Static id="Static10" text="발행여부" class="sta_WFSA_label" position="absolute 29 733 90 754" anchor="left top" style="align:left middle;" visible="false"/>
        <Combo id="cbo_uploadYn" taborder="6" displaynulltext="선택" codecolumn="codecolumn" datacolumn="datacolumn" onitemchanged="cbo_slipType_onitemchanged" position="absolute 110 733 320 754" anchor="left top" class="cmb_WF_Essential" visible="false">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn"/>
                <Col id="datacolumn">전체</Col>
              </Row>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">발행</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">미발행</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Button id="btn_test8B" taborder="51" text="원가이관" onclick="fn_search8B" class="btn_WF_Custom" position="absolute 881 960 956 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Button id="btn_test8B00" taborder="52" text="Helper" onclick="fn_searchHelper" class="btn_WF_Custom" position="absolute 804 960 879 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Button id="btn_test8A" taborder="53" text="영업환불" onclick="fn_search8A" class="btn_WF_Custom" position="absolute 727 960 802 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Button id="btn_test8D" taborder="54" text="영업기타" onclick="fn_search8D" class="btn_WF_Custom" position="absolute 650 960 725 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Button id="btn_test8D_B03" taborder="55" text="채권상계" onclick="fn_search8D_B03" class="btn_WF_Custom" position="absolute 573 960 648 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Button id="btn_test8D_B17" taborder="56" text="대손처리" onclick="fn_search8D_B17" class="btn_WF_Custom" position="absolute 496 960 571 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Button id="btn_test7I" taborder="57" text="쿠폰" onclick="fn_search7I" class="btn_WF_Custom" position="absolute 419 960 494 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Button id="btn_test7I00" taborder="62" text="7A_11204014" onclick="fn_search7A_11204014" class="btn_WF_Custom" position="absolute 322 960 417 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Button id="btn_test" taborder="63" text="단체급식매출" onclick="fn_search2" class="btn_WF_Custom" position="absolute 1135 960 1230 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <Button id="btn_test100" taborder="64" text="100% 세금계산서 발행 전표" onclick="fn_search100" class="btn_WF_Custom" position="absolute 958 960 1133 985" anchor="left top" style="font:Gulim,9,bold;" visible="false"/>
        <TmSearchComponent id="TmSearchComponent01" titletext="팀 검색용 Component" taborder="1" text="TmSearchComponent00" position="absolute 408 40 618 61" bindDataset="ds_search" bindTmCdColumn="tmCd" bindTmNmColumn="tmNm" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tmChanged" eventBeforeTrigger="fn_tmBeforeEvent" isTeamControl="Y" class="edt_WF_Essential"/>
        <UpjangSearchComponent id="UpjangSearchComponent01" titletext="업장 검색용 Component" taborder="2" text="UpjangSearchComponent00" position="absolute 704 40 914 61" bindDataset="ds_search" bindUpjangCodeColumn="ccCd" bindUpjangNameColumn="ccNm" eventBeforeTrigger="fn_upjangBeforeEvent" eventAfterTrigger="" roleSetId=""/>
        <MuSearchComponent id="MuSearchComponent01" titletext="사업부 선택 Component" taborder="0" text="MuSearchComponent00" position="absolute 87 40 297 61" bindDataset="ds_search" bindMuCdColumn="muCd" appendText="선택" onItemChangedEvent="fn_muChanged" class="cmb_WF_Essential"/>
        <Static id="Static11" text="부서" class="sta_WFSA_label" position="absolute 327 39 379 60" anchor="left top"/>
        <CheckBox id="chk_yn" taborder="65" text="미발행만 표시" value="Y" truevalue="Y" falsevalue="N" visible="true" position="absolute 1099 40 1230 60" anchor="top right" style="font:Gulim,9,bold;"/>
        <Static id="Static02" text="※ 6H:기타매출(POS외 등) : 미발행 시 폐식용유 매출, 세금계산서 국세청전송완료 확인 필요" position="absolute 99 80 680 104" style="color:red;font:Gulim,9, bold;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">0</Col>
            <Col id="delYn">0</Col>
            <Col id="savYn">0</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">0</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="tmNm" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="upjangCd" type="STRING" size="256"/>
          <Column id="upjangNm" type="STRING" size="256"/>
          <Column id="slipMon" type="STRING" size="256"/>
          <Column id="closeYn" type="STRING" size="256"/>
          <Column id="loginSabun" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="slipDateFr" type="STRING" size="256"/>
          <Column id="slipDateTo" type="STRING" size="256"/>
          <Column id="slipType" type="STRING" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="slipTypeBySQL" type="STRING" size="256"/>
          <Column id="slipPeriodDate" type="STRING" size="256"/>
          <Column id="chkYn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_searchValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="slipMon" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="muCd">title:사업부,required:true</Col>
            <Col id="tmCd">title:팀,required:true</Col>
            <Col id="ccCd">title:업장(CC),required:false</Col>
            <Col id="slipMon">title:회계월,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="tmNm" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="slipMon" type="STRING" size="256"/>
          <Column id="slip6a11" type="STRING" size="256"/>
          <Column id="slip6a16" type="STRING" size="256"/>
          <Column id="slip6a20" type="STRING" size="256"/>
          <Column id="slip6b" type="STRING" size="256"/>
          <Column id="slip6c" type="STRING" size="256"/>
          <Column id="slip6d12" type="STRING" size="256"/>
          <Column id="slip6d21" type="STRING" size="256"/>
          <Column id="slip6e" type="STRING" size="256"/>
          <Column id="slip6f" type="STRING" size="256"/>
          <Column id="slip6g" type="STRING" size="256"/>
          <Column id="slip6h" type="STRING" size="256"/>
          <Column id="slip7a" type="STRING" size="256"/>
          <Column id="slip7b" type="STRING" size="256"/>
          <Column id="slip7c" type="STRING" size="256"/>
          <Column id="slip7d" type="STRING" size="256"/>
          <Column id="slip7e" type="STRING" size="256"/>
          <Column id="slip7f" type="STRING" size="256"/>
          <Column id="slip7g" type="STRING" size="256"/>
          <Column id="slip7h" type="STRING" size="256"/>
          <Column id="slip7i" type="STRING" size="256"/>
          <Column id="slip7j" type="STRING" size="256"/>
          <Column id="slip8a" type="STRING" size="256"/>
          <Column id="slip8b" type="STRING" size="256"/>
          <Column id="slip8c" type="STRING" size="256"/>
          <Column id="slip8d" type="STRING" size="256"/>
          <Column id="slip8o" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item3" compid="edt_tmCd" propid="value" datasetid="ds_search" columnid="tmCd"/>
      <BindItem id="item5" compid="edt_ccCd" propid="value" datasetid="ds_search" columnid="ccCd"/>
      <BindItem id="item7" compid="edt_upjang" propid="value" datasetid="ds_search" columnid="upjangCd"/>
      <BindItem id="item8" compid="cal_slipMon" propid="text" datasetid="ds_search" columnid="slipMon"/>
      <BindItem id="item10" compid="cbo_uploadYn" propid="value" datasetid="ds_search" columnid="slipType"/>
      <BindItem id="item0" compid="chk_yn" propid="value" datasetid="ds_search" columnid="chkYn"/>
    </Bind>
    <InitValue/>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : SapSlipNonUpoadList
  파 일 명 : SapSlipNonUpoadList.xfdl
  기    능 : SAP 미발행 전표현황

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.09.10   JUN      최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "lib::SMCommon.xjs";	//영업회계 공통 스크립트

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();
var fv_objColInfo;	//데이터셋 컬럼정보
var v_ds_check	= "";
var fv_orgHto = application.httptimeout;

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo){

	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init(){
	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	v_ds_check = "ds_list";

	//조회조건을 초기화한다.
	fn_clearSearch();
	chk_yn.value = 'Y';
	
	TmSearchComponent01.applyAuthLevel(MuSearchComponent01);
	UpjangSearchComponent01.setForcedRoleSet("CostCenter");
	UpjangSearchComponent01.applyAuthLevel(TmSearchComponent01);
	//전월
	fv_taxDay = gfn_getLastDate(gfn_addMonth(fv_sToday, -1));
	cal_slipMon.fn_initMonthCal(this, fv_taxDay.substring(0,6), "", ds_search, "slipMon", "Y");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close(){	
	// v_ds_check 사용시 변경사항 체크
	if(gfn_length(v_ds_check) != 0){	
	
		// v_ds_check 설정기준 변경사항 체크
		if(gfn_isDataChange() == true){
			if(!gfn_confirm("confirm.before.movepage")) return false;	// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
		}
	}
	return true;
}

/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수-공통버튼)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search(){

	// 조회시 Validation Check
	if(gfn_validCheck(ds_search, ds_searchValid, true) == false) return;

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_list);
    
    
    // 타임아웃 시간 변경
    application.httptimeout = 1800;	// 30분

	//서비스 쿼리결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장
	fv_objColInfo = gfn_getDatasetInfo (ds_list);

    gfn_transaction(this
					,"search"
					,"sm/srm/sapSlipNonUpoadList/selectList.xdo"
					,"ds_search=ds_search:A"
					,"ds_list=ds_list"
					,""
					,"fn_callBack"
					,true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert(){}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete(){}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save(){}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print(){}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help(){}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg){

	//타임아웃 시간 원복
	application.httptimeout = fv_orgHto;
	
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0){
		return;
	}

    switch(strSvcID){

        //조회
        case "search" :
			if(ds_list.getRowCount() == 0){ //서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				gfn_loadDatasetInfo (ds_list, fv_objColInfo);
			}else{
			
			}
            break;
    }
}

/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회조건 초기화
 *---------------------------------------------------------------------------------------------*/
function fn_clearSearch(){
    var nRow= ds_search.addRow();
    ds_search.setColumn(nRow, "muCd",       g_Mu_Cd);
    ds_search.setColumn(nRow, "tmCd",       g_Tm_Cd);
    ds_search.setColumn(nRow, "tmNm",       g_Tm_Nm);
    ds_search.setColumn(nRow, "ccCd",       g_Cc_Cd);
    ds_search.setColumn(nRow, "ccNm",       g_Cc_Nm);

	//달력 초기화
	cal_slipMon.fn_initMonthCal(this, gfn_getYear()+gfn_getMonth(), "", ds_search, "slipMon", "Y");
	fn_setGridColumn(g_Mu_Cd);

	// 본사FC회계팀 소속의 사용자와 관리자, 전산관리자, MU/BU 권한은 부서필수 제외
	if( g_Cc_Cd == "100540" || SCAuth.isAuthLevel("99") || SCAuth.isAuthLevel("999") || SCAuth.isAuthLevel("70") || SCAuth.isAuthLevel("80") )
	{
		TmSearchComponent01.edt_tmNm.class = "";
		TmSearchComponent01.btn_search.class = "btn_WF_popSearch";
		ds_searchValid.setColumn(0, "tmCd", "title:팀,required:false");
	}
	else
	{
		TmSearchComponent01.edt_tmNm.class = "edt_WF_Essential";
		TmSearchComponent01.btn_search.class = "btn_WF_popSearchEssential";
		ds_searchValid.setColumn(0, "tmCd", "title:팀,required:true");
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 그리드 색상 변경
 *---------------------------------------------------------------------------------------------*/
function fn_setCellBgcolor(arg){
	if(arg == "미발행"){
		return "#ffd2d2ff";
	}else{
		return "";
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 그리드 Cusor 변경
 *---------------------------------------------------------------------------------------------*/
function fn_setCellCusor(arg){
	if(arg == "미발행"){
		return "hand";
	}else{
		return "";
	}
}

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 사업부 변경시 부서, CC 초기화 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_muChanged(){
    ds_search.setColumn(0, "tmCd",  "");
    ds_search.setColumn(0, "tmNm",  "");
    ds_search.setColumn(0, "ccCd",  "");
    ds_search.setColumn(0, "ccNm",  "");
    fn_setGridColumn(ds_search.getColumn(0, "muCd"));
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 팀(부서)의 팝업을 호출하기 전에 발생되는 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_tmBeforeEvent(obj){
	obj.qoMuCd = MuSearchComponent01.getMuCode();	//cbo_mu.value;
	obj.qoUseYn = "Y";
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 업장의 팝업을 호출하기 전에 발생되는 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_upjangBeforeEvent(obj, cls){
	cls.setTmCd(TmSearchComponent01.getTmCode());	//cls.setTmCd(edt_tm.getTmCode());
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 부서 변경시  CC 초기화 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_tmChanged(){
    ds_search.setColumn(0, "ccCd",  "");
    ds_search.setColumn(0, "ccNm",  "");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 사업부 변경시 그리드 변경 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_setGridColumn(arg){
	var idx6a11 = grd_list.getBindCellIndex("body","slip6a11");	//60
	var idx6a16 = grd_list.getBindCellIndex("body","slip6a16");	//60
	var idx6a20 = grd_list.getBindCellIndex("body","slip6a20");	//60
	var idx6b   = grd_list.getBindCellIndex("body","slip6b");	//100
	var idx6c   = grd_list.getBindCellIndex("body","slip6c");	//90
	var idx6d12 = grd_list.getBindCellIndex("body","slip6d12");	//60
	var idx6d21 = grd_list.getBindCellIndex("body","slip6d21");	//60
	var idx6e   = grd_list.getBindCellIndex("body","slip6e");	//80
	var idx6f   = grd_list.getBindCellIndex("body","slip6f");	//80
	var idx6g   = grd_list.getBindCellIndex("body","slip6g");	//80
	var idx6h   = grd_list.getBindCellIndex("body","slip6h");	//90
	
	if(arg == "2001"){
        grd_list.setFormatColProperty(idx6a11, "size", 0);
        grd_list.setFormatColProperty(idx6a16, "size", 0);
        grd_list.setFormatColProperty(idx6a20, "size", 0);
        grd_list.setFormatColProperty(idx6b  , "size", 0);
        grd_list.setFormatColProperty(idx6c  , "size", 0);
        grd_list.setFormatColProperty(idx6d12, "size", 60);
        grd_list.setFormatColProperty(idx6d21, "size", 60);
        //grd_list.setFormatColProperty(idx6e  , "size", 80);
        grd_list.setFormatColProperty(idx6e  , "size", 0);
        grd_list.setFormatColProperty(idx6f  , "size", 80);
        grd_list.setFormatColProperty(idx6g  , "size", 0);
        grd_list.setFormatColProperty(idx6h  , "size", 90);
	}else if(arg == "2002"){
        grd_list.setFormatColProperty(idx6a11, "size", 60);
        grd_list.setFormatColProperty(idx6a16, "size", 60);
        grd_list.setFormatColProperty(idx6a20, "size", 60);
        grd_list.setFormatColProperty(idx6b  , "size", 0);
        grd_list.setFormatColProperty(idx6c  , "size", 0);
        grd_list.setFormatColProperty(idx6d12, "size", 0);
        grd_list.setFormatColProperty(idx6d21, "size", 0);
        grd_list.setFormatColProperty(idx6e  , "size", 0);
        grd_list.setFormatColProperty(idx6f  , "size", 80);
        grd_list.setFormatColProperty(idx6g  , "size", 0);
        grd_list.setFormatColProperty(idx6h  , "size", 90);
	}else if(arg == "2003"){
        grd_list.setFormatColProperty(idx6a11, "size", 0);
        grd_list.setFormatColProperty(idx6a16, "size", 0);
        grd_list.setFormatColProperty(idx6a20, "size", 0);
        grd_list.setFormatColProperty(idx6b  , "size", 0);
        grd_list.setFormatColProperty(idx6c  , "size", 0);
        grd_list.setFormatColProperty(idx6d12, "size", 60);
        grd_list.setFormatColProperty(idx6d21, "size", 60);
        grd_list.setFormatColProperty(idx6e  , "size", 0);
        grd_list.setFormatColProperty(idx6f  , "size", 80);
        grd_list.setFormatColProperty(idx6g  , "size", 0);
        grd_list.setFormatColProperty(idx6h  , "size", 90);
	}else if(arg == "2004"){
        grd_list.setFormatColProperty(idx6a11, "size", 0);
        grd_list.setFormatColProperty(idx6a16, "size", 0);
        grd_list.setFormatColProperty(idx6a20, "size", 0);
        grd_list.setFormatColProperty(idx6b  , "size", 100);
        grd_list.setFormatColProperty(idx6c  , "size", 90);
        grd_list.setFormatColProperty(idx6d12, "size", 0);
        grd_list.setFormatColProperty(idx6d21, "size", 0);
        grd_list.setFormatColProperty(idx6e  , "size", 0);
        grd_list.setFormatColProperty(idx6f  , "size", 0);
        grd_list.setFormatColProperty(idx6g  , "size", 0);
        grd_list.setFormatColProperty(idx6h  , "size", 90);
	}else if(arg == "2005"){
        grd_list.setFormatColProperty(idx6a11, "size", 0);
        grd_list.setFormatColProperty(idx6a16, "size", 0);
        grd_list.setFormatColProperty(idx6a20, "size", 0);
        grd_list.setFormatColProperty(idx6b  , "size", 0);
        grd_list.setFormatColProperty(idx6c  , "size", 0);
        grd_list.setFormatColProperty(idx6d12, "size", 0);
        grd_list.setFormatColProperty(idx6d21, "size", 0);
        grd_list.setFormatColProperty(idx6e  , "size", 0);
        grd_list.setFormatColProperty(idx6f  , "size", 80);
        grd_list.setFormatColProperty(idx6g  , "size", 80);
        grd_list.setFormatColProperty(idx6h  , "size", 90);
	}else{
        grd_list.setFormatColProperty(idx6a11, "size", 0);
        grd_list.setFormatColProperty(idx6a16, "size", 0);
        grd_list.setFormatColProperty(idx6a20, "size", 0);
        grd_list.setFormatColProperty(idx6b  , "size", 0);
        grd_list.setFormatColProperty(idx6c  , "size", 0);
        grd_list.setFormatColProperty(idx6d12, "size", 0);
        grd_list.setFormatColProperty(idx6d21, "size", 0);
        grd_list.setFormatColProperty(idx6e  , "size", 0);
        grd_list.setFormatColProperty(idx6f  , "size", 0);
        grd_list.setFormatColProperty(idx6g  , "size", 0);
        grd_list.setFormatColProperty(idx6h  , "size", 0);
     }
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 그리드 더블클릭 이벤트
 *---------------------------------------------------------------------------------------------*/
function grd_list_oncelldblclick(obj:Grid, e:GridClickEventInfo){
	if(ds_list.rowcount > 0){
		if(gfn_isNull(grd_list.getCellText(e.row, e.cell)) || e.cell < 3) return;

		var sSlipType	= null;
		var sSysClass	= null;
		var Idx11 = grd_list.getBindCellIndex("body","slip6a11");
		var Idx12 = grd_list.getBindCellIndex("body","slip6d12");
		var Idx13 = grd_list.getBindCellIndex("body","slip6b");
		var Idx14 = grd_list.getBindCellIndex("body","slip6c");
		var Idx15 = grd_list.getBindCellIndex("body","slip6e");
		var Idx16 = grd_list.getBindCellIndex("body","slip6a16");
		var Idx17 = grd_list.getBindCellIndex("body","slip6f");
		var Idx18 = grd_list.getBindCellIndex("body","slip6g");
		var Idx19 = grd_list.getBindCellIndex("body","slip6h");
		var Idx20 = grd_list.getBindCellIndex("body","slip6a20");
		var Idx21 = grd_list.getBindCellIndex("body","slip6d21");
		var Idx22 = grd_list.getBindCellIndex("body","slip7a");
		var Idx23 = grd_list.getBindCellIndex("body","slip7b");
		var Idx24 = grd_list.getBindCellIndex("body","slip7c");
		var Idx25 = grd_list.getBindCellIndex("body","slip7d");
		var Idx26 = grd_list.getBindCellIndex("body","slip7e");
		var Idx27 = grd_list.getBindCellIndex("body","slip7f");
		var Idx28 = grd_list.getBindCellIndex("body","slip7g");
		var Idx29 = grd_list.getBindCellIndex("body","slip7h");
		var Idx30 = grd_list.getBindCellIndex("body","slip7i");
		var Idx31 = grd_list.getBindCellIndex("body","slip7j");
		var Idx32 = grd_list.getBindCellIndex("body","slip8a");
		var Idx33 = grd_list.getBindCellIndex("body","slip8b");
		var Idx34 = grd_list.getBindCellIndex("body","slip8c");
		var Idx35 = grd_list.getBindCellIndex("body","slip8d");
		var Idx36 = grd_list.getBindCellIndex("body","slip8o");

        if(e.cell == Idx11){
            sSlipType   = "6A";
            sSysClass   = "11";
        }else if(e.cell == Idx12){
            sSlipType   = "6D";
            sSysClass = "12";
        }else if(e.cell == Idx13){
            sSlipType   = "6B";
            sSysClass   = "13";
        }else if(e.cell == Idx14){
            sSlipType   = "6C";
            sSysClass   = "14";
        }else if(e.cell == Idx15){
            sSlipType   = "6E";
            sSysClass   = "15";
        }else if(e.cell == Idx16){
            sSlipType   = "6A";
            sSysClass   = "16";
        }else if(e.cell == Idx17){
            sSlipType   = "6F";
            sSysClass   = "17";
        }else if(e.cell == Idx18){
            sSlipType   = "6G";
            sSysClass   = "18";
        }else if(e.cell == Idx19){
            sSlipType   = "6H";
            if (ds_search.getColumn(0, "muCd") == "2005"){
				sSysClass   = "23";
			}else{
				sSysClass   = "19";
			}
        }else if(e.cell == Idx20){
            sSlipType   = "6A";
            sSysClass   = "20";
        }else if(e.cell == Idx21){
            sSlipType   = "6D";
            sSysClass   = "21";
        }else if(e.cell == Idx22){
            sSlipType   = "7A";
        }else if(e.cell == Idx23){
            sSlipType   = "7B";
        }else if(e.cell == Idx24){
            sSlipType   = "7C";
        }else if(e.cell == Idx25){
            sSlipType   = "7D";
        }else if(e.cell == Idx26){
            sSlipType   = "7E";
        }else if(e.cell == Idx27){
            sSlipType   = "7F";
        }else if(e.cell == Idx28){
            sSlipType   = "7G";
        }else if(e.cell == Idx29){
            sSlipType   = "7H";
        }else if(e.cell == Idx30){
            sSlipType   = "7I";
        }else if(e.cell == Idx31){
            sSlipType   = "7J";
        }else if(e.cell == Idx32){
            sSlipType   = "8A";
        }else if(e.cell == Idx33){
            sSlipType   = "8B";
        }else if(e.cell == Idx34){
            sSlipType   = "8C";
        }else if(e.cell == Idx35){
            sSlipType   = "8D";
        }else if(e.cell == Idx36){
            sSlipType   = "8O";
        }

		var params = new Array();
		params[0] = ds_list.getColumn(ds_list.rowposition, "muCd");
		params[1] = ds_list.getColumn(ds_list.rowposition, "tmCd");
		params[2] = ds_list.getColumn(ds_list.rowposition, "tmNm");
		params[3] = ds_list.getColumn(ds_list.rowposition, "ccCd");
		params[4] = ds_list.getColumn(ds_list.rowposition, "ccNm");
		params[5] = sSlipType;
		params[6] = ds_list.getColumn(ds_list.rowposition, "slipMon");
		params[7] = sSysClass;

		gfn_openMenuForm("SapSlipUpload.xfdl","X_SRM",params,"SAP 전표 생성");
/*
		gfn_dialog(	"SapSlipUpload"
					,"X_SRM::SapSlipUpload.xfdl"
					,{arrSchVal:arrArg}	//objArgumentList
					,-1		//Width
					,-1		//Height
					,""		//Style
					,-1		//Left
					,-1		//Top
					,false	//Modeless
					,true	//ShowTitle
					,"-1"	//Align
					,true);	//Resizable
*/					
	}
}
]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSA00090E" onkeydown="frm_OnKeyDown" onload="form_onload" titletext="추가구매 승인 신청" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <MaskEdit id="me_FROM_DT" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="1" type="string" userdata="btn_FROM_DT" position="absolute 405 40 484 61" class="msk_WF_Essential" style="align:center;"/>
        <Button id="btn_FROM_DT" onclick="g_CalButton_OnClick" taborder="4" tabstop="false" userdata="me_FROM_DT" position="absolute 483 40 504 61" class="btn_WF_cal" text="" image=""/>
        <Static id="Static7" text="~" position="absolute 508 43 516 59"/>
        <MaskEdit id="me_TO_DT" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="2" type="string" userdata="btn_TO_DT" position="absolute 521 40 600 61" class="msk_WF_Essential" style="align:center;"/>
        <Button id="btn_TO_DT" onclick="g_CalButton_OnClick" taborder="6" tabstop="false" userdata="me_TO_DT" position="absolute 599 40 620 61" class="btn_WF_cal" text="" image=""/>
        <Static id="Static14" text="작성일" position="absolute 351 41 432 62" class="sta_WFSA_label"/>
        <CheckBox id="chk_APRV_YN" taborder="3" tabstop="false" text="승인포함" userdata="001" value="false" position="absolute 650 40 717 61"/>
        <Grid autoenter="select" binddataset="ds_list" cellsizingtype="both" readonly="false" enable="true" id="grd_list" useinputpanel="false" onheadclick="grd_List_OnHeadClick" taborder="11" tabstop="true" tooltiptype="hover" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 102 1237 710" selecttype="currow" autofittype="col" anchor="all" onexpanddown="grd_list_onexpanddown" autoupdatetype="comboselect" selectchangetype="down" oncellclick="grd_list_oncellclick">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30"/>
                <Column size="80"/>
                <Column size="130"/>
                <Column size="130"/>
                <Column size="153"/>
                <Column size="400"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="60"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="image" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="작성일"/>
                <Cell col="2" displaytype="text" text="구매신청일(시작일)"/>
                <Cell col="3" displaytype="text" text="구매신청일(종료일)"/>
                <Cell col="4" displaytype="text" text="사유" taborder="undefined"/>
                <Cell col="5" displaytype="text" text="상세사유" taborder="undefined"/>
                <Cell col="6" text="사업부"/>
                <Cell col="7" text="팀"/>
                <Cell col="8" displaytype="text" text="승인여부"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="date" style="align:center;" text="bind:PR_DATE"/>
                <Cell col="2" displaytype="text" edittype="expr:getRowType(currow) == 2 ? 'text' : 'none'" editfilter="expr:getRowType(currow) == 2 ? 'text' : 'none'" style="align:center;" text="bind:START_DATE" mask="@@@@-@@-@@" maskchar=" " editdisplay="expr:getRowType(currow) == 2 ? 'display' : 'edit'" expandshow="expr:getRowType(currow)==2 ? 'show' : 'hide'" expandsize="20" expandimage="URL('theme://Images\new\cal_WF_IconN.png')"/>
                <Cell col="3" displaytype="text" edittype="expr:getRowType(currow) == 2 ? 'text' : 'none'" editfilter="expr:getRowType(currow) == 2 ? 'text' : 'none'" style="align:center;" text="bind:END_DATE" mask="@@@@-@@-@@" maskchar=" " editdisplay="expr:getRowType(currow) == 2 ? 'display' : 'edit'" expandshow="expr:getRowType(currow)==2 ? 'show' : 'hide'" expandsize="20" expandimage="URL('theme://Images\new\cal_WF_IconN.png')"/>
                <Cell col="4" displaytype="combo" edittype="expr:APRV_YN=='Y' ? 'none':'combo'" style="align:left;padding:EXPR(expr:APRV_YN=='Y' ? '0 0 0 7':'0 0 0 0');" text="bind:REASON_CD" combodataset="ds_reson_m" combocodecol="CODE" combodatacol="CODE_NAME" combodisplayrowcount="10" combodisplaynulltext="선택" combodisplaynulltype="nulltext" combodisplay="expr:expr:APRV_YN=='Y' ? 'edit' : 'display'"/>
                <Cell col="5" displaytype="combo" edittype="expr:APRV_YN=='Y' ? 'none':'combo'" style="align:left;padding:EXPR(expr:APRV_YN=='Y' ? '0 0 0 7':'0 0 0 0');" text="bind:PR_REASON" editimemode="native" combodataset="expr:REASON_CD == '1' ? 'ds_reson_s1' : REASON_CD == '2' ? 'ds_reson_s2' :REASON_CD == '3' ? 'ds_reson_s3' :REASON_CD == '4' ? 'ds_reson_s4' : ''" combocodecol="CODE" combodatacol="CODE_NAME" combodisplayrowcount="10" combodisplay="expr:APRV_YN=='Y' ? 'edit' : 'display'"/>
                <Cell col="6" style="align:left;padding:0 0 0 7;" text="bind:MU_NAME"/>
                <Cell col="7" style="align:left;padding:0 0 0 7;" text="bind:TM_NAME"/>
                <Cell col="8" displaytype="text" style="align:center;" text="bind:APRV_YN"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static4" text="사업장" class="sta_WFSA_label" position="absolute 16 41 104 62"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="12" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static03" text="h06" onclick="Static03_onclick" class="Guide01_AreaRed" visible="false" position="absolute 0 71 144 84" anchor="top right"/>
        <Static id="Static22" text="추가구매 승인 리스트" onclick="Static22_onclick" class="sta_WF_Title01" position="absolute 0 84 328 115" anchor="left top"/>
        <Static id="Static12" text="h06" onclick="Static03_onclick" class="Guide01_AreaRed" visible="false" position="absolute 1093 71 1237 77" anchor="top right"/>
        <Static id="Static19" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 1093 97 1237 102" anchor="top right"/>
        <Static id="Static06" text="w15" onclick="Static06_onclick" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" onclick="Static71_onclick" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Static id="Static23" text="W15" visible="false" position="absolute 1 40 16 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 74 40 84 61"/>
        <Static id="Static21" text="W10" visible="false" position="absolute 0 30 1237 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static05" text="W10" visible="false" position="absolute 0 61 1237 71" style="background:#ff000055;align:center middle;"/>
        <Static id="Static07" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 321 40 351 61" onclick="Static07_onclick"/>
        <Static id="Static10" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 395 40 405 61" onclick="Static10_onclick"/>
        <Static id="Static13" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 620 40 650 61"/>
        <Static id="Static01" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 917 41 927 62"/>
        <UpjangSearchComponent id="com_upjang" titletext="업장 검색용 Component" taborder="0" text="UpjangSearchComponent00" position="absolute 84 40 321 61" tooltiptext="입고업장" bindDataset="ds_input" bindUpjangCodeColumn="UPJANG" bindUpjangNameColumn="UPJANG_NM" eventBeforeTrigger="" eventAfterTrigger="" roleSetId="ScoAuthLevel01" class="edt_WF_Essential"/>
        <Button id="btn_addRow" taborder="13" class="btn_WF_GrdPlus" position="absolute 1198 77 1216 97" anchor="top right" onclick="btn_addRow_onclick" tooltiptext="행추가" tooltiptype="default"/>
        <Button id="btn_delRow" taborder="14" class="btn_WF_GrdMinus" position="absolute 1218 77 1236 97" anchor="top right" onclick="btn_delRow_onclick" tooltiptext="행삭제" tooltiptype="default"/>
        <Static id="Static00" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 869 40 899 61"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_list" oncolumnchanged="ds_list_OnColumnChanged">
        <ColumnInfo>
          <Column id="MU_CD" type="STRING" size="256"/>
          <Column id="MU_NAME" type="STRING" size="256"/>
          <Column id="TM_CD" type="STRING" size="256"/>
          <Column id="TM_NAME" type="STRING" size="256"/>
          <Column id="APRV_10" size="1" type="STRING"/>
          <Column id="APRV_YN" size="1" type="STRING"/>
          <Column id="END_DATE" size="8" type="STRING"/>
          <Column id="PR_DATE" size="8" type="STRING"/>
          <Column id="REASON_CD" type="STRING" size="256"/>
          <Column id="PR_REASON" size="1000" type="STRING"/>
          <Column id="START_DATE" size="8" type="STRING"/>
          <Column id="UPJANG" size="22" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="79" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_input" oncolumnchanged="ds_input_oncolumnchanged">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="UPJANG_NM" size="256" type="STRING"/>
          <Column id="FROM_DT" size="256" type="STRING"/>
          <Column id="TO_DT" size="256" type="STRING"/>
          <Column id="MU_CD" type="STRING" size="256"/>
          <Column id="TM_CD" type="STRING" size="256"/>
          <Column id="APRV_YN" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="APRV_YN"/>
            <Col id="FROM_DT"/>
            <Col id="TO_DT"/>
            <Col id="UPJANG"/>
            <Col id="UPJANG_NM"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_check"/>
      <Dataset id="ds_reson_m" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="GROUP_NAME" type="STRING" size="100"/>
          <Column id="GROUP_CODE" type="STRING" size="50"/>
          <Column id="CODE" type="STRING" size="50"/>
          <Column id="CODE_NAME" type="STRING" size="500"/>
          <Column id="CONTENTS" type="STRING" size="300"/>
          <Column id="SORT_SEQ" type="BIGDECIMAL" size="39"/>
          <Column id="SYSTEM_YN" type="STRING" size="1"/>
          <Column id="SET1" type="STRING" size="100"/>
          <Column id="SET2" type="STRING" size="100"/>
          <Column id="SET3" type="STRING" size="100"/>
          <Column id="SET4" type="STRING" size="100"/>
          <Column id="SET5" type="STRING" size="100"/>
          <Column id="REMARK" type="STRING" size="300"/>
          <Column id="USE_YN" type="STRING" size="1"/>
          <Column id="ATTR01" type="STRING" size="300"/>
          <Column id="ATTR02" type="STRING" size="300"/>
          <Column id="ATTR03" type="STRING" size="300"/>
          <Column id="ATTR04" type="STRING" size="300"/>
          <Column id="ATTR05" type="STRING" size="300"/>
          <Column id="ATTR06" type="STRING" size="300"/>
          <Column id="ATTR07" type="STRING" size="300"/>
          <Column id="ATTR08" type="STRING" size="300"/>
          <Column id="ATTR09" type="STRING" size="300"/>
          <Column id="ATTR10" type="STRING" size="300"/>
          <Column id="CUSER" type="STRING" size="20"/>
          <Column id="CDATE" type="DATETIME" size="7"/>
          <Column id="UUSER" type="STRING" size="20"/>
          <Column id="UDATE" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_reson_s1" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="GROUP_NAME" type="STRING" size="100"/>
          <Column id="GROUP_CODE" type="STRING" size="50"/>
          <Column id="CODE" type="STRING" size="50"/>
          <Column id="CODE_NAME" type="STRING" size="500"/>
          <Column id="CONTENTS" type="STRING" size="300"/>
          <Column id="SORT_SEQ" type="BIGDECIMAL" size="39"/>
          <Column id="SYSTEM_YN" type="STRING" size="1"/>
          <Column id="SET1" type="STRING" size="100"/>
          <Column id="SET2" type="STRING" size="100"/>
          <Column id="SET3" type="STRING" size="100"/>
          <Column id="SET4" type="STRING" size="100"/>
          <Column id="SET5" type="STRING" size="100"/>
          <Column id="REMARK" type="STRING" size="300"/>
          <Column id="USE_YN" type="STRING" size="1"/>
          <Column id="ATTR01" type="STRING" size="300"/>
          <Column id="ATTR02" type="STRING" size="300"/>
          <Column id="ATTR03" type="STRING" size="300"/>
          <Column id="ATTR04" type="STRING" size="300"/>
          <Column id="ATTR05" type="STRING" size="300"/>
          <Column id="ATTR06" type="STRING" size="300"/>
          <Column id="ATTR07" type="STRING" size="300"/>
          <Column id="ATTR08" type="STRING" size="300"/>
          <Column id="ATTR09" type="STRING" size="300"/>
          <Column id="ATTR10" type="STRING" size="300"/>
          <Column id="CUSER" type="STRING" size="20"/>
          <Column id="CDATE" type="DATETIME" size="7"/>
          <Column id="UUSER" type="STRING" size="20"/>
          <Column id="UDATE" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_reson_s2" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="GROUP_NAME" type="STRING" size="100"/>
          <Column id="GROUP_CODE" type="STRING" size="50"/>
          <Column id="CODE" type="STRING" size="50"/>
          <Column id="CODE_NAME" type="STRING" size="500"/>
          <Column id="CONTENTS" type="STRING" size="300"/>
          <Column id="SORT_SEQ" type="BIGDECIMAL" size="39"/>
          <Column id="SYSTEM_YN" type="STRING" size="1"/>
          <Column id="SET1" type="STRING" size="100"/>
          <Column id="SET2" type="STRING" size="100"/>
          <Column id="SET3" type="STRING" size="100"/>
          <Column id="SET4" type="STRING" size="100"/>
          <Column id="SET5" type="STRING" size="100"/>
          <Column id="REMARK" type="STRING" size="300"/>
          <Column id="USE_YN" type="STRING" size="1"/>
          <Column id="ATTR01" type="STRING" size="300"/>
          <Column id="ATTR02" type="STRING" size="300"/>
          <Column id="ATTR03" type="STRING" size="300"/>
          <Column id="ATTR04" type="STRING" size="300"/>
          <Column id="ATTR05" type="STRING" size="300"/>
          <Column id="ATTR06" type="STRING" size="300"/>
          <Column id="ATTR07" type="STRING" size="300"/>
          <Column id="ATTR08" type="STRING" size="300"/>
          <Column id="ATTR09" type="STRING" size="300"/>
          <Column id="ATTR10" type="STRING" size="300"/>
          <Column id="CUSER" type="STRING" size="20"/>
          <Column id="CDATE" type="DATETIME" size="7"/>
          <Column id="UUSER" type="STRING" size="20"/>
          <Column id="UDATE" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_reson_s3" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="GROUP_NAME" type="STRING" size="100"/>
          <Column id="GROUP_CODE" type="STRING" size="50"/>
          <Column id="CODE" type="STRING" size="50"/>
          <Column id="CODE_NAME" type="STRING" size="500"/>
          <Column id="CONTENTS" type="STRING" size="300"/>
          <Column id="SORT_SEQ" type="BIGDECIMAL" size="39"/>
          <Column id="SYSTEM_YN" type="STRING" size="1"/>
          <Column id="SET1" type="STRING" size="100"/>
          <Column id="SET2" type="STRING" size="100"/>
          <Column id="SET3" type="STRING" size="100"/>
          <Column id="SET4" type="STRING" size="100"/>
          <Column id="SET5" type="STRING" size="100"/>
          <Column id="REMARK" type="STRING" size="300"/>
          <Column id="USE_YN" type="STRING" size="1"/>
          <Column id="ATTR01" type="STRING" size="300"/>
          <Column id="ATTR02" type="STRING" size="300"/>
          <Column id="ATTR03" type="STRING" size="300"/>
          <Column id="ATTR04" type="STRING" size="300"/>
          <Column id="ATTR05" type="STRING" size="300"/>
          <Column id="ATTR06" type="STRING" size="300"/>
          <Column id="ATTR07" type="STRING" size="300"/>
          <Column id="ATTR08" type="STRING" size="300"/>
          <Column id="ATTR09" type="STRING" size="300"/>
          <Column id="ATTR10" type="STRING" size="300"/>
          <Column id="CUSER" type="STRING" size="20"/>
          <Column id="CDATE" type="DATETIME" size="7"/>
          <Column id="UUSER" type="STRING" size="20"/>
          <Column id="UDATE" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_expt_upjang_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="GROUP_NAME" type="STRING" size="100"/>
          <Column id="GROUP_CODE" type="STRING" size="50"/>
          <Column id="CODE" type="STRING" size="50"/>
          <Column id="CODE_NAME" type="STRING" size="500"/>
          <Column id="CONTENTS" type="STRING" size="300"/>
          <Column id="SORT_SEQ" type="BIGDECIMAL" size="39"/>
          <Column id="SYSTEM_YN" type="STRING" size="1"/>
          <Column id="SET1" type="STRING" size="100"/>
          <Column id="SET2" type="STRING" size="100"/>
          <Column id="SET3" type="STRING" size="100"/>
          <Column id="SET4" type="STRING" size="100"/>
          <Column id="SET5" type="STRING" size="100"/>
          <Column id="REMARK" type="STRING" size="300"/>
          <Column id="USE_YN" type="STRING" size="1"/>
          <Column id="ATTR01" type="STRING" size="300"/>
          <Column id="ATTR02" type="STRING" size="300"/>
          <Column id="ATTR03" type="STRING" size="300"/>
          <Column id="ATTR04" type="STRING" size="300"/>
          <Column id="ATTR05" type="STRING" size="300"/>
          <Column id="ATTR06" type="STRING" size="300"/>
          <Column id="ATTR07" type="STRING" size="300"/>
          <Column id="ATTR08" type="STRING" size="300"/>
          <Column id="ATTR09" type="STRING" size="300"/>
          <Column id="ATTR10" type="STRING" size="300"/>
          <Column id="CUSER" type="STRING" size="20"/>
          <Column id="CDATE" type="DATETIME" size="7"/>
          <Column id="UUSER" type="STRING" size="20"/>
          <Column id="UDATE" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_del_list" oncolumnchanged="ds_list_OnColumnChanged">
        <ColumnInfo>
          <Column id="APRV_10" size="1" type="STRING"/>
          <Column id="APRV_YN" size="1" type="STRING"/>
          <Column id="END_DATE" size="8" type="STRING"/>
          <Column id="PR_DATE" size="8" type="STRING"/>
          <Column id="REASON_CD" type="STRING" size="256"/>
          <Column id="PR_REASON" size="1000" type="STRING"/>
          <Column id="START_DATE" size="8" type="STRING"/>
          <Column id="UPJANG" size="22" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="79" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_check_input" oncolumnchanged="ds_input_oncolumnchanged">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="UPJANG_NM" size="256" type="STRING"/>
          <Column id="FROM_DT" size="256" type="STRING"/>
          <Column id="TO_DT" size="256" type="STRING"/>
          <Column id="APRV_YN" size="256" type="STRING"/>
          <Column id="CHK_DATE" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="APRV_YN"/>
            <Col id="CHK_DATE"/>
            <Col id="TO_DT"/>
            <Col id="UPJANG"/>
            <Col id="UPJANG_NM"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_reson_s4" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="GROUP_NAME" type="STRING" size="100"/>
          <Column id="GROUP_CODE" type="STRING" size="50"/>
          <Column id="CODE" type="STRING" size="50"/>
          <Column id="CODE_NAME" type="STRING" size="500"/>
          <Column id="CONTENTS" type="STRING" size="300"/>
          <Column id="SORT_SEQ" type="BIGDECIMAL" size="39"/>
          <Column id="SYSTEM_YN" type="STRING" size="1"/>
          <Column id="SET1" type="STRING" size="100"/>
          <Column id="SET2" type="STRING" size="100"/>
          <Column id="SET3" type="STRING" size="100"/>
          <Column id="SET4" type="STRING" size="100"/>
          <Column id="SET5" type="STRING" size="100"/>
          <Column id="REMARK" type="STRING" size="300"/>
          <Column id="USE_YN" type="STRING" size="1"/>
          <Column id="ATTR01" type="STRING" size="300"/>
          <Column id="ATTR02" type="STRING" size="300"/>
          <Column id="ATTR03" type="STRING" size="300"/>
          <Column id="ATTR04" type="STRING" size="300"/>
          <Column id="ATTR05" type="STRING" size="300"/>
          <Column id="ATTR06" type="STRING" size="300"/>
          <Column id="ATTR07" type="STRING" size="300"/>
          <Column id="ATTR08" type="STRING" size="300"/>
          <Column id="ATTR09" type="STRING" size="300"/>
          <Column id="ATTR10" type="STRING" size="300"/>
          <Column id="CUSER" type="STRING" size="20"/>
          <Column id="CDATE" type="DATETIME" size="7"/>
          <Column id="UUSER" type="STRING" size="20"/>
          <Column id="UDATE" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="me_FROM_DT_value" compid="me_FROM_DT" propid="value" datasetid="ds_input" columnid="FROM_DT"/>
      <BindItem id="me_TO_DT_value" compid="me_TO_DT" propid="value" datasetid="ds_input" columnid="TO_DT"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
 ***********************************************************************************************
 * 시스템구분   : 구매관리 / 신청관리 / 추가구매 승인요청 
 * 프로그램명   : FSP00090E
 * 기      능   : 추가구매 승인요청
 * 작  성  자   : 정영철
 * 작성  일자   : 2015-06-10
 * --------------------------------------------------------------------------------------------
 * HISTORY    :
 ***********************************************************************************************
 */
 
/***********************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/ 
include "U_lib::lib_conversionCom.xjs";

/***********************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/ 

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 로드시 이벤트
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(this);

	// 업데이트 DS
	v_ds_check = "ds_list";
	
	// X-Framework : Action 정보 생성 
	fsp_init(this);
	
	//초기화
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 초기화 및 기본 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	var v_fil_cond;
	var v_ds ;
	var strDt = fn_CurrDateWeek();
	var row = 0;
	
	ds_input.setColumn(0,"FROM_DT",	gfn_left(strDt,6)+"01");		// 일자
	ds_input.setColumn(0,"TO_DT"  ,	strDt);							// 일자
	
	// 공통코드
	v_ds = fn_common_code("'FS0123','FS0124','FS0125'","","","non", "Y");
	
	// 추가구매승인예외 사업장코드
	v_fil_cond = "GROUP_CODE == 'FS0125'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_expt_upjang_list,v_ds.name);
	
	// 추가구매승인사유 대분류
	v_fil_cond = "GROUP_CODE == 'FS0123'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_reson_m,v_ds.name);
	
	// 추가구매승인사유 소분류
	v_fil_cond = "GROUP_CODE == 'FS0124' && SET1 == '1'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_reson_s1,v_ds.name);
	
	v_fil_cond = "GROUP_CODE == 'FS0124' && SET1 == '2'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_reson_s2,v_ds.name);
	
	v_fil_cond = "GROUP_CODE == 'FS0124' && SET1 == '3'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_reson_s3,v_ds.name);
	
	v_fil_cond = "GROUP_CODE == 'FS0124' && SET1 == '4'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_reson_s4,v_ds.name);
	
	com_upjang.edt_upjangNm.setFocus();
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_search()
{
	var sSvcID;			// 서비스 ID
	var sUrl;			// jsp 경로
	var sInDs;			// 입력 데이터셋
	var sOutDs;			// 출력 데이터셋
	var sArg;			// 추가 파라미터
	var sCallFunc;		// 콜백함수명
	
	sSvcID		= "SEARCH";
	sUrl		= "U_svc::" + "fs/fsa/FSA00090E_S001.jsp";
	sInDs		= "ds_input=ds_input";
	sOutDs		= "ds_list=ds_list";
	sCallFunc	= "fn_callback";
	
	// 유효성 체크
	if(!fn_validation(sSvcID)){return false;}
	
	// 초기화
	ds_list.clearData();
	ds_input.setColumn(0,"APRV_YN",iif(chk_APRV_YN.value==false,"N",""));
	
	jsp_transaction(this,sSvcID, sUrl ,sInDs ,sOutDs,sArg,sCallFunc,false,false,true);
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Save()
 * 기      능   : [저장버튼] 저장 시 처리되는 작업
 ******************************************************************************************
 */
function fn_save()
{
	var sSvcID;			// 서비스 ID
	var sUrl;			// jsp 경로
	var sInDs;			// 입력 데이터셋
	var sOutDs;			// 출력 데이터셋
	var sArg;			// 추가 파라미터
	var sCallFunc;		// 콜백함수명
    
	sSvcID		= "SAVE";
	sUrl		= "U_svc::" + "fs/fsa/FSA00090E_T001.jsp";
	
	sInDs		= "ds_list=ds_list:U";
    sOutDs		= "";
    sArg		= "";
    sCallFunc	= "fn_callback";
    
    // 유효성 체크
    if(!fn_validation(sSvcID)){return false;}
	
	jsp_transaction(this,sSvcID, sUrl ,sInDs ,sOutDs,sArg,sCallFunc,false,false,true);
   
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_CheckSearch(sUpjang,sStartDt,sEndDt)
 * 입      력   : sUpjang : 업장, sStartDt : 시작일 , sEndDt : 종료일
 * 반      환   : 없음
 * 기      능   : 중복체크
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-07-21
 ******************************************************************************************
 */
function fn_CheckSearch(sUpjang,sStartDt,sEndDt)
{
	var nRow = 0;
	var sSvcID;			// 서비스 ID
	var sUrl;			// jsp 경로
	var sInDs;			// 입력 데이터셋
	var sOutDs;			// 출력 데이터셋
	var sArg;			// 추가 파라미터
	var sCallFunc;		// 콜백함수명
	
	// 초기화
	ds_check.clearData();
	ds_check_input.clearData();
	
	nRow = ds_check_input.addRow();
	
	ds_check_input.setColumn(nRow,"UPJANG" , sUpjang);
	ds_check_input.setColumn(nRow,"FROM_DT", sStartDt);
	ds_check_input.setColumn(nRow,"TO_DT"  , sEndDt);
	
	sSvcID		= "CHK_SEARCH";
	sUrl		= "U_svc::" + "fs/fsa/FSA00090E_S002.jsp";
	sInDs       = "ds_check_input=ds_check_input";
	sOutDs		= "ds_check=ds_check";
	sArg		= "";
	sCallFunc   = "fn_callback";
	
	jsp_transaction(this,sSvcID, sUrl ,sInDs ,sOutDs,sArg,sCallFunc,false,false,true);
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_row_delete()
 * 기      능   : [삭제버튼] 삭제 시 처리되는 작업
 ******************************************************************************************
 */
function fn_row_delete()
{
	var nRow = 0;
	var sSvcID;			// 서비스 ID
	var sUrl;			// jsp 경로
	var sInDs;			// 입력 데이터셋
	var sOutDs;			// 출력 데이터셋
	var sArg;			// 추가 파라미터
	var sCallFunc;		// 콜백함수명

	sSvcID		= "DELETE";
	sUrl		= "U_svc::" + "fs/fsa/FSA00090E_T002.jsp";
	sInDs		= "ds_del_list=ds_del_list:A";
	sOutDs		= "";
    sArg		= "";
	sCallFunc	= "fn_callback";
	
	// 유효성 체크
	if(!fn_validation(sSvcID)){return false;}
	
	ds_del_list.clearData();
	nRow = ds_del_list.addRow();
	ds_del_list.copyRow(nRow, ds_list, ds_list.rowposition);
	
	jsp_transaction(this,sSvcID, sUrl ,sInDs ,sOutDs, sArg, sCallFunc,false,false,true);
}

/*------------------------------------------------------------
	1. Function    : fn_callback(obj)
	2. Description : 조회 이벤트 콜백
	3. Arguments   : strSvcID, nErrorCode, strErrorMag
	4. History     : 2008. 02. 04 - 최초작성
	                 2015. 06. 10 - 고도화
*------------------------------------------------------------*/
function fn_callback(nErrorCode, sErrorMag, sSvcID)
{
	// 에러일 경우
	if(nErrorCode!=0){
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오" + sErrorMag);
		return;
	}
	
	switch(sSvcID){
		
		case "SEARCH" :	// 조회
			if (ds_list.rowcount < 1){
				g_Message("EE", "조회된 자료가 없습니다.");
				com_upjang.edt_upjangNm.setFocus();
			}
			break;
			
		case "SAVE" :	// 저장
			fn_search();
			break;
		
		case "CHK_SEARCH" : // 체크조회
			break;
			
		case "DELETE" :	// 삭제
			if(nErrorCode!=0){
				ds_list.reset();
				return;
			}else{
				fn_search();
			}

			break;
	}
}

/*------------------------------------------------------------
	1. Function    : fn_validation()
	2. Description : 조회유효성체크
	3. Arguments   : sSvcID
	4. History     : 2015. 06. 10 - 최초작성
*------------------------------------------------------------*/
function fn_validation(sSvcID)
{
	switch(sSvcID)
	{
		case "SEARCH" :
			if (gfn_length(ds_input.getColumn(0,"UPJANG"))== 0){
				g_Message("EE", "사업장을 입력하세요.");
				com_upjang.edt_upjangNm.setFocus();
				return false;
			}

			if (gfn_length(ds_input.getColumn(0,"FROM_DT"))== 0){
				g_Message("EE", "날짜를 입력하세요");
				me_FROM_DT.setFocus();
				return false;
			}

			if (gfn_length(ds_input.getColumn(0,"TO_DT"))== 0){
				g_Message("EE", "날짜를 입력하세요");
				me_TO_DT.setFocus();
				return false;
			}

			if (ds_input.getColumn(0,"FROM_DT") > ds_input.getColumn(0,"TO_DT")){
				g_Message("EE", "검색기간을 확인해 주십시오.");
				me_FROM_DT.setFocus();
				return false;
			}
			break;
			
		case "SAVE" :
			// 변경여부 확인
			if(!gfn_dsIsUpdated(ds_list)){
				g_Message("EE", "변경된 데이터가 없습니다.");
				return;
			}
			
			if(!fn_SaveCheck()){
				return;
			}
		
			break;
		
		case "CHK_SEARCH" :
			break;
		
		case "DELETE" :
		
			if(ds_list.getRowCount()==0){
				g_Message("EE", "삭제할 데이터가 없습니다.");
				return;
			}

			if (gfn_dsIsUpdated(ds_list)){
				g_Message("EE", "변경된 데이터가 있습니다.\n 저장 후 삭제해십시오.");
				return;
			}

			if (ds_list.getColumn(ds_list.rowposition,"APRV_YN") == "Y"){
				g_Message("EE", "승인된 데이터입니다.\n삭제할 수 없습니다.");
				return;
			}

			// 삭제확인
			if(!g_Confirm("01","")){
				return false;
			}
			break;
	}
	
    return true;
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_delete()
 * 기      능   : [입력버튼] 입력 시 처리되는 작업
 * 비      고	: 팝업사용
 ******************************************************************************************
 */
function fn_delete()
{
	fn_row_delete();
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Insert()
 * 기      능   : [입력버튼] 입력 시 처리되는 작업
 * 비      고	: 팝업사용
 ******************************************************************************************
 */
function fn_insert()
{

}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Print()
 * 기      능   : [출력버튼] 출력 시 처리되는 작업
 ******************************************************************************************
 */
function fn_print()
{
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Excel()
 * 기      능   : [엑셀버튼] 엑셀 시 처리되는 작업
 ******************************************************************************************
 */
function fn_Excel()
{
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function fn_Close()
{
	this.close();
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Help()
 * 기      능   : [도움말버튼] 도움말
 ******************************************************************************************
 */
function fn_help()
{
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_SaveCheck()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 저상시 필수입력 체크
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-07-21  
 *****************************************************************************************0*1
 */
function fn_SaveCheck() 
{
	var nFRow,nRow;
	
	nRow = ds_list.rowposition;
	
	// 필수 입력 사항 확인 
	// 사업장
	nFRow = ds_list.findRowExpr("UPJANG<=0 || UPJANG==null");
	if (nFRow >= 0)
	{
		g_Message("EE", "사업장을 입력해주십시오.");
		ds_list.rowposition = nFRow;
		grd_list.setFocus();
		return false;
	}
	
	// 시작일자
	nFRow = ds_list.findRowExpr("gfn_length(START_DATE)==0 || START_DATE==null");
	if (nFRow >= 0)
	{
		g_Message("EE", "FROM일자를 입력해주십시오.");
		ds_list.rowposition = nFRow;
		grd_list.setFocus();
		grd_list.setCellPos(2);
		return false;
	}
	
	// 종료일자
	nFRow = ds_list.findRowExpr("gfn_length(END_DATE)==0 || END_DATE==null");
	if (nFRow >= 0)
	{
		g_Message("EE", "TO일자를 입력해주십시오.");
		ds_list.rowposition = nFRow;
		grd_list.setFocus();
		grd_list.setCellPos(3);
		return false;
	}
	
	// 기간 유효성 체크
	nFRow = ds_list.findRowExpr("START_DATE>END_DATE");
	if (nFRow >= 0)
	{
		g_Message("EE", "시작일이 종료일보다 클 수 없습니다.");
		ds_list.rowposition = nFRow;
		grd_list.setFocus();
		grd_list.setCellPos(3);
		return false;
	}
	// 시작일과 종료일간의 차가 3일을 넘으면 안된다.
	nFRow = ds_list.findRowExpr("gfn_addDate(START_DATE,3)<END_DATE");
	if (nFRow >= 0)
	{
		g_Message("EE", "시작일과 종료일간의 차이는 3일을 넘을 수 없습니다.");
		ds_list.rowposition = nFRow;
		grd_list.setFocus();
		grd_list.setCellPos(3);
		return false;
	}
	
	// 사유코드
	nFRow = ds_list.findRowExpr("gfn_length(REASON_CD)==0 || REASON_CD==null");
	if (nFRow >= 0)
	{
		g_Message("EE", "사유를 선택해 주세요.");
		ds_list.rowposition = nFRow;
		grd_list.setFocus();
		grd_list.setCellPos(4);
		return false;
	}
	
	// 상세사유코드
	nFRow = ds_list.findRowExpr("gfn_length(PR_REASON)==0 || PR_REASON==null");
	if (nFRow >= 0)
	{
		g_Message("EE", "상세사유를 선택해 주세요.");
		ds_list.rowposition = nFRow;
		grd_list.setFocus();
		grd_list.setCellPos(5);
		return false;
	}
	

    return true;
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
 /******************************************************************************************
 * 함  수  명   : grd_List_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
 * 기      능   : 그리드헤드 더블클릭시 Sort
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-07-21
 ******************************************************************************************
 */
function grd_List_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
}

/*
 ******************************************************************************************
 * 함  수  명   : ds_list_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
 * 기      능   : 입력시 값체크
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-07-21
 ******************************************************************************************
 */
function ds_list_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	switch(e.columnid)
	{
		case "START_DATE" : 
		case "END_DATE"   : 
			
			fn_set_date(e.row, e.col, e.newvalue);	// 날짜 자동완성
			
			var sUpjang		= ds_list.getColumn(e.row,"UPJANG");
			var sStartDt	= ds_list.getColumn(e.row,"START_DATE");
			var sEndDt		= ds_list.getColumn(e.row,"END_DATE");
			
			if (gfn_length(gfn_toString(sUpjang))> 0 && gfn_length(sStartDt)> 0 && gfn_length(sEndDt)> 0)
			{
				if (sStartDt > sEndDt){
					g_Message("EE", "시작일이 종료일보다 클 수 없습니다.");
					ds_list.setColumn(e.row,e.columnid,"");
					return;
				}
				// 시작일과 종료일간의 차가 3일을 넘으면 안된다.
				if (gfn_addDate(sStartDt,3)< sEndDt){
					g_Message("EE", "시작일과 종료일의 차이는 3일을 넘을 수 없습니다.");
					ds_list.setColumn(e.row,e.columnid,"");
					return;
				}

				// 중복체크(local)
				var nCnt = ds_list.getCaseCount("UPJANG=" + wrapQuote(sUpjang) + " && START_DATE=" + wrapQuote(sStartDt) + " && END_DATE=" + wrapQuote(sEndDt));
				
				if (nCnt>1){
					g_Message("EE", "중복된 신청내역이 있습니다.\n확인해주십시오.");
					ds_list.setColumn(e.row,e.columnid,"");
					return;
				}
				
				// 중복체크(server)
				fn_CheckSearch(sUpjang,sStartDt,sEndDt);
				if (ds_check.rowcount > 0){
					g_Message("EE", "중복된 신청내역이 있습니다.\n확인해주십시오.");
					ds_list.setColumn(e.row,e.columnid,"");
					return;
				}
			}
			grd_list.moveToNextCell();
			break;
			
		case "REASON_CD" :
			ds_list.setColumn(e.row, "PR_REASON", "");
			break;
	}
}

function frm_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
	if ( (e.keycode == 13) && (e.fromreferenceobject == me_TO_DT) ) fn_search();
}
 
function grd_list_onexpanddown(obj:Grid, e:GridMouseEventInfo)
{ 
    var str_ColumnTitle = fn_Get_ColHeaderTitle(obj, e.cell);   
	
	if(str_ColumnTitle == '구매신청일(시작일)') {
		 var nCellRect  = obj.getCellRect(e.row, 2); //left,right,top,bottom

		 var nX = system.clientToScreenX(obj, nCellRect.left);

		 var nY = system.clientToScreenY(obj, nCellRect.top);

		 var orgDate = ds_list.getColumn(ds_list.rowposition, "START_DATE");		
		 var retDate = gfn_callCalendarPopDiv(ds_list.getColumn(ds_list.rowposition, "START_DATE"),nX, nY+24);

		 if(gfn_isNull(retDate)) {
			 ds_list.setColumn(ds_list.rowposition, "START_DATE", orgDate);
		 } else {
			 ds_list.setColumn(ds_list.rowposition, "START_DATE", retDate);
		 }
	} else if(str_ColumnTitle == '구매신청일(종료일)') {
		 var nCellRect  = obj.getCellRect(e.row, 3); //left,right,top,bottom

		 var nX = system.clientToScreenX(obj, nCellRect.left);

		 var nY = system.clientToScreenY(obj, nCellRect.top);

		 var orgDate = ds_list.getColumn(ds_list.rowposition, "END_DATE");		
		 var retDate = gfn_callCalendarPopDiv(ds_list.getColumn(ds_list.rowposition, "END_DATE"),nX, nY+24);

		 if(gfn_isNull(retDate)) {
			 ds_list.setColumn(ds_list.rowposition, "END_DATE", orgDate);
		 } else {
			 ds_list.setColumn(ds_list.rowposition, "END_DATE", retDate);
		 }
	}	
}

/*-------------------------------------------------------------------------------------------------+
>>  기   능:	추가구매신청예외사업장 비교 이벤트
+-------------------------------------------------------------------------------------------------*/
function ds_input_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	switch(e.columnid)
	{
		case "UPJANG" :
		case "UPJANG_NM" :
			var nCnt1 = 0;
			var nCnt2 = 0;
			nCnt1 = ds_expt_upjang_list.getCaseCount("CODE      == '" + e.newvalue + "'");
			nCnt2 = ds_expt_upjang_list.getCaseCount("CODE_NAME == '" + e.newvalue + "'");
			if(nCnt1 > 0 || nCnt2 > 0){
				
				if(e.columnid == "UPJANG"){
					
					ds_input.setColumn(0, "UPJANG"		, "");
				}else{
					g_Message("EE", e.newvalue + " 업장은 추가구매 승인 예외 업장입니다.");
					ds_input.setColumn(0, "UPJANG_NM"	, "");
				}
			}
			break;
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  기   능:	그리드 추가버튼 클릭시 이벤트
+-------------------------------------------------------------------------------------------------*/
function btn_addRow_onclick(obj:Button,  e:ClickEventInfo)
{
	var nAddRow = 0;
	if (gfn_length(ds_input.getColumn(0,"UPJANG"))== 0)
	{
		g_Message("EE", "사업장을 입력하세요.");
		com_upjang.edt_upjangNm.setFocus();
		return false;
	}
	
	nAddRow = ds_list.addRow();
	ds_list.setColumn(nAddRow,"UPJANG"	,ds_input.getColumn(0,"UPJANG"));
	ds_list.setColumn(nAddRow,"PR_DATE"	,gfn_left(fn_CurrDateWeek(),8));
// 	ds_list.setColumn(nAddRow,"MU_CD"	, g_Mu_Cd);
// 	ds_list.setColumn(nAddRow,"MU_NAME"	, g_Mu_Nm);
// 	ds_list.setColumn(nAddRow,"TM_CD"	, g_Tm_Cd);
// 	ds_list.setColumn(nAddRow,"TM_NAME"	, g_Tm_Nm);
	ds_list.setColumn(nAddRow,"APRV_YN"	,"N");
}


/*-------------------------------------------------------------------------------------------------+
>>  기   능:	그리드row 삭제 버튼 클릭시 이벤트
+-------------------------------------------------------------------------------------------------*/
function btn_delRow_onclick(obj:Button,  e:ClickEventInfo)
{
	nRowType = ds_list.getRowType(ds_list.rowposition);
    if(nRowType == "2"){
		ds_list.deleteRow(ds_list.rowposition);
		return;
    }
	
}

/*-------------------------------------------------------------------------------------------------+
>>  기   능:	그리드 콤보박스 클릭시 강제 드랍다운
+-------------------------------------------------------------------------------------------------*/
function grd_list_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	switch(e.col)
	{
		case 4 :	// 사유
		case 5 :	// 상세사유
			var rs = grd_list.dropdownCombo();
			trace(rs);
			break;
	}
}

/*-------------------------------------------------------------------------------------------------+
>>  기   능:	캘린더 focus 없어질때 캘린더 value 지정
+-------------------------------------------------------------------------------------------------*/
function fn_set_date(nRow, nCol, sDate)
{
	// 단축값 설정
	var strDate  = sDate;
	var currday  = gfn_today();
	var currleng = 0;
	
	// 2015.04.01  김재섭수정
	if (gfn_isNull(strDate))
	{
		currleng = 0;
	}
	else
	{
		currleng = strDate.length;
	}
	
	switch(currleng)
	{
		case 1:
			ds_list.setColumn(nRow, nCol, gfn_subStr(currday,0,6)+"0"+strDate);
			break;
		case 2:
			ds_list.setColumn(nRow, nCol, gfn_subStr(currday,0,6)+strDate);
			break;
		case 3:
			ds_list.setColumn(nRow, nCol, gfn_subStr(currday,0,4)+"0"+strDate);
			break;
		case 4:
			ds_list.setColumn(nRow, nCol, gfn_subStr(currday,0,4)+strDate);
			break;
		case 5:
			ds_list.setColumn(nRow, nCol, gfn_subStr(currday,0,3)+strDate);
			break;
		case 6:
			ds_list.setColumn(nRow, nCol, gfn_subStr(currday,0,2)+strDate);
			break;
		case 7:
			ds_list.setColumn(nRow, nCol, gfn_subStr(currday,0,1)+strDate);
			break;
		default : 
			return;
			break;
	}
}
]]></Script>
  </Form>
</FDL>

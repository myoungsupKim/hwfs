<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="OrderRequestUpload" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1155 713" titletext="주문신청업로드(식자재_식재영업_긴급)테스트" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1140 0 1155 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 697 1150 712" anchor="left bottom"/>
        <Static id="Static18" text="주문신청내역" class="sta_WF_Title01" position="absolute 15 93 465 111" anchor="left top"/>
        <Static id="Static20" text="글자기준간격 h08" class="Guide01_AreaRed" visible="false" position="absolute 0 106 450 114" anchor="left top"/>
        <Grid id="grd_list" taborder="2" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 14 114 1140 480" anchor="all" autofittype="none" binddataset="ds_list" autosizingtype="none" onheadclick="grd_list_onheadclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="85"/>
                <Column size="166"/>
                <Column size="76"/>
                <Column size="69"/>
                <Column size="73"/>
                <Column size="135"/>
                <Column size="152"/>
                <Column size="68"/>
                <Column size="63"/>
                <Column size="193"/>
                <Column size="181"/>
                <Column size="300"/>
                <Column size="69"/>
                <Column size="400"/>
                <Column size="77"/>
                <Column size="77"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" class="grd_WF_Essential" text="창고코드"/>
                <Cell col="2" text="창고명"/>
                <Cell col="3" class="grd_WF_Essential" text="발주일"/>
                <Cell col="4" class="grd_WF_Essential" text="입고일"/>
                <Cell col="5" class="grd_WF_Essential" text="자재코드"/>
                <Cell col="6" text="자재명"/>
                <Cell col="7" text="규격"/>
                <Cell col="8" text="구매단위"/>
                <Cell col="9" class="grd_WF_Essential" text="수량"/>
                <Cell col="10" text="비고"/>
                <Cell col="11" text="사업장"/>
                <Cell col="12" text="오류메시지"/>
                <Cell col="13" text="구매상세"/>
                <Cell col="14" text="오류메시지"/>
                <Cell col="15" text="상태"/>
                <Cell col="16" text="구매상태"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:subinvCode"/>
                <Cell col="2" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:subinvName"/>
                <Cell col="3" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prDate"/>
                <Cell col="4" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:needDate"/>
                <Cell col="5" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemCode"/>
                <Cell col="6" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemName"/>
                <Cell col="7" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemSize"/>
                <Cell col="8" displaytype="text" style="align:center;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemUnit"/>
                <Cell col="9" displaytype="number" edittype="masknumber" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prQty" mask="#,##0.#0"/>
                <Cell col="10" displaytype="text" edittype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prRemark"/>
                <Cell col="11" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:rcUpjangNm"/>
                <Cell col="12" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:red;color2:red;" text="bind:msg"/>
                <Cell col="13" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:poMsg"/>
                <Cell col="14" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:blue;color2:blue;" text="bind:msg2"/>
                <Cell col="15" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:blue;color2:blue;" text="bind:soStatusNm"/>
                <Cell col="16" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:blue;color2:blue;" text="bind:lineStatusNm"/>
              </Band>
            </Format>
            <Format id="down">
              <Columns>
                <Column size="85"/>
                <Column size="76"/>
                <Column size="69"/>
                <Column size="73"/>
                <Column size="135"/>
                <Column size="152"/>
                <Column size="68"/>
                <Column size="63"/>
                <Column size="193"/>
                <Column size="208"/>
                <Column size="300"/>
                <Column size="215"/>
                <Column size="300"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="grd_WF_Essential" text="창고코드"/>
                <Cell col="1" class="grd_WF_Essential" text="발주일"/>
                <Cell col="2" class="grd_WF_Essential" text="입고일"/>
                <Cell col="3" class="grd_WF_Essential" text="자재코드"/>
                <Cell col="4" text="자재명"/>
                <Cell col="5" text="규격"/>
                <Cell col="6" text="구매단위"/>
                <Cell col="7" class="grd_WF_Essential" text="수량"/>
                <Cell col="8" text="비고"/>
                <Cell col="9" text="사업장"/>
                <Cell col="10" text="오류메시지"/>
                <Cell col="11" text="구매상세오류"/>
                <Cell col="12" text="오류메시지"/>
              </Band>
              <Band id="body">
                <Cell style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:subinvCode"/>
                <Cell col="1" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prDate"/>
                <Cell col="2" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:needDate"/>
                <Cell col="3" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemCode"/>
                <Cell col="4" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemName"/>
                <Cell col="5" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemSize"/>
                <Cell col="6" displaytype="text" style="align:center;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemUnit"/>
                <Cell col="7" displaytype="number" edittype="none" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prQty" mask="#,##0.#0"/>
                <Cell col="8" displaytype="text" edittype="none" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prRemark"/>
                <Cell col="9" displaytype="text" style="align:left middle;" text="bind:rcUpjangNm"/>
                <Cell col="10" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:red;color2:red;" text="bind:msg"/>
                <Cell col="11" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:poMsg"/>
                <Cell col="12" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:blue;color2:blue;" text="bind:msg2"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static25" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 1056 110 1140 115" anchor="top right"/>
        <Static id="Static00" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1100 10"/>
        <Static id="sta_title" text="29.식자재_식재영업_긴급 구매신청 업로드 서버" class="sta_WF_Title" position="absolute 15 16 341 40"/>
        <Static id="Static03" text="아이콘기준 h08" class="Guide01_AreaRed" visible="false" position="absolute 15 32 215 40"/>
        <Static id="Static17" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 15 10 215 16"/>
        <Button id="btn_delete" taborder="6" text="삭제" onclick="fn_delete" class="btn_WF_CRUD" position="absolute 1001 10 1046 35" anchor="top right"/>
        <Button id="btn_save" taborder="7" text="저장" onclick="fn_save" class="btn_WF_CRUD" position="absolute 1048 10 1093 35" anchor="top right"/>
        <Button id="btn_close" taborder="8" text="닫기" onclick="btn_close_onclick" class="btn_WF_CRUD" position="absolute 1095 10 1140 35" anchor="top right"/>
        <Static id="Static14" text="W102" visible="false" position="absolute 1093 10 1095 35" anchor="top right" style="background:#ff000055;align:center middle;"/>
        <Static id="Static16" text="W102" visible="false" position="absolute 1046 10 1048 35" anchor="top right" style="background:#ff000055;align:center middle;"/>
        <Button id="btn_excel" taborder="5" text="엑셀" class="btn_WF_CRUD" position="absolute 954 10 999 35" anchor="top right" onclick="fn_excel"/>
        <Static id="Static21" text="W102" visible="false" position="absolute 999 10 1001 35" anchor="top right" style="background:#ff000055;align:center middle;"/>
        <Static id="Static41" text="엑셀 업로드 후 저장 버튼을 눌러 처리합니다." onclick="Static41_onclick" class="sta_WF_DiscInfo" position="absolute 696 98 1046 118" anchor="top right"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 40 1140 81" anchor="left top right"/>
        <Static id="Static12" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 15 341"/>
        <Static id="Static09" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 234 41 327 51" anchor="left top"/>
        <Static id="Static13" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 81 51 91 72" anchor="left top"/>
        <Static id="Static27" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 191 51 221 77" anchor="left top"/>
        <Static id="Static30" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 285 51 295 72" anchor="left top"/>
        <ObjCalendar id="cal_prDate" anchor="left top" titletext="캘린더" taborder="0" scrollbars="none" enable="false" position="absolute 91 51 191 72"/>
        <Static id="Static52" text="신청일자" class="sta_WFSA_label" position="absolute 18 51 94 72" anchor="left top"/>
        <Static id="Static31" text="입고일자" class="sta_WFSA_label" position="absolute 222 51 298 72" anchor="left top"/>
        <ObjCalendar id="cal_needDate" anchor="left top" titletext="캘린더" taborder="1" scrollbars="none" enable="false" position="absolute 295 51 395 72"/>
        <ProgressBar id="pbr_status" taborder="3" text="엑셀업로드 진행 작업" max="100" min="0" position="absolute 1172 51 1538 75" anchor="top right" visible="false"/>
        <Static id="Static19" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 81 450 94"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 690 81 1140 94"/>
        <Grid id="grd_list2" taborder="9" binddataset="ds_sample" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 844 342 1128 464" anchor="left top right" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="136"/>
                <Column size="173"/>
                <Column size="60"/>
                <Column size="80"/>
                <Column size="200"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="창고코드"/>
                <Cell col="1" text="발주일"/>
                <Cell col="2" text="입고일"/>
                <Cell col="3" text="자재코드"/>
                <Cell col="4" text="자재명"/>
                <Cell col="5" text="규격"/>
                <Cell col="6" text="단위"/>
                <Cell col="7" text="수량"/>
                <Cell col="8" text="비고"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center middle;" text="bind:subinvCode"/>
                <Cell col="1" displaytype="text" style="align:center middle;" text="bind:prDate"/>
                <Cell col="2" displaytype="text" style="align:center middle;" text="bind:needDate"/>
                <Cell col="3" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                <Cell col="4" displaytype="text" text="bind:itemName"/>
                <Cell col="5" displaytype="text" text="bind:itemSize"/>
                <Cell col="6" displaytype="text" style="align:center middle;" text="bind:itemUnit"/>
                <Cell col="7" displaytype="normal" style="align:right middle;" text="bind:prQty"/>
                <Cell col="8" displaytype="text" text="bind:prRemark"/>
              </Band>
            </Format>
            <Format id="down">
              <Columns>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="136"/>
                <Column size="173"/>
                <Column size="60"/>
                <Column size="80"/>
                <Column size="200"/>
              </Columns>
              <Rows>
                <Row size="24"/>
              </Rows>
              <Band id="body">
                <Cell displaytype="text" style="align:center middle;" text="bind:subinvCode"/>
                <Cell col="1" displaytype="text" style="align:center middle;" text="bind:prDate"/>
                <Cell col="2" displaytype="text" style="align:center middle;" text="bind:needDate"/>
                <Cell col="3" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                <Cell col="4" displaytype="text" text="bind:itemName"/>
                <Cell col="5" displaytype="text" text="bind:itemSize"/>
                <Cell col="6" displaytype="text" style="align:center middle;" text="bind:itemUnit"/>
                <Cell col="7" displaytype="normal" style="align:right middle;" text="bind:prQty"/>
                <Cell col="8" displaytype="text" text="bind:prRemark"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_template" taborder="4" text="엑셀템플릿" class="btn_WF_Function" visible="true" position="absolute 1063 90 1140 110" anchor="top right" onclick="btn_template_onclick"/>
        <Grid id="grd_listErr" taborder="10" binddataset="ds_listErr" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 14 490 1140 696" anchor="all">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="85"/>
                <Column size="166"/>
                <Column size="76"/>
                <Column size="69"/>
                <Column size="73"/>
                <Column size="135"/>
                <Column size="152"/>
                <Column size="68"/>
                <Column size="63"/>
                <Column size="193"/>
                <Column size="181"/>
                <Column size="300"/>
                <Column size="213"/>
                <Column size="400"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" class="grd_WF_Essential" text="창고코드"/>
                <Cell col="2" text="창고명"/>
                <Cell col="3" class="grd_WF_Essential" text="발주일"/>
                <Cell col="4" class="grd_WF_Essential" text="입고일"/>
                <Cell col="5" class="grd_WF_Essential" text="자재코드"/>
                <Cell col="6" text="자재명"/>
                <Cell col="7" text="규격"/>
                <Cell col="8" text="구매단위"/>
                <Cell col="9" class="grd_WF_Essential" text="수량"/>
                <Cell col="10" text="비고"/>
                <Cell col="11" text="사업장"/>
                <Cell col="12" text="오류메시지"/>
                <Cell col="13" text="구매상세"/>
                <Cell col="14" text="오류메시지"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:subinvCode"/>
                <Cell col="2" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:subinvName"/>
                <Cell col="3" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prDate"/>
                <Cell col="4" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:needDate"/>
                <Cell col="5" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemCode"/>
                <Cell col="6" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemName"/>
                <Cell col="7" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemSize"/>
                <Cell col="8" displaytype="text" style="align:center;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemUnit"/>
                <Cell col="9" displaytype="number" edittype="masknumber" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prQty" mask="#,##0.#0"/>
                <Cell col="10" displaytype="text" edittype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prRemark"/>
                <Cell col="11" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:rcUpjangNm"/>
                <Cell col="12" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:red;color2:red;" text="bind:msg"/>
                <Cell col="13" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:poMsg"/>
                <Cell col="14" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:blue;color2:blue;" text="bind:msg2"/>
              </Band>
            </Format>
            <Format id="down">
              <Columns>
                <Column size="85"/>
                <Column size="76"/>
                <Column size="69"/>
                <Column size="73"/>
                <Column size="135"/>
                <Column size="152"/>
                <Column size="68"/>
                <Column size="63"/>
                <Column size="193"/>
                <Column size="208"/>
                <Column size="300"/>
                <Column size="215"/>
                <Column size="300"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="grd_WF_Essential" text="창고코드"/>
                <Cell col="1" class="grd_WF_Essential" text="발주일"/>
                <Cell col="2" class="grd_WF_Essential" text="입고일"/>
                <Cell col="3" class="grd_WF_Essential" text="자재코드"/>
                <Cell col="4" text="자재명"/>
                <Cell col="5" text="규격"/>
                <Cell col="6" text="구매단위"/>
                <Cell col="7" class="grd_WF_Essential" text="수량"/>
                <Cell col="8" text="비고"/>
                <Cell col="9" text="사업장"/>
                <Cell col="10" text="오류메시지"/>
                <Cell col="11" text="구매상세오류"/>
                <Cell col="12" text="오류메시지"/>
              </Band>
              <Band id="body">
                <Cell style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:subinvCode"/>
                <Cell col="1" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prDate"/>
                <Cell col="2" displaytype="text" style="align:center middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:needDate"/>
                <Cell col="3" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemCode"/>
                <Cell col="4" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemName"/>
                <Cell col="5" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemSize"/>
                <Cell col="6" displaytype="text" style="align:center;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:itemUnit"/>
                <Cell col="7" displaytype="number" edittype="none" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prQty" mask="#,##0.#0"/>
                <Cell col="8" displaytype="text" edittype="none" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:prRemark"/>
                <Cell col="9" displaytype="text" style="align:left middle;" text="bind:rcUpjangNm"/>
                <Cell col="10" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:red;color2:red;" text="bind:msg"/>
                <Cell col="11" displaytype="text" style="background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');" text="bind:poMsg"/>
                <Cell col="12" displaytype="text" style="align:left middle;background:EXPR(error=='Y'?'gold':'');background2:EXPR(error=='Y'?'gold':'');color:blue;color2:blue;" text="bind:msg2"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="Grid00" taborder="11" useinputpanel="false" position="absolute 229 344 812 470" binddataset="ds_excel" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="subinvCode"/>
                <Cell col="1" disptype="normal" text="prDate"/>
                <Cell col="2" disptype="normal" text="needDate"/>
                <Cell col="3" disptype="normal" text="itemCode"/>
                <Cell col="4" disptype="normal" text="itemName"/>
                <Cell col="5" disptype="normal" text="itemSize"/>
                <Cell col="6" disptype="normal" text="itemUnit"/>
                <Cell col="7" disptype="normal" text="prQty"/>
                <Cell col="8" disptype="normal" text="prRemark"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:subinvCode"/>
                <Cell col="1" disptype="normal" text="bind:prDate"/>
                <Cell col="2" disptype="normal" text="bind:needDate"/>
                <Cell col="3" disptype="normal" text="bind:itemCode"/>
                <Cell col="4" disptype="normal" text="bind:itemName"/>
                <Cell col="5" disptype="normal" text="bind:itemSize"/>
                <Cell col="6" disptype="normal" text="bind:itemUnit"/>
                <Cell col="7" disptype="normal" text="bind:prQty"/>
                <Cell col="8" disptype="normal" text="bind:prRemark"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Splitter id="sp_line" type="vertical" position="absolute 16 480 1139 490" anchor="left top right" onmove="sp_line_onmove">
          <Formats>
            <Format id="default">
              <SplitterItems id="items">
                <SplitterItem id="item00" position="leftortop" bindtype="resize" componentid="grd_list"/>
                <SplitterItem id="item02" position="rightorbottom" bindtype="resize" componentid="grd_listErr" offset="3"/>
              </SplitterItems>
            </Format>
          </Formats>
        </Splitter>
        <Static id="Static01" text="서버환경에 따라 시간이 소요됩니다." onclick="Static41_onclick" class="sta_WF_DiscInfo" position="absolute 696 82 1046 102" anchor="top right"/>
        <Static id="sta_msg" text="식재영업_긴급 업로드의 경우 여신 및 0단가 여부 등의 기본적인 사항만 체크합니다." class="sta_WF_DiscPoint" visible="true" position="absolute 605 52 1133 72" anchor="top right"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item2" compid="cal_prDate" propid="text" datasetid="ds_search" columnid="schPrDate"/>
      <BindItem id="item3" compid="cal_needDate" propid="text" datasetid="ds_search" columnid="schNeedDate"/>
    </Bind>
    <Objects>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_search_oncolumnchanged">
        <ColumnInfo>
          <Column id="schType" type="STRING" size="256"/>
          <Column id="schTypeNm" type="STRING" size="256"/>
          <Column id="schSabun" type="STRING" size="256"/>
          <Column id="schPrDate" type="STRING" size="256"/>
          <Column id="schNeedDate" type="STRING" size="256"/>
          <Column id="schPrUpjang" type="STRING" size="256"/>
          <Column id="schPrDeptId" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="rcUpjang" type="STRING" size="256"/>
          <Column id="rcUpjangNm" type="STRING" size="256"/>
          <Column id="invatFlag" type="STRING" size="256"/>
          <Column id="outvatFlag" type="STRING" size="256"/>
          <Column id="stockFlag" type="STRING" size="256"/>
          <Column id="minOrdQty" type="STRING" size="256"/>
          <Column id="maxOrdQty" type="STRING" size="256"/>
          <Column id="multiplierQty" type="STRING" size="256"/>
          <Column id="pointFlag" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
          <Column id="error" type="STRING" size="256"/>
          <Column id="msg" type="STRING" size="256"/>
          <Column id="msg2" type="STRING" size="256"/>
          <Column id="cenFlag" type="STRING" size="256"/>
          <Column id="subFlag" type="STRING" size="256"/>
          <Column id="subInfoFlag" type="STRING" size="256"/>
          <Column id="itemFlag" type="STRING" size="256"/>
          <Column id="cusFlag" type="STRING" size="256"/>
          <Column id="poCnt" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="poStatus" type="STRING" size="256"/>
          <Column id="poMsg" type="STRING" size="256"/>
          <Column id="fmpStatus" type="STRING" size="256"/>
          <Column id="poNoStatus" type="STRING" size="256"/>
          <Column id="ordFlag" type="STRING" size="256"/>
          <Column id="ordDaysFlag" type="STRING" size="256"/>
          <Column id="headYn" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="creditYn" type="STRING" size="256"/>
          <Column id="poType" type="STRING" size="256"/>
          <Column id="prUpjang" type="STRING" size="256"/>
          <Column id="prDeptId" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_excel" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listRow" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="rcUpjang" type="STRING" size="256"/>
          <Column id="rcUpjangNm" type="STRING" size="256"/>
          <Column id="invatFlag" type="STRING" size="256"/>
          <Column id="outvatFlag" type="STRING" size="256"/>
          <Column id="stockFlag" type="STRING" size="256"/>
          <Column id="minOrdQty" type="STRING" size="256"/>
          <Column id="maxOrdQty" type="STRING" size="256"/>
          <Column id="multiplierQty" type="STRING" size="256"/>
          <Column id="pointFlag" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
          <Column id="error" type="STRING" size="256"/>
          <Column id="msg" type="STRING" size="256"/>
          <Column id="msg2" type="STRING" size="256"/>
          <Column id="cenFlag" type="STRING" size="256"/>
          <Column id="subFlag" type="STRING" size="256"/>
          <Column id="subInfoFlag" type="STRING" size="256"/>
          <Column id="itemFlag" type="STRING" size="256"/>
          <Column id="cusFlag" type="STRING" size="256"/>
          <Column id="poCnt" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="poStatus" type="STRING" size="256"/>
          <Column id="poMsg" type="STRING" size="256"/>
          <Column id="fmpStatus" type="STRING" size="256"/>
          <Column id="poNoStatus" type="STRING" size="256"/>
          <Column id="ordFlag" type="STRING" size="256"/>
          <Column id="ordDaysFlag" type="STRING" size="256"/>
          <Column id="headYn" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="creditYn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_excelRow" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_saveRow" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="rcUpjang" type="STRING" size="256"/>
          <Column id="invatFlag" type="STRING" size="256"/>
          <Column id="outvatFlag" type="STRING" size="256"/>
          <Column id="stockFlag" type="STRING" size="256"/>
          <Column id="minOrdQty" type="STRING" size="256"/>
          <Column id="maxOrdQty" type="STRING" size="256"/>
          <Column id="multiplierQty" type="STRING" size="256"/>
          <Column id="pointFlag" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
          <Column id="error" type="STRING" size="256"/>
          <Column id="msg" type="STRING" size="256"/>
          <Column id="cenFlag" type="STRING" size="256"/>
          <Column id="subFlag" type="STRING" size="256"/>
          <Column id="itemFlag" type="STRING" size="256"/>
          <Column id="cusFlag" type="STRING" size="256"/>
          <Column id="poCnt" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="poStatus" type="STRING" size="256"/>
          <Column id="poMsg" type="STRING" size="256"/>
          <Column id="fmpStatus" type="STRING" size="256"/>
          <Column id="poNoStatus" type="STRING" size="256"/>
          <Column id="ordFlag" type="STRING" size="256"/>
          <Column id="ordDaysFlag" type="STRING" size="256"/>
          <Column id="headYn" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="creditYn" type="STRING" size="256"/>
          <Column id="oldRow" type="STRING" size="256"/>
          <Column id="prNum" type="STRING" size="256"/>
          <Column id="approveNum" type="STRING" size="256"/>
          <Column id="prDeptId" type="STRING" size="256"/>
          <Column id="prUpjang" type="STRING" size="256"/>
          <Column id="poType" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_save" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="rcUpjang" type="STRING" size="256"/>
          <Column id="invatFlag" type="STRING" size="256"/>
          <Column id="outvatFlag" type="STRING" size="256"/>
          <Column id="stockFlag" type="STRING" size="256"/>
          <Column id="minOrdQty" type="STRING" size="256"/>
          <Column id="maxOrdQty" type="STRING" size="256"/>
          <Column id="multiplierQty" type="STRING" size="256"/>
          <Column id="pointFlag" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
          <Column id="error" type="STRING" size="256"/>
          <Column id="msg" type="STRING" size="256"/>
          <Column id="cenFlag" type="STRING" size="256"/>
          <Column id="subFlag" type="STRING" size="256"/>
          <Column id="itemFlag" type="STRING" size="256"/>
          <Column id="cusFlag" type="STRING" size="256"/>
          <Column id="poCnt" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="poStatus" type="STRING" size="256"/>
          <Column id="poMsg" type="STRING" size="256"/>
          <Column id="fmpStatus" type="STRING" size="256"/>
          <Column id="poNoStatus" type="STRING" size="256"/>
          <Column id="ordFlag" type="STRING" size="256"/>
          <Column id="ordDaysFlag" type="STRING" size="256"/>
          <Column id="headYn" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="creditYn" type="STRING" size="256"/>
          <Column id="oldRow" type="STRING" size="256"/>
          <Column id="prNum" type="STRING" size="256"/>
          <Column id="approveNum" type="STRING" size="256"/>
          <Column id="prDeptId" type="STRING" size="256"/>
          <Column id="prUpjang" type="STRING" size="256"/>
          <Column id="poType" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_type" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="poType" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_upload" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sample" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100217</Col>
            <Col id="itemName">수수</Col>
            <Col id="itemSize">[상품]</Col>
            <Col id="itemUnit">KG</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100226</Col>
            <Col id="itemName">기장조</Col>
            <Col id="itemSize">[상품]</Col>
            <Col id="itemUnit">KG</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100227</Col>
            <Col id="itemName">메조</Col>
            <Col id="itemSize">[상품]</Col>
            <Col id="itemUnit">KG</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100229</Col>
            <Col id="itemName">차조</Col>
            <Col id="itemSize">[상품]</Col>
            <Col id="itemUnit">KG</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100244</Col>
            <Col id="itemName">흑임자 두보식품</Col>
            <Col id="itemSize">[500g/EA, EA] </Col>
            <Col id="itemUnit">EA</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100247</Col>
            <Col id="itemName">검정깨</Col>
            <Col id="itemUnit">EA</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100249</Col>
            <Col id="itemName">흑임자가루</Col>
            <Col id="itemUnit">EA</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100708</Col>
            <Col id="itemName">배추</Col>
            <Col id="itemSize">[3통/망] [상] [망작?</Col>
            <Col id="itemUnit">BOX</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100710</Col>
            <Col id="itemName">알배기배추</Col>
            <Col id="itemSize">[약간청색] </Col>
            <Col id="itemUnit">KG</Col>
            <Col id="prQty">1</Col>
          </Row>
          <Row>
            <Col id="subinvCode">S1012238</Col>
            <Col id="prDate">20150625</Col>
            <Col id="needDate">20150629</Col>
            <Col id="itemCode">F100799</Col>
            <Col id="itemName">깻잎, 나물 </Col>
            <Col id="itemSize">[상]</Col>
            <Col id="itemUnit">KG</Col>
            <Col id="prQty">1</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">0</Col>
            <Col id="delYn">1</Col>
            <Col id="savYn">1</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">1</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_listErr" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="rcUpjang" type="STRING" size="256"/>
          <Column id="rcUpjangNm" type="STRING" size="256"/>
          <Column id="invatFlag" type="STRING" size="256"/>
          <Column id="outvatFlag" type="STRING" size="256"/>
          <Column id="stockFlag" type="STRING" size="256"/>
          <Column id="minOrdQty" type="STRING" size="256"/>
          <Column id="maxOrdQty" type="STRING" size="256"/>
          <Column id="multiplierQty" type="STRING" size="256"/>
          <Column id="pointFlag" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
          <Column id="error" type="STRING" size="256"/>
          <Column id="msg" type="STRING" size="256"/>
          <Column id="msg2" type="STRING" size="256"/>
          <Column id="cenFlag" type="STRING" size="256"/>
          <Column id="subFlag" type="STRING" size="256"/>
          <Column id="subInfoFlag" type="STRING" size="256"/>
          <Column id="itemFlag" type="STRING" size="256"/>
          <Column id="cusFlag" type="STRING" size="256"/>
          <Column id="poCnt" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="poStatus" type="STRING" size="256"/>
          <Column id="poMsg" type="STRING" size="256"/>
          <Column id="fmpStatus" type="STRING" size="256"/>
          <Column id="poNoStatus" type="STRING" size="256"/>
          <Column id="ordFlag" type="STRING" size="256"/>
          <Column id="ordDaysFlag" type="STRING" size="256"/>
          <Column id="headYn" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="creditYn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list_result" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="rcUpjang" type="STRING" size="256"/>
          <Column id="rcUpjangNm" type="STRING" size="256"/>
          <Column id="invatFlag" type="STRING" size="256"/>
          <Column id="outvatFlag" type="STRING" size="256"/>
          <Column id="stockFlag" type="STRING" size="256"/>
          <Column id="minOrdQty" type="STRING" size="256"/>
          <Column id="maxOrdQty" type="STRING" size="256"/>
          <Column id="multiplierQty" type="STRING" size="256"/>
          <Column id="pointFlag" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
          <Column id="error" type="STRING" size="256"/>
          <Column id="msg" type="STRING" size="256"/>
          <Column id="msg2" type="STRING" size="256"/>
          <Column id="cenFlag" type="STRING" size="256"/>
          <Column id="subFlag" type="STRING" size="256"/>
          <Column id="subInfoFlag" type="STRING" size="256"/>
          <Column id="itemFlag" type="STRING" size="256"/>
          <Column id="cusFlag" type="STRING" size="256"/>
          <Column id="poCnt" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="poStatus" type="STRING" size="256"/>
          <Column id="poMsg" type="STRING" size="256"/>
          <Column id="fmpStatus" type="STRING" size="256"/>
          <Column id="poNoStatus" type="STRING" size="256"/>
          <Column id="ordFlag" type="STRING" size="256"/>
          <Column id="ordDaysFlag" type="STRING" size="256"/>
          <Column id="headYn" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="creditYn" type="STRING" size="256"/>
          <Column id="poType" type="STRING" size="256"/>
          <Column id="prUpjang" type="STRING" size="256"/>
          <Column id="prDeptId" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : OrderRequestUpload3
  파 일 명 : OrderRequestUpload3.xfdl
  기    능 : 식재영업 / 주문관리 / 주문신청 / 구매신청업로드(긴급)

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.12.01   최성연   최초 생성
  
  1) 공통 버튼 정의
  - 엑셀, 삭제, 저장,  닫기, 도움말 활성화
  
  2) 검토사항
  가) 파라미터
  - 구매유형 : 타이틀 표시, 식자재_긴급 건만 처리 가능
  - 로그인정보 : 신청자 정보 조회

  나) 저장 처리
  
  3) 처리순서
  - 긴급일 경우, 여신체크, 0단가, 불용, 중지자재만 체크함   
*/
/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "U_lib::lib_conversionCom.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_processCnt = 0;			//처리건수
var fv_objColInfo;				//데이터셋 컬럼정보
var fv_closeFlag = "";			//닫기 버튼 클릭 시 작업여부를 CHECK 하여 Parent 창에서
var fv_dDays;					//구매유형_D-DAY
var fv_dTimes;					//구매유형-D-TIMES

// 엑셀업로드 관련 변수
var fv_excelRowCnt;				//현재대상 Row Count
var fv_excelRow;				//현재대상 Row Index
var fv_errorFlag;				//에러발생 여부(Y/N)
var fv_errorMsg;				//에러발생 메시지

// 저장 관련 변수
var fv_prNum = "";				//저장 시 주문신청번호를 미리 SET
var fv_approveNum = "";			//저장 시 신청승인번호를 미리 SET
var fv_prNumFlag = false;		//주문신청, 승인번호 SET 상태여부
var fv_saveRowCnt;				//저장대상 Row Count
var fv_saveRow;					//저장대상 Row Index
var fv_row;						//저장대상 ROW ID 

var fv_ret;						//트랜잭션 리턴 값 (E:오류)
var fv_retMsg;					//트랜잭션 리턴 메시지(오류시)
var fv_saveFlag = true;			//중복 저장 방지 상태 true(저장) false(저장불가)

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();

	// 구매유형 SET
	fn_searchType();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	// Argument Dataset으로 받기
 	try {
 		//trace("P_DATASET Dataset :\n" + P_DATASET.saveXML());
		ds_search.setColumn(0, "schType", P_DATASET.getColumn(0, "schType"));
		ds_search.setColumn(0, "schTypeNm", P_DATASET.getColumn(0, "schTypeNm"));
		ds_search.setColumn(0, "schSabun", P_DATASET.getColumn(0, "schSabun"));
		ds_search.setColumn(0, "schPrDate", P_DATASET.getColumn(0, "schPrDate"));
		ds_search.setColumn(0, "schNeedDate", P_DATASET.getColumn(0, "schNeedDate"));

		// 로그인정보 SET
		ds_search.setColumn(0, "schPrDeptId", g_Deptid);
		ds_search.setColumn(0, "schPrUpjang", g_Upjang);
		

		// 입고일선택
		cal_prDate.fn_initMonthCal(this, "", "", ds_search, "schPrDate", "Y");	
		cal_needDate.fn_initMonthCal(this, "", "", ds_search, "schNeedDate", "Y");	
		
		// 화면 제목 표시
		sta_title.text = ds_search.getColumn(ds_search.rowposition, "schType") + "." + ds_search.getColumn(ds_search.rowposition, "schTypeNm");

 	} catch(err) {
 	
 	}
 	btn_save.enable = false;
 	btn_delete.enable = false;
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close(retResult)
{	
    var retVal = new Array();
    retVal[0] = retResult;
    close(retVal);
}


/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 * 선택한 ROW 삭제
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{
	var nRowCnt = ds_list.getRowCount();	// DataSet Count
	var nRow = ds_list.rowposition;
	
	if(nRow == -1) 
	{
		gfn_alert("msg.err.grid.noselect", "삭제할 row");	// 선택된 항목이 없습니다.
		return;
	}
	ds_list.setColumn("lineStatus","");
	
	// 해당 ROW를 삭제
	ds_list.deleteRow(nRow);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 * 저장 !!!!!!
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
	if(!fv_saveFlag){
		gfn_alert("엑셀파일을 재업로드 해주시기 바랍니다.");
		return;
	}
	
	var nRowCnt = ds_list.getRowCount();	// DataSet Count
	var iCnt = 0;
	var sMsg = "";

	// 오류상태의 행 또는 삭제된 행을 제외하고 ROW COUNT
	// 생성 CHECK 개수 
	for (var i = 0 ; i < nRowCnt ; i++)
	{
		// Dataset이 오류가 아닌 자료
		if (ds_list.getColumn(i, "error")!="Y")
		{
			if (ds_list.getRowType(i) <> Dataset.ROWTYPE_DELETE) {
				iCnt++;
			}
		}
	}
	
	// 저장할 자료 여부 CHECK
	if(iCnt == 0) 
	{
		gfn_alert("msg.save.nodata", "저장할 데이터");	// 저장할 데이터가 없습니다.
		return;
	}
	
	// 기본 CHECK 진행
	//if (!fn_itemCheck()) return;
	
	sMsg = "주문신청내역를 저장합니다.\n\n계속 진행 하시겠습니까?\n";
	sMsg = sMsg + " - 오류가 없는 정상적인 자료에 대하여 저장합니다.\n";
	sMsg = sMsg + " ※ 여신관리여부에 따라 여신정보(잔액)을 체크합니다.";
	
	
	if (!gfn_confirm(sMsg, "", "C")) return;
	
	
	// KeySet : 주문신청번호, 신청승인번호 SET
	//fn_searchPrNum(false);

	//if (fv_prNumFlag==false) return;
	
	application.httptimeout = 1800;
	
	var strSvcID    = "saveUpload";
	var strURL      = "fm/fmo/orderRequestUpload/saveUpload.xdo";
	var strInDs     = "ds_list=ds_list";
	var strOutDs    = "ds_list_result=ds_list_result";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
}


/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		if(strSvcID=="saveUpload")
		{
			//fv_errorFlag="Y";
			//fv_errorMsg = strErrorMsg;
			//fn_processStep();
			return;
		}
		else 
		{
			return;
		}
	}

    
    switch(strSvcID)
    {
    
		// 구매유형조회
        case "searchType" :
            //trace(ds_type.saveXML());
            fn_type_init();
            break;
    
    
		// 업로드한 엑셀에 대한 기본정보를 SET
		case "searchUpload" :

            if (ds_list.getRowCount() == 0) {
				//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				gfn_loadDatasetInfo (ds_list, fv_objColInfo);
            }else{
				fv_saveFlag = true;//저장후 다시 저장 불가.
				btn_save.enable = fv_saveFlag;
				btn_delete.enable = fv_saveFlag;
				grd_list.binddataset = ds_list;
            }
			break;
			
        // 저장
        case "saveUpload" :
			if (fv_processCnt > 0) {	
				fv_closeFlag = "OK";
				fv_errorFlag="";
				fv_errorMsg="";
				fv_saveFlag = false;//저장후 다시 저장 불가.
				btn_save.enable = fv_saveFlag;
				btn_delete.enable = fv_saveFlag;
				gfn_alert("msg.save.success");
			}
			if(ds_list_result.getRowCount() > 0){
				grd_list.binddataset = ds_list_result;
			}
            break;  			
    }
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 구매유형정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchType()
{
    var strSvcID    = "searchType";
    var strURL      = "fm/fmo/orderRequest/selectType.xdo";
    var strInDs     = "";
    var strOutDs    = "ds_type=ds_type";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 구매유형 DataSet 초기화 
 *---------------------------------------------------------------------------------------------*/
function fn_type_init()
{
	var v_poType = ds_search.getColumn(ds_search.rowposition, "schType");
	
	// 조건의 구매유형만 선택되게
	var nRow = ds_type.findRowExpr("poType=='" + v_poType + "'");
	
	fv_dDays = ds_type.getColumn(nRow, "dDays");
	fv_dTimes = ds_type.getColumn(nRow, "dTimes");
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 주문신청번호, 신청승인번호를 미리 SET
 *---------------------------------------------------------------------------------------------*/
function fn_searchPrNum(bAsync)
{
    var strSvcID    = "searchPrNum";
    var strURL      = "fm/fmo/orderRequest/selectPrNum.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    //var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 엑셀 버튼 클릭 시
 *---------------------------------------------------------------------------------------------*/
function fn_excel()
{
	// 파일 선택
	var strFileName = gfn_excelFileDialog("LOAD", "EXCEL");

	if (strFileName.length == 0)
	{
		this.setWaitCursor(false);
		return;
	}

	if(ds_list.getRowCount() > 0 || ds_listErr.getRowCount() > 0){
		if(!gfn_confirm("저장하지 않은 데이터는 삭제됩니다.\n\n계속하시겠습니까?")){
			return;
		}
	}
	
	grd_list.binddataset = "";
	ds_list.clearData();
	// 오류 Dataset Clear
	ds_listErr.clearData();

	fv_saveFlag = false;
	btn_save.enable = fv_saveFlag;
	btn_delete.enable = fv_saveFlag;	

	this.setWaitCursor(true);
	
	/*********************************************************************************************
	** argument             : strFileName		파일명 (경로 포함)
	**                        strDsName			Import 대상 Dataset Name
	**                        nStartRow			Import 시작 행(사용된 Range 기준, 1 base)
	**						  bKeepColInfo		Dataset의 컬럼 정보를 유지할지 여부
	*********************************************************************************************/
	var rtn = gfn_importExcel(strFileName, "ds_upload", 1, true);
	
	this.setWaitCursor(false);

	if (ds_upload.getRowCount()>0) {
		// 엑셀업로드 DataSet 처리
		fn_processSetUpload();
	}
	else {
		gfn_alert("msg.err.grid.nodata");	// 데이타가 없습니다
	}

}


/*----------------------------------------------------------------------------------------------
 * 설명      : Progress Bar - 엑셀업로드 용
 *---------------------------------------------------------------------------------------------*/
function fn_processSetUpload()
{
	var iCnt = 0;
	var retFlag;		//엑셀 입력 필수값 체크.

	// 엑셀업로드용 DataSet Filter : 창고코드, 발주일, 입고일, 자재코드 값이 없으면 삭제 
	trace(ds_upload.getRowCount());
	for (var i = 0 ; i < ds_upload.getRowCount() ; i++)
	{
		
		// Null 처리
		if (gfn_nvl(ds_upload.getColumn(i, "subinvCode"), "") == "") ds_upload.setColumn(i, "subinvCode", "");
		if (gfn_nvl(ds_upload.getColumn(i, "itemCode"), "") == "") ds_upload.setColumn(i, "itemCode", "");
		if (gfn_nvl(ds_upload.getColumn(i, "prDate"), "") == "") ds_upload.setColumn(i, "prDate", "");
		if (gfn_nvl(ds_upload.getColumn(i, "needDate"), "") == "") ds_upload.setColumn(i, "needDate", "");
		if (gfn_nvl(ds_upload.getColumn(i, "itemName"), "") == "") ds_upload.setColumn(i, "itemName", "");
		if (gfn_nvl(ds_upload.getColumn(i, "itemSize"), "") == "") ds_upload.setColumn(i, "itemSize", "");
		if (gfn_nvl(ds_upload.getColumn(i, "itemUnit"), "") == "") ds_upload.setColumn(i, "itemUnit", "");
		if (gfn_nvl(ds_upload.getColumn(i, "prRemark"), "") == "") ds_upload.setColumn(i, "prRemark", "");
		
		fv_errorFlag = "";
		fv_errorMsg = "";
			// 기본필수 입력 CHECK
		retFlag = fn_excelCheck(ds_upload,i);
	}
	
	var nRowCnt = ds_excel.getRowCount();	// 엑셀 DataSet Count
	
	if(ds_listErr.getRowCount() == 0){
		fv_objColInfo = gfn_getDatasetInfo (ds_list);
		var strSvcID    = "searchUpload";
		var strURL      = "fm/fmo/orderRequestUpload/saveList2Test.xdo";
		var strInDs     = "ds_list=ds_list:A";
		var strOutDs    = "ds_list=ds_list ds_listErr=ds_listErr";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}else{
		grd_list.binddataset = ds_list;
		gfn_alert("형식에 맞지 않는 주문이 존재합니다.\n\n수정후 재업로드 해 주세요.");	
		return;
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명     : 엑셀 업로드 필수입력 체크 함수
 * 파라미터 : 선택된 행
 *---------------------------------------------------------------------------------------------*/
function fn_excelCheck(objD,arg)
{
	// 창고코드, 발주일자, 입고일자, 자재코드, 수량 CHECK 
	if (gfn_nvl(objD.getColumn(arg, "subinvCode"), "")=="") {
		fv_errorFlag = "Y";
		fv_errorMsg = "창고코드 누락";
	}  else if(gfn_length(gfn_trim(objD.getColumn(arg, "subinvCode"))) > 20) {
		if (fv_errorFlag == "Y") fv_errorMsg = fv_errorMsg + ",";
		fv_errorFlag = "Y";
		fv_errorMsg = fv_errorMsg + "창고코드 오류";
	}
	if (gfn_nvl(objD.getColumn(arg, "itemCode"), "")=="") {
		if (fv_errorFlag == "Y") fv_errorMsg = fv_errorMsg + ",";
		fv_errorFlag = "Y";
		fv_errorMsg = fv_errorMsg + "자재코드 누락";
	} else if(gfn_length(gfn_trim(objD.getColumn(arg, "itemCode"))) > 12) {
		if (fv_errorFlag == "Y") fv_errorMsg = fv_errorMsg + ",";
		fv_errorFlag = "Y";
		fv_errorMsg = fv_errorMsg + "자재코드 오류";
	}
	if (!gfn_isNum(objD.getColumn(arg, "prQty"))) {
		if (fv_errorFlag == "Y") fv_errorMsg = fv_errorMsg + ",";
		fv_errorFlag = "Y";
		fv_errorMsg = fv_errorMsg + "신청수량 누락 및 오류";
	}
	

	// 에러 발생시 현재 엑셀의 Dataset을 ds_list로 복사 : 오류상태 표시
	if (fv_errorFlag=="Y") {
		var iIdx = ds_listErr.addRow();
		ds_listErr.setColumn(iIdx, "subinvCode", gfn_nvl(gfn_trim(objD.getColumn(arg, "subinvCode")).toUpperCase(),""));
		ds_listErr.setColumn(iIdx, "prDate", ds_search.getColumn(ds_search.rowposition, "schPrDate"));
		ds_listErr.setColumn(iIdx, "needDate", ds_search.getColumn(ds_search.rowposition, "schNeedDate"));
		ds_listErr.setColumn(iIdx, "itemCode", gfn_nvl(gfn_trim(objD.getColumn(arg, "itemCode")).toUpperCase(),""));
		ds_listErr.setColumn(iIdx, "itemName", gfn_nvl(objD.getColumn(arg, "itemName"),""));
		ds_listErr.setColumn(iIdx, "itemSize", gfn_nvl(objD.getColumn(arg, "itemSize"),""));
		ds_listErr.setColumn(iIdx, "itemUnit", gfn_nvl(objD.getColumn(arg, "itemUnit").toUpperCase(),""));
		ds_listErr.setColumn(iIdx, "prQty", objD.getColumn(arg, "prQty"));
		ds_listErr.setColumn(iIdx, "prRemark", gfn_nvl(objD.getColumn(arg, "prRemark"),""));
		ds_listErr.setColumn(iIdx, "error", "Y"); 
		ds_listErr.setColumn(iIdx, "msg", fv_errorMsg);
		return false;
	} else {
	// 에러가 없으면 Transaction을 위한 조건DataSet을 생성한다
		var iIdx = ds_list.addRow();
		ds_list.setColumn(iIdx, "subinvCode", gfn_trim(gfn_nvl(objD.getColumn(arg, "subinvCode").toUpperCase(),"")));
		ds_list.setColumn(iIdx, "prDate",     ds_search.getColumn(ds_search.rowposition, "schPrDate"));
		ds_list.setColumn(iIdx, "needDate",   ds_search.getColumn(ds_search.rowposition, "schNeedDate"));
		ds_list.setColumn(iIdx, "itemCode",   gfn_trim(gfn_nvl(objD.getColumn(arg, "itemCode").toUpperCase(),"")));
		ds_list.setColumn(iIdx, "itemName",   gfn_nvl(objD.getColumn(arg, "itemName"),""));
		ds_list.setColumn(iIdx, "itemSize",   gfn_nvl(objD.getColumn(arg, "itemSize"),""));
		ds_list.setColumn(iIdx, "itemUnit",   gfn_nvl(objD.getColumn(arg, "itemUnit").toUpperCase(),""));
		ds_list.setColumn(iIdx, "prQty",      objD.getColumn(arg, "prQty"));
		ds_list.setColumn(iIdx, "prRemark",   gfn_nvl(objD.getColumn(arg, "prRemark"),""));
		ds_list.setColumn(iIdx, "poType",     ds_search.getColumn(ds_search.rowposition, "schType"));
		ds_list.setColumn(iIdx, "prDeptId",   ds_search.getColumn(ds_search.rowposition, "schPrDeptId"));
		ds_list.setColumn(iIdx, "prUpjang",   ds_search.getColumn(ds_search.rowposition, "schPrUpjang"));
		
	}

	return true;
}


/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 닫기버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_close_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_close(fv_closeFlag);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 엑셀템플릿 버튼 클릭 이벤트 - 엑셀 업로드용 export
 *---------------------------------------------------------------------------------------------*/
function btn_template_onclick(obj:Button,  e:ClickEventInfo)
{
	grd_list2.setFormat("down")
	gfn_exportExcel(grd_list2); 
}


function Button00_onclick(obj:Button,  e:ClickEventInfo)
{
	//grd_list2.binddataset = ds_list;
	//grd_list.binddataset = ds_sample;
	grd_list.setFormat("down")
	gfn_exportExcel(grd_list);
	grd_list.setFormat("default")
}

/*----------------------------------------------------------------------------------------------
 * 설명      : Grid Header Click시 이벤트
 *              Merge Head 기준으로 재정의
 *---------------------------------------------------------------------------------------------*/
function grd_list_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	var nCell = e.cell;   

	//엑셀 CLASS 
	if(obj.getCellProperty("Head" ,nCell ,"class") == "head_Excel")
	{
		grd_list.setFormat("down")
		gfn_exportExcel(grd_list);
		grd_list.setFormat("default")
	} else gfn_gridSort(obj, e);	
}]]></Script>
  </Form>
</FDL>

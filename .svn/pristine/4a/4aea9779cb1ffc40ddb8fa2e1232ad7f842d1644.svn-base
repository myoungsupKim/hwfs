<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSP00170V" onkeydown="fn_form_OnKeyDown" onload="form_onload" titletext="클레임처리현황" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Tab id="tab_Main" onchanged="tab_Main_OnChanged" canchange="tab_Main_OnChanging" preload="true" taborder="7" position="absolute 0 84 1237 710" showextrabutton="false" anchor="all">
          <Tabpages>
            <Tabpage id="tab1" taborder="1" text="클레임결과확정" url="U_FSP::FSP00171V.xfdl" position="absolute 2 24 974 552" scrollbars="none"/>
            <Tabpage id="tab2" taborder="5" text="클레임현황조회" url="U_FSP::FSP00172V.xfdl" position="absolute 2 24 974 552" scrollbars="none"/>
            <Tabpage id="tab3" taborder="5" text="클레임처리현황" url="U_FSP::FSP00173V.xfdl" position="absolute 2 24 974 552" scrollbars="none"/>
          </Tabpages>
        </Tab>
        <Button id="btn_Confirm" onclick="Common_Btn_common_OnClick" taborder="22" text="확정" position="absolute 1196 84 1237 105" class="btn_WF_Custom" image=""/>
        <Static id="Static38" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 269 25 1228 30"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 1197 40"/>
        <Static id="Static07" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 1205 71"/>
        <Static id="st_ContractStart" text="창고" class="sta_WFSA_label" position="absolute 15 40 93 61" anchor="left top"/>
        <Static id="Static09" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static03" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 47 40 57 61" anchor="left top"/>
        <Static id="Static10" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 247 40 277 61" anchor="left top"/>
        <Static id="Static11" text="입고일" class="sta_WFSA_label" position="absolute 277 40 326 61" anchor="left top"/>
        <Static id="Static12" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 321 40 331 61" anchor="left top"/>
        <Static id="Static13" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 533 40 563 61" anchor="left top"/>
        <Static id="Static17" text="요청일" class="sta_WFSA_label" position="absolute 563 40 625 61" anchor="left top"/>
        <Static id="Static18" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 607 40 617 61" anchor="left top"/>
        <Static id="Static19" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 712 40 742 61" anchor="left top"/>
        <Static id="Static14" text="자재" class="sta_WFSA_label" position="absolute 743 40 805 61" anchor="left top"/>
        <Static id="Static20" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 774 40 784 61" anchor="left top"/>
        <Static id="Static16" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 918 40 948 61" anchor="left top"/>
        <Static id="Static21" text="처리상황" class="sta_WFSA_label" position="absolute 949 40 1011 61" anchor="left top"/>
        <Static id="Static22" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 1008 40 1018 61" anchor="left top"/>
        <Edit id="ed_Subinv" onkeydown="common_OnKeyDown" taborder="1" position="absolute 57 40 227 61"/>
        <Button id="btn_PopSubinv" onclick="btn_Pop_Subinv" taborder="8" text="" userdata="ed_Subinv" position="absolute 226 40 247 61" class="btn_WF_popSearch" image=""/>
        <Button id="btn_FDate" onclick="g_CalButton_OnClick" taborder="9" tabstop="false" userdata="me_From" position="absolute 404 40 425 61" class="btn_WF_cal" text="" image=""/>
        <Button id="btn_TDate" onclick="g_CalButton_OnClick" taborder="10" tabstop="false" userdata="me_To" position="absolute 512 40 533 61" class="btn_WF_cal" text="" image=""/>
        <MaskEdit id="me_From" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="2" type="string" position="absolute 331 40 405 61" class="msk_WF_Cal"/>
        <MaskEdit id="me_To" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="3" type="string" position="absolute 439 40 513 61" class="msk_WF_Cal"/>
        <Static id="Static4" text="~" position="absolute 427 43 441 59"/>
        <Button id="btn_NDate" onclick="g_CalButton_OnClick" taborder="11" tabstop="false" userdata="me_NeedDate" position="absolute 691 40 712 61" class="btn_WF_cal" text="" image=""/>
        <MaskEdit id="me_NeedDate" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="4" type="string" position="absolute 617 40 692 61" class="msk_WF_Cal"/>
        <Edit id="ed_item" imemode="native" onkeydown="common_OnKeyDown" taborder="5" position="absolute 784 40 898 61"/>
        <Button id="btn_item" onclick="btn_item_OnClick" taborder="12" text="" userdata="ed_item" position="absolute 897 40 918 61" class="btn_WF_popSearch" image=""/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" id="cbo_hand" innerdataset="ds_hand" onkeydown="common_OnKeyDown" taborder="6" position="absolute 1018 40 1137 61"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 450 84"/>
        <Static id="Static00" text="h5" class="Guide01_AreaRed" visible="false" position="absolute 1088 105 1229 110"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="23" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_tab1"/>
      <Dataset id="ds_tab2"/>
      <Dataset id="ds_Input"/>
      <Dataset id="ds_hand"/>
    </Objects>
    <Bind/>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : FS시스템/메뉴관리/구매관리/
 * 프로그램명   : FSP00170V.XML
 * 기      능   : 
 * 작  성  자   : 윤상혁
 * 작성  일자   : 2008-01-16
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::fs_common.js"
//@@컨버터에서 주석처리 #include "lib::po_common.js"


//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================


//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	fsp_init(this);
	
	var v_today=fn_CurrDateWeek();
	me_From.value=v_today;
	me_To.enable=false;
	me_To.value=v_today;
	//me_NeedDate.Value=v_today;
	cbo_hand.enable=false;
	
	// tab_Main.tab1.Url="U_FSP::FSP00171V.xml";
	// tab_Main.tab2.Url="U_FSP::FSP00172V.xml";
	// tab_Main.tab3.Url="U_FSP::FSP00173V.xml";
	// tab_Main.PreLoad=true;
	
	var args="";
	var OutDS="";
	ds_hand.clearData();
	OutDS="ds_hand=ds_hand";
	Transaction("ds_hand","U_svc::" + "fs/fsp/FSP00170V_S001.jsp","",OutDS,args,"fn_call_back");
}
function fn_call_back(svcid,cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
	}
}
//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
function fn_search()
{
	var v_str1=gfn_trim(ed_Subinv.value);
	var v_str2=gfn_trim(me_From.value);
	var v_str3=gfn_trim(me_To.value);
	
	if(gfn_length(v_str1)==0)
	{
		g_Message("EE","창고를 선택하세요.");
		return;
	}
	if(gfn_length(v_str2)==0)
	{
		g_Message("EE","입고일을 입력하세요.");
		return;
	}
	if(gfn_length(v_str3)==0)
	{
		g_Message("EE","입고일을 입력하세요.");
		return;
	}
	switch(tab_Main.tabindex)
	{
		case 0:
			tab_Main.tab1.fn_T1_Search();
			break;
		case 1:
			tab_Main.tab2.fn_T2_Search();
			break;
		case 2:
			tab_Main.tab3.fn_T3_Search();
			break;
	}
}

function fn_save()
{
	switch(tab_Main.tabindex)
	{
		case 0:
			tab_Main.tab1.fn_T1_Save();
			break;
		case 1:
			
			break;
		case 2:
			
			break;
	}
}

function fn_Confirm()
{
	switch(tab_Main.tabindex)
	{
		case 0:
			tab_Main.tab1.fn_T1_Confirm();
			break;
		case 1:
			
			break;
		case 2:
			
			break;
	}
}
function fn_print()
{
	tab_Main.tabindex=2;
	switch(tab_Main.tabindex)
	{
		case 0:
			
			break;
		case 1:
			
			break;
		case 2:
			tab_Main.tab3.fn_T3_Print();
			break;
	}
}

function fn_Close()
{
	this.close();
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
 // G_GridSort(object(obj.BindDataset), obj, nCell);
 /*
 ******************************************************************************************
 * 함  수  명   : Common_Btn_common_OnClick
 * 입      력   : obj  = Form Component
 * 반      환   : 없음
 * 기      능   : 공통함수 호출
 * 작  성  자   : 김동표
 * 작성  일자   : 2008-01-08
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */ 
 
function Common_Btn_common_OnClick(obj:Button, e:ClickEventInfo)
{
	switch(obj.name)
	{
		case "btn_Search":
			fn_search();
			break;
		case "btn_Save":
			fn_save();
			break;
		case "btn_Confirm":
			fn_Confirm();
			break;
		case "btn_Print":
			fn_print();
			break;
		case "btn_Close":
			fn_Close();
			break;
	}
}
 
function tab_Main_OnChanging(obj:Tab, e:TabIndexChangeEventInfo)
{
	var v_str1=gfn_trim(ed_Subinv.value);
	var v_str2=gfn_trim(me_From.value);
	var v_str3=gfn_trim(me_To.value);

	switch(e.postindex)
	{
		case 0:
			break;
		case 1:
			break;
		case 2:
			if(gfn_length(v_str1)==0)
			{
				g_Message("EE","창고를 선택하세요.");
				return false;
			}
			if(gfn_length(v_str2)==0)
			{
				g_Message("EE","입고일을 입력하세요.");
				return false;
			}
			if(gfn_length(v_str3)==0)
			{
				g_Message("EE","입고일을 입력하세요.");
				return false;
			}		
			break;
	}
}

function tab_Main_OnChanged(obj:Tab, e:TabIndexChangeEventInfo)
{
// 처리상황
// 클레임결과확정 Tab 일 경우 Disable 및 NULL
// 클레임현황조회 Tab 일 경우 Enable 처리


// tab1 	from및 to ==>from값으로 to동일값셋팅 ,to Disable처리
// tab2 	from및 to ==>from, to  모두 Enable
// tab3 	from및 to ==>from값으로 to동일값셋팅 ,to Disable처리

	switch(e.postindex)
	{
		case 0:
			div_cmnBtn.btn_save.enable=true;
			btn_Confirm.enable=true;
			
			cbo_hand.enable	=false;
			cbo_hand.index=-1;
						
			me_To.enable	=false;
			me_To.value	=me_From.value;

			tab_Main.tab1.fn_T1_Search();
			break;
		case 1:
			div_cmnBtn.btn_save.enable=false;
			btn_Confirm.enable=false;		
		
			cbo_hand.enable=true;
			
			me_To.enable	=true;
						
			tab_Main.tab2.fn_T2_Search();
			break;
		case 2:
			div_cmnBtn.btn_save.enable=false;
			btn_Confirm.enable=false;			
		
			me_To.enable	=false;
			me_To.value	=me_From.value;

			cbo_hand.enable	=false;
			cbo_hand.index=-1;
					
			tab_Main.tab3.fn_T3_Search();
			break;
	}
}

function btn_Pop_Subinv(obj:Button, e:ClickEventInfo)
{
	// var v_rtn=gfn_dialog("", "U_FSP::FSP00171P.xml","");
	// var v_str=split(v_rtn,";");
	// ed_Subinv.Text=v_str[1];
	// ed_Subinv.UserData=v_str[0];
// 	//[[As-Is 소스
// 	if (SCPopup.runTimeMode == "As-Is")
// 	{
		var strQuery;
		
		strQuery = "SELECT A.SUBINV_CODE, ";
		strQuery += "       DECODE(A.USE_YN, 'N' , '폐장' )||A.SUBINV_CODE||' '||A.SUBINV_NAME||' ( '|| REPLACE(B.UPJANGNM,'단체급식 ')||' ) ' AS SUBINV_NAME ";
		strQuery += "  FROM HLDC_PO_SUBINVENTORY A, ";
		strQuery += "       HLDC_ST_UPJANG B ";
		strQuery += " WHERE A.UPJANG = B.UPJANG ";
		strQuery += "   AND EXISTS ";
		strQuery += "       ( ";
		strQuery += "       SELECT 1 ";
		strQuery += "         FROM HLDC_PO_SUBINV_USER C ";
		strQuery += "        WHERE C.SUBINV_CODE = A.SUBINV_CODE ";
		strQuery += "          AND C.SABUN = '" + g_EmpNo + "'  ";
		strQuery += "       ) ";
		
		strQuery_KeyField		= "SUBINV_CODE";
		strQuery_ValueField		= "DECODE(A.USE_YN,'N','폐장')||A.SUBINV_CODE||' '||A.SUBINV_NAME||'('||B.UPJANGNM||')' ";
		strQuery_KeyFieldNM 	= "창고코드";
		strQuery_ValueFieldNM 	= "창고명";
		strQuery_Caption		= "창고정보조회";
		
		// fn_sql_common_setup(strQuery_SUBINV, 
							// strQuery_SUBINVKeyField, 
							// strQuery_SUBINVValueField, 
							// strQuery_SUBINVKeyFieldNM, 
							// strQuery_SUBINVValueFieldNM, 
							// "", 
							// "",
							// " AND A.UPJANG = " + g_Upjang,   
							// strQuery_SUBINVCaption);

		fn_sql_common_setup( strQuery
							,strQuery_KeyField
							,strQuery_ValueField
							,strQuery_KeyFieldNM
							,strQuery_ValueFieldNM
							,""
							,""
							,""
							,strQuery_Caption
							,"SUBINV_CODE;SUBINV_NAME"
							);
							
		if ( gds_sql_common.getColumn(0, "ret_code") != "" ) {
			eval(obj.userdata).value   = gds_sql_common.getColumn(0, "ret_name");
			eval(obj.userdata).userdata = gds_sql_common.getColumn(0, "ret_code");		
		}
		//var v_str=split(gds_sql_common.GetColumn(0, "ret_name"),";");
// 	}
// 	//As-Is 소스]]
// 	//[[To-Be 소스
// 	else
// 	{
// 		fn_sql_common_setup( "ClaimSubInv"
// 							,""
// 							,""
// 							,""
// 							,""
// 							,""
// 							,""
// 							,{gEmpNo:g_EmpNo}
// 							,strQuery_Caption
// 							,"SUBINV_CODE;SUBINV_NAME"
// 							);
// 							
// 		if ( gds_sql_common.getColumn(0, "ret_code") != "" ) {
// 			eval(obj.userdata).value   = gds_sql_common.getColumn(0, "ret_name");
// 			eval(obj.userdata).userdata = gds_sql_common.getColumn(0, "ret_code");		
// 		}
// 	}
// 	//To-Be 소스]]
}

function Date_OnClick(obj)
{
	var objme = eval(obj.userdata);
	var retDate = gfn_dialog("", "U_SCC::SCC_CALENDAR.xfdl",{fa_Date:(objme.value)},-1,-1,"Title=false Status=false");
	objme.value  = retDate;
}

function btn_item_OnClick(obj:Button, e:ClickEventInfo)
{
	fn_sql_common_setup(strPOQuery_Item, 
						strPOQuery_ItemKeyField, 
						strPOQuery_ItemValueField, 
						strPOQuery_ItemKeyFieldNM, 
						strPOQuery_ItemValueFieldNM, 
						"", 
						"",
						"",   
						strPOQuery_ItemCaption);

	if ( gds_sql_common.getColumn(0, "ret_code") != "" ) {
		eval(obj.userdata).value     = gds_sql_common.getColumn(0, "ret_name");
		eval(obj.userdata).userdata = gds_sql_common.getColumn(0, "ret_code");
	}
	//var v_str=split(gds_sql_common.GetColumn(0, "ret_name"),";");
}
// 조회조건 [enter, del]키다운시 처리로직
function common_OnKeyDown(obj, e:KeyEventInfo)
{
	switch(e.keycode)
	{
		case 13:	// Enter
			switch(obj.name)
			{
				case "ed_Subinv":
					if(gfn_length(gfn_trim(ed_Subinv.value))==0)
					{
						btn_Pop_Subinv(eval("btn_PopSubinv"));
					}
					break;
				case "me_From":
					if(gfn_length(gfn_trim(me_From.value))==0)
					{				
						Date_OnClick(eval("btn_FDate"));
					}
					break;
				case "me_To":
					if(gfn_length(gfn_trim(me_To.value))==0)
					{					
						Date_OnClick(eval("btn_TDate"));
					}
					break;
				case "me_NeedDate":
					if(gfn_length(gfn_trim(me_NeedDate.value))==0)
					{	
						Date_OnClick(eval("btn_NDate"));
					}
					break;
				case "ed_item":
					if(gfn_length(gfn_trim(ed_item.value))==0)
					{				
						btn_item_OnClick(eval("btn_item"));
					}
					break;
				case "cbo_hand":
					fn_search();
					break;
			}
			//var v_nComp=GetNextComponent();
			//v_nComp.SetFocus();			
			break;
		case 46:	// Del
			switch(obj.name)
			{
				case "ed_Subinv":
					ed_Subinv.value="";
					ed_Subinv.userdata="";
					break;
				case "me_From":
					me_From.value="";
					break;
				case "me_To":
					me_To.value="";
					break;
				case "me_NeedDate":
					me_NeedDate.value="";
					break;
				case "ed_item":
					ed_item.value="";
					ed_item.userdata="";
					break;
				case "cbo_hand":
					cbo_hand.index=-1;
					break;
			}		
			break;
	}
}
]]></Script>
  </Form>
</FDL>

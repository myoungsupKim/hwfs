<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="TmSalesList" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 2213" titletext="연회 실적집계 리스트" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 2197 1252 2212" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="1" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30" tabstop="false"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static28" text="업장명" class="sta_WFSA_label" position="absolute 271 40 350 61" anchor="left top"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 93 40" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 93 71" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 86 40 96 61" anchor="left top"/>
        <Static id="Static22" text="웨딩 실적 현황" class="sta_WF_Title01" position="absolute 0 84 166 104" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 528 40 558 61" anchor="left top"/>
        <Static id="Static19" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 450 84" anchor="left top"/>
        <Static id="Static23" text="년도" class="sta_WFSA_label" position="absolute 558 40 620 61" anchor="left top"/>
        <Static id="Static00" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 321 40 331 61" anchor="left top"/>
        <Combo id="cbo_goalYear" taborder="73" class="cmb_WF_Essential" position="absolute 627 40 751 61" value="null" innerdataset="@ds_year" datacolumn="year" codecolumn="year" index="-1" onitemchanged="cbo_goalYear_onitemchanged"/>
        <UpjangSearchComponent id="UpjangSearchComponent00" titletext="업장 검색용 Component" taborder="91" text="UpjangSearchComponent00" position="absolute 331 40 530 64" bindDataset="" bindUpjangCodeColumn="" bindUpjangNameColumn="" eventBeforeTrigger="" eventAfterTrigger="" roleSetId=""/>
        <TmSearchComponent id="TmSearchComponent01" titletext="팀 검색용 Component" taborder="94" text="TmSearchComponent00" class="edt_WF_Essential" position="absolute 96 40 261 61" bindDataset="" bindTmCdColumn="" bindTmNmColumn="" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tmChanged" eventBeforeTrigger=""/>
        <MuSearchComponent id="MuSearchComponent01" titletext="사업부 선택 Component" taborder="95" text="MuSearchComponent00" class="cmb_WF_Essential" position="absolute 166 5 376 26" bindDataset="" bindMuCdColumn="" appendText="" onItemChangedEvent="fn_muChanged" visible="false"/>
        <Static id="Static02" text="팀명" class="sta_WFSA_label" position="absolute 14 40 93 61" anchor="left top"/>
        <Static id="Static01" text="건당 매출" class="sta_WFSA_label" position="absolute 177 83 256 104" anchor="left top"/>
        <Static id="s_th1_txt" class="sta_WFSA_label" position="absolute 291 83 370 104" anchor="left top"/>
        <Static id="s_lt1_txt" class="sta_WFSA_label" position="absolute 467 83 546 104" anchor="left top"/>
        <Static id="s_th1_amt" position="absolute 346 82 442 104"/>
        <Static id="s_lt1_amt" position="absolute 521 82 617 104"/>
        <Static id="Static14" text="연회 실적 현황" class="sta_WF_Title01" position="absolute 4 615 168 635" anchor="left top"/>
        <Static id="s_lt2_amt" position="absolute 521 610 617 632"/>
        <Static id="s_th2_amt" position="absolute 346 612 442 634"/>
        <Static id="Static18" text="건당 매출" class="sta_WFSA_label" position="absolute 181 614 260 635" anchor="left top"/>
        <Static id="Static20" text="기타 실적 현황" class="sta_WF_Title01" position="absolute 4 1142 454 1162" anchor="left top"/>
        <Static id="s_lt3_amt" position="absolute 521 1137 617 1159"/>
        <Static id="s_th3_amt" position="absolute 346 1139 442 1161"/>
        <Static id="Static25" text="건당 매출" class="sta_WFSA_label" position="absolute 181 1141 260 1162" anchor="left top"/>
        <Static id="Static26" text="특판 실적 현황" class="sta_WF_Title01" position="absolute 1 1669 451 1689" anchor="left top"/>
        <Static id="s_lt4_amt" position="absolute 521 1664 617 1686"/>
        <Static id="s_th4_amt" position="absolute 346 1666 442 1688"/>
        <Static id="Static30" text="건당 매출" class="sta_WFSA_label" position="absolute 178 1668 257 1689" anchor="left top"/>
        <Static id="s_th2_txt" class="sta_WFSA_label" position="absolute 291 613 370 634" anchor="left top"/>
        <Static id="s_lt2_txt" class="sta_WFSA_label" position="absolute 467 612 546 633" anchor="left top"/>
        <Static id="s_th3_txt" class="sta_WFSA_label" position="absolute 291 1141 370 1162" anchor="left top"/>
        <Static id="s_lt3_txt" class="sta_WFSA_label" position="absolute 467 1140 546 1161" anchor="left top"/>
        <Static id="s_th4_txt" class="sta_WFSA_label" position="absolute 291 1668 370 1689" anchor="left top"/>
        <Static id="s_lt4_txt" class="sta_WFSA_label" position="absolute 467 1667 546 1688" anchor="left top"/>
        <Grid id="grd_gubun01" taborder="99" useinputpanel="false" position="absolute 0 104 1237 604" binddataset="ds_gubun01" autofittype="none" scrollbars="autoboth" autoenter="none" cellsizingtype="col">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="20" band="left"/>
                <Column size="1" band="left"/>
                <Column size="104" band="left"/>
                <Column size="54" band="left"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="75"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="75"/>
                <Column size="102"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="사업장" taborder="undefined"/>
                <Cell col="2" colspan="2" text="구분" taborder="undefined"/>
                <Cell col="4" text="1월" taborder="undefined"/>
                <Cell col="5" text="2월" taborder="undefined"/>
                <Cell col="6" text="3월" taborder="undefined"/>
                <Cell col="7" text="4월" taborder="undefined"/>
                <Cell col="8" text="5월" taborder="undefined"/>
                <Cell col="9" text="6월" taborder="undefined"/>
                <Cell col="10" text="상반기" taborder="undefined"/>
                <Cell col="11" text="7월" taborder="undefined"/>
                <Cell col="12" text="8월" taborder="undefined"/>
                <Cell col="13" text="9월" taborder="undefined"/>
                <Cell col="14" text="10월" taborder="undefined"/>
                <Cell col="15" text="11월" taborder="undefined"/>
                <Cell col="16" text="12월" taborder="undefined"/>
                <Cell col="17" text="하반기"/>
                <Cell col="18" text="연간"/>
              </Band>
              <Band id="body">
                <Cell displaytype="normal" edittype="none" text="expr:currow+1"/>
                <Cell col="1" text="bind:upjangCd"/>
                <Cell col="2" text="bind:gubun1" suppress="0"/>
                <Cell col="3" text="bind:gubun2"/>
                <Cell col="4" displaytype="number" edittype="normal" text="bind:mon01"/>
                <Cell col="5" displaytype="number" edittype="normal" text="bind:mon02"/>
                <Cell col="6" displaytype="number" edittype="normal" text="bind:mon03"/>
                <Cell col="7" displaytype="number" edittype="normal" text="bind:mon04"/>
                <Cell col="8" displaytype="number" edittype="normal" text="bind:mon05"/>
                <Cell col="9" displaytype="number" edittype="normal" text="bind:mon06"/>
                <Cell col="10" displaytype="number" edittype="normal" text="bind:subsum1"/>
                <Cell col="11" displaytype="number" edittype="normal" text="bind:mon07"/>
                <Cell col="12" displaytype="number" edittype="normal" text="bind:mon08"/>
                <Cell col="13" displaytype="number" edittype="normal" text="bind:mon09"/>
                <Cell col="14" displaytype="number" edittype="normal" text="bind:mon10"/>
                <Cell col="15" displaytype="number" edittype="normal" text="bind:mon11"/>
                <Cell col="16" displaytype="number" edittype="normal" text="bind:mon12"/>
                <Cell col="17" displaytype="number" edittype="normal" text="bind:subsum2"/>
                <Cell col="18" displaytype="number" edittype="none" text="bind:totsum"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="grd_gubun02" taborder="104" binddataset="ds_gubun02" useinputpanel="false" position="absolute 0 633 1237 1134" scrollbars="autoboth" cellsizingtype="col">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="20" band="left"/>
                <Column size="1" band="left"/>
                <Column size="104" band="left"/>
                <Column size="54" band="left"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="75"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="75"/>
                <Column size="102"/>
              </Columns>
              <Rows>
                <Row size="31" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="사업장" taborder="undefined"/>
                <Cell col="2" colspan="2" text="구분" taborder="undefined"/>
                <Cell col="4" text="1월" taborder="undefined"/>
                <Cell col="5" text="2월" taborder="undefined"/>
                <Cell col="6" text="3월" taborder="undefined"/>
                <Cell col="7" text="4월" taborder="undefined"/>
                <Cell col="8" text="5월" taborder="undefined"/>
                <Cell col="9" text="6월" taborder="undefined"/>
                <Cell col="10" text="상반기" taborder="undefined"/>
                <Cell col="11" text="7월" taborder="undefined"/>
                <Cell col="12" text="8월" taborder="undefined"/>
                <Cell col="13" text="9월" taborder="undefined"/>
                <Cell col="14" text="10월" taborder="undefined"/>
                <Cell col="15" text="11월" taborder="undefined"/>
                <Cell col="16" text="12월" taborder="undefined"/>
                <Cell col="17" text="하반기"/>
                <Cell col="18" text="연간"/>
              </Band>
              <Band id="body">
                <Cell displaytype="normal" edittype="none" text="expr:currow+1"/>
                <Cell col="1" text="bind:upjangCd"/>
                <Cell col="2" text="bind:gubun1" suppress="1"/>
                <Cell col="3" text="bind:gubun2"/>
                <Cell col="4" displaytype="number" edittype="normal" text="bind:mon01"/>
                <Cell col="5" displaytype="number" edittype="normal" text="bind:mon02"/>
                <Cell col="6" displaytype="number" edittype="normal" text="bind:mon03"/>
                <Cell col="7" displaytype="number" edittype="normal" text="bind:mon04"/>
                <Cell col="8" displaytype="number" edittype="normal" text="bind:mon05"/>
                <Cell col="9" displaytype="number" edittype="normal" text="bind:mon06"/>
                <Cell col="10" displaytype="number" edittype="normal" text="bind:subsum1"/>
                <Cell col="11" displaytype="number" edittype="normal" text="bind:mon07"/>
                <Cell col="12" displaytype="number" edittype="normal" text="bind:mon08"/>
                <Cell col="13" displaytype="number" edittype="normal" text="bind:mon09"/>
                <Cell col="14" displaytype="number" edittype="normal" text="bind:mon10"/>
                <Cell col="15" displaytype="number" edittype="normal" text="bind:mon11"/>
                <Cell col="16" displaytype="number" edittype="normal" text="bind:mon12"/>
                <Cell col="17" displaytype="number" edittype="normal" text="bind:subsum2"/>
                <Cell col="18" displaytype="number" edittype="normal" text="bind:totsum"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="grd_gubun03" taborder="105" binddataset="ds_gubun03" useinputpanel="false" position="absolute 4 1161 1241 1662" scrollbars="autoboth" cellsizingtype="col">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="20" band="left"/>
                <Column size="1" band="left"/>
                <Column size="104" band="left"/>
                <Column size="54" band="left"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="75"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="75"/>
                <Column size="102"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="사업장" taborder="undefined"/>
                <Cell col="2" colspan="2" text="구분" taborder="undefined"/>
                <Cell col="4" text="1월" taborder="undefined"/>
                <Cell col="5" text="2월" taborder="undefined"/>
                <Cell col="6" text="3월" taborder="undefined"/>
                <Cell col="7" text="4월" taborder="undefined"/>
                <Cell col="8" text="5월" taborder="undefined"/>
                <Cell col="9" text="6월" taborder="undefined"/>
                <Cell col="10" text="상반기" taborder="undefined"/>
                <Cell col="11" text="7월" taborder="undefined"/>
                <Cell col="12" text="8월" taborder="undefined"/>
                <Cell col="13" text="9월" taborder="undefined"/>
                <Cell col="14" text="10월" taborder="undefined"/>
                <Cell col="15" text="11월" taborder="undefined"/>
                <Cell col="16" text="12월" taborder="undefined"/>
                <Cell col="17" text="하반기"/>
                <Cell col="18" text="연간"/>
              </Band>
              <Band id="body">
                <Cell displaytype="normal" edittype="none" text="expr:currow+1"/>
                <Cell col="1" text="bind:upjangCd"/>
                <Cell col="2" text="bind:gubun1" suppress="1"/>
                <Cell col="3" text="bind:gubun2"/>
                <Cell col="4" displaytype="number" edittype="normal" text="bind:mon01"/>
                <Cell col="5" displaytype="number" edittype="normal" text="bind:mon02"/>
                <Cell col="6" displaytype="number" edittype="normal" text="bind:mon03"/>
                <Cell col="7" displaytype="number" edittype="normal" text="bind:mon04"/>
                <Cell col="8" displaytype="number" edittype="normal" text="bind:mon05"/>
                <Cell col="9" displaytype="number" edittype="normal" text="bind:mon06"/>
                <Cell col="10" displaytype="number" edittype="normal" text="bind:subsum1"/>
                <Cell col="11" displaytype="number" edittype="normal" text="bind:mon07"/>
                <Cell col="12" displaytype="number" edittype="normal" text="bind:mon08"/>
                <Cell col="13" displaytype="number" edittype="normal" text="bind:mon09"/>
                <Cell col="14" displaytype="number" edittype="normal" text="bind:mon10"/>
                <Cell col="15" displaytype="number" edittype="normal" text="bind:mon11"/>
                <Cell col="16" displaytype="number" edittype="normal" text="bind:mon12"/>
                <Cell col="17" displaytype="number" edittype="normal" text="bind:subsum2"/>
                <Cell col="18" displaytype="number" edittype="normal" text="bind:totsum"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="grd_gubun04" taborder="106" binddataset="ds_gubun04" useinputpanel="false" position="absolute 4 1689 1241 2189" scrollbars="autoboth" cellsizingtype="col">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="20" band="left"/>
                <Column size="1" band="left"/>
                <Column size="104" band="left"/>
                <Column size="54" band="left"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="75"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="75"/>
                <Column size="102"/>
              </Columns>
              <Rows>
                <Row size="28" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="사업장" taborder="undefined"/>
                <Cell col="2" colspan="2" text="구분" taborder="undefined"/>
                <Cell col="4" text="1월" taborder="undefined"/>
                <Cell col="5" text="2월" taborder="undefined"/>
                <Cell col="6" text="3월" taborder="undefined"/>
                <Cell col="7" text="4월" taborder="undefined"/>
                <Cell col="8" text="5월" taborder="undefined"/>
                <Cell col="9" text="6월" taborder="undefined"/>
                <Cell col="10" text="상반기" taborder="undefined"/>
                <Cell col="11" text="7월" taborder="undefined"/>
                <Cell col="12" text="8월" taborder="undefined"/>
                <Cell col="13" text="9월" taborder="undefined"/>
                <Cell col="14" text="10월" taborder="undefined"/>
                <Cell col="15" text="11월" taborder="undefined"/>
                <Cell col="16" text="12월" taborder="undefined"/>
                <Cell col="17" text="하반기"/>
                <Cell col="18" text="연간"/>
              </Band>
              <Band id="body">
                <Cell displaytype="normal" edittype="none" text="expr:currow+1"/>
                <Cell col="1" text="bind:upjangCd"/>
                <Cell col="2" text="bind:gubun1" suppress="1"/>
                <Cell col="3" text="bind:gubun2"/>
                <Cell col="4" displaytype="number" edittype="normal" text="bind:mon01"/>
                <Cell col="5" displaytype="number" edittype="normal" text="bind:mon02"/>
                <Cell col="6" displaytype="number" edittype="normal" text="bind:mon03"/>
                <Cell col="7" displaytype="number" edittype="normal" text="bind:mon04"/>
                <Cell col="8" displaytype="number" edittype="normal" text="bind:mon05"/>
                <Cell col="9" displaytype="number" edittype="normal" text="bind:mon06"/>
                <Cell col="10" displaytype="number" edittype="normal" text="bind:subsum1"/>
                <Cell col="11" displaytype="number" edittype="normal" text="bind:mon07"/>
                <Cell col="12" displaytype="number" edittype="normal" text="bind:mon08"/>
                <Cell col="13" displaytype="number" edittype="normal" text="bind:mon09"/>
                <Cell col="14" displaytype="number" edittype="normal" text="bind:mon10"/>
                <Cell col="15" displaytype="number" edittype="normal" text="bind:mon11"/>
                <Cell col="16" displaytype="number" edittype="normal" text="bind:mon12"/>
                <Cell col="17" displaytype="number" edittype="normal" text="bind:subsum2"/>
                <Cell col="18" displaytype="number" edittype="normal" text="bind:totsum"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Layouts>
          <Layout>
            <Static id="Static00" text="Static00" position="absolute 82 19 192 53"/>
          </Layout>
        </Layouts>
      </Layout>
    </Layouts>
    <Bind/>
    <Objects>
      <Dataset id="ds_year" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="year" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">Y</Col>
            <Col id="insYn">N</Col>
            <Col id="delYn">N</Col>
            <Col id="savYn">N</Col>
            <Col id="prtYn">N</Col>
            <Col id="exlYn">Y</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="tmNm" type="STRING" size="256"/>
          <Column id="upjangCd" type="STRING" size="256"/>
          <Column id="upjangNm" type="STRING" size="256"/>
          <Column id="rowStatus" type="STRING" size="256"/>
          <Column id="goalYear" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_gubun04" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="gubun1" type="STRING" size="256"/>
          <Column id="gubun2" type="STRING" size="256"/>
          <Column id="mon01" type="STRING" size="256"/>
          <Column id="mon02" type="STRING" size="256"/>
          <Column id="mon03" type="STRING" size="256"/>
          <Column id="mon04" type="STRING" size="256"/>
          <Column id="mon05" type="STRING" size="256"/>
          <Column id="mon06" type="STRING" size="256"/>
          <Column id="subsum1" type="STRING" size="256"/>
          <Column id="mon07" type="STRING" size="256"/>
          <Column id="mon08" type="STRING" size="256"/>
          <Column id="mon09" type="STRING" size="256"/>
          <Column id="mon10" type="STRING" size="256"/>
          <Column id="mon11" type="STRING" size="256"/>
          <Column id="mon12" type="STRING" size="256"/>
          <Column id="subsum2" type="STRING" size="256"/>
          <Column id="totsum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_gubun02" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="gubun1" type="STRING" size="256"/>
          <Column id="gubun2" type="STRING" size="256"/>
          <Column id="mon01" type="STRING" size="256"/>
          <Column id="mon02" type="STRING" size="256"/>
          <Column id="mon03" type="STRING" size="256"/>
          <Column id="mon04" type="STRING" size="256"/>
          <Column id="mon05" type="STRING" size="256"/>
          <Column id="mon06" type="STRING" size="256"/>
          <Column id="subsum1" type="STRING" size="256"/>
          <Column id="mon07" type="STRING" size="256"/>
          <Column id="mon08" type="STRING" size="256"/>
          <Column id="mon09" type="STRING" size="256"/>
          <Column id="mon10" type="STRING" size="256"/>
          <Column id="mon11" type="STRING" size="256"/>
          <Column id="mon12" type="STRING" size="256"/>
          <Column id="subsum2" type="STRING" size="256"/>
          <Column id="totsum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_gubun03" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="gubun1" type="STRING" size="256"/>
          <Column id="gubun2" type="STRING" size="256"/>
          <Column id="mon01" type="STRING" size="256"/>
          <Column id="mon02" type="STRING" size="256"/>
          <Column id="mon03" type="STRING" size="256"/>
          <Column id="mon04" type="STRING" size="256"/>
          <Column id="mon05" type="STRING" size="256"/>
          <Column id="mon06" type="STRING" size="256"/>
          <Column id="subsum1" type="STRING" size="256"/>
          <Column id="mon07" type="STRING" size="256"/>
          <Column id="mon08" type="STRING" size="256"/>
          <Column id="mon09" type="STRING" size="256"/>
          <Column id="mon10" type="STRING" size="256"/>
          <Column id="mon11" type="STRING" size="256"/>
          <Column id="mon12" type="STRING" size="256"/>
          <Column id="subsum2" type="STRING" size="256"/>
          <Column id="totsum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_gubun01" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="seq" type="STRING" size="256"/>
          <Column id="gubun1" type="STRING" size="256"/>
          <Column id="gubun2" type="STRING" size="256"/>
          <Column id="mon01" type="STRING" size="256"/>
          <Column id="mon02" type="STRING" size="256"/>
          <Column id="mon03" type="STRING" size="256"/>
          <Column id="mon04" type="STRING" size="256"/>
          <Column id="mon05" type="STRING" size="256"/>
          <Column id="mon06" type="STRING" size="256"/>
          <Column id="subsum1" type="STRING" size="256"/>
          <Column id="mon07" type="STRING" size="256"/>
          <Column id="mon08" type="STRING" size="256"/>
          <Column id="mon09" type="STRING" size="256"/>
          <Column id="mon10" type="STRING" size="256"/>
          <Column id="mon11" type="STRING" size="256"/>
          <Column id="mon12" type="STRING" size="256"/>
          <Column id="subsum2" type="STRING" size="256"/>
          <Column id="totsum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <InitValue/>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : 연회 실적 목표 관리
  파 일 명 : TmGoalMgmt.xfdl
  기    능 : 외부 발주처를 등록 관리 한다. 
              등록후 외부 발주 품목을 등록 할수 있다.

*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "lib::SMCommon.xjs";	//영업회계 공통 스크립트
 

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();
var RetVal="";
 
/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	ds_gubun01.clearData();
	ds_gubun02.clearData();
	ds_gubun03.clearData();
	ds_gubun04.clearData();
	ds_year.clearData();
	
	cbo_goalYear.value ="";
	
	var sYear = Number(fv_sToday.substring(0,4))+2;
	var nYear = Number(fv_sToday.substring(0,4));
	//alert(sYear);
	for(var i = sYear ; i >= 2015 ; i--)
	{
		var nRow = ds_year.addRow();
		ds_year.setColumn(nRow, "year", i);
	}	
	cbo_goalYear.value = nYear;
	
	TmSearchComponent01.applyAuthLevel(MuSearchComponent01);	
	UpjangSearchComponent00.setForcedRoleSet("OutletUpjang");
	UpjangSearchComponent00.applyAuthLevel(TmSearchComponent01);
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
// function fn_close()
// {	
// 	 	
// //	// v_ds_check 미사용시 변경사항 체크(입력 프로그램일때 변경되는 Dataset 전체 기술)
// // 	if (gfn_dsIsUpdated(ds_list) == true) 
// // 	{
// // 		// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
// //         if (!gfn_confirm("confirm.before.movepage")) return false;
// //     }
// //     
// //	// 조회프로그램에도 Return true; 기술해 주세요!
// // 	return true;
//  
// }
 function fn_close()
 {	
	return true;
 }


/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
	 
    // Grid sort 표시 초기화(필수)
    //ds_gubun01.
    /*
    ds_gubun01.clearData();
    ds_gubun02.clearData();
    ds_gubun03.clearData();
    ds_gubun04.clearData();
	*/
    var strSvcID    = "search";
    var strURL      = "rc/bms/tmMgmt/selectSaleSumList.xdo";
    var strInDs     = "";
    var strOutDs     = "ds_gubun01=ds_gubun01 ds_gubun02=ds_gubun02 ds_gubun03=ds_gubun03 ds_gubun04=ds_gubun04";
    var strArg      = "upjangCd=" + UpjangSearchComponent00.getUpjangCode() + " goalYear=" + cbo_goalYear.value;
    //alert(UpjangSearchComponent00.getUpjangCode());
                  
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);

}



/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
	
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
	
    switch(strSvcID)
    {
		// 코드분류 조회
        case "search" :
            //trace(ds_list.saveXML());
            //trace("===" + ds_tmList.getRowCount());
            var th1_amt = 0;
            var th2_amt = 0;
            var th3_amt = 0;
            var th4_amt = 0;            
            var lt1_amt = 0;
            var lt2_amt = 0;
            var lt3_amt = 0;
            var lt4_amt = 0;
            
            var t_cnt = 0;
            var t_amt = 0;  
            var l_cnt = 0;
            var l_amt = 0;         
            
            for(i=0;i<ds_gubun01.getRowCount()-1;i++) {
				if (ds_gubun01.getColumn(i,"seq") == "AE") {
					t_cnt = ds_gubun01.getColumn(i,"totsum");
				}				
				if (ds_gubun01.getColumn(i,"seq") == "AF") {
					t_amt = ds_gubun01.getColumn(i,"totsum");
				}		
            
				if (ds_gubun01.getColumn(i,"seq") == "AM") {
					l_cnt = ds_gubun01.getColumn(i,"totsum");
				}				
				if (ds_gubun01.getColumn(i,"seq") == "AP") {
					l_amt = ds_gubun01.getColumn(i,"totsum");
				}					
            }     	
            						
			if (t_cnt == 0) {
				th1_amt = 0;
			} else {
				th1_amt =  Math.round(t_amt/t_cnt,1);
			}    
			if (l_cnt == 0) {
				lt1_amt = 0;
			} else {
				lt1_amt = Math.round(l_amt/l_cnt,1);
			} 		
            
            
            t_cnt = 0;
            t_amt = 0;  
            l_cnt = 0;
            l_amt = 0;   
             
            for(i=0;i<ds_gubun02.getRowCount()-1;i++) {
				if (ds_gubun02.getColumn(i,"seq") == "AE") {
					t_cnt = ds_gubun02.getColumn(i,"totsum");
				}				
				if (ds_gubun02.getColumn(i,"seq") == "AF") {
					t_amt = ds_gubun02.getColumn(i,"totsum");
				}			
            
				if (ds_gubun02.getColumn(i,"seq") == "AM") {
					l_cnt = ds_gubun02.getColumn(i,"totsum");
				}				
				if (ds_gubun02.getColumn(i,"seq") == "AP") {
					l_amt = ds_gubun02.getColumn(i,"totsum");
				}				
            }    
                        
			if (t_cnt == 0) {
				th2_amt = 0;
			} else {
				th2_amt =  Math.round(t_amt/t_cnt,1);
			}    
			if (l_cnt == 0) {
				lt2_amt = 0;
			} else {
				lt2_amt = Math.round(l_amt/l_cnt,1);
			} 	
				
            t_cnt = 0;
            t_amt = 0;  
            l_cnt = 0;
            l_amt = 0;   
            
            for(i=0;i<ds_gubun03.getRowCount()-1;i++) {
				if (ds_gubun03.getColumn(i,"seq") == "AE") {
					t_cnt = ds_gubun03.getColumn(i,"totsum");
				}				
				if (ds_gubun03.getColumn(i,"seq") == "AF") {
					t_amt = ds_gubun03.getColumn(i,"totsum");
				}		
            
				if (ds_gubun03.getColumn(i,"seq") == "AM") {
					l_cnt = ds_gubun03.getColumn(i,"totsum");
				}				
				if (ds_gubun03.getColumn(i,"seq") == "AP") {
					l_amt = ds_gubun03.getColumn(i,"totsum");
				}				
            }    
            
			if (t_cnt == 0) {
				th3_amt = 0;
			} else {
				th3_amt =  Math.round(t_amt/t_cnt,1);
			}    
			if (l_cnt == 0) {
				lt3_amt = 0;
			} else {
				lt3_amt = Math.round(l_amt/l_cnt,1);
			} 	
				
            t_cnt = 0;
            t_amt = 0;  
            l_cnt = 0;
            l_amt = 0;   
            
            for(i=0;i<ds_gubun04.getRowCount()-1;i++) {
				if (ds_gubun04.getColumn(i,"seq") == "AE") {
					t_cnt = ds_gubun04.getColumn(i,"totsum");
				}				
				if (ds_gubun04.getColumn(i,"seq") == "AF") {
					t_amt = ds_gubun04.getColumn(i,"totsum");
				}		
            
				if (ds_gubun04.getColumn(i,"seq") == "AM") {
					l_cnt = ds_gubun04.getColumn(i,"totsum");
				}				
				if (ds_gubun04.getColumn(i,"seq") == "AP") {
					l_amt = ds_gubun04.getColumn(i,"totsum");
				}				
            }    
                        
			if (t_cnt == 0) {
				th4_amt = 0;
			} else {
				th4_amt =  Math.round(t_amt/t_cnt,1);
			}    
			if (l_cnt == 0) {
				lt4_amt = 0;
			} else {
				lt4_amt = Math.round(l_amt/l_cnt,1);
			} 		
	
            s_th1_txt.text = cbo_goalYear.value.toString().substring(2,4) + "년 : ";
            s_lt1_txt.text = (Number(cbo_goalYear.value)-1).toString().substring(2,4) + "년 : ";
            s_th2_txt.text = cbo_goalYear.value.toString().substring(2,4) + "년 : ";
            s_lt2_txt.text = (Number(cbo_goalYear.value)-1).toString().substring(2,4) + "년 : ";
            s_th3_txt.text = cbo_goalYear.value.toString().substring(2,4) + "년 : ";
            s_lt3_txt.text = (Number(cbo_goalYear.value)-1).toString().substring(2,4) + "년 : ";
            s_th4_txt.text = cbo_goalYear.value.toString().substring(2,4) + "년 : ";
            s_lt4_txt.text = (Number(cbo_goalYear.value)-1).toString().substring(2,4) + "년 : ";
            
            s_th1_amt.text = th1_amt;
            s_lt1_amt.text = lt1_amt;
            s_th2_amt.text = th2_amt;
            s_lt2_amt.text = lt2_amt;
            s_th3_amt.text = th3_amt;
            s_lt3_amt.text = lt3_amt;
            s_th4_amt.text = th4_amt;
            s_lt4_amt.text = lt4_amt;
            
            
            break;
            
            
    }
}




/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : form에서 Key Down시 단축키들 지정(공통에서 자동생성, 화면에 스크립트 작성시 화면 스크립트만 실행됨)
 *---------------------------------------------------------------------------------------------*/
// function form_onkeydown(obj:Form, e:KeyEventInfo)
// {
// 	gfn_formKeyDown(obj, e);
// }

/*----------------------------------------------------------------------------------------------
 * 설명      : Grid Header Click시 정렬(공통에서 자동생성, 화면에 스크립트 작성시 화면 스크립트만 실행됨)
 *---------------------------------------------------------------------------------------------*/
// function grd_list_onheadclick(obj:Grid, e:GridClickEventInfo)
// {
// 	gfn_gridSort(obj, e);
// }

function cbo_goalYear_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	//trace(  "cbo_goalYear =>:" + cbo_goalYear.value );	
	fn_search();
}

 
 
function fn_tmChanged(){
	UpjangSearchComponent00.setUpjangCode("");
	UpjangSearchComponent00.setUpjangName("");
}
function fn_muChanged(){
	TmSearchComponent01.setTmCode("");
	TmSearchComponent01.setTmName("");
	UpjangSearchComponent00.setUpjangCode("");
	UpjangSearchComponent00.setUpjangName("");
}

]]></Script>
  </Form>
</FDL>

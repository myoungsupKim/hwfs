<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSM00192E" onload="form_onload" titletext="식단등록(카페테리아)" position="absolute 0 0 1235 540" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="sta_detail05" onclick="sta_detail05_onclick" class="sta_WFDA_Labelbg" position="absolute 10 13 592 40" anchor="left top"/>
        <TextArea id="TextArea0" taborder="2" value="TextArea0" visible="false" position="absolute 4 740 764 811"/>
        <Div id="Div_pop" scrollbars="autoboth" taborder="3" text="Div0" visible="false" position="absolute 368 816 618 916">
          <Layouts>
            <Layout>
              <Grid enable="true" id="Grid0" useinputpanel="false" taborder="1" tabstop="true" usecontextmenu="true" useselcolor="true" visible="false" wheelscrollrow="1" position="absolute 6 6 240 90" readonly="true" selecttype="row">
                <Formats>
                  <Format id="Default">
                    <Columns>
                      <Column size="230"/>
                    </Columns>
                    <Rows>
                      <Row size="18"/>
                    </Rows>
                    <Band id="body">
                      <Cell col="0" displaytype="text" style="align:left;"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
            </Layout>
          </Layouts>
        </Div>
        <Grid enable="true" id="Grid0" useinputpanel="false" taborder="4" tabstop="true" usecontextmenu="true" useselcolor="true" visible="false" wheelscrollrow="1" position="absolute 0 816 364 1046" readonly="true" selecttype="row">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="18" band="head"/>
                <Row size="18"/>
              </Rows>
              <Band id="head">
                <Cell col="0" displaytype="text"/>
                <Cell col="1" displaytype="text"/>
                <Cell col="2" displaytype="text"/>
                <Cell col="3" displaytype="text"/>
                <Cell col="4" displaytype="text"/>
                <Cell col="5" displaytype="text"/>
                <Cell col="6" displaytype="text"/>
              </Band>
              <Band id="body">
                <Cell col="0" text="bind:fday" displaytype="text" style="align:left;"/>
                <Cell col="1" text="bind:wcd" displaytype="text" style="align:left;"/>
                <Cell col="2" text="bind:wcd" displaytype="text" style="align:left;"/>
                <Cell col="3" text="bind:we" displaytype="text" style="align:left;"/>
                <Cell col="4" text="bind:we_color" displaytype="text" style="align:left;"/>
                <Cell col="5" text="bind:wimg" displaytype="image" style="align:left;"/>
                <Cell col="6" text="bind:wnm" displaytype="text" style="align:left;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid enable="true" id="Grid1" useinputpanel="false" taborder="5" tabstop="true" usecontextmenu="true" useselcolor="true" visible="false" wheelscrollrow="1" position="absolute 624 816 1009 1056" readonly="true" selecttype="row">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column band="left" size="75"/>
                <Column size="15"/>
                <Column size="100"/>
                <Column size="36"/>
                <Column size="15"/>
                <Column size="100"/>
                <Column size="36"/>
                <Column size="15"/>
                <Column size="100"/>
                <Column size="36"/>
                <Column size="15"/>
                <Column size="100"/>
                <Column size="36"/>
                <Column size="15"/>
                <Column size="100"/>
                <Column size="36"/>
                <Column size="15"/>
                <Column size="100"/>
                <Column size="36"/>
                <Column size="15"/>
                <Column size="100"/>
                <Column size="36"/>
              </Columns>
              <Rows>
                <Row size="18" band="head"/>
                <Row size="18" band="head"/>
                <Row size="18"/>
                <Row size="18" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell col="0" displaytype="text" text="일자"/>
                <Cell col="0" displaytype="text" row="1" text="일정"/>
                <Cell col="1" colspan="2" displaytype="text" text="9/17(월) 맑음"/>
                <Cell col="3" displaytype="text" rowspan="2"/>
                <Cell col="1" colspan="2" displaytype="text" row="1" text="체육대회"/>
                <Cell col="4" colspan="2" displaytype="text" text="9/18(화) 구름조금"/>
                <Cell col="6" displaytype="text" rowspan="2"/>
                <Cell col="4" colspan="2" displaytype="text" row="1"/>
                <Cell col="7" colspan="2" displaytype="text" text="9/19(수) 구름많음"/>
                <Cell col="9" displaytype="text" rowspan="2"/>
                <Cell col="7" colspan="2" displaytype="text" row="1" text="유급휴일/공장현.."/>
                <Cell col="10" colspan="2" displaytype="text" text="9/20(목) 비와 천둥"/>
                <Cell col="12" displaytype="text" rowspan="2"/>
                <Cell col="10" colspan="2" displaytype="text" row="1"/>
                <Cell col="13" colspan="2" displaytype="text" text="9/21(금) 비"/>
                <Cell col="15" displaytype="text" rowspan="2"/>
                <Cell col="13" colspan="2" displaytype="text" row="1" text="소풍/운영없음"/>
                <Cell col="16" colspan="2" displaytype="text" text="9/22(토) 안개"/>
                <Cell col="18" displaytype="text" rowspan="2"/>
                <Cell col="16" colspan="2" displaytype="text" row="1" text="운영없음"/>
                <Cell col="19" colspan="2" displaytype="text" text="9/23(일) 천둥비"/>
                <Cell col="21" displaytype="text" rowspan="2"/>
                <Cell col="19" colspan="2" displaytype="text" row="1" text="운영없음"/>
              </Band>
              <Band id="body">
                <Cell col="0" displaytype="text" expr="expr:iif(cgbn_cd=='0', sgbn_nm+cgbn, sgbn_nm+cgbn+'&#10;('+cgbn_nm+')')" suppress="1" style="align:center;background:EXPR(iif(toNumber(toNumber(sgbn_no)/2) == parseInt(toNumber(sgbn_no)/2), 'white', '#E3F3FF'));"/>
                <Cell col="1" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#DDFCDB',iif(toNumber(toNumber(sgbn_no)/2) == parseInt(toNumber(sgbn_no)/2), 'white', '#E3F3FF')));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(dup_sta_0917 =='Y', '●', '')" style="color:EXPR(dup_color_0917);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0917" displaytype="text" style="font:EXPR(iif(sseq_0917=='99', '굴림,9,Bold', '굴림,9'));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0917" displaytype="number" expr="expr:iif(tot_gbn=='99','',sd_won_0917)" style="align:right;"/>
                </Cell>
                <Cell col="4" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#DDFCDB','white'));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(gfn_length(dup_sta_0918)=='Y', '●', '')" style="color:EXPR(dup_color_0918);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0918" displaytype="text" style="font:EXPR(iif(sseq_0918=='99', '굴림,9,Bold', '굴림,9'));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0918" displaytype="number" style="align:right;"/>
                </Cell>
                <Cell col="7" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#DDFCDB','white'));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(gfn_length(dup_sta_0919)=='Y', '●', '')" style="color:EXPR(dup_color_0919);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0919" displaytype="text" style="font:EXPR(iif(sseq_0919=='99', '굴림,9,Bold', '굴림,9'));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0919" displaytype="number" style="align:right;"/>
                </Cell>
                <Cell col="10" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#DDFCDB','white'));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(gfn_length(dup_sta_0920)=='Y', '●', '')" style="color:EXPR(dup_color_0920);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0920" displaytype="text" style="font:EXPR(iif(sseq_0920=='99', '굴림,9,Bold', '굴림,9'));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0920" displaytype="number" style="align:right;"/>
                </Cell>
                <Cell col="13" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#DDFCDB','white'));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(gfn_length(dup_sta_0921)=='Y', '●', '')" style="color:EXPR(dup_color_0921);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0921" displaytype="text" style="font:EXPR(iif(sseq_0921=='99', '굴림,9,Bold', '굴림,9'));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0921" displaytype="number" style="align:right;"/>
                </Cell>
                <Cell col="16" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#DDFCDB','white'));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(gfn_length(dup_sta_0922)=='Y', '●', '')" style="color:EXPR(dup_color_0922);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0922" displaytype="text" style="font:EXPR(iif(sseq_0922=='99', '굴림,9,Bold', '굴림,9'));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0922" displaytype="number" style="align:right;"/>
                </Cell>
                <Cell col="19" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#DDFCDB','white'));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(gfn_length(dup_sta_0923)=='Y', '●', '')" style="color:EXPR(dup_color_0923);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0923" displaytype="text" style="font:EXPR(iif(sseq_0923=='99', '굴림,9,Bold', '굴림,9'));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0923" displaytype="number" style="align:right;"/>
                </Cell>
              </Band>
              <Band id="summary">
                <Cell col="0" displaytype="text" text="일평균원가" style="align:left;"/>
                <Cell col="1" colspan="3" displaytype="text" text="1" style="align:center;"/>
                <Cell col="4" colspan="3" displaytype="text" text="2" style="align:center;"/>
                <Cell col="7" colspan="3" displaytype="text" text="3" style="align:center;"/>
                <Cell col="10" colspan="3" displaytype="text" text="4" style="align:center;"/>
                <Cell col="13" colspan="3" displaytype="text" text="5" style="align:center;"/>
                <Cell col="16" colspan="3" displaytype="text" text="6" style="align:center;"/>
                <Cell col="19" colspan="3" displaytype="text" text="7" style="align:center;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid selecttype="row" cellsizingtype="both" enable="true" id="grd_lst" useinputpanel="false" oncellclick="grd_lst_OnCellClick" onmouseleave="grd_lst_OnMouseOut" onmousemove="grd_lst_OnMouseOver" onrbuttondown="grd_lst_OnRButtonDown" taborder="1" tabstop="true" usecontextmenu="true" useselcolor="false" visible="true" wheelscrollrow="1" position="absolute 10 52 1226 504" readonly="true" anchor="all" binddataset="DS_menu">
          <Formats/>
        </Grid>
        <Static id="sta_detail00" class="sta_WF_DiscPointN" position="absolute 10 505 1226 532" anchor="left right bottom"/>
        <Button id="Button03" taborder="21" text="구매게시판" onclick="Button03_OnClick" position="absolute 1049 508 1149 529" class="btn_WF_Custom" anchor="right bottom" visible="false"/>
        <Button id="Button04" taborder="22" onclick="Button04_OnClick" class="btn_WF_Custom" position="absolute 1151 508 1226 529" text="구매신청" anchor="right bottom"/>
        <Static id="Static6" text="원가 갱신일" class="sta_WFDA_Label01" position="absolute 551 505 666 532" anchor="left bottom" visible="false" enable="false" enableevent="false"/>
        <MaskEdit id="me_Sdate" taborder="24" type="string" mask="####-##-##" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" oneditclick="g_Date_OnFocus" position="absolute 668 508 746 529" anchor="left bottom" visible="false" enable="false" enableevent="false"/>
        <Button id="btn_Sdate" taborder="25" tabstop="false" onclick="g_CalButton_OnClick" class="btn_WF_cal" position="absolute 745 508 767 529" userdata="me_Sdate" anchor="left bottom" visible="false" enable="false" enableevent="false"/>
        <Button id="btn_RSave" taborder="26" tabstop="false" text="원가 갱신" onclick="btn_RSave_OnClick" class="btn_WF_Custom" position="absolute 773 508 850 529" anchor="left bottom" visible="false" enable="false" enableevent="false"/>
        <Static id="Static03" text="글자기준간격 h05" onclick="Static16_onclick" class="Guide01_AreaRed" visible="false" position="absolute 0 545 1235 557"/>
        <Button id="btn_save" taborder="27" text="저장" onclick="btn_save_OnClick" class="btn_WF_Custom" position="absolute 252 16 303 37" anchor="left top"/>
        <Button id="btn_fcopy" taborder="28" onclick="btn_fcopy_OnClick" class="btn_WF_Custom" position="absolute 948 24 1023 45" text="식단복사" anchor="top right"/>
        <Button id="btn_recipe" taborder="29" onclick="btn_recipe_OnClick" class="btn_WF_Custom" position="absolute 1025 24 1136 45" text="My레시피구성" anchor="top right"/>
        <Button id="btn_ExcelPrint" taborder="30" onclick="btn_ExcelPrint_OnClick" class="btn_WF_Custom" position="absolute 1138 24 1225 45" text="EXCEL" anchor="top right"/>
        <Static id="Static01" text="식당 목표식재료율(주간)" onclick="Static01_onclick" class="sta_WFDA_Label01" position="absolute 10 13 160 40" style="align:left;" anchor="left top"/>
        <Static id="Static0" text="식당 예상식재료율" class="sta_WFDA_Label01" position="absolute 305 13 441 40" anchor="left top"/>
        <MaskEdit id="me_bSikRate" taborder="32" readonly="true" mask="##0.0" position="absolute 443 18 484 39" anchor="left top" style="background:transparent;border:1 none #c2c2c2ff ;"/>
        <Static id="st_memo" class="sta_WFDA_Labelbg" position="absolute 508 18 589 40" anchor="left top" style="background:transparent;border:1 none #c3c3c3ff ;"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1235 13"/>
        <Static id="Static04" text="%" position="absolute 215 18 238 39" anchor="left top" style="background:transparent;border:0 none #808080ff ;"/>
        <Static id="Static05" text="%" position="absolute 482 20 505 41" anchor="left top" style="background:transparent;border:0 none #808080ff ;"/>
        <Static id="Static10" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 1225 24 1240 45"/>
        <Grid id="Grid02" taborder="33" useinputpanel="false" position="absolute 449 1213 719 1393" visible="false">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="75" band="left"/>
                <Column size="17"/>
                <Column size="95"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="95"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="95"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="95"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="95"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="95"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="95"/>
                <Column size="36"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summary"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" text="일자"/>
                <Cell col="1" colspan="2" displaytype="text" text="01/26(월)"/>
                <Cell col="3" rowspan="2" displaytype="text"/>
                <Cell col="4" colspan="2" displaytype="text" text="01/27(화)"/>
                <Cell col="6" rowspan="2" displaytype="text"/>
                <Cell col="7" colspan="2" displaytype="text" text="01/28(수)"/>
                <Cell col="9" rowspan="2" displaytype="text"/>
                <Cell col="10" colspan="2" displaytype="text" text="01/29(목)"/>
                <Cell col="12" rowspan="2" displaytype="text"/>
                <Cell col="13" colspan="2" displaytype="text" text="01/30(금)"/>
                <Cell col="15" rowspan="2" displaytype="text"/>
                <Cell col="16" colspan="2" displaytype="text" text="01/31(토)"/>
                <Cell col="18" rowspan="2" displaytype="text"/>
                <Cell col="19" colspan="2" displaytype="text" text="02/01(일)"/>
                <Cell col="21" rowspan="2" displaytype="text"/>
                <Cell row="1" displaytype="text" text="일정"/>
                <Cell row="1" col="1" colspan="2" displaytype="text"/>
                <Cell row="1" col="4" colspan="2" displaytype="text"/>
                <Cell row="1" col="7" colspan="2" displaytype="text"/>
                <Cell row="1" col="10" colspan="2" displaytype="text"/>
                <Cell row="1" col="13" colspan="2" displaytype="text"/>
                <Cell row="1" col="16" colspan="2" displaytype="text"/>
                <Cell row="1" col="19" colspan="2" displaytype="text"/>
              </Band>
              <Band id="body">
                <Cell style="background:white;background2:white;" expr="expr:iif(gfn_length(cgbn_nm) == 0, gfn_nvl(sgbn_nm)+gfn_nvl(cgbn), gfn_nvl(sgbn_nm)+gfn_nvl(cgbn)+'('+gfn_nvl(cgbn_nm)+')')" suppress="1" suppressalign="middle"/>
                <Cell col="1" colspan="3" displaytype="text" style="background:white;background2:white;align:left;" suppress="2">
                  <Cell displaytype="text" style="color:EXPR(dup_color_0126);align:left;" expr="expr:iif(dup_sta_0126 =='Y', '●', '')"/>
                  <Cell col="1" displaytype="text" style="font:EXPR(iif(sseq_0126=='99', '굴림,9,bold', '굴림,9'));align:left;" text="bind:sd_nm_0126"/>
                  <Cell col="2" displaytype="number" style="align:right;" text="bind:recipe_cost_rate_0126" expr="expr:iif(tot_gbn=='99','',gfn_nvl(recipe_cost_rate_0126))"/>
                </Cell>
                <Cell col="4" colspan="3" displaytype="text" style="background:white;background2:white;align:left;" suppress="2">
                  <Cell displaytype="text" style="color:EXPR(dup_color_0127);align:left;" expr="expr:iif(dup_sta_0127 =='Y', '●', '')"/>
                  <Cell col="1" displaytype="text" style="font:EXPR(iif(sseq_0127=='99', '굴림,9,bold', '굴림,9'));align:left;" text="bind:sd_nm_0127"/>
                  <Cell col="2" displaytype="number" style="align:right;" text="bind:recipe_cost_rate_0127" expr="expr:iif(tot_gbn=='99','',gfn_nvl(recipe_cost_rate_0127))"/>
                </Cell>
                <Cell col="7" colspan="3" displaytype="text" style="background:white;background2:white;align:left;" suppress="2">
                  <Cell displaytype="text" style="color:EXPR(dup_color_0128);align:left;" expr="expr:iif(dup_sta_0128 =='Y', '●', '')"/>
                  <Cell col="1" displaytype="text" style="font:EXPR(iif(sseq_0128=='99', '굴림,9,bold', '굴림,9'));align:left;" text="bind:sd_nm_0128"/>
                  <Cell col="2" displaytype="number" style="align:right;" text="bind:recipe_cost_rate_0128" expr="expr:iif(tot_gbn=='99','',gfn_nvl(recipe_cost_rate_0128))"/>
                </Cell>
                <Cell col="10" colspan="3" displaytype="text" style="background:white;background2:white;align:left;" suppress="2">
                  <Cell displaytype="text" style="color:EXPR(dup_color_0129);align:left;" expr="expr:iif(dup_sta_0129 =='Y', '●', '')"/>
                  <Cell col="1" displaytype="text" style="font:EXPR(iif(sseq_0129=='99', '굴림,9,bold', '굴림,9'));align:left;" text="bind:sd_nm_0129"/>
                  <Cell col="2" displaytype="number" style="align:right;" text="bind:recipe_cost_rate_0129" expr="expr:iif(tot_gbn=='99','',gfn_nvl(recipe_cost_rate_0129))"/>
                </Cell>
                <Cell col="13" colspan="3" displaytype="text" style="background:white;background2:white;align:left;" suppress="2">
                  <Cell displaytype="text" style="color:EXPR(dup_color_0130);align:left;" expr="expr:iif(dup_sta_0130 =='Y', '●', '')"/>
                  <Cell col="1" displaytype="text" style="font:EXPR(iif(sseq_0130=='99', '굴림,9,bold', '굴림,9'));align:left;" text="bind:sd_nm_0130"/>
                  <Cell col="2" displaytype="number" style="align:right;" text="bind:recipe_cost_rate_0130" expr="expr:iif(tot_gbn=='99','',gfn_nvl(recipe_cost_rate_0130))"/>
                </Cell>
                <Cell col="16" colspan="3" displaytype="text" style="background:white;background2:white;align:left;" suppress="2">
                  <Cell displaytype="text" style="color:EXPR(dup_color_0131);align:left;" expr="expr:iif(dup_sta_0131 =='Y', '●', '')"/>
                  <Cell col="1" displaytype="text" style="font:EXPR(iif(sseq_0131=='99', '굴림,9,bold', '굴림,9'));align:left;" text="bind:sd_nm_0131"/>
                  <Cell col="2" displaytype="number" style="align:right;" text="bind:recipe_cost_rate_0131" expr="expr:iif(tot_gbn=='99','',gfn_nvl(recipe_cost_rate_0131))"/>
                </Cell>
                <Cell col="19" colspan="3" displaytype="text" style="background:white;background2:white;align:left;" suppress="2">
                  <Cell displaytype="text" style="color:EXPR(dup_color_0201);align:left;" expr="expr:iif(dup_sta_0201 =='Y', '●', '')"/>
                  <Cell col="1" displaytype="text" style="font:EXPR(iif(sseq_0201=='99', '굴림,9,bold', '굴림,9'));align:left;" text="bind:sd_nm_0201"/>
                  <Cell col="2" displaytype="number" style="align:right;" text="bind:recipe_cost_rate_0201" expr="expr:iif(tot_gbn=='99','',gfn_nvl(recipe_cost_rate_0201))"/>
                </Cell>
              </Band>
              <Band id="summary">
                <Cell displaytype="text" style="align:left;" text="평균원가율"/>
                <Cell col="1" colspan="3" displaytype="text" style="align:center;"/>
                <Cell col="4" colspan="3" displaytype="text" style="align:center;"/>
                <Cell col="7" colspan="3" displaytype="text" style="align:center;"/>
                <Cell col="10" colspan="3" displaytype="text" style="align:center;"/>
                <Cell col="13" colspan="3" displaytype="text" style="align:center;"/>
                <Cell col="16" colspan="3" displaytype="text" style="align:center;"/>
                <Cell col="19" colspan="3" displaytype="text" style="align:center;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <MaskEdit id="me_sikrate" taborder="31" readonly="false" mask="##0.0" position="absolute 162 18 217 38" anchor="left top" style="background:transparent;border:1 none #c2c2c2ff ;" autoselect="false" ontextchanged="me_sikrate_OnChanged"/>
        <Static id="Static68" text="오른쪽 마우스버튼 : MY레시피등록" class="sta_WF_DiscInfo" position="absolute 10 512 247 527" anchor="left bottom"/>
        <Static id="Static20" text="왼쪽 마우스버튼 : 레시피검색 및 등록/수정" class="sta_WF_DiscInfo" position="absolute 256 512 546 527" anchor="left bottom"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="DS_menu">
        <ColumnInfo>
          <Column id="column0" size="256" type="STRING"/>
          <Column id="column1" size="256" type="STRING"/>
          <Column id="column2" size="256" type="STRING"/>
          <Column id="column3" size="256" type="STRING"/>
          <Column id="column4" size="256" type="STRING"/>
          <Column id="column5" size="256" type="STRING"/>
          <Column id="column6" size="256" type="STRING"/>
          <Column id="column7" size="256" type="STRING"/>
          <Column id="column8" size="256" type="STRING"/>
          <Column id="column9" size="256" type="STRING"/>
          <Column id="column10" size="256" type="STRING"/>
          <Column id="column11" size="256" type="STRING"/>
          <Column id="column12" size="256" type="STRING"/>
          <Column id="column13" size="256" type="STRING"/>
          <Column id="column14" size="256" type="STRING"/>
          <Column id="column15" size="256" type="STRING"/>
          <Column id="column16" size="256" type="STRING"/>
          <Column id="column17" size="256" type="STRING"/>
          <Column id="column18" size="256" type="STRING"/>
          <Column id="column19" size="256" type="STRING"/>
          <Column id="column20" size="256" type="STRING"/>
          <Column id="column21" size="256" type="STRING"/>
          <Column id="column22" size="256" type="STRING"/>
          <Column id="column23" size="256" type="STRING"/>
          <Column id="column24" size="256" type="STRING"/>
          <Column id="column25" size="256" type="STRING"/>
          <Column id="column26" size="256" type="STRING"/>
          <Column id="column27" size="256" type="STRING"/>
          <Column id="column28" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_head">
        <ColumnInfo>
          <Column id="fday" size="256" type="STRING"/>
          <Column id="we" size="256" type="STRING"/>
          <Column id="we_color" size="256" type="STRING"/>
          <Column id="wcd" size="256" type="STRING"/>
          <Column id="wnm" size="256" type="STRING"/>
          <Column id="wimg" size="256" type="STRING"/>
          <Column id="rem" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_body">
        <ColumnInfo>
          <Column id="fday" size="256" type="STRING"/>
          <Column id="sgbn" size="256" type="STRING"/>
          <Column id="sgbn_nm" size="256" type="STRING"/>
          <Column id="cgbn" size="256" type="STRING"/>
          <Column id="cgbn_nm" size="256" type="STRING"/>
          <Column id="cgbn_cd" size="256" type="STRING"/>
          <Column id="dup_sta" size="256" type="STRING"/>
          <Column id="dup_color" size="256" type="STRING"/>
          <Column id="sseq" size="256" type="STRING"/>
          <Column id="sd_cd" size="256" type="STRING"/>
          <Column id="sd_nm" size="256" type="STRING"/>
          <Column id="sd_won" size="256" type="STRING"/>
          <Column id="meal_price" size="256" type="STRING"/>
          <Column id="RECIPE_COST_RATE" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_body_f">
        <ColumnInfo>
          <Column id="CGBN" size="100" type="STRING"/>
          <Column id="CGBN_CD" size="20" type="STRING"/>
          <Column id="CGBN_NM" size="50" type="STRING"/>
          <Column id="DUP_COLOR" size="3" type="STRING"/>
          <Column id="DUP_STA" size="1" type="STRING"/>
          <Column id="FDAY" size="8" type="STRING"/>
          <Column id="MEAL_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_COST_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="SD_CD" size="20" type="STRING"/>
          <Column id="SD_NM" size="50" type="STRING"/>
          <Column id="SD_WON" size="22" type="BIGDECIMAL"/>
          <Column id="SGBN" size="20" type="STRING"/>
          <Column id="SGBN_NM" size="100" type="STRING"/>
          <Column id="SSEQ" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_body_c"/>
      <Dataset id="DS_sgbn">
        <ColumnInfo>
          <Column id="sgbn" size="256" type="STRING"/>
          <Column id="sgbn_nm" size="256" type="STRING"/>
          <Column id="cgbn" size="256" type="STRING"/>
          <Column id="cgbn_nm" size="256" type="STRING"/>
          <Column id="cgbn_cd" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_menu2" keystring="fday:sgbn:cgbn:cgbn_cd:sgbn_nm:cgbn_nm">
        <ColumnInfo>
          <Column id="column0" size="256" type="STRING"/>
          <Column id="column1" size="256" type="STRING"/>
          <Column id="column2" size="256" type="STRING"/>
          <Column id="column3" size="256" type="STRING"/>
          <Column id="column4" size="256" type="STRING"/>
          <Column id="column5" size="256" type="STRING"/>
          <Column id="column6" size="256" type="STRING"/>
          <Column id="column7" size="256" type="STRING"/>
          <Column id="column8" size="256" type="STRING"/>
          <Column id="column9" size="256" type="STRING"/>
          <Column id="column10" size="256" type="STRING"/>
          <Column id="column11" size="256" type="STRING"/>
          <Column id="column12" size="256" type="STRING"/>
          <Column id="column13" size="256" type="STRING"/>
          <Column id="column14" size="256" type="STRING"/>
          <Column id="column15" size="256" type="STRING"/>
          <Column id="column16" size="256" type="STRING"/>
          <Column id="column17" size="256" type="STRING"/>
          <Column id="column18" size="256" type="STRING"/>
          <Column id="column19" size="256" type="STRING"/>
          <Column id="column20" size="256" type="STRING"/>
          <Column id="column21" size="256" type="STRING"/>
          <Column id="column22" size="256" type="STRING"/>
          <Column id="column23" size="256" type="STRING"/>
          <Column id="column24" size="256" type="STRING"/>
          <Column id="column25" size="256" type="STRING"/>
          <Column id="column26" size="256" type="STRING"/>
          <Column id="column27" size="256" type="STRING"/>
          <Column id="column28" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sikrate"/>
      <Dataset id="DS_body1">
        <ColumnInfo>
          <Column id="fday" size="256" type="STRING"/>
          <Column id="sgbn" size="256" type="STRING"/>
          <Column id="sgbn_nm" size="256" type="STRING"/>
          <Column id="cgbn" size="256" type="STRING"/>
          <Column id="cgbn_nm" size="256" type="STRING"/>
          <Column id="cgbn_cd" size="256" type="STRING"/>
          <Column id="dup_sta" size="256" type="STRING"/>
          <Column id="dup_color" size="256" type="STRING"/>
          <Column id="sseq" size="256" type="STRING"/>
          <Column id="sd_cd" size="256" type="STRING"/>
          <Column id="sd_nm" size="256" type="STRING"/>
          <Column id="sd_won" size="256" type="STRING"/>
          <Column id="meal_price" size="256" type="STRING"/>
          <Column id="RECIPE_COST_RATE" size="256" type="STRING"/>
          <Column id="GOAL_COST_RATE2" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="sta_detail00" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item5" compid="sta_detail05" propid="text" datasetid="ds_view" columnid="D_1"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/**
====================================================================================================(100)
 1. 시    스    템	: 	식자재관리
 2. 서브    시스템 	:   주간식단표조회
 3. 프로그램  개요 	: 	
 4. 작    성    자 	:  	
 5. 작    성    일 	: 	
====================================================================================================
 * HISTORY    :  2)박은규 2012-11-05 CSR#(CH201210_00143) 요청자:박현정(FS기획팀)
                  -3일~ 는 무조건 예상식수 수정가능
====================================================================================================
**/
//===========================================================================================(90)
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//******************************************************************************************
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"

//******************************************************************************************
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//******************************************************************************************
//var	il_cnt	= 0;	// 기간에 해당되는 일수를 산정
var def_cha	= 2;	// 차감 col pointer
var	t_cnt  	= 0;	// 식당예상 식재료율 계산용 
var	t_rate 	= 0;	// 식당예상 식재료율 계산용 

var v_sale_sum  = 0;    // 식당예상식재료율 계산용
var v_wonga_sum = 0;    // 식당예상식재료율 계산용 



var iBGC        = 0;
var sBGC        = "";
var sPrevMenu   = "";
var sCurrMenu   = "";

//******************************************************************************************
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//******************************************************************************************
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	// X-Framework : Action 정보 생성 
	fsp_init(this);
}

//******************************************************************************************
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//******************************************************************************************

/*------------------------------------------------------------(60)
	1. Function ID : fn_Search()
	2. 개       요 : 업무프로세스에 따른 조회작업
	3. 기       능 : 검색조건에 해당하는 정보를 조회
	4. 인 수 설 명 : 
*/
function fn_search()
{
	if (fn_Search_chk() == false) {
		return false;
	}
	//il_cnt = parent.il_cnt;

    fn_week_create();

	fn_Sel_DS_head();
	if (DS_head.rowcount == 0) {
		g_Message("EE",	"주간일정 정보가 없습니다.");
		return true;
	}
	fn_Sel_DS_sgbn();
	if (DS_sgbn.rowcount == 0) {
		g_Message("EE",	"식,끼니 정보가 없습니다.");
		return true;
	}
	fn_Sel_DS_body();
	fn_Sel_DS_body1();
	//주간식당목표 식재료율 읽어오기
	fn_Sel_ds_ds_sikrate();
	// 작업용 DataSet 마련 - Grid용 DataSet 작성 작업용 (Filter 용)
	//DS_body_f.Clear();
	//DS_body_f.Copy("DS_body");

	// Grid에 사용할 DataSet을 작성합니다.
	grd_lst.enableredraw = false;
	grd_lst.binddataset = "";
	fn_make_DS_menu();
	
	// Grid Format을 작성합니다.
	grd_lst.binddataset = "";
	fn_make_grdlst();
	grd_lst.binddataset = "DS_menu";
	grd_lst.enableredraw = true;
	
	me_sikrate.enable = true;
	me_sikrate.setFocus();
	return true;
}

/*------------------------------------------------------------
	1. Function ID : fn_Insert()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_insert()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Save()
	2. 개       요 : 업무프로세스에 따른 정보 저장작업
	3. 기       능 : 저장버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_save()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Delete()
	2. 개       요 : 업무프로세스에 따른 정보 삭제작업
	3. 기       능 : 삭제버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_delete()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Print()
	2. 개       요 : 업무프로세스에 따른 선별된 정보를 출력지로 인쇄
	3. 기       능 : 인쇄버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_print()
{
}

//******************************************************************************************
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//******************************************************************************************
/*
 ******************************************************************************************
	1. Function ID : fn_Sel_DS_head()
	2. 개       요 : 식단표의 Head 구성요소를 작성한다.
	3. 기       능 : 제공일에 해당하는 주의 기준 Head Data를 작성한다.
	4. 인 수 설 명 : 
 ******************************************************************************************
 */
function fn_Sel_DS_head()
{
	// 초기화
	DS_head.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "ds_input=ds_input";
	outData			= "DS_head=DS_head";
	callBackFnc		= "fn_afterSearch1";

	fsp_clear(this); 
    fsp_addSearch(this, "fs/fsm:FSM00052E_S002");									// 조회 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
	http.Sync = false;
	
}

function fn_afterSearch1(errCode, errMsg)
{
	if(errCode!=0)
	{
		return;
	} else { 
	}
}

/*
 ******************************************************************************************
	1. Function ID : fn_Sel_DS_sgbn()
	2. 개       요 : 식단표의 좌측 기준정보(식,끼니)를 작성한다.
	3. 기       능 : 제공일에 해당하는 주의 좌측 기준정보(식,끼니)를 작성한다.
	4. 인 수 설 명 : 
 ******************************************************************************************
 */
function fn_Sel_DS_sgbn()
{
	// 초기화
	DS_sgbn.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "ds_input=ds_input";
	outData			= "DS_sgbn=DS_sgbn";
	callBackFnc		= "fn_afterSearch2";
	
	fsp_clear(this); 
    fsp_addSearch(this, "fs/fsm:FSM00052E_S001");									// 조회 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
	http.Sync = false;

}

function fn_afterSearch2(errCode, errMsg)
{
	if(errCode!=0)
	{
		return;
	} else { 
	
	  // trace(DS_sgbn.saveXML());
	}
}


/*
 ******************************************************************************************
	1. Function ID : fn_Sel_DS_body()
	2. 개       요 : 메뉴정보를 불러온다.
	3. 기       능 : 제공일에 해당하는 주의 메뉴정보를 불러온다.
	4. 인 수 설 명 : 
 ******************************************************************************************
 */
function fn_Sel_DS_body()
{
	// 초기화
	DS_body.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "ds_input=ds_input";
	outData			= "DS_body=DS_body DS_body_f=DS_body";
	callBackFnc		= "fn_afterSearch3";
	
	fsp_clear(this); 
    fsp_addSearch(this, "fs/fsm:FSM00052E_S003");									// 조회 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
	http.Sync = false;

}

function fn_afterSearch3(errCode, errMsg)
{
	if(errCode!=0)
	{
		return;
	} else {
	
	    DS_body_f.clear();
	    
	    if(DS_body.rowcount <= 0) {
	       DS_body.addRow();
	    }
	    
	    Copy(DS_body_f,DS_body); 
	    
	}
}


/*
 ******************************************************************************************
	1. Function ID : fn_Sel_DS_body1()
	2. 개       요 : 주간식당목표 식재료율
	3. 기       능 : 제공일에 해당하는 주의 메뉴정보를 불러온다.
	4. 인 수 설 명 : 
 ******************************************************************************************
 */
function fn_Sel_DS_body1()
{
	// 초기화
	DS_body1.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "ds_input=ds_input";
	outData			= "DS_body1=DS_body1";
	callBackFnc		= "fn_afterSearch4";
	
	fsp_clear(this); 
    fsp_addSearch(this, "fs/fsm:FSM00051E_S003");									// 조회 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
	http.Sync = false;
	
}

function fn_afterSearch4(errCode, errMsg)
{
	if(errCode!=0)
	{
		return;
	} else {
	
	     //trace(DS_body1.saveXML());
	 
	}
}

/*
 ******************************************************************************************
	1. Function ID : fn_Sel_ds_ds_sikrate()
	2. 개       요 : 주간식당목표 식재료율을 읽어온다.
	3. 기       능 : 제공일이 속해있는 주간의 주간식당목표 식재료율을 읽어온다.
	4. 인 수 설 명 : 
 ******************************************************************************************
 */
function fn_Sel_ds_ds_sikrate()
{
	// 초기화
	ds_sikrate.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "ds_input=ds_input";
	outData			= "ds_sikrate=ds_sikrate";
	callBackFnc		= "fn_afterSearch5";
	
	fsp_clear(this); 
    fsp_addSearch(this, "fs/fsm:FSM00190E_S002");									// 조회 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
	http.Sync = false;
	
	me_sikrate.value = ds_sikrate.getColumn(0, "GOAL_COST_RATE");
	
	me_sikrate.enable = true;
	
}

function fn_afterSearch5(errCode, errMsg)
{
	if(errCode!=0)
	{
		return;
	} else {
	 
	}
}

/*------------------------------------------------------------
	1. Function ID : fn_make_DS_menu()
	2. 개       요 : Grid body에 해당하는 DataSet을 작성
	3. 기       능 : Grid body Format에 맞게 DS_menu DataSet의 Format을 작성하고 DataSet Format에 맞게
	                 Data를 Loading 시킨다.
	4. 인 수 설 명 : 
*/
function fn_make_DS_menu()
{	 
	DS_menu.enableevent = false;
	
    DS_menu.clear();  
	
// 			<colinfo id="dup_sta_'			+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="dup_color_'		+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sseq_'				+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sd_cd_'			+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sd_nm_'			+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sd_won_'			+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="meal_price_'		+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sale_price_'		+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			
// 			<colinfo id="expect_won_amt_'	+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="expect_sale_amt_'	+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			
// 			<colinfo id="recipe_cost_rate_'	+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>';
// 	
// 	
// 	var	Contents_ds = "";
// 	
// 	// DataSet format을 작성합니다.
// 	Contents_ds = '
// 	<Contents>
// 			<colinfo id="sgbn" 			size="256" type="STRING"/>
// 			<colinfo id="sgbn_nm" 		size="256" type="STRING"/>
// 			<colinfo id="cgbn" 			size="256" type="STRING"/>
// 			<colinfo id="cgbn_nm" 		size="256" type="STRING"/>
// 			<colinfo id="cgbn_cd" 		size="256" type="STRING"/>
// 			<colinfo id="sgbn_no" 		size="256" type="STRING"/>
// 			<colinfo id="tot_gbn" 		size="256" type="STRING"/>';
// 
// 	//G_debug("DS_head");
// 	for(var ii = 0; ii < il_cnt; ii++)
// 	{
// 		Contents_ds	+= '
// 			<colinfo id="dup_sta_'			+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="dup_color_'		+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sseq_'				+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sd_cd_'			+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sd_nm_'			+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sd_won_'			+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="meal_price_'		+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sale_price_'		+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			
// 			<colinfo id="expect_won_amt_'	+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="expect_sale_amt_'	+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			
// 			<colinfo id="recipe_cost_rate_'	+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>';
// 	}
// 
// 	Contents_ds += '
// 	</Contents>';
// 
// 	/* Contents은 지원되지 않는 속성입니다.*/ DS_menu.Contents = Contents_ds;
// 	//TextArea0.Text   = Contents_ds;
// 	//G_debug("DS_sgbn");
// 	//alert(DS_menu.RowCount());


    DS_menu.addColumn('sgbn'   , 'STRING', 256);
	DS_menu.addColumn('sgbn_nm', 'STRING', 256);
	DS_menu.addColumn('cgbn'   , 'STRING', 256);
	DS_menu.addColumn('cgbn_nm', 'STRING', 256);
	DS_menu.addColumn('cgbn_cd', 'STRING', 256);
	DS_menu.addColumn('sgbn_no', 'STRING', 256);
	DS_menu.addColumn('tot_gbn', 'STRING', 256);
	DS_menu.addColumn('sseq'   , 'STRING', 256);
	
	for(var ii = 0; ii < il_cnt; ii++)
	{
		DS_menu.addColumn('dup_sta_'			+ gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('dup_color_'		    + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('sseq_'		        + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('sd_cd_'		        + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('sd_nm_'		        + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('sd_won_'		        + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('meal_price_'	        + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('sale_price_'	        + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('expect_won_amt_'	    + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('expect_sale_amt_'	+ gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
		DS_menu.addColumn('recipe_cost_rate_'   + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
	}	
 
// Data를 작성합니다. [ DS_body -> DS_menu Create ]
	var	cnt_ds_total = 0; 
	
	DS_body_f.clear();
	
	Copy(DS_body_f,DS_body);
//trace(DS_sgbn.saveXML());
//trace("DS_sgbn.rowcount==="+DS_sgbn.rowcount);
	for(var ii = 0; ii < DS_sgbn.getRowCount(); ii++) {
	
	    DS_body_f.filter();
		DS_body_f.filter("");

		var	fil_cond = "";
		var	max_row	 = 0;
		
		fil_cond	+= "SGBN=='"+DS_sgbn.getColumn(ii, "SGBN")+"' && CGBN=='"+DS_sgbn.getColumn(ii, "CGBN")+"' && CGBN_CD=='"+DS_sgbn.getColumn(ii, "CGBN_CD")+"'";

		DS_body_f.filter(fil_cond); 
		
		DS_body_c.clear();
		
		CopyF(DS_body_c,DS_body_f);
		
		DS_body_c.keystring = 'G:+SGBN+CGBN+CGBN_CD+FDAY'; 
		
		//alert(DS_body_c.RowCount());
		DS_body_c.filter("SSEQ<>'99'");
		max_row = toNumber(fn_clearNaN(DS_body_c.getMax("SSEQ")));
		max_row = max_row + 1;
		//alert(DS_body_c.RowCount());
		// DS_body_c.UnFilter();

		// DS_menu DataSet에 Row를 생성 
		 
		for(var jj = 0; jj < max_row; jj++) {
			DS_menu.addRow();
		} 
		
		//alert(DS_menu.RowCount());
//trace("max_row==="+max_row);
//trace("DS_body_c.rowcount==="+DS_body_c.rowcount);
		if (DS_body_c.getRowCount() == 0) {
		
			var set_row = cnt_ds_total;
			
			DS_menu.setColumn(set_row, "sgbn", 		DS_sgbn.getColumn(ii, "SGBN"));
			DS_menu.setColumn(set_row, "sgbn_nm", 	DS_sgbn.getColumn(ii, "SGBN_NM"));
			DS_menu.setColumn(set_row, "cgbn", 		DS_sgbn.getColumn(ii, "CGBN"));
			DS_menu.setColumn(set_row, "cgbn_nm", 	DS_sgbn.getColumn(ii, "CGBN_NM"));
			DS_menu.setColumn(set_row, "cgbn_cd", 	DS_sgbn.getColumn(ii, "CGBN_CD"));
			DS_menu.setColumn(set_row, "sgbn_no", 	(ii+1));
		}
		else {
			// 생성된 Row에 Data를 setup 한다
			for(var kk = 0; kk < DS_body_c.getRowCount(); kk++) {
 
				var set_row = cnt_ds_total + toNumber(DS_body_c.getColumn(kk, "SSEQ")) - 1;
				
				if (GetRowType(DS_body_c,kk)== "logical") { 
					set_row = cnt_ds_total + max_row - 1;
					DS_menu.setColumn(set_row, "tot_gbn", "99");
					DS_menu.setColumn(set_row, "sseq",    "99");
					
					DS_menu.setColumn(set_row, "sgbn", 		DS_body_c.getColumn(kk-1, "SGBN"));
					DS_menu.setColumn(set_row, "sgbn_nm", 	DS_body_c.getColumn(kk-1, "SGBN_NM"));
					DS_menu.setColumn(set_row, "cgbn", 		DS_body_c.getColumn(kk-1, "CGBN"));
					DS_menu.setColumn(set_row, "cgbn_nm", 	DS_body_c.getColumn(kk-1, "CGBN_NM"));
					DS_menu.setColumn(set_row, "cgbn_cd", 	DS_body_c.getColumn(kk-1, "CGBN_CD"));
					DS_menu.setColumn(set_row, "sgbn_no", 	(ii+1));
					
				}
				else {
					DS_menu.setColumn(set_row, "tot_gbn", 	"");
					
					DS_menu.setColumn(set_row, "sgbn", 		DS_body_c.getColumn(kk, "SGBN"));
					DS_menu.setColumn(set_row, "sgbn_nm", 	DS_body_c.getColumn(kk, "SGBN_NM"));
					DS_menu.setColumn(set_row, "cgbn", 		DS_body_c.getColumn(kk, "CGBN"));
					DS_menu.setColumn(set_row, "cgbn_nm", 	DS_body_c.getColumn(kk, "CGBN_NM"));
					DS_menu.setColumn(set_row, "cgbn_cd", 	DS_body_c.getColumn(kk, "CGBN_CD"));
					DS_menu.setColumn(set_row, "sgbn_no", 	(ii+1));
				} 
				//
				var set_col = gfn_subStr(DS_body_c.getColumn(kk, "FDAY"),4,4); 
				
				if(gfn_length(set_col) > 0 ){
					DS_menu.setColumn(set_row, "dup_sta_"	+set_col, 	DS_body_c.getColumn(kk, "DUP_STA"));
					DS_menu.setColumn(set_row, "dup_color_"	+set_col, 	DS_body_c.getColumn(kk, "DUP_COLOR"));
					DS_menu.setColumn(set_row, "sseq_"		+set_col, 	DS_body_c.getColumn(kk, "SSEQ"));
					DS_menu.setColumn(set_row, "sd_cd_"		+set_col, 	DS_body_c.getColumn(kk, "SD_CD"));
				}
				
				if (GetRowType(DS_body_c,kk)== "logical") {
				
				   var set_col = gfn_subStr(DS_body_c.getColumn(kk-1, "FDAY"),4,4); 
 
			       if(DS_body_c.getColumn(kk-1, "FDAY") != "") { 
				
						var	v_case			= "FDAY=='"+DS_body_c.getColumn(kk-1, "FDAY")+"' && SGBN=='"+DS_body_c.getColumn(kk-1, "SGBN")+"' && CGBN=='"+DS_body_c.getColumn(kk-1, "CGBN")+"' && CGBN_CD=='"+DS_body_c.getColumn(kk-1, "CGBN_CD")+"'";
 
						var	v_price 		= DS_body_c.getCaseSum(v_case, "SD_WON");
						
						var	v_won_amt 		= DS_body_c.getCaseSum(v_case, "EXPECT_WON_AMT");
						var	v_sale_amt		= DS_body_c.getCaseSum(v_case, "EXPECT_SALE_AMT");
						
						var	v_meal_price 	= DS_body_c.getCaseAvg(v_case, "MEAL_PRICE");
						var	v_sale_price 	= DS_body_c.getCaseAvg(v_case, "SALE_PRICE");
						var	v_cost_rate 	= DS_body_c.getCaseAvg(v_case, "RECIPE_COST_RATE");
		
						DS_menu.setColumn(set_row, "sd_nm_"				+set_col, 	"     "+numFormat(Math.round((toNumber(v_won_amt)/toNumber(v_sale_amt))*100,1), 1)+"%");
						DS_menu.setColumn(set_row, "sd_won_"			+set_col, 	v_price);
						
						DS_menu.setColumn(set_row, "expect_won_amt_"	+set_col, 	v_won_amt);
						DS_menu.setColumn(set_row, "expect_sale_amt_"	+set_col, 	v_sale_amt);
						
						DS_menu.setColumn(set_row, "meal_price_"		+set_col, 	v_meal_price);
						DS_menu.setColumn(set_row, "sale_price_"		+set_col, 	v_sale_price);
						DS_menu.setColumn(set_row, "recipe_cost_rate_"	+set_col, 	v_cost_rate);
					}
				}
				else {
					if(gfn_length(set_col) > 0) {
					
						DS_menu.setColumn(set_row, "sd_nm_"				+set_col, 	DS_body_c.getColumn(kk, "SD_NM"));
						DS_menu.setColumn(set_row, "sd_won_"			+set_col, 	DS_body_c.getColumn(kk, "SD_WON"));
						
						DS_menu.setColumn(set_row, "expect_won_amt_"	+set_col, 	DS_body_c.getColumn(kk, "EXPECT_WON_AMT"));
						DS_menu.setColumn(set_row, "expect_sale_amt_"	+set_col, 	DS_body_c.getColumn(kk, "EXPECT_SALE_AMT"));
						
						DS_menu.setColumn(set_row, "meal_price_"		+set_col, 	DS_body_c.getColumn(kk, "MEAL_PRICE"));
						DS_menu.setColumn(set_row, "sale_price_"		+set_col, 	DS_body_c.getColumn(kk, "SALE_PRICE"));
						DS_menu.setColumn(set_row, "recipe_cost_rate_"	+set_col, 	DS_body_c.getColumn(kk, "RECIPE_COST_RATE"));
					}
				}
			}
		}
		
		// DS_menu Row 위치를 산정하기 위한 누적값
		cnt_ds_total = cnt_ds_total + max_row; 
	} 
	
 
    if(DS_menu.rowcount > 0) { 
    
		DS_menu.rowposition = 0;
		DS_menu.applyChange(); 
		
		DS_menu2.clear();
		
		// 식당예상 식재료율을 구하기 위한 dataset을 생성
		DS_menu.filter("tot_gbn=='99'");
		Copy(DS_menu2,DS_menu);
		DS_menu.filter("");
	} else {
	
	        DS_menu.addRow();
	
			DS_menu.setColumn(0, "sgbn", 		DS_sgbn.getColumn(0, "SGBN"));
			DS_menu.setColumn(0, "sgbn_nm", 	DS_sgbn.getColumn(0, "SGBN_NM"));
			DS_menu.setColumn(0, "cgbn", 		DS_sgbn.getColumn(0, "CGBN"));
			DS_menu.setColumn(0, "cgbn_nm", 	DS_sgbn.getColumn(0, "CGBN_NM"));
			DS_menu.setColumn(0, "cgbn_cd", 	DS_sgbn.getColumn(0, "CGBN_CD"));
			DS_menu.setColumn(0, "sgbn_no", 	1);
	
	
	}
	
	
         for(var i=0;i<DS_menu.rowcount;i++) {
	
         sCurrMenu = DS_menu.getColumn(i,"sgbn") + DS_menu.getColumn(i,"cgbn_cd");
	     
	     if(sPrevMenu != sCurrMenu) { 
	          
	         var exp1 = toNumber(toNumber(DS_menu.getColumn(i,"sgbn_no"))/2);
	  
	         var exp2 = parseInt(toNumber(DS_menu.getColumn(i,"sgbn_no"))/2);
	 
			  if(exp1 > exp2) {
			       
			       iBGC = 0;
			  } else {
			       iBGC = 1;
			  }
			  if(DS_menu.getColumn(i, "tot_gbn") <> '99') {
			     DS_menu.setColumn(i, "tot_gbn", iBGC); 
			  }
			  
			  
	     } else {
			  if(DS_menu.getColumn(i, "tot_gbn") <> '99') {
			     DS_menu.setColumn(i, "tot_gbn", iBGC); 
			  }
	     }
	
	     sPrevMenu = sCurrMenu; 
	
	}
	
	DS_menu.enableevent = true; 
//trace(DS_menu.saveXML());
	//G_debug("DS_menu");
}

/*------------------------------------------------------------
	1. Function ID : fn_make_grdlst()
	2. 개       요 : 조건에 맞는 Grid Format을 작성
	3. 기       능 : 검색조건 기간이 유동적으로 구성되므로 조건에 해당하는 정보를 화면으로
	                 출력하기 위해 Grid를 재구성한다.
	4. 인 수 설 명 : 
*/
function fn_make_grdlst()
{
 	// GRID 작성
	var Contents_grd_lst	 = '';
	var Contents_grd_column  = '';
	var Contents_grd_rows    = '';
	var Contents_grd_head    = '';
	var Contents_grd_body    = '';
	var Contents_grd_body1   = '';
	var Contents_grd_summary = '';
	var Contents_grd_lst	 = '';

	// Grid를 작성합니다.
	Contents_grd_lst  = '<Formats>' + '\n';
	Contents_grd_lst += '<Format id="Default">' + '\n';
	
 	// Grid columns를 작성합니다.
	Contents_grd_column  = ' <Columns>' + '\n';
	Contents_grd_column	+= ' <Column size="75" band="left" />' + '\n';
	
	for(var ii = 0; ii < il_cnt; ii++)
	{
	     Contents_grd_column	+= ' <Column size="17" />' + '\n';
	     Contents_grd_column	+= ' <Column size="95" />' + '\n';
	     Contents_grd_column	+= ' <Column size="36" />' + '\n'; 
	}
	
	Contents_grd_column  += ' </Columns>' + '\n';

	// Grid rows를 작성합니다.
	Contents_grd_rows  = ' <Rows>' + '\n';
  	Contents_grd_rows += ' <Row size="24" band="head" />' + '\n';
  	Contents_grd_rows += ' <Row size="24" band="head" />' + '\n'; 
  	Contents_grd_rows += ' <Row size="24" band="body" />' + '\n';  	
  	Contents_grd_rows += ' <Row size="24" band="summary" />' + '\n';
	Contents_grd_rows += ' </Rows>' + '\n';
 
	// Grid head를 작성합니다.
	Contents_grd_head  = ' <Band id="head">' + '\n';
 
 	Contents_grd_head += ' <cell color="white" col="0" displaytype="text" text="일자"/> ' + '\n';
	Contents_grd_head += ' <cell color="white" col="0" displaytype="text" row="1" text="일정"/>' + '\n';  
 
	var	v_col1 = -2;
	var	v_col2 = 0;
	var	v_day  = "";  
	
	for(var ii = 0; ii < il_cnt; ii++) { 
	
	    v_col1 	= v_col1 + 3;
 		v_col2 	= v_col2 + 3;
	
		v_day	= gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,2) + "/" + gfn_subStr(DS_head.getColumn(ii, "FDAY"),6,2) + "(" + DS_head.getColumn(ii, "WE") + ")"; 
		 
		 if ( gfn_isNull(DS_head.getColumn(ii,"WIMG"))) {
			var v_wImg = "";
		 } else {
			var v_wImg = "URL('theme://convertImages/" + DS_head.getColumn(ii,"WIMG") + ".png";
		}		 
 
		Contents_grd_head += ' <cell color="#'+DS_head.getColumn(ii, "WE_COLOR")+'" col="'+v_col1+'" colspan="2" displaytype="text" text="'+v_day+'" />' + '\n';
	    Contents_grd_head += ' <cell text="'+v_wImg+'" col="'+v_col2+'" displaytype="image" rowspan="2"/>' + '\n';
 
		
 		if (gfn_length(DS_head.getColumn(ii, "REM"))> 8) {
		
		    Contents_grd_head += ' <cell color="#'+DS_head.getColumn(ii, "WE_COLOR")+'" col="'+v_col1+'" colspan="2" displaytype="text" row="1" text="'+gfn_nvl(gfn_subStr(DS_head.getColumn(ii, "REM"),0,8))+".."+'"/>' + '\n';
		}
		else {
		    Contents_grd_head += ' <cell color="#'+DS_head.getColumn(ii, "WE_COLOR")+'" col="'+v_col1+'" colspan="2" displaytype="text" row="1" text="'+gfn_nvl(DS_head.getColumn(ii, "REM"))+'"/>' + '\n';
		} 		
		
	}
				
	Contents_grd_head += ' </Band>' + '\n';
 
  	// Grid body를 작성합니다.
  	Contents_grd_body  = ' <Band id="body">' + '\n';
 
    Contents_grd_body	+= ' <Cell col="0" display="text" style="background:white;background2:white;" font="굴림,8,bold" expr="expr:iif(gfn_length(cgbn_nm)&#32;==&#32;0,&#32;gfn_nvl(sgbn_nm)+gfn_nvl(cgbn),&#32;gfn_nvl(sgbn_nm)+gfn_nvl(cgbn)+&apos;(&apos;+gfn_nvl(cgbn_nm)+&apos;)&apos;)" suppress="1" suppressalign="middle"/>' + '\n';
 
    var	v_col3 = 0; 
 	var	v_seq  = "";  
  	
 	for(var ii = 0; ii < il_cnt; ii++) {
 	
		v_col3 = (ii * 3) + 1;  
		
		v_seq  = gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4); 
		
		img_Del = "expr(iif(tot_gbn=='99'&& gfn_length(sd_nm_" + v_seq + ")>0,'theme://images/new/grd_WF_ExpandImageX.png'))";

		Contents_grd_body	+= ' <Cell col="' + v_col3 + '" colspan="3" displaytype="text" style="background:white;background2:white;align:left;" suppress="2">' + '\n';
     	Contents_grd_body	+= ' <Cell displaytype="text" style="color:EXPR(dup_color_' + v_seq + ');align:left;" expr="expr:iif(dup_sta_' + v_seq + '&#32;==&apos;Y&apos;,&#32;&apos;●&apos;,&#32;&apos;&apos;)"/>' + '\n';
		Contents_grd_body	+= ' <Cell col="1" displaytype="text" style="font:EXPR(iif(sseq_' + v_seq + '==&apos;99&apos;,&#32;&apos;굴림,9,bold&apos;,&#32;&apos;굴림,9&apos;));align:left;" text="bind:sd_nm_' + v_seq +  '"/>' + '\n';
		Contents_grd_body	+= ' <Cell col="2" displaytype="number" style="align:right;" text="bind:recipe_cost_rate_' + v_seq + '" expr="expr:iif(tot_gbn==&apos;99&apos;,&apos;&apos;,gfn_nvl(recipe_cost_rate_' + v_seq + '))"/>' + '\n';
		Contents_grd_body	+= ' </Cell>' + '\n';
 	
    }
      
 	Contents_grd_body	+= '  </Band>' + '\n'; 		
 		
	// Grid Summary를 작성합니다.
	
    Contents_grd_summary =  ' <Band id="summary">' + '\n';
    Contents_grd_summary += ' <Cell displaytype="text" style="align:left;" text="평균원가율"/>' + '\n'; 

 	v_col3 	= 0;
	v_seq  	= "";
	t_cnt  	= 0;
	t_rate 	= 0;
	v_sale_sum = 0;
	v_wonga_sum = 0;
	
	for(var ii = 0; ii < il_cnt; ii++)
	{
		v_col3 = (ii * 3) + 1;
		v_seq  = gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4);
		var v_sale      = 0;
		var v_wonga     = 0;
		var v_expect_qty  = 0;
		
		for(var jj = 0; jj < DS_menu.rowcount; jj++) {
			if ( DS_menu.getColumn(jj, "tot_gbn") == "99") { 
				v_sale	+= fn_clearNaN(toNumber(DS_menu.getColumn(jj, "expect_sale_amt_"+v_seq)));
				v_wonga	+= fn_clearNaN(toNumber(DS_menu.getColumn(jj, "expect_won_amt_"+v_seq)));	 
				v_sale_sum	+= fn_clearNaN(toNumber(DS_menu.getColumn(jj, "expect_sale_amt_"+v_seq)));
				v_wonga_sum	+= fn_clearNaN(toNumber(DS_menu.getColumn(jj, "expect_won_amt_"+v_seq))); 
			}
		} 	
 
		var v_cnt	= fn_clearNaN(toNumber(DS_menu.getCaseCount("tot_gbn=='99' && sd_won_"+v_seq+">0"),0));
		
		if (v_cnt > 0) { 
		    Contents_grd_summary += ' <Cell col="' + v_col3 + '" colspan="3" displaytype="text" style="align:center;" text="' + fn_clearNaN(numFormat((v_wonga/v_sale)*100, 1))+'%'+ '"/>' + '\n';
	    } else {
			Contents_grd_summary += ' <Cell col="' + v_col3 + '" colspan="3" displaytype="text" style="align:center;" text=""/>' + '\n';
 		}
	} 

    Contents_grd_summary += ' </Band>' + '\n';  
    
	// Grid End
	
    Contents_grd_lst += Contents_grd_column + Contents_grd_rows + Contents_grd_head + Contents_grd_body + Contents_grd_summary + '</Format>' + '\n' + '</Formats>';
 
    //trace(Contents_grd_lst);
 
	tab_Main.tab00.grd_lst.formats  = Contents_grd_lst;
 	tab_Main.tab00.grd_lst.formatid = "Default"; 	
	tab_Main.tab00.grd_lst.nodataimage = gv_noData;
	tab_Main.tab00.grd_lst.binddataset  = "DS_menu"
	tab_Main.tab00.grd_lst.autofittype = "col";
	tab_Main.tab00.grd_lst.selecttype  = "row"; 
 
	 
 
	for(var ii = 0; ii < il_cnt; ii++) { 
	
		if(ii==0) {
			v_col3 = 2; 
		} else {
			v_col3 += 2;
		}
		 
		
        v_seq  = gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4);
        
        
        
		var img_Del = "expr(iif(tot_gbn=='99'&& gfn_length(sd_nm_" + v_seq + ")>0,'theme://images/new/grd_WF_ExpandImageX.png'))";
		//var bg = "expr(iif(tot_gbn=='99', '#DDFCDB',iif(toNumber(toNumber(sgbn_no)/2) == parseInt(toNumber(sgbn_no)/2), 'white', '#E3F3FF')))"; 
	    //var bg = "expr(iif(tot_gbn=='99', 'lavender','white'))";  

        var bkColor2 = "expr(tot_gbn == '99' && sseq == '99'?'#DDFCDB':tot_gbn == '0'?'white':'#E3F3FF')";
 		
 		var bkColor1 = "expr(iif(toNumber(toNumber(sgbn_no)/2) == parseInt(toNumber(sgbn_no)/2), '#E3F3FF','white'))";
 		
		
 		if(ii == 0) {
			 grd_lst.setCellProperty('body',0, 'background', bkColor1);
			 grd_lst.setCellProperty('body',0, 'background2', bkColor1);  
		}
  	 	 
 		grd_lst.setCellProperty('body',ii+1, 'background', bkColor2);
 		grd_lst.setCellProperty('body',ii+1, 'background2', bkColor2); 
		
		grd_lst.setCellProperty('body',ii+1, 'backgroundimage', img_Del); 
	} 
	// 식당예상 식재료율을 계산합니다.
	// 
	fn_me_bSikRate();
}

// 식당예상 식재료율
function fn_me_bSikRate() 
{

	var	v_bSikRate 	= 0;
	
	if (v_sale_sum == 0) {
		v_bSikRate		= 0;
	}
	else {
		v_bSikRate		= Math.round(v_wonga_sum / v_sale_sum * 100, 1);
	}	
	
	me_bSikRate.value = v_bSikRate;
	
	if (Math.round(v_bSikRate - toNumber(me_sikrate.value), 1) > 0) {
		st_memo.text = "(↑ "+fn_clearNaN(Math.abs(Math.round(toNumber(v_bSikRate) - toNumber(me_sikrate.value), 1)))+"%P)";
		st_memo.style.color = "red";
	}
	else {
		st_memo.text = "(↓ "+fn_clearNaN(Math.abs(Math.round(toNumber(v_bSikRate) - toNumber(me_sikrate.value), 1)))+"%P)";
		st_memo.style.color = "blue";
	}	
	
	
	// var	v_bSikRate 	= 0;
	
	// if (t_cnt == 0) {
		// v_bSikRate		= 0;
	// }
	// else {
		// v_bSikRate		= round(t_rate / t_cnt, 1);
	// }
	
	// me_bSikRate.Value = v_bSikRate;
	
	// if (round(v_bSikRate - me_sikrate.Value, 1) > 0) {
		// st_memo.Text = "(↑ "+abs(round(toNumber(v_bSikRate) - toNumber(me_sikrate.Value), 1))+"%)";
		// st_memo.Color = "red";
	// }
	// else {
		// st_memo.Text = "(↓ "+abs(round(toNumber(v_bSikRate) - toNumber(me_sikrate.Value), 1))+"%)";
		// st_memo.Color = "blue";
	// }
	
}

// dataset의 변경유무를 검토하여 저장할 것인지를 검증한다.
function fn_dsUpdateSearch()
{
	if (gfn_dsIsUpdated(ds_sikrate)== true) {
		var msg = "저장되지 않은 정보가 있습니다.\n\n데이터를 저장하시겠습니까?";
		if (g_Confirm("02",	msg) == true) {
			gfn_alert("처리");
			// fn_save();
			g_Message("04", "");
		}
		else {
			g_Message("EE", "데이타 저장 작업을 취소하였습니다.");
			return;
		}
	}
}

//******************************************************************************************
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//******************************************************************************************

// Excel 출력
function btn_ExcelPrint_OnClick(obj:Button, e:ClickEventInfo)
{
	if (DS_menu.rowcount == 0) {
		g_Message("EE",	"출력할 메뉴정보가 없습니다.");
		return;
	}
	gfn_exportExcel(grd_lst, "카페테리아 식단표");	
}

function grd_lst_OnMouseOver(obj:Grid, e:GridMouseEventInfo)
{
	//----------------------------------
	// Tooltip 설명 처리부
	//----------------------------------
	// Head 부 처리
	var	srow 	= 0.0;
	var	int_srow= 0;
	var	v_seq  	= "";
	var toolTxt = "";
	
	// ToolTip TEXT 처리
	if (e.row == -1 && e.cell > 3) {
		srow = toNumber((e.cell-1)/3);
		int_srow = parseInt(srow);
		//alert("/"+srow+"/"+int_srow+"/");
		//alert(length(DS_head.GetColumn((int_srow-1), "rem")));
		
		if (gfn_length(DS_head.getColumn((int_srow-1), "REM"))> 8 && int_srow == srow) {
			grd_lst.tooltiptext = "☞ 일정 : "+DS_head.getColumn((int_srow-1), "REM")+" ";
			return;
		}
		else { 
			grd_lst.tooltiptext = ""; 
		}
	}
	
	// 코너명 ToolTiop TEXT 처리
	else if (e.cell == 0 && e.row >0 ) { 
		if (gfn_length(DS_menu.getColumn(e.row,"cgbn_nm"))> 0 ) {
			toolTxt = DS_menu.getColumn(e.row,"sgbn_nm") + DS_menu.getColumn(e.row,"cgbn") + "(" + DS_menu.getColumn(e.row,"cgbn_nm") + ")";
		} 
		else {
			toolTxt = DS_menu.getColumn(e.row,"sgbn_nm") + DS_menu.getColumn(e.row,"cgbn");
		}
		grd_lst.tooltiptext = toolTxt;
	}
	
	// ToolTip TEXT null 처리
	else { 
		grd_lst.tooltiptext = ""; 
	}
	
	// Body 부 처리
	//grd_lst.ToolTipText = "nRow :"+nRow+"\nnCell :"+nCell+"\nnPosX :"+nPosX+"\nnPosY :"+nPosY;
	v_seq  = gfn_subStr(DS_head.getColumn((e.cell-1), "FDAY"),4,4);
	//alert(v_seq);
	
	if (e.row > -1 && e.cell > 0 && gfn_length(DS_menu.getColumn(e.row, "dup_sta_"+v_seq))> 0) {
		if (e.clientX > 740) {
			Div_pop.position.left = e.clientX-(Div_pop.position.width);
			Div_pop.position.top  = e.clientY+30;
			// 화면에 보여질 정보를 처리한다.
			Div_pop.visible = true;
		}
		else {
			Div_pop.position.left = e.clientX+15;
			Div_pop.position.top  = e.clientY+30;
			// 화면에 보여질 정보를 처리한다.
			Div_pop.visible = true;
		}
	}
	else {
		Div_pop.visible = false;
	}



}

function grd_lst_OnMouseOut(obj:Grid, e:MouseEventInfo)
{
	Div_pop.visible = false;
}

function grd_lst_OnRButtonDown(obj:Grid, e:GridMouseEventInfo)
{

	if (e.cell < 1 || e.row < 0 || DS_menu.getColumn(e.row, "tot_gbn") == "99") {
		return;
	}
	
	// 식수여부 CHECK
	var set_col		= gfn_subStr(DS_head.getColumn(e.cell-1, "FDAY"),4,4);
	var fil_cond	= "FDAY=='"+DS_head.getColumn(e.cell-1, "FDAY")+"'&&SGBN=='"+DS_menu.getColumn(e.row, "sgbn")+"'&&CGBN=='"+DS_menu.getColumn(e.row, "cgbn")+"'&&CGBN_CD=='"+DS_menu.getColumn(e.row, "cgbn_cd")+"'";
	var n_row		= tab_Main.tab00.DS_body1.findRowExpr(fil_cond);
	
	// if (n_row < 0 || tab_Main.tab00.DS_body1.GetColumn(n_row, "expect_meal_qty") <= 1) {
			// g_Message("EE",	"[MY레시피 등록작업 불가 !!]\n\n예상식수 정보가 없습니다.\n\n식수정보를 확인 후 처리하세요.");
			// return;
	// }
		
	//alert(nRow);
	//alert(nCell);
	// MY 레시피 등록
	var msg = DS_head.getColumn(e.cell-1, "FDAY")+":"+DS_menu.getColumn(e.row, "sgbn_nm")+DS_menu.getColumn(e.row, "cgbn")+"의\n\nMY레시피 등록 작업을 하시겠습니까?";

	if (g_Confirm("04",	msg) == true) {
		// MY 레시피등록
		var	v_arg	= "";
		var	v_open	= "";
		var	v_rtn	= "";
		var	v_width	= -1;
		var	v_height= -1;
		var	leftPx	= -1;
		var	topPx	= -1;

		var	v_menu_cd	= DS_head.getColumn(e.cell-1, "FDAY")+"-"+ds_input.getColumn(0, "HALL_CD")+DS_menu.getColumn(e.row, "sgbn")+DS_menu.getColumn(e.row, "cgbn_cd");
		
		v_arg	 = { fa_upjang:ds_input.getColumn(0, "UPJANG")
		            ,fa_hall_cd:ds_input.getColumn(0, "HALL_CD")
		            ,fa_meal:DS_menu.getColumn(e.row, "sgbn")
		            ,fa_corner:DS_menu.getColumn(e.row, "cgbn_cd")
		            ,fa_menu_date:DS_head.getColumn(e.cell-1, "FDAY")
		            ,fa_menu_cd:v_menu_cd
		            ,fa_subinv_code:ds_input.getColumn(0,"SUBINV_CODE")};
		
		v_open	 	= "TitleBar=false Status=false AutoSize=false Resize=false NoMove=false";
		//v_rtn 		= gfn_dialog("", "U_FSM::FSM00060E.xml", v_arg, v_width, v_height, v_open, leftPx, topPx);
		v_rtn 		= gfn_dialog("", "U_FSM::FSM00130E.xfdl", v_arg);
		
		fn_search();
	}
}

function grd_lst_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	if (e.row < 0 || e.cell < 1) {
		return;
	}
	
	if (DS_menu.getColumn(e.row, "tot_gbn") == "99" && DS_menu.getColumn(e.row, "sd_won_"+gfn_subStr(DS_head.getColumn(e.cell-1, "FDAY"),4,4)) > 0) {
		var	v_menu_cd = DS_head.getColumn(e.cell-1, "FDAY")+"-"+ds_input.getColumn(0, "HALL_CD")+DS_menu.getColumn(e.row, "sgbn")+DS_menu.getColumn(e.row, "cgbn_cd");
		var msg = DS_head.getColumn(e.cell-1, "FDAY")+":"+DS_menu.getColumn(e.row, "sgbn_nm")+DS_menu.getColumn(e.row, "cgbn")+" 을 삭제하시겠습니까?\n\n";
		msg    += "[ "+v_menu_cd+" ]";

		// 삭제여부 CHECK
		var set_col		= gfn_subStr(DS_head.getColumn(e.cell-1, "FDAY"),4,4);
		var fil_cond	= "FDAY=='"+DS_head.getColumn(e.cell-1, "FDAY")+"'&&SGBN=='"+DS_menu.getColumn(e.row, "sgbn")+"'&&SGBN=='"+DS_menu.getColumn(e.row, "cgbn")+"'&&CGBN_CD=='"+DS_menu.getColumn(e.row, "cgbn_cd")+"'";
		var n_row		= DS_body1.findRowExpr(fil_cond);
		
		if (DS_body1.getColumn(n_row, "ORDER_YN") == "Y") {
			g_Message("EE",	"식자재가 발주되었습니다.\n\n메뉴를 삭제할수 없습니다.");
			return;
		}

		if (g_Confirm("01",	msg) == true) {
			//alert(ds_input.GetColumn(0, "UPJANG"));
			//alert(v_menu_cd);
			//return;
			// 삭제처리
			var actionName, cmdName, inData, outData, otherArg, callBackFnc;
			
			inData			= "";
			outData			= "";
			otherArg		= "UPJANG="+wrapQuote(ds_input.getColumn(0, "UPJANG"))+" MENU_CD="+wrapQuote(v_menu_cd);
			callBackFnc		= "fn_afterSearch";
			
			fsp_clear(this); 
			fsp_addSearch(this, "fs/fsm:FSM00052E_D001");									// 조회 
			http.Sync = true;
			fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
			http.Sync = false;

			fn_search();
		}
		else {
			return;
		}
	}
	else {
		var msg = DS_head.getColumn(e.cell-1, "FDAY")+":"+DS_menu.getColumn(e.row, "sgbn_nm")+DS_menu.getColumn(e.row, "cgbn")+" 에 대한\n\n레시피 검색 및 등록/수정 작업을\n\n하시겠습니까?";

		// 식수여부 CHECK
		var set_col		= gfn_subStr(DS_head.getColumn(e.cell-1, "FDAY"),4,4);
		var fil_cond	= "FDAY=='"+DS_head.getColumn(e.cell-1, "FDAY")+"'&&SGBN=='"+DS_menu.getColumn(e.row, "sgbn")+"'&&CGBN=='"+DS_menu.getColumn(e.row, "cgbn")+"'&&CGBN_CD=='"+DS_menu.getColumn(e.row, "cgbn_cd")+"'";
		var n_row		= DS_body1.findRowExpr(fil_cond);

		if (n_row < 0 || DS_body1.getColumn(n_row, "GOAL_COST_RATE2") <= 1) {
				g_Message("EE",	"[레시피 검색 및 등록/수정작업 불가 !!]\n\n주간식단목표 식재료율 정보가 없습니다.\n\n주간식단목표 식재료율을 확인 후 처리하세요.");
				return;
		}
	
		if (g_Confirm("04",	msg) == true) {
			// 레시피 검색 및 등록/수정
			var	v_arg	= "";
			var	v_open	= "";
			var	v_rtn	= "";
			var	v_width	= -1;
			var	v_height= -1;
			var	leftPx	= -1;
			var	topPx	= -1;
			
			v_arg = {fa_UPJANG:ds_input.getColumn(0, "UPJANG")
			        ,fa_HALL_CD:ds_input.getColumn(0, "HALL_CD")
			        ,fa_HALL_CLASS:'005'
		            ,fa_FROM_DT:ds_input.getColumn(0, "MENU_SDATE")
			        ,fa_TO_DT:ds_input.getColumn(0, "MENU_EDATE")
			        ,fa_MEAL:DS_menu.getColumn(e.row, "sgbn")
			        ,fa_CORNER:DS_menu.getColumn(e.row, "cgbn_cd")
			        ,fa_MENU_DATE:DS_head.getColumn(e.cell-1, "FDAY")
			        ,fa_SUBINV_CODE:ds_input.getColumn(0, "SUBINV_CODE")};
			
			v_open	 	= "TitleBar=false Status=false AutoSize=false Resize=false NoMove=false";
			//v_rtn 		= gfn_dialog("", "U_FSM::FSM00060E.xml", v_arg, v_width, v_height, v_open, leftPx, topPx);
			v_rtn 		= gfn_dialog("", "U_FSM::FSM00060E.xfdl", v_arg, 1230, 770);
			
			 fn_search();
		}
	}
}

// NY 레시피 구성
function btn_recipe_OnClick(obj:Button, e:ClickEventInfo)
{
	var	v_arg	= "";
	var	v_open	= "";
	var	v_rtn	= "";
	var	v_width	= -1;
	var	v_height= -1;
	var	leftPx	= -1;
	var	topPx	= -1;
	
	v_arg	 =  {fa_Upjang:ds_input.getColumn(0, "UPJANG")
	            ,fa_UpjangNm:ds_input.getColumn(0, "UPJANG_NM")
	            ,fa_HallCd:ds_input.getColumn(0, "HALL_CD")
	            ,fa_HallName:cbo_hall.text
	            ,fa_MenuDate:ds_input.getColumn(0, "MENU_DATE")
	            ,fa_SubinvCode:ds_input.getColumn(0, "SUBINV_CODE")};
	
	v_open	 	= "TitleBar=false Status=false AutoSize=false Resize=false NoMove=false";
	//v_rtn 		= gfn_dialog("", "U_FSM::FSM00060E.xml", v_arg, v_width, v_height, v_open, leftPx, topPx);
	gfn_dialog("", "U_FSM::FSM00110E.xfdl", v_arg);
	
	 fn_search();
}

// 예측식수현황을 저장한다.
function btn_save_OnClick(obj:Button, e:ClickEventInfo)
{
	if ( (me_sikrate.value == "0.0") || (gfn_length(gfn_trim(me_sikrate.value))== 0 ) ) {
			g_Message("EE",	"주간식단목표 식재료율을 입력하시기 바랍니다.");
			me_sikrate.setFocus();
			return;
	}
	ds_input.setColumn(0, "EMP_NO", g_EmpNo);
	
	
	ds_sikrate.applyChange();
	ds_input.applyChange();
	
	// 식재료율을 저장한다.
	// ----------------------------
    // 서비스셋팅
    var actionName, cmdName, inData, outData, otherArg, callBackFnc;
    var selectSqlId, notFoundSql, foundSql, saveFlagColumn, keySqlName, keyIncrement, callbackSql;
    var	insertSql, updateSql, deleteSql;

	inData		= "ds_sikrate=ds_sikrate:A ds_input=ds_input";
	outData		= "DS_OUT";
	callBackFnc	= "fn_afterSearchSave1";
	selectSqlId = "fs/fsm:FSM00051E_S005";		// 데이타있는지 체크 sql
	notFoundSql	= "fs/fsm:FSM00051E_I002";		// insert sql
	foundSql	= "fs/fsm:FSM00051E_U002";		// update sql	
	callbackSql	= "";							// callback sql(재조회) 
	
	fsp_clear(this);
	fsp_addSelectExecute(this, selectSqlId,  notFoundSql,  foundSql);					// 저장
	// tit_addSearchActionInfo(this, callbackSql);												// CallBack조회 
	// tit_addSaveActionInfo(formObj, insertSql, updateSql, deleteSql,saveFl, agColumn, keySqlName, keyIncrement, callbackSql)
    
//	http.Sync = true;
	fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
//	http.Sync = false;
	
}

function fn_weekly_menu_save()
{
// 주간식단목표 식수를 저장한다.
	// ----------------------------
    // 서비스셋팅
    var actionName, cmdName, inData, outData, otherArg, callBackFnc;
    var selectSqlId, notFoundSql, foundSql, saveFlagColumn, keySqlName, keyIncrement, callbackSql;
    var	insertSql, updateSql, deleteSql;

	inData		= "DS_body1=DS_body1:A ds_input=ds_input";
	outData		= "";
	callBackFnc	= "fn_afterSearchSave2";
	selectSqlId = "fs/fsm:FSM00051E_S004";		// 데이타있는지 체크 sql
	notFoundSql	= "fs/fsm:FSM00051E_I001";		// insert sql
	foundSql	= "fs/fsm:FSM00051E_U001";		// update sql	
	callbackSql	= "";							// callback sql(재조회)
	
	insertSql	= "";							// insertSql
	updateSql	= "";							// updateSql
	deleteSql	= "";							// deleteSql
	// deleteSql	= "fs/fsm:FSM00051E_D001";		// deleteSql 
	
	fsp_clear(this);
	fsp_addSelectExecute(this, selectSqlId, notFoundSql,  foundSql);					// 저장
	// tit_addSaveActionInfo(this, insertSql, updateSql, deleteSql, saveFlagColumn, keySqlName, keyIncrement, callbackSql);
	// tit_addSearchActionInfo(this, callbackSql);												// CallBack조회 
	// tit_addSaveActionInfo(formObj, insertSql, updateSql, deleteSql,saveFlagColumn, keySqlName, keyIncrement, callbackSql)
    
//	http.Sync = true;
	fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
//	http.Sync = false;
	//
	// 정보를 읽는다.
 
}

function fn_afterSearchSave1(errCode, errMsg)
{
	if(errCode!=0)
	{
	
	    //trace(errMsg);
		return;
	} else {
	    fn_weekly_menu_save();
	}
}

function fn_afterSearchSave2(errCode, errMsg)
{
	if(errCode!=0)
	{
	    //trace(errMsg);
		return;
	} else {
	    fn_search();
	}
}

function btn_fcopy_OnClick(obj:Button, e:ClickEventInfo)
{
	// 식단복사
	var	v_arg	= "";
	var	v_open	= "";
	var	v_rtn	= "";
	var	v_width	= -1;
	var	v_height= -1;
	var	leftPx	= -1;
	var	topPx	= -1;
	
	v_arg	 = {fa_UPJANG:ds_input.getColumn(0, "UPJANG")
	           ,fa_UPJANG_NM:ds_input.getColumn(0, "UPJANG_NM")
	           ,fa_HALL_CD:ds_input.getColumn(0, "HALL_CD")
	           ,fa_HALL_NAME:cbo_hall.text
	           ,fa_FROM_DT:ds_input.getColumn(0, "MENU_SDATE")
	           ,fa_TO_DT:ds_input.getColumn(0, "MENU_EDATE")
	           ,fa_SUBINV_CODE:ds_input.getColumn(0,"SUBINV_CODE")};
	           
	//trace(v_arg);
	
	v_open	 	= "TitleBar=false Status=false AutoSize=false Resize=false NoMove=false";
	//v_rtn 		= gfn_dialog("", "U_FSM::FSM00060E.xml", v_arg, v_width, v_height, v_open, leftPx, topPx);
	v_rtn 		= gfn_dialog("", "U_FSM::FSM00100E.xfdl", v_arg);
	
	fn_search();
	
}

// 주간식단목표 식재료율이 변경되면 ...
function me_sikrate_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{
	//alert(length(toString(strText)));
	if (gfn_length(gfn_toString(e.posttext))> 0) {
		// 변경된 주간식단목표 식재료율을 setting 한다. 2008-01-07 추가됨
		for(var ii = 0; ii < ds_sikrate.rowcount; ii++) {
			ds_sikrate.setColumn(ii, "GOAL_COST_RATE", me_sikrate.value);
		}
		// 
		for(var jj = 0; jj < DS_body1.rowcount; jj++) {
			DS_body1.setColumn(jj, "GOAL_COST_RATE", me_sikrate.value);
		}
		
	}
	else {
		// 주간식단목표 식재료율 setting
		me_sikrate.value = ds_sikrate.getMax("GOAL_COST_RATE");
		
		me_sikrate.enable = true;
	}
	// g_debug("DS_body1");
	// g_debug("ds_sikrate");
	// 식당예상 식재료율
	fn_me_bSikRate();
}


// 구매게시판 화면 실행
function Button03_OnClick(obj:Button, e:ClickEventInfo)
{
 
    gfn_openMenuForm("SCC80040V.xfdl", "U_SCC", {bbsId:'13'}, "구매게시판");							
}

]]></Script>
  </Form>
</FDL>

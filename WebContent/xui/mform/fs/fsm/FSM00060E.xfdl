<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSM00060E" onload="form_onload" onclose="FSM00060E_OnUnloadCompleted" titletext="레시피검색및 등록" position="absolute 0 0 1230 740" scrollbars="none">
    <Layouts>
      <Layout>
        <Tab id="tab_main" taborder="64" canchange="tab_main_OnChanging" onchanged="tab_main_OnChanged" tabindex="0" position="absolute 14 421 1214 730">
          <Tabpages>
            <Tabpage id="tab0" text="레시피수정" url="U_FSM::FSM00061E.xfdl" scrollbars="none"/>
            <Tabpage id="tab1" text="조리법" url="U_FSM::FSM00062E.xfdl" scrollbars="none"/>
            <Tabpage id="tab3" text="조리공정" scrollbars="none">
              <Layouts>
                <Layout width="1153" height="264">
                  <Div id="div_ImgLoadUrl" taborder="0" url="U_FSM::FSM00064E.xfdl" text="Div0" position="absolute 0 0 1198 281"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Static id="sta_detail05" class="sta_WFDA_Labelbg" position="absolute 636 379 1215 407"/>
        <Static id="Static17" onclick="Static04_onclick" class="sta_WFSA_Labelbg" position="absolute 15 107 595 201"/>
        <Static id="Static04" class="sta_WFSA_Labelbg" position="absolute 15 10 1215 51" onclick="Static04_onclick"/>
        <ImageViewer id="img_Weather" taborder="27" position="absolute 15 52 43 77" onclick="img_Weather_onclick" style="border:1 none #cacacaff ;"/>
        <Static id="st_weather" position="absolute 47 55 1188 80" onclick="st_weather_onclick"/>
        <MaskEdit id="me_Cnt" ontextchanged="common_OnChanged" taborder="5" position="absolute 662 20 719 41" mask="#,###"/>
        <MaskEdit id="me_danga" ontextchanged="common_OnChanged" taborder="6" position="absolute 805 20 862 42" mask="#,###" visible="true" enable="false"/>
        <Grid autoenter="select" binddataset="ds_Menu" cellmovingtype="col" selecttype="cell" cellsizingtype="col" readonly="false" enable="true" cellsizebandtype="allband" id="grd_RealRecipe" useinputpanel="false" onheadclick="grd_RealRecipe_OnHeadClick" onkeydown="grd_RealRecipe_OnKeyDown" onmousemove="grd_RealRecipe_OnMouseOver" taborder="36" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 636 107 1215 377" oncellclick="grd_RealRecipe_OnCellClick" fillareatype="none">
          <Formats>
            <Format id="HOSPITAL">
              <Columns>
                <Column size="27" band="left"/>
                <Column size="35" band="left"/>
                <Column size="35" band="left"/>
                <Column size="20" band="left"/>
                <Column size="50" band="left"/>
                <Column size="120"/>
                <Column size="80"/>
                <Column size="60"/>
                <Column size="25"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" style="align:center;" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="순서"/>
                <Cell col="2" rowspan="2" displaytype="text" text="구축"/>
                <Cell col="3" rowspan="2" colspan="2" displaytype="text" text="레시피코드"/>
                <Cell col="5" rowspan="2" displaytype="text" text="레시피명"/>
                <Cell col="6" rowspan="2" displaytype="text" expr="expr:'구성\n요소'"/>
                <Cell col="7" rowspan="2" displaytype="text" expr="expr:'원가\n(원)'"/>
                <Cell col="8" rowspan="2" displaytype="text" text="색"/>
                <Cell col="9" rowspan="2" displaytype="text" text="레시피분류" expr="expr:'에너지\n(kcal)'"/>
                <Cell col="10" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'나트륨\n(mg)'"/>
                <Cell col="11" rowspan="2" displaytype="text" text="레시피유형" expr="expr:'당질\n(g)'"/>
                <Cell col="12" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'단백질\n(g)'"/>
                <Cell col="13" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'지질\n(g)'"/>
                <Cell col="14" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민A\n(R.E)'"/>
                <Cell col="15" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민B1\n(mg)'"/>
                <Cell col="16" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민B2\n(mg)'"/>
                <Cell col="17" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민C\n(mg)'"/>
                <Cell col="18" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'칼슘\n(mg)'"/>
                <Cell col="19" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'철\n(mg)'"/>
              </Band>
              <Band id="body">
                <Cell displaytype="normal" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" celltype="body" displaytype="text" edittype="text" editfilter="number" style="align:right;" text="bind:RECIPE_SEQ" editautoselect="true" editdisplay="edit"/>
                <Cell col="2" displaytype="checkbox" edittype="checkbox" style="align:center;" text="bind:CREAT"/>
                <Cell col="3" displaytype="image" edittype="none" style="align:center;backgroundimage: ;" text="theme://images/new/grd_WF_ExpandImageX.png"/>
                <Cell col="4" displaytype="text" style="align:center;" text="bind:RECIPE_CD"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                <Cell col="6" displaytype="combo" edittype="combo" style="align:left;" text="bind:MAJOR_DISH_INFO" combodataset="ds_Const" combocodecol="CD" combodatacol="NM"/>
                <Cell col="7" displaytype="number" style="align:right;" text="bind:RECIPE_COST"/>
                <Cell col="8" displaytype="image" style="align:center middle;selectbackground: ;" text="expr:gfn_nvl(COLOR)==&quot;&quot;?&quot;&quot;:&quot;URL('theme://convertImages/&quot;+COLOR+&quot;.bmp')&quot;"/>
                <Cell col="9" displaytype="number" style="align:right;" text="bind:S_KCAL"/>
                <Cell col="10" displaytype="number" style="align:right;" text="bind:S_NA"/>
                <Cell col="11" displaytype="number" style="align:right;" text="bind:S_CARBO"/>
                <Cell col="12" displaytype="number" style="align:right;" text="bind:S_PROT"/>
                <Cell col="13" displaytype="number" style="align:right;" text="bind:S_FAT"/>
                <Cell col="14" displaytype="number" style="align:right;" text="bind:S_VITA"/>
                <Cell col="15" displaytype="number" style="align:right;" text="bind:S_THIA"/>
                <Cell col="16" displaytype="number" style="align:right;" text="bind:S_RIBO"/>
                <Cell col="17" displaytype="number" style="align:right;" text="bind:S_VITA_C"/>
                <Cell col="18" displaytype="number" style="align:right;" text="bind:S_CA"/>
                <Cell col="19" displaytype="number" style="align:right;" text="bind:S_FE"/>
              </Band>
              <Band id="summary">
                <Cell colspan="5" displaytype="text" style="align:center;" text="합계"/>
                <Cell col="5" edittype="normal" style="align:right;" expr="expr:'식재료율('+  Math.round((getSum(&quot;RECIPE_COST&quot;)/getAvg(&quot;CORN_SALE_PRICE&quot;)) * 100,1)+'%)'"/>
                <Cell col="6" displaytype="text" style="align:left;"/>
                <Cell col="7" displaytype="number" style="align:right;" expr="expr:getSum('RECIPE_COST')" mask="#,##0"/>
                <Cell col="8" displaytype="text" style="align:left;"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:getSum('S_KCAL')"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="expr:getSum('S_FE')"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:getSum('S_CARBO')"/>
                <Cell col="12" displaytype="number" style="align:right;" expr="expr:getSum('S_PROT')"/>
                <Cell col="13" displaytype="number" style="align:right;" expr="expr:getSum('S_FAT')"/>
                <Cell col="14" displaytype="number" style="align:right;" expr="expr:getSum('S_VITA')"/>
                <Cell col="15" displaytype="number" style="align:right;" expr="expr:getSum('S_THIA')"/>
                <Cell col="16" displaytype="number" style="align:right;" expr="expr:getSum('S_RIBO')"/>
                <Cell col="17" displaytype="number" style="align:right;" expr="expr:getSum('S_VITA_C')"/>
                <Cell col="18" displaytype="number" style="align:right;" expr="expr:getSum('S_CA')"/>
                <Cell col="19" displaytype="number" style="align:right;" expr="expr:getSum('S_FE')"/>
              </Band>
            </Format>
            <Format id="CAFETERIA">
              <Columns>
                <Column size="27" band="left"/>
                <Column size="35" band="left"/>
                <Column size="35" band="left"/>
                <Column size="20" band="left"/>
                <Column size="47" band="left"/>
                <Column size="93" band="left"/>
                <Column size="45"/>
                <Column size="45"/>
                <Column size="50"/>
                <Column size="50"/>
                <Column size="25"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" style="align:center;" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="순서"/>
                <Cell col="2" rowspan="2" displaytype="text" text="구축"/>
                <Cell col="3" rowspan="2" colspan="2" displaytype="text" text="레시피코드"/>
                <Cell col="5" rowspan="2" displaytype="text" text="레시피명"/>
                <Cell col="6" rowspan="2" displaytype="text" expr="expr:'원가\n(원)'"/>
                <Cell col="7" rowspan="2" displaytype="text" expr="expr:'원가율\n(%)'"/>
                <Cell col="8" rowspan="2" displaytype="text" expr="expr:'판매가\n(VAT제외)'"/>
                <Cell col="9" rowspan="2" displaytype="text" expr="expr:'예상\n판매량'"/>
                <Cell col="10" rowspan="2" displaytype="text" text="색"/>
                <Cell col="11" rowspan="2" displaytype="text" text="레시피분류" expr="expr:'에너지\n(kcal)'"/>
                <Cell col="12" rowspan="2" displaytype="text" text="레시피유형" expr="expr:'당질\n(g)'"/>
                <Cell col="13" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'단백질\n(g)'"/>
                <Cell col="14" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'지질\n(g)'"/>
                <Cell col="15" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민A\n(R.E)'"/>
                <Cell col="16" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민B1\n(mg)'"/>
                <Cell col="17" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민B2\n(mg)'"/>
                <Cell col="18" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민C\n(mg)'"/>
                <Cell col="19" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'칼슘\n(mg)'"/>
                <Cell col="20" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'철\n(mg)'"/>
                <Cell col="21" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'나트륨\n(mg)'"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="number" edittype="text" editfilter="number" style="align:right;" text="bind:RECIPE_SEQ" editautoselect="true"/>
                <Cell col="2" displaytype="checkbox" edittype="checkbox" style="align:center;" text="bind:CREAT"/>
                <Cell col="3" displaytype="image" style="align:center;" text="theme://images/new/grd_WF_ExpandImageX.png"/>
                <Cell col="4" displaytype="text" style="align:center;" text="bind:RECIPE_CD"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:RECIPE_COST"/>
                <Cell col="7" displaytype="number" style="align:right;" text="bind:COST_RATE"/>
                <Cell col="8" displaytype="number" edittype="text" editfilter="number" style="align:right;" text="bind:SALE_PRICE" editautoselect="true"/>
                <Cell col="9" displaytype="number" edittype="text" editfilter="number" style="align:right;" text="bind:EXPECT_SALE_QTY" editautoselect="true"/>
                <Cell col="10" displaytype="image" style="align:center middle;padding: ;" text="expr:gfn_nvl(COLOR)==&quot;&quot;?&quot;&quot;:&quot;URL('theme://convertImages/&quot;+COLOR+&quot;.bmp')&quot;"/>
                <Cell col="11" displaytype="number" style="align:right;" text="bind:S_KCAL"/>
                <Cell col="12" displaytype="number" style="align:right;" text="bind:S_CARBO"/>
                <Cell col="13" displaytype="number" style="align:right;" text="bind:S_PROT"/>
                <Cell col="14" displaytype="number" style="align:right;" text="bind:S_FAT"/>
                <Cell col="15" displaytype="number" style="align:right;" text="bind:S_VITA"/>
                <Cell col="16" displaytype="number" style="align:right;" text="bind:S_THIA"/>
                <Cell col="17" displaytype="number" style="align:right;" text="bind:S_RIBO"/>
                <Cell col="18" displaytype="number" style="align:right;" text="bind:S_VITA_C"/>
                <Cell col="19" displaytype="number" style="align:right;" text="bind:S_CA"/>
                <Cell col="20" displaytype="number" style="align:right;" text="bind:S_FE"/>
                <Cell col="21" displaytype="number" style="align:right;" text="bind:S_NA"/>
              </Band>
            </Format>
            <Format id="ETC">
              <Columns>
                <Column size="27" band="left"/>
                <Column size="35" band="left"/>
                <Column size="35" band="left"/>
                <Column size="20" band="left"/>
                <Column size="50" band="left"/>
                <Column size="120" band="left"/>
                <Column size="60"/>
                <Column size="25"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" style="align:center;" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="순서"/>
                <Cell col="2" rowspan="2" displaytype="text" text="구축"/>
                <Cell col="3" rowspan="2" colspan="2" displaytype="text" text="레시피코드"/>
                <Cell col="5" rowspan="2" displaytype="text" text="레시피명"/>
                <Cell col="6" rowspan="2" displaytype="text" expr="expr:'원가\n(원)'"/>
                <Cell col="7" rowspan="2" displaytype="text" text="색"/>
                <Cell col="8" rowspan="2" displaytype="text" text="레시피분류" expr="expr:'에너지\n(kcal)'"/>
                <Cell col="9" rowspan="2" displaytype="text" text="레시피유형" expr="expr:'당질\n(g)'"/>
                <Cell col="10" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'단백질\n(g)'"/>
                <Cell col="11" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'지질\n(g)'"/>
                <Cell col="12" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민A\n(R.E)'"/>
                <Cell col="13" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민B1\n(mg)'"/>
                <Cell col="14" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민B2\n(mg)'"/>
                <Cell col="15" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민C\n(mg)'"/>
                <Cell col="16" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'칼슘\n(mg)'"/>
                <Cell col="17" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'철\n(mg)'"/>
                <Cell col="18" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'나트륨\n(mg)'"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="number" edittype="text" editfilter="number" style="align:right;" text="bind:RECIPE_SEQ" editautoselect="true"/>
                <Cell col="2" displaytype="checkbox" edittype="checkbox" style="align:center;" text="bind:CREAT"/>
                <Cell col="3" displaytype="image" style="align:center;" text="theme://images/new/grd_WF_ExpandImageX.png"/>
                <Cell col="4" displaytype="text" style="align:center;" text="bind:RECIPE_CD"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:RECIPE_COST"/>
                <Cell col="7" displaytype="image" style="align:center middle;selectbackground: ;" text="expr:gfn_nvl(COLOR)==&quot;&quot;?&quot;&quot;:&quot;URL('theme://convertImages/&quot;+COLOR+&quot;.bmp')&quot;"/>
                <Cell col="8" displaytype="number" style="align:right;" text="bind:S_KCAL"/>
                <Cell col="9" displaytype="number" style="align:right;" text="bind:S_CARBO"/>
                <Cell col="10" displaytype="number" style="align:right;" text="bind:S_PROT"/>
                <Cell col="11" displaytype="number" style="align:right;" text="bind:S_FAT"/>
                <Cell col="12" displaytype="number" style="align:right;" text="bind:S_VITA"/>
                <Cell col="13" displaytype="number" style="align:right;" text="bind:S_THIA"/>
                <Cell col="14" displaytype="number" style="align:right;" text="bind:S_RIBO"/>
                <Cell col="15" displaytype="number" style="align:right;" text="bind:S_VITA_C"/>
                <Cell col="16" displaytype="number" style="align:right;" text="bind:S_CA"/>
                <Cell col="17" displaytype="number" style="align:right;" text="bind:S_FE"/>
                <Cell col="18" displaytype="number" style="align:right;" text="bind:S_NA"/>
              </Band>
              <Band id="summary">
                <Cell colspan="5" displaytype="text" style="align:center;" text="합계"/>
                <Cell col="5" style="align:right;" expr="expr:'식재료율('+  Math.round((getSum(&quot;RECIPE_COST&quot;)/getAvg(&quot;CORN_SALE_PRICE&quot;)) * 100,1)+'%)'"/>
                <Cell col="6" displaytype="number" style="align:right;" expr="expr:getSum('RECIPE_COST')"/>
                <Cell col="7" displaytype="text" style="align:left;"/>
                <Cell col="8" displaytype="number" style="align:right;" expr="expr:getSum('S_KCAL')"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:getSum('S_CARBO')"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="expr:getSum('S_PROT')"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:getSum('S_FAT')"/>
                <Cell col="12" displaytype="number" style="align:right;" expr="expr:getSum('S_VITA')"/>
                <Cell col="13" displaytype="number" style="align:right;" expr="expr:getSum('S_THIA')"/>
                <Cell col="14" displaytype="number" style="align:right;" expr="expr:getSum('S_RIBO')"/>
                <Cell col="15" displaytype="number" style="align:right;" expr="expr:getSum('S_VITA_C')"/>
                <Cell col="16" displaytype="number" style="align:right;" expr="expr:getSum('S_CA')"/>
                <Cell col="17" displaytype="number" style="align:right;" expr="expr:getSum('S_FE')"/>
                <Cell col="18" displaytype="number" style="align:right;" expr="expr:getSum('S_FE')"/>
              </Band>
            </Format>
            <Format id="SS_HOSPITAL">
              <Columns>
                <Column size="27"/>
                <Column size="35"/>
                <Column size="35"/>
                <Column size="20"/>
                <Column size="50"/>
                <Column size="120"/>
                <Column size="80"/>
                <Column size="60"/>
                <Column size="25"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" style="align:center;" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="순서"/>
                <Cell col="2" rowspan="2" displaytype="text" text="구축"/>
                <Cell col="3" rowspan="2" colspan="2" displaytype="text" text="레시피코드"/>
                <Cell col="5" rowspan="2" displaytype="text" text="레시피명"/>
                <Cell col="6" rowspan="2" displaytype="text" expr="expr:'구성\n요소'"/>
                <Cell col="7" rowspan="2" displaytype="text" expr="expr:'원가\n(원)'"/>
                <Cell col="8" rowspan="2" displaytype="text" text="색"/>
                <Cell col="9" rowspan="2" displaytype="text" text="레시피분류" expr="expr:'에너지\n(kcal)'"/>
                <Cell col="10" rowspan="2" displaytype="text" text="레시피유형" expr="expr:'당질\n(g)'"/>
                <Cell col="11" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'단백질\n(g)'"/>
                <Cell col="12" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'지질\n(g)'"/>
                <Cell col="13" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민A\n(R.E)'"/>
                <Cell col="14" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민B1\n(mg)'"/>
                <Cell col="15" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민B2\n(mg)'"/>
                <Cell col="16" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민C\n(mg)'"/>
                <Cell col="17" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'칼슘\n(mg)'"/>
                <Cell col="18" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'철\n(mg)'"/>
                <Cell col="19" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'나트륨\n(mg)'"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="number" edittype="text" editfilter="number" style="align:right;" text="bind:RECIPE_SEQ" editautoselect="true"/>
                <Cell col="2" displaytype="checkbox" edittype="checkbox" style="align:center;" text="bind:CREAT"/>
                <Cell col="3" displaytype="image" style="align:center;" text="theme://images/new/grd_WF_ExpandImageX.png"/>
                <Cell col="4" displaytype="text" style="align:center;" text="bind:RECIPE_CD"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                <Cell col="6" displaytype="combo" edittype="combo" style="align:left;" text="bind:MAJOR_DISH_INFO" combodataset="ds_Const" combocodecol="CD" combodatacol="NM"/>
                <Cell col="7" displaytype="number" style="align:right;" text="bind:RECIPE_COST"/>
                <Cell col="8" displaytype="image" style="align:center middle;selectbackground: ;" text="expr:gfn_nvl(COLOR)==&quot;&quot;?&quot;&quot;:&quot;URL('theme://convertImages/&quot;+COLOR+&quot;.bmp')&quot;"/>
                <Cell col="9" displaytype="number" style="align:right;" text="bind:SS_KCAL"/>
                <Cell col="10" displaytype="number" style="align:right;" text="bind:SS_CARBO"/>
                <Cell col="11" displaytype="number" style="align:right;" text="bind:SS_PROT"/>
                <Cell col="12" displaytype="number" style="align:right;" text="bind:SS_FAT"/>
                <Cell col="13" displaytype="number" style="align:right;" text="bind:SS_VITA"/>
                <Cell col="14" displaytype="number" style="align:right;" text="bind:SS_THIA"/>
                <Cell col="15" displaytype="number" style="align:right;" text="bind:SS_RIBO"/>
                <Cell col="16" displaytype="number" style="align:right;" text="bind:SS_VITA_C"/>
                <Cell col="17" displaytype="number" style="align:right;" text="bind:SS_CA"/>
                <Cell col="18" displaytype="number" style="align:right;" text="bind:SS_FE"/>
                <Cell col="19" displaytype="number" style="align:right;" text="bind:SS_NA"/>
              </Band>
              <Band id="summary">
                <Cell colspan="5" displaytype="text" style="align:center;" text="합계"/>
                <Cell col="5" style="align:right;" expr="expr:'식재료율('+  Math.round((getSum(&quot;RECIPE_COST&quot;)/getAvg(&quot;CORN_SALE_PRICE&quot;)) * 100,1)+'%)'"/>
                <Cell col="6" displaytype="text" style="align:left;"/>
                <Cell col="7" displaytype="number" style="align:right;" expr="expr:getSum('RECIPE_COST')"/>
                <Cell col="8" displaytype="text" style="align:left;"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:getSum('SS_KCAL')"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="expr:getSum('SS_CARBO')"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:getSum('SS_PROT')"/>
                <Cell col="12" displaytype="number" style="align:right;" expr="expr:getSum('SS_FAT')"/>
                <Cell col="13" displaytype="number" style="align:right;" expr="expr:getSum('SS_VITA')"/>
                <Cell col="14" displaytype="number" style="align:right;" expr="expr:getSum('SS_THIA')"/>
                <Cell col="15" displaytype="number" style="align:right;" expr="expr:getSum('SS_RIBO')"/>
                <Cell col="16" displaytype="number" style="align:right;" expr="expr:getSum('SS_VITA_C')"/>
                <Cell col="17" displaytype="number" style="align:right;" expr="expr:getSum('SS_CA')"/>
                <Cell col="18" displaytype="number" style="align:right;" expr="expr:getSum('SS_FE')"/>
                <Cell col="19" displaytype="number" style="align:right;" expr="expr:getSum('SS_FE')"/>
              </Band>
            </Format>
            <Format id="SS_CAFETERIA">
              <Columns>
                <Column size="27" band="left"/>
                <Column size="35" band="left"/>
                <Column size="35" band="left"/>
                <Column size="20" band="left"/>
                <Column size="47" band="left"/>
                <Column size="93" band="left"/>
                <Column size="45"/>
                <Column size="45"/>
                <Column size="50"/>
                <Column size="50"/>
                <Column size="25"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" style="align:center;" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="순서"/>
                <Cell col="2" rowspan="2" displaytype="text" text="구축"/>
                <Cell col="3" rowspan="2" colspan="2" displaytype="text" text="레시피코드"/>
                <Cell col="5" rowspan="2" displaytype="text" text="레시피명"/>
                <Cell col="6" rowspan="2" displaytype="text" expr="expr:'원가\n(원)'"/>
                <Cell col="7" rowspan="2" displaytype="text" expr="expr:'원가율\n(%)'"/>
                <Cell col="8" rowspan="2" displaytype="text" expr="expr:'판매가\n(VAT제외)'"/>
                <Cell col="9" rowspan="2" displaytype="text" expr="expr:'예상\n판매량'"/>
                <Cell col="10" rowspan="2" displaytype="text" text="색"/>
                <Cell col="11" rowspan="2" displaytype="text" text="레시피분류" expr="expr:'에너지\n(kcal)'"/>
                <Cell col="12" rowspan="2" displaytype="text" text="레시피유형" expr="expr:'당질\n(g)'"/>
                <Cell col="13" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'단백질\n(g)'"/>
                <Cell col="14" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'지질\n(g)'"/>
                <Cell col="15" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민A\n(R.E)'"/>
                <Cell col="16" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민B1\n(mg)'"/>
                <Cell col="17" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민B2\n(mg)'"/>
                <Cell col="18" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민C\n(mg)'"/>
                <Cell col="19" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'칼슘\n(mg)'"/>
                <Cell col="20" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'철\n(mg)'"/>
                <Cell col="21" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'나트륨\n(mg)'"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;background:white;background2:white;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="number" edittype="text" editfilter="number" style="align:right;background:white;background2:white;" text="bind:RECIPE_SEQ" editautoselect="true"/>
                <Cell col="2" displaytype="checkbox" edittype="checkbox" style="align:center;background:white;background2:white;" text="bind:CREAT"/>
                <Cell col="3" displaytype="image" style="align:center;background:white;background2:white;" text="theme://images/new/grd_WF_ExpandImageX.png"/>
                <Cell col="4" displaytype="text" style="align:center;background:white;background2:white;" text="bind:RECIPE_CD"/>
                <Cell col="5" displaytype="text" style="align:left;background:white;background2:white;" text="bind:RECIPE_NAME"/>
                <Cell col="6" displaytype="number" style="align:right;background:white;background2:white;" text="bind:RECIPE_COST"/>
                <Cell col="7" displaytype="number" style="align:right;background:white;background2:white;" text="bind:COST_RATE"/>
                <Cell col="8" displaytype="number" edittype="text" editfilter="number" style="align:right;background:white;background2:white;" text="bind:SALE_PRICE" editautoselect="true"/>
                <Cell col="9" displaytype="number" edittype="text" editfilter="number" style="align:right;background:white;background2:white;" text="bind:EXPECT_SALE_QTY" editautoselect="true"/>
                <Cell col="10" displaytype="image" style="align:center middle;background:white;background2:white;" text="expr:gfn_nvl(COLOR)==&quot;&quot;?&quot;&quot;:&quot;URL('theme://convertImages/&quot;+COLOR+&quot;.bmp')&quot;"/>
                <Cell col="11" displaytype="number" style="align:right;background:white;background2:white;" text="bind:SS_KCAL"/>
                <Cell col="12" displaytype="number" style="align:right;background:white;background2:white;" text="bind:SS_CARBO"/>
                <Cell col="13" displaytype="number" style="align:right;background:white;background2:white;" text="bind:SS_PROT"/>
                <Cell col="14" displaytype="number" style="align:right;background:white;background2:white;" text="bind:SS_FAT"/>
                <Cell col="15" displaytype="number" style="align:right;background:white;background2:white;" text="bind:SS_VITA"/>
                <Cell col="16" displaytype="number" style="align:right;background:white;background2:white;" text="bind:SS_THIA"/>
                <Cell col="17" displaytype="number" style="align:right;background:white;background2:white;" text="bind:SS_RIBO"/>
                <Cell col="18" displaytype="number" style="align:right;background:white;background2:white;" text="bind:SS_VITA_C"/>
                <Cell col="19" displaytype="number" style="align:right;background:white;background2:white;" text="bind:SS_CA"/>
                <Cell col="20" displaytype="number" style="align:right;background:white;background2:white;" text="bind:SS_FE"/>
                <Cell col="21" displaytype="number" style="align:right;background:white;background2:white;" text="bind:SS_NA"/>
              </Band>
            </Format>
            <Format id="SS_ETC">
              <Columns>
                <Column size="27" band="left"/>
                <Column size="35" band="left"/>
                <Column size="35" band="left"/>
                <Column size="20" band="left"/>
                <Column size="50" band="left"/>
                <Column size="120" band="left"/>
                <Column size="60"/>
                <Column size="25"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" style="align:center;" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="순서"/>
                <Cell col="2" rowspan="2" displaytype="text" text="구축"/>
                <Cell col="3" rowspan="2" colspan="2" displaytype="text" text="레시피코드"/>
                <Cell col="5" rowspan="2" displaytype="text" text="레시피명"/>
                <Cell col="6" rowspan="2" displaytype="text" expr="expr:'원가\n(원)'"/>
                <Cell col="7" rowspan="2" displaytype="text" text="색"/>
                <Cell col="8" rowspan="2" displaytype="text" text="레시피분류" expr="expr:'에너지\n(kcal)'"/>
                <Cell col="9" rowspan="2" displaytype="text" text="레시피유형" expr="expr:'당질\n(g)'"/>
                <Cell col="10" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'단백질\n(g)'"/>
                <Cell col="11" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'지질\n(g)'"/>
                <Cell col="12" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민A\n(R.E)'"/>
                <Cell col="13" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민B1\n(mg)'"/>
                <Cell col="14" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민B2\n(mg)'"/>
                <Cell col="15" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'비타민C\n(mg)'"/>
                <Cell col="16" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'칼슘\n(mg)'"/>
                <Cell col="17" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'철\n(mg)'"/>
                <Cell col="18" rowspan="2" displaytype="text" text="조리법유형" expr="expr:'나트륨\n(mg)'"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="number" edittype="text" editfilter="number" style="align:right;" text="bind:RECIPE_SEQ" editautoselect="true"/>
                <Cell col="2" displaytype="checkbox" edittype="checkbox" style="align:center;" text="bind:CREAT"/>
                <Cell col="3" displaytype="image" style="align:center;" text="theme://images/new/grd_WF_ExpandImageX.png"/>
                <Cell col="4" displaytype="text" style="align:center;" text="bind:RECIPE_CD"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:RECIPE_COST"/>
                <Cell col="7" displaytype="image" style="align:center middle;selectbackground: ;" text="expr:gfn_nvl(COLOR)==&quot;&quot;?&quot;&quot;:&quot;URL('theme://convertImages/&quot;+COLOR+&quot;.bmp')&quot;"/>
                <Cell col="8" displaytype="number" style="align:right;" text="bind:SS_KCAL"/>
                <Cell col="9" displaytype="number" style="align:right;" text="bind:SS_CARBO"/>
                <Cell col="10" displaytype="number" style="align:right;" text="bind:SS_PROT"/>
                <Cell col="11" displaytype="number" style="align:right;" text="bind:SS_FAT"/>
                <Cell col="12" displaytype="number" style="align:right;" text="bind:SS_VITA"/>
                <Cell col="13" displaytype="number" style="align:right;" text="bind:SS_THIA"/>
                <Cell col="14" displaytype="number" style="align:right;" text="bind:SS_RIBO"/>
                <Cell col="15" displaytype="number" style="align:right;" text="bind:SS_VITA_C"/>
                <Cell col="16" displaytype="number" style="align:right;" text="bind:SS_CA"/>
                <Cell col="17" displaytype="number" style="align:right;" text="bind:SS_FE"/>
                <Cell col="18" displaytype="number" style="align:right;" text="bind:SS_NA"/>
              </Band>
              <Band id="summary">
                <Cell colspan="5" displaytype="text" style="align:center;" text="합계"/>
                <Cell col="5" style="align:right;" expr="expr:'식재료율('+  Math.round((getSum(&quot;RECIPE_COST&quot;)/getAvg(&quot;CORN_SALE_PRICE&quot;)) * 100,1)+'%)'"/>
                <Cell col="6" displaytype="number" style="align:right;" expr="expr:getSum('RECIPE_COST')" mask="#,##0"/>
                <Cell col="7" displaytype="text" style="align:left;"/>
                <Cell col="8" displaytype="number" style="align:right;" expr="expr:getSum('SS_KCAL')"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:getSum('SS_CARBO')"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="expr:getSum('SS_PROT')"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:getSum('SS_FAT')"/>
                <Cell col="12" displaytype="number" style="align:right;" expr="expr:getSum('SS_VITA')"/>
                <Cell col="13" displaytype="number" style="align:right;" expr="expr:getSum('SS_THIA')"/>
                <Cell col="14" displaytype="number" style="align:right;" expr="expr:getSum('SS_RIBO')"/>
                <Cell col="15" displaytype="number" style="align:right;" expr="expr:getSum('SS_VITA_C')"/>
                <Cell col="16" displaytype="number" style="align:right;" expr="expr:getSum('SS_CA')"/>
                <Cell col="17" displaytype="number" style="align:right;" expr="expr:getSum('SS_FE')"/>
                <Cell col="18" displaytype="number" style="align:right;" expr="expr:getSum('SS_FE')"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_ImgPop" onclick="btn_ImgPop_OnClick" taborder="22" position="absolute 639 382 662 404" class="btn_WF_camera" image="" style="backgroundimagemode:single;"/>
        <Button id="btn_Qality" onclick="btn_Qality_OnClick" taborder="23" text="품질평가" position="absolute 664 382 739 404" class="btn_WF_Custom" image=""/>
        <Button id="btn_Nut" onclick="btn_Nut_OnClick" taborder="24" text="영양평가" position="absolute 741 382 816 404" class="btn_WF_Custom" image="" visible="true" enable="true" enableevent="true"/>
        <CheckBox id="chk_disuse" onclick="chk_disuse_OnClick" taborder="25" text="폐기율 적용" tooltiptext="체크시 폐기율이 적용되어&#10;영양소가 계산됩니다." position="absolute 1123 383 1209 403" value="true"/>
        <Button id="btn_leftMoveData" onclick="btn_leftMoveData_OnClick" taborder="21" text="" position="absolute 605 216 627 238" class="btn_WF_rightMove" image=""/>
        <Div id="div_extend" taborder="37" text="Div1" position="absolute 10 200 597 407" scrollbars="none">
          <Layouts>
            <Layout>
              <Static id="Static00" position="absolute 4 14 585 206" style="background:white;border:1 solid #808080ff ;color:white;bordertype:normal 1 1 ;" anchor="default"/>
              <Static id="st_bar" position="absolute 48 1 560 14" anchor="default"/>
              <ImageViewer id="img_open" image="URL('theme://convertImages/img_OpenBottom.png')" onclick="div_extend_img_open_OnClick" transparenthittest="false" taborder="2" position="absolute 5 1 41 13" anchor="default"/>
              <Grid binddataset="ds_List" cellmovingtype="col" cellsizingtype="both" enable="true" id="grd_List" useinputpanel="false" oncellclick="div_extend_grd_List_OnCellClick" oncelldblclick="div_extend_grd_List_OnCellDblClick" onheadclick="div_extend_grd_List_OnHeadClick" onkillfocus="div_extend_grd_List_OnKillFocus" onmousemove="div_extend_grd_List_OnMouseOver" taborder="1" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 4 14 585 207" readonly="true" selecttype="row" anchor="default">
                <Formats>
                  <Format id="Default">
                    <Columns>
                      <Column size="27"/>
                      <Column size="35"/>
                      <Column size="17"/>
                      <Column size="60"/>
                      <Column size="17"/>
                      <Column size="130"/>
                      <Column size="50"/>
                      <Column size="26"/>
                      <Column size="70"/>
                      <Column size="80"/>
                      <Column size="80"/>
                      <Column size="80"/>
                    </Columns>
                    <Rows>
                      <Row size="26" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell displaytype="text" class="head_Excel"/>
                      <Cell col="1" displaytype="text" text="구분"/>
                      <Cell col="2" colspan="2" displaytype="text" text="레시피코드"/>
                      <Cell col="4" colspan="2" displaytype="text" text="레시피명"/>
                      <Cell col="6" displaytype="text" text="원가"/>
                      <Cell col="7" displaytype="text" text="H"/>
                      <Cell col="8" displaytype="text" text="선호도"/>
                      <Cell col="9" displaytype="text" text="레시피분류"/>
                      <Cell col="10" displaytype="text" text="레시피유형"/>
                      <Cell col="11" displaytype="text" text="조리법유형"/>
                    </Band>
                    <Band id="body">
                      <Cell displaytype="text" style="align:center;background:white;background2:white;" expr="expr:currow+1"/>
                      <Cell col="1" displaytype="text" style="align:center;background:white;background2:white;" text="bind:GUBUN"/>
                      <Cell col="2" colspan="2" style="align:left;background:white;background2:white;backgroundimage:EXPR(fn_getBackImage(&quot;DI_MON&quot;, DI_MON));">
                        <Cell style="backgroundimage:EXPR(iif(DI_MON==1,'ico_N',''));align:left;"/>
                        <Cell col="1" style="align:left;" text="bind:RECIPE_CD"/>
                      </Cell>
                      <Cell col="4" colspan="2" displaytype="text" style="align:left;background:white;background2:white;backgroundimage:EXPR(fn_getBackImage1(&quot;PHF&quot;, PHF));">
                        <Cell displaytype="text" style="backgroundimage:EXPR(iif(PHF=='Y','ico_P',''));align:left;"/>
                        <Cell col="1" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                      </Cell>
                      <Cell col="6" displaytype="number" style="align:right;background:white;background2:white;" text="bind:RECIPE_COST"/>
                      <Cell col="7" displaytype="image" style="align:center middle;background:white;background2:white;cursor:hand;" text="theme://Images/new/grd_WF_ExpandImage.png"/>
                      <Cell col="8" displaytype="text" style="align:left;background:EXPR(PREFER_LABEL);background2:EXPR(PREFER_LABEL);selectbackground:EXPR(PREFER_LABEL);"/>
                      <Cell col="9" displaytype="combo" style="align:left;background:white;background2:white;" text="bind:RECIPE_CLASS" combodataset="ds_RecipeClass" combocodecol="CD" combodatacol="NM"/>
                      <Cell col="10" displaytype="combo" style="align:left;background:white;background2:white;" text="bind:RECIPE_TYPE" combodataset="ds_RecipeType" combocodecol="CD" combodatacol="NM"/>
                      <Cell col="11" displaytype="combo" style="align:left;background:white;background2:white;" text="bind:CUISINE_TYPE" combodataset="ds_CookClass" combocodecol="CD" combodatacol="NM"/>
                    </Band>
                  </Format>
                  <Format id="CAFETERIA">
                    <Columns>
                      <Column size="25"/>
                      <Column size="35"/>
                      <Column size="17"/>
                      <Column size="48"/>
                      <Column size="17"/>
                      <Column size="110"/>
                      <Column size="50"/>
                      <Column size="62"/>
                      <Column size="55"/>
                      <Column size="26"/>
                      <Column size="90"/>
                      <Column size="65"/>
                      <Column size="65"/>
                      <Column size="65"/>
                    </Columns>
                    <Rows>
                      <Row size="26" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell displaytype="text" class="head_Excel"/>
                      <Cell col="1" displaytype="text" text="구분"/>
                      <Cell col="2" colspan="2" displaytype="text" text="레시피코드"/>
                      <Cell col="4" colspan="2" displaytype="text" text="레시피명"/>
                      <Cell col="6" displaytype="text" text="원가"/>
                      <Cell col="7" displaytype="text" text="원가율(%)"/>
                      <Cell col="8" displaytype="text" text="판매가"/>
                      <Cell col="9" displaytype="text" text="H"/>
                      <Cell col="10" displaytype="text" text="선호도"/>
                      <Cell col="11" displaytype="text" text="레시피분류"/>
                      <Cell col="12" displaytype="text" text="레시피유형"/>
                      <Cell col="13" displaytype="text" text="조리법유형"/>
                    </Band>
                    <Band id="body">
                      <Cell displaytype="text" style="align:right;background:white;background2:white;" expr="expr:currow+1"/>
                      <Cell col="1" displaytype="text" style="align:center;background:white;background2:white;" text="bind:GUBUN"/>
                      <Cell col="2" colspan="2" style="align:left;background:white;background2:white;">
                        <Cell style="backgroundimage:EXPR(expr:iif(DI_MON==1,'ico_N',''));align:left;"/>
                        <Cell col="1" style="align:left;" text="bind:RECIPE_CD"/>
                      </Cell>
                      <Cell col="4" colspan="2" displaytype="text" style="align:left;background:white;background2:white;">
                        <Cell displaytype="text" style="backgroundimage:EXPR(iif(PHF=='Y','ico_P',''));align:left;"/>
                        <Cell col="1" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                      </Cell>
                      <Cell col="6" displaytype="number" style="align:right;background:white;background2:white;" text="bind:RECIPE_COST"/>
                      <Cell col="7" displaytype="number" style="align:right;background:white;background2:white;" text="bind:COST_RATE"/>
                      <Cell col="8" displaytype="number" style="align:right;background:white;background2:white;" text="bind:SALE_PRICE"/>
                      <Cell col="9" displaytype="image" style="align:center middle;background:white;background2:white;cursor:hand;" text="theme://Images/new/grd_WF_ExpandImage.png"/>
                      <Cell col="10" displaytype="text" style="align:left;background:white;background2:white;backgroundimage:EXPR(PREFER_LABEL);"/>
                      <Cell col="11" displaytype="combo" style="align:left;background:white;background2:white;" text="bind:RECIPE_CLASS" combodataset="ds_RecipeClass" combocodecol="CD" combodatacol="NM"/>
                      <Cell col="12" displaytype="combo" style="align:left;background:white;background2:white;" text="bind:RECIPE_TYPE" combodataset="ds_RecipeType" combocodecol="CD" combodatacol="NM"/>
                      <Cell col="13" displaytype="combo" style="align:left;background:white;background2:white;" text="bind:CUISINE_TYPE" combodataset="ds_CookClass" combocodecol="CD" combodatacol="NM"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
            </Layout>
          </Layouts>
        </Div>
        <Button id="btn_GiveCal" onclick="btn_GiveCal_OnClick" taborder="1" text="" position="absolute 162 20 184 41" class="btn_WF_cal" image="" userdata="me_GiveDay"/>
        <Static id="Static10" text="제공일" position="absolute 31 21 100 42" class="sta_WFSA_label"/>
        <Static id="Static1" text="끼니" position="absolute 215 21 284 42" class="sta_WFSA_label"/>
        <Static id="Static2" text="코너" position="absolute 395 21 455 42" class="sta_WFSA_label"/>
        <Static id="Static3" text="예상식수" position="absolute 593 21 661 42" class="sta_WFSA_label"/>
        <Static id="Static4" text="식단가" position="absolute 749 21 818 42" class="sta_WFSA_label"/>
        <Static id="Static6" text="식단특성" position="absolute 892 21 961 42" class="sta_WFSA_label"/>
        <MaskEdit id="me_GiveDay" mask="####-##-##" ontextchanged="me_GiveDay_OnChanged" taborder="2" trimtype="both" type="string" position="absolute 85 20 163 41"/>
        <Combo codecolumn="MEAL" datacolumn="MEAL_NAME" displayrowcount="10" id="cbo_DinGbn" index="0" innerdataset="@ds_Meal" onitemchanged="cbo_DinGbn_OnChanged" taborder="3" position="absolute 256 20 365 41"/>
        <Combo codecolumn="CORNER" datacolumn="CORNER_DETAIL_NAME" displayrowcount="10" id="cbo_CornGbn" index="0" innerdataset="@ds_Corner" onitemchanged="cbo_CornGbn_OnChanged" taborder="4" position="absolute 437 20 563 41"/>
        <Edit id="ed_Feature" imemode="hangul,full" taborder="7" position="absolute 958 20 1083 41" ontextchanged="ed_Feature_ontextchanged"/>
        <Combo codecolumn="CD" datacolumn="NM" id="cbo_CuisineClass" index="0" innerdataset="ds_CookClass" onkeydown="common_OnKeyDown" type="filter" taborder="14" position="absolute 30 143 196 164" displayrowcount="15"/>
        <Combo codecolumn="CD" datacolumn="NM" id="cbo_Item" index="0" innerdataset="ds_Material" onkeydown="common_OnKeyDown" type="filter" taborder="15" position="absolute 226 143 391 164" displayrowcount="15"/>
        <Combo codecolumn="CD" datacolumn="NM" id="cbo_Element" index="0" innerdataset="ds_Element" onkeydown="common_OnKeyDown" type="filter" taborder="16" position="absolute 421 143 580 164" displayrowcount="15"/>
        <MaskEdit enable="false" id="me_SalePfrom" onkeydown="common_OnKeyDown" taborder="19" position="absolute 330 169 405 190" oneditclick="me_SalePfrom_oneditclick" mask="###,###"/>
        <Static id="Static14" text="~" position="absolute 411 178 420 183"/>
        <MaskEdit enable="false" id="me_SalePto" onkeydown="common_OnKeyDown" taborder="20" position="absolute 426 169 502 190" mask="###,###"/>
        <CheckBox id="chk_StdRecipe" onclick="chk_RecipeGbn_OnClick" taborder="8" text="표준레시피" position="absolute 114 88 201 102" value="true" falsevalue="0" truevalue="1"/>
        <CheckBox id="chk_UpjangRecipe" onclick="chk_RecipeGbn_OnClick" taborder="9" text="업장표준레시피" position="absolute 203 88 305 102" value="true" falsevalue="0" truevalue="1"/>
        <Static id="Static41" text="원가" position="absolute 30 170 99 191" class="sta_WFSA_label"/>
        <MaskEdit id="me_UnitPfrom" onkeydown="common_OnKeyDown" taborder="17" position="absolute 73 169 148 190" mask="###,###"/>
        <Static id="Static12" text="~" position="absolute 153 177 162 182"/>
        <MaskEdit id="me_UnitPto" onkeydown="common_OnKeyDown" taborder="18" position="absolute 168 169 244 190" mask="###,###"/>
        <Static id="Static23" text="판매가" position="absolute 274 170 345 191" class="sta_WFSA_label"/>
        <Button id="btn_SubSearch" onclick="btn_SubSearch_OnClick" taborder="10" text="조회" position="absolute 529 168 580 190" class="btn_WF_Custom" image=""/>
        <Combo codecolumn="CD" datacolumn="NM" id="cbo_RecipeType" index="0" innerdataset="ds_RecipeType" onitemchanged="cbo_RecipeType_OnChanged" onkeydown="common_OnKeyDown" type="filter" taborder="13" position="absolute 421 117 580 138" displayrowcount="15"/>
        <Combo codecolumn="CD" datacolumn="NM" id="cbo_RecipeClass" index="0" innerdataset="ds_RecipeClass" onkeydown="common_OnKeyDown" type="filter" taborder="12" position="absolute 226 117 391 138" displayrowcount="15"/>
        <Combo codecolumn="NM" datacolumn="NM" id="cbo_RecipeNM" index="0" innerdataset="ds_RecipeNM" onkillfocus="cbo_RecipeNM_OnKillFocus" type="filter" taborder="11" position="absolute 30 117 196 138" ontextchanged="cbo_RecipeNM_ontextchanged" onkeydown="cbo_RecipeNM_onkeydown" displayrowcount="15" onitemchanged="cbo_RecipeNM_onitemchanged" userchange="0" userdata="" imemode="hangul"/>
        <Button id="btn_ibDateUpdate" onclick="btn_ibDateUpdate_OnClick" taborder="53" text="입고예정일 일괄수정" visible="false" position="absolute 988 421 1111 443" class="btn_WF_Custom" image=""/>
        <Button id="btn_MenuIns" onclick="btn_MenuIns_OnClick" taborder="54" text="기본정보저장" userdata="0" position="absolute 1113 20 1200 42" class="btn_WF_Custom" image=""/>
        <Button id="btn_NutReCalc" onclick="btn_NutReCalc_OnClick" taborder="55" text="영양소 재계산" tooltiptext="레시피 수정후 정확한 영양소를 보려면&#10;클릭하세요." visible="false" position="absolute 907 382 994 404" class="btn_WF_Custom" image=""/>
        <Button id="btn_Pop_Search" onclick="fn_Pop_Search" taborder="56" text="조회" position="absolute 980 80 1031 102" class="btn_WF_Custom" image=""/>
        <Button id="btn_Pop_Save" onclick="Common_Btn_common_OnClick" taborder="57" text="저장" position="absolute 1033 80 1084 102" class="btn_WF_Custom" image=""/>
        <Button id="btn_Pop_Delete" onclick="Common_Btn_common_OnClick" taborder="58" text="전체삭제" position="absolute 1086 80 1162 102" class="btn_WF_Custom" image=""/>
        <Button id="btn_Pop_Close" onclick="Common_Btn_common_OnClick" taborder="59" text="닫기" position="absolute 1164 80 1215 102" class="btn_WF_Custom" image=""/>
        <Static id="Static7" text="평균원가율" visible="true" position="absolute 638 422 777 443" class="sta_WFSA_Labelbg"/>
        <Button id="btn_CheapItem" onclick="btn_CheapItem_OnClick" taborder="63" text="저렴한자재찾기" position="absolute 1112 421 1215 443" class="btn_WF_Custom" image=""/>
        <Static id="Static11" text="입고창고 : " visible="false" position="absolute 440 88 505 106"/>
        <Static id="Static13" visible="false" position="absolute 200 89 504 109"/>
        <Static id="Static01" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 15 730"/>
        <Static id="Static16" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1185 10"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 15 20 30 41"/>
        <Static id="Static19" text="h06" onclick="Static12_onclick" class="Guide01_AreaRed" visible="false" position="absolute 15 51 1200 57" anchor="top right"/>
        <Static id="Static20" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 15 77 1215 82" onclick="Static20_onclick"/>
        <Static id="Static02" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1215 0 1230 730"/>
        <Static id="Static24" text="h10" onclick="Static04_onclick" class="Guide01_AreaRed" visible="false" position="absolute 15 10 1060 20"/>
        <Static id="Static26" text="글자간격기준 w10" onclick="Static11_onclick" class="Guide01_AreaRed" visible="false" position="absolute 75 20 85 41"/>
        <Static id="Static27" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 15 41 1060 51"/>
        <Static id="Static28" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1200 20 1215 41" onclick="Static28_onclick"/>
        <Static id="Static29" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 184 20 214 41"/>
        <Static id="Static30" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 246 20 256 41"/>
        <Static id="Static31" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 365 20 395 41"/>
        <Static id="Static32" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 427 20 437 41"/>
        <Static id="Static33" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 563 20 593 41"/>
        <Static id="Static34" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 652 20 662 41"/>
        <Static id="Static35" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 719 20 749 41"/>
        <Static id="Static36" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 795 20 805 41"/>
        <Static id="Static37" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 862 20 892 41"/>
        <Static id="Static38" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 949 20 959 41"/>
        <Static id="sta_WF_TitleLev01" text="레시피검색" class="sta_WF_Title01" position="absolute 15 89 110 107"/>
        <Static id="sta_WF_TitleLev00" text="식단구성" class="sta_WF_Title01" position="absolute 637 89 732 102" onclick="sta_WF_TitleLev00_onclick"/>
        <Static id="Static43" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 627 82 637 407"/>
        <Static id="Static44" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 595 82 605 407"/>
        <Static id="Static70" text="W10" visible="false" position="absolute 15 107 580 117" style="background:#ff000055;align:center middle;"/>
        <Static id="Static08" text="W10" visible="false" position="absolute 15 190 580 200" style="background:#ff000055;align:center middle;"/>
        <Static id="Static72" text="W15" visible="false" position="absolute 15 117 30 190" style="background:#ff000055;align:center middle;"/>
        <Static id="Static82" text="W05." visible="false" position="absolute 30 138 580 143" style="background:#ff000055;align:center middle;"/>
        <Static id="Static94" text="W05." visible="false" position="absolute 30 164 580 169" style="background:#ff000055;align:center middle;"/>
        <Static id="Static64" text="W30" visible="false" position="absolute 391 117 421 164" style="background:#ff000055;align:center middle;"/>
        <Static id="Static18" text="W30" visible="false" position="absolute 244 169 274 191" style="background:#ff000055;align:center middle;"/>
        <Static id="Static45" text="W30" visible="false" position="absolute 196 117 226 164" style="background:#ff000055;align:center middle;"/>
        <Static id="Static63" text="W10" visible="false" position="absolute 63 169 73 190" style="background:#ff000055;align:center middle;"/>
        <Static id="Static46" text="W10" visible="false" position="absolute 320 169 330 190" style="background:#ff000055;align:center middle;"/>
        <Static id="Static00" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 730 1230 740"/>
        <Static id="Static05" text="h05" onclick="Static20_onclick" class="Guide01_AreaRed" visible="false" position="absolute 15 102 1215 107"/>
        <Static id="Static15" text="W15" visible="false" position="absolute 580 107 595 200" style="background:#ff000055;align:center middle;"/>
        <Static id="Static21" text="h10" onclick="Static20_onclick" class="Guide01_AreaRed" visible="false" position="absolute 15 407 1215 417"/>
        <Static id="Static68" text="영양소는 저장 후 반영됩니다." class="sta_WF_DiscInfo" position="absolute 832 386 1070 401"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 1083 20 1113 41"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_GetDate"/>
      <Dataset id="ds_List"/>
      <Dataset id="ds_input"/>
      <Dataset id="ds_weather"/>
      <Dataset id="ds_RecipeNM"/>
      <Dataset id="ds_RecipeClass"/>
      <Dataset id="ds_RecipeType"/>
      <Dataset id="ds_CookClass"/>
      <Dataset id="ds_Material"/>
      <Dataset id="ds_Element"/>
      <Dataset id="ds_CutList"/>
      <Dataset id="ds_Hall_class"/>
      <Dataset id="ds_Corner"/>
      <Dataset id="ds_Meal"/>
      <Dataset id="ds_Menu" cancolumnchange="ds_Menu_CanColumnChange" oncolumnchanged="ds_Menu_OnColumnChanged"/>
      <Dataset id="ds_Const"/>
      <Dataset id="ds_Recipe"/>
      <Dataset id="ds_CookMethod"/>
      <Dataset id="ds_cond"/>
      <Dataset id="ds_phf" oncolumnchanged="ds_phf_OnColumnChanged"/>
      <Dataset id="ds_Item" cancolumnchange="ds_Item_CanColumnChange" oncolumnchanged="ds_Item_OnColumnChanged" onrowposchanged="ds_Item_OnRowPosChanged"/>
      <Dataset id="ds_RecipePhf"/>
      <Dataset id="ds_Chk"/>
      <Dataset id="ds_rCnt"/>
      <Dataset id="ds_iCnt"/>
      <Dataset id="ds_ValidData"/>
      <Dataset id="ds_subinv_name">
        <ColumnInfo>
          <Column id="SUBINV_NAME" size="256" prop="default" type="STRING"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="st_weather_value" compid="st_weather" propid="value" datasetid="ds_weather" columnid="W_INFO"/>
      <BindItem id="Static13_value" compid="Static13" propid="value" datasetid="ds_subinv_name" columnid="SUBINV_NAME"/>
      <BindItem id="item5" compid="sta_detail05" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item1" compid="ed_Feature" propid="visible" datasetid="ds_List" columnid=""/>
      <BindItem id="item2" compid="me_danga" propid="visible" datasetid="ds_List" columnid=""/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 메뉴관리>식단관리>식단등록>레시피검색및 등록
 * 프로그램명   : FSM00060E.XML
 * 기      능   : 레시피검색및 등록
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071226 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *            : 1)박은규 2009-01-14 CSR#(25617) 요청자:이명희(건강관리센터)
 *                저렴한 자재찾기 기능 추가
                2)박은규 2012-11-05 CSR#(CH201210_00143) 요청자:박현정(FS기획팀)
                  -3일~ 는 무조건 예상식수 수정가능
 ******************************************************************************************
 */
//******************************************************************************************(90)
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//******************************************************************************************
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"		
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"		
//@@컨버터에서 주석처리 #include "LIB::lib_Date.js"		
//******************************************************************************************
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//******************************************************************************************
/*

<레시피검색및 등록>
	UPJANG,	HALL_CD, FROM_DT, TO_DT(업장코드,식당코드,시작일,종료일)
	MEAL,	CORNER,  MENU_DATE     (끼니,코너,제공일)

*/
// var fa_UPJANG="";
// var fa_HALL_CD="";
// var fa_FROM_DT="";
// var fa_TO_DT="";
// var fa="";
// var fa_CORNER="";
// var fa_MENU_DATE="";//cur_date
// var fs_MENU_CD="";

//  원가 문제로 창고 코드 추가 시킴
// var fa_SUBINV_CODE="";
var sort=true;
var setRecipecd="";
var v_CurRecipenm="";
var v_CurRecipecd="";
var v_CurCuisineType="";
var v_gbn=1;
var v_lod="lod";

var v_bln=true;		// 식단 레시피추가 유효성 체크시 서비스 오류 구분값
var v_SearchGbn=true;
// 식단구성 전체선택/해제에 쓰일 변수
var f_Chk = 1;


var iW=''; 

//******************************************************************************************
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//******************************************************************************************
 
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	fsp_init(this); 

	// fa_UPJANG="100771";
	// fa_HALL_CD="00101";
	// fa_FROM_DT="20071118";
	// fa_TO_DT="20080501";
	// fa_MEAL="001";
	// fa_CORNER="001";
	// fa_MENU_DATE="20071123";//cur_date
	// fs_MENU_CD=fa_MENU_DATE+"-"+fa_HALL_CD+fa_MEAL+fa_CORNER;
	
	
	
// 	trace('fa_UPJANG    => ' + fa_UPJANG   );
// 	trace('fa_HALL_CD   => ' + fa_HALL_CD  );
// 	trace('fa_MEAL      => ' + fa_MEAL     );
// 	trace('fa_CORNER    => ' + fa_CORNER   );
// 	trace('fa_MENU_DATE => ' + fa_MENU_DATE); 
// 	trace('fa_FROM_DT   => ' + fa_FROM_DT  ); 
// 	trace('fa_TO_DT     => ' + fa_TO_DT    ); 
 
	fsp_clear(this);
	//오늘 날짜
	ds_GetDate.clearData();
	fsp_addSearch(this,"sc/scc:SCC_TODAY");
	fsp_callService(this,"","","","ds_GetDate=ds_GetDate","","fn_callBack_getDate","",true);

	fsp_clear(this);
	// 레시피명
	ds_RecipeNM.clearData();
	fsp_addSearch(this,"fs/fsr:FSR00010E_S001");
	fsp_callService(this,"","","","ds_RecipeNM=ds_RecipeNM","","fn_callBack_RcipeNm","",true);

	fsp_clear(this);
	// 레시피분류
	ds_RecipeClass.clearData();
	//tit_addSearchActionInfo(this,"fs/fsr:FSR00010E_S002");
	fsp_addSearch(this,"fs/fsm:FSM00060E_S010");	// 업장별 사용레시피분류
	fsp_callService(this,"","","","ds_RecipeClass=ds_RecipeClass","UPJANG="+fa_UPJANG,"fn_callBack_RecipeClass","",true);

	fsp_clear(this);
	// 레시피유형
	ds_RecipeType.clearData();
	fsp_addSearch(this,"fs/fsr:FSR00010E_S003");
	fsp_callService(this,"","","","ds_RecipeType=ds_RecipeType","","fn_callBack_RecipeType","",true);

	fsp_clear(this);  
	// 조리법유형
	ds_CookClass.clearData();
	fsp_addSearch(this,"fs/fsr:FSR00010E_S004");
	fsp_callService(this,"","","","ds_CookClass=ds_CookClass","","fn_callBack_CookClass","",true);
	
	fsp_clear(this);
	// 주재료군
	ds_Material.clearData();
	fsp_addSearch(this,"fs/fsr:FSR00010E_S005");
	fsp_callService(this,"","","","ds_Material=ds_Material","","fn_callBack_Material","",true);	

	fsp_clear(this);
	// 대표영양성분
	ds_Element.clearData();
	fsp_addSearch(this,"fs/fsr:FSR00010E_S006");
	fsp_callService(this,"","","","ds_Element=ds_Element","","fn_callBack_Element","",true);

	fsp_clear(this);
	// 커팅규격
	http.Sync = true;
	ds_CutList.clearData();
	fsp_addSearch(this,"fs/fsr:FSR00010E_S022");
	fsp_callService(this,"","","","ds_CutList=ds_CuttingList","","fn_callBack_CuttingList","",true);
	if( ds_CutList.getRowCount() > 0 ) {
		ds_CutList.insertRow(0);
		ds_CutList.setColumn(0, "DETAIL_CODE", "");
		ds_CutList.setColumn(0, "DETAIL_NAME", "");
	}
	http.Sync = false;

	// 창고명
	http.Sync = true;
	
	ds_input.clear();
	ds_input.addColumn("UPJANG","BIGDECIMAL",256);
	ds_input.addColumn("HALL_CD","STRING",256);
	ds_input.addRow();
	ds_input.setColumn(0,"UPJANG",fa_UPJANG);
	ds_input.setColumn(0,"HALL_CD",fa_HALL_CD);
		
	ds_subinv_name.clearData();
	fsp_addSearch(this,"fs/fsm:FSM00060E_S011");
	fsp_callService(this,"","","","ds_subinv_name=ds_subinv_name","","fn_callBack_SubInvNm","",true);
	http.Sync = false;
	
	////////////////////////////
	/// 병원구성요소 http.Sync = true;
	//  2008-06-11 박종세 수정
	////////////////////////////
	http.Sync = true;
	fsp_clear(this);
	// 병원구성요소(식단구성)
	ds_Const.clearData();
	fsp_addSearch(this,"fs/fsm:FSM00060E_S007");
	fsp_callService(this,"","","","ds_Const=ds_Const","","fn_callBack_Const","",true);
	http.Sync = false;
	

	if(gfn_length(gfn_trim(fa_UPJANG))==0)
	{
		g_Message("EE",fn_AlertMsg("010"));
		return;
	}
	if(gfn_length(gfn_trim(fa_HALL_CD))==0)
	{
		g_Message("EE",fn_AlertMsg("011"));
		return;
	}
	if(gfn_length(gfn_trim(fa_FROM_DT))==0)
	{
		g_Message("EE",fn_AlertMsg("027"));
		return;
	}
	if(gfn_length(gfn_trim(fa_TO_DT))==0)
	{
		g_Message("EE",fn_AlertMsg("027"));
		return;
	}
	if(gfn_length(gfn_trim(fa_MEAL))==0)
	{
		g_Message("EE",fn_AlertMsg("014"));
		return;
	}

	if(gfn_length(gfn_trim(fa_CORNER))==0)
	{
		g_Message("EE",fn_AlertMsg("015"));
		return;
	}
	if(gfn_length(gfn_trim(fa_MENU_DATE))==0)
	{
		g_Message("EE",fn_AlertMsg("013"));
		return;
	}	
	me_GiveDay.value=fa_MENU_DATE;
	
//	*********업장정보 받아가기***********
	ds_input.clear();
 	ds_input.addColumn("CUR_DATE","STRING",256);
	ds_input.addColumn("UPJANG","BIGDECIMAL",256);
	ds_input.addColumn("HALL_CD","STRING",256);
	ds_input.addRow();
	ds_input.setColumn(0,"CUR_DATE",fa_MENU_DATE);
	ds_input.setColumn(0,"UPJANG",fa_UPJANG);
	ds_input.setColumn(0,"HALL_CD",fa_HALL_CD);
// ***************************************	
	http.Sync=true;
	fsp_clear(this);
	ds_GetDate.clearData();
	ds_weather.clearData(); 
	fsp_addSearch(this,"sc/scc:SCC_TODAY");		// 당일 날짜
	fsp_addSearch(this,"fs/fsm:FSM00060E_S001");  // 날씨정보 
	fsp_callService(this,"","",
					"ds_input=ds_input",
					"ds_GetDate=ds_GetDate ds_weather=ds_weather",
					"",
					"fn_callBack_HallClass",
					"",
					true);
	http.Sync=false; 
	
	
    http.Sync=true;
	fsp_clear(this); 
	ds_Hall_class.clearData() 
	fsp_addSearch(this,"fs/fsm:FSM00060E_S003");	// 식당군조회 ds_Hall_class
 
	fsp_callService(this,"","",
					"ds_input=ds_input",
					"ds_Hall_class=ds_Hall_class",
					"",
					"fn_callBack_HallClass2",
					"",
					true);
	http.Sync=false;
	
}

function fn_callBack_getDate(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{	
		 
	}
}

function fn_callBack_RcipeNm(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{	
	     
		if(gfn_length(gfn_trim(setRecipecd))>0)
		{
			var strRow=ds_Menu.findRow("RECIPE_CD",setRecipecd);
			//trace(setRecipecd);
			//trace(strRow);
			ds_Menu.rowposition=strRow;
			setRecipecd="";
		}
		
		cbo_RecipeNM.index = 0;
		
	}
}

function fn_callBack_RecipeClass(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{	
		 ds_RecipeClass.filter("CD!='H'");
		 
		 cbo_RecipeClass.index = 0;
	}
}

function fn_callBack_RecipeType(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{	
		 ds_RecipeType.filter("SET1!='Y'");
		 
		 cbo_RecipeType.index = 0;
		 
	}
}

function fn_callBack_CookClass(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{	
		 cbo_CuisineClass.index = 0;
	}
}

function fn_callBack_Material(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{	
		 cbo_Item.index = 0;
	}
}
 

function fn_callBack_Element(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{	
		 cbo_Element.index = 0;
	}
}
 

function fn_callBack_CuttingList(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{	
		 
	}
}

function fn_callBack_SubInvNm(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{	
		 
	}
}

function fn_callBack_Const(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{	
		 
	}
}

function fn_callBack_HallClass(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{	
	
 
            wIcon = gfn_nvl(ds_weather.getColumn(0,"W_IMAGE"));
 
        
        if(!gfn_isNull(wIcon)) {
        
             iW = "URL('theme://convertImages/" + ds_weather.getColumn(0,"W_IMAGE") + ".png";
		} else {
		     iW = '';
		}
		img_Weather.image=iW; 
		
		st_weather.text = gfn_nvl(ds_weather.getColumn(0,"W_INFO")); 
		
	}
}
 
function fn_callBack_HallClass2(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{	 
	
// 	    trace('ds_Hall_class');
// 	    trace(ds_Hall_class.saveXML());
		
		//fa_SUBINV_CODE=ds_Hall_class.getColumn(0,"SUBINV_CODE"); 
		
		if(ds_Hall_class.getColumn(0,"HALL_CLASS")=="005" )	// 카페테리아 
			{
				// 레시피검색 판매가  조건 사용유무
				me_SalePfrom.enable=true; 
				me_SalePto.enable=true;
				grd_RealRecipe.formatid="SS_CAFETERIA";
				//trace("카페테리아");
				div_extend.grd_List.formatid="CAFETERIA";	// 카페테리아
				me_danga.visible=false;	// 식단가 카페테리아는 이용하지 않습니다.
				Static7.visible=true;	// 평균원가율 사용
				btn_Nut.visible=false;	// 카페테리아는 합계가 없어서 사용못함
			}
			else
			{
				me_SalePfrom.enable=false;
				me_SalePto.enable=false;
				me_danga.visible=true;		// 식단가 카페테리아이외 사용
				Static7.visible=false;			// 평균원가율 미사용
				btn_Nut.visible=true;			// 카페테리아 잉외 사용
				div_extend.grd_List.formatid="Default";  // 카페테리아 이외
				if(ds_Hall_class.getColumn(0,"HALL_CLASS")=="007" 	||
					ds_Hall_class.getColumn(0,"HALL_CLASS")=="008" 	||
					ds_Hall_class.getColumn(0,"HALL_CLASS")=="009"		)	// 병원 
				{
					grd_RealRecipe.formatid="SS_HOSPITAL";
					//trace("병원");
				}
				else
				{
					grd_RealRecipe.formatid="SS_ETC";							// 카페테리아 병원 이외 식당군
					//trace("카페테리아 병원 이외 식당군");
				}
			}
			if(gfn_length(gfn_trim(ds_Hall_class.getColumn(0,"RECIPE_CLASS")))>0)
			{
				cbo_RecipeClass.value=gfn_trim(ds_Hall_class.getColumn(0,"RECIPE_CLASS"));
			}
 
			fn_Meal();		
		
		
	}
}

function fn_callBack_Meal(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
 
		// if(ds_Meal.RowCount()>0)
		// {	//끼니 조회후 코너 조회
			if(v_gbn==1)
			{
				cbo_DinGbn.value=fa_MEAL;
			}
			fn_Corner();
		// }
		
	}
}
function fn_callBack_Corner(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{	
	
	   //trace(ds_Corner.saveXML());
	
		if(v_gbn==1)
		{
			cbo_CornGbn.value=fa_CORNER;
			v_gbn=0;
		}
		cbo_CornGbn_OnChanged();

		if(v_lod=="lod")
		{
			fn_Pop_Search(); 
			v_lod="";  
		}
//		g_debug("ds_Corner");
//		fn_Pop_Search("load");
	}
}
//콜백 프로세스 처리
function fn_call_back(cd,errmsg)
{
	if(cd!=0) 
	{
		return;
	}
	else
	{
		if(gfn_length(gfn_trim(setRecipecd))>0)
		{
			var strRow=ds_Menu.findRow("RECIPE_CD",setRecipecd);
			//trace(setRecipecd);
			//trace(strRow);
			ds_Menu.rowposition=strRow;
			setRecipecd="";
		}
	}	
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Pop_Search()
 * 입      력   : 검색조건
 * 반      환   : 없음
 * 기      능   : 사용자 등록정보
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071226
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function fn_Pop_Search(str)
{
	if(v_SearchGbn==false)
	{
		v_SearchGbn=true;
		return;
	}
	if(btn_MenuIns.userdata==1)
	{
		g_Message("EE","메뉴 정보가 갱신 되었습니다.\n\n저장후 작업하세요.");
		return;
	}
	if(gfn_dsIsUpdated(ds_Menu)==true ||
		gfn_dsIsUpdated(ds_Item)==true)
	{
		if(g_Confirm("02",fn_AlertMsg("028"))==true)
		{
			fn_Pop_Save("BTN_SAVE");
			return;
		}
	}
	tab_main.tabindex=0;
	ds_Menu.clearData();
	ds_Item.clearData();
	ds_RecipePhf.clearData();
	ds_phf.clearData();
	ds_CookMethod.clearData();
	

	if(str!="load")
	{
		if(gfn_length(gfn_trim(cbo_DinGbn.value))==0)
		{
			g_Message("EE",fn_AlertMsg("014"));
			return;
		}
		if(gfn_length(gfn_trim(cbo_CornGbn.value))==0)
		{
			g_Message("EE",fn_AlertMsg("015"));
			return;
		}
		if(gfn_length(gfn_trim(me_Cnt.value))==0)
		{
			g_Message("EE",fn_AlertMsg("016"));
			return;
		}
	}
	else
	{
		if(gfn_length(gfn_trim(cbo_DinGbn.value))==0)
		{
			return;
		}
		if(gfn_length(gfn_trim(cbo_CornGbn.value))==0)
		{
			return;
		}
		if(gfn_length(gfn_trim(me_Cnt.value))==0)
		{
			return;
		}
	}

	// if(ds_Menu.GetUpdate()==true ||
		// ds_Item.GetUpdate()==true)
	// {
		// if(g_Confirm("02",fn_AlertMsg("028"))==true)
		// {
			// fn_Pop_Save("BTN_SAVE");
		// }
	// }	
	var arg="";
	
	arg		="UPJANG="		+wrapQuote(fa_UPJANG)
			+" HALL_CD="	+wrapQuote(fa_HALL_CD)
			+" SUBINV_CODE="+wrapQuote(fa_SUBINV_CODE)
			+" MEAL="		+wrapQuote(cbo_DinGbn.value)
			+" CORNER="		+wrapQuote(cbo_CornGbn.value)
			+" MENU_DATE="	+wrapQuote(me_GiveDay.value);
	fsp_clear(this);
	fsp_addSearch(this,"fs/fsm:FSM00060E_S006");
	http.Sync=true;
	fsp_callService(this,"","","","ds_Menu=ds_Menu",arg,"fn_call_back");
	http.Sync=false;

	if(ds_Hall_class.getColumn(0,"HALL_CLASS")=="005" || fa_HALL_CLASS == "005")	// 카페테리아 
	{
		var tot_Cost=ds_Menu.getSum("TOT_COST");
		var tot_Sale=ds_Menu.getSum("TOT_SALE");
		var avgCostRate=0;
		if(toNumber(tot_Sale)==0)
		{
			avgCostRate=0;
		}
		else
		{
			avgCostRate=gfn_nvl(Math.round((tot_Cost/tot_Sale)*100,1),0);
		}
		Static7.text="평균 원가율 :   "+avgCostRate+" %  ";
	}
	
	//식단구성에 메뉴가 있으면 조회 아니면 데이터 정합성 검사를 한다.
	//레시피는 없는데 아이템에 데이터가 있는 경우(반대의 경우도 체크)
	//아마도 레시피를 작성하고 아이템을 넣었는데 아이템은 안지우고
	//레시피만 지웠을 경우라는 생각이 듬.
	//레시피 지울때 아이템도 지워주는데 왜 이렇게 데이터가 셀까?
	if(ds_Menu.getRowCount()>0)
	{
		tab_main.tab0.fn_T1_Search(); 
	}
	else
	{
		var arg	="UPJANG="		+wrapQuote(fa_UPJANG)
				+" HALL_CLASS="	+wrapQuote(ds_Hall_class.getColumn(0,"HALL_CLASS"))
				+" RECIPE_CD="	+wrapQuote(ds_List.getColumn(ds_List.rowposition,"RECIPE_CD"))
				+" NEED_DATE="	+wrapQuote(me_GiveDay.value)
				+" SUBINV_CODE="+wrapQuote(fa_SUBINV_CODE)
				+" HALL_CD="	+wrapQuote(fa_HALL_CD)
				+" MEAL="		+wrapQuote(cbo_DinGbn.value)
				+" CORNER="		+wrapQuote(cbo_CornGbn.value)
				+" MENU_CD="	+wrapQuote(me_GiveDay.value+"-"+fa_HALL_CD+cbo_DinGbn.value+cbo_CornGbn.value);  // quote(fa_MENU_DATE+"-"+fa_HALL_CD+cbo_DinGbn.Value+cbo_CornGbn.Value);

		ds_ValidData.clearData();
		http.Sync=true;
		Transaction("FSM00060E","U_svc::" + "fs/fsm/FSM00060E_S003.jsp","","ds_ValidData=ds_ValidData",arg,"fn_Call_Back_Valid");
		http.Sync=false;
		if(ds_ValidData.getRowCount() > 0)
		{
			g_Message("EE","선택하신 식단(레시피) 정보가 정상적이지 않습니다.\n\n작업을 중지하시고 전산 담당자에게 \n\n해당 식단 점검을 요청하세요.");
			//this.Close();
			return;
		}
	}
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Pop_Save()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 저장
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071226
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function fn_Pop_Save(str)
{
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	var searchsql,insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql;
	var searchsql,insertSql2, updateSql2, deleteSql2;
	var searchsql,insertSql3, updateSql3, deleteSql3;	
	switch(str)
	{
		case "ICO_RECIPE_DEL":	// x아이콘 레시피
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_Menu=ds_Menu:U ds_Item=ds_Item:U";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "";
			insertSql2 	= "";
			insertSql3 	= "";			
			updateSql1	= "";
			updateSql2	= "";			
			updateSql3	= "";
			deleteSql1	= "fs/fsm:FSM00060E_D001";
			deleteSql2	= "fs/fsm:FSM00060E_D002";
			deleteSql3	= "fs/fsm:FSM00060E_D003";
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			fsp_addSave(this, insertSql2, updateSql2, deleteSql2,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			fsp_addSave(this, insertSql3, updateSql3, deleteSql3,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);
			break;
		case "ICO_ITEM_DEL":	// x아이콘 자제
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_Menu=ds_Menu:U ds_Item=ds_Item:U";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "";
			insertSql2 	= "";
			insertSql3 	= "";			
			updateSql1	= "";
			updateSql2	= "";			
			updateSql3	= "";
			deleteSql1	= "fs/fsm:FSM00060E_D001";
			deleteSql2	= "fs/fsm:FSM00060E_D002";
			deleteSql3	= "fs/fsm:FSM00060E_D003";
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			fsp_addSave(this, insertSql2, updateSql2, deleteSql2,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			fsp_addSave(this, insertSql3, updateSql3, deleteSql3,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			http.Sync=true;
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);
			http.Sync=false;
			//fn_Pop_Search();
			break;
		case "COOK":	// 조리법저장
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_CookMethod=ds_CookMethod:U";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "fs/fsm:FSM00060E_I001";			
			updateSql1	= "fs/fsm:FSM00060E_U001";
			deleteSql1	= "fs/fsm:FSM00060E_D004";
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);		
			break;	
		case "PHF":	// PHF관리 업데이트
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_RecipePhf=ds_RecipePhf:U";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "";			
			updateSql1	= "fs/fsm:FSM00060E_U002";
			deleteSql1	= "";
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);		
			break;								
		case "BTN_DEL":	// 삭제 버튼(식단 삭제)
			fsp_clear(this);
			
			otherArg	="UPJANG="		+wrapQuote(fa_UPJANG)
						+" MENU_CD="	+wrapQuote(ds_Menu.getColumn(0,"MENU_CD"));
			
			inData		= "";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "";
			insertSql2 	= "";
			insertSql3 	= "";
			updateSql1	= "";
			updateSql2	= "";			
			updateSql3	= "";
			deleteSql1	= "fs/fsm:FSM00060E_D005";
			deleteSql2	= "fs/fsm:FSM00060E_D006";	
			deleteSql3	= "fs/fsm:FSM00060E_D007";
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSingle(this, deleteSql1);
			fsp_addSingle(this, deleteSql2);
			fsp_addSingle(this, deleteSql3);
			http.Sync=true;
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);	
			http.Sync=false;
			
			tab_main.tabindex=0;
			ds_Menu.clearData();
			ds_Item.clearData();
			ds_RecipePhf.clearData();
			ds_phf.clearData();
			ds_CookMethod.clearData();	
			
			fn_Pop_Search();
			break;	
		case "BTN_SAVE":	// 저장 버튼
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_Menu=ds_Menu:U ds_Item=ds_Item:U";
			//trace(ds_Item.SaveXML());
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "";
			insertSql2 	= "";
			if(ds_Hall_class.getColumn(0,"HALL_CLASS")=="005")	// 카페테리아 
			{
				if(ds_Menu.findRowExpr("SALE_PRICE==0 || SALE_PRICE=='' || EXPECT_SALE_QTY==0 || EXPECT_SALE_QTY==''")!=-1)
				{
					g_Message("EE","판매가 혹은 예상판매량은 필수 입력입니다.");
					return;
				}
				updateSql1	= "fs/fsm:FSM00060E_U003";
			}
			else 												// 그외 
			{
				updateSql1	= "fs/fsm:FSM00060E_U004";
			}
			updateSql2	= "fs/fsm:FSM00060E_U005";			
			deleteSql1	= "";
			deleteSql2	= "";	
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			fsp_addSave(this, insertSql2, updateSql2, deleteSql2,saveFlagColumn, keySqlName, keyIncrement, callbackSql);			
			http.Sync=true;
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);	
			http.Sync=false;
			// ===>조리법 저장
			if(gfn_dsIsUpdated(ds_CookMethod)==true)
			{
				if(ds_CookMethod.findRowExpr("gfn_length(gfn_trim(CUISINE_DESC))==0 || gfn_trim(CUISINE_DESC)==null")!=-1)
				{
					//alert(fn_AlertMsg("016"));
					g_Message("EE", fn_AlertMsg("021"));
					return false;
				}
				var v_max=ds_CookMethod.getMax("CUISINE_SEQ");
				if( gfn_trim(v_max)==null || gfn_length(gfn_trim(v_max))==0 )
				{
					v_max=0;
				}
				for(i=0;i<ds_CookMethod.getRowCount();i++)
				{
					if(gfn_length(gfn_trim(ds_CookMethod.getColumn(i,"CUISINE_SEQ")))==0
							|| gfn_trim(ds_CookMethod.getColumn(i,"CUISINE_SEQ"))==null )
					{
						v_max=v_max+1;
						ds_CookMethod.setColumn(i,"CUISINE_SEQ",v_max);
					}
					
				}
			}
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_CookMethod=ds_CookMethod:U";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "fs/fsm:FSM00060E_I001";			
			updateSql1	= "fs/fsm:FSM00060E_U001";
			deleteSql1	= "fs/fsm:FSM00060E_D004";
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			http.Sync=true;
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);			
			http.Sync=false;
			// ===>phf 저장
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_RecipePhf=ds_RecipePhf:U";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "";			
			updateSql1	= "fs/fsm:FSM00060E_U002";
			deleteSql1	= "";
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			http.Sync=true;
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);	
			http.Sync=false;
			
			fn_Pop_Save("CHK_CONSTRUCT");
			break;
		case "BTN_CREATE":	// 신규레시피추가 생성
			break;								
		case "CHK_CONSTRUCT":	// 식단구성 구축 체크(구축이면 기존 업장표준데이타 일괄삭제후 실제 식단 레시피로 일괄대체합니다.
			// grd_RealRecipe.Redraw=false;
			// ds_Menu.Filter("CREAT==1");
			var arg="";
			for(i=0;i<ds_Menu.getRowCount();i++)
			{
				if(ds_Menu.getColumn(i,"CREAT")==1)
				{
					arg		="UPJANG="		+wrapQuote(ds_Menu.getColumn(i,"UPJANG"))
							+" HALL_CLASS="	+wrapQuote(ds_Hall_class.getColumn(0,"HALL_CLASS"))
							+" RECIPE_CD="	+wrapQuote(ds_Menu.getColumn(i,"RECIPE_CD"))
							+" MENU_CD="	+wrapQuote(ds_Menu.getColumn(i,"MENU_CD"));
							
					fsp_clear(this);
					ds_Chk.clearData();
					fsp_addSearch(this,"fs/fsm:FSM00060E_S009");
					http.Sync=true;
					fsp_callService(this,"","","","ds_Chk=ds_Chk",arg,"fn_call_back","",true);
					http.Sync=false;
					// 일괄삭제
					inData		= "";
					outData		= "";
					callBackFnc	= "";
					insertSql1 	= "";
					insertSql2 	= "";
					updateSql1	= "";
					updateSql2	= "";			
					deleteSql1	= "fs/fsm:FSM00060E_D008";
					deleteSql2	= "fs/fsm:FSM00060E_D009";
					deleteSql3	= "fs/fsm:FSM00060E_D010";	
					keyIncrement= -1;
					callbackSql	= "";
					
					fsp_addSingle(this, deleteSql1);
					fsp_addSingle(this, deleteSql2);
					fsp_addSingle(this, deleteSql3);
					
					http.Sync=true;
					fsp_callService(this, "", "", inData, outData, arg, callBackFnc);	
					http.Sync=false;
					
					fsp_clear(this);

					// insert
					inData		= "";
					outData		= "";
					callBackFnc	= "";
					insertSql1 	= "fs/fsm:FSM00060E_I002";
					insertSql2 	= "fs/fsm:FSM00060E_I003";
					insertSql3 	= "fs/fsm:FSM00060E_I004";
					keyIncrement= -1;
					callbackSql	= "";
					fsp_addSingle(this, insertSql1);
					fsp_addSingle(this, insertSql2);
					fsp_addSingle(this, insertSql3);
					http.Sync=true;
					fsp_callService(this, actionName, cmdName, inData, outData, arg, callBackFnc);
					http.Sync=false;
				}
			}
			fn_Pop_Search();
			// ds_Menu.UnFilter();
			// grd_RealRecipe.Redraw=true;
			break;
		case "CREATE_REAL":
			var arg	="UPJANG="		+wrapQuote(fa_UPJANG)
					+" HALL_CLASS="	+wrapQuote(ds_Hall_class.getColumn(0,"HALL_CLASS"))
					+" RECIPE_CD="	+wrapQuote(ds_List.getColumn(ds_List.rowposition,"RECIPE_CD"))
					+" NEED_DATE="	+wrapQuote(me_GiveDay.value)
					+" SUBINV_CODE="+wrapQuote(fa_SUBINV_CODE)
					+" HALL_CD="	+wrapQuote(fa_HALL_CD)
					+" MEAL="		+wrapQuote(cbo_DinGbn.value)
					+" CORNER="		+wrapQuote(cbo_CornGbn.value)
					+" MENU_CD="	+wrapQuote(me_GiveDay.value+"-"+fa_HALL_CD+cbo_DinGbn.value+cbo_CornGbn.value);  // quote(fa_MENU_DATE+"-"+fa_HALL_CD+cbo_DinGbn.Value+cbo_CornGbn.Value);

			ds_ValidData.clearData();
			http.Sync=true;
			Transaction("FSM00060E","U_svc::" + "fs/fsm/FSM00060E_S003.jsp","","ds_ValidData=ds_ValidData",arg,"fn_Call_Back_Valid");
			http.Sync=false;
			if(ds_ValidData.getRowCount() > 0)
			{
				g_Message("EE","선택하신 식단(레시피) 정보가 정상적이지 않습니다.\n\n작업을 중지하시고 전산 담당자에게 \n\n해당 식단 점검을 요청하세요.");
				//this.Close();
				return;
			}
			if(gfn_trim(ds_List.getColumn(ds_List.rowposition,"GUBUN"))=="업장")
			{
				ds_rCnt.clearData();
				ds_iCnt.clearData();
				http.Sync=true;
				Transaction("FSM00060E","U_svc::" + "fs/fsm/FSM00060E_S001.jsp","","ds_rCnt=ds_rCnt ds_iCnt=ds_iCnt",arg,"fn_Call_Back_Valid");
				http.Sync=false;
			}
			else
			{
				ds_rCnt.clearData();
				ds_iCnt.clearData();
				http.Sync=true;
				Transaction("FSM00060E","U_svc::" + "fs/fsm/FSM00060E_S002.jsp","","ds_rCnt=ds_rCnt ds_iCnt=ds_iCnt",arg,"fn_Call_Back_Valid");
				http.Sync=false;			
			}
			//trace("레시피 유효성 체크==>"+ds_rCnt.getRowCount()+"/"+ds_iCnt.getRowCount());
			// 비정상적인 데이타체크후 작업중지
			if(!v_bln)
			{
				return;
			}
			if(ds_rCnt.getRowCount()==0 || ds_iCnt.getRowCount()==0)
			{
				g_Message("EE","데이터가 정상적이지 않습니다.\n\n작업을 중지하시고 전산 담당자에게 해당 레시피 점검을 요청하세요.");
				return;
			}
			
			
			fsp_clear(this);
			if(gfn_trim(ds_List.getColumn(ds_List.rowposition,"GUBUN"))=="업장")
			{
				inData		= "";
				outData		= "";
				callBackFnc	= "fn_call_goRecipecd";
				insertSql1 	= "fs/fsm:FSM00060E_I008";
				insertSql2 	= "fs/fsm:FSM00060E_I009";
				insertSql3 	= "fs/fsm:FSM00060E_I010";
				keyIncrement= -1;
				callbackSql	= "";
				fsp_addSingle(this, insertSql1);
				fsp_addSingle(this, insertSql2);
				fsp_addSingle(this, insertSql3);
				http.Sync=true;
				fsp_callService(this, actionName, cmdName, inData, outData, arg, callBackFnc);
				http.Sync=false;			
			}
			else
			{
				inData		= "";
				outData		= "";
				callBackFnc	= "fn_call_goRecipecd";
				insertSql1 	= "fs/fsm:FSM00060E_I005";
				insertSql2 	= "fs/fsm:FSM00060E_I006";	
				insertSql3 	= "fs/fsm:FSM00060E_I007";
				keyIncrement= -1;
				callbackSql	= "";
				fsp_addSingle(this, insertSql1);
				fsp_addSingle(this, insertSql2);
				fsp_addSingle(this, insertSql3);
				http.Sync=true;
				fsp_callService(this, actionName, cmdName, inData, outData, arg, callBackFnc);
				http.Sync=false;			
			}
			fn_Pop_Search();
		
			break;
	}
}
function fn_call_goRecipecd(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
		//setRecipecd
		
	}
}
function fn_Call_Back_Valid(svcid,cd,errmsg)
{
	if(cd!=0)
	{
		v_bln=false;
		g_Message("EE","레시피 유효성 점검중 서비스 오류가 발생했습니다.\n레시피 추가 작업이 중지됩니다.\n\n전산 담당자에게 문의하세요.");
		return;
	}
	else
	{
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Pop_Delete()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 삭제
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071226
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function fn_Pop_Delete()
{
//	if(ds_Menu.RowCount()==0)
//	{
//		return;
//	}
	if(g_Confirm("01",fn_AlertMsg("025"))==true)
	{
		fn_Pop_Save("BTN_DEL");
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Pop_Close()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 화면닫기
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071226
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function fn_Pop_Close()
{
	if(gfn_dsIsUpdated(ds_Menu)==true ||
		gfn_dsIsUpdated(ds_Item)==true)
	{
		if(g_Confirm("02",fn_AlertMsg("028"))==true)
		{
			fn_Pop_Save("BTN_SAVE");
			return;
		}
	}	
	this.close();
}
/******************************************************************************************
 * 함  수  명   : fn_AlertMsg(cd)
 * 입      력   : 메시지 코드
 * 반      환   : 메세지 텍스트
 * 기      능   : 메시지 처리
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071226
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */

function fn_Meal()
{
	fn_Clear();
//  --식수 예측되지 않은 끼니코너 제거는 식단 등록에서만 합니다.
//  ====>표준기간식단및 카페테리아 식단은 식수예측 체크하지 말것
//  카페테리아 코드 005
//	*********업장정보 받아가기***********
	ds_input.clear();
//	ds_input.addColumn("CUR_DATE","STRING",256);
	ds_input.addColumn("UPJANG","BIGDECIMAL",256);
	ds_input.addColumn("HALL_CD","STRING",256);
	ds_input.addColumn("MEAL","STRING",256);
	ds_input.addColumn("CORNER","STRING",256);
	ds_input.addColumn("HALL_CLASS","STRING",256);
	ds_input.addRow();
//	ds_input.setColumn(0,"CUR_DATE",gfn_trim(me_GiveDay.value));//제공일
	ds_input.setColumn(0,"UPJANG",fa_UPJANG);
	ds_input.setColumn(0,"HALL_CD",fa_HALL_CD);
	ds_input.setColumn(0,"MEAL","");
	ds_input.setColumn(0,"CORNER","");
	ds_input.setColumn(0,"HALL_CLASS",gfn_trim(ds_Hall_class.getColumn(0,"HALL_CLASS")));
// ***************************************	
	http.Sync=true;
	fsp_clear(this);
	ds_Meal.clearData();
	fsp_addSearch(this,"fs/fsm:FSM00060E_S002");	// 끼니 조회 ds_Meal

	fsp_callService(this,"","",
					"ds_input=ds_input",
					"ds_Meal=ds_Meal",
					"",
					"fn_callBack_Meal",
					"",
					true);
	http.Sync=false;
}
function fn_Corner()
{
//	*********업장정보 받아가기***********
	ds_input.clear();
 	ds_input.addColumn("CUR_DATE","STRING",256);
	ds_input.addColumn("UPJANG","BIGDECIMAL",256);
	ds_input.addColumn("HALL_CD","STRING",256);
	ds_input.addColumn("MEAL","STRING",256);
	ds_input.addColumn("CORNER","STRING",256);
	ds_input.addColumn("HALL_CLASS","STRING",256);
	ds_input.addRow();
 	ds_input.setColumn(0,"CUR_DATE",gfn_trim(me_GiveDay.value));//제공일
	ds_input.setColumn(0,"UPJANG",fa_UPJANG);
	ds_input.setColumn(0,"HALL_CD",fa_HALL_CD);
	ds_input.setColumn(0,"MEAL",cbo_DinGbn.value);
 	ds_input.setColumn(0,"CORNER","");
	ds_input.setColumn(0,"HALL_CLASS",gfn_trim(ds_Hall_class.getColumn(0,"HALL_CLASS")));	
// ***************************************	
	http.Sync=true;
	fsp_clear(this);
	ds_Corner.clearData;
	
 	fsp_addSearch(this,"fs/fsm:FSM00060E_S004");	// 끼니 조회 ds_Meal
	
	fsp_callService(this,"","",
					"ds_input=ds_input",
					"ds_Corner=ds_Corner",
					"",
					"fn_callBack_Corner",
					"",
					true);
	http.Sync=false;	
	
}

function fn_AlertMsg(cd)
{
	var v_Msg="";
	switch(cd)
	{
		case "001":
			v_Msg= "버튼이 정의 되어 있지않습니다.";
			break;
		case "002":
			v_Msg="서비스 오류:시스템 관리자에게 문의하십시오.";
			break;
		case "003":
			v_Msg="조회된 데이타가 없습니다.";
			break;														
		case "004":
			v_Msg="변경된 데이타가 있습니다.\n\n저장하시겠습니까?";
			break;
		case "005":
			v_Msg="날짜를 입력하셔야 합니다.";
			break;
		case "006":
			v_Msg="날짜 형식을 확인하세요.";
			break;			
		case "007":
			v_Msg="월이 잘못되었습니다.";
			break;			
		case "008":
			v_Msg="일자가 잘못되었습니다.";
			break;	
		case "009":
			v_Msg="조회 기간을 벗어났습니다.";
			break;					
		case "010":
			v_Msg="업장정보가 없습니다.";
			break;
		case "011":
			v_Msg="식당정보가 없습니다.";
			break;
		case "012":
			v_Msg="식당군정보가 없습니다.";
			break;
		case "013":
			v_Msg="제공일정보가 없습니다.";
			break;
		case "014":
			v_Msg="끼니정보가 없습니다.";
			break;
		case "015":
			v_Msg="코너정보가 없습니다.";
			break;	
		case "016":
			v_Msg="예상식수가 없습니다.";
			break;										
		case "017":
			v_Msg="입고 예정일이 잘못되었습니다.\n\n다시 선택하세요.";
			break;
		case "018":
			v_Msg="발주된 자재가 있습니다.\n\n삭제할 수 없습니다.";
			break;	
		case "019":
			v_Msg="레시피별 하나의 자재만 선택대체 할 수 있습니다.";
			break;	
		case "020":
			v_Msg="레시피별 하나의 자재만 선택대체 할 수 있습니다.";
			break;
		case "021":
			v_Msg="조리법이 비어있는 라인이 있습니다.비어있는 라인을 입력하세요.";
			break;	
		case "022":
			v_Msg="변경된 자료가 있습니다.\n\n먼저 저장하신후 작업하세요.";
			break;	
		case "023":
			v_Msg="제공일을 넘을수 없습니다.";
			break;	
		case "024":
			v_Msg="적용할 입고 예정일을 입력하세요.";
			break;
		case "025":
			v_Msg="식단을 삭제 하시겠습니까?";
			break;
		case "026":
			v_Msg="이미 등록된 레시피 입니다.";
			break;	
		case "027":
			v_Msg="조회기간 정보가 없습니다.";
			break;					
		case "028":
			v_Msg="변경된 자료가 있습니다.저장 후 작업하시겠습니까?";
			break;
		case "029":
			v_Msg="레시피를 추가 하시겠습니까?";
			break;								
/*			
		case "":
			v_Msg="";
			break;
*/			
		default:
			break;			
	}
	return v_Msg;
}
/******************************************************************************************
 * 함  수  명   : Common_Btn_common_OnClick
 * 입      력   : 화면공통버튼 
 * 반      환   : 없음
 * 기      능   : 화면공통버튼이벤트처리 :함수호출
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function Common_Btn_common_OnClick(obj:Button, e:ClickEventInfo)
{
	switch(obj.name)
	{
		case "btn_Pop_Search":
			fn_Pop_Search();
			break;
		case "btn_Pop_Save":
			fn_Pop_Save("BTN_SAVE");
			break;
		case "btn_Pop_Delete":
			fn_Pop_Delete();
			break;
		case "btn_Pop_Close":
			fn_Pop_Close();
			break;
	}
}
/******************************************************************************************
 * 함  수  명   : div_extend_img_open_OnClick
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 조회단 그리드 싸이즈 늘이기및 줄이기
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function div_extend_img_open_OnClick(obj:ImageViewer, e:ClickEventInfo)
{
	var cImg = "URL('theme://convertImages/img_CloseBottom.png')";

    //absolute 4 14 566 183

	if(div_extend.img_open.image==cImg)
	{
		div_extend.img_open.image="URL('theme://convertImages/img_OpenBottom.png')";
		div_extend.position.height=207;
	//	div_extend.st_bar.position.top=167;
	//	div_extend.img_open.position.top=167;
		div_extend.grd_List.position.height=193;
		div_extend.Static00.position.height=193; 
	}
	else
	{
		div_extend.img_open.image="URL('theme://convertImages/img_CloseBottom.png')";
		div_extend.position.height=512;
	//	div_extend.st_bar.position.top=375;
	//	div_extend.img_open.position.top=375;
		div_extend.grd_List.position.height=478;
		div_extend.Static00.position.height=478;
	}
}
/******************************************************************************************
 * 함  수  명   : div_extend_grd_List_OnKillFocus
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 조회 그리드 싸이즈 줄이기
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function div_extend_grd_List_OnKillFocus(obj:Grid, e:KillFocusEventInfo)
{
	if(div_extend.img_open.image=="img_closeBottom")
	{
		div_extend.img_open.image="URL('theme://convertImages/img_OpenBottom.png')";
		div_extend.position.height=144;
		div_extend.st_bar.position.top=131;
		div_extend.img_open.position.top=131;
		div_extend.grd_List.position.height=123;
	}	
}
/******************************************************************************************
 * 함  수  명   : btn_GiveCal_OnClick
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 날짜 조회 팝업
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function btn_GiveCal_OnClick(obj:Button, e:ClickEventInfo)
{
	//var v_ret=gfn_dialog("", "U_SCC::SCC_CALENDAR.xfdl","fa_Date="+wrapQuote(me_GiveDay.value),-1,-1,"Title=false Status=false AutoSize=true Resize=false");
	
	g_CalButton_OnClick(obj);
	
	v_ret=me_GiveDay.value;
	
	

	if(gfn_trim(v_ret)<fa_FROM_DT || gfn_trim(v_ret)>fa_TO_DT)
	{
		g_Message("EE",fn_AlertMsg("009"));
		return;
	}
	if(gfn_length(gfn_trim(v_ret))==8)
	{
		me_GiveDay.value=v_ret;
		
		fn_Meal();
		
		ds_input.clear();
		ds_input.addColumn("CUR_DATE","STRING",256);
		ds_input.addColumn("UPJANG","BIGDECIMAL",256);
		ds_input.addRow();
		ds_input.setColumn(0,"CUR_DATE",me_GiveDay.value);
		ds_input.setColumn(0,"UPJANG",fa_UPJANG);
		fsp_clear(this);
		ds_weather.clearData();
		fsp_addSearch(this,"fs/fsm:FSM00060E_S001");  // 날씨정보
		
		http.Sync=true;
		fsp_callService(this,"","",
						"ds_input=ds_input",
						"ds_weather=ds_weather",
						"",
						"fn_Call_back",
						"",
						true);
		http.Sync=false;
		img_Weather.image=ds_weather.getColumn(0,"W_IMAGE");
	}
	else
	{
		return;
		// if(me_GiveDay.Value.Trim().length()!=8)
		// {
			// me_GiveDay.Value=ds_GetDate.GetColumn(0,"TODAY");
			// fn_Meal();
		// }
	}
	
}
/******************************************************************************************
 * 함  수  명   : me_GiveDay_OnKillFocus
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 날짜 유효성체크
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function me_GiveDay_OnKillFocus(obj)
{
//fn_IsDate(me_GiveDay.value);
}

function fn_IsDate(sYmd)
{
 	if(  gfn_length(gfn_trim(sYmd))< 1) {
		g_Message("EE",fn_AlertMsg("005"));
    	return false;
  	}
  	
    // 숫자 확인
    if(gfn_IsNumber(sYmd) == -1) {
    	g_Message("EE",fn_AlertMsg("006"));
    	me_GiveDay.value="";
    	return false;
  	}
  	
  	// 길이 확인
  	if(gfn_length(sYmd)== 8) {
  	} else {
	    g_Message("EE",fn_AlertMsg("006"));
    	return false;
  	}
  	
  	var iYear	= toNumber(gfn_subStr(sYmd,0,4));		//년도입력(YYYY)
  	var iMonth	= toNumber(gfn_subStr(sYmd,4,2));		//월입력(MM)
  	var iDay	= toNumber(gfn_subStr(sYmd,6,2));		//일자입력(DD)
  	
  	if((iMonth < 1) ||(iMonth >12)) {
	    g_Message("EE",fn_AlertMsg("007"));
	    me_GiveDay.setSelect(5,7);
	    me_GiveDay.setFocus();
        return false;
  	}
  	
  	// 날짜의 존재 여부를 확인
  	if(gfn_getDay(sYmd)< 0 ) {
	    g_Message("EE",fn_AlertMsg("008"));
	    me_GiveDay.setSelect(8,10);
	    me_GiveDay.setFocus();
	    me_GiveDay.value=gfn_subStr(sYmd,0,6);
    	return ;
  	}
}
/******************************************************************************************
 * 함  수  명   : cbo_DinGbn_OnChanged
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 끼니 선택시 코너 조회
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function cbo_DinGbn_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	fn_Corner();
}
/******************************************************************************************
 * 함  수  명   : cbo_CornGbn_OnChanged
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 코너 선택시 헤디라인 나머지값 채우기
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function cbo_CornGbn_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	fn_Clear();
	ds_Corner.rowposition=cbo_CornGbn.index; 

	me_Cnt.value=ds_Corner.getColumn(ds_Corner.rowposition,"EXPECT_MEAL_QTY");
	me_danga.value=ds_Corner.getColumn(ds_Corner.rowposition,"SALE_PRICE");
	ed_Feature.value=ds_Corner.getColumn(ds_Corner.rowposition,"MENU_FEATURE");

//	fn_Pop_Search();	//	==> 20080414 조회 조건 변경시 조회 버튼으로 조회하도록 변경 요청함


	//예상식수 변경가능 여부 처리(실실수>0 || 발주여부='Y' || 지난 날짜  ===> 수정불가)
/*
	me_Cnt.Enable = ((ds_Corner.GetColumn(ds_Corner.row,"REAL_MEAL_QTY") > 0)
					|| (ds_Corner.GetColumn(ds_Corner.row,"ORDER_YN") = 'Y')
					|| (ds_Corner.GetColumn(ds_Corner.row,"MENU_DATE") < ds_GetDate.GetColumn(0,"TODAY"))
					);
*/
//============================================================================================
//(2012-11-05 수정) 시작
// 박은규 2012-11-05 CSR#(CH201210_00118) 요청자:박현정(FS기획팀)
// -3일~ 는 무조건 예상식수 수정가능
//============================================================================================
/*
	if ((ds_Corner.GetColumn(ds_Corner.row,"REAL_MEAL_QTY") > 0)
		|| (ds_Corner.GetColumn(ds_Corner.row,"ORDER_YN") = 'Y')
		|| (ds_Corner.GetColumn(ds_Corner.row,"MENU_DATE") < ds_GetDate.GetColumn(0,"TODAY")))
		me_Cnt.Enable = false;
	else
		me_Cnt.Enable = true;
*/
	me_Cnt.enable = (ds_Corner.getColumn(ds_Corner.rowposition,"MENU_DATE") >= gfn_addDate(ds_GetDate.getColumn(0,"TODAY"),-3));
//============================================================================================
//(2012-11-05 수정) 끝
//============================================================================================
}
/******************************************************************************************
 * 함  수  명   : me_GiveDay_OnChanged
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 제공일 변경시 끼니 다시 조회
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function me_GiveDay_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{
	fn_IsDate(me_GiveDay.value);
	fn_Meal();
}
/******************************************************************************************
 * 함  수  명   : btn_SubSearch_OnClick
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 표준및 업장 표준레시피 조회
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function btn_SubSearch_OnClick(obj:Button, e:ClickEventInfo)
{
	if(btn_MenuIns.userdata==1)
	{
		g_Message("EE","메뉴 정보가 갱신 되었습니다.\n\n저장후 작업하세요.");
		return;
	}
//	필수 입력 체크 할것
	var chk_Std=0;
	var chk_Upjang=0;
	
	fa_HALL_CLASS=ds_Hall_class.getColumn(0,"HALL_CLASS");
	
	fa_HALL_CLASS='005';
	
	if(chk_StdRecipe.value !=1 && chk_UpjangRecipe.value != 1)
	{
		chk_StdRecipe.value=1;
		chk_UpjangRecipe.value=1;
		chk_Upjang=1;
		chk_Std=1;
	}
	else
	{
		chk_Std=chk_StdRecipe.value;
		chk_Upjang=chk_UpjangRecipe.value;
	}
	if(gfn_length(gfn_trim(fa_UPJANG))==0)
	{
		g_Message("EE",fn_AlertMsg("010"));
		return;
	}
	if(gfn_length(gfn_trim(fa_HALL_CD))==0)
	{
		g_Message("EE",fn_AlertMsg("011"));
		return;
	}	
	if(gfn_length(gfn_trim(fa_HALL_CLASS))==0)
	{
		g_Message("EE",fn_AlertMsg("012"));
		return;
	}	
	if(gfn_length(gfn_trim(me_GiveDay.value))==0)
	{
		g_Message("EE",fn_AlertMsg("013"));
		return;
	}		
	
	var ActionVal="";
	ActionVal 	="STD_CHK="					+	wrapQuote(gfn_trim(chk_Std))
				+" UPJANG_CHK="				+	wrapQuote(gfn_trim(chk_Upjang))
				+" RECIPE_NAME="			+	wrapQuote(gfn_trim(gfn_replace(cbo_RecipeNM.value,"==레시피명==",null)))
				+" RECIPE_CLASS="			+	wrapQuote(gfn_trim(gfn_replace(cbo_RecipeClass.value,"==레시피분류==",null)))
				+" RECIPE_TYPE="			+	wrapQuote(gfn_trim(gfn_replace(cbo_RecipeType.value,"==레시피유형==",null)))
				+" CUISINE_TYPE="			+	wrapQuote(gfn_trim(gfn_replace(cbo_CuisineClass.value,"==조리법유형==",null)))
				+" MAIN_ITEM_CODE1="		+	wrapQuote(gfn_trim(gfn_replace(cbo_Item.value,"==주재료군==",null)))
				+" RESP_NUT1="				+	wrapQuote(gfn_trim(gfn_replace(cbo_Element.value,"==대표영양성분==",null)))
				+" MENU_DATE="				+	wrapQuote(gfn_trim(me_GiveDay.value))
				+" UPJANG="					+	wrapQuote(gfn_trim(fa_UPJANG))
				+" HALL_CD="				+	wrapQuote(gfn_trim(fa_HALL_CD))
				+" SUBINV_CODE="			+	wrapQuote(gfn_trim(fa_SUBINV_CODE))
				+" HALL_CLASS="				+	wrapQuote(gfn_trim(fa_HALL_CLASS));	
							
	// 레시피명 세팅
	var sRecipeName = gfn_trim(gfn_replace(cbo_RecipeNM.value,"==레시피명==",""));
	if(!gfn_isNull(sRecipeName))
	{
		var aRecipeName = sRecipeName.split(' ');
		for(var i=0; i<aRecipeName.length; i++)
		{
			ActionVal += " RECIPE_NAME" + (i + 1) + "=" + wrapQuote(gfn_trim(aRecipeName[i]));	
		}
	}							
							
	if(ds_Hall_class.getColumn(0,"HALL_CLASS")!="005")
	{
		ActionVal 	+=" UNITPRICE_FROM="	+	wrapQuote(gfn_trim(me_UnitPfrom.value))
					+ " UNITPRICE_TO="		+	wrapQuote(gfn_trim(me_UnitPto.value))
					+ " SALEPRICE_FROM="	+	wrapQuote('')
					+ " SALEPRICE_TO="		+	wrapQuote('');					
	}
	else
	{
		ActionVal 	+=" UNITPRICE_FROM="	+	wrapQuote(gfn_trim(me_UnitPfrom.value))
					+ " UNITPRICE_TO="		+	wrapQuote(gfn_trim(me_UnitPto.value))
					+ " SALEPRICE_FROM="	+	wrapQuote(gfn_trim(me_SalePfrom.value))
					+ " SALEPRICE_TO="		+	wrapQuote(gfn_trim(me_SalePto.value));
	}
	
	//trace("ActionVal=>"+ActionVal); 
	fsp_clear(this);
	ds_List.clearData();
	fsp_addSearch(this,"fs/fsm:FSM90060E_S005");
	fsp_callService(this,"","","","ds_List=ds_List",ActionVal,"fn_call_back","",true);

				
	
}
/******************************************************************************************
 * 함  수  명   : chk_RecipeGbn_OnClick
 * 입      력   : 없음 
 * 반      환   : 없음
 * 기      능   : 표준및 업장 표준레시피 체크 선택(두개중에 하나는 반드시 선택되도록 이벤트 처리)
 * 작  성  자   : 윤상혁
 * 작성  일자   : 20071203
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function chk_RecipeGbn_OnClick(obj:CheckBox, e:ClickEventInfo)
{
	switch(obj.name)
	{
		case "chk_StdRecipe":
			if(obj.isChecked() != 1)
			{
				chk_UpjangRecipe.value=1;
			}
			break;
		case "chk_UpjangRecipe":
			if(obj.isChecked() != 1)
			{
				chk_StdRecipe.value=1;
			}		
			break;
	}
}

function div_extend_grd_List_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
	if( obj.formatid == "Default" ) {
		if( e.cell == 5 ) {
			return;
		}
	} else if( obj.formatid == "CAFETERIA" ) {
		if( e.cell == 7 ) {
			return;
		}
	} else {
		return;
	}
	
	var chkGbn="";
	var arg="";
	
	if(gfn_trim(ds_List.getColumn(e.row,"GUBUN"))=="업장")
	{	// 업장표준레시피
		chkGbn="UPJANG";
	}
	else
	{	// 표준레시피
		chkGbn="STD";
	}
	
	var v_GUBUN			= gfn_trim(chkGbn);
	var v_RECIPE_CD		= gfn_trim(ds_List.getColumn(e.row,"RECIPE_CD"));
	var v_RECIPE_NAME	= gfn_trim(ds_List.getColumn(e.row,"RECIPE_NAME"));
	var v_UPJANG		= gfn_trim(fa_UPJANG);
	var v_HALL_CLASS	= gfn_trim(ds_Hall_class.getColumn(0,"HALL_CLASS"));
	var v_HALL_CD		= gfn_trim(fa_SUBINV_CODE);
	var v_MENU_DATE		= gfn_trim(me_GiveDay.value);
		
	var bOpen = false;
//	var nCount = /*  AllWindows 객체를 지원하지 않습니다. Count은 지원되지 않는 속성입니다.*/ application.AllWindows.Count;
// 	for( var i=0; i<nCount; i++ ) {
// 		if( /* AllWindows 객체를 지원하지 않습니다.*/ application.AllWindows[i].name == "FSM00068P" ) {
// 			//이미 실행되어 있는 경우에는 fn_call이라는 함수를 호출 (fn_call은 변경할 수 있습니다.)
// 			/* Windows 객체를 지원하지 않습니다.*/ application.Windows[i].fn_ReTransport(v_GUBUN, v_RECIPE_CD, v_RECIPE_NAME, v_UPJANG, v_HALL_CLASS, v_MENU_DATE, v_HALL_CD);
// 			bOpen = true;
// 		}
// 	}
// 	
// 	if( bOpen ) {
// 		bOpen = false;
// 	} else {

 
		arg  = {GUBUN:v_GUBUN
		        ,RECIPE_CD:v_RECIPE_CD
		        ,RECIPE_NAME:v_RECIPE_NAME
		        ,UPJANG:v_UPJANG
		        ,HALL_CLASS:v_HALL_CLASS
		        ,HALL_CD:v_HALL_CD
		        ,MENU_DATE:v_MENU_DATE};
		
		gfn_dialog('',"U_FSM::FSM00068P.xfdl",arg);
//	}
}

function chk_disuse_OnClick(obj:CheckBox, e:ClickEventInfo)
{
/*
	var v_strGrdID=grd_RealRecipe.Format;
	if(chk_disuse.Value==1)
	{
		if(substr(v_strGrdID,0,3)=="SS_")
		{
			grd_RealRecipe.Format=replace(v_strGrdID,"SS_","");
		}
	}
	else
	{
		if(substr(v_strGrdID,0,3)!="SS_")
		{
			grd_RealRecipe.Format="SS_"+v_strGrdID;
		}		
	}
*/
	var v_strGrdID=grd_RealRecipe.formatid;
	if(obj.isChecked()==1)		//폐기율 적용 영양소 보기 ss_cal  ss_grd
	{
		if(gfn_subStr(v_strGrdID,0,3)=="SS_")
		{
			grd_RealRecipe.formatid=v_strGrdID;
		}
		else
		{
			grd_RealRecipe.formatid="SS_"+v_strGrdID;
		}
	}
	else	//폐기율 미적용 영양소 보기   s_cal  grd
	{
		if(gfn_subStr(v_strGrdID,0,3)!="SS_")
		{
			grd_RealRecipe.formatid=v_strGrdID;
		}
		else
		{
			grd_RealRecipe.formatid=gfn_replace(v_strGrdID,"SS_","");
		}
	}
}

function btn_ImgPop_OnClick(obj:Button, e:ClickEventInfo)
{
	if(ds_Menu.getRowCount()==0)
	{
		return;
	}
	
	//trace('9999');
	//trace(ds_List.saveXML());
	
	var arg="";
	arg		= {MENU_DATE:ds_Menu.getColumn(0,"MENU_DATE")
			,MEAL:ds_Menu.getColumn(0,"MEAL")
			,UPJANG:ds_Menu.getColumn(0,"UPJANG")
			,HALL_CD:ds_Menu.getColumn(0,"HALL_CD")
			,CORNER:ds_Menu.getColumn(0,"CORNER")
			,ds_pList:ds_List};
	gfn_dialog("", "U_FSM::FSM00066P.xfdl",arg);
}

function btn_Qality_OnClick(obj:Button, e:ClickEventInfo)
{
	if(ds_Menu.getRowCount()==0)
	{
		return;
	}
	var arg="";
	arg	 = {MENU_DATE:ds_Menu.getColumn(0,"MENU_DATE")
			,MEAL:ds_Menu.getColumn(0,"MEAL")
			,UPJANG:ds_Menu.getColumn(0,"UPJANG")
			,HALL_CD:ds_Menu.getColumn(0,"HALL_CD")
			,CORNER:ds_Menu.getColumn(0,"CORNER")};
	gfn_dialog("", "U_FSM::FSM00065P.xfdl",arg);	
} 

function btn_Nut_OnClick(obj:Button, e:ClickEventInfo)
{
	if(ds_Menu.getRowCount()==0)
	{
		return;
	}
	var arg="";
	arg	= {UPJANG:fa_UPJANG
		  ,HALL_CD:fa_HALL_CD
		  ,GUBUN:chk_disuse.value};
	gfn_dialog("", "U_FSM::FSM00064P.xfdl",arg); 
}

function btn_leftMoveData_OnClick(obj:Button, e:ClickEventInfo)
{
	if(ds_List.getRowCount()==0)
	{
		return;
	}
	if(gfn_length(gfn_trim(me_GiveDay.value))==0 || gfn_trim(me_GiveDay.value)==null )
	{
		g_Message("EE",fn_AlertMsg("005"));
		return;
	}
	if(gfn_length(gfn_trim(cbo_DinGbn.value))==0 || gfn_trim(cbo_DinGbn.value)==null )
	{
		g_Message("EE",fn_AlertMsg("014"));
		return;
	}
	if(gfn_length(gfn_trim(cbo_CornGbn.value))==0 || gfn_trim(cbo_CornGbn.value)==null )
	{
		g_Message("EE",fn_AlertMsg("015"));
		return;
	}
	if(ds_Menu.getRowCount()==0)
	{
		http.Sync=true;
		fn_Pop_Search();
		http.Sync=false;
	}
	var v_Recipe=ds_List.getColumn(ds_List.rowposition,"RECIPE_CD");
	if(ds_Menu.findRow("RECIPE_CD",gfn_trim(v_Recipe))!=-1)
	{
		g_Message("EE",fn_AlertMsg("026"));
		return;
	}
	// if(g_Confirm("02",fn_AlertMsg("029"))==false)
	// {
		// return;
	// }	
	if(gfn_dsIsUpdated(ds_Menu)==true ||
		gfn_dsIsUpdated(ds_Item)==true)
	{
		if(g_Confirm("02",fn_AlertMsg("028"))==true)
		{
			http.Sync=true;
			fn_Pop_Save("BTN_SAVE");
			http.Sync=false;
		}
	}
	setRecipecd=ds_List.getColumn(ds_List.rowposition,"RECIPE_CD");
	fn_Pop_Save("CREATE_REAL");
}

function div_extend_grd_List_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	//trace(e.cell);
	//ds_List.row=nRow;

	switch(obj.formatid)
	{
		case "Default":
			if( e.cell != 5 ) {
				return;
			}
			break;
		case "CAFETERIA":
			if( e.cell != 7 ) {
				return;
			}
			break;
	}
	if(gfn_dsIsUpdated(ds_Menu)==true ||
		gfn_dsIsUpdated(ds_Item)==true)
	{
		if(g_Confirm("02",fn_AlertMsg("028"))==true)
		{
			fn_Pop_Save("BTN_SAVE");
		}
	}
	var arg = new Array();
	arg["UPJANG"] = gfn_nvl(fa_UPJANG);
	arg["RECIPE_CD"] = gfn_nvl(ds_List.getColumn(e.row,"RECIPE_CD"));
	arg["RECIPE_NAME"] = gfn_nvl(ds_List.getColumn(e.row,"RECIPE_NAME"));
	arg["HALL_CD"] = gfn_nvl(gfn_trim(fa_HALL_CD));
	arg["MEAL"] = gfn_nvl(gfn_trim(cbo_DinGbn.value));
	arg["CORNER"] = gfn_nvl(gfn_trim(cbo_CornGbn.value));
	arg["MENU_DATE"] = gfn_nvl(gfn_trim(me_GiveDay.value));
	arg["MENU_CD"] = gfn_nvl(fa_MENU_DATE)+"-"+gfn_nvl(fa_HALL_CD)+gfn_nvl(cbo_DinGbn.value)+gfn_nvl(cbo_CornGbn.value);

	gfn_dialog("", "U_FSM::FSM00062P.xfdl",arg);
	fn_Pop_Search();
}

function ds_Item_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{	
	SetWaitCursor(true);
	
	var v_EQ=0;	// EDIBLE_QTY		가식부량 1인소요량*폐기율==>NEED_QTY*(100-disuse_rate)
	var v_PP=0; // PERSON_PRICE 	1인원가	자재g당단가*1인소요량==>GRAM_PRICE*NEED_QTY
//	var v_CC=0; // CAL_CALC			에너지    100g:기본에너지=가식부량:계산할에너지==>CAL_CALC=(CAL*EDIBLE_QTY)/100
	var v_TQ=0; //	1인소요량* 예상식수/1000 = 총소요량  
	var v_Price=0;
	var v_Row="";
	var v_nut="";
	var v_rtn="";
	var v_col="";	
	switch(e.columnid)
	{
		case "NEED_QTY":	// 1인소요량
			v_PP	=	Math.round(ds_Item.getColumn(e.row,"G_ITEM_PRICE")*ds_Item.getColumn(e.row,"NEED_QTY"),0);
			ds_Item.setColumn(e.row,"CUR_PRICE",v_PP);	// 1인원가 
			
			v_EQ	=	Math.round(ds_Item.getColumn(e.row,"NEED_QTY")*((100-ds_Item.getColumn(e.row,"DISUSE_RATE"))/100),2);
			ds_Item.setColumn(e.row,"EDIBLE_QTY",v_EQ);			// 가식부량	
			
			if( ds_Hall_class.getColumn(0,"HALL_CLASS") == "005" ) {	// 카페테리아
				var v_RecipeCd = ds_Item.getColumn(e.row, "RECIPE_CD");
				var v_RowIndex = ds_Menu.findRow("RECIPE_CD", v_RecipeCd);
				var v_ExpSaleQty = ds_Menu.getColumn(v_RowIndex, "EXPECT_SALE_QTY");
				//trace(v_ExpSaleQty);
				
				v_TQ = Math.round((ds_Item.getColumn(e.row, "NEED_QTY") * v_ExpSaleQty) / 1000, 2); // 카페테리아 총소요량= 1인소요량*예상판매량/1000
			} else {
				v_TQ	=	Math.round((ds_Item.getColumn(e.row,"NEED_QTY")*ds_Item.getColumn(e.row,"EXPECT_MEAL_QTY"))/1000,2);
			}
			
			ds_Item.setColumn(e.row,"TOT_QTY",v_TQ);			// 총소요량
			
			break;
		case "EDIBLE_QTY":	// 가식부량
			// CAL WATER PROT FAT CARBO FIBER ASH CA P FE NA K VITA_A RETIN B_CAROT THIA RIBO NIACIN VITA_C CHOLE 
			v_rtn="CAL;WATER;PROT;FAT;CARBO;FIBER;ASH;CA;P;FE;NA;K;VITA;RETIN;B_CAROT;THIA;RIBO;NIACIN;VITA_C;CHOLE";
			v_nut=gfn_split(v_rtn,";");
			/*	불가 협의 요망
			for(i=0;i<20;i++)
			{	
				// 영양가 계산(1 폐기율 미적용영양소 계산 2 폐기율 적용영양소 계산)
				// 1 폐기율 미적용영양소 계산
				//trace(v_nut[i]);
				v_col="S_"+v_nut[i];
				v_Price	= 	ds_Item.CaseSum("RECIPE_CD=="+quote(ds_Item.GetColumn(nRow,"RECIPE_CD")),"NEED_QTY");	// 레시피별 1인량합
				v_Row	=	ds_Menu.FindRow("RECIPE_CD",ds_Item.GetColumn(nRow,"RECIPE_CD"));
				ds_Menu.SetColumn(v_Row, v_col , round(v_Price * ds_Menu.GetColumn(v_Row,v_nut[i]),2) );			
				//trace(v_col);
				// 2 폐기율 적용영양소 계산
				v_col="SS_"+v_nut[i];
				v_Price	= 	ds_Item.CaseSum("RECIPE_CD=="+quote(ds_Item.GetColumn(nRow,"RECIPE_CD")),"EDIBLE_QTY");	// 레시피별 가식부량
				v_Row	=	ds_Menu.FindRow("RECIPE_CD",ds_Item.GetColumn(nRow,"RECIPE_CD"));
				ds_Menu.SetColumn(v_Row, v_col , round(v_Price * ds_Menu.GetColumn(v_Row,v_nut[i]),2) );					
				//trace(v_col);
			}
			*/
			break;			
		case "CUR_PRICE":	// 1인원가 식단레시피 마스터그리드 반영
			v_Price	= 	ds_Item.getCaseSum("RECIPE_CD=="+wrapQuote(ds_Item.getColumn(e.row,"RECIPE_CD")),"CUR_PRICE");
			v_Row	=	ds_Menu.findRow("RECIPE_CD",ds_Item.getColumn(e.row,"RECIPE_CD"));
			ds_Menu.setColumn(v_Row,"RECIPE_COST",v_Price);
			break;					
	}
	SetWaitCursor(false);	
}

function tab_main_OnChanged(obj:Tab, e:TabIndexChangeEventInfo)
{
	if(e.postindex==3)
	{
		tab_main.tab3.div_ImgLoadUrl.img_JoryMethod.image=GF_FILE_SERVER_URL+"upload/img/cook_ctrl/"+v_CurCuisineType+".jpg";
		//trace(tab_main.tab3.div_ImgLoadUrl.img_JoryMethod.image);	
	}
}

function ds_Item_OnRowPosChanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	v_CurRecipenm=ds_Item.getColumn(e.newrow,"RECIPE_NAME");
	v_CurRecipecd=ds_Item.getColumn(e.newrow,"RECIPE_CD");
	v_CurCuisineType=ds_Item.getColumn(e.newrow,"CUISINE_TYPE");	
}

function tab_main_OnChanging(obj:Tab, e:TabIndexChangeEventInfo)
{
	if(ds_Item.getRowCount()==0 || ds_Menu.getRowCount()==0)
	{
		return false;
	}
	switch(e.preindex)
	{
		case 0:	// 레시피수정
			break;
		case 1:	// 조리법
			if(gfn_dsIsUpdated(ds_CookMethod)==false)
			{
				return;
			}
			else
			{
				//trace("탭변경시 저장 메시지");
				if(g_Confirm("02",fn_AlertMsg("028"))==true)
				{
					if(ds_CookMethod.findRowExpr("gfn_length(gfn_trim(CUISINE_DESC))==0 || gfn_trim(CUISINE_DESC)==null")!=-1)
					{
						//alert(fn_AlertMsg("016"));
						g_Message("EE", fn_AlertMsg("021"));
						return false;
					}
					var v_max=ds_CookMethod.getMax("CUISINE_SEQ");
					if( gfn_trim(v_max)==null || gfn_length(gfn_trim(v_max))==0 )
					{
						v_max=0;
					}
					for(i=0;i<ds_CookMethod.getRowCount();i++)
					{
						if(gfn_length(gfn_trim(ds_CookMethod.getColumn(i,"CUISINE_SEQ")))==0
								|| gfn_trim(ds_CookMethod.getColumn(i,"CUISINE_SEQ"))==null )
						{
							v_max=v_max+1;
							ds_CookMethod.setColumn(i,"CUISINE_SEQ",v_max);
						}
						
					}					
					fn_Pop_Save("COOK");
					return;
				}
			}
			break;
		case 2:	// PHF
			// ds_RecipePhf
			if(gfn_dsIsUpdated(ds_RecipePhf)==false)
			{
				return;
			}
			else
			{
				if(g_Confirm("02",fn_AlertMsg("028"))==true)
				{				
					fn_Pop_Save("PHF");
					return;
				}
			}			
			break;
	}
}

function ds_phf_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	switch(e.row)
	{
		case 0:
			if(e.columnid=="PHF")
			{
				ds_RecipePhf.setColumn(0,"PHF_MGMT1",e.newvalue);
			}
			break;
		case 1:
			if(e.columnid=="PHF")
			{
				ds_RecipePhf.setColumn(0,"PHF_MGMT2",e.newvalue);
			}
			break;
		case 2:
			if(e.columnid=="PHF")
			{			
				ds_RecipePhf.setColumn(0,"PHF_MGMT3",e.newvalue);
			}
			break;
		case 3:
			if(e.columnid=="PHF")
			{			
				ds_RecipePhf.setColumn(0,"PHF_MGMT4",e.newvalue);
			}
			break;
		case 4:
			if(e.columnid=="PHF")
			{		
				ds_RecipePhf.setColumn(0,"PHF_MGMT5",e.newvalue);
			}
			break;
	}
	var v_1=ds_RecipePhf.getColumn(0,"PHF_MGMT1");
	var v_2=ds_RecipePhf.getColumn(0,"PHF_MGMT2");
	var v_3=ds_RecipePhf.getColumn(0,"PHF_MGMT3");
	var v_4=ds_RecipePhf.getColumn(0,"PHF_MGMT4");
	var v_5=ds_RecipePhf.getColumn(0,"PHF_MGMT5");
	
	if( v_1=='Y' && v_2=='N')
	{
		ds_RecipePhf.setColumn(0,"PHF","Y");
	}
	else
	{
		if(v_1=='Y' || v_2=='N')
		{
			if(v_3=='Y' || v_4=='Y' || v_5=='Y')
			{
				ds_RecipePhf.setColumn(0,"PHF","Y");
			}
			else
			{
				ds_RecipePhf.setColumn(0,"PHF","N");
			}
		}
		else
		{
			ds_RecipePhf.setColumn(0,"PHF","N");
		}
	}
}

function grd_RealRecipe_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	var v_row;
	var v_cnt;
	ds_Item.clearSelect();
	ds_Item.rowposition=ds_Item.findRow("RECIPE_CD",ds_Menu.getColumn(e.row,"RECIPE_CD"));
	ds_Item.selectRow(ds_Item.rowposition); 
	
	switch(e.cell)
	{
	    case 1:
	       
	       break;
		case 3:
			v_cnt=ds_Item.getRowCount();
			if(v_cnt==0 || v_cnt== null)
			{
				return;
			}
			// 발주된 자재가 있는 레시피는 삭제할 수 없습니다.
			if(ds_Item.findRowExpr("RECIPE_CD=="+wrapQuote(ds_Menu.getColumn(e.row,"RECIPE_CD"))+" && ORDER_YN=='Y'")!=-1)
			{
				g_Message("EE",fn_AlertMsg("018"));
				return;
			}
			// if(g_Confirm("01")==false)
			// {
				// return;
			// }
			for(i=0;i<v_cnt;i++)
			{
				v_row=ds_Item.findRow("RECIPE_CD", ds_Menu.getColumn(e.row,"RECIPE_CD") );
				ds_Item.deleteRow(v_row);
			}
			ds_Menu.deleteRow(e.row);
			
			fn_Pop_Save("ICO_RECIPE_DEL");
			break;
	}
}

function div_extend_grd_List_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	//trace(e.cell);
	if(e.cell==0)
	{
		gfn_exportExcel(div_extend.grd_List, "Sheet1");
	}
	else
	{
		if(e.cell==3)
		{
			if(sort)
			{
				Sort(ds_List,"RECIPE_NAME",true);
				sort=false;
			}
			else
			{
				Sort(ds_List,"RECIPE_NAME",false);
				sort=true;
			}
		}
		else
		{
			gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
		}
	}
}

function grd_RealRecipe_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	switch(e.cell)
	{
		case 0:
			gfn_exportExcel(grd_RealRecipe, "Sheet1");		
			break;
		case 2:
			var dsRecCnt = eval(obj.binddataset).getRowCount();
			if( dsRecCnt == 0 ) { return; }
			
			for( i=0; i<dsRecCnt; i++ ) {
				 eval(obj.binddataset).setColumn(i, "CREAT", f_Chk);
			}
			if( f_Chk == 1 ) f_Chk = 0;
			else f_Chk = 1;
			
			break;
		default:
			gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);		
			break;
	}
}

function btn_ibDateUpdate_OnClick(obj:Button, e:ClickEventInfo)
{
	//alert(obj);
	 if(ds_Menu.getRowCount()==0)
	 {
		 return;
	 }
	 if(tab_main.tabindex!=0)
	 {
		 return;
	 }
	 if(ds_Item.getRowCount()==0)
	 {
		 return;
	 }
	 gfn_dialog("", "U_FSM::FSM00069P.xfdl","");	
}



function btn_MenuIns_OnClick(obj:Button, e:ClickEventInfo)
{
	if(btn_MenuIns.userdata==0)
	{
		g_Message("EE","갱신된 메뉴 정보가 없습니다.");
		return;
	}
	if(gfn_length(gfn_trim(me_GiveDay.value))==0)
	{
		g_Message("EE","제공일 정보가 없습니다.");
		return;
	}
	if(ds_Corner.getRowCount()==0 || ds_Meal.getRowCount()==0)
	{
		g_Message("EE","메뉴(끼니코너) 정보가 없습니다.");
		return;
	}	
	if(me_Cnt.value>0)
	{
	}
	else
	{
		g_Message("EE","예상식수를 입력하세요.");
		return;
	}
	if(me_danga.value>0)
	{
	}
	else
	{
		if(ds_Hall_class.getColumn(0,"HALL_CLASS")!="005")	// 카페테리아 
		{
			g_Message("EE","식단가를 입력하세요.");
			return;
		}
	}

	var strMenu=me_GiveDay.value+"-"+fa_HALL_CD+cbo_DinGbn.value+cbo_CornGbn.value;
	
	var arg	="UPJANG="			+  fa_UPJANG
			+" MENU_CD="		+ wrapQuote(strMenu)
			+" SALE_PRICE="		+ wrapQuote(me_danga.value)		// 식단가(테이블 판매가)
			+" EXPECT_MEAL_QTY="+ wrapQuote(me_Cnt.value)		// 예상식수
			+" MENU_FEATURE="	+ wrapQuote(ed_Feature.value);	// 식단 특성(특징)
			
	ds_Corner.setColumn(cbo_CornGbn.index,"EXPECT_MEAL_QTY",me_Cnt.value);
	ds_Corner.setColumn(cbo_CornGbn.index,"SALE_PRICE",me_danga.value);
	ds_Corner.setColumn(cbo_CornGbn.index,"MENU_FEATURE",ed_Feature.value);
	ds_Corner.applyChange(); 

	//trace("menu U=> "+arg);
	//return;
	fsp_clear(this);
	fsp_addSingle(this,"fs/fsm::FSM00060E_U006");
	fsp_callService(this,"","",
					"",
					"",
					arg,
					"fn_Call_Msg",
					"",
					true);
//	tit_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);					
}
function fn_Call_Msg(cd,errmsg)
{
	if(cd!=0)
	{
		g_Message("EE","시스템 오류!\n\n전산 담당자에게 문의하세요.");
		return;
	}
	else
	{
		btn_MenuIns.userdata=0;
		g_Message("02");
		
		/* 기본정보 저장 후 조회 추가 */
		fn_Pop_Search();
		
		return;
	}
}
function cbo_RecipeType_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	if(e.postindex==0)
	{
		ds_CookClass.filter("");
	}
	else
	{
		ds_CookClass.filter("gfn_length(gfn_trim(SET1))==0 || SET1=='"+e.postvalue+"'");
	}
}

function ds_Item_CanColumnChange(obj:Dataset, e:DSColChangeEventInfo)
{
	if(e.columnid=="NEED_QTY" || e.columnid=="EDIBLE_QTY")
	{
		if(toNumber(e.newvalue)<=-1)
		{
			g_Message("EE","0보다 큰값으로 입력해야 합니다.");
			return false; //	반드시 0보다 큰값으로 입력해야함.		
		}
	}
}


function cbo_RecipeNM_onkeydown(obj:Combo, e:KeyEventInfo)
{
	if (e.keycode == 13 && obj.userchange == "1") {
		var strValue,nFRow,objDs,strDataColumn;
		
		strValue 		= obj.userdata;
	//	objDs			= eval(obj.innerdataset);
		strDataColumn	= obj.datacolumn;
		
		if (gfn_length(strValue)>0) {
			nFRow = ds_RecipeNM.findRow(strDataColumn,strValue);
			
			if (nFRow == -1)
			{
				var nRow = ds_RecipeNM.addRow();
				ds_RecipeNM.setColumn(nRow,strDataColumn,strValue);
				obj.index = nRow;
			} else {
				obj.index = nFRow;
			}
		}
		btn_SubSearch.setFocus();
		btn_SubSearch.click();
		cbo_RecipeNM.setFocus();
		
	} else if (e.keycode == 38 || e.keycode == 40) {
		if ( obj.isDropdown() ) {
			obj.userchange = "2";
		} else {
			obj.userchange = "1";
		}
	}
}

function cbo_RecipeNM_OnKillFocus(obj:Combo, e:KillFocusEventInfo)
{
	var strValue,nFRow,objDs,strDataColumn;
	
	strValue 		= obj.userdata;
	//objDs			= eval(obj.innerdataset);
	strDataColumn	= obj.datacolumn;
	
	if (gfn_length(strValue) > 0) {
		nFRow = ds_RecipeNM.findRow(strDataColumn,strValue);
		
		if (nFRow == -1)
		{
			var nRow = ds_RecipeNM.addRow();
			ds_RecipeNM.setColumn(nRow,strDataColumn,strValue);
			obj.value = strValue;
		} else {
			obj.value = strValue;
		}
	} else {
		obj.index 		= 0;
	}
}

function cbo_RecipeNM_ontextchanged(obj:Combo, e:TextChangedEventInfo)
{
	obj.userdata   = e.posttext;
	obj.userchange = "1";
}

function cbo_RecipeNM_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	//trace("obj.userchange=="+obj.userchange+":::::e.pretext=="+e.pretext+"::::::e.posttext=="+e.posttext);
	if ( obj.userchange == "2" ) {
		obj.userchange = "0";
		obj.userdata   = e.posttext;
		
		btn_SubSearch.setFocus();
		btn_SubSearch.click();
		cbo_RecipeNM.setFocus();
	} else {
		obj.userchange = "1";
		obj.userdata = e.posttext;
	}
}

function common_OnKeyDown(obj:Combo, e:KeyEventInfo)
{
	switch(e.keycode)
	{
		case 13:	// Enter
			switch(obj.name)
			{
				case "cbo_RecipeNM":
					var objDS=eval(obj.innerdataset);
					if(e.keycode==13)
					{
						if(gfn_length(gfn_trim(obj.userdata))!= 0 )
						{
							if(objDS.findRow("NM",gfn_trim(obj.userdata))==-1)
							{
								objDS.addRow();
								objDS.setColumn(objDS.rowposition,"NM",gfn_trim(obj.userdata));
								//div_Reci.cbo_RecipeNM.Value=trim(div_Reci.cbo_RecipeNM.UserData);
								var v_index=objDS.findRow("NM",obj.userdata);
								obj.index=v_index;
							}
						}
						/* Idle은 지원되지 않는 메서드입니다.*/ Idle();
						btn_SubSearch.click();
						obj.userdata="";
					}
					break;
				default :
					break;
			}
			var v_nComp=GetNextComponent(null);
			v_nComp.setFocus();			
			break;
		case 46:	// del
			if(GetType(obj)=="Combo")
			{
				obj.index=-1;
				cbo_RecipeType_OnChanged(obj,"","","",0);
			}
			else
			{
				obj.text="";
				obj.value="";
			}
			break;
	}
}

function grd_RealRecipe_OnMouseOver(obj:Grid, e:GridMouseEventInfo)
{
	if(e.row==-1 && e.cell < 3 )
	{
		grd_RealRecipe.tooltiptext="구축 체크시 업장 표준레시피로 구축됩니다.";
	}
	else
	{
		if(e.row>=0 && e.cell==5)
		{
			if(gfn_length(gfn_trim(ds_Menu.getColumn(e.row,"RECIPE_NAME")))>7)
			{
				grd_RealRecipe.tooltiptext=ds_Menu.getColumn(e.row,"RECIPE_NAME");
			}
			else
			{
				grd_RealRecipe.tooltiptext="";
			}
		}
		else if(e.row>=0 && e.cell==3)
		{
			grd_RealRecipe.tooltiptext="삭제";
		}
		else
		{
			grd_RealRecipe.tooltiptext="";
		}
	}
}

function btn_NutReCalc_OnClick(obj:Button, e:ClickEventInfo)
{
	if(!gfn_dsIsUpdated(ds_Item))
	{
		return;
	}
	fn_NutReCalc("BTN_SAVE");
}
function fn_NutReCalc(str)
{
	// 변경된 자재 정보를 저장하고 레시피 목록(식단구성)만 재 조회 한다.
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	var searchsql,insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql;
	var searchsql,insertSql2, updateSql2, deleteSql2;
	var searchsql,insertSql3, updateSql3, deleteSql3;	

	switch(str)
	{								
		case "BTN_SAVE":	// 저장 버튼
			fsp_clear(this);
			
			// otherArg		="MENU_DATE="		+quote()
					// +" UPJANG="			+quote()
					// +" HALL_CD="		+quote()
					// +" MEAL="			+quote()
					// +" CORNER="			+quote()
					// +" RECIPE_CD="		+quote();
			
			inData		= "ds_Menu=ds_Menu:U ds_Item=ds_Item:U";
			outData		= "";
			callBackFnc	= "";
			insertSql1 	= "";
			insertSql2 	= "";
			if(ds_Hall_class.getColumn(0,"HALL_CLASS")=="005" || fa_HALL_CLASS == "005")	// 카페테리아 
			{
				updateSql1	= "fs/fsm:FSM00060E_U003";
			}
			else 												// 그외 
			{
				updateSql1	= "fs/fsm:FSM00060E_U004";
			}
			updateSql2	= "fs/fsm:FSM00060E_U005";			
			deleteSql1	= "";
			deleteSql2	= "";	
			keyIncrement= -1;
			callbackSql	= "";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1,saveFlagColumn, keySqlName, keyIncrement, callbackSql);
			fsp_addSave(this, insertSql2, updateSql2, deleteSql2,saveFlagColumn, keySqlName, keyIncrement, callbackSql);			
			http.Sync=true;
			fsp_callService(this, "", "", inData, outData, otherArg, callBackFnc);	
			http.Sync=false;
			
			fn_NutReCalc("CHK_CONSTRUCT");
			break;						
		case "CHK_CONSTRUCT":	// 식단구성 구축 체크(구축이면 기존 업장표준데이타 일괄삭제후 실제 식단 레시피로 일괄대체합니다.
			// grd_RealRecipe.Redraw=false;
			// ds_Menu.Filter("CREAT==1");
			var arg="";
			for(i=0;i<ds_Menu.getRowCount();i++)
			{
				if(ds_Menu.getColumn(i,"CREAT")==1)
				{
					arg		="UPJANG="		+wrapQuote(ds_Menu.getColumn(i,"UPJANG"))
							+" HALL_CLASS="	+wrapQuote(ds_Hall_class.getColumn(0,"HALL_CLASS"))
							+" RECIPE_CD="	+wrapQuote(ds_Menu.getColumn(i,"RECIPE_CD"))
							+" MENU_CD="	+wrapQuote(ds_Menu.getColumn(i,"MENU_CD"));
							
					fsp_clear(this);
					ds_Chk.clearData();
					fsp_addSearch(this,"fs/fsm:FSM00060E_S009");
					http.Sync=true;
					fsp_callService(this,"","","","ds_Chk=ds_Chk",arg,"fn_call_back");
					http.Sync=false;
					// 일괄삭제
					inData		= "";
					outData		= "";
					callBackFnc	= "";
					insertSql1 	= "";
					insertSql2 	= "";
					updateSql1	= "";
					updateSql2	= "";			
					deleteSql1	= "fs/fsm:FSM00060E_D008";
					deleteSql2	= "fs/fsm:FSM00060E_D009";
					deleteSql3	= "fs/fsm:FSM00060E_D010";	
					keyIncrement= -1;
					callbackSql	= "";
					
					fsp_addSingle(this, deleteSql1);
					fsp_addSingle(this, deleteSql2);
					fsp_addSingle(this, deleteSql3);
					
					http.Sync=true;
					fsp_callService(this, "", "", inData, outData, arg, callBackFnc);	
					http.Sync=false;
					
					fsp_clear(this);

					// insert
					inData		= "";
					outData		= "";
					callBackFnc	= "";
					insertSql1 	= "fs/fsm:FSM00060E_I002";
					insertSql2 	= "fs/fsm:FSM00060E_I003";
					insertSql3 	= "fs/fsm:FSM00060E_I004";
					keyIncrement= -1;
					callbackSql	= "";
					fsp_addSingle(this, insertSql1);
					fsp_addSingle(this, insertSql2);
					fsp_addSingle(this, insertSql3);
					http.Sync=true;
					fsp_callService(this, actionName, cmdName, inData, outData, arg, callBackFnc);
					http.Sync=false;
				}
			}
			fn_Menu_Search();
			// ds_Menu.UnFilter();
			// grd_RealRecipe.Redraw=true;
			break;
	}	
}
function fn_Menu_Search()
{
	if(tab_main.tabindex!=0 ||
		ds_Menu.getRowCount()==0 )
	{
		return;
	}
	if(btn_MenuIns.userdata==1)
	{
		g_Message("EE","메뉴 정보가 갱신 되었습니다.\n\n저장후 작업하세요.");
		return;
	}

	if(gfn_length(gfn_trim(cbo_DinGbn.value))==0)
	{
		return;
	}
	if(gfn_length(gfn_trim(cbo_CornGbn.value))==0)
	{
		return;
	}
	if(gfn_length(gfn_trim(me_Cnt.value))==0)
	{
		return;
	}

	var arg="";
	
	arg		="UPJANG="		+wrapQuote(fa_UPJANG)
			+" HALL_CD="	+wrapQuote(fa_HALL_CD)
			+" MEAL="		+wrapQuote(cbo_DinGbn.value)
			+" CORNER="		+wrapQuote(cbo_CornGbn.value)
			+" MENU_DATE="	+wrapQuote(me_GiveDay.value);
	
	fsp_clear(this);
	fsp_addSearch(this,"fs/fsm:FSM00060E_S006");
	http.Sync=true;
	fsp_callService(this,"","","","ds_Menu=ds_Menu",arg,"fn_Call_Sms");
	http.Sync=false;
}
function fn_Call_Sms(cd,errmsg)
{
	if(cd!=0)
	{
	}
	else
	{
		g_Message("02","처리가 완료 되었습니다.");
		return;
	}
}
function grd_RealRecipe_OnKeyDown(obj:Grid, e:KeyEventInfo)
{
	if(e.keycode==13)
	{
		if(obj.currentcell==8)
		{
			obj.moveToNextCell();	
		}
		else if(obj.currentcell==9)
		{
			if( eval(obj.binddataset).rowposition != (eval(obj.binddataset).getRowCount()-1))
			{
				eval(obj.binddataset).rowposition=eval(obj.binddataset).rowposition+1;
				obj.setCellPos(8);
			}
		}
	} 
}
/******************************************************************************************
 * 함  수  명   : ds_Menu_OnColumnChanged
 * 입      력   : 
 * 반      환   : 
 * 기      능   : 카페테리아의 경우 예상판매량 변경시 자재들의 총소요량 재계산
 * 작  성  자   : 
 * 작성  일자   : 2008.05.23
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *  1) 
 ******************************************************************************************
 */
function ds_Menu_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if( e.columnid == "EXPECT_SALE_QTY" && ds_Item.getRowCount() > 0 ) {
		var v_RecipeCd = ds_Item.getColumn(e.row, "RECIPE_CD");
		for( var i=0; i<ds_Item.getRowCount(); i++ ) {
			if( ds_Item.getColumn(i, "RECIPE_CD") == v_RecipeCd ) {
				ds_Item.setColumn(i, "TOT_QTY", Math.round((ds_Item.getColumn(i, "NEED_QTY") * parseInt(e.newvalue)) / 1000, 2));
			}
		}
	}
}

function div_extend_grd_List_OnMouseOver(obj:Grid, e:GridMouseEventInfo)
{
	if(e.row>=0 && e.cell==2 && ds_List.getColumn(e.row,"DI_MON")==1)
	{
		div_extend.grd_List.tooltiptext="NEW";
	}
	else if(e.row>=0 && e.cell==5)
	{
		div_extend.grd_List.tooltiptext="과거 제공 내역";
	}
	else
	{
		div_extend.grd_List.tooltiptext="";
	}
}
function fn_Clear()
{
	tab_main.tabindex=0;
	ds_Menu.clearData();
	ds_Item.clearData();
}



/////////////////////////////////////////////////////////////
///// 병원용 체크사항 - 구성요소를 반드시 입력해야 합니다.
///// 한화S&C 박종세 2008-06-11 수정
/////////////////////////////////////////////////////////////
function fn_DataValidation_Hostipal_DataSet(cmdAction)
{
  var blnRtn=true;
  
  switch(cmdAction)
  {
		case "SAVE":
			  var checkRow = ds_Menu.findRowExpr("gfn_length(MAJOR_DISH_INFO)==0");
			  if(checkRow!=-1)
			  {
				g_Message("EE", "구성요소가 지정되지 않은 레시피가 있습니다.\n병원식단 레시피는 구성요소가 필수 입력입니다.\n\n구성요소(주식,국,부식등..)를 선택하여 주십시요."); 
				blnRtn=false;
			  }   	
			  
		      break;
  
		case "CLOSE":
			  var checkRow = ds_Menu.findRowExpr("gfn_length(MAJOR_DISH_INFO)==0");
			  if(checkRow!=-1)
			  {
				g_Message("EE", "구성요소가 지정되지 않은 레시피가 있습니다.\n병원식단 레시피는 구성요소가 필수 입력입니다.\n\n구성요소(주식,국,부식등..)를 선택하여 주십시요."); 
				blnRtn=false;
			  }
			  if(gfn_dsIsUpdated(ds_Menu))
			  {
				blnRtn=g_Confirm("04", "저장되지 않은 데이터가 있습니다.\n구성요소를 변경하였을 경우 반드시 저장버튼을 눌러주십시요.\n\n레시피검색및 등록 창을 닫으시겠습니까?"); 
			  }
  	          break;
  	    default:
			  break;
  }		  
  return blnRtn;
}

//폼이 닫힐때 이벤트
function FSM00060E_OnUnloadCompleted(obj:Form, e:CloseEventInfo)
{
	//병원용 식당일때만 확인한다.
	if(ds_Hall_class.getColumn(0,"HALL_CLASS")=="007" 	||
	   ds_Hall_class.getColumn(0,"HALL_CLASS")=="008" 	||
	   ds_Hall_class.getColumn(0,"HALL_CLASS")=="009"		)	// 병원 
	{
		//구성요소 확인
		var checkRow = ds_Menu.findRowExpr("gfn_length(MAJOR_DISH_INFO)==0");
		if(checkRow!=-1)
		{
			g_Message("EE", "구성요소가 지정되지 않은 레시피가 있습니다.\n병원식단 레시피는 구성요소가 필수 입력입니다.\n\n구성요소(주식,국,부식등..)를 선택하여 주십시요."); 
			return false;
		}
		
		if(gfn_dsIsUpdated(ds_Menu))
		{
			blnRtn=g_Confirm("04", "저장되지 않은 데이터가 있습니다.\n구성요소를 변경하였을 경우 반드시 저장버튼을 눌러주십시요.\n\n레시피검색및 등록 창을 닫으시겠습니까?"); 
			return blnRtn;
		}
	}
	
}

function ds_Menu_CanColumnChange(obj:Dataset, e:DSColChangeEventInfo)
{
	
	//////////////////////////////////////////
	////// 병원용 
	//////////////////////////////////////////
	//병원용 식당일때만 확인한다.
	if(ds_Hall_class.getColumn(0,"HALL_CLASS")=="007" 	||
	   ds_Hall_class.getColumn(0,"HALL_CLASS")=="008" 	||
	   ds_Hall_class.getColumn(0,"HALL_CLASS")=="009"		)	// 병원 
	{
		if(e.columnid=="MAJOR_DISH_INFO")
		{	
			var intFindRow = -1;
			intFindRow = ds_Menu.findRow("MAJOR_DISH_INFO", e.newvalue);
			
			if(intFindRow<>-1)
			{
			   g_Message("EE", "이미 지정된 구성요소의 레시피가 있습니다.\n\n다른 구성요소 항목을 선택하여 주십시요."); 
			   return false;
			}
		}
	}
}

//============================================================================================
//(2009-01-14 추가) 시작
//            : 박은규 2009-01-14 CSR#(25617) 요청자:이명희(건강관리센터)
//              저렴한 자재찾기 기능 추가
//============================================================================================
function btn_CheapItem_OnClick(obj:Button, e:ClickEventInfo)
{
	g_Message("02", "저렴한 자재찾기 실행 시 자재별로 동일 소분류내에서 가장 저렴하지 않은 경우 자재코드 앞에 아이콘이 표시됩니다.");
	
	var strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc;
	
	// 경로 설정
	strSvcID = "FSM00060E_S004";
	strURL   = "U_svc::" + "fs/fsm/FSM00060E_S004.jsp";
	
	// 데이터셋 설정
	strInDatasets = "ds_Item=ds_Item";
	strOutDatasets = "ds_Item=ds_Item";
	
	// 콜백함수 지정
	strCallbackFunc = "";

	jsp_transaction(this,strSvcID,strURL,strInDatasets,strOutDatasets,strArgument,strCallbackFunc,false,false,true);
}
//============================================================================================
//(2009-01-14 추가) 끝
//============================================================================================


function ed_Feature_ontextchanged(obj:Edit,  e:TextChangedEventInfo)
{
 
	btn_MenuIns.userdata=1; 
}

function fn_getColorImage(COLOR) {


var ImagePath = "URL('theme://convertImages/"+COLOR+".bmp')";

//trace(ImagePath);

return ImagePath;

}

function fn_getBackImage(COND,VAL) {

    var BackImg = '';
    if(COND == 'DI_MON') {
		if(VAL == 1) {
		
		   BackImg = "URL('theme://images/new/grd_WF_N.png')";
		
		} else {
		   BackImg = '';
		}
		
	 //   trace(BackImg);
	} 
	
	//trace(ds_List.saveXML());
    
    return BackImg;

}

function fn_getBackImage1(COND,VAL) {

    var BackImg1 = '';
    if (COND == 'PHF') {
	      if(VAL == 'Y') {
	      
	           BackImg1 = "URL('theme://images/new/grd_WF_P.png')";
		
	      } else {
		       BackImg1 = '';
		  }
    }
    
    return BackImg1;

}  ]]></Script>
  </Form>
</FDL>

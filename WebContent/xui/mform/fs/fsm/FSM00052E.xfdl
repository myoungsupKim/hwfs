<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSM00052E" onload="form_onload" titletext="식단등록" position="absolute 0 0 1235 540" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="sta_detail00" class="sta_WFDA_Labelbg" position="absolute 10 505 1225 532" anchor="all"/>
        <Static id="sta_detail05" onclick="sta_detail05_onclick" class="sta_WFDA_Labelbg" position="absolute 10 13 528 40" anchor="left top"/>
        <Static id="st_pyoTitle" position="absolute 751 40 1150 62" class="sta_WF_DiscInfoN"/>
        <Div id="Div_pop" scrollbars="autoboth" taborder="3" text="Div0" visible="false" position="absolute 368 1192 618 1292">
          <Layouts>
            <Layout>
              <Grid enable="true" id="Grid0" useinputpanel="false" taborder="1" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 6 6 240 90" readonly="true" selecttype="row">
                <Formats>
                  <Format id="Default">
                    <Columns>
                      <Column size="230"/>
                    </Columns>
                    <Rows>
                      <Row size="18"/>
                    </Rows>
                    <Band id="body">
                      <Cell col="0" displaytype="text" style="align:left;"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
            </Layout>
          </Layouts>
        </Div>
        <Grid enable="true" id="Grid0" useinputpanel="false" taborder="4" tabstop="true" usecontextmenu="true" useselcolor="true" visible="false" wheelscrollrow="1" position="absolute 0 1192 364 1422" readonly="true" selecttype="row">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="18" band="head"/>
                <Row size="18"/>
              </Rows>
              <Band id="head">
                <Cell col="0" displaytype="text"/>
                <Cell col="1" displaytype="text"/>
                <Cell col="2" displaytype="text"/>
                <Cell col="3" displaytype="text"/>
                <Cell col="4" displaytype="text"/>
                <Cell col="5" displaytype="text"/>
                <Cell col="6" displaytype="text"/>
              </Band>
              <Band id="body">
                <Cell col="0" text="bind:fday" displaytype="text" style="align:left;"/>
                <Cell col="1" text="bind:wcd" displaytype="text" style="align:left;"/>
                <Cell col="2" text="bind:wcd" displaytype="text" style="align:left;"/>
                <Cell col="3" text="bind:we" displaytype="text" style="align:left;"/>
                <Cell col="4" text="bind:we_color" displaytype="text" style="align:left;"/>
                <Cell col="5" text="bind:wimg" displaytype="image" style="align:left;"/>
                <Cell col="6" text="bind:wnm" displaytype="text" style="align:left;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid enable="true" id="Grid1" useinputpanel="false" taborder="5" tabstop="true" usecontextmenu="true" useselcolor="true" visible="false" wheelscrollrow="1" position="absolute 624 1192 1009 1432" readonly="true" selecttype="row">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column band="left" size="55"/>
                <Column size="17"/>
                <Column size="95"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="95"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="95"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="95"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="95"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="95"/>
                <Column size="36"/>
                <Column size="17"/>
                <Column size="95"/>
                <Column size="36"/>
              </Columns>
              <Rows>
                <Row size="18" band="head"/>
                <Row size="18" band="head"/>
                <Row size="18"/>
                <Row size="18" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell col="0" displaytype="text" text="일자"/>
                <Cell col="0" displaytype="text" row="1" text="일정"/>
                <Cell col="1" colspan="2" displaytype="text" text="4/14(월)"/>
                <Cell col="3" displaytype="text" rowspan="2"/>
                <Cell col="1" colspan="2" displaytype="text" row="1"/>
                <Cell col="4" colspan="2" displaytype="text" text="4/15(화)"/>
                <Cell col="6" displaytype="text" rowspan="2"/>
                <Cell col="4" colspan="2" displaytype="text" row="1"/>
                <Cell col="7" colspan="2" displaytype="text" text="4/16(수)"/>
                <Cell col="9" displaytype="text" rowspan="2"/>
                <Cell col="7" colspan="2" displaytype="text" row="1"/>
                <Cell col="10" colspan="2" displaytype="text" text="4/17(목)"/>
                <Cell col="12" displaytype="text" rowspan="2"/>
                <Cell col="10" colspan="2" displaytype="text" row="1"/>
                <Cell col="13" colspan="2" displaytype="text" text="4/18(금)"/>
                <Cell col="15" displaytype="text" rowspan="2"/>
                <Cell col="13" colspan="2" displaytype="text" row="1"/>
                <Cell col="16" colspan="2" displaytype="text" text="4/19(토)"/>
                <Cell col="18" displaytype="text" rowspan="2"/>
                <Cell col="16" colspan="2" displaytype="text" row="1"/>
                <Cell col="19" colspan="2" displaytype="text" text="4/20(일)"/>
                <Cell col="21" displaytype="text" rowspan="2"/>
                <Cell col="19" colspan="2" displaytype="text" row="1"/>
              </Band>
              <Band id="body">
                <Cell col="0" displaytype="text" expr="expr:iif(gfn_length(cgbn_nm)==0, sgbn_nm+cgbn, sgbn_nm+cgbn+'&#10;('+cgbn_nm+')')" suppress="1" style="align:center;background:EXPR(iif(toNumber(toNumber(sgbn_no)/2) == parseInt(toNumber(sgbn_no)/2), '#E9FCFC', '#F6FCFC'));"/>
                <Cell col="1" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#e7e7ffff',iif(toNumber(toNumber(sgbn_no)/2) == parseInt(toNumber(sgbn_no)/2), '#E9FCFC', '#F6FCFC')));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(tot_gbn!='99' &amp;&amp; dup_sta_0414=='Y','■','')" style="backgroundimage:EXPR(iif(tot_gbn=='99' &amp;&amp; gfn_length(sd_nm_0414)&gt;0, 'btn_Delete', ''));color:EXPR(dup_color_0414);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0414" displaytype="text" style="color:EXPR(iif(tot_gbn=='99', '#000000', ''));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0414" displaytype="number" expr="expr:iif(tot_gbn=='99','',sd_won_0414)" style="align:right;"/>
                </Cell>
                <Cell col="4" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#e7e7ffff',iif(toNumber(toNumber(sgbn_no)/2) == parseInt(toNumber(sgbn_no)/2), '#E9FCFC', '#F6FCFC')));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(dup_sta_0415=='Y','■','')" style="backgroundimage:EXPR(iif(tot_gbn=='99' &amp;&amp; gfn_length(sd_nm_0415)&gt;0, 'btn_Delete', ''));color:EXPR(dup_color_0415);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0415" displaytype="text" style="color:EXPR(iif(tot_gbn=='99', '#000000', ''));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0415" displaytype="number" expr="expr:iif(tot_gbn=='99','',sd_won_0415)" style="align:right;"/>
                </Cell>
                <Cell col="7" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#e7e7ffff',iif(toNumber(toNumber(sgbn_no)/2) == parseInt(toNumber(sgbn_no)/2), '#E9FCFC', '#F6FCFC')));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(dup_sta_0416=='Y','■','')" style="backgroundimage:EXPR(iif(tot_gbn=='99' &amp;&amp; gfn_length(sd_nm_0416)&gt;0, 'btn_Delete', ''));color:EXPR(dup_color_0416);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0416" displaytype="text" style="color:EXPR(iif(tot_gbn=='99', '#000000', ''));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0416" displaytype="number" expr="expr:iif(tot_gbn=='99','',sd_won_0416)" style="align:right;"/>
                </Cell>
                <Cell col="10" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#e7e7ffff',iif(toNumber(toNumber(sgbn_no)/2) == parseInt(toNumber(sgbn_no)/2), '#E9FCFC', '#F6FCFC')));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(dup_sta_0417=='Y','■','')" style="backgroundimage:EXPR(iif(tot_gbn=='99' &amp;&amp; gfn_length(sd_nm_0417)&gt;0, 'btn_Delete', ''));color:EXPR(dup_color_0417);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0417" displaytype="text" style="color:EXPR(iif(tot_gbn=='99', '#000000', ''));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0417" displaytype="number" expr="expr:iif(tot_gbn=='99','',sd_won_0417)" style="align:right;"/>
                </Cell>
                <Cell col="13" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#e7e7ffff',iif(toNumber(toNumber(sgbn_no)/2) == parseInt(toNumber(sgbn_no)/2), '#E9FCFC', '#F6FCFC')));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(dup_sta_0418=='Y','■','')" style="backgroundimage:EXPR(iif(tot_gbn=='99' &amp;&amp; gfn_length(sd_nm_0418)&gt;0, 'btn_Delete', ''));color:EXPR(dup_color_0418);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0418" displaytype="text" style="color:EXPR(iif(tot_gbn=='99', '#000000', ''));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0418" displaytype="number" expr="expr:iif(tot_gbn=='99','',sd_won_0418)" style="align:right;"/>
                </Cell>
                <Cell col="16" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#e7e7ffff',iif(toNumber(toNumber(sgbn_no)/2) == parseInt(toNumber(sgbn_no)/2), '#E9FCFC', '#F6FCFC')));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(dup_sta_0419=='Y','■','')" style="backgroundimage:EXPR(iif(tot_gbn=='99' &amp;&amp; gfn_length(sd_nm_0419)&gt;0, 'btn_Delete', ''));color:EXPR(dup_color_0419);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0419" displaytype="text" style="color:EXPR(iif(tot_gbn=='99', '#000000', ''));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0419" displaytype="number" expr="expr:iif(tot_gbn=='99','',sd_won_0419)" style="align:right;"/>
                </Cell>
                <Cell col="19" colspan="3" displaytype="text" suppress="2" style="background:EXPR(iif(tot_gbn=='99', '#e7e7ffff',iif(toNumber(toNumber(sgbn_no)/2) == parseInt(toNumber(sgbn_no)/2), '#E9FCFC', '#F6FCFC')));align:left;">
                  <Cell col="0" displaytype="text" expr="expr:iif(dup_sta_0420=='Y','■','')" style="backgroundimage:EXPR(iif(tot_gbn=='99' &amp;&amp; gfn_length(sd_nm_0420)&gt;0, 'btn_Delete', ''));color:EXPR(dup_color_0420);align:left;"/>
                  <Cell col="1" text="bind:sd_nm_0420" displaytype="text" style="color:EXPR(iif(tot_gbn=='99', '#000000', ''));align:left;"/>
                  <Cell col="2" text="bind:sd_won_0420" displaytype="number" expr="expr:iif(tot_gbn=='99','',sd_won_0420)" style="align:right;"/>
                </Cell>
              </Band>
              <Band id="summary">
                <Cell col="0" displaytype="text" text="평균원가" style="align:left;"/>
                <Cell col="1" colspan="3" displaytype="text" text="966원(35.0%)" style="align:center;"/>
                <Cell col="4" colspan="3" displaytype="text" text="1,050원(30.4%)" style="align:center;"/>
                <Cell col="7" colspan="3" displaytype="text" text="650원(23.8%)" style="align:center;"/>
                <Cell col="10" colspan="3" displaytype="text" text="903원(33.1%)" style="align:center;"/>
                <Cell col="13" colspan="3" displaytype="text" text="629원(23.1%)" style="align:center;"/>
                <Cell col="16" colspan="3" displaytype="text" style="align:center;"/>
                <Cell col="19" colspan="3" displaytype="text" style="align:center;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid selecttype="row" cellsizingtype="both" enable="true" id="grd_lst" useinputpanel="false" oncellclick="grd_lst_OnCellClick" onmouseleave="grd_lst_OnMouseOut" onmousemove="grd_lst_OnMouseOver" onrbuttondown="grd_lst_OnRButtonDown" taborder="1" tabstop="true" usecontextmenu="true" useselcolor="false" visible="true" wheelscrollrow="1" position="absolute 10 52 1226 504" readonly="true" anchor="all">
          <Formats/>
        </Grid>
        <Button id="btn_fcopy" onclick="btn_fcopy_OnClick" taborder="7" position="absolute 799 16 874 37" class="btn_WF_Custom" image="" text="식단복사" anchor="top right"/>
        <Button id="btn_recipe" onclick="btn_recipe_OnClick" taborder="8" position="absolute 875 16 986 37" class="btn_WF_Custom" image="" text="MY레시피구성" anchor="top right"/>
        <Button id="btn_pyo" taborder="9" position="absolute 1151 16 1226 37" class="btn_WF_Custom" image="" text="식단평가" anchor="top right" onclick="btn_pyo_onclick"/>
        <Button id="btn_rut" onclick="btn_rut_OnClick" taborder="10" position="absolute 987 16 1062 37" class="btn_WF_Custom" image="" text="영양분석" anchor="top right"/>
        <Button id="btn_ExcelPrint" onclick="btn_ExcelPrint_OnClick" taborder="11" position="absolute 1063 16 1150 37" class="btn_WF_Custom" image="" text="EXCEL" anchor="top right"/>
        <Static id="Static01" text="식당 목표식재료율(주간)" position="absolute 10 13 160 40" class="sta_WFDA_Label01" style="align:left;" onclick="Static01_onclick" anchor="left top"/>
        <Static id="Static0" text="식당 예상식재료율" position="absolute 241 13 377 40" class="sta_WFDA_Label01" anchor="left top"/>
        <MaskEdit id="me_bSikRate" mask="##0.0" readonly="true" taborder="18" position="absolute 379 15 420 36" anchor="left top"/>
        <Button id="Button03" onclick="Button03_OnClick" taborder="19" text="   구매게시판" position="absolute 1048 508 1148 529" class="btn_WF_Custom" anchor="right bottom"/>
        <Button id="Button04" onclick="Button04_OnClick" taborder="20" position="absolute 1150 508 1225 530" class="btn_WF_Custom" image="" anchor="right bottom" text="구매신청"/>
        <ImageViewer id="Image1" image="URL('theme://convertImages/img_FlagGreen.png')" taborder="22" position="absolute 10 510 26 526" anchor="left bottom"/>
        <Static id="Static2" text="마우스 버튼클릭 : 오른쪽 버튼-&gt;MY레시피등록, 왼쪽 버튼-&gt;레시피검색 및 등록/수정" position="absolute 29 508 549 529" class="sta_WFDA_Labelbg" anchor="left bottom"/>
        <Div id="div_pyo" taborder="23" text="Div0" url="U_FSM::FSM00160V.xfdl" visible="false" position="absolute 745 53 1225 463" scrollbars="none" anchor="top right"/>
        <ImageViewer id="img_open_close" image="URL('theme://convertImages/img_OpenBottom.png')" transparenthittest="false" taborder="24" position="absolute 1189 40 1225 52" onclick="img_open_close_onclick" anchor="top right"/>
        <Static id="st_memo" position="absolute 444 15 525 37" class="sta_WFDA_Labelbg" anchor="left top"/>
        <FlashPlayer id="swFlash0" taborder="27" visible="false" position="absolute 21 552 43 574"/>
        <TextArea id="TextArea0" ontextchanged="cbo_HALL_CD_OnChanged" taborder="2" value="TextArea0" visible="false" position="absolute 4 1116 764 1187"/>
        <Static id="Static6" text="원가 갱신일" position="absolute 551 505 666 532" class="sta_WFDA_Label01" anchor="left bottom"/>
        <MaskEdit id="me_Sdate" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="29" type="string" position="absolute 668 508 746 529" anchor="left bottom"/>
        <Button id="btn_Sdate" onclick="g_CalButton_OnClick" taborder="30" tabstop="false" text="" userdata="me_Sdate" position="absolute 745 508 767 529" class="btn_WF_cal" image="" anchor="left bottom"/>
        <Button id="btn_RSave" onclick="btn_RSave_OnClick" taborder="28" tabstop="false" text="원가 갱신" position="absolute 773 508 850 530" class="btn_WF_Custom" image="" anchor="left bottom"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 11 1235 24" onclick="Static15_onclick"/>
        <Static id="Static06" text="h13" onclick="Static02_onclick" class="Guide01_AreaRed" visible="false" position="absolute 0 19 10 549"/>
        <Static id="Static16" text="글자기준간격 h05" onclick="Static16_onclick" class="Guide01_AreaRed" visible="false" position="absolute 0 37 1235 42"/>
        <Static id="Static02" text="h13" onclick="Static02_onclick" class="Guide01_AreaRed" visible="false" position="absolute 1225 11 1235 541"/>
        <Static id="Static03" text="글자기준간격 h05" onclick="Static16_onclick" class="Guide01_AreaRed" visible="false" position="absolute 0 534 1235 546"/>
        <Static id="Static04" text="%" position="absolute 222 17 245 38" anchor="left top"/>
        <Static id="Static05" text="%" position="absolute 425 18 448 39" anchor="left top"/>
        <Static id="Static10" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 1210 16 1225 37"/>
        <MaskEdit id="me_sikrate" taborder="31" mask="###.0" ontextchanged="me_sikrate_OnChanged" position="absolute 164 16 219 36" anchor="left top"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="DS_menu">
        <ColumnInfo>
          <Column id="column0" size="256" type="STRING"/>
          <Column id="column1" size="256" type="STRING"/>
          <Column id="column2" size="256" type="STRING"/>
          <Column id="column3" size="256" type="STRING"/>
          <Column id="column4" size="256" type="STRING"/>
          <Column id="column5" size="256" type="STRING"/>
          <Column id="column6" size="256" type="STRING"/>
          <Column id="column7" size="256" type="STRING"/>
          <Column id="column8" size="256" type="STRING"/>
          <Column id="column9" size="256" type="STRING"/>
          <Column id="column10" size="256" type="STRING"/>
          <Column id="column11" size="256" type="STRING"/>
          <Column id="column12" size="256" type="STRING"/>
          <Column id="column13" size="256" type="STRING"/>
          <Column id="column14" size="256" type="STRING"/>
          <Column id="column15" size="256" type="STRING"/>
          <Column id="column16" size="256" type="STRING"/>
          <Column id="column17" size="256" type="STRING"/>
          <Column id="column18" size="256" type="STRING"/>
          <Column id="column19" size="256" type="STRING"/>
          <Column id="column20" size="256" type="STRING"/>
          <Column id="column21" size="256" type="STRING"/>
          <Column id="column22" size="256" type="STRING"/>
          <Column id="column23" size="256" type="STRING"/>
          <Column id="column24" size="256" type="STRING"/>
          <Column id="column25" size="256" type="STRING"/>
          <Column id="column26" size="256" type="STRING"/>
          <Column id="column27" size="256" type="STRING"/>
          <Column id="column28" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_head">
        <ColumnInfo>
          <Column id="fday" size="256" type="STRING"/>
          <Column id="we" size="256" type="STRING"/>
          <Column id="we_color" size="256" type="STRING"/>
          <Column id="wcd" size="256" type="STRING"/>
          <Column id="wnm" size="256" type="STRING"/>
          <Column id="wimg" size="256" type="STRING"/>
          <Column id="rem" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_body">
        <ColumnInfo>
          <Column id="fday" size="256" type="STRING"/>
          <Column id="sgbn" size="256" type="STRING"/>
          <Column id="sgbn_nm" size="256" type="STRING"/>
          <Column id="cgbn" size="256" type="STRING"/>
          <Column id="cgbn_nm" size="256" type="STRING"/>
          <Column id="cgbn_cd" size="256" type="STRING"/>
          <Column id="dup_sta" size="256" type="STRING"/>
          <Column id="dup_color" size="256" type="STRING"/>
          <Column id="sseq" size="256" type="STRING"/>
          <Column id="sd_cd" size="256" type="STRING"/>
          <Column id="sd_nm" size="256" type="STRING"/>
          <Column id="sd_won" size="256" type="STRING"/>
          <Column id="meal_price" size="256" type="STRING"/>
          <Column id="RECIPE_COST_RATE" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_body_f">
        <ColumnInfo>
          <Column id="CGBN" size="100" type="STRING"/>
          <Column id="CGBN_CD" size="20" type="STRING"/>
          <Column id="CGBN_NM" size="50" type="STRING"/>
          <Column id="DUP_COLOR" size="3" type="STRING"/>
          <Column id="DUP_STA" size="1" type="STRING"/>
          <Column id="FDAY" size="8" type="STRING"/>
          <Column id="MEAL_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_COST_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="SD_CD" size="20" type="STRING"/>
          <Column id="SD_NM" size="50" type="STRING"/>
          <Column id="SD_WON" size="22" type="BIGDECIMAL"/>
          <Column id="SGBN" size="20" type="STRING"/>
          <Column id="SGBN_NM" size="100" type="STRING"/>
          <Column id="SSEQ" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR">RED</Col>
            <Col id="DUP_STA">Y</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071120</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071121</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR">RED</Col>
            <Col id="DUP_STA">Y</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071122</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR">RED</Col>
            <Col id="DUP_STA">Y</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR">RED</Col>
            <Col id="DUP_STA">Y</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">B</Col>
            <Col id="CGBN_CD">002</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071123</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">001</Col>
            <Col id="SGBN_NM">조식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">55.6</Col>
            <Col id="SD_CD">A00003</Col>
            <Col id="SD_NM">테스트레시피3</Col>
            <Col id="SD_WON">556</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">1</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">26.5</Col>
            <Col id="SD_CD">A00004</Col>
            <Col id="SD_NM">테스트레시피4</Col>
            <Col id="SD_WON">265</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">2</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">58.5</Col>
            <Col id="SD_CD">A00005</Col>
            <Col id="SD_NM">테스트레시피5</Col>
            <Col id="SD_WON">585</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">3</Col>
          </Row>
          <Row>
            <Col id="CGBN">A</Col>
            <Col id="CGBN_CD">001</Col>
            <Col id="CGBN_NM"/>
            <Col id="DUP_COLOR"/>
            <Col id="DUP_STA">N</Col>
            <Col id="FDAY">20071124</Col>
            <Col id="MEAL_PRICE">2000</Col>
            <Col id="RECIPE_COST_RATE">29.2</Col>
            <Col id="SD_CD">A00002</Col>
            <Col id="SD_NM">테스트레시피2</Col>
            <Col id="SD_WON">292</Col>
            <Col id="SGBN">002</Col>
            <Col id="SGBN_NM">중식</Col>
            <Col id="SSEQ">4</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="DS_body_c" keystring="fday:sgbn:cgbn:cgbn_cd:sgbn_nm:cgbn_nm">
        <ColumnInfo>
          <Column id="column0" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_sgbn">
        <ColumnInfo>
          <Column id="sgbn" size="256" type="STRING"/>
          <Column id="sgbn_nm" size="256" type="STRING"/>
          <Column id="cgbn" size="256" type="STRING"/>
          <Column id="cgbn_nm" size="256" type="STRING"/>
          <Column id="cgbn_cd" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_menu2" keystring="fday:sgbn:cgbn:cgbn_cd:sgbn_nm:cgbn_nm">
        <ColumnInfo>
          <Column id="column0" size="256" type="STRING"/>
          <Column id="column1" size="256" type="STRING"/>
          <Column id="column2" size="256" type="STRING"/>
          <Column id="column3" size="256" type="STRING"/>
          <Column id="column4" size="256" type="STRING"/>
          <Column id="column5" size="256" type="STRING"/>
          <Column id="column6" size="256" type="STRING"/>
          <Column id="column7" size="256" type="STRING"/>
          <Column id="column8" size="256" type="STRING"/>
          <Column id="column9" size="256" type="STRING"/>
          <Column id="column10" size="256" type="STRING"/>
          <Column id="column11" size="256" type="STRING"/>
          <Column id="column12" size="256" type="STRING"/>
          <Column id="column13" size="256" type="STRING"/>
          <Column id="column14" size="256" type="STRING"/>
          <Column id="column15" size="256" type="STRING"/>
          <Column id="column16" size="256" type="STRING"/>
          <Column id="column17" size="256" type="STRING"/>
          <Column id="column18" size="256" type="STRING"/>
          <Column id="column19" size="256" type="STRING"/>
          <Column id="column20" size="256" type="STRING"/>
          <Column id="column21" size="256" type="STRING"/>
          <Column id="column22" size="256" type="STRING"/>
          <Column id="column23" size="256" type="STRING"/>
          <Column id="column24" size="256" type="STRING"/>
          <Column id="column25" size="256" type="STRING"/>
          <Column id="column26" size="256" type="STRING"/>
          <Column id="column27" size="256" type="STRING"/>
          <Column id="column28" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list">
        <ColumnInfo>
          <Column id="CD" size="50" type="STRING"/>
          <Column id="CNT" size="22" type="BIGDECIMAL"/>
          <Column id="INFO" size="4000" type="STRING"/>
          <Column id="NM" size="50" type="STRING"/>
          <Column id="TEXTCOLOR" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_input2">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="SDATE" size="256" type="STRING"/>
          <Column id="O_RTN" size="256" type="STRING"/>
          <Column id="O_RTNMSG" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_return">
        <ColumnInfo>
          <Column id="RTN" size="256" type="STRING"/>
          <Column id="RTNMSG" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="RTN"/>
            <Col id="RTNMSG"/>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item5" compid="sta_detail05" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item0" compid="sta_detail00" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item1" compid="me_sikrate" propid="value" datasetid="ds_sikrate" columnid="GOAL_COST_RATE"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/**
====================================================================================================(100)
 1. 시    스    템	: 	식자재관리
 2. 서브    시스템 	:   주간식단표조회
 3. 프로그램  개요 	: 	
 4. 작    성    자 	:  	
 5. 작    성    일 	: 	
====================================================================================================
 6. 수정자/수정일   : 
 7. 수정사유/내역   : 
====================================================================================================
**/
//===========================================================================================(90)
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//******************************************************************************************
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"

//******************************************************************************************
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//******************************************************************************************
//var	il_cnt		= 0;	// 기간에 해당되는 일수를 산정
var def_cha		= 2;	// 차감 col pointer
var open_win1	= 0;	// 차감 col pointer
var fa_gbn		= "FSM00050E";	// 차감 col pointer
var CurrentRow  = 0;

var v_sale_sum  = 0;    // 식당예상식재료율 계산용
var v_wonga_sum = 0;    // 식당예상식재료율 계산용

var iBGC        = "";
var sBGC        = "";
var sPrevMenu   = "";
var sCurrMenu   = "";


//******************************************************************************************
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//******************************************************************************************
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	// X-Framework : Action 정보 생성 
	fsp_init(this);
	
	var currDate = gfn_today();
	
	me_Sdate.value = gfn_addDate(currDate,1);	
	swFlash0.movie = gv_chartPath + "WorkingCercle.swf";
	swFlash0.play();
}

//******************************************************************************************
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//******************************************************************************************

/*------------------------------------------------------------(60)
	1. Function ID : fn_Search()
	2. 개       요 : 업무프로세스에 따른 조회작업
	3. 기       능 : 검색조건에 해당하는 정보를 조회
	4. 인 수 설 명 : 
*/
function fn_search()
{
	//if (Parent.fn_Search_chk() == false) {
	//	return false;
	//}
	
	
	//trace('search 2');
	
//	fn_week_create();
	// Data Loading ...
	// Grid Head : 주간 일정 [Local Data를 DataSet으로 전환--> 향후 서비스로 대체]
	//ext_ExcelImportByName("E:\\02_Project\\08_Hanhwa\\webapps\\FS\\HWFS_DATA\\DS_head.xls", "DS_head", "DS_head", 1);
	fn_Sel_DS_head();
	if (DS_head.getRowCount() == 0) {
		g_Message("EE",	"주간일정 정보가 없습니다.");
		return true;
	}

	// DS_sgbn : 식구분 [Local Data를 DataSet으로 전환--> 향후 서비스로 대체]
	//ext_ExcelImportByName("E:\\02_Project\\08_Hanhwa\\webapps\\FS\\HWFS_DATA\\DS_sgbn.xls", "DS_sgbn", "DS_sgbn", 1);
	fn_Sel_DS_sgbn();
	if (DS_sgbn.getRowCount() == 0) {
		g_Message("EE",	"식,끼니 정보가 없습니다.");
		return true;
	}

	// Grid Body : 주간식단표 [Local Data를 DataSet으로 전환--> 향후 서비스로 대체]
	//ext_ExcelImportByName("E:\\02_Project\\08_Hanhwa\\webapps\\FS\\HWFS_DATA\\DS_body.xls", "DS_body", "DS_body", 1);
	fn_Sel_DS_body();

	//alert("DS loading OK !!");

	// 작업용 DataSet 마련 - Grid용 DataSet 작성 작업용 (Filter 용)
	//DS_body_f.Clear();
	//DS_body_f.Copy("DS_body");

	// Grid에 사용할 DataSet을 작성합니다.
	
/////////////////////////////////////////////////////////////////20150129	
	grd_lst.enableredraw = false;
	grd_lst.binddataset = "";
    //trace('make menu 1');
  	fn_make_DS_menu(); 
// 
// 	// Grid Format을 작성합니다.
	grd_lst.binddataset = "";
	fn_make_grdlst();
	grd_lst.binddataset = "DS_menu";
	grd_lst.enableredraw = true;
/////////////////////////////////////////////////////////////////20150129
	// 식단평가에 기초셋팅을 한다.
	div_pyo.fn_Init();
	st_pyoTitle.text = "";
	return true;
}

function fn_afterSearch_head(errCode, errMsg)
{
	if(errCode!=0)
	{
		return;
	} else { 
	
	 // trace(DS_head.saveXML());
	
	}
}

function fn_afterSearch_sgbn(errCode, errMsg)
{
	if(errCode!=0)
	{
		return;
	} else { 
	
	 //  trace(DS_sgbn.saveXML());
	
	}
}

function fn_afterSearch_body(errCode, errMsg)
{
	if(errCode!=0)
	{
		return;
	} else { 
	
	    DS_body1.clear();
	    Copy(DS_body1,DS_body);
	   // trace(DS_body1.saveXML());
	
	}
}

/*------------------------------------------------------------
	1. Function ID : fn_Insert()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_insert()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Save()
	2. 개       요 : 업무프로세스에 따른 정보 저장작업
	3. 기       능 : 저장버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_save()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Delete()
	2. 개       요 : 업무프로세스에 따른 정보 삭제작업
	3. 기       능 : 삭제버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_delete()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Print()
	2. 개       요 : 업무프로세스에 따른 선별된 정보를 출력지로 인쇄
	3. 기       능 : 인쇄버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_print()
{
}

//******************************************************************************************
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//******************************************************************************************
/*
 ******************************************************************************************
	1. Function ID : fn_Sel_DS_head()
	2. 개       요 : 식단표의 Head 구성요소를 작성한다.
	3. 기       능 : 제공일에 해당하는 주의 기준 Head Data를 작성한다.
	4. 인 수 설 명 : 
 ******************************************************************************************
 */
function fn_Sel_DS_head()
{
	// 초기화
	DS_head.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "ds_input=ds_input";
	outData			= "DS_head=DS_head";
	callBackFnc		= "fn_afterSearch_head";
	
	fsp_clear(this); 
    fsp_addSearch(this, "fs/fsm:FSM00052E_S002");									// 조회 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
	http.Sync = false;

}

/*
 ******************************************************************************************
	1. Function ID : fn_Sel_DS_sgbn()
	2. 개       요 : 식단표의 좌측 기준정보(식,끼니)를 작성한다.
	3. 기       능 : 제공일에 해당하는 주의 좌측 기준정보(식,끼니)를 작성한다.
	4. 인 수 설 명 : 
 ******************************************************************************************
 */
function fn_Sel_DS_sgbn()
{
	// 초기화
	DS_sgbn.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "ds_input=ds_input";
	outData			= "DS_sgbn=DS_sgbn";
	callBackFnc		= "fn_afterSearch_sgbn";
	
	fsp_clear(this); 
    fsp_addSearch(this, "fs/fsm:FSM00052E_S001");									// 조회 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
	http.Sync = false;

}

/*
 ******************************************************************************************
	1. Function ID : fn_Sel_DS_body()
	2. 개       요 : 메뉴정보를 불러온다.
	3. 기       능 : 제공일에 해당하는 주의 메뉴정보를 불러온다.
	4. 인 수 설 명 : 
 ******************************************************************************************
 */
function fn_Sel_DS_body()
{
	// 초기화
	DS_body.clearData();
	
	// 조회
	/* X-FrameWork 사용 시
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "ds_input=ds_input";
	outData			= "DS_body=DS_body DS_body_f=DS_body";
	callBackFnc		= "fn_afterSearch";
	
	tit_clearActionInfo(this); 
    tit_addSearchActionInfo(this, "fs/fsm:FSM00052E_S003");									// 조회 
	http.Sync = true;
    tit_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
	http.Sync = false;
	*/
	
	// JSP 사용 시
	var ActionVal	= "";
	var OutDS		= "";
	var InDS		= "";
	var V_callback	= "fn_afterSearch_body";
	
	ActionVal    +="UPJANG="		+ wrapQuote(ds_input.getColumn(0, "UPJANG"));
	ActionVal    +=" HALL_CD="	    + wrapQuote(ds_input.getColumn(0, "HALL_CD"));
	ActionVal    +=" MENU_SDATE="	+ wrapQuote(ds_input.getColumn(0, "MENU_SDATE"));
	ActionVal    +=" SUBINV_CODE="	+ wrapQuote(ds_input.getColumn(0, "SUBINV_CODE"));
	
	OutDS = "DS_body=DS_body DS_body_f=DS_body";
	//alert(ActionVal);
	http.Sync	=true;
	Transaction("FSM00052E_S003","U_svc::" + "fs/fsm/FSM00052E_S003.jsp",InDS,OutDS,ActionVal,V_callback);
	http.Sync	=false;	

}

/*------------------------------------------------------------
	1. Function ID : fn_make_DS_menu()
	2. 개       요 : Grid body에 해당하는 DataSet을 작성
	3. 기       능 : Grid body Format에 맞게 DS_menu DataSet의 Format을 작성하고 DataSet Format에 맞게
	                 Data를 Loading 시킨다.
	4. 인 수 설 명 : 
*/
// function fn_make_DS_menu()
// {
// 	DS_menu.enableevent = false;
// 	
// 	var	Contents_ds = "";
// 	
// 	// DataSet format을 작성합니다.
// 	Contents_ds = '
// 	<Contents>
// 			<colinfo id="sgbn" 			size="256" type="STRING"/>
// 			<colinfo id="sgbn_nm" 		size="256" type="STRING"/>
// 			<colinfo id="cgbn" 			size="256" type="STRING"/>
// 			<colinfo id="cgbn_nm" 		size="256" type="STRING"/>
// 			<colinfo id="cgbn_cd" 		size="256" type="STRING"/>
// 			<colinfo id="sgbn_no" 		size="256" type="STRING"/>
// 			<colinfo id="tot_gbn" 		size="256" type="STRING"/>';
// 
// 	//G_debug("DS_head");
// 	for(var ii = 0; ii < il_cnt; ii++)
// 	{
// 		Contents_ds	+= '
// 			<colinfo id="phf_'				+gfn_mid(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="dup_sta_'			+gfn_mid(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="dup_color_'		+gfn_mid(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sseq_'				+gfn_mid(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sd_cd_'			+gfn_mid(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sd_nm_'			+gfn_mid(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sd_won_'			+gfn_mid(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="meal_price_'		+gfn_mid(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sale_price_'		+gfn_mid(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			
// 			<colinfo id="expect_qty_'		+gfn_mid(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			
// 			
// 			<colinfo id="recipe_cost_rate_'	+gfn_mid(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="main_item_code1_'	+gfn_mid(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="cuisine_type_'		+gfn_mid(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>';
// 	}
// 
// 	Contents_ds += '
// 	</Contents>';
// 
// 	/* Contents은 지원되지 않는 속성입니다.*/ DS_menu.Contents = Contents_ds;
// 	//TextArea0.Text   = Contents_ds;
// 	//G_debug("DS_sgbn");
// 	//alert(DS_menu.RowCount());
// 	
// 	// Data를 작성합니다. [ DS_body -> DS_menu Create ]
// 	var	cnt_ds_total = 0;
// 
// 	for(var ii = 0; ii < DS_sgbn.getRowCount(); ii++) {
// 	
// 		DS_body_f.filter("");
// 
// 		var	fil_cond = "";
// 		var	max_row	 = 0;
// 		
// 		fil_cond	+= "sgbn=='"+DS_sgbn.getColumn(ii, "sgbn")+"'&&cgbn=='"+DS_sgbn.getColumn(ii, "cgbn")+"'&&cgbn_cd=='"+DS_sgbn.getColumn(ii, "cgbn_cd")+"'";
// 
// 		DS_body_f.filter(fil_cond);
// 		DS_body_c.clear();
// 		CopyF(DS_body_c,DS_body_f);
// 
// 		//alert(DS_body_c.RowCount());
// 		DS_body_c.filter("sseq<>'99'");
// 		max_row = toNumber(DS_body_c.getMax("sseq"));
// 		max_row = max_row + 1;
// 		//alert(DS_body_c.RowCount());
// 		// DS_body_c.UnFilter();
// 
// 		// DS_menu DataSet에 Row를 생성
// 		for(var jj = 0; jj < max_row; jj++) {
// 			DS_menu.addRow();
// 		}
// 		
// 		//alert(DS_menu.RowCount());
// 		if (DS_body_c.getRowCount() == 0) {
// 			var set_row = cnt_ds_total;
// 			
// 			DS_menu.setColumn(set_row, "sgbn", 		DS_sgbn.getColumn(ii, "sgbn"));
// 			DS_menu.setColumn(set_row, "sgbn_nm", 	DS_sgbn.getColumn(ii, "sgbn_nm"));
// 			DS_menu.setColumn(set_row, "cgbn", 		DS_sgbn.getColumn(ii, "cgbn"));
// 			DS_menu.setColumn(set_row, "cgbn_nm", 	DS_sgbn.getColumn(ii, "cgbn_nm"));
// 			DS_menu.setColumn(set_row, "cgbn_cd", 	DS_sgbn.getColumn(ii, "cgbn_cd"));
// 			DS_menu.setColumn(set_row, "sgbn_no", 	(ii+1));
// 		}
// 		else {
// 			// 생성된 Row에 Data를 setup 한다
// 			for(var kk = 0; kk < DS_body_c.getRowCount(); kk++) {
// 			
// 				var set_row = cnt_ds_total + toNumber(DS_body_c.getColumn(kk, "sseq")) - 1;
// 				
// 				//if (toNumber(DS_body_c.GetColumn(kk, "sseq")) == 99) {
// 				if (GetRowType(DS_body_c,kk)== "logical") {
// 					set_row = cnt_ds_total + max_row - 1;
// 					DS_menu.setColumn(set_row, "tot_gbn", 	"99");
// 					DS_menu.setColumn(set_row, "sseq", 	"99");
// 				}
// 				else {
// 					DS_menu.setColumn(set_row, "tot_gbn", 	"");
// 				}
// 				
// 				DS_menu.setColumn(set_row, "sgbn", 		DS_body_c.getColumn(kk, "sgbn"));
// 				DS_menu.setColumn(set_row, "sgbn_nm", 	DS_body_c.getColumn(kk, "sgbn_nm"));
// 				DS_menu.setColumn(set_row, "cgbn", 		DS_body_c.getColumn(kk, "cgbn"));
// 				DS_menu.setColumn(set_row, "cgbn_nm", 	DS_body_c.getColumn(kk, "cgbn_nm"));
// 				DS_menu.setColumn(set_row, "cgbn_cd", 	DS_body_c.getColumn(kk, "cgbn_cd"));
// 				DS_menu.setColumn(set_row, "sgbn_no", 	(ii+1));
// 				//
// 				var set_col = gfn_mid(DS_body_c.getColumn(kk, "fday"),4,4);
// 				DS_menu.setColumn(set_row, "dup_sta_"	+set_col, 	DS_body_c.getColumn(kk, "dup_sta"));
// 				DS_menu.setColumn(set_row, "dup_color_"	+set_col, 	DS_body_c.getColumn(kk, "dup_color"));
// 				DS_menu.setColumn(set_row, "sseq_"		+set_col, 	DS_body_c.getColumn(kk, "sseq"));
// 				DS_menu.setColumn(set_row, "sd_cd_"		+set_col, 	DS_body_c.getColumn(kk, "sd_cd"));
// 				
// 				if (GetRowType(DS_body_c,kk)== "logical") {
// 					var	v_case			= "fday=='"+DS_body_c.getColumn(kk, "fday")+"'&&sgbn=='"+DS_body_c.getColumn(kk, "sgbn")+"'&&cgbn=='"+DS_body_c.getColumn(kk, "cgbn")+"'&&cgbn_cd=='"+DS_body_c.getColumn(kk, "cgbn_cd")+"'";
// 					var	v_price 		= DS_body_c.getCaseSum(v_case, "sd_won");
// 					var	v_meal_price 	= DS_body_c.getCaseAvg(v_case, "meal_price");
// 					var	v_sale_price 	= DS_body_c.getCaseAvg(v_case, "sale_price");
// 					var	v_expect_qty 	= DS_body_c.getCaseAvg(v_case, "expect_meal_qty");
// 					var	v_cost_rate 	= DS_body_c.getCaseSum(v_case, "recipe_cost_rate");
// 	
// 					DS_menu.setColumn(set_row, "sd_nm_"				+set_col, 	numFormat(v_price, 0)+"원"+"("+numFormat(Math.round((toNumber(v_price)/toNumber(v_sale_price))*100,1), 1)+"%)");
// 					DS_menu.setColumn(set_row, "sd_won_"			+set_col, 	v_price);
// 					DS_menu.setColumn(set_row, "meal_price_"		+set_col, 	v_meal_price);
// 					DS_menu.setColumn(set_row, "sale_price_"		+set_col, 	v_sale_price);
// 					DS_menu.setColumn(set_row, "expect_qty_"		+set_col, 	v_expect_qty);
// 					DS_menu.setColumn(set_row, "recipe_cost_rate_"	+set_col, 	numFormat(Math.round((toNumber(v_price)/toNumber(v_meal_price))*100,1), 1));
// 					DS_menu.setColumn(set_row, "phf_"				+set_col, 	"");
// 					DS_menu.setColumn(set_row, "main_item_code1_"	+set_col, 	"");
// 					DS_menu.setColumn(set_row, "cuisine_type_"		+set_col, 	"");
// 				}
// 				else {
// 					DS_menu.setColumn(set_row, "sd_nm_"				+set_col, 	DS_body_c.getColumn(kk, "sd_nm"));
// 					DS_menu.setColumn(set_row, "sd_won_"			+set_col, 	DS_body_c.getColumn(kk, "sd_won"));
// 					DS_menu.setColumn(set_row, "meal_price_"		+set_col, 	DS_body_c.getColumn(kk, "meal_price"));
// 					DS_menu.setColumn(set_row, "sale_price_"		+set_col, 	DS_body_c.getColumn(kk, "sale_price"));
// 					DS_menu.setColumn(set_row, "expect_qty_"		+set_col, 	DS_body_c.getColumn(kk, "expect_meal_qty"));
// 					DS_menu.setColumn(set_row, "recipe_cost_rate_"	+set_col, 	DS_body_c.getColumn(kk, "recipe_cost_rate"));
// 					DS_menu.setColumn(set_row, "phf_"				+set_col, 	DS_body_c.getColumn(kk, "phf"));
// 					DS_menu.setColumn(set_row, "main_item_code1_"	+set_col, 	DS_body_c.getColumn(kk, "main_item_code1"));
// 					DS_menu.setColumn(set_row, "cuisine_type_"		+set_col, 	DS_body_c.getColumn(kk, "cuisine_type"));
// 				}
// 			}
// 		}
// 		
// 		// DS_menu Row 위치를 산정하기 위한 누적값
// 		cnt_ds_total = cnt_ds_total + max_row;
// 		
// 	}
// 	//
// 	DS_menu.rowposition = 0;
// 	DS_menu.applyChange();
// 	//g_debug("DS_menu");	
// 	// 식당예상 식재료율을 구하기 위한 dataset을 생성
// 	DS_menu.filter("tot_gbn=='99'");
// 	CopyF(DS_menu2,DS_menu);
// 	DS_menu.filter("");
// 	
// 	DS_menu.enableevent = true;
// 	//G_debug("DS_menu2");
// }
// 
// /*------------------------------------------------------------
// 	1. Function ID : fn_make_grdlst()
// 	2. 개       요 : 조건에 맞는 Grid Format을 작성
// 	3. 기       능 : 검색조건 기간이 유동적으로 구성되므로 조건에 해당하는 정보를 화면으로
// 	                 출력하기 위해 Grid를 재구성한다.
// 	4. 인 수 설 명 : 
// */
// function fn_make_grdlst()
// {
// //alert(il_cnt);
// 	var Contents_grd_lst	= "";
// // 
// // Grid를 작성합니다.
// //
// 	Contents_grd_lst	= '
// <contents>
// 	<format id="Default">
// 		<columns>
// 			<col fix="left" width="55"/>';
// 	// Grid columns를 작성합니다.
// 	for(var ii = 0; ii < il_cnt; ii++)
// 	{
// 		Contents_grd_lst	+= '
// 				<col width="17"/>
// 				<col width="95"/>
// 				<col width="36"/>';
// 	}
// 	
// 	Contents_grd_lst	+= '
// 			</columns>';
// 
// 	// Grid head를 작성합니다.
// 	Contents_grd_lst	+= '
// 		<head>
// 			<cell bkcolor="#5485be" color="white" col="0" display="text" text="일자"/>
// 			<cell bkcolor="#5485be" color="white" col="0" display="text" row="1" text="일정"/>';
// 
// 	var	v_col1 = -2;
// 	var	v_col2 = 0;
// 	var	v_day  = "";
// 
// 	for(var ii = 0; ii < il_cnt; ii++)
// 	{
// 		v_col1 	= v_col1 + 3;
// 		v_col2 	= v_col2 + 3;
// 		
// 		v_day	= toNumber(gfn_mid(DS_head.getColumn(ii, "fday"),4,2)) + "/" + toNumber(gfn_mid(DS_head.getColumn(ii, "fday"),6,2))
// 				+ "(" + DS_head.getColumn(ii, "we") + ")";
// 				// + " " + DS_head.GetColumn(ii, "wnm");
// 		
// 		Contents_grd_lst	+= '
// 				<cell bkcolor="#5485be" color="#'+DS_head.getColumn(ii, "we_color")+'" col="'+v_col1+'" colspan="2" display="text" text="'+v_day+'"/>';
// 		Contents_grd_lst	+= '
// 				<cell bkcolor="#5485be" bkimageid="'+DS_head.getColumn(ii, "wimg")+'" col="'+v_col2+'" display="text" rowspan="2"/>';
// 		if (gfn_length(DS_head.getColumn(ii, "rem"))> 8) {
// 		Contents_grd_lst	+= '
// 				<cell bkcolor="#5485be" color="#'+DS_head.getColumn(ii, "we_color")+'" col="'+v_col1+'" colspan="2" display="text" row="1" text="'+gfn_mid(DS_head.getColumn(ii, "rem"),0,8)+".."+'"/>';
// 		}
// 		else {
// 		Contents_grd_lst	+= '
// 				<cell bkcolor="#5485be" color="#'+DS_head.getColumn(ii, "we_color")+'" col="'+v_col1+'" colspan="2" display="text" row="1" text="'+DS_head.getColumn(ii, "rem")+'"/>';
// 		}
// 	}
// 	
// 	Contents_grd_lst	+= '
// 		</head>
// 		<body>
// 			<cell align="center" bkcolor="expr:iif(toNumber(toNumber(sgbn_no)/2)&#32;==&#32;toInteger(toNumber(sgbn_no)/2),&#32;&apos;#E9FCFC&apos;,&#32;&apos;#F6FCFC&apos;)" col="0" display="text" font="굴림,8,Bold" expr="iif(length(cgbn_nm)==0,&#32;sgbn_nm+cgbn,&#32;sgbn_nm+cgbn+&apos;'+'&#10;'+'(&apos;+cgbn_nm+&apos;)&apos;)" suppress="1" SuppressAlign="Middle"/>';
// 			// 코너명칭 2줄로 출력
// 			//<cell align="center" bkcolor="expr:iif(toNumber(toNumber(sgbn_no)/2)&#32;==&#32;toInteger(toNumber(sgbn_no)/2),&#32;&apos;white&apos;,&#32;&apos;#E3F3FF&apos;)" col="0" display="text" font="굴림,9,Bold" expr="iif(cgbn_cd==&apos;0&apos;,&#32;sgbn_nm+cgbn,&#32;sgbn_nm+cgbn+&apos;'+'&#10;'+'(&apos;+cgbn_nm+&apos;)&apos;)" suppress="1" SuppressAlign="Middle"/>';
// 		
// 	// Grid body를 작성합니다.
// 	var	v_col3 = 0;
// 	var	v_seq  = "";
// 	
// 	for(var ii = 0; ii < il_cnt; ii++)
// 	{
// 		v_col3 = (ii * 3) + 1;
// 		v_seq  = gfn_mid(DS_head.getColumn(ii, "fday"),4,4);
// 		
// 				//<cell bkcolor="expr:iif(tot_gbn==&apos;99&apos;,&#32;&apos;#DDFCDB&apos;,&apos;white&apos;)" col="'+v_col3+'" colspan="3" display="text" suppress="2" Text="" SuppressAlign="Middle">
// 		Contents_grd_lst	+= '
// 				<cell bkcolor="expr:iif(tot_gbn==&apos;99&apos;,&#32;&apos;user0&apos;,iif(toNumber(toNumber(sgbn_no)/2)&#32;==&#32;toInteger(toNumber(sgbn_no)/2),&#32;&apos;#E9FCFC&apos;,&#32;&apos;#F6FCFC&apos;))" col="'+v_col3+'" colspan="3" display="text" suppress="2" Text="" SuppressAlign="Middle" cursor="expr:iif(tot_gbn==&apos;99&apos;&#32;&amp;&amp;&#32;length(sd_nm_'+v_seq+')&gt;0,&#32;&apos;NO&apos;,&#32;&apos;HAND&apos;)">
// 					<cell bkimageid="expr:iif(tot_gbn==&apos;99&apos;&#32;&amp;&amp;&#32;length(sd_nm_'+v_seq+')&gt;0,&#32;&apos;btn_Delete&apos;,&#32;&apos;&apos;)" col="0" color="expr:dup_color_'+v_seq+'" display="text" font="굴림,8" expr="iif(tot_gbn!=&apos;99&apos;&#32;&amp;&amp;&#32;dup_sta_'+v_seq+'==&apos;Y&apos;,&apos;■&apos;,&apos;&apos;)" />
// 					<cell col="1" colid="sd_nm_'+v_seq+'" display="text" font="굴림,8" color="expr:iif(tot_gbn==&apos;99&apos;,&#32;&apos;#000000&apos;,&#32;&apos;&apos;)" />
// 					<cell align="right" col="2" colid="sd_won_'+v_seq+'" display="number" font="굴림,8" expr="IIF(tot_gbn==&apos;99&apos;,&apos;&apos;,sd_won_'+v_seq+')" />
// 				</cell>';
// 
// 	}
// 	Contents_grd_lst	+= '
// 		</body>';
// 	// Grid Summary를 작성합니다.
// 		Contents_grd_lst	+= '
// 		<summary>
// 			<cell bkcolor="user1" col="0" display="text" color="#993300" font="굴림,8,Bold" text="평균원가"/>';
// 
// 	v_col3 = 0;
// 	v_seq  = "";
// 
// 	v_sale_sum  = 0;
// 	v_wonga_sum = 0;
// 	
// 	for(var ii = 0; ii < il_cnt; ii++)
// 	{
// 		v_col3 = (ii * 3) + 1;
// 		v_seq  = gfn_mid(DS_head.getColumn(ii, "fday"),4,4);
// 		var v_sale      = 0;
// 		var v_wonga     = 0;
// 		var v_expect_qty  = 0;
// 		
// 		for(var jj = 0; jj < DS_menu.rowcount; jj++) {
// 			if ( DS_menu.getColumn(jj, "tot_gbn") == "99") {
// 				v_sale	+= ( toNumber(DS_menu.getColumn(jj, "sale_price_"+v_seq)) * toNumber(DS_menu.getColumn(jj, "expect_qty_"+v_seq)) );
// 				v_wonga	+= ( toNumber(DS_menu.getColumn(jj, "sd_won_"+v_seq))     * toNumber(DS_menu.getColumn(jj, "expect_qty_"+v_seq)) );	
// 				v_expect_qty += toNumber(DS_menu.getColumn(jj, "expect_qty_"+v_seq));
// 
// 				v_sale_sum	+= ( toNumber(DS_menu.getColumn(jj, "sale_price_"+v_seq)) * toNumber(DS_menu.getColumn(jj, "expect_qty_"+v_seq)) );
// 				v_wonga_sum	+= ( toNumber(DS_menu.getColumn(jj, "sd_won_"+v_seq))     * toNumber(DS_menu.getColumn(jj, "expect_qty_"+v_seq)) );	
// 			
// 			}
// 		}
// 
// 		//var v_won	= toNumber(DS_menu.CaseSum("tot_gbn=='99'", "sd_won_"+v_seq),0);
// 		//var v_price	= toNumber(DS_menu.CaseSum("tot_gbn=='99'", "sale_price_"+v_seq),0);
// 		var v_cnt	= toNumber(DS_menu.getCaseCount("tot_gbn=='99' && sd_won_"+v_seq+">0"),0);
// 		
// 		if (v_cnt > 0) {
// 			Contents_grd_lst	+= '
// 				<cell align="center" bkcolor="user1" col="'+v_col3+'" colspan="3" display="text" color="#993300" font="굴림,8,Bold" text="'+numFormat(v_wonga/v_expect_qty, 0)+'원('+numFormat((v_wonga/v_sale)*100, 1)+'%)'+'"/>';
// 		}
// 		else {
// 			Contents_grd_lst	+= '
// 				<cell align="center" bkcolor="user1" col="'+v_col3+'" colspan="3" display="text" color="#993300" font="굴림,8,Bold" text=""/>';
// 		}
// 	}
// 
// 	Contents_grd_lst	+= '
// 		</summary>
// 	</format>
// </contents>
// 	';
// 	// 
// 	//			<cell bkcolor="expr:iif(tot_gbn==&apos;99&apos;,&#32;&apos;#ECE9D8&apos;,(iif(toNumber(toNumber(sgbn_no)/2)&#32;==&#32;toInteger(toNumber(sgbn_no)/2),&#32;&apos;white&apos;,&#32;&apos;#E8F5FF&apos;)))" col="'+v_col3+'" colspan="3" display="text" suppress="2" Text="" SuppressAlign="Middle">
// 	// Grid End
// 	// 
// 	
// 	grd_lst.formats = Contents_grd_lst;
// 	TextArea0.value = grd_lst.formats;
// 	
// 	// 식당예상 식재료율을 계산합니다.
// 	// 
// 	fn_me_bSikRate();
// }

function fn_make_DS_menu()
{	 
	DS_menu.enableevent = false;
	
    DS_menu.clear();  
	
// 			<colinfo id="dup_sta_'			+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="dup_color_'		+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sseq_'				+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sd_cd_'			+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sd_nm_'			+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sd_won_'			+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="meal_price_'		+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sale_price_'		+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			
// 			<colinfo id="expect_won_amt_'	+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="expect_sale_amt_'	+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			
// 			<colinfo id="recipe_cost_rate_'	+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>';
// 	
// 	
// 	var	Contents_ds = "";
// 	
// 	// DataSet format을 작성합니다.
// 	Contents_ds = '
// 	<Contents>
// 			<colinfo id="sgbn" 			size="256" type="STRING"/>
// 			<colinfo id="sgbn_nm" 		size="256" type="STRING"/>
// 			<colinfo id="cgbn" 			size="256" type="STRING"/>
// 			<colinfo id="cgbn_nm" 		size="256" type="STRING"/>
// 			<colinfo id="cgbn_cd" 		size="256" type="STRING"/>
// 			<colinfo id="sgbn_no" 		size="256" type="STRING"/>
// 			<colinfo id="tot_gbn" 		size="256" type="STRING"/>';
// 
// 	//G_debug("DS_head");
// 	for(var ii = 0; ii < il_cnt; ii++)
// 	{
// 		Contents_ds	+= '
// 			<colinfo id="dup_sta_'			+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="dup_color_'		+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sseq_'				+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sd_cd_'			+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sd_nm_'			+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sd_won_'			+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="meal_price_'		+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="sale_price_'		+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			
// 			<colinfo id="expect_won_amt_'	+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			<colinfo id="expect_sale_amt_'	+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>
// 			
// 			<colinfo id="recipe_cost_rate_'	+gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4)+'"	size="256" type="STRING"/>';
// 	}
// 
// 	Contents_ds += '
// 	</Contents>';
// 
// 	/* Contents은 지원되지 않는 속성입니다.*/ DS_menu.Contents = Contents_ds;
// 	//TextArea0.Text   = Contents_ds;
// 	//G_debug("DS_sgbn");
// 	//alert(DS_menu.RowCount());


    DS_menu.addColumn('sgbn'   , 'STRING', 256);
	DS_menu.addColumn('sgbn_nm', 'STRING', 256);
	DS_menu.addColumn('cgbn'   , 'STRING', 256);
	DS_menu.addColumn('cgbn_nm', 'STRING', 256);
	DS_menu.addColumn('cgbn_cd', 'STRING', 256);
	DS_menu.addColumn('sgbn_no', 'STRING', 256);
	DS_menu.addColumn('tot_gbn', 'STRING', 256);
	DS_menu.addColumn('sseq'   , 'STRING', 256);
	
	
	//trace('il_cnt => '+ il_cnt);
	
	for(var ii = 0; ii < il_cnt; ii++)
	{
// 		DS_menu.addColumn('dup_sta_'			+ gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
// 		DS_menu.addColumn('dup_color_'		    + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
// 		DS_menu.addColumn('sseq_'		        + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
// 		DS_menu.addColumn('sd_cd_'		        + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
// 		DS_menu.addColumn('sd_nm_'		        + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
// 		DS_menu.addColumn('sd_won_'		        + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
// 		DS_menu.addColumn('meal_price_'	        + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
// 		DS_menu.addColumn('sale_price_'	        + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
// 		DS_menu.addColumn('expect_won_amt_'	    + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
// 		DS_menu.addColumn('expect_sale_amt_'	+ gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);
// 		DS_menu.addColumn('recipe_cost_rate_'   + gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4), 'STRING', 256);

		DS_menu.addColumn('phf_'              +gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4),'STRING'    ,256);
		DS_menu.addColumn('dup_sta_'          +gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4),'STRING'    ,256);
		DS_menu.addColumn('dup_color_'        +gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4),'STRING'    ,256);
		DS_menu.addColumn('sseq_'             +gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4),'STRING'    ,256);
		DS_menu.addColumn('sd_cd_'            +gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4),'STRING'    ,256);
		DS_menu.addColumn('sd_nm_'            +gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4),'STRING'    ,256);
		DS_menu.addColumn('sd_won_'           +gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4),'BIGDECIMAL',256);
		DS_menu.addColumn('meal_price_'       +gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4),'BIGDECIMAL',256);
		DS_menu.addColumn('sale_price_'       +gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4),'BIGDECIMAL',256);
		DS_menu.addColumn('expect_qty_'       +gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4),'BIGDECIMAL',256);
		DS_menu.addColumn('recipe_cost_rate_' +gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4),'BIGDECIMAL',256);
		DS_menu.addColumn('main_item_code1_'  +gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4),'STRING'    ,256);
		DS_menu.addColumn('cuisine_type_'     +gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4),'STRING'    ,256);
	}	
 
// Data를 작성합니다. [ DS_body -> DS_menu Create ]
	var	cnt_ds_total = 0;  
	
	
	DS_sgbn.keystring = 'S:+SGBN+CGBN_CD';
	
	DS_body_f.clear();
	
	Copy(DS_body_f,DS_body);

	for(var ii = 0; ii < DS_sgbn.rowcount; ii++) {
	
	    DS_body_f.filter();
		DS_body_f.filter("");

		var	fil_cond = "";
		var	max_row	 = 0;
		
		fil_cond	+= "SGBN=='"+DS_sgbn.getColumn(ii, "SGBN")+"' && CGBN=='"+DS_sgbn.getColumn(ii, "CGBN")+"' && CGBN_CD=='"+DS_sgbn.getColumn(ii, "CGBN_CD")+"'";

		DS_body_f.filter(fil_cond); 
		
		DS_body_c.clear();
		
		DS_body_c.copyData(DS_body_f,true);
		
		DS_body_c.keystring = 'G:+FDAY+SGBN+CGBN+CGBN_CD'; 
		
	//	trace('DS_body_c.saveXML => ' + DS_body_c.saveXML());
		
		//alert(DS_body_c.RowCount());
		DS_body_c.filter("SSEQ<>'99'");
		max_row = toNumber(DS_body_c.getMax("SSEQ"));
		max_row = max_row + 1;
		//alert(DS_body_c.RowCount());
		// DS_body_c.UnFilter();

		// DS_menu DataSet에 Row를 생성 
		 
		 
		//trace('max_row => ' + max_row); 
		for(var jj = 0; jj < max_row; jj++) {
			DS_menu.addRow();
		} 
		
		if (DS_body_c.rowcount == 0) {
			var set_row = cnt_ds_total;
			
			DS_menu.setColumn(set_row, "sgbn", 		DS_sgbn.getColumn(ii, "SGBN"));
			DS_menu.setColumn(set_row, "sgbn_nm", 	DS_sgbn.getColumn(ii, "SGBN_NM"));
			DS_menu.setColumn(set_row, "cgbn", 		DS_sgbn.getColumn(ii, "CGBN"));
			DS_menu.setColumn(set_row, "cgbn_nm", 	DS_sgbn.getColumn(ii, "CGBN_NM"));
			DS_menu.setColumn(set_row, "cgbn_cd", 	DS_sgbn.getColumn(ii, "CGBN_CD"));
			DS_menu.setColumn(set_row, "sgbn_no", 	(ii+1)); 
		}
		else {
			// 생성된 Row에 Data를 setup 한다
			for(var kk = 0; kk < DS_body_c.getRowCount(); kk++) {
			
			  //  trace('SSEQ => ' + DS_body_c.getColumn(kk, "SSEQ"));
			
				var set_row = cnt_ds_total + toNumber(DS_body_c.getColumn(kk, "SSEQ")) - 1;
				
				//if (toNumber(DS_body_c.GetColumn(kk, "sseq")) == 99) {
				if (GetRowType(DS_body_c,kk) == "logical") {
					set_row = cnt_ds_total + max_row - 1;
					DS_menu.setColumn(set_row, "tot_gbn", 	"99");
					DS_menu.setColumn(set_row, "sseq", 	"99");
					
				    DS_menu.setColumn(set_row, "sgbn", 		DS_body_c.getColumn(kk-1, "SGBN"));
					DS_menu.setColumn(set_row, "sgbn_nm", 	DS_body_c.getColumn(kk-1, "SGBN_NM"));
					DS_menu.setColumn(set_row, "cgbn", 		DS_body_c.getColumn(kk-1, "CGBN"));
					DS_menu.setColumn(set_row, "cgbn_nm", 	DS_body_c.getColumn(kk-1, "CGBN_NM"));
					DS_menu.setColumn(set_row, "cgbn_cd", 	DS_body_c.getColumn(kk-1, "CGBN_CD"));
					DS_menu.setColumn(set_row, "sgbn_no", 	(ii+1));		
					
				}
				else {
					//DS_menu.setColumn(set_row, "tot_gbn", 	"");
					
					DS_menu.setColumn(set_row, "sgbn", 		DS_body_c.getColumn(kk, "SGBN"));
					DS_menu.setColumn(set_row, "sgbn_nm", 	DS_body_c.getColumn(kk, "SGBN_NM"));
					DS_menu.setColumn(set_row, "cgbn", 		DS_body_c.getColumn(kk, "CGBN"));
					DS_menu.setColumn(set_row, "cgbn_nm", 	DS_body_c.getColumn(kk, "CGBN_NM"));
					DS_menu.setColumn(set_row, "cgbn_cd", 	DS_body_c.getColumn(kk, "CGBN_CD"));
					DS_menu.setColumn(set_row, "sgbn_no", 	(ii+1));
				
				}
				
				var set_col = gfn_subStr(DS_body_c.getColumn(kk, "FDAY"),4,4);
				
				if(gfn_length(set_col) > 0 ){
					DS_menu.setColumn(set_row, "dup_sta_"	+set_col, 	DS_body_c.getColumn(kk, "DUP_STA"));
					DS_menu.setColumn(set_row, "dup_color_"	+set_col, 	DS_body_c.getColumn(kk, "DUP_COLOR"));
					DS_menu.setColumn(set_row, "sseq_"		+set_col, 	DS_body_c.getColumn(kk, "SSEQ"));
					DS_menu.setColumn(set_row, "sd_cd_"		+set_col, 	DS_body_c.getColumn(kk, "SD_CD")); 
                 }
                 					
				if (GetRowType(DS_body_c,kk) == "logical") {
				 
				     var set_col1 = gfn_subStr(DS_body_c.getColumn(kk-1, "FDAY"),4,4);
				
					 if(DS_body_c.getColumn(kk-1, "FDAY") != "") { 
					
							var	v_case			= "FDAY=='"+DS_body_c.getColumn(kk-1, "FDAY")+"'&&SGBN=='"+DS_body_c.getColumn(kk-1, "SGBN")+"'&&CGBN=='"+DS_body_c.getColumn(kk-1, "CGBN")+"'&&CGBN_CD=='"+DS_body_c.getColumn(kk-1, "CGBN_CD")+"'";
							var	v_price 		= DS_body_c.getCaseSum(v_case, "SD_WON");
							var	v_meal_price 	= DS_body_c.getCaseAvg(v_case, "MEAL_PRICE");
							var	v_sale_price 	= DS_body_c.getCaseAvg(v_case, "SALE_PRICE");
							var	v_expect_qty 	= DS_body_c.getCaseAvg(v_case, "EXPECT_MEAL_QTY");
							var	v_cost_rate 	= DS_body_c.getCaseSum(v_case, "RECIPE_COST_RATE");
			
							DS_menu.setColumn(set_row, "sd_nm_"				+set_col1, 	numFormat(v_price, 0)+"원"+"("+numFormat(Math.round((toNumber(v_price)/toNumber(v_sale_price))*100,1), 1)+"%)");
							DS_menu.setColumn(set_row, "sd_won_"			+set_col1, 	v_price);
							DS_menu.setColumn(set_row, "meal_price_"		+set_col1, 	v_meal_price);
							DS_menu.setColumn(set_row, "sale_price_"		+set_col1, 	v_sale_price);
							DS_menu.setColumn(set_row, "expect_qty_"		+set_col1, 	v_expect_qty);
							DS_menu.setColumn(set_row, "recipe_cost_rate_"	+set_col1, 	numFormat(Math.round((toNumber(v_price)/toNumber(v_meal_price))*100,1), 1));
							DS_menu.setColumn(set_row, "phf_"				+set_col1, 	"");
							DS_menu.setColumn(set_row, "main_item_code1_"	+set_col1, 	"");
							DS_menu.setColumn(set_row, "cuisine_type_"		+set_col1, 	"");
					}
				} else {
				      if(gfn_length(set_col) > 0) {
							DS_menu.setColumn(set_row, "sd_nm_"				+set_col, 	DS_body_c.getColumn(kk, "SD_NM"));
							DS_menu.setColumn(set_row, "sd_won_"			+set_col, 	DS_body_c.getColumn(kk, "SD_WON"));
							DS_menu.setColumn(set_row, "meal_price_"		+set_col, 	DS_body_c.getColumn(kk, "MEAL_PRICE"));
							DS_menu.setColumn(set_row, "sale_price_"		+set_col, 	DS_body_c.getColumn(kk, "SALE_PRICE"));
							DS_menu.setColumn(set_row, "expect_qty_"		+set_col, 	DS_body_c.getColumn(kk, "EXPECT_MEAL_QTY"));
							DS_menu.setColumn(set_row, "recipe_cost_rate_"	+set_col, 	DS_body_c.getColumn(kk, "RECIPE_COST_RATE"));
							DS_menu.setColumn(set_row, "phf_"				+set_col, 	DS_body_c.getColumn(kk, "PHF"));
							DS_menu.setColumn(set_row, "main_item_code1_"	+set_col, 	DS_body_c.getColumn(kk, "MAIN_ITEM_CODE1"));
							DS_menu.setColumn(set_row, "cuisine_type_"		+set_col, 	DS_body_c.getColumn(kk, "CUISINE_TYPE"));
					}
				}
		}
 
	}
		
		// DS_menu Row 위치를 산정하기 위한 누적값
		cnt_ds_total = cnt_ds_total + max_row; 
 }
    if(DS_menu.rowcount > 0) { 
    
		DS_menu.rowposition = 0;
		DS_menu.applyChange(); 
		
		DS_menu2.clear();
		
		// 식당예상 식재료율을 구하기 위한 dataset을 생성
		DS_menu.filter("tot_gbn=='99'");
	    
	    DS_menu2.copyData(DS_menu,true);
		
		DS_menu.filter("");
	} else {
	
	    
	    for(i=0;i<DS_sgbn.rowcount;i++) {
	    
	        nRow = DS_menu.addRow(); 
	
			DS_menu.setColumn(nRow, "sgbn", 	DS_sgbn.getColumn(i, "SGBN"));
			DS_menu.setColumn(nRow, "sgbn_nm", 	DS_sgbn.getColumn(i, "SGBN_NM"));
			DS_menu.setColumn(nRow, "cgbn", 	DS_sgbn.getColumn(i, "CGBN"));
			DS_menu.setColumn(nRow, "cgbn_nm", 	DS_sgbn.getColumn(i, "CGBN_NM"));
			DS_menu.setColumn(nRow, "cgbn_cd", 	DS_sgbn.getColumn(i, "CGBN_CD"));
			DS_menu.setColumn(nRow, "sgbn_no", 	1);
			DS_menu.setColumn(nRow, "tot_gbn", 	"");
		} 
	}
	 
	
	for(var i=0;i<DS_menu.rowcount;i++) {
	
         sCurrMenu = DS_menu.getColumn(i,"sgbn") + DS_menu.getColumn(i,"cgbn_cd");
	     
	     if(sPrevMenu != sCurrMenu) {  
	     
// 	          trace('sgbn_no => ' +DS_menu.getColumn(i,"sgbn_no"));
// 	          
// 	          trace('exp 1 => ' + toNumber(toNumber(DS_menu.getColumn(i,"sgbn_no"))/2));
// 	  
// 	          trace('exp 2 => ' +  parseInt(toNumber(DS_menu.getColumn(i,"sgbn_no"))/2)); 
	          
	         var exp1 = toNumber(toNumber(DS_menu.getColumn(i,"sgbn_no"))/2);
	  
	         var exp2 = parseInt(toNumber(DS_menu.getColumn(i,"sgbn_no"))/2);
	 
			  if(exp1 > exp2) {
			       
			       iBGC = 0;
			  } else {
			       iBGC = 1;
			  }
			  if(DS_menu.getColumn(i, "tot_gbn") <> '99') {
			     DS_menu.setColumn(i, "tot_gbn", iBGC); 
			  }
			  
			  
	     } else {
			  if(DS_menu.getColumn(i, "tot_gbn") <> '99') {
			     DS_menu.setColumn(i, "tot_gbn", iBGC); 
			  }
	     }
	
	     sPrevMenu = sCurrMenu; 
	
	} 
	
	DS_menu.enableevent = true;   
}

/*------------------------------------------------------------
	1. Function ID : fn_make_grdlst()
	2. 개       요 : 조건에 맞는 Grid Format을 작성
	3. 기       능 : 검색조건 기간이 유동적으로 구성되므로 조건에 해당하는 정보를 화면으로
	                 출력하기 위해 Grid를 재구성한다.
	4. 인 수 설 명 : 
*/
function fn_make_grdlst()
{
 	// GRID 작성
	var Contents_grd_lst	 = '';
	var Contents_grd_column  = '';
	var Contents_grd_rows    = '';
	var Contents_grd_head    = '';
	var Contents_grd_body    = '';
	var Contents_grd_body1   = '';
	var Contents_grd_summary = '';
	var Contents_grd_lst	 = '';
	
	
	//trace(DS_menu.saveXML());
	

	// Grid를 작성합니다.
	Contents_grd_lst  = '<Formats>' + '\n';
	Contents_grd_lst += '<Format id="Default">' + '\n';
	
 	// Grid columns를 작성합니다.
	Contents_grd_column  = ' <Columns>' + '\n';
	Contents_grd_column	+= ' <Column size="75" band="left" />' + '\n';
	
	for(var ii = 0; ii < il_cnt; ii++)
	{
	     Contents_grd_column	+= ' <Column size="30" />' + '\n';
	     Contents_grd_column	+= ' <Column size="120" />' + '\n';
	     Contents_grd_column	+= ' <Column size="36" />' + '\n'; 
	}
	
	Contents_grd_column  += ' </Columns>' + '\n';

	// Grid rows를 작성합니다.
	Contents_grd_rows  = ' <Rows>' + '\n';
  	Contents_grd_rows += ' <Row size="24" band="head" />' + '\n';
  	Contents_grd_rows += ' <Row size="24" band="head" />' + '\n'; 
  	Contents_grd_rows += ' <Row size="24" band="body" />' + '\n';  	
  	Contents_grd_rows += ' <Row size="24" band="summary" />' + '\n';
	Contents_grd_rows += ' </Rows>' + '\n';
 
	// Grid head를 작성합니다.
	Contents_grd_head  = ' <Band id="head">' + '\n';
 
 	Contents_grd_head += ' <cell color="white" col="0" displaytype="text" text="일자"/> ' + '\n';
	Contents_grd_head += ' <cell color="white" col="0" displaytype="text" row="1" text="일정"/>' + '\n';  
 
	var	v_col1 = -2;
	var	v_col2 = 0;
	var	v_day  = "";  
	
	for(var ii = 0; ii < il_cnt; ii++) { 
	
	    v_col1 	= v_col1 + 3;
 		v_col2 	= v_col2 + 3;
	
		v_day	= gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,2) + "/" + gfn_subStr(DS_head.getColumn(ii, "FDAY"),6,2) + "(" + DS_head.getColumn(ii, "WE") + ")"; 
		 
		 var v_wImg = "URL('theme://convertImages/" + DS_head.getColumn(ii,"WIMG") + ".png";
		 
 
		Contents_grd_head += ' <cell color="#'+DS_head.getColumn(ii, "WE_COLOR")+'" col="'+v_col1+'" colspan="2" displaytype="text" text="'+v_day+'" />' + '\n';
	    Contents_grd_head += ' <cell text="'+v_wImg+'" col="'+v_col2+'" displaytype="image" rowspan="2"/>' + '\n';
 
		
 		if (gfn_length(DS_head.getColumn(ii, "REM"))> 8) {
		
		    Contents_grd_head += ' <cell color="#'+DS_head.getColumn(ii, "WE_COLOR")+'" col="'+v_col1+'" colspan="2" displaytype="text" row="1" text="'+gfn_nvl(gfn_subStr(DS_head.getColumn(ii, "REM"),0,8))+".."+'"/>' + '\n';
		}
		else {
		    Contents_grd_head += ' <cell color="#'+DS_head.getColumn(ii, "WE_COLOR")+'" col="'+v_col1+'" colspan="2" displaytype="text" row="1" text="'+gfn_nvl(DS_head.getColumn(ii, "REM"))+'"/>' + '\n';
		} 		
		
	}
				
	Contents_grd_head += ' </Band>' + '\n';
 
  	// Grid body를 작성합니다.
  	Contents_grd_body  = ' <Band id="body">' + '\n';
 
    Contents_grd_body	+= ' <Cell col="0" display="text" style="background:white;background2:white;" font="굴림,8,bold" expr="expr:iif(gfn_length(cgbn_nm)&#32;==&#32;0,&#32;gfn_nvl(sgbn_nm)+gfn_nvl(cgbn),&#32;gfn_nvl(sgbn_nm)+gfn_nvl(cgbn)+&apos;(&apos;+gfn_nvl(cgbn_nm)+&apos;)&apos;)" suppress="1" suppressalign="middle"/>' + '\n';
 
    var	v_col3 = 0; 
 	var	v_seq  = "";  
  	
 	for(var ii = 0; ii < il_cnt; ii++) {
 	
		v_col3 = (ii * 3) + 1;  
		
		v_seq  = gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4); 
		
		img_Del = "expr(iif(tot_gbn=='99'&& gfn_length(sd_nm_" + v_seq + ")>0,'theme://images/new/grd_WF_ExpandImageX.png'))";

		 Contents_grd_body	+= ' <Cell col="' + v_col3 + '" colspan="3" displaytype="text" style="background:white;background2:white;align:left;" suppress="2">' + '\n';
     	
       // Contents_grd_body	+= '  <cell col="'+ v_col3 + '" colspan="3" style="background:expr(tot_gbn==&apos;99&apos;?&apos;#ffefb5ff&apos;:tot_gbn==&apos;0&apos;?&apos;white&apos;:&apos;#f8f8f8ff&apos;);background2:expr(tot_gbn==&apos;99&apos;?&apos;#ffefb5ff&apos;:tot_gbn==&apos;0&apos;?&apos;white&apos;:&apos;#f8f8f8ff&apos;);linetype:onlyvert; ">' + '\n'; 
			
     	
     	Contents_grd_body	+= ' <Cell displaytype="text" style="color:EXPR(dup_color_' + v_seq + ');color2:EXPR(dup_color_' + v_seq + ');align:left;" expr="expr:iif(dup_sta_' + v_seq + '&#32;==&apos;Y&apos;,&#32;&apos;■&apos;,&#32;&apos;&apos;)"/>' + '\n';
		Contents_grd_body	+= ' <Cell col="1" displaytype="text" style="font:EXPR(iif(sseq_' + v_seq + '==&apos;99&apos;,&#32;&apos;굴림,9,bold&apos;,&#32;&apos;굴림,9&apos;));align:left;" text="bind:sd_nm_' + v_seq +  '"/>' + '\n';
		Contents_grd_body	+= ' <Cell col="2" displaytype="number" style="align:right;" text="bind:sd_won_' + v_seq + '" expr="expr:iif(tot_gbn==&apos;99&apos;,&apos;&apos;,gfn_nvl(sd_won_' + v_seq + '))"/>' + '\n';
		Contents_grd_body	+= ' </Cell>' + '\n';
 	
    } 
      
 	Contents_grd_body	+= '  </Band>' + '\n'; 		
 		
	// Grid Summary를 작성합니다.
	
    Contents_grd_summary =  ' <Band id="summary">' + '\n';
    Contents_grd_summary += ' <Cell displaytype="text" style="align:left;" text="평균원가"/>' + '\n'; 

 	v_col3 = 0;
	v_seq  = "";

	v_sale_sum  = 0;
	v_wonga_sum = 0;
	
	for(var ii = 0; ii < il_cnt; ii++)
	{
		v_col3 = (ii * 3) + 1;
		v_seq  = gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4);
		var v_sale      = 0;
		var v_wonga     = 0;
		var v_expect_qty  = 0;
		
		for(var jj = 0; jj < DS_menu.rowcount; jj++) {
			if ( DS_menu.getColumn(jj, "tot_gbn") == "99") {
				v_sale	+= ( toNumber(gfn_nvl(DS_menu.getColumn(jj, "sale_price_"+v_seq),0)) * toNumber(gfn_nvl(DS_menu.getColumn(jj, "expect_qty_"+v_seq),0)) );
				v_wonga	+= ( toNumber(gfn_nvl(DS_menu.getColumn(jj, "sd_won_"+v_seq),0))     * toNumber(gfn_nvl(DS_menu.getColumn(jj, "expect_qty_"+v_seq),0)) );	
				v_expect_qty += toNumber(gfn_nvl(DS_menu.getColumn(jj, "expect_qty_"+v_seq),0));

				v_sale_sum	+= ( toNumber(gfn_nvl(DS_menu.getColumn(jj, "sale_price_"+v_seq),0)) * toNumber(gfn_nvl(DS_menu.getColumn(jj, "expect_qty_"+v_seq),0)) );
				
				v_wonga_sum	+= ( toNumber(gfn_nvl(DS_menu.getColumn(jj, "sd_won_"+v_seq),0))     * toNumber(gfn_nvl(DS_menu.getColumn(jj, "expect_qty_"+v_seq),0)) );	
				
// 				trace('sum sd_won_' + v_seq + '=> ' + gfn_nvl(DS_menu.getColumn(jj, "sd_won_"+v_seq),0));
// 				trace(jj + ' ====> ' + v_wonga_sum);
			
			}
		}
		
		var v_cnt	= toNumber(DS_menu.getCaseCount("tot_gbn=='99' && sd_won_"+v_seq+">0"),0);
		
		if (v_cnt > 0) {
			Contents_grd_summary	+= ' <cell align="center" col="'+v_col3+'" colspan="3" display="text" color="#993300" font="굴림,8,Bold" text="'+numFormat(v_wonga/v_expect_qty, 0)+'원('+numFormat((v_wonga/v_sale)*100, 1)+'%)"/>' + '\n';
		}
		else {
			Contents_grd_summary	+= ' <cell align="center" col="'+v_col3+'" colspan="3" display="text" color="#993300" font="굴림,8,Bold" text=""/>'+ '\n';
		}
	}

    Contents_grd_summary += ' </Band>' + '\n';  
    
	// Grid End
	
    Contents_grd_lst += Contents_grd_column + Contents_grd_rows + Contents_grd_head + Contents_grd_body + Contents_grd_summary + '</Format>' + '\n' + '</Formats>';
 
  //  trace(Contents_grd_lst);
 
	tab_Main.tab01.grd_lst.formats  = Contents_grd_lst;
 	tab_Main.tab01.grd_lst.formatid = "Default"; 	
	tab_Main.tab01.grd_lst.nodataimage = gv_noData;
	tab_Main.tab01.grd_lst.binddataset  = "DS_menu"
	tab_Main.tab01.grd_lst.autofittype = "col";
	tab_Main.tab01.grd_lst.selecttype  = "row";
	 
	 
	// trace(DS_menu.saveCSV());
 
    var	v_bSikRate 	= 0;
	
// 	trace('v_wonga_sum1 => ' + v_wonga_sum);
// 	trace('v_sale_sum1  => ' + v_sale_sum);
	
	if (v_sale_sum == 0) {
		v_bSikRate		= 0;
	}
	else {
		v_bSikRate		= fn_clearNaN(Math.round(v_wonga_sum / v_sale_sum * 100, 1));
	}	
	
	me_bSikRate.value = v_bSikRate;
	
	if (Math.round(v_bSikRate - toNumber(me_sikrate.value), 1) > 0) {
		st_memo.text = "(↑ "+fn_clearNaN(Math.abs(Math.round(toNumber(v_bSikRate) - toNumber(me_sikrate.value), 1)))+"%P)";
		st_memo.style.color = "red";
	}
	else {
		st_memo.text = "(↓ "+fn_clearNaN(Math.abs(Math.round(toNumber(v_bSikRate) - toNumber(me_sikrate.value), 1)))+"%P)";
		st_memo.style.color = "blue";
	}	
 
	for(var ii = 0; ii < il_cnt; ii++) { 
	
		if(ii==0) {
			v_col3 = 2; 
		} else {
			v_col3 += 2;
		}
		 
		
        v_seq  = gfn_subStr(DS_head.getColumn(ii, "FDAY"),4,4); 
        
        
		var img_Del = "expr(iif(tot_gbn=='99'&& gfn_length(sd_nm_" + v_seq + ")>0,'theme://images/new/grd_WF_ExpandImageX.png'))";
		//var bg = "expr(iif(tot_gbn=='99', '#DDFCDB',iif(toNumber(toNumber(sgbn_no)/2) == parseInt(toNumber(sgbn_no)/2), 'white', '#E3F3FF')))"; 
	    var bg = "expr(iif(tot_gbn=='99', 'lavender','white'))";  
 
 		    //'#E3F3FF' 
 		var bkColor2 = "expr(tot_gbn == '99' && sseq == '99'?'#DDFCDB':tot_gbn == '0'?'white':'whitesmoke')";
 		var bkColor1 = "expr(iif(toNumber(toNumber(sgbn_no)/2) == parseInt(toNumber(sgbn_no)/2), 'whitesmoke','white'))";
 		
 		
 		if(ii == 0) {
			tab_Main.tab01.grd_lst.setCellProperty('body',0, 'background', bkColor1);
			tab_Main.tab01.grd_lst.setCellProperty('body',0, 'background2', bkColor1);  
		}
  	 	 
 		tab_Main.tab01.grd_lst.setCellProperty('body',ii+1, 'background', bkColor2);
 		tab_Main.tab01.grd_lst.setCellProperty('body',ii+1, 'background2', bkColor2); 
		
  		tab_Main.tab01.grd_lst.setCellProperty('body',ii+1, 'backgroundimage', img_Del); 
	} 
	// 식당예상 식재료율을 계산합니다.
	// 
	//fn_me_bSikRate();
}

function fn_me_bSikRate() // 식당예상 식재료율
{
	// var	n_sik_won = 0;
	// var n_sale	  = 0;

	// for(var ii = 0; ii < DS_menu2.RowCount(); ii++) {
	
		// var	fil_cond	= "sgbn=='"+DS_menu2.GetColumn(ii, "sgbn")+"'&&cgbn=='"+DS_menu2.GetColumn(ii, "cgbn")+"'&&cgbn_cd=='"+DS_menu2.GetColumn(ii, "cgbn_cd")+"'";
		// var	m1_row		= tab_Main.tab00.DS_menu1.SearchRow(fil_cond);
		
		// for(var kk = 0; kk < DS_head.RowCount(); kk++) {
		
			// var set_col 	= Mid(DS_head.GetColumn(kk, "fday"),4,4);
			// var m1_col		= "expect_meal_qty_"+set_col;
			// var m2_col		= "sd_won_"+set_col;
			// var m3_col		= "sale_price_"+set_col;
			////예상 식재료비 원가 sale_price_
			// n_sik_won 	= n_sik_won + (toNumber(DS_menu2.GetColumn(ii, m2_col)) * toNumber(tab_Main.tab00.DS_menu1.GetColumn(m1_row, m1_col)));
			////예상 매출액
			// n_sale 		= n_sale 	+ (toNumber(DS_menu2.GetColumn(ii, m3_col)) * toNumber(tab_Main.tab00.DS_menu1.GetColumn(m1_row, m1_col)));
			
		// }
	// }

	var	v_bSikRate 	= 0;
	
// 	trace('v_wonga_sum => ' + v_wonga_sum);
// 	trace('v_sale_sum  => ' + v_sale_sum);
	
	if (v_sale_sum == 0) {
		v_bSikRate		= 0;
	}
	else {
		v_bSikRate		= fn_clearNaN(Math.round(v_wonga_sum / v_sale_sum * 100, 1));
	}	
	
	me_bSikRate.value = v_bSikRate;
	
	if (Math.round(v_bSikRate - toNumber(me_sikrate.value), 1) > 0) {
		st_memo.text = "(↑ "+fn_clearNaN(Math.abs(Math.round(toNumber(v_bSikRate) - toNumber(me_sikrate.value), 1)))+"%P)";
		st_memo.style.color = "red";
	}
	else {
		st_memo.text = "(↓ "+fn_clearNaN(Math.abs(Math.round(toNumber(v_bSikRate) - toNumber(me_sikrate.value), 1)))+"%P)";
		st_memo.style.color = "blue";
	}	
	
	// var	v_bSikRate 	= 0;
	
	// if (n_sale == 0) {
		// v_bSikRate		= 0;
	// }
	// else {
		// v_bSikRate		= round(n_sik_won / n_sale, 1);
	// }
	
	// me_bSikRate.Value = v_bSikRate;
	
	// if (round(v_bSikRate - me_sikrate.Value, 1) > 0) {
		// st_memo.Text = "(↑ "+abs(round(toNumber(v_bSikRate) - toNumber(me_sikrate.Value), 1))+"%P)";
		// st_memo.Color = "red";
	// }
	// else {
		// st_memo.Text = "(↓ "+abs(round(toNumber(v_bSikRate) - toNumber(me_sikrate.Value), 1))+"%P)";
		// st_memo.Color = "blue";
	// }

}

// dataset의 변경유무를 검토하여 저장할 것인지를 검증한다.
function fn_dsUpdateSearch()
{
	if (gfn_dsIsUpdated(DS_menu)== true) {
		var msg = "저장되지 않은 정보가 있습니다.\n\n데이터를 저장하시겠습니까?";
		if (g_Confirm("02",	msg) == true) {
			//alert("처리");
			// fn_save();
			g_Message("04", "");
		}
		else {
			g_Message("EE", "데이타 저장 작업을 취소하였습니다.");
			return;
		}
	}
}

// 식단평가에서 duble Click 시
// fa_com : 선택된 콤보 index (0,1,2,3)
// fa_date : 선택된 일자(YYYYMMDD) or 주간(ALL)
// fa_row : ds_list에서 선택된 row
// fa_tit : 선택된 내용에 대한 설명
// function fn_dup_color(fa_com, fa_date, fa_row, fa_tit)
// {
// 	st_pyoTitle.text = "식단평가 : " + fa_tit;
// 	// alert("fn_dup_color 실행 :fa_com:"+fa_com+"/fa_date:"+fa_date+"/fa_row:"+fa_row+"/");
// 	if (ds_list.getRowCount() == 0) {
// 		g_Message("EE", "평가 내용이 없습니다.");
// 		return;
// 	}
// 	// return;
// 	// fa_com -> 평가항목 combo ( 0 : 레시피명 중복횟수 )
// 	// fa_com -> 평가항목 combo ( 1 : 주재료군 중복횟수 )
// 	// fa_com -> 평가항목 combo ( 2 : 조리법 중복횟수 )
// 	// fa_com -> 평가항목 combo ( 3 : PHF 중복횟수 )
// 	
// 	// fa_date -> 주간 ( ALL ), 일자버튼 선택시 ( YYYYMMDD )
// 	// fa_row -> 조회된 내용 중 더블클릭으로 선택한 row (ds_list)
// 	// fa_tit -> 처리해야될 내용을 타이틀로 표시한다.
// 	
// 	var if_col = ""; // 컬러를 적용할 조건 컬럼
// 	var v_case = ""; // fillter 할 조건
// 	
// 	// 색을 적용할 조건 컬럼을 셋팅
// 	switch(fa_com){
// 		case 0:
// 			if_col = "SD_NM";
// 			break;
// 		case 1:
// 			if_col = "MAIN_ITEM_CODE1";	
// 			break;
// 		case 2:
// 			if_col = "CUISINE_TYPE";	
// 			break;
// 		case 3:
// 			if_col = "PHF";	
// 			break;
// 	}
// 
// 	// case 조건을 생성
// 	if (if_col == "PHF") {
// 		v_case	+= "PHF='Y'";
// 	}
// 	else {
// 		if (gfn_length(gfn_toString(fa_row))> 0) {
// 			v_case	+= if_col+"='"+ds_list.getColumn(fa_row, "CD")+"'";
// 			//alert("fa_row선택:/"+ds_list.GetColumn(fa_row, "CD")+"/");
// 		}
// 		else {
// 			v_case += "(";
// 			for (var ii=0; ii < ds_list.getRowCount(); ii++)
// 			{
// 				if (ii <> 0) {
// 					v_case += " || ";
// 				}
// 				v_case += if_col+"='"+ds_list.getColumn(ii, "CD")+"'";
// 			}
// 			v_case += ")";
// 		}
// 	}
// 	
// 	// 특정일을 선택시
// 	if (gfn_length(gfn_toString(fa_date))== 8) { // 일자 선택 시
// 		v_case	+= " && FDAY='"+fa_date+"'";
// 	}
// 	//
// 	// alert(v_case);
// 	// DS_body 상세 정보에서 평가정보를 추출한다.
// 	Copy(DS_body_f,DS_body);
// 	DS_body_f.filter(v_case);
// 
// 	var f_row = 0;
// 	
// 	for (var jj=0; jj < DS_body_f.getRowCount(); jj++)
// 	{
// 		if (if_col == "PHF") {
// 			f_row = 0;
// 		}
// 		else {
// 			// alert("CD='"+DS_body_f.GetColumn(jj, if_col)+"'");
// 			f_row = ds_list.findRowExpr("CD=='"+DS_body_f.getColumn(jj, if_col)+"'");
// 		}
// 		//
// 		//alert(f_row+"/"+ds_list.GetColumn(f_row, "TEXTCOLOR"));
// 		
// 		DS_body_f.setColumn(jj, "DUP_COLOR", ds_list.getColumn(f_row, "TEXTCOLOR"));
// 		DS_body_f.setColumn(jj, "DUP_STA", "Y");
// 	}
// 	//
// 	DS_body_f.filter("");
// 	
// 	grd_lst.enableredraw = false;
// 	grd_lst.binddataset = "";
// 	
// 	// DS_menu Dataset을 다시 작성한다.
// 	trace('make menu 2');
// 	fn_make_DS_menu();
// 	
// 	grd_lst.binddataset = "DS_menu";
// 	grd_lst.enableredraw = true;
// 
// }


function fn_dup_color(fa_com, fa_date, fa_row, fa_tit)
{
	st_pyoTitle.text = "식단평가 : " + fa_tit;
	// alert("fn_dup_color 실행 :fa_com:"+fa_com+"/fa_date:"+fa_date+"/fa_row:"+fa_row+"/");
	if (ds_list.getRowCount() == 0) {
		g_Message("EE", "평가 내용이 없습니다.");
		return;
	}
	// return;
	// fa_com -> 평가항목 combo ( 0 : 레시피명 중복횟수 )
	// fa_com -> 평가항목 combo ( 1 : 주재료군 중복횟수 )
	// fa_com -> 평가항목 combo ( 2 : 조리법 중복횟수 )
	// fa_com -> 평가항목 combo ( 3 : PHF 중복횟수 )
	
	// fa_date -> 주간 ( ALL ), 일자버튼 선택시 ( YYYYMMDD )
	// fa_row -> 조회된 내용 중 더블클릭으로 선택한 row (ds_list)
	// fa_tit -> 처리해야될 내용을 타이틀로 표시한다.
	
	var if_col = ""; // 컬러를 적용할 조건 컬럼
	var v_case = ""; // fillter 할 조건
	
  /// trace('fa_com => '+ fa_com);
	
	// 색을 적용할 조건 컬럼을 셋팅
	switch(fa_com){
		case 0:
			if_col = "SD_NM";
			break;
		case 1:
			if_col = "MAIN_ITEM_CODE1";	
			break;
		case 2:
			if_col = "CUISINE_TYPE";	
			break;
		case 3:
			if_col = "PHF";	
			break;
	}

	// case 조건을 생성
	if (if_col == "PHF") {
		v_case	+= "PHF=='Y'";
	}
	else {
		if (gfn_length(gfn_toString(fa_row))> 0) {
			v_case	+= if_col+"=='"+ds_list.getColumn(fa_row, "CD")+"'";
			//alert("fa_row선택:/"+ds_list.GetColumn(fa_row, "CD")+"/");
		}
		else {
			//v_case += "(";
			for (var ii=0; ii < ds_list.rowcount; ii++)
			{
				if (ii <> 0) {
					v_case += " || ";
				}
				v_case += if_col+"=='"+ds_list.getColumn(ii, "CD")+"'";
			}
			//v_case += ")";
		}
	}
	
	// 특정일을 선택시
	if (gfn_length(gfn_toString(fa_date))== 8) { // 일자 선택 시
		v_case	+= " && FDAY=='"+fa_date+"'";
	}
	//
	//trace(v_case);
	// DS_body 상세 정보에서 평가정보를 추출한다.
	
//	trace(v_case);

	for (var jj=0; jj < DS_body.rowcount; jj++)
	{
	
	    	DS_body.setColumn(jj, "DUP_COLOR",'');
			DS_body.setColumn(jj, "DUP_STA", '');
	}
 
	DS_body.filter('');
  	DS_body.filter(v_case); 
//   	
//   	DS_body_f.clearData();
//   	
//   	 DS_body_f.copyData(DS_body,true);
// // 	
// 	DS_body.filter("");
// 	

 //   trace('DS_body_f.rowcount => ' + DS_body_f.rowcount);

 	var f_row = 0;
		
	for (var jj=0; jj < DS_body.rowcount; jj++)
	{
	 
		if (if_col == "PHF") {
			f_row = 0;
		}
		else {
			
			var fStr = DS_body.getColumn(jj, if_col)
			
			f_row = ds_list.findRow("CD",fStr);
			
		}		

		if(f_row != -1) {
		
			DS_body.setColumn(jj, "DUP_COLOR", ds_list.getColumn(f_row, "TEXTCOLOR"));
			DS_body.setColumn(jj, "DUP_STA", "Y");
		}
	}
  
// 	DS_body.filter('');  
//  
//     for(var i=0;i<DS_body.rowcount;i++){
//  
// 		DS_body.setColumn(nRow, "DUP_COLOR", '');
// 		DS_body.setColumn(nRow, "DUP_STA",   '');
// 	
// 	}
// 	
// 	for(var i=0;i<DS_body_f.rowcount;i++){
// 	   
// 	        var fr_cond = "FDAY == '"+DS_body_f.getColumn(i, "FDAY")+"' && SGBN == '"+DS_body_f.getColumn(i, "SGBN")+"' && CGBN == '"+DS_body_f.getColumn(i, "CGBN")+"' && CGBN_CD == '"+DS_body_f.getColumn(i, "CGBN_CD")+"' && PHF == '"+DS_body_f.getColumn(i, "PHF")+"'";
// 
//            //  trace(fr_cond);
// 
//             var nRow = DS_body.findRowExpr(fr_cond);
//        
//              trace('nRow => ' + nRow);
// 	     
// 			DS_body.setColumn(nRow, "DUP_COLOR", DS_body_f.getColumn(i, "DUP_COLOR"));
// 			DS_body.setColumn(nRow, "DUP_STA",   DS_body_f.getColumn(i, "DUP_STA"));
// 	
// 	}
// 	


    DS_body.filter('');

	grd_lst.enableredraw = false;
	grd_lst.binddataset = "";
	
	// DS_menu Dataset을 다시 작성한다.
	fn_make_DS_menu();
	
	grd_lst.binddataset = "DS_menu";
	grd_lst.enableredraw = true;
	
	

}

//******************************************************************************************
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//******************************************************************************************

function btn_ExcelPrint_OnClick(obj:Button, e:ClickEventInfo)
{
	//DS_menu.AddRow();
	if (DS_menu.getRowCount() == 0) {
		g_Message("EE",	"출력할 메뉴정보가 없습니다.");
		return;
	}
	gfn_exportExcel(grd_lst, "식단표");
	//alert(DS_menu.row);
	
}

function grd_lst_OnMouseOver(obj:Grid, e:GridMouseEventInfo)
{
	
	//----------------------------------
	// Tooltip 설명 처리부
	//----------------------------------
	// Head 부 처리
	var	srow 	= 0.0;
	var	int_srow= 0;
	var	v_seq  	= "";

	if (e.row == -1 && e.cell > 3) {
		srow = toNumber((e.cell-1)/3);
		int_srow = parseInt(srow);
		//alert("/"+srow+"/"+int_srow+"/");
		//alert(length(DS_head.GetColumn((int_srow-1), "rem")));
		
		if (gfn_length(DS_head.getColumn((int_srow-1), "REM"))> 8 && int_srow == srow) {
			grd_lst.tooltiptext = "☞ 일정 : "+DS_head.getColumn((int_srow-1), "REM")+" ";
			return;
		}
		else { grd_lst.tooltiptext = ""; }
	}
	else { grd_lst.tooltiptext = ""; }
	// Body 부 처리
	//grd_lst.ToolTipText = "nRow :"+nRow+"\nnCell :"+nCell+"\nnPosX :"+nPosX+"\nnPosY :"+nPosY;
	v_seq  = gfn_subStr(DS_head.getColumn((e.cell-1), "FDAY"),4,4);
	//alert(v_seq);
/*	
	if (nRow > -1 && nCell > 0 && length(DS_menu.GetColumn(nRow, "dup_sta_"+v_seq)) > 0) {
		if (nPosX > 740) {
			Div_pop.Left = nPosX-(Div_pop.Width);
			Div_pop.Top  = nPosY+30;
			// 화면에 보여질 정보를 처리한다.
			Div_pop.Visible = true;
		}
		else {
			Div_pop.Left = nPosX+15;
			Div_pop.Top  = nPosY+30;
			// 화면에 보여질 정보를 처리한다.
			Div_pop.Visible = true;
		}
	}
	else {
		Div_pop.Visible = false;
	}
*/
} 

function grd_lst_OnMouseOut(obj:Grid, e:MouseEventInfo)
{
	Div_pop.visible = false;
}

// 레시피 등록
function grd_lst_OnRButtonDown(obj:Grid, e:GridMouseEventInfo)
{
	if (e.cell < 1 || e.row < 0 || DS_menu.getColumn(e.row, "tot_gbn") == "99") {
		return;
	}
	
	// 식수여부 CHECK
	var set_col		= gfn_subStr(DS_head.getColumn(e.cell-1, "FDAY"),4,4);
	var fil_cond	= "FDAY=='"+DS_head.getColumn(e.cell-1, "FDAY")+"'&&SGBN=='"+DS_menu.getColumn(e.row, "sgbn")+"'&&CGBN=='"+DS_menu.getColumn(e.row, "cgbn")+"'&&CGBN_CD=='"+DS_menu.getColumn(e.row, "cgbn_cd")+"'";
	var n_row		= tab_Main.tab00.DS_body1.findRowExpr(fil_cond);
	
	if (n_row < 0 || tab_Main.tab00.DS_body1.getColumn(n_row, "EXPECT_MEAL_QTY") < 1) {
			g_Message("EE",	"[MY레시피 등록작업 불가 !!]\n\n예상식수 정보가 없습니다.\n\n식수정보를 확인 후 처리하세요.");
			return;
	}
		
	//alert(nRow);
	//alert(nCell);
	// MY 레시피 등록
	var msg = DS_head.getColumn(e.cell-1, "FDAY")+":"+DS_menu.getColumn(e.row, "sgbn_nm")+DS_menu.getColumn(e.row, "cgbn")+"의\n\nMY레시피 등록 작업을 하시겠습니까?";

	if (g_Confirm("04",	msg) == true) {
		// MY 레시피등록
		var	v_arg	= "";
		var	v_open	= "";
		var	v_rtn	= "";
		var	v_width	= -1;
		var	v_height= -1;
		var	leftPx	= -1;
		var	topPx	= -1;

		var	v_menu_cd	= DS_head.getColumn(e.cell-1, "FDAY")+"-"+ds_input.getColumn(0, "HALL_CD")+DS_menu.getColumn(e.row, "sgbn")+DS_menu.getColumn(e.row, "cgbn_cd");
		
		v_arg	 =  {fa_upjang:ds_input.getColumn(0, "UPJANG")
	                ,fa_hall_cd:ds_input.getColumn(0, "HALL_CD")
		            ,fa_meal:DS_menu.getColumn(e.row, "sgbn")
		            ,fa_corner:DS_menu.getColumn(e.row, "cgbn_cd")
		            ,fa_menu_date:DS_head.getColumn(e.cell-1, "FDAY")
		            ,fa_menu_cd:v_menu_cd
	                ,fa_subinv_code:ds_input.getColumn(0,"SUBINV_CODE")};
	
		v_open	 	= "TitleBar=false Status=false AutoSize=false Resize=false NoMove=false";
		//v_rtn 		= gfn_dialog("", "U_FSM::FSM00060E.xml", v_arg, v_width, v_height, v_open, leftPx, topPx);
		v_rtn 		= gfn_dialog("", "U_FSM::FSM00130E.xfdl", v_arg);
		
		
		CurrentRow = e.row;
		fn_search();
		
		// grd_lst.SetFocus();
		// DS_menu.row = nRow;
	}
}

function grd_lst_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	if (e.row < 0 || e.cell < 1) {
		return;
	}
	
	// [ 변경전 ] if (DS_menu.GetColumn(nRow, "tot_gbn") == "99" && DS_menu.GetColumn(nRow, "sd_won_"+substr(DS_head.GetColumn(nCell-1, "fday"),4,4)) > 0) {
	if (DS_menu.getColumn(e.row, "tot_gbn") == "99" && gfn_length(DS_menu.getColumn(e.row, "sd_nm_"+gfn_subStr(DS_head.getColumn(e.cell-1, "FDAY"),4,4)))> 0) {
		var	v_menu_cd = DS_head.getColumn(e.cell-1, "FDAY")+"-"+ds_input.getColumn(0, "HALL_CD")+DS_menu.getColumn(e.row, "sgbn")+DS_menu.getColumn(e.row, "cgbn_cd");
		var msg = DS_head.getColumn(e.cell-1, "FDAY")+":"+DS_menu.getColumn(e.row, "sgbn_nm")+DS_menu.getColumn(e.row, "cgbn")+" 을 삭제하시겠습니까?\n\n";
		msg    += "[ "+v_menu_cd+" ]";

		// 삭제여부 CHECK
		var set_col		= gfn_subStr(DS_head.getColumn(e.cell-1, "FDAY"),4,4);
		var fil_cond	= "FDAY=='"+DS_head.getColumn(e.cell-1, "FDAY")+"'&&SGBN=='"+DS_menu.getColumn(e.row, "sgbn")+"'&&CGBN=='"+DS_menu.getColumn(e.row, "cgbn")+"'&&CGBN_CD=='"+DS_menu.getColumn(e.row, "cgbn_cd")+"'";
		var n_row		= tab_Main.tab00.DS_body1.findRowExpr(fil_cond);
		
		if (n_row < 0) {
				g_Message("EE",	"예상식수 정보가 없습니다.\n\n식수정보를 확인 후 처리하세요.");
				return;
		}
		else {
			if (tab_Main.tab00.DS_body1.getColumn(n_row, "ORDER_YN") == "Y") {
				g_Message("EE",	"식자재가 발주되었습니다.\n\n메뉴를 삭제할수 없습니다.");
				return;
			}
		}

		if (g_Confirm("01",	msg) == true) {
			//alert(ds_input.GetColumn(0, "UPJANG"));
			//alert(v_menu_cd);
			//return;
			// 삭제처리
			var actionName, cmdName, inData, outData, otherArg, callBackFnc;
			
			inData			= "";
			outData			= "";
			otherArg		= "UPJANG="+wrapQuote(ds_input.getColumn(0, "UPJANG"))+" MENU_CD="+wrapQuote(v_menu_cd);
			callBackFnc		= "fn_afterSearch";
			
			fsp_clear(this); 
			fsp_addSearch(this, "fs/fsm:FSM00052E_D001");									// 조회 
			http.Sync = true;
			fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
			http.Sync = false;

			fn_search();
		}
		else {
			return;
		}
	}
	else {
		// 식수여부 CHECK
		var set_col		= gfn_subStr(DS_head.getColumn(e.cell-1, "FDAY"),4,4);
		var fil_cond	= "FDAY=='"+DS_head.getColumn(e.cell-1, "FDAY")+"'&&SGBN=='"+DS_menu.getColumn(e.row, "sgbn")+"'&&CGBN=='"+DS_menu.getColumn(e.row, "cgbn")+"'&&CGBN_CD=='"+DS_menu.getColumn(e.row, "cgbn_cd")+"'";
		var n_row		= tab_Main.tab00.DS_body1.findRowExpr(fil_cond);
		
		if (n_row < 0 || tab_Main.tab00.DS_body1.getColumn(n_row, "EXPECT_MEAL_QTY") < 1) {
				g_Message("EE",	"[레시피검색 및 등록/수정작업 불가 !!]\n\n예상식수 정보가 없습니다.\n\n식수정보를 확인 후 처리하세요.");
				return;
		}
		
		// 레시피 검색 및 등록/수정
		var msg = DS_head.getColumn(e.cell-1, "FDAY")+":"+DS_menu.getColumn(e.row, "sgbn_nm")+DS_menu.getColumn(e.row, "cgbn")+" 에 대한\n\n레시피 검색 및 등록/수정 작업을\n\n하시겠습니까?";

		if (g_Confirm("04",	msg) == true) {
			// 레시피 검색 및 등록/수정
			var	v_arg	= "";
			var	v_open	= "";
			var	v_rtn	= "";
			var	v_width	= -1;
			var	v_height= -1;
			var	leftPx	= -1;
			var	topPx	= -1;
			
			v_arg	= {fa_UPJANG:ds_input.getColumn(0, "UPJANG")
			          ,fa_HALL_CD:ds_input.getColumn(0, "HALL_CD")
			          ,fa_HALL_CLASS:''
			          ,fa_FROM_DT:ds_input.getColumn(0, "MENU_SDATE")
			          ,fa_TO_DT:ds_input.getColumn(0, "MENU_EDATE")
			          ,fa_MEAL:DS_menu.getColumn(e.row, "sgbn")
			          ,fa_CORNER:DS_menu.getColumn(e.row, "cgbn_cd")
			          ,fa_MENU_DATE:DS_head.getColumn(e.cell-1, "FDAY")			          
			          ,fa_SUBINV_CODE:ds_input.getColumn(0, "SUBINV_CODE")};
			          
			v_open	 	= "TitleBar=false Status=false AutoSize=false Resize=false NoMove=false";
			//v_rtn 		= gfn_dialog("", "U_FSM::FSM00060E.xml", v_arg, v_width, v_height, v_open, leftPx, topPx);
			v_rtn 		= gfn_dialog("", "U_FSM::FSM00060E.xfdl", v_arg);
			
			fn_search();
		}
	}
}

// NY 레시피 구성
function btn_recipe_OnClick(obj:Button, e:ClickEventInfo)
{
	var	v_arg	= "";
	var	v_open	= "";
	var	v_rtn	= "";
	var	v_width	= -1;
	var	v_height= -1;
	var	leftPx	= -1;
	var	topPx	= -1;
	
// 	v_arg	= {fa_UPJANG:ds_input.getColumn(0, "UPJANG")
// 	           ,fa_UPJANG_NM:ds_input.getColumn(0, "UPJANG_NM")
// 	           ,fa_HALL_CD:ds_input.getColumn(0, "HALL_CD")
// 	           ,fa_HALL_NAME:cbo_HALL_CD.text
// 	           ,fa_MENU_DATE:ds_input.getColumn(0, "MENU_DATE")
// 	           ,fa_SUBINV_CODE:ds_input.getColumn(0, "SUBINV_CODE")};

	v_arg	 =  {fa_Upjang:ds_input.getColumn(0, "UPJANG")
	            ,fa_UpjangNm:ds_input.getColumn(0, "UPJANG_NM")
	            ,fa_HallCd:ds_input.getColumn(0, "HALL_CD")
	            ,fa_HallName:cbo_HALL_CD.text
	            ,fa_MenuDate:ds_input.getColumn(0, "MENU_DATE")
	            ,fa_SubinvCode:ds_input.getColumn(0, "SUBINV_CODE")};
	
	v_open	 	= "TitleBar=false Status=false AutoSize=false Resize=false NoMove=false";
	//v_rtn 		= gfn_dialog("", "U_FSM::FSM00060E.xml", v_arg, v_width, v_height, v_open, leftPx, topPx);
	v_rtn 		= gfn_dialog("", "U_FSM::FSM00110E.xfdl", v_arg);
	
	fn_search();
}

// 식단복사
function btn_fcopy_OnClick(obj:Button, e:ClickEventInfo)
{
	var	v_arg	= "";
	var	v_open	= "";
	var	v_rtn	= "";
	var	v_width	= -1;
	var	v_height= -1;
	var	leftPx	= -1;
	var	topPx	= -1;
	
	v_arg	 = {fa_UPJANG:ds_input.getColumn(0, "UPJANG")
	           ,fa_UPJANG_NM:ds_input.getColumn(0, "UPJANG_NM")
	           ,fa_HALL_CD:ds_input.getColumn(0, "HALL_CD")
	           ,fa_HALL_NAME:cbo_HALL_CD.text
	           ,fa_FROM_DT:ds_input.getColumn(0, "MENU_SDATE")
	           ,fa_TO_DT:ds_input.getColumn(0, "MENU_EDATE")}; 
	
	v_open	 	= "TitleBar=false Status=false AutoSize=false Resize=false NoMove=false";
	//v_rtn 		= gfn_dialog("", "U_FSM::FSM00060E.xml", v_arg, v_width, v_height, v_open, leftPx, topPx);
	v_rtn 		= gfn_dialog("", "U_FSM::FSM00100E.xfdl", v_arg);
	
	fn_search();
	
}

// 식단평가


// 영양분석
function btn_rut_OnClick(obj:Button, e:ClickEventInfo)
{
//
	var	v_arg	= "";
	var	v_open	= "";
	var	v_rtn	= "";
	var	v_width	= -1;
	var	v_height= -1;
	var	leftPx	= -1;
	var	topPx	= -1;
	
	v_arg	 = {fa_UPJANG:ds_input.getColumn(0, "UPJANG")
	           ,fa_HALL_CD:ds_input.getColumn(0, "HALL_CD")
	           ,fa_FROM_MENU_DATE:ds_input.getColumn(0, "MENU_SDATE")
	           ,fa_TO_MENU_DATE:ds_input.getColumn(0, "MENU_EDATE")
	           ,fa_gbn:wrapQuote(fa_gbn)}; 
	
	v_open	 	= "TitleBar=false Status=false AutoSize=false Resize=false NoMove=false";
	//v_rtn 		= gfn_dialog("", "U_FSM::FSM00060E.xml", v_arg, v_width, v_height, v_open, leftPx, topPx);
	v_rtn 		= gfn_dialog("", "U_FSM::FSM00170V.xfdl", v_arg);
	
	//Parent.fn_Search();	
}

// 구매신청 화면 실행
function Button04_OnClick(obj:Button, e:ClickEventInfo)
{
// 	gfn_openMenuForm(  "FSP00030E.xml"		// pgm_id, 
// 							,"U_FSP"				// path,
// 							,""						// v_call_param,
// 							,"구매신청");			// v_pgm_text	
								
     gfn_openMenuForm("FSP00030E.xfdl", "U_FSP", "", "구매신청");	
}
// 구매게시판 화면 실행
function Button03_OnClick(obj:Button, e:ClickEventInfo)
{
//     var bbsId = "13";
//     
// 	gfn_openMenuForm(  "SCC80040V.xml"		// pgm_id, 
// 							,"U_SCC"				// path,
// 							,bbsId					// v_call_param,
// 							,"구매게시판");			// v_pgm_text	
       gfn_openMenuForm("SCC80040V.xfdl", "U_SCC", {bbsId:'13'}, "구매게시판");	
}

// 2009-03-16(월) 원가 재 생성 추가 수정 사항. 변경자 : 노규완 
function btn_RSave_OnClick(obj:Button, e:ClickEventInfo)
{
	if ( me_Sdate.value < gfn_addDate(gfn_today(),1)){
		g_Message("EE",	"갱신일 지정 오류!!\n\n 당일 또는 과거 날짜는 갱신 할 수 없습니다.");
		return;
	  }	  
	
	if (! g_Confirm("02","원가 갱신 작업을 하시겠습니까?!\n\n지정일 ~ 지정일+6일(제공일기준)")) return;
	fn_Reflash_AMT();
}

// 2009-03-16(월) 원가 재 생성 추가 수정 사항. 변경자 : 노규완 
function  fn_Reflash_AMT()
{
	var t_timeout;
	
	// action 정보 초기화
	fsp_clear(this);
	
	// 데이타체크
	ds_input2.clearData();
	ds_input2.addRow();
	ds_input2.setColumn(0,"SDATE" ,me_Sdate.value);
	ds_input2.setColumn(0,"UPJANG",ds_input.getColumn(0, "UPJANG"));
	
	if (gfn_length(ds_input2.getColumn(0,"UPJANG"))== 0) {
		g_Message("EE",	"업장정보 오류!!\n\n 업장정보를 입력하세요.");
		return;
	  }	  
	
	if (gfn_length(ds_input2.getColumn(0,"SDATE"))== 0) {
		g_Message("EE",	"갱신일 오류!!\n\n갱신일을 입력하세요.");
		return;
	  }
	  	  
	    http.Sync = true;
		//http.TimeOut = 600;
		//DB.CommandTimeOut = 700;
		t_timeout = application.httptimeout;
		application.httptimeout=2000; //1800초
	
		fsp_addSingle(this, "fs/fsm:FSM00052E_I001");
		fsp_callService(this, "", "", "ds_input2=ds_input2:A", "ds_return=ds_return",  "", "fn_Out_Msg");
		//http.TimeOut = 30;
		application.httptimeout=t_timeout; //60초
		http.Sync = false;
}

// 2009-03-16(월) 원가 재 생성 추가 수정 사항. 변경자 : 노규완 
function fn_Out_Msg(cd,errmsg)
{
	if(cd==-1)
	{
		g_Message("EE","서비스 에러");
	}
	else
	{
	       //trace(ds_return.saveXML());
	
	
			if ((ds_return.getColumn(0,"O_RTN")) == 'TRUE'){	
				g_Message("04",ds_return.getColumn(0,"O_RTNMSG"));
				//Parent.fn_Search();
				}
			else{
				g_Message("EE","갱신 도중 오류가 발생 하였습니다. \n\n " + ds_return.getColumn(0,"O_RTNMSG"));
			}
	}
}
 
 

function btn_pyo_onclick(obj:Button,  e:ClickEventInfo)
{
	if (btn_pyo.userdata == "img_close") {
		btn_pyo.userdata = "img_open";
		img_open_close.image = "URL('theme://convertImages/img_OpenBottom.png')";
		div_pyo.visible = false;
	}
	else {
		btn_pyo.userdata = "img_close";
		img_open_close.image = "URL('theme://convertImages/img_CloseBottom.png')";
		div_pyo.visible = true;
	}
}

function img_open_close_onclick(obj:ImageViewer,  e:ClickEventInfo)
{
	if (btn_pyo.userdata == "img_close") {
		btn_pyo.userdata = "img_open";
		img_open_close.image = "URL('theme://convertImages/img_OpenBottom.png')";
		div_pyo.visible = false;
	}
	else {
		btn_pyo.userdata = "img_close";
		img_open_close.image = "URL('theme://convertImages/img_CloseBottom.png')";
		div_pyo.visible = true;
	}

}
]]></Script>
  </Form>
</FDL>

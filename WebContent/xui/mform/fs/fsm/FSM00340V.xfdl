<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSM00340V" onkeydown="FSM00340V_OnKeyDown" onload="form_onload" titletext="영양성분분석표" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static29" class="sta_WFSA_Labelbg" position="absolute 0 30 1236 71" anchor="left top right"/>
        <Grid autoenter="select" binddataset="ds_MainList" cellmovingtype="col" cellsizingtype="col" readonly="false" enable="true" id="grd_MainList" useinputpanel="false" onheadclick="grd_MainList_OnHeadClick" taborder="8" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 255 1237 710" selecttype="row" anchor="left right bottom">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30" band="left"/>
                <Column size="90" band="left"/>
                <Column size="140" band="left"/>
                <Column size="64" band="left"/>
                <Column size="200" band="left"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="77"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="16" band="head"/>
                <Row size="16" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
                <Row size="24" band="summ"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="식단" wordwrap="word"/>
                <Cell col="2" rowspan="2" displaytype="text" text="레시피명" wordwrap="word"/>
                <Cell col="3" rowspan="2" displaytype="text" text="자재코드" wordwrap="word"/>
                <Cell col="4" rowspan="2" displaytype="text" text="자재명" wordwrap="word"/>
                <Cell col="5" rowspan="2" displaytype="text" text="1인량&#10;(g)" wordwrap="word"/>
                <Cell col="6" rowspan="2" displaytype="text" text="가식부&#10;(g)" wordwrap="word"/>
                <Cell col="7" rowspan="2" displaytype="text" text="원가" wordwrap="word"/>
                <Cell col="8" rowspan="2" displaytype="text" text="폐기율&#10;(%)" wordwrap="word"/>
                <Cell col="9" rowspan="2" displaytype="text" text="에너지&#10;(kcal)" wordwrap="word"/>
                <Cell col="10" rowspan="2" displaytype="text" text="나트륨&#13;&#10;(mg)" wordwrap="word"/>
                <Cell col="11" rowspan="2" displaytype="text" text="수분&#10;(%)" wordwrap="word"/>
                <Cell col="12" rowspan="2" displaytype="text" text="단백질&#10;(g)" wordwrap="word"/>
                <Cell col="13" rowspan="2" displaytype="text" text="지질&#10;(g)" wordwrap="word"/>
                <Cell col="14" rowspan="2" displaytype="text" text="당질&#10;(g)" wordwrap="word"/>
                <Cell col="15" rowspan="2" displaytype="text" text="섬유소&#10;(g)" wordwrap="word"/>
                <Cell col="16" rowspan="2" displaytype="text" text="회분&#10;(g)" wordwrap="word"/>
                <Cell col="17" rowspan="2" displaytype="text" text="칼슘&#10;(mg)" wordwrap="word"/>
                <Cell col="18" rowspan="2" displaytype="text" text="인&#10;(mg)" wordwrap="word"/>
                <Cell col="19" rowspan="2" displaytype="text" text="철&#10;(mg)" wordwrap="word"/>
                <Cell col="20" rowspan="2" displaytype="text" text="칼륨&#10;(mg)" wordwrap="word"/>
                <Cell col="21" rowspan="2" text="비타민A&#10;(R.E)" taborder="undefined"/>
                <Cell col="22" rowspan="2" displaytype="text" text="레티놀&#10;(㎍)" wordwrap="word"/>
                <Cell col="23" rowspan="2" displaytype="text" text="베타카로&#10;틴(㎍)" wordwrap="word"/>
                <Cell col="24" rowspan="2" displaytype="text" text="비타민B1&#10;(mg)" wordwrap="word"/>
                <Cell col="25" rowspan="2" displaytype="text" text="비타민B2&#10;(mg)" wordwrap="word"/>
                <Cell col="26" rowspan="2" displaytype="text" text="나이아신&#10;(mg)" wordwrap="word"/>
                <Cell col="27" rowspan="2" displaytype="text" text="비타민C&#10;(mg)" wordwrap="word"/>
                <Cell col="28" rowspan="2" displaytype="text" text="콜레스테C&#10;롤(mg)" wordwrap="word"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;background:white;background2:white;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;background:white;background2:white;" text="expr:decode(getRowLevel(currow),2,ds_MainList.getColumn(currow-2,'MEAL_CORNER'),'1',ds_MainList.getColumn(currow-1,'MEAL_CORNER'),MEAL_CORNER)" suppress="1"/>
                <Cell col="2" displaytype="text" style="align:expr:decode(GetRowType(ds_MainList,currow), &quot;logical&quot;, &quot;center&quot;, &quot;left&quot;);background:EXPR(decode(getRowLevel(currow),2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),2,'#ffefb5ff'));" text="expr:decode(getRowLevel(currow),2,'합계','1',ds_MainList.getColumn(currow-1,'RECIPE_NAME'),RECIPE_NAME)" suppress="2"/>
                <Cell col="3" displaytype="text" style="align:center;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="expr:decode(getRowLevel(currow),1,'',ITEM_CODE,'')"/>
                <Cell col="4" displaytype="text" style="align:expr:decode(GetRowType(ds_MainList,currow), &quot;logical&quot;, &quot;center&quot;, &quot;left&quot;);background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="EXPR(decode(getRowLevel(currow),1,'소계',ITEM_NAME,''))"/>
                <Cell col="5" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:NEED_QTY" mask="###,##0.00"/>
                <Cell col="6" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:EDIBLE_QTY" mask="###,##0.00"/>
                <Cell col="7" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:ITEM_COST" mask="###,##0"/>
                <Cell col="8" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:DISUSE_RATE" mask="###,##0"/>
                <Cell col="9" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:CAL" mask="###,##0.00"/>
                <Cell col="10" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:NA" mask="###,##0.00"/>
                <Cell col="11" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:WATER" mask="###,##0.00"/>
                <Cell col="12" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:PROT" mask="###,##0.00"/>
                <Cell col="13" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:FAT" mask="###,##0.00"/>
                <Cell col="14" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:CARBO" mask="###,##0.00"/>
                <Cell col="15" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:FIBER" mask="###,##0.00"/>
                <Cell col="16" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:ASH" mask="###,##0.00"/>
                <Cell col="17" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:CA" mask="###,##0.00"/>
                <Cell col="18" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:P" mask="###,##0.00"/>
                <Cell col="19" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:FE" mask="###,##0.00"/>
                <Cell col="20" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:K" mask="###,##0.00"/>
                <Cell col="21" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:VITA_A" mask="###,##0.00"/>
                <Cell col="22" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:RETIN" mask="###,##0.00"/>
                <Cell col="23" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:B_CAROT" mask="###,##0.00"/>
                <Cell col="24" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:THIA" mask="###,##0.00"/>
                <Cell col="25" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:RIBO" mask="###,##0.00"/>
                <Cell col="26" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:NIACIN" mask="###,##0.00"/>
                <Cell col="27" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:VITA_C" mask="###,##0.00"/>
                <Cell col="28" displaytype="number" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:CHOLE" mask="###,##0.00"/>
              </Band>
              <Band id="summary">
                <Cell colspan="5" displaytype="text" style="align:center;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" text="총        계"/>
                <Cell col="5" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('NEED_QTY')" mask="###,##0.00"/>
                <Cell col="6" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('EDIBLE_QTY')" mask="###,##0.00"/>
                <Cell col="7" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('ITEM_COST')" mask="###,##0.00"/>
                <Cell col="8" displaytype="normal" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));"/>
                <Cell col="9" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('CAL')" mask="###,##0.00"/>
                <Cell col="10" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('NA')" mask="###,##0.00"/>
                <Cell col="11" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('WATER')" mask="###,##0.00"/>
                <Cell col="12" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('PROT')" mask="###,##0.00"/>
                <Cell col="13" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('FAT')" mask="###,##0.00"/>
                <Cell col="14" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('CARBO')" mask="###,##0.00"/>
                <Cell col="15" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('FIBER')" mask="###,##0.00"/>
                <Cell col="16" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('ASH')" mask="###,##0.00"/>
                <Cell col="17" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('CA')" mask="###,##0.00"/>
                <Cell col="18" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('P')" mask="###,##0.00"/>
                <Cell col="19" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('FE')" mask="###,##0.00"/>
                <Cell col="20" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('K')" mask="###,##0.00"/>
                <Cell col="21" displaytype="number" style="background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('VITA_A')" mask="###,##0.00"/>
                <Cell col="22" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('RETIN')" mask="###,##0.00"/>
                <Cell col="23" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('B_CAROT')" mask="###,##0.00"/>
                <Cell col="24" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('THIA')" mask="###,##0.00"/>
                <Cell col="25" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('RIBO')" mask="###,##0.00"/>
                <Cell col="26" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('NIACIN')" mask="###,##0.00"/>
                <Cell col="27" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('VITA_C')" mask="###,##0.00"/>
                <Cell col="28" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('CHOLE')" mask="###,##0.00"/>
                <Cell col="29" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(1,'BG'));background2:EXPR(gfn_sumStyle(1,'BG'));" expr="expr:getSum('CHOLE')" mask="###,##0.00"/>
                <Cell row="1" colspan="5" displaytype="text" style="align:center;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" text="끼니   평균"/>
                <Cell row="1" col="5" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));"/>
                <Cell row="1" col="6" displaytype="text" style="align:center;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));"/>
                <Cell row="1" col="7" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));"/>
                <Cell row="1" col="8" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));"/>
                <Cell row="1" col="9" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));"/>
                <Cell row="1" col="10" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('CAL') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="11" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('NA') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="12" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('PROT') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="13" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('FAT') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="14" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('CARBO') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="15" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('FIBER') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="16" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('ASH') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="17" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('CA') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="18" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('P') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="19" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('FE') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="20" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('K') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="21" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('VITA_A') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="22" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('RETIN') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="23" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('B_CAROT') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="24" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('THIA') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="25" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('RIBO') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="26" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('NIACIN') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="27" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('VITA_C') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="28" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('CHOLE') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="1" col="29" displaytype="number" style="align:right;background:EXPR(gfn_sumStyle(2,'BG'));background2:EXPR(gfn_sumStyle(2,'BG'));" expr="expr:fn_clearNaN(getSum('CHOLE') / v_total_chkCount)" mask="###,##0.00"/>
                <Cell row="2" colspan="5" displaytype="text" style="align:center;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));" text="에너지 구성 비율"/>
                <Cell row="2" col="5" displaytype="text" style="align:right;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="6" displaytype="text" style="align:center;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="7" displaytype="text" style="align:left;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="8" displaytype="text" style="align:left;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="9" displaytype="text" style="align:left;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="10" displaytype="text" style="align:left;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="11" displaytype="text" style="align:left;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="12" displaytype="text" style="align:right;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));" expr="expr:fn_CPF(&quot;PROT&quot;)"/>
                <Cell row="2" col="13" displaytype="text" style="align:right;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));" expr="expr:fn_CPF(&quot;FAT&quot;)"/>
                <Cell row="2" col="14" displaytype="text" style="align:right;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));" expr="expr:fn_CPF(&quot;CARBO&quot;)"/>
                <Cell row="2" col="15" displaytype="text" style="align:right;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="16" displaytype="text" style="align:left;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="17" displaytype="text" style="align:left;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="18" displaytype="text" style="align:left;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="19" displaytype="text" style="align:left;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="20" displaytype="text" style="align:left;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="21" style="background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="22" displaytype="text" style="align:left;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="23" displaytype="text" style="align:left;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="24" displaytype="text" style="align:left;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="25" displaytype="text" style="align:left;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="26" displaytype="text" style="align:left;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="27" displaytype="text" style="align:left;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="28" displaytype="text" style="align:left;background:EXPR(gfn_sumStyle(3,'BG'));background2:EXPR(gfn_sumStyle(3,'BG'));"/>
                <Cell row="2" col="29" displaytype="text" style="align:left;"/>
              </Band>
            </Format>
            <Format id="Default0">
              <Columns>
                <Column size="30" band="left"/>
                <Column size="95" band="left"/>
                <Column size="144" band="left"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="16" band="head"/>
                <Row size="16" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
                <Row size="24" band="summ"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="식단" wordwrap="word"/>
                <Cell col="2" rowspan="2" displaytype="text" text="레시피명" wordwrap="word"/>
                <Cell col="3" rowspan="2" displaytype="text" text="1인량&#10;(g)" wordwrap="word"/>
                <Cell col="4" rowspan="2" displaytype="text" text="원가" wordwrap="word"/>
                <Cell col="5" rowspan="2" displaytype="text" text="에너지&#10;(kcal)" wordwrap="word"/>
                <Cell col="6" rowspan="2" displaytype="text" text="수분&#10;(%)" wordwrap="word"/>
                <Cell col="7" rowspan="2" displaytype="text" text="단백질&#10;(g)" wordwrap="word"/>
                <Cell col="8" rowspan="2" displaytype="text" text="지질&#10;(g)" wordwrap="word"/>
                <Cell col="9" rowspan="2" displaytype="text" text="당질&#10;(g)" wordwrap="word"/>
                <Cell col="10" rowspan="2" displaytype="text" text="섬유소&#10;(g)" wordwrap="word"/>
                <Cell col="11" rowspan="2" displaytype="text" text="회분&#10;(g)" wordwrap="word"/>
                <Cell col="12" rowspan="2" displaytype="text" text="칼슘&#10;(mg)" wordwrap="word"/>
                <Cell col="13" rowspan="2" displaytype="text" text="인(mg)" wordwrap="word"/>
                <Cell col="14" rowspan="2" displaytype="text" text="철&#10;(mg)" wordwrap="word"/>
                <Cell col="15" rowspan="2" displaytype="text" text="나트륨&#10;(mg)" wordwrap="word"/>
                <Cell col="16" rowspan="2" displaytype="text" text="칼륨&#10;(mg)" wordwrap="word"/>
                <Cell col="17" rowspan="2" displaytype="text" text="비타민A&#10;(mg)" wordwrap="word"/>
                <Cell col="18" rowspan="2" displaytype="text" text="레티놀&#10;(mg)" wordwrap="word"/>
                <Cell col="19" rowspan="2" displaytype="text" text="베타카로틴&#10;(mg)" wordwrap="word"/>
                <Cell col="20" rowspan="2" displaytype="text" text="비타민B1&#10;(mg)" wordwrap="word"/>
                <Cell col="21" rowspan="2" displaytype="text" text="비타민B2&#10;(mg)" wordwrap="word"/>
                <Cell col="22" rowspan="2" displaytype="text" text="나미아신&#10;(mg)" wordwrap="word"/>
                <Cell col="23" rowspan="2" displaytype="text" text="비타민C&#10;(mg)" wordwrap="word"/>
                <Cell col="24" rowspan="2" displaytype="text" text="콜레스테롤&#10;(mg)" wordwrap="word"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;background:white;background2:white;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;background:white;background2:white;" expr="expr:decode(getRowLevel(currow),1,ds_MainList.getColumn(currow-1,'MEAL_CORNER'),MEAL_CORNER)" suppress="1"/>
                <Cell col="2" displaytype="text" style="align:expr:decode(GetRowType(ds_MainList,currow), &quot;logical&quot;, &quot;center&quot;, &quot;left&quot;);background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:RECIPE_NAME" subsumtext="소계" suppress="2"/>
                <Cell col="3" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:NEED_QTY" mask="###,##0.00"/>
                <Cell col="4" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:ITEM_COST" mask="###,##0.00"/>
                <Cell col="5" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:CAL" mask="###,##0.00"/>
                <Cell col="6" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:WATER" mask="###,##0.00"/>
                <Cell col="7" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:PROT" mask="###,##0.00"/>
                <Cell col="8" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:FAT" mask="###,##0.00"/>
                <Cell col="9" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:CARBO" mask="###,##0.00"/>
                <Cell col="10" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:FIBER" mask="###,##0.00"/>
                <Cell col="11" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:ASH" mask="###,##0.00"/>
                <Cell col="12" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:CA" mask="###,##0.00"/>
                <Cell col="13" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:P" mask="###,##0.00"/>
                <Cell col="14" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:FE" mask="###,##0.00"/>
                <Cell col="15" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:NA" mask="###,##0.00"/>
                <Cell col="16" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:K" mask="###,##0.00"/>
                <Cell col="17" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:VITA_A" mask="###,##0.00"/>
                <Cell col="18" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:RETIN" mask="###,##0.00"/>
                <Cell col="19" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:B_CAROT" mask="###,##0.00"/>
                <Cell col="20" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:THIA" mask="###,##0.00"/>
                <Cell col="21" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:RIBO" mask="###,##0.00"/>
                <Cell col="22" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:NIACIN" mask="###,##0.00"/>
                <Cell col="23" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:VITA_C" mask="###,##0.00"/>
                <Cell col="24" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));background2:EXPR(decode(getRowLevel(currow),1,'#e7e7ffff',2,'#ffefb5ff'));" text="bind:CHOLE" mask="###,##0.00"/>
              </Band>
              <Band id="summary">
                <Cell colspan="3" displaytype="text" style="align:center;" text="총        계"/>
                <Cell col="3" displaytype="number" style="align:right;" expr="expr:getSum('NEED_QTY')" mask="###,##0.00"/>
                <Cell col="4" displaytype="number" style="align:right;" expr="expr:getSum('ITEM_COST')" mask="###,##0.00"/>
                <Cell col="5" displaytype="number" style="align:right;" expr="expr:getSum('CAL')" mask="###,##0.00"/>
                <Cell col="6" displaytype="number" style="align:right;" expr="expr:getSum('WATER')" mask="###,##0.00"/>
                <Cell col="7" displaytype="number" style="align:right;" expr="expr:getSum('PROT')" mask="###,##0.00"/>
                <Cell col="8" displaytype="number" style="align:right;" expr="expr:getSum('FAT')" mask="###,##0.00"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:getSum('CARBO')" mask="###,##0.00"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="expr:getSum('FIBER')" mask="###,##0.00"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:getSum('ASH')" mask="###,##0.00"/>
                <Cell col="12" displaytype="number" style="align:right;" expr="expr:getSum('CA')" mask="###,##0.00"/>
                <Cell col="13" displaytype="number" style="align:right;" expr="expr:getSum('P')" mask="###,##0.00"/>
                <Cell col="14" displaytype="number" style="align:right;" expr="expr:getSum('FE')" mask="###,##0.00"/>
                <Cell col="15" displaytype="number" style="align:right;" expr="expr:getSum('NA')" mask="###,##0.00"/>
                <Cell col="16" displaytype="number" style="align:right;" expr="expr:getSum('K')" mask="###,##0.00"/>
                <Cell col="17" displaytype="number" style="align:right;" expr="expr:getSum('VITA_A')" mask="###,##0.00"/>
                <Cell col="18" displaytype="number" style="align:right;" expr="expr:getSum('RETIN')" mask="###,##0.00"/>
                <Cell col="19" displaytype="number" style="align:right;" expr="expr:getSum('B_CAROT')" mask="###,##0.00"/>
                <Cell col="20" displaytype="number" style="align:right;" expr="expr:getSum('THIA')" mask="###,##0.00"/>
                <Cell col="21" displaytype="number" style="align:right;" expr="expr:getSum('RIBO')" mask="###,##0.00"/>
                <Cell col="22" displaytype="number" style="align:right;" expr="expr:getSum('NIACIN')" mask="###,##0.00"/>
                <Cell col="23" displaytype="number" style="align:right;" expr="expr:getSum('VITA_C')" mask="###,##0.00"/>
                <Cell col="24" displaytype="number" style="align:right;" expr="expr:getSum('CHOLE')" mask="###,##0.00"/>
                <Cell row="1" colspan="3" displaytype="text" style="align:center;" text="평        균"/>
                <Cell row="1" col="3" displaytype="text" style="align:right;"/>
                <Cell row="1" col="4" displaytype="text" style="align:right;"/>
                <Cell row="1" col="5" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('CAL'))" mask="###,##0.00"/>
                <Cell row="1" col="6" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('WATER')" mask="###,##0.00"/>
                <Cell row="1" col="7" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('PROT'))" mask="###,##0.00"/>
                <Cell row="1" col="8" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('FAT'))" mask="###,##0.00"/>
                <Cell row="1" col="9" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('CARBO'))" mask="###,##0.00"/>
                <Cell row="1" col="10" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('FIBER'))" mask="###,##0.00"/>
                <Cell row="1" col="11" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('ASH'))" mask="###,##0.00"/>
                <Cell row="1" col="12" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('CA'))" mask="###,##0.00"/>
                <Cell row="1" col="13" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('P'))" mask="###,##0.00"/>
                <Cell row="1" col="14" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('FE'))" mask="###,##0.00"/>
                <Cell row="1" col="15" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('NA'))" mask="###,##0.00"/>
                <Cell row="1" col="16" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('K'))" mask="###,##0.00"/>
                <Cell row="1" col="17" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('VITA_A'))" mask="###,##0.00"/>
                <Cell row="1" col="18" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('RETIN'))" mask="###,##0.00"/>
                <Cell row="1" col="19" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('B_CAROT'))" mask="###,##0.00"/>
                <Cell row="1" col="20" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('THIA'))" mask="###,##0.00"/>
                <Cell row="1" col="21" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('RIBO'))" mask="###,##0.00"/>
                <Cell row="1" col="22" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('NIACIN'))" mask="###,##0.00"/>
                <Cell row="1" col="23" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('VITA_C'))" mask="###,##0.00"/>
                <Cell row="1" col="24" displaytype="number" style="align:right;" expr="expr:fn_clearNaN(getAvg('CHOLE'))" mask="###,##0.00"/>
                <Cell row="2" colspan="3" displaytype="text" style="align:center;" text="에너지 구성 비율"/>
                <Cell row="2" col="3" displaytype="text" style="align:left;"/>
                <Cell row="2" col="4" displaytype="text" style="align:left;"/>
                <Cell row="2" col="5" displaytype="text" style="align:left;"/>
                <Cell row="2" col="6" displaytype="text" style="align:left;"/>
                <Cell row="2" col="7" displaytype="text" style="align:right;" expr="expr:fn_CPF(&quot;PROT&quot;)"/>
                <Cell row="2" col="8" displaytype="text" style="align:right;" expr="expr:fn_CPF(&quot;FAT&quot;)"/>
                <Cell row="2" col="9" displaytype="text" style="align:right;" expr="expr:fn_CPF(&quot;CARBO&quot;)"/>
                <Cell row="2" col="10" displaytype="text" style="align:left;"/>
                <Cell row="2" col="11" displaytype="text" style="align:left;"/>
                <Cell row="2" col="12" displaytype="text" style="align:left;"/>
                <Cell row="2" col="13" displaytype="text" style="align:left;"/>
                <Cell row="2" col="14" displaytype="text" style="align:left;"/>
                <Cell row="2" col="15" displaytype="text" style="align:left;"/>
                <Cell row="2" col="16" displaytype="text" style="align:left;"/>
                <Cell row="2" col="17" displaytype="text" style="align:left;"/>
                <Cell row="2" col="18" displaytype="text" style="align:left;"/>
                <Cell row="2" col="19" displaytype="text" style="align:left;"/>
                <Cell row="2" col="20" displaytype="text" style="align:left;"/>
                <Cell row="2" col="21" displaytype="text" style="align:left;"/>
                <Cell row="2" col="22" displaytype="text" style="align:left;"/>
                <Cell row="2" col="23" displaytype="text" style="align:left;"/>
                <Cell row="2" col="24" displaytype="text" style="align:left;"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid autoenter="select" binddataset="ds_List" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="grd_Item1" useinputpanel="false" selecttype="row" oncellclick="grd_Item1_OnCellClick" onheadclick="grd_Item1_OnHeadClick" taborder="7" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 81 1237 242" autofittype="col" anchor="all" class="grd_WF_LineNone">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="96"/>
                <Column size="70"/>
                <Column size="90"/>
                <Column size="786"/>
                <Column size="95"/>
                <Column size="95"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="제공일"/>
                <Cell col="1" displaytype="text" text="끼니"/>
                <Cell col="2" displaytype="text" text="코너"/>
                <Cell col="3" displaytype="text" text="제공메뉴"/>
                <Cell col="4" displaytype="text" text="식단가"/>
                <Cell col="5" displaytype="text" text="예상식수"/>
                <Cell col="6" displaytype="text" text="선택" combodatacol="ㅇ"/>
              </Band>
              <Band id="body">
                <Cell text="bind:MENU_DATE"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:MEAL" expr="expr:iif(MEAL=='',MENU_FEATURE,MEAL)"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:CORNER"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:MENU_CONSTRUCT"/>
                <Cell col="4" displaytype="number" style="align:right;" text="bind:SALE_PRICE" mask="###,##0"/>
                <Cell col="5" displaytype="number" style="align:right;" text="bind:EXPECT_MEAL_QTY" mask="###,##0"/>
                <Cell col="6" displaytype="checkbox" edittype="checkbox" style="align:center middle;" text="bind:SEL"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static1" text="사업장" position="absolute 15 42 86 63" class="sta_WFSA_label"/>
        <Static id="Static4" text="제공일" position="absolute 533 42 604 63" class="sta_WFSA_label"/>
        <MaskEdit id="me_FromMenuDate" mask="####-##-##" taborder="2" type="string" userdata="btn_FromDate" position="absolute 587 40 674 61" style="padding:1 0 0 0;align:center;" class="msk_WF_Cal" onkillfocus="Date_OnKillFocus" autoselect="true"/>
        <Button id="btn_FromDate" onclick="CalButton_OnClick" taborder="3" tabstop="false" userdata="me_FromMenuDate" position="absolute 673 40 695 61" class="btn_WF_cal" text="" image=""/>
        <Static id="Static0" text="식당" position="absolute 315 42 386 63" class="sta_WFSA_label"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" displayrowcount="10" id="cbo_HallCd" index="0" innerdataset="@ds_Hall" onitemchanged="cbo_HallCd_OnChanged" taborder="1" position="absolute 358 40 503 61"/>
        <CheckBox id="chk_Resource" onclick="chk_Resource_OnClick" taborder="4" tabstop="false" text="자재별" position="absolute 886 40 941 61" value="true" truevalue="1" falsevalue="0"/>
        <CheckBox id="chk_AbolitionRate" onclick="chk_AbolitionRate_OnClick" taborder="5" tabstop="false" text="폐기율 적용" position="absolute 960 40 1050 61" value="true" truevalue="1" falsevalue="0"/>
        <CheckBox id="chk_Recipe" onclick="chk_Recipe_OnClick" taborder="6" tabstop="false" text="'레시피조정'적용" position="absolute 1060 40 1170 61" value="true" truevalue="1" falsevalue="0"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="12" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static34" text="W10" visible="false" position="absolute 61 30 71 71" style="background:#ff000055;align:center middle;"/>
        <Static id="Static35" text="W30" visible="false" position="absolute 285 40 315 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static43" text="W10" visible="false" position="absolute 0 30 1237 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static44" text="W10" visible="false" position="absolute 0 61 1237 71" style="background:#ff000055;align:center middle;"/>
        <Static id="Static45" text="W15" visible="false" position="absolute 0 30 15 71" style="background:#ff000055;align:center middle;"/>
        <Static id="Static14" text="W10" visible="false" position="absolute 348 30 358 71" style="background:#ff000055;align:center middle;"/>
        <Static id="Static17" text="W30" visible="false" position="absolute 503 40 533 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static18" text="W10" visible="false" position="absolute 577 30 587 71" style="background:#ff000055;align:center middle;"/>
        <Static id="Static02" text="W15" visible="false" position="absolute 1222 30 1237 70" style="background:#ff000055;align:center middle;"/>
        <Static id="Static05" text="W10" visible="false" position="absolute 0 242 1237 255" style="background:#ff000055;align:center middle;"/>
        <UpjangSearchComponent id="edt_upjang" titletext="업장 검색용 Component" taborder="0" text="UpjangSearchComponent00" position="absolute 71 40 285 61" bindDataset="ds_Input" bindUpjangCodeColumn="UPJANG" bindUpjangNameColumn="UPJANG_NM" eventBeforeTrigger="" eventAfterTrigger="fn_SearchHall" roleSetId="ScoAuthLevel01" class="edt_WF_Essential"/>
        <MaskEdit id="me_FromMenuDate2" taborder="13" type="string" mask="####-##-##" autoselect="true" onkillfocus="Date_OnKillFocus" class="msk_WF_Cal" position="absolute 713 40 800 61" style="padding:1 0 0 0;align:center;" userdata="btn_FromDate"/>
        <Button id="btn_FromDate2" taborder="14" tabstop="false" onclick="CalButton_OnClick" class="btn_WF_cal" position="absolute 799 40 821 61" userdata="me_FromMenuDate2"/>
        <Static id="Static5" text="~" position="absolute 700 43 709 64"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_DetailList"/>
      <Dataset id="ds_Input">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="INT"/>
          <Column id="UPJANG_NM" size="256" type="STRING"/>
          <Column id="HALL_CD" size="256" type="STRING"/>
          <Column id="MEAL" size="256" type="STRING"/>
          <Column id="CORNER" size="256" type="STRING"/>
          <Column id="RECIPE_NAME" size="256" type="STRING"/>
          <Column id="MENU_DATE" type="STRING" size="256"/>
          <Column id="MENU_DATE2" size="256" type="STRING"/>
          <Column id="TO_MENU_DATE" size="256" type="STRING"/>
          <Column id="FROM_SALE_PRICE" size="256" type="INT"/>
          <Column id="TO_SALE_PRICE" size="256" type="INT"/>
          <Column id="FROM_MENU_PRICE" size="256" type="INT"/>
          <Column id="TO_MENU_PRICE" size="256" type="INT"/>
          <Column id="RESOURCE" size="256" type="INT"/>
          <Column id="RECIPE" size="256" type="INT"/>
          <Column id="ABOLITIONRATE" size="256" type="STRING"/>
          <Column id="MENU_CD" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="ABOLITIONRATE"/>
            <Col id="CORNER"/>
            <Col id="FROM_MENU_PRICE"/>
            <Col id="FROM_SALE_PRICE"/>
            <Col id="HALL_CD"/>
            <Col id="MEAL"/>
            <Col id="MENU_CD"/>
            <Col id="MENU_DATE2"/>
            <Col id="RECIPE"/>
            <Col id="RECIPE_NAME"/>
            <Col id="RESOURCE"/>
            <Col id="TO_MENU_DATE"/>
            <Col id="TO_MENU_PRICE"/>
            <Col id="TO_SALE_PRICE"/>
            <Col id="UPJANG"/>
            <Col id="UPJANG_NM"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Hall">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">00000</Col>
            <Col id="CODE_NAME">- 전체 -</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Meal">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">000</Col>
            <Col id="CODE_NAME">- 전체 -</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Corner">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">000</Col>
            <Col id="CODE_NAME">- 전체 -</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_RecipeName"/>
      <Dataset id="ds_MainList" keystring="MEAL,CORNER,RECIPE_NAME" enableevent="true">
        <ColumnInfo>
          <Column id="MENU_NAME" size="0" prop="sum" type="STRING"/>
          <Column id="RECIPE_NAME" size="0" prop="sum" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Main"/>
      <Dataset id="ds_sum"/>
      <Dataset id="ds_List"/>
    </Objects>
    <Bind/>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 메뉴관리 > 식단관리
 * 프로그램명   : FSM00340.XML
 * 기      능   : 영양성분분석표
 * 작  성  자   : 
 * 작성  일자   : 2008-02-21
 * 비      고   : 
 *		- 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "LIB::sc_comon.js";			// 시스템공통 함수
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js";
//@@컨버터에서 주석처리 #include "LIB::sc_sql_common.js";
//@@컨버터에서 주석처리 #include "LIB::tit_comm_0001.js";		// X-Framework Lib
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
var v_ChkCount = 0;
var v_total_chkCount = 0;
var v_ChkInd = "0";
//var v_ChkMenuCd = ""; // 상위 리스트의 체크된 갯수를 반환하기위한 변수( 쿼리의 in함수에 들어갈 값)
//=========================================================================================
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(this);

	// X-Framework : Action 정보 생성 
	fsp_init(this);
	
	// 표준레시피명 콤보박스 데이터 조회
	fsp_clear(this);	
	
	ds_Input.clearData();
	ds_Input.addRow();

	chk_Recipe.value = false;
	grd_MainList.formatid="Default";
	
	// 메인사업장 셋팅
	ds_Input.setColumn(0, "UPJANG",   g_Upjang  );
	ds_Input.setColumn(0, "UPJANG_NM", g_UpjangNm);

	me_FromMenuDate.value = fn_CurrDateWeek();
	me_FromMenuDate2.value = fn_CurrDateWeek();

	fn_SearchHall();	
	fn_SearchHeadList();
}
//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_search()
{
	// 필수 검색조건 체크
/*	if( trim(ds_Input.GetColumn(0, "UPJANG")).length() == 0 ) {
		g_Message("EE", "사업장을 선택해 주세요.");
		ed_UpjangNm.SetFocus();
		return;
	}
	if( trim(ds_Input.GetColumn(0, "FROM_MENU_DATE")).length() == 0 ) {
		g_Message("EE", "제공일 시작일을 선택해 주세요.");
		me_FromMenuDate.SetFocus();
		return;
	}
	*/
	if(ds_List.getRowCount() == 0){
		g_Message("EE", "해당 데이터가 없습니다.");
		return;
	}else{
		fn_SetMenuCd();
	}
	
	if( v_ChkCount == 0 ) {
		g_Message("EE", "식단을 체크해 주세요.");
		return;
	}
	v_ChkCount = 0;

	//trace("SEL의 값"+ds_List.GetColumn(1,"SEL"));
	v_total_chkCount = 0;
	
	for( var i=0; i<ds_List.getRowCount(); i++ ) {
		if( ds_List.getColumn(i, "SEL") == "1" ) {
			v_total_chkCount += 1;
		}
	}		
	fsp_clear(this);
	ds_MainList.clearData();
	
	//ds_Input.setColumn(0, "UPJANG_NM", ed_UpjangNm.value);
	ds_Input.setColumn(0, "HALL_CD", cbo_HallCd.value);
	ds_Input.setColumn(0, "MENU_DATE", me_FromMenuDate.value);
	ds_Input.setColumn(0, "MENU_DATE2", me_FromMenuDate2.value);
	ds_Input.setColumn(0, "RESOURCE", chk_Resource.value);
	ds_Input.setColumn(0, "ABOLITIONRATE", chk_AbolitionRate.value);
	ds_Input.setColumn(0, "RECIPE", chk_Recipe.value);

//	tit_addSearchActionInfo(this,"fs/fsm:FSM00340V_S001");
//	tit_CallService(this,"","","ds_Input=ds_Input","ds_MainList=ds_MainList","","fn_CallBackSearch");
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	actionName		= "FSM00340V_S001";
	cmdName			= "U_svc::" + "fs/fsm/FSM00340V_S001.jsp";
	inData			= "ds_Input=ds_Input";
	outData			= "ds_MainList=ds_MainList";
	callBackFnc		= "fn_CallBackSearch";
	
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc,true,false,false);

}
/*------------------------------------------------------------
	1. Function    : fn_CallBackSearch(errCode, errMsg)
	2. Description : fn_Search() CallBack Function
	3. Arguments   : 
	4. History     : 2008. 02 21 - 최초작성
*------------------------------------------------------------*/
function fn_CallBackSearch(errCode, errMsg)
{	
	if( errCode != 0 ) {
		return;
	} else {
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Insert()
 * 기      능   : [등록버튼] 등록 버튼 클릭 시 처리되는 작업
 ******************************************************************************************
 */
function fn_insert()
{
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Save()
 * 기      능   : [저장버튼] 저장 버튼 클릭 시 처리되는 작업
 ******************************************************************************************
 */
function fn_save()
{
}
/* 
 ******************************************************************************************
 * 함  수  명   : fn_Delete()
 * 기      능   : [삭제버튼] 삭제 시 처리되는 작업
 ******************************************************************************************
 */
function fn_delete(nRow)
{
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Print()
 * 기      능   : [출력버튼] 출력 시 처리되는 작업
 ******************************************************************************************
 */
function fn_print()
{
	var chkAbol = "", chkRecipe= "";

	if(ds_MainList.getRowCount() == 0){
		g_Message("EE","출력할 데이터가 없습니다!");
		return;
	}	
//	trace("폐기율 : "+chk_AbolitionRate.Value);
//	trace("레시피 : "+chk_Recipe.Value);
//	trace("자재별여부 : "+chk_Resource.Value);

	// 폐기율 적용여부
	if(chk_AbolitionRate.value == 1){
		chkAbol = "Y";
	}else if(chk_AbolitionRate.value == 0){
		chkAbol = "N";
	}
	// 레시피수정 여부
	if(chk_Recipe.value == 1){
		chkRecipe = "Y";
	}else if( chk_Recipe.value == 0 ){
		chkRecipe = "N";
	}
	
	var checkCnt = ds_Input.getColumn(0, "MENU_CD");

	//레포트에 전달할 파라메터 생성
	var arrParams	= SCReport.newParams ();
	
	//--------------------------------------------------
	//방법1)서버에서 Query에 의해 처리하는 경우 예
	//(필수) 레포트명
	if(chk_Resource.value == "1"){
		SCReport.setParams (arrParams, SCReport.RPT_NAME, "/IFIS/FSM00340V_REPORT_01.ozr");
	}else{
		SCReport.setParams (arrParams, SCReport.RPT_NAME, "/IFIS/FSM00340V_REPORT_02.ozr");
	}

	//출력 옵션 설정
	//-창 타이틀 (디폴트는 "ReportViewer")
	SCReport.setParams (arrParams, SCReport.RPT_TITLE, "영양성분분석표");
	
	//레포트에 맞게 전달되는 개발자 정의 파라미터
	//SCReport.setParams (arrParams, "cnt", 6);
	SCReport.setParams (arrParams, "PARAM1", ds_Input.getColumn(0, "UPJANG")); // 업장코드
	SCReport.setParams (arrParams, "PARAM2", me_FromMenuDate.value);           // 제공일
	SCReport.setParams (arrParams, "PARAM3", cbo_HallCd.value);                // 식당
	SCReport.setParams (arrParams, "PARAM4", checkCnt);                        // 상단그리드에서 체크된 코드값을 in함수의 값으로 넘김
	SCReport.setParams (arrParams, "PARAM5", chkAbol);                         // 폐기율 적용 여부
	SCReport.setParams (arrParams, "PARAM6", chkRecipe);                       // 레시피수정 여부
	SCReport.setParams (arrParams, "zoom", 150);
	//--------------------------------------------------
	SCReport.viewReport (this, arrParams);
	strReturn = gfn_dialog("", "U_SCC::SCCOZREPORT1.xfdl",{fstrParam:strParam});
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function fn_Close()
{
	this.close();
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Help()
 * 기      능   : [도움말버튼] 도움말
 ******************************************************************************************
 */
function fn_help()
{
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*------------------------------------------------------------
	1. Function    : fn_SearchHeadList()
	2. Description : 
	3. Arguments   : 
	4. History     : 2008. 02. 29 - 최초작성
*------------------------------------------------------------*/
function fn_SearchHeadList()
{
/*	var upjangCd = 0;
	var menuDate = "";
	var hallCd = 0;
	
	upjangCd = ds_Input.GetColumn(0, "UPJANG");
	ds_Input.GetColumn(0, "HALL_CD");
	ds_Input.GetColumn(0, "MENU_DATE");		*/
	
	fsp_clear(this);
	ds_List.clearData();
	ds_MainList.clearData();

	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	if (me_FromMenuDate.value == "____-__-__") {
		g_Message("EE","시작일자를 입력해 주세요!");
		return false;
	}
	if (me_FromMenuDate2.value == "____-__-__") {
		g_Message("EE","종료일자를 입력해 주세요!");
		return false;
	}
	
	// 최대 3개월 조회만 가능하도록 제한(염병문차장 요청)	
	if ( gfn_getDiffDay(me_FromMenuDate.value, me_FromMenuDate2.value) <= 92 ) {
		// ok
	} else {
		gfn_alert("최대 조회 기간은 3개월 이하로 지정하여 주십시요.");
		return false;;		
	}
	
	
	//ds_Input.setColumn(0,"UPJANG",       ed_UpjangNm.value);
	ds_Input.setColumn(0,"HALL_CD",       cbo_HallCd.value);
	ds_Input.setColumn(0,"MENU_DATE",   me_FromMenuDate.value);
	ds_Input.setColumn(0,"MENU_DATE2",   me_FromMenuDate2.value);
	
	actionName		= "FSM00340V_S002";
	cmdName			= "U_svc::" + "fs/fsm/FSM00340V_S002.jsp";
	inData			= "ds_Input=ds_Input";
	outData			= "ds_List=ds_List";
	callBackFnc		= "fn_callbackSearchHeadList";

	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc,true,false,true);
	
	//me_FromMenuDate.setFocus();
	grd_Item1.setFocus();
}

function fn_callbackSearchHeadList(errCode, errMsg)
{	
	if( errCode != 0 ) {
		return;
	} else {
	}
}

/*------------------------------------------------------------
	1. Function    : fn_SetMenuCd()
	2. Description : ds_List의 SEL 컬럼을 체크한 경우 상세정보 검색시 필요한
	                 IN MENU_CD 값을 문자열로 생성
	3. Arguments   : 
	4. History     : 2008. 02. 29 - 최초작성
*------------------------------------------------------------*/
function fn_SetMenuCd()
{
	if( ds_List.getRowCount() > 0 ) {
		//var v_ChkCount = 0;
		var v_ChkMenuCd = "";
		for( var i=0; i<ds_List.getRowCount(); i++ ) {
			if( ds_List.getColumn(i, "SEL") == "1" ) {
				v_ChkCount += 1;
				if( v_ChkCount == 1 ) {
					v_ChkMenuCd = "'" + ds_List.getColumn(i, "MENU_CD") + "'";
				} else {
					v_ChkMenuCd += ", '" + ds_List.getColumn(i, "MENU_CD") + "'";
				}
			}
		}
		
		if( v_ChkCount != 0 ) {
			ds_Input.setColumn(0, "MENU_CD", v_ChkMenuCd);
			//ds_Input.SetColumn(0, "MENU_CD", "");
		}
		
	}
}

/*------------------------------------------------------------
	1. Function    : fn_SearchHall()
	2. Description : 업장에 딸린 식당 조회
	3. Arguments   : 
	4. History     : 2008. 02. 21 - 최초작성
*------------------------------------------------------------*/
function fn_SearchHall()
{
	var args = "UPJANG="+wrapQuote(ds_Input.getColumn(0,"UPJANG"));
	
	fsp_clear(this);
	ds_Hall.clearData();
	fsp_addSearch(this,"fs/fsm:FSM00300V_S002");
	fsp_callService(this,"","","","ds_Hall=ds_Hall",args,"fn_CallBackSearchHall","",true);
}
/*------------------------------------------------------------
	1. Function    : fn_CallBackSearchHall(errCode, errMsg)
	2. Description : fn_SearchHall() CallBack Function
	3. Arguments   : 
	4. History     : 2008. 02. 21 - 최초작성
*------------------------------------------------------------*/
function fn_CallBackSearchHall(errCode, errMsg)
{	
	if( errCode != 0 ) {
		return;
	} else {
		cbo_HallCd.index = 0;
		fn_SearchHeadList();
	}
}
/*------------------------------------------------------------
	1. Function    : fn_SearchMealCorner()
	2. Description : 업장/식당에 딸린 끼니/코너 조회
	3. Arguments   : 
	4. History     : 2008. 02. 21 - 최초작성
*------------------------------------------------------------*/
function fn_SearchMealCorner()
{
	var args  = "UPJANG="+ds_Input.getColumn(0, "UPJANG");
		args += " HALL_CD="+wrapQuote(ds_Input.getColumn(0, "HALL_CD"));
	
	// 끼니
	fsp_clear(this);
	ds_Meal.clearData();
	fsp_addSearch(this,"fs/fsm:FSM00300V_S003");
	fsp_callService(this,"","","","ds_Meal=ds_Meal",args,"fn_CallBackSearchComboData","",true);
	
	// 코너
	fsp_clear(this);
	ds_Corner.clearData();
	fsp_addSearch(this,"fs/fsm:FSM00300V_S004");
	fsp_callService(this,"","","","ds_Corner=ds_Corner",args,"fn_CallBackSearchComboData","",true);
}
/*------------------------------------------------------------
	1. Function    : fn_CallBackSearchComboData(errCode, errMsg)
	2. Description : Common CallBack Function
	3. Arguments   : 
	4. History     : 2008. 02. 21 - 최초작성
*------------------------------------------------------------*/
function fn_CallBackSearchComboData(errCode, errMsg)
{	
	if( errCode != 0 ) {
		return;
	} else {
//		cbo_Meal.Index   = 0;
//		cbo_Corner.Index = 0;
	}
}


//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
/*------------------------------------------------------------
	1. Function    : fn_CallBackSearchDetail(errCode, errMsg)
	2. Description : 상세내역 조회 CallBack Function
	3. Arguments   : 
	4. History     : 2008. 02. 21 - 최초작성
*------------------------------------------------------------*/
function fn_CallBackSearchDetail(errCode, errMsg)
{	
	if( errCode != 0 ) {
		return;
	} else {
	}
}

/*------------------------------------------------------------
	1. Function    : grd_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
	2. Description : 그리드 정렬 및 엑셀 출력
	3. Arguments   : 
	4. History     : 2008. 02. 21 - 최초작성
*------------------------------------------------------------*/
function grd_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if( nCell == 0 ) {	// Excel Export
		gfn_exportExcel(obj, "Sheet1");
	} else {
		gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, nCell);
	}
}
/*------------------------------------------------------------
	1. Function    : FSM00300V_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
	2. Description : 폼 엔터키 공통 이벤트
	3. Arguments   : 
	4. History     : 2008. 02. 28 - 최초작성
*------------------------------------------------------------*/
function FSM00340V_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
}

/*------------------------------------------------------------
	1. Function    : chk_Resource_OnClick(obj,strValue)
	2. Description : 자재별 체크박스 클릭시 그리드화면 변경 
	3. Arguments   : 
	4. History     : 2008. 02. 22 - 최초작성
*------------------------------------------------------------*/
function chk_Resource_OnClick(obj:CheckBox, e:ClickEventInfo)
{

	if(obj.isChecked() == true){
		grd_MainList.formatid  = "Default";
		ds_MainList.clear();
		ds_MainList.keystring = "MEAL,CORNER,RECIPE_NAME";
	}else{
		grd_MainList.formatid  = "Default0";
		ds_MainList.clear();
		ds_MainList.keystring = "MEAL,CORNER,RECIPE_NAME";
	}
	
	fn_search();
}
/*------------------------------------------------------------
	1. Function    : fn_FormClear()
	2. Description : 조회된 화면 초기화
	3. Arguments   : 
	4. History     : 2008. 02. 29 - 최초작성
*------------------------------------------------------------*/
function fn_FormClear()
{
//	trace("fn_FormClear 호출");
	ds_List.clearData();	
	ds_MainList.clearData();
}

function fn_CPF(strColumnId)
{
	// CARBO : 당질
	// PROT : 단백질
	// FAT : 지질
	if( ds_MainList.getRowCount() > 0 ) {
		var v_temp = 0;
		switch(strColumnId) {
			case "CARBO" :
				v_temp = ds_MainList.getAvg("CARBO") * 4;
				break;
			case "PROT" :
				v_temp = ds_MainList.getAvg("PROT") * 4;
				break;
			case "FAT" :
				v_temp = ds_MainList.getAvg("FAT") * 9;
				break;
			default :
				return "-";
		}
		if( v_temp == 0 )
			return "-";
		else
			return gfn_toString(numFormat((v_temp / ((ds_MainList.getAvg("CARBO") * 4) + (ds_MainList.getAvg("PROT") * 4) + (ds_MainList.getAvg("FAT") * 9))) * 100, 2))+ "%";
	} else {
		return "-";
	}

}

/*------------------------------------------------------------
	1. Function    : cbo_HallCd_OnChanged()
	2. Description : 식당변경시 조건 리스트 조회
	3. Arguments   : 
	4. History     : 2008. 02. 29 - 최초작성
*------------------------------------------------------------*/
function cbo_HallCd_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	if(e.preindex != e.postindex){
		fn_SearchHeadList();
		ds_MainList.clear(); 
	}
}
/*------------------------------------------------------------
	1. Function    : me_FromMenuDate_OnChanged()
	2. Description : 날짜변경시 조건 리스트 조회
	3. Arguments   : 
	4. History     : 2008. 03. 03 - 최초작성
*------------------------------------------------------------*/
// function me_FromMenuDate_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
// {
// 	//g_Date_OnKillFocus(obj);
// 	if(gfn_length(this,me_FromMenuDate.value)== 8){
// 		fn_SearchHeadList();
// 	}
// }
/*------------------------------------------------------------
	1. Function    : grd_Item1_OnCellClick()
	2. Description : 상단리스트의 임의의 한줄을 클릭시 " 선택 " 체크표시를 조정한다
	3. Arguments   : 
	4. History     : 2008. 03. 12 - 최초작성
*------------------------------------------------------------*/
function grd_Item1_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	var selState = ds_List.getColumn(e.row, "SEL");

	if( grd_Item1.getCellProperty("head",e.cell,"text") != "선택"){
		if(selState == 0){
			ds_List.setColumn(e.row, "SEL", 1);
		} else{
			ds_List.setColumn(e.row, "SEL", 0);
		}
	}
}

/*------------------------------------------------------------
	1. Function    : grd_Item1_OnCellClick()
	2. Description : 헤더 클릭시 전체선택/해제 기능 추가
	3. Arguments   : 
	4. History     : 2008. 04. 11 - 최초작성
*------------------------------------------------------------*/
function grd_Item1_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	var toggInd;
	
	// [선택] 헤더 클릭시 전체선택/해제 기능
	if (grd_Item1.getCellProperty("head",e.cell,"text") == "선택") {
		if (v_ChkInd == "0") {
			toggInd  = "1";
			v_ChkInd = "1";
		} else {
			toggInd  = "0";
			v_ChkInd = "0";
		}
		
		for(i = 0; i < ds_List.rowcount; i++) {
			ds_List.setColumn(i,"SEL",toggInd);
		}
	}
	
	// 제공메뉴 헤더클릭시 SORT기능 삭제
	else if (grd_Item1.getCellProperty("head",e.cell,"text") == "제공메뉴") {
		return;
	}
	
	// SORT 기능
	else { 
		gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
	}

}

/*------------------------------------------------------------
	1. Function    : chk_AbolitionRate_OnClick()
	2. Description : 폐기율 적용 선택시 조회처리
	3. Arguments   : 
	4. History     : 2008. 04. 11 - 최초작성
*------------------------------------------------------------*/
function chk_AbolitionRate_OnClick(obj:CheckBox, e:ClickEventInfo)
{
	fn_search();
}

/*------------------------------------------------------------
	1. Function    : chk_Recipe_OnClick()
	2. Description : 레시피 수정적용 선택시 조회처리
	3. Arguments   : 
	4. History     : 2008. 04. 11 - 최초작성
*------------------------------------------------------------*/
function chk_Recipe_OnClick(obj:CheckBox, e:ClickEventInfo)
{
	fn_search();
}

function grd_MainList_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
}
 

function me_FromMenuDate_OnChanged(obj:MaskEdit,  e:TextChangedEventInfo)
{
	if(gfn_isDate(me_FromMenuDate.value)) {
		fn_SearchHeadList();
	}
}

function me_FromMenuDate_onkillfocus(obj:MaskEdit, e:KillFocusEventInfo)
{ 


    var currday  = gfn_today();
	var currleng = gfn_length(gfn_trim(obj.value));
	var objValue = gfn_trim(obj.value);

	if (obj.mask == "####-##-##" ) 
	{
		switch(currleng)
		{
			case 1:
				obj.value = gfn_subStr(currday,0,6)+"0"+objValue;
				break;
			case 2:
				obj.value = gfn_subStr(currday,0,6)+objValue;
				break;
			case 3:
				obj.value = gfn_subStr(currday,0,4)+"0"+objValue;
				break;
			case 4:
				obj.value = gfn_subStr(currday,0,4)+objValue;
				break;
			case 5:
				obj.value = gfn_subStr(currday,0,3)+objValue;
				break;
			case 6:
				obj.value = gfn_subStr(currday,0,2)+objValue;
				break;
			case 7:
				obj.value = gfn_subStr(currday,0,1)+objValue;
				break;			
		}

		if ( gfn_length(gfn_trim(obj.value))== 0 ) return;
	
		if ( G_fn_IsDateYMD(obj.value) == -1 ) {
			obj.value = "";
			obj.setFocus();
		}	
	}
	else {
		switch(currleng)
		{
			case 1:
				obj.value = gfn_subStr(currday,0,4)+"0"+objValue;
				break;
			case 2:
				obj.value = gfn_subStr(currday,0,4)+objValue;
				break;
			case 3:
				obj.value = gfn_subStr(currday,0,3)+objValue;
				break;
			case 4:
				obj.value = gfn_subStr(currday,0,2)+objValue;
				break;
			case 5:
				obj.value = gfn_subStr(currday,0,1)+objValue;
				break;
		}
		
		if ( gfn_length(gfn_trim(obj.value))== 0 ) return;
		
		if ( gfn_subStr(obj.value,4,2)< "01" || gfn_subStr(obj.value,4,2)> "12" ) {
			obj.value = "";
			obj.setFocus();
		}		
	}
	
	fn_SearchHeadList(); 
}

/************************************************************************************
날짜필드(MaskEdit + Button) 내부사용을 위해 공통에서 함수를 빼옴 이 아래로

MaskEdit 는 setfocus가 먹다 안먹다 해서 속성의 autoselect 로 조절함
MaskEdit 는 Date_OnKillFocus() 함수를 사용해서 날짜를 조합함
Button 은 CalButton_OnClick() 함수를 사용해서 달력을 출력하고 값을 리턴
me_Date_canchange() 는 달출력 한후 실행하는 트리거 같은 함수
************************************************************************************/
function Date_OnKillFocus(obj)
{
	var currday  = gfn_today();
	var currleng = gfn_length(gfn_trim(obj.value));
	var objValue = gfn_trim(obj.value);

	if (obj.mask == "####-##-##" ) 
	{
		switch(currleng)
		{
			case 1:
				obj.value = gfn_subStr(currday,0,6)+"0"+objValue;
				break;
			case 2:
				obj.value = gfn_subStr(currday,0,6)+objValue;
				break;
			case 3:
				obj.value = gfn_subStr(currday,0,4)+"0"+objValue;
				break;
			case 4:
				obj.value = gfn_subStr(currday,0,4)+objValue;
				break;
			case 5:
				obj.value = gfn_subStr(currday,0,3)+objValue;
				break;
			case 6:
				obj.value = gfn_subStr(currday,0,2)+objValue;
				break;
			case 7:
				obj.value = gfn_subStr(currday,0,1)+objValue;
				break;			
		}

		if ( gfn_length(gfn_trim(obj.value))== 0 ) return;
	
		if ( G_fn_IsDateYMD(obj.value) == -1 ) {
			obj.value = "";
			obj.setFocus();
		}	
	}
	else {
		switch(currleng)
		{
			case 1:
				obj.value = gfn_subStr(currday,0,4)+"0"+objValue;
				break;
			case 2:
				obj.value = gfn_subStr(currday,0,4)+objValue;
				break;
			case 3:
				obj.value = gfn_subStr(currday,0,3)+objValue;
				break;
			case 4:
				obj.value = gfn_subStr(currday,0,2)+objValue;
				break;
			case 5:
				obj.value = gfn_subStr(currday,0,1)+objValue;
				break;
		}
		
		if ( gfn_length(gfn_trim(obj.value))== 0 ) return;
		
		if ( gfn_subStr(obj.value,4,2)< "01" || gfn_subStr(obj.value,4,2)> "12" ) {
			obj.value = "";
			obj.setFocus();
		}		
	}
	
	//헤더 조회
	fn_SearchHeadList();
}

function CalButton_OnClick(obj:Button,  e:ClickEventInfo)
{
	var sOldDate = eval(obj.userdata).value;
	
	// 달력
	if ( eval(obj.userdata).mask == "####-##-##" )
	{
		// 과거 달력 팝업
		//eval(obj.userdata).value = gfn_dialog("", "U_SCC::SCC_CALENDAR.xfdl","fa_Date="+eval(obj.userdata).value,-1,-1,"",-1,-1,false,false);
			
		// 신규 달력 div
		var nX = system.clientToScreenX(obj, 0) + obj.position.width  - 167;
		var nY = system.clientToScreenY(obj, 0) + obj.position.height - 1;
		var strDate = gfn_callCalendarPop(obj, eval(obj.userdata).value, nX, nY);
		if(gfn_isNull(strDate)) return;
		eval(obj.userdata).value = strDate;
	}
	// 월력
	else {
		// 과거 월력 팝업
		//eval(obj.userdata).value = gfn_dialog("", "U_SCC::SCC_CALMONTH.xfdl","fa_Date="+eval(obj.userdata).value,-1,-1,"",-1,-1,false,false);	
			
		// 신규 월력 div
		var nX = system.clientToScreenX(obj, 0) - 168 + obj.position.width;
		var nY = system.clientToScreenY(obj, 0) + obj.position.height;
		var strDate = gfn_callMonthPop(obj, eval(obj.userdata).value, nX, nY);
		if(gfn_isNull(strDate)) return;
		eval(obj.userdata).value = strDate;
	}
	//기존 값과 달라진 경우 Change이벤트 발생시킴
	//if (sOldDate <> object(obj.UserData).Value)	eval(obj.UserData + "_OnChanged(" + obj.UserData + ", " + object(obj.UserData).Value + ")");
	
	
	//trace("sOldDate :" + sOldDate);
	//trace("sNewDate :" + eval(obj.userdata).value);
	
	if (sOldDate <> eval(obj.userdata).value) 
	{
		//trace("obj.userdata : " + obj.userdata);
		me_Date_trigger();
		//온체인지를 캔체인지로 바꿈 엑스플렛폼이기때문에
	}
}

function me_Date_trigger()
{
	//헤더 조회
	fn_SearchHeadList();
}]]></Script>
  </Form>
</FDL>

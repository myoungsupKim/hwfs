<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="FSM90030E" classname="SAMPLE01" inheritanceid="" position="absolute 0 0 1252 725" titletext="식단등록(카페테리아)" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static49" class="sta_WFDA_Labelbg" position="absolute 120 77 278 104" anchor="default"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="5" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 1237 40" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 1237 71" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static03" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 258 40 268 61" anchor="left top"/>
        <Static id="Static37" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 0 71 1237 77" anchor="top right"/>
        <Static id="Static10" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 514 40 544 61" anchor="left top"/>
        <Static id="Static14" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 589 40 599 61" anchor="left top"/>
        <Static id="Static15" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 771 40 801 61" anchor="left top"/>
        <Static id="Static23" text="제공일" class="sta_WFSA_label" position="absolute 801 41 861 62" anchor="left top"/>
        <Static id="Static24" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 846 40 856 61" anchor="left top"/>
        <ObjCalendar id="cal_menuDate" anchor="left top" titletext="캘린더" taborder="3" scrollbars="none" position="absolute 856 40 959 61" onkeydown="cal_menuDate_onkeydown"/>
        <Static id="Static01" text="사업장" class="sta_WFSA_label" position="absolute 213 41 273 62" anchor="left top"/>
        <UpjangSearchComponent id="edt_upjang" titletext="업장 검색용 Component" taborder="1" text="UpjangSearchComponent00" position="absolute 268 40 514 61" bindDataset="ds_cond" bindUpjangCodeColumn="UPJANG" bindUpjangNameColumn="UPJANGNM" eventBeforeTrigger="" eventAfterTrigger="fn_hallSearch" roleSetId=""/>
        <Static id="Static00" text="식당명" class="sta_WFSA_label" position="absolute 544 41 604 62" anchor="left top"/>
        <Combo id="cbo_hall" taborder="2" position="absolute 599 40 771 61" index="-1" innerdataset="@ds_cboHall" codecolumn="HALL_CD" datacolumn="HALL_NAME" onitemchanged="cbo_hall_onitemchanged"/>
        <Static id="Static41" text="원가는 입고예정일 기준 사업장 원가입니다." class="sta_WF_DiscInfo" position="absolute 957 656 1237 671" anchor="right bottom"/>
        <Static id="Static09" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 670 1237 683"/>
        <Static id="Static13" text="팀" class="sta_WFSA_label" position="absolute 15 41 75 62" anchor="left top"/>
        <TmSearchComponent id="edt_tm" titletext="팀 검색용 Component" taborder="0" text="TmSearchComponent00" position="absolute 44 40 183 61" bindDataset="" bindTmCdColumn="" bindTmNmColumn="" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tmChange" eventBeforeTrigger=""/>
        <Static id="Static16" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 183 40 213 61" anchor="left top"/>
        <Static id="Static17" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 34 40 44 61" anchor="left top"/>
        <MuSearchComponent id="cbo_mu" titletext="사업부 선택 Component" taborder="22" text="MuSearchComponent00" position="absolute 999 40 1144 61" bindDataset="" bindMuCdColumn="" appendText="" onItemChangedEvent="" visible="false"/>
        <Button id="btn_next" taborder="23" class="btn_WF_rightMove" position="absolute 1202 40 1222 60" onclick="btn_next_onclick" anchor="top right"/>
        <Button id="btn_prev" taborder="24" class="btn_WF_leftMove" position="absolute 1179 40 1199 60" onclick="btn_prev_onclick" anchor="top right"/>
        <Grid id="grd_menuList" taborder="4" binddataset="ds_menuList" useinputpanel="false" selecttype="area" autofittype="col" onrbuttondown="tab_menu_tabpage2_grd_menuList_onrbuttondown" onmousemove="tab_menu_tabpage2_grd_menuList_onmousemove" oncellclick="tab_menu_tabpage2_grd_menuList_oncellclick" onheadclick="tab_menu_tabpage2_grd_menuList_onheadclick" oncelldblclick="tab_menu_tabpage2_grd_menuList_oncelldblclick" position="absolute 0 109 1237 648" anchor="all" style="border:1 solid #53606cff,1 solid #c3c3c3ff,1 solid #c3c3c3ff,1 solid #c3c3c3ff;">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="100"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
                <Column size="120"/>
                <Column size="35"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" text="일자" taborder="undefined"/>
                <Cell col="1" text="월" taborder="undefined"/>
                <Cell col="2" rowspan="2" taborder="undefined"/>
                <Cell col="3" text="화" taborder="undefined"/>
                <Cell col="4" rowspan="2" taborder="undefined"/>
                <Cell col="5" text="수" taborder="undefined"/>
                <Cell col="6" rowspan="2" taborder="undefined"/>
                <Cell col="7" text="목" taborder="undefined"/>
                <Cell col="8" rowspan="2" taborder="undefined"/>
                <Cell col="9" text="금" taborder="undefined"/>
                <Cell col="10" rowspan="2" taborder="undefined"/>
                <Cell col="11" style="color:#99ccffff;" text="토" taborder="undefined"/>
                <Cell col="12" rowspan="2" taborder="undefined"/>
                <Cell col="13" style="color:#ff7878;" text="일" taborder="undefined"/>
                <Cell col="14" rowspan="2" taborder="undefined"/>
                <Cell row="1" col="1" taborder="undefined"/>
                <Cell row="1" col="3" taborder="undefined"/>
                <Cell row="1" col="5" taborder="undefined"/>
                <Cell row="1" col="7" taborder="undefined"/>
                <Cell row="1" col="9" taborder="undefined"/>
                <Cell row="1" col="11" taborder="undefined"/>
                <Cell row="1" col="13" taborder="undefined"/>
              </Band>
              <Band id="body">
                <Cell style="line:1 none transparent transparent;background:whitesmoke;background2:whitesmoke;" text="expr:!gfn_isNull(KEY) ? SGBN_NM + '(' + CGBN + ')' : ''" suppress="1" suppressalign="middle"/>
                <Cell col="1" displaytype="text" style="padding:0 0 0 5;line:1 none transparent transparent;background:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;white&quot;);background2:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;white&quot;);color:EXPR(!gfn_isNull(C2) ? &quot;C2&quot; : &quot;black&quot;);" text="bind:M2"/>
                <Cell col="2" displaytype="number" style="padding:0 3 0 0;line:1 none transparent transparent;background:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;whitesmoke&quot;);background2:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;whitesmoke&quot;);" text="bind:R2"/>
                <Cell col="3" displaytype="text" style="padding:0 0 0 5;line:1 none transparent transparent;background:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;white&quot;);background2:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;white&quot;);" text="bind:M3"/>
                <Cell col="4" displaytype="number" style="padding:0 3 0 0;line:1 none transparent transparent;background:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;whitesmoke&quot;);background2:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;whitesmoke&quot;);" text="bind:R3"/>
                <Cell col="5" displaytype="text" style="padding:0 0 0 5;line:1 none transparent transparent;background:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;white&quot;);background2:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;white&quot;);" text="bind:M4"/>
                <Cell col="6" displaytype="number" style="padding:0 3 0 0;line:1 none transparent transparent;background:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;whitesmoke&quot;);background2:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;whitesmoke&quot;);" text="bind:R4"/>
                <Cell col="7" displaytype="text" style="padding:0 0 0 5;line:1 none transparent transparent;background:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;white&quot;);background2:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;white&quot;);" text="bind:M5"/>
                <Cell col="8" displaytype="number" style="padding:0 3 0 0;line:1 none transparent transparent;background:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;whitesmoke&quot;);background2:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;whitesmoke&quot;);" text="bind:R5"/>
                <Cell col="9" displaytype="text" style="padding:0 0 0 5;line:1 none transparent transparent;background:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;white&quot;);background2:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;white&quot;);" text="bind:M6"/>
                <Cell col="10" displaytype="number" style="padding:0 3 0 0;line:1 none transparent transparent;background:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;whitesmoke&quot;);background2:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;whitesmoke&quot;);" text="bind:R6"/>
                <Cell col="11" displaytype="text" style="padding:0 0 0 5;line:1 none transparent transparent;background:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;white&quot;);background2:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;white&quot;);" text="bind:M7"/>
                <Cell col="12" displaytype="number" style="padding:0 3 0 0;line:1 none transparent transparent;background:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;whitesmoke&quot;);background2:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;whitesmoke&quot;);" text="bind:R7"/>
                <Cell col="13" displaytype="text" style="padding:0 0 0 5;line:1 none transparent transparent;background:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;white&quot;);background2:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;white&quot;);" text="bind:M1"/>
                <Cell col="14" displaytype="normal" style="padding:0 3 0 0;line:1 none transparent transparent;background:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;whitesmoke&quot;);background2:EXPR(!gfn_isNull(C1) ? C1 : gfn_isNull(KEY) ? &quot;lavender&quot; : &quot;whitesmoke&quot;);" text="bind:R1"/>
              </Band>
              <Band id="summary">
                <Cell style="align:center;" text="평균원가"/>
                <Cell col="1" colspan="2" taborder="undefined"/>
                <Cell col="3" colspan="2" taborder="undefined"/>
                <Cell col="5" colspan="2" taborder="undefined"/>
                <Cell col="7" colspan="2" taborder="undefined"/>
                <Cell col="9" colspan="2" taborder="undefined"/>
                <Cell col="11" colspan="2" taborder="undefined"/>
                <Cell col="13" colspan="2" taborder="undefined"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static18" text="주간 목표식재료율" class="sta_WFDA_Label01" position="absolute 0 77 121 104" anchor="left top" style="background:lavender;font:Gulim,9;"/>
        <Static id="Static19" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 104 1237 109"/>
        <Button id="btn_copyMenu" taborder="26" text="식단복사" onclick="tab_menu_tabpage2_btn_copyMenu_onclick" class="btn_WF_Function" position="absolute 1003 84 1068 104" anchor="top right"/>
        <Button id="btn_myRecipe" taborder="27" text="MY 레시피구성" onclick="tab_menu_tabpage2_btn_myRecipe_onclick" class="btn_WF_Function" position="absolute 1070 84 1170 104" anchor="top right"/>
        <Button id="btn_excel" taborder="29" text="Excel" onclick="tab_menu_tabpage2_btn_excel_onclick" class="btn_WF_Function" position="absolute 1172 84 1237 104" anchor="top right"/>
        <Static id="Static20" text="주간 예상식재료율" class="sta_WFDA_Label01" position="absolute 277 77 398 104" anchor="left top" style="background:lavender;font:Gulim,9;"/>
        <Static id="Static61" text="h08" class="Guide01_AreaRed" visible="false" position="absolute 0 648 1237 656" anchor="left top"/>
        <Static id="Static44" text="오른쪽 버튼 : MY레시피등록" class="sta_WF_DiscInfo" position="absolute 0 656 206 671" anchor="left bottom"/>
        <Static id="Static21" text="왼쪽 버튼 : 레시피검색 및 등록/수정" class="sta_WF_DiscInfo" position="absolute 208 656 453 671" anchor="left bottom"/>
        <Button id="btn_po" taborder="31" text="구매신청" onclick="tab_menu_tabpage2_btn_po_onclick" class="btn_WF_Function" position="absolute 936 84 1001 104" anchor="top right"/>
        <Edit id="edt_exptCostRate" taborder="33" readonly="true" position="absolute 397 77 507 104" style="color:blue;padding:1 10 0 5;align:right middle;font:Gulim,9,bold;"/>
        <Edit id="edt_resultRate" taborder="34" readonly="true" position="absolute 605 77 715 104" style="padding:1 10 0 5;align:right middle;font:Gulim,9,bold;"/>
        <Static id="Static22" text="달성율" class="sta_WFDA_Label01" position="absolute 506 77 606 104" anchor="left top" style="background:lavender;font:Gulim,9;"/>
        <Button id="btn_po00" taborder="36" text="저장" onclick="fn_saveGoalCostRate" class="btn_WF_Function" position="absolute 233 80 274 100" anchor="default"/>
        <Static id="Static25" text="%" position="absolute 210 81 226 101"/>
        <MaskEdit id="edt_goalCostRate" taborder="37" position="absolute 123 80 207 101" style="color:blue;font:Gulim,9,bold;"/>
        <Static id="Static26" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1222 40 1237 61" anchor="left top"/>
        <Static id="Static12" text="계획 식재료율 (%)" class="sta_WFDA_Label01" position="absolute 0 683 136 710" anchor="left bottom" style="background:lavender;font:Gulim,9;"/>
        <Static id="Static02" text="실적 식재료율 (%)" class="sta_WFDA_Label01" position="absolute 250 683 386 710" anchor="left bottom" style="background:lavender;font:Gulim,9;"/>
        <Static id="Static11" text="달성율 (%P)" class="sta_WFDA_Label01" position="absolute 500 683 644 710" anchor="left bottom" style="background:lavender;font:Gulim,9;"/>
        <Edit id="edt_rate03" taborder="38" readonly="true" enable="false" position="absolute 643 683 759 710" anchor="left bottom" style=":disabled {align:center middle;font:Gulim,9,bold;}"/>
        <Edit id="edt_rate02" taborder="39" readonly="true" enable="false" position="absolute 385 683 501 710" anchor="left bottom" style=":disabled {align:center middle;font:Gulim,9,bold;}"/>
        <Edit id="edt_rate01" taborder="40" readonly="true" enable="false" position="absolute 135 683 251 710" anchor="left bottom" style=":disabled {align:center middle;font:Gulim,9,bold;}"/>
        <Static id="sta_info" position="absolute 462 656 927 681" anchor="left bottom"/>
        <Static id="Static27" class="sta_WFDA_Labelbg" position="absolute 1061 683 1237 710" anchor="right bottom"/>
        <Button id="btn_costReflash" taborder="41" text="원가갱신" class="btn_WF_Function" position="absolute 1169 686 1234 706" anchor="right bottom" onclick="btn_costReflash_onclick"/>
        <ObjCalendar id="cal_costReflash" anchor="right bottom" titletext="캘린더" taborder="42" scrollbars="none" position="absolute 1064 686 1167 707"/>
        <Static id="Static28" text="원가 갱신일" class="sta_WFDA_Label01" position="absolute 976 683 1062 710" anchor="right bottom" style="background:lavender;font:Gulim,9;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cboHall" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="HALL_CD" type="STRING" size="256"/>
          <Column id="HALL_NAME" type="STRING" size="256"/>
          <Column id="SUBINV_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onvaluechanged="ds_cond_onvaluechanged">
        <ColumnInfo>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="UPJANGNM" type="STRING" size="256"/>
          <Column id="HALL_CD" type="STRING" size="256"/>
          <Column id="HALL_NM" type="STRING" size="256"/>
          <Column id="MENU_DATE" type="STRING" size="256"/>
          <Column id="MENU_SDATE" type="STRING" size="256"/>
          <Column id="MENU_EDATE" type="STRING" size="256"/>
          <Column id="EMP_NO" type="STRING" size="256"/>
          <Column id="SUBINV_CODE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_headList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_bodyList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_menuList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="KEY" type="STRING" size="256"/>
          <Column id="MENU_CD" type="STRING" size="256"/>
          <Column id="SGBN" type="STRING" size="256"/>
          <Column id="SGBN_NM" type="STRING" size="256"/>
          <Column id="CGBN_CD" type="STRING" size="256"/>
          <Column id="CGBN" type="STRING" size="256"/>
          <Column id="SSEQ" type="STRING" size="256"/>
          <Column id="SALE_PRICE" type="BIGDECIMAL" size="256"/>
          <Column id="M2" type="STRING" size="256"/>
          <Column id="M3" type="STRING" size="256"/>
          <Column id="M4" type="STRING" size="256"/>
          <Column id="M5" type="STRING" size="256"/>
          <Column id="M6" type="STRING" size="256"/>
          <Column id="M7" type="STRING" size="256"/>
          <Column id="M1" type="STRING" size="256"/>
          <Column id="P2" type="BIGDECIMAL" size="256"/>
          <Column id="P3" type="BIGDECIMAL" size="256"/>
          <Column id="P4" type="BIGDECIMAL" size="256"/>
          <Column id="P5" type="BIGDECIMAL" size="256"/>
          <Column id="P6" type="BIGDECIMAL" size="256"/>
          <Column id="P7" type="BIGDECIMAL" size="256"/>
          <Column id="P1" type="BIGDECIMAL" size="256"/>
          <Column id="T2" type="STRING" size="256"/>
          <Column id="T3" type="STRING" size="256"/>
          <Column id="T4" type="STRING" size="256"/>
          <Column id="T5" type="STRING" size="256"/>
          <Column id="T6" type="STRING" size="256"/>
          <Column id="T7" type="STRING" size="256"/>
          <Column id="T1" type="STRING" size="256"/>
          <Column id="D2" type="STRING" size="256"/>
          <Column id="D3" type="STRING" size="256"/>
          <Column id="D4" type="STRING" size="256"/>
          <Column id="D5" type="STRING" size="256"/>
          <Column id="D6" type="STRING" size="256"/>
          <Column id="D7" type="STRING" size="256"/>
          <Column id="D1" type="STRING" size="256"/>
          <Column id="C2" type="STRING" size="256"/>
          <Column id="C3" type="STRING" size="256"/>
          <Column id="C4" type="STRING" size="256"/>
          <Column id="C5" type="STRING" size="256"/>
          <Column id="C6" type="STRING" size="256"/>
          <Column id="C7" type="STRING" size="256"/>
          <Column id="C1" type="STRING" size="256"/>
          <Column id="R2" type="STRING" size="256"/>
          <Column id="R3" type="STRING" size="256"/>
          <Column id="R4" type="STRING" size="256"/>
          <Column id="R5" type="STRING" size="256"/>
          <Column id="R6" type="STRING" size="256"/>
          <Column id="R7" type="STRING" size="256"/>
          <Column id="R1" type="STRING" size="256"/>
          <Column id="E2" type="BIGDECIMAL" size="256"/>
          <Column id="E3" type="BIGDECIMAL" size="256"/>
          <Column id="E4" type="BIGDECIMAL" size="256"/>
          <Column id="E5" type="BIGDECIMAL" size="256"/>
          <Column id="E6" type="BIGDECIMAL" size="256"/>
          <Column id="E7" type="BIGDECIMAL" size="256"/>
          <Column id="E1" type="BIGDECIMAL" size="256"/>
          <Column id="F2" type="BIGDECIMAL" size="256"/>
          <Column id="F3" type="BIGDECIMAL" size="256"/>
          <Column id="F4" type="BIGDECIMAL" size="256"/>
          <Column id="F5" type="BIGDECIMAL" size="256"/>
          <Column id="F6" type="BIGDECIMAL" size="256"/>
          <Column id="F7" type="BIGDECIMAL" size="256"/>
          <Column id="F1" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_mealQtyBodyList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_realMealQtyList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="DAYS" type="STRING" size="256"/>
          <Column id="WDESC" type="STRING" size="256"/>
          <Column id="REAL_MEAL_QTY" type="STRING" size="256"/>
          <Column id="SIKDAN" type="STRING" size="256"/>
          <Column id="MENU_FEATURE" type="STRING" size="256"/>
          <Column id="SCHEDULE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_mealQtyList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="KEY" type="STRING" size="256"/>
          <Column id="TERM_MENU_CD" type="STRING" size="256"/>
          <Column id="SGBN" type="STRING" size="256"/>
          <Column id="SGBN_NM" type="STRING" size="256"/>
          <Column id="CGBN_CD" type="STRING" size="256"/>
          <Column id="CGBN" type="STRING" size="256"/>
          <Column id="SSEQ" type="STRING" size="256"/>
          <Column id="Q2" type="BIGDECIMAL" size="256"/>
          <Column id="Q3" type="BIGDECIMAL" size="256"/>
          <Column id="Q4" type="BIGDECIMAL" size="256"/>
          <Column id="Q5" type="BIGDECIMAL" size="256"/>
          <Column id="Q6" type="BIGDECIMAL" size="256"/>
          <Column id="Q7" type="BIGDECIMAL" size="256"/>
          <Column id="Q1" type="BIGDECIMAL" size="256"/>
          <Column id="D2" type="STRING" size="256"/>
          <Column id="D3" type="STRING" size="256"/>
          <Column id="D4" type="STRING" size="256"/>
          <Column id="D5" type="STRING" size="256"/>
          <Column id="D6" type="STRING" size="256"/>
          <Column id="D7" type="STRING" size="256"/>
          <Column id="D1" type="STRING" size="256"/>
          <Column id="L2" type="STRING" size="256"/>
          <Column id="L3" type="STRING" size="256"/>
          <Column id="L4" type="STRING" size="256"/>
          <Column id="L5" type="STRING" size="256"/>
          <Column id="L6" type="STRING" size="256"/>
          <Column id="L7" type="STRING" size="256"/>
          <Column id="L1" type="STRING" size="256"/>
          <Column id="O2" type="STRING" size="256"/>
          <Column id="O3" type="STRING" size="256"/>
          <Column id="O4" type="STRING" size="256"/>
          <Column id="O5" type="STRING" size="256"/>
          <Column id="O6" type="STRING" size="256"/>
          <Column id="O7" type="STRING" size="256"/>
          <Column id="O1" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_goalCostRate">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="HALL_CD" size="256" type="STRING"/>
          <Column id="MENU_DATE" size="256" type="STRING"/>
          <Column id="GOAL_COST_RATE" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_costRate">
        <ColumnInfo>
          <Column id="RMK" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sgbn">
        <ColumnInfo>
          <Column id="SGBN" size="256" type="STRING"/>
          <Column id="SGBN_NM" size="256" type="STRING"/>
          <Column id="CGBN" size="256" type="STRING"/>
          <Column id="CGBN_NM" size="256" type="STRING"/>
          <Column id="CGBN_CD" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_return">
        <ColumnInfo>
          <Column id="RTN" size="256" type="STRING"/>
          <Column id="RTNMSG" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="RTN"/>
            <Col id="RTNMSG"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_input">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="SDATE" size="256" type="STRING"/>
          <Column id="O_RTN" size="256" type="STRING"/>
          <Column id="O_RTNMSG" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sikck"/>
      <Dataset id="ds_subSum" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="WEEK" type="STRING" size="256"/>
          <Column id="SGBN" type="STRING" size="256"/>
          <Column id="CGBN_CD" type="STRING" size="256"/>
          <Column id="SD_WON" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_menuGuid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="GUID_YEAR" type="STRING" size="256"/>
          <Column id="GUID_SEQ" type="STRING" size="256"/>
          <Column id="REQ_NUM" type="STRING" size="256"/>
          <Column id="SDATE" type="STRING" size="256"/>
          <Column id="EDATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="DS_body1">
        <ColumnInfo>
          <Column id="fday" size="256" type="STRING"/>
          <Column id="sgbn" size="256" type="STRING"/>
          <Column id="sgbn_nm" size="256" type="STRING"/>
          <Column id="cgbn" size="256" type="STRING"/>
          <Column id="cgbn_nm" size="256" type="STRING"/>
          <Column id="cgbn_cd" size="256" type="STRING"/>
          <Column id="dup_sta" size="256" type="STRING"/>
          <Column id="dup_color" size="256" type="STRING"/>
          <Column id="sseq" size="256" type="STRING"/>
          <Column id="sd_cd" size="256" type="STRING"/>
          <Column id="sd_nm" size="256" type="STRING"/>
          <Column id="sd_won" size="256" type="STRING"/>
          <Column id="meal_price" size="256" type="STRING"/>
          <Column id="RECIPE_COST_RATE" size="256" type="STRING"/>
          <Column id="GOAL_COST_RATE2" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_rateMonth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="PLAN_RATE" type="STRING" size="256"/>
          <Column id="RESULT_RATE" type="STRING" size="256"/>
          <Column id="DIFF_RATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_enfUpjangList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="START_DD" type="STRING" size="256"/>
          <Column id="END_DD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="cbo_hall" propid="value" datasetid="ds_cond" columnid="HALL_CD"/>
      <BindItem id="item1" compid="edt_rate03" propid="value" datasetid="ds_rateMonth" columnid="DIFF_RATE"/>
      <BindItem id="item3" compid="edt_rate02" propid="value" datasetid="ds_rateMonth" columnid="RESULT_RATE"/>
      <BindItem id="item2" compid="edt_rate01" propid="value" datasetid="ds_rateMonth" columnid="PLAN_RATE"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";

/******************************************************************************************
 * 시스템구분 : 메뉴관리/식단관리
 * 프로그램명 : FSM90070E.XML
 * 기ㅡㅡㅡ능 : 식단등록(카페테리아)
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************/

//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var menuCnt    = 0;	          // 식단등록 수
var salePriceSum = 0;         // 식단판매가
var isEvalShow = false;       // 식단평가 팝업 여부
var fa_PFormID = "FSM90030E"  // 식단평가 팝업에서 분기 조건으로 사용

//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(this);

	// X-Framework : Action 정보 생성
	fsp_init(this);
	
	// 초기화
	fn_init();
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_init()
 * 기ㅡㅡㅡ능 : 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_init()
{
	// 조회조건 초기화
	ds_cond.clearData();
	ds_cond.addRow();
	ds_cond.setColumn(0, "EMP_NO", g_EmpNo);

	// 권한처리
	edt_tm.applyAuthLevel(cbo_mu);
	edt_upjang.applyAuthLevel(edt_tm);

	// 공통코드 조회
	var v_fil_cond;
	var v_ds = fn_common_code("'FS0029','FS0030','FS0031','FS0023'","","","non","Y");
	
	// 제공일 초기화
	cal_menuDate.fn_initMonthCal(this, gfn_today(), "", ds_cond, "MENU_DATE", "Y");
	
	cal_costReflash.fn_initMonthCal(this, gfn_addDate(gfn_today(), 1), "", "", "", "");
	
	// 업장코드가 존재할 경우 식당조회
	if(!gfn_isNull(ds_cond.getColumn(0, "UPJANG")))
	{
		fn_hallSearch();
	}

	// 그룹레시피 대상사업장 체크
	fn_checkEnfUpjang();
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_checkEnfUpjang()
 * 기ㅡㅡㅡ능 : 그룹레시피 대상업장 여부 조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_checkEnfUpjang()
{
	ds_enfUpjangList.clearData();
	
	fsp_clear(this);
	fsp_addSearch(this, "fs/fsr:FSR90120E_S002");	// 그룹레시피 대상사업장 여부조회
	fsp_callService(this, "", "", "ds_cond=ds_cond", "ds_enfUpjangList=ds_list", "", "fn_callbackCheckEnfUpjang");
}

function fn_callbackCheckEnfUpjang()
{
	if(ds_enfUpjangList.getRowCount() > 0)
	{
		sta_info.class = "sta_WF_DiscInfo";
		sta_info.text = "그룹레시피 기간 : " + gfn_getFormat(ds_enfUpjangList.getColumn(0, "START_DATE"), '@@@@년 @@월 @@일') + " ~ " + gfn_getFormat(ds_enfUpjangList.getColumn(0, "END_DATE"), '@@@@년 @@월 @@일');
		btn_copyMenu.enable = false;      // 식단복사
		btn_myRecipe.enable = false;      // MY레시피 구성
	}
	else
	{
		sta_info.class = "";
		sta_info.text = "";
		btn_copyMenu.enable = true;      // 식단복사
		btn_myRecipe.enable = true;      // MY레시피 구성
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_initData()
 * 기ㅡㅡㅡ능 : 화면 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_initData() {

	// 그리드 데이터 초기화
	ds_mealQtyList.clearData();		// 식수예측
	ds_realMealQtyList.clearData();	// 4주간 실식수
	ds_menuList.clearData();		// 식단
	
	// Text 초기화
	edt_goalCostRate.value = "";
	edt_exptCostRate.value = "";
}

//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,출력)
//
//=========================================================================================
/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_search()
 * 기ㅡㅡㅡ능 : 조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_search()
{
	// 업장 체크
	if(gfn_isNull(ds_cond.getColumn(0, "UPJANG")))
	{
		g_Message("EE",	"업장을 입력해주세요.");
		return;
	}

	// 식당 체크
	if(gfn_isNull(ds_cond.getColumn(0, "HALL_CD")))
	{
		g_Message("EE",	"식당을 선택해주세요.");
		return;
	}

	// 식단제공일 필수 체크
	if(gfn_isNull(ds_cond.getColumn(0, "MENU_DATE")))
	{
		g_Message("EE",	"식단 제공일을 입력해주세요.");
		return;
	}

	// 정보 조회
	fn_dataSearch();
}

function fn_callback(errCode, errMsg) 
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오!");
		return;
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_saveGoalCostRate()
 * 기ㅡㅡㅡ능 : 저장
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_saveGoalCostRate()
{
	if(ds_menuList.getRowCount() == 0) return;

	if((edt_goalCostRate.value == "0.0") || (gfn_length(gfn_trim(edt_goalCostRate.value))== 0)) {
		g_Message("EE",	"주간식단목표 식재료율을 입력하시기 바랍니다.");
		edt_goalCostRate.setFocus();
		return;
	}
	
	for(var i = 0; i < ds_goalCostRate.rowcount; i++) {
		ds_goalCostRate.setColumn(i, "GOAL_COST_RATE", edt_goalCostRate.value);
	}

	for(var i=0; i < ds_mealQtyBodyList.rowcount; i++) {
		ds_mealQtyBodyList.setColumn(i, "GOAL_COST_RATE", edt_goalCostRate.value);
	}

	// 식재료율을 저장한다.
    var actionName, cmdName, inData, outData, otherArg, callBackFnc;
    var selectSqlId, notFoundSql, foundSql, saveFlagColumn, keySqlName, keyIncrement, callbackSql;
    var	insertSql, updateSql, deleteSql;

	inData		= "ds_sikrate=ds_goalCostRate:A";
	outData		= "";
	callBackFnc	= "fn_afterSearchSave1";
	selectSqlId = "fs/fsm:FSM00051E_S005";		// 데이타있는지 체크 sql
	notFoundSql	= "fs/fsm:FSM00051E_I002";		// insert sql
	foundSql	= "fs/fsm:FSM00051E_U002";		// update sql	
	callbackSql	= "";							// callback sql(재조회) 
	
	fsp_clear(this);
	fsp_addSelectExecute(this, selectSqlId,  notFoundSql,  foundSql);					// 저장
	fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
}

function fn_afterSearchSave1(errCode, errMsg)
{
	if(errCode!=0)
	{
		return;
	} else {
		var actionName, cmdName, inData, outData, otherArg, callBackFnc;
		var selectSqlId, notFoundSql, foundSql, saveFlagColumn, keySqlName, keyIncrement, callbackSql;
		var	insertSql, updateSql, deleteSql;

		inData		= "DS_body1=ds_mealQtyBodyList:A";
		outData		= "";
		callBackFnc	= "fn_callbackSave";
		selectSqlId = "fs/fsm:FSM00051E_S004";		// 데이타있는지 체크 sql
		notFoundSql	= "fs/fsm:FSM00051E_I001";		// insert sql
		foundSql	= "fs/fsm:FSM00051E_U001";		// update sql	
		callbackSql	= "";							// callback sql(재조회)
		
		insertSql	= "";							// insertSql
		updateSql	= "";							// updateSql
		deleteSql	= "";							// deleteSql
		
		fsp_clear(this);
		fsp_addSelectExecute(this, selectSqlId, notFoundSql,  foundSql);					// 저장
		fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc); // 서비스 호출 
	}
}

function fn_callbackSave(errCode, errMsg) 
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오!");
		return;
	}
	
	fn_search();
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_dataSearch()
 * 기ㅡㅡㅡ능 : 정보 조회 (일자, 날씨정보, 식수예측, 4주간 실식수)
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_dataSearch()
{
	// 데이터 초기화
	fn_initData();

	// 주(Week)의 시작일, 종료일 세팅
	fn_setPeriodOfWeek(ds_cond.getColumn(0, "MENU_DATE"));

	ds_headList.clearData();
	ds_mealQtyBodyList.clearData();
	fsp_clear(this); 
    fsp_addSearch(this, "fs/fsm:FSM00020E_S002");  // 헤더 정보
    fsp_addSearch(this, "fs/fsm:FSM00052E_S001");  // 끼니-코너 정보
    fsp_addSearch(this, "fs/fsm:FSM00051E_S003");  // 식수예측 조회
    fsp_addSearch(this, "fs/fsm:FSM00051E_S002");  // 식당목표식재료율(주간)
	fsp_callService(this, "", "", "ds_input=ds_cond", "ds_headList=DS_head ds_sgbn=DS_sgbn ds_mealQtyBodyList=DS_body1 ds_goalCostRate=ds_sikrate", "", "fn_callbackDataSearch");
	
	// 식단정보 조회
	var ActionVal	= "";
	ActionVal += "UPJANG="		+ wrapQuote(ds_cond.getColumn(0, "UPJANG"));
	ActionVal += " HALL_CD="	+ wrapQuote(ds_cond.getColumn(0, "HALL_CD"));
	ActionVal += " MENU_SDATE="	+ wrapQuote(ds_cond.getColumn(0, "MENU_SDATE"));
	
	http.Sync = true;
	Transaction("FSM00052E_S003","U_svc::" + "fs/fsm/FSM00052E_S003.jsp", "", "ds_bodyList=DS_body", ActionVal, "");
	http.Sync = false;	
}

function fn_callbackDataSearch(errCode, errMsg) 
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오!");
		return;
	}
	else
	{
		// 식재료율 조회
		var ActionVal	= "";
		ActionVal += "UPJANG="		+ wrapQuote(ds_cond.getColumn(0, "UPJANG"));
		ActionVal += " START_DATE="	+ wrapQuote(gfn_getFirstDate(ds_cond.getColumn(0, "MENU_SDATE")));
		ActionVal += " END_DATE="	+ wrapQuote(gfn_getLastDate(ds_cond.getColumn(0, "MENU_SDATE")));
		
		Transaction("FSM90900E_S001","U_svc::" + "fs/fsm/FSM90900E_S001.jsp", "", "ds_rateMonth=ds_rateMonth", ActionVal, "fn_searchRateMonth");
	
		// 식단등록 그리드 데이터 세팅
		fn_setMenuGridData(grd_menuList, ds_menuList, ds_headList, ds_bodyList);
		
		fn_callbackCheckEnfUpjang();	    
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_searchRateMonth
 * 기ㅡㅡㅡ능 : 하단 식재료율 표시방법 처리 (추후 색상변경이 필요할 경우 사용하세요.)
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_searchRateMonth() 
{
	// 계획식재료율
	if(Number(edt_rate01.value) > 0) edt_rate01.style.color = "black";
	else if(Number(edt_rate01.value) < 0) edt_rate01.style.color = "black";
	else edt_rate01.style.color = "black";
	
	// 실적식재료율
	if(Number(edt_rate02.value) > 0) edt_rate02.style.color = "black";
	else if(Number(edt_rate02.value) < 0) edt_rate02.style.color = "black";
	else edt_rate02.style.color = "black";

	// 달성율
	if(Number(edt_rate03.value) > 0) 
	{
		edt_rate03.style.color = "blue";
	}
	else if(Number(edt_rate03.value) < 0) 
	{
		edt_rate03.style.color = "red";
	}
	else 
	{
		edt_rate03.style.color = "black";
	}

}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_hallSearch()
 * 기ㅡㅡㅡ능 : 식당정보 조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_hallSearch()
{
	// 업장이 선택되어 있을 경우에만 조회한다.
	if(gfn_isNull(ds_cond.getColumn(0, "UPJANG"))) {
		ds_cboHall.clearData();
		return;
	}

	// 기존 데이터 초기화
	fn_initData();
	
	var args = "UPJANG=" + wrapQuote(ds_cond.getColumn(0, "UPJANG"));

	fsp_clear(this); 
	fsp_addSearch(this, "fs/fsc:FSA_HALL_MST_S001");  // 식당정보
	fsp_callService(this, "", "", "", "ds_cboHall=gds_Csqlout", args, "fn_callbackHallSearch");
}

function fn_callbackHallSearch(errCode, errMsg) 
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오!");
		return;
	}
	// 005:카페테리아
	ds_cboHall.filter("gfn_subStr(HALL_CD,0,3)=='005'");
	cbo_hall.index = 0;
	ds_cond.setColumn(0, "SUBINV_CODE", ds_cboHall.getColumn(cbo_hall.index, "SUBINV_CODE"));
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_setHeader(tabPage, menuObj, headObj)
 * 기ㅡㅡㅡ능 : 헤더 데이터 세팅
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_setHeader(grdObj, dsGrdObj, dsHeadObj, sSecondRowIdx) {

	// 헤더 데이터 세팅
	var idx = 0;
	var fDay = "";
	var sDay = "";
	var sImage = "";
	for(var i=0; i < grdObj.getFormatColCount() - 1; i++)
	{
		if(i < 1) continue;
		
		if(i % 2 != 0) 
		{
			// 날짜 세팅
			fDay = dsHeadObj.getColumn(idx, "FDAY");
			sDay = gfn_subStr(fDay, 4, 2) + "/" + gfn_subStr(fDay, 6, 2) + "(" + dsHeadObj.getColumn(idx, "WE") + ")";
			grdObj.setCellProperty("Head", i, "text", sDay);
			grdObj.setCellProperty("Head", sSecondRowIdx, "text", "");
			
			// 날씨 이미지 세팅
			if(!gfn_isNull(dsHeadObj.getColumn(idx, "WIMG")))
			{
				sImage = "URL('theme://convertImages/" + dsHeadObj.getColumn(idx, "WIMG") + ".png')";
			} else {
				sImage = "";
			}
  		    grdObj.setCellProperty('head', i + 1, 'displaytype', 'image'); 
			grdObj.setCellProperty("head", i + 1, "text", sImage);
			sSecondRowIdx ++;
			idx ++;
		}
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_setMenuGridData(menuObj, headObj, bodyObj)
 * 기ㅡㅡㅡ능 : 식단등록 그리드 데이터 세팅
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_setMenuGridData(grdObj, dsGrdObj, dsHeadObj, dsBodyObj)
{
	ds_subSum.clearData();
	menuCnt = 0;
	dsGrdObj.clearData();

	// 헤더 세팅
	fn_setHeader(grdObj, dsGrdObj, dsHeadObj, 15);

	var vCond = "";
	var nRow = 0;
	var nSdWon = 0;  // 소계처리용 변수
	var nSumStartRow = 0;
	for(var i=0; i<ds_sgbn.getRowCount(); i++)
	{
		vCond = "SGBN=='" + ds_sgbn.getColumn(i, "SGBN") + "' && CGBN=='" + ds_sgbn.getColumn(i, "CGBN") + "' && CGBN_CD=='" + ds_sgbn.getColumn(i, "CGBN_CD")+"'";
		dsBodyObj.filter(vCond);
		
		if(dsBodyObj.getRowCount() == 0)
		{
			nRow = dsGrdObj.addRow();
			dsGrdObj.setColumn(nRow, "KEY"         , "N" + i);                          // KEY
			dsGrdObj.setColumn(nRow, "SGBN"        , ds_sgbn.getColumn(i, "SGBN"));		// 끼니코드
			dsGrdObj.setColumn(nRow, "SGBN_NM"     , ds_sgbn.getColumn(i, "SGBN_NM"));	// 끼니명
			dsGrdObj.setColumn(nRow, "CGBN"        , ds_sgbn.getColumn(i, "CGBN"));		// 코너명
			dsGrdObj.setColumn(nRow, "CGBN_CD"     , ds_sgbn.getColumn(i, "CGBN_CD"));	// 코너코드			
			
			// 소계
			nRow = dsGrdObj.addRow();
			dsGrdObj.setColumn(nRow, "SGBN"        , ds_sgbn.getColumn(i, "SGBN"));		// 끼니코드
			dsGrdObj.setColumn(nRow, "SGBN_NM"     , ds_sgbn.getColumn(i, "SGBN_NM"));	// 끼니명
			dsGrdObj.setColumn(nRow, "CGBN"        , ds_sgbn.getColumn(i, "CGBN"));		// 코너명
			dsGrdObj.setColumn(nRow, "CGBN_CD"     , ds_sgbn.getColumn(i, "CGBN_CD"));	// 코너코드			
		}
		else
		{
			for(var j=0; j<dsBodyObj.getRowCount(); j++)
			{
				nRow = dsGrdObj.findRow("KEY", dsBodyObj.getColumn(j, "KEY"));
				// 키가 존재하지 않을 경우 행 추가 후 세팅
				if(nRow == -1)
				{
					nRow = dsGrdObj.addRow();
					dsGrdObj.setColumn(nRow, "KEY"         , dsBodyObj.getColumn(j, "KEY"));			// 끼니코드 + 코너코드 + 레시피순번
					dsGrdObj.setColumn(nRow, "SGBN"        , dsBodyObj.getColumn(j, "SGBN"));			// 끼니코드
					dsGrdObj.setColumn(nRow, "SGBN_NM"     , dsBodyObj.getColumn(j, "SGBN_NM"));		// 끼니명
					dsGrdObj.setColumn(nRow, "CGBN_CD"     , dsBodyObj.getColumn(j, "CGBN_CD"));		// 코너코드
					dsGrdObj.setColumn(nRow, "CGBN"        , dsBodyObj.getColumn(j, "CGBN"));			// 코너명
					dsGrdObj.setColumn(nRow, "SSEQ"        , dsBodyObj.getColumn(j, "SSEQ"));			// 레시피순번
					dsGrdObj.setColumn(nRow, "SALE_PRICE"  , dsBodyObj.getColumn(j, "SALE_PRICE"));		// 판매가
					dsGrdObj.setColumn(nRow, "MENU_CD"     , dsBodyObj.getColumn(j, "MENU_CD"));	    // 메뉴코드
				}
				dsGrdObj.setColumn(nRow, "T" + dsBodyObj.getColumn(j, "WEEK"), dsBodyObj.getColumn(j, "MENU_CD"));      // 메뉴코드
				dsGrdObj.setColumn(nRow, "D" + dsBodyObj.getColumn(j, "WEEK"), dsBodyObj.getColumn(j, "FDAY"));         // 제공일
				dsGrdObj.setColumn(nRow, "M" + dsBodyObj.getColumn(j, "WEEK"), dsBodyObj.getColumn(j, "SD_NM"));	    // 레시피명
				dsGrdObj.setColumn(nRow, "P" + dsBodyObj.getColumn(j, "WEEK"), dsBodyObj.getColumn(j, "SD_WON"));       // 레시피원가
				dsGrdObj.setColumn(nRow, "R" + dsBodyObj.getColumn(j, "WEEK"), dsBodyObj.getColumn(j, "RECIPE_COST_RATE"));       // 평균원가율
				dsGrdObj.setColumn(nRow, "C" + dsBodyObj.getColumn(j, "WEEK"), dsBodyObj.getColumn(j, "DUP_COLOR"));    // 식단평가색상
				dsGrdObj.setColumn(nRow, "E" + dsBodyObj.getColumn(j, "WEEK"), dsBodyObj.getColumn(j, "EXPECT_WON_AMT"));    // 예상원가
				dsGrdObj.setColumn(nRow, "F" + dsBodyObj.getColumn(j, "WEEK"), dsBodyObj.getColumn(j, "EXPECT_SALE_AMT"));   // 예상판매가
			}
			
			// 소계 처리
			var subSumidx = dsBodyObj.getRowCount() - 1;
			nRow = dsGrdObj.addRow();
			dsGrdObj.setColumn(nRow, "SGBN"        , dsBodyObj.getColumn(subSumidx, "SGBN"));
			dsGrdObj.setColumn(nRow, "SGBN_NM"     , dsBodyObj.getColumn(subSumidx, "SGBN_NM"));
			dsGrdObj.setColumn(nRow, "CGBN_CD"     , dsBodyObj.getColumn(subSumidx, "CGBN_CD"));
			dsGrdObj.setColumn(nRow, "CGBN"        , dsBodyObj.getColumn(subSumidx, "CGBN"));
			dsGrdObj.setColumn(nRow, "SSEQ"        , dsBodyObj.getColumn(subSumidx, "SSEQ"));
			dsGrdObj.setColumn(nRow, "SALE_PRICE"  , dsBodyObj.getColumn(subSumidx, "SALE_PRICE"));
			
			for(var j=0; j<dsHeadObj.getRowCount(); j++)
			{
				nSdWon = dsGrdObj.getSum("P" + (j + 1), nSumStartRow, nRow);
				if(nSdWon > 0 || !gfn_isNull(dsGrdObj.getMax("M" + (j + 1), nSumStartRow, nRow)))
				{
					dsGrdObj.setColumn(nRow, "T" + (j + 1), dsGrdObj.getMax("T" + (j + 1)));        // 메뉴코드
					dsGrdObj.setColumn(nRow, "D" + (j + 1), dsGrdObj.getMax("D" + (j + 1)));        // 제공일
					//dsGrdObj.setColumn(nRow, "M" + (j + 1), Put_comma(nSdWon, 0) + " 원(" + Math.round(nSdWon / dsGrdObj.getColumn(nRow, "SALE_PRICE") * 100, 1) + "%)");   // 소계
					dsGrdObj.setColumn(nRow, "M" + (j + 1), Math.round(dsGrdObj.getSum("E" + (j + 1), nSumStartRow, nRow) / dsGrdObj.getSum("F" + (j + 1), nSumStartRow, nRow) * 100, 1) + "%");   // 소계
					
					var nSumRow = ds_subSum.addRow();
					ds_subSum.setColumn(nSumRow, "WEEK", j + 1);
					ds_subSum.setColumn(nSumRow, "SGBN", dsBodyObj.getColumn(subSumidx, "SGBN"));
					ds_subSum.setColumn(nSumRow, "CGBN_CD", dsBodyObj.getColumn(subSumidx, "CGBN_CD"));
					ds_subSum.setColumn(nSumRow, "SD_WON", nSdWon);
					
					// 주간평균원가 계산용 식단제공수 처리
					menuCnt ++;
					
					salePriceSum = salePriceSum + Number(dsGrdObj.getColumn(nRow, "SALE_PRICE"));					
				}
			}
			nSumStartRow = nRow + 1;
			nSdWon = 0;
		}
		
	}

	var sProp1 = "0 none #c3c3c3ff, 1 solid #c3c3c3ff, 0 none #c3c3c3ff,  0 none #c3c3c3ff";   // body line
	var sProp2 = "0 none #c3c3c3ff, 0 none #c3c3c3ff,  0 none #c3c3c3ff,  0 none #c3c3c3ff";   // body line (오른쪽라인 없는 Style)
	var sProp3 = "0 none #c3c3c3ff, 1 solid #c3c3c3ff, 1 solid #c3c3c3ff, 0 none #c3c3c3ff";   // 소계 line
	var sProp4 = "0 none #c3c3c3ff, 0 none #c3c3c3ff,  1 solid #c3c3c3ff, 0 none #c3c3c3ff";   // 소계 line (오른쪽라인 없는 Style)
	sImage = "URL('theme://Images/new/grd_WF_ExpandImageX.png') middle center lavender";
	var expr = "";
	
	var weekNum = "";
	for(var i=0; i<grdObj.getFormatColCount(); i++)
	{
		if(i % 2 == 0 && i > 0)
		{
			expr = 'EXPR(!gfn_isNull(KEY)?"' + sProp1 + '":"' + sProp3 + '")';
			
			// 식단평가 색상처리를 위해 색상컬럼 ID를 찾는다.
			var val = grdObj.getCellProperty("body", i, "text");
			weekNum = gfn_right(val.replace("bind:", ""), 1);
		
			grdObj.setCellProperty("body", i, "background", 'EXPR(!gfn_isNull(C' + weekNum + ') ?C' + weekNum + ':!gfn_isNull(KEY)?"whitesmoke":gfn_isNull(M' + weekNum + ')?"lavender":"' + sImage + '")');
			grdObj.setCellProperty("body", i, "background2", 'EXPR(!gfn_isNull(C' + weekNum + ') ?C' + weekNum + ':!gfn_isNull(KEY)?"whitesmoke":gfn_isNull(M' + weekNum + ')?"lavender":"' + sImage + '")');
		}
		else
		{
			if(i == 0)
			{
				expr = 'EXPR(!gfn_isNull(KEY)?"' + sProp1 + '":"' + sProp3 + '")';
			}
			else
			{
				expr = 'EXPR(!gfn_isNull(KEY)?"' + sProp2 + '":"' + sProp4 + '")';				
			}
		}
		grdObj.setCellProperty("body", i, "line", expr);
		
		if(i > 0)
		{
			grdObj.setCellProperty("body", i, "font", 'EXPR(!gfn_isNull(KEY)?"굴림,9":"굴림,9,bold right")');
			grdObj.setCellProperty("body", i, "selectfont", 'EXPR(!gfn_isNull(KEY)?"굴림,9":"굴림,9,bold")');
			grdObj.setCellProperty("body", i, "align", 'EXPR(!gfn_isNull(KEY)?"":"center middle")');
		}
	}

	// 표준식단 그리드의 끼니 컬럼 bold 처리
	grdObj.setCellProperty("body", 0, "font", "굴림,9,bold");
	
	// [중요] 모든 데이터 세팅작업이 끝난뒤 필터 초기화
	dsBodyObj.filter("");
	
	grdObj.setCellProperty("summ", 0, "text", "평균원가");
	var nSumSdWon = 0;
	for(var i=1; i<=dsHeadObj.getRowCount(); i++) 
	{
		grdObj.setCellProperty("summ", i, "align", "center");
		grdObj.setCellProperty("summ", i, "text", fn_clearNaN(Math.round(dsGrdObj.getSum("E" + (i + 1)) / dsGrdObj.getSum("F" + (i + 1)) * 100, 1)) + "%");
	}
	
	// 식당목표식재료율(주간) 세팅
	var goalCostRate = ds_goalCostRate.getMax("GOAL_COST_RATE");
	edt_goalCostRate.value = goalCostRate;
	
	// 예상식재료율 세팅
	var exptCostRate = fn_clearNaN(Math.round(ds_bodyList.getSum("EXPECT_WON_AMT") / ds_bodyList.getSum("EXPECT_SALE_AMT") * 100, 1));
	edt_exptCostRate.value = exptCostRate + ' %';

	// 달성율 세팅
	if((goalCostRate - exptCostRate) < 0)
	{
		edt_resultRate.value = goalCostRate - exptCostRate + ' %P';
		edt_resultRate.style.color = "red";
	}
	else if((goalCostRate - exptCostRate) > 0)
	{
		edt_resultRate.value = goalCostRate - exptCostRate + ' %P';
		edt_resultRate.style.color = "blue";
	} else 
	{
		edt_resultRate.value = '0 %P';
	}
	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_setPeriodOfWeek(menuDate)
 * 기ㅡㅡㅡ능 : 일자가 속한 주(Week)의 시작일, 종료일 세팅 (월 ~ 일)
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-29
 ******************************************************************************************/
function fn_setPeriodOfWeek(menuDate)
{
	var objCalendar = new Calendar();
	objCalendar.value = menuDate;

	var startDate = gfn_getStartOfWeek(objCalendar);	// 시작일
	var endDate = gfn_getEndOfWeek(objCalendar);		// 종료일
	
	// 조회조건의 식단 제공일이 일요일일 경우 전주 식단을 제공
	var addDay = 0;
	if(startDate == menuDate) 
	{
		addDay = -6;
	}
	else
	{
		addDay = 1;
	}
	
	ds_cond.setColumn(0, "MENU_SDATE", gfn_addDate(startDate, addDay));
	ds_cond.setColumn(0, "MENU_EDATE", gfn_addDate(endDate, addDay));
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// 
//=========================================================================================
/******************************************************************************************
 * 함ㅡ수ㅡ명 : tab_menu_tabpage2_btn_nutAnalysis_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 영양분석
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function tab_menu_tabpage2_btn_nutAnalysis_onclick(obj:Button,  e:ClickEventInfo)
{
	var v_arg = {fa_UPJANG:ds_cond.getColumn(0, "UPJANG")
	            ,fa_HALL_CD:ds_cond.getColumn(0, "HALL_CD")
	            ,fa_FROM_MENU_DATE:ds_cond.getColumn(0, "MENU_SDATE")
	            ,fa_TO_MENU_DATE:ds_cond.getColumn(0, "MENU_EDATE")}; 
	
	gfn_dialog("", "U_FSM::FSM00170V.xfdl", v_arg);	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : tab_menu_tabpage2_btn_excel_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 엑셀 다운로드
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function tab_menu_tabpage2_btn_excel_onclick(obj:Button,  e:ClickEventInfo)
{
	if (ds_menuList.getRowCount() == 0) {
		g_Message("EE",	"출력할 메뉴정보가 없습니다.");
		return;
	}

	gfn_exportExcel(grd_menuList, "식단표", "", "", "", "", "cellline");
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : tab_menu_tabpage2_btn_myRecipe_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : MY레시피구성
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function tab_menu_tabpage2_btn_myRecipe_onclick(obj:Button,  e:ClickEventInfo)
{
	var v_arg =  {fa_Upjang:ds_cond.getColumn(0, "UPJANG")
	             ,fa_UpjangNm:ds_cond.getColumn(0, "UPJANGNM")
	             ,fa_HallCd:ds_cond.getColumn(0, "HALL_CD")
	             ,fa_HallName:cbo_hall.text
	             ,fa_MenuDate:ds_cond.getColumn(0, "MENU_DATE")
	             ,fa_SubinvCode:ds_cond.getColumn(0, "SUBINV_CODE")};
	
	gfn_dialog("", "U_FSM::FSM00110E.xfdl", v_arg);
	fn_search();
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : tab_menu_tabpage2_btn_myRecipe_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 식당 변경시 SUBINV_CODE 세팅
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function cbo_hall_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	ds_cond.setColumn(0, "SUBINV_CODE", ds_cboHall.getColumn(cbo_hall.index, "SUBINV_CODE"));
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : tab_menu_tabpage2_btn_copyMenu_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 식단복사
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function tab_menu_tabpage2_btn_copyMenu_onclick(obj:Button,  e:ClickEventInfo)
{
	var v_arg =  {fa_UPJANG:ds_cond.getColumn(0, "UPJANG")
	             ,fa_UPJANG_NM:ds_cond.getColumn(0, "UPJANGNM")
	             ,fa_HALL_CD:ds_cond.getColumn(0, "HALL_CD")
	             ,fa_HALL_NAME:cbo_hall.text
	             ,fa_FROM_DT:ds_cond.getColumn(0, "MENU_SDATE")
	             ,fa_SUBINV_CODE:ds_cond.getColumn(0, "SUBINV_CODE")
	             ,fa_CALL_PGM:'G'
	             ,fa_TO_DT:ds_cond.getColumn(0, "MENU_EDATE")
	             ,fa_IS_ENF:'N'};
	
	gfn_dialog("", "U_FSM::FSM00100E.xfdl", v_arg);
	fn_search();	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : tab_menu_tabpage2_btn_po_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 구매신청
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function tab_menu_tabpage2_btn_po_onclick(obj:Button,  e:ClickEventInfo)
{
	gfn_openMenuForm("FSP00030E.xfdl", "U_FSP", "", "구매신청");
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : tab_menu_tabpage2_grd_menuList_oncellclick(obj:Grid, e:GridClickEventInfo)
 * 기ㅡㅡㅡ능 : 메뉴삭제
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function tab_menu_tabpage2_grd_menuList_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	if(e.col > 0)
	{
		var sCellType = grd_menuList.getCellProperty("body", e.col, "displaytype");
		
		// 레시피 삭제
		if(sCellType == "number" && gfn_isNull(ds_menuList.getColumn(e.row, "KEY")))
		{
		
			var val = grd_menuList.getCellProperty("body", e.col, "text");
			var weekNum = '';
			if(!gfn_isNull(val))
			{
				weekNum = gfn_right(val.replace("bind:", ""), 1);
			}
			
			var sMenuCd = ds_menuList.getColumn(e.row, "T" + weekNum);
			var sFday = ds_menuList.getColumn(e.row, "D" + weekNum);
			
			if(gfn_isNull(sMenuCd)) return;
			
			// 삭제 가능여부 체크 ( 1. 예상식수 등록여부, 2. 주문 여부 )
			var vCond = "FDAY=='" + sFday + "'&&SGBN=='" + ds_menuList.getColumn(e.row, "SGBN") + "'&&CGBN=='" + ds_menuList.getColumn(e.row, "CGBN") + "'&&CGBN_CD=='" + ds_menuList.getColumn(e.row, "CGBN_CD") + "'";
			var nRow = ds_mealQtyBodyList.findRowExpr(vCond);
			
			if (nRow < 0) 
			{
					g_Message("EE",	"예상식수 정보가 없습니다.\n\n식수정보를 확인 후 처리하세요.");
					return;
			}
			else 
			{
				if (ds_mealQtyBodyList.getColumn(nRow, "ORDER_YN") == "Y") 
				{
					g_Message("EE",	"식자재가 발주되었습니다.\n\n메뉴를 삭제할수 없습니다.");
					return;
				}
			}

			// 확인메시지
			var msg = grd_menuList.getCellProperty("head",  e.col - 1, "text") + " : " + ds_menuList.getColumn(e.row, "SGBN_NM") + ds_menuList.getColumn(e.row, "CGBN") + "을(를) 삭제하시겠습니까?\n\n[ " + sMenuCd + " ]";
			
			if (g_Confirm("04",	msg) == true) {
				// 삭제처리
				var actionName, cmdName, inData, outData, otherArg, callBackFnc;
				
				inData			= "";
				outData			= "";
				otherArg		= "UPJANG=" + wrapQuote(ds_cond.getColumn(0, "UPJANG")) + " MENU_CD=" + wrapQuote(sMenuCd);
				callBackFnc		= "";
				
				fsp_clear(this); 
				fsp_addSearch(this, "fs/fsm:FSM00052E_D001");									// 조회 
				http.Sync = true;
				fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
				http.Sync = false;

				fn_search();
			}		
		}
	}	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : tab_menu_tabpage2_grd_menuList_oncelldblclick(obj:Grid, e:GridClickEventInfo)
 * 기ㅡㅡㅡ능 : 레시피검색 및 등록 
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function tab_menu_tabpage2_grd_menuList_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	if(e.col > 0)
	{
		var sCellType = grd_menuList.getCellProperty("body", e.col, "displaytype");
		
		// 레시피검색 및 등록
		var sFday = ds_headList.getColumn((e.cell - 1) / 2, "FDAY");
		
		// 예상식수 등록여부 체크
// 		var vCond = "FDAY=='" + sFday + "'&&SGBN=='" + ds_menuList.getColumn(e.row, "SGBN") + "'&&CGBN=='" + ds_menuList.getColumn(e.row, "CGBN") + "'&&CGBN_CD=='" + ds_menuList.getColumn(e.row, "CGBN_CD") + "'";
// 		var nRow = ds_mealQtyBodyList.findRowExpr(vCond);
// 		
// 		if (nRow < 0 || ds_mealQtyBodyList.getColumn(nRow, "EXPECT_MEAL_QTY") < 1) 
// 		{
// 				g_Message("EE",	"예상식수 정보가 없습니다.\n\n식수정보를 확인 후 처리하세요.");
// 				return;
// 		}			
		
		// 확인메시지
		var msg = grd_menuList.getCellProperty("head",  e.col - ((e.col - 1) % 2), "text") + ":" + ds_menuList.getColumn(e.row, "SGBN_NM") + ds_menuList.getColumn(e.row, "CGBN")+" 에 대한\n\n레시피 검색 및 등록/수정 작업을\n\n하시겠습니까?";

		if (g_Confirm("04",	msg) == true) {
			var v_arg = {fa_UPJANG:ds_cond.getColumn(0, "UPJANG")
						,fa_HALL_CD:ds_cond.getColumn(0, "HALL_CD")
						,fa_HALL_CLASS:ds_cboHall.lookup("HALL_CD", ds_cond.getColumn(0, "HALL_CD"), "HALL_CLASS")
						,fa_FROM_DT:ds_cond.getColumn(0, "MENU_SDATE")
						,fa_TO_DT:ds_cond.getColumn(0, "MENU_EDATE")
						,fa_MEAL:ds_menuList.getColumn(e.row, "SGBN")
						,fa_CORNER:ds_menuList.getColumn(e.row, "CGBN_CD")
						,fa_MENU_DATE:sFday
						,fa_SUBINV_CODE:ds_cond.getColumn(0, "SUBINV_CODE")
						,fa_CALL_PGM:'C'};	// G:일반식, H:병원식, C:카페테리아
			
		    gfn_dialog("", "U_FSM::FSM90030P.xfdl", v_arg, "", "", "", "", "", "", "", "", true);  // FSM00060E.xfdl					  
			fn_search();
		}		
	}		
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : tab_menu_tabpage2_grd_menuList_onmousemove(obj:Grid, e:GridMouseEventInfo)
 * 기ㅡㅡㅡ능 : 이미지 버튼에 대한 커서 처리
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function tab_menu_tabpage2_grd_menuList_onmousemove(obj:Grid, e:GridMouseEventInfo)
{
	if(e.col > 0)
	{
		var val = grd_menuList.getCellProperty("body", e.col, "text");
		var weekNum = '';
		if(!gfn_isNull(val))
		{
			weekNum = gfn_right(val.replace("bind:", ""), 1);
		}
	
		if(gfn_isNull(ds_menuList.getColumn(e.row, "KEY")) && gfn_isNull(ds_menuList.getColumn(e.row, "C" + weekNum)) && !gfn_isNull(ds_menuList.getColumn(e.row, "M" + weekNum)))
		{
			grd_menuList.setCellProperty('body', e.col, 'cursor', 'pointer');
		}
		else
		{
			grd_menuList.setCellProperty('body', e.col, 'cursor', '');
		}
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : tab_menu_tabpage2_grd_menuList_onmousemove(obj:Grid, e:GridMouseEventInfo)
 * 기ㅡㅡㅡ능 : MY 레시피 등록
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function tab_menu_tabpage2_grd_menuList_onrbuttondown(obj:Grid, e:GridMouseEventInfo)
{
	if (e.cell < 1 || e.row < 0) {
		return;
	}

	var sFday = ds_headList.getColumn((e.cell - 1) / 2, "FDAY");
	
	// 예상식수 등록여부 체크
	var vCond = "FDAY=='" + sFday + "'&&SGBN=='" + ds_menuList.getColumn(e.row, "SGBN") + "'&&CGBN=='" + ds_menuList.getColumn(e.row, "CGBN") + "'&&CGBN_CD=='" + ds_menuList.getColumn(e.row, "CGBN_CD") + "'";
	var nRow = ds_mealQtyBodyList.findRowExpr(vCond);
	
	if (nRow < 0) 
	{
			g_Message("EE",	"예상식수 정보가 없습니다.\n\n식수정보를 확인 후 처리하세요.");
			return;
	}
	
	// 확인메시지
	var msg = grd_menuList.getCellProperty("head",  e.col - ((e.col - 1) % 2), "text") + ":" + ds_menuList.getColumn(e.row, "SGBN_NM") + ds_menuList.getColumn(e.row, "CGBN") + "의\n\nMY레시피 등록 작업을 하시겠습니까?";

	trace(sFday + "-" + ds_cond.getColumn(0, "HALL_CD") + ds_menuList.getColumn(e.row, "SGBN") + ds_menuList.getColumn(e.row, "CGBN_CD"));

	if (g_Confirm("04",	msg) == true) {
	
		var v_arg = {fa_upjang:ds_cond.getColumn(0, "UPJANG")
	                ,fa_hall_cd:ds_cond.getColumn(0, "HALL_CD")
		            ,fa_meal:ds_menuList.getColumn(e.row, "SGBN")
		            ,fa_corner:ds_menuList.getColumn(e.row, "CGBN_CD")
		            ,fa_menu_date:sFday
		            ,fa_menu_cd:sFday + "-" + ds_cond.getColumn(0, "HALL_CD") + ds_menuList.getColumn(e.row, "SGBN") + ds_menuList.getColumn(e.row, "CGBN_CD")
	                ,fa_subinv_code:ds_cond.getColumn(0,"SUBINV_CODE")};
	
		gfn_dialog("", "U_FSM::FSM00130E.xfdl", v_arg);
		fn_search();
	}	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : ds_cond_onvaluechanged(obj:Dataset,  e:DSColChangeEventInfo)
 * 기ㅡㅡㅡ능 : 조회조건 변경시 데이터 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-04-22
 ******************************************************************************************/
function ds_cond_onvaluechanged(obj:Dataset,  e:DSColChangeEventInfo)
{
	fn_initData();
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_tmChange(obj, data)
 * 기ㅡㅡㅡ능 : 운영부서 변경시 사업장 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function fn_tmChange(obj, data)
{
	if(gfn_isNull(edt_tm.getTmCode()))
	{
		cbo_mu.setMuCode("");
	}
	edt_upjang.setUpjangCode("");
	ds_cboHall.clearData();
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_prev_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 전주
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function btn_prev_onclick(obj:Button,  e:ClickEventInfo)
{
	ds_cond.setColumn(0, "MENU_DATE", gfn_addDate(ds_cond.getColumn(0, "MENU_DATE"), -7));
	fn_search();
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_next_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 차주
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function btn_next_onclick(obj:Button,  e:ClickEventInfo)
{
	ds_cond.setColumn(0, "MENU_DATE", gfn_addDate(ds_cond.getColumn(0, "MENU_DATE"), 7));
	fn_search();
}

function tab_menu_tabpage2_grd_menuList_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	return false;
}

function cal_menuDate_onkeydown(obj:ObjCalendar, e:KeyEventInfo)
{
	if(e.keycode == 13) {
		grd_menuList.setFocus();
		fn_search();
	}	
}

function btn_costReflash_onclick(obj:Button,  e:ClickEventInfo)
{
	var sCostReflashDate = cal_costReflash.fn_getValue();
	if (sCostReflashDate < gfn_addDate(gfn_today(), 1)){
		g_Message("EE",	"갱신일 지정 오류!!\n\n당일 또는 과거 날짜는 갱신 할 수 없습니다.");
		return;
	}	  

	if (gfn_length(ds_cond.getColumn(0, "UPJANG"))== 0) {
		g_Message("EE",	"업장정보 오류!!\n\n 업장정보를 입력하세요.");
		return;
	}	  
	
	if (gfn_length(sCostReflashDate)== 0) {
		g_Message("EE",	"갱신일 오류!!\n\n갱신일을 입력하세요.");
		return;
	}
	
	if (!g_Confirm("02","원가 갱신 작업을 하시겠습니까?!\n\n지정일 ~ 지정일+6일(제공일기준)")) return;
	
	// 데이타체크
	ds_input.clearData();
	ds_input.addRow();
	ds_input.setColumn(0,"SDATE", sCostReflashDate);
	ds_input.setColumn(0,"UPJANG", ds_cond.getColumn(0, "UPJANG"));
	  	  
    http.Sync = true;
	var t_timeout = application.httptimeout;
	application.httptimeout = 2000; //1800초

	fsp_clear(this);	
	fsp_addSingle(this, "fs/fsm:FSM00052E_I001");
	fsp_callService(this, "", "", "ds_input2=ds_input:A", "ds_return=ds_return",  "", "fn_callbackCostReflash");

	application.httptimeout = t_timeout; //60초
	http.Sync = false;		
}

function fn_callbackCostReflash(errCode, errMsg) 
{
	if(errCode != 0)
	{
		g_Message("EE","서비스 에러");
	}
	else
	{
		if ((ds_return.getColumn(0, "O_RTN")) == 'TRUE'){	
			g_Message("04", ds_return.getColumn(0,"O_RTNMSG"));
		}
		else
		{
			g_Message("EE","갱신 도중 오류가 발생 하였습니다. \n\n " + ds_return.getColumn(0, "O_RTNMSG"));
		}
	}
}
]]></Script>
  </Form>
</FDL>

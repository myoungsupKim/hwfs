<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSC00080V" onkeydown="frm_OnKeyDown" onload="form_onload" titletext="지적항목 관리" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static96" class="sta_WFSA_Labelbg01" position="absolute 0 76 1237 117" anchor="left top right"/>
        <Static id="Static01" position="absolute 0 30 1237 71" class="sta_WFSA_Labelbg" anchor="left top right"/>
        <Static id="Static02" text="점검표" position="absolute 15 40 66 61" class="sta_WFSA_label"/>
        <Grid autoenter="select" binddataset="ds_Detail" cellsizingtype="both" readonly="false" enable="true" id="grd_Detail" useinputpanel="false" onheadclick="grd_list_OnHeadClick" taborder="19" tabstop="true" tooltiptype="hover" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 297 127 1237 710" selecttype="row" anchor="all" onexpanddown="grd_Detail_onexpanddown" autofittype="col">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="40" band="left"/>
                <Column size="60"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="120"/>
                <Column size="90"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="50"/>
                <Column size="140"/>
                <Column size="140"/>
                <Column size="20"/>
                <Column size="26"/>
              </Columns>
              <Rows>
                <Row size="48" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="image" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="직군"/>
                <Cell col="2" displaytype="text" text="상세직군"/>
                <Cell col="3" text="사업부"/>
                <Cell col="4" text="지역본부/팀"/>
                <Cell col="5" text="운영팀"/>
                <Cell col="6" text="사업장"/>
                <Cell col="7" text="점검일"/>
                <Cell col="8" text="점장명"/>
                <Cell col="9" text="점검자"/>
                <Cell col="10" text="점수"/>
                <Cell col="11" text="평가내용"/>
                <Cell col="12" text="개선계획"/>
                <Cell col="13" displaytype="checkbox" edittype="checkbox" style="align:center middle;"/>
                <Cell col="14" displaytype="button" text="사&#13;&#10;진" expandshow="hide" tooltiptext="위생점검 사진정보를 저장합니다."/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center middle;background:#ffffffff;background2:#ffffff;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="background:#ffffffff;background2:#ffffff;" text="bind:JOB_NAME" suppress="1"/>
                <Cell col="2" displaytype="text" style="background:#ffffffff;background2:#ffffff;" text="bind:SUB_JOB_NAME" suppress="2"/>
                <Cell col="3" text="bind:MU_NM"/>
                <Cell col="4" text="bind:SC_NM"/>
                <Cell col="5" text="bind:PT_NM"/>
                <Cell col="6" displaytype="text" style="background:#ffffffff;background2:#ffffff;" text="bind:UPJANGNM" suppress="3"/>
                <Cell col="7" displaytype="date" style="background:#ffffffff;background2:#ffffff;" text="bind:CHECK_DATE"/>
                <Cell col="8" displaytype="text" style="align:center middle;background:#ffffffff;background2:#ffffffff;" text="bind:CHARGE_NM"/>
                <Cell col="9" style="align:center middle;background:#ffffffff;background2:#ffffffff;" text="bind:CHECK_SABUN_NM"/>
                <Cell col="10" displaytype="number" style="background:#ffffffff;background2:#ffffff;" text="bind:MARK"/>
                <Cell col="11" displaytype="text" style="background:#ffffffff;background2:#ffffff;" text="bind:EVAL_CONTENTS"/>
                <Cell col="12" displaytype="text" style="background:#ffffffff;background2:#ffffff;" text="bind:IMPROV_MGMT"/>
                <Cell col="13" displaytype="checkbox" edittype="checkbox" style="background:#ffffffff;background2:#ffffffff;" text="bind:CHK"/>
                <Cell col="14" edittype="expr:iif(PHOTO_CNT&gt;0,'expand','none')" style="background:#ffffffff;background2:#ffffffff;" expandshow="expr:iif(PHOTO_CNT&gt;0,'show','hide')" expandsize="21"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <MaskEdit id="me_FROM_DT" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="2" type="string" userdata="btn_FROM_DT" position="absolute 255 40 335 61" class="msk_WF_EssentialCal"/>
        <Button id="btn_FROM_DT" onclick="g_CalButton_OnClick" taborder="3" userdata="me_FROM_DT" position="absolute 334 40 355 61" class="btn_WF_calEssential" text="" image=""/>
        <Static id="Static7" text="~" position="absolute 358 40 366 61"/>
        <MaskEdit id="me_TO_DT" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="4" type="string" userdata="btn_TO_DT" position="absolute 369 40 449 61" class="msk_WF_EssentialCal"/>
        <Button id="btn_TO_DT" onclick="g_CalButton_OnClick" taborder="5" userdata="me_TO_DT" position="absolute 448 40 469 61" class="btn_WF_calEssential" text="" image=""/>
        <Static id="Static14" text="기    간" position="absolute 192 40 247 61" class="sta_WFSA_label"/>
        <Div id="div_cmnBtn" taborder="26" text="Div0" url="cmn::CmnBtn.xfdl" position="absolute 0 0 1237 30" anchor="left top right" scrollbars="none"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" id="cbo_S_TABLE_TYPE" imemode="none" index="0" innerdataset="ds_TABLE_TYPE" type="NOTFILTERED" taborder="1" position="absolute 69 40 158 61" class="cmb_WF_Essential"/>
        <Static id="Static0" text="점검구분" position="absolute 957 40 1028 61" class="sta_WFSA_label"/>
        <CheckBox id="chk_CHECK_TYPE1" onclick="common_chk_OnClick" taborder="7" text="정기" userdata="001" position="absolute 1025 40 1067 61" value="true" class="chk_WF_Essential"/>
        <CheckBox id="chk_CHECK_TYPE2" onclick="common_chk_OnClick" taborder="8" text="기획" userdata="007" position="absolute 1076 40 1118 61" value="true" class="chk_WF_Essential"/>
        <CheckBox id="chk_CHECK_TYPE3" onclick="common_chk_OnClick" taborder="9" text="지도" userdata="002" value="false" position="absolute 1127 40 1169 61" class="chk_WF_Essential"/>
        <Static id="Static1" text="직    군" position="absolute 587 86 650 107" class="sta_WFSA_label"/>
        <Combo id="cbo_JOB" index="0" innerdataset="ds_JOB" type="NOTFILTERED" taborder="13" position="absolute 648 86 758 107"/>
        <Static id="Static2" text="상세직군" position="absolute 769 86 830 107" class="sta_WFSA_label"/>
        <Combo id="cbo_SubJob" index="0" innerdataset="ds_SUB_JOB" type="NOTFILTERED" taborder="14" position="absolute 837 86 930 107"/>
        <Static id="st10" text="사 업 장" position="absolute 936 86 1007 107" class="sta_WFSA_label"/>
        <Static id="Static3" text="운영부서" position="absolute 387 86 450 107" class="sta_WFSA_label"/>
        <Static id="Static15" text="평가항목대분류" position="absolute 15 86 114 107" class="sta_WFSA_label"/>
        <Combo codecolumn="CLASS_CD" datacolumn="CLASS_NAME" id="cbo_LRG_CLASS_CD" index="0" innerdataset="ds_LRG_CLASS_CD" type="NOTFILTERED" taborder="10" position="absolute 122 86 212 107" class="cmb_WF_Essential" userdata=""/>
        <Button id="btn_Chart" onclick="btn_Chart_OnClick" taborder="17" position="absolute 1205 86 1226 107" class="btn_WF_chart" text="" image=""/>
        <Grid autoenter="select" cellsizingtype="both" readonly="false" enable="true" id="grd_list" useinputpanel="false" oncelldblclick="grd_list_OnCellDblClick" onheadclick="grd_list_OnHeadClick" taborder="18" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 127 287 710" selecttype="row" anchor="left top bottom" binddataset="ds_list" treeusecheckbox="false" autofittype="col">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="40"/>
                <Column size="30"/>
                <Column size="150"/>
                <Column size="50"/>
                <Column size="0"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" class="head_Excel"/>
                <Cell col="1" rowspan="2" class="Cellgrd_WF_Plusbtn"/>
                <Cell col="2" rowspan="2" text="평가항목"/>
                <Cell col="3" rowspan="2" displaytype="text" text="지적&#10;건수"/>
                <Cell col="4"/>
                <Cell row="1" col="4"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center middle;background:#ffffffff;background2:#ffffff;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="image" style="background:#ffffffff;background2:#ffffff;backgroundimage:EXPR(gfn_sumStyle(getRowLevel(currow),&quot;IMG&quot;,null,currow, grd_list));"/>
                <Cell col="2" displaytype="text" style="background:EXPR(decode(getRowLevel(currow),1,gfn_sumStyle(getRowLevel(currow),&quot;BG&quot;),'#ffffff'));background2:EXPR(decode(getRowLevel(currow),1,gfn_sumStyle(getRowLevel(currow),&quot;BG&quot;),'#ffffff'));" text="bind:CLASS_NAME" subsumtext="expr:getColumn(currow+getRowLevel(currow),'MIDDLE_CLASS_NAME')" suppress="1"/>
                <Cell col="3" displaytype="number" style="background:EXPR(decode(getRowLevel(currow),1,gfn_sumStyle(getRowLevel(currow),&quot;BG&quot;),'#ffffff'));background2:EXPR(decode(getRowLevel(currow),1,gfn_sumStyle(getRowLevel(currow),&quot;BG&quot;),'#ffffff'));" text="bind:CNT"/>
                <Cell col="4" displaytype="tree" treelevel="expr:gfn_sumStyle(getRowLevel(currow),&quot;LV&quot;,1)"/>
              </Band>
              <Band id="summary">
                <Cell style="align:left;"/>
                <Cell col="1" colspan="2" style="align:center;" text="합    계"/>
                <Cell col="3" displaytype="number" style="align: ;" expr="expr:getSum('CNT')"/>
                <Cell col="4"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Combo codecolumn="FORM_CD" datacolumn="FORM_NAME" id="cbo_FORM_CD" index="0" innerdataset="ds_FORM_CD" type="NOTFILTERED" taborder="6" position="absolute 605 40 751 61" class="cmb_WF_Essential" userdata=""/>
        <Static id="Static6" text="양    식" position="absolute 544 40 599 61" class="sta_WFSA_label"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Static id="Static36" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 59 40 69 61" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 157 40 187 61" anchor="left top"/>
        <Static id="Static08" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 245 40 255 61" anchor="left top"/>
        <Static id="Static10" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 595 40 605 61" anchor="left top"/>
        <Static id="Static03" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 1015 40 1025 61" anchor="left top"/>
        <Static id="Static21" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 1066 40 1076 61" anchor="left top"/>
        <Static id="Static22" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 1117 40 1127 61" anchor="left top"/>
        <Static id="Static40" text="h5" class="Guide01_AreaRed" visible="false" position="absolute 0 71 450 76" anchor="left top"/>
        <Static id="Static45" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 117 611 127"/>
        <Static id="Static04" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 112 86 122 107" anchor="left top"/>
        <Static id="Static05" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 444 86 454 107" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 638 86 648 107" anchor="left top"/>
        <Static id="Static12" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 827 86 837 107" anchor="left top"/>
        <Static id="Static13" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 991 86 1001 107" anchor="left top"/>
        <CheckBox id="chk_CHECK_TYPE4" taborder="27" text="특별" onclick="common_chk_OnClick" class="chk_WF_Essential" position="absolute 1179 40 1221 61" userdata="004"/>
        <Static id="Static16" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 1169 40 1179 61" anchor="left top"/>
        <Static id="Static17" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 469 40 482 61" anchor="left top"/>
        <Static id="Static18" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 927 40 957 61" anchor="left top"/>
        <Combo id="cbo_CHECK_SABUN" taborder="28" innerdataset="@ds_CHECK_SABUN" codecolumn="CHECK_SABUN" datacolumn="CHECK_SABUN_NM" class="cmb_WF_Essential" position="absolute 837 40 927 61" userdata=""/>
        <Static id="Static19" text="점검자" class="sta_WFSA_label" position="absolute 781 40 828 61"/>
        <Static id="Static20" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 827 40 837 61" anchor="left top"/>
        <Static id="Static23" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 751 40 781 61" anchor="left top"/>
        <TmSearchComponent id="edt_tm" titletext="팀 검색용 Component" taborder="29" text="TmSearchComponent00" position="absolute 454 86 577 107" bindDataset="ds_input" bindTmCdColumn="TM_CD" bindTmNmColumn="TM_NM" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tmChange" eventBeforeTrigger=""/>
        <UpjangSearchComponent id="edt_upjang" titletext="업장 검색용 Component" taborder="30" text="UpjangSearchComponent00" position="absolute 1001 86 1150 107" bindDataset="ds_input" bindUpjangCodeColumn="UPJANG" bindUpjangNameColumn="UPJANG_NM" eventBeforeTrigger="" eventAfterTrigger="" roleSetId=""/>
        <MuSearchComponent id="cbo_mu" titletext="사업부 선택 Component" taborder="31" text="MuSearchComponent00" position="absolute 278 86 377 107" bindDataset="ds_input" bindMuCdColumn="MU_CD" appendText="" onItemChangedEvent="fn_muChange"/>
        <Static id="Static24" text="사업부" class="sta_WFSA_label" position="absolute 223 86 270 107"/>
        <Static id="Static25" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 268 86 278 107" anchor="left top"/>
        <Radio id="rd_SelType" taborder="32" columncount="1" rowcount="2" innerdataset="@ds_SelType" codecolumn="CODE" datacolumn="CODE_NAME" onitemchanged="rd_SelType_onitemchanged" position="absolute 479 36 529 67"/>
        <ActiveX id="IfBrowser" progid="Shell.Explorer" useautobitmapcache="1" position2="absolute l:1319 r:-133 t:15 b:676" positiontype="position2" taborder="33" NewWindow2="IfBrowser_NewWindow2" DocumentComplete="IfBrowser_DocumentComplete" NavigateError=" " visible="false"/>
        <Button id="Button91" taborder="34" text="(All)" class="btn_WF_Excel" position="absolute 1155 86 1200 107" onclick="btn_Excel_OnClick" visible="true"/>
        <Grid id="grd_Detailall" taborder="35" binddataset="ds_Detailall" wheelscrollrow="1" autoenter="select" useinputpanel="false" cellsizingtype="both" autofittype="col" position="absolute 82 270 1235 401" anchor="all" tooltiptype="hover" onheadclick="grd_Detailall_OnHeadClick" visible="false">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="40" band="left"/>
                <Column size="81"/>
                <Column size="200"/>
                <Column size="60"/>
                <Column size="74"/>
                <Column size="45"/>
                <Column size="82"/>
                <Column size="44"/>
                <Column size="61"/>
                <Column size="100"/>
                <Column size="57"/>
                <Column size="80"/>
                <Column size="50"/>
                <Column size="77"/>
                <Column size="115"/>
                <Column size="20"/>
                <Column size="26"/>
              </Columns>
              <Rows>
                <Row size="48" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="image" class="head_Excel"/>
                <Cell col="1" text="평가항목"/>
                <Cell col="2" text="평가항목"/>
                <Cell col="3" displaytype="text" text="직군"/>
                <Cell col="4" displaytype="text" text="상세직군"/>
                <Cell col="5" text="사업부"/>
                <Cell col="6" text="지역본부/팀"/>
                <Cell col="7" text="운영팀"/>
                <Cell col="8" text="사업장"/>
                <Cell col="9" text="점검일"/>
                <Cell col="10" text="점장명"/>
                <Cell col="11" text="점검자"/>
                <Cell col="12" text="점수"/>
                <Cell col="13" text="평가내용"/>
                <Cell col="14" text="개선계획"/>
                <Cell col="15" displaytype="checkbox" edittype="checkbox" style="align:center middle;"/>
                <Cell col="16" displaytype="button" text="사&#13;&#10;진" expandshow="hide" tooltiptext="위생점검 사진정보를 저장합니다."/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center middle;background:#ffffffff;background2:#ffffff;" expr="expr:currow+1"/>
                <Cell col="1" text="bind:MIDDLE_CLASS_NAME"/>
                <Cell col="2" text="bind:CLASS_NAME"/>
                <Cell col="3" displaytype="text" style="background:#ffffffff;background2:#ffffff;" text="bind:JOB_NAME"/>
                <Cell col="4" displaytype="text" style="background:#ffffffff;background2:#ffffff;" text="bind:SUB_JOB_NAME"/>
                <Cell col="5" text="bind:MU_NM"/>
                <Cell col="6" text="bind:SC_NM"/>
                <Cell col="7" text="bind:PT_NM"/>
                <Cell col="8" displaytype="text" style="background:#ffffffff;background2:#ffffff;" text="bind:UPJANGNM"/>
                <Cell col="9" displaytype="date" style="background:#ffffffff;background2:#ffffff;" text="bind:CHECK_DATE"/>
                <Cell col="10" displaytype="text" style="align:center middle;background:#ffffffff;background2:#ffffffff;" text="bind:CHARGE_NM"/>
                <Cell col="11" style="align:center middle;background:#ffffffff;background2:#ffffffff;" text="bind:CHECK_SABUN_NM"/>
                <Cell col="12" displaytype="number" style="background:#ffffffff;background2:#ffffff;" text="bind:MARK"/>
                <Cell col="13" displaytype="text" style="background:#ffffffff;background2:#ffffff;" text="bind:EVAL_CONTENTS"/>
                <Cell col="14" displaytype="text" style="background:#ffffffff;background2:#ffffff;" text="bind:IMPROV_MGMT"/>
                <Cell col="15" displaytype="checkbox" edittype="checkbox" style="background:#ffffffff;background2:#ffffffff;" text="bind:CHK"/>
                <Cell col="16" edittype="expr:iif(PHOTO_CNT&gt;0,'expand','none')" style="background:#ffffffff;background2:#ffffffff;" expandshow="expr:iif(PHOTO_CNT&gt;0,'show','hide')" expandsize="21"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_input" oncolumnchanged="ds_input_OnColumnChanged">
        <ColumnInfo>
          <Column id="FROM_DT" size="256" type="STRING"/>
          <Column id="TO_DT" size="256" type="STRING"/>
          <Column id="TABLE_TYPE" size="256" type="STRING"/>
          <Column id="CHECK_TYPE" size="256" type="STRING"/>
          <Column id="JOB" size="256" type="STRING"/>
          <Column id="SUB_JOB" size="256" type="STRING"/>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="UPJANG_NM" size="256" type="STRING"/>
          <Column id="MU_CD" type="STRING" size="256"/>
          <Column id="MU_NM" type="STRING" size="256"/>
          <Column id="TM_CD" size="256" type="STRING"/>
          <Column id="TM_NM" size="256" type="STRING"/>
          <Column id="FORM_CD" size="256" type="STRING"/>
          <Column id="LRG_CLASS_CD" size="256" type="STRING"/>
          <Column id="CLASS_CD" size="256" type="STRING"/>
          <Column id="CHECK_SABUN" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CHECK_TYPE"/>
            <Col id="CLASS_CD"/>
            <Col id="FORM_CD"/>
            <Col id="FROM_DT"/>
            <Col id="JOB"/>
            <Col id="LRG_CLASS_CD"/>
            <Col id="SUB_JOB"/>
            <Col id="TABLE_TYPE"/>
            <Col id="TM_CD"/>
            <Col id="TM_NM"/>
            <Col id="TO_DT"/>
            <Col id="UPJANG"/>
            <Col id="UPJANG_NM"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_TABLE_TYPE">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_JOB"/>
      <Dataset id="ds_SUB_JOB"/>
      <Dataset id="ds_SUB_JOB1"/>
      <Dataset id="ds_Detail">
        <ColumnInfo>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="CLASS_CD" type="STRING" size="256"/>
          <Column id="JOB_CD" type="STRING" size="256"/>
          <Column id="JOB_NAME" type="STRING" size="256"/>
          <Column id="SUB_JOB_CD" type="STRING" size="256"/>
          <Column id="SUB_JOB_NAME" type="STRING" size="256"/>
          <Column id="MU_NM" type="STRING" size="256"/>
          <Column id="PT_NM" type="STRING" size="256"/>
          <Column id="SC_NM" type="STRING" size="256"/>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="UPJANGNM" type="STRING" size="256"/>
          <Column id="CHECK_DATE" type="STRING" size="256"/>
          <Column id="CHECK_SABUN" type="STRING" size="256"/>
          <Column id="CHECK_SABUN_NM" type="STRING" size="256"/>
          <Column id="CHARGE_SABUN" type="STRING" size="256"/>
          <Column id="CHARGE_NM" type="STRING" size="256"/>
          <Column id="MARK" type="STRING" size="256"/>
          <Column id="EVAL_CONTENTS" type="STRING" size="256"/>
          <Column id="INDICATE_PHOTO" type="STRING" size="256"/>
          <Column id="SINDICATE_PHOTO" type="STRING" size="256"/>
          <Column id="IMPROV_MGMT" type="STRING" size="256"/>
          <Column id="IMPROV_PHOTO" type="STRING" size="256"/>
          <Column id="SIMPROV_PHOTO" type="STRING" size="256"/>
          <Column id="PHOTO_CNT" type="STRING" size="256"/>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="SEQNO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_LRG_CLASS_CD"/>
      <Dataset id="ds_FORM_CD">
        <ColumnInfo>
          <Column id="TABLE_TYPE" size="256" type="STRING"/>
          <Column id="FORM_CD" size="256" type="STRING"/>
          <Column id="FORM_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list" keystring="G:+PL_UP_CD" reversesubsum="true"/>
      <Dataset id="ds_listtemp" keystring="PL_UP_CD:MIDDLE_CLASS_NAME" reversesubsum="True"/>
      <Dataset id="ds_CHECK_SABUN">
        <ColumnInfo>
          <Column id="CHECK_SABUN" size="256" type="STRING"/>
          <Column id="CHECK_SABUN_NM" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SelType">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">N</Col>
            <Col id="CODE_NAME">금년</Col>
          </Row>
          <Row>
            <Col id="CODE">B</Col>
            <Col id="CODE_NAME">전년</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Detailall">
        <ColumnInfo>
          <Column id="MIDDLE_CLASS_NAME" type="STRING" size="256"/>
          <Column id="CLASS_NAME" type="STRING" size="256"/>
          <Column id="MU_NM" type="STRING" size="256"/>
          <Column id="PT_NM" type="STRING" size="256"/>
          <Column id="SC_NM" type="STRING" size="256"/>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="CLASS_CD" type="STRING" size="256"/>
          <Column id="JOB_CD" type="STRING" size="256"/>
          <Column id="JOB_NAME" type="STRING" size="256"/>
          <Column id="SUB_JOB_CD" type="STRING" size="256"/>
          <Column id="SUB_JOB_NAME" type="STRING" size="256"/>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="UPJANGNM" type="STRING" size="256"/>
          <Column id="CHECK_DATE" type="STRING" size="256"/>
          <Column id="CHECK_SABUN" type="STRING" size="256"/>
          <Column id="CHECK_SABUN_NM" type="STRING" size="256"/>
          <Column id="CHARGE_SABUN" type="STRING" size="256"/>
          <Column id="CHARGE_NM" type="STRING" size="256"/>
          <Column id="MARK" type="STRING" size="256"/>
          <Column id="EVAL_CONTENTS" type="STRING" size="256"/>
          <Column id="INDICATE_PHOTO" type="STRING" size="256"/>
          <Column id="SINDICATE_PHOTO" type="STRING" size="256"/>
          <Column id="IMPROV_MGMT" type="STRING" size="256"/>
          <Column id="IMPROV_PHOTO" type="STRING" size="256"/>
          <Column id="SIMPROV_PHOTO" type="STRING" size="256"/>
          <Column id="PHOTO_CNT" type="STRING" size="256"/>
          <Column id="CHK" type="STRING" size="256"/>
          <Column id="SEQNO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="me_FROM_DT_value" compid="me_FROM_DT" propid="value" datasetid="ds_input" columnid="FROM_DT"/>
      <BindItem id="me_TO_DT_value" compid="me_TO_DT" propid="value" datasetid="ds_input" columnid="TO_DT"/>
      <BindItem id="cbo_S_TABLE_TYPE_value" compid="cbo_S_TABLE_TYPE" propid="value" datasetid="ds_input" columnid="TABLE_TYPE"/>
      <BindItem id="cbo_JOB_value" compid="cbo_JOB" propid="value" datasetid="ds_input" columnid="JOB"/>
      <BindItem id="cbo_SubJob_value" compid="cbo_SubJob" propid="value" datasetid="ds_input" columnid="SUB_JOB"/>
      <BindItem id="cbo_LRG_CLASS_CD_value" compid="cbo_LRG_CLASS_CD" propid="value" datasetid="ds_input" columnid="LRG_CLASS_CD"/>
      <BindItem id="cbo_FORM_CD_value" compid="cbo_FORM_CD" propid="value" datasetid="ds_input" columnid="FORM_CD"/>
      <BindItem id="item0" compid="cbo_CHECK_SABUN" propid="value" datasetid="ds_input" columnid="CHECK_SABUN"/>
      <BindItem id="item2" compid="edt_upjang" propid="value" datasetid="ds_cond" columnid="UPJANGNM"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 메뉴관리/위생관리/점검결과 조회(지적항목 관리)
 * 프로그램명   : FSC00080V.XML
 * 기      능   : 점검결과 조회(지적항목 관리)
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-27
 * 비      고   : 
 *		- ds_input				: [input DS] 조회조건 파라미터 DS
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
   2020.03.16 김명섭 점검구분기준변경(보정미사용,기획신규사용)
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"		// X-Framework Lib
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"
//@@컨버터에서 주석처리 #include "lib::fs_common.js"
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var fstrQuery1 = "SELECT FORM_CD,FORM_NAME||'('||START_DATE||'~'||NVL(END_DATE,'            ')||')' AS FORM_NAME \n  FROM FSC_FORM_MST \n WHERE 1=1";
var fstrQuery2 = "SELECT A.CLASS_CD, A.CLASS_NAME, A.CLASS_TYPE  FROM FSC_CLASS_MST A WHERE CLASS_TYPE = 'L'";
var onWork = false;
var serverSaveDir = "FSC_RESULT_PHOTO";		// 파일패스
var serverSaveUrl;							// 파일패스URL
var fv_isIfPage;
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	// 업데이트 DS
	v_ds_check = "";
	
	// X-Framework : Action 정보 생성 
	fsp_init(this);
	
	// 권한처리
	edt_tm.applyAuthLevel(cbo_mu);
	edt_upjang.applyAuthLevel(edt_tm);
	
	fn_InitSearch();
	
	// 초기값 셋팅
	var strDt = fn_CurrDateWeek();
	serverSaveUrl = fsp_getServerDir(serverSaveDir) + "/";
	ds_input.setColumn(0,"FROM_DT",gfn_left(strDt,6)+"01");				// 일자
	ds_input.setColumn(0,"TO_DT",strDt);							// 일자
	//2020.03.16
	//ds_input.setColumn(0,"CHECK_TYPE","'001','003'");
	ds_input.setColumn(0,"CHECK_TYPE","'001','007'");	//정기,기획
	
	cbo_S_TABLE_TYPE.index = 0;
	cbo_S_TABLE_TYPE.setFocus();
	
	//cbo_mu.setMuCode(' ');
	//edt_tm.setTmCode('');
	//edt_upjang.setUpjangCode('');
}

function frm_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
}
//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_search()
{
	if (!fn_SearchCheck())		// 조회조건체크
	{
		return;
	}
	
	// 초기화
	grd_list.enableredraw = false;
	
	ds_list.clearData();
	ds_Detail.clearData();
	
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	actionName		= "FSC00080V_T001";
	cmdName			= "U_svc::" + "fs/fsc/FSC00080V_T001.jsp";
	inData			= "ds_input=ds_input";
	outData			= "ds_list=ds_list";
	callBackFnc		= "fn_afterSearchList";
	
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc,true,false,false);
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Print()
 * 기      능   : [출력버튼] 출력 시 처리되는 작업
 ******************************************************************************************
 */
function fn_print()
{
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Excel()
 * 기      능   : [엑셀버튼] 엑셀 시 처리되는 작업
 ******************************************************************************************
 */
function fn_Excel()
{
	gfn_exportExcel(grd_list, "Sheet1");
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function fn_Close()
{
	this.close();
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Help()
 * 기      능   : [도움말버튼] 도움말
 ******************************************************************************************
 */
function fn_help()
{
	// tit_addSearchActionInfo(this, "fs/fsm:SCC_MENU_SELECT");
	// tit_callService(this, "", "", "ds_cond=ds_cond", "ds_Menu=ds_list", "", "");	
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_SearchCheck()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 조회시 필수조회조건 체크
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-10  
 ******************************************************************************************
 */
function fn_SearchCheck()
{
	if (gfn_length(ds_input.getColumn(0,"TABLE_TYPE"))== 0)
	{
		g_Message("EE", "점검표를 선택하세요.");
		cbo_S_TABLE_TYPE.setFocus();
		return false;
	}

	if (gfn_length(ds_input.getColumn(0,"FROM_DT"))== 0)
	{
		g_Message("EE", "날짜를 입력하세요");
		me_FROM_DT.setFocus();
		return false;
	}

	if (gfn_length(ds_input.getColumn(0,"TO_DT"))== 0)
	{
		g_Message("EE", "날짜를 입력하세요");
		me_TO_DT.setFocus();
		return false;
	}

	if (ds_input.getColumn(0,"FROM_DT") > ds_input.getColumn(0,"TO_DT"))
	{
		g_Message("EE", "검색기간을 확인해 주십시오.");
		me_FROM_DT.setFocus();
		return false;
	}
	
	if (gfn_length(ds_input.getColumn(0,"FORM_CD"))== 0)
	{
		g_Message("EE", "양식을 선택하세요.");
		cbo_FORM_CD.setFocus();
		return false;
	}
	
	if (gfn_length(ds_input.getColumn(0,"CHECK_TYPE"))== 0)
	{
		g_Message("EE", "점검구분을 선택하세요.");
		chk_CHECK_TYPE1.setFocus();
		return false;
	}
	
	if (gfn_length(ds_input.getColumn(0,"LRG_CLASS_CD"))== 0)
	{
		g_Message("EE", "평가항목대분류를 선택하세요.");
		cbo_LRG_CLASS_CD.setFocus();
		return false;
	}
	
    return true;
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_callBackSearch()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 점검자 리스트 조회
 * 작  성  자   : 지승훈
 * 작성  일자   : 2015-05-27 
 ******************************************************************************************
 */
function fn_callBackSearch(errCode, errMsg) 
{
	if ( errCode != 0 ) {
		g_Message("EE", errMsg);
		return;
	}
	
	// 점검자 콤보에 선택 추가
	ds_CHECK_SABUN.insertRow(0);
	ds_CHECK_SABUN.setColumn(0, "CHECK_SABUN", "");
	ds_CHECK_SABUN.setColumn(0, "CHECK_SABUN_NM", "- 선택 -");

	cbo_CHECK_SABUN.value = "";
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_InitSearch()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 초기 공통코드조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-15
 ******************************************************************************************
 */
function fn_InitSearch()
{

	//직군코드
	fn_sql_common("C", strMAQuery_MAJOB,"","ORDER BY JOB_CD","",cbo_JOB,-1,ds_JOB);
	ds_JOB.insertRow(0);
	ds_JOB.setColumn(0,"JOB_CD","");
	ds_JOB.setColumn(0,"JOB_NAME","전체");
	cbo_JOB.index = 0;
	
	//SUB 직군코드
	fn_sql_common("C", strMAQuery_MASUBJOB,"","ORDER BY SUB_JOB_CD","",cbo_SubJob,-1,ds_SUB_JOB);
	ds_SUB_JOB.insertRow(0);
	ds_SUB_JOB.setColumn(0,"SUB_JOB_CD","");
	ds_SUB_JOB.setColumn(0,"SUB_JOB_NAME","전체");
	Copy(ds_SUB_JOB1,ds_SUB_JOB);	
	cbo_SubJob.index = 0;
	
	//공통코드조회
	var v_fil_cond;
	var v_ds = fn_common_code("'FS0041'","","","all","Y");

	// 정검표구분(ds_TABLE_TYPE, GROUP_CODE : 'FS0041')
	v_fil_cond = "GROUP_CODE == 'FS0041' && CODE != null";
	v_ds.filter(v_fil_cond);
	CopyF(ds_TABLE_TYPE,v_ds.name);
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_SearchSub(nRow)
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 상세내역 조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-18  
 ******************************************************************************************
 */
function fn_SearchSub(nRow)
{
	// 초기화
	ds_Detail.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg,callBackFnc;
	
	ds_input.setColumn(0,"CLASS_CD",ds_list.getColumn(nRow,"PL_CD"));
	
	actionName		= "FSC00080V_T002";
	cmdName			= "U_svc::" + "fs/fsc/FSC00080V_T002.jsp";
	inData			= "ds_input=ds_input";
	outData			= "ds_Detail=ds_list";
	callBackFnc		= "";
	
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc,true,false,false);
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSearchList()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 개별 표준 식단 조회 후 실행 함수
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-18  
 ******************************************************************************************
 */
function fn_afterSearchList(errCode, errMsg)
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오");
		return;
	}	
// 	ds_listtemp.copyData(ds_list);
// 	trace(ds_listtemp.saveXML());
// 	// SetData
// 	var nARow,nValue,nTotal;
// 	
// 	for(i=0 ; i< ds_listtemp.rowcount ; i++)
// 	{
// 		// 소계추가
// 		if (ds_listtemp.getRowLevel(i) == 1)
// 		{
// 			ds_list.insertRow(i);
// 			CopyToRow(ds_listtemp,i, "ds_list", i);
// 			
// 			ds_list.setColumn(i, "BL_PLUS", "+");
// 			ds_list.setColumn(i, "BL_SHOW", "1");
// 			ds_list.setColumn(i, "LEVEL_NO", 1);
// 			ds_list.setColumn(i, "PL_CD", ds_list.getColumn(i, "PL_UP_CD"));
// 			ds_list.setColumn(i, "PL_UP_CD", ds_list.getColumn(i, "PL_UP_CD"));
// 			ds_list.setColumn(i, "CLASS_NAME", ds_list.getColumn(i, "MIDDLE_CLASS_NAME"));
// 		}
// 	}
// 	
// 	ds_list.filter("(BL_SHOW==1)");
// 	
// 	grd_list.enableredraw = true;
	//fn_SearchSub(0);
	grd_list.enableredraw = true;	
}

/*
 ******************************************************************************************
 * 함  수  명   : gprGrdExpand(ds_obj, nRow)
 * 입      력   : ds_obj 	= 필터할데이터셋
				  nRow		= 선택된행
 * 반      환   : 없음
 * 기      능   : 그리드를 펼치거나 닫침
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-05  
 ******************************************************************************************
 */
function gprGrdExpand(ds_obj, nRow) 
{
	/*
	BL_PLUS: 현재 펼쳐져 있는지 확인 플래그
	LEVEL_NO: 레벨(st_depth: 선택 행의 레벨, ex_depth: 펼쳐질 레벨)
	PL_CD: 선택 행의 코드(PL_UP_CD: 상위코드)
	BL_SHOW: 해당 행의 표시여부 플래그
	*/
	
	if (ds_obj.getColumn(nRow,"LEVEL_NO") == ds_obj.getMaxNF("LEVEL_NO")) return;
	
	var sfilter = "";	// filter 구문
	
	ds_obj.enableevent 	= false;
	
	st_depth = parseInt(ds_obj.getColumn(nRow,"LEVEL_NO"));
	
	
	if(ds_obj.getColumn(nRow,"BL_PLUS") == "+")			// + : 그리드를 펼침
	{
		ds_obj.setColumn(nRow,"BL_PLUS", "-");
		
		var ex_depth = -1;
		var PL_CD = ds_obj.getColumn(nRow,"PL_CD");		// 구분코드
		
		sfilter = "(BL_SHOW==1)||(PL_UP_CD=='" + PL_CD + "')";
		
		ds_obj.filter("");
		
		var Row = ds_obj.findRowAs("PL_CD",PL_CD);
		
		for(var i = Row + 1; i < ds_obj.rowcount; i++) 
		{
			if(parseInt(ds_obj.getColumn(i,"LEVEL_NO")) <= st_depth) break;
			if(ex_depth == -1) ex_depth = parseInt(ds_obj.getColumn(i,"LEVEL_NO"));
			if(parseInt(ds_obj.getColumn(i,"LEVEL_NO")) == ex_depth)
				  ds_obj.setColumn(i, "BL_SHOW", 1);
			else 
				  ds_obj.setColumn(i, "BL_SHOW", 0);
			ds_obj.setColumn(i, "BL_PLUS", "+");
		}
	}
	else												// - : 그리드를 닫힘
	{
		ds_obj.setColumn(nRow,"BL_PLUS", "+");
		for(var i = nRow + 1; i < ds_obj.rowcount; i++) 
		{
			if(parseInt(ds_obj.getColumn(i,"LEVEL_NO")) <= st_depth) break;
			ds_obj.setColumn(i, "BL_SHOW", 0);
		}
	}
	sfilter = "(BL_SHOW==1)";
	ds_obj.filter(sfilter);
	
	ds_obj.rowposition = nRow;
	ds_obj.enableevent 	= true; 
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
/******************************************************************************************
 * 함  수  명   : grd_List_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
 * 기      능   : 그리드헤드 클릭 
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-03  
 ******************************************************************************************
 */
function grd_list_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{

	var strbkimg = obj.getCellProperty("head",e.cell,"class");

	if (strbkimg == "head_Excel")				// 엑셀출력
	{
		gfn_exportExcel(obj, this.titletext);
	}
	else if (e.col == 1) 
	{

		if(obj.treeinitstatus == "expand,all")
		{
			obj.treeinitstatus = "collapse,all";
		} 
		else {
			obj.treeinitstatus = "expand,all";		
		}
	}
	else if(e.cell == 13) 
	{
		gfn_setGridCheckAll(obj, e);
		//항상 첫번째 행을 선택하도록 한다.
		ds_Detail.selectRow(0);
	}
	//2019.01.23 김명섭 엑셀자료수신
	else if (e.col == 14)
	{
		fn_download();
	}
// 	else if (strbkimg == "Cellgrd_WF_Plusbtn" || strbkimg == "Cellgrd_WF_Minusbtn")	// 전체펼침
// 	{
// 		var ds_obj = eval(obj.binddataset);	// 연결된ds
// 		
// 		if (ds_obj.getCountNF() <= 1) return;
// 		
// 		ds_obj.enableevent 	= false;
// 		
// 		ds_obj.filter("");
// 		
// 		for (i=0 ; i<ds_obj.rowcount ; i++)
// 		{	
// 			if (strbkimg == "Cellgrd_WF_Plusbtn")			// 펼침
// 			{
// 				ds_obj.setColumn(i, "BL_PLUS", "-");
// 				ds_obj.setColumn(i, "BL_SHOW", 1);
// 			}
// 			else
// 			{
// 				if (ds_obj.getColumn(i,"LEVEL_NO") == ds_obj.getMax("LEVEL_NO"))
// 				{
// 					ds_obj.setColumn(i, "BL_SHOW", 0);
// 				}
// 				else
// 				{
// 					ds_obj.setColumn(i, "BL_SHOW", 1);
// 					ds_obj.setColumn(i, "BL_PLUS", "+");
// 				}
// 			}
// 		}
// 		
// 		obj.setCellProperty("head",e.cell,"class",iif(strbkimg == "Cellgrd_WF_Plusbtn","Cellgrd_WF_Minusbtn","Cellgrd_WF_Plusbtn"));
// 		
// 		ds_obj.filter("(BL_SHOW==1)");
// 	
// 		ds_obj.enableevent 	= true;
// 	}
}

function fn_download()
{
	if (ds_Detail.rowcount < 1) return;

	//trace(ds_input.saveXML());
	//trace(ds_Detail.saveXML());
	
	//선택데이터 체크
	var strCheckSeqno = "";
	var nRowCnt = ds_Detail.getRowCount();
	var bIsCheckedRow = false;
	for(var i=0 ; i<nRowCnt ; i++)
	{
		if (ds_Detail.getColumn(i, "CHK") == 1)
		{
			bIsCheckedRow = true;
			strCheckSeqno += " '" + ds_Detail.getColumn(i, "SEQNO") + "' ";
		}
	}

	//선택항목이 없을 시에 메시지를 처리한다.
	if (!bIsCheckedRow)
	{
		gfn_alert("선택된 항목이 없습니다.\n다운로드할 수 없습니다.", "다운로드할 row");	// 선택된 항목이 없습니다.
		return;
	}
	
	ds_input.addColumn("CHECK_SEQ","string",256);
	ds_input.setColumn(0,"CHECK_SEQ",gfn_replace(strCheckSeqno,"'  '","','"));

	//세션이 쿠키에 있는지를 검사 
	if (gfn_isNull(JSESSIONID)) {
		gfn_alert("서버에 접속할 수 있는 세션정보가 없습니다.@프로그램 종료 후 다시 로그인 하신 후 처리하시기 바랍니다.");
		return;
	}

	var mainTitle = "위생 점검 결과 조회";

	var arrParams = new Array();

	setParams (arrParams, "portrait", "vertical");

    var sParams = "TABLE_TYPE=" + ds_input.getColumn(ds_input.rowposition, "TABLE_TYPE")
                                            + "&FROM_DT=" + ds_input.getColumn(ds_input.rowposition, "FROM_DT")
                                            + "&TO_DT=" + ds_input.getColumn(ds_input.rowposition, "TO_DT")
                                            + "&FORM_CD=" + ds_input.getColumn(ds_input.rowposition, "FORM_CD")
                                            + "&CHECK_TYPE=" + ds_input.getColumn(ds_input.rowposition, "CHECK_TYPE")
                                            + "&LRG_CLASS_CD=" + ds_input.getColumn(ds_input.rowposition, "LRG_CLASS_CD")
                                            + "&MU_CD=" + ds_input.getColumn(ds_input.rowposition, "MU_CD")
                                            + "&TM_CD=" + ds_input.getColumn(ds_input.rowposition, "TM_CD")
                                            + "&JOB=" + ds_input.getColumn(ds_input.rowposition, "JOB")
                                            + "&SUB_JOB=" + ds_input.getColumn(ds_input.rowposition, "SUB_JOB")
                                            + "&UPJANG=" + ds_input.getColumn(ds_input.rowposition, "UPJANG")
                                            + "&CLASS_CD=" + ds_input.getColumn(ds_input.rowposition, "CLASS_CD")
                                            + "&CHECK_SABUN=" + ds_input.getColumn(ds_input.rowposition, "CHECK_SABUN")
                                            + "&TITLE=" + encodeURI(encodeURIComponent(mainTitle))
                                            + "&CHECK_SEQ=" + ds_input.getColumn(ds_input.rowposition, "CHECK_SEQ")
                                            + "&IMG_ROOT=" + fsp_getServerDir(serverSaveDir, "") + "/"
                                            //URL 이미지 읽기 위해 외부 URL 사용
                                            //+ "&IMG_ROOT=" + "https://nfics.hanwhafoodist.co.kr//app/gpfs/app_repository/ifis/upload/fs/fsc/photo" + "/"
                                            ;
    //trace(sParams);

	setParams (arrParams, "sParams", sParams);
	
	//조회팝업 호출 엑셀 저장 start
	
	var rtnVal = gfn_dialog("FSC00080V_Pop"				// dialogId
					   , "U_FSC::FSC00080V_Pop.xfdl"	// Url
					   , {fv_Contents:arrParams}		// 배열
					   , null, null, null, null, null, false, true, -1);
	
	//조회팝업 호출 엑셀 저장 end
	//직접 호출 엑셀 저장 start
	//직접 호출 엑셀 저장 end
	//fn_ResultXlsExport(sParams);

}

function setParams(arrParams, strName, strValue) {
	return arrParams[strName] =  strValue;
}

function fn_ResultXlsExport(sParams)
{
	fv_isIfPage = true;

	var objBuffer = new Buffer;
	objBuffer.appendText("JSESSIONID=" + JSESSIONID); //세션공유를 위해 세션값 넘김	
	var sHeaders = "Content-Type: application/x-www-form-urlencoded";
	var strURL = application.services.get_item("svc").url + "common/FSC00080V_POI_Save.jsp?" + sParams;
	//trace(strURL);
	IfBrowser.Navigate2(strURL, "", "_self", objBuffer.data, sHeaders);
	
}

/**
 * WebBrowser에 표시된 파라미터를 설정한다.
 * @param obj WebBrowser
 * @param e WebLoadCompEventInfo
 * @return none
 */
function IfBrowser_DocumentComplete(obj:ActiveX, e)
{
	if (!fv_isIfPage) return;
	fv_isIfPage = false;
}
/*
 ******************************************************************************************
 * 함  수  명   : ds_input_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
 * 기      능   : 조회조건 변경시 조회조건 셋팅
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-02-14  
 ******************************************************************************************
 */
function ds_input_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if (e.columnid == "JOB")	// 직군변경시
	{
		if (gfn_length(e.newvalue)==0)
		{
			Copy(ds_SUB_JOB,ds_SUB_JOB1);
			cbo_SubJob.index = 0;
		}
		else
		{
			//SUB 직군코드
			fn_sql_common("C", strMAQuery_MASUBJOB,"","AND JOB_CD = '" + e.newvalue + "'ORDER BY SUB_JOB_CD","",cbo_SubJob,-1,ds_SUB_JOB);
			ds_SUB_JOB.insertRow(0);
			ds_SUB_JOB.setColumn(0,"SUB_JOB_NAME","전체");
			ds_SUB_JOB.setColumn(0,"SUB_JOB_CD","");
			cbo_SubJob.index = 0;
		}
	}
	
	// 양식조회
	if (e.columnid == "TABLE_TYPE" || e.columnid == "FROM_DT" || e.columnid == "TO_DT")
	{
		var strTableType	= ds_input.getColumn(e.row,"TABLE_TYPE");
		var strFromDt		= ds_input.getColumn(e.row,"FROM_DT");
		var strToDt			= ds_input.getColumn(e.row,"TO_DT");
		
		if (gfn_length(strTableType)!= 0 && gfn_length(strFromDt)!= 0 && gfn_length(strToDt)!= 0)
		{
			var straddWhere	=  "   AND   TABLE_TYPE ='" + strTableType + "' \n";
			straddWhere 	+= "   AND   ((START_DATE BETWEEN '" + strFromDt + "' AND '" + strToDt + "') \n";
			straddWhere 	+= "	OR (END_DATE BETWEEN '" + strFromDt + "' AND '" + strToDt + "') \n";
			straddWhere 	+= "	OR END_DATE IS NULL) \n";
			straddWhere 	+= " ORDER BY START_DATE DESC, FORM_CD";
			
			// 양식조회
			fn_sql_common("C", fstrQuery1,"",straddWhere,"",cbo_FORM_CD,-1,ds_FORM_CD);
	
			cbo_FORM_CD.index = 0;
			
			ds_CHECK_SABUN.clearData();
			fsp_clear(this);
			fsp_addSearch(this,"fs/fsc:FSC00080V_S001");
			fsp_callService(this,"","","ds_input=ds_input","ds_CHECK_SABUN=ds_list","","fn_callBackSearch");
			
		}
		else
		{
			ds_FORM_CD.clearData();
		}  
	}

	// 양식변경
	if (e.columnid == "FORM_CD" || e.columnid == "TABLE_TYPE")
	//if (e.columnid == "TABLE_TYPE")
	{
		var strFromCd = cbo_FORM_CD.value;
		
		if (gfn_length(strFromCd)==0)
		{
			ds_LRG_CLASS_CD.clearData();
			cbo_SubJob.index = 0;
		}
		else
		{
			//평가항목대분류
			var strTableType = ds_input.getColumn(0,"TABLE_TYPE");
			
			fn_sql_common("C", fstrQuery2,"   AND A.TABLE_TYPE = '" + strTableType + "'   AND A.FORM_CD = '" + strFromCd + "'","ORDER BY A.TABLE_TYPE,A.FORM_CD,A.CLASS_CD","",cbo_LRG_CLASS_CD,-1,ds_LRG_CLASS_CD);
			cbo_LRG_CLASS_CD.index = 0;
		}
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : btn_Date_OnClick(obj,nX,nY)
 * 기      능   : 달력
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-02-04  
 ******************************************************************************************
 */
function btn_Date_OnClick(obj:Button, e:ClickEventInfo)
{
	var objme = eval(obj.userdata);
	
	var retDate = gfn_dialog("", "U_SCC::SCC_CALENDAR.xfdl","fa_Date="+wrapQuote(objme.value),-1,-1,"Title=false Status=false");

	objme.value  = retDate;
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_TeamPopup
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 업장조회 팝업
 * 작  성  자   : 김동표
 * 작성  일자   : 2007-11-27
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_TeamPopup(obj:Button, e:ClickEventInfo)
{
	fn_sql_common_setup( strMAQuery_Team
						,strMAQuery_TeamKeyField
						,strMAQuery_TeamValueField
						,strMAQuery_TeamKeyFieldNM
						,strMAQuery_TeamValueFieldNM
						,""
						,""
						,"AND FS_UPJANG = 'Y'"
						,strMAQuery_TeamCaption
						,strMAQuery_TeamAllField
						);
						
	ds_input.setColumn(0,"TM_NM",gds_sql_common.getColumn(0, "ret_name"));
	ds_input.setColumn(0,"TM_CD",gds_sql_common.getColumn(0, "ret_code"));
}

/*
 ******************************************************************************************
 * 함  수  명   : btn_upjang_OnClick(obj)
 * 기      능   : 팝업버튼 클릭 -> 사업장 조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-03  
 ******************************************************************************************
 */
function btn_upjang_OnClick(obj:Button, e:ClickEventInfo)
{
// 	//[[As-Is 소스
// 	if (SCPopup.runTimeMode == "As-Is")
// 	{
		var strWhere;
		
		// 운영부서
		if (gfn_length(ds_input.getColumn(0,"TM_CD"))> 0)
		{
			strWhere = "  AND A.TM_CD ='" + ds_input.getColumn(0,"TM_CD") + "'";
		}
		// 직군
		if (gfn_length(cbo_JOB.value)>0)
		{
			strWhere += "  AND A.JOB_CD='" + cbo_JOB.value + "'";
		}
		// 상세직군
		if (gfn_length(cbo_SubJob.value)>0)
		{
			strWhere += "  AND A.SUB_JOB_CD='" + cbo_SubJob.value + "'";
		}
			
		fn_sql_common_setup( "SELECT A.UPJANG, A.UPJANGNM FROM MAC_UPJANG_V A WHERE (1=1)"
							,strQuery_UpjangKeyField
							,strQuery_UpjangValueField
							,strQuery_UpjangKeyFieldNM
							,strQuery_UpjangValueFieldNM
							,""
							,""
							,strWhere
							,strQuery_UpjangCaption
							,strQuery_UpjangAllField
							);
							
		ds_input.setColumn(0,"UPJANG_NM",gds_sql_common.getColumn(0, "ret_name"));
		ds_input.setColumn(0,"UPJANG",gds_sql_common.getColumn(0, "ret_code"));
// 	}
// 	//As-Is 소스]]
// 	//[[To-Be 소스
// 	else
// 	{
// 		var strWhere = {};
// 		
// 		// 운영부서
// 		if (gfn_length(ds_input.getColumn(0,"TM_CD"))> 0)
// 		{
// 			strWhere.tmCd = ds_input.getColumn(0,"TM_CD");
// 		}
// 		// 직군
// 		if (gfn_length(cbo_JOB.value)>0)
// 		{
// 			strWhere.jobCd = cbo_JOB.value;
// 		}
// 		// 상세직군
// 		if (gfn_length(cbo_SubJob.value)>0)
// 		{
// 			strWhere.subJobCd = cbo_SubJob.value;
// 		}
// 			
// 		fn_sql_common_setup( "MacUpjang"
// 							,strQuery_UpjangKeyField
// 							,strQuery_UpjangValueField
// 							,strQuery_UpjangKeyFieldNM
// 							,strQuery_UpjangValueFieldNM
// 							,""
// 							,""
// 							,strWhere
// 							,strQuery_UpjangCaption
// 							,strQuery_UpjangAllField
// 							);
// 							
// 		ds_input.setColumn(0,"UPJANG_NM",gds_sql_common.getColumn(0, "ret_name"));
// 		ds_input.setColumn(0,"UPJANG",gds_sql_common.getColumn(0, "ret_code"));
// 	}
// 	//To-Be 소스]]
}

/*
 ******************************************************************************************
 * 함  수  명   : ed_pop_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
 * 기      능   : 팝업edit키입력시
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-12-03  
 ******************************************************************************************
 */
function ed_pop_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if( e.keycode == 13 ) {
		if( gfn_length(gfn_trim(obj.value))== 0 ) {
			var objme = eval(obj.userdata);
			objme.click();
		}
	} else if( e.keycode == 46 ) {
		switch(obj.name) {
			case "ed_TM_NM" :
				ds_input.setColumn(0, "TM_CD", "");
				ds_input.setColumn(0, "TM_NM", "");
				break;
			case "ed_UPJANG_NM" :
				ds_input.setColumn(0, "UPJANG",    "");
				ds_input.setColumn(0, "UPJANG_NM", "");
				break;
			default :
				break;
		}
	}
}

/*
 ******************************************************************************************
 * 함  수  명   : common_chk_OnClick(obj,strValue)
 * 기      능   : 점검구분선택
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-26  
 ******************************************************************************************
 */
function common_chk_OnClick(obj:CheckBox, e:ClickEventInfo)
{
	var strCheckType = "";
	for(i = 1; i<= 4 ; i++)
	{
		if (eval("chk_CHECK_TYPE" + i).value)
		{
			strCheckType += " '" + eval("chk_CHECK_TYPE" + i).userdata + "' ";
		}
	}
	ds_input.setColumn(0,"CHECK_TYPE",gfn_replace(strCheckType,"'  '","','"));
}

 /******************************************************************************************
 * 함  수  명   : grd_list_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
 * 기      능   : 그리드를 펼침닫힘.
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-03  
 ******************************************************************************************
 */
function grd_list_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
// 	var nRowLevel = toNumber(ds_list.getColumn(e.row,"LEVEL_NO"));
// 	
// 	if (nRowLevel == 1)
// 	{
// 			if (onWork) return;
// 				
// 			onWork = true;
// 			gprGrdExpand(eval(obj.binddataset), e.row);
// 			onWork = false;	
// 	}
// 	else
// 	{
// 		fn_SearchSub(e.row);
// 	}

	if(e.clickitem == "image" || e.clickitem == "treebutton") return;

    var nRow = obj.getTreeRow(e.row);    
    if (obj.getTreeStatus(nRow) == 0 ) 
    {
        // 설정하고자 하는 TreeStatus.
        //  false : 해당 Row의 TreeStatus를 Collapse로 설정
        //  true  : 해당 Row의 TreeStatus를 Expand로 설정                
        obj.setTreeStatus(nRow, true);
    } else if (obj.getTreeStatus(nRow) == 1 ) {
        obj.setTreeStatus(nRow, false);
    }
    else
    {
		fn_SearchSub(e.row);
    }
	
	
}

/*
 ******************************************************************************************
 * 함  수  명   : grd_Detail_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
 * 기      능   : 사진팝업
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-20  
 ******************************************************************************************
 */
function grd_Detail_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	
}

/*
 ******************************************************************************************
 * 함  수  명   : btn_Chart_OnClick(obj)
 * 기      능   : 그래프팝업
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-20  
 ******************************************************************************************
 */
function btn_Chart_OnClick(obj:Button, e:ClickEventInfo)
{
	if (ds_list.getCountNF() == 0)
	{
		g_Message("EE", "데이터가 없습니다.");
		return;
	}
	gfn_dialog("", "U_FSC::FSC00081P.xfdl","");
}

function fn_GetDrillDownImg(BL_PLUS, BG)
{
	if (BL_PLUS == "+")
	{
		if(BG == "1")
			return "#ffffffff URL(" + "'theme://images/new/grd_WF_Plusbtn.png'" + ") center middle";
		else if(BG == "2")
			return "#e4e4e4ff URL(" + "'theme://images/new/grd_WF_Plusbtn.png'" + ") center middle";
		else if(BG == "3")
			return "#24a3a8ff URL(" + "'theme://images/new/grd_WF_Plusbtn.png'" + ") center middle";
			
	}
	else if (BL_PLUS == "-")
	{
		if(BG == "1")
			return "#ffffffff URL(" + "'theme://images/new/grd_WF_Minusbtn.png'" + ") center middle";
		else if(BG == "2")
			return "#e4e4e4ff URL(" + "'theme://images/new/grd_WF_Minusbtn.png'" + ") center middle";
		else if(BG == "3")	
			return "#24a3a8ff URL(" + "'theme://images/new/grd_WF_Minusbtn.png'" + ") center middle";
	}
	else		
		return "default";
}

function grd_Detail_onexpanddown(obj:Grid, e:GridMouseEventInfo)
{
	ds_Detail.rowposition = e.row;
	
	if (e.cell == 14)
	{
		var TABLE_TYPE = ds_Detail.getColumn(e.row, "TABLE_TYPE");
		var FORM_CD = ds_Detail.getColumn(e.row, "FORM_CD");
		var UPJANG = ds_Detail.getColumn(e.row, "UPJANG");
		var CHECK_DATE = ds_Detail.getColumn(e.row, "CHECK_DATE");
		var CLASS_CD = ds_Detail.getColumn(e.row, "CLASS_CD");
		
		var sParam = {
			  TABLE_TYPE:TABLE_TYPE
			, FORM_CD:FORM_CD
			, UPJANG:UPJANG
			, CHECK_DATE:CHECK_DATE
			, CLASS_CD:CLASS_CD
		};
		var vRtn = gfn_dialog("", "U_FSC::FSC00513P.xfdl", sParam);	
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_muChange(obj, event)
 * 기ㅡㅡㅡ능 : 사업부 변경시 운영부서, 사업장 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function fn_muChange(obj, event)
{
	edt_tm.setTmCode("");
	cbo_JOB.value = "";
    cbo_SubJob.value = "";
    edt_upjang.setUpjangCode("");
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_tmChange(obj, data)
 * 기ㅡㅡㅡ능 : 운영부서 변경시 사업장 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function fn_tmChange(obj, data)
{
    cbo_JOB.value = "";
    cbo_SubJob.value = "";
    edt_upjang.setUpjangCode("");
}

//2019.01.23 김명섭 조회일자 Set 조건 추가(금년,전년)
function rd_SelType_onitemchanged(obj:Radio, e:ItemChangeEventInfo)
{
	var strDt = fn_CurrDateWeek();
	//금년
	if(rd_SelType.value == "N")
	{
		ds_input.setColumn(0,"FROM_DT",gfn_left(strDt,4)+"0101");
		ds_input.setColumn(0,"TO_DT",strDt);
	}
	//전년
	if(rd_SelType.value == "B")
	{
		var strTodt = gfn_addMonth(strDt,-12)
		ds_input.setColumn(0,"FROM_DT",gfn_left(strTodt,4)+"0101");
		ds_input.setColumn(0,"TO_DT",gfn_left(strTodt,4)+"1231");
	}
	//rd_SelType.value = "";
}

function btn_Excel_OnClick(obj:Button,  e:ClickEventInfo)
{  
	if(gfn_getDiffMonth(me_FROM_DT.value, me_TO_DT.value) >= 3)
	{
		gfn_alert("3개월을 초과하여 다운로드하실 수 없습니다.");
		return;
	}     
		
	if(ds_list.getRowCount() == 0){ 		
		g_Message("EE", "평가항목 데이터가 없습니다.");
		return;
	} 
	fn_SearchSuball(1);	
}

function fn_SearchSuball(nRow)
{
	// 초기화
	ds_Detailall.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg,callBackFnc;
	
	ds_input.setColumn(0,"CLASS_CD",ds_list.getColumn(nRow,"PL_CD"));
	
	actionName		= "FSC00080V_T003";
	cmdName			= "U_svc::" + "fs/fsc/FSC00080V_T003.jsp";
	inData			= "ds_input=ds_input";
	outData			= "ds_Detailall=ds_list";
	callBackFnc		= "fn_callBack";
	
	jsp_transaction(this,actionName, cmdName ,inData ,outData,otherArg,callBackFnc,true,false,false);
}

function grd_Detailall_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{	
		gfn_exportExcel(obj, this.titletext);
}

function fn_callBack(errCode, errMsg)
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오");
		return;
	}	

	if(ds_Detailall.getRowCount() == 0){ 		
		g_Message("EE", "데이터가 없습니다.");
		return;
	} 
	
	gfn_exportExcel(grd_Detailall, "Sheet1");
}]]></Script>
  </Form>
</FDL>

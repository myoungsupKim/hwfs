<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="FSC00400E" classname="SAMPLE01" inheritanceid="" position="absolute 0 0 1252 725" titletext="CS진단 양식관리" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="1" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static22" text="대분류" class="sta_WF_Title01" position="absolute 0 269 450 287" anchor="left top"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 282 1237 287" anchor="left top"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 93 40" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 93 71" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static19" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 997 84"/>
        <Grid id="grd_hlClassList" taborder="4" useinputpanel="false" position="absolute 0 287 689 482" binddataset="ds_hlClassList" autofittype="col" autoenter="select">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30"/>
                <Column size="80"/>
                <Column size="190"/>
                <Column size="40"/>
                <Column size="70"/>
                <Column size="0"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="코드"/>
                <Cell col="2" text="대분류명"/>
                <Cell col="3" text="테마"/>
                <Cell col="4" text="총점"/>
                <Cell col="5" text="중점항목"/>
                <Cell col="6" text="최종수정일"/>
              </Band>
              <Band id="body">
                <Cell text="expr:rowidx+1"/>
                <Cell col="1" text="bind:CLASS_CD"/>
                <Cell col="2" displaytype="text" edittype="text" text="bind:CLASS_NM" editautoselect="true"/>
                <Cell col="3" displaytype="checkbox" edittype="checkbox" text="bind:FOCS_ARTICLE_YN"/>
                <Cell col="4" displaytype="number" edittype="none" text="bind:TOT_SCORE" mask="###.#"/>
                <Cell col="5" displaytype="checkbox" edittype="checkbox" text="bind:FOCS_ARTICLE_YN" editautoselect="true"/>
                <Cell col="6" displaytype="date" text="bind:UDATE" calendardisplaynulltype="none"/>
              </Band>
              <Band id="summary">
                <Cell colspan="3" style="align:center;" text="합계" taborder="undefined"/>
                <Cell col="3"/>
                <Cell col="4" displaytype="number" text="expr:getSum('TOT_SCORE')"/>
                <Cell col="5"/>
                <Cell col="6"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static00" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 270 40 300 61" anchor="left top"/>
        <Combo id="cbo_tableType" taborder="8" innerdataset="@ds_cboTableType" codecolumn="CODE" datacolumn="CODE_NAME" onitemchanged="Combo00_onitemchanged" position="absolute 96 40 270 61" index="-1"/>
        <Static id="Static03" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 86 40 96 61" anchor="left top"/>
        <Static id="Static01" text="진단표구분" class="sta_WFSA_label" position="absolute 15 40 88 61" anchor="left top"/>
        <Static id="Static02" text="중분류" class="sta_WF_Title01" position="absolute 699 269 1149 287" anchor="left top"/>
        <Grid id="grd_hmClassList" taborder="9" binddataset="ds_hmClassList" useinputpanel="false" autofittype="col" position="absolute 699 287 1237 482" anchor="left top right" autoenter="select">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30"/>
                <Column size="80"/>
                <Column size="260"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="코드"/>
                <Cell col="2" text="중분류명"/>
                <Cell col="3" text="관리항목"/>
                <Cell col="4" text="관리건수"/>
                <Cell col="5" text="최종수정일"/>
              </Band>
              <Band id="body">
                <Cell text="expr:rowidx+1"/>
                <Cell col="1" text="bind:CLASS_CD"/>
                <Cell col="2" displaytype="text" edittype="text" text="bind:CLASS_NM" editautoselect="true"/>
                <Cell col="3" displaytype="checkbox" edittype="checkbox" text="bind:FOCS_ARTICLE_YN"/>
                <Cell col="4" displaytype="number" text="bind:MGMT_CNT"/>
                <Cell col="5" displaytype="date" text="bind:UDATE" calendardisplaynulltype="none"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static11" text="소분류" class="sta_WF_Title01" position="absolute 0 495 450 513" anchor="left top"/>
        <Grid id="grd_hsClassList" taborder="10" binddataset="ds_hsClassList" useinputpanel="false" autofittype="col" position="absolute 0 513 1237 710" anchor="all" autoenter="select" ontextchange="grd_hsClassList_ontextchange">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30"/>
                <Column size="80"/>
                <Column size="500"/>
                <Column size="70"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="코드"/>
                <Cell col="2" text="소분류명"/>
                <Cell col="3" text="우수점수"/>
                <Cell col="4" text="최종수정일"/>
              </Band>
              <Band id="body">
                <Cell text="expr:rowidx+1"/>
                <Cell col="1" text="bind:CLASS_CD"/>
                <Cell col="2" displaytype="text" edittype="text" text="bind:CLASS_NM" editautoselect="true"/>
                <Cell col="3" displaytype="number" edittype="masknumber" text="bind:CHK_IDCTR" mask="##0.#" editautoselect="true"/>
                <Cell col="4" displaytype="date" text="bind:UDATE" calendardisplaynulltype="none"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static28" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 689 256 699 482"/>
        <Static id="Static09" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 508 1237 513" anchor="left top"/>
        <Static id="Static12" text="진단표 양식" class="sta_WF_Title01" position="absolute 0 84 450 102" anchor="left top"/>
        <Static id="Static13" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 97 1237 102" anchor="left top"/>
        <Grid id="grd_tableList" taborder="16" binddataset="ds_tableList" useinputpanel="false" autofittype="col" position="absolute 0 102 1237 256" autoenter="select" anchor="left top right" oncelldblclick="grd_tableList_oncelldblclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="20"/>
                <Column size="80"/>
                <Column size="250"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="진단표구분"/>
                <Cell col="2" class="grd_WF_Essential" text="양식명"/>
                <Cell col="3" class="grd_WF_Essential" text="사용시작일"/>
                <Cell col="4" text="사용종료일"/>
                <Cell col="5" text="최종수정일"/>
                <Cell col="6" text="결과건수"/>
                <Cell col="7" text="사용여부"/>
              </Band>
              <Band id="body">
                <Cell text="expr:rowidx+1"/>
                <Cell col="1" displaytype="combo" edittype="expr:ds_tableList.getColumn(ds_tableList.rowposition, &quot;FORM_CD&quot;)!=null?&quot;&quot;:&quot;combo&quot;" style="align:left;" text="bind:TABLE_TYPE" combodataset="ds_cboGrdTableType" combocodecol="CODE" combodatacol="CODE_NAME"/>
                <Cell col="2" displaytype="text" edittype="text" text="bind:FORM_NM" editimemode="hangul"/>
                <Cell col="3" displaytype="date" edittype="date" text="bind:START_DD" calendardisplaynulltype="none"/>
                <Cell col="4" displaytype="date" edittype="date" text="bind:END_DD" calendardisplaynulltype="none"/>
                <Cell col="5" displaytype="date" text="bind:UDATE" calendardisplaynulltype="none"/>
                <Cell col="6" text="bind:RESULT_CNT"/>
                <Cell col="7" displaytype="combo" edittype="combo" text="bind:USE_YN" combodataset="ds_cboUseYn" combocodecol="CODE" combodatacol="CODE_NAME"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static20" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 256 450 269" anchor="left top"/>
        <Static id="Static10" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 482 739 495" anchor="left top"/>
        <Static id="Static14" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1179 256 1237 262" anchor="top right"/>
        <Button id="btn_addHmClass" taborder="20" class="btn_WF_GrdPlus" position="absolute 1199 262 1217 282" anchor="top right" userdata="M" onclick="fn_addCode"/>
        <Button id="btn_delHmClass" taborder="21" class="btn_WF_GrdMinus" position="absolute 1219 262 1237 282" anchor="top right" userdata="M" onclick="fn_deleteCode"/>
        <Static id="Static15" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1217 262 1219 282" anchor="top right"/>
        <Static id="Static18" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 631 256 689 262" anchor="default"/>
        <Button id="btn_addHlClass" taborder="23" class="btn_WF_GrdPlus" position="absolute 651 262 669 282" anchor="default" onclick="fn_addCode" userdata="L"/>
        <Button id="btn_delHlClass" taborder="24" class="btn_WF_GrdMinus" position="absolute 671 262 689 282" anchor="default" onclick="fn_deleteCode" userdata="L"/>
        <Static id="Static21" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 669 262 671 282" anchor="default"/>
        <Static id="Static25" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1179 482 1237 488" anchor="default"/>
        <Button id="btn_addHsClass" taborder="26" class="btn_WF_GrdPlus" position="absolute 1199 488 1217 508" anchor="top right" userdata="S" onclick="fn_addCode"/>
        <Button id="btn_delHsClass" taborder="27" class="btn_WF_GrdMinus" position="absolute 1219 488 1237 508" anchor="top right" userdata="S" onclick="fn_deleteCode"/>
        <Static id="Static30" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1217 488 1219 508" anchor="default"/>
        <Static id="Static37" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1179 71 1237 77" anchor="top right"/>
        <Button id="btn_copyTable" taborder="28" text="양식복사" class="btn_WF_Function" position="absolute 1172 77 1237 97" anchor="top right" onclick="btn_copyTable_onclick"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_hlClassList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_hlClassList_onrowposchanged">
        <ColumnInfo>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="CLASS_CD" type="STRING" size="256"/>
          <Column id="CLASS_NM" type="STRING" size="256"/>
          <Column id="CLASS_TYPE" type="STRING" size="256"/>
          <Column id="FOCS_ARTICLE_YN" type="STRING" size="256"/>
          <Column id="TOT_SCORE" type="INT" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="UUSER" type="STRING" size="256"/>
          <Column id="UDATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_hmClassList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_hmClassList_onrowposchanged">
        <ColumnInfo>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="CLASS_CD" type="STRING" size="256"/>
          <Column id="CLASS_NM" type="STRING" size="256"/>
          <Column id="CLASS_TYPE" type="STRING" size="256"/>
          <Column id="FOCS_ARTICLE_YN" type="STRING" size="256"/>
          <Column id="MGMT_CNT" type="INT" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="UUSER" type="STRING" size="256"/>
          <Column id="UDATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_hsClassList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="CLASS_CD" type="STRING" size="256"/>
          <Column id="CLASS_NM" type="STRING" size="256"/>
          <Column id="CLASS_TYPE" type="STRING" size="256"/>
          <Column id="HL_CLASS_CD" type="STRING" size="256"/>
          <Column id="HL_CLASS_NM" type="STRING" size="256"/>
          <Column id="HM_CLASS_CD" type="STRING" size="256"/>
          <Column id="HM_CLASS_NM" type="STRING" size="256"/>
          <Column id="CHK_IDCTR" type="STRING" size="256"/>
          <Column id="NOT_FIT_SCORE" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="UUSER" type="STRING" size="256"/>
          <Column id="UDATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_tableList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="FORM_NM" type="STRING" size="256"/>
          <Column id="START_DD" type="STRING" size="256"/>
          <Column id="END_DD" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="RESULT_CNT" type="INT" size="256"/>
          <Column id="CUSER" type="STRING" size="256"/>
          <Column id="CDATE" type="STRING" size="256"/>
          <Column id="UUSER" type="STRING" size="256"/>
          <Column id="UDATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboTableType">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboUseYn" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">Y</Col>
            <Col id="CODE_NAME">사용</Col>
          </Row>
          <Row>
            <Col id="CODE">N</Col>
            <Col id="CODE_NAME">미사용</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_cboGrdTableType">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_tableListValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="TABLE_TYPE_NM" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="FORM_NM" type="STRING" size="256"/>
          <Column id="START_DD" type="STRING" size="256"/>
          <Column id="END_DD" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="CUSER" type="STRING" size="256"/>
          <Column id="CDATE" type="STRING" size="256"/>
          <Column id="UUSER" type="STRING" size="256"/>
          <Column id="UDATE" type="STRING" size="256"/>
          <Column id="Column0" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="TABLE_TYPE">title:진단표구분,required:true</Col>
            <Col id="FORM_NM">title:양식명,required:true</Col>
            <Col id="TABLE_TYPE_NM"/>
            <Col id="END_DD">title:사용종료일,comparemax:START_DD:사용시작일</Col>
            <Col id="START_DD">title:사용시작일,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_classList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_hsClassList_onrowposchanged">
        <ColumnInfo>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="CLASS_CD" type="STRING" size="256"/>
          <Column id="CLASS_NM" type="STRING" size="256"/>
          <Column id="CLASS_TYPE" type="STRING" size="256"/>
          <Column id="FOCS_ARTICLE_YN" type="STRING" size="256"/>
          <Column id="HL_CLASS_CD" type="STRING" size="256"/>
          <Column id="HL_CLASS_NM" type="STRING" size="256"/>
          <Column id="HM_CLASS_CD" type="STRING" size="256"/>
          <Column id="HM_CLASS_NM" type="STRING" size="256"/>
          <Column id="CHK_IDCTR" type="STRING" size="256"/>
          <Column id="NOT_FIT_SCORE" type="STRING" size="256"/>
          <Column id="MGMT_CNT" type="STRING" size="256"/>
          <Column id="TOT_SCORE" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="UUSER" type="STRING" size="256"/>
          <Column id="UDATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="cbo_tableType" propid="value" datasetid="ds_cond" columnid="TABLE_TYPE"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";

/******************************************************************************************
 * 시스템구분 : 위생관리/CS진단관리
 * 프로그램명 : FSC00400E.XML
 * 기ㅡㅡㅡ능 : CS진단양식관리
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************/
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var isCopyMode = false;   // 양식복사 모드 여부

//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(this);

	// X-Framework : Action 정보 생성
	fsp_init(this);
	
	// 검색조건 ComboBox Setting
	fn_setComboBox();
	
	// 조회조건 DataSet 초기화
	ds_cond.clearData();
	ds_cond.addRow();
	ds_cond.setColumn(0, "TABLE_TYPE",  "");
	cbo_tableType.index = 0;
	
	// 분류 추가, 삭제버튼 비활성화
	fn_enableBtn(false);
}

/******************************************************************************************
 * 함  수  명   : function fn_setComboBox() 
 * 기      능   : 검색조건 ComboBox Setting
 * 작  성  자   : 김민수
 * 작성  일자   : 2015-02-02  
 ******************************************************************************************/
function fn_setComboBox() 
{
	//공통코드조회
	var objCode = fn_common_code("'FS0103'","","","","Y");

	// 점검표구분
	var sCond = "GROUP_CODE == 'FS0103'";
	objCode.filter(sCond);
	CopyF(ds_cboTableType, objCode.name);
	
	// 그리드 점검표 구분
	sCond = "GROUP_CODE == 'FS0103' && CODE != null";
	objCode.filter(sCond);
	CopyF(ds_cboGrdTableType, objCode.name);
}

//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,출력)
//
//=========================================================================================
/******************************************************************************************
 * 함  수  명   : fn_search()
 * 기      능   : 조회
 * 작  성  자   : 김민수
 * 작성  일자   : 2015-02-02  
 ******************************************************************************************/
function fn_search() 
{
	var strMsg = "변경된 내역이 있습니다. 저장하시겠습니까?";

	// 변경 데이터 체크
	if(gfn_dsIsUpdated(ds_tableList) || gfn_dsIsUpdated(ds_hlClassList) || gfn_dsIsUpdated(ds_hmClassList) && gfn_dsIsUpdated(ds_hsClassList))
	{
		if (g_Confirm("02",strMsg))
		{
			fn_save();
			return;
		}
	}
	
	fsp_clear(this);
	
	fn_changeCopyMode(false);
	
	// 양식, 대분류, 중분류, 소분류, 평가항목 초기화	
	ds_tableList.clearData();
	ds_hlClassList.clearData();
	ds_hmClassList.clearData();
	ds_hsClassList.clearData();
	
	fsp_addSearch(this,"fs/fsc:FSC00400E_S001");
	fsp_callService(this,"","","ds_cond=ds_cond","ds_tableList=ds_list","","fn_callBackSearch");
}

function fn_callBackSearch() 
{
	fn_enableBtn(false);
}

/******************************************************************************************
 * 함  수  명   : fn_insert()
 * 기      능   : 입력
 * 작  성  자   : 김민수
 * 작성  일자   : 2015-02-02  
 ******************************************************************************************/
function fn_insert() 
{
	// 양식, 대분류, 중분류, 소분류, 평가항목 초기화	
	ds_tableList.clearData();
	ds_hlClassList.clearData();
	ds_hmClassList.clearData();
	ds_hsClassList.clearData();

	ds_tableList.addRow();
	ds_tableList.setColumn(ds_tableList.rowposition, "TABLE_TYPE", ds_cond.getColumn(0, "TABLE_TYPE"));
	ds_tableList.setColumn(ds_tableList.rowposition, "USE_YN", "N");
	fn_enableBtn(true);
}

/******************************************************************************************
 * 함  수  명   : fn_delete()
 * 기      능   : 삭제
 * 작  성  자   : 김민수
 * 작성  일자   : 2015-02-02  
 ******************************************************************************************/
function fn_delete() 
{
	var nRow = ds_tableList.rowposition;
	
	// 등록된 양식이 아닐경우 초기화
	if (ds_tableList.getRowType(nRow) == 2) 
	{
		if (!confirm("등록 중인 양식을 삭제하시겠습니다.", "확인", "default")) return;
		ds_tableList.clearData();
		ds_hlClassList.clearData();
		ds_hmClassList.clearData();
		ds_hsClassList.clearData();
		return;
	}

	// 양식 선택 체크
	if (nRow == -1)
	{
		g_Message("EE", "양식을 선택해주세요.");
		return false;
	}
	
	if (ds_tableList.getColumn(nRow,"RESULT_CNT") > 0)
	{
		g_Message("EE", "해당 양식의 점검결과가 등록되어있어 삭제가 불가합니다.");
		return;
	}	

	
	if (!confirm("[" + ds_tableList.getColumn(nRow,"FORM_NM") + "] 점검표를 삭제하시겠습니까?", "확인", "default")) return;
	
	ds_tableList.deleteRow(nRow);
	
	jsp_transaction(
		  this                                 // 해당 스크립트를 호출하는 Form 객체
		, "FSC00400E_T002"                     // 서비스 ID
		, "U_svc::fs/fsc/FSC00400E_T002.jsp"   // 서비스 URL
		, "ds_tableList=ds_tableList:U"        // 서버로 전송할 DataSet 객체 Str
		, ""                                   // 서버로부터 전송 받을 DataSet 객체 String
		, ""                                   // 서버로 전송할 기타 Argument 정보 String
		, "fn_callBackDelete"                  // 서버에서 처리가 완료된 후 Callback 받을 Function 명
		, true                                 // 에러 발생 시 Callback 함수 호출 여부
		, false                                // 처리중입니다. 메시지 창 보여줄지 여부 설정하기
		, false                                // 동기식으로 설정할지 여부
	);
}

function fn_callBackDelete(errCode, errMsg) 
{
	fn_search();
}

/******************************************************************************************
 * 함  수  명   : fn_save(obj , e)
 * 기      능   : 저장
 * 작  성  자   : 김민수
 * 작성  일자   : 2015-02-02  
 ******************************************************************************************/
function fn_save() 
{
	// 양식 선택 체크
	if (ds_tableList.rowposition == -1)
	{
		g_Message("EE", "양식을 선택해주세요.");
		return false;
	}

	// 변경 데이터 체크
	if((!gfn_dsIsUpdated(ds_tableList)) && (!gfn_dsIsUpdated(ds_hlClassList)) && (!gfn_dsIsUpdated(ds_hmClassList)) && (!gfn_dsIsUpdated(ds_hsClassList)))
	{
		g_Message("EE", "변경된 데이터가 없습니다.");
		return false;
	}

	// 유효성 검사
	if (gfn_validCheck(ds_tableList, ds_tableListValid, true) == false) return;

	if (!confirm("점검표를 저장하시겠습니까?", "확인", "default")) return;
	
	jsp_transaction(
		  this                                 // 해당 스크립트를 호출하는 Form 객체
		, "FSC00400E_T001"                     // 서비스 ID
		, "U_svc::fs/fsc/FSC00400E_T001.jsp"   // 서비스 URL
		, "ds_tableList=ds_tableList:U ds_hlClassList=ds_hlClassList:U ds_hmClassList=ds_hmClassList:U ds_hsClassList=ds_hsClassList:U"    // 서버로 전송할 DataSet 객체 Str
		, ""                                   // 서버로부터 전송 받을 DataSet 객체 String
		, ""                                   // 서버로 전송할 기타 Argument 정보 String
		, "fn_callBackSave"                    // 서버에서 처리가 완료된 후 Callback 받을 Function 명
		, true                                 // 에러 발생 시 Callback 함수 호출 여부
		, true                                 // 처리중입니다. 메시지 창 보여줄지 여부 설정하기
		, true                                 // 동기식으로 설정할지 여부
	);

}

function fn_callBackSave() 
{
	fn_search();
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/******************************************************************************************
 * 함  수  명   : fn_resetClass(nRow)
 * 기      능   : 분류코드 조회
 * 작  성  자   : 김민수
 * 작성  일자   : 2015-02-02  
 ******************************************************************************************/
function fn_resetClass(nRow)
{
	ds_cond.setColumn(0, "TABLE_TYPE", ds_tableList.getColumn(nRow, "TABLE_TYPE"));
	ds_cond.setColumn(0, "FORM_CD", ds_tableList.getColumn(nRow, "FORM_CD"));

	// 대분류, 중분류, 소분류, 평가항목 초기화
	ds_hlClassList.clearData();
	ds_hmClassList.clearData();
	ds_hsClassList.clearData();

	fsp_clear(this);
	// 분류정보 조회
	fsp_addSearch(this,"fs/fsc:FSC00400E_S002");
	fsp_callService(this,"","","ds_cond=ds_cond","ds_classList=ds_classList","","fn_afterSearch");
	
	if (ds_tableList.getColumn(nRow, "RESULT_CNT") > 0) 
	{
		fn_enableBtn(false);
	} 
	else 
	{
		fn_enableBtn(true);	
	}
}

/******************************************************************************************
 * 함  수  명   : fn_enableBtn(bEdit)
 * 기      능   : 추가, 삭제버튼 enable 제어
 * 작  성  자   : 김민수
 * 작성  일자   : 2015-02-02  
 ******************************************************************************************/
function fn_enableBtn(bEdit)
{
	btn_addHlClass.enable = bEdit;
	btn_addHmClass.enable = bEdit;
	btn_addHsClass.enable = bEdit;

	btn_delHlClass.enable = bEdit;
	btn_delHmClass.enable = bEdit;
	btn_delHsClass.enable = bEdit;
}

/******************************************************************************************
 * 함  수  명   : fn_changeCopyMode(bCopy)
 * 기      능   : 복사 모드 변경
 * 작  성  자   : 김민수
 * 작성  일자   : 2015-02-04
 ******************************************************************************************/
function fn_changeCopyMode(bCopy)
{
	if (bCopy == true) 
	{
		isCopyMode = bCopy;
		btn_copyTable.text = "복사취소";
	}
	else
	{
		isCopyMode = bCopy;
		btn_copyTable.text = "양식복사";		
	}
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
/******************************************************************************************
 * 함  수  명   : fn_addCode(obj , e)
 * 기      능   : 그리드 행 추가
 * 작  성  자   : 김민수
 * 작성  일자   : 2015-02-02  
 ******************************************************************************************/
function fn_addCode(obj:Button,  e:ClickEventInfo)
{
	var nRow;
	var nClassRow;
	
	if (obj.userdata == 'L')
	{
		// 양식(FORM) 선택여부 체크
		nRow = ds_tableList.rowposition;
		if (nRow < 0)
		{
			gfn_message("A", "양식을 선택해 주십시오. (양식 저장 후 입력이 가능합니다.)");
			return;
		}
		
		strCode = ds_hlClassList.getMax("CLASS_CD");
		strCode = isNaN( strCode ) ? 1000000 : toNumber(strCode) + 1000000;

		nClassRow = ds_hlClassList.addRow();
		ds_hlClassList.setColumn(nClassRow,"TABLE_TYPE", ds_tableList.getColumn(nRow, "TABLE_TYPE"));
		ds_hlClassList.setColumn(nClassRow,"FORM_CD", ds_tableList.getColumn(nRow, "FORM_CD"));
		ds_hlClassList.setColumn(nClassRow,"CLASS_CD", gfn_lPad(strCode, "0", 8));
		ds_hlClassList.setColumn(nClassRow,"CLASS_TYPE", obj.userdata);
		ds_hlClassList.setColumn(nClassRow,"FOCS_ARTICLE_YN", 0);
	}
	else if (obj.userdata == 'M')
	{
		// 대분류 선택여부 체크
		nRow = ds_hlClassList.rowposition;
		if (nRow < 0)
		{
			gfn_message("A", "대분류를 선택해 주십시오.");
			return;
		}
		
		strCode = ds_hmClassList.getMax("CLASS_CD");
		strCode = isNaN(strCode) ? "0" : strCode;
		strCode = toNumber(ds_hlClassList.getColumn(nRow,"CLASS_CD")) + toNumber(gfn_right(strCode, 6)) + 1000;

		nClassRow = ds_hmClassList.addRow();
		ds_hmClassList.setColumn(nClassRow,"TABLE_TYPE", ds_hlClassList.getColumn(nRow, "TABLE_TYPE"));
		ds_hmClassList.setColumn(nClassRow,"FORM_CD", ds_hlClassList.getColumn(nRow, "FORM_CD"));
		ds_hmClassList.setColumn(nClassRow,"CLASS_CD", gfn_lPad(strCode, "0", 8));
		ds_hmClassList.setColumn(nClassRow,"CLASS_TYPE", obj.userdata);
		ds_hmClassList.setColumn(nClassRow,"MGMT_CNT", 0);
	}
	else if (obj.userdata == 'S')
	{
		// 중분류 선택여부 체크
		nRow = ds_hmClassList.rowposition;
		if (nRow < 0)
		{
			gfn_message("A", "중분류를 선택해 주십시오.");
			return;
		}
		
		strCode = ds_hsClassList.getMax("CLASS_CD");
		strCode = isNaN(strCode) ? "0" : strCode;
		strCode = toNumber(ds_hmClassList.getColumn(nRow,"CLASS_CD")) + toNumber(gfn_right(strCode, 3)) + 1;
		
		nClassRow = ds_hsClassList.addRow();
		ds_hsClassList.setColumn(nClassRow,"TABLE_TYPE", ds_hmClassList.getColumn(nRow, "TABLE_TYPE"));
		ds_hsClassList.setColumn(nClassRow,"FORM_CD", ds_hmClassList.getColumn(nRow, "FORM_CD"));
		ds_hsClassList.setColumn(nClassRow,"CLASS_CD", gfn_lPad(strCode, "0", 8));
		ds_hsClassList.setColumn(nClassRow,"CLASS_TYPE", obj.userdata);
		ds_hsClassList.setColumn(nClassRow,"HL_CLASS_CD", ds_hlClassList.getColumn(ds_hlClassList.rowposition,"CLASS_CD"));
		ds_hsClassList.setColumn(nClassRow,"HL_CLASS_NM", ds_hlClassList.getColumn(ds_hlClassList.rowposition,"CLASS_NM"));
		ds_hsClassList.setColumn(nClassRow,"HM_CLASS_CD", ds_hmClassList.getColumn(nRow,"CLASS_CD"));
		ds_hsClassList.setColumn(nClassRow,"HM_CLASS_NM", ds_hmClassList.getColumn(nRow,"CLASS_NM"));
		ds_hsClassList.setColumn(nClassRow,"CHK_IDCTR", "0");
		ds_hsClassList.setColumn(nClassRow,"NOT_FIT_SCORE", "0");
	}
}

/******************************************************************************************
 * 함  수  명   : fn_deleteCode(obj , e)
 * 기      능   : 그리드 행 삭제
 * 작  성  자   : 김민수
 * 작성  일자   : 2015-02-02  
 ******************************************************************************************/
function fn_deleteCode(obj:Button,  e:ClickEventInfo)
{
	var objDs;
	
	if (obj.userdata == 'L')
	{
		if (ds_hmClassList.rowcount > 0)
		{
			alert("하위코드가 있습니다. 확인해 주십시오.", "Information", "information");
			return;
		}
		objDs = ds_hlClassList;
	}
	else if (obj.userdata == 'M')
	{
		if (ds_hsClassList.rowcount > 0)
		{
			alert("하위코드가 있습니다. 확인해 주십시오.", "Information", "information");
			return;
		}
		objDs = ds_hmClassList;
	}
	else if (obj.userdata == 'S')
	{
		objDs = ds_hsClassList;
	}
	
	objDs.deleteRow(objDs.rowposition);
}

/******************************************************************************************
 * 함  수  명   : ds_aclass_onrowposchanged(obj , e)
 * 기      능   : 대분류 선택 변경시 중분류, 소분류, 평가항목 필터링
 * 작  성  자   : 김민수
 * 작성  일자   : 2015-02-02  
 ******************************************************************************************/
function ds_hlClassList_onrowposchanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	ds_hmClassList.filter("gfn_subStr(CLASS_CD,0,2)==" + wrapQuote(gfn_subStr(ds_hlClassList.getColumn(e.newrow,"CLASS_CD"),0,2)));	
	ds_hsClassList.filter("gfn_subStr(CLASS_CD,0,5)==" + wrapQuote(gfn_subStr(ds_hmClassList.getColumn(ds_hmClassList.rowposition,"CLASS_CD"),0,5)));
	
	// 선택 변경시 선택위치 초기화
	ds_hmClassList.rowposition = 0;
	ds_hsClassList.rowposition = 0;
}

/******************************************************************************************
 * 함  수  명   : ds_bclass_onrowposchanged(obj , e)
 * 기      능   : 중분류 선택 변경시 소분류, 평가항목 필터링
 * 작  성  자   : 김민수
 * 작성  일자   : 2015-02-02  
 ******************************************************************************************/
function ds_hmClassList_onrowposchanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	ds_hsClassList.filter("gfn_subStr(CLASS_CD,0,5)==" + wrapQuote(gfn_subStr(ds_hmClassList.getColumn(e.newrow,"CLASS_CD"),0,5)));
	
	// 선택 변경시 선택위치 초기화
	ds_hsClassList.rowposition = 0;
}

/******************************************************************************************
 * 함  수  명   : grd_tblFormList_oncelldblclick(obj , e)
 * 기      능   : 양식 더블클릭시 분류값 조회
 * 작  성  자   : 김민수
 * 작성  일자   : 2015-02-02  
 ******************************************************************************************/
function grd_tableList_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	var strMsg = "변경된 내역이 있습니다. 저장하시겠습니까?";

	// 변경 데이터 체크
	if(gfn_dsIsUpdated(ds_tableList) || gfn_dsIsUpdated(ds_hlClassList) || gfn_dsIsUpdated(ds_hmClassList) && gfn_dsIsUpdated(ds_hsClassList))
	{
		if (g_Confirm("02",strMsg))
		{
			fn_save();
			return;
		}
	}

	fn_resetClass(obj.currentrow);
}

/******************************************************************************************
 * 함  수  명   : fn_afterSearch(errCode, errMsg)
 * 기      능   : 양식 조회 후 분류 필터링 처리
 * 작  성  자   : 김민수
 * 작성  일자   : 2015-02-02  
 ******************************************************************************************/
function fn_afterSearch(errCode, errMsg)
{
	if(errCode!=0)
	{
		alert("서비스 오류:시스템 관리자에게 문의하십시오!", "Error", "error")
		return;
	}
	
	ds_classList.filter("CLASS_TYPE=='L'");
	CopyF(ds_hlClassList,ds_classList);
	ds_classList.filter("CLASS_TYPE=='M'");
	CopyF(ds_hmClassList,ds_classList);
	ds_classList.filter("CLASS_TYPE=='S'");
	CopyF(ds_hsClassList,ds_classList);
	
	ds_hmClassList.filter("gfn_subStr(CLASS_CD,0,2)==" + wrapQuote(gfn_subStr(ds_hlClassList.getColumn(0,"CLASS_CD"),0,2)));
	ds_hsClassList.filter("gfn_subStr(CLASS_CD,0,5)==" + wrapQuote(gfn_subStr(ds_hmClassList.getColumn(0,"CLASS_CD"),0,5)));
}

/******************************************************************************************
 * 함  수  명   : btn_copyTable_onclick(obj:Button,  e:ClickEventInfo)
 * 기      능   : 점검양식 복사
 * 작  성  자   : 김민수
 * 작성  일자   : 2015-02-04
 ******************************************************************************************/
function btn_copyTable_onclick(obj:Button,  e:ClickEventInfo)
{

	if (ds_tableList.rowposition < 0)
	{
		g_Message("EE", "복사하실 점검양식을 조회 후 선택해주세요.");
		return;
	}

	if (ds_hlClassList.getRowCount() == 0)
	{
		g_Message("EE", "복사하실 점검양식을 선택해주세요.");
		return;
	}

	if (isCopyMode == true)
	{
		fn_changeCopyMode(false);
		g_Message("EE", "점검표 복사가 취소되었습니다.");
		fn_search();
		return;
	} else {
		if (!confirm("점검표 복사작업을 진행하시겠습니까?", "확인", "default")) return;	
		fn_changeCopyMode(true);
	}

	var nRow = ds_tableList.rowposition;
	
	ds_hlClassList.updatecontrol = false;
	ds_hmClassList.updatecontrol = false;
	ds_hsClassList.updatecontrol = false;
	
	// 양식
	var sTableType = ds_tableList.getColumn(nRow, "TABLE_TYPE");
	var sFormNm = ds_tableList.getColumn(nRow, "FORM_NM") + " - 복사본";
	
	ds_tableList.clearData();
	ds_tableList.addRow();
	ds_tableList.setColumn(0, "TABLE_TYPE", sTableType);
	ds_tableList.setColumn(0, "FORM_NM", sFormNm);
	ds_tableList.setColumn(0, "USE_YN", "N");
	
	// 대분류
	ds_hlClassList.filter("");
	nRowCnt = ds_hlClassList.getCountNF();
	for (i=0; i<nRowCnt; i++)
	{
		ds_hlClassList.setRowType(i, Dataset.ROWTYPE_INSERT);
		ds_hlClassList.setColumn(i, "FORM_CD", null);
	}
	
	// 중분류
	ds_hmClassList.filter("");
	nRowCnt = ds_hmClassList.getCountNF();
	for (i=0; i<nRowCnt; i++)
	{
		ds_hmClassList.setRowType(i, Dataset.ROWTYPE_INSERT);
		ds_hmClassList.setColumn(i, "FORM_CD", null);
	}

	// 소분류
	ds_hsClassList.filter("");
	nRowCnt = ds_hsClassList.getCountNF();
	for (i=0; i<nRowCnt; i++)
	{
		ds_hsClassList.setRowType(i, Dataset.ROWTYPE_INSERT);
		ds_hsClassList.setColumn(i, "FORM_CD", null);
	}
	
	ds_hlClassList.updatecontrol = true;
	ds_hmClassList.updatecontrol = true;
	ds_hsClassList.updatecontrol = true;

	ds_hlClassList.rowposition = -1;
	ds_hlClassList.rowposition = 0;

	fn_enableBtn(true);
}

/******************************************************************************************
 * 함  수  명   : ds_hsClassList_onvaluechanged(obj:Dataset,  e:DSColChangeEventInfo)
 * 기      능   : 중점항목 설정시 점수 세팅
 * 작  성  자   : 김민수
 * 작성  일자   : 2015-02-04
 ******************************************************************************************/
function ds_hsClassList_onvaluechanged(obj:Dataset,  e:DSColChangeEventInfo)
{
	if (e.col == 13)
	{
		// 중점항목일 경우 부적합점수를 점검지표점수로 자동세팅
		if (parseInt(e.newvalue) == 1)
		{
			ds_hsClassList.setColumn(e.row, "NOT_FIT_SCORE", ds_hsClassList.getColumn(e.row, "CHK_IDCTR"));
		}
		// 중점항목 해제시 부적합점수를 0점 처리
		else
		{
			ds_hsClassList.setColumn(e.row, "NOT_FIT_SCORE", "0");
		}
	}
}]]></Script>
  </Form>
</FDL>

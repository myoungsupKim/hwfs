<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="FSC00440E" onload="form_onload" titletext="CS진단 개인별진단결과조회" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Div id="div_cmnBtn" taborder="13" text="Div0" url="cmn::CmnBtn.xfdl" position="absolute 0 0 1237 30" anchor="left top right" scrollbars="none"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Static id="Static29" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 97" anchor="left top right"/>
        <Static id="Static30" text="진단표" class="sta_WFSA_label" position="absolute 15 41 90 62" anchor="left top"/>
        <Static id="Static31" text="기간" class="sta_WFSA_label" position="absolute 223 41 298 62" anchor="left top"/>
        <Static id="Static32" text="진단구분" class="sta_WFSA_label" position="absolute 536 41 611 62" anchor="left top"/>
        <Static id="Static34" text="W10" visible="false" position="absolute 72 40 82 61" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <Static id="Static35" text="W30" visible="false" position="absolute 193 40 223 87" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <Static id="Static11" text="W10" visible="false" position="absolute 280 40 290 87" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <Static id="Static37" text="W30" visible="false" position="absolute 506 40 536 61" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <Static id="Static38" text="W10" visible="false" position="absolute 594 40 604 87" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <Static id="Static39" text="W30" visible="false" position="absolute 800 40 830 87" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <Static id="Static43" text="H10" visible="false" position="absolute 15 30 1237 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static44" text="H10" visible="false" position="absolute 15 87 1237 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static13" text="W15" visible="false" position="absolute 0 30 15 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static46" text="운영부서" class="sta_WFSA_label" position="absolute 223 67 298 88" anchor="left top"/>
        <Static id="Static47" text="사업장" class="sta_WFSA_label" position="absolute 536 67 611 88" anchor="left top"/>
        <Static id="Static48" text="평가점수" class="sta_WFSA_label" position="absolute 830 41 905 62" anchor="left top"/>
        <Static id="Static53" text="W30" visible="false" position="absolute 506 66 536 87" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <Static id="Static54" text="W10" visible="false" position="absolute 888 40 898 61" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <Static id="Static55" text="W30" visible="false" position="absolute 1006 40 1036 61" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <Static id="Static51" text="W05." visible="false" position="absolute 15 61 1169 66" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <Static id="Static50" text="W10" visible="false" position="absolute 72 66 82 87" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <MaskEdit id="edt_scoreFrom" taborder="4" value="MaskEdit0" position="absolute 898 40 944 61" autoselect="true"/>
        <Static id="Static6" text="~" position="absolute 948 40 956 61"/>
        <MaskEdit id="edt_scoreTo" taborder="5" value="MaskEdit0" position="absolute 960 40 1006 61" autoselect="true"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" id="cbo_tableType" imemode="none" index="0" innerdataset="@ds_cboTableType" type="NOTFILTERED" taborder="0" position="absolute 82 40 193 61"/>
        <Combo id="cbo_chkClass" taborder="3" innerdataset="@ds_cboChkClass" codecolumn="CODE" datacolumn="CODE_NAME" position="absolute 604 40 800 61"/>
        <CheckBox id="chk_closeYn" taborder="12" tabstop="false" text="폐점업장 제외" value="N" truevalue="Y" falsevalue="N" onclick="common_chk_OnClick" position="absolute 1136 40 1234 61"/>
        <CheckBox id="chk_entireYn" taborder="11" tabstop="false" text="전체사업장" value="N" truevalue="Y" falsevalue="N" position="absolute 1036 40 1118 61" onclick="chk_entireYn_onclick"/>
        <Static id="Static18" text="개인별 진단 정보" class="sta_WF_Title01" position="absolute 0 110 450 128" anchor="left top"/>
        <Static id="Static19" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 97 500 110"/>
        <Static id="Static20" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 123 500 128" anchor="left top"/>
        <Static id="Static49" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1179 97 1237 103" anchor="top right"/>
        <Static id="Static12" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 1078 123 1237 128" anchor="top right"/>
        <Static id="Static00" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 606 -858 608 -838" anchor="top right"/>
        <Static id="Static33" text="담당자" class="sta_WFSA_label" position="absolute 830 67 905 88" anchor="left top"/>
        <Edit id="edt_empSabunNm" taborder="10" readonly="true" position="absolute 983 66 1169 87" userdata="btn_CHARGE_SABUN" autoselect="true" onkeydown="edt_empSabunNm_onkeydown"/>
        <Button id="btn_emp" taborder="63" tabstop="false" class="btn_WF_popSearch" position="absolute 1168 66 1190 87" onclick="btn_emp_onclick"/>
        <Static id="Static40" text="W10" visible="false" position="absolute 886 66 896 87" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <Grid id="grd_list" taborder="14" useinputpanel="false" position="absolute 0 127 1237 446" autofittype="none" anchor="left top right" autoenter="select" onexpanddown="grd_list_onexpanddown" oncelldblclick="grd_list_oncelldblclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="200"/>
                <Column size="120"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="70"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" class="head_Excel" taborder="undefined"/>
                <Cell col="1" colspan="2" text="점장" taborder="undefined"/>
                <Cell col="3" rowspan="2" text="업장명" taborder="undefined"/>
                <Cell col="4" rowspan="2" text="운영부서" taborder="undefined"/>
                <Cell col="5" rowspan="2" text="진단횟수" taborder="undefined"/>
                <Cell col="6" rowspan="2" text="평균점수" taborder="undefined"/>
                <Cell col="7" rowspan="2" text="부적합누계" taborder="undefined"/>
                <Cell col="8" colspan="2" text="년월(M)" taborder="undefined"/>
                <Cell col="10" colspan="2" text="년월(M+1)" taborder="undefined"/>
                <Cell col="12" colspan="2" text="년월(M+2)" taborder="undefined"/>
                <Cell row="1" col="1" text="사번" taborder="undefined"/>
                <Cell row="1" col="2" text="이름" taborder="undefined"/>
                <Cell row="1" col="8" text="점수"/>
                <Cell row="1" col="9" text="누계"/>
                <Cell row="1" col="10" text="점수"/>
                <Cell row="1" col="11" text="누계"/>
                <Cell row="1" col="12" text="점수"/>
                <Cell row="1" col="13" text="누계"/>
              </Band>
              <Band id="body">
                <Cell/>
                <Cell col="1" displaytype="text"/>
                <Cell col="2"/>
                <Cell col="3"/>
                <Cell col="4"/>
                <Cell col="5"/>
                <Cell col="6"/>
                <Cell col="7"/>
                <Cell col="8"/>
                <Cell col="9"/>
                <Cell col="10"/>
                <Cell col="11"/>
                <Cell col="12"/>
                <Cell col="13"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Combo id="cbo_empType" taborder="9" innerdataset="@ds_empType" codecolumn="CODE" datacolumn="CODE_NAME" position="absolute 896 66 981 87"/>
        <Button id="btn_TO_DT" taborder="69" onclick="g_CalButton_OnClick" class="btn_WF_calEssential" position="absolute 485 40 506 61" userdata="cal_endDd"/>
        <MaskEdit id="cal_endDd" taborder="2" type="string" mask="####-##-##" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" oneditclick="g_Date_OnFocus" class="msk_WF_EssentialCal" position="absolute 406 40 486 61" userdata="btn_TO_DT"/>
        <Static id="Static7" text="~" position="absolute 394 40 402 61"/>
        <Button id="btn_FROM_DT" taborder="71" onclick="g_CalButton_OnClick" class="btn_WF_calEssential" position="absolute 369 40 390 61" userdata="cal_startDd"/>
        <MaskEdit id="cal_startDd" taborder="1" type="string" mask="####-##-##" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" oneditclick="g_Date_OnFocus" class="msk_WF_EssentialCal" position="absolute 290 40 370 61" userdata="btn_FROM_DT"/>
        <UpjangSearchComponent id="edt_upjang" titletext="업장 검색용 Component" taborder="8" text="UpjangSearchComponent00" position="absolute 604 66 800 87" bindDataset="ds_cond" bindUpjangCodeColumn="UPJANG" bindUpjangNameColumn="UPJANGNM" eventBeforeTrigger="" eventAfterTrigger="" roleSetId=""/>
        <Static id="Static25" text="사업부" class="sta_WFSA_label" position="absolute 15 67 85 88"/>
        <MuSearchComponent id="cbo_mu" titletext="사업부 선택 Component" taborder="6" text="MuSearchComponent00" position="absolute 82 66 193 87" bindDataset="ds_cond" bindMuCdColumn="MU_CD" appendText="" onItemChangedEvent="fn_muChange"/>
        <TmSearchComponent id="edt_tm" titletext="팀 검색용 Component" taborder="7" text="TmSearchComponent00" position="absolute 290 66 506 87" bindDataset="ds_cond" bindTmCdColumn="TM_CD" bindTmNmColumn="TM_NM" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tmChange" eventBeforeTrigger=""/>
        <Static id="Static01" text="진단 정보" class="sta_WF_Title01" position="absolute 0 459 450 477" anchor="left top"/>
        <Static id="Static02" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 446 500 459"/>
        <Static id="Static03" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 472 500 477" anchor="left top"/>
        <Static id="Static04" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1179 446 1237 452" anchor="top right"/>
        <Static id="Static05" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 1078 472 1237 477" anchor="top right"/>
        <Grid id="grd_chkList" taborder="72" autoenter="select" useinputpanel="false" onexpanddown="grd_list_onexpanddown" position="absolute 0 476 1237 710" anchor="all" autofittype="col" binddataset="ds_chkList">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="200"/>
                <Column size="120"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="90"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" class="head_Excel" taborder="undefined"/>
                <Cell col="1" rowspan="2" text="업장명" taborder="undefined"/>
                <Cell col="2" rowspan="2" text="운영부서" taborder="undefined"/>
                <Cell col="3" colspan="2" text="점장" taborder="undefined"/>
                <Cell col="5" colspan="2" text="책임자" taborder="undefined"/>
                <Cell col="7" rowspan="2" text="팀장/본부장" taborder="undefined"/>
                <Cell col="8" rowspan="2" text="본부팀장" taborder="undefined"/>
                <Cell col="9" rowspan="2" text="점검일" taborder="undefined"/>
                <Cell col="10" rowspan="2" text="점수" taborder="undefined"/>
                <Cell col="11" rowspan="2" text="부적합판정" taborder="undefined"/>
                <Cell row="1" col="3" text="사번" taborder="undefined"/>
                <Cell row="1" col="4" text="이름" taborder="undefined"/>
                <Cell row="1" col="5" text="사번" taborder="undefined"/>
                <Cell row="1" col="6" text="이름" taborder="undefined"/>
              </Band>
              <Band id="body">
                <Cell expr="expr:currow + 1"/>
                <Cell col="1" displaytype="text" text="bind:UPJANGNM"/>
                <Cell col="2" displaytype="text" text="bind:TM_NAME"/>
                <Cell col="3" displaytype="normal" style="align:center;" text="bind:CHARGE_SABUN"/>
                <Cell col="4" text="bind:CHARGE_NM"/>
                <Cell col="5" displaytype="normal" style="align:center;" text="bind:RESP_USER1"/>
                <Cell col="6" text="bind:RESP_USER1_NM"/>
                <Cell col="7" text="bind:TEAM_MST_NM"/>
                <Cell col="8" text="bind:SUBTEAM_MST_NM"/>
                <Cell col="9" displaytype="date" text="bind:CHK_DD" calendardisplaynulltype="none"/>
                <Cell col="10" text="bind:SCORE"/>
                <Cell col="11" text="bind:CHK_RESULT"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="START_DD" type="STRING" size="256"/>
          <Column id="END_DD" type="STRING" size="256"/>
          <Column id="CHK_CLASS" type="STRING" size="256"/>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="UPJANGNM" type="STRING" size="256"/>
          <Column id="SCORE_FROM" type="STRING" size="256"/>
          <Column id="SCORE_TO" type="STRING" size="256"/>
          <Column id="EMP_SABUN" type="STRING" size="256"/>
          <Column id="EMP_NM" type="STRING" size="256"/>
          <Column id="ENTIRE_YN" type="STRING" size="256"/>
          <Column id="CLOSE_YN" type="STRING" size="256"/>
          <Column id="TM_CD" type="STRING" size="256"/>
          <Column id="TM_NM" type="STRING" size="256"/>
          <Column id="MU_CD" type="STRING" size="256"/>
          <Column id="MU_NM" type="STRING" size="256"/>
          <Column id="EMP_TYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TM_NAME" type="STRING" size="256"/>
          <Column id="UPJANGNM" type="STRING" size="256"/>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="CNT" type="STRING" size="256"/>
          <Column id="CHK_CLASS" type="STRING" size="256"/>
          <Column id="CHK_DD" type="STRING" size="256"/>
          <Column id="INSPECTOR_NM" type="STRING" size="256"/>
          <Column id="CHARGE_SABUN" type="STRING" size="256"/>
          <Column id="CHARGE_NM" type="STRING" size="256"/>
          <Column id="TEAM_MST_SABUN" type="STRING" size="256"/>
          <Column id="TEAM_MST_NM" type="STRING" size="256"/>
          <Column id="SUBTEAM_MST_SABUN" type="STRING" size="256"/>
          <Column id="SUBTEAM_MST_NM" type="STRING" size="256"/>
          <Column id="SCORE" type="STRING" size="256"/>
          <Column id="IMPROV_WRITE_CONFIRM_DD" type="STRING" size="256"/>
          <Column id="IMPROV_WRITE_CONFIRMOR" type="STRING" size="256"/>
          <Column id="IMPROV_WRITE_CONFIRMOR_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboChkClass" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboTableType">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboTmCd">
        <ColumnInfo>
          <Column id="TM_CD" size="3" type="STRING"/>
          <Column id="TM_NM" size="50" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_empType" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="CODE_NAME">점장</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="CODE_NAME">대팀장</Col>
          </Row>
          <Row>
            <Col id="CODE">3</Col>
            <Col id="CODE_NAME">소팀장</Col>
          </Row>
          <Row>
            <Col id="CODE_NAME">책임자</Col>
            <Col id="CODE">4</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_chkList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TM_NAME" type="STRING" size="256"/>
          <Column id="UPJANGNM" type="STRING" size="256"/>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="FORM_CD" type="STRING" size="256"/>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="CNT" type="STRING" size="256"/>
          <Column id="CHK_CLASS" type="STRING" size="256"/>
          <Column id="CHK_DD" type="STRING" size="256"/>
          <Column id="INSPECTOR_NM" type="STRING" size="256"/>
          <Column id="CHARGE_SABUN" type="STRING" size="256"/>
          <Column id="CHARGE_NM" type="STRING" size="256"/>
          <Column id="TEAM_MST_SABUN" type="STRING" size="256"/>
          <Column id="TEAM_MST_NM" type="STRING" size="256"/>
          <Column id="SUBTEAM_MST_SABUN" type="STRING" size="256"/>
          <Column id="SUBTEAM_MST_NM" type="STRING" size="256"/>
          <Column id="RESP_USER1" type="STRING" size="256"/>
          <Column id="RESP_USER1_NM" type="STRING" size="256"/>
          <Column id="SCORE" type="STRING" size="256"/>
          <Column id="IMPROV_WRITE_CONFIRM_DD" type="STRING" size="256"/>
          <Column id="IMPROV_WRITE_CONFIRMOR" type="STRING" size="256"/>
          <Column id="IMPROV_WRITE_CONFIRMOR_NM" type="STRING" size="256"/>
          <Column id="CHK_RESULT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_chkCond" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="TABLE_TYPE" type="STRING" size="256"/>
          <Column id="START_DD" type="STRING" size="256"/>
          <Column id="END_DD" type="STRING" size="256"/>
          <Column id="CHK_CLASS" type="STRING" size="256"/>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="UPJANGNM" type="STRING" size="256"/>
          <Column id="SCORE_FROM" type="STRING" size="256"/>
          <Column id="SCORE_TO" type="STRING" size="256"/>
          <Column id="EMP_SABUN" type="STRING" size="256"/>
          <Column id="EMP_NM" type="STRING" size="256"/>
          <Column id="ENTIRE_YN" type="STRING" size="256"/>
          <Column id="CLOSE_YN" type="STRING" size="256"/>
          <Column id="TM_CD" type="STRING" size="256"/>
          <Column id="TM_NM" type="STRING" size="256"/>
          <Column id="MU_CD" type="STRING" size="256"/>
          <Column id="MU_NM" type="STRING" size="256"/>
          <Column id="EMP_TYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="me_FROM_DT_value" compid="cal_startDd" propid="value" datasetid="ds_cond" columnid="START_DD"/>
      <BindItem id="me_TO_DT_value" compid="cal_endDd" propid="value" datasetid="ds_cond" columnid="END_DD"/>
      <BindItem id="chk_All_value" compid="chk_entireYn" propid="value" datasetid="ds_cond" columnid="ENTIRE_YN"/>
      <BindItem id="chk_Exc_value" compid="chk_closeYn" propid="value" datasetid="ds_cond" columnid="CLOSE_YN"/>
      <BindItem id="cbo_S_TABLE_TYPE_value" compid="cbo_tableType" propid="value" datasetid="ds_cond" columnid="TABLE_TYPE"/>
      <BindItem id="me_FROM_SCORE_value" compid="edt_scoreFrom" propid="value" datasetid="ds_cond" columnid="SCORE_FROM"/>
      <BindItem id="me_TO_SCORE_value" compid="edt_scoreTo" propid="value" datasetid="ds_cond" columnid="SCORE_TO"/>
      <BindItem id="item0" compid="cbo_chkClass" propid="value" datasetid="ds_cond" columnid="CHK_CLASS"/>
      <BindItem id="ed_CHARGE_SABUN_NM_value" compid="edt_empSabunNm" propid="value" datasetid="ds_cond" columnid="EMP_NM"/>
      <BindItem id="item3" compid="cbo_empType" propid="value" datasetid="ds_cond" columnid="EMP_TYPE"/>
      <BindItem id="item1" compid="edt_upjang" propid="value" datasetid="ds_cond" columnid="UPJANGNM"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";

/******************************************************************************************
 * 시스템구분 : 위생관리/CS진단관리
 * 프로그램명 : FSC00430V.XML
 * 기ㅡㅡㅡ능 : 개인별진단결과조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************/
 
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================

//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================

//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(this);

	// X-Framework : Action 정보 생성
	fsp_init(this);
	
	// 초기화
	fn_init();
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_init()
 * 기ㅡㅡㅡ능 : 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function fn_init() 
{
	// 조회조건 DataSet 초기화
	ds_cond.clearData();
	ds_cond.addRow();
	ds_cond.setColumn(0, "ENTIRE_YN", "N");
	ds_cond.setColumn(0, "CLOSE_YN", "Y");

	ds_chkCond.clearData();
	ds_chkCond.addRow();

	//공통코드조회
	var objCode = fn_common_code("'FS0103','FS0107'","","","non","Y");

	// 진단표구분
	var sCond = "GROUP_CODE == 'FS0103' && CODE != null";
	objCode.filter(sCond);
	CopyF(ds_cboTableType, objCode.name);
	
	// CS 진단구분
	sCond = "GROUP_CODE == 'FS0107'";
	objCode.filter(sCond);
	CopyF(ds_cboChkClass, objCode.name);

	// 권한처리
	edt_tm.applyAuthLevel(cbo_mu);
	edt_upjang.applyAuthLevel(edt_tm);

	// 조회기간 초기화
	cal_startDd.value = gfn_today().substr(0, 6) + '01';
	cal_endDd.value = gfn_today();
	
	cbo_empType.index = 0;
	
	//cbo_mu.setMuCode(" ");
	//edt_tm.setTmCode("");
	//edt_upjang.setUpjangCode("");	
}

//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,출력)
//
//=========================================================================================
/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_search()
 * 기ㅡㅡㅡ능 : 목록조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function fn_search() 
{
	if(gfn_isNull(ds_cond.getColumn(0, "START_DD")) || gfn_isNull(ds_cond.getColumn(0, "END_DD")))
	{
		g_Message("EE", "기간을 입력해주세요.");
		return;	
	}

	fsp_clear(this);
	
	// 목록 초기화
	ds_list.clearData();
	fsp_addSearch(this,"fs/fsc:FSC00430V_S001");
	fsp_callService(this,"","","ds_cond=ds_cond","ds_list=ds_list","","fn_callBackSearch");
}

function fn_callBackSearch(errCode, errMsg) 
{
	if( errCode != 0 ) {
		g_Message("EE", errMsg);
		return;
	}
	else
	{
		var objPivotHeadDs = fn_makeHeadDs(ds_list);
		var objPivotBodyDs = fn_makeBodyDs(ds_list, objPivotHeadDs);
		fn_crossTabGrid(grd_list, objPivotHeadDs, objPivotBodyDs);
	}
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_inspector_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 점장명 조회 팝업
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function btn_inspector_onclick(obj:Button, e:ClickEventInfo)
{
	fn_sql_common_setup( strMAQuery_SABUN
						,strMAQuery_SABUNKeyField
						,strMAQuery_SABUNValueField
						,strMAQuery_SABUNKeyFieldNM
						,strMAQuery_SABUNValueFieldNM
						,""
						,""
						,""
						,strMAQuery_SABUNCaption
						,strMAQuery_SABUNAllField
						);

	ds_resultMst.setColumn(0,"INSPECTOR_NM", gds_sql_common.getColumn(0, "ret_name"));
	ds_resultMst.setColumn(0,"INSPECTOR", gds_sql_common.getColumn(0, "ret_code"));	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : btn_charge_onclick(obj:Button,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 사원 조회팝업
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-23
 ******************************************************************************************/
function btn_emp_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_sql_common_setup( strMAQuery_SABUN
						,strMAQuery_SABUNKeyField
						,strMAQuery_SABUNValueField
						,strMAQuery_SABUNKeyFieldNM
						,strMAQuery_SABUNValueFieldNM
						,""
						,""
						,""
						,strMAQuery_SABUNCaption
						,strMAQuery_SABUNAllField
						);
	
	if (!gfn_isNull(gds_sql_common.getColumn(0, "ret_code")))
	{
		ds_cond.setColumn(0,"EMP_NM",    gds_sql_common.getColumn(0, "ret_name"));
		ds_cond.setColumn(0,"EMP_SABUN", gds_sql_common.getColumn(0, "ret_code"));
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : edt_empSabunNm_onkeydown(obj:Edit, e:KeyEventInfo)
 * 기ㅡㅡㅡ능 : 조회조건 사원명 삭제
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function edt_empSabunNm_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13) btn_emp.click();
	if (e.keycode == 46) {
		ds_cond.setColumn(0, "EMP_NM", "");
		ds_cond.setColumn(0, "EMP_SABUN", "");
	}
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : grd_list_onexpanddown(obj:Grid, e:GridMouseEventInfo)
 * 기ㅡㅡㅡ능 : 그리드의 확인자 클릭시 사원조회 팝업
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function grd_list_onexpanddown(obj:Grid, e:GridMouseEventInfo)
{
	// 확인자
	if (obj.currentcol == 14) 
	{
		fn_sql_common_setup( strMAQuery_SABUN
						,strMAQuery_SABUNKeyField
						,strMAQuery_SABUNValueField
						,strMAQuery_SABUNKeyFieldNM
						,strMAQuery_SABUNValueFieldNM
						,""
						,""
						,""
						,strMAQuery_SABUNCaption
						,strMAQuery_SABUNAllField
						);
						
		if (gds_sql_common.getColumn(0, "ret_name") != "") {				
			ds_list.setColumn(obj.currentrow, "IMPROV_WRITE_CONFIRMOR_NM", gds_sql_common.getColumn(0, "ret_name"));
			ds_list.setColumn(obj.currentrow, "IMPROV_WRITE_CONFIRMOR", gds_sql_common.getColumn(0, "ret_code"));
		}
	}
}

//Pivot Head Dataset생성
function fn_makeHeadDs(objDs)
{
	var sPivotHeadDs = objDs.name + "_PivotHead";
	var objPivotHeadDs;
	if ( this.isValidObject(sPivotHeadDs) )
	{
		objPivotHeadDs = eval(sPivotHeadDs);
	}
	else
	{
		objPivotHeadDs = new Dataset();
		objPivotHeadDs.name = sPivotHeadDs;
		this.addChild(objPivotHeadDs.name,objPivotHeadDs);
	}

	objPivotHeadDs.clear();
	objDs.keystring = "S:CHK_DD";
	var nRow;
	for ( var i = 0; i < objDs.rowcount; i++ )
	{
		sPrevDate = objDs.getColumn(i, "CHK_DD");
		sNextDate = objDs.getColumn(i-1, "CHK_DD");
		if ( sPrevDate != sNextDate)	
		{			
			nRow = objPivotHeadDs.addRow();
			objPivotHeadDs.addColumn("CHK_DD","STRING",255);						
			objPivotHeadDs.addColumn("DISP_HEAD1","STRING",255);
			objPivotHeadDs.addColumn("DISP_HEAD2","STRING",255);
			objPivotHeadDs.setColumn(nRow,"CHK_DD",sPrevDate);
			objPivotHeadDs.setColumn(nRow,"DISP_HEAD1","점수");
			objPivotHeadDs.setColumn(nRow,"DISP_HEAD2","누계");
		}
	}
	return objPivotHeadDs;
}

//Pivot Dataset생성
function fn_makeBodyDs(objDs, objPivotHeadDs)
{
	var sPivotDs = objDs.name + "_Pivot";
	var objPivotDs;
	if ( this.isValidObject(sPivotDs) )
	{
		objPivotDs = eval(sPivotDs);
	}
	else
	{
		objPivotDs = new Dataset();
		objPivotDs.name = sPivotDs;
		this.addChild(objPivotDs.name,objPivotDs);
	}
	objPivotDs.clear();
	
	//고정컬럼 추가
	objPivotDs.addColumn("KEY","STRING",255);	            // 키
	objPivotDs.addColumn("CHARGE_SABUN","STRING",9);	    // 사번
	objPivotDs.addColumn("CHARGE_NM","STRING",255);		    // 점장명
	objPivotDs.addColumn("EMP_SABUN","STRING",9);	        // 사번
	objPivotDs.addColumn("EMP_NM","STRING",255);		    // 담당자명
	objPivotDs.addColumn("UPJANGNM","STRING",255);		    // 업장명
	objPivotDs.addColumn("TM_NM","STRING",255);		    // 운영부서
	objPivotDs.addColumn("TOT_CNT","BIGDECIMAL",39);		// 진단횟수
	objPivotDs.addColumn("AVG_SCORE","BIGDECIMAL",39);		// 평균점수
	objPivotDs.addColumn("TOT_NOT_FIT_CNT","BIGDECIMAL",39);// 부적합누계
	objPivotDs.addColumn("CHK_DD","STRING",12);			    // 점검일

	//Pivot컬럼 추가
	for (var i=0; i<objPivotHeadDs.rowcount; i++)
	{
		objPivotDs.addColumn("SCORE"+objPivotHeadDs.getColumn(i,0),"BIGDECIMAL",39);		//점수
		objPivotDs.addColumn("NOT_FIT_CNT"+objPivotHeadDs.getColumn(i,0),"BIGDECIMAL",39);	//부적합누계
	}
	
	//objPivotHeadDs	헤더데이터셋	
	var sPrevSEQ = "";
	var sNextSEQ = "";
	var nAddRow;
	var sYYDD;
	var sPrevUPJANG = "";
	var sNextUPJANG = "";
	objDs.keystring = "S:+CHARGE_SABUN+UPJANG";
	
	objDs.enableevent = false;
	for(var j=0; j < objDs.rowcount; j++)
	{
		sPrevSABUN = objDs.getColumn(j,"CHARGE_SABUN") + objDs.getColumn(j,"UPJANG");
		sNextSABUN = objDs.getColumn(j-1, "CHARGE_SABUN") + objDs.getColumn(j-1, "UPJANG");		
		
		if( sPrevSABUN != sNextSABUN )
		{
			nAddRow = objPivotDs.addRow();	
			objPivotDs.setColumn(nAddRow,"KEY",objDs.getColumn(j,"CHARGE_SABUN")+objDs.getColumn(j,"UPJANG"));
			objPivotDs.setColumn(nAddRow,"CHARGE_SABUN",objDs.getColumn(j,"CHARGE_SABUN"));
			objPivotDs.setColumn(nAddRow,"CHARGE_NM",objDs.getColumn(j,"CHARGE_NM"));
			objPivotDs.setColumn(nAddRow,"UPJANGNM",objDs.getColumn(j,"UPJANGNM"));
			objPivotDs.setColumn(nAddRow,"TM_NM",objDs.getColumn(j,"TM_NM"));
			objPivotDs.setColumn(nAddRow,"TOT_CNT",objDs.getColumn(j,"TOT_CNT"));
			objPivotDs.setColumn(nAddRow,"AVG_SCORE",objDs.getColumn(j,"AVG_SCORE"));
			objPivotDs.setColumn(nAddRow,"TOT_NOT_FIT_CNT",objDs.getColumn(j,"TOT_NOT_FIT_CNT"));
		}
	}

	for(var k=0; k < objDs.rowcount; k++)
	{
		if(objDs.getColumn(k,"TOT_CNT") == 0) continue;
		var nRow = objPivotDs.findRow("KEY",objDs.getColumn(k,"CHARGE_SABUN")+objDs.getColumn(k,"UPJANG"));
		objPivotDs.setColumn(nRow,"SCORE" + objDs.getColumn(k,"CHK_DD"),objDs.getColumn(k,"SCORE"));		
		objPivotDs.setColumn(nRow,"NOT_FIT_CNT" + objDs.getColumn(k,"CHK_DD"),objDs.getColumn(k,"NOT_FIT_CNT"));
	}
	objDs.enableevent = true;

	return objPivotDs;
}

//Pivot 그리드포맷생성
function fn_crossTabGrid(objGrid, objPivotHeadDs, objPivotBodyDs)
{
	var v_Formats = "";
	var v_Columns = "";
	var v_Rows = "";
	var v_BandHead = "";
	var v_BandBody = "";

	v_Columns  +=      '<Column size="40" band="left"/>\n';	 // 엑셀
	v_Columns  +=      '<Column size="100" band="left"/>\n'; // 점장-사번
	v_Columns  +=      '<Column size="100" band="left"/>\n'; // 점장-점장명
	v_Columns  +=      '<Column size="200" band="left"/>\n'; // 업장명
	v_Columns  +=      '<Column size="120" band="left"/>\n'; // 운영부서
	v_Columns  +=      '<Column size="80" band="left"/>\n';  // 진단횟수
	v_Columns  +=      '<Column size="80" band="left"/>\n';  // 평균점수
	v_Columns  +=      '<Column size="80" band="left"/>\n';  // 부적합누계

	v_Rows     +=      '<Row size="24" band="head"/>\n';
	v_Rows     +=      '<Row size="24" band="head"/>\n';
	v_Rows     +=      '<Row size="24"/>\n';

	v_BandHead +=      '<Cell rowspan="2" displaytype="image" class="head_Excel"/>\n';
	if(cbo_empType.value == 1) v_BandHead +=      '<Cell col="1" colspan="2" text="점장"/>\n';
	else if(cbo_empType.value == 2) v_BandHead +=      '<Cell col="1" colspan="2" text="대팀장"/>\n';
	else if(cbo_empType.value == 3) v_BandHead +=      '<Cell col="1" colspan="2" text="소팀장"/>\n';
	else if(cbo_empType.value == 4) v_BandHead +=      '<Cell col="1" colspan="2" text="책임자"/>\n';
	v_BandHead +=      '<Cell row="1" col="1" text="사번"/>\n';
	v_BandHead +=      '<Cell row="1" col="2" text="이름"/>\n';
	v_BandHead +=      '<Cell col="3" rowspan="2" displaytype="text" text="업장명"/>\n';
	v_BandHead +=      '<Cell col="4" rowspan="2" displaytype="text" text="운영부서"/>\n';
	v_BandHead +=      '<Cell col="5" rowspan="2" text="진단횟수"/>\n';
	v_BandHead +=      '<Cell col="6" rowspan="2" text="평균점수"/>\n';
	v_BandHead +=      '<Cell col="7" rowspan="2" text="부적합누계"/>\n';

	v_BandBody +=      '<Cell displaytype="text" style="align:center middle;" expr="expr:currow+1"/>\n';
	v_BandBody +=      '<Cell col="1" displaytype="normal" style="align: ;" text="bind:CHARGE_SABUN"/>\n';
	v_BandBody +=      '<Cell col="2" displaytype="normal" style="align: ;" text="bind:CHARGE_NM"/>\n';
	v_BandBody +=      '<Cell col="3" displaytype="text" style="align: ;" text="bind:UPJANGNM"/>\n';
	v_BandBody +=      '<Cell col="4" displaytype="text" style="align: ;" text="bind:TM_NM"/>\n';
	v_BandBody +=      '<Cell col="5" displaytype="number" style="align: ;" text="bind:TOT_CNT"/>\n';	      // 진단휫수
	v_BandBody +=      '<Cell col="6" displaytype="number" style="align: ;" text="bind:AVG_SCORE"/>\n';	      // 평균점수
	v_BandBody +=      '<Cell col="7" displaytype="number" style="align: ;" text="bind:TOT_NOT_FIT_CNT"/>\n'; // 부적합누계

	// 포맷 생성
	var v_HeadText = '';
	var v_HeadColIdx = 8;
	var v_BodyColIdx = 8;

	for (var i=0; i<objPivotHeadDs.getRowCount(); i++)
	{
		if(gfn_isNull(objPivotHeadDs.getColumn(i, "CHK_DD"))) continue;
		
		// Column 생성
		v_Columns += '<Column size="70" />\n';
		v_Columns += '<Column size="70" />\n';

		// Head 생성
		if (v_HeadText != objPivotHeadDs.getColumn(i, "CHK_DD"))
		{
			v_HeadText = objPivotHeadDs.getColumn(i, "CHK_DD");
							
			// Row 1
			v_BandHead += '<Cell col="'+v_HeadColIdx+'" colspan="' + 2 + '" text="'+gfn_getFormat(v_HeadText,"@@@@.@@")+'"/>\n';
			
			// Row 2
			for (var j=i; j<objPivotHeadDs.getRowCount(); j++)
			{
				if (v_HeadText == objPivotHeadDs.getColumn(j, "CHK_DD")){
					v_BandHead += '<Cell row="1" col="'+v_HeadColIdx+'" text="점수"/>\n';
					v_BandHead += '<Cell row="1" col="'+(v_HeadColIdx + 1)+'" text="누계"/>\n';
					v_HeadColIdx += 2;
				}
			}
		}

		// Body 생성
		v_BandBody += '<Cell style="align:right;" col="'+v_BodyColIdx+'" displaytype="number" text="expr:SCORE'+objPivotHeadDs.getColumn(i, "CHK_DD")+'"/>\n';
		v_BandBody += '<Cell style="align:right;" col="'+(v_BodyColIdx + 1)+'" displaytype="number" text="expr:NOT_FIT_CNT'+objPivotHeadDs.getColumn(i, "CHK_DD")+'"/>\n';
		v_BodyColIdx+=2;
	}

	v_Formats = '<Formats>\n';
	v_Formats += '<Format id="default">\n';
	v_Formats += '<Columns>\n';
	v_Formats += v_Columns;
	v_Formats += '</Columns>\n';
	v_Formats += '<Rows>\n';
	v_Formats += v_Rows;
	v_Formats += '</Rows>\n';
	v_Formats += '<Band id="head">\n';
	v_Formats += v_BandHead;
	v_Formats += '</Band>\n';	
	v_Formats += '<Band id="body">\n';
	v_Formats += v_BandBody;
	v_Formats += '</Band>\n';		
	v_Formats += '</Format>\n';	
	v_Formats += '</Formats>\n';

	//trace(objPivotBodyDs.saveXML());
	objGrid.enableredraw = false;
	objGrid.formats = v_Formats;
	objGrid.binddataset = objPivotBodyDs.name;
	objGrid.enableredraw = true;	
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_muChange(obj, event)
 * 기ㅡㅡㅡ능 : 사업부 변경시 운영부서, 사업장 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function fn_muChange(obj, event)
{
	edt_tm.setTmCode("");
	edt_upjang.setUpjangCode("");
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : fn_tmChange(obj, data)
 * 기ㅡㅡㅡ능 : 운영부서 변경시 사업장 초기화
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function fn_tmChange(obj, data)
{
	edt_upjang.setUpjangCode("");
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : grd_list_oncelldblclick(obj:Grid, e:GridClickEventInfo)
 * 기ㅡㅡㅡ능 : 더블클릭시 개별점검내용조회
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function grd_list_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	ds_chkCond.copyData(ds_cond);
	ds_chkCond.setColumn(0, "UPJANG", ds_list.getColumn(e.row, "UPJANG"));

	ds_chkList.clearData();
	fsp_clear(this);
	fsp_addSearch(this,"fs/fsc:FSC00440E_S001");
	fsp_callService(this,"","","ds_cond=ds_chkCond","ds_chkList=ds_list","","");
}

/******************************************************************************************
 * 함ㅡ수ㅡ명 : chk_entireYn_onclick(obj:CheckBox,  e:ClickEventInfo)
 * 기ㅡㅡㅡ능 : 전체사업장 선택시 담당자구분 점장으로 강제세팅
 * 작ㅡ성ㅡ자 : 김민수
 * 작성ㅡ일자 : 2015-03-27
 ******************************************************************************************/
function chk_entireYn_onclick(obj:CheckBox,  e:ClickEventInfo)
{
	if(obj.value == 'Y')
	{
		cbo_empType.enable = false;
		edt_empSabunNm.enable = false;
		btn_emp.enable = false;
		cbo_empType.index = 0;
	}
	else
	{
		cbo_empType.enable = true;
		edt_empSabunNm.enable = true;
		btn_emp.enable = true;
		cbo_empType.index = 0;
	}
}
]]></Script>
  </Form>
</FDL>

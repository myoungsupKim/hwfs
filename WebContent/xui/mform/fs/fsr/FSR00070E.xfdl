<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FSR00070E" onload="form_onload" titletext="업장레시피공유" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static0" position="absolute 0 282 1237 361" class="sta_WFDA_Labelbg" anchor="left top right"/>
        <Static id="Static02" class="sta_WFDA_Labelbg" position="absolute 79 308 419 335"/>
        <Grid autoenter="select" binddataset="ds_list" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="grd_list" useinputpanel="false" oncelldblclick="grd_list_OnCellDblClick" onheadclick="grd_list_OnHeadClick" taborder="9" tabstop="true" usecontextmenu="true" userdata="자랑레시피" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 102 1237 207" selecttype="row" anchor="left top right" autofittype="col">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30"/>
                <Column size="79"/>
                <Column size="325"/>
                <Column size="83"/>
                <Column size="274"/>
                <Column size="85"/>
                <Column size="97"/>
                <Column size="158"/>
                <Column size="85"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="날짜" wordwrap="word"/>
                <Cell col="2" displaytype="text" text="사업장"/>
                <Cell col="3" displaytype="text" text="등록자" wordwrap="word"/>
                <Cell col="4" displaytype="text" text="레시피명" wordwrap="word"/>
                <Cell col="5" displaytype="text" text="원가" wordwrap="word"/>
                <Cell col="6" displaytype="text" text="레시피유형"/>
                <Cell col="7" displaytype="text" text="조리법유형"/>
                <Cell col="8" displaytype="text" text="조회 수" wordwrap="word"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:center;" text="bind:SUBMIT_DATE" mask="####-##-##"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:UPJANGNM"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:NM_KOR"/>
                <Cell col="4" displaytype="text" style="align:left;" text="bind:RECIPE_NAME"/>
                <Cell col="5" displaytype="number" style="align:right;" text="bind:RECIPE_COST" mask="#,##0"/>
                <Cell col="6" displaytype="text" style="align:left;" text="bind:RECIPE_TYPE_NM"/>
                <Cell col="7" displaytype="text" style="align:left;" text="bind:CUISINE_TYPE_NM"/>
                <Cell col="8" displaytype="number" style="align:right;" text="bind:INQUERY_CNT" mask="#,###"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_Insert" onclick="fn_insert" taborder="18" text="입력" position="absolute 1080 256 1131 277" class="btn_WF_Custom" image="" anchor="top right"/>
        <Button id="btn_Save" onclick="fn_save" taborder="19" text="저장" position="absolute 1133 256 1184 277" class="btn_WF_Custom" image="" anchor="top right"/>
        <Button enable="false" id="btn_delete" onclick="fn_delete" taborder="20" text="삭제" position="absolute 1186 256 1237 277" class="btn_WF_Custom" image="" anchor="top right"/>
        <Edit enable="false" id="ed_recipeName" imemode="none" taborder="21" tabstop="false" position="absolute 82 285 395 306" class="edt_WF_Essential"/>
        <Edit lengthunit="asciii" id="ed_upjangCd" imemode="english" maxlength="6" inputtype="number" taborder="22" tabstop="false" visible="false" position="absolute 174 77 232 99"/>
        <Static id="Static10" text="원가는 표준단가로 계산되었습니다. 사업장 원가와는 차이가 날 수 있습니다." position="absolute 2 210 698 229" style="color:crimson;" class="sta_WF_DiscPoint"/>
        <Static id="Static11" text="레시피명" position="absolute 0 282 80 309" class="sta_WFDA_Label01"/>
        <Button enable="false" id="btn_recipeSearch" onclick="btn_recipeSearch_OnClick" taborder="11" text="" position="absolute 394 285 415 306" class="btn_WF_popSearchEssential" image=""/>
        <Static id="Static12" text="제공찬수" position="absolute 0 308 80 335" class="sta_WFDA_Label01"/>
        <Static id="Static14" text="배식방법" position="absolute 210 308 290 335" class="sta_WFDA_Label01"/>
        <Static id="Static16" text="1인량 기준" position="absolute 0 334 80 361" class="sta_WFDA_Label01"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" displayrowcount="10" id="cbo_dishQty" imemode="native" innerdataset="ds_FS0038Cd" type="filter" taborder="12" position="absolute 82 311 206 332" class="cmb_WF_Essential"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" displayrowcount="10" id="cbo_rationMethod" imemode="native" innerdataset="ds_FS0024Cd" type="filter" taborder="13" position="absolute 292 311 415 332" class="cmb_WF_Essential"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" displayrowcount="10" id="cbo_manStd" imemode="native" innerdataset="ds_FS0039Cd" type="filter" taborder="14" position="absolute 82 337 206 358" class="cmb_WF_Essential"/>
        <Static id="Static18" text="특이사항" position="absolute 418 282 498 361" class="sta_WFDA_Label01"/>
        <TextArea id="txt_desc" imemode="native" onsetfocus="txt_desc_OnFocus" onkillfocus="txt_desc_OnKillFocus" taborder="15" position="absolute 497 282 1237 361" anchor="left top right"/>
        <Grid autoenter="select" binddataset="ds_itemList" readonly="false" enable="true" id="grd_item" useinputpanel="false" oncellclick="grd_item_OnCellClick" onchar="grd_item_OnChar" onheadclick="grd_list_OnHeadClick" onkeydown="grd_item_OnKeyDown" taborder="16" tabstop="true" usecontextmenu="true" userdata="재료구성" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 392 689 710" selecttype="row" anchor="left top bottom" autofittype="col">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30"/>
                <Column size="89"/>
                <Column size="299"/>
                <Column size="90"/>
                <Column size="50"/>
                <Column size="60"/>
                <Column size="60"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="자재코드"/>
                <Cell col="2" rowspan="2" displaytype="text" text="자재명"/>
                <Cell col="3" rowspan="2" displaytype="text" text="규격"/>
                <Cell col="4" rowspan="2" displaytype="text" text="구매&#10;단위"/>
                <Cell col="5" rowspan="2" displaytype="text" text="1인소요량&#10;(g)"/>
                <Cell col="6" rowspan="2" displaytype="text" text="1인원가&#10;(원)"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:ITEM_CODE"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:ITEM_NAME"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:ITEM_SIZE"/>
                <Cell col="4" displaytype="text" style="align:left;" text="bind:PO_UOM"/>
                <Cell col="5" displaytype="number" style="align:right;" text="bind:NEED_QTY"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:PERSON_PRICE"/>
              </Band>
              <Band id="summary">
                <Cell colspan="5" displaytype="text" style="align:center;" text="합계"/>
                <Cell col="5" displaytype="number" style="align:right;" expr="expr:getSum('NEED_QTY')"/>
                <Cell col="6" displaytype="number" style="align:right;" expr="expr:getSum('PERSON_PRICE')"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid autoenter="select" binddataset="ds_cookList" readonly="false" enable="true" id="grd_cook" useinputpanel="false" oncellclick="grd_cook_OnCellClick" onheadclick="grd_list_OnHeadClick" onkeydown="grd_cook_OnKeyDown" taborder="17" tabstop="true" usecontextmenu="true" userdata="조리법" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 698 392 1237 710" selecttype="row" anchor="all" autofittype="col">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="30"/>
                <Column size="488"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="조리법"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:CUISINE_DESC"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="st_upjang" position="absolute 0 255 224 277" class="sta_WFDA_Label01"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 1245 40"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 1245 71"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 269 40 299 61"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61"/>
        <Static id="st00" text="사 업 장" class="sta_WFSA_label" position="absolute 15 40 78 61"/>
        <Button id="btn_fromDt" taborder="37" onclick="btn_Date_OnClick" class="btn_WF_cal" position="absolute 1079 40 1101 61" userdata="med_fromDt"/>
        <Button id="btn_toDt" taborder="39" onclick="btn_Date_OnClick" class="btn_WF_cal" position="absolute 1195 40 1217 61" userdata="med_toDt"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="40" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static21" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 71 40 81 61"/>
        <Static id="Static03" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 366 40 376 61"/>
        <Static id="Static22" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 476 40 506 61"/>
        <Static id="Static23" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 585 40 595 61"/>
        <Static id="Static24" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 695 40 725 61"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Button id="btn_upjangCd" onclick="btn_upjangCd_OnClick" taborder="8" tabstop="false" text="" position="absolute 248 40 269 61" class="btn_WF_popSearch" image=""/>
        <Static id="Static7" text="레시피유형" position="absolute 295 40 371 61" class="sta_WFSA_label"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" displayrowcount="15" id="cbo_recipeType" imemode="native" innerdataset="ds_FS0002Cd" type="filter" taborder="2" position="absolute 376 40 476 61"/>
        <Edit id="ed_upjangNm" onkeydown="ed_upjangNm_OnKeyDown" readonly="true" taborder="1" position="absolute 81 40 249 61"/>
        <Static id="Static1" text="날 짜" position="absolute 951 40 1014 61" class="sta_WFSA_label"/>
        <Static id="Static8" text="조리법유형" position="absolute 514 40 590 61" class="sta_WFSA_label"/>
        <Static id="Static9" text="레시피명" position="absolute 727 40 790 61" class="sta_WFSA_label"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" displayrowcount="15" id="cbo_cuisineType" imemode="native" innerdataset="ds_FS0003Cd" type="filter" taborder="3" position="absolute 595 40 695 61"/>
        <Combo codecolumn="RECIPE_NAME" datacolumn="RECIPE_NAME" id="cbo_recipe" index="0" innerdataset="ds_recipe" type="filter" taborder="4" position="absolute 796 40 919 61" displayrowcount="15" ontextchanged="cbo_recipe_ontextchanged" onkillfocus="cbo_recipe_onkillfocus" onkeydown="cbo_recipe_onkeydown" onitemchanged="cbo_recipe_onitemchanged"/>
        <MaskEdit id="med_fromDt" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="5" type="string" position="absolute 1001 40 1080 61"/>
        <Static id="Static13" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 786 40 796 61"/>
        <Static id="Static19" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 919 40 949 61"/>
        <Static id="Static20" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 991 40 1001 61"/>
        <Static id="st_under" text="~" position="absolute 1104 40 1114 60"/>
        <MaskEdit id="med_toDt" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="6" type="string" position="absolute 1117 40 1196 61"/>
        <Static id="st_title" text="목록" class="sta_WF_Title01" position="absolute 0 84 242 102"/>
        <Static id="Static26" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 450 84"/>
        <Static id="Static27" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 97 450 102"/>
        <Static id="Static15" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 207 450 212"/>
        <Static id="st_titleM" text="상    세" class="sta_WF_Title01" position="absolute 0 237 242 255"/>
        <Static id="Static25" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 224 450 237"/>
        <Static id="Static28" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 250 450 255"/>
        <Static id="Static17" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 277 1242 282"/>
        <Static id="st_titleM00" text="재료구성" class="sta_WF_Title01" position="absolute 0 374 242 392"/>
        <Static id="st_titleM01" text="조리법" class="sta_WF_Title01" position="absolute 698 374 940 392"/>
        <Static id="Static29" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 361 794 374"/>
        <Static id="Static30" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 387 794 392"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_FS0002Cd">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_FS0003Cd">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond">
        <ColumnInfo>
          <Column id="CUISINE_TYPE" size="255" type="STRING"/>
          <Column id="FROM_DT" size="255" type="STRING"/>
          <Column id="RECIPE_NAME" size="255" type="STRING"/>
          <Column id="RECIPE_SEQ" size="255" type="STRING"/>
          <Column id="RECIPE_TYPE" size="255" type="STRING"/>
          <Column id="TO_DT" size="255" type="STRING"/>
          <Column id="UPJANG" size="6" type="BIGDECIMAL"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CUISINE_TYPE"/>
            <Col id="FROM_DT"/>
            <Col id="RECIPE_NAME"/>
            <Col id="RECIPE_SEQ"/>
            <Col id="RECIPE_TYPE"/>
            <Col id="TO_DT"/>
            <Col id="UPJANG"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list">
        <ColumnInfo>
          <Column id="CUISINE_TYPE" size="20" type="STRING"/>
          <Column id="DISH_QTY" size="20" type="STRING"/>
          <Column id="INQUERY_CNT" size="22" type="BIGDECIMAL"/>
          <Column id="MAN_STD" size="20" type="STRING"/>
          <Column id="NM_KOR" size="20" type="STRING"/>
          <Column id="PRIDE_RECIPE_SEQ" size="20" type="STRING"/>
          <Column id="PWD" size="20" type="STRING"/>
          <Column id="RATION_METHOD" size="20" type="STRING"/>
          <Column id="RECIPE_CD" size="20" type="STRING"/>
          <Column id="RECIPE_CLASS" size="20" type="STRING"/>
          <Column id="RECIPE_COST" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_NAME" size="50" type="STRING"/>
          <Column id="RECIPE_TYPE" size="20" type="STRING"/>
          <Column id="SUBMIT_DATE" size="8" type="STRING"/>
          <Column id="SUBMIT_SABUN" size="9" type="STRING"/>
          <Column id="UPJANG" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_recipe">
        <ColumnInfo>
          <Column id="RECIPE_SEQ" size="256" type="STRING"/>
          <Column id="RECIPE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_master">
        <ColumnInfo>
          <Column id="CUISINE_TYPE" size="20" type="STRING"/>
          <Column id="DISH_QTY" size="20" type="STRING"/>
          <Column id="INQUERY_CNT" size="22" type="BIGDECIMAL"/>
          <Column id="MAN_STD" size="20" type="STRING"/>
          <Column id="NM_KOR" size="20" type="STRING"/>
          <Column id="PRIDE_RECIPE_SEQ" size="20" type="STRING"/>
          <Column id="PWD" size="20" type="STRING"/>
          <Column id="RATION_METHOD" size="20" type="STRING"/>
          <Column id="RECIPE_CD" size="20" type="STRING"/>
          <Column id="RECIPE_CLASS" size="20" type="STRING"/>
          <Column id="RECIPE_COST" size="22" type="BIGDECIMAL"/>
          <Column id="RECIPE_NAME" size="50" type="STRING"/>
          <Column id="RECIPE_TYPE" size="20" type="STRING"/>
          <Column id="SUBMIT_DATE" size="8" type="STRING"/>
          <Column id="SUBMIT_SABUN" size="9" type="STRING"/>
          <Column id="UPJANG" size="22" type="BIGDECIMAL"/>
          <Column id="SPECIAL_DESC" size="256" type="STRING"/>
          <Column id="HALL_CLASS" size="256" type="STRING"/>
          <Column id="UPJANGNM" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_FS0038Cd">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_FS0024Cd">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_FS0039Cd">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
          <Column id="SET1" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cookList" oncolumnchanged="ds_cookList_OnColumnChanged">
        <ColumnInfo>
          <Column id="CUISINE_DESC" size="200" type="STRING"/>
          <Column id="CUISINE_SEQ" size="22" type="BIGDECIMAL"/>
          <Column id="HALL_CLASS" size="20" type="STRING"/>
          <Column id="PHOTO_PATH" size="200" type="STRING"/>
          <Column id="RECIPE_CD" size="20" type="STRING"/>
          <Column id="SPHOTO_PATH" size="200" type="STRING"/>
          <Column id="UPJANG" size="22" type="BIGDECIMAL"/>
          <Column id="FLAG" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_itemList" oncolumnchanged="ds_itemList_OnColumnChanged">
        <ColumnInfo>
          <Column id="CAL" size="22" type="BIGDECIMAL"/>
          <Column id="CUT_SPEC" size="20" type="STRING"/>
          <Column id="DISUSE_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="EDIBLE_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="GRAM_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="ITEM_CODE" size="12" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SEQ" size="22" type="BIGDECIMAL"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="ITEM_TYPE" size="0" type="STRING"/>
          <Column id="KG_CONVERT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="MARGIN_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="NEED_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="REMARK" size="300" type="STRING"/>
          <Column id="RESTRICT_YN" size="1" type="STRING"/>
          <Column id="FLAG" size="256" type="STRING"/>
          <Column id="OLD_ITEM_CODE" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_descList">
        <ColumnInfo>
          <Column id="PRIDE_RECIPE_SEQ" size="255" type="STRING"/>
          <Column id="SPECIAL_DESC" size="200" type="STRING"/>
          <Column id="SPECIAL_SEQ" size="22" type="BIGDECIMAL"/>
          <Column id="FLAG" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_key">
        <ColumnInfo>
          <Column id="MAX_SEQ" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="ed_recipeName_value" compid="ed_recipeName" propid="value" datasetid="ds_master" columnid="RECIPE_NAME"/>
      <BindItem id="cbo_recipeType_value" compid="cbo_recipeType" propid="value" datasetid="ds_cond" columnid="RECIPE_TYPE"/>
      <BindItem id="cbo_cuisineType_value" compid="cbo_cuisineType" propid="value" datasetid="ds_cond" columnid="CUISINE_TYPE"/>
      <BindItem id="med_fromDt_value" compid="med_fromDt" propid="value" datasetid="ds_cond" columnid="FROM_DT"/>
      <BindItem id="med_toDt_value" compid="med_toDt" propid="value" datasetid="ds_cond" columnid="TO_DT"/>
      <BindItem id="cbo_dishQty_value" compid="cbo_dishQty" propid="value" datasetid="ds_master" columnid="DISH_QTY"/>
      <BindItem id="cbo_rationMethod_value" compid="cbo_rationMethod" propid="value" datasetid="ds_master" columnid="RATION_METHOD"/>
      <BindItem id="cbo_manStd_value" compid="cbo_manStd" propid="value" datasetid="ds_master" columnid="MAN_STD"/>
      <BindItem id="txt_desc_value" compid="txt_desc" propid="value" datasetid="ds_descList" columnid="SPECIAL_DESC"/>
      <BindItem id="st_upjang_value" compid="st_upjang" propid="value" datasetid="ds_master" columnid="UPJANGNM"/>
      <BindItem id="item0" compid="st_upjang" propid="text" datasetid="ds_master" columnid="UPJANGNM"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
 ******************************************************************************************
 * 시스템구분   : 메뉴관리
 * 프로그램명   : FSR00070E
 * 기      능   : 업장레시피공유
 * 작  성  자   : 
 * 작성  일자   : 2007-12-21
 * 비      고   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
include "U_lib::lib_conversionCom.xjs";
//@@컨버터에서 주석처리 #include "LIB::sc_comon.js";
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js";
//@@컨버터에서 주석처리 #include "LIB::tit_comm_0001.js";		// X-Framework Lib
//@@컨버터에서 주석처리 #include "LIB::sc_sql_common.js"		// 사업장팝업용 Lib
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var F_DESC = "조리 tip,배식 시 주의할 점, 고객 반응 등을 자유롭게 적어주세요.";
// I : 신규입력, U : 수정
var f_GUBUN;
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(this);
	
	// 업데이트 DS
	//v_ds_check = "ds_master";
	med_fromDt.value = gfn_subStr(gfn_today(), 0, 6)+ "01";
	med_toDt.value = gfn_today();
	
	fsp_init(this);
	// 레시피명 조회
    fsp_addSearch(this, "fs/fsc:FSR_RECIPE_CD_REF_S001"); // 레시피 정보 가져오기 
    fsp_callService(this, "", "", ""
        , "ds_recipe=gds_Csqlout" 
        , "" 
        , "fn_afterInit"
        , null, true);
        
    var v_fil_cond;
	var v_ds = fn_common_code("'FS0002','FS0003','FS0038', 'FS0024', 'FS0039'","","","blk","Y"); 
	
	//FS0002 : RECIPE_TYPE
	v_fil_cond = "GROUP_CODE == 'FS0002'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_FS0002Cd,v_ds.name);	

	//FS0003 : CUISINE_TYPE
	v_fil_cond = "GROUP_CODE == 'FS0003'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_FS0003Cd,v_ds.name);	
	ds_FS0003Cd.setColumn(0, "CODE" , "");
	
	//FS0038 : 제공 찬수 
	v_fil_cond = "GROUP_CODE == 'FS0038'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_FS0038Cd,v_ds.name);	
	ds_FS0038Cd.setColumn(0, "CODE" , "");
	
	//FS0024: 배식방법 
	v_fil_cond = "GROUP_CODE == 'FS0024' && SET1=='Y'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_FS0024Cd,v_ds.name);	
	ds_FS0024Cd.insertRow(0);
	ds_FS0024Cd.setColumn(0, "CODE" , "");
	
	//FS0039: 1인량 기준  
	v_fil_cond = "GROUP_CODE == 'FS0039'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_FS0039Cd,v_ds.name);	
	ds_FS0039Cd.setColumn(0, "CODE" , "");
}
//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_search() {
    gfn_clearGrid(grd_list);
	fsp_clear(this); 
    ds_cond.setColumn(0, "UPJANG", ed_upjangCd.value);
	if( cbo_recipe.index==0 )
	{
		ds_cond.setColumn(0, "RECIPE_NAME", "");
	}
	else
	{
		ds_cond.setColumn(0, "RECIPE_NAME", gfn_trim(cbo_recipe.text) );
	}
    /*
    var rValue = cbo_recipe.value;
    if ( length( rValue ) == 0 ) {
        ds_cond.setColumn(0, "RECIPE_SEQ", "");
        ds_cond.setColumn(0, "RECIPE_NAME", "");
    } else {
        var row = ds_recipe.findRow("RECIPE_SEQ", rValue);
        if ( ds_recipe.getColumn(row, "RECIPE_NAME")
                == ds_recipe.getColumn(row, "RECIPE_SEQ") ) {
            ds_cond.setColumn(0, "RECIPE_SEQ", "");
            ds_cond.setColumn(0, "RECIPE_NAME", rValue);
        } else {
            ds_cond.setColumn(0, "RECIPE_SEQ", rValue);
            ds_cond.setColumn(0, "RECIPE_NAME", "");
        }
    }
    */
    fsp_addSearch(this, "fs/fsr:FSR00070E_S001");	 

    fsp_callService(this, "", ""
            , "ds_cond=ds_cond"
            , "ds_list=ds_list"
            , ""
            , "fn_afterSearch"
            , true);
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Insert()
 * 기      능   : [입력버튼] 입력 시 처리되는 작업
 * 비      고	: 팝업사용
 ******************************************************************************************
 */
function fn_insert(obj:Button, e:ClickEventInfo) {
    if ( fn_isChangeDetail() ) {
        return;
    }
    
    ds_master.clearData();
    ds_master.addRow();
    ds_master.setColumn(0, "UPJANGNM", g_Upjang);
    ds_master.applyChange();
    
    // 신규 등록 
    ds_descList.clearData();
    ds_descList.addRow();
    txt_desc.value = F_DESC;
    ds_descList.applyChange();
    
    ds_itemList.clearData();
    ds_cookList.clearData();
    
    fn_clearDetail(false);
    
    f_GUBUN = "I";
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_save()
 * 기      능   : [저장버튼] 저장 시 처리되는 작업
 ******************************************************************************************
 */
function fn_save(obj:Button, e:ClickEventInfo) {
	// 변경 사항 확인
	if( f_GUBUN == "U" ) {
		var iCnt = ds_itemList.findRowExpr("FLAG == 'I' || FLAG == 'U'");
		var cCnt = ds_cookList.findRowExpr("FLAG == 'I' || FLAG == 'U'");
		if ( iCnt == -1 && cCnt == -1 && gfn_dsIsUpdated(ds_descList)== false ) {
			// 변경 사항 확인 
			if ( !gfn_isChangeDs(ds_master, st_titleM.text, "") ) {
				return;
			}
		}
    }
    
	// 재료구성과 조리법에 자동적으로 추가된 마지막 빈 Row를 찾아서 지워주자
	/*trace(ds_itemList.SaveXML());
	for( var i=ds_itemList.GetRowCount()-1; i>=0; i-- ) {
		trace(ds_itemList.GetColumn(i, "ITEM_CODE"));
		if( trim(ds_itemList.GetColumn(i, "ITEM_CODE")).length() == 0 || trim(ds_itemList.GetColumn(i, "ITEM_CODE")) == "" ) {
			ds_itemList.DeleteRow(i);
		}
	}
	for( var i=ds_cookList.GetRowCount()-1; i>=0; i-- ) {
		if( trim(ds_cookList.GetColumn(i, "ITEM_CODE")).length() == 0 || trim(ds_cookList.GetColumn(i, "ITEM_CODE")) == "" ) {
			ds_cookList.DeleteRow(i);
		}
	}*/

	// 필수 입력 사항 확인     
    if ( gfn_isNullCheck(ed_recipeName.value, "레시피", ed_recipeName) ) {
        return;
    }
    if ( gfn_isNullCheck(cbo_dishQty.value, "제공찬수", cbo_dishQty) ) {
        return;
    }
    if ( gfn_isNullCheck(cbo_rationMethod.value, "배식방법", cbo_rationMethod) ) {
        return;
    }
    if ( gfn_isNullCheck(cbo_manStd.value, "1인량 기준", cbo_manStd) ) {
        return;
    }
    
    if ( ds_itemList.getRowCount() == 0 ) {
        gfn_alert( gfn_msg(FSRW00001, "재료구성 정보") );    
        return;
    }
    /*if ( ds_cookList.rowCount() == 0 ) {
        gfn_alert( gfn_msg(FSRW00001, "조리법 정보") );    
        return;
    }*/
    
    var dsArr = ["ITEM_CODE"];
    var labelArr = ["자재명"];
    if ( gfn_isGridNull(grd_item, dsArr, labelArr) ) {
        return;
    }
    
    dsArr = ["CUISINE_DESC"];
    labelArr = ["조리법"];
    if ( gfn_isGridNull(grd_cook, dsArr, labelArr) ) {
        return;
    }
    
    // 비밀번호 
    //trace("PWD==="+ds_master.getColumn(0, "PWD"));
    var arr = gfn_dialog("","U_FSR::FSR00073P.xfdl", {fa_pwd:ds_master.getColumn(0, "PWD")});
    if ( gfn_isNull(arr)) {
        return;
    } else if ( arr != true ) {
        ds_master.setColumn(0, "PWD", arr );
    }
    // 조리법 순번 정하기 
    var maxNo = ds_cookList.getMax("CUISINE_SEQ");
    for ( var i = 0;i < ds_cookList.getRowCount(); i++) {
        if ( ds_cookList.getColumn(i, "FLAG") == "I" ) {
            ds_cookList.setColumn(i, "CUISINE_SEQ", maxNo + i + 1); 
        }    
    }
    fsp_clear(this);
    var upDs = "";
    if ( gfn_length( ds_master.getColumn(0, "PRIDE_RECIPE_SEQ") )== 0 ) {
        // 신규입력 
        fsp_addSearch(this, "fs/fsr:FSR00070E_S007", true);   // key 조회 
        fsp_addSingle(this, "fs/fsr:FSR00070E_I001"); // master 입력 
        fsp_addSingle(this, "fs/fsr:FSR00070E_I004"); // 특기사항 입력 
    } else {
        // 수정 
        fsp_addSingle(this, "fs/fsr:FSR00070E_U002"); // master 입력 
        fsp_addSingle(this, "fs/fsr:FSR00070E_U005"); // 특기사항 입력 
        
        upDs = " ds_key=ds_key:A";
        ds_key.clearData();
        ds_key.addRow();
        ds_key.setColumn(0, "MAX_SEQ", ds_master.getColumn(0, "PRIDE_RECIPE_SEQ") );
    }
    // 자재 정보 
    fsp_addSave(this
            , "fs/fsr:FSR00070E_I002"
            , "fs/fsr:FSR00070E_U003"
            , ""
            , "FLAG"
            , "", -1
            , "" );
    // 조리법 정보         
    fsp_addSave(this
            , "fs/fsr:FSR00070E_I003"
            , "fs/fsr:FSR00070E_U004"
            , ""
            , "FLAG"
            , "", -1
            , "" );
                
    fsp_callService(this, "", ""
        , "ds_master=ds_master:A ds_itemList=ds_itemList:A ds_descList=ds_descList:A ds_cookList=ds_cookList:A" + upDs
        , "ds_key=ds_key"
        , ""
        , "fn_afterSave"
        , true);		// 서비스 호출 
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Delete()
 * 기      능   : [삭제버튼] 삭제 시 처리되는 작업
 ******************************************************************************************
 */
function fn_delete(obj:Button, e:ClickEventInfo) {
    if ( !gfn_confirm(gfn_msg(SCCI00004, "자랑레시피 ") ) ) {
        return;
    }
    
    if ( gfn_length( ds_master.getColumn(0, "PRIDE_RECIPE_SEQ") )> 0 ) {
        // 비밀번호 
        //trace("PWD==="+ds_master.getColumn(0, "PWD"));
        var arr = gfn_dialog("","U_FSR::FSR00073P.xfdl", {fa_pwd:ds_master.getColumn(0, "PWD")} );
        if ( arr == null ) {
            return;
        }
        
        fsp_clear(this);
        fsp_addSingle(this, "fs/fsr:FSR00070E_D004"); // master 삭제 
        fsp_addSingle(this, "fs/fsr:FSR00070E_D005"); // 자재 삭제
        fsp_addSingle(this, "fs/fsr:FSR00070E_D003"); // 조리법 삭제 
        fsp_addSingle(this, "fs/fsr:FSR00070E_D002"); // 특이사항 삭제 
        
        fsp_callService(this, "", ""
            , "ds_master=ds_master:A ds_descList=ds_descList:A"
            , ""
            , ""
            , "fn_afterDelete"
            , true);	
    }
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Print()
 * 기      능   : [출력버튼] 출력 시 처리되는 작업
 ******************************************************************************************
 */
function fn_print() {
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function fn_close() {
	return true;
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Help()
 * 기      능   : [도움말버튼] 도움말
 ******************************************************************************************
 */
function fn_help() {

}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Excel
 * 기      능   : Excel
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_Excel()
{

}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   :  fn_afterInit
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 초기화 callback 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function fn_afterInit(errCode, errMsg) {
    ds_recipe.insertRow(0);
    ds_recipe.setColumn(0, "RECIPE_SEQ", "");
    ds_recipe.setColumn(0, "RECIPE_NAME", "전체");
    
    cbo_recipe.value = "";
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSearch()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 리스트 조회 후 callback 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function fn_afterSearch(errCode, errMsg)
{	
    gfn_showMsgGrid(grd_list);
    
    ds_list.filter("RECIPE_COST>''");
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSave()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 저장 후 callback 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function fn_afterSave(errCode, errMsg)
{
	if( errCode != 0 ) {
		return;
	} else {
		g_Message("02");
		fn_clearDetail(true);
		if ( gfn_length(ds_master.getColumn(0, "PRIDE_RECIPE_SEQ") )== 0 ) {
			ds_master.setColumn(0, "PRIDE_RECIPE_SEQ", ds_key.getColumn(0, "MAX_SEQ") );
		}
		
		//---- 저장 전 위치로 셋팅
		http.Sync = true;
		fn_search();
		http.Sync = false;
		var v_TmpRow = ds_list.findRow("PRIDE_RECIPE_SEQ", ds_master.getColumn(0, "PRIDE_RECIPE_SEQ"));
		if( v_TmpRow != -1 ) {
			ds_list.rowposition = v_TmpRow;
		}
		//----
		
		fn_updateAndSearchDetail("AS");

		ds_itemList.filter("PERSON_PRICE>''");
		
		// 저장 후 초기화
		f_GUBUN = "U";
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_afterDelete()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 삭제 후 callback 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function fn_afterDelete(errCode, errMsg)
{	
    // list에서 삭제 
    var nRow = ds_list.findRow("PRIDE_RECIPE_SEQ", ds_master.getColumn(0, "PRIDE_RECIPE_SEQ") );
    if ( nRow >= 0 ) {
        ds_list.deleteRow( nRow );
    }
    
    ds_master.clearData();
    ds_cookList.clearData();
    ds_itemList.clearData();
    ds_descList.clearData();
    
    btn_delete.enable = false;
    btn_recipeSearch.enable = false;
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_afterDeleteItem()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 삭제 후 callback 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function fn_afterDeleteItem(errCode, errMsg)
{	
    ds_itemList.deleteRow( ds_itemList.rowposition );
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_afterDeleteCook()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 삭제 후 callback 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function fn_afterDeleteCook(errCode, errMsg)
{	
    ds_cookList.deleteRow( ds_cookList.rowposition );
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_afterDetailSearch()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 조회 후 callback 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function fn_afterDetailSearch(errCode, errMsg) {
    gfn_showMsgGrid(grd_item);
    gfn_showMsgGrid(grd_cook);
    if ( ds_descList.getRowCount() == 0 ) {
        ds_descList.addRow();
    }
    if( gfn_length( ds_descList.getColumn(0, "SPECIAL_DESC") )== 0 ) {
        txt_desc.value = F_DESC;
    }
    
    //ds_itemList.AddRow();
    //ds_cookList.AddRow();
    
    ds_descList.applyChange();
    fn_clearDetail(true);
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_clearDetail
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 상세 목록 초기화 
 * 작  성  자   : 조은영
 * 작성  일자   : 2007-11-30
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_clearDetail(isEnable) {
    btn_recipeSearch.enable = !isEnable;
    btn_delete.enable = isEnable;
    
    if ( gfn_length( ds_master.getColumn(0, "PRIDE_RECIPE_SEQ"))== 0 ) {
        btn_recipeSearch.enable = true;
        btn_delete.enable = false;
    }
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_updateAndSearchDetail
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 상세 정보 조회 
 * 작  성  자   : 조은영
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_updateAndSearchDetail(sType) {    
    // 그리드 초기화 
    gfn_clearGrid(grd_item);
    gfn_clearGrid(grd_cook);
        
    fsp_clear(this);
    
    if ( sType == "S" ) {   // 기존 정보 조회 
        fsp_addSingle(this, "fs/fsr:FSR00070E_U001");  // 조회 건수 증가 
        fsp_addSearch(this, "fs/fsr:FSR00070E_S002"); // 자재 정보 조회  
        fsp_addSearch(this, "fs/fsr:FSR00070E_S003"); // 조리법 정보 조회
        fsp_addSearch(this, "fs/fsr:FSR00070E_S006"); // 특기사항 조회 
    } else if ( sType == "AS" ) {
        fsp_addSearch(this, "fs/fsr:FSR00070E_S002"); // 자재 정보 조회  
        fsp_addSearch(this, "fs/fsr:FSR00070E_S003"); // 조리법 정보 조회
        fsp_addSearch(this, "fs/fsr:FSR00070E_S006"); // 특기사항 조회 
    } else {
        // Upjang Recipe 에서 조회 
        fsp_addSearch(this, "fs/fsr:FSR00070E_S004"); // 자재 정보 조회 
        fsp_addSearch(this, "fs/fsr:FSR00070E_S005"); // 조리법 조회
    }
    http.Sync = true;
    fsp_callService(this, "", ""
        , "ds_cond=ds_cond ds_master=ds_master:A"
        , "ds_itemList=ds_itemList ds_cookList=ds_cookList ds_descList=ds_descList"
        , ""
        , "fn_afterDetailSearch");		// 서비스 호출 
    http.Sync = false;
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_isChangeDetail()
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 상세 정보 변경 유무 확인  
 * 작  성  자   : 조은영
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_isChangeDetail() {
    // 변경 사항 확인 
    var iCnt = ds_itemList.findRowExpr("FLAG == 'I' || FLAG == 'U'");
    var cCnt = ds_cookList.findRowExpr("FLAG == 'I' || FLAG == 'U'");
    
    if ( iCnt == -1 && cCnt == -1 && gfn_dsIsUpdated(ds_descList)== false
        && gfn_dsIsUpdated(ds_master)== false ) {
        // 변경 사항  없음.  
    } else {
        if( !gfn_confirm(gfn_msg(SCCI00003) ) ) {
            return true;
        }
    }
    return false;
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : btn_upjangCd_OnClick
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 업장 조회 
 * 작  성  자   : 조은영
 * 작성  일자   : 2007-11-30
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function btn_upjangCd_OnClick(obj:Button, e:ClickEventInfo)
{
    fn_sql_common_setup(strMAQuery_Upjang
						,strMAQuery_UpjangKeyField
						,strMAQuery_UpjangValueField
						,strMAQuery_UpjangKeyFieldNM 
						,strMAQuery_UpjangValueFieldNM
						,""
						,""
						,""   
						,strMAQuery_UpjangCaption
						,strMAQuery_UpjangAllField
						);
    
    var upjang = "";
    var upjangNm = "";
    
    if (gds_sql_common.getColumn(0, "ret_code") != "")  {
		upjang = gds_sql_common.getColumn(0, "ret_code");
        upjangNm = gds_sql_common.getColumn(0, "ret_name");
        ed_upjangCd.value = upjang;
        ed_upjangNm.value = upjangNm;
    }
}
/*
 ******************************************************************************************
 * 함  수  명   : ed_upjangNm_OnKeyDown
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 업장 조회 
 * 작  성  자   : 조은영
 * 작성  일자   : 2007-11-30
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function ed_upjangNm_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if ( e.keycode == 13 ) {
        btn_upjangCd_OnClick(null);
	} else if ( e.keycode == 46 ) {
        ed_upjangCd.value = "";
        ed_upjangNm.value = "";
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : grd_list_OnHeadClick
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 그리드 헤더 클릭 
 * 작  성  자   : 조은영
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function grd_list_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
    if ( eval(obj.binddataset).getRowCount() == 0 ) {
        return;
    }
    
	if (e.cell == 0 ){
        gfn_exportExcel(obj, obj.userdata); //, null, null,null, false);
        return;
    }
    
	gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
}
/*
 ******************************************************************************************
 * 함  수  명   : ds_master_OnColumnChanged
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 데이터 컬럼 변경 시 
 * 작  성  자   : 조은영
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function ds_master_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
    switch( strColumnID ) {
        case "HALL_CD":    // 식당명 -> 입고처 자동으로 보여주기 
            if ( gfn_length( varNewValue )== 0 ) {
                ds_master.setColumn(nRow, "SUBINV_CODE", "");
                ds_master.setColumn(nRow, "SUBINV_NAME", "");
            } else {
                var r = ds_hallList.findRow("HALL_CD", varNewValue);
                ds_master.setColumn(nRow, "SUBINV_CODE", ds_hallList.getColumn(r, "SUBINV_CODE"));
            }
            break;
        case "GOAL_COST_RATE":
            var num = toNumber( varNewValue);
            if ( num != 0 ) {
                var title = new Array();
                title[0] = "목표식재료율";
                if ( num < 0 ) {
                    title[1] = "0";
                    gfn_alert( gfn_msg(SCCW00009, title));
                    ds_master.setColumn(nRow, "GOAL_COST_RATE","0");
                } else if ( num > 100 ) {
                    title[1] = "100";
                    gfn_alert( gfn_msg(SCCW00010, title));
                    ds_master.setColumn(nRow, "GOAL_COST_RATE","0");
                }
            } 
            break;
        default :
            break;
    }
}
/*
 ******************************************************************************************
 * 함  수  명   : grd_list_OnCellDblClick
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 그리드에서 해당 Cell 설정 
 * 작  성  자   : 조은영
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function grd_list_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
    if( fn_isChangeDetail() ) {
        return;
    }
    
    ds_master.clearData();
    ds_master.addRow();
    ds_master.copyRow(0, ds_list, e.row); 
    ds_master.setColumn(0,"INQUERY_CNT", ds_master.getColumn(0, "INQUERY_CNT") + 1); 
    ds_master.applyChange();
    fn_clearDetail(false);
    
    // list 증가 
    ds_list.setColumn(e.row, "INQUERY_CNT", ds_master.getColumn(0, "INQUERY_CNT"));
    
	fn_updateAndSearchDetail("S");
	
	f_GUBUN = "U";
}
/*
 ******************************************************************************************
 * 함  수  명   : btn_recipeSearch_OnClick
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 레시피 조회 
 * 작  성  자   : 조은영
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function btn_recipeSearch_OnClick(obj:Button, e:ClickEventInfo)
{
    var upjang = ds_master.getColumn(0, "UPJANG");
    if ( gfn_length( upjang )== 0 ) {
        upjang = g_Upjang;
    }
	var arg = {fa_UPJANG:upjang};
        
	var arr = gfn_dialog("","U_FSR::FSR00071P.xfdl", arg);
	if ( arr != null ) {
        if ( arr[0] != ds_master.getColumn(0, "RECIPE_CD") 
            || arr[2] != ds_master.getColumn(0, "HALL_CLASS") ) {
            ds_master.setColumn(0, "UPJANG", arr[3]);
            ds_master.setColumn(0, "HALL_CLASS", arr[2]);
            ds_master.setColumn(0, "RECIPE_NAME", arr[1]);
            ds_master.setColumn(0, "RECIPE_CD", arr[0]);
            
            fn_updateAndSearchDetail("U");
        }
	}
	
	// Insert Mode로 변경
	for( var i=0; i<ds_itemList.getRowCount(); i++ ) {
		ds_itemList.setColumn(i, "FLAG", "I");
	}
	for( var i=0; i<ds_cookList.getRowCount(); i++ ) {
		ds_cookList.setColumn(i, "FLAG", "I");
	}
	ds_itemList.applyChange();
	ds_cookList.applyChange();
}

/*
 ******************************************************************************************
 * 함  수  명   : frm_OnUnloadCompleted
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 화면 닫힐 때 처리 
 * 작  성  자   : 조은영
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function frm_OnUnloadCompleted(obj)
{   
    // 변경된것이 없다. 
    if ( !gfn_isChangeDs(ds_list, "", "", true) ) {
        return true;
    }
    
    if ( !gfn_confirm(gfn_msg(SCCI00002))) {
        return true;
    }
    
    // 저장 호출 
    fn_Save(true);
    
    return false;
}
//=========================================================================================
// [ PART 7]
// Tab안의 화면이 공통으로 사용 
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : txt_desc_OnFocus
 * 기      능   : 텍스트에 글자 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function txt_desc_OnFocus(obj:TextArea, e:SetFocusEventInfo)
{
	if ( obj.value == F_DESC ) {
        obj.value = "";
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : txt_desc_OnKillFocus
 * 기      능   : 텍스트에 글자 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function txt_desc_OnKillFocus(obj:TextArea, e:KillFocusEventInfo)
{
	if ( gfn_length( obj.value )== 0 ) {
        obj.value = F_DESC;
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : grd_item_OnCellClick
 * 기      능   : 자재 그리드 선택 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function grd_item_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	// 자재 및 조리법 수정 불가 처리 2008.05.15 12F 3Room Start
	/*
    ds_itemList.row = nRow;
	switch( nCell ) {
        case 1: // 삭제
            if ( !gfn_confirm(gfn_msg(SCCI00004, "재료구성 ") ) ) {
                return;
            }
            
            if ( ds_itemList.getColumn(nRow, "FLAG") == "S"
                || ds_itemList.getColumn(nRow, "FLAG") == "U" ) {
                // 서버에서 삭제 
                tit_clearActionInfo(this);
                tit_addSingleActionInfo(this, "fs/fsr:FSR00070E_D001"); // 자재 삭제 
                tit_callService(this, "", ""
                    , ""
                    , ""
                    , "PRIDE_RECIPE_SEQ=" + quote( ds_itemList.getColumn(nRow, "PRIDE_RECIPE_SEQ") )
                        + " ITEM_CODE=" + quote( ds_itemList.getColumn(nRow, "ITEM_CODE") )
                    , "fn_afterDeleteItem"
                    , true );		// 서비스 호출 
            } else {
                ds_itemList.deleteRow( nRow );
            }    
            break;
        case 3: // 자재 조회
            var arg = "";
            if ( ds_itemList.getColumn(nRow, "FLAG") == "I" ) {
                arg = "fa_itemCode=''"
                    + " fa_itemName=''"
                    + " fa_itemClass2=''"
                    + " fa_itemClass3=''"
                    + " fa_itemClass4=''";
            } else {
                arg = "fa_itemCode=" + quote( ds_itemList.getColumn(nRow, "ITEM_CODE") )
                    + " fa_itemName=" + quote( ds_itemList.getColumn(nRow, "ITEM_NAME") )
                    + " fa_itemClass2=" + quote( ds_itemList.getColumn(nRow, "ITEM_CLASS2") )
                    + " fa_itemClass3=" + quote( ds_itemList.getColumn(nRow, "ITEM_CLASS3") )
                    + " fa_itemClass4=" + quote( ds_itemList.getColumn(nRow, "ITEM_CLASS4") );
            }
            var arr = gfn_dialog("","U_FSR::FSR00072P.xml",arg ); 
            if ( arr != null ) {
                // 해당 자재가 이미 등록되어 있는지 확인 
                for ( var r = 0; r < ds_itemList.rowCount(); r++ ) {
                    if ( ds_itemList.getColumn(r, "ITEM_CODE") == arr[0]
                        && r != nRow ) {
                        gfn_alert("해당 자재는 이미 재료구성 정보에 존재합니다.\n확인하여 주십시오.");
                        return;
                    }
                }
                ds_itemList.setColumn(nRow, "FLAG", "U");
                ds_itemList.setColumn(nRow, "ITEM_CODE", arr[0]);
                ds_itemList.setColumn(nRow, "ITEM_NAME", arr[1]);
                ds_itemList.setColumn(nRow, "ITEM_SIZE", arr[2]);
                ds_itemList.setColumn(nRow, "PO_UOM", arr[3]);
                ds_itemList.setColumn(nRow, "GRAM_PRICE", arr[4]);
                ds_itemList.setColumn(nRow, "MARGIN_PRICE", arr[5]);
                ds_itemList.setColumn(nRow, "RESTRICT_YN", arr[6]);
                ds_itemList.setColumn(nRow, "DISUSE_RATE", arr[7]);
            }
            break;
	}
	*/
	// 자재 및 조리법 수정 불가 처리 2008.05.15 12F 3Room End
}
/*
 ******************************************************************************************
 * 함  수  명   : grd_item_OnKeyDown
 * 기      능   : 자재 그리드 key down 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function grd_item_OnKeyDown(obj:Grid, e:KeyEventInfo)
{
	// 자재 및 조리법 수정 불가 처리 2008.05.15 12F 3Room Start
	/*
	if ( nChar == 13 && length( ds_master.getColumn(0, "RECIPE_CD") ) > 0 ) {
		if (length(ds_itemList.GetColumn(ds_itemList.lastrow,"ITEM_CODE")) > 0) {
			// 입력 그리드 추가 
			var nRow = ds_itemList.addRow();
			ds_itemList.setColumn(nRow, "FLAG", "I");
        }
	}
	*/
	// 자재 및 조리법 수정 불가 처리 2008.05.15 12F 3Room End
}
/*
 ******************************************************************************************
 * 함  수  명   : grd_cook_OnKeyDown
 * 기      능   : 조리법 그리드 key down 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function grd_cook_OnKeyDown(obj:Grid, e:KeyEventInfo)
{
	// 자재 및 조리법 수정 불가 처리 2008.05.15 12F 3Room Start
	/*
	if ( nChar == 13 && length( ds_master.getColumn(0, "RECIPE_CD") ) > 0 ) {
		if (length(ds_cookList.GetColumn(ds_cookList.lastrow,"CUISINE_DESC")) > 0) {
        // 입력 그리드 추가 
			var nRow = ds_cookList.addRow();
			ds_cookList.setColumn(nRow, "FLAG", "I");
        }
    }
    */
    // 자재 및 조리법 수정 불가 처리 2008.05.15 12F 3Room End
}
/*
 ******************************************************************************************
 * 함  수  명   : grd_cook_OnCellClick
 * 기      능   : 조리법 그리드 삭제 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function grd_cook_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	// 자재 및 조리법 수정 불가 처리 2008.05.15 12F 3Room Start
	/*
	switch( nCell ) {
        case 1: // 삭제
            if ( !gfn_confirm(gfn_msg(SCCI00004, "조리법 ") ) ) {
                return;
            }
            
            if ( ds_cookList.getColumn(nRow, "FLAG") == "S"
                || ds_cookList.getColumn(nRow, "FLAG") == "U" ) {
                // 서버에서 삭제 
                tit_clearActionInfo(this);
                tit_addSingleActionInfo(this, "fs/fsr:FSR00070E_D006"); // 삭제 
                tit_callService(this, "", ""
                    , ""
                    , ""
                    , "PRIDE_RECIPE_SEQ=" + quote( ds_cookList.getColumn(nRow, "PRIDE_RECIPE_SEQ") )
                        + " CUISINE_SEQ=" + quote( ds_cookList.getColumn(nRow, "CUISINE_SEQ") )
                    , "fn_afterDeleteCook"
                    , true );		// 서비스 호출 
            } else {
                ds_cookList.deleteRow( nRow );
            }    
            break;
	}
	*/
	// 자재 및 조리법 수정 불가 처리 2008.05.15 12F 3Room End
}
/*
 ******************************************************************************************
 * 함  수  명   : ds_itemList_OnColumnChanged
 * 기      능   : 값 변경시 재계산 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function ds_itemList_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	switch(e.columnid) {
        case "NEED_QTY" :	// 1인소요량 
            var v_PP=Math.round(ds_itemList.getColumn(e.row,"GRAM_PRICE")*ds_itemList.getColumn(e.row,"NEED_QTY"),0);
			ds_itemList.setColumn(e.row,"PERSON_PRICE",v_PP);
				
		    if ( obj.getColumn(e.row, "FLAG") == "S" ) {
                obj.setColumn(e.row, "FLAG", "U");
		    }
            break;
		default :
			break;
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : ds_cookList_OnColumnChanged
 * 기      능   : 데이터 변경 시 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function ds_cookList_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if ( e.columnid == "CUISINE_DESC" ) {
        if ( obj.getColumn(e.row, "FLAG") == "S" ) {
            obj.setColumn(e.row, "FLAG", "U");
        }
	}
}



function obj_onKeyDown(obj:Combo, e:KeyEventInfo)
{
    if ( e.keycode == 13 ) {
       
    }
}

/******************************************************************************************
 * 함  수  명   : btn_Date_OnClick(obj,nX,nY)
 * 기      능   : 달력 팝업 호출
 * 작  성  자   : 
 * 작성  일자   : 2008-04-08
 ******************************************************************************************
 */
function btn_Date_OnClick(obj:Button,  e:ClickEventInfo)
{
	g_CalButton_OnClick(obj);
}

function grd_item_OnChar(obj:Grid, e:GridEditCharEventInfo)
{
	if(e.cell == 7)
	{ 
	var rtn = gfn_indexOf(e.posttext, "-");
		if(rtn >= 0)
		{
			gfn_alert("음수(-)값은 입력할 수 없습니다.");
			ds_display.setColumn(e.row,"number",e.pretext);
			return; 
		}
	}	
}
function cbo_recipe_ontextchanged(obj:Combo, e:TextChangedEventInfo)
{
	obj.userdata   = e.posttext;
	obj.userchange = "1";
}

function cbo_recipe_onkillfocus(obj:Combo, e:KillFocusEventInfo)
{
	var strValue,nFRow,objDs,strDataColumn;
	
	strValue 		= obj.userdata;
	objDs			= eval(obj.innerdataset);
	strDataColumn	= obj.datacolumn;
	
	if (gfn_length(strValue) > 0) {
		nFRow = objDs.findRow(strDataColumn,strValue);
		
		if (nFRow == -1)
		{
			var nRow = objDs.addRow();
			objDs.setColumn(nRow,strDataColumn,strValue);
			obj.value = strValue;
		} else {
			obj.value = strValue;
		}
	} else {
		obj.index 		= 0;
	}
}

function cbo_recipe_onkeydown(obj:Combo, e:KeyEventInfo)
{
	if (e.keycode == 13 && obj.userchange == "1") {
		var strValue,nFRow,objDs,strDataColumn;
		
		strValue 		= obj.userdata;
		objDs			= eval(obj.innerdataset);
		strDataColumn	= obj.datacolumn;
		
		if (gfn_length(strValue)>0) {
			nFRow = objDs.findRow(strDataColumn,strValue);
			
			if (nFRow == -1)
			{
				var nRow = objDs.addRow();
				objDs.setColumn(nRow,strDataColumn,strValue);
				obj.index = nRow;
			} else {
				obj.index = nFRow;
			}
		}
		//화면별 처리 시작
		div_cmnBtn.btn_search.setFocus();
		div_cmnBtn.btn_search.click();
		//화면별 처리 끝
		obj.setFocus();
		
	} else if (e.keycode == 38 || e.keycode == 40) {
		if ( obj.isDropdown() ) {
			obj.userchange = "2";
		} else {
			obj.userchange = "1";
		}
	}
}

function cbo_recipe_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	if ( obj.userchange == "2" ) {
		obj.userchange = "0";
		obj.userdata   = e.posttext;
		//화면별 처리 시작
		div_cmnBtn.btn_search.setFocus();
		div_cmnBtn.btn_search.click();
		//화면별 처리 끝
		obj.setFocus();
	} else {
	    obj.userchange = "1";
		obj.userdata = e.posttext;
	}
}
]]></Script>
  </Form>
</FDL>

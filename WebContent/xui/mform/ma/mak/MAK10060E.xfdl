<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="MAK10060E" onkeydown="fn_form_OnKeyDown" onload="form_onload" titletext="신규수주실적관리" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static28" class="sta_WFDA_Labelbg" position="absolute 469 555 602 582"/>
        <Static id="Static29" class="sta_WFDA_Labelbg" position="absolute 601 555 735 582"/>
        <Static id="Static30" class="sta_WFDA_Labelbg" position="absolute 734 555 877 582"/>
        <Static id="Static31" class="sta_WFDA_Labelbg" position="absolute 876 555 992 582"/>
        <Static id="Static32" class="sta_WFDA_Labelbg" position="absolute 991 555 1101 582"/>
        <Static id="Static35" class="sta_WFDA_Labelbg" position="absolute 734 581 1101 608"/>
        <Static id="Static36" class="sta_WFDA_Labelbg" position="absolute 601 581 735 608"/>
        <Static id="Static37" class="sta_WFDA_Labelbg" position="absolute 469 581 602 608"/>
        <Static id="Static27" class="sta_WFDA_Labelbg" position="absolute 0 658 1101 710"/>
        <Static id="Static26" class="sta_WFDA_Labelbg" position="absolute 0 607 1101 659"/>
        <Static id="Static25" class="sta_WFDA_Labelbg" position="absolute 0 581 469 608"/>
        <Static id="Static20" class="sta_WFDA_Labelbg" position="absolute 0 555 469 582"/>
        <Static id="Static19" class="sta_WFDA_Labelbg" position="absolute 0 529 1101 556"/>
        <Static id="Static18" class="sta_WFDA_Labelbg" position="absolute 0 503 1101 530"/>
        <Static id="Static17" class="sta_WFDA_Labelbg" position="absolute 0 477 1101 504"/>
        <Static id="Static16" class="sta_WFDA_Labelbg" position="absolute 0 451 1101 478"/>
        <Static id="Static00" class="sta_WFDA_Labelbg" position="absolute 0 451 992 478"/>
        <Div id="div_cmnBtn" taborder="33" text="Div0" url="cmn::CmnBtn.xfdl" position="absolute 0 0 1237 30" anchor="left top right" scrollbars="none"/>
        <Grid autoenter="select" binddataset="ds_list" cellsizingtype="both" readonly="false" enable="true" cellsizebandtype="allband" id="grid_List" useinputpanel="false" onheadclick="grid_List_OnHeadClick" taborder="34" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 86 1237 420" selecttype="row" anchor="left top right">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="45" band="left"/>
                <Column size="82" band="left"/>
                <Column size="160" band="left"/>
                <Column size="66" band="left"/>
                <Column size="106" band="left"/>
                <Column size="106"/>
                <Column size="106"/>
                <Column size="123"/>
                <Column size="123"/>
                <Column size="160"/>
                <Column size="116"/>
                <Column size="106"/>
                <Column size="106"/>
                <Column size="106"/>
                <Column size="106"/>
                <Column size="106"/>
                <Column size="106"/>
                <Column size="106"/>
                <Column size="106"/>
                <Column size="106"/>
                <Column size="106"/>
                <Column size="106"/>
                <Column size="106"/>
                <Column size="106"/>
                <Column size="106"/>
                <Column size="106"/>
                <Column size="106"/>
                <Column size="106"/>
                <Column size="106"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" style="background:#566572ff;" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="수주일"/>
                <Cell col="2" displaytype="text" text="업장"/>
                <Cell col="3" displaytype="text" text="직군1"/>
                <Cell col="4" displaytype="text" text="직군2"/>
                <Cell col="5" displaytype="text" text="매출액(년간)"/>
                <Cell col="6" displaytype="text" text="일식수"/>
                <Cell col="7" displaytype="text" text="마케팅부서"/>
                <Cell col="8" displaytype="text" text="수주구분(EIS)"/>
                <Cell col="9" displaytype="text" text="업장DEPT_ID"/>
                <Cell col="10" displaytype="text" text="운영부서"/>
                <Cell col="11" displaytype="text" text="지역1"/>
                <Cell col="12" displaytype="text" text="지역2"/>
                <Cell col="13" displaytype="text" text="OPEN일"/>
                <Cell col="14" displaytype="text" text="수주담당자"/>
                <Cell col="15" displaytype="text" text="운영담당자"/>
                <Cell col="16" displaytype="text" text="투자계획"/>
                <Cell col="17" displaytype="text" text="임대보증금"/>
                <Cell col="18" displaytype="text" text="계약기간Fr"/>
                <Cell col="19" displaytype="text" text="계약기간To"/>
                <Cell col="20" displaytype="text" text="식단가1구분"/>
                <Cell col="21" displaytype="text" text="식단가1"/>
                <Cell col="22" displaytype="text" text="식단가2구분"/>
                <Cell col="23" displaytype="text" text="식단가2"/>
                <Cell col="24" displaytype="text" text="식단가3구분"/>
                <Cell col="25" displaytype="text" text="식단가3"/>
                <Cell col="26" displaytype="text" text="년간매출이익"/>
                <Cell col="27" displaytype="text" text="비고"/>
                <Cell col="28" displaytype="text" text="특약사항"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="date" style="align:center;" text="bind:ORDER_DATE"/>
                <Cell col="2" style="align:left;" text="bind:UPJANGNM"/>
                <Cell col="3" style="align:center;" text="bind:JOB_CDNM"/>
                <Cell col="4" style="align:left;" text="bind:SUB_JOB_CDNM"/>
                <Cell col="5" displaytype="number" style="align:right;" text="bind:SALE_YEAR"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:MEAL_CNT"/>
                <Cell col="7" style="align:left;" text="bind:ORD_DEPT_IDNM"/>
                <Cell col="8" style="align:left;" text="bind:ORD_DEPT_GUBUNNM"/>
                <Cell col="9" style="align:left;" text="bind:UPJANGDEPT_IDNM"/>
                <Cell col="10" style="align:left;" text="bind:MGMT_DEPT_IDNM"/>
                <Cell col="11" style="align:left;" text="bind:LOC_CDNM"/>
                <Cell col="12" style="align:left;" text="bind:SUB_LOC_CDNM"/>
                <Cell col="13" displaytype="date" style="align:center;" text="bind:OPEN_DATE"/>
                <Cell col="14" style="align:left;" text="bind:ORD_SABUNNM"/>
                <Cell col="15" style="align:left;" text="bind:MGMT_SABUNNM"/>
                <Cell col="16" displaytype="number" style="align:left;" text="bind:INVEST_PLAN"/>
                <Cell col="17" displaytype="number" style="align:right;" text="bind:GUARANTY_AMT"/>
                <Cell col="18" displaytype="expr:iif(gfn_isNull(OP_CTRT_DATE), 'none', 'date')" style="align:center;" text="bind:OP_CTRT_DATE"/>
                <Cell col="19" displaytype="expr:iif(gfn_isNull(OP_ECTRT_DATE), 'none', 'date')" style="align:center;" text="bind:OP_ECTRT_DATE"/>
                <Cell col="20" style="align:left;" text="bind:MEAL_UPRICE_1_TEXT"/>
                <Cell col="21" displaytype="number" style="align:right;" text="bind:MEAL_UPRICE_1"/>
                <Cell col="22" style="align:left;" text="bind:MEAL_UPRICE_2_TEXT"/>
                <Cell col="23" displaytype="number" style="align:right;" text="bind:MEAL_UPRICE_2"/>
                <Cell col="24" style="align:left;" text="bind:MEAL_UPRICE_3_TEXT"/>
                <Cell col="25" displaytype="number" style="align:right;" text="bind:MEAL_UPRICE_3"/>
                <Cell col="26" displaytype="number" style="align:right;" text="bind:PROFIE_YEAR"/>
                <Cell col="27" style="align:left;" text="bind:BIGO_DESC"/>
                <Cell col="28" style="align:left;" text="bind:SPECIAL_DESC"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static01" position="absolute 0 30 1237 71" class="sta_WFSA_Labelbg" anchor="left top right"/>
        <Static id="Static1" text="수주일자" position="absolute 540 40 622 61" class="sta_WFSA_label"/>
        <Static id="st_BOOK_ID" text="수주번호" position="absolute 0 451 80 478" class="sta_WFDA_Label01"/>
        <Button id="edtBtn_Date" onclick="g_CalButton_OnClick" taborder="36" tabstop="false" userdata="me_ORDER_DATEQuery" position="absolute 684 40 704 61" class="btn_WF_popSearch" text="" image=""/>
        <MaskEdit id="me_ORDER_DATEQuery" mask="####-##-##" ontextchanged="me_ORDER_DATEQuery_OnChanged" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="3" type="string" position="absolute 609 40 685 61"/>
        <Static id="st_ORD_DEPT_IDQuery" text="수주부서" userdata="strMAQuery_DEPT_ID" position="absolute 15 40 77 61" class="sta_WFSA_label"/>
        <Static id="Static9" text="특약사항" position="absolute 0 607 80 659" class="sta_WFDA_Label01"/>
        <TextArea lengthunit="asciii" id="ta_SPECIAL_DESC" imemode="native" maxlength="2000" taborder="31" position="absolute 82 610 1098 656"/>
        <Static id="st_UPJANGNM" text="업장명" position="absolute 167 451 247 478" class="sta_WFDA_Label01"/>
        <Static id="st_ORDER_DATE" text="수주일" position="absolute 923 477 1003 504" class="sta_WFDA_Label01"/>
        <MaskEdit id="me_ORDER_DATE" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="12" type="string" position="absolute 1005 480 1078 501" class="msk_WF_EssentialCal"/>
        <Button enable="false" id="edtBtn_ORDER_DATE" onclick="g_CalButton_OnClick" taborder="38" tabstop="false" userdata="me_ORDER_DATE" position="absolute 1077 480 1098 501" class="btn_WF_popSearchEssential" text="" image=""/>
        <Static id="st_ORD_SABUNQuery" text="수주담당자" userdata="strMAQuery_SABUN" position="absolute 305 40 381 61" class="sta_WFSA_label"/>
        <Edit enable="false" id="edt_BOOK_ID" readonly="true" taborder="40" position="absolute 82 454 165 475"/>
        <Edit id="edt_ORD_DEPT_IDQuery" ontextchanged="edt_ORD_DEPT_IDQuery_OnChanged" onkeydown="edt_ORD_DEPT_IDQuery_OnKeyDown" readonly="true" taborder="1" position="absolute 82 40 256 61" class="edt_WF_Essential"/>
        <Button id="edtBtn_ORD_DEPT_IDQuery" onclick="edtBtn_ORD_DEPT_IDQuery_OnClick" taborder="41" tabstop="false" position="absolute 255 40 275 61" class="btn_WF_popSearchEssential" text="" image=""/>
        <Button id="edtBtn_ORD_SABUNQuery" onclick="edtBtn_ORD_DEPT_IDQuery_OnClick" taborder="42" tabstop="false" position="absolute 490 40 510 61" class="btn_WF_popSearch" text="" image=""/>
        <Edit id="edt_ORD_SABUNQuery" imemode="none" ontextchanged="edt_ORD_DEPT_IDQuery_OnChanged" onkeydown="edt_ORD_DEPT_IDQuery_OnKeyDown" readonly="true" taborder="2" position="absolute 387 40 491 61"/>
        <Edit lengthunit="asciii" id="edt_UPJANGNM" imemode="native" maxlength="200" taborder="4" position="absolute 249 454 403 475" class="edt_WF_Essential"/>
        <Static id="st_JOB_CD" text="직군1" userdata="strMAQuery_MAJOB" position="absolute 405 451 485 478" class="sta_WFDA_Label01"/>
        <Edit id="edt_JOB_CD" onkeydown="edt_JOB_CD_OnKeyDown" readonly="true" taborder="5" position="absolute 487 454 561 475"/>
        <Button enable="false" id="edtBtn_JOB_CD" onclick="edtBtn_JOB_CD_OnClick" taborder="43" tabstop="false" position="absolute 560 454 581 475" class="btn_WF_popSearch" text="" image=""/>
        <Button enable="false" id="edtBtn_SUB_JOB_CD" onclick="edtBtn_JOB_CD_OnClick" taborder="45" tabstop="false" position="absolute 560 480 581 501" class="btn_WF_popSearch" text="" image=""/>
        <Edit id="edt_SUB_JOB_CD" onkeydown="edt_JOB_CD_OnKeyDown" readonly="true" taborder="6" position="absolute 487 480 561 501"/>
        <Static id="st_SUB_JOB_CD" text="직군2" userdata="strMAQuery_MASUBJOB" position="absolute 405 477 485 504" class="sta_WFDA_Label01"/>
        <Static id="st_LOC_CD" text="지역1" userdata="strMAQueryLocal_LOC_CD" position="absolute 583 451 663 478" class="sta_WFDA_Label01"/>
        <Edit id="edt_LOC_CD" onkeydown="edt_JOB_CD_OnKeyDown" readonly="true" taborder="7" position="absolute 665 454 723 475"/>
        <Button enable="false" id="edtBtn_LOC_CD" onclick="edtBtn_JOB_CD_OnClick" taborder="44" tabstop="false" position="absolute 722 454 743 475" class="btn_WF_popSearch" text="" image=""/>
        <Button enable="false" id="edtBtn_SUB_LOC_CD" onclick="edtBtn_JOB_CD_OnClick" taborder="46" tabstop="false" position="absolute 722 480 743 501" class="btn_WF_popSearch" text="" image=""/>
        <Edit id="edt_SUB_LOC_CD" onkeydown="edt_JOB_CD_OnKeyDown" readonly="true" taborder="8" position="absolute 665 480 723 501"/>
        <Static id="st_SUB_LOC_CD" text="지역2" userdata="strMAQuery_SUB_LOC_CD" position="absolute 583 477 663 504" class="sta_WFDA_Label01"/>
        <Static id="st_ORD_DEPT_ID" text="수주부서" userdata="strMAQuery_DEPT_ID" position="absolute 745 451 825 478" class="sta_WFDA_Label01"/>
        <Edit id="edt_ORD_DEPT_ID" onkeydown="edt_JOB_CD_OnKeyDown" readonly="true" taborder="9" position="absolute 827 454 901 475"/>
        <Button enable="false" id="edtBtn_ORD_DEPT_ID" onclick="edtBtn_JOB_CD_OnClick" taborder="47" tabstop="false" position="absolute 900 454 921 475" class="btn_WF_popSearch" text="" image=""/>
        <Button enable="false" id="edtBtn_ORD_SABUN" onclick="edtBtn_JOB_CD_OnClick" taborder="48" tabstop="false" position="absolute 900 480 921 501" class="btn_WF_popSearch" text="" image=""/>
        <Edit id="edt_ORD_SABUN" onkeydown="edt_JOB_CD_OnKeyDown" readonly="true" taborder="10" position="absolute 827 480 901 501"/>
        <Static id="st_ORD_SABUN" text="수주담당자" userdata="strMAQuery_SABUN" position="absolute 745 477 825 504" class="sta_WFDA_Label01"/>
        <Static id="Static5" text="매출/손익" position="absolute 0 477 80 530" class="sta_WFDA_Label01"/>
        <Static id="st_SALE_YEAR" text="평균연매출" position="absolute 79 477 182 504" class="sta_WFDA_Label01"/>
        <MaskEdit id="me_SALE_YEAR" mask="###,##0" taborder="13" position="absolute 82 506 140 527" class="msk_WF_Essential"/>
        <Static id="st_PROFIE_YEAR" text="평균연매출이익" position="absolute 181 477 292 504" class="sta_WFDA_Label01"/>
        <MaskEdit id="me_PROFIE_YEAR" mask="###,##0" taborder="14" position="absolute 184 506 238 527"/>
        <Static id="st_MGMT_DEPT_ID" text="운영부서" userdata="strMAQuery_DEPT_ID" position="absolute 79 555 159 582" class="sta_WFDA_Label01"/>
        <Static enable="false" id="st_MGMT_SABUN" text="운영담당자" userdata="strMAQuery_SABUN" visible="false" position="absolute 79 581 159 608" class="sta_WFDA_Label01"/>
        <Edit id="edt_MGMT_DEPT_ID" onkeydown="edt_JOB_CD_OnKeyDown" readonly="true" taborder="21" position="absolute 161 558 368 579"/>
        <Edit enable="false" id="edt_MGMT_SABUN" onkeydown="edt_JOB_CD_OnKeyDown" readonly="true" taborder="22" visible="false" position="absolute 161 584 368 605"/>
        <Button enable="false" id="edtBtn_MGMT_DEPT_ID" onclick="edtBtn_JOB_CD_OnClick" taborder="49" tabstop="false" position="absolute 367 558 388 579" class="btn_WF_popSearch" text="" image=""/>
        <Button enable="false" id="edtBtn_MGMT_SABUN" onclick="edtBtn_JOB_CD_OnClick" taborder="50" tabstop="false" visible="false" position="absolute 367 584 388 605" class="btn_WF_popSearch" text="" image=""/>
        <Static id="st_MEAL_CNT" text="일식수" position="absolute 405 503 485 530" class="sta_WFDA_Label01"/>
        <MaskEdit id="me_MEAL_CNT" taborder="16" position="absolute 487 506 581 527"/>
        <Static id="st_INVEST_PLAN" text="투자계획" position="absolute 859 503 939 530" class="sta_WFDA_Label01"/>
        <MaskEdit id="me_INVEST_PLAN" mask="###,##0" taborder="18" position="absolute 941 506 1045 527"/>
        <Static id="st_GUARANTY_AMT" text="임대보증금" position="absolute 583 503 663 530" class="sta_WFDA_Label01"/>
        <MaskEdit id="me_GUARANTY_AMT" taborder="17" position="absolute 665 506 769 527" mask="###,##0"/>
        <Static id="Static24" text="백만원" position="absolute 772 506 812 527"/>
        <Static id="Static0" text="백만원" position="absolute 1048 506 1085 527"/>
        <Static id="Static8" text="백만원" position="absolute 241 506 281 527"/>
        <Static id="Static10" text="백만원" position="absolute 143 506 183 527"/>
        <Static id="st_OPEN_DATE" text="OPEN일" position="absolute 876 529 992 556" class="sta_WFDA_Label01"/>
        <MaskEdit id="me_OPEN_DATE" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="29" type="string" position="absolute 879 558 969 579" class="msk_WF_EssentialCal"/>
        <Button enable="false" id="edtBtn_OPEN_DATE" onclick="g_CalButton_OnClick" taborder="51" tabstop="false" userdata="me_OPEN_DATE" position="absolute 968 558 989 579" class="btn_WF_popSearchEssential" text="" image=""/>
        <Static id="Static12" text="운영정보" position="absolute 0 555 80 608" class="sta_WFDA_Label01"/>
        <Static id="st_MEAL_UPRICE_1" text="식단가1" position="absolute 469 529 602 556" class="sta_WFDA_Label01"/>
        <Static id="st_MEAL_UPRICE_2" text="식단가2" position="absolute 601 529 735 556" class="sta_WFDA_Label01"/>
        <Static id="st_MEAL_UPRICE_3" text="식단가3" position="absolute 734 529 877 556" class="sta_WFDA_Label01"/>
        <Static id="Static14" text="식단가" position="absolute 390 529 470 608" class="sta_WFDA_Label01"/>
        <MaskEdit id="me_MEAL_UPRICE_1" mask="###,##0" taborder="24" position="absolute 472 584 581 605"/>
        <Static id="Static42" text="원" position="absolute 584 584 597 605"/>
        <MaskEdit id="me_MEAL_UPRICE_2" mask="###,##0" taborder="26" position="absolute 604 584 710 605"/>
        <Static id="Static43" text="원" position="absolute 713 584 726 605"/>
        <MaskEdit id="me_MEAL_UPRICE_3" mask="###,##0" taborder="28" position="absolute 737 584 847 605"/>
        <Static id="Static44" text="원" position="absolute 850 584 863 605"/>
        <Static id="Static15" text="비고" position="absolute 0 658 80 710" class="sta_WFDA_Label01"/>
        <TextArea lengthunit="asciii" id="ta_BIGO_DESC" imemode="native" maxlength="2000" taborder="32" position="absolute 82 661 1098 707"/>
        <MaskEdit id="me_OP_CTRT_DATE" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="19" type="string" position="absolute 82 532 171 553" class="msk_WF_Cal"/>
        <Button enable="false" id="edtBtn_OP_CTRT_DATE" onclick="g_CalButton_OnClick" taborder="52" tabstop="false" userdata="me_OP_CTRT_DATE" position="absolute 170 532 191 553" class="btn_WF_popSearch" text="" image=""/>
        <Static id="Static4" text="~" position="absolute 221 532 229 553"/>
        <MaskEdit id="me_OP_ECTRT_DATE" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="20" type="string" position="absolute 259 532 348 553" class="msk_WF_Cal"/>
        <Button enable="false" id="edtBtn_OP_ECTRT_DATE" onclick="g_CalButton_OnClick" taborder="53" tabstop="false" userdata="me_OP_ECTRT_DATE" position="absolute 347 532 368 553" class="btn_WF_popSearch" text="" image=""/>
        <Static id="Static6" text="계약기간" position="absolute 0 529 80 556" class="sta_WFDA_Label01"/>
        <Static id="st_SALE_CURR_YEAR" text="예상당년신규매출" position="absolute 291 477 406 504" class="sta_WFDA_Label01"/>
        <MaskEdit id="me_SALE_CURR_YEAR" mask="###,##0" taborder="15" position="absolute 294 506 356 527"/>
        <Static id="Static13" text="백만원" position="absolute 359 506 396 527"/>
        <Edit lengthunit="asciii" id="edt_MEAL_UPRICE_1_TEXT" imemode="native" maxlength="200" taborder="23" position="absolute 472 558 599 579"/>
        <Edit lengthunit="asciii" id="edt_MEAL_UPRICE_2_TEXT" imemode="native" maxlength="200" taborder="25" position="absolute 604 558 732 579"/>
        <Edit lengthunit="asciii" id="edt_MEAL_UPRICE_3_TEXT" imemode="native" maxlength="200" taborder="27" position="absolute 737 558 874 579"/>
        <Static id="st_ORD_DEPT_GUBUN" text="EIS" userdata="strMAQueryLocal_ORD_DEPT_GUBUN" position="absolute 923 451 1003 478" class="sta_WFDA_Label01"/>
        <Edit id="edt_ORD_DEPT_GUBUN" onkeydown="edt_JOB_CD_OnKeyDown" readonly="true" taborder="11" position="absolute 1005 454 1078 475" class="edt_WF_Essential"/>
        <Button enable="false" id="edtBtn_ORD_DEPT_GUBUN" onclick="edtBtn_JOB_CD_OnClick" taborder="55" tabstop="false" position="absolute 1077 454 1098 475" class="btn_WF_popSearchEssential" text="" image=""/>
        <Static id="st_UPJANGDEPT_ID" text="업장DEPT_ID" userdata="strMAQuery_DEPT_ID" position="absolute 991 529 1101 556" class="sta_WFDA_Label01"/>
        <Edit id="edt_UPJANGDEPT_ID" onkeydown="edt_JOB_CD_OnKeyDown" readonly="true" taborder="30" position="absolute 994 558 1078 579" class="edt_WF_Essential"/>
        <Button enable="false" id="edtBtn_UPJANGDEPT_ID" onclick="edtBtn_JOB_CD_OnClick" taborder="58" tabstop="false" position="absolute 1077 558 1098 579" class="btn_WF_popSearchEssential" text="" image=""/>
        <Static id="Static02" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static09" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Static id="Static03" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 72 40 82 61" anchor="left top"/>
        <Static id="Static07" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 377 40 387 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 599 40 609 61" anchor="left top"/>
        <Static id="Static21" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 420 450 433" anchor="left top"/>
        <Static id="Static22" text="신규수주 상세내역" class="sta_WF_Title01" position="absolute 0 433 450 451" anchor="left top"/>
        <Static id="Static23" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 446 450 451" anchor="left top"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond"/>
      <Dataset id="ds_listInput" cancolumnchange="ds_listInput_CanColumnChange" oncolumnchanged="ds_listInput_OnColumnChanged">
        <ColumnInfo>
          <Column id="BIGO_DESC" size="2000" type="STRING"/>
          <Column id="BOOK_ID" size="22" type="BIGDECIMAL"/>
          <Column id="GUARANTY_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="INVEST_PLAN" size="22" type="BIGDECIMAL"/>
          <Column id="JOB_CD" size="3" type="STRING"/>
          <Column id="JOB_CDNM" size="20" type="STRING"/>
          <Column id="LOC_CD" size="20" type="STRING"/>
          <Column id="LOC_CDNM" size="100" type="STRING"/>
          <Column id="MEAL_CNT" size="22" type="BIGDECIMAL"/>
          <Column id="MEAL_UPRICE_1" size="22" type="BIGDECIMAL"/>
          <Column id="MEAL_UPRICE_2" size="22" type="BIGDECIMAL"/>
          <Column id="MEAL_UPRICE_3" size="22" type="BIGDECIMAL"/>
          <Column id="MGMT_DEPT_ID" size="22" type="BIGDECIMAL"/>
          <Column id="MGMT_DEPT_IDNM" size="50" type="STRING"/>
          <Column id="MGMT_SABUN" size="9" type="STRING"/>
          <Column id="MGMT_SABUNNM" size="20" type="STRING"/>
          <Column id="OP_CTRT_DATE" size="8" type="STRING"/>
          <Column id="OP_ECTRT_DATE" size="8" type="STRING"/>
          <Column id="OPEN_DATE" size="8" type="STRING"/>
          <Column id="ORD_DEPT_ID" size="22" type="BIGDECIMAL"/>
          <Column id="ORD_DEPT_IDNM" size="50" type="STRING"/>
          <Column id="ORD_SABUN" size="9" type="STRING"/>
          <Column id="ORD_SABUNNM" size="20" type="STRING"/>
          <Column id="ORDER_DATE" size="8" type="STRING"/>
          <Column id="PROFIE_YEAR" size="22" type="BIGDECIMAL"/>
          <Column id="SALE_YEAR" size="22" type="BIGDECIMAL"/>
          <Column id="SPECIAL_DESC" size="2000" type="STRING"/>
          <Column id="SUB_JOB_CD" size="6" type="STRING"/>
          <Column id="SUB_JOB_CDNM" size="20" type="STRING"/>
          <Column id="SUB_LOC_CD" size="20" type="STRING"/>
          <Column id="SUB_LOC_CDNM" size="100" type="STRING"/>
          <Column id="UPJANGNM" size="200" type="STRING"/>
          <Column id="SALE_CURR_YEAR" size="256" type="BIGDECIMAL"/>
          <Column id="MEAL_UPRICE_1_TEXT" size="256" type="STRING"/>
          <Column id="MEAL_UPRICE_2_TEXT" size="256" type="STRING"/>
          <Column id="MEAL_UPRICE_3_TEXT" size="256" type="STRING"/>
          <Column id="ORD_DEPT_GUBUN" size="256" type="STRING"/>
          <Column id="ORD_DEPT_GUBUNNM" size="256" type="STRING"/>
          <Column id="UPJANGDEPT_ID" size="256" type="STRING"/>
          <Column id="UPJANGDEPT_IDNM" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list" onrowposchanged="ds_list_OnRowPosChanged">
        <ColumnInfo>
          <Column id="BIGO_DESC" size="2000" type="STRING"/>
          <Column id="BOOK_ID" size="22" type="BIGDECIMAL"/>
          <Column id="GUARANTY_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="INVEST_PLAN" size="22" type="BIGDECIMAL"/>
          <Column id="JOB_CD" size="3" type="STRING"/>
          <Column id="JOB_CDNM" size="20" type="STRING"/>
          <Column id="LOC_CD" size="20" type="STRING"/>
          <Column id="LOC_CDNM" size="100" type="STRING"/>
          <Column id="MEAL_CNT" size="22" type="BIGDECIMAL"/>
          <Column id="MEAL_UPRICE_1" size="22" type="BIGDECIMAL"/>
          <Column id="MEAL_UPRICE_2" size="22" type="BIGDECIMAL"/>
          <Column id="MEAL_UPRICE_3" size="22" type="BIGDECIMAL"/>
          <Column id="MGMT_DEPT_ID" size="22" type="BIGDECIMAL"/>
          <Column id="MGMT_DEPT_IDNM" size="50" type="STRING"/>
          <Column id="MGMT_SABUN" size="9" type="STRING"/>
          <Column id="MGMT_SABUNNM" size="20" type="STRING"/>
          <Column id="OP_CTRT_DATE" size="8" type="STRING"/>
          <Column id="OP_ECTRT_DATE" size="8" type="STRING"/>
          <Column id="OPEN_DATE" size="8" type="STRING"/>
          <Column id="ORD_DEPT_ID" size="22" type="BIGDECIMAL"/>
          <Column id="ORD_DEPT_IDNM" size="50" type="STRING"/>
          <Column id="ORD_SABUN" size="9" type="STRING"/>
          <Column id="ORD_SABUNNM" size="20" type="STRING"/>
          <Column id="ORDER_DATE" size="8" type="STRING"/>
          <Column id="PROFIE_YEAR" size="22" type="BIGDECIMAL"/>
          <Column id="SALE_YEAR" size="22" type="BIGDECIMAL"/>
          <Column id="SPECIAL_DESC" size="2000" type="STRING"/>
          <Column id="SUB_JOB_CD" size="6" type="STRING"/>
          <Column id="SUB_JOB_CDNM" size="20" type="STRING"/>
          <Column id="SUB_LOC_CD" size="20" type="STRING"/>
          <Column id="SUB_LOC_CDNM" size="100" type="STRING"/>
          <Column id="UPJANGNM" size="200" type="STRING"/>
          <Column id="SALE_CURR_YEAR" size="256" type="BIGDECIMAL"/>
          <Column id="MEAL_UPRICE_1_TEXT" size="256" type="STRING"/>
          <Column id="MEAL_UPRICE_2_TEXT" size="256" type="STRING"/>
          <Column id="MEAL_UPRICE_3_TEXT" size="256" type="STRING"/>
          <Column id="ORD_DEPT_GUBUN" size="256" type="STRING"/>
          <Column id="ORD_DEPT_GUBUNNM" size="256" type="STRING"/>
          <Column id="UPJANGDEPT_ID" size="256" type="STRING"/>
          <Column id="UPJANGDEPT_IDNM" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="ta_SPECIAL_DESC_value" compid="ta_SPECIAL_DESC" propid="value" datasetid="ds_listInput" columnid="SPECIAL_DESC"/>
      <BindItem id="me_ORDER_DATE_value" compid="me_ORDER_DATE" propid="value" datasetid="ds_listInput" columnid="ORDER_DATE"/>
      <BindItem id="edt_BOOK_ID_value" compid="edt_BOOK_ID" propid="value" datasetid="ds_listInput" columnid="BOOK_ID"/>
      <BindItem id="edt_UPJANGNM_value" compid="edt_UPJANGNM" propid="value" datasetid="ds_listInput" columnid="UPJANGNM"/>
      <BindItem id="edt_JOB_CD_value" compid="edt_JOB_CD" propid="value" datasetid="ds_listInput" columnid="JOB_CDNM"/>
      <BindItem id="edt_SUB_JOB_CD_value" compid="edt_SUB_JOB_CD" propid="value" datasetid="ds_listInput" columnid="SUB_JOB_CDNM"/>
      <BindItem id="edt_LOC_CD_value" compid="edt_LOC_CD" propid="value" datasetid="ds_listInput" columnid="LOC_CDNM"/>
      <BindItem id="edt_SUB_LOC_CD_value" compid="edt_SUB_LOC_CD" propid="value" datasetid="ds_listInput" columnid="SUB_LOC_CDNM"/>
      <BindItem id="edt_ORD_DEPT_ID_value" compid="edt_ORD_DEPT_ID" propid="value" datasetid="ds_listInput" columnid="ORD_DEPT_IDNM"/>
      <BindItem id="edt_ORD_SABUN_value" compid="edt_ORD_SABUN" propid="value" datasetid="ds_listInput" columnid="ORD_SABUNNM"/>
      <BindItem id="me_SALE_YEAR_value" compid="me_SALE_YEAR" propid="value" datasetid="ds_listInput" columnid="SALE_YEAR"/>
      <BindItem id="me_PROFIE_YEAR_value" compid="me_PROFIE_YEAR" propid="value" datasetid="ds_listInput" columnid="PROFIE_YEAR"/>
      <BindItem id="edt_MGMT_DEPT_ID_value" compid="edt_MGMT_DEPT_ID" propid="value" datasetid="ds_listInput" columnid="MGMT_DEPT_IDNM"/>
      <BindItem id="edt_MGMT_SABUN_value" compid="edt_MGMT_SABUN" propid="value" datasetid="ds_listInput" columnid="MGMT_SABUNNM"/>
      <BindItem id="me_MEAL_CNT_value" compid="me_MEAL_CNT" propid="value" datasetid="ds_listInput" columnid="MEAL_CNT"/>
      <BindItem id="me_INVEST_PLAN_value" compid="me_INVEST_PLAN" propid="value" datasetid="ds_listInput" columnid="INVEST_PLAN"/>
      <BindItem id="me_GUARANTY_AMT_value" compid="me_GUARANTY_AMT" propid="value" datasetid="ds_listInput" columnid="GUARANTY_AMT"/>
      <BindItem id="me_OPEN_DATE_value" compid="me_OPEN_DATE" propid="value" datasetid="ds_listInput" columnid="OPEN_DATE"/>
      <BindItem id="me_MEAL_UPRICE_1_value" compid="me_MEAL_UPRICE_1" propid="value" datasetid="ds_listInput" columnid="MEAL_UPRICE_1"/>
      <BindItem id="me_MEAL_UPRICE_2_value" compid="me_MEAL_UPRICE_2" propid="value" datasetid="ds_listInput" columnid="MEAL_UPRICE_2"/>
      <BindItem id="me_MEAL_UPRICE_3_value" compid="me_MEAL_UPRICE_3" propid="value" datasetid="ds_listInput" columnid="MEAL_UPRICE_3"/>
      <BindItem id="ta_BIGO_DESC_value" compid="ta_BIGO_DESC" propid="value" datasetid="ds_listInput" columnid="BIGO_DESC"/>
      <BindItem id="me_OP_CTRT_DATE_value" compid="me_OP_CTRT_DATE" propid="value" datasetid="ds_listInput" columnid="OP_CTRT_DATE"/>
      <BindItem id="me_OP_ECTRT_DATE_value" compid="me_OP_ECTRT_DATE" propid="value" datasetid="ds_listInput" columnid="OP_ECTRT_DATE"/>
      <BindItem id="me_SALE_CURR_YEAR_value" compid="me_SALE_CURR_YEAR" propid="value" datasetid="ds_listInput" columnid="SALE_CURR_YEAR"/>
      <BindItem id="edt_MEAL_UPRICE_1_TEXT_value" compid="edt_MEAL_UPRICE_1_TEXT" propid="value" datasetid="ds_listInput" columnid="MEAL_UPRICE_1_TEXT"/>
      <BindItem id="edt_MEAL_UPRICE_2_TEXT_value" compid="edt_MEAL_UPRICE_2_TEXT" propid="value" datasetid="ds_listInput" columnid="MEAL_UPRICE_2_TEXT"/>
      <BindItem id="edt_MEAL_UPRICE_3_TEXT_value" compid="edt_MEAL_UPRICE_3_TEXT" propid="value" datasetid="ds_listInput" columnid="MEAL_UPRICE_3_TEXT"/>
      <BindItem id="edt_ORD_DEPT_GUBUN_value" compid="edt_ORD_DEPT_GUBUN" propid="value" datasetid="ds_listInput" columnid="ORD_DEPT_GUBUNNM"/>
      <BindItem id="edt_UPJANGDEPT_ID_value" compid="edt_UPJANGDEPT_ID" propid="value" datasetid="ds_listInput" columnid="UPJANGDEPT_IDNM"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : FS시스템/시스템공통/템플릿 1
 * 프로그램명   : Sam_Form_Basic1.XML
 * 기      능   : 표준 UI Form
 * 작  성  자   : 구종화
 * 작성  일자   : 2007-11-16
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::ma_common.js"


//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var f_Saved_ID,
	f_AfterCallServerCheck;
	
var f_NewDataCheck;		

//지역코드1########################################################################
var strMAQueryLocal_LOC_CD              = "SELECT CODE, CODE_NAME  FROM SCC_COMMON_CODE  WHERE (GROUP_CODE ='MA0040') ";
var strMAQueryLocal_LOC_CDKeyField      = "CODE";
var strMAQueryLocal_LOC_CDValueField    = "CODE_NAME";
var strMAQueryLocal_LOC_CDKeyFieldNM    = "지역코드";
var strMAQueryLocal_LOC_CDValueFieldNM  = "지역코드명"; 
var strMAQueryLocal_LOC_CDCaption       = "지역코드조회";
var strMAQueryLocal_LOC_CDAllField      = "CODE;CODE_NAME";
//지역코드1########################################################################

//수주구분(EIS)####################################################################
var strMAQueryLocal_ORD_DEPT_GUBUN              = " SELECT ITEM_CD, ITEM_NM FROM HLDC.AL_BAEBU_CODE WHERE HEADER_CD = '306' AND DESCRIPTION2 = 'FC신규수주' ";
var strMAQueryLocal_ORD_DEPT_GUBUNKeyField      = "ITEM_CD";
var strMAQueryLocal_ORD_DEPT_GUBUNValueField    = "ITEM_NM";
var strMAQueryLocal_ORD_DEPT_GUBUNKeyFieldNM    = "수주구분(EIS)";
var strMAQueryLocal_ORD_DEPT_GUBUNValueFieldNM  = "수주구분(EIS)명";
var strMAQueryLocal_ORD_DEPT_GUBUNCaption       = "수주구분(EIS)조회";
var strMAQueryLocal_ORD_DEPT_GUBUNAllField      = "ITEM_CD;ITEM_NM";
//수주구분(EIS)####################################################################

//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

    var F_ArrCol          = new Array(-1);
    var F_ArrColType      = new Array(-1);
    
	//init_btn_setup();	// Button 초기화
	fsp_init(this);


	/*
	#############################################################################################################
	공통코드 SETTING
	#############################################################################################################
	*/	
	
    //fn_Insert();
	/*
	#############################################################################################################
	공통코드 SETTING
	#############################################################################################################
	*/
}





//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
function fn_search()
{
	if (!before_SelectCheck())
		return;


	//리스트############################################################
    fsp_clear(this);
    
	fsp_addSearch(this, "ma/mak:MAK10060E_S001");	

	ds_cond.clear();
	
	ds_cond.addColumn("ORD_DEPT_ID","INT",256);	
	ds_cond.addColumn("ORD_SABUN","STRING",256);	
	ds_cond.addColumn("ORDER_DATE","STRING",256);
			
	ds_cond.addRow();
	
	var n_ORD_DEPT_ID = gfn_isNull(edt_ORD_DEPT_IDQuery.userdata) ? null : edt_ORD_DEPT_IDQuery.userdata;
	
	ds_cond.setColumn(ds_cond.rowposition, "ORD_DEPT_ID",  n_ORD_DEPT_ID);	
	ds_cond.setColumn(ds_cond.rowposition, "ORD_SABUN",    edt_ORD_SABUNQuery.userdata);
	ds_cond.setColumn(ds_cond.rowposition, "ORDER_DATE",   me_ORDER_DATEQuery.value);
					
	fn_DataSetAllClear();

    http.Sync = true;
	fsp_callService(this, "", "", "ds_cond=ds_cond","ds_list=ds_list","","");
	http.Sync = false;	
	//리스트############################################################
	
}

function fn_insert()
{
	if (!before_SelectCheck()) return;
	
		
	ds_listInput.clearData();

	//edtBtn Component 초기화############################
	Set_edtBtn_UserData("Clear");	
	//edtBtn Component 초기화############################

	ds_listInput.addRow();

	ds_listInput_OnColumnChanged(ds_listInput,0,"ORDER_DATE","",ds_listInput.getColumn(ds_listInput.rowposition, "ORDER_DATE"),0);
	//Setds_listInput_OnColumnChanged();
		 
	//Disabled항목 Enabled처리####################################
	edtBtn_JOB_CD.enable         = true;
	edtBtn_SUB_JOB_CD.enable     = true;
	edtBtn_LOC_CD.enable         = true;
	edtBtn_SUB_LOC_CD.enable     = true;
	
	edtBtn_ORD_DEPT_ID.enable    = true;
	edtBtn_ORD_SABUN.enable      = true;
	edtBtn_ORDER_DATE.enable     = true;
	edtBtn_MGMT_DEPT_ID.enable   = true;
	edtBtn_MGMT_SABUN.enable     = true;
	edtBtn_OPEN_DATE.enable      = true;
	edtBtn_ORD_DEPT_GUBUN.enable = true;
	edtBtn_UPJANGDEPT_ID.enable  = true;
	
	
	edtBtn_OP_CTRT_DATE.enable      = true;
	edtBtn_OP_ECTRT_DATE.enable     = true;
    //Disabled항목 Enabled처리####################################
	
	 
	edt_UPJANGNM.setFocus();
}

function fn_delete()
{
    if (!before_DeleteCheck("Master") ){

		return;
    }
}

function fn_save()
{

    if (!before_SaveCheck("Master") ){


        if (f_NewDataCheck){
			
			ds_listInput.setColumn(ds_listInput.rowposition, "BOOK_ID", "");
        }        
        
		return;
    }
}


function fn_print()
{
}
function fn_Close()
{
	this.close();
}
function fn_help()
{
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================

function fn_SearchDetail()
{

	
}

function before_SelectCheck()
{
    /*
	if (length(edt_MGMT_SABUNQuery.UserData) == 0)
	{
	
		alert("담당마케터를 지정하여 주십시요.");
		edt_MGMT_SABUNQuery.SetFocus();
		return False;
	}
	*/

		
	return true;
}


function before_SaveCheck(str_Gubun)
{

        /*
        업무구분별로 addAction 지정세팅##########################################        
        */
        
        f_Saved_ID = 0;
        f_NewDataCheck = false;
		
        /*
        업무구분별로 addAction 지정세팅##########################################        
        */

		
 		if (ds_listInput.rowcount == 0){

			return;
		}

	    if (str_Gubun == "Master"){

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANGNM"))== 0){    
		
				g_Message("EE", "업장명을 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				edt_UPJANGNM.setFocus();
				return false;
			}
			
			/*
			if (length(ds_listInput.GetColumn(ds_listInput.row, "JOB_CD")) == 0){    
		
				g_Message("EE", "직군1을 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				edt_JOB_CD.SetFocus();
				return False;
			}
			
			if (length(ds_listInput.GetColumn(ds_listInput.row, "SUB_JOB_CD")) == 0){    
		
				g_Message("EE", "직군2를 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				edt_SUB_JOB_CD.SetFocus();
				return False;
			}
			*/
					
			if (toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "SALE_YEAR")) == 0){    
		
				g_Message("EE", "평균연매출를 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				me_SALE_YEAR.setFocus();
				return false;
			}
			
			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ORD_DEPT_GUBUN"))== 0){    
		
				g_Message("EE", "수주구분(EIS)을 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				edt_ORD_DEPT_GUBUN.setFocus();
				return false;
			}    			
					
			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ORDER_DATE"))== 0){    
		
				g_Message("EE", "수주일을 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				me_ORDER_DATE.setFocus();
				return false;
			}    							
						
			/*
			if (toNumber(ds_listInput.GetColumn(ds_listInput.row, "PROFIE_YEAR")) == 0){    
		
				g_Message("EE", "평균연매출이익을 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				me_PROFIE_YEAR.SetFocus();
				return False;
			}               
						
			if (toNumber(ds_listInput.GetColumn(ds_listInput.row, "SALE_CURR_YEAR")) == 0){    
		
				g_Message("EE", "예상당년신규매출을 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				me_SALE_CURR_YEAR.SetFocus();
				return False;
			}       
									
			if (toNumber(ds_listInput.GetColumn(ds_listInput.row, "MEAL_CNT")) == 0){    
		
				g_Message("EE", "일식수를 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				me_MEAL_CNT.SetFocus();
				return False;
			}                 
						
						
 
						 
			if (NumFormat(ds_listInput.GetColumn(ds_listInput.row, "ORD_DEPT_ID")) == "0"){    
		
				g_Message("EE", "수주부서를 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				edt_ORD_DEPT_ID.SetFocus();
				return False;
			}                 
						 
			if (length(ds_listInput.GetColumn(ds_listInput.row, "ORD_SABUN")) == 0){    
		
				g_Message("EE", "수주담당자를 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				edt_ORD_SABUN.SetFocus();
				return False;
			}                     
						 
						 
			if (NumFormat(ds_listInput.GetColumn(ds_listInput.row, "MGMT_DEPT_ID")) == "0"){    
		
				g_Message("EE", "운영부서를 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				edt_MGMT_DEPT_ID.SetFocus();
				return False;
			}                       
						 
			if (length(ds_listInput.GetColumn(ds_listInput.row, "OPEN_DATE")) == 0){    
		
				g_Message("EE", "OPEN예정일 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				me_OPEN_DATE.SetFocus();
				return False;
			}                       
				
			if (toNumber(ds_listInput.GetColumn(ds_listInput.row, "INVEST_PLAN")) == 0){    
		
				g_Message("EE", "투자계획을 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				me_INVEST_PLAN.SetFocus();
				return False;
			}            
				
			if (length(ds_listInput.GetColumn(ds_listInput.row, "LOC_CD")) == 0){    
		
				g_Message("EE", "지역1을 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				edt_LOC_CD.SetFocus();
				return False;
			}  
					
			if (length(ds_listInput.GetColumn(ds_listInput.row, "SUB_LOC_CD")) == 0){    
		
				g_Message("EE", "지역2를 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				edt_SUB_LOC_CD.SetFocus();
				return False;
			}              
				
				
				
			if (length(ds_listInput.GetColumn(ds_listInput.row, "OP_CTRT_DATE")) == 0){    
		
				g_Message("EE", "계약기간Fr을 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				me_OP_CTRT_DATE.SetFocus();
				return False;
			}     
					
			if (length(ds_listInput.GetColumn(ds_listInput.row, "OP_ECTRT_DATE")) == 0){    
		
				g_Message("EE", "계약기간To을 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				me_OP_ECTRT_DATE.SetFocus();
				return False;
			}                 
				
				
			if (length(ds_listInput.GetColumn(ds_listInput.row, "MEAL_UPRICE_1_TEXT")) == 0){    
		
				g_Message("EE", "식단가1구분을 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				edt_MEAL_UPRICE_1_TEXT.SetFocus();
				return False;
			}  				
				
			if (toNumber(ds_listInput.GetColumn(ds_listInput.row, "MEAL_UPRICE_1")) == 0){    
		
				g_Message("EE", "식단가1을 선택하여 주십시요.\n" +
								"확인하여 주십시요.");        
				me_MEAL_UPRICE_1.SetFocus();
				return False;
			}  
		   */
				        
	        //입력일때 Confirm체크##################################
	        if ( 
	             (ds_listInput.rowcount > 0) &&
                 (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "BOOK_ID"))== "0")
	           )
	        {
				if (!g_Confirm("02")) return false;	             
	        }     
	        //입력일때 Confirm체크##################################
	             
	             
	        //수정일때 Confirm체크##################################
            if (
                 (ds_listInput.rowcount > 0) &&
                 (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "BOOK_ID"))!= "0")
               )
            {	        
				if (!g_Confirm("02", "데이터를 수정하시겠습니까?")) return false;
			}
	        //수정일때 Confirm체크##################################
	        
	        
	        
			//각 구분별 대체 마감체크##############################
            if (
                 (ds_listInput.rowcount > 0) &&
                 (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "BOOK_ID"))!= "0")
               )
            {			
				if (!fn_GetALT_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "BOOK_ID"))) return false;
			}
			//각 구분별 대체 마감체크##############################	        
					        
			
			
				
						
			//MST_ID 지정#################################################################
   		    if(!fn_SaveTrxData(ds_listInput.getColumn(ds_listInput.rowposition, "BOOK_ID"))) return false;
			
		}			

        
		//저장#############################################################
	    if (str_Gubun == "Master"){

			
			// action 정보 초기화
			fsp_clear(this);	  		
										    		        
	    
            //기존 라인 및 매출 데이터 삭제.            
            if (
                 (ds_listInput.rowcount > 0) &&
                 (numFormat(f_Saved_ID)!= "0")
               )
            {
  
				fsp_addSingle(this, "ma/mak:MAK10060E_U001");			
            }
            else 
            {
            
			    fsp_addSingle(this, "ma/mak:MAK10060E_I001");			     
            }  	            			
			
			f_Saved_ID = ds_listInput.getColumn(ds_listInput.rowposition, "BOOK_ID");
			fsp_callService(this, "", "", "ds_cond=ds_listInput:A", "",  "", "fn_AfterSaveSearch()");
	    }


		return true;
}


function fn_AfterSaveSearch(errCode, errMsg)
{
	if (errCode != 0){
		
		g_Message("EE");		
		return;
	}
		

	fn_search();	
	//fn_Insert();
	
	http.Sync = true;
	ds_list.rowposition = ds_list.findRowExpr("BOOK_ID==" + f_Saved_ID);
	http.Sync = false;
	/*
	for(i=0;i<ds_list.rowcount;i++){
	
		if (f_Saved_ID == ds_list.GetColumn(i, "TRX_ID")){
					
			ds_list.row = i;
		}
	}
	*/
	
}

/*
 ******************************************************************************************
 * 함  수  명   : Common_Btn_common_OnClick
 * 입      력   : obj  = Form Component
 * 반      환   : 없음
 * 기      능   : 
 * 작  성  자   : 구종화
 * 작성  일자   : 2007-11-16
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================

function Common_Btn_common_OnClick(obj)
{

	switch(obj.name)
	{
		case "btn_search":
		    //alert("d");
			fn_search();
			break;
		case "btn_ins":
			fn_insert();
			break;
		case "btn_del":
			fn_delete();
			break;
		case "btn_save":
			fn_save();
			break;
		case "btn_Print":
			//fn_Print();
			break;
		case "btn_close":
			fn_Close();
			break;
		case "btn_Help":
			//fn_Help();
			break;
		default:
			break;
	}

}


function WorkForm_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
{
	
	gfn_formKeyDown(obj, e); //(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam);
}







function fn_DataSetAllClear()
{

	ds_list.clearData();	
	ds_listInput.clearData();	

}	



function edtBtn_Date_OnClick(obj:Button, e:ClickEventInfo)
{
	g_CalButton_OnClick(obj);
	fn_DataSetAllClear();		
}


function grid_List_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	
	
	if (obj.getCellProperty("head",e.cell,"class") == "head_Excel"){
		//obj.ExportExcelEx(this.Title);
	}
	else {
	
		gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);	
		//ds_list_OnRowPosChanged(obj,-1,0);	
	}
	//obj.ExportExcel(this.Title, , False);	
}




function ds_list_OnRowPosChanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
    if (ds_list.rowcount == 0) return;
    
	ds_listInput.clearData();
	var row = ds_listInput.addRow();
	ds_listInput.copyRow(row, ds_list, e.newrow);
	ds_listInput.applyChange();

	//edtBtn Component 복사############################
	Set_edtBtn_UserData("Clear");
	Set_edtBtn_UserData("Copy");
	
	
	//edtBtn Component 복사############################
	
	
	Setds_listInput_OnColumnChanged();
	//edt_TYPE_CD.Enable        = False;

	//edt_TYPE_NAME.SetFocus();
	fn_SearchDetail();
	
}

//edtBtn Component 세팅/초기화####################################################################
function Set_edtBtn_UserData(str_Gubun)
{

	if (str_Gubun == "Copy"){

		//edtBtn Component 초기화############################  		 
		for (i=0;i<components.length;i++){
							
			if (
				(gfn_subStr(components[i].name, 0, 3)== "st_") &&
				(gfn_subStr(components[i].userdata, 0, 10)== "strMAQuery")
			   )	
			{

			    if (gfn_length(eval("edt_" + gfn_subStr(components[i].name, 3)).Column)!= 0)
				eval("edt_" + gfn_subStr(components[i].name, 3)).userdata = ds_listInput.getColumn(ds_listInput.rowposition, gfn_subStr(components[i].name, 3));
			}
		}		 
		//edtBtn Component 초기화############################
	}
	else if (str_Gubun == "Clear"){

		//edtBtn Component 초기화############################
		for (i=0;i<components.length;i++){
				
				
			if (
				(gfn_subStr(components[i].name, 0, 3)== "st_") &&
				(gfn_subStr(components[i].userdata, 0, 10)== "strMAQuery")
			   )	
			{
				if (gfn_length(components[i].Column)!= 0)
				eval("edt_" + gfn_subStr(components[i].name, 3)).userdata = "";
			}
		}  
		//edtBtn Component 초기화############################
	}
}

function Setds_listInput_OnColumnChanged()
{

	ds_listInput.setColumn(0,"ORDER_DATE",ds_listInput.getColumn(ds_listInput.rowposition, "ORDER_DATE"));
	/*
	ds_listInput_OnColumnChanged(ds_listInput,0,"BIZ_CHK_YN","",ds_listInput.GetColumn(ds_listInput.row, "BIZ_CHK_YN"),0);
	ds_listInput_OnColumnChanged(ds_listInput,0,"FEE_REG_YN","",ds_listInput.GetColumn(ds_listInput.row, "FEE_REG_YN"),0);
	ds_listInput_OnColumnChanged(ds_listInput,0,"ADITEM1_CHK_YN","",ds_listInput.GetColumn(ds_listInput.row, "ADITEM1_CHK_YN"),0);
	ds_listInput_OnColumnChanged(ds_listInput,0,"ADITEM2_CHK_YN","",ds_listInput.GetColumn(ds_listInput.row, "ADITEM2_CHK_YN"),0);
	*/
}

function ds_listInput_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{

	if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "BOOK_ID"))!= "0"){

		edtBtn_JOB_CD.enable         = true;
		edtBtn_SUB_JOB_CD.enable     = true;
		edtBtn_LOC_CD.enable         = true;
		edtBtn_SUB_LOC_CD.enable     = true;
		
		edtBtn_ORD_DEPT_ID.enable    = true;
		edtBtn_ORD_SABUN.enable      = true;
		edtBtn_ORDER_DATE.enable     = true;
		edtBtn_MGMT_DEPT_ID.enable   = true;
		edtBtn_MGMT_SABUN.enable     = true;
		edtBtn_OPEN_DATE.enable      = true;
		
		edtBtn_ORD_DEPT_GUBUN.enable    = true;
		edtBtn_UPJANGDEPT_ID.enable     = true;
		
		edtBtn_OP_CTRT_DATE.enable      = true;
		edtBtn_OP_ECTRT_DATE.enable     = true;		
		    /*
		if (ds_listInput.GetColumn(ds_listInput.Row, "TEAM_MST_CONGUBN") != "Y"){
		
			edt_TEAM_MST_SABUN.Enable    = true;
			edtBtn_TEAM_MST_SABUN.Enable = true;	
			ta_REMARK_DESC.Enable        = true;
			
			btn_AddRow.Enable            = true;
			btn_DeleteRow.Enable         = true;			
		}
		*/
	}
}

//각 구분별 대체마감체크############################################################
function fn_GetALT_CLOSE(objOutDs, real_MST_ID)
{
    /*
    //대체마감체크#####################################################################
    var str_CloseErr = "";
    
    objOutDs.Clear();
    objOutDs.AddColumn("TEAM_MST_CONGUBN","STRING",256);	       
    objOutDs.AddColumn("HEAD_MST_CONGUBN","STRING",256);	       
    objOutDs.AddColumn("GA_CONGUBN","STRING",256);	      
 
    
	// action 정보 초기화 
    tit_clearActionInfo(this);  
	
    // 서버에서 조회할 정보 추가 
	tit_addSearchActionInfo(this, "ma/maa:MAA10010E_S004");
	
	f_AfterCallServerCheck = True;
	
	// 서버 호출 
	http.Sync = True;
	tit_callService(this, "", "", "", objOutDs.id + "=ds_list","MST_ID=" + real_MST_ID
	                                                           ,"fn_AfterCallServiceCheck()");	
	http.Sync = False;
	
    if (!f_AfterCallServerCheck) return False;

	if (objOutDs.GetColumn(objOutDs.row, "TEAM_MST_CONGUBN") == "Y")   str_CloseErr = "해당신청자료는 팀장승인 되었습니다.\n수정/삭제할 수 없습니다.";

	if (objOutDs.GetColumn(objOutDs.row, "HEAD_MST_CONGUBN") == "Y") str_CloseErr = "해당신청자료는 부장승인 되었습니다.\n수정/삭제할 수 없습니다.";				

	if (objOutDs.GetColumn(objOutDs.row, "GA_CONGUBN") == "Y")   str_CloseErr = "해당신청자료에 회계승인 되었습니다.\n수정/삭제할 수 없습니다.";			    
	
	if (length(str_CloseErr ) != 0){
	
		g_Message("EE", str_CloseErr + "\n" +
						"확인하여 주십시요.");			 
		return false;        
	}
    */
	return true;
	//대체마감체크#####################################################################
 
}			 
//각 구분별 대체마감체크############################################################
			 
	




//MST_ID 세팅#######################################################################
function fn_SaveTrxData(real_BOOK_ID)
{

    if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANGNM"))== 0){    

		g_Message("EE", "업장명을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_UPJANGNM.setFocus();
        return false;
    }
    
    /*
    if (length(ds_listInput.GetColumn(ds_listInput.row, "JOB_CD")) == 0){    

		g_Message("EE", "직군1을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_JOB_CD.SetFocus();
        return False;
    }
    
    if (length(ds_listInput.GetColumn(ds_listInput.row, "SUB_JOB_CD")) == 0){    

		g_Message("EE", "직군2를 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_SUB_JOB_CD.SetFocus();
        return False;
    }
    */        
    if (toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "SALE_YEAR")) == 0){    

		g_Message("EE", "평균연매출를 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        me_SALE_YEAR.setFocus();
        return false;
    }
    /*            
    if (toNumber(ds_listInput.GetColumn(ds_listInput.row, "PROFIE_YEAR")) == 0){    

		g_Message("EE", "평균연매출이익을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        me_PROFIE_YEAR.SetFocus();
        return False;
    }               
		
	if (toNumber(ds_listInput.GetColumn(ds_listInput.row, "SALE_CURR_YEAR")) == 0){    

		g_Message("EE", "예상당년신규매출을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
		me_SALE_CURR_YEAR.SetFocus();
		return False;
	}                       
		
    if (toNumber(ds_listInput.GetColumn(ds_listInput.row, "MEAL_CNT")) == 0){    

		g_Message("EE", "일식수를 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        me_MEAL_CNT.SetFocus();
        return False;
    }                 
                
                
    if (length(ds_listInput.GetColumn(ds_listInput.row, "ORDER_DATE")) == 0){    

		g_Message("EE", "수주일을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        me_ORDER_DATE.SetFocus();
        return False;
    }     
                 
    if (NumFormat(ds_listInput.GetColumn(ds_listInput.row, "ORD_DEPT_ID")) == "0"){    

		g_Message("EE", "수주부서를 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_ORD_DEPT_ID.SetFocus();
        return False;
    }                 
                 
    if (length(ds_listInput.GetColumn(ds_listInput.row, "ORD_SABUN")) == 0){    

		g_Message("EE", "수주담당자를 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_ORD_SABUN.SetFocus();
        return False;
    }                     
                 
                 
    if (NumFormat(ds_listInput.GetColumn(ds_listInput.row, "MGMT_DEPT_ID")) == "0"){    

		g_Message("EE", "운영부서를 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_MGMT_DEPT_ID.SetFocus();
        return False;
    }                       
                 
    if (length(ds_listInput.GetColumn(ds_listInput.row, "OPEN_DATE")) == 0){    

		g_Message("EE", "OPEN예정일 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        me_OPEN_DATE.SetFocus();
        return False;
    }                       
        
    if (toNumber(ds_listInput.GetColumn(ds_listInput.row, "INVEST_PLAN")) == 0){    

		g_Message("EE", "투자계획을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        me_INVEST_PLAN.SetFocus();
        return False;
    }            
        
    if (length(ds_listInput.GetColumn(ds_listInput.row, "LOC_CD")) == 0){    

		g_Message("EE", "지역1을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_LOC_CD.SetFocus();
        return False;
    }  
            
    if (length(ds_listInput.GetColumn(ds_listInput.row, "SUB_LOC_CD")) == 0){    

		g_Message("EE", "지역2를 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_SUB_LOC_CD.SetFocus();
        return False;
    }              
        
        
        
    if (length(ds_listInput.GetColumn(ds_listInput.row, "OP_CTRT_DATE")) == 0){    

		g_Message("EE", "계약기간Fr을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        me_OP_CTRT_DATE.SetFocus();
        return False;
    }     
            
    if (length(ds_listInput.GetColumn(ds_listInput.row, "OP_ECTRT_DATE")) == 0){    

		g_Message("EE", "계약기간To을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        me_OP_ECTRT_DATE.SetFocus();
        return False;
    }                 
        
        
        
    if (toNumber(ds_listInput.GetColumn(ds_listInput.row, "MEAL_UPRICE_1")) == 0){    

		g_Message("EE", "식단가1을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        me_MEAL_UPRICE_1.SetFocus();
        return False;
    }  
    */
    




    f_Saved_ID = ds_listInput.getColumn(ds_listInput.rowposition, "BOOK_ID");
    
    if (numFormat(real_BOOK_ID)== "0"){
    
		ds_cond.clear();
		ds_cond.addColumn("MAK_NEWORDER_MGMT_S","INT",256);
					
		// action 정보 초기화
		fsp_clear(this);

		// 서버에서 조회할 정보 추가
		fsp_addSearch(this, "ma/mak:MAK10060E_S002");

		// 서버 호출
		http.Sync = true;
		fsp_callService(this, "", "", "", ds_cond.name + "=ds_list","","");
		http.Sync = false;
		
		real_BOOK_ID = ds_cond.getColumn(ds_cond.rowposition, "MAK_NEWORDER_MGMT_S");
		ds_listInput.setColumn(ds_listInput.rowposition, "BOOK_ID", real_BOOK_ID);
		
		f_Saved_ID  = 0;
		f_NewDataCheck = true;
    }

    return true;
}
//MST_ID 세팅#######################################################################



function edt_CUST_IDQuery_OnChanged(obj,strText)
{
	fn_DataSetAllClear();		
}







//삭제처리###########################################################################
function before_DeleteCheck(str_GUBUN)
{

	if ( 
		(ds_listInput.rowcount == 0) ||
		(numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "BOOK_ID"))== "0") ||
		(!g_Confirm("01"))
	   )
	{

		return false;
	}
	
	//각 구분별 대체 마감체크##############################
    if (!fn_GetALT_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "BOOK_ID"))) return false;	
	//각 구분별 대체 마감체크##############################	        
					
				       		
	
	// action 정보 초기화
	fsp_clear(this);			
	
	//기존 라인 및 매출 데이터 삭제.
	fsp_addSingle(this, "ma/mak:MAK10060E_D001");
		   
	http.Sync = true;
	fsp_callService(this, "", "", "ds_cond=ds_listInput:A",  "", "", "fn_AfterDeleteSearch()");		
	http.Sync = false;		
	
	return true;
}


function fn_AfterDeleteSearch(errCode, errMsg)
{
	if (errCode != 0){

		g_Message("EE");
		return;
	}

    g_Message("01");
    
	fn_search();
	fn_insert();

}
//삭제처리###########################################################################



//마감항목 배경색처리###############################################################
function fn_GetBackColorClose(ColorGubun, YN)
{

   	if (YN == "Y")
   	{
		return "thistle";
	}
	else
	{
		if (ColorGubun == "1")
		return "white";
		else
		return "#F6FCFC";
	}

}
//마감항목 배경색처리###############################################################




function ds_listInput_CanColumnChange(obj:Dataset, e:DSColChangeEventInfo)
{

	if (
		(e.columnid == "SALE_YEAR") ||
		(e.columnid == "PROFIE_YEAR") ||
		(e.columnid == "SALE_CURR_YEAR") ||
		(e.columnid == "MEAL_CNT") ||
		(e.columnid == "GUARANTY_AMT") ||
		(e.columnid == "INVEST_PLAN") ||
		(e.columnid == "MEAL_UPRICE_1") ||
		(e.columnid == "MEAL_UPRICE_2") ||
		(e.columnid == "MEAL_UPRICE_3")
	   )
	{
	
		if (toNumber(e.newvalue) < 0){
		
			g_Message("EE", "-를 입력할 수 없습니다.\n" +
							"확인하여 주십시요.");			
                        			
			eval("me_" + e.columnid).value = "";
			eval("me_" + e.columnid).setFocus();			
			
			
			return false;  		
		
		}	
	
	}

}



function fn_AfterCallServiceCheck(errCode, errMsg)
{
	if (errCode != 0){

		g_Message("EE");
		
		f_AfterCallServerCheck = false;
		fn_insert();
		return false;
	}
}







function edtBtn_JOB_CD_OnClick(obj:Button, e:ClickEventInfo)
{   

    /*
    if (
        (NumFormat(ds_listInput.GetColumn(ds_listInput.row, "UPJANG")) == "0") 
       )     
    return;
    */
    
    var str_Where = "";
    
    
    //담당부서####################################################################################
    if (
         (obj.name == "edtBtn_ORD_DEPT_ID") ||
         (obj.name == "edtBtn_MGMT_DEPT_ID")
       )
    {	
			    
		str_Where += "  AND (V.EXP_CD = 'N')";
		
		if (obj.name == "edtBtn_ORD_DEPT_ID")
        str_Where += "  AND (V.DEPT_ID IN (SELECT CODE FROM SCC_COMMON_CODE WHERE GROUP_CODE = 'MA1002' AND SET1 = 'IFIS')) ";
    }
        
    
    //업장DEPT_ID####################################################################################
    if (obj.name == "edtBtn_UPJANGDEPT_ID") 
    {	
			    
		str_Where += "  AND (V.EXP_CD = 'Y')";		
    }
                
        
    //담당마케터####################################################################################
    if (
         (obj.name == "edtBtn_ORD_SABUN") ||
         (obj.name == "edtBtn_MGMT_SABUN")
       )
    {	    
		if (obj.name == "edtBtn_ORD_SABUN")
        str_Where += "  AND (V.DEPT_ID IN (SELECT CODE FROM SCC_COMMON_CODE WHERE GROUP_CODE = 'MA1002' AND SET1 = 'IFIS')) ";
   
    }              
        
        
    //직군2####################################################################################
    if (obj.name == "edtBtn_SUB_JOB_CD"){	
		
	    if (gfn_length(edt_JOB_CD.userdata)== 0){
	    
			g_Message("EE", "직군1이 없습니다.\n" +
							"확인하여 주십시요.");
			edt_JOB_CD.setFocus();
			return false;   					
	    }
		str_Where += "  AND (JOB_CD = '" + edt_JOB_CD.userdata + "')";
    }
    
    //창고코드####################################################################################
    if (obj.name == "edtBtn_SUB_LOC_CD"){	
		
	    if (gfn_length(edt_LOC_CD.userdata)== 0){
	    
			g_Message("EE", "지역1이 없습니다.\n" +
							"확인하여 주십시요.");
			edt_LOC_CD.setFocus();
			return false;   					
	    }
	    		
		str_Where += " AND  (SET1 = '" + edt_LOC_CD.userdata + "')";
		
    }   
     
    
        
	fn_edtBtn_OnClick(obj, str_Where);

    if (gfn_length(eval("edt_" + gfn_subStr(obj.name, 7)).userdata)!= 0)
	ds_listInput.setColumn(ds_listInput.rowposition, gfn_subStr(obj.name, 7), eval("edt_" + gfn_subStr(obj.name, 7)).userdata);	
			    		
}


function edt_JOB_CD_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	fn_edt_OnKeyDown(obj,e.keycode);	
	
	if (e.keycode == 46){
	
		ds_listInput.setColumn(ds_listInput.rowposition, gfn_subStr(obj.name, 4), "");			
			
	    if (obj.name == "edt_JOB_CD"){
			
			ds_listInput.setColumn(ds_listInput.rowposition, "SUB_JOB_CD", "");				    		
			ds_listInput.setColumn(ds_listInput.rowposition, "SUB_JOB_CDNM", "");				    		
	    }
	    else if (obj.name == "edt_LOC_CD"){
			
			ds_listInput.setColumn(ds_listInput.rowposition, "SUB_LOC_CD", "");				    		
			ds_listInput.setColumn(ds_listInput.rowposition, "SUB_LOC_CDNM", "");				    		
	    }
	}
}

function edtBtn_ORD_DEPT_IDQuery_OnClick(obj:Button, e:ClickEventInfo)
{
	var str_Where = "";

	if (obj.name == "edtBtn_ORD_DEPT_IDQuery") str_Where += " AND (V.EXP_CD = 'N')";
	if (obj.name == "edtBtn_ORD_DEPT_IDQuery") str_Where += " AND (V.DEPT_ID IN (SELECT CODE FROM SCC_COMMON_CODE WHERE GROUP_CODE = 'MA1002' AND SET1 = 'IFIS')) ";
	if (obj.name == "edtBtn_ORD_SABUNQuery") str_Where += "  AND (V.DEPT_ID IN (SELECT CODE FROM SCC_COMMON_CODE WHERE GROUP_CODE = 'MA1002' AND SET1 = 'IFIS')) ";
	
	fn_edtBtn_OnClick(obj, str_Where);
	fn_DataSetAllClear();			
}


function edt_ORD_DEPT_IDQuery_OnChanged(obj:Edit, e:TextChangedEventInfo)
{
	fn_DataSetAllClear();	
}

function me_ORDER_DATEQuery_OnChanged(obj, e)
{
	fn_DataSetAllClear();
}


function edt_ORD_DEPT_IDQuery_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	fn_edt_OnKeyDown(obj,e.keycode);	
	fn_DataSetAllClear();		
	
}
]]></Script>
  </Form>
</FDL>

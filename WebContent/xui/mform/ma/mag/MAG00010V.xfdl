<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="MAG00010V" onkeydown="fn_form_OnKeyDown" onload="form_onload" titletext="영업잔액조회" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="st_Disp" text="★ 잔액을 즉시 입금하시기 바랍니다." visible="false" position="absolute 719 91 1232 107" anchor="top right" class="sta_WF_DiscPoint"/>
        <Static id="Static01" position="absolute 0 30 1237 71" class="sta_WFSA_Labelbg" anchor="left top right"/>
        <Static id="st_GB" text="기준일자" position="absolute 695 37 757 63" class="sta_WFSA_label"/>
        <TextArea id="ta_Sql" readonly="true" taborder="8" tabstop="false" visible="false" position="absolute 417 0 531 40"/>
        <Static id="st_Team" text="팀" userdata="strMAQuery_Team" position="absolute 201 37 264 63" class="sta_WFSA_label"/>
        <MaskEdit id="me_Sdate" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="3" type="string" position="absolute 770 40 848 61" class="msk_WF_Essential" style="align:center;"/>
        <Button id="btn_Sdate" onclick="g_CalButton_OnClick" taborder="4" tabstop="false" userdata="me_Sdate" position="absolute 844 40 867 61" class="btn_WF_calEssential" text="" image=""/>
        <Static id="st_Upjang" text="사업장" userdata="strQuery_Upjang" position="absolute 437 37 541 63" class="sta_WFSA_label"/>
        <Tab id="tab_list" onchanged="tab_list_OnChanged" preload="true" taborder="17" position="absolute 0 86 1237 715" showextrabutton="false" anchor="all" tabjustify="false">
          <Tabpages>
            <Tabpage id="tab3" taborder="3" text="영업수입 현금 잔액" position="absolute 2 24 975 564" scrollbars="none">
              <Layouts>
                <Layout>
                  <Grid autoenter="select" binddataset="ds_List3" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="gd_list" useinputpanel="false" onheadclick="gd_list_OnHeadClick" taborder="1" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 10 10 1226 599" selecttype="row" anchor="all" autofittype="col" oncelldblclick="tab_list_tab3_gd_list_oncelldblclick" onexpanddown="grid_Slip_OnExpandEdit" treeusecheckbox="false">
                    <Formats>
                      <Format id="Default">
                        <Columns>
                          <Column size="0"/>
                          <Column size="25"/>
                          <Column size="26"/>
                          <Column size="106"/>
                          <Column size="150"/>
                          <Column size="70"/>
                          <Column size="99"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="190"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="91"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text"/>
                          <Cell col="1" displaytype="text" class="head_Excel"/>
                          <Cell col="2" displaytype="text" class="Cellgrd_WF_Plusbtn"/>
                          <Cell col="3" displaytype="text" text="팀"/>
                          <Cell col="4" displaytype="text" text="업장명"/>
                          <Cell col="5" displaytype="text" text="발생일자"/>
                          <Cell col="6" displaytype="text" text="영업현금번호"/>
                          <Cell col="7" displaytype="text" text="계정코드"/>
                          <Cell col="8" displaytype="text" text="고객사"/>
                          <Cell col="9" displaytype="text" text="고객사명"/>
                          <Cell col="10" displaytype="text" text="발생금액"/>
                          <Cell col="11" displaytype="text" text="이월대체금액"/>
                          <Cell col="12" displaytype="text" text="조회대체금액"/>
                          <Cell col="13" displaytype="text" text="잔액"/>
                          <Cell col="14" displaytype="text" text="전표번호"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="tree" treelevel="expr:gfn_sumStyle(getRowLevel(currow),&quot;LV&quot;,2)"/>
                          <Cell col="1" celltype="none" displaytype="text" style="align:right;" expr="expr:currow+1"/>
                          <Cell col="2" displaytype="image" style="align:center middle;background:EXPR(gfn_sumStyle(getRowLevel(currow),&quot;BG&quot;));background2:EXPR(gfn_sumStyle(getRowLevel(currow),&quot;BG&quot;));backgroundimage:EXPR(gfn_sumStyle(getRowLevel(currow),&quot;IMG&quot;,null,currow, tab_list.tab3.gd_list));" suppress="1"/>
                          <Cell col="3" displaytype="text" style="align:left;background:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );background2:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );" text="expr:getColumn(currow+getRowLevel(currow),'tmNm')" suppress="1"/>
                          <Cell col="4" displaytype="text" style="align:left;background:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );background2:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );barcolor:transparent;" text="expr:decode(getRowLevel(currow),2, '(팀소계)',1,getColumn(currow+getRowLevel(currow),'ccNm'), getColumn(currow,'ccNm'))" suppress="0"/>
                          <Cell col="5" displaytype="expr:iif(getRowLevel(currow)&gt;0,'null','date')" style="align:center;background:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );background2:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );" text="expr:decode(getRowLevel(currow),1, '(업장소계)', getColumn(currow,'occurDate'))" suppress="0"/>
                          <Cell col="6" displaytype="text" style="align:center;background:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );background2:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );" text="bind:salesCashNum" suppress="0"/>
                          <Cell col="7" displaytype="text" style="align:right;background:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );background2:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );" text="bind:acctCd"/>
                          <Cell col="8" displaytype="text" style="align:right;background:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );background2:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );" text="bind:custCd" subsumtext=" "/>
                          <Cell col="9" displaytype="text" style="align:left;background:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );background2:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );" text="bind:custNm"/>
                          <Cell col="10" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );background2:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );" text="bind:occurAmt"/>
                          <Cell col="11" displaytype="number" style="align:right;background:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );background2:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );" text="bind:oldAltAmt"/>
                          <Cell col="12" displaytype="number" style="background:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );background2:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );" text="bind:altAmt"/>
                          <Cell col="13" displaytype="number" style="background:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );background2:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );" text="bind:balAmt"/>
                          <Cell col="14" displaytype="text" style="align:left;background:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );background2:EXPR(getRowLevel(currow) &gt; 0?  'default' : balAmt &gt;0 ? 'bisque' :  'default' );" text="bind:journalzNum"/>
                        </Band>
                        <Band id="summary">
                          <Cell col="1" colspan="9" style="align:center;" text="합     계" taborder="undefined"/>
                          <Cell col="10" displaytype="number" style="align:right middle;" expr="expr:getSum('occurAmt')" mask="#,##0"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" expr="expr:getSum('occurAmt')" mask="#,##0"/>
                          <Cell col="12" displaytype="number" style="align: ;" expr="expr:getSum('altAmt')" mask="#,##0" taborder="undefined"/>
                          <Cell col="13" displaytype="number" style="align: ;" expr="expr:getSum('balAmt')" mask="#,##0" taborder="undefined"/>
                          <Cell col="14" displaytype="text" style="align: ;"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tab4" taborder="4" text="미수금(신용카드)" position="absolute 2 24 975 564" scrollbars="none">
              <Layouts>
                <Layout>
                  <Grid autoenter="select" binddataset="ds_List4" cellmovingtype="none" cellsizingtype="col" readonly="false" enable="true" id="gd_list" useinputpanel="false" onheadclick="gd_list_OnHeadClick" taborder="1" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 10 10 1226 591" selecttype="row" anchor="all" autofittype="none">
                    <Formats>
                      <Format id="Default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="100"/>
                          <Column size="150"/>
                          <Column size="174"/>
                          <Column size="80"/>
                          <Column size="118"/>
                          <Column size="65"/>
                          <Column size="82"/>
                          <Column size="88"/>
                          <Column size="140"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="70"/>
                          <Column size="140"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="사업부"/>
                          <Cell col="2" displaytype="text" text="팀"/>
                          <Cell col="3" displaytype="text" text="업장"/>
                          <Cell col="4" displaytype="text" text="발생일자"/>
                          <Cell col="5" displaytype="text" text="채권유형"/>
                          <Cell col="6" displaytype="text" text="채권분류"/>
                          <Cell col="7" displaytype="text" text="계정코드"/>
                          <Cell col="8" displaytype="text" text="고객사"/>
                          <Cell col="9" displaytype="text" text="고객사명"/>
                          <Cell col="10" displaytype="text" text="발생금액"/>
                          <Cell col="11" displaytype="text" text="입금금액"/>
                          <Cell col="12" displaytype="text" text="미회수금액"/>
                          <Cell col="13" displaytype="text" text="회수예정일"/>
                          <Cell col="14" displaytype="text" text="발생분개번호"/>
                          <Cell col="15" displaytype="text" text="담당자"/>
                          <Cell col="16" displaytype="text" text="비고"/>
                        </Band>
                        <Band id="body">
                          <Cell celltype="none" displaytype="text" style="align:right;" expr="expr:currow + 1"/>
                          <Cell col="1" displaytype="text" style="align:left;background:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));background2:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));" text="bind:muNm" suppress="0"/>
                          <Cell col="2" displaytype="text" style="align:left;background:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));background2:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));" text="bind:tmNm" suppress="0"/>
                          <Cell col="3" displaytype="text" style="align:left;background:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));background2:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));" text="bind:ccNm" subsumtext="expr:LEVEL" suppress="0"/>
                          <Cell col="4" displaytype="date" style="align:center;background:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));background2:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));" text="bind:occurDate" suppress="0"/>
                          <Cell col="5" displaytype="text" style="align:left;background:EXPR(iif(AMT4 == 0, 'default', 'pink'));background2:EXPR(iif(AMT4 == 0, 'default', 'pink'));" text="bind:arTypeNm" suppress="0"/>
                          <Cell col="6" displaytype="text" style="align:left;background:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));background2:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));" text="bind:arClassNm"/>
                          <Cell col="7" displaytype="text" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));background2:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));" text="bind:acctCd"/>
                          <Cell col="8" displaytype="text" style="align:right;background:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));background2:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));" text="bind:custCd"/>
                          <Cell col="9" displaytype="text" style="align:left;background:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));background2:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));" text="bind:custNm"/>
                          <Cell col="10" displaytype="number" style="align: ;background:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));background2:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));" text="bind:arAmt"/>
                          <Cell col="11" displaytype="number" style="align: ;background:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));background2:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));" text="bind:receiveAmt"/>
                          <Cell col="12" displaytype="number" style="align: ;background:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));background2:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));" text="bind:arBalAmt"/>
                          <Cell col="13" displaytype="date" style="align:center;background:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));background2:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));" text="bind:withdrawSchdDate"/>
                          <Cell col="14" displaytype="text" style="align: ;background:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));background2:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));" text="bind:journalzNum"/>
                          <Cell col="15" displaytype="text" style="align:center;background:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));background2:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));" text="bind:arIncharge"/>
                          <Cell col="16" displaytype="text" style="align:left;background:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));background2:EXPR(decode(getRowLevel(currow),1,'moccasin',2,'lightsalmon',iif(AMT4 == 0, 'default', 'pink')));" text="bind:remark"/>
                        </Band>
                        <Band id="summary">
                          <Cell colspan="10" style="align:center;" text="합     계"/>
                          <Cell col="10" displaytype="number" style="align: ;" expr="expr:getSum('arAmt')" mask="#,##0"/>
                          <Cell col="11" displaytype="number" style="align: ;" expr="expr:getSum('receiveAmt')" mask="#,##0"/>
                          <Cell col="12" displaytype="number" style="align: ;" expr="expr:getSum('arBalAmt')" mask="#,##0"/>
                          <Cell col="13" displaytype="number" style="align: ;"/>
                          <Cell col="14" displaytype="number" style="align: ;"/>
                          <Cell col="15" displaytype="number" style="align: ;"/>
                          <Cell col="16" displaytype="number" style="align: ;"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage3" text="일반후불">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" taborder="0" binddataset="ds_List1" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 10 1226 591" anchor="all">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="100"/>
                          <Column size="150"/>
                          <Column size="170"/>
                          <Column size="80"/>
                          <Column size="110"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="60"/>
                          <Column size="120"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="200"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" text="사업부"/>
                          <Cell col="2" text="팀"/>
                          <Cell col="3" text="업장"/>
                          <Cell col="4" text="발생일자"/>
                          <Cell col="5" text="채권유형"/>
                          <Cell col="6" text="채권분류"/>
                          <Cell col="7" text="계정코드"/>
                          <Cell col="8" text="고객사"/>
                          <Cell col="9" text="고객사명"/>
                          <Cell col="10" text="발생금액"/>
                          <Cell col="11" text="입금금액"/>
                          <Cell col="12" text="미회수금액"/>
                          <Cell col="13" text="회수예정일"/>
                          <Cell col="14" text="발생분개번호"/>
                          <Cell col="15" text="담당자"/>
                          <Cell col="16" text="비고"/>
                        </Band>
                        <Band id="body">
                          <Cell text="expr:currow+1"/>
                          <Cell col="1" displaytype="normal" style="align:center middle;" text="bind:muNm" suppress="0"/>
                          <Cell col="2" displaytype="normal" style="align:left middle;" text="bind:tmNm" suppress="0"/>
                          <Cell col="3" displaytype="normal" style="align:left middle;" text="bind:ccNm" suppress="0"/>
                          <Cell col="4" displaytype="date" style="align:center middle;" text="bind:occurDate" suppress="0"/>
                          <Cell col="5" displaytype="normal" style="align:center middle;" text="bind:arTypeNm"/>
                          <Cell col="6" text="bind:arClassNm"/>
                          <Cell col="7" displaytype="normal" style="align:right middle;" text="bind:acctCd"/>
                          <Cell col="8" displaytype="normal" style="align:center middle;" text="bind:custCd"/>
                          <Cell col="9" displaytype="normal" style="align:left middle;" text="bind:custNm"/>
                          <Cell col="10" displaytype="number" style="align:right middle;" text="bind:arAmt"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" text="bind:receiveAmt"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" text="bind:arBalAmt"/>
                          <Cell col="13" displaytype="expr:withdrawSchdDate != null &amp;&amp; withdrawSchdDate != '' ? 'date' : 'narmal'" style="align:center middle;" text="bind:withdrawSchdDate"/>
                          <Cell col="14" displaytype="normal" style="align:center middle;" text="bind:journalzNum"/>
                          <Cell col="15" displaytype="normal" style="align:center;" text="bind:arIncharge"/>
                          <Cell col="16" displaytype="normal" style="align:left middle;" text="bind:remark"/>
                        </Band>
                        <Band id="summary">
                          <Cell colspan="10" style="align:right middle;" text="합   계" taborder="undefined"/>
                          <Cell col="10" displaytype="number" text="expr:getSum('arAmt')"/>
                          <Cell col="11" displaytype="number" text="expr:getSum('receiveAmt')"/>
                          <Cell col="12" displaytype="number" text="expr:getSum('arBalAmt')"/>
                          <Cell col="13"/>
                          <Cell col="14"/>
                          <Cell col="15"/>
                          <Cell col="16"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage4" text="식권외상판매">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" taborder="0" binddataset="ds_List2" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 10 1226 591" anchor="all">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="100"/>
                          <Column size="150"/>
                          <Column size="170"/>
                          <Column size="80"/>
                          <Column size="110"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="60"/>
                          <Column size="120"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="200"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" text="사업부"/>
                          <Cell col="2" text="팀"/>
                          <Cell col="3" text="업장"/>
                          <Cell col="4" text="발생일자"/>
                          <Cell col="5" text="채권유형"/>
                          <Cell col="6" text="채권분류"/>
                          <Cell col="7" text="계정코드"/>
                          <Cell col="8" text="고객사"/>
                          <Cell col="9" text="고객사명"/>
                          <Cell col="10" text="발생금액"/>
                          <Cell col="11" text="입금금액"/>
                          <Cell col="12" text="미회수금액"/>
                          <Cell col="13" text="회수예정일"/>
                          <Cell col="14" text="발생분개번호"/>
                          <Cell col="15" text="담당자"/>
                          <Cell col="16" text="비고"/>
                        </Band>
                        <Band id="body">
                          <Cell text="expr:currow+1"/>
                          <Cell col="1" displaytype="normal" style="align:center middle;" text="bind:muNm" suppress="0"/>
                          <Cell col="2" displaytype="normal" style="align:left middle;" text="bind:tmNm" suppress="0"/>
                          <Cell col="3" displaytype="normal" style="align:left middle;" text="bind:ccNm" suppress="0"/>
                          <Cell col="4" displaytype="date" style="align:center middle;" text="bind:occurDate" suppress="0"/>
                          <Cell col="5" displaytype="normal" style="align:center middle;" text="bind:arTypeNm"/>
                          <Cell col="6" text="bind:arClassNm"/>
                          <Cell col="7" displaytype="normal" style="align:right middle;" text="bind:acctCd"/>
                          <Cell col="8" displaytype="normal" style="align:center middle;" text="bind:custCd"/>
                          <Cell col="9" displaytype="normal" style="align:left middle;" text="bind:custNm"/>
                          <Cell col="10" displaytype="number" style="align:right middle;" text="bind:arAmt"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" text="bind:receiveAmt"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" text="bind:arBalAmt"/>
                          <Cell col="13" displaytype="expr:withdrawSchdDate != null &amp;&amp; withdrawSchdDate != '' ? 'date' : 'narmal'" style="align:center middle;" text="bind:withdrawSchdDate"/>
                          <Cell col="14" displaytype="normal" style="align:center middle;" text="bind:journalzNum"/>
                          <Cell col="15" displaytype="normal" style="align:center;" text="bind:arIncharge"/>
                          <Cell col="16" displaytype="normal" style="align:left middle;" text="bind:remark"/>
                        </Band>
                        <Band id="summary">
                          <Cell colspan="10" style="align:right middle;" text="합   계" taborder="undefined"/>
                          <Cell col="10" displaytype="number" text="expr:getSum('arAmt')"/>
                          <Cell col="11" displaytype="number" text="expr:getSum('receiveAmt')"/>
                          <Cell col="12" displaytype="number" text="expr:getSum('arBalAmt')"/>
                          <Cell col="13"/>
                          <Cell col="14"/>
                          <Cell col="15"/>
                          <Cell col="16"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage5" text="선수금잔액">
              <Layouts>
                <Layout>
                  <Grid id="grd_list" taborder="0" binddataset="ds_List5" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 10 1226 591" anchor="all">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="30"/>
                          <Column size="90"/>
                          <Column size="100"/>
                          <Column size="120"/>
                          <Column size="110"/>
                          <Column size="80"/>
                          <Column size="110"/>
                          <Column size="80"/>
                          <Column size="60"/>
                          <Column size="140"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="500"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                          <Cell col="1" text="사업부"/>
                          <Cell col="2" text="팀"/>
                          <Cell col="3" text="업장"/>
                          <Cell col="4" text="선수금번호"/>
                          <Cell col="5" text="발생일자"/>
                          <Cell col="6" text="선수금유형"/>
                          <Cell col="7" text="계정코드"/>
                          <Cell col="8" text="고객사"/>
                          <Cell col="9" text="고객사명"/>
                          <Cell col="10" text="발생금액"/>
                          <Cell col="11" text="대체금액"/>
                          <Cell col="12" text="잔액"/>
                          <Cell col="13" text="적요"/>
                        </Band>
                        <Band id="body">
                          <Cell style="align:center middle;" expr="currow+1"/>
                          <Cell col="1" style="align:left;" text="bind:muNm"/>
                          <Cell col="2" style="align:left;" text="bind:tmNm"/>
                          <Cell col="3" style="align:left;" text="bind:ccNm"/>
                          <Cell col="4" text="bind:advanceNum"/>
                          <Cell col="5" style="align:center middle;" text="bind:fiscalDate" mask="####-##-##"/>
                          <Cell col="6" style="align:center middle;" text="bind:advanceTypeCdNm"/>
                          <Cell col="7" style="align:center middle;" text="bind:acctCd"/>
                          <Cell col="8" displaytype="text" style="align:center middle;" text="bind:custCd"/>
                          <Cell col="9" displaytype="text" style="align:left;" text="bind:custNm"/>
                          <Cell col="10" displaytype="number" style="align:right middle;" text="bind:occurAmt"/>
                          <Cell col="11" displaytype="number" style="align:right middle;" text="bind:applyAmt"/>
                          <Cell col="12" displaytype="number" style="align:right middle;" text="bind:balAmt"/>
                          <Cell col="13" style="align:left middle;" text="bind:remark"/>
                        </Band>
                        <Band id="summary">
                          <Cell/>
                          <Cell col="1"/>
                          <Cell col="2"/>
                          <Cell col="3"/>
                          <Cell col="4"/>
                          <Cell col="5"/>
                          <Cell col="6"/>
                          <Cell col="7"/>
                          <Cell col="8"/>
                          <Cell col="9" style="align:center middle;" text="합계"/>
                          <Cell col="10" displaytype="number" text="expr:getSum('occurAmt')" mask="#,##0"/>
                          <Cell col="11" displaytype="number" text="expr:getSum('applyAmt')" mask="#,##0"/>
                          <Cell col="12" displaytype="number" text="expr:getSum('balAmt')" mask="#,##0"/>
                          <Cell col="13"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Div id="div_cmnBtn" anchor="left top right" taborder="1" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static23" text="W15" visible="false" position="absolute 185 40 200 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static21" text="W10" visible="false" position="absolute 16 30 279 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static22" text="W10" visible="false" position="absolute 16 61 279 71" style="background:#ff000055;align:center middle;"/>
        <Static id="Static04" text="W10" visible="false" position="absolute 226 40 236 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static00" text="W30" visible="false" position="absolute 406 40 436 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static09" text="W10" visible="false" position="absolute 483 40 493 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static12" text="W30" visible="false" position="absolute 664 40 694 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static02" text="W10" visible="false" position="absolute 760 40 770 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static03" text="H15" visible="false" position="absolute 0 71 263 86" style="background:#ff000055;align:center middle;"/>
        <Static id="Static05" text="잔액 0포함여부" class="sta_WFSA_label" position="absolute 1031 40 1129 61" anchor="left top"/>
        <Combo id="cbo_zeroIncludeYn" taborder="18" codecolumn="codecolumn" datacolumn="datacolumn" onitemchanged="Combo00_onitemchanged" position="absolute 1139 40 1217 61" anchor="left top" index="1" value="N" text="아니오">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">예</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">아니오</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="Static06" text="W30" visible="false" position="absolute 997 40 1027 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static07" text="W10" visible="false" position="absolute 1129 40 1139 61" style="background:#ff000055;align:center middle;"/>
        <TmSearchComponent id="edt_tmNm" titletext="팀 검색용 Component" taborder="19" onkeydown="edt_tmNm_onkeydown" text="TmSearchComponent00" position="absolute 236 40 406 62" bindDataset="" bindTmCdColumn="" bindTmNmColumn="" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tmChange" eventBeforeTrigger="" isTeamControl="Y"/>
        <UpjangSearchComponent id="edt_upjangNm" titletext="업장 검색용 Component" taborder="20" onkeydown="edt_upjangNm_onkeydown" text="UpjangSearchComponent00" position="absolute 493 40 664 61" bindDataset="" bindUpjangCodeColumn="" bindUpjangNameColumn="" eventBeforeTrigger="" eventAfterTrigger="" roleSetId=""/>
        <MuSearchComponent id="edt_muNm" titletext="사업부 선택 Component" taborder="21" class="cmb_WF_Essential" position="absolute 65 40 185 61" bindDataset="" bindMuCdColumn="" appendText="" onItemChangedEvent="fn_muOnchangedEvent" visible="true"/>
        <MaskEdit id="me_Edate" taborder="22" type="string" mask="####-##-##" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" oneditclick="g_Date_OnFocus" class="msk_WF_Essential" position="absolute 889 40 967 61" style="align:center;"/>
        <Button id="btn_Sdate00" taborder="23" tabstop="false" onclick="g_CalButton_OnClick" class="btn_WF_calEssential" position="absolute 963 40 986 61" userdata="me_Edate"/>
        <Static id="st_A" text="~" position="absolute 873 41 887 63"/>
        <Static id="Static08" text="W15" visible="false" position="absolute 1 40 16 61" style="background:#ff000055;align:center middle;"/>
        <Static id="st_Team00" text="사업부" class="sta_WFSA_label" position="absolute 17 37 80 63" userdata="strMAQuery_Team"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond">
        <ColumnInfo>
          <Column id="UPJANG" size="50" type="STRING"/>
          <Column id="SDATE" size="50" type="STRING"/>
          <Column id="EDATE" size="50" type="STRING"/>
          <Column id="occurDate" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="upjangCd" type="STRING" size="256"/>
          <Column id="zeroIncludeYn" type="STRING" size="256"/>
          <Column id="fiscalDate" type="STRING" size="256"/>
          <Column id="arTypeCd" type="STRING" size="256"/>
          <Column id="occurDateFrom" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="occurDateTo" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List3" reversesubsum="true" keystring="G:+tmCd,+upjangCd">
        <ColumnInfo>
          <Column id="salesCashNum" type="STRING" size="256"/>
          <Column id="upjangCd" type="STRING" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="occurDate" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="tmNm" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="acctCd" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="occurAmt" type="STRING" size="256"/>
          <Column id="oldAltAmt" type="STRING" size="256"/>
          <Column id="altAmt" type="STRING" size="256"/>
          <Column id="balAmt" type="STRING" size="256"/>
          <Column id="couponProcNum" type="STRING" size="256"/>
          <Column id="withdrawAmt" type="STRING" size="256"/>
          <Column id="journalzYn" type="STRING" size="256"/>
          <Column id="journalzNum" type="STRING" size="256"/>
          <Column id="procUser" type="STRING" size="256"/>
          <Column id="modifySalsYn" type="STRING" size="256"/>
          <Column id="dealType" type="STRING" size="256"/>
          <Column id="dataClass" type="STRING" size="256"/>
          <Column id="receiveNum" type="STRING" size="256"/>
          <Column id="recdStatus" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List4">
        <ColumnInfo>
          <Column id="arNum" type="STRING" size="256"/>
          <Column id="occurDate" type="STRING" size="256"/>
          <Column id="fiscalDate" type="STRING" size="256"/>
          <Column id="arOccurClass" type="STRING" size="256"/>
          <Column id="arTypeCd" type="STRING" size="256"/>
          <Column id="arTypeNm" type="STRING" size="256"/>
          <Column id="arClassCd" type="STRING" size="256"/>
          <Column id="arClassNm" type="STRING" size="256"/>
          <Column id="acctCd" type="STRING" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="tmNm" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="arAmt" type="STRING" size="256"/>
          <Column id="receiveAmt" type="STRING" size="256"/>
          <Column id="arBalAmt" type="STRING" size="256"/>
          <Column id="taxShetPublishYn" type="STRING" size="256"/>
          <Column id="batchId" type="STRING" size="256"/>
          <Column id="reservTypeCd" type="STRING" size="256"/>
          <Column id="reservNum" type="STRING" size="256"/>
          <Column id="contractTypeCd" type="STRING" size="256"/>
          <Column id="contractNum" type="STRING" size="256"/>
          <Column id="payClassCd" type="STRING" size="256"/>
          <Column id="billingPublishYn" type="STRING" size="256"/>
          <Column id="withdrawSchdDate" type="STRING" size="256"/>
          <Column id="receiveEndDate" type="STRING" size="256"/>
          <Column id="arIncharge" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="256"/>
          <Column id="receiptNum" type="STRING" size="256"/>
          <Column id="refNum" type="STRING" size="256"/>
          <Column id="journalzYn" type="STRING" size="256"/>
          <Column id="recdStatus" type="STRING" size="256"/>
          <Column id="journalzNum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List1">
        <ColumnInfo>
          <Column id="arNum" type="STRING" size="256"/>
          <Column id="occurDate" type="STRING" size="256"/>
          <Column id="fiscalDate" type="STRING" size="256"/>
          <Column id="arOccurClass" type="STRING" size="256"/>
          <Column id="arTypeCd" type="STRING" size="256"/>
          <Column id="arTypeNm" type="STRING" size="256"/>
          <Column id="arClassCd" type="STRING" size="256"/>
          <Column id="arClassNm" type="STRING" size="256"/>
          <Column id="acctCd" type="STRING" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="tmNm" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="arAmt" type="STRING" size="256"/>
          <Column id="receiveAmt" type="STRING" size="256"/>
          <Column id="arBalAmt" type="STRING" size="256"/>
          <Column id="taxShetPublishYn" type="STRING" size="256"/>
          <Column id="batchId" type="STRING" size="256"/>
          <Column id="reservTypeCd" type="STRING" size="256"/>
          <Column id="reservNum" type="STRING" size="256"/>
          <Column id="contractTypeCd" type="STRING" size="256"/>
          <Column id="contractNum" type="STRING" size="256"/>
          <Column id="payClassCd" type="STRING" size="256"/>
          <Column id="billingPublishYn" type="STRING" size="256"/>
          <Column id="withdrawSchdDate" type="STRING" size="256"/>
          <Column id="receiveEndDate" type="STRING" size="256"/>
          <Column id="arIncharge" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="256"/>
          <Column id="receiptNum" type="STRING" size="256"/>
          <Column id="refNum" type="STRING" size="256"/>
          <Column id="journalzYn" type="STRING" size="256"/>
          <Column id="recdStatus" type="STRING" size="256"/>
          <Column id="journalzNum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List2">
        <ColumnInfo>
          <Column id="arNum" type="STRING" size="256"/>
          <Column id="occurDate" type="STRING" size="256"/>
          <Column id="fiscalDate" type="STRING" size="256"/>
          <Column id="arOccurClass" type="STRING" size="256"/>
          <Column id="arTypeCd" type="STRING" size="256"/>
          <Column id="arTypeNm" type="STRING" size="256"/>
          <Column id="arClassCd" type="STRING" size="256"/>
          <Column id="arClassNm" type="STRING" size="256"/>
          <Column id="acctCd" type="STRING" size="256"/>
          <Column id="sysClass" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="tmNm" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="arAmt" type="STRING" size="256"/>
          <Column id="receiveAmt" type="STRING" size="256"/>
          <Column id="arBalAmt" type="STRING" size="256"/>
          <Column id="taxShetPublishYn" type="STRING" size="256"/>
          <Column id="batchId" type="STRING" size="256"/>
          <Column id="reservTypeCd" type="STRING" size="256"/>
          <Column id="reservNum" type="STRING" size="256"/>
          <Column id="contractTypeCd" type="STRING" size="256"/>
          <Column id="contractNum" type="STRING" size="256"/>
          <Column id="payClassCd" type="STRING" size="256"/>
          <Column id="billingPublishYn" type="STRING" size="256"/>
          <Column id="withdrawSchdDate" type="STRING" size="256"/>
          <Column id="receiveEndDate" type="STRING" size="256"/>
          <Column id="arIncharge" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="256"/>
          <Column id="receiptNum" type="STRING" size="256"/>
          <Column id="refNum" type="STRING" size="256"/>
          <Column id="journalzYn" type="STRING" size="256"/>
          <Column id="recdStatus" type="STRING" size="256"/>
          <Column id="journalzNum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List5" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="advanceNum" type="STRING" size="18"/>
          <Column id="seq" type="BIGDECIMAL" size="22"/>
          <Column id="occurDate" type="STRING" size="8"/>
          <Column id="fiscalDate" type="STRING" size="8"/>
          <Column id="advanceOccurClass" type="STRING" size="4"/>
          <Column id="advanceTypeCd" type="STRING" size="18"/>
          <Column id="custCd" type="BIGDECIMAL" size="22"/>
          <Column id="sysClass" type="STRING" size="18"/>
          <Column id="muCd" type="STRING" size="4"/>
          <Column id="ccCd" type="STRING" size="6"/>
          <Column id="acctCd" type="STRING" size="12"/>
          <Column id="occurAmt" type="BIGDECIMAL" size="22"/>
          <Column id="applyAmt" type="BIGDECIMAL" size="22"/>
          <Column id="remark" type="STRING" size="300"/>
          <Column id="batchId" type="STRING" size="10"/>
          <Column id="occurSupplyAmt" type="BIGDECIMAL" size="22"/>
          <Column id="occurVatAmt" type="BIGDECIMAL" size="22"/>
          <Column id="applySupplyAmt" type="BIGDECIMAL" size="22"/>
          <Column id="applyVatAmt" type="BIGDECIMAL" size="22"/>
          <Column id="vatCd" type="STRING" size="1"/>
          <Column id="newhghtUpjang" type="STRING" size="12"/>
          <Column id="reservNum" type="STRING" size="15"/>
          <Column id="reservDate" type="STRING" size="8"/>
          <Column id="custNm" type="STRING" size="50"/>
          <Column id="guestTelNum" type="STRING" size="20"/>
          <Column id="journalzYn" type="STRING" size="1"/>
          <Column id="journalzNum" type="STRING" size="18"/>
          <Column id="upjangCd" type="STRING" size="12"/>
          <Column id="receiptNum" type="STRING" size="18"/>
          <Column id="mngmvAdvanceNum" type="STRING" size="18"/>
          <Column id="refNum" type="STRING" size="18"/>
          <Column id="couponProcNum" type="STRING" size="18"/>
          <Column id="recdStatus" type="STRING" size="1"/>
          <Column id="cuser" type="STRING" size="10"/>
          <Column id="cdate" type="DATETIME" size="7"/>
          <Column id="uuser" type="STRING" size="10"/>
          <Column id="udate" type="DATETIME" size="7"/>
          <Column id="advanceOccurClassNm" type="STRING" size="254"/>
          <Column id="advanceTypeCdNm" type="STRING" size="254"/>
          <Column id="sysClassNm" type="STRING" size="254"/>
          <Column id="muNm" type="STRING" size="254"/>
          <Column id="tmNm" type="STRING" size="254"/>
          <Column id="ccNm" type="STRING" size="254"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item4" compid="cbo_zeroIncludeYn" propid="value" datasetid="ds_search" columnid="zeroIncludeYn"/>
      <BindItem id="item2" compid="edt_upjangNm" propid="visible" datasetid=" " columnid="upjangNm"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 영업관리/영업잔액조회
 * 프로그램명   : MAG00010V.XML
 * 기      능   : 영업잔액조회
 * 작  성  자   : 박은규
 * 작성  일자   : 2013-02-05 
 * ----------------------------------------------------------------------------------------
 * HISTORY      : 1) 2013-02-05 박은규 - 최초개발 (CH201203_00081)
 ******************************************************************************************
*/
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"				// 시스템 공통
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"		//JAVA 코딩시
//@@컨버터에서 주석처리 #include "LIB::tit_comm_0001.js"		// X-Framework Lib
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"		// 공통팝업
//@@컨버터에서 주석처리 #include "lib::fm_common.js"			// FM공통
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var fa_Sql;
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj);

	//초기화
	fsp_init(this);
	v_ds_check = "ds_List1;ds_List3;ds_List4";
	//ta_Sql.Visible = (global.g_AuthLevel == "999");

	//화면 초기설정
// 	ed_Team.userdata      = application.g_Tm_Cd;
// 	ed_Team.value          = application.g_Tm_Nm;
// 	ed_Upjang.userdata    = application.g_Upjang;
// 	ed_Upjang.value        = application.g_UpjangNm;
	
	me_Sdate.value = fn_CurrDateWeek();
	me_Edate.value = fn_CurrDateWeek();
	st_Disp.visible = true;
	
	// 권한에 따른 버튼 활성화 및 디폴트값 설정
	//fn_SetAuth("ed_Team", "btn_Team", "ed_Upjang", "btn_Upjang");
	
	edt_tmNm.applyAuthLevel(edt_muNm);
	edt_upjangNm.applyAuthLevel(edt_tmNm);

	tab_list.tabindex = 0;
	//if (ed_Team.enable) ed_Team.setFocus();
	//else if (ed_Upjang.enable) ed_Upjang.setFocus();
	//else me_Sdate.setFocus();
}

//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*------------------------------------------------------------(60)
	1. Function ID : fn_Search()
	2. 개       요 : 업무프로세스에 따른 조회작업
	3. 기       능 : 검색조건에 해당하는 정보를 조회
	4. 인 수 설 명 : 
*/
function fn_search()
{
	if(gfn_isNull(edt_muNm.getMuCode())){
		alert("사업부는 필수 입력 사항입니다.");
		return;
	}
	
	//필수항목 
	if (!fn_ChkManNull()) return;
	
		// 탭 구분별 조회
	if(tab_list.tabindex == 1){ // 미수금 신용카드
		fn_searchCard();
		return;
	}else if(tab_list.tabindex == 2){ // 일반후불
		fn_searchCommon();
		return;
	}else if(tab_list.tabindex == 3){ // 식권외상판매
		fn_searchTicket();
		return;
	}else if(tab_list.tabindex == 4){ // 선수금 잔액
		fn_searchAdvance();
		return;
	}
	
	// 초기화
	ds_cond.clearData();
	//eval("ds_List" + gfn_toString(tab_list.tabindex+1)).clearData();
	ds_cond.addRow();
	ds_cond.setColumn(0, "muCd",      edt_muNm.getMuCode() );
	ds_cond.setColumn(0, "tmCd",      edt_tmNm.getTmCode() );
	ds_cond.setColumn(0, "upjangCd",     edt_upjangNm.getUpjangCode() );
	ds_cond.setColumn(0, "SDATE",      me_Sdate.value);
	ds_cond.setColumn(0, "occurDate",      me_Sdate.value);
	ds_cond.setColumn(0, "occurDateFrom",      me_Sdate.value);
	ds_cond.setColumn(0, "occurDateTo",      me_Edate.value);
	ds_cond.setColumn(0, "zeroIncludeYn", cbo_zeroIncludeYn.value);
	
	var strSvcID    = "search";
    var strURL      = "sm/sar/saleCashByValidDate/selectList2.xdo";
    var strInDs     = "ds_search=ds_cond:A";
    var strOutDs    = "ds_List3=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
    
	// 조회
	/*var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "MAG00010V_T001";
	strURL   = "U_svc::" + "ma/mag/MAG00010V_T001.jsp";
	// 데이터셋 설정
	strInDatasets  = "ds_Cond=ds_Cond";
	strOutDatasets = "ds_List" + gfn_toString(tab_list.tabindex+1)+ "=ds_List";
	// 파라메터 설정
	strArgument = "strIndex=" + wrapQuote(gfn_toString(tab_list.tabindex+1));
	// 콜백함수 지정
	strCallbackFunc = "fn_CallBack_Search";
	// 서버 호출 
	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);*/
}

/*------------------------------------------------------------
	1. Function ID : fn_Insert()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_insert()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Delete()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_delete()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Save()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_save()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Print()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_print()
{
	//gd_listE.ExportExcelEx("단가표");
}

/*------------------------------------------------------------
	1. Function ID : fn_Close()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_Close()
{
	This.close();
}

/*------------------------------------------------------------
	1. Function ID : fn_Help()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_help()
{
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
//콜백
/*function fn_CallBack_Search(errCode, errMsg)
{
ta_Sql.value = fa_Sql;
	if (errCode == 0)
	{
		if (eval("ds_List" + gfn_toString(tab_list.tabindex+1)).rowcount < 1)
			g_Message("EE","조회내용이 없습니다.");
			
			
		switch(tab_list.tabindex){
		    case 0:
		        ds_List1.keystring.current = "G:TM_CD,UPJANG"; 
		    case 1:
		        ds_List2.keystring.current = "G:TM_CD,UPJANG"; 
		    case 2:
		        ds_List3.keystring.current = "G:TM_CD,UPJANG"; 
		    case 3:
		        ds_List4.keystring.current = "G:TM_CD,UPJANG"; 
		    default:
			    break;
	    }	
	     
			
	}
	else
		g_Message("EE","조회중 오류가 발생했습니다. 관리자에게 문의하세요." + '\n' + '(' + errMsg + ')' );

   
    
    
}*/

function fn_ChkManNull()
{

	/*
	if ( ffn_ChkNull(edt_tmNm.getTmCode() ) )
	{
		g_Message("EE", "팀을 선택하세요.");
		edt_tmNm.setFocus();
		return false;
	}
	/*if ( ffn_ChkNull(ed_Upjang.UserData) )
	{
		g_Message("EE", "사업장을 선택하세요.");
		ed_Upjang.SetFocus();
		return true;
	}
*/
	//if (G_fn_IsDateYMD(me_Sdate.Value) == -1) return true
	if ( ffn_ChkNull(me_Sdate.value) || (gfn_length(me_Sdate.value)< 8) )
	{
		g_Message("EE", "일자를 정확하게 입력하세요.");
		me_Sdate.setFocus();
		return false;
	}
	
	return true;
}

/*function fn_edBtn_OnClick(obj:Button, e:ClickEventInfo)
{
	var sAddWhere;
	var sOnBoard  = "";
	
	switch(obj.name)
	{
		case "btn_Team":

			break;

		case "btn_Upjang":
			if (ffn_ChkNull(ed_Team.userdata))
			{
				g_Message("EE", "운영부서를 선택하세요.");
				ed_Team.setFocus();
				return;
			}
			sAddWhere = " AND A.TM_CD = '" + ed_Team.userdata + "'";

			break;

		default:
			break;
	}
	//fm공통 팝업클릭 호출
	if (ffn_btn_OnClick(obj, sAddWhere)) fn_Trigger_edBtn(eval("ed_" + gfn_subStr(obj.name, 4)));
}*/

/*function fn_edBtn_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if (ffn_ed_OnKeyDown(obj,e.keycode)) fn_Trigger_edBtn(eval("ed_" + gfn_subStr(obj.name, 3)));
}*/

/*function fn_Trigger_edBtn(obj)
{
	switch(obj)
	{
		case ed_Team:
			//초기화
			//ds_List.ClearData();
			ed_Upjang.userdata = ""; ed_Upjang.value = "";

			break;
			
		default:

			break;
	}
}*/

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
function gd_list_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	//alert(obj.getCellProperty("head", e.col,"class"));
	trace(e.cell);
	if(e.cell == 2){
		if(ds_List3.getRowCount() > 0){
			for(var i = 0; i < ds_List3.getRowCount();i++){
				trace("grd_list.getTreeStatus(i) : " + tab_list.tab3.gd_list.getTreeStatus(i));
				if (tab_list.tab3.gd_list.getTreeStatus(i) == 0 ) 
				{
					tab_list.tab3.gd_list.setTreeStatus(i, true);
				}else if (tab_list.tab3.gd_list.getTreeStatus(i) == 1 ){
					tab_list.tab3.gd_list.setTreeStatus(i, false);
				}
			}
		}
	}else{
		gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
	}
}

function tab_list_OnChanged(obj:Tab, e:TabIndexChangeEventInfo)
{
	st_Disp.visible = (e.postindex == 0);

}

// function Button00_onclick(obj:Button,  e:ClickEventInfo)
// {
//     var arrGridList = new Array(tab_list.tab1.gd_list,tab_list.tab1.gd_list);
//      
//      var strFileName = 'test';
//      var strSheetName = 'sheet1';
// 
// 	gfn_exportExcelMulti(arrGridList, strFileName, strSheetName) ;
// }

function fn_tmChange(obj, data){
	edt_upjangNm.setUpjangCode("");
}
/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {
		
        case "search" :
            //fn_searchCard(); // 미수금(신용카드) 조회
            break;
	
        case "searchCard" :
            //fn_searchCommon(); // 일반후불 조회
            break;
            
		case "searchCommon" :
            //fn_searchTicket(); // 식권외상판매 조회
            break;
            
		case "searchTicket" :
            //fn_searchAdvance() // 선수금 잔액 조회
            break;
            
		case "searchAdvance" :
            
            break;
            
        // 저장
        case "save" :
			gfn_alert("msg.save.success");	// 저장 되었습니다.
            break;    
    }
}

// 미수금(신용카드) 조회
function fn_searchCard(){
	
	ds_cond.clearData();
	
	ds_cond.addRow();
	
	ds_cond.setColumn(0, "muCd",      edt_muNm.getMuCode() );
	ds_cond.setColumn(0, "tmCd",      edt_tmNm.getTmCode() );
	ds_cond.setColumn(0, "upjangCd",     edt_upjangNm.getUpjangCode() );
	ds_cond.setColumn(0, "fiscalDate",      me_Sdate.value);
	ds_cond.setColumn(0, "zeroIncludeYn", cbo_zeroIncludeYn.value);
	ds_cond.setColumn(0, "arTypeCd", "A03"); // 미수금(신용카드)
	
	var strSvcID    = "searchCard";
    var strURL      = "sm/sar/arReportByValidDate/selectList.xdo";
    var strInDs     = "ds_search=ds_cond:A";
    var strOutDs    = "ds_List4=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

// 일반후불 조회
function fn_searchCommon(){
	
	ds_cond.clearData();
	
	ds_cond.addRow();
	ds_cond.setColumn(0, "muCd",      edt_muNm.getMuCode() );
	ds_cond.setColumn(0, "tmCd",      edt_tmNm.getTmCode() );
	ds_cond.setColumn(0, "upjangCd",     edt_upjangNm.getUpjangCode() );
	ds_cond.setColumn(0, "fiscalDate",      me_Sdate.value);
	ds_cond.setColumn(0, "zeroIncludeYn", cbo_zeroIncludeYn.value);
	ds_cond.setColumn(0, "arTypeCd", "A01"); // 일반후불
	
	var strSvcID    = "searchCommon";
    var strURL      = "sm/sar/arReportByValidDate/selectList.xdo";
    var strInDs     = "ds_search=ds_cond:A";
    var strOutDs    = "ds_List1=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

// 식권외상판매 조회
function fn_searchTicket(){
	
	ds_cond.clearData();
	
	ds_cond.addRow();
	ds_cond.setColumn(0, "muCd",      edt_muNm.getMuCode() );
	ds_cond.setColumn(0, "tmCd",      edt_tmNm.getTmCode() );
	ds_cond.setColumn(0, "upjangCd",     edt_upjangNm.getUpjangCode() );
	ds_cond.setColumn(0, "fiscalDate",      me_Sdate.value);
	ds_cond.setColumn(0, "zeroIncludeYn", cbo_zeroIncludeYn.value);
	ds_cond.setColumn(0, "arTypeCd", "A07"); // 식권외상판매
	
	var strSvcID    = "searchTicket";
    var strURL      = "sm/sar/arReportByValidDate/selectList.xdo";
    var strInDs     = "ds_search=ds_cond:A";
    var strOutDs    = "ds_List2=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

// 선수금잔액 조회
function fn_searchAdvance(){
	
	ds_cond.clearData();
	
	ds_cond.addRow();
	ds_cond.setColumn(0, "muCd",      edt_muNm.getMuCode() );
	ds_cond.setColumn(0, "tmCd",      edt_tmNm.getTmCode() );
	ds_cond.setColumn(0, "upjang",     edt_upjangNm.getUpjangCode() );
	ds_cond.setColumn(0, "occurDateFrom",      me_Sdate.value);
	ds_cond.setColumn(0, "zeroIncludeYn", cbo_zeroIncludeYn.value);
	
	var strSvcID    = "searchAdvance";
    var strURL      = "sm/spm/advanceBalanceInquiry/selectList.xdo";
    var strInDs     = "ds_search=ds_cond:A";
    var strOutDs    = "ds_List5=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}
function tab_list_tab3_gd_list_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	
	
	if(e.clickitem == "image" || e.clickitem == "treebutton") return;
	
    var nRow = obj.getTreeRow(e.row);    
    
    if (obj.getTreeStatus(nRow) == 0 ) 
    {
        // 설정하고자 하는 TreeStatus.
        //  false : 해당 Row의 TreeStatus를 Collapse로 설정
        //  true  : 해당 Row의 TreeStatus를 Expand로 설정                
        obj.setTreeStatus(nRow, true);
    } else if (obj.getTreeStatus(nRow) == 1 ) {
        obj.setTreeStatus(nRow, false);
    }
}

function fn_muOnchangedEvent(){
	edt_tmNm.setTmCode("");
	edt_upjangNm.setUpjangCode("");
}
]]></Script>
  </Form>
</FDL>

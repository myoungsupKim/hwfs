<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="MAM20020V" onkeydown="fr_Main_OnKeyDown" onload="form_onload" titletext="월별손익실적 보고서" userdata="FormLink='Y'" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static96" class="sta_WFSA_Labelbg01" position="absolute 0 80 1237 147" anchor="left top right"/>
        <Static id="Static00" position="absolute 0 30 1237 71" class="sta_WFSA_Labelbg" anchor="left top right"/>
        <Div id="div_cmnBtn" taborder="0" tabstop="false" text="Div0" url="cmn::CmnBtn.xfdl" position="absolute 0 0 1237 30" anchor="left top right" scrollbars="none"/>
        <Edit id="edt_Tm" onkeydown="edt_Tm_OnKeyDown" readonly="true" taborder="0" position="absolute 227 42 357 63"/>
        <Edit id="edt_Upjang" onkeydown="edt_Upjang_OnKeyDown" readonly="true" taborder="0" position="absolute 475 42 605 63"/>
        <Static id="Static1" text="팀" position="absolute 186 42 251 63" class="sta_WFSA_label"/>
        <Static id="Static2" text="사업장" position="absolute 407 42 472 63" class="sta_WFSA_label"/>
        <Combo codecolumn="YY" datacolumn="YY" displayrowcount="10" id="cbo_Yy" innerdataset="ds_close_out" taborder="11" position="absolute 57 42 127 63" class="cmb_WF_Essential"/>
        <Static id="Static6" text="연도" position="absolute 15 42 50 63" class="sta_WFSA_label"/>
        <Combo displayrowcount="10" id="cbo_Subjob" onitemchanged="fn_CboChange" taborder="13" visible="false" position="absolute 56 91 156 112"/>
        <Static id="Static0" text="지역" visible="false" position="absolute 186 91 259 112" class="sta_WFSA_label01"/>
        <Static id="Static3" text="직군" visible="false" position="absolute 15 91 49 112" class="sta_WFSA_label01"/>
        <Combo displayrowcount="10" id="cbo_Loc" onitemchanged="fn_CboChange" taborder="14" visible="false" position="absolute 227 91 327 112"/>
        <Static id="Static5" text="사업구분" visible="false" position="absolute 407 91 480 112" class="sta_WFSA_label01"/>
        <Combo codecolumn="GUBUN_CD" datacolumn="GUBUN_NAME" displayrowcount="10" id="cbo_New" innerdataset="ds_cbo_new" onitemchanged="fn_CboChange" taborder="14" visible="false" position="absolute 688 91 753 112"/>
        <Static id="Static7" text="기존/신규" visible="false" position="absolute 613 91 686 112" class="sta_WFSA_label01"/>
        <Static id="st_Gubun" text="구분" position="absolute 15 117 80 138" class="sta_WFSA_label01"/>
        <Combo displayrowcount="10" id="cbo_Saup" onitemchanged="fn_CboChange" taborder="26" visible="false" position="absolute 475 91 583 112"/>
        <Static id="Static05" text="(단위 : 천원)" position="absolute 1163 127 1234 148" anchor="top right"/>
        <Radio codecolumn="CLOSE_TYPE" columncount="4" datacolumn="CLOSE_TYPE_NAME" id="rdo_Type" index="-1" innerdataset="ds_rdo_type" taborder="22" position="absolute 56 117 409 138"/>
        <Radio codecolumn="CLOSE_TYPE" columncount="4" datacolumn="CLOSE_TYPE_NAME" id="rdo_Type_Temp" index="-1" innerdataset="ds_rdo_type_temp" taborder="31" position="absolute 56 117 217 138"/>
        <Static id="Static04" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 47 42 57 63" anchor="left top"/>
        <Static id="Static10" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 204 42 214 63" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 453 42 463 63" anchor="left top"/>
        <Static id="Static08" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static09" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Button id="edtBtn_Tm" taborder="32" tabstop="false" onclick="edtBtn_Tm_OnClick" class="btn_WF_popSearch" position="absolute 356 42 377 63"/>
        <Button id="edtBtn_Upjang" taborder="33" tabstop="false" onclick="edtBtn_Upjang_OnClick" class="btn_WF_popSearch" position="absolute 604 42 625 63"/>
        <Grid id="grd_Upjang" taborder="34" binddataset="ds_upjang_out" wheelscrollrow="1" readonly="true" useinputpanel="false" autofittype="col" oncelldblclick="grd_Upjang_OnCellDblClick" position="absolute 0 157 187 710" anchor="left top bottom">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="154"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" text="사업장 선택"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:left;" text="bind:UPJANGNM"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="grd_Main" taborder="35" binddataset="ds_out" wheelscrollrow="1" readonly="true" useinputpanel="false" cellsizingtype="both" cellmovingtype="col" useselcolor="false" onheadclick="grd_Main_OnHeadClick" position="absolute 197 157 1237 710" anchor="all" titletext="월별손익실적 보고서" autofittype="col">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="153" band="left"/>
                <Column size="90"/>
                <Column size="65"/>
                <Column size="65"/>
                <Column size="65"/>
                <Column size="65"/>
                <Column size="65"/>
                <Column size="65"/>
                <Column size="65"/>
                <Column size="65"/>
                <Column size="65"/>
                <Column size="65"/>
                <Column size="65"/>
                <Column size="65"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') left middle;" class="head_Excel" text="계 정"/>
                <Cell col="1" displaytype="text" text="연간"/>
                <Cell col="2" displaytype="text" text="1월"/>
                <Cell col="3" displaytype="text" text="2월"/>
                <Cell col="4" displaytype="text" text="3월"/>
                <Cell col="5" displaytype="text" text="4월"/>
                <Cell col="6" displaytype="text" text="5월"/>
                <Cell col="7" displaytype="text" text="6월"/>
                <Cell col="8" displaytype="text" text="7월"/>
                <Cell col="9" displaytype="text" text="8월"/>
                <Cell col="10" displaytype="text" text="9월"/>
                <Cell col="11" displaytype="text" text="10월"/>
                <Cell col="12" displaytype="text" text="11월"/>
                <Cell col="13" displaytype="text" text="12월"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="background:#566572ff;background2:#566572ff;color:#ffffffff;color2:#ffffff;font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:ACCT_NAME"/>
                <Cell col="1" displaytype="number" style="background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#FFFFCC'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#FFFFCC'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(YY_AMT&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(YY_AMT&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(YY_AMT&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(YY_AMT&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:YY_AMT" mask="expr:fn_getMaskType(currow)"/>
                <Cell col="2" displaytype="number" style="background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT01&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT01&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT01&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT01&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:AMT01" mask="expr:fn_getMaskType(currow)"/>
                <Cell col="3" displaytype="number" style="background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT02&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT02&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT02&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT02&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:AMT02" mask="expr:fn_getMaskType(currow)"/>
                <Cell col="4" displaytype="number" style="background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT03&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT03&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT03&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT03&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:AMT03" mask="expr:fn_getMaskType(currow)"/>
                <Cell col="5" displaytype="number" style="background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT04&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT04&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT04&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT04&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:AMT04" mask="expr:fn_getMaskType(currow)"/>
                <Cell col="6" displaytype="number" style="background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT05&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT05&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT05&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT05&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:AMT05" mask="expr:fn_getMaskType(currow)"/>
                <Cell col="7" displaytype="number" style="background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT06&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT06&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT06&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT06&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:AMT06" mask="expr:fn_getMaskType(currow)"/>
                <Cell col="8" displaytype="number" style="background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT07&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT07&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT07&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT07&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:AMT07" mask="expr:fn_getMaskType(currow)"/>
                <Cell col="9" displaytype="number" style="background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT08&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT08&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT08&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT08&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:AMT08" mask="expr:fn_getMaskType(currow)"/>
                <Cell col="10" displaytype="number" style="background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT09&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT09&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT09&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT09&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:AMT09" mask="expr:fn_getMaskType(currow)"/>
                <Cell col="11" displaytype="number" style="background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT10&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT10&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT10&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT10&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:AMT10" mask="expr:fn_getMaskType(currow)"/>
                <Cell col="12" displaytype="number" style="background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT11&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT11&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT11&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT11&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:AMT11" mask="expr:fn_getMaskType(currow)"/>
                <Cell col="13" displaytype="number" style="background:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));background2:EXPR(iif(ACCT_LEVEL == '1' ,'#DDDDDD','#ffffff'));color:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT12&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT12&lt;0,&quot;red&quot;,&quot;default&quot;)));color2:EXPR(iif(ACCT_LEVEL == &quot;10&quot;,iif(AMT12&lt;0,&quot;red&quot;,&quot;#0066FF&quot;),iif(AMT12&lt;0,&quot;red&quot;,&quot;default&quot;)));font:EXPR(iif(ACCT_LEVEL=='1','굴림,9,bold'));" text="bind:AMT12" mask="expr:fn_getMaskType(currow)"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static12" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 46 91 56 112" anchor="left top"/>
        <Static id="Static13" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 217 91 227 112" anchor="left top"/>
        <Static id="Static14" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 465 91 475 112" anchor="left top"/>
        <Static id="Static15" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 678 91 688 112" anchor="left top"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_rdo_type">
        <ColumnInfo>
          <Column id="CLOSE_TYPE" size="256" type="STRING"/>
          <Column id="CLOSE_TYPE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CLOSE_TYPE">C05A</Col>
            <Col id="CLOSE_TYPE_NAME">재무가확정</Col>
          </Row>
          <Row>
            <Col id="CLOSE_TYPE">C05B</Col>
            <Col id="CLOSE_TYPE_NAME">관리가확정</Col>
          </Row>
          <Row>
            <Col id="CLOSE_TYPE">C05C</Col>
            <Col id="CLOSE_TYPE_NAME">재무확정</Col>
          </Row>
          <Row>
            <Col id="CLOSE_TYPE">C05D</Col>
            <Col id="CLOSE_TYPE_NAME">관리확정</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_cbo_SubJob"/>
      <Dataset id="ds_cbo_Loc"/>
      <Dataset id="ds_cbo_new">
        <ColumnInfo>
          <Column id="GUBUN_CD" size="1" type="STRING"/>
          <Column id="GUBUN_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="GUBUN_CD"/>
            <Col id="GUBUN_NAME"/>
          </Row>
          <Row>
            <Col id="GUBUN_CD">O</Col>
            <Col id="GUBUN_NAME">기존</Col>
          </Row>
          <Row>
            <Col id="GUBUN_CD">N</Col>
            <Col id="GUBUN_NAME">신규</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_cbo_saup"/>
      <Dataset id="ds_close_in">
        <ColumnInfo>
          <Column id="MOD_CLASS" size="20" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_close_out">
        <ColumnInfo>
          <Column id="YY" size="4" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_old_out">
        <ColumnInfo>
          <Column id="NEW_GB" size="6" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_old_in">
        <ColumnInfo>
          <Column id="UPJANG" size="255" type="STRING"/>
          <Column id="YY" size="4" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_upjang_in">
        <ColumnInfo>
          <Column id="LOC_CD" size="10" type="STRING"/>
          <Column id="NEW_GB" size="10" type="STRING"/>
          <Column id="SAUP_TYPE" size="10" type="STRING"/>
          <Column id="SUB_JOB_CD" size="10" type="STRING"/>
          <Column id="TM_CD" size="10" type="STRING"/>
          <Column id="UPJANG" size="10" type="STRING"/>
          <Column id="YY" size="4" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_upjang_out">
        <ColumnInfo>
          <Column id="TM_CD" size="10" type="STRING"/>
          <Column id="TM_NAME" size="255" type="STRING"/>
          <Column id="UPJANG" size="6" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="255" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_in">
        <ColumnInfo>
          <Column id="CLOSE_TYPE" size="20" type="STRING"/>
          <Column id="LOC_CD" size="10" type="STRING"/>
          <Column id="NEW_GUBUN" size="10" type="STRING"/>
          <Column id="SAUP_TYPE" size="20" type="STRING"/>
          <Column id="SUB_JOB_CD" size="10" type="STRING"/>
          <Column id="TM_CD" size="3" type="STRING"/>
          <Column id="UPJANG" size="6" type="STRING"/>
          <Column id="YY" size="4" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_out">
        <ColumnInfo>
          <Column id="ACCT_CD" size="20" type="STRING"/>
          <Column id="ACCT_LEVEL" size="20" type="STRING"/>
          <Column id="ACCT_NAME" size="100" type="STRING"/>
          <Column id="AMT01" size="22" type="BIGDECIMAL"/>
          <Column id="AMT02" size="22" type="BIGDECIMAL"/>
          <Column id="AMT03" size="22" type="BIGDECIMAL"/>
          <Column id="AMT04" size="22" type="BIGDECIMAL"/>
          <Column id="AMT05" size="22" type="BIGDECIMAL"/>
          <Column id="AMT06" size="22" type="BIGDECIMAL"/>
          <Column id="AMT07" size="22" type="BIGDECIMAL"/>
          <Column id="AMT08" size="22" type="BIGDECIMAL"/>
          <Column id="AMT09" size="22" type="BIGDECIMAL"/>
          <Column id="AMT10" size="22" type="BIGDECIMAL"/>
          <Column id="AMT11" size="22" type="BIGDECIMAL"/>
          <Column id="AMT12" size="22" type="BIGDECIMAL"/>
          <Column id="YY_AMT" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_rdo_type_temp">
        <ColumnInfo>
          <Column id="CLOSE_TYPE" size="256" type="STRING"/>
          <Column id="CLOSE_TYPE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CLOSE_TYPE">C05B</Col>
            <Col id="CLOSE_TYPE_NAME">가확정</Col>
          </Row>
          <Row>
            <Col id="CLOSE_TYPE">C05D</Col>
            <Col id="CLOSE_TYPE_NAME">확정</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_cond"/>
    </Objects>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : FS시스템/경영관리/실적
 * 프로그램명   : MAP20020V.XML
 * 기      능   : 손익보고서
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"
//@@컨버터에서 주석처리 #include "Lib::lib_Date.js";
//@@컨버터에서 주석처리 #include "Lib::lib_Dataset.js";
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js";
//@@컨버터에서 주석처리 #include "LIB::ma_common.js";

//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================

//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	
	fsp_init(this);
	
	
	//Login 팀 정보 
	edt_Tm.userdata = g_Tm_Cd;
	edt_Tm.value = g_Tm_Nm;
	
	// Login 사업장 정보
	edt_Upjang.userdata = g_Upjang;
	edt_Upjang.value = g_UpjangNm;
	
	//사업장 권한 셋팅#############################################################################
	fn_SetAuth("edt_Tm","edtBtn_Tm","edt_Upjang", "edtBtn_Upjang");
    //사업장 권한 셋팅############################################################################# 
	
	
	//사용자 권한에 따른 구분 선택 여부 셋팅########################################################
	if ((g_AuthLevel == "10") || (g_AuthLevel == "12"))  { // 영양사, 리더영양사
       rdo_Type.visible = false;
       rdo_Type_Temp.visible = true;
       rdo_Type_Temp.index = 1;
       
      
     }
    else {
       rdo_Type.visible = true;
       rdo_Type_Temp.visible = false;
       rdo_Type.index = 2;
       
      
     }  
    //사용자 권한에 따른 구분 선택 여부 셋팅########################################################
	
	
	fsp_clear(this);
	// 마감연도 정보 조회 
    fsp_addSearch(this, "ma/mac:MAC_CLOSE_S002");
    
    http.Sync = true;
    fsp_callService(this, "", "", "", "ds_close_out=ds_close_out", "MOD_CLASS=MAM");
    http.Sync = false; 
      
    cbo_Yy.index = ds_close_out.rowcount-1;  
    
	
	fsp_clear(this);
	// 업장 정보 조회 
    fsp_addSearch(this, "ma/mac:MAC_UPJANG_MST_S001");
    // 서버 호출 
	http.Sync = true;
    fsp_callService(this, "", "", "", "ds_upjang_out=ds_upjang_out","TM_CD=" + wrapQuote(edt_Tm.userdata));
    http.Sync = false;
    
    fn_OrgChange();
   
    //권한에 따른 EXCEL DOWN세팅 #############################################################################
    fn_SetBlockExcelAuth(ds_cond, grd_Main);   
    //권한에 따른 EXCEL DOWN세팅 #############################################################################
}


//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================


/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 조회버튼 입력 시 처리되는 작업
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_search()
{
   /*  if (length(edt_Tm.Text) == 0)  {
		g_Message("EE", gfn_msg(SCCW00005, "팀"));
		edt_Tm.SetFocus();
		return;
	} 
	
	if (length(edt_Upjang.Text) == 0) {
	    g_Message("EE", gfn_msg(SCCW00005, "사업장"));
		edt_Upjang.SetFocus();
		return;
	} */
    // 초기화
	ds_in.clearData();
    
    gfn_clearGrid(grd_Main);
    grd_Main.binddataset = "";
    
    fsp_clear(this);
    
	// 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/mam:MAM20020V_S001");
	
	
   // <isNotNull col="SUB_JOB_CD">
   // AND SUB_JOB_CD = #SUB_JOB_CD#
   // </isNotNull>
   // <isNotNull col="LOC_CD">
   // AND LOC_CD = #LOC_CD#
   // </isNotNull>
   // <isNotNull col="NEW_GUBUN">
   // AND NEW_GUBUN = #NEW_GUBUN#
   // </isNotNull>
   // <isNotNull col="SAUP_TYPE">
   // AND SAUP_TYPE = #SAUP_TYPE#
   // </isNotNull>   	
   	
	// 서버 호출 
	http.Sync = true;
	
	if ((g_AuthLevel == "10") || (g_AuthLevel == "12"))  { // 영양사, 리더영양사 
	  fsp_callService(this, "", "", "", "ds_out=ds_out","YY=" + wrapQuote(cbo_Yy.value) + " CLOSE_TYPE=" + wrapQuote(rdo_Type_Temp.value)  + " TM_CD=" + wrapQuote(edt_Tm.userdata) + " UPJANG=" + wrapQuote(edt_Upjang.userdata) + " SUB_JOB_CD=" + wrapQuote(cbo_Subjob.value) + " LOC_CD=" + wrapQuote(cbo_Loc.value) + " SAUP_TYPE=" + wrapQuote(cbo_Saup.value) + " NEW_GUBUN=" + wrapQuote(cbo_New.value),"fn_afterSearch");
	}
	else {
	  fsp_callService(this, "", "", "", "ds_out=ds_out","YY=" + wrapQuote(cbo_Yy.value) + " CLOSE_TYPE=" + wrapQuote(rdo_Type.value)  + " TM_CD=" + wrapQuote(edt_Tm.userdata) + " UPJANG=" + wrapQuote(edt_Upjang.userdata) + " SUB_JOB_CD=" + wrapQuote(cbo_Subjob.value) + " LOC_CD=" + wrapQuote(cbo_Loc.value) + " SAUP_TYPE=" + wrapQuote(cbo_Saup.value) + " NEW_GUBUN=" + wrapQuote(cbo_New.value),"fn_afterSearch");
	}
	
	http.Sync = false;
	
	
}


/*
 ******************************************************************************************
 * 함  수  명   : fn_Insert()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 입력버튼 입력 시 처리되는 작업
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_insert()
{
    
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Save()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 저장버튼 입력 시 처리되는 작업
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_save()
{
  
 }

/*
 ******************************************************************************************
 * 함  수  명   : fn_Delete()
 * 입      력   : kEY 값
 * 반      환   : 없음
 * 기      능   : 삭제버튼 입력 시 처리되는 작업
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */

function fn_delete()
{
      
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Close()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 닫기 버튼 이벤트
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_Close()
{
	this.close();
}



/*
 ******************************************************************************************
 * 함  수  명   : fn_Help()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 도움말 
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_help()
{
}


//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================



//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 개요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSearch
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : callback 
 * 작  성  자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_afterSearch(errCode, errMsg) {
   // 재료비율
    // 재료비 식음료 비율 
    // 재료비 상품 비율
    // 인건비 비율
    // 경비 비율
    // 매출이익율 
   
    var row1 = fn_getRow("PLB10000");   // 재료비
    var row2 = fn_getRow("PLA00000");   // 매출액
   
    var row3 = fn_getRow("PLB11000");   // 식음료재료비
    var row4 = fn_getRow("PLA10000");   // 식음료매출
    
    var row5 = fn_getRow("PLB12000");   // 상품재료비
    var row6 = fn_getRow("PLA20000");   // 상품매출
    
    var row7 = fn_getRow("PLB20000");   // 인건비
    var row8 = fn_getRow("PLA00000");   // 매출액
    
    var row9 = fn_getRow("PLB30000");   // 경비
    var row10 = fn_getRow("PLA00000");  // 매출액
    
    var row11 = fn_getRow("PLC00000");   // 매출이익
    var row12 = fn_getRow("PLA00000");   // 매출액
    
    
    var tRow1 = fn_getRow("PLB10090");              // 재료비원가율
    var tRow2 = fn_getRow("PLB11090");   			// 식음료원가율
    var tRow3 = fn_getRow("PLB12090");   			// 상품원가율
    
    var tRow4 = fn_getRow("PLB20090");              // 인건비비율 
    var tRow5 = fn_getRow("PLB30090");			    // 경비비율 
    
    var tRow6 = fn_getRow("PLC00090");              // 영업이익율
    
    
     
     // 재료비 비율
    if (toNumber(ds_out.getColumn(row2, "YY_AMT")) != 0 ) {
	    ds_out.setColumn(tRow1, "YY_AMT" 
	         , Math.round(toNumber(ds_out.getColumn(row1, "YY_AMT")) / toNumber(ds_out.getColumn(row2, "YY_AMT")) * 100, 1));
	  }
		
	// 식음료 재료비 비율
   	if (toNumber(ds_out.getColumn(row4, "YY_AMT")) != 0 ) {
		ds_out.setColumn(tRow2, "YY_AMT"
			, Math.round(toNumber(ds_out.getColumn(row3, "YY_AMT")) / toNumber(ds_out.getColumn(row4, "YY_AMT")) * 100 , 1));
	  }	
		
	 // 상품 재료비 비율 
	if (toNumber(ds_out.getColumn(row6, "YY_AMT")) != 0 ) {
		ds_out.setColumn(tRow3, "YY_AMT"
			, Math.round(toNumber(ds_out.getColumn(row5, "YY_AMT")) / toNumber(ds_out.getColumn(row6, "YY_AMT")) * 100 , 1));
	 }	
		
	// 인건비 비율 
	if (toNumber(ds_out.getColumn(row8, "YY_AMT")) != 0 ) {	
		ds_out.setColumn(tRow4, "YY_AMT"
			, Math.round(toNumber(ds_out.getColumn(row7, "YY_AMT")) / toNumber(ds_out.getColumn(row8, "YY_AMT")) * 100 , 1));
	 }
	 		
	// 경비 비율
	if (toNumber(ds_out.getColumn(row10, "YY_AMT")) != 0 ) {		 
		ds_out.setColumn(tRow5, "YY_AMT"
			, Math.round(toNumber(ds_out.getColumn(row9, "YY_AMT")) / toNumber(ds_out.getColumn(row10, "YY_AMT")) * 100 , 1)); 
	 }
	 		   
	// 매출이익율
	if (toNumber(ds_out.getColumn(row12, "YY_AMT")) != 0 ) {		
		ds_out.setColumn(tRow6, "YY_AMT"
			, Math.round(toNumber(ds_out.getColumn(row11, "YY_AMT")) / toNumber(ds_out.getColumn(row12, "YY_AMT")) * 100 , 1));    
     }
 
    
    var colNm = "";
    for( var i = 1; i <= 12; i++ ) {
        if ( i < 10 ) {
            colNm = "0" + i;
        } else {
            colNm = "" + i;
        }
        
     if (toNumber(ds_out.getColumn(row2, "AMT" + colNm)) != 0 ) {
        ds_out.setColumn(tRow1, "AMT" + colNm
            , Math.round(ds_out.getColumn(row1, "AMT" + colNm) / ds_out.getColumn(row2, "AMT" + colNm) * 100 , 1));
       }
     
     if (toNumber(ds_out.getColumn(row4, "AMT" + colNm)) != 0 ) {       
        ds_out.setColumn(tRow2, "AMT"+ colNm
            , Math.round(ds_out.getColumn(row3, "AMT"+ colNm) / ds_out.getColumn(row4, "AMT"+ colNm) * 100 , 1));
       }
        
     if (toNumber(ds_out.getColumn(row6, "AMT" + colNm)) != 0 ) {   
        ds_out.setColumn(tRow3, "AMT"+ colNm
            , Math.round(ds_out.getColumn(row5, "AMT"+ colNm) / ds_out.getColumn(row6, "AMT"+ colNm) * 100 , 1));
       }
            
     if (toNumber(ds_out.getColumn(row8, "AMT" + colNm)) != 0 ) {        
        ds_out.setColumn(tRow4, "AMT" + colNm
            , Math.round(ds_out.getColumn(row7, "AMT" + colNm) / ds_out.getColumn(row8, "AMT" + colNm) * 100 , 1));
       }
            
     if (toNumber(ds_out.getColumn(row10, "AMT" + colNm)) != 0 ) {        
        ds_out.setColumn(tRow5, "AMT"+ colNm
            , Math.round(ds_out.getColumn(row9, "AMT"+ colNm) / ds_out.getColumn(row10, "AMT"+ colNm) * 100 , 1));
       } 
       
     if (toNumber(ds_out.getColumn(row12, "AMT" + colNm)) != 0 ) {   
        ds_out.setColumn(tRow6, "AMT"+ colNm
            , Math.round(ds_out.getColumn(row11, "AMT"+ colNm) / ds_out.getColumn(row12, "AMT"+ colNm) * 100 , 1));    
       } 
    }
    
    grd_Main.binddataset = "ds_out";
    gfn_showMsgGrid(grd_Main);
 }
 
 
 /*
 ******************************************************************************************
 * 함  수  명   : fn_getRow
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 처리할 row 찾기  
 * 작  성  자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_getRow(str, stIdx) {
    if ( stIdx == null ) {
        stIdx = 0;
    }

    for ( var i = stIdx; i < ds_out.getRowCount(); i++) {
        if ( str == gfn_trim( ds_out.getColumn(i, "ACCT_CD") )) {
            return i;
        }
    }
    
    return -1;
}

/*
 ******************************************************************************************
 * 함  수  명   : fr_Main_OnKeyDown
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : KeyDown 이벤트 (sc_comon 호출)
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fr_Main_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	// sc_comon 호출
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
}


/*
 ******************************************************************************************
 * 함  수  명   : edtBtn_Tm_OnClick()
 * 입      력   : 없음
 * 반      환   : 팀코드/코드명
 * 기      능   : 조회조건 팝업
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */

function edtBtn_Tm_OnClick(obj:Button, e:ClickEventInfo)
{
        fn_sql_common_setup(strMAQuery_Team2, 
							strMAQuery_Team2KeyField, 
							strMAQuery_Team2ValueField, 
							strMAQuery_Team2KeyFieldNM, 
							strMAQuery_Team2ValueFieldNM, 
							"", 
							"", 
							"",
							strMAQuery_Team2Caption,
							strMAQuery_Team2AllField);
	
	if (gds_sql_common.getColumn(0, "ret_code") != ""){
		
		edt_Tm.userdata = gds_sql_common.getColumn(0, "ret_code");
		edt_Tm.value     = gds_sql_common.getColumn(0, "ret_name");
		
		edt_Upjang.userdata = "";
        edt_Upjang.value = "";
	 }	
	
    
    fsp_clear(this);
    // 업장 정보 조회 
    fsp_addSearch(this, "ma/mac:MAC_UPJANG_MST_S001");
    // 서버 호출 
	http.Sync = true;
    fsp_callService(this, "", "", "", "ds_upjang_out=ds_upjang_out","TM_CD=" + wrapQuote(edt_Tm.userdata));// + " AND DECODE('" + g_AuthLevel + "', '12', LEADER_SABUN, '" + g_EmpNo + "') = '" + g_EmpNo + "'");
    http.Sync = false;
    
    edt_Upjang.setFocus();
    
    fn_OrgChange();
 }

/*
 ******************************************************************************************
 * 함  수  명   : edtBtn_Upjang_OnClick()
 * 입      력   : 없음
 * 반      환   : 업장코드/코드명
 * 기      능   : 조회조건 팝업
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function edtBtn_Upjang_OnClick(obj:Button, e:ClickEventInfo)
{ 
    if( gfn_length(edt_Tm.value)== 0 ) {
        g_Message("EE","팀을 먼저 선택하여 주십시오.");
        edt_Tm.setFocus();
        return;
    }  
        
        fn_sql_common_setup(strMAQuery_Upjang + " AND DECODE('" + g_AuthLevel + "', '12', LEADER_SABUN, '" + g_EmpNo + "') = '" + g_EmpNo + "'",  
							strMAQuery_UpjangKeyField, 
							strMAQuery_UpjangValueField, 
							strMAQuery_UpjangKeyFieldNM, 
							strMAQuery_UpjangValueFieldNM, 
							"", 
							"",
							" AND NVL(TM_CD,'0') LIKE '%" +gfn_toString(edt_Tm.userdata)+ "%'",// AND NVL(LOC_CD,'0') LIKE '%" +ToString(cbo_Loc.Value) + "%'" + " AND NVL(SUB_JOB_CD,'0') LIKE '%" +ToString(cbo_SubJob.Value) + "%'",
							strMAQuery_UpjangCaption,
							strMAQuery_UpjangAllField);

	if (gds_sql_common.getColumn(0, "ret_code") != ""){
		
		edt_Upjang.userdata = gds_sql_common.getColumn(0, "ret_code");
		edt_Upjang.value     = gds_sql_common.getColumn(0, "ret_name");
		
	}
     
	fn_OrgChange();  
}


/*
 ******************************************************************************************
 * 함  수  명   : edt_Tm_OnKeyDown() 
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : Edit EnterKey Event
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function edt_Tm_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	
	fn_edt_OnKeyDown(obj,e.keycode);
	
	if (e.keycode == 46) {
	   
	   edt_Upjang.userdata = "";
       edt_Upjang.value = "";
   
       fn_OrgChange();
	 
     }		
		
}

/*
 ******************************************************************************************
 * 함  수  명   : edt_Upjang_OnKeyDown() 
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : Edit EnterKey Event
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function edt_Upjang_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	fn_edt_OnKeyDown(obj,e.keycode);
	
		
	if (e.keycode == 46) {
	   
	   fn_OrgChange();
	 
      }		
    
}

/*
 ******************************************************************************************
 * 함  수  명   : grd_Main_OnHeadClick() 
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : Excel Down
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function grd_Main_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{

  if (obj.getCellProperty("head",e.cell,"class") == "head_Excel") 
	  gfn_exportExcel(obj, this.titletext);
  /*}
  else {	
	G_GridSort(object(obj.BindDataset), obj, nCell);
  }	*/
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_OrgChange() 
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : 콤보박스 자료 생성
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_OrgChange()
{
   fsp_clear(this);
   
   if (gfn_length(gfn_trim(edt_Upjang.userdata))== 0 ) {  
      
      if (gfn_length(gfn_trim(edt_Tm.userdata))== 0 ) {  
			 
		 //지역코드
		 fn_sql_common("C", strMAQuery_LOC_CD,""," ORDER BY CODE_NAME","non",cbo_Loc,-1,ds_cbo_Loc);
		 
		 //SUB 직군코드
		 fn_sql_common("C", strMAQuery_MASUBJOB,""," ORDER BY SUB_JOB_NAME","non",cbo_Subjob,-1,ds_cbo_SubJob);
		 
		 //사업코드
		 fn_sql_common("C", strMAQuery_MASAUP_TYPE1,""," ORDER BY SAUP_NAME","non",cbo_Saup,-1,ds_cbo_saup);
		 
		 cbo_New.userdata = "";
		 cbo_New.text = "";
		 
		 fsp_clear(this);
	     // 업장 정보 조회 
         fsp_addSearch(this, "ma/mac:MAC_UPJANG_MST_S001");
         // 서버 호출 
	     http.Sync = true;
		 fsp_callService(this, "", "", "", "ds_upjang_out=ds_upjang_out","TM_CD=" + wrapQuote(edt_Tm.userdata) + " SUB_JOB_CD=" + wrapQuote(cbo_Subjob.value) + " LOC_CD=" + wrapQuote(cbo_Loc.value) + " SAUP_TYPE=" + wrapQuote(cbo_Saup.value) + " YY=" + wrapQuote(cbo_Yy.value) + " NEW_GB=" + wrapQuote(cbo_New.value) );
		 http.Sync = false;
    
		}	 	 
	 else {
	  		//지역코드
		fn_sql_common("C", strMAQuery_MALOC_CD,""," AND TM_CD = '"+gfn_toString(edt_Tm.userdata)+ "' ORDER BY LOC_NAME","",cbo_Loc,-1,ds_cbo_Loc);
		 
		//SUB 직군코드
		fn_sql_common("C", strMAQuery_MASUBJOB1,""," AND TM_CD = '"+gfn_toString(edt_Tm.userdata)+ "' ORDER BY SUB_JOB_NAME","",cbo_Subjob,-1,ds_cbo_SubJob);
		 
		//사업코드
		fn_sql_common("C", strMAQuery_MASAUP_TYPE2,""," AND TM_CD = '"+gfn_toString(edt_Tm.userdata)+ "' ORDER BY SAUP_NAME","",cbo_Saup,-1,ds_cbo_saup);
		 
		cbo_New.userdata = "";
		cbo_New.text = "";
	  }
   }     
   else {
    
        //지역코드
		fn_sql_common("C", strMAQuery_MALOC_CD,""," AND UPJANG = '"+gfn_toString(edt_Upjang.userdata)+ "' ORDER BY LOC_NAME","",cbo_Loc,-1,ds_cbo_Loc);
		cbo_Loc.index = 0;
		 
		//SUB 직군코드
		fn_sql_common("C", strMAQuery_MASUBJOB1,""," AND UPJANG = '"+gfn_toString(edt_Upjang.userdata)+ "' ORDER BY SUB_JOB_NAME","",cbo_Subjob,-1,ds_cbo_SubJob);
		cbo_Subjob.index = 0;
		 
		//사업코드
		fn_sql_common("C", strMAQuery_MASAUP_TYPE2,""," AND UPJANG = '"+gfn_toString(edt_Upjang.userdata)+ "' ORDER BY SAUP_NAME","",cbo_Saup,-1,ds_cbo_saup);
		cbo_Saup.index = 0;
		
		
		// 업장 신규 정보 조회 
		fsp_addSearch(this, "ma/mac:MAC_UPJANG_NEW_S001");
		// 서버 호출 
		http.Sync = true;
		fsp_callService(this, "", "", "", "ds_old_out=ds_old_out","YY=" + wrapQuote(cbo_Yy.value) + " UPJANG=" + wrapQuote(edt_Upjang.userdata));
		http.Sync = false;
		
		/*if (length(ds_old_out.GetColumn(ds_old_out.row, "NEW_GB")) == 0) {
		  cbo_New.UserData = "N";
		  cbo_New.Text = "신규";
		 }
		else
		  cbo_New.UserData = "O";
		  cbo_New.Text = "기존";
		 } */
		 
		if (ds_old_out.getColumn(ds_old_out.rowposition, "NEW_GB") == 0) {
		  cbo_New.index = 2; 
		}
		else
		  cbo_New.index = 1;
		}  
  }
   
 /*
 ******************************************************************************************
 * 함  수  명   : fn_CboChange() 
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : 콤보박스 Change Event
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_CboChange(obj:Combo, e:ItemChangeEventInfo)
{ 
   fsp_clear(this);
	// 업장 정보 조회 
    fsp_addSearch(this, "ma/mac:MAC_UPJANG_MST_S001");
    // 서버 호출 
	http.Sync = true;
    fsp_callService(this, "", "", "", "ds_upjang_out=ds_upjang_out","TM_CD=" + wrapQuote(edt_Tm.userdata));
    http.Sync = false;
 }   
 
 /*
 ******************************************************************************************
 * 함  수  명   : grd_Upjang_OnCellDblClick() 
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : 콤보박스 Change Event
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function grd_Upjang_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
  if ((g_AuthLevel == "10") || (g_AuthLevel == "12"))  { // 영양사, 리더영양사
	  
	  g_Message("EE","사업장 변경 권한이 없습니다.");
      return;
   }
   
  else {
	 edt_Tm.userdata = ds_upjang_out.getColumn(ds_upjang_out.rowposition, "TM_CD");
	  edt_Tm.value     = ds_upjang_out.getColumn(ds_upjang_out.rowposition, "TM_NAME");
	  
	  edt_Upjang.userdata = ds_upjang_out.getColumn(ds_upjang_out.rowposition, "UPJANG");
	  edt_Upjang.value     = ds_upjang_out.getColumn(ds_upjang_out.rowposition, "UPJANGNM");
	  
	  fn_OrgChange();
	  
	  fn_search();
   }	  
}


/*
 ******************************************************************************************
 * 함  수  명   : fn_getMaskType() 
 * 입      력   : 없음
 * 반      환   : 
 * 기      능   : 그리드 마스트 타입 
 * 작  성  자   : 
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
  
function fn_getMaskType(nRow) {
    if ( ds_out.getColumn(nRow, "ACCT_LEVEL") == "10" ) {
        // 비율 
        return "#,##0.0";
    } else {
        return "#,##0";
    }
}

]]></Script>
  </Form>
</FDL>

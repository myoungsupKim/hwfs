<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="MAS10140E" onkeydown="fn_form_OnKeyDown" onload="form_onload" titletext="세금계산서발행" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="sta_detail41" class="sta_WFDA_Labelbg" position="absolute 867 534 1237 561" anchor="left right"/>
        <Static id="sta_detail40" class="sta_WFDA_Labelbg" position="absolute 867 664 1237 692" anchor="left right"/>
        <Static id="sta_detail38" class="sta_WFDA_Labelbg" position="absolute 867 612 1237 639" anchor="left right"/>
        <Static id="sta_detail39" class="sta_WFDA_Labelbg" position="absolute 867 638 1237 665" anchor="left right"/>
        <Static id="sta_detail36" class="sta_WFDA_Labelbg" position="absolute 867 560 1237 587" anchor="left right"/>
        <Static id="sta_detail37" class="sta_WFDA_Labelbg" position="absolute 867 586 1237 613" anchor="left right"/>
        <Static id="sta_detail34" class="sta_WFDA_Labelbg" position="absolute 867 482 1237 509" anchor="left right"/>
        <Static id="sta_detail35" class="sta_WFDA_Labelbg" position="absolute 867 508 1237 535" anchor="left right"/>
        <Static id="sta_detail33" class="sta_WFDA_Labelbg" position="absolute 635 665 726 692"/>
        <Static id="sta_detail32" class="sta_WFDA_Labelbg" position="absolute 631 534 726 561"/>
        <Static id="sta_detail27" class="sta_WFDA_Labelbg" position="absolute 443 560 581 587"/>
        <Static id="sta_detail28" class="sta_WFDA_Labelbg" position="absolute 443 586 581 613"/>
        <Static id="sta_detail29" class="sta_WFDA_Labelbg" position="absolute 443 612 581 639"/>
        <Static id="sta_detail30" class="sta_WFDA_Labelbg" position="absolute 443 638 581 665"/>
        <Static id="sta_detail31" class="sta_WFDA_Labelbg" position="absolute 443 664 581 691"/>
        <Static id="sta_detail25" class="sta_WFDA_Labelbg" position="absolute 580 482 726 509"/>
        <Static id="sta_detail26" class="sta_WFDA_Labelbg" position="absolute 631 508 726 535"/>
        <Static id="sta_detail10" class="sta_WFDA_Labelbg" position="absolute 867 430 1237 457" anchor="left right"/>
        <Static id="sta_detail13" class="sta_WFDA_Labelbg" position="absolute 867 456 1237 483" anchor="left right"/>
        <Static id="sta_detail04" class="sta_WFDA_Labelbg" position="absolute 443 430 726 457"/>
        <Static id="sta_detail09" class="sta_WFDA_Labelbg" position="absolute 443 456 581 483"/>
        <Static id="sta_detail03" class="sta_WFDA_Labelbg" position="absolute 150 456 301 483"/>
        <Static id="sta_detail02" class="sta_WFDA_Labelbg" position="absolute 150 430 301 457"/>
        <Grid autoenter="select" binddataset="ds_list" cellsizingtype="both" readonly="false" enable="true" cellsizebandtype="allband" id="grid_List" useinputpanel="false" onexpanddown="grid_List_OnExpandEdit" onheadclick="grid_List_OnHeadClick" taborder="14" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 196 1237 399" selecttype="row" autofittype="col" anchor="left right">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="27"/>
                <Column size="162"/>
                <Column size="175"/>
                <Column size="77"/>
                <Column size="70"/>
                <Column size="73"/>
                <Column size="170"/>
                <Column size="81"/>
                <Column size="58"/>
                <Column size="81"/>
                <Column size="33"/>
                <Column size="33"/>
                <Column size="146"/>
                <Column size="33"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="발행번호"/>
                <Cell col="2" displaytype="text" text="국세청승인번호"/>
                <Cell col="3" displaytype="text" text="발행종류"/>
                <Cell col="4" displaytype="text" text="발행구분"/>
                <Cell col="5" displaytype="text" text="발행일자"/>
                <Cell col="6" displaytype="text" text="고객사"/>
                <Cell col="7" displaytype="text" text="공급가"/>
                <Cell col="8" displaytype="text" text="부가세"/>
                <Cell col="9" displaytype="text" text="적요"/>
                <Cell col="10" displaytype="text" text="마감"/>
                <Cell col="11" displaytype="text" text="전자"/>
                <Cell col="12" displaytype="text" text="상태"/>
                <Cell col="13" displaytype="text" text="서손"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:BILL_NO"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:TAX_APPROVAL_NO"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:BILL_TYPENM"/>
                <Cell col="4" displaytype="text" style="align:left;" text="bind:BILL_GUBUNNM"/>
                <Cell col="5" displaytype="date" style="align:center;" text="bind:BILL_DATE" calendardisplaynulltype="none"/>
                <Cell col="6" displaytype="text" style="align:left;" text="bind:CUSTCDNM"/>
                <Cell col="7" displaytype="number" style="align:right;" text="bind:AMT"/>
                <Cell col="8" displaytype="number" style="align:right;" text="bind:VAT"/>
                <Cell col="9" displaytype="text" style="align:left;" text="bind:BILL_DESC"/>
                <Cell col="10" displaytype="text" edittype="expand" style="align:left;background:EXPR(fn_GetBackColorClose(&quot;1&quot;, CLS_YN));background2:EXPR(fn_GetBackColorClose(&quot;2&quot;, CLS_YN));" text="bind:CLS_YN" expandshow="expr:iif(CANCEL_YN=='N', 'show', 'hide')"/>
                <Cell col="11" displaytype="text" style="align:center;" text="bind:TAX_IF_GB"/>
                <Cell col="12" displaytype="text" style="align:left;" text="bind:ELC_AGREE_STAT"/>
                <Cell col="13" displaytype="text" style="align:center;background:EXPR(fn_GetBackColorClose(&quot;1&quot;, CANCEL_YN));background2:EXPR(fn_GetBackColorClose(&quot;2&quot;, CANCEL_YN));" text="bind:CANCEL_YN"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static2" text="♨세금계산서 출력 오류발생 시 서손 후 재발행하여야 하므로, 프린터 토너등 프린터상태 및 PC상태를 확인하시고 발행하여 주시기 바랍니다." position="absolute 0 698 935 711"/>
        <Static id="st_CURR_OP_VENDOR" text="구분 " position="absolute 0 430 64 483" class="sta_WFDA_Label01"/>
        <Static id="st_TAXSENDGB" text="발행구분" position="absolute 63 430 151 457" class="sta_WFDA_Label01"/>
        <Combo displayrowcount="10" enable="false" id="cbo_TAXSENDGB" taborder="37" position="absolute 153 433 298 454" class="cmb_WF_Essential"/>
        <Static id="st_SMSSENDYN" text="SMS발송여부" position="absolute 63 456 151 483" class="sta_WFDA_Label01"/>
        <Combo displayrowcount="10" enable="false" id="cbo_SMSSENDYN" taborder="39" position="absolute 153 459 298 480" codecolumn="codecolumn" datacolumn="datacolumn" class="cmb_WF_Essential">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">Y</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">N</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="Static9" text="거래처&#10;정보" position="absolute 0 482 64 691" class="sta_WFDA_Label01"/>
        <Static id="st_NATFORGB" text="구분" position="absolute 63 482 151 509" class="sta_WFDA_Label01"/>
        <Static id="st_SAUPNO" text="사업자번호" position="absolute 63 508 151 535" class="sta_WFDA_Label01"/>
        <Static id="st_CUSTNM" text="사업자명" position="absolute 63 534 151 561" class="sta_WFDA_Label01"/>
        <Static id="st_DRNAME1" text="대표자명" position="absolute 63 560 151 587" class="sta_WFDA_Label01"/>
        <Static id="st_Addr" text="주소" position="absolute 63 586 151 613" class="sta_WFDA_Label01"/>
        <Static id="st_Uptae" text="업태" position="absolute 63 612 151 639" class="sta_WFDA_Label01"/>
        <Static id="st_Upjong" text="종목" position="absolute 63 638 151 665" class="sta_WFDA_Label01"/>
        <Static id="st_PassportNo" text="여권/등록No" position="absolute 63 664 151 691" class="sta_WFDA_Label01"/>
        <Static id="st_EMPNO" text="성명" userdata="strMAQuery_SABUN" position="absolute 788 430 868 457" class="sta_WFDA_Label01"/>
        <Edit enable="false" id="edt_EMPNO" imemode="native" maxlength="30" onkeydown="edt_BILL_TYPE_OnKeyDown" readonly="true" taborder="62" position="absolute 870 433 949 454" class="edt_WF_Essential"/>
        <Edit lengthunit="asciii" enable="false" id="edt_TELNO" imemode="native" maxlength="20" taborder="63" position="absolute 870 459 970 480" class="edt_WF_Essential"/>
        <Static id="st_TELNO" text="전화번호" position="absolute 788 456 868 483" class="sta_WFDA_Label01"/>
        <Edit lengthunit="asciii" enable="false" id="edt_CPNO" imemode="native" maxlength="20" taborder="65" position="absolute 870 485 970 506" class="edt_WF_Essential"/>
        <Static id="st_CPNO" text="휴대폰번호" position="absolute 788 482 868 509" class="sta_WFDA_Label01"/>
        <Edit lengthunit="asciii" enable="false" id="edt_EMAIL" imemode="english" maxlength="40" onkeydown="edt_BILL_DESC_OnKeyDown" taborder="67" position="absolute 870 511 970 532" class="edt_WF_Essential"/>
        <Static id="st_EMAIL" text="E-Mail" position="absolute 788 508 868 535" class="sta_WFDA_Label01"/>
        <Edit lengthunit="asciii" enable="false" id="edt_DEPTNM" imemode="native" maxlength="40" taborder="69" position="absolute 870 537 970 558" class="edt_WF_Essential"/>
        <Static id="st_DEPTNM" text="부서" position="absolute 788 534 868 561" class="sta_WFDA_Label01"/>
        <Static id="Static23" text="담당자&#10;정보&#10;&#10;(점장님&#10;정보)" position="absolute 725 430 789 561" class="sta_WFDA_Label01"/>
        <Static id="st_EMPNOUP" text="성명" userdata="strMAQuery_SABUN" position="absolute 788 560 868 587" class="sta_WFDA_Label01"/>
        <Edit enable="false" id="edt_EMPNOUP" imemode="native" maxlength="30" onkeydown="edt_BILL_TYPE_OnKeyDown" readonly="true" taborder="72" position="absolute 870 563 949 584" class="edt_WF_Essential"/>
        <Button enable="false" id="edtBtn_EMPNOUP" onclick="edtBtn_BILL_TYPE_OnClick" taborder="73" tabstop="false" position="absolute 948 563 969 584" class="btn_WF_popSearch" text="" image=""/>
        <Edit lengthunit="asciii" enable="false" id="edt_TELNOUP" imemode="native" maxlength="20" taborder="74" position="absolute 870 589 970 610" class="edt_WF_Essential"/>
        <Static id="st_TELNOUP" text="전화번호" position="absolute 788 586 868 613" class="sta_WFDA_Label01"/>
        <Edit lengthunit="asciii" enable="false" id="edt_CPNOUP" imemode="native" maxlength="20" taborder="76" position="absolute 870 615 970 636" class="edt_WF_Essential"/>
        <Static id="st_CPNOUP" text="휴대폰번호" position="absolute 788 612 868 639" class="sta_WFDA_Label01"/>
        <Edit lengthunit="asciii" enable="false" id="edt_EMAILUP" imemode="english" maxlength="40" taborder="78" position="absolute 870 641 970 662" class="edt_WF_Essential"/>
        <Static id="st_EMAILUP" text="E-Mail" position="absolute 788 638 868 665" class="sta_WFDA_Label01"/>
        <Edit lengthunit="asciii" enable="false" id="edt_DEPTNMUP" imemode="native" maxlength="40" taborder="80" position="absolute 870 667 970 688" class="edt_WF_Essential"/>
        <Static id="st_DEPTNMUP" text="부서" position="absolute 788 664 868 692" class="sta_WFDA_Label01"/>
        <Static id="Static29" text="상위&#10;담당자&#10;정보&#10;&#10;(소팀장&#10;정보)" position="absolute 725 560 789 692" class="sta_WFDA_Label01"/>
        <Static id="st_MEM_SEQ" text="성명" userdata="strMAQueryLocal_MemInfo" position="absolute 364 560 444 587" class="sta_WFDA_Label01"/>
        <Edit enable="false" id="edt_MEM_SEQ" imemode="native" maxlength="30" onkeydown="edt_BILL_TYPE_OnKeyDown" taborder="57" position="absolute 446 563 558 584" class="edt_WF_Essential"/>
        <Button enable="false" id="edtBtn_MEM_SEQ" onclick="edtBtn_BILL_TYPE_OnClick" taborder="83" tabstop="false" position="absolute 557 563 578 584" class="btn_WF_popSearch" text="" image=""/>
        <Edit lengthunit="asciii" enable="false" id="edt_MEM_TEL_NO" imemode="native" maxlength="20" taborder="58" position="absolute 446 589 578 610" class="edt_WF_Essential"/>
        <Static id="st_MEM_TEL_NO" text="전화번호" position="absolute 364 586 444 613" class="sta_WFDA_Label01"/>
        <Edit lengthunit="asciii" enable="false" id="edt_MEM_CP_NO" imemode="native" maxlength="20" taborder="59" position="absolute 446 615 578 636" class="edt_WF_Essential"/>
        <Static id="st_MEM_CP_NO" text="휴대폰번호" position="absolute 364 612 444 639" class="sta_WFDA_Label01"/>
        <Edit lengthunit="asciii" id="edt_MEM_EMAIL" imemode="english" maxlength="40" onkeydown="edt_BILL_DESC_OnKeyDown" taborder="60" position="absolute 446 641 578 662" class="edt_WF_Essential"/>
        <Static id="st_MEM_EMAIL" text="E-Mail" position="absolute 364 638 444 665" class="sta_WFDA_Label01"/>
        <Edit lengthunit="asciii" enable="false" id="edt_MEM_DEPT" imemode="native" maxlength="40" taborder="61" position="absolute 446 667 578 688" class="edt_WF_Essential"/>
        <Static id="st_MEM_DEPT" text="부서" position="absolute 364 664 444 691" class="sta_WFDA_Label01"/>
        <Static id="Static35" text="담당자&#10;정보" position="absolute 300 560 365 691" class="sta_WFDA_Label01"/>
        <Static id="Static36" position="absolute 580 601 726 639" class="sta_WFDA_Label01"/>
        <ImageViewer stretch="fit" id="IMG_PATH" transparenthittest="false" taborder="89" text="이미지가 없습니다." position="absolute 363 482 581 535"/>
        <Button enable="false" id="edtBtn_EMPNO" onclick="edtBtn_BILL_TYPE_OnClick" taborder="90" tabstop="false" position="absolute 948 433 969 454" class="btn_WF_popSearch" text="" image=""/>
        <Static id="str_RCPT_INVO_NUM" text="역발행세금계산서번호" position="absolute 300 430 444 457" class="sta_WFDA_Label01"/>
        <Edit lengthunit="asciii" enable="false" id="edt_RCPT_INVO_NUM" imemode="english" maxlength="24" taborder="53" position="absolute 446 433 578 454"/>
        <Static id="st_TAX_AMEND_CD" text="수정세금계산서구분" position="absolute 300 456 444 483" class="sta_WFDA_Label01"/>
        <Combo displayrowcount="10" enable="false" id="cbo_TAX_AMEND_CD" taborder="54" position="absolute 446 459 578 480"/>
        <Static id="Static10" text="역발행&#10;이미지" position="absolute 300 482 364 535" class="sta_WFDA_Label01"/>
        <Static id="Static6" text="※전화번호, 휴대폰번호&#10;(-제외)" position="absolute 582 603 714 638"/>
        <Button enable="false" id="btn_DetailSmsResend" onclick="btn_DetailResend_OnClick" taborder="149" text="재전송하기" userdata="930" position="absolute 640 668 718 689" class="btn_WF_Custom" image=""/>
        <Static id="Static12" userdata="strMAQueryLocal_MemInfo" position="absolute 580 665 636 692" class="sta_WFDA_Label01"/>
        <Radio columncount="2" id="rd_TAX_IF_GB" index="1" taborder="154" tabstop="false" position="absolute 153 410 388 431" codecolumn="codecolumn" datacolumn="datacolumn">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">일반세금계산서</Col>
              </Row>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">전자세금계산서</Col>
              </Row>
            </Rows>
          </Dataset>
        </Radio>
        <Button enable="false" id="btn_ImgInsert" onclick="btn_ImgInsert_OnClick" taborder="155" text="첨부" position="absolute 581 433 633 454" class="btn_WF_CRUD" image=""/>
        <MPFile id="file_EBill" taborder="159" position="absolute 642 432 666 453"/>
        <MPFileDialog Filter="Xml File(*.xml)|*.xml|" id="fileDialog_EBill" taborder="158" position="absolute 674 432 698 453"/>
        <Static id="Static7" text="☞ (국세청)전송 대상은 세금계산서 발행만 해당합니다.(수정세금계산서/계산서/수정계산서 제외)" position="absolute 704 180 1239 193" anchor="right"/>
        <Button enable="false" id="btn_OriginalTaxBill" onclick="btn_OriginalTaxBill_OnClick" taborder="158" tabstop="false" position="absolute 701 485 722 506" class="btn_WF_popSearch" text="" image=""/>
        <Edit lengthunit="asciii" enable="false" id="edt_OriginalTaxBill" imemode="native" maxlength="40" taborder="159" position="absolute 583 485 702 506"/>
        <Static id="Static13" text="당초세금계산서번호" position="absolute 580 456 726 483" class="sta_WFDA_Label01"/>
        <Static id="Static8" text="공급가" position="absolute 580 508 632 535" class="sta_WFDA_Label01"/>
        <Static id="Static11" text="부가세" position="absolute 580 534 632 561" class="sta_WFDA_Label01"/>
        <MaskEdit enable="false" id="edt_OriginalAmt" mask="###,##0" taborder="163" value="MaskEdit00" position="absolute 634 511 723 532"/>
        <MaskEdit enable="false" id="edt_OriginalVat" mask="###,##0" taborder="164" value="MaskEdit00" position="absolute 634 537 723 558"/>
        <Static id="st_BILL_DESC" text="적요" class="sta_WFDA_Label01" position="absolute 0 138 80 165" userdata=""/>
        <Static id="sta_detail14" class="sta_WFDA_Labelbg" position="absolute 782 86 925 113"/>
        <Static id="sta_detail15" class="sta_WFDA_Labelbg" position="absolute 782 112 925 139"/>
        <Static id="sta_detail16" class="sta_WFDA_Labelbg" position="absolute 782 138 1237 165" anchor="left right"/>
        <Static id="sta_detail11" class="sta_WFDA_Labelbg" position="absolute 567 86 704 113"/>
        <Static id="sta_detail12" class="sta_WFDA_Labelbg" position="absolute 567 112 704 139"/>
        <Static id="sta_detail08" class="sta_WFDA_Labelbg" position="absolute 332 86 489 113"/>
        <Static id="sta_detail07" class="sta_WFDA_Labelbg" position="absolute 79 138 704 165"/>
        <Static id="sta_detail06" class="sta_WFDA_Labelbg" position="absolute 79 112 489 139"/>
        <Static id="sta_detail05" class="sta_WFDA_Labelbg" position="absolute 79 86 254 113"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static14" text="조회월" class="sta_WFSA_label" position="absolute 278 40 368 61"/>
        <Static id="st_BILL_DATE" text="발행일자" class="sta_WFDA_Label01" position="absolute 0 86 80 113" userdata=""/>
        <Static id="st_SUM" text="발행총액" class="sta_WFDA_Label01" position="absolute 488 112 568 139"/>
        <Static id="st_BILL_TYPE" text="발행종류" class="sta_WFDA_Label01" position="absolute 253 86 333 113" userdata="strMAQuery_BILL_TYPE"/>
        <Static id="st_BILL_GUBUN" text="발행구분" class="sta_WFDA_Label01" position="absolute 488 86 568 113" userdata=""/>
        <Static id="st_CUSTCD" text="고객사" class="sta_WFDA_Label01" position="absolute 0 112 80 139" userdata="strMAQuery_UPJANG_CUST"/>
        <Static id="st_BILL_NO" text="발행번호" class="sta_WFDA_Label01" position="absolute 703 138 783 165"/>
        <Static id="st_LINE_ID" text="(-) 발행" class="sta_WFDA_Label01" position="absolute 703 86 783 113"/>
        <Static id="st_AMT" text="공급가" class="sta_WFDA_Label01" position="absolute 703 112 783 139"/>
        <Static id="st_UPJANGQuery" text="업장" class="sta_WFSA_label" position="absolute 16 40 86 61" userdata="strMAQuery_Upjang"/>
        <Edit id="edt_UPJANGQuery" taborder="195" readonly="true" onkeydown="edt_UPJANGQuery_OnKeyDown" ontextchanged="edt_UPJANGQuery_OnChanged" position="absolute 59 40 228 61" class="edt_WF_Essential"/>
        <Button id="edtBtn_UPJANGQuery" taborder="196" tabstop="false" onclick="edtBtn_UPJANGQuery_OnClick" class="btn_WF_popSearchEssential" position="absolute 227 40 248 61"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="197" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 93 40"/>
        <Static id="Static09" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 93 71"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61"/>
        <Static id="Static15" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 248 40 278 61"/>
        <Static id="Static16" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 49 40 59 61"/>
        <Static id="Static17" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 322 40 332 61"/>
        <Static id="Static03" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 429 40 459 61"/>
        <Static id="Static18" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 165 450 178"/>
        <Static id="Static22" text="발행내역" class="sta_WF_Title01" position="absolute 0 178 450 196"/>
        <Static id="Static19" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 191 1170 196"/>
        <MaskEdit id="me_BILL_MONTH" mask="####-##" ontextchanged="me_BILL_MONTH_OnChanged" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" taborder="2" type="string" position="absolute 332 40 410 61" class="msk_WF_EssentialCal"/>
        <Button id="edtBtn_Date" onclick="g_CalButton_OnClick" taborder="16" tabstop="false" userdata="me_BILL_MONTH" position="absolute 409 40 429 61" class="btn_WF_popSearchEssential" text="" image=""/>
        <Button enable="false" id="btn_DetailDisuse" onclick="btn_DetailResend_OnClick" taborder="22" text="서손" userdata="444" position="absolute 690 40 741 61" class="btn_WF_Custom" image=""/>
        <Button id="btn_DetailJanAmt" onclick="btn_DetailJanAmt_OnClick" taborder="21" text="발행대상조회" position="absolute 459 40 546 61" class="btn_WF_Custom" image=""/>
        <CheckBox id="chk_Auto" taborder="19" text="자동저장" position="absolute 855 40 930 61" value="true"/>
        <Static id="Static0" text="[단위:식,원,VAT포함]" position="absolute 1111 40 1246 61" anchor="right"/>
        <Button enable="false" id="btn_DetailDisuseRequest" onclick="btn_DetailResend_OnClick" taborder="148" text="서손요청" userdata="400" position="absolute 637 40 688 61" class="btn_WF_Custom" image=""/>
        <Button enable="false" id="btn_DetailDisuseRequestTurndown" onclick="btn_DetailResend_OnClick" taborder="152" text="반려기각" userdata="250" position="absolute 743 40 794 61" class="btn_WF_Custom" image=""/>
        <Button enable="false" id="btn_DetailResend" onclick="btn_DetailResend_OnClick" taborder="153" text="재발송" userdata="100" position="absolute 584 40 635 61" class="btn_WF_Custom" image=""/>
        <Button enable="false" id="btn_Send" onclick="btn_DetailResend_OnClick" taborder="156" text="전송" userdata="N00" position="absolute 796 40 847 61" class="btn_WF_Custom" image=""/>
        <Button id="btn_Exception" onclick="btn_Exception_OnClick" taborder="165" text="설정" userdata="444" visible="false" position="absolute 547 40 582 61" class="btn_WF_Custom" image=""/>
        <Static id="st_ACCTCD" text="매출구분" class="sta_WFDA_Label01" position="absolute 924 86 1004 113"/>
        <Static id="sta_detail00" class="sta_WFDA_Labelbg" position="absolute 1003 86 1237 113" anchor="left right"/>
        <Static id="st_VAT" text="부가세" class="sta_WFDA_Label01" position="absolute 924 112 1004 139"/>
        <Static id="sta_detail01" class="sta_WFDA_Labelbg" position="absolute 1003 112 1237 139" anchor="left right"/>
        <Edit id="edt_BILL_TYPE" imemode="none" onkeydown="edt_BILL_TYPE_OnKeyDown" readonly="true" taborder="4" position="absolute 335 89 438 110" class="edt_WF_Essential"/>
        <Button id="edtBtn_BILL_TYPE" onclick="edtBtn_BILL_TYPE_OnClick" taborder="17" tabstop="false" position="absolute 437 89 458 110" class="btn_WF_popSearchEssential" text="" image=""/>
        <Button id="edtBtn_BILL_DATE" onclick="g_CalButton_OnClick" taborder="20" tabstop="false" userdata="me_BILL_DATE" position="absolute 159 89 180 110" class="btn_WF_popSearchEssential" text="" image=""/>
        <MaskEdit id="me_BILL_DATE" mask="####-##-##" ontextchanged="me_BILL_DATE_OnChanged" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" taborder="3" type="string" position="absolute 82 89 160 110" class="msk_WF_EssentialCal"/>
        <Combo displayrowcount="10" id="cbo_BILL_GUBUN" taborder="5" position="absolute 570 89 675 110" class="cmb_WF_Essential"/>
        <Div id="div_Exp" taborder="166" text="Div0" visible="false" position="absolute 520 88 640 117" scrollbars="none" style="background:white;">
          <Layouts>
            <Layout>
              <CheckBox id="chkNonMachul" taborder="0" text="미발행매출조회" position="absolute 5 1 120 21" onclick="div_Exp_chkNonMachul_OnClick"/>
            </Layout>
          </Layouts>
        </Div>
        <Combo displayrowcount="10" id="cbo_ACCTCD" taborder="7" position="absolute 1006 89 1115 110" class="cmb_WF_Essential"/>
        <Combo displayrowcount="10" id="cbo_MINUS_YN" taborder="6" value="N" position="absolute 785 89 889 110" codecolumn="codecolumn" datacolumn="datacolumn" class="cmb_WF_Essential">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">Y</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">N</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Edit id="edt_CUSTCD" onkeydown="edt_BILL_TYPE_OnKeyDown" readonly="true" taborder="8" position="absolute 82 115 377 136" class="edt_WF_Essential"/>
        <Button id="edtBtn_CUSTCD" onclick="edtBtn_BILL_TYPE_OnClick" taborder="18" tabstop="false" position="absolute 376 115 397 136" class="btn_WF_popSearchEssential" text="" image=""/>
        <MaskEdit id="me_SUMAMT" mask="###,##0" taborder="9" value="MaskEdit00" position="absolute 570 115 674 136" class="msk_WF_Essential"/>
        <MaskEdit id="me_AMT" mask="###,##0" taborder="10" value="MaskEdit00" position="absolute 785 115 889 136" class="msk_WF_Essential"/>
        <MaskEdit id="me_VAT" mask="###,##0" taborder="10" value="MaskEdit00" position="absolute 1006 115 1114 136" class="msk_WF_Essential"/>
        <Edit lengthunit="asciii" id="edt_BILL_DESC" imemode="native" maxlength="50" onkeydown="edt_BILL_DESC_OnKeyDown" taborder="11" position="absolute 82 141 587 162" class="edt_WF_Essential"/>
        <Edit enable="false" id="edt_BILL_NO" readonly="true" taborder="12" position="absolute 785 141 1079 162"/>
        <Static id="Static01" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 399 450 412"/>
        <Static id="Static20" text="세금계산서 관련정보" class="sta_WF_Title01" position="absolute 0 412 450 430"/>
        <Static id="Static21" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 425 450 430"/>
        <Static id="sta_detail17" class="sta_WFDA_Labelbg" position="absolute 150 482 301 509"/>
        <Static id="sta_detail18" class="sta_WFDA_Labelbg" position="absolute 150 508 301 535"/>
        <Static id="sta_detail19" class="sta_WFDA_Labelbg" position="absolute 150 534 301 561"/>
        <Static id="sta_detail20" class="sta_WFDA_Labelbg" position="absolute 150 560 301 587"/>
        <Static id="sta_detail21" class="sta_WFDA_Labelbg" position="absolute 150 586 301 613"/>
        <Static id="sta_detail22" class="sta_WFDA_Labelbg" position="absolute 150 612 301 639"/>
        <Combo displayrowcount="10" enable="false" id="cbo_NATFORGB" taborder="41" position="absolute 153 485 298 506" class="cmb_WF_Essential"/>
        <MaskEdit enable="false" id="edt_SAUPNO" mask="###-##-#####" taborder="43" type="string" position="absolute 153 511 298 532" class="msk_WF_Essential"/>
        <Edit lengthunit="asciii" enable="false" id="edt_CUSTNM" imemode="native" maxlength="70" taborder="44" position="absolute 153 537 298 558" class="edt_WF_Essential"/>
        <Edit lengthunit="asciii" enable="false" id="edt_DRNAME1" imemode="native" maxlength="30" taborder="47" position="absolute 153 563 298 584" class="edt_WF_Essential"/>
        <Static id="sta_detail23" class="sta_WFDA_Labelbg" position="absolute 150 638 301 665"/>
        <Static id="sta_detail24" class="sta_WFDA_Labelbg" position="absolute 150 664 301 691"/>
        <Edit lengthunit="asciii" enable="false" id="edt_ADDR" imemode="native" maxlength="150" taborder="49" position="absolute 153 589 298 610"/>
        <Edit lengthunit="asciii" enable="false" id="edt_UPTAE" imemode="native" maxlength="40" taborder="50" position="absolute 153 615 298 636"/>
        <Edit lengthunit="asciii" enable="false" id="edt_UPJONG" imemode="native" maxlength="40" taborder="51" position="absolute 153 641 298 662"/>
        <Edit lengthunit="asciii" enable="false" id="edt_PASSPORTNO" imemode="english" maxlength="50" taborder="52" position="absolute 153 667 298 688"/>
        <Static id="Static04" text="[거래처 담당자 정보]" class="sta_WF_Title01" position="absolute 304 541 459 554"/>
        <Static id="Static24" text="업장담당자" class="sta_WF_Title01" position="absolute 583 585 738 598"/>
        <Static id="Static25" text="e-Mail/SMS 재전송" class="sta_WF_Title01" position="absolute 583 648 738 661"/>
        <Static id="Static26" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 71 1252 86" anchor="left bottom"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond"/>
      <Dataset id="ds_MAS_BILL_LINE">
        <ColumnInfo>
          <Column id="BILL_ID" size="256" type="BIGDECIMAL"/>
          <Column id="AMT" size="256" type="BIGDECIMAL"/>
          <Column id="TRX_ID" size="256" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list" onrowposchanged="ds_list_OnRowPosChanged">
        <ColumnInfo>
          <Column id="ACCTCD" size="255" type="STRING"/>
          <Column id="ACCTCDNM" size="255" type="STRING"/>
          <Column id="AMT" size="0" type="BIGDECIMAL"/>
          <Column id="BILL_DATE" size="255" type="STRING"/>
          <Column id="BILL_DESC" size="255" type="STRING"/>
          <Column id="BILL_GUBUN" size="255" type="STRING"/>
          <Column id="BILL_GUBUNNM" size="255" type="STRING"/>
          <Column id="BILL_ID" size="0" type="BIGDECIMAL"/>
          <Column id="BILL_NO" size="255" type="STRING"/>
          <Column id="BILL_TYPE" size="255" type="STRING"/>
          <Column id="BILL_TYPENM" size="255" type="STRING"/>
          <Column id="CANCEL_YN" size="255" type="STRING"/>
          <Column id="CLS_YN" size="255" type="STRING"/>
          <Column id="CUSTCD" size="0" type="BIGDECIMAL"/>
          <Column id="CUSTCDNM" size="255" type="STRING"/>
          <Column id="GADATE" size="255" type="STRING"/>
          <Column id="GALINE" size="0" type="BIGDECIMAL"/>
          <Column id="GAMU" size="255" type="STRING"/>
          <Column id="GANO" size="0" type="BIGDECIMAL"/>
          <Column id="UPJANG" size="0" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="255" type="STRING"/>
          <Column id="VAT" size="0" type="BIGDECIMAL"/>
          <Column id="SUMAMT" size="0" type="BIGDECIMAL"/>
          <Column id="MINUS_YN" size="256" type="STRING"/>
          <Column id="TAXSENDGB" size="256" type="STRING"/>
          <Column id="SMSSENDYN" size="256" type="STRING"/>
          <Column id="NATFORGB" size="256" type="STRING"/>
          <Column id="SAUPNO" size="256" type="STRING"/>
          <Column id="CUSTNM" size="256" type="STRING"/>
          <Column id="DRNAME1" size="256" type="STRING"/>
          <Column id="ADDR" size="256" type="STRING"/>
          <Column id="UPTAE" size="256" type="STRING"/>
          <Column id="UPJONG" size="256" type="STRING"/>
          <Column id="PASSPORTNO" size="256" type="STRING"/>
          <Column id="MEM_TEL_NO" size="256" type="STRING"/>
          <Column id="MEM_CP_NO" size="256" type="STRING"/>
          <Column id="MEM_EMAIL" size="256" type="STRING"/>
          <Column id="MEM_DEPT" size="256" type="STRING"/>
          <Column id="EMPNO" size="256" type="STRING"/>
          <Column id="TELNO" size="256" type="STRING"/>
          <Column id="CPNO" size="256" type="STRING"/>
          <Column id="EMAIL" size="256" type="STRING"/>
          <Column id="DEPTNM" size="256" type="STRING"/>
          <Column id="EMPNOUP" size="256" type="STRING"/>
          <Column id="TELNOUP" size="256" type="STRING"/>
          <Column id="CPNOUP" size="256" type="STRING"/>
          <Column id="EMAILUP" size="256" type="STRING"/>
          <Column id="DEPTNMUP" size="256" type="STRING"/>
          <Column id="MEM_NAME" size="256" type="STRING"/>
          <Column id="MEM_SEQ" size="256" type="STRING"/>
          <Column id="EMPNO_NAME" size="256" type="STRING"/>
          <Column id="EMPNOUP_NAME" size="256" type="STRING"/>
          <Column id="RCPT_INVO_NUM" size="256" type="STRING"/>
          <Column id="TAX_AMEND_CD" size="256" type="STRING"/>
          <Column id="ORG_SAUPNO" size="256" type="STRING"/>
          <Column id="UPJANG_SAUPNO" size="256" type="STRING"/>
          <Column id="UPJANG_VATUPJANGNM" size="256" type="STRING"/>
          <Column id="UPJANG_DRNAME" size="256" type="STRING"/>
          <Column id="UPJANG_ADDR" size="256" type="STRING"/>
          <Column id="UPJANG_UP_TAE" size="256" type="STRING"/>
          <Column id="UPJANG_UP_JONG" size="256" type="STRING"/>
          <Column id="ELC_AGREE_STAT" size="256" type="STRING"/>
          <Column id="TAX_IF_GB" size="256" type="STRING"/>
          <Column id="TAX_APPROVAL_NO" size="256" type="STRING"/>
          <Column id="AMEND_BILL_NO" size="256" type="STRING"/>
          <Column id="ORIGINAL_AMT" size="256" type="STRING"/>
          <Column id="ORIGINAL_VAT" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listInput" cancolumnchange="ds_listInput_CanColumnChange" oncolumnchanged="ds_listInput_OnColumnChanged">
        <ColumnInfo>
          <Column id="ACCTCD" size="255" type="STRING"/>
          <Column id="ACCTCDNM" size="255" type="STRING"/>
          <Column id="AMT" size="0" type="BIGDECIMAL"/>
          <Column id="BILL_DATE" size="255" type="STRING"/>
          <Column id="BILL_DESC" size="255" type="STRING"/>
          <Column id="BILL_GUBUN" size="255" type="STRING"/>
          <Column id="BILL_GUBUNNM" size="255" type="STRING"/>
          <Column id="BILL_ID" size="0" type="BIGDECIMAL"/>
          <Column id="BILL_NO" size="255" type="STRING"/>
          <Column id="BILL_TYPE" size="255" type="STRING"/>
          <Column id="BILL_TYPENM" size="255" type="STRING"/>
          <Column id="CANCEL_YN" size="255" type="STRING"/>
          <Column id="CLS_YN" size="255" type="STRING"/>
          <Column id="CUSTCD" size="0" type="BIGDECIMAL"/>
          <Column id="CUSTCDNM" size="255" type="STRING"/>
          <Column id="GADATE" size="255" type="STRING"/>
          <Column id="GALINE" size="0" type="BIGDECIMAL"/>
          <Column id="GAMU" size="255" type="STRING"/>
          <Column id="GANO" size="0" type="BIGDECIMAL"/>
          <Column id="UPJANG" size="0" type="BIGDECIMAL"/>
          <Column id="UPJANGNM" size="255" type="STRING"/>
          <Column id="VAT" size="0" type="BIGDECIMAL"/>
          <Column id="SUMAMT" size="0" type="BIGDECIMAL"/>
          <Column id="MINUS_YN" size="256" type="STRING"/>
          <Column id="TAXSENDGB" size="256" type="STRING"/>
          <Column id="SMSSENDYN" size="256" type="STRING"/>
          <Column id="NATFORGB" size="256" type="STRING"/>
          <Column id="SAUPNO" size="256" type="STRING"/>
          <Column id="CUSTNM" size="256" type="STRING"/>
          <Column id="DRNAME1" size="256" type="STRING"/>
          <Column id="ADDR" size="256" type="STRING"/>
          <Column id="UPTAE" size="256" type="STRING"/>
          <Column id="UPJONG" size="256" type="STRING"/>
          <Column id="PASSPORTNO" size="256" type="STRING"/>
          <Column id="MEM_TEL_NO" size="256" type="STRING"/>
          <Column id="MEM_CP_NO" size="256" type="STRING"/>
          <Column id="MEM_EMAIL" size="256" type="STRING"/>
          <Column id="MEM_DEPT" size="256" type="STRING"/>
          <Column id="EMPNO" size="256" type="STRING"/>
          <Column id="TELNO" size="256" type="STRING"/>
          <Column id="CPNO" size="256" type="STRING"/>
          <Column id="EMAIL" size="256" type="STRING"/>
          <Column id="DEPTNM" size="256" type="STRING"/>
          <Column id="EMPNOUP" size="256" type="STRING"/>
          <Column id="TELNOUP" size="256" type="STRING"/>
          <Column id="CPNOUP" size="256" type="STRING"/>
          <Column id="EMAILUP" size="256" type="STRING"/>
          <Column id="DEPTNMUP" size="256" type="STRING"/>
          <Column id="MEM_NAME" size="256" type="STRING"/>
          <Column id="MEM_SEQ" size="256" type="STRING"/>
          <Column id="EMPNO_NAME" size="256" type="STRING"/>
          <Column id="EMPNOUP_NAME" size="256" type="STRING"/>
          <Column id="RCPT_INVO_NUM" size="256" type="STRING"/>
          <Column id="TAX_AMEND_CD" size="256" type="STRING"/>
          <Column id="ORG_SAUPNO" size="256" type="STRING"/>
          <Column id="UPJANG_SAUPNO" size="256" type="STRING"/>
          <Column id="UPJANG_VATUPJANGNM" size="256" type="STRING"/>
          <Column id="UPJANG_DRNAME" size="256" type="STRING"/>
          <Column id="UPJANG_ADDR" size="256" type="STRING"/>
          <Column id="UPJANG_UP_TAE" size="256" type="STRING"/>
          <Column id="UPJANG_UP_JONG" size="256" type="STRING"/>
          <Column id="ELC_AGREE_STAT" size="256" type="STRING"/>
          <Column id="TAX_IF_GB" size="256" type="STRING"/>
          <Column id="TAX_APPROVAL_NO" size="256" type="STRING"/>
          <Column id="ORIGINAL_TAX_BILL" size="256" type="STRING"/>
          <Column id="ORIGINAL_AMT" size="256" type="STRING"/>
          <Column id="ORIGINAL_VAT" size="256" type="STRING"/>
          <Column id="ORIGINAL_CUST_CD" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cbo_BILL_GUBUN"/>
      <Dataset id="ds_cbo_ACCTCD"/>
      <Dataset id="DS_Head"/>
      <Dataset id="DS_Body">
        <ColumnInfo>
          <Column id="AMT" size="0" type="BIGDECIMAL"/>
          <Column id="BAL_DATEDD" size="255" type="STRING"/>
          <Column id="BAL_DATEMM" size="255" type="STRING"/>
          <Column id="BAL_DATEYY" size="255" type="STRING"/>
          <Column id="BILL_DESC" size="255" type="STRING"/>
          <Column id="CNT" size="0" type="BIGDECIMAL"/>
          <Column id="CUST_ADDR" size="255" type="STRING"/>
          <Column id="CUST_DRNAME1" size="255" type="STRING"/>
          <Column id="CUST_SAUPNO" size="255" type="STRING"/>
          <Column id="CUST_UP_TAE" size="255" type="STRING"/>
          <Column id="CUSTNM" size="255" type="STRING"/>
          <Column id="GUBUN" size="255" type="STRING"/>
          <Column id="S1" size="0" type="BIGDECIMAL"/>
          <Column id="S10" size="0" type="BIGDECIMAL"/>
          <Column id="S11" size="0" type="BIGDECIMAL"/>
          <Column id="S2" size="0" type="BIGDECIMAL"/>
          <Column id="S3" size="0" type="BIGDECIMAL"/>
          <Column id="S4" size="0" type="BIGDECIMAL"/>
          <Column id="S5" size="0" type="BIGDECIMAL"/>
          <Column id="S6" size="0" type="BIGDECIMAL"/>
          <Column id="S7" size="0" type="BIGDECIMAL"/>
          <Column id="S8" size="0" type="BIGDECIMAL"/>
          <Column id="S9" size="0" type="BIGDECIMAL"/>
          <Column id="T1" size="0" type="BIGDECIMAL"/>
          <Column id="T10" size="0" type="BIGDECIMAL"/>
          <Column id="T2" size="0" type="BIGDECIMAL"/>
          <Column id="T3" size="0" type="BIGDECIMAL"/>
          <Column id="T4" size="0" type="BIGDECIMAL"/>
          <Column id="T5" size="0" type="BIGDECIMAL"/>
          <Column id="T6" size="0" type="BIGDECIMAL"/>
          <Column id="T7" size="0" type="BIGDECIMAL"/>
          <Column id="T8" size="0" type="BIGDECIMAL"/>
          <Column id="T9" size="0" type="BIGDECIMAL"/>
          <Column id="TAXNO1" size="255" type="STRING"/>
          <Column id="TAXNO2" size="255" type="STRING"/>
          <Column id="TOTAL" size="0" type="BIGDECIMAL"/>
          <Column id="UPJANG" size="0" type="BIGDECIMAL"/>
          <Column id="UPJANG_ADDR" size="255" type="STRING"/>
          <Column id="UPJANG_DRNAME" size="255" type="STRING"/>
          <Column id="UPJANG_SAUPNO" size="255" type="STRING"/>
          <Column id="UPJANG_UP_JONG" size="255" type="STRING"/>
          <Column id="UPJANG_UP_TAE" size="255" type="STRING"/>
          <Column id="VAT" size="0" type="BIGDECIMAL"/>
          <Column id="VATUPJANGNM" size="255" type="STRING"/>
          <Column id="TITLE" size="256" type="STRING"/>
          <Column id="COATING1" size="256" type="STRING"/>
          <Column id="COATING2" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cbo_TaxSendGb"/>
      <Dataset id="ds_cbo_NatForGb"/>
      <Dataset id="ds_cbo_TAX_AMEND_CD"/>
      <Dataset id="ds_MAS_IF_SEND_MST_HIS">
        <ColumnInfo>
          <Column id="TAX_ISSUE_DT" size="256" type="STRING"/>
          <Column id="TAX_TYPE" size="256" type="STRING"/>
          <Column id="TAX_CLAS" size="256" type="STRING"/>
          <Column id="TAX_AMEND_CD" size="256" type="STRING"/>
          <Column id="TAX_APAR_GB" size="256" type="STRING"/>
          <Column id="TAX_SEND_GB" size="256" type="STRING"/>
          <Column id="TAX_PURPOSE_CD" size="256" type="STRING"/>
          <Column id="INVOICER_TAXREGIST_CD" size="256" type="STRING"/>
          <Column id="INVOICEE_TAXREGIST_CD" size="256" type="STRING"/>
          <Column id="INVOICER_CMP_ID" size="256" type="STRING"/>
          <Column id="INVOICER_CMP_NAME" size="256" type="STRING"/>
          <Column id="INVOICER_CMP_CEO" size="256" type="STRING"/>
          <Column id="INVOICER_CMP_ADDR" size="256" type="STRING"/>
          <Column id="INVOICER_CMP_TYPE" size="256" type="STRING"/>
          <Column id="INVOICER_CMP_CLAS" size="256" type="STRING"/>
          <Column id="INVOICEE_BUSINESSTYPE_CD" size="256" type="STRING"/>
          <Column id="INVOICEE_CMP_ID" size="256" type="STRING"/>
          <Column id="INVOICEE_CMP_NAME" size="256" type="STRING"/>
          <Column id="INVOICEE_CMP_CEO" size="256" type="STRING"/>
          <Column id="INVOICEE_CMP_ADDR" size="256" type="STRING"/>
          <Column id="INVOICEE_CMP_TYPE" size="256" type="STRING"/>
          <Column id="INVOICEE_CMP_CLAS" size="256" type="STRING"/>
          <Column id="INVOICER_MEM_NAME" size="256" type="STRING"/>
          <Column id="INVOICER_MEM_TEL_NO" size="256" type="STRING"/>
          <Column id="INVOICER_MEM_CP_NO" size="256" type="STRING"/>
          <Column id="INVOICER_MEM_EMAIL" size="256" type="STRING"/>
          <Column id="INVOICER_MEM_DEPT" size="256" type="STRING"/>
          <Column id="INVOICEE_MEM_NAME" size="256" type="STRING"/>
          <Column id="INVOICEE_MEM_TEL_NO" size="256" type="STRING"/>
          <Column id="INVOICEE_MEM_CP_NO" size="256" type="STRING"/>
          <Column id="INVOICEE_MEM_EMAIL" size="256" type="STRING"/>
          <Column id="INVOICEE_MEM_DEPT" size="256" type="STRING"/>
          <Column id="CHARGE_TOT_AMT" size="0" type="BIGDECIMAL"/>
          <Column id="TAX_TOT_AMT" size="0" type="BIGDECIMAL"/>
          <Column id="GRAND_TOT_AMT" size="0" type="BIGDECIMAL"/>
          <Column id="TAX_DESC" size="256" type="STRING"/>
          <Column id="ITEM_PURCHASE_EXPIRY_DT1" size="256" type="STRING"/>
          <Column id="ITEM_NAME1" size="256" type="STRING"/>
          <Column id="ITEM_INFO1" size="256" type="STRING"/>
          <Column id="ITEM_CHARGE_UNIT_QUANTITY1" size="0" type="BIGDECIMAL"/>
          <Column id="ITEM_UNIT_AMT1" size="0" type="BIGDECIMAL"/>
          <Column id="ITEM_INVOICE_AMT1" size="0" type="BIGDECIMAL"/>
          <Column id="ITEM_TOTAL_TAX_AMT1" size="0" type="BIGDECIMAL"/>
          <Column id="ITEM_DESC1" size="256" type="STRING"/>
          <Column id="ITEM_PURCHASE_EXPIRY_DT2" size="256" type="STRING"/>
          <Column id="ITEM_NAME2" size="256" type="STRING"/>
          <Column id="ITEM_INFO2" size="256" type="STRING"/>
          <Column id="ITEM_CHARGE_UNIT_QUANTITY2" size="0" type="BIGDECIMAL"/>
          <Column id="ITEM_UNIT_AMT2" size="0" type="BIGDECIMAL"/>
          <Column id="ITEM_INVOICE_AMT2" size="0" type="BIGDECIMAL"/>
          <Column id="ITEM_TOTAL_TAX_AMT2" size="0" type="BIGDECIMAL"/>
          <Column id="ITEM_DESC2" size="256" type="STRING"/>
          <Column id="ITEM_PURCHASE_EXPIRY_DT3" size="256" type="STRING"/>
          <Column id="ITEM_NAME3" size="256" type="STRING"/>
          <Column id="ITEM_INFO3" size="256" type="STRING"/>
          <Column id="ITEM_CHARGE_UNIT_QUANTITY3" size="0" type="BIGDECIMAL"/>
          <Column id="ITEM_UNIT_AMT3" size="0" type="BIGDECIMAL"/>
          <Column id="ITEM_INVOICE_AMT3" size="0" type="BIGDECIMAL"/>
          <Column id="ITEM_TOTAL_TAX_AMT3" size="0" type="BIGDECIMAL"/>
          <Column id="ITEM_DESC3" size="256" type="STRING"/>
          <Column id="ITEM_PURCHASE_EXPIRY_DT4" size="256" type="STRING"/>
          <Column id="ITEM_NAME4" size="256" type="STRING"/>
          <Column id="ITEM_INFO4" size="256" type="STRING"/>
          <Column id="ITEM_CHARGE_UNIT_QUANTITY4" size="0" type="BIGDECIMAL"/>
          <Column id="ITEM_UNIT_AMT4" size="0" type="BIGDECIMAL"/>
          <Column id="ITEM_INVOICE_AMT4" size="0" type="BIGDECIMAL"/>
          <Column id="ITEM_TOTAL_TAX_AMT4" size="0" type="BIGDECIMAL"/>
          <Column id="ITEM_DESC4" size="256" type="STRING"/>
          <Column id="SMS_SEND_YN" size="256" type="STRING"/>
          <Column id="ADD_DOC_YN" size="256" type="STRING"/>
          <Column id="RCPT_INVO_NUM" size="256" type="STRING"/>
          <Column id="CMP_MEM_SEQ" size="256" type="STRING"/>
          <Column id="USER1_SABUN" size="256" type="STRING"/>
          <Column id="USER2_NAME" size="256" type="STRING"/>
          <Column id="USER2_SABUN" size="256" type="STRING"/>
          <Column id="USER2_PHONE" size="256" type="STRING"/>
          <Column id="USER2_CELLPHONE" size="256" type="STRING"/>
          <Column id="USER2_MAIL" size="256" type="STRING"/>
          <Column id="BILL_ID" size="256" type="BIGDECIMAL"/>
          <Column id="TAX_IF_GB" size="256" type="STRING"/>
          <Column id="AMEND_BILL_NO" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SendElectricCheck">
        <ColumnInfo>
          <Column id="strInParams" size="256" type="STRING"/>
          <Column id="strUserID" size="256" type="STRING"/>
          <Column id="strUserIP" size="256" type="STRING"/>
          <Column id="strHPtr" size="256" type="STRING"/>
          <Column id="lngRtn" size="256" type="STRING"/>
          <Column id="lngCount" size="256" type="STRING"/>
          <Column id="strDesc" size="256" type="STRING"/>
          <Column id="SEND_FLAG" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_EBill">
        <ColumnInfo>
          <Column id="IssueDateTime" size="256" type="STRING"/>
          <Column id="IssueID" size="256" type="STRING"/>
          <Column id="PurposeCode" size="256" type="STRING"/>
          <Column id="InvoicerParty_ID" size="256" type="STRING"/>
          <Column id="InvoiceeParty_ID" size="256" type="STRING"/>
          <Column id="ChargeTotalAmount" size="256" type="BIGDECIMAL"/>
          <Column id="TaxTotalAmount" size="256" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_tmp"/>
      <Dataset id="ds_Exp"/>
    </Objects>
    <Bind>
      <BindItem id="edt_CUSTCD_value" compid="edt_CUSTCD" propid="value" datasetid="ds_listInput" columnid="CUSTCDNM"/>
      <BindItem id="me_SUMAMT_value" compid="me_SUMAMT" propid="value" datasetid="ds_listInput" columnid="SUMAMT"/>
      <BindItem id="me_AMT_value" compid="me_AMT" propid="value" datasetid="ds_listInput" columnid="AMT"/>
      <BindItem id="me_VAT_value" compid="me_VAT" propid="value" datasetid="ds_listInput" columnid="VAT"/>
      <BindItem id="cbo_ACCTCD_value" compid="cbo_ACCTCD" propid="value" datasetid="ds_listInput" columnid="ACCTCD"/>
      <BindItem id="cbo_MINUS_YN_value" compid="cbo_MINUS_YN" propid="value" datasetid="ds_listInput" columnid="MINUS_YN"/>
      <BindItem id="cbo_BILL_GUBUN_value" compid="cbo_BILL_GUBUN" propid="value" datasetid="ds_listInput" columnid="BILL_GUBUN"/>
      <BindItem id="edt_BILL_TYPE_value" compid="edt_BILL_TYPE" propid="value" datasetid="ds_listInput" columnid="BILL_TYPENM"/>
      <BindItem id="me_BILL_DATE_value" compid="me_BILL_DATE" propid="value" datasetid="ds_listInput" columnid="BILL_DATE"/>
      <BindItem id="edt_BILL_DESC_value" compid="edt_BILL_DESC" propid="value" datasetid="ds_listInput" columnid="BILL_DESC"/>
      <BindItem id="edt_BILL_NO_value" compid="edt_BILL_NO" propid="value" datasetid="ds_listInput" columnid="BILL_NO"/>
      <BindItem id="cbo_TAXSENDGB_value" compid="cbo_TAXSENDGB" propid="value" datasetid="ds_listInput" columnid="TAXSENDGB"/>
      <BindItem id="cbo_SMSSENDYN_value" compid="cbo_SMSSENDYN" propid="value" datasetid="ds_listInput" columnid="SMSSENDYN"/>
      <BindItem id="cbo_NATFORGB_value" compid="cbo_NATFORGB" propid="value" datasetid="ds_listInput" columnid="NATFORGB"/>
      <BindItem id="edt_SAUPNO_value" compid="edt_SAUPNO" propid="value" datasetid="ds_listInput" columnid="SAUPNO"/>
      <BindItem id="edt_CUSTNM_value" compid="edt_CUSTNM" propid="value" datasetid="ds_listInput" columnid="CUSTNM"/>
      <BindItem id="edt_DRNAME1_value" compid="edt_DRNAME1" propid="value" datasetid="ds_listInput" columnid="DRNAME1"/>
      <BindItem id="edt_ADDR_value" compid="edt_ADDR" propid="value" datasetid="ds_listInput" columnid="ADDR"/>
      <BindItem id="edt_UPTAE_value" compid="edt_UPTAE" propid="value" datasetid="ds_listInput" columnid="UPTAE"/>
      <BindItem id="edt_UPJONG_value" compid="edt_UPJONG" propid="value" datasetid="ds_listInput" columnid="UPJONG"/>
      <BindItem id="edt_PASSPORTNO_value" compid="edt_PASSPORTNO" propid="value" datasetid="ds_listInput" columnid="PASSPORTNO"/>
      <BindItem id="edt_EMPNO_value" compid="edt_EMPNO" propid="value" datasetid="ds_listInput" columnid="EMPNO_NAME"/>
      <BindItem id="edt_TELNO_value" compid="edt_TELNO" propid="value" datasetid="ds_listInput" columnid="TELNO"/>
      <BindItem id="edt_CPNO_value" compid="edt_CPNO" propid="value" datasetid="ds_listInput" columnid="CPNO"/>
      <BindItem id="edt_EMAIL_value" compid="edt_EMAIL" propid="value" datasetid="ds_listInput" columnid="EMAIL"/>
      <BindItem id="edt_DEPTNM_value" compid="edt_DEPTNM" propid="value" datasetid="ds_listInput" columnid="DEPTNM"/>
      <BindItem id="edt_EMPNOUP_value" compid="edt_EMPNOUP" propid="value" datasetid="ds_listInput" columnid="EMPNOUP_NAME"/>
      <BindItem id="edt_TELNOUP_value" compid="edt_TELNOUP" propid="value" datasetid="ds_listInput" columnid="TELNOUP"/>
      <BindItem id="edt_CPNOUP_value" compid="edt_CPNOUP" propid="value" datasetid="ds_listInput" columnid="CPNOUP"/>
      <BindItem id="edt_EMAILUP_value" compid="edt_EMAILUP" propid="value" datasetid="ds_listInput" columnid="EMAILUP"/>
      <BindItem id="edt_DEPTNMUP_value" compid="edt_DEPTNMUP" propid="value" datasetid="ds_listInput" columnid="DEPTNMUP"/>
      <BindItem id="edt_MEM_SEQ_value" compid="edt_MEM_SEQ" propid="value" datasetid="ds_listInput" columnid="MEM_NAME"/>
      <BindItem id="edt_MEM_TEL_NO_value" compid="edt_MEM_TEL_NO" propid="value" datasetid="ds_listInput" columnid="MEM_TEL_NO"/>
      <BindItem id="edt_MEM_CP_NO_value" compid="edt_MEM_CP_NO" propid="value" datasetid="ds_listInput" columnid="MEM_CP_NO"/>
      <BindItem id="edt_MEM_EMAIL_value" compid="edt_MEM_EMAIL" propid="value" datasetid="ds_listInput" columnid="MEM_EMAIL"/>
      <BindItem id="edt_MEM_DEPT_value" compid="edt_MEM_DEPT" propid="value" datasetid="ds_listInput" columnid="MEM_DEPT"/>
      <BindItem id="edt_RCPT_INVO_NUM_value" compid="edt_RCPT_INVO_NUM" propid="value" datasetid="ds_listInput" columnid="RCPT_INVO_NUM"/>
      <BindItem id="cbo_TAX_AMEND_CD_value" compid="cbo_TAX_AMEND_CD" propid="value" datasetid="ds_listInput" columnid="TAX_AMEND_CD"/>
      <BindItem id="rd_TAX_IF_GB_value" compid="rd_TAX_IF_GB" propid="value" datasetid="ds_listInput" columnid="TAX_IF_GB"/>
      <BindItem id="edt_OriginalTaxBill_value" compid="edt_OriginalTaxBill" propid="value" datasetid="ds_listInput" columnid="ORIGINAL_TAX_BILL"/>
      <BindItem id="edt_OriginalAmt_value" compid="edt_OriginalAmt" propid="value" datasetid="ds_listInput" columnid="ORIGINAL_AMT"/>
      <BindItem id="edt_OriginalVat_value" compid="edt_OriginalVat" propid="value" datasetid="ds_listInput" columnid="ORIGINAL_VAT"/>
      <BindItem id="item19" compid="sta_detail14" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item20" compid="sta_detail15" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item21" compid="sta_detail16" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item16" compid="sta_detail11" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item17" compid="sta_detail12" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item13" compid="sta_detail08" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item12" compid="sta_detail07" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item11" compid="sta_detail06" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item10" compid="sta_detail05" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item0" compid="sta_detail00" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item1" compid="sta_detail01" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item2" compid="sta_detail02" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item3" compid="sta_detail03" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item4" compid="sta_detail04" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item5" compid="sta_detail09" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item6" compid="sta_detail10" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item7" compid="sta_detail13" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item8" compid="sta_detail17" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item9" compid="sta_detail18" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item14" compid="sta_detail19" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item15" compid="sta_detail20" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item18" compid="sta_detail21" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item22" compid="sta_detail22" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item23" compid="sta_detail23" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item24" compid="sta_detail24" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item25" compid="sta_detail25" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item26" compid="sta_detail26" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item27" compid="sta_detail27" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item28" compid="sta_detail28" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item29" compid="sta_detail29" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item30" compid="sta_detail30" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item31" compid="sta_detail31" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item32" compid="sta_detail32" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item33" compid="sta_detail33" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item34" compid="sta_detail34" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item35" compid="sta_detail35" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item36" compid="sta_detail36" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item37" compid="sta_detail37" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item38" compid="sta_detail38" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item39" compid="sta_detail39" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item40" compid="sta_detail40" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item41" compid="sta_detail41" propid="text" datasetid="ds_view" columnid="D_1"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : FS시스템/시스템공통/템플릿 1
 * 프로그램명   : Sam_Form_Basic1.XML
 * 기      능   : 표준 UI Form
 * 작  성  자   : 구종화
 * 작성  일자   : 2007-11-16
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
001 : ERP전송대기
002 : 인증서미제출
003 : 인증서폐지
004 : 인증서만료
005 : 국세청인증서 검증일수 오류
008 : 필수항목 오류
009 : 국세청승인번호 중복 오류
100 : 발행
200 : 반려요청
250 : 반려기각
270 : 반려승인
400 : ERP폐기요청
450 : ERP폐기승인요청
470 : ERP폐기승인
500 : 완료(승인)
700 : ERP폐기대기
N00 : 국세청전송완료

전자세금계산서인 경우만 500에서 국세청 전송
그 외에 일반계산서, 수정세금계산서, 계산서, 수정계산서는 500에서 끝이다.

메일 : <100 발행>, <400 폐기요청>일 경우에만 (PRE 포함) 거래처 담당자에게 날아가고
       <500 완료> 및 모든 상황값에 대해서 발행자에게 메일이 발송됩니다.
       이런 경우에는 발행자가 다시 거래처 담당자에게 메일을 포워딩 해줘야만 한다.
*/
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::ma_common.js"
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var f_Saved_ID,
	f_CurrDate;
	
var f_NewDataCheck;	

var f_ROLE_YN;  
var f_IF_SEMD_MST_CheckDate = "20100101";

var f_clkcnt = 0;
 

//전자세금계산서########################################################################
//var strMAQueryLocal_MemInfo             = "SELECT A.SEQ MEM_SEQ, '거래처명  : '||A.CMP_NAME||' '||'성명      : '||RPAD(A.MEM_NAME, 10, ' ')||' '||'전화번호  : '||RPAD(A.MEM_TEL_NO, 20, ' ')||' '||'휴대폰번호: '||RPAD(A.MEM_CP_NO, 20, ' ')||' '||'E-Mail    : '||RPAD(A.MEM_EMAIL, 40, ' ')||' '||'부서      : '||A.MEM_DEPT CMP_INFO FROM HLDC_IF_CMP_MEM_INFO A WHERE (1 = 1) ";
var strMAQueryLocal_MemInfo
= "SELECT A.MEM_SEQ \n"
+ "     , (SELECT '['||Z.NM_KOR||'] ' FROM HLDC_HR_PERSONAL Z WHERE Z.SABUN = A.UUSER)||A.CMP_INFO AS CMP_INFO \n"
+ "  FROM \n"
+ "( \n"
+ "SELECT /*+ INDEX_DESC(A IF_CMP_MEM_INFO_PK) */ \n"
+ "       A.CMP_ID, A.SEQ MEM_SEQ \n"
+ "     , A.MEM_NAME||'  '||SC_CRYPTO_FUN('DEC',A.MEM_TEL_NO_ENC,4)||'  '||SC_CRYPTO_FUN('DEC',A.MEM_CP_NO_ENC,4)||'  '||SC_CRYPTO_FUN('DEC',A.MEM_EMAIL_ENC,5)||'  '||A.MEM_DEPT AS CMP_INFO \n"
+ "     , NVL(A.UPDT_USER,A.CRAT_USER) AS UUSER \n"
+ "  FROM HLDC_IF_CMP_MEM_INFO A \n"
+ " WHERE A.CRAT_USER = '" + application.g_EmpNo + "' \n"
+ " UNION ALL \n"
+ "SELECT /*+ INDEX_DESC(A IF_CMP_MEM_INFO_PK) */ \n"
+ "       A.CMP_ID, A.SEQ MEM_SEQ \n"
+ "     , A.MEM_NAME||'  '||SC_CRYPTO_FUN('DEC',A.MEM_TEL_NO_ENC,4)||'  '||SC_CRYPTO_FUN('DEC',A.MEM_CP_NO_ENC,4)||'  '||SC_CRYPTO_FUN('DEC',A.MEM_EMAIL_ENC,5)||'  '||A.MEM_DEPT AS CMP_INFO \n"
+ "     , NVL(A.UPDT_USER,A.CRAT_USER) AS UUSER \n"
+ "  FROM HLDC_IF_CMP_MEM_INFO A \n"
+ " WHERE A.CRAT_USER <> '" + application.g_EmpNo + "' \n"
+ ") A \n"
+ " WHERE (1=1)";
var strMAQueryLocal_MemInfoKeyField      = "A.MEM_SEQ";
//var strMAQueryLocal_MemInfoValueField    = "'거래처명  : '||A.CMP_NAME||' '||'성명      : '||RPAD(A.MEM_NAME, 10, ' ')||' '||'전화번호  : '||RPAD(A.MEM_TEL_NO, 20, ' ')||' '||'휴대폰번호: '||RPAD(A.MEM_CP_NO, 20, ' ')||' '||'E-Mail    : '||RPAD(A.MEM_EMAIL, 40, ' ')||' '||'부서      : '||A.MEM_DEPT";
var strMAQueryLocal_MemInfoValueField    = "A.CMP_INFO";
var strMAQueryLocal_MemInfoKeyFieldNM    = "거래처담당자코드";
var strMAQueryLocal_MemInfoValueFieldNM  = "[등록자] 거래처담당자명"; 
var strMAQueryLocal_MemInfoCaption       = "거래처담당자조회";
var strMAQueryLocal_MemInfoAllField      = "MEM_SEQ;CMP_INFO";

//전자세금계산서########################################################################
	
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

    var F_ArrCol          = new Array(-1); 
    var F_ArrColType      = new Array(-1);
	
	// FC기획팀 김성권 매니저 로그인시 설정버튼 보이게 함.
	// 설정버튼 : 세금계산서 발행시 과거매출조회 가능 설정
	//            설정된 업장은 당월포함 과거매출까지 조회
	//            설정 안된 업장은 당월 매출만 조회
	//g_EmpNo = '200010566'; // 임시(서버에 소스 배포시 주석처리)
    if(g_EmpNo == '200010566' || g_AuthLevel == '999'){
		btn_Exception.visible = true;
    }
    
	//init_btn_setup();	// Button 초기화
	fsp_init(this);
	/*
	#############################################################################################################
	공통코드 SETTING
	#############################################################################################################
	*/
		
	//발행구분코드####################################################################################################
	fn_sql_common("C", strMAQuery_BILL_GUBUN,""," ORDER BY SORT_SEQ","",cbo_BILL_GUBUN,-1,ds_cbo_BILL_GUBUN);
	//발행구분코드####################################################################################################
	//매출구분코드####################################################################################################
	//fn_sql_common("C", strMAQuery_BILL_ACCTCD,""," AND (CODE <> '009') ORDER BY SORT_SEQ","",cbo_ACCTCD,-1,ds_cbo_ACCTCD);
	fn_sql_common("C", strMAQuery_BILL_ACCTCD,"","  ORDER BY SORT_SEQ","",cbo_ACCTCD,-1,ds_cbo_ACCTCD);
	//매출구분코드####################################################################################################
	
			
		
			
	//전자세금계산서:발행구분코드####################################################################################
	fn_sql_common("C", "  SELECT SCODE, SNM FROM HLDC_ST_COMMON_ITEM WHERE (LCODE = 'K01')",""," ORDER BY SCODE","",cbo_TAXSENDGB,-1,ds_cbo_TaxSendGb);
	//전자세금계산서:발행구분코드####################################################################################
	//전자세금계산서:구분코드-사업자,내국인,외국인)################################################################
	fn_sql_common("C", "  SELECT SCODE, SNM FROM HLDC_ST_COMMON_ITEM WHERE (LCODE = 'K02')",""," ORDER BY SCODE","",cbo_NATFORGB,-1,ds_cbo_NatForGb);
	//전자세금계산서:구분코드-사업자,내국인,외국인)################################################################
			
	//전자세금계산서:수정세금계산서구분################################################################
	fn_sql_common("C", "  SELECT SCODE, SNM FROM HLDC_ST_COMMON_ITEM WHERE (LCODE = 'K03') AND (USE_YN = 'Y') AND SCODE IN ('02', '04')",""," ORDER BY SCODE","",cbo_TAX_AMEND_CD,-1,ds_cbo_TAX_AMEND_CD);
	//전자세금계산서:수정세금계산서구분################################################################
			
			
	edt_UPJANGQuery.userdata = g_Upjang;
	edt_UPJANGQuery.value     = g_UpjangNm;
			
    f_CurrDate = fn_CurrDateWeek();
	me_BILL_MONTH.value   = gfn_subStr(f_CurrDate, 0, 6);		
	//me_RCP_DATE.Value   = "20070911";		
    fn_insert();
    
    //사업장 권한 셋팅#############################################################################
    f_ROLE_YN = fn_GetLocalUserRole(ds_cond);
    if (f_ROLE_YN == "Y"){
    
    }
    else {  
    	
		fn_SetAuth("","","edt_UPJANGQuery", "edtBtn_UPJANGQuery");
	}
    //사업장 권한 셋팅#############################################################################    
	/*
	#############################################################################################################
	공통코드 SETTING
	#############################################################################################################
	*/
}
function fn_GetLocalUserRole(objOutDs)
{
    
    //잔액체크#####################################################################
    objOutDs.clear();
    objOutDs.addColumn("ROLE_YN","STRING",256);	       
    
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/maa:MAA10010E_S006");
	
	//alert(str_ACCTCD);
	//alert(str_DATE_STD);
	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list",""
	                                                           ,"");	
	http.Sync = false;
	
                          	
	
	//alert(objOutDs.GetColumn(objOutDs.row, "ACCTCD_DATE") );
	return objOutDs.getColumn(objOutDs.rowposition, "ROLE_YN");
	//잔액체크#####################################################################
	
}
//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
function fn_search()
{
	if (!before_SelectCheck())
		return;
	//리스트############################################################
    fsp_clear(this);
    
	fsp_addSearch(this, "ma/mas:MAS10140E_S001");	
	ds_cond.clear();
	ds_cond.addColumn("UPJANG","INT",256);
	ds_cond.addColumn("BILL_DATE","STRING",256);
			
	ds_cond.addRow();
		
	ds_cond.setColumn(ds_cond.rowposition, "UPJANG",    edt_UPJANGQuery.userdata);
	ds_cond.setColumn(ds_cond.rowposition, "BILL_DATE",  me_BILL_MONTH.value);
					
	fn_DataSetAllClear();
    http.Sync = true;
	fsp_callService(this, "", "", "ds_cond=ds_cond","ds_list=ds_list","","fn_SearchDetail()");
	http.Sync = false;	
	//리스트############################################################
}
function fn_insert()
{
	if (!before_SelectCheck()) return;
	
	ds_listInput.clearData();
	ds_MAS_IF_SEND_MST_HIS.clearData();
	ds_EBill.clearData();
	//edtBtn Component 초기화############################
	Set_edtBtn_UserData("Clear");	
	//edtBtn Component 초기화############################
	ds_listInput.addRow();
	ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG", edt_UPJANGQuery.userdata);	  
	ds_listInput.setColumn(ds_listInput.rowposition, "UPJANGNM", edt_UPJANGQuery.value);
		 
	ds_listInput.setColumn(ds_listInput.rowposition, "BILL_TYPE",   "310");	  
	ds_listInput.setColumn(ds_listInput.rowposition, "BILL_TYPENM", "세금계산서");	 
		 
		 
	ds_listInput.setColumn(ds_listInput.rowposition, "BILL_GUBUN", "001");	 
	ds_listInput.setColumn(ds_listInput.rowposition, "MINUS_YN", "N");
	
	
	ds_listInput.setColumn(ds_listInput.rowposition, "ACCTCD", "4010221");	

	
	var e = new EventInfo;
	e.row = 0;
	e.columnid = "BILL_DATE";
	e.oldvalue = "";
	e.newvalue = ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE");
	e.colidx = 0;	 
	ds_listInput_OnColumnChanged(ds_listInput,e);
	
	
	ds_listInput.setColumn(ds_listInput.rowposition, "TAX_IF_GB", "Y");	
	
	//Setds_listInput_OnColumnChanged();
	
	//Disabled항목 Enabled처리####################################
	me_BILL_DATE.enable       = true;
	edtBtn_BILL_DATE.enable   = true;
	
	edt_BILL_TYPE.enable      = true;
	edtBtn_BILL_TYPE.enable   = true;
	
	cbo_BILL_GUBUN.enable     = true;
	cbo_MINUS_YN.enable       = true;
	cbo_ACCTCD.enable         = true;
	
	edt_CUSTCD.enable         = true;
	edtBtn_CUSTCD.enable      = true;
	
	me_SUMAMT.enable          = true;
	me_AMT.enable             = true;
	me_VAT.enable             = true;
	
	edt_BILL_DESC.enable      = true;	
	
	rd_TAX_IF_GB.enable       = true;		
    //Disabled항목 Enabled처리####################################
    btn_ImgInsert.enable = false;
    
	me_BILL_DATE.setFocus();
}
function fn_delete()
{
    if (!before_DeleteCheck("Master") ){
		return;
    }
}
function fn_save()
{
    if (!before_SaveCheck("Master") ){
        if (f_NewDataCheck){
			
			ds_listInput.setColumn(ds_listInput.rowposition, "BILL_ID", "");
        }
		return;
    }
}
function fn_print()
{
	var str_Gubun;
	
		
	if (
	    (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE") == "310") ||
	    (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE") == "350")
	   )
		str_Gubun = "세금계산서_재발행";
	else if (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE") == "410")
		str_Gubun = "계산서_재발행";
				
	if (ds_listInput.getColumn(ds_listInput.rowposition, "TAX_IF_GB") == "Y"){
		
	}
	else {
	
		fn_SetPrint(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"), str_Gubun);
	}
}
function fn_Close()
{
	this.close();
}
function fn_help()
{
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
function fn_SearchDetail(int_TabIndex)
{
	/*
	if (Length(Tab_UPJANG.tab1.st_CC_CD.Value) == 0)
		return;
	//업장정보GET############################################################
    tit_clearActionInfo(this);
	tit_addSearchActionInfo(this, "ma/mas:MAS10020E_S002");
	ds_cond.Clear();
	ds_cond.AddColumn("CC_CD","VARCHAR",256);
	ds_cond.AddRow();
	ds_cond.SetColumn(ds_cond.Row, "CC_CD",  Tab_UPJANG.tab1.st_CC_CD.Value);
	tit_callService(this, "", "", "ds_cond=ds_cond","ds_deptHis=ds_list","","");
	//업장정보GET############################################################
	*/
}
function before_SelectCheck()
{
	if (numFormat(edt_UPJANGQuery.userdata)== "0")
	{
	
		gfn_alert("업장을 지정하여 주십시요.");
		edt_UPJANGQuery.setFocus();
		return false;
	}
	if (gfn_length(me_BILL_MONTH.value)== 0)
	{
	
		gfn_alert("조회월을 지정하여 주십시요.");
		me_BILL_MONTH.setFocus();
		return false;
	}
		
	return true;
}
function before_SaveCheck(str_Gubun)

{

        

		//권한에 따른 저장/삭제 가능체크#########################################################################

		//if (!fn_GetSaveAuthBy_AuthLevel(ds_listInput.GetColumn(ds_listInput.row, "UPJANG"))) return false;

		//권한에 따른 저장/삭제 가능체크#########################################################################

          

        /*

        업무구분별로 addAction 지정세팅##########################################        

        */

        

        f_Saved_ID = 0;

        f_NewDataCheck = false;

        

        //자동비교여부가 'N'일 경우 입금비교 팝업창을 띄운다.

		ds_MAS_BILL_LINE.clearData();

        /*

        업무구분별로 addAction 지정세팅##########################################        

        */

		

		

 		if (ds_listInput.rowcount == 0){

			return;

		}

	    if (str_Gubun == "Master"){

			if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0")

			{

			

				g_Message("EE", "업장을 지정하여 주십시요.");

				edt_UPJANGQuery.setFocus();

				return false;

			}

		

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE"))== 0)

			{

			

				g_Message("EE", "발행일자가 누락되었습니다.");

				me_BILL_DATE.setFocus();

				return false;

			}

			

			if (gfn_subStr(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE"), 0, 6)!= me_BILL_MONTH.value)

			{

			

				g_Message("EE", "조회월과 발행일자가 상이합니다.\n" +

				                "발행일자를 다시 한번 확인하여 주십시요.");

				me_BILL_DATE.setFocus();

				return false;

			}			

	        

	        //입력일때 Confirm체크##################################

	        if ( 

	             (ds_listInput.rowcount > 0) &&

                 (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"))== "0") &&

	             (chk_Auto.value == "0") 

	           )

	        {

				if (!g_Confirm("02")) return false;	             

	        }     

	        //입력일때 Confirm체크##################################

	             

	             

	        //수정일때 Confirm체크##################################

            if (

                 (ds_listInput.rowcount > 0) &&

                 (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"))!= "0")

               )

            {	        

				g_Message("EE", "기존 세금계산서데이터를 수정하려면\n삭제 후 신규 등록해야만 합니다.\n" +

				                "확인하여 주십시요.");                

				return false;   

			}

	        //수정일때 Confirm체크##################################

	        

			//각 구분별 대체 마감체크##############################

            if (

                 (ds_listInput.rowcount > 0) &&

                 (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"))!= "0")

               )

            {			

				if (!fn_GetALT_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"))) return false;

				if (!fn_GetTAX_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE"), ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))) return false;

			}

			//각 구분별 대체 마감체크##############################	        

					        

					        

			//마감체크###############################################

			if (!fn_CheckGAClosing(ds_cond, edt_UPJANGQuery.userdata, me_BILL_DATE.value, "200"))

				return false;                

			//마감체크###############################################

								        

			

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE"))== 0){

				

				g_Message("EE", "발행종류가 누락되었습니다.\n" +

				                "확인하여 주십시요.");

                edt_BILL_TYPE.setFocus();

				return false;                

			}

			

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_GUBUN"))== 0){

				

				g_Message("EE", "발행구분이 누락되었습니다.\n" +

				                "확인하여 주십시요.");

                cbo_BILL_GUBUN.setFocus();

				return false;                

			}

			

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "MINUS_YN"))== 0){

				

				g_Message("EE", "(-) 발행여부가 누락되었습니다.\n" +

				                "확인하여 주십시요.");

                cbo_MINUS_YN.setFocus();

				return false;                

			}	

					

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ACCTCD"))== 0){

				

				g_Message("EE", "매출구분이 누락되었습니다.\n" +

				                "확인하여 주십시요.");

                cbo_ACCTCD.setFocus();

				return false;                

			}	

					

			if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD"))== "0"){

				

				g_Message("EE", "고객사가 누락되었습니다.\n" +

				                "확인하여 주십시요.");

                edt_CUSTCD.setFocus();

				return false;                

			}	

				

				

			//금액체크##################################################################

			if (toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "AMT")) == 0){

			

				g_Message("EE", "공급가가 누락되었습니다.\n" +

								"확인하여 주십시요.");

									

				me_AMT.setFocus();		

							

				return false;  									

			}

			

			if (

			     (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE") == "310") &&

			     (toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "VAT")) == 0)

			    )

			{

			

				g_Message("EE", "부가세가 누락되었습니다.\n" +

								"확인하여 주십시요.");

									

				me_VAT.setFocus();		

							

				return false;  									

			}			

					

							

			if (

			     (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE") != "310") &&

			     (toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "VAT")) != 0)

			    )

			{

			

				g_Message("EE", "해당부가세구분은 부가세가\n발생되지않습니다.\n" +

								"확인하여 주십시요.");

									

				me_VAT.setFocus();		

							

				return false;  									

			}	

										

										

			if (ds_listInput.getColumn(ds_listInput.rowposition, "MINUS_YN") == "N"){

				

				

				if (toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "SUMAMT")) < 0){

				

					g_Message("EE", "-금액을 입력할 수 없습니다.\n" +

									"확인하여 주십시요.");

										

					me_SUMAMT.setFocus();		

								

					return false;  									

				}

				

				if (toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "AMT")) < 0){

				

					g_Message("EE", "-금액을 입력할 수 없습니다.\n" +

									"확인하여 주십시요.");

										

					me_AMT.setFocus();		

								

					return false;  									

				}			

					

				if (toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "VAT")) < 0){

				

					g_Message("EE", "-금액을 입력할 수 없습니다.\n" +

									"확인하여 주십시요.");

										

					me_VAT.setFocus();		

								

					return false;  									

				}						

			}		

			

			if (ds_listInput.getColumn(ds_listInput.rowposition, "MINUS_YN") == "Y"){

				

				

				if (toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "SUMAMT")) > 0){

				

					g_Message("EE", "마이너스 발행은 금액을 마이너스로 등록해야 합니다.\n" +

									"확인하여 주십시요.");

										

					me_SUMAMT.setFocus();		

								

					return false;  									

				}

				

				if (toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "AMT")) > 0){

				

					g_Message("EE", "마이너스 발행은 금액을 마이너스로 등록해야 합니다.\n" +

									"확인하여 주십시요.");

										

					me_AMT.setFocus();		

								

					return false;  									

				}

								

				if (toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "VAT")) > 0){

				

					g_Message("EE", "마이너스 발행은 금액을 마이너스로 등록해야 합니다.\n" +

									"확인하여 주십시요.");

										

					me_VAT.setFocus();		

								

					return false;  									

				}								

			}	



		    //부가세 공급가대비 100차이 체크하기-----------------------------------		    

			if (toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "VAT")) != 0){

		

				if ( Math.abs( (toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "AMT"))/toNumber(10)) - toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "VAT")) ) > 100)

				{

					g_Message("EE", "부가세와 공급가를 확인하시기 바랍니다.\n" +

									"확인하여 주십시요.");

										

					me_VAT.setFocus();		

								

					return false;  					

				}				

			}						

			//부가세 공급가대비 100차이 체크하기-----------------------------------

			

			//금액체크##################################################################				

																							

	

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DESC"))== 0){

				

				//alert(ds_listInput.GetColumn(ds_listInput.row, "TRX_DESC"));

				g_Message("EE", "적요가 누락되었습니다.\n" +

				                "확인하여 주십시요.");

                edt_BILL_DESC.setFocus();

				return false;                

			}			

			

			

			//전자세금계산서: 체크####################################################	

			if (ds_listInput.getColumn(ds_listInput.rowposition, "TAX_IF_GB") == "Y"){

			

			

				if (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE") > fn_CurrDateWeek()){

					

					g_Message("EE", "세금계산서:\n 발행은 현재일자 이후가 될수없습니다.\n" +

									"확인하여 주십시요.");

					

					return false;                

				}

			}

			

			if (

			     (ds_listInput.getColumn(ds_listInput.rowposition, "TAX_IF_GB") == "Y") &&

			     (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE") < f_IF_SEMD_MST_CheckDate)

			   )

			{

			

					g_Message("EE", "세금계산서:\n 전자세금계산서로 발행할 수 없습니다..\n" +

									"확인하여 주십시요.");

					

					return false;                

			}	

					

			//2011.01.01 부터 일반세금계산서 막기#################################################		

			if (

			     (ds_listInput.getColumn(ds_listInput.rowposition, "TAX_IF_GB") == "N") &&

			     (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE") >= '20110101')

			   )

			{

			

					g_Message("EE", "세금계산서:\n 2011년부터 일반세금계산서로 발행할 수 없습니다..\n" +

									"확인하여 주십시요.");

					

					return false;                

			}	

			//2011.01.01 부터 일반세금계산서 막기#################################################					

								

							

							

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TAXSENDGB"))== 0){

				

				g_Message("EE", "세금계산서:\n 발행구분이 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}			

		

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "SMSSENDYN"))== 0){

				

				g_Message("EE", "세금계산서:\n SMS발송여부가 누락되었습니다.\n" +

								"확인하여 주십시요.");

			   

				return false;                

			}					

			

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "NATFORGB"))== 0){

				

				g_Message("EE", "세금계산서:\n 구분(사업자/내국인/외국인)이 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}		

							

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "SAUPNO"))== 0){

				

				g_Message("EE", "세금계산서:\n 사업자번호/주민번호가 누락되었습니다.\n" +

								"확인하여 주십시요.");

			   

				return false;                

			}		

				

			if (

				(ds_listInput.getColumn(ds_listInput.rowposition, "NATFORGB") == "02") &&

				(fnCheckJumin(gfn_subStr(ds_listInput.getColumn(ds_listInput.rowposition, "SAUPNO"), 0, 6), gfn_subStr(ds_listInput.getColumn(ds_listInput.rowposition, "SAUPNO"), 6, 7)) == -1)		

			   )	

			{

				

				g_Message("EE", "세금계산서:\n 주민등록번호 확인 후 다시 입력하세요.\n" +

								"확인하여 주십시요.");

			   

				return false;                

			}		

				

														

														

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "CUSTNM"))== 0){

				

				g_Message("EE", "세금계산서:\n 사업자명이 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}		

												

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "DRNAME1"))== 0){

				

				g_Message("EE", "세금계산서:\n 대표자명이 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}	

				

			//개인이 아닐경우 주소,업태,업종 체크................................

			if (ds_listInput.getColumn(ds_listInput.rowposition, "NATFORGB") != "02"){

																

				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ADDR"))== 0){

					

					g_Message("EE", "세금계산서:\n 주소가 누락되었습니다.\n" +

									"확인하여 주십시요.");

					

					return false;                

				}	

																				

				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "UPTAE"))== 0){

					

					g_Message("EE", "세금계산서:\n 업태가 누락되었습니다.\n" +

									"확인하여 주십시요.");

					

					return false;                

				}	

																							

				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "UPJONG"))== 0){

					

					g_Message("EE", "세금계산서:\n 업종이 누락되었습니다.\n" +

									"확인하여 주십시요.");

					

					return false;                

				}																	

			}

			//개인이 아닐경우 주소,업태,업종 체크................................

			

			//외국인일경우 여권/등록No 체크.......................................

			if (ds_listInput.getColumn(ds_listInput.rowposition, "NATFORGB") == "03"){

																

				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "PASSPORTNO"))== 0){

					

					g_Message("EE", "세금계산서:\n 여권/등록No가 누락되었습니다.\n" +

									"확인하여 주십시요.");

					

					return false;                

				}													

			}

			

			if (ds_listInput.getColumn(ds_listInput.rowposition, "NATFORGB") != "03"){

																

				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "PASSPORTNO"))!= 0){

					

					g_Message("EE", "세금계산서:\n 여권/등록No가 존재할 수 없습니다.\n" +

									"확인하여 주십시요.");

					

					return false;                

				}													

			}			

			//외국인일경우 여권/등록No 체크.......................................

			

				

			

			//역발행일경우 역발행세금계산서번호 체크............................

			if (ds_listInput.getColumn(ds_listInput.rowposition, "TAXSENDGB") == "2"){

																

				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "RCPT_INVO_NUM"))== 0){

					

					g_Message("EE", "세금계산서:\n 역발행세금계산서번호 가 누락되었습니다.\n" +

									"확인하여 주십시요.");

					

					return false;                

				}		

															

				if (

					(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE") >= "20100401") &&

					(ds_listInput.getColumn(ds_listInput.rowposition, "TAX_IF_GB") == "Y")

				   )	

				{	

														

					//첨부파일존재 검증###############################################################

					if (ds_EBill.rowcount == 0)

					{

					

						g_Message("EE", "전자세금계산서 첨부파일이 존재하지 않습니다.\n확인하여 주십시요.");		

						return false;					

					}

					//첨부파일존재 검증###############################################################

									

									

					//발행일자 검증###############################################################

					if (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE") !=  ds_EBill.getColumn(ds_EBill.rowposition, "IssueDateTime"))

					{

					

						g_Message("EE", "전자세금계산서 첨부파일과 발행일자가 상이합니다.\n확인하여 주십시요.");		

						return false;					

					}

					//발행일자 검증###############################################################

				

					//발행번호 검증###############################################################

					if (ds_listInput.getColumn(ds_listInput.rowposition, "RCPT_INVO_NUM") !=  ds_EBill.getColumn(ds_EBill.rowposition, "IssueID"))

					{

					

						g_Message("EE", "전자세금계산서 첨부파일과 역발행세금계산서번호가 상이합니다.\n확인하여 주십시요.");		

						return false;					

					}

					//발행번호 검증###############################################################

					

					

					//고객사 검증###############################################################

					if (ds_listInput.getColumn(ds_listInput.rowposition, "SAUPNO") !=  ds_EBill.getColumn(ds_EBill.rowposition, "InvoiceeParty_ID"))

					{

					

						g_Message("EE", "전자세금계산서 첨부파일과 고객사가 상이합니다.\n확인하여 주십시요.");		

						return false;					

					}

					//고객사 검증###############################################################		

								

					//공급가 검증###############################################################

					if (toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "AMT")) != toNumber(ds_EBill.getColumn(ds_EBill.rowposition, "ChargeTotalAmount")))

					{

					

						g_Message("EE", "전자세금계산서 첨부파일과 공급가가 상이합니다.\n확인하여 주십시요.");		

						return false;					

					}

					//공급가 검증###############################################################			

											

					//부가세 검증###############################################################

					if (toNumber(ds_listInput.getColumn(ds_listInput.rowposition, "VAT")) != toNumber(ds_EBill.getColumn(ds_EBill.rowposition, "TaxTotalAmount")))

					{

					

						g_Message("EE", "전자세금계산서 첨부파일과 부가세가 상이합니다.\n확인하여 주십시요.");		

						return false;					

					}

					//부가세 검증###############################################################												

																									

				}										

			}

			

			if (ds_listInput.getColumn(ds_listInput.rowposition, "TAXSENDGB") == "1"){

																

				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "RCPT_INVO_NUM"))!= 0){

					

					g_Message("EE", "세금계산서:\n 역발행세금계산서번호 가 존재할 수 없습니다.\n" +

									"확인하여 주십시요.");

					

					return false;                

				}													

			}			

			//역발행일경우 역발행세금계산서번호 체크............................

			

			

						

			//마이너스 세금계산서의 경우 수정세금계산서구분 체크...............

			if (ds_listInput.getColumn(ds_listInput.rowposition, "MINUS_YN") == "Y"){
				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TAX_AMEND_CD"))== 0){
					g_Message("EE", "세금계산서:\n 수정세금계산서구분이 누락되었습니다.\n" +
									"확인하여 주십시요.");
					return false;                
				}	
			}

			if (ds_listInput.getColumn(ds_listInput.rowposition, "MINUS_YN") != "Y"){
				if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TAX_AMEND_CD"))!= 0){
					g_Message("EE", "세금계산서:\n 수정세금계산서구분이 존재할 수 없습니다.\n" +
									"확인하여 주십시요.");
					return false;                
				}													
			}		
				
			//------------------------------------------------------------------------
			// 2013-12-30 김장욱 추가시작
			// 국세청 세금계산서 로직변경(수정계산서 발행시 원세금계산서번호 첨부)으로 
			// 소스수정함.
			//------------------------------------------------------------------------
			// [(-)발행]이 'Y'이고 순발행이며 기존세금계산서번호가 있는지 체크 
			if (ds_listInput.getColumn(ds_listInput.rowposition, "MINUS_YN") == "Y"){
				if(gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TAXSENDGB"))== "1"){ // 순발행
					if(gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ORIGINAL_TAX_BILL"))== 0){
						g_Message("EE", "세금계산서:\n 당초세금계산서번호가 누락되었습니다.\n" +
										"확인하여 주십시요.");
						return false; 
					}
					
					// 수정세금계산서구분이 [계약의해제(04)]일 경우는 공급가와 부가세가 같아야 한다.
					if(ds_listInput.getColumn(ds_listInput.rowposition, "TAX_AMEND_CD") == "04"){	// 계약의 해제
						//alert(abs(parseFloat(ds_listInput.GetColumn(ds_listInput.row, "AMT"))));
						//alert(abs(parseFloat(ds_listInput.GetColumn(ds_listInput.row, "ORIGINAL_AMT"))));
						// 당초세금계산서와 현발행세금계산서의 공급가 같은지 확인 
						if(Math.abs(parseFloat(ds_listInput.getColumn(ds_listInput.rowposition, "AMT"))) != Math.abs(parseFloat(ds_listInput.getColumn(ds_listInput.rowposition, "ORIGINAL_AMT")))){
							g_Message("EE", "세금계산서:\n 수정세금계산서 구분이 [계약의 해제]인 경우 당초세금계산서의 공급가와 현재세금계산서의 공급가가 같아야 합니다.\n" +
											"확인하여 주십시요.");
							return false; 
						}
						
						//alert(abs(parseFloat(ds_listInput.GetColumn(ds_listInput.row, "VAT"))));
						//alert(abs(parseFloat(ds_listInput.GetColumn(ds_listInput.row, "ORIGINAL_VAT"))));
						// 당초세금계산서와 현발행세금계산서의 부가세 금액이 같은지 확인 
						if(Math.abs(parseFloat(ds_listInput.getColumn(ds_listInput.rowposition, "VAT"))) != Math.abs(parseFloat(ds_listInput.getColumn(ds_listInput.rowposition, "ORIGINAL_VAT")))){
							g_Message("EE", "세금계산서:\n 수정세금계산서 구분이 [계약의 해제]인 경우 당초세금계산서의 부가세와 현재세금계산서의 부가세가 같아야 합니다.\n" +
											"확인하여 주십시요.");
							return false; 
						}
					}
					
					// 수정세금계산서구분이 [공급가액변동(02]일 경우는 공급가와 부가세가 같으면 안된다. 
					// => 이 경우는 [계약의해제(04)]로 해야 한다.
					if(ds_listInput.getColumn(ds_listInput.rowposition, "TAX_AMEND_CD") == "02"){	// 공급가액변동
						//alert(abs(parseFloat(ds_listInput.GetColumn(ds_listInput.row, "AMT"))));
						//alert(abs(parseFloat(ds_listInput.GetColumn(ds_listInput.row, "ORIGINAL_AMT"))));
						// 당초세금계산서와 현발행세금계산서의 공급가 같은지 확인 
						if(Math.abs(parseFloat(ds_listInput.getColumn(ds_listInput.rowposition, "AMT"))) == Math.abs(parseFloat(ds_listInput.getColumn(ds_listInput.rowposition, "ORIGINAL_AMT")))){
							g_Message("EE", "세금계산서:\n 수정세금계산서 구분이 [공급가액 변동]인 경우 당초세금계산서의 공급가와 현재세금계산서의 공급가가 달라야 합니다.\n" +
											"확인하여 주십시요.");
							return false; 
						}
						
						//alert(abs(parseFloat(ds_listInput.GetColumn(ds_listInput.row, "VAT"))));
						//alert(abs(parseFloat(ds_listInput.GetColumn(ds_listInput.row, "ORIGINAL_VAT"))));
						// 당초세금계산서와 현발행세금계산서의 부가세 금액이 같은지 확인 
						if(Math.abs(parseFloat(ds_listInput.getColumn(ds_listInput.rowposition, "VAT"))) == Math.abs(parseFloat(ds_listInput.getColumn(ds_listInput.rowposition, "ORIGINAL_VAT")))){
							g_Message("EE", "세금계산서:\n 수정세금계산서 구분이 [공급가액 변동]인 경우 당초세금계산서의 부가세와 현재세금계산서의 부가세가 달라야 합니다.\n" +
											"확인하여 주십시요.");
							return false; 
						}
					}
					
					//alert(ds_listInput.GetColumn(ds_listInput.row, "ORIGINAL_CUST_CD"));
					//alert(ds_listInput.GetColumn(ds_listInput.row, "CUSTCD"));
					if(ds_listInput.getColumn(ds_listInput.rowposition, "ORIGINAL_CUST_CD") != ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD")){
							g_Message("EE", "세금계산서:\n 당초세금계산서의 고객사와 수정세금계산서의 고객사가 다릅니다.\n" +
											"확인하여 주십시요.");
							return false; 					
					}
				}			
			}
			
			
			//return false;
			//------------------------------------------------------------------------
			// 2013-12-30 김장욱 추가종료
			//------------------------------------------------------------------------

			//마이너스 세금계산서의 경우 수정세금계산서구분 체크...............

				

						

			//거래처 담당자 정보 체크..............................................

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "MEM_NAME"))== 0){

				

				g_Message("EE", "세금계산서:\n 거래처담당자정보 - 성명 이 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}	

									

									

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "MEM_TEL_NO"))== 0){

				

				g_Message("EE", "세금계산서:\n 거래처담당자정보 - 전화번호 가 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}	

												

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "MEM_CP_NO"))== 0){

				

				g_Message("EE", "세금계산서:\n 거래처담당자정보 - 휴대폰번호 가 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}												

				

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "MEM_EMAIL"))== 0){

				

				g_Message("EE", "세금계산서:\n 거래처담당자정보 - E-Mail 이 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}						

            /*

			if (user_IsEmail(ds_listInput.GetColumn(ds_listInput.row, "MEM_EMAIL")) == "N"){

				

				g_Message("EE", "세금계산서:\n 거래처담당자정보 - E-Mail 확인 후 다시 입력하세요.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}

			*/

				

				

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "MEM_DEPT"))== 0){

				

				g_Message("EE", "세금계산서:\n 거래처담당자정보 - 부서 가 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}	

			//거래처 담당자 정보 체크..............................................	

										

										

			//업장 담당자 정보 체크................................................

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "EMPNO"))== 0){

				

				g_Message("EE", "세금계산서:\n 업장담당자정보 - 사번 이 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}	

						

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "EMPNO_NAME"))== 0){

				

				g_Message("EE", "세금계산서:\n 업장담당자정보 - 성명 이 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}	

									

									

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TELNO"))== 0){

				

				g_Message("EE", "세금계산서:\n 업장담당자정보 - 전화번호 가 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}	

												

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "CPNO"))== 0){

				

				g_Message("EE", "세금계산서:\n 업장담당자정보 - 휴대폰번호 가 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}												

				

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "EMAIL"))== 0){

				

				g_Message("EE", "세금계산서:\n 업장담당자정보 - E-Mail 이 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}	

								

            /*

			if (user_IsEmail(ds_listInput.GetColumn(ds_listInput.row, "EMAIL")) == "N"){

				

				g_Message("EE", "세금계산서:\n 업장담당자정보 - E-Mail 확인 후 다시 입력하세요.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}

			*/

				

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "DEPTNM"))== 0){

				

				g_Message("EE", "세금계산서:\n 업장담당자정보 - 부서 가 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}	

			//업장 담당자 정보 체크................................................		

										

										

			//업장 상위담당자 정보 체크...........................................

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "EMPNOUP"))== 0){

				

				g_Message("EE", "세금계산서:\n 상위담당자정보 - 사번 이 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}	

						

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "EMPNOUP_NAME"))== 0){

				

				g_Message("EE", "세금계산서:\n 상위담당자정보 - 성명 이 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}	

									

									

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TELNOUP"))== 0){

				

				g_Message("EE", "세금계산서:\n 상위담당자정보 - 전화번호 가 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}	

												

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "CPNOUP"))== 0){

				

				g_Message("EE", "세금계산서:\n 상위담당자정보 - 휴대폰번호 가 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}												

				

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "EMAILUP"))== 0){

				

				g_Message("EE", "세금계산서:\n 상위담당자정보 - E-Mail 이 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}						

			/*	

			if (user_IsEmail(ds_listInput.GetColumn(ds_listInput.row, "EMAILUP")) == "N"){

				

				g_Message("EE", "세금계산서:\n 상위담당자정보 - E-Mail 확인 후 다시 입력하세요.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}

			*/		

								

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "DEPTNMUP"))== 0){

				

				g_Message("EE", "세금계산서:\n 상위담당자정보 - 부서 가 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}	

			//업장 상위담당자 정보 체크...........................................

			

			

			//일반세금계산서/전자세금계산서 여부 체크...........................

			if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "TAX_IF_GB"))== 0){

				

				g_Message("EE", "세금계산서:\n 일반세금계산서/전자세금계산서 여부가 누락되었습니다.\n" +

								"확인하여 주십시요.");

				

				return false;                

			}	

			//일반세금계산서/전자세금계산서 여부 체크...........................

										

			//전자세금계산서: 체크####################################################	

						

						

		

		

			

		    // 매출액 비교 작업 시작 ###################################################

		    var real_BillAmt = ds_listInput.getColumn(ds_listInput.rowposition, "AMT") + ds_listInput.getColumn(ds_listInput.rowposition, "VAT");

		    var real_JANAMT = 0;

			var real_ExcAmt = 0;

		    

			if (ds_listInput.getColumn(ds_listInput.rowposition, "MINUS_YN") == "N"){

				

	            real_JANAMT = fn_GetBalance(ds_cond, 	                                        

											ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"), 

											ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"), 

											ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE"), 											

											ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE"), 

											">", 

											"", 

											"", 

											"", 											

											ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD"), 

											"");

											

				

				//alert(real_TrxAmt);

				//alert(real_JANAMT);

				

				real_ExcAmt = real_BillAmt - real_JANAMT;

				if (real_ExcAmt > 0)

				{

		

					g_Message("EE", "발행액이 미발행 매출액을 초과했습니다.\n" +

									"확인하여 주십시요.");

					me_AMT.setFocus();

					return false;     

				}


			}

			else if (ds_listInput.getColumn(ds_listInput.rowposition, "MINUS_YN") == "Y"){

				

				

	            real_JANAMT = fn_GetBalance(ds_cond, 	                                        

											ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"), 

											ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"), 

											ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE"), 											

											ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE"), 

											"<", 

											"", 

											"", 

											"", 											

											ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD"), 

											"");

											

				

				//alert(real_TrxAmt);

				//alert(real_JANAMT);

				

				real_ExcAmt = real_BillAmt - real_JANAMT;

				if (real_ExcAmt < 0)

				{

		

					g_Message("EE", "발행액이 미발행 마이너스 매출액을 초과했습니다.\n" +

									"확인하여 주십시요.");

					me_AMT.setFocus();

					return false;     

				}

			}

			

		    // 발행할 매출액 비교 작업 시작 ###################################################						

			if(!fn_OpenLineWindow(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"), real_BillAmt, ds_listInput.getColumn(ds_listInput.rowposition, "MINUS_YN"))) return false;

			// 발행할 매출액 비교 작업 시작 ###################################################

													

			

			// 매출액 비교 작업 시작 ###################################################					

			

			//BILL_ID 지정################################################################

            if (!fn_SaveTrxData(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"))) return false;

            

            

		    

		    

		    

		    //전자세금계산서:  MAS_IF_SEND_MST_HIS 매핑시작 ###################################

		    if (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE") >= f_IF_SEMD_MST_CheckDate){

		    

				if(!fn_SetMAS_IF_SEND_MST_HIS(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"))) return false;

			}

			//전자세금계산서:  MAS_IF_SEND_MST_HIS 매핑시작 ###################################            

		}			

        

		//저장#############################################################

	    if (str_Gubun == "Master"){

			

			var real_BillAmt = ds_listInput.getColumn(ds_listInput.rowposition, "AMT") + ds_listInput.getColumn(ds_listInput.rowposition, "VAT");

			//각 구분별 대체 마감체크##############################저장전 중복확인

            if (

                 (ds_listInput.rowcount > 0) &&

                 (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"))!= "0")

               )

            {			

				if (!fn_GetALT_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"))) return false;

				if (!fn_GetTAX_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE"), ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))) return false;

			}

			//각 구분별 대체 마감체크##############################저장전 중복확인	        

					        

					        

			//마감체크###############################################저장전 중복확인

			if (!fn_CheckGAClosing(ds_cond, edt_UPJANGQuery.userdata, me_BILL_DATE.value, "200"))

				return false;                

			//마감체크###############################################저장전 중복확인

			

			

			

			//대체잔액체크##########################################저장전 중복확인

			if (!fn_GetBalanceLine(ds_cond, ds_MAS_BILL_LINE, "세금계산서잔액체크"))

				return false;                

			//대체잔액체크##########################################저장전 중복확인

			

	

		

			// action 정보 초기화

			fsp_clear(this);	  		

										    		        

	    

            //기존 라인 및 발행 데이터 삭제.          

            if (

                 (ds_listInput.rowcount > 0) &&

                 (numFormat(f_Saved_ID)!= "0")

               )

            {

            

				fsp_addSingle(this, "ma/mas:MAS10140E_D002"); // MAS_BILL_LINE 삭제

				fsp_addSingle(this, "ma/mas:MAS10140E_D001");	// MAS_BILL 삭제

            } 

       

            

            

            //발행 저장

            if (real_BillAmt != 0){

            				

				fsp_addSingle(this, "ma/mas:MAS10140E_I001");	// MAS_BILL 저장

            }                  		

			

            //매출비교 팝업창을 띄운다.

            if (ds_MAS_BILL_LINE.rowcount > 0){

            

				fsp_addMulti(this, "ma/mas:MAS10140E_I002");	// MAS_BILL_LINE 저장

            }

            

            //전자세금계산서:   MAS_IF_SEND_MST_HIS 라인저장

			if (ds_MAS_IF_SEND_MST_HIS.rowcount > 0){

							  

					fsp_addSingle(this, "ma/mas:MAS10140E_I003");	// MAS_IF_SEND_MST_HIS 저장

			}      

                       

			

			f_Saved_ID = ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID");

			

			http.Sync = true;

			//http.Compress = true;

			//http.CompressMethod = "ZLIB";

		

			fsp_callService(this, "", "", "ds_cond=ds_listInput:A ds_MAS_BILL_LINE=ds_MAS_BILL_LINE:A ds_MAS_IF_SEND_MST_HIS=ds_MAS_IF_SEND_MST_HIS:A", "",  "", "fn_AfterSaveSearch()");



			//http.Compress = false;

			//http.CompressMethod = "";

			http.Sync = false;

	    }

	   

	    

		return true;

}
function fn_AfterSaveSearch(errCode, errMsg)
{
	if (errCode != 0){
		
		g_Message("EE", errMsg);		
		return;
	}
	
	var str_Gubun;
	
	if (
	    (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE") == "310") ||
	    (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE") == "350")
	   ) 
		str_Gubun = "세금계산서";
	else if (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE") == "410")
		str_Gubun = "계산서";
		
	if (ds_listInput.getColumn(ds_listInput.rowposition, "TAX_IF_GB") == "Y"){	
	
	}
	else {
		fn_SetPrint(f_Saved_ID, str_Gubun);
	}
    
	fn_search();	
	fn_insert();
		
	http.Sync = true;
	if (chk_Auto.value == "0") ds_list.rowposition = ds_list.findRowExpr("BILL_ID==" + f_Saved_ID);
	http.Sync = false;
	
}
function fn_SetPrint(real_BILL_ID, str_GUBUN)
{
		
	var str_CANCEL_YN;
	
	// 출력할 데이터가 있는지 확인
	if (numFormat(real_BILL_ID)== "0")
	{
		gfn_alert("출력할 데이터가 없습니다.");
		return;
	}
	
	str_CANCEL_YN = ds_listInput.getColumn(ds_listInput.findRowExpr("BILL_ID==" + real_BILL_ID), "CANCEL_YN");
	if (str_CANCEL_YN == "Y")
	{
		gfn_alert("서손된 세금계산서는 출력 할 수 없습니다.");
		return;
	}
	
    
    var strParam;
    
	strParam = "IFIS/oz.asp?title=세금계산서/계산서";		// Page Title
	
	if (str_GUBUN == "세금계산서")
		strParam += "&url=IFIS/MAS10140E_세금계산서.ozr";	// OZ Report File Name
	else if (str_GUBUN == "계산서")
		strParam += "&url=IFIS/MAS10140E_계산서.ozr";	// OZ Report File Name
	else if (str_GUBUN == "세금계산서_재발행")
		strParam += "&url=IFIS/MAS10140E_세금계산서_재발행.ozr";	// OZ Report File Name
	else if (str_GUBUN == "계산서_재발행")
		strParam += "&url=IFIS/MAS10140E_계산서_재발행.ozr";	// OZ Report File Name
	
    
    //테스트후 삭제필요
//    strParam = "IFIS/oz.asp?title=세금계산서/계산서";			
//	strParam += "&url=IFIS/MAS10140E_세금계산서TEST.ozr";	
    //테스트후 삭제필요	
	
	// 개인정보 마스킹 처리로 소스 수정 20140327 김장욱 
	/*
	if (str_GUBUN == "세금계산서"){
		strParam += "&cnt=2";					// Parameters Count
		strParam += "&p1=" + real_BILL_ID;		// 코드	
		strParam += "&p2=" + g_empno;   		// 조회자 사번
	}else if (str_GUBUN == "계산서"){
		strParam += "&cnt=1";					// Parameters Count
		strParam += "&p1=" + real_BILL_ID;		// 코드	
	}else if (str_GUBUN == "세금계산서_재발행"){
		strParam += "&cnt=2";					// Parameters Count
		strParam += "&p1=" + real_BILL_ID;		// 코드	
		strParam += "&p2=" + g_empno;   		// 조회자 사번
	}else if (str_GUBUN == "계산서_재발행"){
		strParam += "&cnt=1";					// Parameters Count
		strParam += "&p1=" + real_BILL_ID;		// 코드	
	}
	*/
	
	strParam += "&cnt=1";									// Parameters Count
	strParam += "&p1=" + real_BILL_ID;	// 코드	
	strParam += "&zoom=150";						// 화면 출력 크기
	
	var sParam = {fstrParamstrParam};
	gfn_dialog("", "U_SCC::SCCOZREPORT1.xfdl", sParam);	
}
/*
 ******************************************************************************************
 * 함  수  명   : Common_Btn_common_OnClick
 * 입      력   : obj  = Form Component
 * 반      환   : 없음
 * 기      능   : 
 * 작  성  자   : 구종화
 * 작성  일자   : 2007-11-16
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
function Common_Btn_common_OnClick(obj)
{
	switch(obj.name)
	{
		case "btn_search":
		    //alert("d");
			fn_search();
			break;
		case "btn_ins":
			fn_insert();
			break;
		case "btn_del":
			fn_delete();
			break;
		case "btn_save":
			fn_save();
			break;
		case "btn_Print":
			//fn_Print();
			break;
		case "btn_close":
			fn_Close();
			break;
		case "btn_Help":
			//fn_Help();
			break;
		default:
			break;
	}
}
function WorkForm_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
{
	
	gfn_formKeyDown(obj, e); //(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam);
}
function edt_UPJANGQuery_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	fn_edt_OnKeyDown(obj,e.keycode);	
			
	if (e.keycode == 46){
			
		if (obj.name == "edt_UPJANGQuery"){
				
			fn_DataSetAllClear();				
		}		
	}
}
function fn_DataSetAllClear()
{
	ds_list.clearData();	
	ds_listInput.clearData();			
	ds_MAS_IF_SEND_MST_HIS.clearData();
	ds_EBill.clearData();

	//매출비교 팝업창을 띄운다.
	ds_MAS_BILL_LINE.clearData();			
}	
function edtBtn_UPJANGQuery_OnClick(obj:Button, e:ClickEventInfo)
{
    
	fn_edtBtn_OnClick(obj);
	fn_DataSetAllClear();		
}
function grid_List_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	
	
	if (obj.getCellProperty("head",e.cell,"backgroundimage") == "ico_Excel"){
		gfn_exportExcel(obj, this.titletext);
	}
	else {
	
		gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);	
		var e1 = new EventInfo;
		e1.oldrow = -1;
		e1.newrow = 0;
		ds_list_OnRowPosChanged(obj,e1);	
	}
	//obj.ExportExcel(this.Title, , False);	
}
function edtBtn_BILL_TYPE_OnClick(obj:Button, e:ClickEventInfo)
{   

    if (
        (numFormat(edt_UPJANGQuery.userdata)== "0") 
       ) 
    return;
    
    var str_Where = "";
    
         
    //고객사코드####################################################################################
    if (obj.name == "edtBtn_CUSTCD"){	
		
		str_Where += " AND  (A.UPJANG = " + edt_UPJANGQuery.userdata + ") AND USE_YN = 'Y' ";			
    }        
           
    //전자세금계산서:거래처담당자코드####################################################################################
    if (obj.name == "edtBtn_MEM_SEQ"){	
		str_Where += "   AND A.CMP_ID = '" + edt_SAUPNO.value + "' \n";
		str_Where += "   AND ROWNUM <= 10 \n  ";
    } 
                      
                             
    //전자세금계산서:담당자코드####################################################################################
    if (obj.name == "edtBtn_EMPNO"){	
		
		str_Where += " AND  (V.PER_DTD IS NULL)";			
    } 
    //전자세금계산서:상위담당자코드####################################################################################
    if (obj.name == "edtBtn_EMPNOUP"){	
		
		str_Where += " AND  (V.PER_DTD IS NULL) AND (V.SABUN <> '" + ds_listInput.getColumn(ds_listInput.rowposition, "EMPNO") + "')";			
    } 
                    
                    
	fn_edtBtn_OnClick(obj, str_Where);
    if (gfn_length(eval("edt_" + gfn_subStr(obj.name, 7)).userdata)!= 0){
    
		ds_listInput.setColumn(ds_listInput.rowposition, gfn_subStr(obj.name, 7), eval("edt_" + gfn_subStr(obj.name, 7)).userdata);	
	
	
		//전자세금계산서:거래처정보####################################################################################
		if (obj.name == "edtBtn_CUSTCD"){	
			
			ds_cond.clear();
			ds_cond.addColumn("CUSTCD","INT",256);
			ds_cond.addColumn("UPJANG","INT",256);
			ds_cond.addColumn("BILL_DATE","STRING",256);
			
			ds_cond.addRow();
			
			ds_cond.setColumn(ds_cond.rowposition, "CUSTCD",    ds_listInput.getColumn(ds_listInput.rowposition, "CUSTCD"));
			ds_cond.setColumn(ds_cond.rowposition, "UPJANG",    ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"));
			ds_cond.setColumn(ds_cond.rowposition, "BILL_DATE", ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE"));
		
/*
			// action 정보 초기화
			tit_clearActionInfo(this);
			// 서버에서 조회할 정보 추가
			tit_addSearchActionInfo(this, "ma/mas:MAS10140E_S006");
			// 서버 호출
			http.Sync = True;
			////http.XmlFormat = true;
			//tit_callService(this, "", "", "ds_cond=ds_cond", ds_cond.id + "=ds_list","","");
			tit_callService(this, "", "", "ds_cond=ds_cond", "ds_cond=ds_list","","");
			http.Sync = False;
			////http.XmlFormat = false;
*/
	// 조회
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "MAS10140E_T001";
	strURL   = "U_svc::" + "ma/mas/MAS10140E_T001.jsp";
	// 데이터셋 설정
	strInDatasets  = "ds_cond=ds_cond";
	strOutDatasets = "ds_cond=ds_list";
	// 파라메터 설정
	strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
	// 콜백함수 지정
	strCallbackFunc = "";//fn_CallBack_Search
	// 서버 호출 
	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);

			//ds_listInput.SetColumn(ds_listInput.row, "MEM_SEQ", ds_cond.GetColumn(ds_cond.row, "MEM_SEQ"));
			ds_listInput.setColumn(ds_listInput.rowposition, "CUSTNM", ds_cond.getColumn(ds_cond.rowposition, "CUSTNM"));
			ds_listInput.setColumn(ds_listInput.rowposition, "SAUPNO", ds_cond.getColumn(ds_cond.rowposition, "SAUPNO"));			
			ds_listInput.setColumn(ds_listInput.rowposition, "ORG_SAUPNO", ds_cond.getColumn(ds_cond.rowposition, "ORG_SAUPNO"));
			ds_listInput.setColumn(ds_listInput.rowposition, "TAXSENDGB", ds_cond.getColumn(ds_cond.rowposition, "TAXSENDGB"));
			ds_listInput.setColumn(ds_listInput.rowposition, "SMSSENDYN", ds_cond.getColumn(ds_cond.rowposition, "SMSSENDYN"));			
			ds_listInput.setColumn(ds_listInput.rowposition, "NATFORGB", ds_cond.getColumn(ds_cond.rowposition, "NATFORGB"));
			ds_listInput.setColumn(ds_listInput.rowposition, "DRNAME1", ds_cond.getColumn(ds_cond.rowposition, "DRNAME1"));
			ds_listInput.setColumn(ds_listInput.rowposition, "ADDR", ds_cond.getColumn(ds_cond.rowposition, "ADDR"));
			ds_listInput.setColumn(ds_listInput.rowposition, "UPTAE", ds_cond.getColumn(ds_cond.rowposition, "UPTAE"));
			ds_listInput.setColumn(ds_listInput.rowposition, "UPJONG", ds_cond.getColumn(ds_cond.rowposition, "UPJONG"));
			ds_listInput.setColumn(ds_listInput.rowposition, "EMPNO", ds_cond.getColumn(ds_cond.rowposition, "EMPNO"));
			ds_listInput.setColumn(ds_listInput.rowposition, "EMPNO_NAME", ds_cond.getColumn(ds_cond.rowposition, "EMPNO_NAME"));
			ds_listInput.setColumn(ds_listInput.rowposition, "TELNO", ds_cond.getColumn(ds_cond.rowposition, "TELNO"));
			ds_listInput.setColumn(ds_listInput.rowposition, "CPNO", ds_cond.getColumn(ds_cond.rowposition, "CPNO"));
			ds_listInput.setColumn(ds_listInput.rowposition, "EMAIL", ds_cond.getColumn(ds_cond.rowposition, "EMAIL"));
			ds_listInput.setColumn(ds_listInput.rowposition, "DEPTNM", ds_cond.getColumn(ds_cond.rowposition, "DEPTNM"));
			ds_listInput.setColumn(ds_listInput.rowposition, "EMPNOUP", ds_cond.getColumn(ds_cond.rowposition, "EMPNOUP"));
			ds_listInput.setColumn(ds_listInput.rowposition, "EMPNOUP_NAME", ds_cond.getColumn(ds_cond.rowposition, "EMPNOUP_NAME"));
			ds_listInput.setColumn(ds_listInput.rowposition, "TELNOUP", ds_cond.getColumn(ds_cond.rowposition, "TELNOUP"));
			ds_listInput.setColumn(ds_listInput.rowposition, "CPNOUP", ds_cond.getColumn(ds_cond.rowposition, "CPNOUP"));
			ds_listInput.setColumn(ds_listInput.rowposition, "EMAILUP", ds_cond.getColumn(ds_cond.rowposition, "EMAILUP"));
			ds_listInput.setColumn(ds_listInput.rowposition, "DEPTNMUP", ds_cond.getColumn(ds_cond.rowposition, "DEPTNMUP"));
			
			ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG_SAUPNO", ds_cond.getColumn(ds_cond.rowposition, "UPJANG_SAUPNO"));
			ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG_VATUPJANGNM", ds_cond.getColumn(ds_cond.rowposition, "UPJANG_VATUPJANGNM"));
			ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG_DRNAME", ds_cond.getColumn(ds_cond.rowposition, "UPJANG_DRNAME"));
			ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG_ADDR", ds_cond.getColumn(ds_cond.rowposition, "UPJANG_ADDR"));
			ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG_UP_TAE", ds_cond.getColumn(ds_cond.rowposition, "UPJANG_UP_TAE"));
			ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG_UP_JONG", ds_cond.getColumn(ds_cond.rowposition, "UPJANG_UP_JONG"));		
			
			ds_listInput.setColumn(ds_listInput.rowposition, "TAX_IF_GB", "Y");		
			cbo_SMSSENDYN.enable = false;
			
			//===============================================
			// 2013-12-30 김장욱 수정 시작
			// 국세청 수정세금계산서 로직변경으로 추가
			// (-)발행이 Y이면 당초세금계산서 버튼 해지
			//===============================================
			if(ds_listInput.getColumn(ds_listInput.rowposition, "MINUS_YN") == "N"){
				btn_OriginalTaxBill.enable = false;
			}
			//===============================================
			// 2013-12-30 김장욱 수정 종료
			//===============================================
			
			//전자세금계산서:Enabled처리#################################
			cbo_TAXSENDGB.enable      = true;
			cbo_SMSSENDYN.enable      = true;
			cbo_NATFORGB.enable       = true;
			//edt_SAUPNO.Enable         = True;
			edt_CUSTNM.enable      	  = true;
			edt_DRNAME1.enable        = true;
			edt_ADDR.enable      	  = true;
			edt_UPTAE.enable      	  = true;
			edt_UPJONG.enable      	  = true;
			//edt_PASSPORTNO.Enable     = True;
			//edt_RCPT_INVO_NUM.Enable  = True;
			//cbo_TAX_AMEND_CD.Enable   = True;
			edt_MEM_SEQ.enable        = true;
			edtBtn_MEM_SEQ.enable     = true;
			edt_MEM_TEL_NO.enable     = true;
			edt_MEM_CP_NO.enable      = true;
			//메일재전송(930)기능 추가로 일단 무조건 수정가능하게
			//edt_MEM_EMAIL.Enable      = True;
			edt_MEM_DEPT.enable       = true;
		
			edt_EMPNO.enable      	  =	true;
			edtBtn_EMPNO.enable       = true;
			edt_TELNO.enable      	  = true;
			edt_CPNO.enable      	  = true;
			edt_EMAIL.enable      	  = true;
			//edt_DEPTNM.Enable      	  = True;
			edt_EMPNOUP.enable        = true;
			edtBtn_EMPNOUP.enable     = true;
			edt_TELNOUP.enable        = true;
			edt_CPNOUP.enable      	  = true;
			edt_EMAILUP.enable        = true;
			//edt_DEPTNMUP.Enable       = True;
			//전자세금계산서:Enabled처리#################################   			
					
			if (ds_cond.getColumn(ds_cond.rowposition, "ORG_SAUPNO") == "9999999999") 	       
			{	 	
				
 				
				cbo_NATFORGB.enable = true;		
		
				edt_SAUPNO.enable  	= true;	
				edt_SAUPNO.mask     = "######-#######";			
					
				edt_CUSTNM.enable  	= true;	
					
				edt_ADDR.enable    = false;
				edt_UPTAE.enable   = false;
				edt_UPJONG.enable  = false;						
					
			}	
			else {	 	
				
 	 						
				cbo_NATFORGB.enable = false;
		
				edt_SAUPNO.enable  	= false;		
				edt_SAUPNO.mask     = "###-##-#####";
				edt_CUSTNM.enable  	= false;					
				
				edt_ADDR.enable    = true;
				edt_UPTAE.enable   = true;
				edt_UPJONG.enable  = true;						
				
			}			
			
		}  
			
			
		//전자세금계산서:거래처담당자정보####################################################################################
		if (obj.name == "edtBtn_MEM_SEQ"){	
			
			ds_cond.clear();
			ds_cond.addColumn("SAUPNO","STRING",256);
			ds_cond.addColumn("SEQ","STRING",256);
			
			ds_cond.addRow();
			
			ds_cond.setColumn(ds_cond.rowposition, "SAUPNO",    edt_SAUPNO.value);
			ds_cond.setColumn(ds_cond.rowposition, "SEQ",       edt_MEM_SEQ.userdata);
						
			// action 정보 초기화
			fsp_clear(this);
	
			// 서버에서 조회할 정보 추가
			fsp_addSearch(this, "ma/mas:MAS10140E_S004");
	
			// 서버 호출
			http.Sync = true;
			fsp_callService(this, "", "", "ds_cond=ds_cond", ds_cond.name + "=ds_list","","");
			http.Sync = false;
			//ds_listInput.SetColumn(ds_listInput.row, "MEM_SEQ", ds_cond.GetColumn(ds_cond.row, "MEM_SEQ"));
			ds_listInput.setColumn(ds_listInput.rowposition, "MEM_NAME", ds_cond.getColumn(ds_cond.rowposition, "MEM_NAME"));
			ds_listInput.setColumn(ds_listInput.rowposition, "MEM_TEL_NO", ds_cond.getColumn(ds_cond.rowposition, "MEM_TEL_NO"));
			ds_listInput.setColumn(ds_listInput.rowposition, "MEM_CP_NO", ds_cond.getColumn(ds_cond.rowposition, "MEM_CP_NO"));
			ds_listInput.setColumn(ds_listInput.rowposition, "MEM_EMAIL", ds_cond.getColumn(ds_cond.rowposition, "MEM_EMAIL"));
			ds_listInput.setColumn(ds_listInput.rowposition, "MEM_DEPT", ds_cond.getColumn(ds_cond.rowposition, "MEM_DEPT"));
		}  
	
		//전자세금계산서:담당자정보####################################################################################
		if (obj.name == "edtBtn_EMPNO"){	
			
			ds_cond.clear();
			ds_cond.addColumn("SABUN","STRING",256);
			
			//===========================================================================================
			// 2013-12-09 김장욱 수정 시작
			//===========================================================================================
			// 담당자 정보 조회시 사무실전화번호를 HR_PERSONAL.COMM_TEL1_ENC에서 조회하게 되어 있었는데
			// 이 컬럼은 집전화번호이고 따로 HR_PERSONAL에서 업장번호를 관리하지 않아 사업장 전화번호로 바꿈.
			ds_cond.addColumn("UPJANG","STRING",256);
			//===========================================================================================
			// 2013-12-09 김장욱 수정 끝
			//===========================================================================================
			
			ds_cond.addRow();
			
			ds_cond.setColumn(ds_cond.rowposition, "SABUN",    edt_EMPNO.userdata);
			
			//===========================================================================================
			// 2013-12-09 김장욱 수정 시작
			//===========================================================================================
			// 담당자 정보 조회시 사무실전화번호를 HR_PERSONAL.COMM_TEL1_ENC에서 조회하게 되어 있었는데
			// 이 컬럼은 집전화번호이고 따로 HR_PERSONAL에서 업장번호를 관리하지 않아 사업장 전화번호로 바꿈.
			ds_cond.setColumn(ds_cond.rowposition, "UPJANG",    edt_UPJANGQuery.userdata);
			//===========================================================================================
			// 2013-12-09 김장욱 수정 끝
			//===========================================================================================
						
			// action 정보 초기화
			fsp_clear(this);
	
			// 서버에서 조회할 정보 추가
			fsp_addSearch(this, "ma/mas:MAS10140E_S005");
	
			// 서버 호출
			http.Sync = true;
			fsp_callService(this, "", "", "ds_cond=ds_cond", ds_cond.name + "=ds_list","","");
			http.Sync = false;
			//ds_listInput.SetColumn(ds_listInput.row, "MEM_SEQ", ds_cond.GetColumn(ds_cond.row, "MEM_SEQ"));
			ds_listInput.setColumn(ds_listInput.rowposition, "EMPNO_NAME", ds_cond.getColumn(ds_cond.rowposition, "NM_KOR"));
			ds_listInput.setColumn(ds_listInput.rowposition, "TELNO", ds_cond.getColumn(ds_cond.rowposition, "COMM_TEL1"));
			ds_listInput.setColumn(ds_listInput.rowposition, "CPNO", ds_cond.getColumn(ds_cond.rowposition, "COMM_TEL3"));
			ds_listInput.setColumn(ds_listInput.rowposition, "EMAIL", ds_cond.getColumn(ds_cond.rowposition, "COMM_EMAIL"));
			ds_listInput.setColumn(ds_listInput.rowposition, "DEPTNM", ds_cond.getColumn(ds_cond.rowposition, "DEPT_NM"));
		}  
		
		//전자세금계산서:상위담당자정보####################################################################################
		if (obj.name == "edtBtn_EMPNOUP"){	
			
			ds_cond.clear();
			ds_cond.addColumn("SABUN","STRING",256);
			
			ds_cond.addRow();
			
			ds_cond.setColumn(ds_cond.rowposition, "SABUN",    edt_EMPNOUP.userdata);
						
			// action 정보 초기화
			fsp_clear(this);
	
			// 서버에서 조회할 정보 추가
			fsp_addSearch(this, "ma/mas:MAS10140E_S005");
	
			// 서버 호출
			http.Sync = true;
			fsp_callService(this, "", "", "ds_cond=ds_cond", ds_cond.name + "=ds_list","","");
			http.Sync = false;
			//ds_listInput.SetColumn(ds_listInput.row, "MEM_SEQ", ds_cond.GetColumn(ds_cond.row, "MEM_SEQ"));
			ds_listInput.setColumn(ds_listInput.rowposition, "EMPNOUP_NAME", ds_cond.getColumn(ds_cond.rowposition, "NM_KOR"));
			ds_listInput.setColumn(ds_listInput.rowposition, "TELNOUP", ds_cond.getColumn(ds_cond.rowposition, "COMM_TEL1"));
			ds_listInput.setColumn(ds_listInput.rowposition, "CPNOUP", ds_cond.getColumn(ds_cond.rowposition, "COMM_TEL3"));
			ds_listInput.setColumn(ds_listInput.rowposition, "EMAILUP", ds_cond.getColumn(ds_cond.rowposition, "COMM_EMAIL"));
			ds_listInput.setColumn(ds_listInput.rowposition, "DEPTNMUP", ds_cond.getColumn(ds_cond.rowposition, "DEPT_NM"));
		} 				   	
	}		    		
}
function edt_BILL_TYPE_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	fn_edt_OnKeyDown(obj,e.keycode);		
	
	if (e.keycode == 46)
	ds_listInput.setColumn(ds_listInput.rowposition, gfn_subStr(obj.name, 4), "");	
	
	if (
		(e.keycode == 46) && (obj.name == "edt_EMPNO")
	   )
	{
		
		ds_listInput.setColumn(ds_listInput.rowposition, "TELNO", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "CPNO",  "");
		ds_listInput.setColumn(ds_listInput.rowposition, "EMAIL", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "DEPTNM","");		
	}
	
	if (
		(e.keycode == 46) && (obj.name == "edt_EMPNOUP")
		)
	{
		
		ds_listInput.setColumn(ds_listInput.rowposition, "TELNOUP", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "CPNOUP",  "");
		ds_listInput.setColumn(ds_listInput.rowposition, "EMAILUP", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "DEPTNMUP","");	
	}
	
}
function ds_list_OnRowPosChanged(obj,e1)
{
    if (ds_list.rowcount == 0) return;
    
	ds_listInput.clearData();
	ds_MAS_IF_SEND_MST_HIS.clearData();
	ds_EBill.clearData();

	
	var row = ds_listInput.addRow();
	ds_listInput.copyRow(row, ds_list, e1.newrow);
	ds_listInput.applyChange();
	//edtBtn Component 복사############################
	Set_edtBtn_UserData("Clear");
	Set_edtBtn_UserData("Copy");
	
	ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG", edt_UPJANGQuery.userdata);	   
	ds_listInput.setColumn(ds_listInput.rowposition, "UPJANGNM", edt_UPJANGQuery.value);
	//edtBtn Component 복사############################
	
	
	Setds_listInput_OnColumnChanged();
	//edt_TYPE_CD.Enable        = False;
	//edt_TYPE_NAME.SetFocus();
	
	btn_ImgInsert.enable = false;
}
//edtBtn Component 세팅/초기화####################################################################
function Set_edtBtn_UserData(str_Gubun)
{
	if (str_Gubun == "Copy"){
		//edtBtn Component 초기화############################  		 
		for (i=0;i<components.length;i++){
							
			if (
				(gfn_subStr(components[i].name, 0, 3)== "st_") &&
				(gfn_subStr(components[i].userdata, 0, 10)== "strMAQuery")
			   )	
			{
			    if (gfn_length(eval("edt_" + gfn_subStr(components[i].name, 3)).Column)!= 0)
				eval("edt_" + gfn_subStr(components[i].name, 3)).userdata = ds_listInput.getColumn(ds_listInput.rowposition, gfn_subStr(components[i].name, 3));
			}
		}		 
		//edtBtn Component 초기화############################
	}
	else if (str_Gubun == "Clear"){
		//edtBtn Component 초기화############################
		for (i=0;i<components.length;i++){
				
				
			if (
				(gfn_subStr(components[i].name, 0, 3)== "st_") &&
				(gfn_subStr(components[i].userdata, 0, 10)== "strMAQuery")
			   )	
			{
				if (gfn_length(components[i].Column)!= 0)
				eval("edt_" + gfn_subStr(components[i].name, 3)).userdata = "";
			}
		}  
		//edtBtn Component 초기화############################
	}
}
function Setds_listInput_OnColumnChanged()
{
	var e = new EventInfo;
	e.row = 0;
	e.columnid = "BILL_DATE";
	e.oldvalue = "";
	e.newvalue = ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE");
	e.colidx = 0;
	ds_listInput_OnColumnChanged(ds_listInput,e);	
	/*
	ds_listInput_OnColumnChanged(ds_listInput,0,"BIZ_CHK_YN","",ds_listInput.GetColumn(ds_listInput.row, "BIZ_CHK_YN"),0);
	ds_listInput_OnColumnChanged(ds_listInput,0,"FEE_REG_YN","",ds_listInput.GetColumn(ds_listInput.row, "FEE_REG_YN"),0);
	ds_listInput_OnColumnChanged(ds_listInput,0,"ADITEM1_CHK_YN","",ds_listInput.GetColumn(ds_listInput.row, "ADITEM1_CHK_YN"),0);
	ds_listInput_OnColumnChanged(ds_listInput,0,"ADITEM2_CHK_YN","",ds_listInput.GetColumn(ds_listInput.row, "ADITEM2_CHK_YN"),0);
	*/
}
function ds_listInput_OnColumnChanged(obj:Dataset, e)
{
	var F_ArrCol          = new Array(-1);
	var F_ArrColType      = new Array(-1);
	
	if (e.columnid == "BILL_DATE"){
	
						
	    if (e.colidx == -1){
	        
	        /*
			ds_listInput.SetColumn(ds_listInput.row, "SUBINV_CODE", "");
			ds_listInput.SetColumn(ds_listInput.row, "SUBINV_CODENM", "");
			ds_listInput.SetColumn(ds_listInput.row, "CUSTCD", "");
			ds_listInput.SetColumn(ds_listInput.row, "CUSTCDNM", "");			
			ds_listInput.SetColumn(ds_listInput.row, "AMT", "");
			ds_listInput.SetColumn(ds_listInput.row, "QTY", "");
			ds_listInput.SetColumn(ds_listInput.row, "PRICE", "");
			ds_listInput.SetColumn(ds_listInput.row, "FEE", "");
			ds_listInput.SetColumn(ds_listInput.row, "ACNTCD", "");
			ds_listInput.SetColumn(ds_listInput.row, "RCP_DESC", "");
			ds_listInput.SetColumn(ds_listInput.row, "ADITEM1", "");
			ds_listInput.SetColumn(ds_listInput.row, "ADITEM1NM", "");
			ds_listInput.SetColumn(ds_listInput.row, "TICKET_SEQ", "");	
			*/													
		}
					
	}
	
	if (e.columnid == "BILL_TYPE"){
	    
	    if (e.newvalue == "310"){
	 
			me_VAT.enable  = true;
		}
		else {
			me_VAT.enable  = false;
		}			
	}
	if (e.columnid == "SUMAMT"){
	    
	    if (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE") == "310"){	 	
	 
			ds_listInput.setColumn(ds_listInput.rowposition, "AMT", Math.round(ds_listInput.getColumn(ds_listInput.rowposition, "SUMAMT") / 1.1));
			ds_listInput.setColumn(ds_listInput.rowposition, "VAT", ds_listInput.getColumn(ds_listInput.rowposition, "SUMAMT") - Math.round(ds_listInput.getColumn(ds_listInput.rowposition, "SUMAMT") / 1.1));
		}
		else {
			ds_listInput.setColumn(ds_listInput.rowposition, "AMT", ds_listInput.getColumn(ds_listInput.rowposition, "SUMAMT"));
			ds_listInput.setColumn(ds_listInput.rowposition, "VAT", 0);
		}			
	}			
	
	
	if (e.columnid == "AMT"){
	    
	    if (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE") == "310"){	 	
	 			
			ds_listInput.setColumn(ds_listInput.rowposition, "VAT", ds_listInput.getColumn(ds_listInput.rowposition, "SUMAMT") - ds_listInput.getColumn(ds_listInput.rowposition, "AMT"));
		}	
	}	
		
	if (e.columnid == "VAT"){
	    
	    if (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE") == "310"){	 	
	 			
			ds_listInput.setColumn(ds_listInput.rowposition, "AMT", ds_listInput.getColumn(ds_listInput.rowposition, "SUMAMT") - ds_listInput.getColumn(ds_listInput.rowposition, "VAT"));
		}	
	}	
	
	
	//전자세금계산서:관련사항조정###############################################################################	
	if (e.columnid == "TAX_IF_GB"){
	    
	    
	    //역발행세금계산서번호 필드 통제
	    if (e.newvalue == "Y"){	 	
	 			
				ds_listInput.setColumn(ds_listInput.rowposition, "SMSSENDYN", "Y");	 						
				cbo_SMSSENDYN.enable = true;
		}
		else if (e.newvalue == "N"){	 	
	 		
			ds_listInput.setColumn(ds_listInput.rowposition, "SMSSENDYN", "N");	 						
			cbo_SMSSENDYN.enable = false;
		}			
	}
		
	// 발행구분
	if (e.columnid == "TAXSENDGB"){
	    btn_ImgInsert.enable = false;
	    //역발행세금계산서번호 필드 통제
	    if (e.newvalue == "1"){ //순발행	 	
			ds_listInput.setColumn(ds_listInput.rowposition, "RCPT_INVO_NUM", "");
			if (ds_listInput.getColumn(ds_listInput.rowposition, "TAX_IF_GB") == "Y"){	
				ds_listInput.setColumn(ds_listInput.rowposition, "SMSSENDYN", "Y");	 						
				cbo_SMSSENDYN.enable = true;
			}
			edt_RCPT_INVO_NUM.enable = false;
			
			//======================================================================
			// 2013-12-30 김장욱 추가 시작
			// 수정세금계산서에 역발행일 경우 기존세금계산서 번호는 필요하지 않다.
			//======================================================================
			btn_OriginalTaxBill.enable = true;
			
			//======================================================================
			// 2013-12-30 김장욱 추가 종료
			//======================================================================
		}
		else if (e.newvalue == "2"){	 // 역발행	
			ds_listInput.setColumn(ds_listInput.rowposition, "SMSSENDYN", "N");	 						
			cbo_SMSSENDYN.enable = false;
			edt_RCPT_INVO_NUM.enable = true;
			btn_ImgInsert.enable = true;
			
			//======================================================================
			// 2013-12-30 김장욱 추가 시작
			// 수정세금계산서에 역발행일 경우 기존세금계산서 번호는 필요하지 않다.
			//======================================================================
			edt_OriginalTaxBill.value = "";	// 당초세금계산서번호
			edt_OriginalAmt.value = "";		// 당초공급가액
			edt_OriginalVat.value = "";		// 당초부가세액
			btn_OriginalTaxBill.enable = false;
			
			//======================================================================
			// 2013-12-30 김장욱 추가 종료
			//======================================================================
		}			
	}		
	
	if (e.columnid == "NATFORGB"){
	    
	    
	    //외국인일 경우 필드 통제
	    if (e.newvalue == "03"){	 	
	 			
			ds_listInput.setColumn(ds_listInput.rowposition, "SAUPNO", "9999999999999");
			edt_SAUPNO.enable     = false;								
			edt_PASSPORTNO.enable = true;	
			
			edt_ADDR.enable    = true;
			edt_UPTAE.enable   = true;
			edt_UPJONG.enable  = true;					
					
			st_SAUPNO.text      = "외국인";		
		}
		else if (e.newvalue == "02"){	 	
	 			
			ds_listInput.setColumn(ds_listInput.rowposition, "SAUPNO", "");
			ds_listInput.setColumn(ds_listInput.rowposition, "PASSPORTNO", "");				
			
			edt_SAUPNO.enable     = true;								
			edt_PASSPORTNO.enable = false;
			
			ds_listInput.setColumn(ds_listInput.rowposition, "ADDR", "");	
			ds_listInput.setColumn(ds_listInput.rowposition, "UPTAE", "");	
			ds_listInput.setColumn(ds_listInput.rowposition, "UPJONG", "");	
			
			edt_ADDR.enable    = false;
			edt_UPTAE.enable   = false;
			edt_UPJONG.enable  = false;			
						
			st_SAUPNO.text      = "주민번호";						
		}
		else if (e.newvalue == "01"){	
		
			ds_listInput.setColumn(ds_listInput.rowposition, "PASSPORTNO", "");	
            edt_SAUPNO.enable     = false;								
			edt_PASSPORTNO.enable = false;			
			
			edt_ADDR.enable    = true;
			edt_UPTAE.enable   = true;
			edt_UPJONG.enable  = true;	
						
			st_SAUPNO.text      = "사업자번호";			
		}			
	}			
	
	if (e.columnid == "MINUS_YN"){
	    
	    if (e.newvalue == "N"){	 	
	 			
			ds_listInput.setColumn(ds_listInput.rowposition, "TAX_AMEND_CD", "");
			cbo_TAX_AMEND_CD.enable = false;
						
			//=============================================================
			// 2013-12-30 김장욱 추가시작
			// 국세청 세금계산서 변경에 따른 소스 수정
			//=============================================================
			btn_OriginalTaxBill.enable = false;	
			edt_OriginalTaxBill.value = ""; 		// 초기화
			edt_OriginalAmt.value = ""; 		// 초기화
			edt_OriginalVat.value = ""; 		// 초기화
			//=============================================================
			// 2013-12-30 김장욱 추가종료
			//=============================================================
		}	
		else {	 	
	 		
	 		ds_listInput.setColumn(ds_listInput.rowposition, "TAX_AMEND_CD", "02");				
			cbo_TAX_AMEND_CD.enable = true;
			
			//=============================================================
			// 2013-12-30 김장욱 추가시작
			// 국세청 세금계산서 변경에 따른 소스 수정
			//=============================================================
			btn_OriginalTaxBill.enable = true;
			//=============================================================
			// 2013-12-30 김장욱 추가종료
			//=============================================================
		}			
	}		
		
	if (e.columnid == "CUSTCD"){
		
		ds_listInput.setColumn(ds_listInput.rowposition, "TAXSENDGB", "");		 
		ds_listInput.setColumn(ds_listInput.rowposition, "SMSSENDYN", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "NATFORGB", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "SAUPNO", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "CUSTNM", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "DRNAME1", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "ADDR", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "UPTAE", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "UPJONG", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "PASSPORTNO", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "RCPT_INVO_NUM", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "TAX_AMEND_CD", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "MEM_SEQ", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "MEM_NAME", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "MEM_TEL_NO", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "MEM_CP_NO", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "MEM_EMAIL", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "MEM_DEPT", "");
		
		ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG_SAUPNO", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG_VATUPJANGNM", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG_DRNAME", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG_ADDR", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG_UP_TAE", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "UPJANG_UP_JONG", "");

		ds_listInput.setColumn(ds_listInput.rowposition, "ELC_AGREE_STAT", "");		
		ds_listInput.setColumn(ds_listInput.rowposition, "TAX_IF_GB", "");
		ds_listInput.setColumn(ds_listInput.rowposition, "TAX_APPROVAL_NO", ""); 		
	}			
	
			
	//전자세금계산서:관련사항조정###############################################################################
				
				
	if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"))!= "0"){
	
		
		//Disabled항목 Enabled처리####################################
		me_BILL_DATE.enable       = false;
		edtBtn_BILL_DATE.enable   = false;
		
		edt_BILL_TYPE.enable      = false;
		edtBtn_BILL_TYPE.enable   = false;
		
		cbo_BILL_GUBUN.enable     = false;
		cbo_MINUS_YN.enable       = false;
		cbo_ACCTCD.enable         = false;
		
		edt_CUSTCD.enable         = false;
		edtBtn_CUSTCD.enable      = false;
		
		me_SUMAMT.enable          = false;
		me_AMT.enable             = false;
		me_VAT.enable             = false;
		
		
		edt_BILL_DESC.enable      = false;	
		
		rd_TAX_IF_GB.enable       = false;
		//Disabled항목 Enabled처리####################################	
		
		//전자세금계산서:Enabled처리#################################
		cbo_TAXSENDGB.enable      = false;	
		cbo_SMSSENDYN.enable      = false;	
		cbo_NATFORGB.enable       = false;	
		edt_SAUPNO.enable         = false;	
		edt_CUSTNM.enable      	  = false;	
		edt_DRNAME1.enable        = false;	
		edt_ADDR.enable      	  = false;	
		edt_UPTAE.enable      	  = false;	
		edt_UPJONG.enable      	  = false;	
		edt_PASSPORTNO.enable     = false;	
		edt_RCPT_INVO_NUM.enable  = false;	
		cbo_TAX_AMEND_CD.enable   = false;	
		edt_MEM_SEQ.enable        = false;	
		edtBtn_MEM_SEQ.enable     = false;	
		edt_MEM_TEL_NO.enable     = false;	
		edt_MEM_CP_NO.enable      = false;	
		//메일재전송(930)기능 추가로 일단 무조건 수정가능하게
		//edt_MEM_EMAIL.Enable      = False;	
		edt_MEM_DEPT.enable       = false;	
		
		edt_EMPNO.enable      	  =	false;	
		edtBtn_EMPNO.enable       = false;	
		edt_TELNO.enable      	  = false;	
		edt_CPNO.enable      	  = false;	
		edt_EMAIL.enable      	  = false;	
		edt_DEPTNM.enable      	  = false;	
		edt_EMPNOUP.enable        = false;	
		edtBtn_EMPNOUP.enable     = false;	
		edt_TELNOUP.enable        = false;	
		edt_CPNOUP.enable      	  = false;	
		edt_EMAILUP.enable        = false;	
		edt_DEPTNMUP.enable       = false;	
		

		btn_DetailResend.enable                = false;	
		btn_DetailDisuseRequest.enable         = false;	
		btn_DetailDisuseRequestTurndown.enable = false;	
		btn_DetailSmsResend.enable             = false;	
		btn_DetailDisuse.enable                = false;	
		
		btn_ImgInsert.enable      			   = false;
			
		if (ds_listInput.getColumn(ds_listInput.rowposition, "TAX_IF_GB") == "N")
			btn_DetailDisuse.enable = true;	
	
		
		Set_SendElectricCheck(gfn_subStr(ds_listInput.getColumn(ds_listInput.rowposition, "ELC_AGREE_STAT"), 0, 3));
		
		//전자세금계산서:Enabled처리#################################
				
	}	
}
//각 구분별 대체마감체크############################################################
function fn_GetALT_CLOSE(objOutDs, real_BILL_ID)
{
    //대체마감체크#####################################################################
    var str_CloseErr = "";
    
    objOutDs.clear();
    //objOutDs.AddColumn("TRX_YN","STRING",256);	       
    //objOutDs.AddColumn("SUBST_YN","STRING",256);	       
    //objOutDs.AddColumn("CMS_YN","STRING",256);	 
    //bjOutDs.AddColumn("AUTO_YN","STRING",256);	
    objOutDs.addColumn("CLS_YN","STRING",256);	
    //objOutDs.AddColumn("RMT_YN","STRING",256);	 
    
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/mas:MAS10140E_S003");
	
	//alert(str_ACCTCD);
	//alert(str_DATE_STD);
	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","BILL_ID=" + real_BILL_ID
	                                                           ,"");	
	http.Sync = false;
	
	//if (objOutDs.GetColumn(objOutDs.row, "TRX_YN") == "Y")   str_CloseErr = "입금액의 일부 혹은 전부에 대해 \n매출이 발생했으므로\n수정/삭제할 수 없습니다.";
	//if (objOutDs.GetColumn(objOutDs.row, "SUBST_YN") == "Y") str_CloseErr = "영업대체된 데이터는\n수정/삭제할 수 없습니다.";				
	//if (objOutDs.GetColumn(objOutDs.row, "CMS_YN") == "Y")   str_CloseErr = "";			    
			                          	
	//if (objOutDs.GetColumn(objOutDs.row, "AUTO_YN") == "Y")  str_CloseErr = "자동등록된 데이터는\n수정/삭제할 수 없습니다.\n해당 화면에서 취소하신후 다시 작업\n하여주십시요.";			    
	
	if (objOutDs.getColumn(objOutDs.rowposition, "CLS_YN") == "Y")   str_CloseErr = "마감된 데이터는\n수정/삭제할 수 없습니다.";				
	
	//if (objOutDs.GetColumn(objOutDs.row, "RMT_YN") == "Y")   str_CloseErr = "현금/미수금->수입금이체된 데이터는\n수정/삭제할 수 없습니다.";
	
	if (gfn_length(str_CloseErr )!= 0){
	
		g_Message("EE", str_CloseErr + "\n" +
						"확인하여 주십시요.");			 
		return false;        
	}
	return true;
	//대체마감체크#####################################################################
 
}		
//각 구분별 대체마감체크############################################################
	 
	 
//세무월마감체크#######################################################################	 
function fn_GetTAX_CLOSE(objOutDs, str_BILL_DATE, real_UPJANG)
{
    var str_CloseErr = "";
    
    objOutDs.clear();
    objOutDs.addColumn("ENDGUBUN","STRING",256);	
    
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/mac:GetTAX_CLOSE");
	
	//alert(str_ACCTCD);
	//alert(str_DATE_STD);
	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","UPJANG=" + real_UPJANG +
	                                                           " ENDMONTH=" + gfn_subStr(str_BILL_DATE, 0, 6),"");	
	http.Sync = false;
	
	if (objOutDs.getColumn(objOutDs.rowposition, "ENDGUBUN") == "Y")   str_CloseErr = "해당업장은 " + gfn_subStr(str_BILL_DATE, 0, 4)+ "년 " + gfn_subStr(str_BILL_DATE, 4, 2)+ "월에 대해\n세무월마감 되었습니다.";
	
	if (gfn_length(str_CloseErr )!= 0){
	
		g_Message("EE", str_CloseErr + "\n" +
						"확인하여 주십시요.");			 
		return false;        
	}
	return true;
}	
//대체마감체크#####################################################################
			 
/*
 ******************************************************************************************
 * 함  수  명   : fn_GetBalance
 * 입      력   : real_UPJANG : 업장코드
	              str_DATE : 일자
	             
 * 반      환   :  값 리턴
 * 기      능   : 영업잔액체크
 * 작  성  자   : 황승한
 * 작성  일자   : 2007-11-28
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
*/
function fn_GetBalance(objOutDs, real_UPJANG, real_ID, str_DATE, str_CMP_CLASS, str_CMP_GRP, str_CMP_TYPE, str_CMP_ACCTCD, str_ALL_YN, real_CUSTCD, str_SUBINV_CODE)
{
    
    //잔액체크#####################################################################
    objOutDs.clear();
    objOutDs.addColumn("JANAMT","INT",256);	       
    
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/mas:GetMAS_GETBALANCE");
	//alert(str_ACCTCD);
	//alert(str_DATE_STD);
	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "", objOutDs.name + "=ds_list","V_GUBUN=" + wrapQuote("세금계산서잔액체크") + 
															   " V_UPJANG=" + wrapQuote(real_UPJANG) + 
	                                                           " V_ID=" + wrapQuote(real_ID) + 
	                                                           " V_DATE=" + wrapQuote(str_DATE) +
	                                                           " V_CMP_CLASS=" + wrapQuote(str_CMP_CLASS) +
	                                                           " V_CMP_GRP=" + wrapQuote(str_CMP_GRP) +
	                                                           " V_CMP_TYPE=" + wrapQuote(str_CMP_TYPE) +
	                                                           " V_CMP_ACCTCD=" + wrapQuote(str_CMP_ACCTCD) +
	                                                           " V_ALL_YN=" + wrapQuote(str_ALL_YN) +
	                                                           " V_CUSTCD=" + wrapQuote(real_CUSTCD) +
	                                                           " V_SUBINV_CODE=" + wrapQuote(str_SUBINV_CODE)
	                                                           ,"");	
	http.Sync = false;
	
                          	
	
	//alert(objOutDs.GetColumn(objOutDs.row, "ACCTCD_DATE") );
	return objOutDs.getColumn(objOutDs.rowposition, "JANAMT");
	//잔액체크#####################################################################
	
}
//자동비교여부가 'N'일 경우 매출비교 팝업창을 띄운다.#########################
function fn_OpenLineWindow(real_BILL_ID, real_BillAmt, str_MINUS_YN)
{
    if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0"){    
		g_Message("EE", "업장을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_UPJANGQuery.setFocus();
        return false;
    }
    
    if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE"))== 0){    
		g_Message("EE", "입금일자가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 						       
        me_BILL_DATE.setFocus();
        return false;
    }    
    
    var sParam = {real_BillAmt:real_BillAmt, str_MINUS_YN:str_MINUS_YN};
	gfn_dialog("", "U_MAS::MAS10140P.xfdl", sParam);
	
	if (ds_MAS_BILL_LINE.rowcount == 0) return false;
	
	return true;
    
}
//자동비교여부가 'N'일 경우 매출비교 팝업창을 띄운다.#########################
//BILL_ID 세팅#######################################################################
function fn_SaveTrxData(real_BILL_ID)
{
    if (numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))== "0"){    
		g_Message("EE", "업장을 선택하여 주십시요.\n" +
						"확인하여 주십시요.");        
        edt_UPJANGQuery.setFocus();
        return false;
    }
    
    if (gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE"))== 0){    
		g_Message("EE", "발행일자가 선택되어 있지 않습니다.\n" +
						"확인하여 주십시요."); 						       
        me_BILL_DATE.setFocus();
        return false;
    }    
    f_Saved_ID = ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID");
    
    if (numFormat(real_BILL_ID)== "0"){
    
		ds_cond.clear();
		ds_cond.addColumn("MAS_BILL_S","INT",256);
					
		// action 정보 초기화
		fsp_clear(this);
		// 서버에서 조회할 정보 추가
		fsp_addSearch(this, "ma/mas:MAS10140E_S002");
		// 서버 호출
		http.Sync = true;
		fsp_callService(this, "", "", "", ds_cond.name + "=ds_list","","");
		http.Sync = false;
		
		real_BILL_ID = ds_cond.getColumn(ds_cond.rowposition, "MAS_BILL_S");
		ds_listInput.setColumn(ds_listInput.rowposition, "BILL_ID", real_BILL_ID);
		
		f_Saved_ID  = 0;
		f_NewDataCheck = true;
    }
    
		
	//수기매출 대체###########################
	for (i=0;i<ds_MAS_BILL_LINE.rowcount;i++){
		
			ds_MAS_BILL_LINE.setColumn(i, "BILL_ID", real_BILL_ID);
	}
	//수기매출 대체###########################
	 
  
    return true;
}
//BILL_ID 세팅#######################################################################
function edt_UPJANGQuery_OnChanged(obj:Edit, e:TextChangedEventInfo)
{
	fn_DataSetAllClear();		
}
function grid_List_OnExpandEdit(obj:Grid, e:GridMouseEventInfo)
{
	if (numFormat(ds_list.getColumn(ds_list.rowposition, "BILL_ID"))== "0") return;
	
	var str_MenuIDText = "",
	    str_MenuIDTextDetail = "",
		str_XMLADDRESS1 = "",
		str_XMLADDRESS2 = "",	
		str_ColumnTitle = "",	
		real_BILL_ID = ds_list.getColumn(ds_list.rowposition, "BILL_ID");
		
    str_ColumnTitle = gfn_replace(gfn_replace(fn_Get_ColHeaderTitle(obj, e.cell), "▼"), "▲");	
    if (str_ColumnTitle == "마감"){
		
		str_MenuIDText       = "세금계산서발행-매출내역";
		str_MenuIDTextDetail = "[해당세금계산서가매출대체]한내역입니다.";
		str_XMLADDRESS1       = "ma/mas:MAS10081P_S018";
		str_XMLADDRESS2       = "NONE";
	}
	
	var sParam = {str_MenuIDText:str_MenuIDText, str_MenuIDTextDetail:str_MenuIDTextDetail, str_XMLADDRESS1:str_XMLADDRESS1, str_XMLADDRESS2:str_XMLADDRESS2, TRID:real_BILL_ID};
	gfn_dialog("", "U_MAS::MAS10081P.xfdl", sParam);	
	//gfn_dialog("", "U_MAS::MAS10081P.xfdl", "str_MenuIDText=" + str_MenuIDText + " str_MenuIDTextDetail=" + str_MenuIDTextDetail + " str_XMLADDRESS1=" + str_XMLADDRESS1 + " str_XMLADDRESS2=" + str_XMLADDRESS2 + " TRID=" + real_BILL_ID );	
}
//삭제처리###########################################################################
function before_DeleteCheck(str_GUBUN)
{
return;
	if ( 
		(ds_listInput.rowcount == 0) ||
		(numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"))== "0") ||
		(!g_Confirm("01"))
	   )
	{
		return false;
	}
	
	//각 구분별 대체 마감체크##############################
    if (!fn_GetALT_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"))) return false;	
    if (!fn_GetTAX_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE"), ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))) return false;
	//각 구분별 대체 마감체크##############################	        
					
	//마감체크###############################################
	if (!fn_CheckGAClosing(ds_cond, edt_UPJANGQuery.userdata, me_BILL_DATE.value, "200"))
		return false;                
	//마감체크###############################################
				       		
	
	// action 정보 초기화
	fsp_clear(this);			
	
	//기존 라인 및 매출 데이터 삭제.
	fsp_addSingle(this, "ma/mas:MAS10140E_D002");
	fsp_addSingle(this, "ma/mas:MAS10140E_D001");
	   
	http.Sync = true;
	fsp_callService(this, "", "", "ds_cond=ds_listInput:A",  "", "", "fn_AfterDeleteSearch()");		
	http.Sync = false;		
	
	return true;
}
function fn_AfterDeleteSearch(errCode, errMsg)
{
	if (errCode != 0){
		g_Message("EE");
		return;
	}
    g_Message("01");
    
	fn_search();
	fn_insert();
}
//삭제처리###########################################################################
//마감항목 배경색처리###############################################################
function fn_GetBackColorClose(ColorGubun, YN)
{
   	if (YN == "Y")
   	{
		return "thistle";
	}
	else
	{
		if (ColorGubun == "1")
		return "white";
		else
		return "#F6FCFC";
	}
}
//마감항목 배경색처리###############################################################
function ds_listInput_CanColumnChange(obj:Dataset, e:DSColChangeEventInfo)
{
	if (
	    (e.columnid == "SUMAMT")||
	    (e.columnid == "AMT")||
	    (e.columnid == "VAT")
	   )
	{
	
		if (ds_listInput.getColumn(ds_listInput.rowposition, "MINUS_YN") == "N"){
			
			
			if (toNumber(e.newvalue) < 0){
			
				g_Message("EE", "-금액을 입력할 수 없습니다.\n" +
								"확인하여 주십시요.");
									
				eval("me_" + e.columnid).value = "";
				eval("me_" + e.columnid).setFocus();		
							
				return false;  									
			}
		}		
		else if (ds_listInput.getColumn(ds_listInput.rowposition, "MINUS_YN") == "Y"){
			
			
			if (toNumber(e.newvalue) > 0){
			
				g_Message("EE", "마이너스 발행은 금액을 마이너스로 등록해야 합니다.\n" +
								"확인하여 주십시요.");
									
				eval("me_" + e.columnid).value = "";
				eval("me_" + e.columnid).setFocus();		
							
				return false;  									
			}
		}					
		
	}	
	
	if (e.columnid == "NATFORGB")	    	   
	{
		if (
			(gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ORG_SAUPNO"))== 0) ||
			(gfn_length(e.newvalue)== 0)
	       ) return true;
		
		if (
			(e.newvalue == "01") &&
			(gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ORG_SAUPNO"))!= 0) &&
			(ds_listInput.getColumn(ds_listInput.rowposition, "ORG_SAUPNO") == "9999999999")
		   )
		{					
			
				g_Message("EE", "해당 거래처는 사업자일수 없습니다.\n" +
								"확인하여 주십시요.");
									
							
				return false;  									
		
		}		
		if (
			(e.newvalue != "01") &&
			(gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "ORG_SAUPNO"))!= 0) &&
			(ds_listInput.getColumn(ds_listInput.rowposition, "ORG_SAUPNO") != "9999999999")
		   )
		{					
			
				g_Message("EE", "해당 거래처는 사업자가 아닐 수 없습니다.\n" +
								"확인하여 주십시요.");
									
							
				return false;  									
			
		}				
	}
}
function me_BILL_MONTH_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{
	fn_DataSetAllClear();		
}
function edt_BILL_DESC_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13){
		if (chk_Auto.value == "1")
		{
		    //Common_Btn.SetFocus();
			//fn_Save();
		}
	}	
}
function btn_DetailJanAmt_OnClick(obj:Button, e:ClickEventInfo)
{
	if (numFormat(edt_UPJANGQuery.userdata)== "0") return;
	
	var str_MenuIDText = "",
	    str_MenuIDTextDetail = "",
		str_XMLADDRESS1 = "",
		str_XMLADDRESS2 = "",		
		real_UPJANG = edt_UPJANGQuery.userdata;
		
    
		
	str_MenuIDText       = "세금계산서발행-잔액조회";
	str_MenuIDTextDetail = gfn_subStr(f_CurrDate, 0, 4)+ "년" +  gfn_subStr(f_CurrDate, 4, 2)+ "월" + gfn_subStr(f_CurrDate, 6, 2)+ "일" + "기준의[발행잔액]내역";
	str_XMLADDRESS1       = "ma/mas:MAS10081P_S019";
	str_XMLADDRESS2       = "NONE";
		
	var sParam = {str_MenuIDText:str_MenuIDText, str_MenuIDTextDetail:str_MenuIDTextDetail, str_XMLADDRESS1:str_XMLADDRESS1, str_XMLADDRESS2:str_XMLADDRESS2, TRID:real_UPJANG};
	gfn_dialog("", "U_MAS::MAS10081P.xfdl", sParam);	
	//gfn_dialog("", "U_MAS::MAS10081P.xfdl", "str_MenuIDText=" + str_MenuIDText + " str_MenuIDTextDetail=" + str_MenuIDTextDetail + " str_XMLADDRESS1=" + str_XMLADDRESS1 + " str_XMLADDRESS2=" + str_XMLADDRESS2 + " TRID=" + real_UPJANG );	
}
//서손처리###########################################################################
function btn_DetailDisuse_OnClick(obj)
{
	if (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE") < f_IF_SEMD_MST_CheckDate)
	{
		
		
		//권한에 따른 저장/삭제 가능체크#########################################################################
		if (!fn_GetSaveAuthBy_AuthLevel(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))) return false;
		//권한에 따른 저장/삭제 가능체크#########################################################################
	
		if ( 
			(ds_listInput.rowcount == 0) ||
			(numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"))== "0") ||
			(ds_listInput.getColumn(ds_listInput.rowposition, "CANCEL_YN") == "Y") ||
			(!g_Confirm("01", "해당 발행내역을 서손처리 하시겠습니까?"))
		   )
		{
	
			return false;
		}
		
		//각 구분별 대체 마감체크##############################
		if (!fn_GetALT_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"))) return false;
		if (!fn_GetTAX_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE"), ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))) return false;
		//각 구분별 대체 마감체크##############################	        
						
		//마감체크###############################################
		if (!fn_CheckGAClosing(ds_cond, edt_UPJANGQuery.userdata, me_BILL_DATE.value, "200"))
			return false;                
		//마감체크###############################################
								
		
		// action 정보 초기화
		fsp_clear(this);			
		
		//서손처리.
		fsp_addSingle(this, "ma/mas:MAS10140E_D002");
		
		fsp_addSingle(this, "ma/mas:MAS10140E_U001");
		   
		http.Sync = true;
		fsp_callService(this, "", "", "ds_cond=ds_listInput:A",  "", "", "fn_AfterDisuseSearch()");		
		http.Sync = false;		
		
		return true;	
	}
	else
	{
		//전자세금계산서 재발행/서손요청/서손/반려기각/e-Mail/SMS 재전송#################
		return before_SendElectricCheck(btn_DetailDisuse.userdata, btn_DetailDisuse.name);		
	}
}
function fn_AfterDisuseSearch(errCode, errMsg)
{
	if (errCode != 0){
		g_Message("EE");
		return;
	}
    g_Message("01", "정상적으로 서손처리 되었습니다.");
    
	fn_search();
	fn_insert();
}



function fn_AfterSendElectricCheck(errCode, errMsg)
{
	if (errCode != 0){

		g_Message("EE");
		return;
	}

    g_Message("01", "정상적으로 처리 되었습니다.");
    
	fn_search();
	fn_insert();

}
//서손처리###########################################################################
function edtBtn_Date_OnClick(obj)
{
	g_CalButton_OnClick(obj);
	fn_DataSetAllClear();		
}
 
//전자세금계산서:  MAS_IF_SEND_MST_HIS 매핑시작 ###################################
function fn_SetMAS_IF_SEND_MST_HIS(real_BILL_ID)
{
    var int_CurrRow = -1;
    
	if (ds_listInput.rowcount == 0)
	{
		return false;
	}   
	 
	
		
	ds_MAS_IF_SEND_MST_HIS.clearData();
	
	ds_MAS_IF_SEND_MST_HIS.addRow();
	
	int_CurrRow = ds_MAS_IF_SEND_MST_HIS.rowposition;
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "BILL_ID", ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"));		
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "TAX_ISSUE_DT", ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE"));
	
	if (
		(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE") == "310") || //세금계산서
		(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE") == "350")    //세금계산서(영세율)
	   )
	{
	   
		if (ds_listInput.getColumn(ds_listInput.rowposition, "MINUS_YN") == "Y")
		{
			ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "TAX_TYPE", "02"); //수정세금계산서
		}
		else
		{
			ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "TAX_TYPE", "01"); //세금계산서	
		}	
	}
	
	if (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE") == "410")  //계산서
	{
	   
		if (ds_listInput.getColumn(ds_listInput.rowposition, "MINUS_YN") == "Y")
		{
			ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "TAX_TYPE", "04"); //수정계산서
		}
		else
		{
			ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "TAX_TYPE", "03"); //계산서	
		}
	}
	
	if (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_TYPE") == "350")    //세금계산서(영세율)
	{
		ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "TAX_CLAS", "02"); //영세율	
	}
	else
	{
		ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "TAX_CLAS", "01"); //일반	
	}
	
	
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "TAX_AMEND_CD", ds_listInput.getColumn(ds_listInput.rowposition, "TAX_AMEND_CD"));
	
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "TAX_APAR_GB", "1");
	
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "TAX_SEND_GB", ds_listInput.getColumn(ds_listInput.rowposition, "TAXSENDGB"));
	
	
	
	if (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_GUBUN") == "001")    //청구
	{
		ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "TAX_PURPOSE_CD", "02"); //청구
	}
	else
	{
		ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "TAX_PURPOSE_CD", "01"); //영수	
	}
	
	
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICER_TAXREGIST_CD", gfn_subStr(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG_SAUPNO"), 10, 4));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICEE_TAXREGIST_CD", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICER_CMP_ID", gfn_subStr(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG_SAUPNO"), 0, 10));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICER_CMP_NAME", ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG_VATUPJANGNM"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICER_CMP_CEO", ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG_DRNAME"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICER_CMP_ADDR", ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG_ADDR"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICER_CMP_TYPE", ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG_UP_TAE"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICER_CMP_CLAS", ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG_UP_JONG"));
	
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICEE_BUSINESSTYPE_CD", ds_listInput.getColumn(ds_listInput.rowposition, "NATFORGB"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICEE_CMP_ID", ds_listInput.getColumn(ds_listInput.rowposition, "SAUPNO"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICEE_CMP_NAME", ds_listInput.getColumn(ds_listInput.rowposition, "CUSTNM"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICEE_CMP_CEO", ds_listInput.getColumn(ds_listInput.rowposition, "DRNAME1"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICEE_CMP_ADDR", ds_listInput.getColumn(ds_listInput.rowposition, "ADDR"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICEE_CMP_TYPE", ds_listInput.getColumn(ds_listInput.rowposition, "UPTAE"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICEE_CMP_CLAS", ds_listInput.getColumn(ds_listInput.rowposition, "UPJONG"));
	
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICER_MEM_NAME", ds_listInput.getColumn(ds_listInput.rowposition, "EMPNO_NAME"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICER_MEM_TEL_NO", ds_listInput.getColumn(ds_listInput.rowposition, "TELNO"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICER_MEM_CP_NO", ds_listInput.getColumn(ds_listInput.rowposition, "CPNO"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICER_MEM_EMAIL", ds_listInput.getColumn(ds_listInput.rowposition, "EMAIL"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICER_MEM_DEPT", ds_listInput.getColumn(ds_listInput.rowposition, "DEPTNM"));
	
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICEE_MEM_NAME", ds_listInput.getColumn(ds_listInput.rowposition, "MEM_NAME"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICEE_MEM_TEL_NO", ds_listInput.getColumn(ds_listInput.rowposition, "MEM_TEL_NO"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICEE_MEM_CP_NO", ds_listInput.getColumn(ds_listInput.rowposition, "MEM_CP_NO"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICEE_MEM_EMAIL", ds_listInput.getColumn(ds_listInput.rowposition, "MEM_EMAIL"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "INVOICEE_MEM_DEPT", ds_listInput.getColumn(ds_listInput.rowposition, "MEM_DEPT"));
	
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "CHARGE_TOT_AMT", ds_listInput.getColumn(ds_listInput.rowposition, "AMT"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "TAX_TOT_AMT", ds_listInput.getColumn(ds_listInput.rowposition, "VAT"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "GRAND_TOT_AMT", ds_listInput.getColumn(ds_listInput.rowposition, "AMT") + ds_listInput.getColumn(ds_listInput.rowposition, "VAT"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "TAX_DESC", ds_listInput.getColumn(ds_listInput.rowposition, "PASSPORTNO"));
	
	
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_PURCHASE_EXPIRY_DT1", ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_NAME1", ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DESC"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_INFO1", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_CHARGE_UNIT_QUANTITY1", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_UNIT_AMT1", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_INVOICE_AMT1", ds_listInput.getColumn(ds_listInput.rowposition, "AMT"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_TOTAL_TAX_AMT1", ds_listInput.getColumn(ds_listInput.rowposition, "VAT"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_DESC1", ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DESC"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_PURCHASE_EXPIRY_DT2", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_NAME2", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_INFO2", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_CHARGE_UNIT_QUANTITY2", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_UNIT_AMT2", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_INVOICE_AMT2", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_TOTAL_TAX_AMT2", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_DESC2", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_PURCHASE_EXPIRY_DT3", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_NAME3", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_INFO3", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_CHARGE_UNIT_QUANTITY3", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_UNIT_AMT3", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_INVOICE_AMT3", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_TOTAL_TAX_AMT3", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_DESC3", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_PURCHASE_EXPIRY_DT4", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_NAME4", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_INFO4", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_CHARGE_UNIT_QUANTITY4", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_UNIT_AMT4", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_INVOICE_AMT4", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_TOTAL_TAX_AMT4", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ITEM_DESC4", ds_listInput.getColumn(ds_listInput.rowposition, ""));
	
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "SMS_SEND_YN", ds_listInput.getColumn(ds_listInput.rowposition, "SMSSENDYN"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "ADD_DOC_YN", ds_listInput.getColumn(ds_listInput.rowposition, "N"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "RCPT_INVO_NUM", ds_listInput.getColumn(ds_listInput.rowposition, "RCPT_INVO_NUM"));
	
	
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "CMP_MEM_SEQ", ds_listInput.getColumn(ds_listInput.rowposition, "MEM_SEQ"));
	
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "USER1_SABUN", ds_listInput.getColumn(ds_listInput.rowposition, "EMPNO"));
	
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "USER2_NAME", ds_listInput.getColumn(ds_listInput.rowposition, "EMPNOUP_NAME"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "USER2_SABUN", ds_listInput.getColumn(ds_listInput.rowposition, "EMPNOUP"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "USER2_PHONE", ds_listInput.getColumn(ds_listInput.rowposition, "TELNOUP"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "USER2_CELLPHONE", ds_listInput.getColumn(ds_listInput.rowposition, "CPNOUP"));
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "USER2_MAIL", ds_listInput.getColumn(ds_listInput.rowposition, "EMAILUP"));	
	
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "TAX_IF_GB", ds_listInput.getColumn(ds_listInput.rowposition, "TAX_IF_GB"));	
	
	//=============================================================================
	// 2013-12-31 김장욱 추가 시작
	// 국세청 세금계산서 로직변경으로 반영
	//=============================================================================
	// 당초세금계산서번
	ds_MAS_IF_SEND_MST_HIS.setColumn(int_CurrRow, "AMEND_BILL_NO", ds_listInput.getColumn(ds_listInput.rowposition, "ORIGINAL_TAX_BILL"));	
	//=============================================================================
	// 2013-12-31 김장욱 추가 끝
	//=============================================================================
  
	//필수항목 null체크
	if (gfn_length(ds_MAS_IF_SEND_MST_HIS.getColumn(int_CurrRow, "INVOICER_CMP_ID"))<= 0)
	{
		g_Message("EE", "해당 업장은 사업자등록번호가 등록되지 않았습니다!\n(회계)담당자에게 문의하세요.");
		return false;
	}
	if (gfn_length(ds_MAS_IF_SEND_MST_HIS.getColumn(int_CurrRow, "INVOICER_CMP_NAME"))<= 0)
	{
		g_Message("EE", "해당 업장은 세무신고업장명이 등록되지 않았습니다!\n(회계)담당자에게 문의하세요.");
		return false;
	}
	if (gfn_length(ds_MAS_IF_SEND_MST_HIS.getColumn(int_CurrRow, "INVOICER_CMP_CEO"))<= 0)
	{
		g_Message("EE", "해당 업장은 대표자명이 등록되지 않았습니다!\n(회계)담당자에게 문의하세요.");
		return false;
	}
	if (gfn_length(ds_MAS_IF_SEND_MST_HIS.getColumn(int_CurrRow, "INVOICER_CMP_ADDR"))<= 0)
	{
		g_Message("EE", "해당 업장은 주소가 등록되지 않았습니다!\n(회계)담당자에게 문의하세요.");
		return false;
	}
	if (gfn_length(ds_MAS_IF_SEND_MST_HIS.getColumn(int_CurrRow, "INVOICER_CMP_TYPE"))<= 0)
	{
		g_Message("EE", "해당 업장은 업태가 등록되지 않았습니다!\n(회계)담당자에게 문의하세요.");
		return false;
	}
	if (gfn_length(ds_MAS_IF_SEND_MST_HIS.getColumn(int_CurrRow, "INVOICER_CMP_CLAS"))<= 0)
	{
		g_Message("EE", "해당 업장은 업종이 등록되지 않았습니다!\n(회계)담당자에게 문의하세요.");
		return false;
	}

    return true;
}
//전자세금계산서:  MAS_IF_SEND_MST_HIS 매핑시작 ###################################
//이메일 체크########################################################################
function user_IsEmail(sValue)
{
	var sReturnValue = "N";
	var sTmp = "";
	var sRegExp = "[a-z0-9]+[a-z0-9.,]+@[a-z0-9]+[a-z0-9.,]+\\.[a-z0-9]+";
	
	var regexp = createRegExp(sRegExp,"ig");
	sTmp = regexp.Exec(sValue);
	
	if ( sTmp == null )
			sReturnValue = "N";
	else
	{
		if ( ( sTmp.index == 0 ) && (sTmp.length == sValue.length ) )
			sReturnValue = "Y";
		else
			sReturnValue = "N";
	}
	
	return sReturnValue;
}
//이메일 체크########################################################################
function isValidPhone(input) {
    var format = "/^(\d+)-(\d+)-(\d+)$/";
    return isValidFormat(input,format);
} 
 
 
 



//전자세금계산서 재발행/서손요청/서손/반려기각/e-Mail/SMS 재전송#################
function before_SendElectricCheck(str_ARCode, str_ButtonName)
{
    if (ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE") < f_IF_SEMD_MST_CheckDate) return false;
        
        
	//권한에 따른 저장/삭제 가능체크#########################################################################
	if (
		    (f_ROLE_YN != "Y") &&
		    (!fn_GetSaveAuthBy_AuthLevel(ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG")))
	   ) return false;
	//권한에 따른 저장/삭제 가능체크#########################################################################


	//전자세금계산서 재발행/서손요청/서손/반려기각/e-Mail/SMS 재전송 체크function#######
    if (!Set_SendElectricCheckRealTime(str_ARCode, str_ButtonName))
    {
     
  		g_Message("EE", "해당 세금계산서 상태에서 처리할 수 없습니다.");
		return false;
	}


    // 전자세금계산서 프로시저 호출
    //IF_SEND_REQ_PRO
    // 세금계산서번호 + "#" + 요청코드(서손요청:400, 서손:444, 반려기각:250, 국세청전송:N00, SMS재전송:900, e-Mail재전송:930) + "#" +
    // 성명 + "#" + 휴대폰 + "#" + 이메일 + "#" + 일반전화 + "#" + 부서 + "#" + seq

    var str_SendMessage = "";
    
 

    str_SendMessage = ds_listInput.getColumn(ds_listInput.rowposition, "BILL_NO") + "#" + str_ARCode;

    //900: e-Mail/SMS 재전송#############################################################################
	if (str_ARCode == "900")
	{
		str_SendMessage += "#" + edt_MEM_SEQ.value + "#" + edt_MEM_CP_NO.value + "#" + edt_MEM_EMAIL.value + "#" + edt_MEM_TEL_NO.value + "#" + edt_MEM_DEPT.value + "#";
		if (gfn_length(edt_MEM_SEQ.userdata)<> 0) str_SendMessage += edt_MEM_SEQ.userdata;
	}
	else if (str_ARCode == "930") //세금계산서번호#930###거래처담당자이메일###
	{
		str_SendMessage += "###" + edt_MEM_EMAIL.value + "###";
	}
	else
	{

		str_SendMessage += "######";
	}



    ds_SendElectricCheck.clearData();
    
    ds_SendElectricCheck.addRow();
    
    ds_SendElectricCheck.setColumn(ds_SendElectricCheck.rowposition, "strInParams", str_SendMessage);
    ds_SendElectricCheck.setColumn(ds_SendElectricCheck.rowposition, "strUserID",   g_EmpNo);
    ds_SendElectricCheck.setColumn(ds_SendElectricCheck.rowposition, "strUserIP",   "");
    ds_SendElectricCheck.setColumn(ds_SendElectricCheck.rowposition, "strHPtr",     "");
    
    ds_SendElectricCheck.setColumn(ds_SendElectricCheck.rowposition, "lngRtn",      "");
    ds_SendElectricCheck.setColumn(ds_SendElectricCheck.rowposition, "lngCount",    "");
    ds_SendElectricCheck.setColumn(ds_SendElectricCheck.rowposition, "strDesc",     "");// 정상 : Y#, 오류 : N#오류내용
    ds_SendElectricCheck.setColumn(ds_SendElectricCheck.rowposition, "SEND_FLAG",  "N");//기본 1차 전송
    

    //서손 처리 process############################################################
    if (str_ARCode == "444")
    {
    

		
		if ( 
			(ds_listInput.rowcount == 0) ||
			(numFormat(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"))== "0") ||
			(ds_listInput.getColumn(ds_listInput.rowposition, "CANCEL_YN") == "Y") ||
			(!g_Confirm("01", "해당 발행내역을 서손처리 하시겠습니까?"))
		   )
		{
	
			return false;
		}
		
		//각 구분별 대체 마감체크##############################
		if (!fn_GetALT_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "BILL_ID"))) return false;
		if (!fn_GetTAX_CLOSE(ds_cond, ds_listInput.getColumn(ds_listInput.rowposition, "BILL_DATE"), ds_listInput.getColumn(ds_listInput.rowposition, "UPJANG"))) return false;
		//각 구분별 대체 마감체크##############################	        
						


							
		//마감체크###############################################
		if (!fn_CheckGAClosing(ds_cond, edt_UPJANGQuery.userdata, me_BILL_DATE.value, "200"))
			return false;                
		//마감체크###############################################
								
		
		// action 정보 초기화
		fsp_clear(this);			
		
		//서손처리.
		fsp_addSingle(this, "ma/mas:MAS10140E_D002");
		
		fsp_addSingle(this, "ma/mas:MAS10140E_U001");
		
		//전자세금계산서 PROC호출################################
		fsp_addSingle(this, "ma/mas:MAS10140E_I004");
		//전자세금계산서 PROC호출################################
		   
		http.Sync = true;
		fsp_callService(this, "", "", "ds_cond=ds_listInput:A ds_SendElectricCheck=ds_SendElectricCheck:A",  "", "", "fn_AfterDisuseSearch()");		
		http.Sync = false;		
		
		return true;	
	}
    //서손 처리 process############################################################
    
    else
    {
    
		// action 정보 초기화
		fsp_clear(this);	
		
		//전송인 경우 파라메터는 계산서번호만.
		if (str_ARCode == "N00")
		{
			g_Message("01", "국세청전송완료 상태는 5~10분 후에 확인해보시기 바랍니다.");
			ds_SendElectricCheck.setColumn(ds_SendElectricCheck.rowposition, "strInParams", ds_listInput.getColumn(ds_listInput.rowposition, "BILL_NO"));
			ds_SendElectricCheck.setColumn(ds_SendElectricCheck.rowposition, "SEND_FLAG",  "Y");//2차 국세청전송
		}
		//전자세금계산서 PROC호출################################
		fsp_addSingle(this, "ma/mas:MAS10140E_I004");
		//전자세금계산서 PROC호출################################    
    
		http.Sync = true;
		fsp_callService(this, "", "", "ds_SendElectricCheck=ds_SendElectricCheck:A",  "", "", "fn_AfterSendElectricCheck()");
		http.Sync = false;		
		
		return true; 

    }
}

/*
#TAX_ISSUE_DT#,                 -- 작성일자 // 세금계산서 내 작성년월일 YYYYMMDD
#TAX_TYPE#,                     -- 세금계산서종류 // 01:세금계산서, 02:수정세금계산서, 03:계산서, 04:수정계산서
#TAX_CLAS#,                     -- 세금계산서분류 // 01:일반, 02:영세율
#TAX_AMEND_CD#,                 -- 수정코드 // 수정세금계산서의 경우에는 not null
#TAX_APAR_GB#,                  -- 세금계산서구분 // 1:매출, 2:매입
#TAX_SEND_GB#,                  -- 발행구분 // 1:순발행, 2:역발행
#TAX_PURPOSE_CD#,               -- 영수/청구구분 // 01:청구, 02:청구
#INVOICER_TAXREGIST_CD#,        -- 종사업장번호 (공급자)
#INVOICEE_TAXREGIST_CD#,        -- 종사업장번호 (공급받는자)
#INVOICER_CMP_ID#,              -- 공급자 사업자등록번호
#INVOICER_CMP_NAME#,            -- 공급자 사업자명
#INVOICER_CMP_CEO#,             -- 공급자 대표자명
#INVOICER_CMP_ADDR#,            -- 공급자 주소
#INVOICER_CMP_TYPE#,            -- 공급자 업태
#INVOICER_CMP_CLAS#,            -- 공급자 업종
#INVOICEE_BUSINESSTYPE_CD#,     -- 사업자등록번호구분코드(공급받는자) // 01:사업자등록번호, 02:주민등록번호, 03:외국인
#INVOICEE_CMP_ID#,              -- 공급받는자 사업자등록번호 // 법인사업자등록번호 10자리, 개인주민등록번호 13자리, 외국인 13자리 9999...
#INVOICEE_CMP_NAME#,            -- 공급받는자 사업자명
#INVOICEE_CMP_CEO#,             -- 공급받는자 대표자명
#INVOICEE_CMP_ADDR#,            -- 공급받는자 주소 (개인은 null)
#INVOICEE_CMP_TYPE#,            -- 공급받는자 업태 (개인은 null)
#INVOICEE_CMP_CLAS#,            -- 공급받는자 업종 (개인은 null)
#INVOICER_MEM_NAME#,            -- 공급자 담당자명
#INVOICER_MEM_TEL_NO#,          -- 공급자 담당자 전화번호
#INVOICER_MEM_CP_NO#,           -- 공급자 담당자 휴대폰번호
#INVOICER_MEM_EMAIL#,           -- 공급자 담당자 이메일
#INVOICER_MEM_DEPT#,            -- 공급자 담당자 부서
#INVOICEE_MEM_NAME#,            -- 공급받는자 담당자명
#INVOICEE_MEM_TEL_NO#,          -- 공급받는자 담당자 전화번호
#INVOICEE_MEM_CP_NO#,           -- 공급받는자 담당자 휴대폰번호
#INVOICEE_MEM_EMAIL#,           -- 공급받는자 담당자 이메일
#INVOICEE_MEM_DEPT#,            -- 공급받는자 담당자 부서
#CHARGE_TOT_AMT#,               -- 공급가액
#TAX_TOT_AMT#,                  -- 세액
#GRAND_TOT_AMT#,                -- 합계금액
#TAX_DESC#,                     -- 세금계산서 비고
                                -- 공급받는자가 외국인인 경우
                                -- 여권번호 및 외국인등록번호 등을 기재
#ITEM_PURCHASE_EXPIRY_DT1#,     -- 품목1 공급년월일
#ITEM_NAME1#,                   -- 품목1 명
#ITEM_INFO1#,                   -- 품목1 규격
#ITEM_CHARGE_UNIT_QUANTITY1#,   -- 품목1 수량
#ITEM_UNIT_AMT1#,               -- 품목1 단가
#ITEM_INVOICE_AMT1#,            -- 품목1 공급가액
#ITEM_TOTAL_TAX_AMT1#,          -- 품목1 세액
#ITEM_DESC1#,                   -- 품목1  비고
#ITEM_PURCHASE_EXPIRY_DT2#,     -- 품목2 공급년월일
#ITEM_NAME2#,                   -- 품목2 명
#ITEM_INFO2#,                   -- 품목2 규격
#ITEM_CHARGE_UNIT_QUANTITY2#,   -- 품목2 수량
#ITEM_UNIT_AMT2#,               -- 품목2 단가
#ITEM_INVOICE_AMT2#,            -- 품목2 공급가액
#ITEM_TOTAL_TAX_AMT2#,          -- 품목2 세액
#ITEM_DESC2#,                   -- 품목2  비고
#ITEM_PURCHASE_EXPIRY_DT3#,     -- 품목3 공급년월일
#ITEM_NAME3#,                   -- 품목3 명
#ITEM_INFO3#,                   -- 품목3 규격
#ITEM_CHARGE_UNIT_QUANTITY3#,   -- 품목3 수량
#ITEM_UNIT_AMT3#,               -- 품목3 단가
#ITEM_INVOICE_AMT3#,            -- 품목3 공급가액
#ITEM_TOTAL_TAX_AMT3#,          -- 품목3 세액
#ITEM_DESC3#,                   -- 품목3  비고
#ITEM_PURCHASE_EXPIRY_DT4#,     -- 품목3 공급년월일
#ITEM_NAME4#,                   -- 품목4 명
#ITEM_INFO4#,                   -- 품목4 규격
#ITEM_CHARGE_UNIT_QUANTITY4#,   -- 품목4 수량
#ITEM_UNIT_AMT4#,               -- 품목4 단가
#ITEM_INVOICE_AMT4#,            -- 품목4 공급가액
#ITEM_TOTAL_TAX_AMT4#,          -- 품목4 세액
#ITEM_DESC4#,                   -- 품목4  비고,
#SMS_SEND_YN#,                  -- SMS 발송여부
#ADD_DOC_YN#,                   -- 첨부문서 포함여부 (Y/N)
#RCPT_INVO_NUM#,                -- 피발행 세금계산서번호 (거래처의 발급 세금계산서 번호)
                                -- 피발행시에만 입력
#CMP_MEM_SEQ#,                  -- 거래처 담당자정보 SEQ
#USER1_SABUN#,                  -- 발행자1 사번
#USER2_NAME#,                   -- 발행자2 성명
#USER2_SABUN#,                  -- 발행자2 사번
#USER2_PHONE#,                  -- 발행자2 전화번호
#USER2_CELLPHONE#,              -- 발행자2 휴대폰번호
#USER2_MAIL#,                   -- 발행자2 이메일
*/
function btn_DetailResend_OnClick(obj:Button, e:ClickEventInfo)
{
	//전자세금계산서 재발행/서손요청/서손/반려기각/e-Mail/SMS 재전송#################
	before_SendElectricCheck(obj.userdata, obj.name);	
}

//전자세금계산서 재발행/서손요청/서손/반려기각/e-Mail/SMS 재전송 체크function#######
function Set_SendElectricCheck(str_ARCode)
{

	// 미전송(R99)인 경우 재발행, 서손
	if (str_ARCode == "R99")
	{
	
		if (
			(ds_listInput.getColumn(ds_listInput.rowposition, "TAXSENDGB") == "1") &&
			(gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_NO"))== 0)
		   ) 
		{   
			btn_DetailResend.enable                = true;			
		}
				
		if (
			(ds_listInput.getColumn(ds_listInput.rowposition, "TAXSENDGB") == "2") &&
			(gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "RCPT_INVO_NUM"))== 0)
		   ) 
		{
			btn_DetailResend.enable                = true;	
		}
							
		btn_DetailDisuse.enable                = true;		
	}
	
	// 국세청송신실패(N03)인 경우 서손요청
	if (str_ARCode == "N03")
	{
	
		btn_DetailDisuseRequest.enable         = true;			
	}		
	
	// 세금계산서 필수항목 오류(008)/국세청승인번호 중복 오류(009)/폐기(700)인 경우 서손
	if (
		 (str_ARCode == "008") ||
		 (str_ARCode == "009") ||
		 (str_ARCode == "700")	 
	   )
	{
		btn_DetailDisuse.enable         = true;			
	}		
		

		
	// 발행(100)인 경우 서손요청, SMS재전송
	if (str_ARCode == "100")
	{
	
		btn_DetailDisuseRequest.enable         = true;	
		btn_DetailSmsResend.enable             = true;		
		
		// SMS재전송인 경우 공급받는자 담당자를 수정할 수 있다.	
		//edt_MEM_SEQ.Enable        = True;
		//edtBtn_MEM_SEQ.Enable     = True;
		//edt_MEM_TEL_NO.Enable     = True;
		//edt_MEM_CP_NO.Enable      = True;
		//edt_MEM_EMAIL.Enable      = True;
		//edt_MEM_DEPT.Enable       = True;			
		// SMS재전송인 경우 공급받는자 담당자를 수정할 수 있다.
	}		
			
	// 반려요청(200)인 경우 서손요청, 반려기각	
	if (str_ARCode == "200")
	{
	
		btn_DetailDisuseRequest.enable         = true;	
		btn_DetailDisuseRequestTurndown.enable = true;			
	}		
								
	// ERP폐기요청(400), ERP폐기승인요청(450), 국세청전송완료(N00)인 경우 SMS재전송
	if ((str_ARCode == "400") || (str_ARCode == "450") || (str_ARCode == "N00"))
	{
	
		btn_DetailSmsResend.enable             = true;		
					
		// SMS재전송인 경우 공급받는자 담당자를 수정할 수 있다.	
		//edt_MEM_SEQ.Enable        = True;
		//edtBtn_MEM_SEQ.Enable     = True;
		//edt_MEM_TEL_NO.Enable     = True;
		//edt_MEM_CP_NO.Enable      = True;
		//edt_MEM_EMAIL.Enable      = True;
		//edt_MEM_DEPT.Enable       = True;			
		// SMS재전송인 경우 공급받는자 담당자를 수정할 수 있다.					
	}	
							
	// 완료(500)인 경우 서손요청
	if (str_ARCode == "500")
	{
		btn_DetailDisuseRequest.enable = true;
		btn_Send.enable = true;
/*나중에 수정하자
		// 완료(500) & 전자세금계산서인 경우만 국세청 전송
		// 그 외에 일반계산서, 수정세금계산서, 계산서, 수정계산서는 500에서 끝이다.
		if (ds_listInput.GetColumn(ds_listInput.Row, "BILL_TYPE") == "310")
		{
			btn_Send.Enable = True;
		}
*/
	}

}		
//전자세금계산서 재발행/서손요청/서손/반려기각/e-Mail/SMS 재전송 체크function#######	




//전자세금계산서 재발행/서손요청/서손/반려기각/e-Mail/SMS 재전송 체크function#######
function Set_SendElectricCheckRealTime(str_ActionCode, str_ButtonName)
{
    var str_ELC_AGREE_STAT;
    str_ELC_AGREE_STAT = "";
    
    //상태체크#####################################################################
    ds_cond.clear();
    ds_cond.addColumn("ELC_AGREE_STAT","STRING",256);	       
    
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/mas:MAS10140E_S007");
	
	//alert(str_ACCTCD);
	//alert(str_DATE_STD);
	// 서버 호출 
	http.Sync = true;
	fsp_callService(this, "", "", "", ds_cond.name + "=ds_list","V_BILL_NO=" + wrapQuote(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_NO"))
	                                                           ,"");	
	http.Sync = false;
	
                          	
	
	//alert(objOutDs.GetColumn(objOutDs.row, "ACCTCD_DATE") );
	str_ELC_AGREE_STAT = gfn_subStr(ds_cond.getColumn(ds_cond.rowposition, "ELC_AGREE_STAT"), 0, 3);
	//상태체크#####################################################################
	
	
	// 미전송(R99)인 경우 재발행, 서손
	if (str_ELC_AGREE_STAT == "R99")
	{
		
		if (str_ButtonName == "btn_DetailDisuse") return true;
		
		if (
			(ds_listInput.getColumn(ds_listInput.rowposition, "TAXSENDGB") == "1") &&
			(gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "BILL_NO"))== 0)
		   ) 
		{   
			//btn_DetailResend.Enable                = True;			
			if (str_ButtonName != "btn_DetailResend") return false;
		}
				
		if (
			(ds_listInput.getColumn(ds_listInput.rowposition, "TAXSENDGB") == "2") &&
			(gfn_length(ds_listInput.getColumn(ds_listInput.rowposition, "RCPT_INVO_NUM"))== 0)
		   ) 
		{
			//btn_DetailResend.Enable                = True;	
			if (str_ButtonName != "btn_DetailResend") return false;
		}
							
		//btn_DetailDisuse.Enable                = True;		
	}
	
	// 국세청송신실패(N03)인 경우 서손요청
	if (str_ELC_AGREE_STAT == "N03")
	{
	
		//btn_DetailDisuseRequest.Enable         = True;			
		if (str_ButtonName != "btn_DetailDisuseRequest") return false;
	}		
	
	// 세금계산서 필수항목 오류(008)/국세청승인번호 중복 오류(009)/폐기(700)인 경우 서손
	if (
		 (str_ELC_AGREE_STAT == "008") ||
		 (str_ELC_AGREE_STAT == "009") ||
		 (str_ELC_AGREE_STAT == "700")	 
	   )
	{
		//btn_DetailDisuse.Enable         = True;			
		if (str_ButtonName != "btn_DetailDisuse") return false;
	}		
		

		
	// 발행(100)인 경우 서손요청, SMS재전송
	if (str_ELC_AGREE_STAT == "100")
	{
	
		//btn_DetailDisuseRequest.Enable         = True;	
		//btn_DetailSmsResend.Enable             = True;		
		//alert(str_ButtonName);
		if (
		     (str_ButtonName != "btn_DetailDisuseRequest") &&
		     (str_ButtonName != "btn_DetailSmsResend")
		   ) return false;
		
		//SMS재전송인 경우 공급받는자 담당자를 수정할 수 있다.	
		// edt_MEM_SEQ.Enable        = True;
		// edtBtn_MEM_SEQ.Enable     = True;
		// edt_MEM_TEL_NO.Enable     = True;
		// edt_MEM_CP_NO.Enable      = True;
		// edt_MEM_EMAIL.Enable      = True;
		// edt_MEM_DEPT.Enable       = True;			
		//SMS재전송인 경우 공급받는자 담당자를 수정할 수 있다.
	}		
			
	// 반려요청(200)인 경우 서손요청, 반려기각	
	if (str_ELC_AGREE_STAT == "200")
	{
	
		//btn_DetailDisuseRequest.Enable         = True;	
		//btn_DetailDisuseRequestTurndown.Enable = True;	
				
		if (
		     (str_ButtonName != "btn_DetailDisuseRequest") &&
		     (str_ButtonName != "btn_DetailDisuseRequestTurndown")
		   ) return false;				
	}		
								
	// ERP폐기요청(400), ERP폐기승인요청(450), 국세청전송완료(N00)인 경우 SMS재전송
	if ((str_ELC_AGREE_STAT == "400") || (str_ELC_AGREE_STAT == "450") || (str_ELC_AGREE_STAT == "N00"))
	{
	
		//btn_DetailSmsResend.Enable             = True;		
		
		if (str_ButtonName != "btn_DetailSmsResend") return false;		
					
		// SMS재전송인 경우 공급받는자 담당자를 수정할 수 있다.	
		// edt_MEM_SEQ.Enable        = True;
		// edtBtn_MEM_SEQ.Enable     = True;
		// edt_MEM_TEL_NO.Enable     = True;
		// edt_MEM_CP_NO.Enable      = True;
		// edt_MEM_EMAIL.Enable      = True;
		// edt_MEM_DEPT.Enable       = True;			
		// SMS재전송인 경우 공급받는자 담당자를 수정할 수 있다.					
	}	
							
	// 완료(500)인 경우 서손요청, 국세청 전송
	if (str_ELC_AGREE_STAT == "500")
	{
		//btn_DetailDisuseRequest.Enable             = True;					
		//if (str_ButtonName != "btn_DetailDisuseRequest") return False;	
		if (
			(str_ButtonName != "btn_DetailDisuseRequest") &&
			(str_ButtonName != "btn_Send")
		) return false;	
	}
	
	return true;
}		
//전자세금계산서 재발행/서손요청/서손/반려기각/e-Mail/SMS 재전송 체크function#######	



function me_BILL_DATE_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{
	ds_listInput.setColumn(ds_listInput.rowposition, "CUSTCD",      "");	
	ds_listInput.setColumn(ds_listInput.rowposition, "CUSTCDNM",    "");	
	ds_listInput.setColumn(ds_listInput.rowposition, "TAX_IF_GB",   "Y");

}

function btn_ImgInsert_OnClick(obj:Button, e:ClickEventInfo)
{
	if (ds_listInput.getRowCount()==0)
	{
		return;
	}

	if(fileDialog_EBill.Open()==false)
	{
		return;
	}


	file_EBill.FileName = fileDialog_EBill.FilePath + "\\" + fileDialog_EBill.FileName;
	file_EBill.Open(); 
	
	var xslfile = file_EBill.Read(-1, "utf-8");
	
	file_EBill.Close(); 
	
	var XMLDoc = createObject("Microsoft.XMLDOM");  
	 
	XMLDoc.async = false;
		
	//xml; string8??? load?? ??
	XMLDoc.loadXML(xslfile);
	
	//trace(XMLDoc.xml);
	
	//root node? ????
	var root = XMLDoc.documentElement;

	ds_EBill.clearData();
	ds_EBill.addRow();
	
/*	//발행일자################################################
	var nodeList = root.getElementsByTagName("ExchangedDocument");
	
	for(var j=0;j<nodeList.length;j++)
	{	
		var node = nodeList[j];
		
		var childNodes = node.childNodes;
		
		for(var i=0; i < childNodes.length; i++)
		{
			// var strTmp = childNodes[i].text;
			// if(strTmp == null) strTmp = "null";
				// trace(childNodes[i].nodeName + "==" + strTMP );
			
			
			if (childNodes[i].nodeName == "IssueDateTime"){
				
				//ds_listInput.SetColumn(ds_listInput.row, "BILL_DATE", substr(childNodes[i].text, 0, 8));	
				ds_EBill.SetColumn(ds_EBill.row, "IssueDateTime", substr(childNodes[i].text, 0, 8));	
			}			
		}
	}
	//발행일자################################################
*/	

	//발행번호################################################
	var nodeList = root.getElementsByTagName("TaxInvoiceDocument");
	
	for(var j=0;j<nodeList.length;j++)
	{	
		var node = nodeList[j];
		
		var childNodes = node.childNodes;
		
		for(var i=0; i < childNodes.length; i++)
		{		
			
			if (childNodes[i].nodeName == "IssueID"){
				
				ds_listInput.setColumn(ds_listInput.rowposition, "RCPT_INVO_NUM", childNodes[i].text);		
				ds_EBill.setColumn(ds_EBill.rowposition, "IssueID", childNodes[i].text);	
			}		
			//발행일자################################################
			if (childNodes[i].nodeName == "IssueDateTime"){
				
				ds_listInput.setColumn(ds_listInput.rowposition, "BILL_DATE", childNodes[i].text);		
				ds_EBill.setColumn(ds_EBill.rowposition, "IssueDateTime", childNodes[i].text);	
			}
			//발행일자################################################	
			
			if (childNodes[i].nodeName == "PurposeCode"){
				
				// if (sTest = '01') then
				   // edtBtn_BAL_GUBUN.Text := '영수'
				// else if  (sTest = '02') then
				   // edtBtn_BAL_GUBUN.Text := '청구';				
			}						
		}
	}
	//발행번호################################################
	
	//고객사체크################################################
	var nodeList = root.getElementsByTagName("TaxInvoiceTradeSettlement");
	
	for(var j=0;j<nodeList.length;j++)
	{	
		var node = nodeList[j];
		
		var childNodes = node.childNodes;
		
		for(var i=0; i < childNodes.length; i++)
		{		
			
			
			//if (childNodes[i].nodeName == "InvoicerParty"){ //매입일경우
			if (childNodes[i].nodeName == "InvoiceeParty"){ //매출일경우								
				var grandChildNodes = childNodes[i].childNodes;
				
				for(var i=0; i < grandChildNodes.length; i++)
				{		
					
					if (grandChildNodes[i].nodeName == "ID"){
												
					    ds_EBill.setColumn(ds_EBill.rowposition, "InvoiceeParty_ID", grandChildNodes[i].text);										
					}		
						
				}
										
			}		
				
		}
	}
	//고객사체크################################################
	
	//총공급가/부가세체크######################################
	var nodeList = root.getElementsByTagName("TaxInvoiceTradeSettlement");
	
	for(var j=0;j<nodeList.length;j++)
	{	
		var node = nodeList[j];
		
		var childNodes = node.childNodes;
		
		for(var i=0; i < childNodes.length; i++)
		{		
			
			if (childNodes[i].nodeName == "SpecifiedMonetarySummation"){ 
											
				var grandChildNodes = childNodes[i].childNodes;
				
				for(var i=0; i < grandChildNodes.length; i++)
				{		
					
					if (grandChildNodes[i].nodeName == "ChargeTotalAmount"){
						
						//ds_listInput.SetColumn(ds_listInput.row, "ADJ_AMT", toNumber(grandChildNodes[i].text));
						ds_EBill.setColumn(ds_EBill.rowposition, "ChargeTotalAmount", toNumber(grandChildNodes[i].text));		
						
						//me_AMT.Value = ToNumber(me_ADJ_AMT.Value) + ToNumber(me_VAT.Value);
		
					}		
					
					if (grandChildNodes[i].nodeName == "TaxTotalAmount"){
						
						//ds_listInput.SetColumn(ds_listInput.row, "VAT", toNumber(grandChildNodes[i].text));	
						ds_EBill.setColumn(ds_EBill.rowposition, "TaxTotalAmount", toNumber(grandChildNodes[i].text));		
						
						//me_AMT.Value = ToNumber(me_ADJ_AMT.Value) + ToNumber(me_VAT.Value);
			
					}							
				}
										
			}		
				
		}
	}
	//총공급가/부가세체크######################################
	
	destroyObject(XMLDoc);	
}
//===========================================================================================
// 2013-12-09 김장욱 수정 시작
// 수정세금계산서 국세청 로직변경으로 인한 수정
//===========================================================================================
function btn_OriginalTaxBill_OnClick(obj:Button, e:ClickEventInfo)
{
	gfn_dialog("", "U_MAS::MAS10141P.xfdl", "");
	
	//alert(ds_listInput.GetColumn(ds_listInput.row, "ORIGINAL_CUST_NM"));
	
	//edt_OriginalTaxBill.Text = "11111";
}

// 설정버튼
// FC기획팀 김성권 매니저만 작업가능
// (여기에 설정된 업장은 당월 매출뿐만 아니라 과거 매출도 다 같이 조회가능)
// 등록 안된 업장은 당월 매출만 조회가능
function btn_Exception_OnClick(obj:Button, e:ClickEventInfo)
{
	f_clkcnt++;
	
	// 설정버튼을 toggle로 설정한다.
	if(f_clkcnt%2 == 1){
		div_Exp.visible = true;
	}else{
		div_Exp.visible = false;
	}
	
	// 초기화
	ds_Exp.clearData();
		
	ds_Exp.addColumn("UPJANG", "INT",    256);
	ds_Exp.addColumn("USER",   "STRING", 256);
	
	ds_Exp.addRow();
	ds_Exp.setColumn(0, "UPJANG",  edt_UPJANGQuery.userdata);
	ds_Exp.setColumn(0, "USER",    g_EmpNo);	
	
	// action 정보 초기화 
    fsp_clear(this);  
	
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "ma/mas:MAS10140E_S008");

	// 서버 호출 

	http.Sync = true;
	fsp_callService(this, "", "", "ds_Exp=ds_Exp", "ds_list=ds_list", "", "");	
	http.Sync = false;

	div_Exp.chkNonMachul.value = ds_list.getColumn(0, "ABLE_YN");
		
}

// 미발행 매출 chkbox 클릭이벤트
function div_Exp_chkNonMachul_OnClick(obj:CheckBox, e:ClickEventInfo)
{
	if(edt_UPJANGQuery.value == ""){
		gfn_alert("업장을 선택해 주세요!");
		return;
	}
	
	if(div_Exp.chkNonMachul.value == true){
		if (! g_Confirm("02", '미발생 매출항목들을 조회가능하게 설정 하시겠습니까?')) return;
		// 초기화
		ds_Exp.clearData();
		
		ds_Exp.addColumn("UPJANG", "INT",    256);
		ds_Exp.addColumn("USER",   "STRING", 256);
	
		ds_Exp.addRow();
		ds_Exp.setColumn(0, "UPJANG",  edt_UPJANGQuery.userdata);
		ds_Exp.setColumn(0, "USER",    g_EmpNo);
		fsp_clear(this);
		
		fsp_addSingle(this, "ma/mas:MAS10140E_I007");
		
		http.Sync = true;
		
		// 서버 호출 
		fsp_callService(this, "", "", "ds_Exp=ds_Exp", "ds_list=ds_list",  "", "fn_CallBack_chkTrue()");
		
		http.Sync = false;
	}else{
		if (! g_Confirm("02", '당월 매출항목들만 조회가능하게 설정 하시겠습니까?')) return;
		// 초기화
		ds_Exp.clearData();
		
		ds_Exp.addColumn("UPJANG", "INT",    256);
		ds_Exp.addColumn("USER",   "STRING", 256);
	
		ds_Exp.addRow();
		ds_Exp.setColumn(0, "UPJANG",  edt_UPJANGQuery.userdata);
		ds_Exp.setColumn(0, "USER",    g_EmpNo);
		fsp_clear(this);
		
		fsp_addSingle(this, "ma/mas:MAS10140E_D003");
	
		http.Sync = true;
		
		// 서버 호출 
		fsp_callService(this, "", "", "ds_Exp=ds_Exp", "ds_list=ds_list",  "", "fn_CallBack_chkFalse()");
		
		http.Sync = false;	
	}
}

// 미발행 매출 chkbox 클릭이벤트 Callback함수
function fn_CallBack_chkTrue(errCode, errMsg){
	if (errCode != 0){
		g_Message("EE", errMsg);		
		return;
	}
}

// 미발행 매출 chkbox 클릭이벤트 Callback함수
function fn_CallBack_chkFalse(errCode, errMsg){
	if (errCode != 0){
		g_Message("EE", errMsg);		
		return;
	}
}
]]></Script>
  </Form>
</FDL>

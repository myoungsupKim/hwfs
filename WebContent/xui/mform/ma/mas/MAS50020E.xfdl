<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="MAS50020E" classname="SAMPLE01" inheritanceid="" position="absolute 0 0 1252 725" titletext="수거업체관리(본사)" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static21" class="sta_WFDA_Labelbg" position="absolute 1 553 1237 580" anchor="left top right"/>
        <Static id="Static49" class="sta_WFDA_Labelbg" position="absolute 1 527 1237 554" anchor="left top right"/>
        <Static id="Static37" class="sta_WFDA_Labelbg" position="absolute 0 579 1237 606" anchor="left top right"/>
        <Grid id="grd_list" taborder="4" binddataset="ds_list" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 0 102 1237 495" anchor="left top right" autofittype="col" formats="&lt;Formats&gt;&#10;  &lt;Format id=&quot;default&quot;&gt;&#10;    &lt;Columns&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;    &lt;/Columns&gt;&#10;    &lt;Rows&gt;&#10;      &lt;Row band=&quot;head&quot; size=&quot;24&quot;/&gt;&#10;      &lt;Row band=&quot;body&quot; size=&quot;24&quot;/&gt;&#10;    &lt;/Rows&gt;&#10;    &lt;Band id=&quot;head&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;순번&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;업체명&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;계약기간&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;계약금액&quot;/&gt;&#10;      &lt;Cell col=&quot;4&quot; disptype=&quot;normal&quot; text=&quot;업체담당자&quot;/&gt;&#10;      &lt;Cell col=&quot;5&quot; disptype=&quot;normal&quot; text=&quot;연락처&quot;/&gt;&#10;      &lt;Cell col=&quot;6&quot; disptype=&quot;normal&quot; text=&quot;수거량&quot;/&gt;&#10;      &lt;Cell col=&quot;7&quot; disptype=&quot;normal&quot; text=&quot;수거금액&quot;/&gt;&#10;      &lt;Cell col=&quot;8&quot; disptype=&quot;normal&quot; text=&quot;담당자&quot;/&gt;&#10;      &lt;Cell col=&quot;9&quot; disptype=&quot;normal&quot; text=&quot;연락처1&quot;/&gt;&#10;      &lt;Cell col=&quot;10&quot; disptype=&quot;normal&quot; text=&quot;팩스번호&quot;/&gt;&#10;      &lt;Cell col=&quot;11&quot; disptype=&quot;normal&quot; text=&quot;휴대전화&quot;/&gt;&#10;      &lt;Cell col=&quot;12&quot; disptype=&quot;normal&quot; text=&quot;이메일&quot;/&gt;&#10;      &lt;Cell col=&quot;13&quot; disptype=&quot;normal&quot; text=&quot;비고&quot;/&gt;&#10;    &lt;/Band&gt;&#10;    &lt;Band id=&quot;body&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;bind:순번&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;bind:업체명&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;bind:계약기간&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;bind:계약금액&quot;/&gt;&#10;      &lt;Cell col=&quot;4&quot; disptype=&quot;normal&quot; text=&quot;bind:업체담당자&quot;/&gt;&#10;      &lt;Cell col=&quot;5&quot; disptype=&quot;normal&quot; text=&quot;bind:연락처&quot;/&gt;&#10;      &lt;Cell col=&quot;6&quot; disptype=&quot;normal&quot; text=&quot;bind:수거량&quot;/&gt;&#10;      &lt;Cell col=&quot;7&quot; disptype=&quot;normal&quot; text=&quot;bind:수거금액&quot;/&gt;&#10;      &lt;Cell col=&quot;8&quot; disptype=&quot;normal&quot; text=&quot;bind:담당자&quot;/&gt;&#10;      &lt;Cell col=&quot;9&quot; disptype=&quot;normal&quot; text=&quot;bind:연락처1&quot;/&gt;&#10;      &lt;Cell col=&quot;10&quot; disptype=&quot;normal&quot; text=&quot;bind:팩스번호&quot;/&gt;&#10;      &lt;Cell col=&quot;11&quot; disptype=&quot;normal&quot; text=&quot;bind:휴대전화&quot;/&gt;&#10;      &lt;Cell col=&quot;12&quot; disptype=&quot;normal&quot; text=&quot;bind:이메일&quot;/&gt;&#10;      &lt;Cell col=&quot;13&quot; disptype=&quot;normal&quot; text=&quot;bind:비고&quot;/&gt;&#10;    &lt;/Band&gt;&#10;  &lt;/Format&gt;&#10;&lt;/Formats&gt;&#10;">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30"/>
                <Column size="214"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="91"/>
                <Column size="110"/>
                <Column size="110"/>
                <Column size="110"/>
                <Column size="110"/>
                <Column size="110"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" class="head_Excel" taborder="undefined"/>
                <Cell col="1" rowspan="2" text="업체명" taborder="undefined"/>
                <Cell col="2" rowspan="2" text="거래처 코드" taborder="undefined"/>
                <Cell col="3" colspan="2" text="계약기간" taborder="undefined"/>
                <Cell col="5" rowspan="2" text="단위" taborder="undefined"/>
                <Cell col="6" rowspan="2" text="계약금액" taborder="undefined"/>
                <Cell col="7" rowspan="2" text="업체담당자" taborder="undefined"/>
                <Cell col="8" rowspan="2" text="수거사업장수" taborder="undefined"/>
                <Cell col="9" rowspan="2" text="수거량" taborder="undefined"/>
                <Cell col="10" rowspan="2" text="수거금액" taborder="undefined"/>
                <Cell col="11" text="담당자"/>
                <Cell col="12" text="연락처1"/>
                <Cell col="13" text="팩스번호"/>
                <Cell col="14" text="휴대전화"/>
                <Cell col="15" text="이메일"/>
                <Cell col="16" text="비고"/>
                <Cell col="17" text="계약일"/>
                <Cell row="1" col="3" text="시작"/>
                <Cell row="1" col="4" text="종료"/>
                <Cell row="1" col="11"/>
                <Cell row="1" col="12"/>
                <Cell row="1" col="13"/>
                <Cell row="1" col="14"/>
                <Cell row="1" col="15"/>
                <Cell row="1" col="16"/>
                <Cell row="1" col="17"/>
              </Band>
              <Band id="body">
                <Cell celltype="none" style="align: ;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" text="bind:CUSTNM"/>
                <Cell col="2" displaytype="text" text="bind:CUSTCD"/>
                <Cell col="3" displaytype="date" text="bind:CONTRACT_TERM_START" calendardisplaynulltype="none"/>
                <Cell col="4" displaytype="date" text="bind:CONTRACT_TERM_END" calendardisplaynulltype="none"/>
                <Cell col="5" displaytype="combo" text="bind:CONTRACT_UNIT" combodataset="ds_contractUnitType" combocodecol="CODE" combodatacol="CODE_NAME"/>
                <Cell col="6" displaytype="number" text="bind:CONTRACT_AMT"/>
                <Cell col="7" text="bind:CONTRACT_PRCG_NM"/>
                <Cell col="8" displaytype="number" text="bind:UPJANG_CNT"/>
                <Cell col="9" displaytype="number" text="bind:REMV_QTY"/>
                <Cell col="10" displaytype="number" text="bind:REMV_AMT"/>
                <Cell col="11" text="bind:담당자"/>
                <Cell col="12" text="bind:연락처1"/>
                <Cell col="13" text="bind:팩스번호"/>
                <Cell col="14" text="bind:휴대전화"/>
                <Cell col="15" text="bind:이메일"/>
                <Cell col="16" text="bind:비고"/>
                <Cell col="17" text="bind:계약일"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="23" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static28" text="업체명" class="sta_WFSA_label" position="absolute 15 40 77 61" anchor="left top"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 93 40" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 93 71" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 60 40 70 61" anchor="left top"/>
        <Static id="Static22" text="수거업체 목록" class="sta_WF_Title01" position="absolute 0 84 450 102" anchor="left top"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 450 84" anchor="left top"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 97 450 102" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 311 40 341 61" anchor="left top"/>
        <Static id="Static00" text="계약일" class="sta_WFSA_label" position="absolute 341 40 403 61" anchor="left top"/>
        <Static id="Static01" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 386 40 396 61" anchor="left top"/>
        <Static id="Static18" text="수거업체 정보" class="sta_WF_Title01" position="absolute 0 509 450 527" anchor="left top"/>
        <Static id="Static19" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 494 450 509" anchor="left top"/>
        <Static id="Static20" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 522 450 527" anchor="left top"/>
        <Static id="Static26" text="업체명" class="sta_WFDA_Label01" position="absolute 92 527 186 554" anchor="left top"/>
        <Static id="Static50" text="계약일" class="sta_WFDA_Label01" position="absolute 446 527 540 554" anchor="left top"/>
        <Static id="Static70" class="sta_WFDA_Labelbg" position="absolute 92 605 1237 710" anchor="all"/>
        <Static id="Static73" text="비 고" class="sta_WFDA_Labelpoint" position="absolute 0 605 93 710" anchor="left top bottom"/>
        <TextArea id="txt_remark" taborder="22" scrollbars="fixedvert" position="absolute 95 608 1234 708" anchor="all" oneditclick="TextArea01_oneditclick" wordwrap="word"/>
        <Static id="Static03" text="~" position="absolute 304 556 330 577" style="align:center middle;"/>
        <Static id="Static25" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 1153 97 1237 102" anchor="top right"/>
        <Static id="Static12" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1153 71 1237 77" anchor="top right"/>
        <Static id="Static17" text="업체담당자" class="sta_WFDA_Label01" position="absolute 787 527 881 554" anchor="left top"/>
        <Static id="Static23" text="연락처" class="sta_WFDA_Label01" position="absolute 787 553 881 580" anchor="left top"/>
        <Static id="Static24" text="계약금액" class="sta_WFDA_Label01" position="absolute 446 553 540 580" anchor="left top"/>
        <Edit id="edt_contractPrcgNm" taborder="8" class="edt_WF_Essential" position="absolute 883 530 1233 551" anchor="left top"/>
        <Edit id="edt_contractCntcplce" taborder="15" position="absolute 883 556 1233 577" anchor="left top" style="align:left middle;"/>
        <Static id="Static30" text="계약정보" class="sta_WFDA_Label03" position="absolute 0 527 93 606" anchor="left top"/>
        <Static id="Static52" text="계약기간" class="sta_WFDA_Label01" position="absolute 92 553 186 580" anchor="left top"/>
        <MaskEdit id="msk_contractAmt" taborder="14" position="absolute 663 556 784 577" mask="#,###" class="msk_WF_Essential"/>
        <Combo id="cbo_contractUnit" taborder="13" innerdataset="ds_contractUnitType" codecolumn="CODE" datacolumn="CODE_NAME" index="0" onitemchanged="Combo00_onitemchanged" position="absolute 542 556 660 577" value="0" text="선택" class="cmb_WF_Essential"/>
        <Button id="btn_linkUpjang" taborder="24" text="수거 사업장 등록" class="btn_WF_Function" position="absolute 1130 77 1237 97" anchor="top right" onclick="btn_linkUpjang_onclick"/>
        <Static id="Static29" text="계약서" class="sta_WFDA_Label01" position="absolute 92 579 186 606" anchor="left top"/>
        <Edit id="edt_orgnlFileNm" taborder="21" position="absolute 188 582 640 603" anchor="left top" style="align:left middle;"/>
        <Button id="btn_attachFile" taborder="25" text="계약서첨부" class="btn_WF_Custom" position="absolute 642 582 719 603" anchor="left top" onclick="btn_attachFile_onclick"/>
        <MaskEdit id="msk_selContractDd" taborder="2" type="string" mask="####-##-##" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" oneditclick="g_Date_OnFocus" position="absolute 396 40 474 61"/>
        <Button id="btn_selContractDd" taborder="3" tabstop="false" onclick="g_CalButton_OnClick" class="btn_WF_cal" position="absolute 473 40 494 61" userdata="msk_selContractDd"/>
        <MaskEdit id="msk_contractDd" taborder="7" type="string" mask="####-##-##" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" oneditclick="g_Date_OnFocus" position="absolute 542 530 640 551" style="align:center middle;" class="msk_WF_EssentialCal"/>
        <Button id="btn_contractDd" taborder="26" tabstop="false" class="btn_WF_calEssential" position="absolute 639 530 660 551" userdata="msk_contractDd" onclick="g_CalButton_OnClick"/>
        <MaskEdit id="msk_contractTermStart" taborder="9" type="string" mask="####-##-##" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" oneditclick="g_Date_OnFocus" class="msk_WF_EssentialCal" position="absolute 188 556 286 577" style="align:center middle;" autoselect="true"/>
        <Button id="btn_contractTermStart" taborder="10" tabstop="false" onclick="g_CalButton_OnClick" class="btn_WF_calEssential" position="absolute 285 556 306 577" userdata="msk_contractTermStart"/>
        <MaskEdit id="msk_contractTermEnd" taborder="11" type="string" mask="####-##-##" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" oneditclick="g_Date_OnFocus" class="msk_WF_EssentialCal" position="absolute 326 556 424 577" style="align:center middle;" autoselect="true"/>
        <Button id="btn_contractTermEnd" taborder="12" tabstop="false" onclick="g_CalButton_OnClick" class="btn_WF_calEssential" position="absolute 423 556 444 577" userdata="msk_contractTermEnd"/>
        <MPFileDialog id="fileDialog" taborder="28" visible="false" position="absolute 1263 8 1287 32" FileName="" FileNameList="" FilePath="" UserData="" MultiSelect="false" Filter="ALL File(*.*)|*.*" FilterIndex="0" AppendExtDefault="false" Type="Open" FileSize=""/>
        <Button id="btn_downFile" taborder="29" text="다운로드" class="btn_WF_Custom" position="absolute 721 582 787 603" anchor="left top" onclick="btn_downFile_onclick"/>
        <CustSearchComponent id="edt_custCond" titletext="거래처 검색용 Component" taborder="30" text="CustSearchComponent00" position="absolute 70 40 311 61" bindDataset="ds_cond" eventBeforeTrigger="" eventAfterTrigger="" bindCustCodeColumn="CUSTCD" bindCustNameColumn="CUSTNM"/>
        <CustSearchComponent id="edt_cust" titletext="거래처 검색용 Component" taborder="31" text="CustSearchComponent00" position="absolute 188 530 444 551" bindDataset="ds_list" eventBeforeTrigger="" eventAfterTrigger="" bindCustCodeColumn="CUSTCD" bindCustNameColumn="CUSTNM" class="edt_WF_Essential"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_list_onrowposchanged" oncolumnchanged="ds_list_oncolumnchanged">
        <ColumnInfo>
          <Column id="CUSTCD" type="STRING" size="256"/>
          <Column id="CUSTNM" type="STRING" size="256"/>
          <Column id="CONTRACT_TERM_START" type="STRING" size="256"/>
          <Column id="CONTRACT_TERM_END" type="STRING" size="256"/>
          <Column id="CONTRACT_TERM" type="STRING" size="256"/>
          <Column id="CONTRACT_UNIT" type="STRING" size="256"/>
          <Column id="CONTRACT_AMT" type="STRING" size="256"/>
          <Column id="CONTRACT_PRCG_NM" type="STRING" size="256"/>
          <Column id="CONTRACT_CNTCPLCE" type="STRING" size="256"/>
          <Column id="CONTRACT_DD" type="STRING" size="256"/>
          <Column id="ORGNL_FILE_NM" type="STRING" size="256"/>
          <Column id="SVR_FILE_NM" type="STRING" size="256"/>
          <Column id="UPJANG_CNT" type="STRING" size="256"/>
          <Column id="REMV_QTY" type="STRING" size="256"/>
          <Column id="REMV_AMT" type="STRING" size="256"/>
          <Column id="REMARK" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cond">
        <ColumnInfo>
          <Column id="CUSTCD" type="STRING" size="256"/>
          <Column id="CUSTNM" type="STRING" size="256"/>
          <Column id="CONTRACT_DD" type="STRING" size="256"/>
          <Column id="CONTRACT_TERM_START" type="STRING" size="256"/>
          <Column id="CONTRACT_TERM_END" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CUSTCD" type="STRING" size="256"/>
          <Column id="CUSTNM" type="STRING" size="256"/>
          <Column id="CONTRACT_TERM_START" type="STRING" size="256"/>
          <Column id="CONTRACT_TERM_END" type="STRING" size="256"/>
          <Column id="CONTRACT_TERM" type="STRING" size="256"/>
          <Column id="CONTRACT_UNIT" type="STRING" size="256"/>
          <Column id="CONTRACT_AMT" type="STRING" size="256"/>
          <Column id="CONTRACT_PRCG_NM" type="STRING" size="256"/>
          <Column id="CONTRACT_CNTCPLCE" type="STRING" size="256"/>
          <Column id="CONTRACT_DD" type="STRING" size="256"/>
          <Column id="C_PER_NAME" type="STRING" size="256"/>
          <Column id="C_PER_TELNO" type="STRING" size="256"/>
          <Column id="C_PART_FAX" type="STRING" size="256"/>
          <Column id="C_PER_HPNO" type="STRING" size="256"/>
          <Column id="C_PER_EMAIL" type="STRING" size="256"/>
          <Column id="ORGNL_FILE_NM" type="STRING" size="256"/>
          <Column id="SVR_FILE_NM" type="STRING" size="256"/>
          <Column id="UPJANG_CNT" type="STRING" size="256"/>
          <Column id="REMV_QTY" type="STRING" size="256"/>
          <Column id="REMV_AMT" type="STRING" size="256"/>
          <Column id="REMARK" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CUSTCD"/>
            <Col id="CUSTNM">title:업체명,required:true</Col>
            <Col id="CONTRACT_TERM_START">title:계약기간FROM,required:true</Col>
            <Col id="CONTRACT_TERM_END">title:계약기간TO,required:true</Col>
            <Col id="CONTRACT_UNIT">title:단위,required:true</Col>
            <Col id="CONTRACT_AMT">title:계약금액,required:true</Col>
            <Col id="CONTRACT_PRCG_NM">title:업체담당자,required:true</Col>
            <Col id="CONTRACT_DD">title:계약일,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_contractUnitType">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_dupChk" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CNT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item1" compid="edt_contractPrcgNm" propid="value" datasetid="ds_list" columnid="CONTRACT_PRCG_NM"/>
      <BindItem id="item5" compid="edt_contractCntcplce" propid="value" datasetid="ds_list" columnid="CONTRACT_CNTCPLCE"/>
      <BindItem id="item11" compid="txt_remark" propid="value" datasetid="ds_list" columnid="REMARK"/>
      <BindItem id="item4" compid="msk_contractAmt" propid="value" datasetid="ds_list" columnid="CONTRACT_AMT"/>
      <BindItem id="item13" compid="cbo_contractUnit" propid="value" datasetid="ds_list" columnid="CONTRACT_UNIT"/>
      <BindItem id="item14" compid="edt_orgnlFileNm" propid="value" datasetid="ds_list" columnid="ORGNL_FILE_NM"/>
      <BindItem id="item2" compid="msk_contractDd" propid="value" datasetid="ds_list" columnid="CONTRACT_DD"/>
      <BindItem id="item3" compid="msk_contractTermStart" propid="value" datasetid="ds_list" columnid="CONTRACT_TERM_START"/>
      <BindItem id="item12" compid="msk_contractTermEnd" propid="value" datasetid="ds_list" columnid="CONTRACT_TERM_END"/>
      <BindItem id="item17" compid="msk_selContractDd" propid="value" datasetid="ds_cond" columnid="CONTRACT_DD"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
 ******************************************************************************************
 * 시스템구분   : IFIS/영업관리/폐식용유관리/수거업체관리(본사)
 * 프로그램명   : MAS50020E.xfdl
 * 기      능   : 수거업체관리(본사)
 * 작  성  자   : 김경은
 * 작성  일자   : 2015-02-04
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */

//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
include "U_lib::lib_conversionCom.xjs";

//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var serverSaveDir = "MAS_DOC";					        // 파일패스
var serverSaveUrl = fsp_getServerDir(serverSaveDir);	// 파일패스URL
var oldStDt;
var oldEdDt;

//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//========================================================================================= 
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, true);

	fsp_init(this);	
	
	fn_init();
}


//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_search()
{
	// 변경여부 확인
	if (gfn_dsIsUpdated(ds_list)) 
	{
		if ( !g_Confirm("02", '변경된 데이타가 있습니다. 무시하고 재조회하시겠습니까?!') ) return;
	}
	
	var actionName, cmdName, inData, outData, otherArg, callBackFnc, trId;	
	
	ds_list.clearData();
	
	inData			= "ds_cond=ds_cond";
	outData			= "ds_list=ds_list";
	callBackFnc		= "fn_callBack";	
    trId            = "SELECT"; 
    
	fsp_clear(this); 
    fsp_addSearch(this, "ma/mas:MAS50020E_S001");									
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc,"","","",trId);
   
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Insert()
 * 기      능   : [등록버튼] 등록 버튼 클릭 시 처리되는 작업
 ******************************************************************************************
 */
function fn_insert()
{
	ds_list.addRow();
	msk_contractDd.value = gfn_today();
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Save()
 * 기      능   : [저장버튼] 저장 버튼 클릭 시 처리되는 작업
 ******************************************************************************************
 */
function fn_save()
{
	// 변경여부 확인
	if( gfn_dsIsUpdated(ds_list) == false )
	{
		g_Message("EE", "변경된 데이터가 없습니다.");
		return;
	}
	
	// 유효성 검사
	if ( gfn_validCheck(ds_list, ds_listValid, true) == false ) return;
	
	if ( !g_Confirm("02", "저장하시겠습니까?") ) return;
	
	// 파일 업로드
	if ( !fn_fileUpload() )
	{
		gfn_alert("파일 업로드에 실패하였습니다.");
		return;
	}

	// 서비스셋팅
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	var insertSql, updateSql, deleteSql,saveFlagColumn, keySqlName, keyIncrement, callbackSql;    

	inData		= "ds_list=ds_list:U";
	outData		= "";
	callBackFnc	= "fn_callBack";
	insertSql 	= "ma/mas:MAS50020E_I001";
	updateSql	= "ma/mas:MAS50020E_U001";
	deleteSql	= "ma/mas:MAS50020E_D001";
	
	fsp_clear(this);
	fsp_addSave(this, insertSql, updateSql, deleteSql,saveFlagColumn, keySqlName);
	fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc,"","","","SAVE");		
}

/* 
 ******************************************************************************************
 * 함  수  명   : fn_Delete()
 * 기      능   : [삭제버튼] 삭제 시 처리되는 작업
 ******************************************************************************************
 */
function fn_delete()
{
	var nRow = ds_list.rowposition;
	if(Number(ds_list.getColumn(nRow, "UPJANG_CNT")) > 0 || Number(ds_list.getColumn(nRow, "REMV_QTY")) > 0)
	{
		g_Message("EE", "수거사업장 또는 수거량이 존재할 경우 삭제가 불가합니다.");
		return;
	}
	ds_list.deleteRow();
}

/* 
 ******************************************************************************************
 * 함  수  명   : fn_checkDate()
 * 기      능   : [삭제버튼] 삭제 시 처리되는 작업
 ******************************************************************************************
 */
function fn_dupCheck(stDt, edDt)
{
	var actionName, cmdName, inData, outData, otherArg, callBackFnc, trId;	
	
	inData			= "ds_cond=ds_cond";
	outData			= "ds_dupChk=ds_dupChk";
	callBackFnc		= "fn_callBack";	
    trId            = "DUPCHECK"; 
    
	fsp_clear(this); 
    fsp_addSearch(this, "ma/mas:MAS50020E_S002");
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc,"","","",trId);
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================

/*-----------------------------------------------------------------------------------------
 * 설명      : 화면 처음 로딩시 설정 셋팅
 *----------------------------------------------------------------------------------------*/
function fn_init()
{
	ds_cond.clearData();
	ds_cond.addRow();	

	// 계약일 셋팅
	//ds_cond.setColumn(0, "CONTRACT_DD", gfn_today());
	
	//공통코드조회
	//계약단위
	var objCode = fn_common_code("'MA0138'","","","","Y");
	var sCond = "GROUP_CODE == 'MA0138'";
	objCode.filter(sCond);
	CopyF(ds_contractUnitType, objCode.name);
}

/*-----------------------------------------------------------------------------------------
 * 설명      : callBack 함수
 *----------------------------------------------------------------------------------------*/
function fn_callBack(errCode, errMsg, trId)
{	
	if( errCode != 0 )
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오.");
		return;
	}
	else
	{
		if ( trId == "SELECT" )
		{
		
		} 
		else if ( trId == "SAVE" )
		{
			fn_search();
		}
	}
}

/*-----------------------------------------------------------------------------------------
 * 설명      : 파일 업로드 함수
 *----------------------------------------------------------------------------------------*/
function fn_fileUpload()
{	
	for ( i=0; i<ds_list.getRowCount(); i++ ) 
	{
		if ( (ds_list.getRowType(i) == 2 || ds_list.getRowType(i) == 4) && gfn_isUpdateColumn(ds_list, i, "ORGNL_FILE_NM") )
		{
			// 파일 서버로 전송 
			var vArr = fsp_fileWrite(httpFile, serverSaveDir, ds_list.getColumn(i, "FILE_PATH"), ds_list.getColumn(i, "ORGNL_FILE_NM"));
			
			// 처리 결과 확인하기 
			if( vArr[0] == "S" ) 	// 성공 
			{
				ds_list.setColumn(ds_list.rowposition, "SVR_FILE_NM", vArr[2]);
			} else {
				return false;
			}
		}
	}
	
	return true;
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
/*-----------------------------------------------------------------------------------------
 * 설명      : 계약서첨부 버튼 클릭시 이벤트
 *----------------------------------------------------------------------------------------*/
function btn_attachFile_onclick(obj:Button,  e:ClickEventInfo)
{
	// 서버로 전송 할 파일 선택하기 
	var vRtn = fileDialog.Open();
	
	if ( vRtn )
	{
		// 파일 사이즈 체크 로직 필요? fileDialog.FileSize
		ds_list.setColumn(ds_list.rowposition, "ORGNL_FILE_NM", fileDialog.FileName);
		ds_list.setColumn(ds_list.rowposition, "FILE_PATH", fileDialog.FilePath);
	}
}

/*-----------------------------------------------------------------------------------------
 * 설명      : 수거사업장등록 버튼 클릭시 이벤트
 *----------------------------------------------------------------------------------------*/
function btn_linkUpjang_onclick(obj:Button,  e:ClickEventInfo)
{
	if ( grd_list.selectendrow > -1 )
	{
		var	vArg = new Array();
		var	vRtn = "";
		
		vArg["fa_custCd"] = ds_list.getColumn(ds_list.rowposition, "CUSTCD");
		vArg["fa_custNm"] = ds_list.getColumn(ds_list.rowposition, "CUSTNM");
		vArg["fa_contractDd"] = ds_list.getColumn(ds_list.rowposition, "CONTRACT_DD");
		vArg["fa_contractTermStart"] = ds_list.getColumn(ds_list.rowposition, "CONTRACT_TERM_START");
		vArg["fa_contractTermEnd"] = ds_list.getColumn(ds_list.rowposition, "CONTRACT_TERM_END");
		
		vRtn = gfn_dialog("", "U_MAS::MAS50021P.xfdl", vArg);
		
		if ( vRtn == "Y" )
		{
			fn_search();
		}
	}
	else
	{
		g_Message("EE", "수거업체 조회 후 선택해주세요.");
	}
}

/*-----------------------------------------------------------------------------------------
 * 설명      : 다운로드 버튼 클릭시 이벤트
 *----------------------------------------------------------------------------------------*/
function btn_downFile_onclick(obj:Button,  e:ClickEventInfo)
{
	var vArr = fsp_fileRead(httpFile, serverSaveDir, ds_list.getColumn(ds_list.rowposition, "SVR_FILE_NM"), "", ds_list.getColumn(ds_list.rowposition, "ORGNL_FILE_NM"));
	
	if ( vArr[0] == "E" )
	{
		gfn_alert(vArr[1]);
		return;
	}
	
	gfn_alert("파일 다운로드가 완료되었습니다.");
}

/*-----------------------------------------------------------------------------------------
 * 설명      : 그리드 데이터셋 변경시 이벤트
 *----------------------------------------------------------------------------------------*/
function ds_list_onrowposchanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	if ( ds_list.getRowType(ds_list.rowposition) == 2 ) 
	{
		edt_cust.enable = true;
		msk_contractDd.enable = true;
		btn_contractDd.enable = true;
		btn_contractDd.class = "btn_WF_calEssential";
	} else {
		edt_cust.enable = false;
		msk_contractDd.enable = false;
		btn_contractDd.enable = false;
		btn_contractDd.class = "btn_WF_cal";
	}
}

/*-----------------------------------------------------------------------------------------
 * 설명      : 그리드 데이터셋 컬럼변경시 이벤트
 *----------------------------------------------------------------------------------------*/
function ds_list_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	switch(e.columnid)
	{
		case "CONTRACT_TERM_START" :	//시작일
		case "CONTRACT_TERM_END"   :	//종료일
		
			var actionName, cmdName, inData, outData, otherArg, callBackFnc, trId;
			var nDupCnt = 0;
			var sStDt   = ds_list.getColumn(e.row, "CONTRACT_TERM_START");
			var sEdDt   = ds_list.getColumn(e.row, "CONTRACT_TERM_END");
			var sContDD = ds_list.getColumn(e.row, "CONTRACT_DD");
			var sCustCd = ds_list.getColumn(e.row, "CUSTCD");
			
			if(!gfn_isNull(sStDt) && !gfn_isNull(sEdDt) && !gfn_isNull(sCustCd))
			{
				ds_cond.setColumn(0, "CONTRACT_TERM_START", sStDt);
				ds_cond.setColumn(0, "CONTRACT_TERM_END"  , sEdDt);
				ds_cond.setColumn(0, "CONTRACT_DD"        , sContDD);
				ds_cond.setColumn(0, "CUSTCD"             , sCustCd);
				
				inData			= "ds_cond=ds_cond";
				outData			= "ds_dupChk=ds_dupChk";
				callBackFnc		= "fn_callBack";	
				trId            = "DUPCHECK"; 
				
				fsp_clear(this); 
				fsp_addSearch(this, "ma/mas:MAS50020E_S002");
				fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc,"","",true,trId);
				
				if(ds_dupChk.rowcount < 1) return;
				
				nDupCnt = ds_dupChk.getColumn(0, "CNT");
				
				if(nDupCnt > 0)
				{
					g_Message("EE", "중복되는 계약기간입니다.\n계약기간을 확인해주세요");
					obj.setColumn(e.row, e.columnid, e.oldvalue);
					if(e.columnid == "CONTRACT_TERM_START")
						msk_contractTermStart.setFocus();
					else
						msk_contractTermEnd.setFocus();
					return false;
				}
			}
			break;		
	}
}
]]></Script>
  </Form>
</FDL>

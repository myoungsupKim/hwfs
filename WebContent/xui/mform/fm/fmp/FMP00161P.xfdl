<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FMP00161P" onkeydown="fn_FormKeyDown" onload="form_onload" ontimer="FMP00161P_OnTimer" titletext="주요상품 검색" position="absolute 0 0 950 590" scrollbars="none" onactivate="FMP00161P_onactivate" ondeactivate="FMP00161P_ondeactivate">
    <Layouts>
      <Layout>
        <Static id="Static10" class="sta_WFDA_Labelbg" position="absolute 674 40 935 67"/>
        <Tab id="tab_list" onchanged="tab_list_OnChanged" preload="true" taborder="2" position="absolute 15 82 935 575" showextrabutton="false" canchange="tab_list_canchange" anchor="all">
          <Tabpages>
            <Tabpage id="tab1" taborder="1" text="주요상품" position="absolute 2 24 759 456" scrollbars="none">
              <Layouts>
                <Layout>
                  <Static id="Static02" class="sta_WFDA_Labelbg" position="absolute 102 10 909 37"/>
                  <Grid autoenter="select" binddataset="ds_List1" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="gd_list" useinputpanel="false" selecttype="row" oncellclick="gd_list_OnCellClick" oncelldblclick="tab_list_tab1_gd_list_OnCellDblClick" onselectchanged="tab_list_tab1_gd_list_OnCellPosChanged" onheadclick="gd_list_OnHeadClick" taborder="11" tabstop="true" usecontextmenu="true" visible="true" wheelscrollrow="1" position="absolute 10 42 908 455" autofittype="col" anchor="all">
                    <Formats>
                      <Format id="Default">
                        <Columns>
                          <Column size="23"/>
                          <Column size="59"/>
                          <Column size="85"/>
                          <Column size="120"/>
                          <Column size="100"/>
                          <Column size="0"/>
                          <Column size="38"/>
                          <Column size="55"/>
                          <Column size="58"/>
                          <Column size="50"/>
                          <Column size="64"/>
                          <Column size="64"/>
                          <Column size="64"/>
                          <Column size="63"/>
                          <Column size="0"/>
                          <Column size="26"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                          <Row size="22" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="중분류"/>
                          <Cell col="2" displaytype="text" text="상품코드"/>
                          <Cell col="3" displaytype="text" text="상품명"/>
                          <Cell col="4" displaytype="text" text="규격"/>
                          <Cell col="5" displaytype="text" text="원산지"/>
                          <Cell col="6" displaytype="text" text="단위"/>
                          <Cell col="7" displaytype="text" text="판매단가"/>
                          <Cell col="8" displaytype="text" style="align:center;" text="마감일"/>
                          <Cell col="9" displaytype="text" text="수량"/>
                          <Cell col="10" displaytype="text" text="금액"/>
                          <Cell col="11" text="부가세"/>
                          <Cell col="12" text="합계"/>
                          <Cell col="13" displaytype="text" text="비고"/>
                          <Cell col="14" displaytype="text" text="발주가능여부"/>
                          <Cell col="15" displaytype="text" text="사진"/>
                        </Band>
                        <Band id="body">
                          <Cell celltype="head" displaytype="text" style="align:right;background:EXPR(iif(GUBUN=='1', iif(PR_QTY == '0','white','yellow'), 'thistle')));" expr="expr:currow + 1"/>
                          <Cell col="1" displaytype="text" style="align:left;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));" text="bind:CLASS_NAME3"/>
                          <Cell col="2" displaytype="text" style="align:center;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));" text="bind:ITEM_CODE"/>
                          <Cell col="3" displaytype="text" style="align:left;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));" text="bind:ITEM_NAME"/>
                          <Cell col="4" displaytype="text" style="align:left;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));" text="bind:ITEM_SIZE"/>
                          <Cell col="5" displaytype="text" style="align:left;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));" text="bind:ORIGIN_TYPE"/>
                          <Cell col="6" displaytype="text" style="align:center;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));" text="bind:PO_UOM"/>
                          <Cell col="7" displaytype="number" style="background:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));" text="bind:OP_PRICE" mask="#,##0"/>
                          <Cell col="8" displaytype="text" style="align:center;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));" text="bind:D_DAY_DISP"/>
                          <Cell col="9" displaytype="number" edittype="expr:setEditExpr(iif(GUBUN == '1', 'number', 'none'))" editfilter="expr:setfilterExpr(iif(GUBUN == '1', 'number', 'none'))" style="background:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));" text="bind:PR_QTY" mask="#,##0.0" editlimit="10" editautoselect="true"/>
                          <Cell col="10" displaytype="number" style="background:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));" text="bind:OP_AMOUNT" mask="#,##0"/>
                          <Cell col="11" displaytype="number" style="background:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));" expr="expr:Math.round(iif(TAX_CODE==&quot;100&quot;,0.1,0)* OP_AMOUNT)" mask="#,##0"/>
                          <Cell col="12" displaytype="number" style="background:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));" expr="expr:Math.round(iif(TAX_CODE==&quot;100&quot;,1.1,1)* OP_AMOUNT)" mask="#,##0"/>
                          <Cell col="13" displaytype="text" edittype="normal" style="align:left;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));" text="bind:PR_REMARK" editimemode="native" editautoselect="true"/>
                          <Cell col="14" displaytype="text" style="align:left;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));" text="bind:GUBUN" editimemode="native"/>
                          <Cell col="15" displaytype="text" style="align:center;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &lt;&gt; 0 || gfn_isNull(PR_QTY),'lightyellow','white'), 'thistle'));" text="bind:IMG_YN"/>
                        </Band>
                        <Band id="summary">
                          <Cell displaytype="text" style="align:left;"/>
                          <Cell col="1" displaytype="text" style="align:center;"/>
                          <Cell col="2" displaytype="text" style="align:center;"/>
                          <Cell col="3" displaytype="text" style="align:left;"/>
                          <Cell col="4" displaytype="text" style="align:center;" taborder="undefined"/>
                          <Cell col="5" displaytype="text" style="align:center;" text="발주건수" taborder="undefined"/>
                          <Cell col="6" displaytype="number" style="align: ;" expr="expr:expr:getCaseCount(&quot;PR_QTY&gt;0&quot;)" mask="#,##0"/>
                          <Cell col="7" displaytype="text" style="align:center;" text="합  계"/>
                          <Cell col="8" displaytype="text" style="align:center;"/>
                          <Cell col="9" displaytype="number" style="align: ;" expr="expr:getSum(&quot;PR_QTY&quot;)" mask="#,##0.0"/>
                          <Cell col="10" displaytype="number" style="align: ;" expr="expr:getSum(&quot;OP_AMOUNT&quot;)" mask="#,##0"/>
                          <Cell col="11" displaytype="number" expr="expr:getCaseSum(&quot;TAX_CODE=='100'&quot;,&quot;Math.round(OP_AMOUNT/10)&quot;)" mask="#,##0"/>
                          <Cell col="12" displaytype="number" expr="expr:getSum(&quot;Math.round(iif(TAX_CODE=='100',1.1,1)* OP_AMOUNT)&quot;)" mask="#,##0"/>
                          <Cell col="13" displaytype="text" style="align:left;" text="(VAT별도)"/>
                          <Cell col="14" displaytype="text" style="align:left;" text="(VAT별도)"/>
                          <Cell col="15" displaytype="text" style="align:left;"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Edit autoselect="true" id="ed_Item" imemode="hangul" onkeydown="ed_Item_OnKeyDown" taborder="7" position="absolute 105 13 546 34"/>
                  <Button id="btn_search" onclick="btn_search_OnClick" onkeydown="btn_search_OnKeyDown" taborder="7" tabstop="false" text="검색" position="absolute 853 13 906 34" class="btn_WF_Find" image=""/>
                  <Static id="st_Otcust" text="상품명" position="absolute 10 10 103 37" class="sta_WFDA_Label01"/>
                  <Static id="Static7" text="즐겨찾기 그룹" position="absolute 548 10 652 37" class="sta_WFDA_Label03"/>
                  <Combo codecolumn="FAVOR_GROUP" datacolumn="FAVOR_NAME" displayrowcount="10" id="cbo_groupList" index="0" innerdataset="ds_groupList" onitemchanged="cbo_groupList_OnChanged" taborder="8" position="absolute 654 13 851 34"/>
                  <Static id="Static13" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 759 10" anchor="left bottom"/>
                  <Static id="Static12" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 10 465" anchor="top right"/>
                  <Static id="Static00" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 908 0 918 465" anchor="top right"/>
                  <Static id="Static21" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 37 749 42"/>
                  <Static id="Static01" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 455 759 465" anchor="left bottom"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tab2" taborder="5" text="지난발주 복사" position="absolute 2 24 759 456" scrollbars="none">
              <Layouts>
                <Layout>
                  <Static id="Static02" class="sta_WFDA_Labelbg" position="absolute 89 10 908 37"/>
                  <Button id="btn_search" onclick="btn_search_OnClick" onkeydown="btn_search_OnKeyDown" taborder="5" tabstop="false" text="검색" position="absolute 852 12 905 34" class="btn_WF_Find" image=""/>
                  <Static id="st_Otcust" text="입고일자" position="absolute 652 10 740 37" class="sta_WFDA_Label01"/>
                  <Grid autoenter="select" binddataset="ds_List2" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="gd_list" useinputpanel="false" oncellclick="gd_list_OnCellClick" oncelldblclick="tab_list_tab1_gd_list_OnCellDblClick" onselectchanged="tab_list_tab1_gd_list_OnCellPosChanged" onheadclick="gd_list_OnHeadClick" taborder="6" tabstop="true" usecontextmenu="true" visible="true" wheelscrollrow="1" position="absolute 10 42 908 455" selecttype="row" autofittype="col" anchor="all">
                    <Formats>
                      <Format id="Default">
                        <Columns>
                          <Column size="23"/>
                          <Column size="0"/>
                          <Column size="80"/>
                          <Column size="120"/>
                          <Column size="100"/>
                          <Column size="0"/>
                          <Column size="40"/>
                          <Column size="70"/>
                          <Column size="80"/>
                          <Column size="50"/>
                          <Column size="80"/>
                          <Column size="100"/>
                          <Column size="30"/>
                          <Column size="100"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="24"/>
                          <Row size="22" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="대분류"/>
                          <Cell col="2" displaytype="text" text="상품코드"/>
                          <Cell col="3" displaytype="text" text="상품명"/>
                          <Cell col="4" displaytype="text" text="규격"/>
                          <Cell col="5" displaytype="text" text="원산지"/>
                          <Cell col="6" displaytype="text" text="단위"/>
                          <Cell col="7" displaytype="text" text="판매단가"/>
                          <Cell col="8" displaytype="text" style="align:center;" text="마감일"/>
                          <Cell col="9" displaytype="text" text="수량"/>
                          <Cell col="10" displaytype="text" text="금액"/>
                          <Cell col="11" displaytype="text" text="비고"/>
                          <Cell col="12" displaytype="text" text="사진"/>
                          <Cell col="13" displaytype="text" text="발주가능여부"/>
                        </Band>
                        <Band id="body">
                          <Cell celltype="head" displaytype="text" style="align:right;background:EXPR(iif(GUBUN=='1', iif(PR_QTY == '0','white','yellow'), 'thistle')));" expr="expr:currow + 1"/>
                          <Cell col="1" displaytype="text" style="background:EXPR(iif(GUBUN=='1', iif(PR_QTY == '0','white','yellow'), 'thistle')));align:left;" text="bind:CLASS_NAME3"/>
                          <Cell col="2" displaytype="text" style="align:center;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));" text="bind:ITEM_CODE"/>
                          <Cell col="3" displaytype="text" style="align:left;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));" text="bind:ITEM_NAME"/>
                          <Cell col="4" displaytype="text" style="align:left;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));" text="bind:ITEM_SIZE"/>
                          <Cell col="5" displaytype="text" style="align:left;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));" text="bind:ORIGIN_TYPE"/>
                          <Cell col="6" displaytype="text" style="align:center;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));" text="bind:PO_UOM"/>
                          <Cell col="7" displaytype="number" style="background:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));" text="bind:OP_PRICE" mask="#,##0"/>
                          <Cell col="8" displaytype="text" style="align:center;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));" text="bind:D_DAY_DISP"/>
                          <Cell col="9" displaytype="number" edittype="expr:setEditExpr(iif(GUBUN == '1', 'number', 'none'))" editfilter="expr:setfilterExpr(iif(GUBUN == '1', 'number', 'none'))" style="background:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));" text="bind:PR_QTY" mask="#,##0.0" editlimit="10" editautoselect="true"/>
                          <Cell col="10" displaytype="number" style="background:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));" text="bind:OP_AMOUNT" mask="#,##0"/>
                          <Cell col="11" displaytype="text" edittype="normal" style="align:left;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));" text="bind:PR_REMARK" editimemode="native" editautoselect="true"/>
                          <Cell col="12" displaytype="text" style="align:center;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));" text="bind:IMG_YN"/>
                          <Cell col="13" displaytype="text" edittype="normal" style="align:left;background:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));background2:EXPR(iif(GUBUN=='1', iif(PR_QTY &gt; 0,'lightyellow','white'), 'thistle'));" text="bind:PR_REMARK" editimemode="native"/>
                        </Band>
                        <Band id="summary">
                          <Cell displaytype="text" style="align:left;"/>
                          <Cell col="1" displaytype="text" style="align:center;"/>
                          <Cell col="2" displaytype="text" style="align:center;"/>
                          <Cell col="3" displaytype="text" style="align:left;"/>
                          <Cell col="4" displaytype="text" style="align:center;" taborder="undefined"/>
                          <Cell col="5" displaytype="text" style="align:center;" text="발주건수" taborder="undefined"/>
                          <Cell col="6" displaytype="number" style="align: ;" expr="expr:getCaseCount(&quot;PR_QTY&gt;0&quot;)" mask="#,##0"/>
                          <Cell col="7" displaytype="text" style="align:center;" text="합  계"/>
                          <Cell col="8" displaytype="text" style="align:center;"/>
                          <Cell col="9" displaytype="number" style="align: ;" expr="expr:getSum(&quot;PR_QTY&quot;)" mask="#,##0.0"/>
                          <Cell col="10" displaytype="number" style="align: ;" expr="expr:getSum(&quot;OP_AMOUNT&quot;)" mask="#,##0"/>
                          <Cell col="11" displaytype="text" style="align:left;" text="(VAT별도)"/>
                          <Cell col="12" displaytype="text" style="align:left;"/>
                          <Cell col="13" displaytype="text" style="align:left;" text="(VAT별도)"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <MaskEdit id="me_NeedDateP" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkeydown="ed_Item_OnKeyDown" onkillfocus="g_Date_OnKillFocus" taborder="3" type="string" position="absolute 742 13 842 34" class="msk_WF_Cal"/>
                  <Button id="btn_NeedDateP" onclick="g_CalButton_OnClick" taborder="4" tabstop="false" text="" userdata="tab_list.tab2.me_NeedDateP" position="absolute 821 13 842 34" class="btn_WF_cal" image=""/>
                  <Static id="st_UpjangP" text="사업장" userdata="strQuery_FMUpjang" position="absolute 10 9 98 36" class="sta_WFDA_Label01"/>
                  <Edit autoselect="true" id="ed_UpjangP" imemode="native" onkeydown="fn_edBtn_OnKeyDown" readonly="true" taborder="1" position="absolute 100 13 282 34"/>
                  <Button id="btn_UpjangP" onclick="fn_edBtn_OnClick" taborder="1" tabstop="false" text="" position="absolute 281 13 302 34" class="btn_WF_popSearch" image=""/>
                  <Static id="Static6" text="식당(창고)" position="absolute 304 10 392 37" class="sta_WFDA_Label01"/>
                  <Combo codecolumn="SUBINV_CODE" datacolumn="SUBINV_NAME" displayrowcount="10" id="cbo_SubinvP" imemode="none" innerdataset="ds_SubinvP" onitemchanged="cbo_SubinvP_OnChanged" taborder="2" position="absolute 394 13 650 34"/>
                  <Static id="Static13" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 759 10" anchor="left bottom"/>
                  <Static id="Static12" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 10 465" anchor="top right"/>
                  <Static id="Static00" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 908 0 918 465" anchor="top right"/>
                  <Static id="Static21" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 37 749 42"/>
                  <Static id="Static01" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 455 759 465" anchor="left bottom"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Button id="btn_close" onclick="btn_close_OnClick" taborder="3" text="닫 기" position="absolute 890 10 935 35" class="btn_WF_Custom" image="" anchor="top right"/>
        <Button id="btn_save" onclick="btn_save_OnClick" taborder="1" text="저 장" position="absolute 843 10 888 35" class="btn_WF_Custom" image="" anchor="top right"/>
        <Static id="st_NeedDate" text="입고예정일 : 0000-00-00" position="absolute 15 40 342 67" class="sta_WFDA_Label03" style="align:center middle;"/>
        <Static id="st_Days" text="마감시간 : 00일 00시간 00분 전" position="absolute 341 40 675 67" class="sta_WFDA_Label03" style="align:center middle;"/>
        <Static id="Static2" text="선발주 상품은 미리 주문하세요." position="absolute 724 88 935 103" class="sta_WF_DiscPoint"/>
        <TextArea id="ta_Sql" readonly="true" taborder="8" position="absolute 399 75 500 104" scrollbars="none" style="font:Gulim,7;" wordwrap="word" visible="false"/>
        <Static id="st_Week" text="(월)" position="absolute 263 44 295 63" class="sta_WFDA_Label03" style="border:0 none #c3c3c3ff ;padding:0 0 0 0;"/>
        <Static id="st_Credit" text="발주가능액" visible="false" position="absolute 674 40 762 67" class="sta_WFDA_Label03"/>
        <Edit autoselect="true" enable="false" id="ed_Credit" imemode="native" taborder="10" tabstop="false" visible="false" position="absolute 764 43 932 64" style="align:right; :disabled {color:red;}"/>
        <Static id="Static01" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 15 590"/>
        <Static id="Static15" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 15 0 935 10"/>
        <Static id="Static02" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 935 0 950 590" positionstep="0"/>
        <Static id="Static04" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 688 35 935 40"/>
        <Static id="Static20" text="W102" visible="false" position="absolute 888 10 890 35" anchor="top right" style="background:#ff000055;align:center middle;"/>
        <Static id="Static03" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 15 575 935 590"/>
        <Edit id="ed_CreditAvail" taborder="11" tabstop="false" autoselect="true" enable="false" position="absolute 765 72 933 93" style="align:right; :disabled {color:red;}" visible="false"/>
        <Static id="stc_ctrlAmt" text="( 전체창고 발주금액 : $amt$ )" visible="false" position="absolute 683 43 936 64" style="font:Gulim,9, bold;"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cond">
        <ColumnInfo>
          <Column id="ITEM_NAME" size="100" type="STRING"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="UPJANG" size="22" type="INT"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="QTY_CONTROL_YN" size="1" type="STRING"/>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="AP_UNITPRICE_UPJANG" size="22" type="INT"/>
          <Column id="OTCUST_PRICE_UPJANG" size="22" type="INT"/>
          <Column id="ITEM_CLASS2" size="8" type="STRING"/>
          <Column id="ITEM_CLASS3" size="8" type="STRING"/>
          <Column id="ITEM_CLASS4" size="8" type="STRING"/>
          <Column id="FAVOR_GROUP" size="50" type="STRING"/>
          <Column id="NEED_DATEP" size="8" type="STRING"/>
          <Column id="UPJANGP" size="22" type="INT"/>
          <Column id="SUBINV_CODEP" size="8" type="STRING"/>
          <Column id="POPUP_GUBUN" size="8" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Class2"/>
      <Dataset id="ds_Class3"/>
      <Dataset id="ds_Class4"/>
      <Dataset id="ds_Fav">
        <ColumnInfo>
          <Column id="FAVOR_GROUP" size="50" type="STRING"/>
          <Column id="FAVOR_NAME" size="100" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List1" cancolumnchange="ds_List_CanColumnChange" oncolumnchanged="ds_List_OnColumnChanged">
        <ColumnInfo>
          <Column id="CENTER_CODE" size="22" prop="default" type="INT"/>
          <Column id="CENTER_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="CLS_STATUS" size="50" prop="default" type="STRING"/>
          <Column id="CUSTCD" size="22" prop="default" type="INT"/>
          <Column id="INVAT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="ITEM_CODE" size="50" prop="default" type="STRING"/>
          <Column id="ITEM_NAME" size="200" prop="default" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" prop="default" type="STRING"/>
          <Column id="LINE_STATUS" size="50" prop="default" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" prop="default" type="STRING"/>
          <Column id="OTCUSTCD" size="50" prop="default" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="PO_UOM" size="10" prop="default" type="STRING"/>
          <Column id="POINT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="PR_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" prop="default" type="STRING"/>
          <Column id="PR_UPJANG" size="22" prop="default" type="INT"/>
          <Column id="RC_UPJANG" size="22" prop="default" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" prop="default" type="STRING"/>
          <Column id="TAX_CODE" size="3" prop="default" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" prop="default" type="INT"/>
          <Column id="D_DAY_DISP" size="50" prop="default" type="STRING"/>
          <Column id="CLASS_NAME3" size="100" prop="default" type="STRING"/>
          <Column id="D_TIMES" size="4" prop="default" type="INT"/>
          <Column id="IMAGE_PATH" size="200" prop="default" type="STRING"/>
          <Column id="CONSUM_YN" size="1" prop="default" type="STRING"/>
          <Column id="CORN_YN" size="1" prop="default" type="STRING"/>
          <Column id="SPICE_YN" size="1" prop="default" type="STRING"/>
          <Column id="GUBUN" size="256" prop="default" type="STRING"/>
          <Column id="IMG_YN" size="256" prop="default" type="STRING"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="ORIGIN_TYPE" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CtUpj">
        <ColumnInfo>
          <Column id="AP_UNITPRICE_UPJANG" size="22" type="INT"/>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="OTCUST_PRICE_UPJANG" size="22" type="INT"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List2" cancolumnchange="ds_List_CanColumnChange" oncolumnchanged="ds_List_OnColumnChanged">
        <ColumnInfo>
          <Column id="CENTER_CODE" size="22" prop="default" type="INT"/>
          <Column id="CENTER_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="CLS_STATUS" size="50" prop="default" type="STRING"/>
          <Column id="CUSTCD" size="22" prop="default" type="INT"/>
          <Column id="INVAT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="ITEM_CODE" size="50" prop="default" type="STRING"/>
          <Column id="ITEM_NAME" size="200" prop="default" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" prop="default" type="STRING"/>
          <Column id="LINE_STATUS" size="50" prop="default" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" prop="default" type="STRING"/>
          <Column id="OTCUSTCD" size="50" prop="default" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="PO_UOM" size="10" prop="default" type="STRING"/>
          <Column id="POINT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="PR_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" prop="default" type="STRING"/>
          <Column id="PR_UPJANG" size="22" prop="default" type="INT"/>
          <Column id="RC_UPJANG" size="22" prop="default" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" prop="default" type="STRING"/>
          <Column id="TAX_CODE" size="3" prop="default" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" prop="default" type="INT"/>
          <Column id="D_DAY_DISP" size="50" prop="default" type="STRING"/>
          <Column id="CLASS_NAME3" size="100" prop="default" type="STRING"/>
          <Column id="D_TIMES" size="4" prop="default" type="INT"/>
          <Column id="IMAGE_PATH" size="200" prop="default" type="STRING"/>
          <Column id="CONSUM_YN" size="1" prop="default" type="STRING"/>
          <Column id="CORN_YN" size="1" prop="default" type="STRING"/>
          <Column id="SPICE_YN" size="1" prop="default" type="STRING"/>
          <Column id="GUBUN" size="256" prop="default" type="STRING"/>
          <Column id="IMG_YN" size="256" prop="default" type="STRING"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="ORIGIN_TYPE" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SubinvP"/>
      <Dataset id="ds_groupList">
        <ColumnInfo>
          <Column id="ATTR01" size="300" type="STRING"/>
          <Column id="ATTR02" size="300" type="STRING"/>
          <Column id="ATTR03" size="300" type="STRING"/>
          <Column id="ATTR04" size="300" type="STRING"/>
          <Column id="ATTR05" size="300" type="STRING"/>
          <Column id="ATTR06" size="300" type="STRING"/>
          <Column id="ATTR07" size="300" type="STRING"/>
          <Column id="ATTR08" size="300" type="STRING"/>
          <Column id="ATTR09" size="300" type="STRING"/>
          <Column id="ATTR10" size="300" type="STRING"/>
          <Column id="CDATE" size="7" type="DATE"/>
          <Column id="CONTENTS" size="300" type="STRING"/>
          <Column id="CUSER" size="9" type="STRING"/>
          <Column id="FAVOR_GROUP" size="50" type="STRING"/>
          <Column id="FAVOR_NAME" size="100" type="STRING"/>
          <Column id="FAVOR_TYPE" size="50" type="STRING"/>
          <Column id="REMARK" size="300" type="STRING"/>
          <Column id="SORT_SEQ" size="22" type="BIGDECIMAL"/>
          <Column id="UDATE" size="7" type="DATE"/>
          <Column id="UPJANG" size="22" type="BIGDECIMAL"/>
          <Column id="USE_YN" size="1" type="STRING"/>
          <Column id="UUSER" size="9" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_WeekendTime">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="SET1" type="STRING" size="256"/>
          <Column id="SET2" type="STRING" size="256"/>
          <Column id="SET3" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 식재영업/발주관리/상품검색
 * 프로그램명   : FMP00161P.XML
 * 기      능   : 상품검색
 * 작  성  자   : 박은규
 * 작성  일자   : 2008-01-10
 * ----------------------------------------------------------------------------------------
 * HISTORY    :  1. 변경일자 : 2010/03/25 기능 추가
 *                  변경내용 : D-Day 체크 후 발주 불가 상품 표시 및 수량 입력 불가 하게 변경 
 *                  수정자   :  노규완  
 *                  요청자   :  김진희
 * ========================================================================================
 *               2. 변경일자 : 2010/03/29 기능추가
 *                  변경내용 : 수량이 0.0 이면 노란색 표시, 발주 불가는 색깔 표시, 
 *                             발주 불가이면 edit -> False 수량이 0.0이 아니면 노란색 표시 
 *                  수 정 자 : 노규완
 *                  요 청 자 : 김진희/이혜은
 * ========================================================================================
 *               3. 변경일자 : 2010/10/22 기능추가
 *                  변경내용 : 기존 즐겨찾기 그룹 등록이 단일 그룹으로 사용 되던 것에서 
 *                             상품 분류별 그룹 등록 후 발주 팝업에 그룹으로 조회 할 수 있게
 *                  수 정 자 : 노규완
 *                  요 청 자 : 오성주 과장(한촌 설렁탕 신규 업장 수주에 따른 변경 요청)
 *				2017.02.24	kihoon	[CH201702_00698] 주요상품발주 추가 정보 표기
 ******************************************************************************************
 */
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"
//@@컨버터에서 주석처리 #include "lib::tit_comm_0001.js"
//@@컨버터에서 주석처리 #include "lib::fm_common.js"			// FM공통

//var fa_Upjang, fa_SubinvCode, fa_NeedDate, fa_Consum, fa_Qty_Ctl, fa_TabIdx;
var fa_Sql;
var v_Group_Code = "";
var fa_weekendTimeCheck = "N"; // 주말 발주 통제 여부
var fa_startTime; // 통제시작시간
var fa_endTime; // 통제종료시간
var fa_credit;	// 주문가능액

function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	//초기화
	fsp_init(this);
   	//ta_Sql.Visible = (global.g_AuthLevel == "999");

   	// 간편발주인 경우는 발주가능금액 안보이도록 수정(2010-07-08)
	if (g_Simple_Po_Yn == "Y") {
		st_Credit.visible = true;
	} else {
		st_Credit.visible = false;
	} 
	
	ed_Credit.visible = st_Credit.visible;
	
// [속도개선 Project 시작] 2017. 7. 19. 최범주 발주버튼 클릭 시 주요상품검색 팝업 저장버튼 권한처리
	// 식재영업1,2 팀의 영업사원일 경우 저장 버튼을 숨김
	if ( fa_sHiddenYn == "Y" ) {
		btn_save.visible = false;
	} else {
		btn_save.visible = true;
	}
// [속도개선 Project   끝] 2017. 7. 19. 최범주
	tab_list.tab2.ed_UpjangP.userdata = opener.ed_Upjang.userdata;
	tab_list.tab2.ed_UpjangP.value     = opener.ed_Upjang.text;
	Copy(ds_SubinvP,opener.ds_Subinv);
	tab_list.tab2.cbo_SubinvP.value   = opener.cbo_Subinv.value;
	tab_list.tab2.me_NeedDateP.value  = gfn_addDate(fa_NeedDate,-7);  //addDate(fn_CurrDateWeek(),-7);
	//분류세팅
	//fn_sql_common("C", strQuery_FMItemClass	," AND A.USE_YN = 'Y' AND A.CLASS_TYPE = 'M' AND A.CLASS_CODE LIKE '01%' "," ORDER BY A.CLASS_CODE","all",tab_list.tab2.cbo_Class2,-1,ds_Class2); tab_list.tab2.cbo_Class2.Index = 0;
	//fn_sql_common("C", strQuery_FMItemClass	," AND A.USE_YN = 'Y' AND A.CLASS_TYPE = 'S' AND A.CLASS_CODE LIKE '01%' "," ORDER BY A.CLASS_CODE","all",tab_list.tab2.cbo_Class3,-1,ds_Class3); tab_list.tab2.cbo_Class3.Index = 0;
	//fn_sql_common("C", strQuery_FMItemClass	," AND A.USE_YN = 'Y' AND A.CLASS_TYPE = 'D' AND A.CLASS_CODE LIKE '01%' "," ORDER BY A.CLASS_CODE","all",tab_list.tab2.cbo_Class4,-1,ds_Class4); tab_list.tab2.cbo_Class4.Index = 0;
	//즐겨찾기그룹
	//fn_SetFav();
	//센터단가업장정보
	fn_SetCtUpj();
	//헤더설정
	st_NeedDate.text = "입고예정일 : " + opener.me_NeedDate.text + "";
	st_Week.text = "(" + ffn_DayToWeek(opener.me_NeedDate.value) + ")";
	if (st_Week.text == "(토)")
		st_Week.style.color = "blue";
	else if (st_Week.text == "(일)")
		st_Week.style.color = "red";
	else
		st_Week.style.color = "default";
	
	fn_SetTitle();
	//타이머...
	//setTimer(666,30000); //일단 30초 세팅
	
	//플래쉬
	//Flash10.Movie = "IMG::WorkingCercle.swf";
	//Flash10.Play();

	tab_list.tabindex = toNumber(fa_TabIdx);
	if (tab_list.tabindex == 0)
		tab_list.tab1.ed_Item.setFocus();
	else if (tab_list.tabindex == 1)
		tab_list.tab2.me_NeedDateP.setFocus();

	if( this.opener.ed_Credit.text != "무 제 한" )
	{
		fa_credit = this.opener.ed_Credit.text;
		fa_credit = toNumber(fa_credit.replace(",", ""));	
	}
	else
	{
		fa_credit = this.opener.ed_Credit.text;
	}

	//주문가능액
	ed_Credit.value = this.opener.ed_Credit.text;
	//실주문가능액(임시여신포함된)
	ed_CreditAvail.value = this.opener.ed_CreditAvail.text;
	
	
	//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
	// 2010/10/25 기능 추가 History 3번 추가 : 즐겨찾기 그룹 조회
	//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
	fn_searchGroup();	
	//+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++		

//	if (this.opener.ID = 'U_FMP::FMP00160E.xml') 
//	{ fn_Search();}

	// FICS 발주제한요일, 시간 설정 조회
	fn_getWeekendTime();	
	
	stc_ctrlAmt.text = fa_CtrlAmt.text;
	stc_ctrlAmt.style.color = fa_CtrlAmt.color;
	stc_ctrlAmt.visible = fa_CtrlAmt.visible;
	
	if ( ed_Credit.visible ) {
		stc_ctrlAmt.visible = false;
	}
}

function fn_search()
{	

	// 초기화
	ds_cond.clearData();
	eval("ds_List" + gfn_toString(tab_list.tabindex+1)).clearData();
	ds_cond.addRow();
	ds_cond.setColumn(0, "UPJANG",        fa_Upjang);
	ds_cond.setColumn(0, "SUBINV_CODE",   fa_SubinvCode);
	ds_cond.setColumn(0, "NEED_DATE",     fa_NeedDate);
	ds_cond.setColumn(0, "CONSUM_YN",     fa_Consum);
	ds_cond.setColumn(0, "QTY_CONTROL_YN",fa_Qty_Ctl);
	ds_cond.setColumn(0, "FAVOR_GROUP"   ,v_Group_Code);	
	
	
	//http.Sync = true;
	
			
	if (this.opener.url == 'U_FMP::FMP00160E.xfdl')      //  --> 테스트 완료 후 실 서버 적용 시 풀 경로와 .xml을 모두 적어야  반영 됨.
	//if (this.opener.ID = 'FMP00160E') 
	{	
		ds_cond.setColumn(0, "POPUP_GUBUN","FMP00161P"); 
	}
	else
	{
		ds_cond.setColumn(0, "POPUP_GUBUN","");
	}
	
	ds_cond.setColumn(0, "CENTER_CODE",   ds_CtUpj.getColumn(0,"CENTER_CODE"));
	ds_cond.setColumn(0, "AP_UNITPRICE_UPJANG",     ds_CtUpj.getColumn(0,"AP_UNITPRICE_UPJANG"));
	ds_cond.setColumn(0, "OTCUST_PRICE_UPJANG",     ds_CtUpj.getColumn(0,"OTCUST_PRICE_UPJANG"));
	if (tab_list.tabindex == 0)
		ds_cond.setColumn(0, "ITEM_NAME",     tab_list.tab1.ed_Item.text);
	else if (tab_list.tabindex == 1)
	{
		if (ffn_ChkNull(tab_list.tab2.me_NeedDateP.value))
		{
			g_Message("EE", "복사대상 일자를 선택하세요."); tab_list.tab2.me_NeedDateP.setFocus(); return;
		}
		if (ffn_ChkNull(tab_list.tab2.ed_UpjangP.userdata))
		{
			g_Message("EE", "복사대상 업장을 선택하세요."); tab_list.tab2.ed_UpjangP.setFocus(); return;
		}
		if (ffn_ChkNull(tab_list.tab2.cbo_SubinvP.value))
		{
			g_Message("EE", "복사대상 식당을 선택하세요."); tab_list.tab2.cbo_SubinvP.setFocus(); return;
		}
		ds_cond.setColumn(0, "NEED_DATEP",    tab_list.tab2.me_NeedDateP.value);
		ds_cond.setColumn(0, "UPJANGP",       tab_list.tab2.ed_UpjangP.userdata);
		ds_cond.setColumn(0, "SUBINV_CODEP",  tab_list.tab2.cbo_SubinvP.value);
	}
/*
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    inData		= "ds_cond=ds_cond";
    outData		= "ds_List" + toString(tab_list.TabIndex+1) + "=ds_List";
    callBackFnc	= "fn_CallBack_Search";
	
	//action 정보 초기화 
	tit_clearActionInfo(this); 
    // 서버에서 조회할 정보 추가 
	tit_addSearchActionInfo(this, "fm/fmp:FMP00161P_S00" + toString(tab_list.TabIndex+1));
	// 서버 호출 
    tit_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
*/
	// 조회
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMP00160E_T002";
	strURL   = "U_svc::" + "fm/fmp/FMP00160E_T002.jsp";
	// 데이터셋 설정
	strInDatasets  = "ds_cond=ds_cond";
	strOutDatasets = "ds_List" + gfn_toString(tab_list.tabindex+1)+ "=ds_List";
	// 파라메터 설정
	strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
	strArgument += " strIndex=" + wrapQuote(gfn_toString(tab_list.tabindex+1));
	strArgument += " strWeekendTimeCheck=" + wrapQuote(fa_weekendTimeCheck);
	
	// 콜백함수 지정
	strCallbackFunc = "fn_CallBack_Search";
	
	// 서버 호출 
	//Transaction(strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc);
	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, false);

	//++++++++++++++++++++++++++++++++++
	// 2010/03/29 기능 추가 History 2번 
	//++++++++++++++++++++++++++++++++++
	
	/*
	if (tab_list.tabindex == 0)
	{
		for( i=0 ; i<ds_List1.rowcount ; i++ )
		{	    
			if (fn_SetRowColor(ds_List1.getColumn(i,"D_DAYS"),ds_List1.getColumn(i,"D_TIMES"),ds_List1.getColumn(i,"PR_QTY")) == "white")
			{	
				ds_List1.setColumn(i,"GUBUN","1");		//white
			}
			else
			{				
				ds_List1.setColumn(i,"GUBUN","2");       //thistle
			}
		}
	}
	else if (tab_list.tabindex == 1)
	{
		for( i=0 ; i<ds_List2.rowcount ; i++ )
		{	    
			if (fn_SetRowColor(ds_List2.getColumn(i,"D_DAYS"),ds_List2.getColumn(i,"D_TIMES"),ds_List2.getColumn(i,"PR_QTY")) == "white")
			{	
				ds_List2.setColumn(i,"GUBUN","1");		//white
			}
			else
			{				
				ds_List2.setColumn(i,"GUBUN","2");       //thistle
			}
		}	  
	}
	*/
	
	//+++++++++++++++++++++++++++++++++++++++++
	// 2010/03/29 기능 추가 History 2번 추가 끝
	//+++++++++++++++++++++++++++++++++++++++++
	//http.Sync = false;	
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
//콜백
//function fn_CallBack_Search(SvcID, errCode, errMsg)
function fn_CallBack_Search(errCode, errMsg)
{
ta_Sql.value = fa_Sql;
	if (errCode == 0)
	{
		if (eval("ds_List" + gfn_toString(tab_list.tabindex+1)).rowcount == 0)
			g_Message("EE","검색된 상품이 없습니다.");
		else
		{
			
			if (tab_list.tabindex == 0)
			{
				for( i=0 ; i<ds_List1.rowcount ; i++ )
				{	    
					if (fn_SetRowColor(ds_List1.getColumn(i,"D_DAYS"),ds_List1.getColumn(i,"D_TIMES"),ds_List1.getColumn(i,"PR_QTY")) == "white")
					{	
						ds_List1.setColumn(i,"GUBUN","1");		//white
					}
					else
					{				
						ds_List1.setColumn(i,"GUBUN","2");       //thistle
					}
				}
			}
			else if (tab_list.tabindex == 1)
			{
				for( i=0 ; i<ds_List2.rowcount ; i++ )
				{	    
					if (fn_SetRowColor(ds_List2.getColumn(i,"D_DAYS"),ds_List2.getColumn(i,"D_TIMES"),ds_List2.getColumn(i,"PR_QTY")) == "white")
					{	
						ds_List2.setColumn(i,"GUBUN","1");		//white
					}
					else
					{				
						ds_List2.setColumn(i,"GUBUN","2");       //thistle
					}
				}

				// 발주가능액 변경
				if( fa_credit != "무 제 한" )
				{
					ed_Credit.value = gfn_numFormat(fa_credit - ds_List2.getSum("OP_AMOUNT"));
				}	  
			}
			
			
			//창고가 식재/소모품 통합창고인 경우 주문통제 점검
			if (ffn_ChkNull(fa_Consum)) fn_SetOrdCtrl();			
			
			eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).gd_list.setFocus();			
			eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).gd_list.setCellPos(7);
			
		}
	}
	else {
		g_Message("EE","주문상품 조회하는 중에 오류가 발생하였습니다! \n 관리자에게 문의하세요.");
	}
}

function fn_SetOrdCtrl()
{
	var nRow;
	for (i=eval("ds_List" + gfn_toString(tab_list.tabindex+1)).rowcount-1; i>=0; i--)
	{
		//주문통제(주문일자)
		nRow = opener.ds_OrdCtrl.findRowExpr("CTRL_TYPE=='주문'&&ITEM_TYPE==iif('" + eval("ds_List" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"CONSUM_YN") + "','Y','소모품','식자재')");
		if (nRow >= 0)
		{
			if (opener.ds_OrdCtrl.getColumn(nRow,ToUpper(gds_currdate.getColumn(0, "WEEK_ENG"))) == "Y")
				eval("ds_List" + gfn_toString(tab_list.tabindex+1)).deleteRow(i);
		}
		//주문통제(입고일자)
		nRow = opener.ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE==iif('" + eval("ds_List" + gfn_toString(tab_list.tabindex+1)).getColumn(i,"CONSUM_YN") + "','Y','소모품','식자재')");
		if (nRow >= 0)
		{
			if (opener.ds_OrdCtrl.getColumn(nRow,ToUpper(ffn_DayToWeek(fa_NeedDate,"1"))) == "Y")
				eval("ds_List" + gfn_toString(tab_list.tabindex+1)).deleteRow(i);
		}
	}
}

function fn_FormKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
	//ESC키는 닫기
	if ( e.keycode == 27 ) close();
	//임시로...'F12'입력시 타이머 작동중지
	if (e.keycode == 123) killTimer(666);
}

function fn_CopyRow(obj)
{
	if (obj.rowcount < 1) return;
	if (obj.findRowExpr("PR_QTY>0") < 0) return;
	
	for (i=0; i<obj.rowcount; i++)
	{
		if (obj.getColumn(i,"PR_QTY") <= 0) continue;
		//이미 등록여부
		if ( opener.ds_List.findRowExpr("ITEM_CODE=="+wrapQuote(obj.getColumn(i,"ITEM_CODE"))) >= 0 )
		{
			if (! g_Confirm("01", obj.getColumn(i,"ITEM_CODE") + ' ' + obj.getColumn(i,"ITEM_NAME") + '\n이미 주문등록한 상품입니다.\n\n추가주문 하시겠습니까?!')) continue;
		}
		opener.ds_List.addRow();
		opener.ds_List.copyRow(opener.ds_List.rowposition, obj, i);
	}
	//for (i=obj.rowcount-1; i>=0; i--)
		//if (obj.GetColumn(i,"PR_QTY") > 0) obj.DeleteRow(i);
}

function fn_SetFav()
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_Fav=ds_List";
    otherArg	= "UPJANG=" + wrapQuote(fa_Upjang);
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_FAVORITE_GROUP_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	if (ds_Fav.rowcount > 0) tab_list.tab3.cbo_Fav.index = 0;
}

function fn_SetCtUpj()
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_CtUpj=ds_List";
    otherArg	= "UPJANG=" + wrapQuote(fa_Upjang);
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_GET_CTUPJ_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	if (ds_CtUpj.rowcount <= 0)
	{
		g_Message("EE","업장기초정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
		close();
	}
}

function fn_SetSubinvP()
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 초기화
	ds_SubinvP.clearData();
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_SubinvP=ds_List";
    otherArg	= "UPJANG=" + wrapQuote(tab_list.tab2.ed_UpjangP.userdata);
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_PO_SUBINV_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	//기본창고지정
	if (ds_SubinvP.rowcount > 0) tab_list.tab2.cbo_SubinvP.index = 0;
}
//========================================================================================
// 기존 수량 입력 시 색깔 표시  --> 상품 발주와 동일하게 적용 (기존 소스 주석 처리)
//========================================================================================
//function fn_SetRowColor(nQty)
//{
//	if (NumFormat(nQty,1) == "0.0")
//		return "white";
//	else
//		return "thistle";
//}
function fn_SetRowColor(nDdays,nDtimes,sPR_QTY)
{		
	return iif(fn_GetDayStatus(nDdays,gfn_trim(nDtimes),sPR_QTY)=="0","thistle","white");
	       
}
//========================================================================================
// 일차적으로 통제 상품 색상 처리.
//========================================================================================
function fn_GetDayStatus(nDdays,nDtimes,sPR_QTY)
{	
	//무통제면 패스...
	if ( numFormat(nDdays)== "0" )	return "2";
	//디데이체크
	if ( gfn_addDate(gds_currdate.getColumn(0,"YMD"),nDdays)> opener.me_NeedDate.value )
	    {
			//tab_list.tab1.gd_list.SetCellProp()
			
			return "0";
		}
	else if ( gfn_addDate(gds_currdate.getColumn(0,"YMD"),nDdays)== opener.me_NeedDate.value )
	{
		//디타임체크
		if ( gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4)> nDtimes )
			return "0";
		else if ( G_fn_GapTime(0, gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4), nDtimes, "") <= "0030" )
			return "1";
		else
			return "2";
	}
	else
		return "2";
}
//=========================================================================================


//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
function btn_close_OnClick(obj:Button, e:ClickEventInfo)
{
	if(fn_isUpdateColumn(ds_List1, "PR_QTY")==true)
	{
		g_Message("EE","변경된 내역이 있습니다. 저장해 주십시요");
	}else{
		close();
	}
}

function fn_isUpdateColumn(objDs, strColumn)
{
	for (var i = 0; i <  objDs.getRowCount(); i++)
	{
		if (objDs.getColumn(i, strColumn) != objDs.getOrgColumn(i, strColumn)) 
		{
			return true;
		}
	}
	
	return false;
} 

function gd_list_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
}

function btn_search_OnClick(obj:Button, e:ClickEventInfo)
{
	/*
	if(tab_list.tabindex == '0' && tab_list.tab1.ed_Item.text == "")
	{
		gfn_alert("상품명을 입력하시기 바랍니다.");
		return;
	};
	*/

	fn_search();
}

function btn_search_OnKeyDown(obj:Button, e:KeyEventInfo)
{
	if ( e.keycode == 13 ) btn_search_OnClick(obj);
}

function ed_Item_OnKeyDown(obj, e)
{
	if ( e.keycode == 13 ) fn_search();
}

// function cbo_Class2_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
// {
	// if (obj == tab_list.tab2.cbo_Class2)
	// {
		////중분류 데이터셋 필터
		// ds_Class3.Filter("left(CLASS_CODE,4)="+quote(left(strCode,4))+"||CLASS_CODE=''");
		// tab_list.tab2.cbo_Class3.Index = 0;
		////소분류 데이터셋 필터
		// ds_Class4.Filter("Left(CLASS_CODE,4)="+quote(left(strCode,4))+"||CLASS_CODE=''");
		// tab_list.tab2.cbo_Class4.Index = 0;
	// }
	// else if (obj == tab_list.tab2.cbo_Class3)
	// {
		// ds_Class4.Filter("left(CLASS_CODE,6)="+quote(left(strCode,6))+"||CLASS_CODE=''");
		// tab_list.tab2.cbo_Class4.Index=0;
	// }
// }

// function cbo_Class2_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,LLParam,HLParam)
// {
	// ffn_SetComboNull(obj, nChar);
// }

function tab_list_OnChanged(obj:Tab, e:TabIndexChangeEventInfo)
{
	switch(e.postindex)
	{
		case 0:
			tab_list.tab1.ed_Item.setFocus();
			break;
		case 1:
			tab_list.tab2.me_NeedDateP.setFocus();
			break;
		default:
			break;
	}

	// 발주가능액 변경
	if( fa_credit != "무 제 한" )
	{
		ed_Credit.value = gfn_numFormat(fa_credit - eval("ds_List" + gfn_toString(tab_list.tabindex+1)).getSum("OP_AMOUNT"));
	}
}

function ds_List_CanColumnChange(obj:Dataset, e:DSColChangeEventInfo)
{
	//수량체크
	if (e.columnid == "PR_QTY")
	{
		//(-)발주여부
		if ( toNumber(e.newvalue) < 0 )
		{
			g_Message("EE","(-)발주는 불가합니다.");
			return false;
		}
		//수량통제 안하는 업장의 경우 이하 패스...
		//if (fa_Qty_Ctl = "N") return true;
		//
		//수량통제 안하는 업장의 경우 소숫점발주가 Y이면 무조건 최소발주량/발주승수량을 무조건 0.1로 세팅하여 조회
		if ( toNumber(e.newvalue) > 0 )
		{
			//최소발주량 체크
			if ( (toNumber(obj.getColumn(e.row,"MIN_ORD_QTY")) > 0) && (toNumber(obj.getColumn(e.row,"MIN_ORD_QTY")) > toNumber(e.newvalue)) )
			{
				g_Message("EE","해당 상품은 최소발주량이 " + obj.getColumn(e.row,"MIN_ORD_QTY") + "입니다.");
				return false;
			}
			//최대발주량 체크
			if ( (toNumber(obj.getColumn(e.row,"MAX_ORD_QTY")) > 0) && (toNumber(obj.getColumn(e.row,"MAX_ORD_QTY")) < toNumber(e.newvalue)) )
			{
				g_Message("EE","해당 상품은 최대발주량이 " + obj.getColumn(e.row,"MAX_ORD_QTY") + "입니다.");
				return false;
			}
			//소숫점발주여부
			if ( (obj.getColumn(e.row,"POINT_FLAG") != "Y") && (Math.ceil(toNumber(e.newvalue)) != toNumber(e.newvalue)) )
			{
				g_Message("EE","해당 상품은 소숫점발주가 불가합니다.");
				return false;
			}
			//발주승수량
			if ( (toNumber(obj.getColumn(e.row,"MULTIPLIER_QTY")) > 0) && ((Math.round(toNumber(e.newvalue) * 1000) % Math.round(toNumber(obj.getColumn(e.row,"MULTIPLIER_QTY")) * 1000)) <> 0) )
			{
				g_Message("EE","해당 상품은 발주승수량이 " + obj.getColumn(e.row,"MULTIPLIER_QTY") + "입니다.");
				return false;
			}
		}
		
		//3개월치 최대발주량 초과시 알람
		if ( toNumber(e.newvalue) >  toNumber(obj.getColumn(e.row,"MAX_SO_QTY")) )
		{
			g_Message("EE","해당 상품은 최근 3개월 최대발주량 " + obj.getColumn(e.row,"MAX_SO_QTY") + " 을 초과 하였습니다. ");
		}
	}
	return true;
}

function ds_List_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	//금액계산
	if (e.columnid == "PR_QTY")
	{
		var nAmt = Math.round(toNumber(obj.getColumn(e.row,"SALE_PRICE")) * toNumber(e.newvalue));
		obj.setColumn(e.row, "SALE_AMOUNT", nAmt);
		nAmt = Math.round(toNumber(obj.getColumn(e.row,"OP_PRICE")) * toNumber(e.newvalue));
		obj.setColumn(e.row, "OP_AMOUNT", nAmt);

		// 발주가능액 변경
		if( fa_credit != "무 제 한" )
		{
			ed_Credit.value = gfn_numFormat(fa_credit - obj.getSum("OP_AMOUNT"));
		}
	}
}

function btn_save_OnClick(obj:Button, e:ClickEventInfo)
{
	//발주시 임시여신이 포함된 실제 발주 가능금액을 체크함
	if(toNumber(replace(ed_CreditAvail.value,",","")) < ds_List1.getSum("OP_AMOUNT"))
	{
		alert("발주가능금액을 초과해서 주문할수 없습니다.");
		return;
	}
	
	fn_CopyRow(eval("ds_List" + gfn_toString(tab_list.tabindex + 1)));
	close();	

}

function FMP00161P_OnTimer(obj:Form, e:TimerEventInfo)
{
	if (e.timerid == 666) {
		fn_SetTitle();
	}
}

function FMP00161P_onactivate(obj:Form, e:ActivateEventInfo)
{
	//화면 액트브시 타이머 재설정
	fn_SetTitle();
	setTimer(666,30000); //일단 30초 세팅
}

function FMP00161P_ondeactivate(obj:Form, e:ActivateEventInfo)
{
	//타이머 종료...(타이머 발생으로 쿼리 수행하여 결과값 가져오면 화면이 앞으로 올라온다.
	killTimer(666);
}

function fn_SetTitle()
{
	fn_CurrDateWeek();
	
	// FICS 발주제한요일, 시간 설정 	
	fn_setWeekendTime();
			
	var sChkDate, sDay, sTime;
	if ( gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4)>= opener.ds_Days.getColumn(0,"D_TIMES") )
	{
		sChkDate = gfn_addDate(fa_NeedDate, (-1 * (toNumber(opener.ds_Days.getColumn(0,"D_DAYS")) + 1)));
		sTime = G_fn_GapTime("1", gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4), opener.ds_Days.getColumn(0,"D_TIMES"), "");				
	}
	else
	{
		sChkDate = gfn_addDate(fa_NeedDate, (-1 * toNumber(opener.ds_Days.getColumn(0,"D_DAYS"))));
		sTime = G_fn_GapTime("0", gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4), opener.ds_Days.getColumn(0,"D_TIMES"), "");				
	}
	
	if (parseInt(gds_currdate.getColumn(0, "YMD")) <= parseInt(sChkDate))
		sDay = G_fn_CalcDay(gds_currdate.getColumn(0, "YMD"), sChkDate);		
		
	else
		sDay = G_fn_CalcDay(sChkDate, gds_currdate.getColumn(0, "YMD")) * (-1);	


	if ((toNumber(sDay) >= 0) && (toNumber(sDay) < 10)) sDay = "0" + sDay;	
	st_Days.text = "마감시간 : " + sDay + "일 " + gfn_left(sTime,2)+ "시간 " + gfn_right(sTime,2)+ "분 전";
	
}

function fn_stringToDate(sDate)
{
	if( gfn_isNull(sDate) )		return -1;	
	var sVal = sDate.toString();
	sVal = sVal.replace("-","").replace("/","").replace(".","");
	var date =  new Date(parseInt(sVal.substr(0,4)),parseInt(sVal.substr(4,2))-1,parseInt(sVal.substr(6,2)),parseInt(sVal.substr(8,2)),parseInt(sVal.substr(10,2)),parseInt(sVal.substr(12,2)));
	return date;
}

function fn_getDayDiff(time1,time2) {
   var date1 = fn_stringToDate(String(time1));
   var date2 = fn_stringToDate(String(time2));
   var day   = 1000 * 3600 * 24; //24시간

   return parseInt((date2 - date1) / day, 10);
}

function fn_getHourDiff(time1,time2) {
   var date1 = fn_stringToDate(String(time1));
   var date2 = fn_stringToDate(String(time2));
   var hour  = 1000 * 3600; //1시간   

   return parseInt((date2 - date1) / hour, 10);
}

function fn_getMinDiff(time1,time2) {
   var date1 = fn_stringToDate(String(time1));
   var date2 = fn_stringToDate(String(time2));   
   var min  = 1000 * 60;
   return parseInt((date2 - date1) / min, 10);
}

function fn_edBtn_OnClick(obj:Button, e:ClickEventInfo)
{
	var sAddWhere = "";
	var sOnBoard = "tab_list.tab2.";

	switch(obj.name)
	{
		case "btn_UpjangP":
			sAddWhere = " AND A.USE_YN = 'Y'";
			//본사인 경우 해당 사업장 조회
			if (application.g_UserKind == '본사')
				sAddWhere += " AND A.MAIN_UPJANG = " + application.g_Main_Upjang;
			//사업장인 경우 관리업장만 조회
			else if (application.g_UserKind == '사업장')
				sAddWhere += " AND ( A.UPJANG = " + application.g_Upjang + " OR EXISTS (SELECT 1 FROM FMS_USER_UPJANG B WHERE B.USE_YN = 'Y' AND B.UPJANG = A.UPJANG AND B.SABUN = '" + application.g_EmpNo + "') )";
			
			break;

		default:
			break;
	}
	//fm공통 팝업클릭 호출
	if (ffn_btn_OnClick(obj, sAddWhere, sOnBoard)) fn_Trigger_edBtn(eval(sOnBoard + "ed_" + gfn_subStr(obj.name, 4)));
}

function fn_edBtn_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	var sOnBoard = "tab_list.tab2.";

	ffn_ed_OnKeyDown(obj,e.keycode,sOnBoard);
	//Del의 경우 뒷처리
	if (e.keycode == 46) fn_Trigger_edBtn(eval(sOnBoard + "ed_" + gfn_subStr(obj.name, 3)));
}

function fn_Trigger_edBtn(obj)
{
	switch(obj)
	{
		case tab_list.tab2.ed_UpjangP:
			//초기화
			ds_List2.clearData();
			//창고세팅
			fn_SetSubinvP();

			break;
			
		default:

			break;
	}
}

function gd_list_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	//2010/03/23 수량 입력 클릭 시 공백 처리 == by Noh Kyu Wan ==
/*	
	if (nCell = 8)
	{	    
	    if (ds_List1.GetColumn(nRow,"PR_QTY") <> 0)
	    {}
	    else	    
		ds_List1.SetColumn(nRow,"PR_QTY","");		
		
	    if (ds_List4.GetColumn(nRow,"PR_QTY") <> 0)
	    {}
	    else	    
		ds_List4.SetColumn(nRow,"PR_QTY","");				
	}
	if (object(obj.BindDataset).rowcount < 1) return;
	if (nRow < 0) return;
	if (nCell <> 1) return;
*/
	if (eval(obj.binddataset).rowcount < 1) return;
	if (e.row < 0) return;
	if (e.cell == 9)
	{	    
		if (eval(obj.binddataset).getColumn(e.row,"PR_QTY") <> 0)
		{}
		else	    
		eval(obj.binddataset).setColumn(e.row,"PR_QTY","");		
	}
}

function cbo_SubinvP_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	//초기화
	if (obj == tab_list.tab2.cbo_SubinvP)
		ds_List2.clearData();
	//데이타셑 위치변경
	eval(obj.innerdataset).rowposition = e.postindex;
}

function tab_list_tab2_me_NeedDateP_OnKillFocus(obj)
{
	//g_Date_OnKillFocus(obj);
	g_Date_OnKillFocus(tab_list.tab2.me_NeedDateP);
}

function tab_list_tab1_gd_list_OnCellPosChanged(obj:Grid, e:GridSelectEventInfo)
{
/*
	//2010/03/23 수량 입력 클릭 시 공백 처리 == by Noh Kyu Wan ==
	if (nCell = 8)
	{
	    if (ds_List1.GetColumn(nRow,"PR_QTY") <> 0)
	    {			
	    }
	    else	    
		ds_List1.SetColumn(nRow,"PR_QTY","");		
	}	
*/
	//2010/03/23 수량 입력 클릭 시 공백 처리 == by Noh Kyu Wan ==
	if (e.cell == 9)
	{
		if (eval(obj.binddataset).getColumn(e.row,"PR_QTY") <> 0) {			
		}
		else {		
			if (e.oldcell == 9) {
				eval(obj.binddataset).setColumn(e.row,"PR_QTY","");	
			}
		}
	} 
	
	if (e.oldcell == 9) {
		if (gfn_isNull(eval(obj.binddataset).getColumn(e.oldrow, "PR_QTY"))) {
			eval(obj.binddataset).setColumn(e.oldrow, "PR_QTY", eval(obj.binddataset).getOrgColumn(e.oldrow, "PR_QTY"));
		}
	}
}
/*
function tab_list_tab2_gd_list_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{
	//2010/03/23 수량 입력 클릭 시 공백 처리 == by Noh Kyu Wan ==
	if (nCell = 8)
	{
	    if (ds_List2.GetColumn(nRow,"PR_QTY") <> 0)
	    {}
	    else	    
		ds_List2.SetColumn(nRow,"PR_QTY","");		
	}	
}
*/
function tab_list_tab1_gd_list_OnCellDblClick(obj:Grid, e:GridClickEventInfo)
{
	/************ 이미지팝업 주석
	if (e.cell == 2 || e.cell == 3)
	{
		if (eval(obj.binddataset).getColumn(e.row, "OTCUSTCD") == "0000")
			gfn_dialog("", "U_SCC::SCC91000P.xfdl","fa_Image="+wrapQuote(gfmsImgPathH + eval(obj.binddataset).getColumn(e.row, "IMAGE_PATH")));
		else
			gfn_dialog("", "U_SCC::SCC91000P.xfdl","fa_Image="+wrapQuote(gfmsImgPathO + eval(obj.binddataset).getColumn(e.row, "IMAGE_PATH")));
	}	
	*************/		
}


/*******************************************************************************************
 * 함  수  명   : fn_searchGroup
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 조회  
 * 작  성  자   : 노규완
 * 작성  일자   : 2010-10-25
 * ----------------------------------------------------------------------------------------
 * HISTORY    : 상품 분류별 그룹 등록 후 발주 팝업에 그룹으로 조회
 *******************************************************************************************/ 
function fn_searchGroup() {
    // 필수 입력사항 체크 
    if ( gfn_isNull(opener.ed_Upjang.value, "사업장", '') ) {
        return;
    }  
     
    ds_List1.clearData();
    ds_List2.clearData();
    
    ds_cond.addRow();    
    ds_cond.setColumn(0, "UPJANG", opener.ed_Upjang.userdata);
        
    // 그룹정보 조회 
    fsp_clear(this);
    fsp_addSearch(this, "fm/fmp:FMP00860E_S001");
        
    fsp_callService(this, "", "", "ds_cond=ds_cond", "ds_groupList=ds_groupList", "", "fn_afterSearchGroup", true);		// 서비스 호출     
    
}
function fn_afterSearchGroup(errCode, errMsg)
{	
    if ( ds_groupList.getRowCount() > 0 ) {
        // 그룹정보 조회 
        tab_list.tab1.cbo_groupList.index = 0;  
        v_Group_Code = tab_list.tab1.cbo_groupList.value;        
		
		/*
		if (this.opener.url == 'U_FMP::FMP00160E.xfdl') 
		{ fn_search();}        
		*/
    }
}
function cbo_groupList_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{	
	v_Group_Code = tab_list.tab1.cbo_groupList.value;
	
//	fn_Search();	
	if (this.opener.url == 'U_FMP::FMP00160E.xfdl') 	
	{ fn_search();}
}

// FICS 발주제한요일, 시간 설정 조회
function fn_getWeekendTime()
{
	fn_CurrDateWeek();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_WeekendTime=ds_List";
    callBackFnc = "callBackWeekendTime"
    //action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	//fsp_addSearch(this, "fm/fmz:FMZ_GET_WEEKENDTIME_S001");
	fsp_addSearch(this, "fm/fmz:FMZ_GET_WEEKENDTIME_S001");
	
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
}

function callBackWeekendTime(errCode, errMsg)
{
	if (errCode == 0)
	{
	    fn_setWeekendTime();
	} else {
		g_Message("EE",fn_AlertMsg("002"));
	}
}

// FICS 발주제한요일, 시간 설정에 따른 화면 제어 	
function fn_setWeekendTime()
{
	var sCurWeekCd = gds_currdate.getColumn(0, "WEEK_CD");
	var sCurTm = gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4);
	var nRow = ds_WeekendTime.findRow("CODE", sCurWeekCd);
	
	if ( nRow > -1 ) {
		
		fa_startTime = ds_WeekendTime.getColumn(nRow, "SET2");
		fa_endTime = ds_WeekendTime.getColumn(nRow, "SET3");
		
		if ( sCurTm >= fa_startTime && sCurTm <= fa_endTime ) {
			
			// 발주 통제 함
			fa_weekendTimeCheck = "Y"; 
			//g_Message("EE", "발주통제 시간입니다. 해당화면을 닫습니다.");
			//fn_close();
			
		} else {
		    // 발주 통제 안함
			fa_weekendTimeCheck = "N"; 
		}
		
		//trace("fn_setWeekendTime 주요상품발주: "+fa_weekendTimeCheck);
	}
}

// 발주제한에 따른 탭페이지 제어
function tab_list_canchange(obj:Tab, e:TabIndexChangeEventInfo)
{
	if ( e.postindex == 1 ) {
		if ( fa_weekendTimeCheck == "Y" ) {
			g_Message("EE", "발주통제 시간입니다.");
			return false;
		}
	} 	
}






function Button00_onclick(obj:Button,  e:ClickEventInfo)
{
	if(toNumber(replace(ed_CreditAvail.value,",","")) < ds_List1.getSum("OP_AMOUNT"))
	{
		alert("발주가능금액이 부족합니다.");
		return;
	}
	

}
]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FMP00379R" onkeydown="fn_FormKeyDown" onload="form_onload" titletext="거래명세서(센터일괄)" position="absolute 0 0 1252 725" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static29" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 97" anchor="left top right"/>
        <WebBrowser id="wb_Oz" taborder="13" position="absolute -17 168 1221 767" anchor="all" cookiesynctype="always"/>
        <Static id="st_Upjang" text="업 장" userdata="strQuery_FMUpjang" position="absolute 516 40 573 61" class="sta_WFSA_label" visible="false"/>
        <Static id="Static6" text="창고" position="absolute 516 66 556 87" class="sta_WFSA_label" visible="false"/>
        <Static id="Static8" text="입고일자" position="absolute 286 40 349 61" class="sta_WFSA_label"/>
        <Static id="Static3" text="출력구분" position="absolute 768 41 833 62" class="sta_WFSA_label" visible="false"/>
        <Combo displayrowcount="10" id="cbo_prtGB" imemode="none" index="0" taborder="5" position="absolute 366 66 486 87" codecolumn="cd" datacolumn="cdNm" innerdataset="@ds_prtGB" visible="true" onitemchanged="cbo_prtGB_onitemchanged"/>
        <TextArea id="ta_Sql" readonly="true" taborder="14" visible="false" position="absolute 512 0 626 40"/>
        <Combo displayrowcount="10" id="cbo_Type" imemode="none" index="0" taborder="9" position="absolute 995 65 1133 86" codecolumn="codecolumn" datacolumn="datacolumn" visible="false">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">0</Col>
                <Col id="datacolumn">일반용</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1</Col>
                <Col id="datacolumn">고객사용</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="Static5" text="출력양식" position="absolute 768 66 831 87" class="sta_WFSA_label" visible="false"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static45" text="W15" visible="false" position="absolute 0 30 15 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static43" text="W10" visible="false" position="absolute 15 30 1221 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static14" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 15 86 1221 96" anchor="left top"/>
        <Static id="Static13" text="W15" onclick="Static13_onclick" visible="false" position="absolute 1221 29 1236 96" style="background:#ff000055;align:center middle;"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="12" url="cmn::CmnBtn.xfdl" text="Div0" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static00" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 97 270 112"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 51 40 61 66" anchor="left top"/>
        <Static id="Static01" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 356 40 366 86" anchor="left top"/>
        <Static id="Static02" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 554 40 564 86" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 256 40 286 86" anchor="left top"/>
        <Static id="Static07" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 486 40 516 86" anchor="left top"/>
        <Static id="Static03" text="센 터" class="sta_WFSA_label" position="absolute 15 42 57 63" anchor="left top"/>
        <Static id="Static51" text="W05." visible="false" position="absolute 0 61 1090 66" style="background:#ff000055;align:center middle;"/>
        <Static id="Static10" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 738 40 768 86" anchor="left top"/>
        <Static id="Static12" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 826 40 836 86" anchor="left top"/>
        <Static id="Static15" text="출력구분" class="sta_WFSA_label" position="absolute 286 66 351 87"/>
        <Combo id="cbo_GB" taborder="8" codecolumn="CODE" datacolumn="NAME" index="-1" displayrowcount="10" position="absolute 836 65 989 86" innerdataset="@ds_Gb" visible="false"/>
        <Combo id="cbo_centerCode" taborder="0" position="absolute 61 40 256 62" innerdataset="@ds_center" codecolumn="cd" datacolumn="cdNm" class="cmb_WF_Essential" index="-1" onitemchanged="cbo_centerCode_onitemchanged" canitemchange="cbo_centerCode_canitemchange"/>
        <CheckBox id="chk_Minus" taborder="10" tabstop="false" text="감량/반품(-)표시" position="absolute 836 40 951 61" visible="false"/>
        <Button id="btn_upjang" taborder="4" tabstop="false" class="btn_WF_popSearch" position="absolute 718 40 739 61" onclick="btn_upjang_onclick" visible="false"/>
        <Edit id="edt_upjang" taborder="3" readonly="false" autoselect="true" position="absolute 564 40 719 61" onkeydown="edt_upjang_onkeydown" ontextchanged="edt_upjang_ontextchanged" visible="false"/>
        <Edit id="edt_subinv" taborder="6" readonly="true" autoselect="true" position="absolute 564 65 719 86" visible="false"/>
        <Button id="btn_subinv" taborder="7" tabstop="false" class="btn_WF_popSearch" position="absolute 718 65 739 86" onclick="btn_subinv_onclick" visible="false"/>
        <Button id="btn_InitEdit" taborder="11" text="업장/창고 초기화" class="btn_WF_Function" position="absolute 1008 40 1132 60" anchor="default" onclick="btn_InitEdit_onclick" visible="false"/>
        <MaskEdit id="me_NeedDate" taborder="1" type="string" mask="####-##-##" onsetfocus="g_Date_OnFocus" onkillfocus="me_NeedDate_onkillfocus" onkeydown="me_NeedDate_onkeydown" oneditclick="g_Date_OnFocus" canchange="me_NeedDate_canchange" ontextchanged="me_NeedDate_ontextchanged" class="msk_WF_Cal" position="absolute 366 40 468 61" autoselect="true"/>
        <Button id="btn_NeedDate" taborder="2" tabstop="false" onclick="g_CalButton_OnClick" class="btn_WF_cal" position="absolute 465 40 486 61" userdata="me_NeedDate"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_Subinv" useclientlayout="false">
        <ColumnInfo>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="SUBINV_NAME_DISP" size="100" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CrdInfo">
        <ColumnInfo>
          <Column id="CREDIT_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="CREDIT_AMOUNT_CONTROL_YN" size="1" type="STRING"/>
          <Column id="CREDIT_AMOUNT_TOT" size="22" type="BIGDECIMAL"/>
          <Column id="CREDIT_AVAIL_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="CREDIT_EXT_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="CREDIT_EXT_DAYS" size="22" type="BIGDECIMAL"/>
          <Column id="CREDIT_OVER_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="CREDIT_RMN_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="CREDIT_TURN_CONTROL_YN" size="1" type="STRING"/>
          <Column id="CREDIT_TURN_DAYS" size="22" type="BIGDECIMAL"/>
          <Column id="CREDIT_TURN_DAYS_TOT" size="22" type="BIGDECIMAL"/>
          <Column id="L_BILL_DATE" size="8" type="STRING"/>
          <Column id="L_BILL_DATE_DISP" size="50" type="STRING"/>
          <Column id="LAST_TURN_CNT" size="22" type="BIGDECIMAL"/>
          <Column id="PO_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="PR_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="RMN_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="TR_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="ACNTCD" size="30" type="STRING"/>
          <Column id="RCP_AMT" size="22" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Cond">
        <ColumnInfo>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="UPJANG" size="22" type="INT"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Gb" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_prtGB" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cdNm" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="cd"/>
            <Col id="cdNm"/>
          </Row>
          <Row>
            <Col id="cdNm">일괄1</Col>
            <Col id="cd">01</Col>
          </Row>
          <Row>
            <Col id="cdNm">일괄2</Col>
            <Col id="cd">02</Col>
          </Row>
          <Row>
            <Col id="cd">03</Col>
            <Col id="cdNm">일괄3</Col>
          </Row>
          <Row>
            <Col id="cd">04</Col>
            <Col id="cdNm">일괄4</Col>
          </Row>
          <Row>
            <Col id="cd">05</Col>
            <Col id="cdNm">일괄5</Col>
          </Row>
          <Row>
            <Col id="cd">06</Col>
            <Col id="cdNm">일괄6</Col>
          </Row>
          <Row>
            <Col id="cd">07</Col>
            <Col id="cdNm">일괄7</Col>
          </Row>
          <Row>
            <Col id="cd">08</Col>
            <Col id="cdNm">일괄8</Col>
          </Row>
          <Row>
            <Col id="cd">09</Col>
            <Col id="cdNm">일괄9(검수서)</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_center" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cdNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search">
        <ColumnInfo>
          <Column id="needDate" size="256" type="STRING"/>
          <Column id="upjang" size="256" type="STRING"/>
          <Column id="centerCode" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">Y</Col>
            <Col id="insYn">N</Col>
            <Col id="delYn">N</Col>
            <Col id="savYn">N</Col>
            <Col id="prtYn">N</Col>
            <Col id="exlYn">N</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_upjang" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cdNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_edtUpjang" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_edtUpjang_oncolumnchanged">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cdNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_edtSubinv" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cd" type="STRING" size="256"/>
          <Column id="cdNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_InUpjang" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schUpjang" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="schCenter" type="STRING" size="256"/>
          <Column id="schMainUpjang" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_outPrt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="upjangnm" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="ctprtFlag" type="STRING" size="256"/>
          <Column id="ctprtPricegb" type="STRING" size="256"/>
          <Column id="ctprtType" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="ctprtAllgb" type="STRING" size="256"/>
          <Column id="ctprtCrdgb" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ProCrdChk" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="AVG_TIME" type="STRING" size="256"/>
          <Column id="MAX_TIME" type="STRING" size="256"/>
          <Column id="CHK" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="edt_upjang" propid="value" datasetid="ds_edtUpjang" columnid="cdNm"/>
      <BindItem id="item1" compid="edt_subinv" propid="value" datasetid="ds_edtSubinv" columnid="cdNm"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
  화 면 명 : FMP00379R
  파 일 명 : FMP00379R.xfdl
  기    능 : 거래명세서(식재영업/센터출력용)

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.09.02   ajn      최초 생성
*/ 
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"				// 시스템 공통
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"		//JAVA 코딩시
//@@컨버터에서 주석처리 #include "LIB::tit_comm_0001.js"		// X-Framework Lib
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"		// 공통팝업
//@@컨버터에서 주석처리 #include "lib::fm_common.js"			// FM공통
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var fa_Sql;
var fvCboUpjangCd = "";
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	//초기화
   	fsp_init(this);
   	v_ds_check = "";
   	
   	// 초기값 셋팅
	////////////////////////////////////////////////////////////////////
	me_NeedDate.value = gfn_today();

	fn_searchCenter();
	edt_upjang.value = g_Upjang;
	edt_upjang.userdata = g_UpjangNm;
	
	trace(edt_upjang.value + "|" + edt_upjang.userdata);
    
	//입고일자 초기화
    //출력구분 설정, 사업장인 경우 본사용 출력불가
    /*
	ds_Gb.clearData();
	var nRow = ds_Gb.addRow();
	ds_Gb.setColumn(nRow, "CODE","운영:FMP00350R_R01.ozr");
	ds_Gb.setColumn(nRow, "NAME","일반사업장");
	
	nRow = ds_Gb.addRow();
	ds_Gb.setColumn(nRow, "CODE","운영:FMP00350R_R01.ozr");
	ds_Gb.setColumn(nRow, "NAME","가맹사업장");
	
	if (application.g_UserKind != '사업장') {
		nRow = ds_Gb.addRow();
		ds_Gb.setColumn(nRow, "CODE","일반:FMP00350R_R01.ozr");
		ds_Gb.setColumn(nRow, "NAME","일반본사");
		
		nRow = ds_Gb.addRow();
		ds_Gb.setColumn(nRow, "CODE","일반:FMP00350R_R01.ozr");
		ds_Gb.setColumn(nRow, "NAME","가맹본사");
		
		nRow = ds_Gb.addRow();
		ds_Gb.setColumn(nRow, "CODE","장려:FMP00350R_R01.ozr");
		ds_Gb.setColumn(nRow, "NAME","일반본사(장려금제외)");
		
		nRow = ds_Gb.addRow();
		ds_Gb.setColumn(nRow, "CODE","장려:FMP00350R_R01.ozr");
		ds_Gb.setColumn(nRow, "NAME","가맹본사(장려금제외)");
	}
	
	nRow = ds_Gb.addRow();
	ds_Gb.setColumn(nRow, "CODE","수량:FMP00350R_R01.ozr");
	ds_Gb.setColumn(nRow, "NAME","수량만표시");
	
	nRow = ds_Gb.addRow();
	ds_Gb.setColumn(nRow, "CODE","일반:FMP00353R_R01.ozr");
	ds_Gb.setColumn(nRow, "NAME","추가양식");
<<<<<<< .mine
	*/
	
	ds_Gb.clearData();
	var nRow = ds_Gb.addRow();
	ds_Gb.setColumn(nRow, "CODE","운영:FICS_거래명세서.ozr");
	ds_Gb.setColumn(nRow, "NAME","일반사업장");
	
	nRow = ds_Gb.addRow();
	ds_Gb.setColumn(nRow, "CODE","운영:FICS_거래명세서.ozr");
	ds_Gb.setColumn(nRow, "NAME","가맹사업장");
	
	if (application.g_UserKind != '사업장') {
		nRow = ds_Gb.addRow();
		ds_Gb.setColumn(nRow, "CODE","일반:FICS_거래명세서.ozr");
		ds_Gb.setColumn(nRow, "NAME","일반본사");
		
		nRow = ds_Gb.addRow();
		ds_Gb.setColumn(nRow, "CODE","일반:FICS_거래명세서.ozr");
		ds_Gb.setColumn(nRow, "NAME","가맹본사");
		
		nRow = ds_Gb.addRow();
		ds_Gb.setColumn(nRow, "CODE","장려:FICS_거래명세서.ozr");
		ds_Gb.setColumn(nRow, "NAME","일반본사(장려금제외)");
		
		nRow = ds_Gb.addRow();
		ds_Gb.setColumn(nRow, "CODE","장려:FICS_거래명세서.ozr");
		ds_Gb.setColumn(nRow, "NAME","가맹본사(장려금제외)");
	}
	
	nRow = ds_Gb.addRow();
	ds_Gb.setColumn(nRow, "CODE","수량:FICS_거래명세서.ozr");
	ds_Gb.setColumn(nRow, "NAME","수량만표시");
	
	nRow = ds_Gb.addRow();
	ds_Gb.setColumn(nRow, "CODE","일반:FICS_거래명세서_추가양식.ozr");
	ds_Gb.setColumn(nRow, "NAME","추가양식");

	//trace(g_UserKind);
	
	ds_Gb.clearData();
	var nRow = ds_Gb.addRow();
	ds_Gb.setColumn(nRow, "CODE","운영:FICS_거래명세서.ozr");
	ds_Gb.setColumn(nRow, "NAME","일반사업장");
	
	nRow = ds_Gb.addRow();
	ds_Gb.setColumn(nRow, "CODE","운영:FICS_거래명세서.ozr");
	ds_Gb.setColumn(nRow, "NAME","가맹사업장");
	
	if (application.g_UserKind != '사업장') {
		nRow = ds_Gb.addRow();
		ds_Gb.setColumn(nRow, "CODE","일반:FICS_거래명세서.ozr");
		ds_Gb.setColumn(nRow, "NAME","일반본사");
		
		nRow = ds_Gb.addRow();
		ds_Gb.setColumn(nRow, "CODE","일반:FICS_거래명세서.ozr");
		ds_Gb.setColumn(nRow, "NAME","가맹본사");
		
		nRow = ds_Gb.addRow();
		ds_Gb.setColumn(nRow, "CODE","장려:FICS_거래명세서.ozr");
		ds_Gb.setColumn(nRow, "NAME","일반본사(장려금제외)");
		
		nRow = ds_Gb.addRow();
		ds_Gb.setColumn(nRow, "CODE","장려:FICS_거래명세서.ozr");
		ds_Gb.setColumn(nRow, "NAME","가맹본사(장려금제외)");
	}
	
	nRow = ds_Gb.addRow();
	ds_Gb.setColumn(nRow, "CODE","수량:FICS_거래명세서.ozr");
	ds_Gb.setColumn(nRow, "NAME","수량만표시");
	
	nRow = ds_Gb.addRow();
	ds_Gb.setColumn(nRow, "CODE","일반:FICS_거래명세서_추가양식.ozr");
	ds_Gb.setColumn(nRow, "NAME","추가양식");
	
	//신규 추가
	//nRow = ds_Gb.addRow();
	//ds_Gb.setColumn(nRow, "CODE","01:FMP00359R_R01.ozr");
	//ds_Gb.setColumn(nRow, "NAME","과면세");
	
	
	
	cbo_GB.index = 0;
	cbo_prtGB.index = 0;
	
	ds_edtUpjang.addRow();
	ds_edtSubinv.addRow();

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 센터 코드 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchCenter()
{
	//센터 조회//조회 조건 없음
	ds_search.clearData();
    ds_search.addRow();
    
	var strSvcID    = "search";
    var strURL      = "/fm/fmp/itemSalesDealSheet/selectCenter.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_center=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = false;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	cbo_centerCode.index = 0;
}

//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*------------------------------------------------------------(60)
	1. Function ID : fn_Search()
	2. 개       요 : 거래명세서 조회
	3. 기       능 : 
	4. 인 수 설 명 : 
*/
function fn_search()
{
	
	//익일 조회인 경우
	if(me_NeedDate.value > gfn_today())
	{
		//데이터 집계완료 여부 체크
		fn_ProCrdChk();
		
		if(cbo_centerCode.value <> "300003" && ds_ProCrdChk.getColumn(0, "CHK") == "N")
		{
			var hh = gfn_subStr(ds_ProCrdChk.getColumn(0, "AVG_TIME"), 0, 2);
			var mm = gfn_subStr(ds_ProCrdChk.getColumn(0, "AVG_TIME"), 2);
			
			var hh_max = gfn_subStr(ds_ProCrdChk.getColumn(0, "MAX_TIME"), 0, 2);
			var mm_max = gfn_subStr(ds_ProCrdChk.getColumn(0, "MAX_TIME"), 2);
			
			var strMsg = "";
			
			strMsg += me_NeedDate.text + " 일자 여신정보 생성 전입니다.\r\n";
			strMsg += "[최근 일주일]\r\n";
			strMsg += "평균완료 시각 : "+hh + "시 " + mm + "분\r\n";
			strMsg += "최대완료 시각 : "+hh_max + "시 " + mm_max + "분\r\n";
			strMsg += "[문의]FC정보기획팀 02-2174-9335";
			g_Message("EE", strMsg);
			
			return;
		}
	}
	
	//필수항목 	
	if (ffn_ChkNull(cbo_centerCode.value))
	{
		g_Message("EE", "센 터" + fn_AlertMsg("005"));
		cbo_centerCode.setFocus();
		return true;
	}
	
	if ( ffn_ChkNull(me_NeedDate.value)  )
	{
		g_Message("EE", "입고일을 정확하게 입력하세요.");
		me_NeedDate.setFocus();
		return true;
	}
	
	if( gfn_isNull( ds_edtUpjang.getColumn(0, "cd") ) &&  !gfn_isNull( ds_edtUpjang.getColumn(0, "cdNm") ) )
	{
		alert( ds_edtUpjang.getColumn(0, "cd") + "======" + ds_edtUpjang.getColumn(0, "cdNm") );
		g_Message("EE", "검색되지 않아 코드가 없는 업장입니다. 업장을 검색후 조회하세요.");
		btn_upjang.setFocus();
		return true;
	}
	
	//가맹양식인 경우 여신정보
	if (gfn_subStr(cbo_GB.text,0,2)== "가맹")
	{
		fn_GetCredit();
		if (ds_CrdInfo.rowcount < 1)
		{
			g_Message("EE","여신정보를 조회할 수 없습니다.\n\n관리자에게 문의하세요.");
			return;
		}
	}
	
	//센터가 선택되고 업장이 선택되지 않은 경우 전체 출력(일괄출력이 선택되어 있어어야 함)
	if( gfn_isNull( ds_edtUpjang.getColumn(0,"cd") ) )
	{
		if( gfn_isNull( cbo_prtGB.value ) )
		{
			g_Message("EE","출력구분이 누락되었습니다.");
			return;
		}
		
		if( !confirm( "모든 업장에 대해 일괄출력 하시겠습니까?" ) )
		{
			return;
		}
	}
	
	//검수서 출력
	if(cbo_prtGB.value == "09")
	{
		fn_printFMP00452();
	}
	else
	{
		// 출력
		var strParam;
		strParam  = gv_ozReport + "?" + gfn_getGlobalVariableUrl();
		strParam += "&url=/FICS/" + encodeURI(gfn_subStr(cbo_GB.value,3));
		//strParam += "&url=/FICS/FICS_거래명세서.ozr";
		
		//test
		trace("cbo_GB.value >> " + cbo_GB.value);
		trace("cbo_GB.text >> " + cbo_GB.text);
		
		if("01:FMP00359R_R01.ozr" == cbo_GB.value )//과면세인 경우
		{
			strParam += "&cnt=19";											// Parameters Count
			
		}
		else //과면세가 아닌경우
		{
			strParam += "&cnt=18";											// Parameters Count
		}
		
		strParam += "&p1=" + me_NeedDate.value;							//시작일
		strParam += "&p2=" + me_NeedDate.value;							//종료일
		
		var sSubinvTmp = "";
		if( !gfn_isNull(ds_edtSubinv.getColumn(0,"cd")) )
		{
			sSubinvTmp = ds_edtSubinv.getColumn(0,"cd");
		}
		strParam += "&p3=" + sSubinvTmp;								//창고
		strParam += "&p4=" + cbo_centerCode.value;						//주문번호가 아니고 센터코드
		
		var sUpjangTmp = "";
		if( !gfn_isNull(ds_edtUpjang.getColumn(0,"cd")) )
		{
			sUpjangTmp = ds_edtUpjang.getColumn(0,"cd");
		}
		strParam += "&p5=" + sUpjangTmp;								//사업장
		strParam += "&p6=" + application.g_EmpNo;						//사번
		strParam += "&p7=" + encodeURI(gfn_subStr(cbo_GB.value,0,2));	//출력구분
		
		if (chk_Minus.value) 
			strParam += "M"; else strParam += "P";
		
		if (gfn_subStr(cbo_GB.text,0,2)== "가맹")
		{
			strParam += "&p8=" + ds_CrdInfo.getColumn(0,"ACNTCD");	//계좌번호
			strParam += "&p9=" + ds_CrdInfo.getColumn(0,"CREDIT_AMOUNT_TOT");	//책정금액
			strParam += "&p10=" + ds_CrdInfo.getColumn(0,"BMJ_AMT");	//전월잔고액
			strParam += "&p11=" + gfn_toString( toNumber(ds_CrdInfo.getColumn(0,"TR_AMT"))
										  + toNumber(ds_CrdInfo.getColumn(0,"PO_AMT"))
										  + toNumber(ds_CrdInfo.getColumn(0,"PR_AMT"))
										  );	//당월주문액
			strParam += "&p12=" + ds_CrdInfo.getColumn(0,"CREDIT_RMN_AMT");	//주문가능액
			strParam += "&p15=" + ds_CrdInfo.getColumn(0,"RCP_AMT");	//당월입금액
			strParam += "&p16=" + gfn_toString( toNumber(ds_CrdInfo.getColumn(0,"BMJ_AMT"))
										  + toNumber(ds_CrdInfo.getColumn(0,"TR_AMT"))
										  + toNumber(ds_CrdInfo.getColumn(0,"PO_AMT"))
										  + toNumber(ds_CrdInfo.getColumn(0,"PR_AMT"))
										  - toNumber(ds_CrdInfo.getColumn(0,"RCP_AMT"))
										  );	//잔고총액
		}
		else
		{
			strParam += "&p8=-1";	//계좌번호
			
			if(gfn_isNull(edt_upjang.value))	//업장이 비어있어 통합출력일 때
			{
				strParam += "&p9=-666";		//검수정보
			}else{
				strParam += "&p9=-1";		//여신정보
			}
			
			//strParam += "&p9=-1";		//여신정보
			strParam += "&p10=-1";	//외상매출잔액
			strParam += "&p11=-1";	//매입금액
			strParam += "&p12=-1";	//가용여신
			strParam += "&p15=-1";	//당월입금
			strParam += "&p16=-1";	//잔고총액
		}
		
		strParam += "&p13=" + cbo_Type.value;							//출력선택('0':일반거래명세서, '1':고객사거래명세서)
		strParam += "&p14=" + cbo_prtGB.value;							//일괄출력구분(IRIS에서 사용) //신규 추가
		
		trace("cbo_prtGB.value >> " + cbo_prtGB.value);
		
		strParam += "&p17=" + fsp_getServerDir("FMS_UPJANG_STAMP")+"/";	//STAMP 경로
		
		if("01:FMP00359R_R01.ozr" == cbo_GB.value )//과면세인 경우
		{
			strParam += "&p18=" + "01";	//STAMP 경로
			
		}
		
		strParam += "&zoom=150";										// 화면 출력 크기
		
		trace(strParam);
		wb_Oz.url = strParam;
	}
}

//검수서 출력(20171024 유선미)
function fn_printFMP00452()
{
	//레포트에 전달할 파라메터 생성
	var arrParams	= SCReport.newParams ();
	
	//(필수) 레포트명
	SCReport.setParams (arrParams, SCReport.RPT_NAME, "/FICS/FMP00452V_R01.ozr");

	//출력 옵션 설정
	SCReport.setParams (arrParams, SCReport.RPT_TITLE, "검수서");

	//레포트에 맞게 전달되는 개발자 정의 파라미터
	SCReport.setParams (arrParams, "PARAM4", "");
	SCReport.setParams (arrParams, "PARAM3", me_NeedDate.value);
	SCReport.setParams (arrParams, "PARAM5", "ITEM_NAME");
	SCReport.setParams (arrParams, "PARAM6", "전체");
	SCReport.setParams (arrParams, "PARAM9", me_NeedDate.value + " (" + ffn_DayToWeek(me_NeedDate.value) + ")");	
	SCReport.setParams (arrParams, "PARAM11", "");
	SCReport.setParams (arrParams, "PARAM12", cbo_centerCode.value);
	SCReport.setParams (arrParams, "PARAM13", "FMP00379R");
	SCReport.setParams (arrParams, "zoom", 120);
	
	trace(SCReport.getParams (arrParams, "PARAM3"));
	trace(SCReport.getParams (arrParams, "PARAM9"));	
	trace(SCReport.getParams (arrParams, "PARAM12"));
	
	SCReport.viewReport (this, arrParams);
}

/*------------------------------------------------------------
	1. Function ID : fn_Insert()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_insert()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Delete()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_delete()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Save()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_save()
{
}

/*------------------------------------------------------------
	1. Function ID : fn_Print()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_print()
{
	fn_search();
}

/*------------------------------------------------------------
	1. Function ID : fn_Close()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_Close()
{
	This.close();
}

/*------------------------------------------------------------
	1. Function ID : fn_Help()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_help()
{
}

//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*------------------------------------------------------------
	1. Function ID : fn_AlertMsg(cd)
	2. 개       요 : 메세지 처리
	3. 기       능 : 화면에 나타나는 메시지 코드및 텍스트 리턴
	4. 인 수 설 명 : cd : 원하는 메시지 코드
*/
function fn_AlertMsg(cd)
{
	var v_Msg="";
	switch(cd)
	{
		case "000":
			v_Msg= "이(가) 저장되었습니다.";
			break;
		case "001":
			v_Msg= "버튼이 정의 되어 있지않습니다.";
			break;
		case "002":
			v_Msg="서비스 오류:시스템 관리자에게 문의하십시오";
			break;
		case "003":
			v_Msg="필수항목은 반드시 선택하시기 바랍니다.";
			break;	
		case "004":
			v_Msg="작업대상 본사를 선택하세요.";
			break;
		case "005":
			v_Msg="을(를) 입력하세요";
			break;
		case "006":
			v_Msg="삭제할 데이터가 없습니다.";
			break;
		case "007":
			v_Msg="변경된 데이터가 없습니다.";
			break;
		case "008":
			v_Msg="시스템ID가 없습니다.";
			break;						
		default:
			break;			
	}
	return v_Msg;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 조건 체크
 *---------------------------------------------------------------------------------------------*/
function fn_ChkManNull()
{
	if (ffn_ChkNull(cbo_upjang.value))
	{
		g_Message("EE", "사업장" + fn_AlertMsg("005"));
		if (edt_upjang.enable) edt_upjang.setFocus();
		return true;
	}
	
	if ( ffn_ChkNull(me_NeedDate.value) || (gfn_length(me_NeedDate.value) < 8) )
	{
		g_Message("EE", "입고일을 정확하게 입력하세요.");
		me_NeedDate.setFocus();
		
		return true;
	}
	
	//
	return false;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 폼에서 엔터키가 눌렸을 때
 *---------------------------------------------------------------------------------------------*/
function fn_FormKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); 
	
	//입고구분에서 엔터시 조회
	if ( (e.keycode == 13) && (e.fromreferenceobject.parent == cbo_Type) ) 
		fn_search();
}	

/*----------------------------------------------------------------------------------------------
 * 설명      : 
 *---------------------------------------------------------------------------------------------*/
function fn_GetCredit()
{
/*
	if (! fn_GetCrdYn())
	{
		ds_CrdInfo.ClearData();
		ds_CrdInfo.AddRow();
		ds_CrdInfo.SetColumn(0,"ACNTCD","-1");
		ds_CrdInfo.SetColumn(0,"CREDIT_AMOUNT_TOT",-1);
		return;
	}
*/
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 초기화
	ds_Cond.clearData();
	ds_CrdInfo.clearData();
	ds_Cond.addRow();
	ds_Cond.setColumn(0, "UPJANG",         ds_edtUpjang.getColumn( 0, "cd") );
	ds_Cond.setColumn(0, "NEED_DATE",      me_NeedDate.value);
	
	// 조회
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	
	// 경로 설정
	strSvcID = "FMZ_CREDIT_INFO_PRT_T001";
	strURL   = "U_svc::" + "fm/fmz/FMZ_CREDIT_INFO_PRT_T001.jsp";
	
	// 데이터셋 설정
	strInDatasets  = "ds_Cond=ds_Cond";
	strOutDatasets = "ds_CrdInfo=ds_List";
	
	// 파라메터 설정
	strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
	strArgument += " sIgnorCtrl='Y'";
	
	// 서버 호출 
	Transaction(strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc);
	
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	
	ta_Sql.value = fa_Sql;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 
 *---------------------------------------------------------------------------------------------*/
function fn_GetCrdYn()
{
	//ds임시생성
	var dsObjin, dsObjot;
		
	create("Dataset", "ds_Dummyin");
	create("Dataset", "ds_Dummyot");
	
	dsObjin = eval("ds_Dummyin");
	dsObjin.addColumn("UPJANG", "INT", 22);
	dsObjin.addColumn("NEED_DATE", "STRING", 8);
	
	dsObjot = eval("ds_Dummyot");
	dsObjot.addColumn("CRD_YN", "STRING", 1);
	
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	
	// 초기화
	ds_Dummyin.clearData();
	ds_Dummyot.clearData();
	ds_Dummyin.addRow();
	ds_Dummyin.setColumn(0, "UPJANG",         ds_edtUpjang.getColumn( 0, "cd") );
	ds_Dummyin.setColumn(0, "NEED_DATE",      me_NeedDate.value);
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    inData		= "ds_Cond=ds_Dummyin";
    outData		= "ds_Dummyot=ds_List";
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_CREDIT_CHKYN_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/

	var bYn = (ds_Dummyot.rowcount > 0);

	//ds임시생성 해제
	Destroy("ds_Dummyin");
	Destroy("ds_Dummyot");

	return  bYn;
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
function gd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if (obj.getCellProperty("head",nCell,"backgroundimage") == "ico_Excel")
		gfn_exportExcel(obj, this.titletext);
	else 
		gfn_gridSort(obj, e); 
}


/*
 ******************************************************************************************
 * 함  수  명   : fn_callBack
 * 입      력   : 
 * 반      환   : 
 * 기      능   : 트랜잭션 콜백 함수 (필수)
 * 작  성  자   : 
 * 작성  일자   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {
		// 코드분류 조회
        case "search" :
        
            break;
        
        // 저장
        case "save" :
			gfn_alert("msg.save.success");	// 저장 되었습니다.
		
            break;
		case "save3" :
			gfn_alert("msg.save.success");	// 저장 되었습니다.
			
			break;
    }
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 센터 변경시 이벤트
 *---------------------------------------------------------------------------------------------*/
function cbo_centerCode_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	//업장, 창고 데이타셋 초기화
	ds_edtUpjang.setColumn(0, "cd", "");  //사업장 코드
	ds_edtUpjang.setColumn(0, "cdNm", "");//사업장 이름	
	ds_edtSubinv.setColumn(0, "cd", "");  //창고 코드
	ds_edtSubinv.setColumn(0, "cdNm", "");//창고 이름	
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 업장 변경시 이벤트
 *---------------------------------------------------------------------------------------------*/
function ds_edtUpjang_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	ds_edtSubinv.setColumn(0, "cd", "");  //창고 코드
	ds_edtSubinv.setColumn(0, "cdNm", "");//창고 이름	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 날짜 변경시 이벤트
 *---------------------------------------------------------------------------------------------*/
function me_NeedDate_onchanged(obj:Calendar, e:ChangeEventInfo)
{
	//업장, 창고 데이터 초기화
	ds_edtUpjang.setColumn(0, "cd", "");  //사업장 코드
	ds_edtUpjang.setColumn(0, "cdNm", "");//사업장 이름	
	ds_edtSubinv.setColumn(0, "cd", "");  //창고 코드
	ds_edtSubinv.setColumn(0, "cdNm", "");//창고 이름	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 센터 코드 변경시 이벤트
 *---------------------------------------------------------------------------------------------*/
function cbo_centerCode_canitemchange(obj:Combo, e:ItemChangeEventInfo)
{
	if ( ffn_ChkNull(me_NeedDate.value)  )
	{
		g_Message("EE", "입고일을 입력하세요.");
		me_NeedDate.setFocus();
		return false;
	}
	
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 업장 정보 조회
 *---------------------------------------------------------------------------------------------*/
function btn_upjang_onclick(obj:Button,  e:ClickEventInfo)
{
	//업장조회
	fn_searchUpjang();
		
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      :  업장 정보 조회 대화상자
 *---------------------------------------------------------------------------------------------*/
function fn_searchUpjang()
{
	if( gfn_isNull(me_NeedDate.value) )
	{
		alert("입고 일자를 입력하세요.");
		return;
	}

	// 팝업 호출전 ARGUMENT 설정
	var objArg = new Array();

	objArg[0] = cbo_centerCode.value;		//센터코드
	objArg[1] = edt_upjang.value;			//업장이름
	objArg[2] = me_NeedDate.value;			//입고일자
	
	
	var strId       = "";
	var strURL      = "U_FMP::FMP00370R_P01.xfdl";                  //팝업 아이디
	var objArgument = {fv_Contents:objArg}; 							//넘겨줄 파라미터
	var nWidth      = -1;                                               //팝업 넓이 
	var nHeight     = -1;                                               //팝업 높이 
	var strStyle    = "";	                                            //팝업 스타일 정의
	var nLeft       = -1;                                               //팝업 위치 left 
	var nTop        = -1;                                               //팝업 위치 top
	var isModeless  = false;                                            //모달, 모달레스 선택
	var bShowTitle  = true;                                             //상단 타이틀을 보여줄 것인지 선택 
	var strAlign    = "-1";                                             //정렬 선택 
	var bResizable  = true;                                             //팝업창을 리사이즈 선택   

	// 리턴값을 배열로 받을 경우	
	var rtnVal = gfn_dialog( strId, 
							 strURL,      
							 objArgument, 
							 nWidth, 
							 nHeight, 
							 strStyle, 
							 nLeft, 
							 nTop, 
							 isModeless, 
							 bShowTitle, 
							 strAlign, 
							 bResizable );

	if(rtnVal != null)
	{
		ds_edtUpjang.setColumn(0, "cd", rtnVal[0]);//사업장 코드
		ds_edtUpjang.setColumn(0, "cdNm", rtnVal[1]);//사업장 이름	
	}
	
	cbo_GB.index = 2;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 창고정보 조회
 *---------------------------------------------------------------------------------------------*/
function btn_subinv_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_searchSubinv();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 창고 정보 조회 대화상자 
 *---------------------------------------------------------------------------------------------*/
function fn_searchSubinv()
{
	if( gfn_isNull( ds_edtUpjang.getColumn(0,"cd") ) )
	{
		alert("업장을 먼저 선택하십시요.");
		return;
	}
	
	// 팝업 호출전 ARGUMENT 설정
	var objArg = new Array();

	objArg[0] = ds_edtUpjang.getColumn(0,"cd");		//업장코드
	objArg[1] = ds_edtUpjang.getColumn(0,"cdNm");	//업장이름
	objArg[2] = ds_edtSubinv.getColumn(0,"cdNm");	//창고이름
	
	
	var strId       = "";
	var strURL      = "U_FMP::FMP00370R_P02.xfdl";                  //팝업 아이디
	var objArgument = {fv_Contents:objArg}; 							//넘겨줄 파라미터
	var nWidth      = -1;                                               //팝업 넓이 
	var nHeight     = -1;                                               //팝업 높이 
	var strStyle    = "";	                                            //팝업 스타일 정의
	var nLeft       = -1;                                               //팝업 위치 left 
	var nTop        = -1;                                               //팝업 위치 top
	var isModeless  = false;                                            //모달, 모달레스 선택
	var bShowTitle  = true;                                             //상단 타이틀을 보여줄 것인지 선택 
	var strAlign    = "-1";                                             //정렬 선택 
	var bResizable  = true;                                             //팝업창을 리사이즈 선택   

	// 리턴값을 배열로 받을 경우	
	var rtnVal = gfn_dialog( strId, 
							 strURL,      
							 objArgument, 
							 nWidth, 
							 nHeight, 
							 strStyle, 
							 nLeft, 
							 nTop, 
							 isModeless, 
							 bShowTitle, 
							 strAlign, 
							 bResizable );

	if(rtnVal != null)
	{
		ds_edtSubinv.setColumn(0, "cd", rtnVal[0]);//사업장 코드
		ds_edtSubinv.setColumn(0, "cdNm", rtnVal[1]);//사업장 이름	
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 업장/창고 초기화 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_InitEdit_onclick(obj:Button,  e:ClickEventInfo)
{
	//업장, 창고 데이터 초기화
	ds_edtUpjang.setColumn(0, "cd", "");  //사업장 코드
	ds_edtUpjang.setColumn(0, "cdNm", "");//사업장 이름	
	ds_edtSubinv.setColumn(0, "cd", "");  //창고 코드
	ds_edtSubinv.setColumn(0, "cdNm", "");//창고 이름	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 업장에서 엔터키를 쳤을때
 *---------------------------------------------------------------------------------------------*/
function edt_upjang_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if( e.keycode == 13 )
	{
		fn_searchUpjang();
		
		var upjang = ds_edtUpjang.getColumn(0, "cdNm");
		var center = cbo_centerCode.value;
		
		//업장에 맞는 출력양식 셋팅
		setPrintForm(center, upjang);
		
		//trace(ds_outPrt.saveXML());
		trace("출력구분 : " + ds_outPrt.getColumn(0,"ctprtFlag"));		//출력구분
		trace("단가구분 : " + ds_outPrt.getColumn(0,"ctprtPricegb"));	//단가구분 --> CS가 사용
		trace("출력양식 : " + ds_outPrt.getColumn(0,"ctprtType"));		//출력양식 --> CS가 사용
		trace("일괄출력 : " + ds_outPrt.getColumn(0,"ctprtAllgb"));	//일괄출력
		
		
		
		//출력구분 = 일괄출력
		cbo_prtGB.index = ds_outPrt.getColumn(0,"ctprtAllgb");
		
		//출력양식1
		if(ds_outPrt.getColumn(0,"ctprtPricegb") == "운영")
		{
			cbo_GB.index = 0;
			//ds_Gb.value = "운영:FICS_거래명세서.ozr";
		}else if (ds_outPrt.getColumn(0,"ctprtPricegb") == "수량"){
			cbo_GB.index = 6;
			//ds_Gb.value = "수량:FICS_거래명세서.ozr";
		}
		
		//출력양식2 = 출력양식  0일반 1 고객사
		if(ds_outPrt.getColumn(0,"ctprtType") == "0")
		{
			cbo_Type.index = 0;
		}else{
			cbo_Type.index = 1;
		};
	}
}

//데이타 셋에 값을 넣을때 해당 이벤트가 발생하지 않는 것을 이용하여
//텍스트 변경시 검색되지 않은 것이므로 유효하지 않은 값임으로 코드값을 초기화 한다.
/*----------------------------------------------------------------------------------------------
 * 설명      : 업장 변경시
 *---------------------------------------------------------------------------------------------*/
function edt_upjang_ontextchanged(obj:Edit,  e:TextChangedEventInfo)
{
	ds_edtUpjang.setColumn(0, "cd", "");
	

}
/*----------------------------------------------------------------------------------------------
 * 설명      : 과면세인 경우
 *---------------------------------------------------------------------------------------------*/
function fn_search2()
{
		//필수항목 
	if (fn_ChkManNull()) return;
	//가맹양식인 경우 여신정보
	if (gfn_subStr(cbo_GB.text,0,2)== "가맹")
	{
		fn_GetCredit();
		if (ds_CrdInfo.rowcount < 1)
		{
			g_Message("EE","여신정보를 조회할 수 없습니다.\n\n관리자에게 문의하세요.");
			return;
		}
	}
	//trace(gfn_subStr(cbo_GB.value,3));
	// 출력
	var strParam;
	
	strParam  = gv_ozReport + "?" + gfn_getGlobalVariableUrl();
	
	
	if ( cbo_Tax.value == "01" ) {
		strParam += "&url=/FICS/FMP00359R_R01.ozr";//과면세
	} else {
		strParam += "&url=/FICS/FMP00350R_R01.ozr";//전체
	}
	
	strParam += "&cnt=19";							// Parameters Count
	strParam += "&p1=" + me_DateF.value;	//시작일
	strParam += "&p2=" + me_DateT.value;	//종료일
	
	//테스트용 삭제요망
	strParam += "&p3=" + cbo_Subinv.value;	//창고
	strParam += "&p4=";	//주문번호
	strParam += "&p5=" + ed_Upjang.userdata;//사업장
	strParam += "&p6=" + application.g_EmpNo;	//사번
	strParam += "&p7=" + encodeURI(gfn_subStr(cbo_GB.value,0,2));	//출력구분
	if (chk_Minus.value) strParam += "M"; else strParam += "P";
	if (gfn_subStr(cbo_GB.text,0,2)== "가맹")
	{
//		strParam += "&p8=우리은행  " + ds_CrdInfo.GetColumn(0,"ACNTCD") + "  한화리조트(주)";	//계좌번호
		strParam += "&p8=" + ds_CrdInfo.getColumn(0,"ACNTCD");	//계좌번호
		strParam += "&p9=" + ds_CrdInfo.getColumn(0,"CREDIT_AMOUNT_TOT");	//책정금액
		strParam += "&p10=" + ds_CrdInfo.getColumn(0,"RMN_AMT");	//외상매출잔액
		strParam += "&p11=" + gfn_toString( toNumber(ds_CrdInfo.getColumn(0,"TR_AMT"))
		                              + toNumber(ds_CrdInfo.getColumn(0,"PO_AMT"))
		                              + toNumber(ds_CrdInfo.getColumn(0,"PR_AMT"))
		                              );	//매입금액
		strParam += "&p12=" + ds_CrdInfo.getColumn(0,"CREDIT_RMN_AMT");	//가용여신
		strParam += "&p15=" + ds_CrdInfo.getColumn(0,"RCP_AMT");	//당월입금
		strParam += "&p16=" + gfn_toString( toNumber(ds_CrdInfo.getColumn(0,"RMN_AMT"))
		                              + toNumber(ds_CrdInfo.getColumn(0,"TR_AMT"))
		                              + toNumber(ds_CrdInfo.getColumn(0,"PO_AMT"))
		                              + toNumber(ds_CrdInfo.getColumn(0,"PR_AMT"))
		                              - toNumber(ds_CrdInfo.getColumn(0,"RCP_AMT"))
		                              );	//잔고총액
	}
	else
	{
		strParam += "&p8=-1";	//계좌번호
		strParam += "&p9=-1";	//책정금액
		strParam += "&p10=-1";	//외상매출잔액
		strParam += "&p11=-1";	//매입금액
		strParam += "&p12=-1";	//가용여신
		strParam += "&p15=-1";	//당월입금
		strParam += "&p16=-1";	//잔고총액//
	}
	strParam += "&p13=" + cbo_Type.value;	//출력선택('0':일반거래명세서, '1':고객사거래명세서)
	strParam += "&p14=";	//일괄출력구분(IRIS에서 사용)
	strParam += "&p17=" + fsp_getServerDir("FMS_UPJANG_STAMP")+"/";	//STAMP 경로
	strParam += "&p18=" + cbo_Tax.value;	//STAMP 경로
	strParam += "&zoom=150";						// 화면 출력 크기
	//ffn_Alert(strParam);
	//trace(strParam);
	wb_Oz.url = strParam;//g_OzUrl + strParam;
	//strReturn = gfn_dialog("", "U_SCC::SCCOZREPORT1.xfdl",{fstrParam:strParam});
	/* Run은 지원되지 않는 메서드입니다.*/ //wb_Oz.Run();
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 화면을 로드한 후 또는 업장을 바꾼 후 출력양식을 셋팅하는 함수
 *---------------------------------------------------------------------------------------------*/
function setPrintForm(center, upjang)
{
	//인데이터 셋 설정
	ds_InUpjang.clearData();
	ds_InUpjang.addRow();
	ds_InUpjang.setColumn(0,"schCenter",center);
	ds_InUpjang.setColumn(0,"schMainUpjang","");
	ds_InUpjang.setColumn(0,"schUpjang",upjang);
	ds_InUpjang.setColumn(0,"useYn","Y");
	
	//Transaction 설정
	var strSvcID    = "fmp00379r_001";
    var strURL      = "fm/fmo/foodMaterialsSalePrintSet/selectList.xdo";
    var strInDs     = "ds_search=ds_InUpjang:A";
    var strOutDs    = "ds_outPrt=ds_list";
    var strArg      = "";
    var strCallback = ""; 
    var bAsync      = false;	
    
    //서버호출
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}


function me_NeedDate_onkeydown(obj:MaskEdit, e:KeyEventInfo)
{
	if (e.keycode == 13) {
		g_Date_OnKillFocus(obj);
	}	
}

/*통합 일괄 출력전에 집계 프로시저가 제대로 돌았는지를 확인해주는 로직*/
function fn_ProCrdChk()
{
	// 초기화
	ds_ProCrdChk.clearData();
	
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, bAsync;
	
	strSvcID 		= "FMZ_CREDIT_CHK";
	strURL   		= "U_svc::" + "fm/fmz/FMZ_CREDIT_CHK.jsp";
	strInDatasets  	= "";
	strOutDatasets 	= "ds_ProCrdChk=ds_List";
	strArgument  	= "needDate=" + wrapQuote(me_NeedDate.value);	
	strCallbackFunc = "";
	bAsync = false;
	
	// 서버 호출 
	//Transaction 하고 transaction 하고 기능은 똑같은데 Transaction은 bAsync가 작동하지 않음...)
	transaction(strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, bAsync);
}

]]></Script>
  </Form>
</FDL>

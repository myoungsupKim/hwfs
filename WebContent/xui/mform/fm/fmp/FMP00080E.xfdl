<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FMP00080E" onactivate="FMP00080E_OnActivate" ondeactivate="FMP00080E_OnDeactivate" onkeydown="fn_FormKeyDown" onload="form_onload" ontimer="FMP00080E_OnTimer" titletext="상품발주" position="absolute 0 0 996 593" scrollbars="none" onsize="FMP00080E_onsize">
    <Layouts>
      <Layout>
        <Static id="Static14" class="sta_WFDA_Labelbg" position="absolute 0 376 981 403" anchor="left top right"/>
        <Static id="Static00" class="sta_WFDA_Labelbg" position="absolute 601 128 832 155" anchor="left top" visible="false"/>
        <Static id="Static49" class="sta_WFDA_Labelbg" position="absolute 78 86 981 113" anchor="left top right"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 981 71" anchor="left top right"/>
        <Edit autoselect="true" enable="false" id="ed_Green" imemode="native" taborder="25" tabstop="false" visible="false" position="absolute 714 131 830 152" style="align:right;"/>
        <Edit autoselect="true" enable="false" id="ed_Pamt" imemode="native" taborder="22" tabstop="false" position="absolute 335 89 430 110" style="align:right;"/>
        <Grid autoenter="select" binddataset="ds_List" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="gd_list" useinputpanel="false" onselectchanged="gd_list_OnCellPosChanged" onheadclick="gd_list_OnHeadClick1" taborder="8" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 434 981 578" selecttype="row" anchor="all" onkeydown="gd_list_onkeydown" autofitminwidth="981" oncellclick="gd_list_oncellclick">
          <Formats>
            <Format id="ORI">
              <Columns>
                <Column size="25"/>
                <Column size="80"/>
                <Column size="140"/>
                <Column size="100"/>
                <Column size="0"/>
                <Column size="35"/>
                <Column size="45"/>
                <Column size="70"/>
                <Column size="50"/>
                <Column size="0"/>
                <Column size="90"/>
                <Column size="70"/>
                <Column size="90"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="70"/>
                <Column size="60"/>
                <Column size="50"/>
                <Column size="85"/>
                <Column size="120"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="0"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="20"/>
                <Row size="22" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="상품코드"/>
                <Cell col="2" displaytype="text" text="상품명"/>
                <Cell col="3" displaytype="text" text="규격"/>
                <Cell col="4" displaytype="text" text="원산지"/>
                <Cell col="5" displaytype="text" text="단위"/>
                <Cell col="6" displaytype="text" text="보관"/>
                <Cell col="7" displaytype="text" text="단가"/>
                <Cell col="8" displaytype="text" text="수량"/>
                <Cell col="9" text="총중량(㎏)"/>
                <Cell col="10" displaytype="text" text="금액"/>
                <Cell col="11" displaytype="text" text="부가세"/>
                <Cell col="12" displaytype="text" text="합계"/>
                <Cell col="13" text="총중량(㎏)"/>
                <Cell col="14" displaytype="text" text="비고(50자)"/>
                <Cell col="15" displaytype="text" text="발주상태"/>
                <Cell col="16" displaytype="text" text="마감"/>
                <Cell col="17" displaytype="text" text="마감일"/>
                <Cell col="18" text="업체직송여부"/>
                <Cell col="19" displaytype="text" text="주문번호"/>
                <Cell col="20" displaytype="text" text="발주구분"/>
                <Cell col="21" text="발주시간"/>
                <Cell col="22" text="등록자"/>
              </Band>
              <Band id="body">
                <Cell celltype="head" displaytype="text" style="align:right;backgroundimage:EXPR(expr_GetRowTypeImg(currow));" expr="expr:currow + 1"/>
                <Cell col="1" displaytype="text" style="align:center;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:ITEM_CODE"/>
                <Cell col="2" displaytype="text" style="align:left;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:ITEM_NAME"/>
                <Cell col="3" displaytype="text" style="align:left;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:ITEM_SIZE"/>
                <Cell col="4" displaytype="text" style="align:left;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:ORIGIN_TYPE"/>
                <Cell col="5" displaytype="text" style="align:center;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:PO_UOM"/>
                <Cell col="6" displaytype="text" style="align:center middle;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:KEEPING_TYPE"/>
                <Cell col="7" displaytype="number" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:OP_PRICE" mask="#,##0"/>
                <Cell col="8" displaytype="number" edittype="expr:setEditExpr(iif(CLS_STATUS=='마감',&quot;none&quot;,&quot;number&quot;))" editfilter="expr:setfilterExpr(iif(CLS_STATUS=='마감',&quot;none&quot;,&quot;number&quot;))" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;lightyellow&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;lightyellow&quot;));color:EXPR(iif(PR_QTY==0,&quot;red&quot;,&quot;default&quot;));color2:EXPR(iif(PR_QTY==0,&quot;red&quot;,&quot;default&quot;));" text="bind:PR_QTY" mask="#,##0.0" editautoselect="true"/>
                <Cell col="9" displaytype="number" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));color2: ;" text="bind:TOT_WGHT" mask="#,##0.0"/>
                <Cell col="10" displaytype="number" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:OP_AMOUNT" mask="#,##0"/>
                <Cell col="11" displaytype="number" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" expr="expr:Math.round(iif(TAX_CODE==&quot;100&quot;,0.1,0)* OP_AMOUNT)" mask="#,##0"/>
                <Cell col="12" displaytype="number" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" expr="expr:Math.round(iif(TAX_CODE==&quot;100&quot;,1.1,1)* OP_AMOUNT)" mask="#,##0"/>
                <Cell col="13" displaytype="number" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:TOT_WGHT" mask="#,##0.0#"/>
                <Cell col="14" displaytype="text" edittype="expr:setEditExpr(iif(CLS_STATUS=='마감',&quot;none&quot;,&quot;normal&quot;))" editfilter="expr:setfilterExpr(iif(CLS_STATUS=='마감',&quot;none&quot;,&quot;normal&quot;))" style="align:left;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;lightyellow&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;lightyellow&quot;));color: ;" text="bind:PR_REMARK" editlimit="100" editimemode="native" editautoselect="true"/>
                <Cell col="15" displaytype="text" style="align:center;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));color:EXPR(iif(PO_LINE_STATUS==&quot;발주취소&quot; || PO_LINE_STATUS == &quot;결의반려&quot;, &quot;red&quot;, &quot;black&quot;));color2:EXPR(iif(PO_LINE_STATUS==&quot;발주취소&quot; || PO_LINE_STATUS == &quot;결의반려&quot;, &quot;red&quot;, &quot;black&quot;));" text="bind:PO_LINE_STATUS"/>
                <Cell col="16" displaytype="text" style="align:center;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:CLS_STATUS"/>
                <Cell col="17" displaytype="text" style="align:center;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:D_DAY_DISP"/>
                <Cell col="18" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:VC_YN"/>
                <Cell col="19" displaytype="text" style="align:center;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:PR_NUM"/>
                <Cell col="20" displaytype="text" style="align:left;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:DOCU_SOURCE"/>
                <Cell col="21" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:APPROVE_TIME"/>
                <Cell col="22" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:CREATE_BY"/>
              </Band>
              <Band id="summary">
                <Cell displaytype="text" style="align:left;"/>
                <Cell col="1" displaytype="text" style="align:center;" text="합  계"/>
                <Cell col="2" displaytype="number" style="align: ;" expr="expr:getCaseCount(&quot;PR_QTY&gt;0&quot;)" mask="#,##0"/>
                <Cell col="3" displaytype="text" style="align:left;" text="건"/>
                <Cell col="4" displaytype="text" style="align:left;"/>
                <Cell col="5" displaytype="text" style="align:left;"/>
                <Cell col="6" displaytype="text" style="align:left;"/>
                <Cell col="7" displaytype="number" style="align:right middle;" expr="expr:getSum(&quot;OP_PRICE&quot;)" mask="#,##0"/>
                <Cell col="8" displaytype="number" style="align: ;" expr="expr:getSum(&quot;PR_QTY&quot;)" mask="#,##0.0"/>
                <Cell col="9" displaytype="number" expr="expr:getSum(&quot;TOT_WGHT&quot;)" mask="#,##0.0"/>
                <Cell col="10" displaytype="number" style="align: ;" expr="expr:getSum(&quot;OP_AMOUNT&quot;)" mask="#,##0"/>
                <Cell col="11" displaytype="number" style="align: ;" expr="expr:getCaseSum(&quot;TAX_CODE=='100'&quot;,&quot;Math.round(OP_AMOUNT/10)&quot;)" mask="#,##0"/>
                <Cell col="12" displaytype="number" style="align: ;" expr="expr:getSum(&quot;Math.round(iif(TAX_CODE=='100',1.1,1)* OP_AMOUNT)&quot;)" mask="#,##0"/>
                <Cell col="13"/>
                <Cell col="14" displaytype="text" style="align:left;"/>
                <Cell col="15" displaytype="text" style="align:left;"/>
                <Cell col="16" displaytype="text" style="align:left;"/>
                <Cell col="17" displaytype="text" style="align:left;"/>
                <Cell col="18"/>
                <Cell col="19" displaytype="text" style="align:left;"/>
                <Cell col="20" displaytype="text" style="align:left;"/>
                <Cell col="21"/>
                <Cell col="22"/>
              </Band>
            </Format>
            <Format id="CPY">
              <Columns>
                <Column size="25"/>
                <Column size="80"/>
                <Column size="140"/>
                <Column size="100"/>
                <Column size="0"/>
                <Column size="35"/>
                <Column size="45"/>
                <Column size="70"/>
                <Column size="50"/>
                <Column size="0"/>
                <Column size="90"/>
                <Column size="70"/>
                <Column size="90"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="87"/>
                <Column size="70"/>
                <Column size="60"/>
                <Column size="50"/>
                <Column size="85"/>
                <Column size="120"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="0"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="20"/>
                <Row size="22" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="상품코드"/>
                <Cell col="2" displaytype="text" text="상품명"/>
                <Cell col="3" displaytype="text" text="규격"/>
                <Cell col="4" displaytype="text" text="원산지"/>
                <Cell col="5" displaytype="text" text="단위"/>
                <Cell col="6" displaytype="text" style="align:center middle;" text="보관"/>
                <Cell col="7" displaytype="text" text="단가"/>
                <Cell col="8" displaytype="text" text="수량"/>
                <Cell col="9" text="총중량(㎏)"/>
                <Cell col="10" displaytype="text" text="금액"/>
                <Cell col="11" displaytype="text" text="부가세"/>
                <Cell col="12" displaytype="text" text="합계"/>
                <Cell col="13" text="총중량(㎏)"/>
                <Cell col="14" displaytype="text" text="비고(50자)"/>
                <Cell col="15" text="실발주자"/>
                <Cell col="16" displaytype="text" text="발주상태"/>
                <Cell col="17" displaytype="text" text="마감"/>
                <Cell col="18" displaytype="text" text="마감일"/>
                <Cell col="19" text="업체직송여부"/>
                <Cell col="20" displaytype="text" text="주문번호"/>
                <Cell col="21" displaytype="text" text="발주구분"/>
                <Cell col="22" text="발주시간"/>
                <Cell col="23" text="등록자"/>
              </Band>
              <Band id="body">
                <Cell celltype="head" displaytype="text" style="align:right;backgroundimage:EXPR(expr_GetRowTypeImg(currow));" expr="expr:currow + 1"/>
                <Cell col="1" displaytype="text" style="align:center;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:ITEM_CODE"/>
                <Cell col="2" displaytype="text" style="align:left;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:ITEM_NAME"/>
                <Cell col="3" displaytype="text" style="align:left;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:ITEM_SIZE"/>
                <Cell col="4" displaytype="text" style="align:left;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:ORIGIN_TYPE"/>
                <Cell col="5" displaytype="text" style="align:center;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:PO_UOM"/>
                <Cell col="6" displaytype="text" style="align:center middle;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:KEEPING_TYPE"/>
                <Cell col="7" displaytype="number" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:OP_PRICE" mask="#,##0"/>
                <Cell col="8" displaytype="number" edittype="expr:setEditExpr(iif(CLS_STATUS=='마감',&quot;none&quot;,&quot;number&quot;))" editfilter="expr:setfilterExpr(iif(CLS_STATUS=='마감',&quot;none&quot;,&quot;number&quot;))" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;lightyellow&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;lightyellow&quot;));color:EXPR(iif(PR_QTY==0,&quot;red&quot;,&quot;default&quot;));color2:EXPR(iif(PR_QTY==0,&quot;red&quot;,&quot;default&quot;));" text="bind:PR_QTY" mask="#,##0.0" editautoselect="true"/>
                <Cell col="9" displaytype="number" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));color2: ;" text="bind:TOT_WGHT" mask="#,##0.0"/>
                <Cell col="10" displaytype="number" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:OP_AMOUNT" mask="#,##0"/>
                <Cell col="11" displaytype="number" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" expr="expr:Math.round(iif(TAX_CODE==&quot;100&quot;,0.1,0)* OP_AMOUNT)" mask="#,##0"/>
                <Cell col="12" displaytype="number" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" expr="expr:Math.round(iif(TAX_CODE==&quot;100&quot;,1.1,1)* OP_AMOUNT)" mask="#,##0"/>
                <Cell col="13" displaytype="number" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:TOT_WGHT" mask="#,##0.0#"/>
                <Cell col="14" displaytype="text" edittype="expr:setEditExpr(iif(CLS_STATUS=='마감',&quot;none&quot;,&quot;normal&quot;))" editfilter="expr:setfilterExpr(iif(CLS_STATUS=='마감',&quot;none&quot;,&quot;normal&quot;))" style="align:left;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;lightyellow&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;lightyellow&quot;));color: ;" text="bind:PR_REMARK" editlimit="100" editimemode="native" editautoselect="true"/>
                <Cell col="15" displaytype="text" edittype="expr:expr:setEditExpr(iif(CLS_STATUS=='마감',&quot;none&quot;,&quot;text&quot;))" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:T_ORDER"/>
                <Cell col="16" displaytype="text" style="align:center;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));color:EXPR(iif(PO_LINE_STATUS==&quot;발주취소&quot; || PO_LINE_STATUS == &quot;결의반려&quot;, &quot;red&quot;, &quot;black&quot;));color2:EXPR(iif(PO_LINE_STATUS==&quot;발주취소&quot; || PO_LINE_STATUS == &quot;결의반려&quot;, &quot;red&quot;, &quot;black&quot;));" text="bind:PO_LINE_STATUS"/>
                <Cell col="17" displaytype="text" style="align:center;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:CLS_STATUS"/>
                <Cell col="18" displaytype="text" style="align:center;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:D_DAY_DISP"/>
                <Cell col="19" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:VC_YN"/>
                <Cell col="20" displaytype="text" style="align:center;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:PR_NUM"/>
                <Cell col="21" displaytype="text" style="align:left;background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:DOCU_SOURCE"/>
                <Cell col="22" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:APPROVE_TIME"/>
                <Cell col="23" style="background:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));background2:EXPR(iif(CLS_STATUS==&quot;마감&quot;,&quot;thistle&quot;,&quot;white&quot;));" text="bind:CREATE_BY"/>
              </Band>
              <Band id="summary">
                <Cell displaytype="text" style="align:left;"/>
                <Cell col="1" displaytype="text" style="align:center;" text="합  계"/>
                <Cell col="2" displaytype="number" style="align: ;" expr="expr:getCaseCount(&quot;PR_QTY&gt;0&quot;)" mask="#,##0"/>
                <Cell col="3" displaytype="text" style="align:left;" text="건"/>
                <Cell col="4" displaytype="text" style="align:left;"/>
                <Cell col="5" displaytype="text" style="align:left;"/>
                <Cell col="6" displaytype="text" style="align:left;"/>
                <Cell col="7" displaytype="number" style="align:right middle;" expr="expr:getSum(&quot;OP_PRICE&quot;)" mask="#,##0"/>
                <Cell col="8" displaytype="number" style="align: ;" expr="expr:getSum(&quot;PR_QTY&quot;)" mask="#,##0.0"/>
                <Cell col="9" displaytype="number" expr="expr:getSum(&quot;TOT_WGHT&quot;)" mask="#,##0.0"/>
                <Cell col="10" displaytype="number" style="align: ;" expr="expr:getSum(&quot;OP_AMOUNT&quot;)" mask="#,##0"/>
                <Cell col="11" displaytype="number" style="align: ;" expr="expr:getCaseSum(&quot;TAX_CODE=='100'&quot;,&quot;Math.round(OP_AMOUNT/10)&quot;)" mask="#,##0"/>
                <Cell col="12" displaytype="number" style="align: ;" expr="expr:getSum(&quot;Math.round(iif(TAX_CODE=='100',1.1,1)* OP_AMOUNT)&quot;)" mask="#,##0"/>
                <Cell col="13"/>
                <Cell col="14" displaytype="text" style="align:left;"/>
                <Cell col="15"/>
                <Cell col="16" displaytype="text" style="align:left;"/>
                <Cell col="17" displaytype="text" style="align:left;"/>
                <Cell col="18" displaytype="text" style="align:left;"/>
                <Cell col="19"/>
                <Cell col="20" displaytype="text" style="align:left;"/>
                <Cell col="21" displaytype="text" style="align:left;"/>
                <Cell col="22"/>
                <Cell col="23"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Tab id="tab_list" onchanged="tab_list_OnChanged" taborder="6" position="absolute 0 128 980 361" showextrabutton="false" anchor="left top right" canchange="tab_list_canchange">
          <Tabpages>
            <Tabpage id="tab1" taborder="1" text="상품조회" position="absolute 2 24 974 231" scrollbars="none">
              <Layouts>
                <Layout>
                  <Grid id="gd_list_excel" taborder="9" binddataset="ds_List1" wheelscrollrow="1" autoenter="select" useinputpanel="false" cellsizingtype="both" cellmovingtype="col" autofittype="col" autofitminwidth="959" onkeydown="tab_list_tab1_gd_list_OnKeyDown" oncellclick="gd_list_OnCellClick" onheadclick="gd_list_OnHeadClick" oncelldblclick="gd_list_OnCellDblClick" position="absolute 10 42 969 196" anchor="all" style="color:black;" visible="false">
                    <Formats>
                      <Format id="Default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="80"/>
                          <Column size="140"/>
                          <Column size="100"/>
                          <Column size="0"/>
                          <Column size="35"/>
                          <Column size="60"/>
                          <Column size="80"/>
                          <Column size="55"/>
                          <Column size="60"/>
                          <Column size="58"/>
                          <Column size="0"/>
                          <Column size="80"/>
                          <Column size="30"/>
                          <Column size="66"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="상품코드"/>
                          <Cell col="2" displaytype="text" text="상품명"/>
                          <Cell col="3" displaytype="text" text="규격"/>
                          <Cell col="4" displaytype="text" text="원산지"/>
                          <Cell col="5" displaytype="text" text="단위"/>
                          <Cell col="6" displaytype="text" text="보관유형"/>
                          <Cell col="7" displaytype="text" text="단가"/>
                          <Cell col="8" displaytype="text" text="과/면세"/>
                          <Cell col="9" displaytype="text" text="마감일"/>
                          <Cell col="10" displaytype="text" text="g당단가"/>
                          <Cell col="11" displaytype="text" text="상품정보"/>
                          <Cell col="12" displaytype="text" text="공급업체"/>
                          <Cell col="13" displaytype="text" text="사진"/>
                          <Cell col="14" displaytype="text" text="즐찾추가"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="image" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="expr:fn_SetRowImg(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS)"/>
                          <Cell col="1" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:ITEM_CODE"/>
                          <Cell col="2" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));backgroundimage:EXPR(gfn_isNull(FEATURE_ICON) ? &quot;&quot; : FEATURE_ICON);" text="bind:ITEM_NAME" expr="expr:gfn_isNull(FEATURE_ICON) ? ITEM_NAME : &quot; &quot;.padLeft(11, &quot; &quot;)   +  ITEM_NAME"/>
                          <Cell col="3" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:ITEM_SIZE"/>
                          <Cell col="4" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:ORIGIN_TYPE"/>
                          <Cell col="5" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:PO_UOM"/>
                          <Cell col="6" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:KEEPING_TYPE"/>
                          <Cell col="7" displaytype="number" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:OP_PRICE" mask="#,##0"/>
                          <Cell col="8" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" expr="expr:decode(TAX_CODE, &quot;100&quot;, &quot;과세&quot;, &quot;210&quot;, &quot;면세&quot;, &quot;영세&quot;)"/>
                          <Cell col="9" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:D_DAY_DISP"/>
                          <Cell col="10" displaytype="number" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:G_PRICE" mask="#,##0.0"/>
                          <Cell col="11" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:FEATURE_NAME"/>
                          <Cell col="12" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:OTCUSTNM"/>
                          <Cell col="13" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:IMAGE_YN"/>
                          <Cell col="14" displaytype="button" edittype="button" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="추가하기"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static02" class="sta_WFDA_Labelbg" position="absolute 10 10 969 37" anchor="left top right"/>
                  <Grid autoenter="select" autofittype="col" binddataset="ds_List1" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="gd_list" useinputpanel="false" autofitminwidth="959" selecttype="row" oncellclick="gd_list_OnCellClick" oncelldblclick="gd_list_OnCellDblClick" onheadclick="gd_list_OnHeadClick" onkeydown="tab_list_tab1_gd_list_OnKeyDown" taborder="3" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 10 42 969 196" anchor="all" style="color:black;">
                    <Formats>
                      <Format id="Default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="80"/>
                          <Column size="140"/>
                          <Column size="140"/>
                          <Column size="0"/>
                          <Column size="35"/>
                          <Column size="45"/>
                          <Column size="80"/>
                          <Column size="55"/>
                          <Column size="60"/>
                          <Column size="58"/>
                          <Column size="0"/>
                          <Column size="80"/>
                          <Column size="30"/>
                          <Column size="66"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="상품코드"/>
                          <Cell col="2" displaytype="text" text="상품명"/>
                          <Cell col="3" displaytype="text" text="규격"/>
                          <Cell col="4" displaytype="text" text="원산지"/>
                          <Cell col="5" displaytype="text" text="단위"/>
                          <Cell col="6" displaytype="text" text="보관"/>
                          <Cell col="7" displaytype="text" text="단가"/>
                          <Cell col="8" displaytype="text" text="과/면세"/>
                          <Cell col="9" displaytype="text" text="마감일"/>
                          <Cell col="10" displaytype="text" text="g당단가"/>
                          <Cell col="11" displaytype="text" text="상품정보"/>
                          <Cell col="12" displaytype="text" text="공급업체"/>
                          <Cell col="13" displaytype="text" text="사진"/>
                          <Cell col="14" displaytype="text" text="즐찾추가"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="image" style="background2: ;" text="expr:fn_SetRowImg(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS)"/>
                          <Cell col="1" displaytype="text" style="align:center;background2: ;" text="bind:ITEM_CODE"/>
                          <Cell col="2" displaytype="text" style="align:left;background2: ;backgroundimage:EXPR(gfn_isNull(FEATURE_ICON) ? &quot;&quot; : FEATURE_ICON);" text="bind:ITEM_NAME" expr="expr:gfn_isNull(FEATURE_ICON) ? ITEM_NAME : &quot; &quot;.padLeft(11, &quot; &quot;)   +  ITEM_NAME"/>
                          <Cell col="3" displaytype="text" style="align:left;background2: ;" text="bind:ITEM_SIZE"/>
                          <Cell col="4" displaytype="text" style="align:left;background2: ;" text="bind:ORIGIN_TYPE"/>
                          <Cell col="5" displaytype="text" style="align:center;background2: ;" text="bind:PO_UOM"/>
                          <Cell col="6" displaytype="text" style="align:center middle;" text="bind:KEEPING_TYPE"/>
                          <Cell col="7" displaytype="number" style="background2: ;" text="bind:OP_PRICE" mask="#,##0"/>
                          <Cell col="8" displaytype="text" style="align:center;background2: ;" text="bind:TAX_CODE" expr="expr:decode(TAX_CODE, &quot;100&quot;, &quot;과세&quot;, &quot;210&quot;, &quot;면세&quot;, &quot;영세&quot;)"/>
                          <Cell col="9" displaytype="text" style="align:center;background2: ;" text="bind:D_DAY_DISP"/>
                          <Cell col="10" displaytype="number" style="background2: ;" text="bind:G_PRICE" mask="#,##0.0"/>
                          <Cell col="11" displaytype="text" style="align:left;background2: ;" text="bind:FEATURE_NAME"/>
                          <Cell col="12" displaytype="text" style="align:left;background2: ;" text="bind:OTCUSTNM"/>
                          <Cell col="13" displaytype="text" style="align:center;background2: ;" text="bind:IMAGE_YN"/>
                          <Cell col="14" displaytype="button" edittype="button" style="align:center;background2: ;" text="expr:gfn_isNull(FAVOR_GROUP_FLAG) ? '추가하기' : '삭제하기'"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Button id="btn_search" onclick="btn_search_OnClick" onkeydown="btn_search_OnKeyDown" taborder="2" tabstop="false" text="검색" position="absolute 967 13 1022 34" class="btn_WF_Find" image=""/>
                  <Edit autoselect="true" id="ed_Item" imemode="hangul" onkeydown="ed_Item_OnKeyDown" taborder="0" position="absolute 89 12 275 35" class="edt_WF_Essential" tooltiptype="inplace,mouseleave" onsetfocus="tab_list_tab1_ed_Item_onsetfocus" onkillfocus="tab_list_tab1_ed_Item_onkillfocus" style="padding:1 20 0 5;"/>
                  <CheckBox id="chk_Only" taborder="1" tabstop="false" text="주문가능 상품" position="absolute 285 11 394 35" value="true" truevalue="1" falsevalue="0" enable="true"/>
                  <Combo codecolumn="CLASS_CODE" datacolumn="CLASS_NAME" displayrowcount="10" id="cbo_Class2" imemode="native" innerdataset="ds_Class2" onitemchanged="cbo_Class2_OnChanged" onkeydown="cbo_Class2_OnKeyDown" taborder="4" tabstop="false" position="absolute 556 13 650 34" visible="true"/>
                  <Static id="Static23" text="중분류" position="absolute 494 10 554 37" class="sta_WFDA_Label01" visible="true"/>
                  <Static id="Static28" text="소분류" position="absolute 652 10 712 37" class="sta_WFDA_Label01"/>
                  <Combo codecolumn="CLASS_CODE" datacolumn="CLASS_NAME" displayrowcount="10" id="cbo_Class3" imemode="native" innerdataset="ds_Class3" onitemchanged="cbo_Class2_OnChanged" onkeydown="cbo_Class2_OnKeyDown" taborder="5" tabstop="false" position="absolute 714 13 808 34"/>
                  <Static id="Static0" text="세분류" position="absolute 809 10 869 37" class="sta_WFDA_Label01"/>
                  <Combo codecolumn="CLASS_CODE" datacolumn="CLASS_NAME" displayrowcount="10" id="cbo_Class4" imemode="native" innerdataset="ds_Class4" onkeydown="cbo_Class2_OnKeyDown" taborder="6" tabstop="false" position="absolute 871 13 965 34"/>
                  <CheckBox id="chk_ThreeMonth" taborder="7" tabstop="false" text="최근 3개월" value="0" truevalue="1" falsevalue="0" position="absolute 422 67 531 91" visible="false"/>
                  <Static id="st_Otcust" text="상품검색" class="sta_WFDA_Label01" position="absolute 10 10 87 37" style="padding:0 0 0 0;align:center middle;"/>
                  <Combo id="cbo_month" taborder="8" tabstop="false" value="0" text="전체" codecolumn="codecolumn" datacolumn="datacolumn" index="0" displayrowcount="10" position="absolute 402 13 492 34">
                    <Dataset id="innerdataset">
                      <ColumnInfo>
                        <Column id="codecolumn" size="256"/>
                        <Column id="datacolumn" size="256"/>
                      </ColumnInfo>
                      <Rows>
                        <Row>
                          <Col id="codecolumn">0</Col>
                          <Col id="datacolumn">전체</Col>
                        </Row>
                        <Row>
                          <Col id="codecolumn">1</Col>
                          <Col id="datacolumn">최근 1개월</Col>
                        </Row>
                        <Row>
                          <Col id="codecolumn">3</Col>
                          <Col id="datacolumn">최근 3개월</Col>
                        </Row>
                      </Rows>
                    </Dataset>
                  </Combo>
                  <Button id="btn_tooltip" taborder="10" position="absolute 258 13 273 31" style="image:URL('theme://Images\new\sta_WF_DiscInfo.png');border:0 solid #ff864bff ;opacity:70; :disabled {background:transparent;align:left top;}" visible="false" tooltiptext="TIP!!&#13;&#10;기획자재검색방법&#13;&#10;기획:쌀" tooltiptype="default" enable="true" tabstop="false"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tab2" taborder="1" text="즐겨찾기상품" position="absolute 2 24 974 231" scrollbars="none">
              <Layouts>
                <Layout>
                  <Grid id="gd_list_excel" taborder="6" binddataset="ds_List2" wheelscrollrow="1" autoenter="select" useinputpanel="false" cellsizingtype="both" cellmovingtype="col" autofittype="col" autofitminwidth="959" onkeydown="tab_list_tab2_gd_list_OnKeyDown" oncellclick="gd_list_OnCellClick" onheadclick="gd_list_OnHeadClick" oncelldblclick="gd_list_OnCellDblClick" position="absolute 10 42 969 196" anchor="all" visible="false">
                    <Formats>
                      <Format id="Default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="80"/>
                          <Column size="140"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="35"/>
                          <Column size="60"/>
                          <Column size="80"/>
                          <Column size="55"/>
                          <Column size="60"/>
                          <Column size="58"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="30"/>
                          <Column size="66"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="상품코드"/>
                          <Cell col="2" displaytype="text" text="상품명"/>
                          <Cell col="3" displaytype="text" text="규격"/>
                          <Cell col="4" displaytype="text" text="원산지"/>
                          <Cell col="5" displaytype="text" text="단위"/>
                          <Cell col="6" displaytype="text" text="보관유형"/>
                          <Cell col="7" displaytype="text" text="단가"/>
                          <Cell col="8" displaytype="text" text="과/면세"/>
                          <Cell col="9" displaytype="text" text="마감일"/>
                          <Cell col="10" displaytype="text" text="g당단가"/>
                          <Cell col="11" displaytype="text" text="상품정보"/>
                          <Cell col="12" displaytype="text" text="공급업체"/>
                          <Cell col="13" displaytype="text" text="사진"/>
                          <Cell col="14" displaytype="text" text="즐찾삭제"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="image" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="expr:fn_SetRowImg(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS)"/>
                          <Cell col="1" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:ITEM_CODE"/>
                          <Cell col="2" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));backgroundimage:EXPR(gfn_isNull(FEATURE_ICON) ? &quot;&quot; : FEATURE_ICON);" text="expr:gfn_isNull(FEATURE_ICON) ? ITEM_NAME : &quot; &quot;.padLeft(11, &quot; &quot;)   +  ITEM_NAME"/>
                          <Cell col="3" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:ITEM_SIZE"/>
                          <Cell col="4" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:ORIGIN_TYPE"/>
                          <Cell col="5" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:PO_UOM"/>
                          <Cell col="6" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:KEEPING_TYPE"/>
                          <Cell col="7" displaytype="number" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:OP_PRICE" mask="#,##0"/>
                          <Cell col="8" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" expr="expr:decode(TAX_CODE, &quot;100&quot;, &quot;과세&quot;, &quot;210&quot;, &quot;면세&quot;, &quot;영세&quot;)"/>
                          <Cell col="9" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:D_DAY_DISP"/>
                          <Cell col="10" displaytype="number" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:G_PRICE" mask="#,##0.0"/>
                          <Cell col="11" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:FEATURE_NAME"/>
                          <Cell col="12" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:OTCUSTNM"/>
                          <Cell col="13" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="bind:IMAGE_YN"/>
                          <Cell col="14" displaytype="button" edittype="button" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS));" text="삭제하기"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static02" class="sta_WFDA_Labelbg" position="absolute 86 10 969 37" anchor="left top right"/>
                  <Grid autoenter="select" binddataset="ds_List2" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="gd_list" useinputpanel="false" selecttype="row" oncellclick="gd_list_OnCellClick" oncelldblclick="gd_list_OnCellDblClick" onheadclick="gd_list_OnHeadClick" onkeydown="tab_list_tab2_gd_list_OnKeyDown" taborder="5" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 10 42 969 196" anchor="all" autofittype="col" autofitminwidth="959">
                    <Formats>
                      <Format id="Default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="80"/>
                          <Column size="140"/>
                          <Column size="100"/>
                          <Column size="0"/>
                          <Column size="35"/>
                          <Column size="60"/>
                          <Column size="80"/>
                          <Column size="55"/>
                          <Column size="60"/>
                          <Column size="58"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="30"/>
                          <Column size="66"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="상품코드"/>
                          <Cell col="2" displaytype="text" text="상품명"/>
                          <Cell col="3" displaytype="text" text="규격"/>
                          <Cell col="4" displaytype="text" text="원산지"/>
                          <Cell col="5" displaytype="text" text="단위"/>
                          <Cell col="6" displaytype="text" text="보관유형"/>
                          <Cell col="7" displaytype="text" text="단가"/>
                          <Cell col="8" displaytype="text" text="과/면세"/>
                          <Cell col="9" displaytype="text" text="마감일"/>
                          <Cell col="10" displaytype="text" text="g당단가"/>
                          <Cell col="11" displaytype="text" text="상품정보"/>
                          <Cell col="12" displaytype="text" text="공급업체"/>
                          <Cell col="13" displaytype="text" text="사진"/>
                          <Cell col="14" displaytype="text" text="즐찾삭제"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="image" style="background2: ;" text="expr:fn_SetRowImg(D_DAYS,D_TIMES,WEEK_ITEM_CODE,UNUSE_YN,VAL_STP_YN,PO_STATUS,DANGAWEEK_STATUS)"/>
                          <Cell col="1" displaytype="text" style="align:center;background2: ;" text="bind:ITEM_CODE"/>
                          <Cell col="2" displaytype="text" style="align:left;background2: ;backgroundimage:EXPR(gfn_isNull(FEATURE_ICON) ? &quot;&quot; : FEATURE_ICON);" text="bind:ITEM_NAME" expr="expr:gfn_isNull(FEATURE_ICON) ? ITEM_NAME : &quot; &quot;.padLeft(11, &quot; &quot;)   +  ITEM_NAME"/>
                          <Cell col="3" displaytype="text" style="align:left;background2: ;" text="bind:ITEM_SIZE"/>
                          <Cell col="4" displaytype="text" style="align:left;background2: ;" text="bind:ORIGIN_TYPE"/>
                          <Cell col="5" displaytype="text" style="align:center;background2: ;" text="bind:PO_UOM"/>
                          <Cell col="6" displaytype="text" style="align:left;background2: ;" text="bind:KEEPING_TYPE"/>
                          <Cell col="7" displaytype="number" style="background2: ;" text="bind:OP_PRICE" mask="#,##0"/>
                          <Cell col="8" displaytype="text" style="align:center;background2: ;" text="bind:TAX_CODE" expr="expr:decode(TAX_CODE, &quot;100&quot;, &quot;과세&quot;, &quot;210&quot;, &quot;면세&quot;, &quot;영세&quot;)"/>
                          <Cell col="9" displaytype="text" style="align:center;background2: ;" text="bind:D_DAY_DISP"/>
                          <Cell col="10" displaytype="number" style="background2: ;" text="bind:G_PRICE" mask="#,##0.0"/>
                          <Cell col="11" displaytype="text" style="align:left;background2: ;" text="bind:FEATURE_NAME"/>
                          <Cell col="12" displaytype="text" style="align:left;background2: ;" text="bind:OTCUSTNM"/>
                          <Cell col="13" displaytype="text" style="align:center;background2: ;" text="bind:IMAGE_YN"/>
                          <Cell col="14" displaytype="button" edittype="button" style="align:center;background2: ;" text="삭제하기"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Button id="btn_search" onclick="btn_search_OnClick" onkeydown="btn_search_OnKeyDown" taborder="3" tabstop="false" text="검색" position="absolute 752 13 804 34" class="btn_WF_Find" image=""/>
                  <Static id="st_Otcust" text="상품검색" position="absolute 10 10 87 37" class="sta_WFDA_Label01" style="padding:0 0 0 0;align:center middle;"/>
                  <Edit autoselect="true" id="ed_Item" imemode="hangul" onkeydown="ed_Item_OnKeyDown" taborder="0" position="absolute 89 13 319 34"/>
                  <Static id="Static0" text="즐겨찾기 그룹" position="absolute 441 10 534 37" class="sta_WFDA_Label01"/>
                  <Combo codecolumn="FAVOR_GROUP" datacolumn="FAVOR_NAME" displayrowcount="10" id="cbo_Fav" imemode="none" innerdataset="ds_Fav" onitemchanged="cbo_Subinv_OnChanged" onkeydown="ed_Item_OnKeyDown" taborder="2" position="absolute 536 13 750 34" tabstop="true"/>
                  <Button id="btn_CallPop" onclick="btn_CallPop_OnClick" taborder="4" tabstop="false" text="즐겨찾기 등록" userdata="ds_List2" position="absolute 875 13 966 34" class="btn_WF_Custom" image="" anchor="top right"/>
                  <CheckBox id="chk_Only" taborder="1" tabstop="true" text="주문가능 상품만" position="absolute 323 14 430 33" value="true"/>
                  <Static id="Static12" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 10 430" anchor="top right"/>
                  <Static id="Static13" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 969 10" anchor="left bottom"/>
                  <Static id="Static00" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 969 0 979 430" anchor="top right"/>
                  <Static id="Static01" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 196 969 206" anchor="left bottom"/>
                  <Static id="Static21" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 37 749 42"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tab3" taborder="1" text="주간발주상품" position="absolute 2 24 974 231" scrollbars="none">
              <Layouts>
                <Layout>
                  <Grid id="gd_list_excel" taborder="5" binddataset="ds_List3" wheelscrollrow="1" autoenter="select" useinputpanel="false" cellsizingtype="both" cellmovingtype="col" autofittype="col" autofitminwidth="959" onkeydown="tab_list_tab3_gd_list_OnKeyDown" oncellclick="gd_list_OnCellClick" onheadclick="gd_list_OnHeadClick" oncelldblclick="gd_list_OnCellDblClick" position="absolute 10 42 969 196" anchor="all" visible="false">
                    <Formats>
                      <Format id="Default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="80"/>
                          <Column size="140"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="35"/>
                          <Column size="60"/>
                          <Column size="80"/>
                          <Column size="60"/>
                          <Column size="60"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="40"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="상품코드"/>
                          <Cell col="2" displaytype="text" text="상품명"/>
                          <Cell col="3" displaytype="text" text="규격"/>
                          <Cell col="4" displaytype="text" text="원산지"/>
                          <Cell col="5" displaytype="text" text="단위"/>
                          <Cell col="6" displaytype="text" text="보관유형"/>
                          <Cell col="7" displaytype="text" text="단가"/>
                          <Cell col="8" displaytype="text" text="과/면세"/>
                          <Cell col="9" displaytype="text" text="마감일"/>
                          <Cell col="10" displaytype="text" text="g당단가"/>
                          <Cell col="11" displaytype="text" text="상품정보"/>
                          <Cell col="12" displaytype="text" text="공급업체"/>
                          <Cell col="13" displaytype="text" text="사진"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="image" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="expr:fn_SetRowImg(D_DAYS,D_TIMES,WEEK_ITEM_CODE)"/>
                          <Cell col="1" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:ITEM_CODE"/>
                          <Cell col="2" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));backgroundimage:EXPR(gfn_isNull(FEATURE_ICON) ? &quot;&quot; : FEATURE_ICON);" text="expr:gfn_isNull(FEATURE_ICON) ? ITEM_NAME : &quot; &quot;.padLeft(11, &quot; &quot;)   +  ITEM_NAME"/>
                          <Cell col="3" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:ITEM_SIZE"/>
                          <Cell col="4" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:ORIGIN_TYPE"/>
                          <Cell col="5" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:PO_UOM"/>
                          <Cell col="6" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:KEEPING_TYPE"/>
                          <Cell col="7" displaytype="number" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:OP_PRICE" mask="#,##0"/>
                          <Cell col="8" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" expr="expr:decode(TAX_CODE, &quot;100&quot;, &quot;과세&quot;, &quot;210&quot;, &quot;면세&quot;, &quot;영세&quot;)"/>
                          <Cell col="9" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:D_DAY_DISP"/>
                          <Cell col="10" displaytype="number" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:G_PRICE" mask="#,##0.0"/>
                          <Cell col="11" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:FEATURE_NAME"/>
                          <Cell col="12" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:OTCUSTNM"/>
                          <Cell col="13" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:IMAGE_YN"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static02" class="sta_WFDA_Labelbg" position="absolute 86 10 969 37" anchor="left top right"/>
                  <Grid autoenter="select" binddataset="ds_List3" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="gd_list" useinputpanel="false" selecttype="row" oncellclick="gd_list_OnCellClick" oncelldblclick="gd_list_OnCellDblClick" onheadclick="gd_list_OnHeadClick" onkeydown="tab_list_tab3_gd_list_OnKeyDown" taborder="4" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 10 42 969 196" anchor="all" autofittype="col" autofitminwidth="959">
                    <Formats>
                      <Format id="Default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="80"/>
                          <Column size="140"/>
                          <Column size="100"/>
                          <Column size="0"/>
                          <Column size="35"/>
                          <Column size="60"/>
                          <Column size="80"/>
                          <Column size="60"/>
                          <Column size="60"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="40"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="상품코드"/>
                          <Cell col="2" displaytype="text" text="상품명"/>
                          <Cell col="3" displaytype="text" text="규격"/>
                          <Cell col="4" displaytype="text" text="원산지"/>
                          <Cell col="5" displaytype="text" text="단위"/>
                          <Cell col="6" displaytype="text" text="보관유형"/>
                          <Cell col="7" displaytype="text" text="단가"/>
                          <Cell col="8" displaytype="text" text="과/면세"/>
                          <Cell col="9" displaytype="text" text="마감일"/>
                          <Cell col="10" displaytype="text" text="g당단가"/>
                          <Cell col="11" displaytype="text" text="상품정보"/>
                          <Cell col="12" displaytype="text" text="공급업체"/>
                          <Cell col="13" displaytype="text" text="사진"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="image" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="expr:fn_SetRowImg(D_DAYS,D_TIMES,WEEK_ITEM_CODE)"/>
                          <Cell col="1" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:ITEM_CODE"/>
                          <Cell col="2" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));backgroundimage:EXPR(gfn_isNull(FEATURE_ICON) ? &quot;&quot; : FEATURE_ICON);" text="bind:ITEM_NAME" expr="expr:gfn_isNull(FEATURE_ICON) ? ITEM_NAME : &quot; &quot;.padLeft(11, &quot; &quot;)   +  ITEM_NAME"/>
                          <Cell col="3" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:ITEM_SIZE"/>
                          <Cell col="4" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:ORIGIN_TYPE"/>
                          <Cell col="5" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:PO_UOM"/>
                          <Cell col="6" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:KEEPING_TYPE"/>
                          <Cell col="7" displaytype="number" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:OP_PRICE" mask="#,##0"/>
                          <Cell col="8" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:TAX_CODE" expr="expr:decode(TAX_CODE, &quot;100&quot;, &quot;과세&quot;, &quot;210&quot;, &quot;면세&quot;, &quot;영세&quot;)"/>
                          <Cell col="9" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:D_DAY_DISP"/>
                          <Cell col="10" displaytype="number" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:G_PRICE" mask="#,##0.0"/>
                          <Cell col="11" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:FEATURE_NAME"/>
                          <Cell col="12" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:OTCUSTNM"/>
                          <Cell col="13" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:IMAGE_YN"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Button id="btn_search" onclick="btn_search_OnClick" onkeydown="btn_search_OnKeyDown" taborder="2" tabstop="false" text="검색" position="absolute 444 13 496 34" class="btn_WF_Find" image=""/>
                  <Static id="st_Otcust" text="상품검색" position="absolute 10 10 87 37" class="sta_WFDA_Label01" style="padding:0 0 0 0;align:center middle;"/>
                  <Edit autoselect="true" id="ed_Item" imemode="hangul" onkeydown="ed_Item_OnKeyDown" taborder="0" position="absolute 89 13 319 34"/>
                  <Button id="btn_CallPop" onclick="btn_CallPop_OnClick" taborder="3" tabstop="false" text="주간발주 등록" userdata="ds_List3" position="absolute 874 13 966 34" class="btn_WF_Custom" image="" anchor="top right"/>
                  <CheckBox id="chk_Only" taborder="1" tabstop="false" text="주문가능 상품만" position="absolute 323 14 430 33" value="true"/>
                  <Static id="Static12" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 10 430" anchor="top right"/>
                  <Static id="Static13" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 969 10" anchor="left bottom"/>
                  <Static id="Static00" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 969 0 979 430" anchor="top right"/>
                  <Static id="Static01" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 196 969 206" anchor="left bottom"/>
                  <Static id="Static21" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 37 749 42"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tab4" taborder="2" text="지난발주 복사" position="absolute 2 24 974 231" scrollbars="none">
              <Layouts>
                <Layout>
                  <Grid id="gd_list_excel" taborder="8" binddataset="ds_List4" wheelscrollrow="1" autoenter="select" useinputpanel="false" selecttype="multirow" cellsizingtype="both" cellmovingtype="col" autofittype="col" autofitminwidth="959" oncellclick="gd_list_OnCellClick" onheadclick="gd_list_OnHeadClick" oncelldblclick="gd_list_OnCellDblClick" position="absolute 10 42 969 196" anchor="all" visible="false">
                    <Formats>
                      <Format id="Default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="80"/>
                          <Column size="140"/>
                          <Column size="100"/>
                          <Column size="80"/>
                          <Column size="35"/>
                          <Column size="60"/>
                          <Column size="65"/>
                          <Column size="60"/>
                          <Column size="60"/>
                          <Column size="60"/>
                          <Column size="60"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="35"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="상품코드"/>
                          <Cell col="2" displaytype="text" text="상품명"/>
                          <Cell col="3" displaytype="text" text="규격"/>
                          <Cell col="4" displaytype="text" text="원산지"/>
                          <Cell col="5" displaytype="text" text="단위"/>
                          <Cell col="6" displaytype="text" text="보관유형"/>
                          <Cell col="7" displaytype="text" text="단가"/>
                          <Cell col="8" displaytype="text" text="과/면세"/>
                          <Cell col="9" displaytype="text" text="마감일"/>
                          <Cell col="10" displaytype="text" text="g당단가"/>
                          <Cell col="11" displaytype="text" text="발주량"/>
                          <Cell col="12" displaytype="text" text="상품정보"/>
                          <Cell col="13" displaytype="text" text="공급업체"/>
                          <Cell col="14" displaytype="text" text="사진"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="image" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="expr:fn_SetRowImg(D_DAYS,D_TIMES,WEEK_ITEM_CODE)"/>
                          <Cell col="1" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:ITEM_CODE"/>
                          <Cell col="2" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));backgroundimage:EXPR(gfn_isNull(FEATURE_ICON) ? &quot;&quot; : FEATURE_ICON);" text="expr:gfn_isNull(FEATURE_ICON) ? ITEM_NAME : &quot; &quot;.padLeft(11, &quot; &quot;)   +  ITEM_NAME"/>
                          <Cell col="3" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:ITEM_SIZE"/>
                          <Cell col="4" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:ORIGIN_TYPE"/>
                          <Cell col="5" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:PO_UOM"/>
                          <Cell col="6" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:KEEPING_TYPE"/>
                          <Cell col="7" displaytype="number" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:OP_PRICE" mask="#,##0"/>
                          <Cell col="8" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" expr="expr:decode(TAX_CODE, &quot;100&quot;, &quot;과세&quot;, &quot;210&quot;, &quot;면세&quot;, &quot;영세&quot;)"/>
                          <Cell col="9" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:D_DAY_DISP"/>
                          <Cell col="10" displaytype="number" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:G_PRICE" mask="#,##0.0"/>
                          <Cell col="11" displaytype="number" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:PR_QTY" mask="#,##0.0"/>
                          <Cell col="12" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:FEATURE_NAME"/>
                          <Cell col="13" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:OTCUSTNM"/>
                          <Cell col="14" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:IMAGE_YN"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static02" class="sta_WFDA_Labelbg" position="absolute 86 10 969 37" anchor="left top right"/>
                  <Grid autoenter="select" binddataset="ds_List4" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="gd_list" useinputpanel="false" selecttype="multirow" oncellclick="gd_list_OnCellClick" oncelldblclick="gd_list_OnCellDblClick" onheadclick="gd_list_OnHeadClick" taborder="7" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 10 42 969 196" anchor="all" autofittype="col" autofitminwidth="959">
                    <Formats>
                      <Format id="Default">
                        <Columns>
                          <Column size="25"/>
                          <Column size="80"/>
                          <Column size="140"/>
                          <Column size="100"/>
                          <Column size="0"/>
                          <Column size="35"/>
                          <Column size="60"/>
                          <Column size="65"/>
                          <Column size="60"/>
                          <Column size="60"/>
                          <Column size="60"/>
                          <Column size="60"/>
                          <Column size="80"/>
                          <Column size="80"/>
                          <Column size="35"/>
                        </Columns>
                        <Rows>
                          <Row size="26" band="head"/>
                          <Row size="20"/>
                        </Rows>
                        <Band id="head">
                          <Cell displaytype="text" class="head_Excel"/>
                          <Cell col="1" displaytype="text" text="상품코드"/>
                          <Cell col="2" displaytype="text" text="상품명"/>
                          <Cell col="3" displaytype="text" text="규격"/>
                          <Cell col="4" displaytype="text" text="원산지"/>
                          <Cell col="5" displaytype="text" text="단위"/>
                          <Cell col="6" displaytype="text" text="보관유형"/>
                          <Cell col="7" displaytype="text" text="단가"/>
                          <Cell col="8" displaytype="text" text="과/면세"/>
                          <Cell col="9" displaytype="text" text="마감일"/>
                          <Cell col="10" displaytype="text" text="g당단가"/>
                          <Cell col="11" displaytype="text" text="발주량"/>
                          <Cell col="12" displaytype="text" text="상품정보"/>
                          <Cell col="13" displaytype="text" text="공급업체"/>
                          <Cell col="14" displaytype="text" text="사진"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="image" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="expr:fn_SetRowImg(D_DAYS,D_TIMES,WEEK_ITEM_CODE)"/>
                          <Cell col="1" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:ITEM_CODE"/>
                          <Cell col="2" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));backgroundimage:EXPR(gfn_isNull(FEATURE_ICON) ? &quot;&quot; : FEATURE_ICON);" text="bind:ITEM_NAME" expr="expr:gfn_isNull(FEATURE_ICON) ? ITEM_NAME : &quot; &quot;.padLeft(11, &quot; &quot;)   +  ITEM_NAME"/>
                          <Cell col="3" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:ITEM_SIZE"/>
                          <Cell col="4" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:ORIGIN_TYPE"/>
                          <Cell col="5" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:PO_UOM"/>
                          <Cell col="6" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:KEEPING_TYPE"/>
                          <Cell col="7" displaytype="number" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:OP_PRICE" mask="#,##0"/>
                          <Cell col="8" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:TAX_CODE" expr="expr:decode(TAX_CODE, &quot;100&quot;, &quot;과세&quot;, &quot;210&quot;, &quot;면세&quot;, &quot;영세&quot;)"/>
                          <Cell col="9" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:D_DAY_DISP"/>
                          <Cell col="10" displaytype="number" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:G_PRICE" mask="#,##0.0"/>
                          <Cell col="11" displaytype="number" style="background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:PR_QTY" mask="#,##0.0"/>
                          <Cell col="12" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:FEATURE_NAME"/>
                          <Cell col="13" displaytype="text" style="align:left;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:OTCUSTNM"/>
                          <Cell col="14" displaytype="text" style="align:center;background:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));background2:EXPR(fn_SetRowColor(D_DAYS,D_TIMES,WEEK_ITEM_CODE));" text="bind:IMAGE_YN"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Button id="btn_search" onclick="btn_search_OnClick" onkeydown="btn_search_OnKeyDown" taborder="5" tabstop="false" text="검색" position="absolute 809 13 862 34" class="btn_WF_Find" image=""/>
                  <CheckBox id="chk_Only" taborder="5" tabstop="false" text="주문가능 상품만" value="false" visible="false" position="absolute 130 83 237 102"/>
                  <Static id="Static0" text="상품검색" position="absolute 10 10 87 37" class="sta_WFDA_Label01" style="padding:0 0 0 0;align:center middle;"/>
                  <Edit autoselect="true" id="ed_Item" imemode="hangul" onkeydown="ed_Item_OnKeyDown" taborder="7" position="absolute 89 13 214 34"/>
                  <Static id="st_UpjangP" text="사업장" userdata="strQuery_FMUpjang" position="absolute 216 10 286 37" class="sta_WFDA_Label01"/>
                  <Edit autoselect="true" id="ed_UpjangP" imemode="native" onkeydown="fn_edBtn_OnKeyDown" readonly="true" taborder="0" position="absolute 288 13 390 34"/>
                  <Button id="btn_UpjangP" onclick="fn_edBtn_OnClick" taborder="1" tabstop="false" text="" position="absolute 389 13 410 34" class="btn_WF_popSearch" image=""/>
                  <Static id="Static1" text="식당(창고)" position="absolute 412 10 482 37" class="sta_WFDA_Label01"/>
                  <Combo codecolumn="SUBINV_CODE" datacolumn="SUBINV_NAME" displayrowcount="10" id="cbo_SubinvP" imemode="none" innerdataset="ds_SubinvP" onitemchanged="cbo_Subinv_OnChanged" taborder="2" position="absolute 484 13 632 34"/>
                  <Static id="st_Otcust" text="입고일자" position="absolute 634 10 704 37" class="sta_WFDA_Label01"/>
                  <MaskEdit id="me_NeedDateP" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkeydown="ed_Item_OnKeyDown" onkillfocus="g_Date_OnKillFocus" taborder="3" type="string" position="absolute 707 13 787 34" class="msk_WF_Cal"/>
                  <Button id="btn_NeedDateP" onclick="g_CalButton_OnClick" taborder="4" tabstop="false" text="" userdata="tab_list.tab4.me_NeedDateP" position="absolute 786 13 807 34" class="btn_WF_cal" image=""/>
                  <Button id="btn_CallPop" onclick="btn_CallPop_OnClick" taborder="6" tabstop="false" text="일괄선택 등록" userdata="ds_List4" position="absolute 867 13 966 34" class="btn_WF_Custom" image="" anchor="top right"/>
                  <Static id="Static12" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 10 430" anchor="top right"/>
                  <Static id="Static13" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 0 969 10" anchor="left bottom"/>
                  <Static id="Static00" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 969 0 979 430" anchor="top right"/>
                  <Static id="Static01" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 196 969 206" anchor="left bottom"/>
                  <Static id="Static21" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 37 749 42"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Combo codecolumn="SUBINV_CODE" datacolumn="SUBINV_NAME" displayrowcount="10" id="cbo_Subinv" innerdataset="ds_Subinv" onitemchanged="cbo_Subinv_OnChanged" taborder="3" position="absolute 350 40 550 61" type="filter" canitemchange="cbo_Subinv_canitemchange"/>
        <Static id="st_Days" text="(발주 마감 : D-0 00시)" position="absolute 803 41 960 62" style="font:Gulim,9, bold;"/>
        <Button id="btn_Upjang" onclick="fn_edBtn_OnClick" taborder="2" tabstop="false" text="" position="absolute 219 40 240 61" class="btn_WF_popSearch" image=""/>
        <Edit autoselect="true" id="ed_Upjang" imemode="native" onkeydown="fn_edBtn_OnKeyDown" readonly="true" taborder="1" position="absolute 70 40 220 61"/>
        <Static id="st_Upjang" text="사업장" userdata="strQuery_FMUpjang" position="absolute 15 40 68 61" class="sta_WFSA_label"/>
        <Static id="Static6" text="식당(창고)" position="absolute 270 40 347 61" class="sta_WFSA_label"/>
        <Static id="Static8" text="입고예정일" position="absolute 580 40 653 61" class="sta_WFSA_label"/>
        <MaskEdit id="me_NeedDate" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" taborder="4" type="string" position="absolute 660 40 740 61" class="msk_WF_Cal" onkillfocus="me_NeedDate_onkillfocus" canchange="me_NeedDate_canchange" ontextchanged="me_NeedDate_ontextchanged" onkeydown="me_NeedDate_onkeydown"/>
        <Button id="btn_NeedDate" onclick="g_CalButton_OnClick" taborder="5" tabstop="false" text="" userdata="me_NeedDate" position="absolute 739 40 760 61" class="btn_WF_cal" image=""/>
        <Static id="st_Timer" text="마감시간 : 00일 00시간 00분 전" position="absolute 702 136 975 148" class="sta_WF_RedhelpB" style="color:red;align:right middle;font:굴림,9,bold;" anchor="top right"/>
        <ImageViewer id="Image1" image="URL('theme://convertImages/img_GC.png')" taborder="9" tabstop="false" position="absolute 14 382 29 397" style="border:0 none #cacacaff ;"/>
        <Static id="Static4" text="발주가능" position="absolute 32 384 96 396"/>
        <ImageViewer id="Image2" image="URL('theme://convertImages/img_YC.png')" taborder="10" tabstop="false" position="absolute 96 382 111 397" style="border:0 none #cacacaff ;"/>
        <Static id="Static5" text="마감 30분전" position="absolute 114 384 194 396"/>
        <ImageViewer id="Image3" image="URL('theme://convertImages/img_RC.png')" taborder="11" tabstop="false" position="absolute 197 382 212 397" style="border:0 none #cacacaff ;"/>
        <Static id="Static7" text="마감/발주불가" position="absolute 215 384 309 396"/>
        <Static id="Static9" text="상품 추가/수정 후 반드시 저장버튼을 클릭해 주시기 바랍니다." position="absolute 311 384 655 397" class="sta_WF_Redhelp" style="color:red;" visible="false"/>
        <Static id="st_Week" text="(월)" position="absolute 766 41 794 62" style="font:Gulim,9,bold;"/>
        <TextArea id="ta_Sql" readonly="true" taborder="12" tabstop="false" visible="false" position="absolute 360 0 474 40" scrollbars="none"/>
        <Button id="btn_copy" onclick="fn_Excel_Import" taborder="13" tabstop="false" text="▼ Excel 일괄발주" position="absolute 859 379 978 400" class="btn_WF_Custom" image="" anchor="top right" visible="false"/>
        <MPFileDialog id="fd_Excel" taborder="40" position="absolute 952 464 976 488"/>
        <Div id="dv_Prg" taborder="14" tabstop="false" text="Div0" visible="false" position="absolute 292 604 690 732" scrollbars="none">
          <Layouts>
            <Layout>
              <ImageViewer id="img_message" image="URL('theme://convertImages/img_Handling.png')" taborder="1" text="엑셀 업로드 중입니다" position="absolute -1 -2 399 131" anchor="default"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static2" text="발주내역" position="absolute 0 416 123 434" class="sta_WF_Title01"/>
        <Combo displayrowcount="10" id="cbo_Type" imemode="none" index="1" taborder="19" tabstop="false" position="absolute 14 232 104 253" codecolumn="codecolumn" datacolumn="datacolumn" visible="false">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">A.ITEM_CODE</Col>
                <Col id="datacolumn"> 상품코드</Col>
              </Row>
              <Row>
                <Col id="codecolumn">A.ITEM_NAME</Col>
                <Col id="datacolumn"> 상품명칭</Col>
              </Row>
              <Row>
                <Col id="codecolumn">A.ITEM_SIZE</Col>
                <Col id="datacolumn"> 상품규격</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Div id="div_Error" taborder="20" tabstop="false" text="Div0" visible="false" position="absolute 0 754 981 929" scrollbars="none" style="background:#ffffffff;" anchor="all">
          <Layouts>
            <Layout>
              <Grid binddataset="ds_ErrLst" cellmovingtype="col" cellsizingtype="both" enable="true" id="grd_ErrLst" useinputpanel="false" onheadclick="gd_list_OnHeadClick" taborder="2" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute -1 31 981 176" readonly="true" selecttype="row" anchor="all" autofittype="col">
                <Formats>
                  <Format id="Default">
                    <Columns>
                      <Column size="30"/>
                      <Column size="704"/>
                      <Column size="146"/>
                    </Columns>
                    <Rows>
                      <Row size="26" band="head"/>
                      <Row size="20"/>
                    </Rows>
                    <Band id="head">
                      <Cell displaytype="text" text="No."/>
                      <Cell col="1" displaytype="text" text="오류내용"/>
                      <Cell col="2" displaytype="text" text="오류코드"/>
                    </Band>
                    <Band id="body">
                      <Cell celltype="head" displaytype="text" style="align:right;" expr="expr:currow + 1"/>
                      <Cell col="1" displaytype="text" edittype="normal" style="align:left;" text="bind:errmsg"/>
                      <Cell col="2" displaytype="text" style="align:left;" text="bind:errcode"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Button id="btn_Hidden" onclick="div_Error_btn_Hidden_OnClick" taborder="3" text="확   인" position="absolute 917 5 980 26" class="btn_WF_Custom" image="" anchor="top right"/>
              <Static id="Static1" text="오류목록" position="absolute 0 13 123 31" class="sta_WF_Title01" anchor="default"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Sta_Green" text="보조금 잔액" visible="false" position="absolute 601 128 712 155" class="sta_WFDA_Label01"/>
        <Edit autoselect="true" enable="false" id="ed_Pcnt" imemode="native" taborder="24" tabstop="false" position="absolute 263 89 334 110" style="align:right;"/>
        <Static id="Static28" text="최종 발주정보" position="absolute 164 86 261 113" class="sta_WFDA_Label01"/>
        <MaskEdit enable="false" id="me_Pdate" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="23" tabstop="false" type="string" position="absolute 84 89 162 110" class="msk_WF_Cal"/>
        <Static id="Static23" text="최종발주일" position="absolute 0 86 82 113" class="sta_WFDA_Label01"/>
        <Static id="Static1" text="주문가능 상품만 체크 해제 시 D-2 상품 조회 가능" position="absolute 383 136 657 149" class="sta_WF_RedhelpB"/>
        <Div id="dv_RcpConf" taborder="50" tabstop="false" text="Div0" visible="false" position="absolute 998 187 1133 355" class="div_WFGRD_graybg" scrollbars="none" style="background:#ffffffff;border:2 solid #515d6fff ;">
          <Layouts>
            <Layout>
              <Button id="btn_RcpRun" onclick="dv_MultiUpj_btn_Hidden_OnClick" taborder="0" text="입금확인" position="absolute 4 84 128 106" class="btn_WF_Custom" image="" anchor="default"/>
              <Static id="Static1" text="입금확인일자" position="absolute 4 6 127 33" class="sta_WFDA_Label01" anchor="default"/>
              <MaskEdit enable="false" id="me_RcpDateF" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" readonly="true" taborder="3" type="string" position="absolute 5 36 105 57" class="msk_WF_Cal" anchor="default"/>
              <Button enable="false" id="btn_RcpDateF" onclick="g_CalButton_OnClick" taborder="4" tabstop="false" text="" userdata="dv_RcpConf.me_RcpDateF" position="absolute 84 36 105 57" class="btn_WF_cal" image="" anchor="default"/>
              <MaskEdit id="me_RcpDateT" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" readonly="true" taborder="5" type="string" position="absolute 17 59 117 80" class="msk_WF_Cal" anchor="default" onkillfocus="dv_RcpConf_me_RcpDateT_onkillfocus"/>
              <Button id="btn_RcpDateT" onclick="g_CalButton_OnClick" taborder="6" tabstop="false" text="" userdata="dv_RcpConf.me_RcpDateT" position="absolute 96 59 117 80" class="btn_WF_cal" image="" anchor="default"/>
              <Static id="Static0" text="~" position="absolute 5 63 13 76" anchor="default"/>
              <Static id="Static02" text="※ 은행 전산 구조상 최대 10분 지연 될수 있습니다." position="absolute 8 107 128 167" anchor="default"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="st_Credit" text="발주가능금액" visible="false" position="absolute 432 86 524 113" class="sta_WFDA_Label01"/>
        <Edit autoselect="true" enable="false" id="ed_Credit" imemode="native" taborder="21" tabstop="false" visible="false" position="absolute 526 89 636 110" style="align:right; :disabled {background:#ffffffff;color:red;}"/>
        <Static id="st_Bond" text="채권잔액" visible="false" position="absolute 638 86 733 113" class="sta_WFDA_Label01" style="align:center middle;"/>
        <Edit autoselect="true" enable="false" id="ed_Bond" imemode="native" taborder="51" tabstop="false" visible="false" position="absolute 735 89 845 110" style="align:right; :disabled {background:#ffffffff;color:red;}"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="52" url="cmn::CmnBtn.xfdl" text="Div0" scrollbars="none" position="absolute 0 0 981 30"/>
        <Static id="Static44" text="과발주한 상품은 없는지 다시 한번 확인하시고 저장버튼을 클릭해 주시기 바랍니다. 상품 추가/수정 후 저장버튼을 눌러야 반영됩니다.." class="sta_WF_DiscPoint" position="absolute 96 415 942 430"/>
        <Splitter id="sp_line" type="vertical" position="absolute 0 364 981 372" anchor="left top right" onmove="sp_line_onmove" class="spt_WF_2">
          <Formats>
            <Format id="default">
              <SplitterItems id="items">
                <SplitterItem id="item00" position="leftortop" bindtype="resize" componentid="tab_list"/>
              </SplitterItems>
            </Format>
          </Formats>
        </Splitter>
        <Static id="stc_desc" text="각 tab별로 동일한 엑셀출력용 그리드 존재&#13;&#10;ex) tab_list.tab1.gd_list_excel" position="absolute 1020 60 1264 113" style="background:darkorange;" visible="false"/>
        <Static id="st_budget" text="예산잔액" class="sta_WFDA_Label01" visible="false" position="absolute 847 86 939 113" style="color:#1955b8ff;align:center middle;font:Gulim,9,underline;cursor:hand;" onclick="st_budget_onclick"/>
        <Edit id="ed_budget" taborder="53" tabstop="false" autoselect="true" enable="false" visible="false" position="absolute 944 89 1054 110" style="align:right; :disabled {background:#ffffffff;color:red;}"/>
        <Button id="btn_RcpConf" onclick="btn_RcpConf_OnClick" taborder="49" tabstop="false" text="실시간 입금확인" userdata="1" visible="false" position="absolute 870 89 978 110" class="btn_WF_Custom" image="" anchor="top right"/>
        <Static id="stc_ctrlAmt" text="( 전체창고 발주금액 : $amt$ )" position="absolute 955 41 1208 62" style="font:Gulim,9, bold;" visible="false"/>
        <Static id="st_ctrlAmt" text="발주가능금액 0원 부족" class="sta_WF_RedhelpB" position="absolute 705 417 978 429" anchor="top right" style="color:red;align:right middle;font:굴림,9,bold;" visible="false"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_Cond">
        <ColumnInfo>
          <Column id="ITEM_NAME" size="100" type="STRING"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="UPJANG" size="22" type="INT"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="QTY_CONTROL_YN" size="1" type="STRING"/>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="AP_UNITPRICE_UPJANG" size="22" type="INT"/>
          <Column id="OTCUST_PRICE_UPJANG" size="22" type="INT"/>
          <Column id="FAVOR_GROUP" size="50" type="STRING"/>
          <Column id="NEED_DATEP" size="8" type="STRING"/>
          <Column id="UPJANGP" size="22" type="INT"/>
          <Column id="SUBINV_CODEP" size="8" type="STRING"/>
          <Column id="ITEM_CLASS2" size="8" type="STRING"/>
          <Column id="ITEM_CLASS3" size="8" type="STRING"/>
          <Column id="ITEM_CLASS4" size="8" type="STRING"/>
          <Column id="ITEM_CODE" size="256" type="STRING"/>
          <Column id="NEED_DATET" type="STRING" size="256"/>
          <Column id="UPJANGT" type="STRING" size="256"/>
          <Column id="SUBINV_CODET" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Subinv">
        <ColumnInfo>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="SUBINV_NAME_DISP" size="100" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Days">
        <ColumnInfo>
          <Column id="D_DAYS" size="22" type="INT"/>
          <Column id="D_TIMES" size="4" type="STRING"/>
          <Column id="DAYS" size="50" type="STRING"/>
          <Column id="D_OVER_DAYS" size="22" type="INT"/>
          <Column id="QTY_CONTROL_YN" size="1" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_OrdCtrl">
        <ColumnInfo>
          <Column id="CTRL_TYPE" size="50" type="STRING"/>
          <Column id="FRI" size="1" type="STRING"/>
          <Column id="ITEM_TYPE" size="50" type="STRING"/>
          <Column id="MON" size="1" type="STRING"/>
          <Column id="SAT" size="1" type="STRING"/>
          <Column id="SUN" size="1" type="STRING"/>
          <Column id="THU" size="1" type="STRING"/>
          <Column id="TUE" size="1" type="STRING"/>
          <Column id="WED" size="1" type="STRING"/>
          <Column id="CHK_TYPE" size="100" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CrdInfo">
        <ColumnInfo>
          <Column id="CREDIT_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="CREDIT_AMOUNT_CONTROL_YN" size="1" prop="default" type="STRING"/>
          <Column id="CREDIT_AMOUNT_TOT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="CREDIT_AVAIL_AMT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="CREDIT_EXT_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="CREDIT_EXT_DAYS" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="CREDIT_OVER_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="CREDIT_RMN_AMT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="CREDIT_TURN_CONTROL_YN" size="1" prop="default" type="STRING"/>
          <Column id="CREDIT_TURN_DAYS" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="CREDIT_TURN_DAYS_TOT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="L_BILL_DATE" size="8" prop="default" type="STRING"/>
          <Column id="L_BILL_DATE_DISP" size="50" prop="default" type="STRING"/>
          <Column id="LAST_TURN_CNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="PO_AMT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="PR_AMT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="RMN_AMT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="TR_AMT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="BOND_AMT" size="22" prop="default" type="BIGDECIMAL"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Fav">
        <ColumnInfo>
          <Column id="FAVOR_GROUP" size="50" type="STRING"/>
          <Column id="FAVOR_NAME" size="100" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_CtUpj">
        <ColumnInfo>
          <Column id="AP_UNITPRICE_UPJANG" size="22" type="INT"/>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="OTCUST_PRICE_UPJANG" size="22" type="INT"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List" cancolumnchange="ds_List_CanColumnChange" oncolumnchanged="ds_List_OnColumnChanged">
        <ColumnInfo>
          <Column id="CENTER_CODE" size="22" prop="default" type="INT"/>
          <Column id="CENTER_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="CLS_STATUS" size="50" prop="default" type="STRING"/>
          <Column id="CUSTCD" size="22" prop="default" type="INT"/>
          <Column id="INVAT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="ITEM_CODE" size="50" prop="default" type="STRING"/>
          <Column id="ITEM_NAME" size="200" prop="default" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" prop="default" type="STRING"/>
          <Column id="LINE_STATUS" size="50" prop="default" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" prop="default" type="STRING"/>
          <Column id="OTCUSTCD" size="50" prop="default" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="PO_UOM" size="10" prop="default" type="STRING"/>
          <Column id="POINT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="PR_ID" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="PR_NUM" size="50" prop="default" type="STRING"/>
          <Column id="PR_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" prop="default" type="STRING"/>
          <Column id="PR_UPJANG" size="22" prop="default" type="INT"/>
          <Column id="RC_UPJANG" size="22" prop="default" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" prop="default" type="STRING"/>
          <Column id="TAX_CODE" size="3" prop="default" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" prop="default" type="BIGDECIMAL"/>
          <Column id="D_TIMES" size="4" prop="default" type="BIGDECIMAL"/>
          <Column id="D_DAY_DISP" size="200" prop="default" type="STRING"/>
          <Column id="IMAGE_PATH" size="200" prop="default" type="STRING"/>
          <Column id="OP_AMOUNT_OLD" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="DOCU_SOURCE" size="256" prop="default" type="STRING"/>
          <Column id="KEEPING_TYPE" type="STRING" size="256"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="ORIGIN_TYPE" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="PO_LINE_STATUS" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
          <Column id="APPROVE_TIME" type="STRING" size="256"/>
          <Column id="CREATE_BY" type="STRING" size="256"/>
          <Column id="PR_REMARK_RECENT" type="STRING" size="256"/>
          <Column id="T_ORDER" type="STRING" size="256"/>
          <Column id="KG_CONVERT_RATE" type="STRING" size="256"/>
          <Column id="UOM_CONVERT_RATE" type="STRING" size="256"/>
          <Column id="TOT_WGHT" type="STRING" size="256"/>
          <Column id="VC_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List1">
        <ColumnInfo>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="CENTER_FLAG" size="1" type="STRING"/>
          <Column id="CLS_STATUS" size="50" type="STRING"/>
          <Column id="CUSTCD" size="22" type="INT"/>
          <Column id="INVAT_FLAG" size="1" type="STRING"/>
          <Column id="ITEM_CODE" size="50" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="LINE_STATUS" size="50" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="OTCUSTCD" size="50" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" type="STRING"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="POINT_FLAG" size="1" type="STRING"/>
          <Column id="PR_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" type="STRING"/>
          <Column id="PR_UPJANG" size="22" type="INT"/>
          <Column id="RC_UPJANG" size="22" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="TAX_CODE" size="3" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="G_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" type="INT"/>
          <Column id="D_DAY_DISP" size="50" type="STRING"/>
          <Column id="D_TIMES" size="4" type="INT"/>
          <Column id="OTCUSTNM" size="100" type="STRING"/>
          <Column id="KG_CONVERT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="FEATURE_NAME" size="100" type="STRING"/>
          <Column id="IMAGE_PATH" size="200" type="STRING"/>
          <Column id="LIMIT_ITEM" size="50" type="STRING"/>
          <Column id="LIMIT_REASON" size="300" type="STRING"/>
          <Column id="WEEK_ITEM_CODE" size="300" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="IMAGE_YN" size="2" type="STRING"/>
          <Column id="KEEPING_TYPE" type="STRING" size="256"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="ORIGIN_TYPE" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
          <Column id="UNUSE_YN" type="STRING" size="256"/>
          <Column id="VAL_STP_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List2">
        <ColumnInfo>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="CENTER_FLAG" size="1" type="STRING"/>
          <Column id="CLS_STATUS" size="50" type="STRING"/>
          <Column id="CUSTCD" size="22" type="INT"/>
          <Column id="INVAT_FLAG" size="1" type="STRING"/>
          <Column id="ITEM_CODE" size="50" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="LINE_STATUS" size="50" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="OTCUSTCD" size="50" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" type="STRING"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="POINT_FLAG" size="1" type="STRING"/>
          <Column id="PR_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" type="STRING"/>
          <Column id="PR_UPJANG" size="22" type="INT"/>
          <Column id="RC_UPJANG" size="22" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="TAX_CODE" size="3" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="G_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" type="INT"/>
          <Column id="D_DAY_DISP" size="50" type="STRING"/>
          <Column id="D_TIMES" size="4" type="INT"/>
          <Column id="OTCUSTNM" size="100" type="STRING"/>
          <Column id="KG_CONVERT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="FEATURE_NAME" size="100" type="STRING"/>
          <Column id="IMAGE_PATH" size="200" type="STRING"/>
          <Column id="LIMIT_ITEM" size="50" type="STRING"/>
          <Column id="LIMIT_REASON" size="300" type="STRING"/>
          <Column id="WEEK_ITEM_CODE" size="300" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="IMAGE_YN" size="256" type="STRING"/>
          <Column id="KEEPING_TYPE" type="STRING" size="256"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="ORIGIN_TYPE" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
          <Column id="UNUSE_YN" type="STRING" size="256"/>
          <Column id="VAL_STP_YN" type="STRING" size="256"/>
          <Column id="PO_STATUS" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List3">
        <ColumnInfo>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="CENTER_FLAG" size="1" type="STRING"/>
          <Column id="CLS_STATUS" size="50" type="STRING"/>
          <Column id="CUSTCD" size="22" type="INT"/>
          <Column id="INVAT_FLAG" size="1" type="STRING"/>
          <Column id="ITEM_CODE" size="50" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="LINE_STATUS" size="50" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="OTCUSTCD" size="50" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" type="STRING"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="POINT_FLAG" size="1" type="STRING"/>
          <Column id="PR_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" type="STRING"/>
          <Column id="PR_UPJANG" size="22" type="INT"/>
          <Column id="RC_UPJANG" size="22" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="TAX_CODE" size="3" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="G_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" type="INT"/>
          <Column id="D_DAY_DISP" size="50" type="STRING"/>
          <Column id="D_TIMES" size="4" type="INT"/>
          <Column id="OTCUSTNM" size="100" type="STRING"/>
          <Column id="KG_CONVERT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="FEATURE_NAME" size="100" type="STRING"/>
          <Column id="IMAGE_PATH" size="200" type="STRING"/>
          <Column id="LIMIT_ITEM" size="50" type="STRING"/>
          <Column id="LIMIT_REASON" size="300" type="STRING"/>
          <Column id="WEEK_ITEM_CODE" size="300" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="IMAGE_YN" size="256" type="STRING"/>
          <Column id="KEEPING_TYPE" type="STRING" size="256"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="ORIGIN_TYPE" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_List4">
        <ColumnInfo>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="CENTER_FLAG" size="1" type="STRING"/>
          <Column id="CLS_STATUS" size="50" type="STRING"/>
          <Column id="CUSTCD" size="22" type="INT"/>
          <Column id="INVAT_FLAG" size="1" type="STRING"/>
          <Column id="ITEM_CODE" size="50" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="LINE_STATUS" size="50" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="OTCUSTCD" size="50" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" type="STRING"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="POINT_FLAG" size="1" type="STRING"/>
          <Column id="PR_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" type="STRING"/>
          <Column id="PR_UPJANG" size="22" type="INT"/>
          <Column id="RC_UPJANG" size="22" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="TAX_CODE" size="3" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="G_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" type="INT"/>
          <Column id="D_DAY_DISP" size="50" type="STRING"/>
          <Column id="D_TIMES" size="4" type="INT"/>
          <Column id="OTCUSTNM" size="100" type="STRING"/>
          <Column id="KG_CONVERT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="FEATURE_NAME" size="100" type="STRING"/>
          <Column id="IMAGE_PATH" size="200" type="STRING"/>
          <Column id="LIMIT_ITEM" size="50" type="STRING"/>
          <Column id="LIMIT_REASON" size="300" type="STRING"/>
          <Column id="WEEK_ITEM_CODE" size="300" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="IMAGE_YN" size="256" type="STRING"/>
          <Column id="KEEPING_TYPE" type="STRING" size="256"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="ORIGIN_TYPE" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_SubinvP"/>
      <Dataset id="ds_Class2"/>
      <Dataset id="ds_Class3"/>
      <Dataset id="ds_Class4"/>
      <Dataset id="ds_Excel"/>
      <Dataset id="ds_ErrLst">
        <ColumnInfo>
          <Column id="errmsg" size="500" type="STRING"/>
          <Column id="errcode" size="100" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Excel_IN">
        <ColumnInfo>
          <Column id="UPJANG" size="255" type="STRING"/>
          <Column id="ITEM_CODE" size="256" type="STRING"/>
          <Column id="NEED_DATE" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="ITEM_CODE"/>
            <Col id="NEED_DATE"/>
            <Col id="UPJANG"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Excel_OUT"/>
      <Dataset id="ds_Green">
        <ColumnInfo>
          <Column id="BALANCE_AMT" size="22" type="BIGDECIMAL"/>
          <Column id="GREEN_AMT" size="200" type="STRING"/>
          <Column id="USE_YN" size="2" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Green_Proc">
        <ColumnInfo>
          <Column id="UPJANG" size="256" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="256" type="STRING"/>
          <Column id="CUSER" size="256" type="STRING"/>
          <Column id="OUT_RTN_MESSAGE" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_WeekendTime">
        <ColumnInfo>
          <Column id="CODE" type="STRING" size="256"/>
          <Column id="CODE_NAME" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="SET1" type="STRING" size="256"/>
          <Column id="SET2" type="STRING" size="256"/>
          <Column id="SET3" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_save_out" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false"/>
      <Dataset id="ds_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codename" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_checkExceptCredit" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="EXCEPT_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ListCheck" cancolumnchange="ds_List_CanColumnChange" oncolumnchanged="ds_List_OnColumnChanged">
        <ColumnInfo>
          <Column id="CENTER_CODE" size="22" prop="default" type="INT"/>
          <Column id="CENTER_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="CLS_STATUS" size="50" prop="default" type="STRING"/>
          <Column id="CUSTCD" size="22" prop="default" type="INT"/>
          <Column id="INVAT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="ITEM_CODE" size="50" prop="default" type="STRING"/>
          <Column id="ITEM_NAME" size="200" prop="default" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" prop="default" type="STRING"/>
          <Column id="LINE_STATUS" size="50" prop="default" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" prop="default" type="STRING"/>
          <Column id="OTCUSTCD" size="50" prop="default" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="PO_UOM" size="10" prop="default" type="STRING"/>
          <Column id="POINT_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="PR_ID" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="PR_NUM" size="50" prop="default" type="STRING"/>
          <Column id="PR_QTY" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" prop="default" type="STRING"/>
          <Column id="PR_UPJANG" size="22" prop="default" type="INT"/>
          <Column id="RC_UPJANG" size="22" prop="default" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" prop="default" type="STRING"/>
          <Column id="TAX_CODE" size="3" prop="default" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" prop="default" type="BIGDECIMAL"/>
          <Column id="D_TIMES" size="4" prop="default" type="BIGDECIMAL"/>
          <Column id="D_DAY_DISP" size="200" prop="default" type="STRING"/>
          <Column id="IMAGE_PATH" size="200" prop="default" type="STRING"/>
          <Column id="OP_AMOUNT_OLD" size="22" prop="default" type="BIGDECIMAL"/>
          <Column id="DOCU_SOURCE" size="256" prop="default" type="STRING"/>
          <Column id="KEEPING_TYPE" type="STRING" size="256"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="ORIGIN_TYPE" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="PO_LINE_STATUS" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
          <Column id="APPROVE_TIME" type="STRING" size="256"/>
          <Column id="CREATE_BY" type="STRING" size="256"/>
          <Column id="PR_REMARK_RECENT" type="STRING" size="256"/>
          <Column id="T_ORDER" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_msg" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="NO" type="STRING" size="256"/>
          <Column id="TYPE" type="STRING" size="256"/>
          <Column id="MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_msg_out" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="NO" type="STRING" size="256"/>
          <Column id="TYPE" type="STRING" size="256"/>
          <Column id="MSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_temp">
        <ColumnInfo>
          <Column id="CENTER_CODE" size="22" type="INT"/>
          <Column id="CENTER_FLAG" size="1" type="STRING"/>
          <Column id="CLS_STATUS" size="50" type="STRING"/>
          <Column id="CUSTCD" size="22" type="INT"/>
          <Column id="INVAT_FLAG" size="1" type="STRING"/>
          <Column id="ITEM_CODE" size="50" type="STRING"/>
          <Column id="ITEM_NAME" size="200" type="STRING"/>
          <Column id="ITEM_SIZE" size="100" type="STRING"/>
          <Column id="LINE_STATUS" size="50" type="STRING"/>
          <Column id="MARGIN_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="MIN_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MAX_ORD_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="MULTIPLIER_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="NEED_DATE" size="8" type="STRING"/>
          <Column id="OTCUSTCD" size="50" type="STRING"/>
          <Column id="OUTVAT_FLAG" size="1" type="STRING"/>
          <Column id="PO_UOM" size="10" type="STRING"/>
          <Column id="POINT_FLAG" size="1" type="STRING"/>
          <Column id="PR_QTY" size="22" type="BIGDECIMAL"/>
          <Column id="PR_REMARK" size="300" type="STRING"/>
          <Column id="PR_UPJANG" size="22" type="INT"/>
          <Column id="RC_UPJANG" size="22" type="INT"/>
          <Column id="SALE_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="SALE_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="SUBINV_CODE" size="8" type="STRING"/>
          <Column id="TAX_CODE" size="3" type="STRING"/>
          <Column id="UNIT_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="OP_AMOUNT" size="22" type="BIGDECIMAL"/>
          <Column id="G_PRICE" size="22" type="BIGDECIMAL"/>
          <Column id="D_DAYS" size="4" type="INT"/>
          <Column id="D_DAY_DISP" size="50" type="STRING"/>
          <Column id="D_TIMES" size="4" type="INT"/>
          <Column id="OTCUSTNM" size="100" type="STRING"/>
          <Column id="KG_CONVERT_RATE" size="22" type="BIGDECIMAL"/>
          <Column id="FEATURE_NAME" size="100" type="STRING"/>
          <Column id="IMAGE_PATH" size="200" type="STRING"/>
          <Column id="LIMIT_ITEM" size="50" type="STRING"/>
          <Column id="LIMIT_REASON" size="300" type="STRING"/>
          <Column id="WEEK_ITEM_CODE" size="300" type="STRING"/>
          <Column id="CONSUM_YN" size="1" type="STRING"/>
          <Column id="IMAGE_YN" size="2" type="STRING"/>
          <Column id="KEEPING_TYPE" type="STRING" size="256"/>
          <Column id="APPLY_SD" type="STRING" size="256"/>
          <Column id="VD_SN" type="STRING" size="256"/>
          <Column id="ORIGIN_TYPE" type="STRING" size="256"/>
          <Column id="MOBILE_GUBUN" type="STRING" size="256"/>
          <Column id="MAX_SO_QTY" type="STRING" size="256"/>
          <Column id="UPJANG_GRP" type="STRING" size="256"/>
          <Column id="OP_RATE" type="STRING" size="256"/>
          <Column id="UNUSE_YN" type="STRING" size="256"/>
          <Column id="VAL_STP_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_search_oncolumnchanged">
        <ColumnInfo>
          <Column id="schMainUpjang" type="STRING" size="256"/>
          <Column id="schMainUpjangNm" type="STRING" size="256"/>
          <Column id="schUpjang" type="STRING" size="256"/>
          <Column id="schUpjangNm" type="STRING" size="256"/>
          <Column id="schStdDt" type="STRING" size="256"/>
          <Column id="schTotYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="schTotYn">0</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_budget"/>
      <Dataset id="ds_ctrlList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="rcUpjang" type="STRING" size="255"/>
          <Column id="subinvCode" type="STRING" size="255"/>
          <Column id="subinvAmt" type="BIGDECIMAL" size="255"/>
          <Column id="poAmt" type="BIGDECIMAL" size="255"/>
          <Column id="controlAmt" type="BIGDECIMAL" size="255"/>
          <Column id="controlYn" type="STRING" size="255"/>
          <Column id="nonCtrlAmt" type="BIGDECIMAL" size="255"/>
          <Column id="chkSave" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind/>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 식재영업/발주관리/상품 발주
 * 프로그램명   : FMP00080E.XML
 * 기      능   : 상품 발주
 * 작  성  자   : 박은규
 * 작성  일자   : 2008-01-17
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 *				2017.03.20	kihoon	[CH201703_00486] 식당검색기능 추가 / 기획상품 검색안내 추가
 *				2017.04.03	kihoon	[CH201703_00816] 최대발주 수량 제어
 *				2017.04.05	kihoon	[CH201704_00069] 최대발주 수량 제어 로직 수정
 *				2017.04.20	kihoon	[선반영] 상품발주 저장 시(업장변경) 여신확인 제외 업장에 대한 처리 [fn_checkExceptCredit()]
 ******************************************************************************************
*/
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"				// 시스템 공통
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"		//JAVA 코딩시
//@@컨버터에서 주석처리 #include "LIB::tit_comm_0001.js"		// X-Framework Lib
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"		// 공통팝업
//@@컨버터에서 주석처리 #include "lib::fm_common.js"			// FM공통
//=========================================================================================
// [ PART 2 ]    
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var fa_Sql;
var fa_sDay;
var fa_DocSrc = '07 FM(상품)';
var fa_DocSrc1 = '07 FM';             //구 푸드엠 주문내용  ---> 상품발주로 간주
var fa_DocSrc2 = '01 BO';             //통합영업 주문내용   ---> 상품발주로 간주
var fa_DocSrc3 = '07 FM(모바일)';    //모바일 주문내용
var pre_need_date = gfn_addDate(gfn_today(),1);  				  //날짜 변경전 이전 날짜 기억
var fa_weekendTimeCheck = "N"; // 주말 발주 통제 여부
var fa_startTime; // 통제시작시간
var fa_endTime; // 통제종료시간

//최초등록시 주문번호 채번, 이후에는 같은 주문번호로 발주되도록 함
var fn_gubunNewOrOld = "NEW";
var fn_maxPrNum = "";
var fn_maxApproveNum = "";
var fn_maxBefApproveNum = "";
var fn_dsListCnt = 0;
var pre_need_date_temp = ""; //달력 컴포넌트 날짜 변경 전 이전 날짜 기억 2017.10.13 김호석 추가
var fv_chkMsg = "";
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);
	
	//초기화
	fsp_init(this);
	v_ds_check = "ds_List";
	
	//사용자관리화면에서 [여신/공급업체] 항목의 값을 들고와서 
	//발주가능금액, 채권잔액, 실시간입금확인을 컨트롤 함 - (김진희 2014.02.19)
	if (g_Simple_Po_Yn == "Y") 
	{
		//발주가능금액 컨트롤
		st_Credit.visible = true;
		ed_Credit.visible = true;
		//채권잔액 컨트롤
		st_Bond.visible = true;
		ed_Bond.visible = true;
		//실시간입금확인 컨트롤
		btn_RcpConf.visible = true;

		//공급업체 컬럼 컨트롤
		tab_list.tab1.gd_list.setFormatColProperty(11, "size", 80);
		tab_list.tab2.gd_list.setFormatColProperty(11, "size", 80);
		tab_list.tab3.gd_list.setFormatColProperty(11, "size", 80);
		tab_list.tab4.gd_list.setFormatColProperty(12, "size", 80);	
	}	
	else 
	{
		//발주가능금액 컨트롤
		st_Credit.visible = false;
		ed_Credit.visible = false;
		//채권잔액 컨트롤
		st_Bond.visible = false;
		ed_Bond.visible = false;
		//실시간입금확인 컨트롤
		btn_RcpConf.visible = false;

		//공급업체 컬럼 컨트롤
		tab_list.tab1.gd_list.setFormatColProperty(12, "size", 0);
		tab_list.tab2.gd_list.setFormatColProperty(12, "size", 0);
		tab_list.tab3.gd_list.setFormatColProperty(12, "size", 0);
		tab_list.tab4.gd_list.setFormatColProperty(13, "size", 0);
			
	}

	//기본적으로 사업장은 채권잔액 공개않함. - 이혜은(20130422)
	if(application.g_UserKind == "사업장")
	{
		st_Bond.visible = false;
		ed_Bond.visible = false;
	}

	//실시간 입금확인
	var nX = btn_RcpConf.position.left - (dv_RcpConf.position.width - btn_RcpConf.position.width);
	var nY = btn_RcpConf.position.bottom + 1
	dv_RcpConf.move(nX, nY);	
	
	var strCurrent = fn_CurrDateWeek();
	
	dv_RcpConf.me_RcpDateT.value = strCurrent;
	dv_RcpConf.me_RcpDateF.value = gfn_addDate(strCurrent,-1);
	
	ed_Upjang.userdata = application.g_Upjang;
	ed_Upjang.value     = application.g_UpjangNm;
	me_NeedDate.value  = gfn_addDate(strCurrent,1); //addDate(today(),1);
	//날자 셋팅 후 일자도 변경
	st_Week.text = "(" + ffn_DayToWeek(me_NeedDate.value) + ")";
	if (st_Week.text == "(토)")
		st_Week.style.color = "blue";
	else if (st_Week.text == "(일)")
		st_Week.style.color = "red";
	else
		st_Week.style.color = "black";
	//공휴일색변경	
	if(gfn_length(fn_isHoliday(me_NeedDate.value))>0)
	{
		st_Week.style.color = "red";
	}

	if (g_UserKind == '본부')
	{
		//btn_copy.visible = true;
	}
	else {	btn_copy.visible = false; }
	
	//초기화
	fn_ResetData();
	
	// FICS 발주제한요일, 시간 설정 조회
	//fn_getWeekendTime();
	
	//Init 조회 서비스(속도 개선 async 통신으로 변경)
    fn_InitService();
		
	//분류세팅  2008.12.11 분류 추가. By Noh Kyu Wan
	fn_sql_common("C", strQuery_FMItemClass	," AND A.USE_YN = 'Y' AND A.CLASS_TYPE = 'M' AND A.CLASS_CODE LIKE 'F%' "," ORDER BY A.CLASS_CODE","all",tab_list.tab1.cbo_Class2,-1,ds_Class2); tab_list.tab1.cbo_Class2.index = 0;
	fn_sql_common("C", strQuery_FMItemClass	," AND A.USE_YN = 'Y' AND A.CLASS_TYPE = 'S' AND A.CLASS_CODE LIKE 'F%' "," ORDER BY A.CLASS_CODE","all",tab_list.tab1.cbo_Class3,-1,ds_Class3); tab_list.tab1.cbo_Class3.index = 0;
	fn_sql_common("C", strQuery_FMItemClass	," AND A.USE_YN = 'Y' AND A.CLASS_TYPE = 'D' AND A.CLASS_CODE LIKE 'F%' "," ORDER BY A.CLASS_CODE","all",tab_list.tab1.cbo_Class4,-1,ds_Class4); tab_list.tab1.cbo_Class4.index = 0;
	
	//인에프앤씨 본사 및 하위가맹점에 대해 상품조회 탭 비활성화 작업 요청 (외식식재영업팀 한윤환)
	/*
	if(application.g_Main_Upjang == "157091")
	{
		tab_list.tab1.enable = false;
		tab_list.tab2.setFocus();
	}
	*/
	
	if(g_EmpNo.substr(0,2) <> "CS" && g_EmpNo.substr(0,2) <> "FM" )
	{
		gd_list.formatid = "CPY";
	}
	else
	{
		gd_list.formatid = "ORI";
	}
	
	/////fn_searchItemUpMemory();
}


function fn_InitService()
{
	////////// 1. 센터단가업장정보 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc, trId;
	trId  = "searchCtUpj";
    outData		= "ds_CtUpj=ds_List";
    otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);
    callBackFnc = "fn_CallbakInitService";
	fsp_clear(this); 
	fsp_addSearch(this, "fm/fmz:FMZ_GET_CTUPJ_S001");
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc, "", "", "", trId);
}

function fn_CallbakInitService(errCode, errMsg, svcId)
{	
	if (errCode == 0)
	{
	    
	    switch(svcId)
		{
			case "searchCtUpj":
				
				if (ds_CtUpj.rowcount <= 0)
				{
					g_Message("EE","업장기초정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
					return;
				}
				
				////////// 2. 창고 조회
				ds_Subinv.clearData();
				var actionName, cmdName, inData, outData, otherArg, callBackFnc, trId;
				trId  = "searchSubinv";
				outData		= "ds_Subinv=ds_List";
				otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);
				callBackFnc = "fn_CallbakInitService";
				
				fsp_clear(this); 
				fsp_addSearch(this, "fm/fmz:FMZ_PO_SUBINV_S001");
				fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc, true, "", "", trId);
	            
				break;
			
			case "searchSubinv":
				//기본창고지정
	            if (ds_Subinv.rowcount > 0) cbo_Subinv.index = 0;
	            
	            tab_list.tab4.ed_UpjangP.userdata = ed_Upjang.userdata;
				tab_list.tab4.ed_UpjangP.value     = ed_Upjang.value;
				Copy(ds_SubinvP,ds_Subinv);
				tab_list.tab4.cbo_SubinvP.value   = cbo_Subinv.value;
				tab_list.tab4.me_NeedDateP.value  = gfn_addDate(me_NeedDate.value,-7);
	            
	            ////////// 3. 디데이 조회
				ds_Days.clearData();
				var actionName, cmdName, inData, outData, otherArg, callBackFnc, trId;
				trId  = "searchDays";
				outData		= "ds_Days=ds_List";
				otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata) + " SUBINV_CODE=" + wrapQuote(cbo_Subinv.value) + " NEED_DATE=" + wrapQuote(me_NeedDate.value);
				callBackFnc = "fn_CallbakInitService";
				fsp_clear(this); 
				fsp_addSearch(this, "fm/fmz:FMZ_GETDAYS_S001");
				fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc, "", "", "", trId);
				
				////////// 4. 주문통제 조회
				ds_OrdCtrl.clearData();
				var actionName, cmdName, inData, outData, otherArg, callBackFnc, trId;
				trId  = "searchOrdCtrl";
				outData		= "ds_OrdCtrl=ds_List";
				otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);
				callBackFnc = "fn_CallbakInitService";
				fsp_clear(this); 
				fsp_addSearch(this, "fm/fmz:FMZ_ORD_CTRL_S001");
				fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc, "", "", "", trId);
				
				////////// 5. 사업장이 여신관리하는지 여부 조회
// [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
				if ( !fn_GetCredit() ) return; // 여신정보 조회

				//자동조회
				fn_search();
// 				var dsObjin, dsObjot;
// 				create("Dataset", "ds_Dummyin");
// 				create("Dataset", "ds_Dummyot");
// 				dsObjin = eval("ds_Dummyin");
// 				dsObjin.addColumn("UPJANG", "INT", 22);
// 				dsObjin.addColumn("NEED_DATE", "STRING", 8);
// 				dsObjot = eval("ds_Dummyot");
// 				dsObjot.addColumn("CRD_YN", "STRING", 1);
// 				ds_Dummyin.clearData();
// 				ds_Dummyot.clearData();
// 				ds_Dummyin.addRow();
// 				ds_Dummyin.setColumn(0, "UPJANG",         ed_Upjang.userdata);
// 				ds_Dummyin.setColumn(0, "NEED_DATE",      me_NeedDate.value);
// 				var actionName, cmdName, inData, outData, otherArg, callBackFnc, trId;
// 				trId  = "searchCreditChk";
// 				inData		= "ds_Cond=ds_Dummyin";
// 				outData		= "ds_Dummyot=ds_List";
// 				fsp_clear(this); 
// 				fsp_addSearch(this, "fm/fmz:FMZ_CREDIT_CHKYN_S001");
// 				fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc, "", "", "", trId);
// [속도개선 Project   끝] 2017. 8. 21. 최범주
				break;
				
			case "searchDays":
				
				//디데이 표시
				if (ds_Days.rowcount > 0) {
					st_Days.text = "(발주 마감 : " + ds_Days.getColumn(0,"DAYS") + ")";
				} else {
					g_Message("EE","발주마감정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
				}
	            
				break;	
				
// [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
// 			case "searchCreditChk":
// 				
// 				/*여신정보조회(비동기조회)*/
// 				fn_GetCredit(false);
// 				
// 				/*자동조회*/
// 				fn_search();
// 				
// 				/*
// 				if (ds_Dummyot.rowcount > 0) {
// 					
// 					////////// 6. 여신정보 조회
// 					ds_Cond.clearData();
// 					ds_CrdInfo.clearData();
// 					ds_Cond.addRow();
// 					ds_Cond.setColumn(0, "UPJANG",         ed_Upjang.userdata);
// 					ds_Cond.setColumn(0, "NEED_DATE",      me_NeedDate.value);
// 					var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, trId;
// 					strSvcID = "searchCreditInfo";
// 					//strURL   = "U_svc::" + "fm/fmz/FMZ_CREDIT_INFO_T001.jsp";
// 					strURL   = "U_svc::" + "fm/fmz/FMZ_CREDIT_INFO_PRT_T003.jsp";
// 					strInDatasets  = "ds_Cond=ds_Cond";
// 					strOutDatasets = "ds_CrdInfo=ds_List";
// 					strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
// 					strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
// 					strCallbackFunc = "fn_CallbakInitService";
// 					jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, "", "", "");
// 					
// 				} else {
// 					//여신정보 초기화
// 					ds_CrdInfo.clearData();
// 					ed_Credit.value = "무 제 한";
// 					return;
// 				}
// 				
// 				//ds임시생성 해제
// 				Destroy("ds_Dummyin");
// 				Destroy("ds_Dummyot");
// 				*/
// 				break;
// [속도개선 Project   끝] 2017. 8. 21. 최범주
				
// [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
// 			case "searchCreditInfo":
// 				
// 				//여신 표시
// 				/*
// 				if (ds_CrdInfo.rowcount > 0) 
// 				{
// 					if (ds_CrdInfo.getColumn(0,"CREDIT_AMOUNT_CONTROL_YN") == "Y")
// 					{
// 						ed_Credit.value = gfn_numFormat(gfn_trim(ds_CrdInfo.getColumn(0,"CREDIT_RMN_AMT")))+ " 원";
// 						ed_Bond.value = gfn_numFormat(gfn_trim(ds_CrdInfo.getColumn(0,"BOND_AMT")))+ " 원";
// 					}	
// 					else
// 						ed_Credit.value = "무 제 한";
// 				}
// 				else
// 				{
// 					g_Message("EE","업장여신정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
// 					return;
// 				}
// 				
// 				//최종 발주정보
// 				//fn_GetLastOrd();
// 				
// 				//자동조회
// 				fn_search();
// 				*/
// 				break;	
// [속도개선 Project   끝] 2017. 8. 21. 최범주
				
			default:
				break;
		}
	    
	} else {
		g_Message("EE",fn_AlertMsg("002"));
	}
}

//=========================================================================================
// [ PART 4 ] 
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*------------------------------------------------------------(60)
	1. Function ID : fn_Search()
	2. 개       요 : 업무프로세스에 따른 조회작업
	3. 기       능 : 검색조건에 해당하는 정보를 조회
	4. 인 수 설 명 : 
*/
function fn_search(isSave)
{
	// 발주저장전 발주상태 재확인
	if ( gfn_isNull(isSave) ) {
		isSave = false;
	}
		
	//필수항목 
	if (fn_ChkManNull()) return;
	//입고통제일 체크 
	if (fn_NeedDateCheck()) 
	{
	    g_Message("EE","해당일자는 입고통제일 입니다.");
	    ds_List.clearData();
	    ds_List1.clearData();
		return;
	}	
	
	//2017.10.13 김호석 추가 입고일자 변경 전으로 되돌림
	pre_need_date_temp = me_NeedDate.value;
		
	fn_SetTimer();
	//최종발주정보
	fn_GetLastOrd();
	fn_getBudgetInfo();
	// 초기화
	ds_Cond.clearData();
	
	st_ctrlAmt.visible = false;
	
	if ( !isSave ) {
		ds_List.clearData();
	}
	ds_Cond.addRow();
	ds_Cond.setColumn(0, "SUBINV_CODE",    cbo_Subinv.value);
	ds_Cond.setColumn(0, "NEED_DATE",      me_NeedDate.value);
	ds_Cond.setColumn(0, "QTY_CONTROL_YN", ds_Days.getColumn(0,"QTY_CONTROL_YN"));
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	// 파라미터셋팅
    inData		= "ds_Cond=ds_Cond";
    
    if ( isSave ) {
		outData		= "ds_ListCheck=ds_List";
		callBackFnc	= "";
    } else {
		outData		= "ds_List=ds_List";
		callBackFnc	= "fn_CallBack_Search";
    }
    
    
	otherArg    = "DocSrc=" + wrapQuote(fa_DocSrc);
	otherArg   += " DocSrc1=" + wrapQuote(fa_DocSrc1);
	otherArg   += " DocSrc2=" + wrapQuote(fa_DocSrc2);
	otherArg   += " DocSrc3=" + wrapQuote(fa_DocSrc3);
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmp:FMP00160E_S002");
	// 서버 호출 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
    http.Sync = false;
    
    //trace(ds_ListCheck.saveXML());
    if ( isSave ) {
		
		fn_getOrderCtrlList();
		
		// save check 로직에서 dateset 확인
		return ds_ListCheck;
    }
    
    /*
    if (ed_Green.visible == true)
    {
		//보조금 금액 재 계산 프로시져 호출     
		fn_Create_Green_Amt();
		
		//보조금 사용 후 잔액 조회
		//fn_Green_Amt();    
    } 
    */
}
function fn_NeedDateCheck()
{
	//ds임시생성
	var dsObjin, dsObjot;
		
	create("Dataset", "ds_Dummyin");
	create("Dataset", "ds_Dummyot");
	
	dsObjin = eval("ds_Dummyin");
	dsObjin.addColumn("UPJANG", "INT", 22);
	dsObjin.addColumn("NEED_DATE", "STRING", 8);
	dsObjot = eval("ds_Dummyot");
	dsObjot.addColumn("CNT", "INT", 22);
	
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 초기화
	ds_Dummyin.clearData();
	ds_Dummyot.clearData();
	ds_Dummyin.addRow();
	ds_Dummyin.setColumn(0, "UPJANG",         ed_Upjang.userdata);
	ds_Dummyin.setColumn(0, "NEED_DATE",      me_NeedDate.value);
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    inData		= "ds_Cond=ds_Dummyin";
    outData		= "ds_Dummyot=ds_List";
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_ORD_CTRL_S002");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	var bYn = (ds_Dummyot.getColumn(0, "CNT") > 0);
	//ds임시생성 해제
	Destroy("ds_Dummyin");
	Destroy("ds_Dummyot");
	
	return bYn;
}

function fn_SearchItem()
{
	// 2016.09.04 추가
	if ( tab_list.tabindex == 0 ) {
		if ( ffn_ChkNull(tab_list.tab1.ed_Item.value) && ffn_ChkNull(tab_list.tab1.cbo_Class4.value) ) {
			g_Message("EE", "세분류 또는 상품검색어를 입력하세요.");
			tab_list.tab1.ed_Item.setFocus();
			//return false;
		}
	}
	
	//필수항목 
	if (fn_ChkManNull()) return;
	//발주가능 체크
	if (! fn_OrdChk())
	{
		btn_NeedDate.setFocus();
		return;
	}
/*
	//입고통제일 체크 
	if (fn_NeedDateCheck()) 
	{
	    g_Message("EE","해당일자는 입고통제일 입니다.");
		return;
	}	
*/
	// 초기화
	ds_Cond.clearData();
	eval("ds_List" + gfn_toString(tab_list.tabindex+1)).clearData();
	ds_Cond.addRow();
	ds_Cond.setColumn(0, "UPJANG",        ed_Upjang.userdata);
	ds_Cond.setColumn(0, "SUBINV_CODE",   cbo_Subinv.value);
	ds_Cond.setColumn(0, "NEED_DATE",     me_NeedDate.value);
	ds_Cond.setColumn(0, "CONSUM_YN",     ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN"));
	ds_Cond.setColumn(0, "QTY_CONTROL_YN",ds_Days.getColumn(0,"QTY_CONTROL_YN"));
	ds_Cond.setColumn(0, "CENTER_CODE",   			ds_CtUpj.getColumn(0,"CENTER_CODE"));
	ds_Cond.setColumn(0, "AP_UNITPRICE_UPJANG",     ds_CtUpj.getColumn(0,"AP_UNITPRICE_UPJANG"));
	ds_Cond.setColumn(0, "OTCUST_PRICE_UPJANG",     ds_CtUpj.getColumn(0,"OTCUST_PRICE_UPJANG"));
	ds_Cond.setColumn(0, "ITEM_NAME",     eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.text);
	if (tab_list.tabindex == 1)
		ds_Cond.setColumn(0, "FAVOR_GROUP",   tab_list.tab2.cbo_Fav.value);
		
	else if (tab_list.tabindex == 0) // 2008.12.11 추가(분류별 상품 조회 기능)
	{
		ds_Cond.setColumn(0, "ITEM_CLASS2", tab_list.tab1.cbo_Class2.value);    //중분류
		ds_Cond.setColumn(0, "ITEM_CLASS3", tab_list.tab1.cbo_Class3.value);	//소분류
		ds_Cond.setColumn(0, "ITEM_CLASS4", tab_list.tab1.cbo_Class4.value);	//세분류
	}
	else if (tab_list.tabindex == 3)
	{
		if (ffn_ChkNull(tab_list.tab4.me_NeedDateP.value))
		{
			g_Message("EE", "복사대상 일자를 선택하세요."); tab_list.tab4.me_NeedDateP.setFocus(); return;
		}
		if (ffn_ChkNull(tab_list.tab4.ed_UpjangP.userdata))
		{
			g_Message("EE", "복사대상 업장을 선택하세요."); tab_list.tab4.ed_UpjangP.setFocus(); return;
		}
		if (ffn_ChkNull(tab_list.tab4.cbo_SubinvP.value))
		{
			g_Message("EE", "복사대상 식당을 선택하세요."); tab_list.tab4.cbo_SubinvP.setFocus(); return;
		}
		ds_Cond.setColumn(0, "NEED_DATEP",    tab_list.tab4.me_NeedDateP.value);
		ds_Cond.setColumn(0, "UPJANGP",       tab_list.tab4.ed_UpjangP.userdata);
		ds_Cond.setColumn(0, "SUBINV_CODEP",  tab_list.tab4.cbo_SubinvP.value);
	}
	
	// 조회
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMP00080E_T001";
	
	/*
	if(tab_list.tabindex == 0)	//상품조회 일 때는 바인드 된 jsp를 호출 하게 한다. 2016-09-02 박용대
	{
		strURL   = "U_svc::" + "fm/fmp/FMP00080E_T001_bind.jsp";
	}
	else
	{
		strURL   = "U_svc::" + "fm/fmp/FMP00080E_T001.jsp";
	}
	*/
	strURL   = "U_svc::" + "fm/fmp/FMP00080E_T001.jsp";	// renwebind ㅜㅜ
	
	// 데이터셋 설정
	strInDatasets  = "ds_Cond=ds_Cond";
	strOutDatasets = "ds_List" + gfn_toString(tab_list.tabindex+1)+ "=ds_List";
	// 파라메터 설정
	strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
	strArgument += " Holiday_YN=" + wrapQuote(application.g_HOLIDAY_CHK_YN);	
	strArgument += " strIndex=" + wrapQuote(gfn_toString(tab_list.tabindex+1));
	strArgument += " strWeekendTimeCheck=" + wrapQuote(fa_weekendTimeCheck);
	
    if (eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).chk_Only.value == "1") {
		strArgument += " strOnly='TRUE'";
    } else {
		strArgument += " strOnly='FALSE'";
    }
	
	/*
	if (tab_list.tab1.chk_ThreeMonth.value == "1") {
		strArgument += " strThreeMonth='TRUE'";
    } else {
		strArgument += " strThreeMonth='FALSE'";
    }
	*/
	// 최근 n개월
	strArgument += " nMonth="+wrapQuote(tab_list.tab1.cbo_month.value);
		
	strArgument += " sType=" + wrapQuote(cbo_Type.value);
	
	// 콜백함수 지정
	strCallbackFunc = "fn_CallBack_SearchItem";
	// 서버 호출 
	//Transaction(strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc);
	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true); 
	
	//trace("즐겨찾기 발주 조회 테스트");
	//trace(strOutDatasets);	//ds_List4
	//trace(ds_List4.saveXML());
	//trace(ta_Sql.value);
}

/*------------------------------------------------------------
	1. Function ID : fn_Insert()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_insert()
{
}
/*------------------------------------------------------------
	1. Function ID : fn_Delete()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_delete()
{
	if (ds_List.rowcount < 1)
	{
		g_Message("EE", fn_AlertMsg("006"));
		return;
	}
	
	if (ds_List.rowposition < 0  || ds_List.getSelect(ds_List.rowposition) == false)
	{
		g_Message("EE", "삭제할 상품을 선택하세요.");
		return;
	}
	//if (ds_List.GetColumn(ds_List.row,"LINE_STATUS") <> "004")
	if (ds_List.getColumn(ds_List.rowposition,"CLS_STATUS") == "마감")
	{
		g_Message("EE", "해당상품은 마감이 완료되어 삭제가 불가합니다.");
		return;
	}
	//발주가능 체크
	if (! fn_OrdChk()) return;
	//기존 자료인 경우 디데이 체크
	if (GetRowType(ds_List,ds_List.rowposition)<> 'insert')
	{
		if (fn_GetDayStatus(ds_List.getColumn(ds_List.rowposition,"D_DAYS"), ds_List.getColumn(ds_List.rowposition,"D_TIMES")) == "0")
		{
			g_Message("EE","해당 상품은 마감시간(D-Days)이 초과되어 삭제가 불가합니다.");
			return;
		}
	}
	//
	
	
	if (! g_Confirm("01", '선택하신 주문상품을 삭제하시겠습니까?!')) return;
	
	if (GetRowType(ds_List,ds_List.rowposition)== 'insert')
	{
		ds_List.deleteRow(ds_List.rowposition);
		return;
	}
	
	//실제 Table자료 삭제 시 Table에서 즉시 삭제처리
	//필수항목 
	if (fn_ChkManNull()) return;
	//
	
	var rtnCheckMsg = fn_checkLineStatus("delete");
	if ( !gfn_isNull(rtnCheckMsg) ) {
		g_Message("EE", rtnCheckMsg);
		fn_search();
		return;
	}
	
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMP00160E_T003";
	strURL   = "U_svc::" + "fm/fmp/FMP00160E_T003.jsp";
	// 데이터셋 설정U
	strInDatasets  = "";
	strOutDatasets = "";
	
	strInDatasets += "ds_msg=ds_msg:U";
	strOutDatasets += "ds_msg_out=ds_msg_out";
		
	// 파라메터 설정
	strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
	strArgument += " sDocSrc=" + wrapQuote(fa_DocSrc);
	strArgument += " sPrID=" + wrapQuote(ds_List.getColumn(ds_List.rowposition,"PR_ID"));
	strArgument += " sPrNum=" + wrapQuote(ds_List.getColumn(ds_List.rowposition,"PR_NUM"));
	strArgument += " sOtcustCD=" + wrapQuote(ds_List.getColumn(ds_List.rowposition,"OTCUSTCD"));
	strArgument += " sMenuFlag=" + wrapQuote("N");
	strArgument += " sUpjang=" + wrapQuote(ds_List.getColumn(ds_List.rowposition,"RC_UPJANG"));
	strArgument += " sMenuCD=" + wrapQuote(ds_List.getColumn(ds_List.rowposition,"NEED_DATE") + "-" + ds_List.getColumn(ds_List.rowposition,"SUBINV_CODE"));
	strArgument += " sItemCode=" + wrapQuote(ds_List.getColumn(ds_List.rowposition,"ITEM_CODE"));
	strArgument += " sPrUpjang=" + wrapQuote(ed_Upjang.userdata);
	strArgument += " sPrSabun=" + wrapQuote(g_EmpNo);
// [속도개선 Project 시작] 2017. 8. 4. 최범주 여신금액 집계 프로시저 추가
    strArgument += " sSubinv=" + wrapQuote(cbo_Subinv.value);     // 식당(창고)
    strArgument += " sNeedDate=" + wrapQuote(me_NeedDate.value);  // 입고예정일
	strArgument += " scrnId=" + wrapQuote("FMP00080E");           // 화면ID
	strArgument += " scrnName=" + wrapQuote("상품발주");          // 화면명
// [속도개선 Project   끝] 2017. 8. 4. 최범주	
	// 콜백함수 지정
	strCallbackFunc = "fn_CallBack_Delete";
	// 서버 호출 
	//Transaction(strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc);
	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
}
/*------------------------------------------------------------
	1. Function ID : fn_Save(confirmYn)
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : confirmYn = null 이면 저장하시겠습니까라는 창을 띄움
	                 confirmYn = 1 이면 저장하시겠습니까라는 창을 안띄움
*/
function fn_save(confirmYn)
{
	//저장 버튼 누른 후 팝업 상태에서 마감시간 이후 저장 체크를 위한 변경
	//[HISTORY] : 수정일 > 2009/01/19
	//            수정자 > 노규완
	//            수정 내용 > 저장 Confirm 팝업 메시지를 제일 먼저 띄어 줌.
	
/*
	//입고통제일 체크 
	if (fn_NeedDateCheck()) 
	{
	    g_Message("EE","해당일자는 입고통제일 입니다.");
		return;
	}	
*/
	// 구멍 매꾸기
	if ( div_cmnBtn.btn_save.enable == false || div_cmnBtn.btn_save.visible == false ) {
		g_Message("EE","발주 정보를 저장할 권한이 없습니다.");
		return;
	}
	
	/*시스템 통제 시간 체크 - 특정일자에 사용을 할 수 없게 한다.*/
	mfn_GetSystemWorkCheck("PO");
	if (ds_common.getColumn(0, 0) == "Y")
	{
		g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
		return false; 
	}

// [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
// 	if (ed_Credit.value == "여신정보갱신중")
// 	{
// 		alert("여신정보갱신중입니다. 조금만 기다려주세요");
// 		return;
// 	}
// [속도개선 Project   끝] 2017. 8. 21. 최범주

	//입고예정일 변경 확인 2017.10.18 김호석(하단 주문내역 그리드의 입고예정일과 검색조건 입고예정일 비교) 시작
	//그리드의 입고예정일은 검색조건의 입고예정일로 조회 후 표시또는 추가되므로 조회 시(fn_search함수) 이전 입고예정일 저장(pre_need_date_temp)	
	var from_need_date = "";
	var to_need_date = "";
	from_need_date = pre_need_date_temp;
	to_need_date = me_NeedDate.value;
	
	if (from_need_date.length  == 8) 
	{
		from_need_date = from_need_date.slice(0,4) + "-" + from_need_date.slice(4,6) + "-" + from_need_date.slice(6,8);
	}
	if (to_need_date.length  == 8) 
	{
		to_need_date = to_need_date.slice(0,4) + "-" + to_need_date.slice(4,6) + "-" + to_need_date.slice(6,8);
	}
	
	if (pre_need_date_temp != me_NeedDate.value) {
		
		// 저장 전 사용자 메세지 전달
		if (g_Confirm("02", "입고예정일이 " + from_need_date + "에서 " + to_need_date + "로 변경되었습니다. \n입고예정일 " + from_need_date + "로 주문내역을 저장하시겠습니까? "))
		//g_Message("EE","변경된 내역이 있습니다. 저장해 주십시요");
		{ 	
			me_NeedDate.value = pre_need_date_temp;			
		} else {
			me_NeedDate.value = pre_need_date_temp;
			g_Message("EE","입고예정일이 " + from_need_date + "에서 " + to_need_date + "로 변경되었습니다.");
			return;		
		}
		
	}
	//입고예정일 변경 확인 2017.10.18 김호석(하단 주문내역 그리드의 입고예정일과 검색조건 입고예정일 비교) 끝
	
	
	// 통제 창고인 경우
	gd_list.updateToDataset();
	if ( ds_ctrlList.lookup("subinvCode", cbo_Subinv.value, "controlYn") == "Y" ) {
		var bMix = true;
		//if ( ds_List.rowcount == ds_List.getCaseCount("D_DAYS == '1' && PR_QTY >= 0") ) {
		if ( ds_List.getCaseCount("PR_QTY > 0") == ds_List.getCaseCount("D_DAYS == '1' && PR_QTY > 0") ) {
			bMix = false;
		} else {
			bMix = true;
		}
		
		//trace(ds_List.getCaseCount("PR_QTY > 0") +"=="+ ds_List.getCaseCount("D_DAYS == '1' && PR_QTY >= 0"));
		var rtnAmt = fn_getOrderStatus("recheck");
		
		if ( (ds_List.getCaseCount("D_DAYS == '1' && PR_QTY > 0") > 0) && (rtnAmt.ctrlAmt > rtnAmt.poAmt) ) {
		
			var  strMsg = "최소발주금액[" + gfn_numFormat(ds_ctrlList.lookup("subinvCode", cbo_Subinv.value, "controlAmt")) + "]원보다";
				 strMsg += " [" + gfn_numFormat(rtnAmt.ctrlAmt - rtnAmt.poAmt) + "]원 부족합니다.\r\n\r\n";
			
			if ( !bMix ) {
				strMsg += "발주금액을 확인하시기 바랍니다.";
				
			} else {
				strMsg += "D-2상품은 금액과 상관없이 주문가능하나, D-1상품은 저장할 수 없습니다.";
				
				/*
				strMsg += "D-2상품은 금액과 상관없이 주문가능하며,\r\n\D-1상품은 삭제됩니다.\r\n\D-2상품만 주문하시겠습니까?";
				
				if ( g_Confirm("01", strMsg) ) {
					for ( var z=ds_List.rowcount; z>=0; z-- ) {
						if ( (ds_List.getRowType(z) == Dataset.ROWTYPE_INSERT) && ds_List.getColumn(z, "D_DAYS") == "1" ) {
							ds_List.deleteRow(z);
						}
					}
				} else {
					return;
				}
				*/
			}
	
			g_Message("EE", strMsg);
	
			if ( g_EmpNo.substr(0,2) <> "CS" && g_EmpNo.substr(0,2) <> "FM" ) {
				// 내부지원 skip
			} else {	// 고객
				return;
			}
		}
	}
	

	
	// 저장 전 사용자 메세지 전달
	if (! g_Confirm("", "주문내역을 저장하시겠습니까?"))
	{
		return;
	}
	
	//발주량 0상품 확인
	var nRow;
	nRow = ds_List.findRowExpr("PR_QTY==0");
	if (nRow >= 0)
	{
		if (! g_Confirm("02", "발주량이 0인 상품이 있습니다.\n\n그대로 저장하시겠습니까?"))
		{
			ds_List.rowposition = nRow;
			gd_list.setFocus();
			gd_list.setCellPos(ffn_Get_HeaderTitleColIdx(gd_list,"수량"));
			return;
		}
	}
	

	
	//현재시간 초기화. 
	//발주가능, 데이타체크에서 현재시간을 통해 계산하기때문에
	fn_SetTimer();
	
	//필수항목 
	if (fn_ChkManNull()) return;
	
	//발주가능 체크(창고)
	if (! fn_OrdChk()) return;
	
	// 데이타체크(여신및 상품별 디데이체크)
	var sRtn = fn_ChkData();
	
	if (sRtn != null)
	{
		g_Message("EE", sRtn);
		return;
	}
	
/*
   	// action 정보 초기화 
    tit_clearActionInfo(this);
	// 초기화
	ds_Cond.ClearData();
	ds_Cond.AddRow();
	ds_Cond.SetColumn(0, "SUBINV_CODE",    cbo_Subinv.Value);
	ds_Cond.SetColumn(0, "NEED_DATE",      me_NeedDate.Value);
    // 서비스셋팅
    var actionName, cmdName, inData, outData, otherArg, callBackFnc;
    var singleSql, insertSql, updateSql, deleteSql, saveFlagColumn, keySqlName, keyIncrement, callbackSql;
    inData		= "ds_IUD=ds_List:U ds_Cond=ds_Cond";
    outData		= "ds_List=ds_List";
    callBackFnc	= "fn_CallBack_Save";
	// 파라미터셋팅
    insertSql	= "fm/fmp:FMP00160E_I001";
    updateSql	= "fm/fmp:FMP00160E_U001";
    deleteSql	= "fm/fmp:FMP00160E_D001";
//    keySqlName	= "fm/fmz:FMZ_PR_NUM_S002";
//    keyIncrement= 0;
    callbackSql	= "fm/fmp:FMP00160E_S002";
	// 서버에서 작업할 정보 추가
	tit_addSearchActionInfo(this, "fm/fmz:FMZ_PR_NUM_S002", true);
	tit_addSaveActionInfo(this, insertSql, updateSql, deleteSql, saveFlagColumn, keySqlName, keyIncrement, callbackSql);
	// 서버 호출
	tit_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
*/
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMP00160E_T001";
	strURL   = "U_svc::" + "fm/fmp/FMP00160E_T001.jsp";
	// 데이터셋 설정U
	strInDatasets  = "ds_IUD=ds_List:U";
	strInDatasets += " ds_msg=ds_msg:U";
	strOutDatasets = "ds_save_out=ds_save_out";
	strOutDatasets += " ds_msg_out=ds_msg_out";
	
	// 파라메터 설정
	strArgument  = "sSubinv=" + wrapQuote(cbo_Subinv.value);
	strArgument += " sNeedDate=" + wrapQuote(me_NeedDate.value);
	strArgument += " g_Upjang=" + wrapQuote(g_Upjang);
	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
	strArgument += " sDocSrc=" + wrapQuote(fa_DocSrc);
	strArgument += " sPrUpjang=" + wrapQuote(ed_Upjang.userdata);
	strArgument += " sPrSabun=" + wrapQuote(g_EmpNo);
	// 신규일경우 기존대로 새로운 주문번호 생성:NEW , 동일업장, 창고 및 입고일자에 주문건수가 있을경우 상품추가시  주문번호를 새로 생성하지 않는다:OLD
	strArgument += " sGubunNewOrOld=" + wrapQuote(fn_gubunNewOrOld);
	strArgument += " sMaxPrNum=" + wrapQuote(fn_maxPrNum);
	strArgument += " sMaxApproveNum=" + wrapQuote(fn_maxApproveNum);
// [속도개선 Project 시작] 2017. 8. 4. 최범주 여신금액 집계 프로시저 추가
	strArgument += " scrnId=" + wrapQuote("FMP00080E");   // 화면ID
	strArgument += " scrnName=" + wrapQuote("상품발주");  // 화면명
// [속도개선 Project   끝] 2017. 8. 4. 최범주
	//trace(ds_msg.saveXML());	
	// 콜백함수 지정
	strCallbackFunc = "fn_CallBack_Save";
	//바이너리 통신 설정
	//http.Compress = true;
	//http.CompressMethod = "ZLIB";
	////http.XmlFormat = false;
	//바이너리 통신 설정	
	// 서버 호출 
	//Transaction(strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc);
	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
}
/*------------------------------------------------------------
	1. Function ID : fn_Print()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_print()
{
	//gd_listE.ExportExcelEx("단가표");
}
/*------------------------------------------------------------
	1. Function ID : fn_Close()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_Close()
{
	This.close();
}
/*------------------------------------------------------------
	1. Function ID : fn_Help()
	2. 개       요 : 업무프로세스에 따른 입력작업
	3. 기       능 : 입력버튼 입력 시 처리되는 작업
	4. 인 수 설 명 : 
*/
function fn_help()
{
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*------------------------------------------------------------
	1. Function ID : fn_AlertMsg(cd)
	2. 개       요 : 메세지 처리
	3. 기       능 : 화면에 나타나는 메시지 코드및 텍스트 리턴
	4. 인 수 설 명 : cd : 원하는 메시지 코드
*/
function fn_AlertMsg(cd)
{
	var v_Msg="";
	switch(cd)
	{
		case "000":
			v_Msg= "이(가) 저장되었습니다.";
			break;
		case "001":
			v_Msg= "버튼이 정의 되어 있지않습니다.";
			break;
		case "002":
			v_Msg="서비스 오류:시스템 관리자에게 문의하십시오";
			break;
		case "003":
			v_Msg="필수항목은 반드시 선택하시기 바랍니다.";
			break;	
		case "004":
			v_Msg="작업대상 본사를 선택하세요.";
			break;
		case "005":
			v_Msg="을(를) 입력하세요";
			break;
		case "006":
			v_Msg="삭제할 데이터가 없습니다.";
			break;
		case "007":
			v_Msg="변경된 데이터가 없습니다.";
			break;
		case "008":
			v_Msg="시스템ID가 없습니다.";
			break;			
/*			
		case "":
			v_Msg="";
			break;
*/			
		default:
			break;			
	}
	return v_Msg;
}
//콜백
function fn_CallBack_Search(errCode, errMsg)
{
	if (errCode == 0)
	{
		if (ds_List.rowcount < 1)
		{
			g_Message("EE","주문등록한 상품이 없습니다.");
		} else {
			fn_CLS_STATUS_Setting();
		}
		
		//최초등록시 주문번호 채번, 이후에는 같은 주문번호로 발주
		ds_List.filter("OTCUSTCD=='0000'");
		fn_dsListCnt = 0;
		fn_dsListCnt = ds_List.rowcount;
		ds_List.filter("");
		
		
		fn_getOrderCtrlList();
		
		eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.setFocus();
			
	}
	else
		g_Message("EE",fn_AlertMsg("002"));
}
//function fn_CallBack_SearchItem(SvcID, errCode, errMsg)
function fn_CallBack_SearchItem(errCode, errMsg)
{
ta_Sql.value = fa_Sql;
	if (errCode == 0)
	{
		if (eval("ds_List" + gfn_toString(tab_list.tabindex+1)).rowcount < 1)
		{
			g_Message("EE","검색된 상품이 없습니다.");
			eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.setFocus();
		}
		else
		{
			eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).gd_list.setFocus();
			/*
			if (tab_list.tabindex < 3)
				Sort(eval("ds_List" + gfn_toString(tab_list.tabindex+1)),"ITEM_CODE");
			else
				Sort(eval("ds_List" + gfn_toString(tab_list.tabindex+1)),"PR_ID");
			*/	
			eval("ds_List" + gfn_toString(tab_list.tabindex+1)).rowposition = 0;
		}
	}
	else
		g_Message("EE","주문상품 조회하는 중에 오류가 발생하였습니다! \n 관리자에게 문의하세요.");
}
//function fn_CallBack_Delete(SvcID, errCode, errMsg)
function fn_CallBack_Delete(errCode, errMsg)
{
//ta_Sql.value = fa_Sql;
	if (errCode == 0)
	{
		if ( ds_msg_out.rowcount != 0 )  {
			var strMsg ="";
			for ( var q=0; q<ds_msg_out.rowcount; q++ ) {
				if ( ds_msg_out.getColumn(q, "TYPE") == "I" ) {
					strMsg += ds_msg_out.getColumn(q, "MSG")+"\r\n";
				}
			}
			
			if ( !gfn_isNull(strMsg) ) { 
				g_Message("", strMsg);
				fn_search();
			}
			
			var rowPos = ds_msg_out.findRow("TYPE", "N");
			if ( rowPos != -1 ) {
				g_Message("", ds_msg_out.getColumn(rowPos, "MSG"));
				
				//trace("MENU_ID=="+this.parent._fv_menuId);
				application.afrm_Bottom.form.fn_reOpenMenu(this.parent._fv_menuId);
				this.getOwnerFrame().form.close();
				return;
			}
			
			ds_msg_out.clearData();
		}
		
		
		//PR_ID를 (-)으로 설정하여 저장 시 다시 삭제하는 일이 없도록 한다.
		ds_List.setColumn(ds_List.rowposition,"PR_ID","-1");
		ds_List.deleteRow(ds_List.rowposition);
		//삭제자료만 존재한다면 데이타셑의 row type을 초기화 하여 삭제상태를 초기화 한다.
		//if (ds_List.getCaseCount("rowtype='insert'||rowtype='update'") <= 0) ds_List.applyChange();
		
		if ( (! gfn_dsIsUpdated(ds_List)) ) {
			ds_List.applyChange();
		}
		
		//최초등록시 주문번호 채번, 이후에는 같은 주문번호로 발주
		ds_List.filter("OTCUSTCD=='0000'");
		if (ds_List.rowcount == 0)
		{
			fn_dsListCnt = 0;
		}
		else
		{
			fn_dsListCnt = ds_List.rowcount;
		}
		ds_List.filter("");
		
// [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
		if ( !fn_GetCredit() ) return; // 여신정보 조회
// [속도개선 Project   끝] 2017. 8. 21. 최범주
	}
	else
		g_Message("EE",fn_AlertMsg("002"));
}
//function fn_CallBack_Save(SvcID, errCode, errMsg)
function fn_CallBack_Save(errCode, errMsg)
{
	if (errCode == 0)
	{
// [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
		if ( !fn_GetCredit() ) return; // 여신정보 조회
// [속도개선 Project   끝] 2017. 8. 21. 최범주
		fn_search();
		g_Message("02","주문자료" + fn_AlertMsg("000"));
		
		//trace(ds_msg_out.saveXML());
		if ( ds_msg_out.rowcount != 0 )  {
			var strMsg ="";
			for ( var q=0; q<ds_msg_out.rowcount; q++ ) {
				if ( ds_msg_out.getColumn(q, "TYPE") == "I" ) {
					strMsg += ds_msg_out.getColumn(q, "MSG")+"\r\n";
				}
			}
			
			if ( !gfn_isNull(strMsg) ) {
				g_Message("", strMsg);
			}
			
			var rowPos = ds_msg_out.findRow("TYPE", "N");
			if ( rowPos != -1 ) {
				g_Message("", ds_msg_out.getColumn(rowPos, "MSG"));
				
				//trace("MENU_ID=="+this.parent._fv_menuId);
				application.afrm_Bottom.form.fn_reOpenMenu(this.parent._fv_menuId);
				this.getOwnerFrame().form.close();
				return;
			}
			
			ds_msg_out.clearData();
		}
		
		fn_search();	// 재조회
		
	} else {
		
		if(ds_save_out.rowcount >0){
			// 자재유효성체크에서 걸린 리스트
			var sRet = gfn_dialog("", "U_FMP::FMP00030P.xfdl", "", "", "", "", "", "", "", "", "", false);
			return;
		}
		
		g_Message("EE",fn_AlertMsg("002"));
	}
		
}
function fn_ChkManNull()
{
	if (ffn_ChkNull(ed_Upjang.userdata))
	{
		g_Message("EE", "사업장" + fn_AlertMsg("005"));
		if (ed_Upjang.enable) ed_Upjang.setFocus();
		return true;
	}
	if (ffn_ChkNull(cbo_Subinv.value))
	{
		g_Message("EE", "식당을 선택하세요.");
		if (cbo_Subinv.enable) cbo_Subinv.setFocus();
		return true;
	}
	if ( ffn_ChkNull(me_NeedDate.value) || (gfn_length(me_NeedDate.value)< 8) )
	{
		g_Message("EE", "입고예정일을 정확하게 입력하세요.");
		me_NeedDate.setFocus();
		return true;
	}

	//
	return false;
}
function fn_ChkData()
{
	//변경여부 확인
	if ( (! gfn_dsIsUpdated(ds_List)) )
	{
		return fn_AlertMsg("007");
	}
// [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
	if ( !fn_GetCredit() ) return; // 여신정보 조회
// [속도개선 Project   끝] 2017. 8. 21. 최범주
	//여신한도초과여부
	//if (ed_Credit.Text != "무 제 한")
	if (ds_CrdInfo.rowcount > 0)
	{
		//여신금액
		if (ds_CrdInfo.getColumn(0,"CREDIT_AMOUNT_CONTROL_YN") == "Y")
		{
			var nAmt = 0;
			
			for (i=0; i<ds_List.rowcount; i++) {
				nAmt += Math.round((toNumber(ds_List.getColumn(i,"OP_AMOUNT")) - toNumber(ds_List.getColumn(i,"OP_AMOUNT_OLD"))) * iif(ds_List.getColumn(i,"TAX_CODE")=="100",1.1,1));
			}
				
			if ( nAmt > toNumber(ds_CrdInfo.getColumn(0,"CREDIT_AVAIL_AMT")) && ds_List.getSum("OP_AMOUNT") != ds_List.getSum("OP_AMOUNT_OLD") )
			{
				return "주문가능한 여신한도를 초과하여 주문이 불가합니다.";
			}
		}
		//여신회전일
		if (ds_CrdInfo.getColumn(0,"CREDIT_TURN_CONTROL_YN") == "Y")
		{
			if (toNumber(ds_CrdInfo.getColumn(0,"LAST_TURN_CNT")) >= 0)
			{
				if (toNumber(ds_CrdInfo.getColumn(0,"LAST_TURN_CNT")) > toNumber(ds_CrdInfo.getColumn(0,"CREDIT_TURN_DAYS_TOT")))
				{
					return ds_CrdInfo.getColumn(0,"L_BILL_DATE_DISP") + "에 매출채권이 존재하여 주문이 불가합니다.";
				}
			}
		}
	}
	//상품별 디데이 체크
	for (i=0; i<ds_List.rowcount; i++)
	{
		if (GetRowType(ds_List,i)<> 'normal')
		{
			//수량 0인건 어차피 지울꺼니 패스...
			//if ( NumFormat(ds_List.GetColumn(i,"PR_QTY"),1) == "0.0" ) continue;
			if (( GetRowType(ds_List,i)== 'insert' ) && ( gfn_numFormat(gfn_trim(ds_List.getColumn(i,"PR_QTY")),1)== "0" )) continue;
			//기존자료이거나 무통제면 패스...
			if ( numFormat(ds_List.getColumn(i,"D_DAYS"))== "0" ) continue;
			//디데이체크
/*			
			if ( addDate(gds_currdate.GetColumn(0,"YMD"),ds_List.GetColumn(i,"D_DAYS")) > me_NeedDate.Value )
			{
				ds_List.row = i;
				return ("[" + ds_List.GetColumn(i,"ITEM_NAME") + "]상품은 주문일자(D-" + ds_List.GetColumn(i,"D_DAYS") + ")를 초과하여 주문이 불가합니다.");
			}
			else if ( addDate(gds_currdate.GetColumn(0,"YMD"),ds_List.GetColumn(i,"D_DAYS")) = me_NeedDate.Value )
			{
				//디타임체크
				if ( substr(gds_currdate.GetColumn(0, "YMD_TM"),8,4) > ds_List.GetColumn(i,"D_TIMES") )
				{
					ds_List.row = i;
					return ("[" + ds_List.GetColumn(i,"ITEM_NAME") + "]상품은 주문시간(" + right("0"+ds_List.GetColumn(i,"D_TIMES"),4) + ")을 초과하여 주문이 불가합니다.");
				}
			}
*/
			if (fn_GetDayStatus(ds_List.getColumn(i,"D_DAYS"), ds_List.getColumn(i,"D_TIMES")) == "0")
			{
				ds_List.rowposition = i;
				return ("[" + ds_List.getColumn(i,"ITEM_NAME") + "]상품은 마감시간(D-Days)을 초과하여 주문이 불가합니다.");
			}
		}
        //-----------------------------------------------------------------------------------
		//--- 체크로직 추가 
		//    수정일    : 2010/10/28 BY 노규완
		//    수정내용  : 상품 수량 입력 시 기존에는 라인별로 최대발주량 체크 하였으나,
		//                추가 상품으로 동일 상품을 등록 한 다음 최대 발주량만 넘지 않으면 
		//                추가로 상품이 저장 되는 문제가 발생하여, 입고 예정일 기준으로 
		//                동일 상품의 총 합계를 체크 하여 최대 발주량을 넘는지 체크 한다.
		//    수정일    : 2013/08/01 BY 박용대
		//    수정내용  : 상품을 저장할때 아이리스에서 취소한 목록들이 발주내역에 올라오게되는데
		//                이것들이 최대 발주량계산에 포함되어 있어 발주상태가 003,005인 항목을
		//                제외하고 CASESUM 하는 부분을 추가.
		//-----------------------------------------------------------------------------------
		if ((ds_List.getColumn(i,"MAX_ORD_QTY") > 0) && ( ds_List.getCaseSum("ITEM_CODE=='"+ds_List.getColumn(i,"ITEM_CODE")+"'&& ((LINE_STATUS <> '005' && LINE_STATUS <> '002') && LINE_STATUS <> '003') && DOCU_SOURCE <> '01 BO'","PR_QTY") > ds_List.getColumn(i,"MAX_ORD_QTY")))  
		{   
		    if (toNumber(ds_List.getColumn(i,"PR_NUM")) <> 0)
		    {
		        //동일상품의 다른 주문날짜일 경우 합산은 최대발주량을 넘어도 상관없다.
		        if ( ds_List.getCaseSum("PR_NUM=='"+ds_List.getColumn(i,"PR_NUM")+"'","PR_QTY") <= ds_List.getColumn(i,"MAX_ORD_QTY"))
		            continue;
		    }
       	    ds_List.rowposition = i;
		    return ("[" + ds_List.getColumn(i,"ITEM_NAME") + "] 상품이 최대 발주량" + ds_List.getColumn(i,"MAX_ORD_QTY") + ")를 초과하여 주문이 불가합니다.");
		}		
	}
	//수량 0인거 제거...
// 	for (i=ds_List.rowcount-1; i>=0; i--)
// 	{
// 		if ( gfn_numFormat(gfn_trim(ds_List.getColumn(i,"PR_QTY")),1)== "0" ) ds_List.deleteRow(i);
// 	}

	// 발주 저장직전 발주리스트내용 재확인(ds_List <=> ds_ListCheck)
	/*
	fv_chkMsg = "";
	ds_msg.clearData();
	var checkDs = fn_search(true);
	for ( var k=0; k<ds_List.rowcount; k++ ) {
		var nRowType = ds_List.getRowType(k);
		var strExpr = "PR_ID == '" + ds_List.getColumn(k, "PR_ID")+ "'";
			strExpr += " && PR_NUM == '" + ds_List.getColumn(k, "PR_NUM") + "'";
			strExpr += " && ITEM_CODE == '" + ds_List.getColumn(k, "ITEM_CODE") + "'";
		var nRow1 = ds_List.findRowExpr(strExpr);
		var nRow2 = checkDs.findRowExpr(strExpr);
		
		var sLine1 = ds_List.getColumn(nRow1, "LINE_STATUS");
		var sLine2 = checkDs.getColumn(nRow2, "LINE_STATUS");
		//trace(strExpr);
		trace(nRow1+"||"+nRow2+"||"+sLine1+"||"+sLine2);
		//if ( nRowType == Dataset.ROWTYPE_UPDATE ) {
			if ( nRow1 != -1 && nRow2 != -1 ) {
				if ( sLine1 != sLine2 ) {
					ds_List.updatecontrol = false;
					ds_List.setRowType(nRow1, Dataset.ROWTYPE_NORMAL);	// for skip save
					//return ("["+ds_List.getColumn(nRow1, "ITEM_NAME")+"] 상품의 발주상태가 " + checkDs.getColumn(nRow2, "PO_LINE_STATUS") +"로 변경되어 해당 내용을 수정할 수 없습니다.");
					fv_chkMsg = "["+ds_List.getColumn(nRow1, "ITEM_CODE")+":"+ds_List.getColumn(nRow1, "ITEM_NAME")+"] 상품의 발주상태가 " + checkDs.getColumn(nRow2, "PO_LINE_STATUS") +"로 변경되어 해당 내용을 수정할 수 없습니다.";
					var nRow = ds_msg.addRow();
					ds_msg.setColumn(nRow, "NO", nRow);
					ds_msg.setColumn(nRow, "MSG", fv_chkMsg);
					ds_List.updatecontrol = true;
				}
			}
		//}
	}
	
	if ( !gfn_dsIsUpdated(ds_List) ) {
		return "주문한 자재의 발주상태가 변경되어 수정할 수 없습니다.\r\n발주내역을 다시 조회하여 상태를 확인하시기바랍니다.";
	}
	*/
	
	var rtnCheckMsg = fn_checkLineStatus();
	if ( !gfn_isNull(rtnCheckMsg) ) {
		return rtnCheckMsg;
	}
	
	// 저장 시 수량이 0 이거나 NULL 인 자재 삭제 처리
	for( var i = ds_List.getRowCount()-1; i >= 0; i-- ) {		
		if( ds_List.getColumn(i, "PR_QTY") == 0 || gfn_length(gfn_trim(ds_List.getColumn(i, "PR_QTY"))) == 0 ) {
			ds_List.deleteRow(i);
		}		
	}
}
function fn_FormKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
	//입고예정일에서 엔터시 조회
	//if ( (nChar == 13) && (objSenderObj == me_NeedDate) ) fn_Search();
	//임시로...'F12'입력시 타이머 작동중지
	if (e.keycode == 123) killTimer(777);
}	
function fn_edBtn_OnClick(obj:Button, e:ClickEventInfo)
{
	if(gfn_dsIsUpdated(ds_List)==true)
	{
		if(g_Confirm("02","변경된 내역이 있습니다. 변경된 내역을 저장하시겠습니까?"))
		{
			fn_save(1);
		}
	}
	
	var sAddWhere = "";
	var sOnBoard  = "";
	
	switch(obj.name)
	{
		case "btn_Upjang":
			sAddWhere = " AND A.USE_YN = 'Y'";
			//본사인 경우 해당 사업장 조회
			if (application.g_UserKind == '본사')
				sAddWhere += " AND A.MAIN_UPJANG = " + application.g_Main_Upjang;
			//사업장인 경우 관리업장만 조회
			else if (application.g_UserKind == '사업장')
				sAddWhere += " AND ( A.UPJANG = " + application.g_Upjang + " OR EXISTS (SELECT 1 FROM FMS_USER_UPJANG B WHERE B.USE_YN = 'Y' AND B.UPJANG = A.UPJANG AND B.SABUN = '" + application.g_EmpNo + "') )";
			break;
		
		case "btn_UpjangP":
			sAddWhere = " AND A.USE_YN = 'Y'";
			//본사인 경우 해당 사업장 조회
			if (application.g_UserKind == '본사')
				sAddWhere += " AND A.MAIN_UPJANG = " + application.g_Main_Upjang;
			//사업장인 경우 관리업장만 조회
			else if (application.g_UserKind == '사업장')
				sAddWhere += " AND ( A.UPJANG = " + application.g_Upjang + " OR EXISTS (SELECT 1 FROM FMS_USER_UPJANG B WHERE B.USE_YN = 'Y' AND B.UPJANG = A.UPJANG AND B.SABUN = '" + application.g_EmpNo + "') )";
			sOnBoard  = "tab_list.tab4.";
			break;
		
		case "btn_UpjangT":
			sAddWhere = " AND A.USE_YN = 'Y'";
			//본사인 경우 해당 사업장 조회
			if (application.g_UserKind == '본사')
				sAddWhere += " AND A.MAIN_UPJANG = " + application.g_Main_Upjang;
			//사업장인 경우 관리업장만 조회
			else if (application.g_UserKind == '사업장')
				sAddWhere += " AND ( A.UPJANG = " + application.g_Upjang + " OR EXISTS (SELECT 1 FROM FMS_USER_UPJANG B WHERE B.USE_YN = 'Y' AND B.UPJANG = A.UPJANG AND B.SABUN = '" + application.g_EmpNo + "') )";
			sOnBoard  = "tab_list.tab5.";
			break;
			
		default:
			break;
	}
	//fm공통 팝업클릭 호출
	if (ffn_btn_OnClick(obj, sAddWhere, sOnBoard)) fn_Trigger_edBtn(eval(sOnBoard + "ed_" + gfn_subStr(obj.name, 4)));
}
function fn_edBtn_OnKeyDown(obj:Edit, e:KeyEventInfo)
{
	if(gfn_dsIsUpdated(ds_List)==true)
	{
		g_Message("EE","변경된 내역이 있습니다. 저장해 주십시요");
		return;
		/*
		if(g_Confirm("02","변경된 내역이 있습니다. 변경된 내역을 저장하시겠습니까?"))
		{
			fn_Save(1);
		}
		*/
	}
	
	var sOnBoard = "";
	if (obj == tab_list.tab4.ed_UpjangP)
	{
		sOnBoard = "tab_list.tab4.";
	} 
	
	ffn_ed_OnKeyDown(obj,e.keycode,sOnBoard);
	//Del의 경우 뒷처리
	//if (nChar == 46) fn_Trigger_edBtn(obj);
	if (e.keycode == 46) fn_Trigger_edBtn(eval(sOnBoard + "ed_" + gfn_subStr(obj.name, 3)));
}
function fn_Trigger_edBtn(obj)
{
	switch(obj)
	{
		case ed_Upjang:
			//초기화
			fn_ResetData();
			if (! ffn_ChkNull(obj.userdata))
			{
				//창고세팅
				fn_SetSubinv(ds_Subinv);
				//디데이
				fn_GetDays();
				//
				//fn_SetTimer();
// [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
				if ( !fn_GetCredit() ) return; // 여신정보 조회
// [속도개선 Project   끝] 2017. 8. 21. 최범주
				//최종 발주정보
				//fn_GetLastOrd();
				//즐겨찾기그룹
				fn_SetFav();
				//센터단가업장정보
				fn_SetCtUpj();
				//메모리
				/////fn_searchItemUpMemory();
				
				fn_getBudgetInfo();
				//자동조회
				fn_search();
			}
			break;
			
		case tab_list.tab4.ed_UpjangP:
			
			if (! ffn_ChkNull(obj.userdata))
			{
				//초기화
				ds_List4.clearData();
				//창고세팅
				fn_SetSubinv(ds_SubinvP);
			}	
			break;
			
		default:
			break;
	}
}
function fn_ResetData()
{
	ds_Subinv.clearData();
	//ds_SubinvP.ClearData();
	st_Days.text = "(발주 마감 : - -)";
	st_Timer.text = "";
	ed_Credit.value = "";
	me_Pdate.value = "";
	ed_Pcnt.value = "";
	ed_Pamt.value = "";
	ed_Bond.value = "";
	cbo_Subinv.value = "";
	ds_List.clearData();
	ds_List1.clearData();
	ds_List2.clearData();
	ds_List3.clearData();
	ds_List4.clearData();
	//
	me_NeedDate.value  = gfn_addDate(gds_currdate.getColumn(0, "YMD"),1);
}
function fn_SetSubinv(ds_Obj)
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 초기화
	ds_Obj.clearData();
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= ds_Obj.name + "=ds_List";
    if (ds_Obj == ds_Subinv)
    {
		otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);
    } else if (ds_Obj == ds_SubinvP) {
		otherArg	= "UPJANG=" + wrapQuote(tab_list.tab4.ed_UpjangP.userdata);
    } 
		
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_PO_SUBINV_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	//기본창고지정
    if (ds_Obj == ds_Subinv)
    {
		if (ds_Obj.rowcount > 0) cbo_Subinv.index = 0;
	}
	else if (ds_Obj == ds_SubinvP)
	{
		if (ds_Obj.rowcount > 0) tab_list.tab4.cbo_SubinvP.index = 0;
	}
	
	fn_getBudgetInfo();
}
function fn_GetDays()
{
	// 초기화(디데이)
	ds_Days.clearData();
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_Days=ds_List";
    otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata) + " SUBINV_CODE=" + wrapQuote(cbo_Subinv.value) + " NEED_DATE=" + wrapQuote(me_NeedDate.value);
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_GETDAYS_S001");
	// 서버 호출 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	http.Sync = false;
	//디데이 표시
	if (ds_Days.rowcount > 0)
		st_Days.text = "(발주 마감 : " + ds_Days.getColumn(0,"DAYS") + ")";
	else
	{
		g_Message("EE","발주마감정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
		//close();
	}
	// 초기화(주문통제)
	ds_OrdCtrl.clearData();
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_OrdCtrl=ds_List";
    otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_ORD_CTRL_S001");
	// 서버 호출 
	http.Sync = true;
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	http.Sync = false;
}
// [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
/*----------------------------------------------------------------------------------------------
 * 설명      : 여신정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_GetCredit() {
	var rtnValue = false;
	
	////////////////////////////////////////////////////////////////////////////////////////////////////////
	// 초기화
	////////////////////////////////////////////////////////////////////////////////////////////////////////
	ds_Cond.clearData();
	ds_CrdInfo.clearData();

	////////////////////////////////////////////////////////////////////////////////////////////////////////
	// 여신정보 조회 조건 셋팅
	////////////////////////////////////////////////////////////////////////////////////////////////////////
	var iRow = ds_Cond.addRow();
	ds_Cond.setColumn(iRow, "UPJANG", ed_Upjang.userdata);    // 업장코드
	ds_Cond.setColumn(iRow, "NEED_DATE", me_NeedDate.value);  // 입고예정일
	
	////////////////////////////////////////////////////////////////////////////////////////////////////////
	// 서버단 호출
	////////////////////////////////////////////////////////////////////////////////////////////////////////
	var svcID, svcUrl, inData, outData, otherArg, callBackFnc, isErrorNotCall, isNotShow, isSync;
	svcID          = "FMZ_CREDIT_INFO_T003";                         // 서비스 ID
	svcUrl         = "U_svc::" + "fm/fmz/FMZ_CREDIT_INFO_T003.jsp";  // 서비스 URL
	inData         = "ds_Cond=ds_Cond";                              // 서버로 전송할 DataSet 객체 Str
	outData        = "ds_CrdInfo=ds_CrdInfo";                        // 서버로부터 전송 받을  DataSet 객체 String
	otherArg       = "";                                             // 서버로 전송할 기타 Argument 정보 String
	callBackFnc    = "";                                             // 서버에서 처리가 완료된 후 Callback 받을 Function 명
	isErrorNotCall = false;                                          // 에러 발생 시 Callback 함수 호출 여부
	isNotShow      = false;                                          // 처리중입니다. 메시지 창 보여줄지 여부 설정하기
	isSync         = true;                                           // 동기식으로 설정할지 여부
	jsp_transaction(this, svcID, svcUrl, inData, outData, otherArg, callBackFnc, isErrorNotCall, isNotShow, isSync);

	////////////////////////////////////////////////////////////////////////////////////////////////////////
	// 여신정보 셋팅
	////////////////////////////////////////////////////////////////////////////////////////////////////////
	ta_Sql.value = fa_Sql;
	
	if ( ds_CrdInfo.getRowCount() == 0 ) {
		g_Message("EE", "업장여신정보를 확인할 수 없습니다.\n\n관리자에게 문의하십시오.");
		
	} else {
		rtnValue = true;
		
		// 여신금액통제일 경우
		if ( ds_CrdInfo.getColumn(0,"CREDIT_AMOUNT_CONTROL_YN") == "Y" ) {
			ed_Credit.value      = gfn_numFormat(ds_CrdInfo.getColumn(0,"CREDIT_RMN_AMT")) + " 원";    // 가용여신
			ed_Bond.value        = gfn_numFormat(ds_CrdInfo.getColumn(0,"BOND_AMT")) + " 원";          // 채권잔액
		} else {
			ed_Credit.value      = "해당없음";
			ed_Bond.value        = "";
		}
	}
	
	return rtnValue;
}
// [속도개선 Project   끝] 2017. 8. 21. 최범주

// [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
// function fn_GetCredit_callback(errCode, errMsg)
// {
// ta_Sql.value = fa_Sql;
// 		if (errCode == 0)
// 	{
// 		//여신 표시
// 		if (ds_CrdInfo.rowcount > 0) 
// 		{
// 			if (ds_CrdInfo.getColumn(0,"CREDIT_AMOUNT_CONTROL_YN") == "Y")
// 			{
// 				ed_Credit.value = gfn_numFormat(ds_CrdInfo.getColumn(0,"CREDIT_RMN_AMT"))+ " 원";
// 				ed_Bond.value = gfn_numFormat(ds_CrdInfo.getColumn(0,"BOND_AMT"))+ " 원";
// 			}
// 			else
// 				//ed_Credit.value = "무 제 한";
// 				ed_Credit.value = "해당없음";
// 		}
// 		else
// 		{
// 			//g_Message("EE","업장여신정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
// 			//close();
// 		}
// 	}
// 	else
// 		g_Message("EE",fn_AlertMsg("002"));	
// }
// [속도개선 Project   끝] 2017. 8. 21. 최범주

function fn_GetCrdYn()
{
	// fn_checkExceptCredit = true [ 예외(ex.예림푸드) ]
	if ( fn_checkExceptCredit() ) {
		return false;
	}
	
	//ds임시생성
	var dsObjin, dsObjot;
	
	create("Dataset", "ds_Dummyin");
	create("Dataset", "ds_Dummyot");
	
	dsObjin = eval("ds_Dummyin");
	dsObjin.addColumn("UPJANG", "INT", 22);
	dsObjin.addColumn("NEED_DATE", "STRING", 8);
	dsObjot = eval("ds_Dummyot");
	dsObjot.addColumn("CRD_YN", "STRING", 1);
	
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 초기화
	ds_Dummyin.clearData();
	ds_Dummyot.clearData();
	ds_Dummyin.addRow();
	ds_Dummyin.setColumn(0, "UPJANG",         ed_Upjang.userdata);
	ds_Dummyin.setColumn(0, "NEED_DATE",      me_NeedDate.value);
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    inData		= "ds_Cond=ds_Dummyin";
    outData		= "ds_Dummyot=ds_List";
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_CREDIT_CHKYN_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	var bYn = (ds_Dummyot.rowcount > 0);
	//ds임시생성 해제
	Destroy("ds_Dummyin");
	Destroy("ds_Dummyot");
	return  bYn;
}
function fn_GetLastOrd()
{
	//ds임시생성
	var dsObjin, dsObjot;
		
	create("Dataset", "ds_Dummyin");
	create("Dataset", "ds_Dummyot");
	
	dsObjin = eval("ds_Dummyin");
	dsObjin.addColumn("SUBINV_CODE", "STRING", 8);
	dsObjin.addColumn("NEED_DATE", "STRING", 8);
	dsObjin.addColumn("DOCU_SOURCE", "STRING", 50);
	dsObjot = eval("ds_Dummyot");
	dsObjot.addColumn("NEED_DATE", "STRING", 8);
	dsObjot.addColumn("CNT", "DECIMAL", 22);
	dsObjot.addColumn("AMT", "DECIMAL", 22);
	
	// 초기화
	dsObjin.clearData();
	dsObjot.clearData();
	dsObjin.addRow();
	dsObjin.setColumn(0, "SUBINV_CODE",    cbo_Subinv.value);
	dsObjin.setColumn(0, "NEED_DATE",      me_NeedDate.value);
	dsObjin.setColumn(0, "DOCU_SOURCE",    fa_DocSrc);
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    inData		= "ds_Cond=ds_Dummyin";
    outData		= "ds_Dummyot=ds_List";
	otherArg    = "DocSrc1=" + wrapQuote(fa_DocSrc1);
	otherArg   += " DocSrc2=" + wrapQuote(fa_DocSrc2);
	callBackFnc = "fn_GetLastOrd_callback";
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmp:FMP00160E_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 

}

function fn_GetLastOrd_callback(errCode, errMsg)
{
	if (errCode == 0)
	{
		//최근 발주 표시
		if (ds_Dummyot.rowcount > 0)
		{
			//trace(ds_Dummyot.saveXML());
			me_Pdate.value = ds_Dummyot.getColumn(ds_Dummyot.rowcount-1,"NEED_DATE");
			ed_Pcnt.value = '총 (' + gfn_numFormat(ds_Dummyot.getColumn(ds_Dummyot.rowcount-1,"CNT"))+ ') 건';
			ed_Pamt.value = gfn_numFormat(ds_Dummyot.getColumn(ds_Dummyot.rowcount-1,"AMT"))+ ' 원';
		}
		else
		{
			me_Pdate.value = "";
			ed_Pcnt.value = "";
			ed_Pamt.value = "";
		}
		//ds임시생성 해제
		Destroy("ds_Dummyin");
		Destroy("ds_Dummyot");
	}
	else
		g_Message("EE",fn_AlertMsg("002"));
}

function fn_OrdChk()
{
	fn_GetDays();
	fn_CurrDateWeek();

	//입고통제일 체크 
	if (fn_NeedDateCheck()) 
	{
	    g_Message("EE","해당일자는 입고통제일 입니다.");
   	    ds_List.clearData();
	    ds_List1.clearData();

		return false;
	}

	//발주통제일자
	if (toNumber(ds_Days.getColumn(0,"D_OVER_DAYS")) > 0)
	{
		if (me_NeedDate.value > gfn_addDate(gds_currdate.getColumn(0, "YMD"),toNumber(ds_Days.getColumn(0,"D_OVER_DAYS"))))
		{
			g_Message("EE", ds_Days.getColumn(0,"D_OVER_DAYS") + "일을 초과하여 입고예정일을 지정할 수 없습니다.");
			return false;
		}
	}
	//발주제한일자
	if (toNumber(ds_Days.getColumn(0,"D_DAYS")) > 0)
	{
		if (me_NeedDate.value < gfn_addDate(gds_currdate.getColumn(0, "YMD"),toNumber(ds_Days.getColumn(0,"D_DAYS"))))
		{
			g_Message("EE", "발주마감은 " + ds_Days.getColumn(0,"DAYS") + "입니다.");
			return false;
		}
		if (me_NeedDate.value == gfn_addDate(gds_currdate.getColumn(0, "YMD"),toNumber(ds_Days.getColumn(0,"D_DAYS"))))
		{
			if (gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,6)> ds_Days.getColumn(0,"D_TIMES"))
			{
				g_Message("EE", "발주마감은 " + ds_Days.getColumn(0,"DAYS") + "입니다.");
				return false;
			}
		}
	}
	//창고가 식재 또는 소모품 전용창고인 경우 주문통제 점검
	if (! ffn_ChkNull(ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN")))
	{
		//주문통제(주문일자)
		var nRow;
		nRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='주문'&&ITEM_TYPE==decode('" + ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN") + "','Y','소모품','식자재')");
		if (nRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(nRow,ToUpper(gds_currdate.getColumn(0, "WEEK_ENG"))) == "Y")
			{
				g_Message("EE", gds_currdate.getColumn(0, "WEEK_KOR") + "요일은 주문불가 요일입니다.");
				return false;
			}
		}
		//주문통제(입고일자)
		nRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE==decode('" + ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN") + "','Y','소모품','식자재')");
		if (nRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(nRow,ToUpper(ffn_DayToWeek(me_NeedDate.value,"1"))) == "Y")
			{
				g_Message("EE", ffn_DayToWeek(me_NeedDate.value) + "요일은 입고불가 요일입니다." + "\n\n" + "입고예정일을 변경하세요.");
				return false;
			}
		}
	}else{
		//주문통제(입고일자)
		nRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE=='공통'");
		if (nRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(nRow,ToUpper(ffn_DayToWeek(me_NeedDate.value,"1"))) == "Y")
			{
				g_Message("EE", ffn_DayToWeek(me_NeedDate.value) + "요일은 입고불가 요일입니다." + "\n\n" + "입고예정일을 변경하세요.");
				return false;
			}
		}	
	}
	//
	return true;
}
function fn_SetFav()
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_Fav=ds_List";
    otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_FAVORITE_GROUP_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	if (ds_Fav.rowcount > 0) tab_list.tab2.cbo_Fav.index = 0;
}
function fn_SetCtUpj()
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_CtUpj=ds_List";
    otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "fm/fmz:FMZ_GET_CTUPJ_S001");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/
	if (ds_CtUpj.rowcount <= 0)
	{
		g_Message("EE","업장기초정보를 확인할 수 없습니다.!" + "\n\n" + "관리자에게 문의하세요.");
		//close();
	}
}
function fn_CopyRow(obj,nRow)
{
	if ( ds_List.findRowExpr("ITEM_CODE=="+wrapQuote(obj.getColumn(nRow,"ITEM_CODE"))) >= 0 )
	{
		if (! g_Confirm("01", '이미 주문등록한 상품입니다.\n\n추가주문 하시겠습니까?!')) return;
	}
	ds_List.addRow();
	ds_List.copyRow(ds_List.rowposition, obj, nRow);
	//기본적으로 신청수량은 기본 0으로 설정한다.
	ds_List.setColumn(ds_List.rowposition, "PR_QTY", 0);
	
	// for only 화성네트웍스-상지대학교부속한방병원[162851]
	if ( obj.getColumn(obj.rowposition, "RC_UPJANG") == "162851" ) {
		ds_List.setColumn(ds_List.rowposition, "PR_REMARK", obj.getColumn(obj.rowposition, "PR_REMARK_RECENT"));
	}
	//obj.DeleteRow(nRow);
}
function fn_SetRowImg(nDdays,nDtimes,sWeekItemCode,sUnuseYn,sValSptYn,sPoStatus,sDangaWeekStatus)
{
	//품목별 D-Day설정과 전체 D-Day설정을 비교하여 빠른것을 기준으로 한다.
	var nDdays1 = greatest(toNumber(nDdays), toNumber(ds_Days.getColumn(0,"D_DAYS")));
	var nDtimes1;
	if ( toNumber(nDdays) > toNumber(ds_Days.getColumn(0,"D_DAYS")) )
		nDtimes1 = nDtimes;
	else if ( toNumber(nDdays) == toNumber(ds_Days.getColumn(0,"D_DAYS")) )
		nDtimes1 = least(nDtimes,ds_Days.getColumn(0,"D_TIMES"));
	else if ( toNumber(nDdays) < toNumber(ds_Days.getColumn(0,"D_DAYS")) )
		nDtimes1 = ds_Days.getColumn(0,"D_TIMES");
	
	if (sUnuseYn=="UK" || sValSptYn=="TK" || sPoStatus =="HE" || sDangaWeekStatus =="FE") //구매불용, 구매중지, 수발주스케쥴, 단가업장 수발주 스케쥴
	{
		return "theme://convertImages\\img_RC.png";
	}else{
		return decode(fn_GetDayStatus(nDdays,nDtimes,sWeekItemCode),"0","theme://convertImages\\img_RC.png","1","theme://convertImages\\img_YC.png","2","theme://convertImages\\img_GC.png","");
	}
}

function fn_SetRowColor(nDdays,nDtimes,sWeekItemCode,sUnuseYn,sValSptYn,sPoStatus,sDangaWeekStatus)
{
	var bDayStatus;
	
	if(fn_GetDayStatus(nDdays,nDtimes,sWeekItemCode) == "0")
	{
		bDayStatus = true;
	}else{
		bDayStatus = false;
	}
	
	if(sUnuseYn=="UK" || sValSptYn=="TK" || bDayStatus || sPoStatus =="HE" || sDangaWeekStatus =="FE") //구매불용, 구매중지, 수발주스케쥴, 단가업장 수발주 스케쥴 
	{
		return "thistle";
	}else{
		return "white";
	}
}

function fn_GetDayStatus(nDdays,nDtimes,sWeekItemCode)
{
	//리조트 물류스케주울 체크
	if (! ffn_ChkNull(sWeekItemCode)) return "0";
	//무통제면 패스...
	if ( numFormat(nDdays)== "0" )	return "2";
	//디데이체크
	if ( gfn_addDate(gds_currdate.getColumn(0,"YMD"),nDdays)> me_NeedDate.value )
		return "0";
	else if ( gfn_addDate(gds_currdate.getColumn(0,"YMD"),nDdays)== me_NeedDate.value )
	{
		//디타임체크
		if ( gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4)> nDtimes )
			return "0";
		else if ( G_fn_GapTime(0, gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4), nDtimes, "") <= "0030" )
			return "1";
		else
			return "2";
	}
	else
		return "2";
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
function gd_list_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	var strHeadClass = obj.getCellProperty("head", e.col,"class");
    if(strHeadClass == "head_Excel")
    {
		// 출력용 그리드
		gfn_exportExcel(tab_list.tabpages["tab"+parseInt(tab_list.tabindex+1)].gd_list_excel);
		return;
    } else {
		gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
	}
}

// 발주내역 그리드
function gd_list_OnHeadClick1(obj:Grid, e:GridClickEventInfo)
{
	gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
}

function cbo_Subinv_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	//데이타셑 위치변경
	eval(obj.innerdataset).rowposition = e.postindex;
	//초기화
	if (obj == cbo_Subinv)
	{
		me_Pdate.value = "";
		ed_Pcnt.value = "";
		ed_Pamt.value = "";
		ds_List.clearData();
		ds_List1.clearData();
		ds_List2.clearData();
		ds_List3.clearData();
		ds_List4.clearData();
		//최종 발주정보
		//fn_GetLastOrd();
		//디데이
		fn_GetDays();
		
		fn_getBudgetInfo();
		
		//자동조회
		fn_search();
	} else if (obj == tab_list.tab2.cbo_Fav) {
		ds_List2.clearData();
	} else if (obj == tab_list.tab4.cbo_SubinvP) {
		ds_List4.clearData();
	} 
}

function cbo_Subinv_canitemchange(obj:Combo, e:ItemChangeEventInfo)
{
	if(gfn_dsIsUpdated(ds_List)==true)
	{
		if(g_Confirm("02","변경된 내역이 있습니다. 변경된 내역을 저장하시겠습니까?"))
		{	
			fn_save(1);
			return true;
		}   else {
			return false;
		}
	} else {
		return true;
	}
	
	
	
}

function me_NeedDate_OnChanged(obj:MaskEdit, e:TextChangedEventInfo)
{
	//변경되면 포커스를 잃고 글로벌 함수 실행(여기서 글자수를 체크하여 제대로 된 데이터 넘김)
	//g_Date_OnKillFocus(obj);
	
	//변경된 사항이 있는지 확인
	if(gfn_dsIsUpdated(ds_List)==true)
	{
		g_Message("EE","변경된 내역이 있습니다. 저장해 주십시요");
		me_NeedDate.value = pre_need_date;	//변경전의 날짜를 되돌림
		return;
	}else{
	
		//발주가능 체크
		if (! fn_OrdChk())
		{
			btn_NeedDate.setFocus();
			return;
		}
		
		// 상단그리드 초기화
		fn_setInitForm();
		
		fn_search();
	}
	
}



function ds_List_CanColumnChange(obj:Dataset, e:DSColChangeEventInfo)
{
	//수량체크
	if (e.columnid == "PR_QTY")
	{
		//(-)발주여부
		if ( toNumber(e.newvalue) < 0 )
		{
			g_Message("EE","(-)발주는 불가합니다.");
			return false;
		}
		//발주마감체크
		fn_CurrDateWeek();
		if (fn_GetDayStatus(obj.getColumn(e.row,"D_DAYS"), obj.getColumn(e.row,"D_TIMES")) == "0")
		{
			g_Message("EE","해당 상품은 마감시간(D-Days)이 초과되어 수정이 불가합니다.");
			return false;
		}
		//수량통제 안하는 업장의 경우 이하 패스...
		//if (ds_Days.GetColumn(0,"QTY_CONTROL_YN") = "N") return;
		//
		//수량통제 안하는 업장의 경우 소숫점발주가 Y이면 무조건 최소발주량/발주승수량을 무조건 0.1로 세팅하여 조회
		if ( toNumber(e.newvalue) > 0 )
		{
			//최소발주량 체크
			if ( (toNumber(obj.getColumn(e.row,"MIN_ORD_QTY")) > 0) && (toNumber(obj.getColumn(e.row,"MIN_ORD_QTY")) > toNumber(e.newvalue)) )
			{
				g_Message("EE","해당 상품은 최소발주량이 " + obj.getColumn(e.row,"MIN_ORD_QTY") + "입니다.");
				return false;
			}
			
			//최대발주량 체크
			/**
			if ( (toNumber(obj.getColumn(e.row,"MAX_ORD_QTY")) > 0) && (toNumber(obj.getColumn(e.row,"MAX_ORD_QTY")) < toNumber(e.newvalue)) )
			{
				g_Message("EE","해당 상품은 최대발주량이 " + obj.getColumn(e.row,"MAX_ORD_QTY") + "입니다.");
				return false;
			}
			**/
			// canColumnChange Event에서 obj.getCaseSum()의 올바른 연산을 위해 함수로 대체
			if ( fn_isOverQty(obj, e) ) {
				g_Message("EE","해당 상품은 최대발주량이 " + obj.getColumn(e.row,"MAX_ORD_QTY") + "입니다.");
				// 고객인 경우만 제한
				if( g_EmpNo.substr(0,2) == "CS" ) {
					return false;
				}
			}
			
			//소숫점발주여부
			if ( (obj.getColumn(e.row,"POINT_FLAG") != "Y") && (Math.ceil(toNumber(e.newvalue)) != toNumber(e.newvalue)) )
			{
				g_Message("EE","해당 상품은 소숫점발주가 불가합니다.");
				return false;
			}
			//발주승수량
			if ( (toNumber(obj.getColumn(e.row,"MULTIPLIER_QTY")) > 0) && ((Math.round(toNumber(e.newvalue) * 1000) % Math.round(toNumber(obj.getColumn(e.row,"MULTIPLIER_QTY")) * 1000)) <> 0) )
			{
				g_Message("EE","해당 상품은 발주승수량이 " + obj.getColumn(e.row,"MULTIPLIER_QTY") + "입니다.");
				return false;
			}
		}
		
		//alert(obj.getRowType(e.row) +" : "+ toNumber(e.newvalue));
		
		//3개월치 최대발주량 초과시 알람
		if ( toNumber(e.newvalue) >  toNumber(obj.getColumn(e.row,"MAX_SO_QTY")) )
		{
			g_Message("EE","해당 상품은 최근 3개월 최대발주량 " + obj.getColumn(e.row,"MAX_SO_QTY") + " 을 초과 하였습니다. ");
		}
		
	} 
	if ( e.columnid == "PR_REMARK" ) {
		if ( gfn_lengthByte(e.newvalue) > 100 ) {
			g_Message("EE","최대 입력 길이(100byte)를 초과 하였습니다.");
			return false;
		} 
	}
	
	return true;
}
function ds_List_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	//금액계산
	if (e.columnid == "PR_QTY")
	{
		var nAmt = Math.round(toNumber(obj.getColumn(e.row,"SALE_PRICE")) * toNumber(e.newvalue));
		obj.setColumn(e.row, "SALE_AMOUNT", nAmt);
		nAmt = Math.round(toNumber(obj.getColumn(e.row,"OP_PRICE")) * toNumber(e.newvalue));
		obj.setColumn(e.row, "OP_AMOUNT", nAmt);
		
		//var nTotWght = Math.round(toNumber(obj.getColumn(e.row, "KG_CONVERT_RATE")) * toNumber(obj.getColumn(e.row, "UOM_CONVERT_RATE")) * toNumber(e.newvalue));
		//var nTotWght = Math.round(toNumber(obj.getColumn(e.row, "KG_CONVERT_RATE")) * toNumber(e.newvalue));
		var nTotWght = Math.round(toNumber(obj.getColumn(e.row, "KG_CONVERT_RATE")) * toNumber(e.newvalue), 3);
		obj.setColumn(e.row, "TOT_WGHT", nTotWght);
	}
	
	
	var rtnAmt = fn_getOrderStatus("recheck");	
	if ( (obj.getCaseCount("PR_QTY > 0") > 0) && (rtnAmt.ctrlAmt > rtnAmt.poAmt) ) {
		st_ctrlAmt.text = " 발주가능금액 " + gfn_numFormat(rtnAmt.ctrlAmt - rtnAmt.poAmt) + "원 부족";
		st_ctrlAmt.visible = true;
	} else {
		st_ctrlAmt.text = "";
		st_ctrlAmt.visible = false;
	}
}
function FMP00080E_OnTimer(obj:Form, e:TimerEventInfo)
{
	if (e.timerid == 777) {
		fn_SetTimer();
	}
}
function fn_SetTimer()
{
	fn_CurrDateWeek();
	
	// FICS 발주제한요일, 시간 설정 	
	//fn_setWeekendTime();
		
	var sChkDate, sDay, sTime;
	if ( gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4)>= gfn_trim(ds_Days.getColumn(0,"D_TIMES")) )
	{
		sChkDate = gfn_addDate(me_NeedDate.value, (-1 * (toNumber(gfn_trim(ds_Days.getColumn(0,"D_DAYS"))) + 1)));	
		sTime = G_fn_GapTime("1", gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4), toNumber(gfn_trim(ds_Days.getColumn(0,"D_TIMES"))), "");	
	}
	else
	{
		sChkDate = gfn_addDate(me_NeedDate.value, (-1 * toNumber(gfn_trim(ds_Days.getColumn(0,"D_DAYS")))));
		sTime = G_fn_GapTime("0", gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4), gfn_trim(ds_Days.getColumn(0,"D_TIMES")), "");
	}
	
	if (parseInt(gds_currdate.getColumn(0, "YMD")) <= parseInt(sChkDate))
		sDay = G_fn_CalcDay(gds_currdate.getColumn(0, "YMD"), sChkDate);		
	else
		sDay = G_fn_CalcDay(sChkDate, gds_currdate.getColumn(0, "YMD")) * (-1);		
		
	if ((toNumber(sDay) >= 0) && (toNumber(sDay) < 10)) sDay = "0" + sDay;	
	st_Timer.text = "마감시간 : " + sDay + "일 " + gfn_left(sTime,2)+ "시간 " + gfn_right(sTime,2)+ "분 전";
	
	st_Week.text = "(" + ffn_DayToWeek(me_NeedDate.value) + ")";
	if (st_Week.text == "(토)")
		st_Week.style.color = "blue";
	else if (st_Week.text == "(일)")
		st_Week.style.color = "red";
	else
		st_Week.style.color = "black";
	//공휴일색변경	
	if(gfn_length(fn_isHoliday(me_NeedDate.value))>0)
	{
		st_Week.style.color = "red";
	}

		
	fa_sDay = sDay;	
	if (toNumber(sDay) < 0) fn_CLS_STATUS_Setting(); 	
	
}

function fn_CLS_STATUS_Setting()
{
    if (fa_sDay >= 0) return;
    
    ds_List.updatecontrol = false;
	for (i=0; i<ds_List.rowcount; i++)
	{
		if (ds_List.getColumn(i, "OTCUSTCD") != "0000")
		{
			ds_List.setColumn(i, "CLS_STATUS", "마감");
			ds_List.setRowType(i, Dataset.ROWTYPE_NORMAL);
		}
	}
	ds_List.updatecontrol = true;	
}
function ed_Item_OnKeyDown(obj, e)
{
	if ( e.keycode == 13 ) fn_SearchItem();
}
function btn_search_OnClick(obj:Button, e:ClickEventInfo)
{
	fn_SearchItem();
}
function btn_search_OnKeyDown(obj:Button, e:KeyEventInfo)
{
	if ( e.keycode == 13 ) btn_search_OnClick(obj);
}
function gd_list_OnCellDblClick(obj:Grid, e)
{
	/*
	  주문시점의 업장, 창고, 입고일자를 저장한다.
	  왜냐하면 주문을 하고 발주내역에 등록이 된 뒤에
	  날짜를 변경하면 발주된된 데이터에 대해서 
	  변경을 하겠습니까? 라고 확인메세지를 주는데
	  여기서 아니오라고 해도 업장과 창고 입고일자는 
	  바뀌어 버리기 때문에(공통함수라서) 
	  아니오 일때는 주문시점의 데이터를 다시 불러와야함
	*/
	pre_need_date = me_NeedDate.value;
	

	if (obj == gd_list) return;
	if (eval(obj.binddataset).rowcount < 1) return;
	if (e.row < 0) return;
	
	//리조트 물류스케주울 체크
	if (! ffn_ChkNull(eval(obj.binddataset).getColumn(e.row,"WEEK_ITEM_CODE")))
	{
		g_Message("EE","해당 상품은 요일통제 상품입니다!");
		return;
	}
	//주문통제체크	
	if (!ffn_ChkNull(eval(obj.binddataset).getColumnInfo("LIMIT_ITEM"))) {	
		if (! ffn_ChkNull(eval(obj.binddataset).getColumn(e.row,"LIMIT_ITEM")))
		{
			g_Message("EE","해당 상품은 주문통제 상품입니다!" + "\n\n" + "통제내용:" + eval(obj.binddataset).getColumn(e.row,"LIMIT_REASON"));
			return;
		}
	}
	
	if(tab_list.tabindex == 0)	//상품조회
	{
		//금지자재 및 불용자재 체크	
		//trace(ds_List1.getColumn(ds_List1.rowposition,"UNUSE_YN"));
		//trace(ds_List1.getColumn(ds_List1.rowposition,"VAL_STP_YN"));

		if (ds_List1.getColumn(ds_List1.rowposition,"UNUSE_YN") == "UK" || ds_List1.getColumn(ds_List1.rowposition,"VAL_STP_YN") == "TK" ) 
		{	
			g_Message("EE","해당 상품은 주문불가 상품입니다!");
			return;
		}	
		
		//단가업장 수발주 요일 제한 상품 체크
		if (ds_List1.getColumn(ds_List1.rowposition,"DANGAWEEK_STATUS") == "FE")
		{
			g_Message("EE","해당 상품은 단가업장 수발주 요일 제한 상품입니다!");
			return;
		}	
	}
	
	if(tab_list.tabindex == 1)	//즐겨찾기상품
	{
		//금지자재 및 불용자재 체크	
		//trace(ds_List2.getColumn(ds_List2.rowposition,"UNUSE_YN"));
		//trace(ds_List2.getColumn(ds_List2.rowposition,"VAL_STP_YN"));

		if (ds_List2.getColumn(ds_List2.rowposition,"UNUSE_YN") == "UK" || ds_List2.getColumn(ds_List2.rowposition,"VAL_STP_YN") == "TK" ) 
		{	
			g_Message("EE","해당 상품은 주문불가 상품입니다!");
			return;
		}	
		
		//단가업장 수발주 요일 제한 상품 체크
		if (ds_List2.getColumn(ds_List2.rowposition,"DANGAWEEK_STATUS") == "FE")
		{
			g_Message("EE","해당 상품은 단가업장 수발주 요일 제한 상품입니다!");
			return;
		}	
	}

	//발주마감체크
	if (fn_GetDayStatus(eval(obj.binddataset).getColumn(e.row,"D_DAYS"), eval(obj.binddataset).getColumn(e.row,"D_TIMES")) == "0")
	{
		//g_Message("EE","마감시간이 초과되어 주문이 불가합니다.");
		return;
	}
	//창고가 식재/소모품 통합창고인 경우 주문통제 점검
	if (ffn_ChkNull(ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN")))
	{
		//주문통제(주문일자)
		var jRow;
		jRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='주문'&&ITEM_TYPE==iif('" + eval(obj.binddataset).getColumn(e.row,"CONSUM_YN") + "','Y','소모품','식자재')");
		if (jRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(jRow,ToUpper(gds_currdate.getColumn(0, "WEEK_ENG"))) == "Y")
			{
				g_Message("EE", gds_currdate.getColumn(0, "WEEK_KOR") + "요일은 " + ds_OrdCtrl.getColumn(jRow,"ITEM_TYPE") + " 주문불가 요일입니다.");
				return;
			}
		}
		//주문통제(입고일자)
		jRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE==iif('" + eval(obj.binddataset).getColumn(e.row,"CONSUM_YN") + "','Y','소모품','식자재')");
		if (jRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(jRow,ToUpper(ffn_DayToWeek(me_NeedDate.value,"1"))) == "Y")
			{
				g_Message("EE", ffn_DayToWeek(me_NeedDate.value) + "요일은 " + ds_OrdCtrl.getColumn(jRow,"ITEM_TYPE") + " 입고불가 요일입니다." + "\n\n" + "입고예정일을 변경하세요.");
				return;
			}
		}
	}else{
		//주문통제(입고일자)
		jRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE=='공통'");
		if (jRow >= 0)
		{
			if (ds_OrdCtrl.getColumn(jRow,ToUpper(ffn_DayToWeek(me_NeedDate.value,"1"))) == "Y")
			{
				g_Message("EE", ffn_DayToWeek(me_NeedDate.value) + "요일은 " + ds_OrdCtrl.getColumn(jRow,"ITEM_TYPE") + " 입고불가 요일입니다." + "\n\n" + "입고예정일을 변경하세요.");
				return;
			}
		}	
	}
	
	// 최초등록시 주문번호 채번, 이후에는 같은 주문번호가 나오도록 함
	// 조회건수가 1건이라도 있을경우
	ds_List.filter("OTCUSTCD=='0000'");
	
	if (fn_dsListCnt > 0)
	{
		for (i=0; i<ds_List.rowcount; i++)
		{
			fn_gubunNewOrOld = "OLD";	
			
			if(!gfn_isNull(ds_List.getColumn(i, "PR_NUM")) && ds_List.getColumn(i, "OTCUSTCD") == "0000")
			{
				fn_maxPrNum = ds_List.getColumn(i, "PR_NUM");
			}
			
			if(!gfn_isNull(ds_List.getColumn(i, "APPROVE_NUM")))
			{
				fn_maxApproveNum = ds_List.getColumn(i, "APPROVE_NUM");	
			}			
		}
	}
	else
	{
		fn_maxPrNum = "";
		fn_maxApproveNum = "";
		fn_gubunNewOrOld = "NEW";
	}
	
	ds_List.filter("");
	
	//라인복사
	fn_CopyRow(eval(obj.binddataset), e.row);
	
	//obj.SetFocus();
	
	gd_list.setFocus();
	gd_list.setCellPos(8);
	
}

function tab_list_tab1_gd_list_OnEnterDown(obj,nRow,nCell,strVal,nPivotIndex)
{
	//2007버젼의 CyGridU.dll에 있는 오류를 수정하기 위해 온 엔터 다운코드를 제거함.
	//오류내용 : 1번째 그리드를 선택하고 엔터를 누르면 2번째 레코드 nRow가 넘어가는 현상
	//때문에 keyDown 함수에 구현함.
}

var fa_Chk;
function btn_CallPop_OnClick(obj:Button, e:ClickEventInfo)
{
/*
	if (object(obj.UserData).rowcount < 1) return;
	if (object(obj.UserData).row < 0) return;
	if (! g_Confirm("02","해당 상품을 " + obj.Text + "하시겠습니까?!")) return;
	
	//필수항목 
	if (fn_ChkManNull()) return;
	//
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	
	strSvcID = "FMP00080E_T002";
	strURL   = "S_FMP::FMP00080E_T002.jsp";
	// 데이터셋 설정U
	strInDatasets  = "";
	strOutDatasets = "";
	// 파라메터 설정
	strArgument  = "g_Upjang=" + quote(g_Upjang);
	strArgument += " g_EmpNo=" + quote(g_EmpNo);
	strArgument += " sUpjang=" + quote(ed_Upjang.UserData);
	strArgument += " sFavGroup=" + quote(tab_list.tab2.cbo_Fav.Value);
	strArgument += " sItemCode=" + quote(object(obj.UserData).GetColumn(object(obj.UserData).row,"ITEM_CODE"));
	if (obj.UserData == "ds_List2")
		strArgument += " sGB='0'";
	else
		strArgument += " sGB='1'";
	
	// 콜백함수 지정
	strCallbackFunc = "";
	// 서버 호출 
	http.Sync = true;
	Transaction(strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc);
	http.Sync = false;
	//결과
	if (! ffn_ChkNull(fa_Chk)) g_Message("EE",fa_Chk);
*/
	//해당 작업화면 링크
	if (obj.userdata == "ds_List2")
		gfn_openMenuForm("FMP00860E.xfdl","U_FMP","","즐겨찾기 상품등록");
	else if (obj.userdata == "ds_List3")
		gfn_openMenuForm("FMP00890E.xfdl","U_FMP","","주간발주 상품등록");
	else if (obj.userdata == "ds_List4")	//지난발주 복사일 경우
	{
		for (var i=0; i<eval(obj.userdata).rowcount; i++)	//선택된 상품에 대해 추가 작업을 함.
		{
			if (eval(obj.userdata).getSelect(i))
			{
				var e = new EventInfo();
				e.row = i;
				gd_list_OnCellDblClick(tab_list.tab4.gd_list,e);
			}
		}
	}
}
function tab_list_OnChanged(obj:Tab, e:TabIndexChangeEventInfo)
{
	eval("tab_list.tab" + gfn_toString(e.postindex + 1)).ed_Item.setFocus();
	
	if(e.postindex == '1')
	{
		//즐겨찾기그룹
		fn_SetFav();
	};
}
function gd_list_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	
	if(tab_list.tabindex=='0') //상품추가 탭에서
	{
		//즐겨찾기 추가 버튼을 누를 때
		if(e.cell == 14)
		{
		
			if ( !gfn_isNull(eval(obj.binddataset).getColumn(e.row, "FAVOR_GROUP_FLAG")) ) {
			
				//삭제확인
			if (! g_Confirm("01", '선택하신 즐겨찾기 상품을 삭제하시겠습니까?!')) return;
				//fn_deleteFav(e.row);
				var strParam = {};
				strParam["fa_ItemCode"] = eval(obj.binddataset).getColumn(e.row, "ITEM_CODE");
				strParam["fa_ItemName"] = eval(obj.binddataset).getColumn(e.row, "ITEM_NAME");
				strParam["fa_Upjang"] = ed_Upjang.userdata;
				strParam["fa_Mode"] = "D";
								
				gfn_dialog("", "U_FMP::FMP00080P.xfdl", strParam);
			} else {
				//alert(obj +"|"+ nRow +"|"+ nCell +"|"+ nX +"|"+ nY +"|"+ nPivotIndex);
				var strParam = {};
				strParam["fa_ItemCode"] = eval(obj.binddataset).getColumn(e.row, "ITEM_CODE");
				strParam["fa_ItemName"] = eval(obj.binddataset).getColumn(e.row, "ITEM_NAME");
				strParam["fa_Upjang"] = ed_Upjang.userdata;
				strParam["fa_Mode"] = "I";
				
				gfn_dialog("", "U_FMP::FMP00080P.xfdl", strParam);
				
			}
			fn_SearchItem();
		}
	}else if(tab_list.tabindex=='1') //즐겨찾기 탭에서
	{
		//즐겨찾기 삭제 버튼을 누를 때
		if(e.cell == 14)
		{
			//삭제확인
			if (! g_Confirm("01", '선택하신 즐겨찾기 상품을 삭제하시겠습니까?!')) return;
			fn_deleteFav(e.row);
		}
	}
	
	//2010/03/22 수량 입력 클릭 시 공백 처리 == by Noh Kyu Wan ==
	if (e.cell == 8)
	{
	    if (ds_List.getColumn(e.row,"PR_QTY") <> 0)
	    {}
	    else	    
		ds_List.setColumn(e.row,"PR_QTY","");		
     }			
	
	if (eval(obj.binddataset).rowcount < 1) return;
	if (e.row < 0) return;
	if (e.cell <> 1) return;
	
	//상품이미지
/*
	if (object(obj.BindDataset).GetColumn(nRow, "OTCUSTCD") = "0000")
		gfn_dialog("", "U_SCC::SCC91000P.xml","fa_Image="+quote(gfmsImgPathH + object(obj.BindDataset).GetColumn(nRow, "IMAGE_PATH")));
	else
		gfn_dialog("", "U_SCC::SCC91000P.xml","fa_Image="+quote(gfmsImgPathO + object(obj.BindDataset).GetColumn(nRow, "IMAGE_PATH")));
*/
	
	/******************* 구매 자재팝업으로 변경*/
// 	var strParam = {};
// 	strParam["fa_CenterCode"] = gfn_trim(eval(obj.binddataset).getColumn(e.row, "CENTER_CODE"));
// 	strParam["fa_Custcd"] = gfn_trim(eval(obj.binddataset).getColumn(e.row, "CUSTCD"));
// 	strParam["fa_ItemCode"] = gfn_trim(eval(obj.binddataset).getColumn(e.row, "ITEM_CODE"));
// 	if (gfn_length(eval(obj.binddataset).getColumn(e.row, "IMAGE_PATH"))<= 0)
// 		strParam["fa_Image"] = '';
// 	else
// 	{
// 		if (eval(obj.binddataset).getColumn(e.row, "OTCUSTCD") == "0000")
// 		{
// 			strParam["fa_Image"] = gfn_trim(gfmsImgPathH + eval(obj.binddataset).getColumn(e.row, "IMAGE_PATH"));
// 		}
// 		else
// 		{
// 			//기존에 쓰던 서버가 바뀌어서 강제로 변경함.
// 			var ImgPath = "http://203.233.82.50/hwfs/upload/fm/item/";
// 			strParam["fa_Image"] = gfn_trim(ImgPath + eval(obj.binddataset).getColumn(e.row, "IMAGE_PATH"));
// 			//trace("pppppp : " + strParam);
// 		}
// 	}
	var arrParam = new Array();
	
	arrParam[0] = eval(obj.binddataset).getColumn(e.row, "ITEM_CODE");
	
	var rtnVal = gfn_dialog("FMP00010P"			// dialogId
				   , "U_FMP::FMP00010P.xfdl"		// Url
				   , {fv_Contents:arrParam}					// 배열
				   , null, null, null, null, null, false, true, -1);
				   
	//strParam["fa_ItemPrice"] = eval(obj.binddataset).getColumn(e.row, "OP_PRICE");
// 	strParam["fa_ItemCode"] = eval(obj.binddataset).getColumn(e.row, "ITEM_CODE");
// 	gfn_dialog("", "U_FMP::FMP00010P.xfdl", strParam);
	/********************/
	
	//20150824 구매자재팝업 사용 X
	//자재상세팝업 호출 : 두번째 파라미터는 아이템코드 
	//SCSysIf.eprocPopup(SCSysIf.EPROC_ITEM_POPUP, gfn_trim(eval(obj.binddataset).getColumn(e.row, "ITEM_CODE")));
}
function FMP00080E_OnActivate(obj:Form, e:ActivateEventInfo)
{
	//fn_searchItemUpMemory();
	
	//화면 액트브시 타이머 재설정
	fn_SetTimer();
	setTimer(777,30000); //일단 30초 세팅
}
function FMP00080E_OnDeactivate(obj:Form, e:ActivateEventInfo)
{
	//타이머 종료...(타이머 발생으로 쿼리 수행하여 결과값 가져오면 화면이 앞으로 올라온다.
	killTimer(777);
}
// 2008.12.11 추가 (조회 분류 OnChanged 추가) by Noh Kyu Wan
function cbo_Class2_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	//trace(ds_Class3.saveXML());
	//trace(e.postvalue);
	//trace(obj);
	
	if(gfn_isNull(e.postvalue))
	{
		trace("null");
	}
	
	if (obj == tab_list.tab1.cbo_Class2)
	{
		if(gfn_isNull(e.postvalue))	//전체일경우 필터해제
		{
			ds_Class3.filter("");
			ds_Class4.filter("");
			tab_list.tab1.cbo_Class3.index = 0;
			tab_list.tab1.cbo_Class4.index = 0;
		}
		else
		{
			// 소분류 데이터셋 필터
			ds_Class3.filter("gfn_left(CLASS_CODE,3)=="+wrapQuote(gfn_left(e.postvalue,3))+"||CLASS_CODE==''");
			tab_list.tab1.cbo_Class3.index = 0;
			// 세분류 데이터셋 필터
			ds_Class4.filter("gfn_left(CLASS_CODE,3)=="+wrapQuote(gfn_left(e.postvalue,3))+"||CLASS_CODE==''");
			tab_list.tab1.cbo_Class4.index = 0;
		}
	}
	else if (obj == tab_list.tab1.cbo_Class3)
	{
		if(gfn_isNull(e.postvalue))	//전체일경우 필터해제
		{
			ds_Class4.filter("");
			tab_list.tab1.cbo_Class4.index = 0;
		}
		else
		{
			ds_Class4.filter("gfn_left(CLASS_CODE,5)=="+wrapQuote(gfn_left(e.postvalue,5))+"||CLASS_CODE==''");
			tab_list.tab1.cbo_Class4.index=0;
		}
	}	
}
function cbo_Class2_OnKeyDown(obj:Combo, e:KeyEventInfo)
{
	ffn_SetComboNull(obj, e.keycode);	
}
function gd_list_OnEnterDown(obj:Grid, e:GridEditEventInfo)
{	
	//********************************************************************************************
	// 기능 추가 : CSR Number <26200> 
	// 변 경 자  : 노규완
	// 수정 일자 : 2009-04-10 
	// 수정 내역 : 기존 상품 조회 추가 시 마우스 포커스 이동이 수량 -> 비고.
	//             그리드에 등록 된 마지막 Row의 비고란에서 Enter값이 들어 오면 
	//             마우스 포커스가 상품검색란으로 이동 시켜 준다.
	//********************************************************************************************	
	//trace(ds_List.getCountNF() +"::"+ (ds_List.rowposition + 1) + "::" + gd_list.getCellPos());

	if ( obj == gd_list );	
	{
		if ( (ds_List.getCountNF() == ds_List.rowposition + 1) && (gd_list.getCellPos() == 10) )	
		{
		  if (tab_list.tabindex == 0)  tab_list.tab1.ed_Item.setFocus();
		  if (tab_list.tabindex == 1)  tab_list.tab2.ed_Item.setFocus();
		  if (tab_list.tabindex == 2)  tab_list.tab3.ed_Item.setFocus();
		  if (tab_list.tabindex == 3)  tab_list.tab4.ed_Item.setFocus();
		}	
	}	
}
//gd_list_OnEnterDown을 대체함.
function gd_list_onkeydown(obj:Grid, e:KeyEventInfo)
{
	if (e.keycode == 13) {		
		if ((ds_List.getCountNF() == ds_List.rowposition + 1) && (gd_list.getCellPos() == 14)) {
			//trace(ds_List.getCountNF() +"::"+ (ds_List.rowposition + 1) + "::" + gd_list.getCellPos());
			if (tab_list.tabindex == 0)  tab_list.tab1.ed_Item.setFocus();
			if (tab_list.tabindex == 1)  tab_list.tab2.ed_Item.setFocus();
			if (tab_list.tabindex == 2)  tab_list.tab3.ed_Item.setFocus();
			if (tab_list.tabindex == 3)  tab_list.tab4.ed_Item.setFocus();
			return true; //Focus 이상으로 추가함.
		}	
	}
}
function gd_list_OnCellPosChanged(obj:Grid, e:GridSelectEventInfo)
{
	//2010/03/22 수량 입력 클릭 시 공백 처리 == by Noh Kyu Wan ==
	if (e.cell == 8)
	{
	    if (ds_List.getColumn(e.row,"PR_QTY") <> 0)
	    {}
	    else	    
		ds_List.setColumn(e.row,"PR_QTY","");		
     }	
}
//************************************************************************************************
// Excel 상품 일괄 발주 기능 추가  2010/06/25 by 노규완
//************************************************************************************************
function fn_Excel_Import(obj:Button, e:ClickEventInfo)
{	
	//필수항목 
	if (fn_ChkManNull()) return;
	//발주가능 체크
	if (! fn_OrdChk())
	{
		btn_NeedDate.setFocus();
		return;
	}	
	
	if (ed_Upjang.userdata == ""){
		g_Message("EE","사업장 코드를 반드시 입력 하시기 바랍니다.");
		return;
	}
	if (cbo_Subinv.value == ""){
		g_Message("EE","창고 코드를 반드시 입력 하시기 바랍니다.");
		return;
	}	
	
	//엑셀 임포트
	fd_Excel.Type = "OPEN";
	fd_Excel.Filter = "All(*.*)|*.*|Excel File(*.xls)|*.xls|";
	
	if( fd_Excel.Open() )
	{		
		var nX = parseInt(this.position.width/2) - parseInt(dv_Prg.position.width/2);		
		var nY = parseInt(this.position.height/2) - parseInt(dv_Prg.position.height/2);		
		dv_Prg.move(nX, nY);
	
		dv_Prg.visible = true;
		var sFullFileName = fd_Excel.FilePath + '\\' + fd_Excel.FileName;
		gd_list.enableredraw = false;
		ds_Excel.clearData();
		//ext_ExcelImportByIndex(파일풀패스, 시트순번, 깡통데이타셑);
		ext_ExcelImportByIndex(sFullFileName, 0, "ds_Excel");
		
		
		
		fn_SetImpData();
		gd_list.enableredraw = true;
	}	
}
function fn_SetImpData()
{
	var sErrMsg = "";
	var sErrCode = "";
	
	ds_List.clearData();
	ds_ErrLst.clearData();
	
	//SetWaitCursor(true);
	//trace(ds_Excel.saveXML());
	
	
	for (var i = 1; i < ds_Excel.rowcount; i++)
	{	
        //**********************************************************************************
        // 기본적인 엑셀 데이터 중 미등록 항목 체크 [Start]
        //**********************************************************************************
		if (gfn_length(gfn_trim(ds_Excel.getColumn(i,"Col01")))== 0)  //상품코드 체크
		{
			ds_ErrLst.addRow();
			ds_ErrLst.setColumn(ds_ErrLst.rowposition, "errmsg", i + "행)상품코드 미등록");
			continue;
		}
		if (gfn_length(gfn_trim(ds_Excel.getColumn(i,"Col02")))== 0)  //상품명 체크
		{
			ds_ErrLst.addRow();
			ds_ErrLst.setColumn(ds_ErrLst.rowposition, "errmsg", i + "행)상품명 미등록");
			continue;
		}		
		if (gfn_length(gfn_trim(ds_Excel.getColumn(i,"Col03")))== 0)  //규격 체크
		{
			ds_ErrLst.addRow();
			ds_ErrLst.setColumn(ds_ErrLst.rowposition, "errmsg", i + "행)규격 미등록");
			continue;
		}												
		if (gfn_length(gfn_trim(ds_Excel.getColumn(i,"Col04")))== 0)  //단위 체크
		{
			ds_ErrLst.addRow();
			ds_ErrLst.setColumn(ds_ErrLst.rowposition, "errmsg", i + "행)단위 미등록");
			continue;
		}
		if (gfn_length(gfn_trim(ds_Excel.getColumn(i,"Col05")))== 0)  //수량 체크
		{
			ds_ErrLst.addRow();
			ds_ErrLst.setColumn(ds_ErrLst.rowposition, "errmsg", i + "행)수량 미등록");
			continue;
		}
        //**********************************************************************************
        // 기본적인 엑셀 데이터 중 미등록 항목 체크 [End]
        //**********************************************************************************		
		
		ds_Cond.clearData();
		eval("ds_List" + gfn_toString(tab_list.tabindex+1)).clearData();
		ds_Cond.addRow();
		ds_Cond.setColumn(0, "UPJANG",        ed_Upjang.userdata);
		ds_Cond.setColumn(0, "SUBINV_CODE",   cbo_Subinv.value);
		ds_Cond.setColumn(0, "NEED_DATE",     me_NeedDate.value);
		ds_Cond.setColumn(0, "CONSUM_YN",     ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN"));
		ds_Cond.setColumn(0, "QTY_CONTROL_YN",ds_Days.getColumn(0,"QTY_CONTROL_YN"));
		ds_Cond.setColumn(0, "CENTER_CODE",   			ds_CtUpj.getColumn(0,"CENTER_CODE"));
		ds_Cond.setColumn(0, "AP_UNITPRICE_UPJANG",     ds_CtUpj.getColumn(0,"AP_UNITPRICE_UPJANG"));
		ds_Cond.setColumn(0, "OTCUST_PRICE_UPJANG",     ds_CtUpj.getColumn(0,"OTCUST_PRICE_UPJANG"));
		ds_Cond.setColumn(0, "ITEM_CODE",ds_Excel.getColumn(i,"Col01"));
		
		if (tab_list.tabindex == 1)
			ds_Cond.setColumn(0, "FAVOR_GROUP",   tab_list.tab2.cbo_Fav.value);
			
		else if (tab_list.tabindex == 0) // 2008.12.11 추가(분류별 상품 조회 기능)
		{
			ds_Cond.setColumn(0, "ITEM_CLASS2", tab_list.tab1.cbo_Class2.value);    //중분류
			ds_Cond.setColumn(0, "ITEM_CLASS3", tab_list.tab1.cbo_Class3.value);	//소분류
			ds_Cond.setColumn(0, "ITEM_CLASS4", tab_list.tab1.cbo_Class4.value);	//세분류
		}
		http.Sync = true;
		// 조회
		var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
		// 경로 설정
		strSvcID = "FMP00080E_T001";
		strURL   = "U_svc::" + "fm/fmp/FMP00080E_T001.jsp";
		// 데이터셋 설정
		strInDatasets  = "ds_Cond=ds_Cond";
		strOutDatasets = "ds_List" + gfn_toString(tab_list.tabindex+1)+ "=ds_List";
		// 파라메터 설정
		strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
		strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
		strArgument += " strIndex=" + wrapQuote(gfn_toString(tab_list.tabindex+1));
		if (eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).chk_Only.value)
			strArgument += " strOnly='TRUE'";
		else
			strArgument += " strOnly='FALSE'";
		strArgument += " sType=" + wrapQuote(cbo_Type.value);
		// 콜백함수 지정
		strCallbackFunc = "";
		// 서버 호출 
		//Transaction(strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc);
		jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);	
		http.Sync = false;
		
		
		//*****************************************************************
		// 조회 한 상품 별로 발주 리스트로 복사 하기 전 체크               
		//*****************************************************************
		if (ds_List1.rowcount < 1) return;
		
		//리조트 물류스케주울 체크
		if (! ffn_ChkNull(ds_List1.getColumn(ds_List1.rowposition,"WEEK_ITEM_CODE")))
		{
			g_Message("EE","해당 상품은 요일통제 상품입니다!");
			return;
		}
		//주문통제체크
		if (!ffn_ChkNull(ds_List1.getColumnInfo("LIMIT_ITEM"))) {
			if (! ffn_ChkNull(ds_List1.getColumn(ds_List1.rowposition,"LIMIT_ITEM")))
			{
				g_Message("EE","해당 상품은 주문통제 상품입니다!" + "\n\n" + "통제내용:" + ds_List1.getColumn(ds_List1.rowposition,"LIMIT_REASON"));
				return;
			}
		}
		//발주마감체크
		if (fn_GetDayStatus(ds_List1.getColumn(ds_List1.rowposition,"D_DAYS"), ds_List1.getColumn(ds_List1.rowposition,"D_TIMES")) == "0")
		{
			//g_Message("EE","마감시간이 초과되어 주문이 불가합니다.");
			return;
		}
		//창고가 식재/소모품 통합창고인 경우 주문통제 점검
		if (ffn_ChkNull(ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN")))
		{
			//주문통제(주문일자)
			var jRow;
			jRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='주문'&&ITEM_TYPE==iif('" + ds_List1.getColumn(ds_List1.rowposition,"CONSUM_YN") + "','Y','소모품','식자재')");
			if (jRow >= 0)
			{
				if (ds_OrdCtrl.getColumn(jRow,ToUpper(gds_currdate.getColumn(0, "WEEK_ENG"))) == "Y")
				{
					g_Message("EE", gds_currdate.getColumn(0, "WEEK_KOR") + "요일은 " + ds_OrdCtrl.getColumn(jRow,"ITEM_TYPE") + " 주문불가 요일입니다.");
					return;
				}
			}
			//주문통제(입고일자)
			jRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE==iif('" + eval(obj.Binddataset).getColumn(nRow,"CONSUM_YN") + "','Y','소모품','식자재')");
			if (jRow >= 0)
			{
				if (ds_OrdCtrl.getColumn(jRow,ToUpper(ffn_DayToWeek(me_NeedDate.value,"1"))) == "Y")
				{
					g_Message("EE", ffn_DayToWeek(me_NeedDate.value) + "요일은 " + ds_OrdCtrl.getColumn(jRow,"ITEM_TYPE") + " 입고불가 요일입니다." + "\n\n" + "입고예정일을 변경하세요.");
					return;
				}
			}
		}else{
			//주문통제(입고일자)
			jRow = ds_OrdCtrl.findRowExpr("CTRL_TYPE=='입고'&&ITEM_TYPE=='공통'");
			if (jRow >= 0)
			{
				if (ds_OrdCtrl.getColumn(jRow,ToUpper(ffn_DayToWeek(me_NeedDate.value,"1"))) == "Y")
				{
					g_Message("EE", ffn_DayToWeek(me_NeedDate.value) + "요일은 " + ds_OrdCtrl.getColumn(jRow,"ITEM_TYPE") + " 입고불가 요일입니다." + "\n\n" + "입고예정일을 변경하세요.");
					return;
				}
			}			
		}
	
		
		if ( ds_List.findRow("ITEM_CODE", ds_Excel.getColumn(i,"Col01")) )  //상품코드 체크
		{
			ds_ErrLst.addRow();
			ds_ErrLst.setColumn(ds_ErrLst.rowposition, "errmsg", i + "행)상품코드 기등록");
			continue;
		}
		else
		{
			ds_List.addRow();
			ds_List.copyRow(ds_List.rowposition,ds_List1,ds_List1.rowposition);
			ds_List.setColumn(ds_List.rowposition, "PR_QTY", ds_Excel.getColumn(i,"Col05"));              //수량
			if (gfn_length(gfn_trim(ds_List1.getColumn(ds_List1.rowposition,"ITEM_CODE")))== 0)  //조회 한 상품 코드가 있는지 체크
			{
				ds_ErrLst.addRow();
				ds_ErrLst.setColumn(ds_ErrLst.rowposition, "errmsg", i + "행)창고,발주예정일 체크:조회한 상품이 없습니다.");
				ds_List.deleteRow();
				continue; 
			}
		}

   }
	
	ds_List1.clearData();
	
	SetWaitCursor(false);
	dv_Prg.visible = false;
	
	
	if (ds_ErrLst.rowcount < ds_Excel.rowcount)
	{		
		if (ds_ErrLst.rowcount > 0)
		{
			sErrMsg += '\n오류 데이타가 존재합니다.\n확인하시겠습니까?!';
			
			div_Error.move(0, Static2.position.top - 12);
			
			ds_ErrLst.rowposition = 0;
			div_Error.visible = (g_Confirm("04", sErrMsg));
			if (div_Error.visible) div_Error.grd_ErrLst.setFocus();
			ds_List.clearData();
		}
		else
			g_Message("02", "정상적으로 업로드 되었습니다.");
	}		
	
}
function div_Error_btn_Hidden_OnClick(obj:Button, e:ClickEventInfo)
{
	div_Error.visible = false;
}
//*************************************************************
// 2010-08-05  보조금 관련 추가 ( 사업장 보조금 관리 유무조회)
//*************************************************************
function fn_Green_Upjang()
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_Green=ds_Green";
    otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);	
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "sc/scc:SCC_GREEN_USER");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/	
	
	//*********************************************************************
	//	me_Pdate   Width : 160  --> 80
	//	Static28  : Width : 95  , Left : 268     --> Left : 190
	//	ed_Pcnt : Width 110 , Left : 365  -->   Width 90  , Left :  287
	//	ed_Pamt : Width : 224 , Left : 477   -> Width : 130 , Left : 378	
	//*********************************************************************
	if (ds_Green.getColumn(0,"USE_YN") == 'Y')
	{
		me_Pdate.position.width = 80;                      //최종발주일자 edit 사이즈 변경
		Static28.position.left = 190;                       //최종발주정보 Static 위치 변경
		ed_Pcnt.position.width = 90;  ed_Pcnt.position.left = 287;   //최종발주 카운터 사이즈 및 위치 변경
		ed_Pamt.position.width = 130; ed_Pamt.position.left = 378;   //최종발주 금액 사이즈 및 위치 변경
		Sta_Green.visible = true;                  //보조금 잔액 Static 화면 보이기
		ed_Green.visible = true;				   //보조금 잔액 금액 표시 화면 보이기.
	}
}
//*************************************************************
// 2010-08-05  보조금 관련 추가 ( 사업장 보조금 잔액 조회)
//*************************************************************
function fn_Green_Amt()
{
	/*-------------*/
	http.Sync = true;
	/*-------------*/
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_Green=ds_Green";
    otherArg	= "UPJANG=" + wrapQuote(ed_Upjang.userdata);
	otherArg	+=" NEED_DATE="+ wrapQuote(gfn_trim(me_NeedDate.value));        	
	//action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	fsp_addSearch(this, "sc/scc:SCC_GREEN_AMT");
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
	/*-------------*/
	http.Sync = false;
	/*-------------*/	
	ed_Green.value = numFormat(ds_Green.getColumn(0,"BALANCE_AMT"))+ " 원";	
}
//*****************************************************************************
// 2010-08-05  보조금 관련 추가 (로그인 사업장 보조금 재 생성 프로시져 호출)
//*****************************************************************************
function  fn_Create_Green_Amt()
{
	var t_timeout;
	// action 정보 초기화
	fsp_clear(this);	

	// 데이타체크
	ds_Green_Proc.clearData();	
	ds_Green_Proc.addRow();				

	ds_Green_Proc.setColumn(0,"UPJANG",ed_Upjang.userdata);				
	ds_Green_Proc.setColumn(0,"NEED_DATE",me_NeedDate.value);
	ds_Green_Proc.setColumn(0,"CUSER", g_EmpNo);		
	http.Sync = true;			

	t_timeout = application.httptimeout;
	application.httptimeout=2000; //1800초 

	//setCapture();

	fsp_addSingle(this, "sc/scc:SCC_GREEN_PROC");
	fsp_callService(this, "", "", "ds_Green_Proc=ds_Green_Proc:A", "",  "", "");

	application.httptimeout=t_timeout; //60초

	http.Sync = false;
}

function btn_RcpConf_OnClick(obj:Button, e:ClickEventInfo)
{
	dv_RcpConf.visible = (! dv_RcpConf.visible);
}

function dv_RcpConf_me_RcpDateT_onkillfocus(obj:MaskEdit, e:KillFocusEventInfo)
{
	dv_RcpConf.me_RcpDateF.value = gfn_addDate(obj.value,-1);
}

function dv_MultiUpj_btn_Hidden_OnClick(obj:Button, e:ClickEventInfo)
{
	if (ffn_ChkNull(ed_Upjang.userdata))
	{
		g_Message("EE", "사업장을 선택하세요!");
		return;
	}
	if (ffn_ChkNull(dv_RcpConf.me_RcpDateF.value))
	{
		g_Message("EE", "입금확인일자를 지정하세요!");
		return;
	}
	if (ffn_ChkNull(dv_RcpConf.me_RcpDateT.value))
	{
		g_Message("EE", "입금확인일자를 지정하세요!");
		return;
	}
	/*
	//ds임시생성
	var dsObjin;
	create("Dataset", "ds_Dummyin");
	dsObjin = eval("ds_Dummyin");
	dsObjin.addColumn("RCP_DATEF", "STRING", 8);
	dsObjin.addColumn("RCP_DATET", "STRING", 8);
	dsObjin.addColumn("UPJANG", "STRING", 6);
	// 초기화
	ds_Dummyin.clearData();
	ds_Dummyin.addRow();
	ds_Dummyin.setColumn(0, "RCP_DATEF",  dv_RcpConf.me_RcpDateF.value);
	ds_Dummyin.setColumn(0, "RCP_DATET",  dv_RcpConf.me_RcpDateT.value);
	ds_Dummyin.setColumn(0, "UPJANG",    ed_Upjang.userdata);
	// 트랜잭션 호출
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMZ_CREDIT_INFO_T002";
	strURL   = "U_svc::" + "fm/fmz/FMZ_CREDIT_INFO_T002.jsp";
	// 데이터셋 설정
	strInDatasets  = "ds_Cond=ds_Dummyin";
	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
	//ds임시생성 해제
	Destroy("ds_Dummyin");
	*/
	//과거에는 아이리스 인터페이스 프로시져를 통해 입금 여부를 실시간으로 가져왔으나
	//지금은 SAP와 연동되어서 바로 받아오기 때문에 그냥 여신을 다시 한번 재조회 하면 됨.
	
// [속도개선 Project 시작] 2017. 8. 21. 최범주 여신정보조회 함수 대체
	if ( !fn_GetCredit() ) return; // 여신정보 조회
// [속도개선 Project   끝] 2017. 8. 21. 최범주
	dv_RcpConf.visible = false;
	g_Message("01","실시간 입금확인이 완료되었습니다.");
}

function fn_searchItemUpMemory() {
	
	ds_Cond.clearData();
	ds_Cond.addRow();
	ds_Cond.setColumn(0, "UPJANG",        ed_Upjang.userdata);
	ds_Cond.setColumn(0, "SUBINV_CODE",   cbo_Subinv.value);
	ds_Cond.setColumn(0, "NEED_DATE",     me_NeedDate.value);
	ds_Cond.setColumn(0, "CONSUM_YN",     ds_Subinv.getColumn(ds_Subinv.rowposition,"CONSUM_YN"));
	ds_Cond.setColumn(0, "QTY_CONTROL_YN",ds_Days.getColumn(0,"QTY_CONTROL_YN"));
	ds_Cond.setColumn(0, "CENTER_CODE",   			ds_CtUpj.getColumn(0,"CENTER_CODE"));
	ds_Cond.setColumn(0, "AP_UNITPRICE_UPJANG",     ds_CtUpj.getColumn(0,"AP_UNITPRICE_UPJANG"));
	ds_Cond.setColumn(0, "OTCUST_PRICE_UPJANG",     ds_CtUpj.getColumn(0,"OTCUST_PRICE_UPJANG"));
	//ds_Cond.setColumn(0, "ITEM_NAME",     eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).ed_Item.text);
	ds_Cond.setColumn(0, "ITEM_NAME",     "계란");
	if (tab_list.tabindex == 1)
		ds_Cond.setColumn(0, "FAVOR_GROUP",   tab_list.tab2.cbo_Fav.value);
		
	else if (tab_list.tabindex == 0) // 2008.12.11 추가(분류별 상품 조회 기능)
	{
		ds_Cond.setColumn(0, "ITEM_CLASS2", tab_list.tab1.cbo_Class2.value);    //중분류
		ds_Cond.setColumn(0, "ITEM_CLASS3", tab_list.tab1.cbo_Class3.value);	//소분류
		ds_Cond.setColumn(0, "ITEM_CLASS4", tab_list.tab1.cbo_Class4.value);	//세분류
	}
	else if (tab_list.tabindex == 3)
	{
		/**
		if (ffn_ChkNull(tab_list.tab4.me_NeedDateP.value))
		{
			g_Message("EE", "복사대상 일자를 선택하세요."); tab_list.tab4.me_NeedDateP.setFocus(); return;
		}
		if (ffn_ChkNull(tab_list.tab4.ed_UpjangP.userdata))
		{
			g_Message("EE", "복사대상 업장을 선택하세요."); tab_list.tab4.ed_UpjangP.setFocus(); return;
		}
		if (ffn_ChkNull(tab_list.tab4.cbo_SubinvP.value))
		{
			g_Message("EE", "복사대상 식당을 선택하세요."); tab_list.tab4.cbo_SubinvP.setFocus(); return;
		}
		**/
		ds_Cond.setColumn(0, "NEED_DATEP",    tab_list.tab4.me_NeedDateP.value);
		ds_Cond.setColumn(0, "UPJANGP",       tab_list.tab4.ed_UpjangP.userdata);
		ds_Cond.setColumn(0, "SUBINV_CODEP",  tab_list.tab4.cbo_SubinvP.value);
	}
	
	// 조회
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMP00080E_T001";
	strURL   = "U_svc::" + "fm/fmp/FMP00080E_T001.jsp";	// FMP00080E_T001.jsp 동일 
	
	// 데이터셋 설정
	strInDatasets  = "ds_Cond=ds_Cond";
	strOutDatasets = "ds_temp=ds_List";
	strOutDatasets = "";
	// 파라메터 설정
	strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
	strArgument += " Holiday_YN=" + wrapQuote(application.g_HOLIDAY_CHK_YN);	
	strArgument += " strIndex=" + wrapQuote(gfn_toString(tab_list.tabindex+1));
	strArgument += " strWeekendTimeCheck=" + wrapQuote(fa_weekendTimeCheck);
	
    if (eval("tab_list.tab" + gfn_toString(tab_list.tabindex+1)).chk_Only.value == "1") {
		strArgument += " strOnly='TRUE'";
    } else {
		strArgument += " strOnly='FALSE'";
    }
	
	// 최근 n개월
	strArgument += " nMonth="+wrapQuote(tab_list.tab1.cbo_month.value);
	strArgument += " sType=" + wrapQuote(cbo_Type.value);
	
	// 콜백함수 지정
	strCallbackFunc = "";
	// 서버 호출 
	jsp_transaction_async(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, false);
}


function tab_list_tab1_gd_list_OnKeyDown(obj:Grid, e:KeyEventInfo)
{
	var nRow = ds_List1.rowposition;
	var nCell = '0';
	var nPivotIndex = '-1';
	
	//엔터키일때 입력
	if(e.keycode == '13')
	{
		var e = new EventInfo();
		e.row = this[obj.binddataset].rowposition;
	
		gd_list_OnCellDblClick(obj,e);
		
		return true; //Form의 onkeydown 이벤트를 발생시키지 않는다
	}
}

function tab_list_tab2_gd_list_OnKeyDown(obj:Grid, e:KeyEventInfo)
{
	var nRow = ds_List2.rowposition;
	var nCell = '0';
	var nPivotIndex = '-1';
	
	//엔터키일때 입력
	if(e.keycode == '13')
	{
		var e = new EventInfo();
		e.row = this[obj.binddataset].rowposition;
		gd_list_OnCellDblClick(obj,e);
	}
}

function tab_list_tab3_gd_list_OnKeyDown(obj:Grid, e:KeyEventInfo)
{
	var nRow = ds_List3.rowposition;
	var nCell = '0';
	var nPivotIndex = '-1';
	
	//엔터키일때 입력
	if(e.keycode == '13')
	{
		var e = new EventInfo();
		e.row = this[obj.binddataset].rowposition;
	
		gd_list_OnCellDblClick(obj,e);
	}
}

//즐겨찾기 삭제 함수
function fn_deleteFav(nRow)
{
	var fa_Upjang		= ed_Upjang.userdata;
	var favorGroupCode  = null;
	var itemCode		= null;
	if ( tab_list.tabindex == 0 ) {
		favorGroupCode	= ds_List1.getColumn(nRow,"FAVOR_GROUP_FLAG");
		itemCode 		= ds_List1.getColumn(nRow,"ITEM_CODE");
		
	} else {
		favorGroupCode	= ds_Fav.getColumn(ds_Fav.rowposition,"FAVOR_GROUP");
		itemCode 		= ds_List2.getColumn(nRow,"ITEM_CODE");
		
		//trace(upjang +"/"+ group +"/"+ itemCode);
		
		ds_List2.deleteRow(nRow);
	}
	ds_Cond.clearData();
	ds_Cond.addRow();
	ds_Cond.setColumn(0,"UPJANG",fa_Upjang);
	ds_Cond.setColumn(0,"FAVOR_GROUP",favorGroupCode);
	ds_Cond.setColumn(0,"ITEM_CODE",itemCode);
		
	//Transaction 설정
	var formObj			= this;
	var strSvcID		= "FMP00080P_T003";
	var strURL			= "U_svc::" + "fm/fmp/FMP00080P_T004.jsp";
	var strInDatasets	= "ds_Cond=ds_Cond:A";
	var strOutDatasets	= "";
	var strArgument = "";	//= "name1=park name2=yongdae";
	//var strCallbackFunc	= "fn_Add_callback"; //없는함수임.
	var strCallbackFunc	= "";
	var isErrorNotCall	= false;
	var isNotShow		= false;	//false 메세지 보여줌 --> sync일때 표현 안됨.
	var isSync			= true;		//true 다실행하고 실행됨.(async)

	//서버호출
	jsp_transaction(formObj, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, isErrorNotCall, isNotShow, isSync);
	
	// 삭재 후 재조회
	if ( tab_list.tabindex == 0 ) {
		tab_list.tab1.btn_search.click();
	}
}



function fn_setInitForm()
{
	if (tab_list.tabindex == 0){
		cbo_Type.index = 1;
		tab_list.tab1.ed_Item.value = ""; 
		tab_list.tab1.chk_Only.value = "1";
		tab_list.tab1.cbo_Class2.index = 0;
		tab_list.tab1.cbo_Class3.index = 0;
		tab_list.tab1.cbo_Class4.index = 0;
		ds_List1.clearData();
		tab_list.tab1.ed_Item.setFocus();
	}else if (tab_list.tabindex == 1){
		cbo_Type.index = 1;
		tab_list.tab2.ed_Item.value = ""; 
		tab_list.tab2.chk_Only.value = "1";
		tab_list.tab2.cbo_Fav.index = 0;
		ds_List2.clearData();
		tab_list.tab2.ed_Item.setFocus();
	}else if (tab_list.tabindex == 2){
		cbo_Type.index = 1;
		tab_list.tab3.ed_Item.value = ""; 
		tab_list.tab3.chk_Only.value = "1";
		ds_List3.clearData();
		tab_list.tab3.ed_Item.setFocus();
	}else if (tab_list.tabindex == 3){
		cbo_Type.index = 1;
		tab_list.tab4.ed_Item.value = ""; 
		ds_List4.clearData();
		tab_list.tab4.ed_Item.setFocus();
	}
}

// FICS 발주제한요일, 시간 설정 조회
function fn_getWeekendTime()
{
	fn_CurrDateWeek();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	// 파라미터셋팅
    outData		= "ds_WeekendTime=ds_List";
    callBackFnc = "callBackWeekendTime"
    //action 정보 초기화 
	fsp_clear(this); 
    // 서버에서 조회할 정보 추가 
	//fsp_addSearch(this, "fm/fmz:FMZ_GET_WEEKENDTIME_S001");
	fsp_addSearch(this, "fm/fmz:FMZ_GET_WEEKENDTIME_S001");
	
	// 서버 호출 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
}

function callBackWeekendTime(errCode, errMsg)
{
	if (errCode == 0)
	{
	    fn_setWeekendTime();
	} else {
		g_Message("EE",fn_AlertMsg("002"));
	}
}

// FICS 발주제한요일, 시간 설정에 따른 화면 제어 	
function fn_setWeekendTime()
{
	var sCurWeekCd = gds_currdate.getColumn(0, "WEEK_CD");
	var sCurTm = gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4);
	var nRow = ds_WeekendTime.findRow("CODE", sCurWeekCd);
	
	if ( nRow > -1 ) {
		
		fa_startTime = ds_WeekendTime.getColumn(nRow, "SET2");
		fa_endTime = ds_WeekendTime.getColumn(nRow, "SET3");
		
		if ( sCurTm >= fa_startTime && sCurTm <= fa_endTime ) {
			
			// 발주 통제 함
			fa_weekendTimeCheck = "Y"; 
			
			//tab_list.tab2.enable = false;
			//tab_list.tab3.enable = false;
			//tab_list.tab4.enable = false;
			
		} else {
		    // 발주 통제 안함
			fa_weekendTimeCheck = "N"; 
			
			//tab_list.tab2.enable = true;
			//tab_list.tab3.enable = true;
			//tab_list.tab4.enable = true;
		}
		
		//trace("fn_setWeekendTime 상품발주: "+fa_weekendTimeCheck);
	}
}

// 발주제한에 따른 탭페이지 제어
function tab_list_canchange(obj:Tab, e:TabIndexChangeEventInfo)
{
	if ( e.postindex == 2 || e.postindex == 3 ) {
		if ( fa_weekendTimeCheck == "Y" ) {
			g_Message("EE", "발주통제 시간입니다.");
			return false;
		}
	} 	
}

function gd_list_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	if ( e.cell == 1 ) {
		var arrParam = new Array();
		arrParam[0] = eval(obj.binddataset).getColumn(e.row, "ITEM_CODE");
		var rtnVal = gfn_dialog("FMP00010P"			// dialogId
					   , "U_FMP::FMP00010P.xfdl"		// Url
					   , {fv_Contents:arrParam}					// 배열
					   , null, null, null, null, null, false, true, -1);
	}
	
}




//요일별 창고별 발주 통제 관리 - 개발중
function fn_OrdWeek()
{
	ds_Cond.clearData();
	ds_List.clearData();
	ds_Cond.addRow();
    ds_Cond.setColumn(0, "SUBINV_CODE", cbo_Subinv.value);
	ds_Cond.setColumn(0, "UPJANG",      ed_Upjang.userdata);
	
	// 조회	
	
	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	// 경로 설정
	strSvcID = "FMP00031E_T001";
	strURL   = "U_svc::" + "fm/fmp/FMP00080E_T005.jsp";
	// 데이터셋 설정
	strInDatasets  = "ds_Cond=ds_Cond";
	strOutDatasets = "ds_List=ds_List";
	// 파라메터 설정
	strArgument  = "g_Upjang=" + wrapQuote(g_Upjang);
	strArgument += " g_EmpNo=" + wrapQuote(g_EmpNo);
	// 콜백함수 지정
	strCallbackFunc = "fn_CallBack_Search";
	// 서버 호출 
	//Transaction(strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc);
}

function Button00_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_OrdWeek();
}

function me_NeedDate_ontextchanged(obj:MaskEdit,  e:TextChangedEventInfo)
{
	
}



function fn_isHoliday(sDate)
{
	var i;
	var aHolidays;
	
	aHolidays = gfn_getHolidays(parseInt(gfn_today().substr(0,4), 10));

	for( i = 0 ; i < aHolidays.length ; i++ )
	{
		if( aHolidays[i].substr(0,8) == sDate )
			return aHolidays[i].substr(8);
	}

	return "";	
}

/*
       <달력 포커스 및 조회 총정리>     2015.12.19 박용대

1. 숫자 입력 후 탭이동 : me_NeedDate_canchange -> me_NeedDate_onkillfocus
                           (fn_search())            (fn_search()) 
                           (색적용)

2. 숫자 입력 후 엔터   : me_NeedDate_onkeydown -> me_NeedDate_onkillfocus
						   (색적용)      			(fn_search()) 

3. 달력컴포넌트를 사용 : me_NeedDate_canchange
						   (fn_search())
						   (색적용)
						   
※ 구조상 탭이동은 조회가 두번 겹칠수 밖에 없음. 2,3번의 케이스가 훨신 많기 때문에 1번은 무시함
※ mi->xplatform으로 바뀌면서 onchanged 이벤트가 canchange 이벤트로 바뀌면서 obj를 제대로 못가져옴. 강제셋팅
*/

function me_NeedDate_onkeydown(obj:MaskEdit, e:KeyEventInfo)
{
	if (e.keycode == 13) 
	{
		//trace("me_NeedDate_onkeydown");
		g_Date_OnKillFocus(obj); 
	
		//초기화
		//	me_Pdate.Value = "";
		//	ed_Pcnt.Text = "";
		//	ed_Pamt.Text = "";
		ds_List.clearData();
		//최종 발주정보
		//fn_GetLastOrd();
		//디데이
		fn_GetDays();
		//날짜변경
		st_Week.text = "(" + ffn_DayToWeek(me_NeedDate.value) + ")";
		
		//날짜색변경
		if (st_Week.text == "(토)")
			st_Week.style.color = "blue";
		else if (st_Week.text == "(일)")
			st_Week.style.color = "red";
		else
			st_Week.style.color = "black";
		//공휴일색변경	
		if(gfn_length(fn_isHoliday(me_NeedDate.value))>0)
		{
			st_Week.style.color = "red";
		}
	}
}


function me_NeedDate_onkillfocus(obj:MaskEdit, e:KillFocusEventInfo)
{
	//trace("me_NeedDate_onkillfocus");
	//변경되면 포커스를 잃고 글로벌 함수 실행(여기서 글자수를 체크하여 제대로 된 데이터 넘김)
	g_Date_OnKillFocus(obj);
	
	//변경된 사항이 있는지 확인
	if(gfn_dsIsUpdated(ds_List)==true)
	{
		g_Message("EE","변경된 내역이 있습니다. 저장해 주십시요");
		//me_NeedDate.value = pre_need_date;	//변경전의 날짜를 되돌림
		return;
	}else{
		// 상단그리드 초기화
		fn_setInitForm();
		fn_search();
	}
}


function me_NeedDate_canchange(obj:MaskEdit,  e:ChangeEventInfo)
{
	//trace("me_NeedDate_canchange");
	
	//날짜변경
	st_Week.text = "(" + ffn_DayToWeek(me_NeedDate.value) + ")";
	//날짜색변경

	if (st_Week.text == "(토)")
		st_Week.style.color = "blue";
	else if (st_Week.text == "(일)")
		st_Week.style.color = "red";
	else
		st_Week.style.color = "black";
	//공휴일색변경	
	if(gfn_length(fn_isHoliday(me_NeedDate.value))>0)
	{
		st_Week.style.color = "red";
	}

	
	//변경되면 포커스를 잃고 글로벌 함수 실행(여기서 글자수를 체크하여 제대로 된 데이터 넘김)
	//g_Date_OnKillFocus(me_NeedDate);
		
	//변경된 사항이 있는지 확인
	if(gfn_dsIsUpdated(ds_List)==true)
	{
		//g_Message("EE","변경된 내역이 있습니다. 저장해 주십시요");
		var retValue = gfn_confirm("confirm.before.search");	// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
 		if (retValue == true) {		
			fn_setInitForm();
			fn_search();
			return true;
 		} else {			
			//2017.10.13 김호석 추가 입고일자 변경 전으로 되돌림
			me_NeedDate.value = pre_need_date_temp;	//변경전의 날짜를 되돌림
			//날짜변경
			st_Week.text = "(" + ffn_DayToWeek(me_NeedDate.value) + ")";
			//날짜색변경

			if (st_Week.text == "(토)")
				st_Week.style.color = "blue";
			else if (st_Week.text == "(일)")
				st_Week.style.color = "red";
			else
				st_Week.style.color = "black";
			//공휴일색변경	
			if(gfn_length(fn_isHoliday(me_NeedDate.value))>0)
			{
				st_Week.style.color = "red";
			}
			return false;
 		}
 		//날짜변경
		st_Week.text = "(" + ffn_DayToWeek(me_NeedDate.value) + ")";
		//날짜색변경

		if (st_Week.text == "(토)")
			st_Week.style.color = "blue";
		else if (st_Week.text == "(일)")
			st_Week.style.color = "red";
		else
			st_Week.style.color = "black";
		//공휴일색변경	
		if(gfn_length(fn_isHoliday(me_NeedDate.value))>0)
		{
			st_Week.style.color = "red";
		}
		me_NeedDate.value = pre_need_date_temp;	//변경전의 날짜를 되돌림
		return false;
	}else{
		// 상단그리드 초기화	
		fn_setInitForm();
		fn_search();
		return true;
	}

}


function sp_line_onmove(obj:Splitter, e:MoveEventInfo)
{
	Image1.position.top = e.y + 22;
	Image1.position.height = 15;
	Image2.position.top = e.y + 22;
	Image2.position.height = 15;
	Image3.position.top = e.y + 22;
	Image3.position.height = 15;
	Static4.position.top = e.y + 24;
	Static4.position.height = 12;
	Static5.position.top = e.y + 24;
	Static5.position.height = 12;
	Static7.position.top = e.y + 24;
	Static7.position.height = 12;
	Static9.position.top = e.y + 24;
	Static9.position.height = 12;
	
	Static14.position.top = e.y + 16;
	Static14.position.height = 27;
	
	Static2.position.top = e.y + 56;
	Static2.position.height = 18;
	Static44.position.top = e.y + 56;
	Static44.position.height = 15;
	
	gd_list.position.top = e.y + 74;	
}


function tab_list_tab1_ed_Item_onsetfocus(obj:Edit, e:SetFocusEventInfo) {
	tab_list.tab1.btn_tooltip.visible = true;
}

function tab_list_tab1_ed_Item_onkillfocus(obj:Edit, e:KillFocusEventInfo) {
	tab_list.tab1.btn_tooltip.visible = false;
}


function fn_isOverQty(obj:Dataset, e:DSColChangeEventInfo) {
	var maxQty = toNumber(obj.getColumn(e.row, "MAX_ORD_QTY"));
	if ( maxQty == 0 ) {	// MAX_ORD_QTY == 0 이면 발주수량제한 없음
		return false;
	}
	var itemCd = obj.getColumn(e.row, "ITEM_CODE");
	var nSum = toNumber(obj.getCaseSum("ITEM_CODE == '" + itemCd +"'", "PR_QTY"));
	var nReal = nSum-toNumber(e.oldvalue)+toNumber(e.newvalue);
	
	return (maxQty < nReal);
}


// fn_checkExceptCredit = true [ 예외(ex.예림푸드) ]
function fn_checkExceptCredit() {

	var strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc;
	
	if ( gfn_isNull(ed_Upjang.userdata) ) {
		g_Message("EE","업장정보가 없습니다.");
		return;
	}
	
	strSvcID = "FMP00080E_T003_2";
	strURL   = "U_svc::" + "fm/fmp/FMP00080E_T003_2.jsp";
	strOutDatasets = "ds_checkExceptCredit=ds_checkExceptCredit"
	strArgument  = "upjang=" + wrapQuote(ed_Upjang.userdata);
	
	jsp_transaction(this, strSvcID, strURL, strInDatasets, strOutDatasets, strArgument, strCallbackFunc, false, false, true);
	
	if ( ds_checkExceptCredit.rowcount == 0 ) {
		return false;
	} else {
		return (ds_checkExceptCredit.getColumn(0, "EXCEPT_YN") == "Y");
	}
}

function fn_checkResource(sResource) {
	/*
	var rtn = application.afrm_Bottom.form.fn_isSameResource(sResource, true);
	for ( var p in rtn ) {
		trace(p+"="+rtn[p]);
	}
	*/
	return (application.afrm_Bottom.form.fn_isSameResource(sResource, true).result);
}

function fn_checkLineStatus(flag) {

	fv_chkMsg = "";
	ds_msg.clearData();
	var checkDs = fn_search(true);
	for ( var k=0; k<ds_List.rowcount; k++ ) {
		var nRowType = ds_List.getRowType(k);
		var strExpr = "PR_ID == '" + ds_List.getColumn(k, "PR_ID")+ "'";
			strExpr += " && PR_NUM == '" + ds_List.getColumn(k, "PR_NUM") + "'";
			strExpr += " && ITEM_CODE == '" + ds_List.getColumn(k, "ITEM_CODE") + "'";
		var nRow1 = ds_List.findRowExpr(strExpr);
		var nRow2 = checkDs.findRowExpr(strExpr);
		
		var sLine1 = ds_List.getColumn(nRow1, "PO_LINE_STATUS");
		var sLine2 = checkDs.getColumn(nRow2, "PO_LINE_STATUS");
		//trace(strExpr);
		//trace(nRow1+"||"+nRow2+"||"+sLine1+"||"+sLine2);
		//if ( nRowType == Dataset.ROWTYPE_UPDATE ) {
			if ( nRow1 != -1 && nRow2 != -1 ) {
				if ( sLine1 != sLine2 ) {
					ds_List.updatecontrol = false;
					ds_List.setColumn(nRow1, "PR_QTY", ds_List.getOrgColumn(nRow1, "PR_QTY"));
					ds_List.setColumn(nRow1, "PR_REMARK", ds_List.getOrgColumn(nRow1, "PR_REMARK"));
					ds_List.setColumn(nRow1, "PO_LINE_STATUS", checkDs.getColumn(nRow2, "PO_LINE_STATUS"));
					ds_List.setColumn(nRow1, "CLS_STATUS", "마감");
					ds_List.setRowType(nRow1, Dataset.ROWTYPE_NORMAL);	// for skip save
					//return ("["+ds_List.getColumn(nRow1, "ITEM_NAME")+"] 상품의 발주상태가 " + checkDs.getColumn(nRow2, "PO_LINE_STATUS") +"로 변경되어 해당 내용을 수정할 수 없습니다.");
					fv_chkMsg = "["+ds_List.getColumn(nRow1, "ITEM_CODE")+":"+ds_List.getColumn(nRow1, "ITEM_NAME")+"] 상품의 발주상태가 [" + checkDs.getColumn(nRow2, "PO_LINE_STATUS") +"]로 변경되어 해당 내용을 수정할 수 없습니다.";
					var nRow = ds_msg.addRow();
					ds_msg.setColumn(nRow, "NO", nRow);
					ds_msg.setColumn(nRow, "TYPE", "I");
					ds_msg.setColumn(nRow, "MSG", fv_chkMsg);
					ds_List.updatecontrol = true;
				}
			}
		//}
	}

	// cache check
	/******
	if ( fn_checkResource("xui/mform/fm/fmp/FMP00080E.xfdl") == false ) {
		var nRow2 = ds_msg.addRow();
		ds_msg.setColumn(nRow2, "NO", nRow2);
		ds_msg.setColumn(nRow2, "TYPE", "N");
		ds_msg.setColumn(nRow2, "MSG", "상품발주 프로그램이 업데이트되었습니다. \r\n업데이트 내용을 적용하기 위해 해당 화면을 자동으로 재시작합니다.");
	}
	*****/
	
	if ( !gfn_dsIsUpdated(ds_List) ) {
		if ( !gfn_isNull(flag) ) {
			if ( flag == "delete" ) {
				return fv_chkMsg;
			} else {
				return "주문한 자재의 발주상태가 변경되어 수정할 수 없습니다.\r\n발주내역을 다시 조회하여 상태를 확인하시기바랍니다.";
			}
		} else {
			return "주문한 자재의 발주상태가 변경되어 수정할 수 없습니다.\r\n발주내역을 다시 조회하여 상태를 확인하시기바랍니다.";
		}
	}
}

function fn_getBudgetInfo() {
	/*
	ds_search.setColumn(0, "schMainUpjang", "");
	ds_search.setColumn(0, "schUpjang", ed_Upjang.userdata);
	ds_search.setColumn(0, "schTotYn", "0");
	ds_search.setColumn(0, "schStdDt", me_NeedDate.value);
	
	var strSvcID    = "searchBudget";
    var strURL      = "hwfs_svc/fm/fmo/FMO00420E_T001.jsp";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_budget=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
    */
    
	var strSvcID    = "searchBudget";
	var strURL      = "sc/cmn/introFrame/selectBudgetList.xdo";
	var strInDs     = "";
	var strOutDs    = "ds_budget=ds_budgetList";
	var strArg      = "upjang=" + g_Upjang;
		strArg		+= " mainUpjang=" + g_Main_Upjang;
		strArg		+= " uKey=" + gfn_encProc(g_Upjang+gfn_today());
	var strCallback = "fn_callBack";
	var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

function fn_callBack(strSvcID, nErrorCode, strErrorMsg) {
	if ( nErrorCode < 0 ) {
		return;
	}
	
    switch ( strSvcID ) {
		case "searchBudget" :
			if ( ds_budget.rowcount > 0 ) {
				if ( st_Bond.visible && !st_Credit.visible) {
					st_budget.position.x = st_Credit.position.x;
					ed_budget.position.x = ed_Credit.position.x;
				} else if ( !st_Bond.visible && st_Credit.visible ) {
					st_budget.position.x = st_Bond.position.x;
					ed_budget.position.x = ed_Bond.position.x;
				} else if ( !st_Bond.visible && !st_Credit.visible ) {
					st_budget.position.x = st_Credit.position.x;
					ed_budget.position.x = ed_Credit.position.x;
				} else {
					
				}
				
				st_budget.visible = true;
				ed_budget.visible = true;
			} else {
				st_budget.visible = false;
				ed_budget.visible = false;
			}
			
			var budget = ds_budget.lookup("subinvCode", cbo_Subinv.value ,"amt");
				budget = gfn_isNull(budget) ? '' :  gfn_numFormat(budget) + " 원";
			ed_budget.value = budget;	
			break;
			
		case "searchCtrlList" :
			//trace(ds_ctrlList.saveXML());
			
			/*
			if ( ds_ctrlList.lookup("subinvCode", cbo_Subinv.value, "controlYn") == "Y" ) {
				if ( ds_ctrlList.rowcount != 0 ) {
					stc_ctrlAmt.text = "( 전체창고 발주금액 : " + gfn_numFormat(ds_ctrlList.getSum("poAmt")) + "원 )";
				}
				switch ( ds_ctrlList.lookup("subinvCode", cbo_Subinv.value, "chkSave") ) {
					case "Y" :
						stc_ctrlAmt.style.color = "#444444ff";
						stc_ctrlAmt.visible = true;
						break;
						
					case "N" :
						stc_ctrlAmt.style.color = "red";
						stc_ctrlAmt.visible = true;
						break;
						
					default : 
						stc_ctrlAmt.visible = false;
						break;
					
				}
				break;
			}
			*/
			stc_ctrlAmt.visible = false;
			if ( ds_ctrlList.rowcount != 0 && ds_ctrlList.getCaseCount("controlYn == 'Y'") > 0 ) {
				stc_ctrlAmt.text = "( 전체창고 발주금액 : " + gfn_numFormat(ds_ctrlList.getSum("subinvAmt")) + "원 )";
				 
				switch ( ds_ctrlList.lookup("subinvCode", cbo_Subinv.value, "chkSave") ) {
					case "Y" :
						stc_ctrlAmt.style.color = "#444444ff";
						stc_ctrlAmt.visible = true;
						break;
						
					case "N" :
						stc_ctrlAmt.style.color = "red";
						stc_ctrlAmt.visible = true;
						break;
						
					default : 
						stc_ctrlAmt.visible = false;
						break;
					
				}
				
				var rtnAmt = fn_getOrderStatus();	
				if ( rtnAmt.ctrlAmt > rtnAmt.poAmt ) {
					st_ctrlAmt.text = " 발주가능금액 " + gfn_numFormat(rtnAmt.ctrlAmt - rtnAmt.poAmt) + "원 부족";
					st_ctrlAmt.visible = true;
				}
			}
				
		default :
			break;
    }
}

function st_budget_onclick(obj:Static,  e:ClickEventInfo) {
	//fn_getBudgetInfo();
	var menuId = "";
	switch ( gv_runMode ) {
		case "L" :
		case "D" :
			menuId = "3249";
			break;
		case "S" :
			menuId = "3252";
			break;
		default :
			menuId = "3252";
			break;
	}
	gfn_openMenu(menuId, "");
}


function fn_getOrderCtrlList() {
	
	var strSvcID    = "searchCtrlList";
	var strURL      = "fm/fms/smallOrderCtrlMgnt/selectCtrlList.xdo";
	var strInDs     = "";
	var strOutDs    = "ds_ctrlList=ds_ctrlList";
	var strArg      = "upjang=" + ed_Upjang.userdata;
		strArg		+= " needDate=" + me_NeedDate.value;
		strArg		+= " uKey=" + gfn_encProc(g_Upjang+gfn_today());
	var strCallback = "fn_callBack";
	var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

function fn_getOrderStatus(pSource) {
	
	switch ( ds_ctrlList.lookup("subinvCode", cbo_Subinv.value, "chkSave") ) {
		case "Y" :
			if ( pSource != "recheck" ) {
				return {'poAmt': 0, 'ctrlAmt' : -1};
			}
			break;
			
		case "N" :
				//return {'poAmt': 0, 'ctrlAmt' : -1};
			break;
			
		default : 
			break;
			
	}
	
	var poAmt = toNumber(ds_List.getCaseSum("PR_QTY > 0 && TAX_CODE == '100'", "OP_AMOUNT")) * 1.1
				+ toNumber(ds_List.getCaseSum("PR_QTY > 0 && TAX_CODE != '100'", "OP_AMOUNT")) * 1
				//+ toNumber(ds_ctrlList.getSum("subinvAmt"))
				+ toNumber(ds_ctrlList.getCaseSum("subinvCode != '" + cbo_Subinv.value + "'", "subinvAmt" ))
				//+ toNumber(ds_ctrlList.lookup("subinvCode", cbo_Subinv.value, "nonCtrlAmt"));
	var ctrlAmt = toNumber(ds_ctrlList.lookup("subinvCode", cbo_Subinv.value, "controlAmt"));
	
	return {'poAmt': Math.round(poAmt), 'ctrlAmt' : ctrlAmt};
}]]></Script>
  </Form>
</FDL>

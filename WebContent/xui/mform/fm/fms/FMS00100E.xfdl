<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="FMS00100E" onload="form_onload" titletext="매출처 정보관리" position="absolute 0 0 1252 725" scrollbars="autoboth">
    <Layouts>
      <Layout>
        <Grid autoenter="select" binddataset="ds_list" cellsizingtype="col" readonly="false" enable="true" id="grd_list" useinputpanel="false" oncellclick="grd_list_OnCellClick" onheadclick="grd_List_OnHeadClick" taborder="4" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 256 539 708" selecttype="row" anchor="all" onkeydown="grd_list_onkeydown" autofittype="none" cellmovingtype="col">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="25"/>
                <Column size="40"/>
                <Column size="45"/>
                <Column size="80"/>
                <Column size="110"/>
                <Column size="86"/>
                <Column size="29"/>
                <Column size="89"/>
                <Column size="80"/>
                <Column size="70"/>
                <Column size="100"/>
                <Column size="70"/>
                <Column size="100"/>
                <Column size="128"/>
                <Column size="146"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="102"/>
                <Column size="109"/>
                <Column size="86"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="110"/>
                <Column size="110"/>
                <Column size="110"/>
                <Column size="110"/>
                <Column size="110"/>
                <Column size="140"/>
                <Column size="100"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="구분"/>
                <Cell col="2" displaytype="text" text="코드"/>
                <Cell col="3" displaytype="text" text="본사명"/>
                <Cell col="4" displaytype="text" text="사업장명"/>
                <Cell col="5" displaytype="text" text="고객"/>
                <Cell col="6" displaytype="text" text="사용"/>
                <Cell col="7" text="센터"/>
                <Cell col="8" displaytype="text" text="사업자번호"/>
                <Cell col="9" displaytype="text" text="영업사원"/>
                <Cell col="10" displaytype="text" text="영업 전화번호"/>
                <Cell col="11" displaytype="text" text="C/S사원"/>
                <Cell col="12" displaytype="text" text="C/S 전화번호"/>
                <Cell col="13" displaytype="text" text="영업부서"/>
                <Cell col="14" displaytype="text" text="BO관리부서"/>
                <Cell col="15" text="사업군"/>
                <Cell col="16" text="직군"/>
                <Cell col="17" displaytype="text" text="파트"/>
                <Cell col="18" text="세부직군"/>
                <Cell col="19" text="계약시작일"/>
                <Cell col="20" text="거래처코드"/>
                <Cell col="21" text="거래처명"/>
                <Cell col="22" displaytype="text" text="부가세업장"/>
                <Cell col="23" text="POP배송여부"/>
                <Cell col="24" text="발행부수"/>
                <Cell col="25" text="LEVEL0 경로"/>
                <Cell col="26" displaytype="text" text="LEVEL1 운영형태"/>
                <Cell col="27" displaytype="text" text="LEVEL2 업태구분"/>
                <Cell col="28" displaytype="text" text="LEVEL3 세부업태"/>
                <Cell col="29" displaytype="text" text="LEVEL4 유저/상품"/>
                <Cell col="30" text="시스템인터페이스"/>
                <Cell col="31" text="반환가능여부"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:UPJANG_TYPE" combodataset="ds_Gbn" combocodecol="CD" combodatacol="NM"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:UPJANG"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:MAIN_UPJANG_NM"/>
                <Cell col="4" displaytype="text" style="align:left;" text="bind:UPJANG_NM"/>
                <Cell col="5" displaytype="text" style="align:center;" text="bind:CUST_TYPE"/>
                <Cell col="6" displaytype="text" style="align:center;" text="bind:USE_YN"/>
                <Cell col="7" displaytype="text" text="bind:CENTER_NAME"/>
                <Cell col="8" displaytype="text" style="align:center;" text="bind:SAUPNO"/>
                <Cell col="9" displaytype="text" style="align:left;" text="bind:PART_SALES_SABUN_NM"/>
                <Cell col="10" displaytype="text" style="align:left;" text="bind:PART_SALES_TEL_NO"/>
                <Cell col="11" displaytype="text" style="align:left;" text="bind:CS_SABUN_NM"/>
                <Cell col="12" displaytype="text" style="align:left;" text="bind:CS_TEL_NO"/>
                <Cell col="13" displaytype="text" style="align:left;" text="bind:CC_NM"/>
                <Cell col="14" displaytype="text" style="align:left;" text="bind:BO_DEPT_ID"/>
                <Cell col="15" displaytype="text" text="bind:BIZ_KIND_NAME"/>
                <Cell col="16" displaytype="text" text="bind:BIZ_GROUP_NAME"/>
                <Cell col="17" displaytype="text" style="align:left;" text="bind:PART_CODE_NAME"/>
                <Cell col="18" displaytype="text" text="bind:BIZ_DETAIL_NAME"/>
                <Cell col="19" displaytype="text" style="align:center middle;" text="bind:CONTRACT_TERM" mask="@@@@-@@-@@"/>
                <Cell col="20" displaytype="text" style="align:center middle;" text="bind:CUSTCD"/>
                <Cell col="21" displaytype="text" text="bind:CUSTNM"/>
                <Cell col="22" displaytype="text" style="align:left;" text="bind:BO_VAT_UPJANG"/>
                <Cell col="23" text="bind:POP_REQ_YN"/>
                <Cell col="24" displaytype="number" text="bind:POP_CNT"/>
                <Cell col="25" text="bind:MASTERCLASS0"/>
                <Cell col="26" displaytype="text" text="bind:MASTERCLASS1"/>
                <Cell col="27" displaytype="text" text="bind:MASTERCLASS2"/>
                <Cell col="28" displaytype="text" text="bind:MASTERCLASS3"/>
                <Cell col="29" displaytype="text" text="bind:MASTERCLASS4"/>
                <Cell col="30" text="bind:INTERFACE_ATTR01"/>
                <Cell col="31" displaytype="text" style="align:center;" text="bind:RTN_YN"/>
              </Band>
            </Format>
            <Format id="excel">
              <Columns>
                <Column size="25"/>
                <Column size="40"/>
                <Column size="45"/>
                <Column size="80"/>
                <Column size="110"/>
                <Column size="86"/>
                <Column size="29"/>
                <Column size="89"/>
                <Column size="80"/>
                <Column size="70"/>
                <Column size="70"/>
                <Column size="128"/>
                <Column size="146"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="102"/>
                <Column size="109"/>
                <Column size="86"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="89"/>
                <Column size="121"/>
                <Column size="113"/>
                <Column size="116"/>
                <Column size="134"/>
                <Column size="140"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="text" class="head_Excel"/>
                <Cell col="1" displaytype="text" text="구분"/>
                <Cell col="2" displaytype="text" text="코드"/>
                <Cell col="3" displaytype="text" text="본사명"/>
                <Cell col="4" displaytype="text" text="사업장명"/>
                <Cell col="5" displaytype="text" text="고객"/>
                <Cell col="6" displaytype="text" text="사용"/>
                <Cell col="7" text="센터"/>
                <Cell col="8" displaytype="text" text="사업자번호"/>
                <Cell col="9" displaytype="text" text="영업사원"/>
                <Cell col="10" displaytype="text" text="C/S사원"/>
                <Cell col="11" displaytype="text" text="영업부서"/>
                <Cell col="12" displaytype="text" text="BO관리부서"/>
                <Cell col="13" text="사업군"/>
                <Cell col="14" text="직군"/>
                <Cell col="15" displaytype="text" text="파트"/>
                <Cell col="16" text="세부직군"/>
                <Cell col="17" text="계약시작일"/>
                <Cell col="18" text="거래처코드"/>
                <Cell col="19" text="거래처명"/>
                <Cell col="20" displaytype="text" text="부가세업장"/>
                <Cell col="21" text="POP배송여부"/>
                <Cell col="22" text="발행부수"/>
                <Cell col="23" displaytype="text" text="LEVEL0 경로"/>
                <Cell col="24" displaytype="text" text="LEVEL1 운영형태"/>
                <Cell col="25" displaytype="text" text="LEVEL2 업태구분"/>
                <Cell col="26" displaytype="text" text="LEVEL3 세부업태"/>
                <Cell col="27" displaytype="text" text="LEVEL4 유저/상품"/>
                <Cell col="28" text="시스템인터페이스"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:left;" text="bind:UPJANG_TYPE" combodataset="ds_Gbn" combocodecol="CD" combodatacol="NM"/>
                <Cell col="2" displaytype="text" style="align:left;" text="bind:UPJANG"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:MAIN_UPJANG_NM"/>
                <Cell col="4" displaytype="text" style="align:left;" text="bind:UPJANG_NM"/>
                <Cell col="5" displaytype="text" style="align:center;" text="bind:CUST_TYPE"/>
                <Cell col="6" displaytype="text" style="align:center;" text="bind:USE_YN"/>
                <Cell col="7" displaytype="text" text="bind:CENTER_NAME"/>
                <Cell col="8" displaytype="text" style="align:center;" text="bind:SAUPNO"/>
                <Cell col="9" displaytype="text" style="align:left;" text="bind:PART_SALES_SABUN_NM"/>
                <Cell col="10" displaytype="text" style="align:left;" text="bind:CS_SABUN_NM"/>
                <Cell col="11" displaytype="text" style="align:left;" text="bind:CC_NM"/>
                <Cell col="12" displaytype="text" style="align:left;" text="bind:BO_DEPT_ID"/>
                <Cell col="13" displaytype="text" text="bind:BIZ_KIND_NAME"/>
                <Cell col="14" displaytype="text" text="bind:BIZ_GROUP_NAME"/>
                <Cell col="15" displaytype="text" style="align:left;" text="bind:PART_CODE_NAME"/>
                <Cell col="16" displaytype="text" text="bind:BIZ_DETAIL_NAME"/>
                <Cell col="17" displaytype="text" style="align:center middle;" text="bind:CONTRACT_TERM" mask="@@@@-@@-@@"/>
                <Cell col="18" displaytype="text" style="align:center middle;" text="bind:CUSTCD"/>
                <Cell col="19" displaytype="text" text="bind:CUSTNM"/>
                <Cell col="20" displaytype="text" style="align:left;" text="bind:BO_VAT_UPJANG"/>
                <Cell col="21" text="bind:POP_REQ_YN"/>
                <Cell col="22" displaytype="number" text="bind:POP_CNT"/>
                <Cell col="23" displaytype="text" text="bind:MASTERCLASS0"/>
                <Cell col="24" displaytype="text" text="bind:MASTERCLASS1"/>
                <Cell col="25" displaytype="text" text="bind:MASTERCLASS2"/>
                <Cell col="26" displaytype="text" text="bind:MASTERCLASS3"/>
                <Cell col="27" displaytype="text" text="bind:MASTERCLASS4"/>
                <Cell col="28" text="bind:INTERFACE_ATTR01"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Div id="div_cmnBtn" taborder="7" text="Div0" url="cmn::CmnBtn.xfdl" position="absolute 0 0 1236 30" anchor="left top right" scrollbars="none"/>
        <Tab id="tab_list" preload="true" taborder="5" position="absolute 550 61 1238 710" showextrabutton="false" anchor="top right bottom">
          <Tabpages>
            <Tabpage id="tab1" taborder="1" text="기본관리" url="U_FMS::FMS00101E.xfdl" position="absolute 2 24 594 577" scrollbars="autovert"/>
            <Tabpage id="tab2" taborder="5" text="설정관리" url="U_FMS::FMS00102E.xfdl" position="absolute 2 24 594 577" scrollbars="autovert"/>
            <Tabpage id="tab3" taborder="5" text="채권/여신관리" url="U_FMS::FMS00103E.xfdl" position="absolute 2 24 594 577" scrollbars="none"/>
          </Tabpages>
        </Tab>
        <Button enable="false" id="btn_Copy" onclick="btn_Copy_OnClick" taborder="6" text="불러오기" visible="false" position="absolute 1169 61 1234 82" class="btn_WF_Custom" image="" anchor="top right"/>
        <Static id="Static7" text="매출처 상세정보 조회" position="absolute 550 43 737 61" class="sta_WF_Title01" anchor="top right"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 30 280 43"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1217 725" anchor="left bottom"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <MPFileDialog id="fileDialog" taborder="24" visible="false" position="absolute 546 0 570 24" FileName="" FileNameList="" FilePath="" UserData="" MultiSelect="false" Filter="All image files|*.bmp; *.jpg; *.jpeg; *.jpe; *.jfif; *.gif|Bitmap (.BMP)|*.bmp|JPEG (*.JPG;*.JPEG;*.JPE;*.JFIF)|*.jpg; *.jpeg; *.jpe; *.jfif|GIF (.GIF)|*.gif|" FilterIndex="0" AppendExtDefault="false" Type="Open" FileSize=""/>
        <MPFileDialog id="FileDialogSave" taborder="25" onclick="fileDialog1_onclick" visible="false" position="absolute 606 3 630 27" FileName="" FileNameList="" FilePath="" UserData="" MultiSelect="false" Filter="" FilterIndex="0" AppendExtDefault="false" Type="save" FileSize=""/>
        <Div id="div_mainSearch" taborder="37" position="absolute -1 40 542 237" anchor="left top right">
          <Layouts>
            <Layout width="543" height="279">
              <Static id="sta_detail01" class="sta_WFDA_Labelbg" position="absolute 95 73 540 118" anchor="left top right"/>
              <Static id="sta_detail02" class="sta_WFDA_Labelbg" position="absolute 94 117 540 144" anchor="left top right"/>
              <Static id="sta_detail03" class="sta_WFDA_Labelbg" position="absolute 94 142 540 169" anchor="left top right" onclick="div_mainSearch_sta_detail03_onclick"/>
              <Static id="Static02" text="본사" class="sta_WFDA_Label01" position="absolute 1 21 95 48" anchor="default"/>
              <Static id="Static3" text="사업장" class="sta_WFDA_Label01" position="absolute 1 47 95 74" anchor="default"/>
              <Static id="Static4" text="고객구분" class="sta_WFDA_Label01" position="absolute 1 117 95 144" anchor="default"/>
              <Radio id="rdo_CUST_TYPE" taborder="9" innerdataset="ds_CustType" codecolumn="CODE" datacolumn="CODE_NAME" onitemclick="rdo_CUST_TYPE_onitemclick" position="absolute 97 121 533 142" style="textpadding:0 12 0 5;" anchor="default" columncount="-1" rowcount="-1"/>
              <Static id="Static0" text="사용여부" class="sta_WFDA_Label01" position="absolute 1 142 95 169" anchor="default" onclick="div_mainSearch_Static0_onclick"/>
              <Combo id="cbo_UseYN" taborder="10" text="전체" innerdataset="ds_Use" codecolumn="CODE" datacolumn="code_name" index="0" position="absolute 97 145 178 166" anchor="default"/>
              <Static id="sta_detail04" class="sta_WFDA_Labelbg" position="absolute 94 47 540 74" anchor="left top right" onclick="div_mainSearch_sta_detail04_onclick"/>
              <Static id="sta_detail05" class="sta_WFDA_Labelbg" position="absolute 94 21 540 48" anchor="left top right"/>
              <Edit id="ed_S_MAIN_UPJANG" taborder="0" autoselect="true" onkeydown="ed_S_UPJANG_onkeydown" oneditclick="ed_S_MAIN_UPJANG_oneditclick" onchar="sed_common_OnChar" position="absolute 97 24 278 45" anchor="default" imemode="hangul"/>
              <Edit id="ed_S_UPJANG" taborder="2" autoselect="true" onkeydown="ed_S_UPJANG_onkeydown" onchar="sed_common_OnChar" position="absolute 97 50 278 71" anchor="default" imemode="hangul"/>
              <Edit id="ed_S_UPJANG_NM" taborder="13" onchar="sed_common_OnChar" visible="false" position="absolute 200 50 275 71" anchor="default"/>
              <Edit id="ed_S_MAIN_UPJANG_NM" taborder="14" onchar="sed_common_OnChar" visible="false" position="absolute 198 24 273 46" anchor="default"/>
              <Static id="Static5" text="사업자번호" class="sta_WFDA_Label01" position="absolute 280 21 385 48" anchor="default"/>
              <Edit id="ed_S_SAUPNO" taborder="1" inputtype="number" autoselect="true" onchar="sed_common_OnChar" position="absolute 387 24 492 45" anchor="default"/>
              <Static id="Static1" text="사원명" class="sta_WFDA_Label01" position="absolute 280 142 347 169" anchor="default"/>
              <Edit id="ed_empNm" taborder="11" autoselect="true" position="absolute 349 145 492 166" anchor="default" onkeydown="div_mainSearch_ed_empNm_onkeydown"/>
              <Static id="Static2" text="매출처 목록조회" class="sta_WF_Title01" position="absolute 1 3 124 21" anchor="default"/>
              <Static id="Static6" text="(본사명 클릭 시 본사의 상세정보 조회)" position="absolute 119 4 543 17" anchor="default"/>
              <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 16 540 21" anchor="default"/>
              <Static id="Static07" text="전화번호" class="sta_WFDA_Label01" position="absolute 280 47 385 74" visible="true" anchor="default"/>
              <Edit id="ed_S_TEL_NO" taborder="3" inputtype="number" autoselect="true" onchar="sed_common_OnChar" position="absolute 387 50 492 71" visible="true" onkeydown="div_mainSearch_ed_S_TEL_NO_onkeydown" anchor="default"/>
              <Button id="Button00" taborder="15" text="Button00" position="absolute 501 145 535 167" onclick="div_mainSearch_Button00_onclick" visible="false" anchor="default"/>
              <Static id="Static08" text="고객마스터" class="sta_WFDA_Label01" position="absolute 1 73 95 118" style="align:left middle;" onclick="div_mainSearch_Static08_onclick" anchor="default" visible="true"/>
              <Static id="Static09" text="LV0 경로" class="sta_WFDA_Label01" position="absolute 95 73 187 93" anchor="default" visible="true" style="align:center;"/>
              <Static id="Static10" class="sta_WFDA_Label01" position="absolute 187 73 275 93" anchor="default" visible="true" style="align:center;" onclick="div_mainSearch_Static10_onclick" text="LV1 운영형태"/>
              <Static id="Static11" text="LV2 업태구분" class="sta_WFDA_Label01" position="absolute 275 73 362 93" anchor="default" visible="true" style="align:center;"/>
              <Static id="Static12" text="LV3 세부업태" class="sta_WFDA_Label01" position="absolute 362 73 450 93" anchor="default" visible="true" style="align:center;"/>
              <Static id="Static13" text="LV4 유저/상품" class="sta_WFDA_Label01" position="absolute 449 73 540 93" anchor="default" visible="true" style="align:center;"/>
              <Combo id="Cbo_MasterClass0_S" taborder="4" innerdataset="@ds_class0_S" codecolumn="CODE" datacolumn="CODE_NAME" index="-1" position="absolute 95 94 182 115" onitemchanged="Combo_OnChanged" anchor="default" visible="true"/>
              <Combo id="Cbo_MasterClass1_S" taborder="5" innerdataset="@ds_class1_S" codecolumn="CODE" datacolumn="CODE_NAME" onitemchanged="Combo_OnChanged" position="absolute 187 94 270 115" anchor="default" visible="true"/>
              <Combo id="Cbo_MasterClass2_S" taborder="6" innerdataset="@ds_class2_S" codecolumn="CODE" datacolumn="CODE_NAME" onitemchanged="Combo_OnChanged" position="absolute 275 94 357 115" anchor="default" visible="true" style="itemheight:20;"/>
              <Combo id="Cbo_MasterClass3_S" taborder="7" innerdataset="@ds_class3_S" codecolumn="CODE" datacolumn="CODE_NAME" onitemchanged="Combo_OnChanged" position="absolute 362 94 445 115" anchor="default" visible="true"/>
              <Combo id="Cbo_MasterClass4_S" taborder="8" innerdataset="@ds_class4_S" codecolumn="CODE" datacolumn="CODE_NAME" onitemchanged="Combo_OnChanged" position="absolute 449 94 534 115" anchor="default" visible="true"/>
              <Static id="Static14" text="POP배송" class="sta_WFDA_Label01" position="absolute 1 168 95 195" anchor="default"/>
              <Static id="sta_detail00" class="sta_WFDA_Labelbg" position="absolute 94 168 540 195" anchor="left top right"/>
              <Combo id="cbo_pop" taborder="12" text="전체" codecolumn="codecolumn" datacolumn="datacolumn" index="0" position="absolute 97 171 178 192" anchor="default">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn"/>
                      <Col id="datacolumn">전체</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">Y</Col>
                      <Col id="datacolumn">Y</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">N</Col>
                      <Col id="datacolumn">N</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Combo>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static07" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 541 29 551 679"/>
        <Splitter id="Splitter00" position="absolute 542 61 547 708">
          <Formats>
            <Format id="default">
              <SplitterItems id="items">
                <SplitterItem id="item00" bindtype="resize" position="leftortop" offset="0" componentid="div_mainSearch"/>
                <SplitterItem id="item01" bindtype="resize" position="leftortop" offset="0" componentid="grd_list"/>
                <SplitterItem id="item02" bindtype="resize" position="rightorbottom" offset="5" componentid="tab_list"/>
                <SplitterItem id="item03" bindtype="move" position="rightorbottom" offset="5" componentid="Static7"/>
              </SplitterItems>
            </Format>
          </Formats>
        </Splitter>
        <Button id="btn_excel" taborder="38" text="엑셀출력" class="btn_WF_Function" position="absolute 1 235 66 255" onclick="btn_excel_onclick"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_list">
        <ColumnInfo>
          <Column id="CUST_TYPE" size="50" type="STRING"/>
          <Column id="CUSTCD" size="22" type="STRING"/>
          <Column id="M_LEVEL" size="1" type="STRING"/>
          <Column id="MAIN_UPJANG" size="22" type="INT"/>
          <Column id="MAIN_UPJANG_NM" size="50" type="STRING"/>
          <Column id="UPJANG" size="22" type="INT"/>
          <Column id="UPJANG_NM" size="50" type="STRING"/>
          <Column id="UPJANG_TYPE" size="6" type="STRING"/>
          <Column id="SAUPNO" size="50" type="STRING"/>
          <Column id="USE_YN" size="1" type="STRING"/>
          <Column id="DEPT_ID" size="10" type="INT"/>
          <Column id="CC_NM" size="200" type="STRING"/>
          <Column id="BO_DEPT_ID" size="200" type="STRING"/>
          <Column id="BO_VAT_UPJANG" size="200" type="STRING"/>
          <Column id="PART_CODE_NAME" size="256" type="STRING"/>
          <Column id="CUSTNM" type="STRING" size="256"/>
          <Column id="BIZ_KIND_NAME" size="256" type="STRING"/>
          <Column id="BIZ_GROUP_NAME" size="256" type="STRING"/>
          <Column id="BIZ_DETAIL_NAME" size="256" type="STRING"/>
          <Column id="CENTER_NAME" size="256" type="STRING"/>
          <Column id="CONTRACT_TERM" type="STRING" size="256"/>
          <Column id="MASTERCLASS0" type="STRING" size="256"/>
          <Column id="MASTERCLASS1" type="STRING" size="256"/>
          <Column id="MASTERCLASS2" type="STRING" size="256"/>
          <Column id="MASTERCLASS4" type="STRING" size="256"/>
          <Column id="MASTERCLASS3" type="STRING" size="256"/>
          <Column id="POP_REQ_YN" type="STRING" size="256"/>
          <Column id="POP_CNT" type="STRING" size="256"/>
          <Column id="INTERFACE_ATTR01" type="STRING" size="256"/>
          <Column id="RTN_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_input">
        <ColumnInfo>
          <Column id="MAIN_UPJANG" size="256" type="STRING"/>
          <Column id="MAIN_UPJANG_NM" size="256" type="STRING"/>
          <Column id="UPJANG" size="256" type="STRING"/>
          <Column id="UPJANG_NM" size="256" type="STRING"/>
          <Column id="CUST_TYPE" size="256" type="STRING"/>
          <Column id="UJ_UPJANG" size="256" type="STRING"/>
          <Column id="FILEURL" size="256" type="STRING"/>
          <Column id="USE_YN" size="256" type="STRING"/>
          <Column id="EMP_NM" size="256" type="STRING"/>
          <Column id="SAUPNO" size="50" type="STRING"/>
          <Column id="SABUN" type="STRING" size="256"/>
          <Column id="TEL_NO" type="STRING" size="256"/>
          <Column id="MASTERCLASS0_S" type="STRING" size="50"/>
          <Column id="MASTERCLASS1_S" type="STRING" size="50"/>
          <Column id="MASTERCLASS2_S" type="STRING" size="50"/>
          <Column id="MASTERCLASS3_S" type="STRING" size="50"/>
          <Column id="MASTERCLASS4_S" type="STRING" size="50"/>
          <Column id="POP_REQ_YN" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CUST_TYPE"/>
            <Col id="EMP_NM"/>
            <Col id="FILEURL"/>
            <Col id="MAIN_UPJANG"/>
            <Col id="MAIN_UPJANG_NM"/>
            <Col id="UJ_UPJANG"/>
            <Col id="UPJANG"/>
            <Col id="UPJANG_NM"/>
            <Col id="USE_YN"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_useyn">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">Y</Col>
            <Col id="code_name">사용</Col>
          </Row>
          <Row>
            <Col id="CODE">N</Col>
            <Col id="code_name">미사용</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_existYn">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">Y</Col>
            <Col id="CODE_NAME">유</Col>
          </Row>
          <Row>
            <Col id="CODE">N</Col>
            <Col id="CODE_NAME">무</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_CustType">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE"/>
            <Col id="CODE_NAME">전체</Col>
          </Row>
          <Row>
            <Col id="CODE">캐터링</Col>
            <Col id="CODE_NAME">캐터링</Col>
          </Row>
          <Row>
            <Col id="CODE">가맹점</Col>
            <Col id="CODE_NAME">가맹점</Col>
          </Row>
          <Row>
            <Col id="CODE">일반</Col>
            <Col id="CODE_NAME">일반</Col>
          </Row>
          <Row>
            <Col id="CODE">외식(직영)</Col>
            <Col id="CODE_NAME">외식(직영)</Col>
          </Row>
          <Row>
            <Col id="CODE">외식(가맹점)</Col>
            <Col id="CODE_NAME">외식(가맹점)</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_UPJANG_TYPE">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">본사</Col>
            <Col id="code_name">본사</Col>
          </Row>
          <Row>
            <Col id="CODE">사업장</Col>
            <Col id="code_name">사업장</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_PWD_CHG">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">0</Col>
            <Col id="code_name">설정안함</Col>
          </Row>
          <Row>
            <Col id="CODE">15</Col>
            <Col id="code_name">15일</Col>
          </Row>
          <Row>
            <Col id="CODE">30</Col>
            <Col id="code_name">30일</Col>
          </Row>
          <Row>
            <Col id="CODE">60</Col>
            <Col id="code_name">60일</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_OtcustType">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">대표업장</Col>
            <Col id="code_name">대표 사업장</Col>
          </Row>
          <Row>
            <Col id="CODE">대상업장</Col>
            <Col id="code_name">대상 사업장</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_CREDITTYPE">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">관리안함</Col>
            <Col id="code_name">관리안함</Col>
          </Row>
          <Row>
            <Col id="CODE">여신일</Col>
            <Col id="code_name">여신회전일</Col>
          </Row>
          <Row>
            <Col id="CODE">여신액</Col>
            <Col id="code_name">여신액</Col>
          </Row>
          <Row>
            <Col id="CODE">여신일+여신액</Col>
            <Col id="code_name">회전일+여신액</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_FINANCIAL_STATUS">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">안정</Col>
            <Col id="code_name">안정</Col>
          </Row>
          <Row>
            <Col id="CODE">법정관리</Col>
            <Col id="code_name">법정관리</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_RCV_TYPE">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">현금(CMS)</Col>
            <Col id="code_name">현금(CMS)</Col>
          </Row>
          <Row>
            <Col id="CODE">현금(가상계좌)</Col>
            <Col id="code_name">현금(가상계좌)</Col>
          </Row>
          <Row>
            <Col id="CODE">어음</Col>
            <Col id="code_name">어음</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_BizGroup"/>
      <Dataset id="ds_Use">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE"/>
            <Col id="code_name">전체</Col>
          </Row>
          <Row>
            <Col id="CODE">Y</Col>
            <Col id="code_name">사용</Col>
          </Row>
          <Row>
            <Col id="CODE">N</Col>
            <Col id="code_name">미사용</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Excel_Use">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">Y</Col>
            <Col id="CODE_NAME">사용</Col>
          </Row>
          <Row>
            <Col id="CODE">N</Col>
            <Col id="CODE_NAME">미사용</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_BizKind"/>
      <Dataset id="ds_BizDetail"/>
      <Dataset id="ds_PartCode"/>
      <Dataset id="ds_sys_useyn">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">Y</Col>
            <Col id="code_name">사용</Col>
          </Row>
          <Row>
            <Col id="CODE">N</Col>
            <Col id="code_name">미사용</Col>
          </Row>
          <Row>
            <Col id="CODE"/>
            <Col id="code_name">미설정</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Holiday_yn">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="code_name" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">Y</Col>
            <Col id="code_name">반영</Col>
          </Row>
          <Row>
            <Col id="CODE">N</Col>
            <Col id="code_name">미반영</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_OpRate_Yn">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">C</Col>
            <Col id="CODE_NAME">소분류별</Col>
          </Row>
          <Row>
            <Col id="CODE">I</Col>
            <Col id="CODE_NAME">상품별</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_main" oncolumnchanged="ds_main_OnColumnChanged" onrowposchanged="ds_main_OnRowPosChanged" cancolumnchange="ds_main_cancolumnchange">
        <ColumnInfo>
          <Column id="ACNTCD" size="30" prop="default" type="STRING"/>
          <Column id="ADDR" size="300" prop="default" type="STRING"/>
          <Column id="ATTR01" size="300" prop="default" type="STRING"/>
          <Column id="ATTR02" size="300" prop="default" type="STRING"/>
          <Column id="ATTR03" size="300" prop="default" type="STRING"/>
          <Column id="ATTR04" size="300" prop="default" type="STRING"/>
          <Column id="ATTR05" size="300" prop="default" type="STRING"/>
          <Column id="ATTR06" size="300" prop="default" type="STRING"/>
          <Column id="ATTR07" size="300" prop="default" type="STRING"/>
          <Column id="ATTR08" size="300" prop="default" type="STRING"/>
          <Column id="ATTR09" size="300" prop="default" type="STRING"/>
          <Column id="ATTR10" size="300" prop="default" type="STRING"/>
          <Column id="BANK_CD" size="6" prop="default" type="STRING"/>
          <Column id="BANK_DRNM" size="50" prop="default" type="STRING"/>
          <Column id="BIZ_CAT" size="50" prop="default" type="STRING"/>
          <Column id="BIZ_NUM" size="10" prop="default" type="STRING"/>
          <Column id="BIZ_TYPE" size="50" prop="default" type="STRING"/>
          <Column id="CAPITAL" size="22" prop="default" type="INT"/>
          <Column id="CDATE" size="7" prop="default" type="DATE"/>
          <Column id="CENTER_FLAG" size="1" prop="default" type="STRING"/>
          <Column id="CLASS1_CNT" size="22" prop="default" type="INT"/>
          <Column id="CLASS2_CNT" size="22" prop="default" type="INT"/>
          <Column id="CLASS3_CNT" size="22" prop="default" type="INT"/>
          <Column id="CLASS4_CNT" size="22" prop="default" type="INT"/>
          <Column id="CLASS5_CNT" size="22" prop="default" type="INT"/>
          <Column id="CLASS6_CNT" size="22" prop="default" type="INT"/>
          <Column id="CLASS_CNT" size="22" prop="default" type="INT"/>
          <Column id="CONSUM_OP_RATE_YN" size="1" prop="default" type="STRING"/>
          <Column id="CONSUM_SM_RATE_YN" size="1" prop="default" type="STRING"/>
          <Column id="CONT_SALES_SABUN" size="9" prop="default" type="STRING"/>
          <Column id="CONT_SALES_SABUN_NM" size="20" prop="default" type="STRING"/>
          <Column id="CONTRACT_EDATE" size="8" prop="default" type="STRING"/>
          <Column id="CONTRACT_TERM" size="50" prop="default" type="STRING"/>
          <Column id="CREDIT_AMOUNT" size="22" prop="default" type="INT"/>
          <Column id="CREDIT_AMOUNT_CONTROL_YN" size="1" prop="default" type="STRING"/>
          <Column id="CREDIT_CONTROL_YN" size="1" prop="default" type="STRING"/>
          <Column id="CREDIT_END" size="8" prop="default" type="STRING"/>
          <Column id="CREDIT_EXT_AMOUNT" size="22" prop="default" type="INT"/>
          <Column id="CREDIT_EXT_DAYS" size="22" prop="default" type="INT"/>
          <Column id="CREDIT_GRADE" size="50" prop="default" type="STRING"/>
          <Column id="CREDIT_OVER_AMOUNT" size="22" prop="default" type="INT"/>
          <Column id="CREDIT_OVER_END" size="8" prop="default" type="STRING"/>
          <Column id="CREDIT_START" size="8" prop="default" type="STRING"/>
          <Column id="CREDIT_TURN_CONTROL_YN" size="1" prop="default" type="STRING"/>
          <Column id="CREDIT_TURN_DAYS" size="22" prop="default" type="INT"/>
          <Column id="CREDIT_TYPE" size="13" prop="default" type="STRING"/>
          <Column id="CREDIT_UDATE" size="7" prop="default" type="DATE"/>
          <Column id="CREDIT_UUSER" size="9" prop="default" type="STRING"/>
          <Column id="CS_SABUN" size="9" prop="default" type="STRING"/>
          <Column id="CS_SABUN_NM" size="20" prop="default" type="STRING"/>
          <Column id="CS_TEL_NO" size="20" prop="default" type="STRING"/>
          <Column id="CUSER" size="9" prop="default" type="STRING"/>
          <Column id="CUST_ADDR" size="100" prop="default" type="STRING"/>
          <Column id="CUST_NAME" size="50" prop="default" type="STRING"/>
          <Column id="CUST_TYPE" size="50" prop="default" type="STRING"/>
          <Column id="D_DAYS" size="22" prop="default" type="INT"/>
          <Column id="D_OVER_DAYS" size="22" prop="default" type="INT"/>
          <Column id="D_TIMES" size="22" prop="default" type="INT"/>
          <Column id="DEPT_ID" size="22" prop="default" type="INT"/>
          <Column id="DEPT_ID_NM" size="50" prop="default" type="STRING"/>
          <Column id="EMPLOYEE_CNT" size="22" prop="default" type="INT"/>
          <Column id="FINANCIAL_STATUS" size="50" prop="default" type="STRING"/>
          <Column id="FREE_CNT" size="22" prop="default" type="INT"/>
          <Column id="FST_REG_DATE" size="8" prop="default" type="STRING"/>
          <Column id="GUAR_INSUR_INFO" size="300" prop="default" type="STRING"/>
          <Column id="HEAD_CREDIT_YN" size="1" prop="default" type="STRING"/>
          <Column id="LST_DEAL_DATE" size="8" prop="default" type="STRING"/>
          <Column id="M_LEVEL" size="1" prop="default" type="STRING"/>
          <Column id="MAIL_NUM" size="7" prop="default" type="STRING"/>
          <Column id="MAIN_UPJANG" size="22" prop="default" type="INT"/>
          <Column id="MAIN_UPJANG_NM" size="50" prop="default" type="STRING"/>
          <Column id="MORTGAGE_INFO" size="300" prop="default" type="STRING"/>
          <Column id="OP_RATE_YN" size="1" prop="default" type="STRING"/>
          <Column id="OTCUST_OP_RATE_YN" size="1" prop="default" type="STRING"/>
          <Column id="OTCUST_PRICE_UPJANG" size="22" prop="default" type="INT"/>
          <Column id="OTCUST_PRICE_UPJANG_NM" size="50" prop="default" type="STRING"/>
          <Column id="OTCUST_SM_RATE_YN" size="1" prop="default" type="STRING"/>
          <Column id="OTCUST_UPJANG_TYPE" size="8" prop="default" type="STRING"/>
          <Column id="PART_EMAIL" size="20" prop="default" type="STRING"/>
          <Column id="PART_FAX_NO" size="20" prop="default" type="STRING"/>
          <Column id="PART_HP_NO" size="20" prop="default" type="STRING"/>
          <Column id="PART_NAME" size="20" prop="default" type="STRING"/>
          <Column id="PART_SALES_SABUN" size="9" prop="default" type="STRING"/>
          <Column id="PART_SALES_SABUN_NM" size="20" prop="default" type="STRING"/>
          <Column id="PART_SALES_TEL_NO" size="20" prop="default" type="STRING"/>
          <Column id="PART_TEL_NO" size="20" prop="default" type="STRING"/>
          <Column id="PWD_CHG_CYCLE" size="22" prop="default" type="INT"/>
          <Column id="PWD_CHG_YN" size="1" prop="default" type="STRING"/>
          <Column id="QTY_CONTROL_YN" size="1" prop="default" type="STRING"/>
          <Column id="RCV_EXP_DATE" size="8" prop="default" type="STRING"/>
          <Column id="RCV_TYPE" size="50" prop="default" type="STRING"/>
          <Column id="REMARK" size="300" prop="default" type="STRING"/>
          <Column id="SALE_RATE" size="22" prop="default" type="INT"/>
          <Column id="SIGN1" size="50" prop="default" type="STRING"/>
          <Column id="SIGN2" size="50" prop="default" type="STRING"/>
          <Column id="SIGN3" size="50" prop="default" type="STRING"/>
          <Column id="SIGN4" size="50" prop="default" type="STRING"/>
          <Column id="SM_RATE_YN" size="1" prop="default" type="STRING"/>
          <Column id="SPECIAL_FACT" size="300" prop="default" type="STRING"/>
          <Column id="SUPPLY_END" size="8" prop="default" type="STRING"/>
          <Column id="TOT_CNT" size="22" prop="default" type="INT"/>
          <Column id="UDATE" size="7" prop="default" type="DATE"/>
          <Column id="UPJANG" size="22" prop="default" type="INT"/>
          <Column id="UPJANG_TYPE" size="6" prop="default" type="STRING"/>
          <Column id="UPJANGNM_DISP" size="100" prop="default" type="STRING"/>
          <Column id="USE_YN" size="1" prop="default" type="STRING"/>
          <Column id="UUSER" size="9" prop="default" type="STRING"/>
          <Column id="ZIP_CD" size="7" prop="default" type="STRING"/>
          <Column id="BIZ_GROUP" size="256" prop="default" type="STRING"/>
          <Column id="STAMP_IMG" size="50" prop="default" type="STRING"/>
          <Column id="SAUPNO" size="10" prop="default" type="STRING"/>
          <Column id="DRNAME" size="22" prop="default" type="STRING"/>
          <Column id="ADDR2" size="100" prop="default" type="STRING"/>
          <Column id="DRJUMIN" size="22" prop="default" type="STRING"/>
          <Column id="DELIVERY_DETAIL" size="256" prop="default" type="STRING"/>
          <Column id="EXCEL_EXPORT_YN" size="256" prop="default" type="STRING"/>
          <Column id="HOLIDAY_CHK_YN" size="256" prop="default" type="STRING"/>
          <Column id="SAFE_KEY" size="256" prop="default" type="STRING"/>
          <Column id="DOCU_FILE1" size="256" prop="default" type="STRING"/>
          <Column id="DOCU_FILE2" size="256" prop="default" type="STRING"/>
          <Column id="DOCU_FILE3" size="256" prop="default" type="STRING"/>
          <Column id="DOCU_FILE4" size="256" prop="default" type="STRING"/>
          <Column id="DOCU_FILE5" size="256" prop="default" type="STRING"/>
          <Column id="SDOCU_FILE1" size="256" prop="default" type="STRING"/>
          <Column id="SDOCU_FILE2" size="256" prop="default" type="STRING"/>
          <Column id="SDOCU_FILE3" size="256" prop="default" type="STRING"/>
          <Column id="SDOCU_FILE4" size="256" prop="default" type="STRING"/>
          <Column id="SDOCU_FILE5" size="256" prop="default" type="STRING"/>
          <Column id="SDOCU_FILE_SIZE1" size="256" prop="default" type="STRING"/>
          <Column id="SDOCU_FILE_SIZE2" size="256" prop="default" type="STRING"/>
          <Column id="SDOCU_FILE_SIZE3" size="256" prop="default" type="STRING"/>
          <Column id="SDOCU_FILE_SIZE4" size="256" prop="default" type="STRING"/>
          <Column id="SDOCU_FILE_SIZE5" size="256" prop="default" type="STRING"/>
          <Column id="ACNT_PROC" type="STRING" size="10"/>
          <Column id="LOCAL1" type="STRING" size="3"/>
          <Column id="LOCAL2" type="STRING" size="3"/>
          <Column id="GANAP_YN" type="STRING" size="1"/>
          <Column id="LOCAL1_NM" type="STRING" size="256"/>
          <Column id="LOCAL2_NM" type="STRING" size="256"/>
          <Column id="ADDR_DETAIL" type="STRING" size="256"/>
          <Column id="CUST_ADDR_DETAIL" type="STRING" size="256"/>
          <Column id="GANAP_SALE_PART_NAME" type="STRING" size="256"/>
          <Column id="GANAP_SALE_PART_TEL_NO" type="STRING" size="256"/>
          <Column id="GANAP_CS_PART_NAME" type="STRING" size="256"/>
          <Column id="GANAP_CS_PART_TEL_NO" type="STRING" size="256"/>
          <Column id="ADDR_KEY" type="STRING" size="256"/>
          <Column id="ADDR_INFO" type="STRING" size="256"/>
          <Column id="CUST_ADDR_KEY" type="STRING" size="256"/>
          <Column id="CUST_ADDR_INFO" type="STRING" size="256"/>
          <Column id="ADDR2_KEY" type="STRING" size="256"/>
          <Column id="ADDR2_INFO" type="STRING" size="256"/>
          <Column id="ARRIVAL_TIME_FROM" type="STRING" size="256"/>
          <Column id="ARRIVAL_TIME_TO" type="STRING" size="256"/>
          <Column id="GANAP_BANK_CD" type="STRING" size="256"/>
          <Column id="GANAP_BANK_ACCT_NO" type="STRING" size="256"/>
          <Column id="GANAP_BANK_ACCT_NAME" type="STRING" size="256"/>
          <Column id="GANAP_CREDIT_YN" type="STRING" size="256"/>
          <Column id="GANAP_BANK_YN" type="STRING" size="256"/>
          <Column id="SHIP_ID" type="STRING" size="256"/>
          <Column id="TRANS_CNT" type="STRING" size="256"/>
          <Column id="ADDR_TEMP1" type="STRING" size="256"/>
          <Column id="ADDR_TEMP2" type="STRING" size="256"/>
          <Column id="BUDGET_YN" type="STRING" size="256"/>
          <Column id="FIRST_NEED_DATE" type="STRING" size="256"/>
          <Column id="MASTERCLASS0" type="STRING" size="50"/>
          <Column id="MASTERCLASS1" type="STRING" size="50"/>
          <Column id="MASTERCLASS2" type="STRING" size="50"/>
          <Column id="MASTERCLASS3" type="STRING" size="50"/>
          <Column id="MASTERCLASS4" type="STRING" size="50"/>
          <Column id="POP_REQ_YN" type="STRING" size="256"/>
          <Column id="POP_CNT" type="STRING" size="256"/>
          <Column id="INTERFACE_ATTR01" type="STRING" size="256"/>
          <Column id="AR_DESC_AA_YN" type="STRING" size="256"/>
          <Column id="EMAIL" type="STRING" size="256"/>
          <Column id="FAX_NO" type="STRING" size="256"/>
          <Column id="RTN_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cust" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onvaluechanged="ds_cust_onvaluechanged">
        <ColumnInfo>
          <Column id="UPJANG" type="STRING" size="256"/>
          <Column id="UPJANG_NO" type="STRING" size="256"/>
          <Column id="GUBUN" type="STRING" size="256"/>
          <Column id="PART_NAME" type="STRING" size="256"/>
          <Column id="CUST_TEL_NO" type="STRING" size="256"/>
          <Column id="CUST_HP_NO" type="STRING" size="256"/>
          <Column id="CUST_FAX_NO" type="STRING" size="256"/>
          <Column id="CUST_EMAIL" type="STRING" size="256"/>
          <Column id="DEPT_ID" type="STRING" size="256"/>
          <Column id="CONT_SALES_SABUN" type="STRING" size="256"/>
          <Column id="PART_SALES_SABUN" type="STRING" size="256"/>
          <Column id="PART_SALES_TEL_NO" type="STRING" size="256"/>
          <Column id="CS_SABUN" type="STRING" size="256"/>
          <Column id="CS_TEL_NO" type="STRING" size="256"/>
          <Column id="CUST_TEL_NO_ENC" type="STRING" size="256"/>
          <Column id="CUST_HP_NO_ENC" type="STRING" size="256"/>
          <Column id="CUST_FAX_NO_ENC" type="STRING" size="256"/>
          <Column id="CUST_EMAIL_ENC" type="STRING" size="256"/>
          <Column id="PART_SALES_TEL_NO_ENC" type="STRING" size="256"/>
          <Column id="CS_TEL_NO_ENC" type="STRING" size="256"/>
          <Column id="CUSER" type="STRING" size="256"/>
          <Column id="CDATE" type="STRING" size="256"/>
          <Column id="UUSER" type="STRING" size="256"/>
          <Column id="UDATE" type="STRING" size="256"/>
          <Column id="MAIN_YN" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">Y</Col>
            <Col id="insYn">N</Col>
            <Col id="delYn">N</Col>
            <Col id="savYn">Y</Col>
            <Col id="prtYn">N</Col>
            <Col id="exlYn">N</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_aotoCnt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="GROUP_NAME" type="STRING" size="100"/>
          <Column id="GROUP_CODE" type="STRING" size="50"/>
          <Column id="CODE" type="STRING" size="50"/>
          <Column id="CODE_NAME" type="STRING" size="500"/>
          <Column id="CONTENTS" type="STRING" size="300"/>
          <Column id="SORT_SEQ" type="BIGDECIMAL" size="39"/>
          <Column id="SYSTEM_YN" type="STRING" size="1"/>
          <Column id="SET1" type="STRING" size="100"/>
          <Column id="SET2" type="STRING" size="100"/>
          <Column id="SET3" type="STRING" size="100"/>
          <Column id="SET4" type="STRING" size="100"/>
          <Column id="SET5" type="STRING" size="100"/>
          <Column id="REMARK" type="STRING" size="300"/>
          <Column id="USE_YN" type="STRING" size="1"/>
          <Column id="ATTR01" type="STRING" size="300"/>
          <Column id="ATTR02" type="STRING" size="300"/>
          <Column id="ATTR03" type="STRING" size="300"/>
          <Column id="ATTR04" type="STRING" size="300"/>
          <Column id="ATTR05" type="STRING" size="300"/>
          <Column id="ATTR06" type="STRING" size="300"/>
          <Column id="ATTR07" type="STRING" size="300"/>
          <Column id="ATTR08" type="STRING" size="300"/>
          <Column id="ATTR09" type="STRING" size="300"/>
          <Column id="ATTR10" type="STRING" size="300"/>
          <Column id="CUSER" type="STRING" size="20"/>
          <Column id="CDATE" type="DATETIME" size="7"/>
          <Column id="UUSER" type="STRING" size="20"/>
          <Column id="UDATE" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_telno" oncolumnchanged="ds_main_OnColumnChanged" onrowposchanged="ds_main_OnRowPosChanged">
        <ColumnInfo>
          <Column id="TEL_NO" size="255" prop="default" type="STRING"/>
          <Column id="HP_NO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Hist" oncolumnchanged="ds_main_OnColumnChanged">
        <ColumnInfo>
          <Column id="CREDIT_AMOUNT" size="22" type="INT"/>
          <Column id="CREDIT_OVER_AMOUNT" size="22" type="INT"/>
          <Column id="CREDIT_TURN_DAYS" size="22" type="INT"/>
          <Column id="UDATE" size="7" type="DATE"/>
          <Column id="UUSER" size="9" type="STRING"/>
          <Column id="CREDIT_OVER_END" size="7" type="DATE"/>
          <Column id="ATTR04" size="300" type="STRING"/>
          <Column id="HEAD_CREDIT_YN" size="300" type="STRING"/>
          <Column id="MAIN_UPJANG" size="300" type="STRING"/>
          <Column id="UPJANG_TYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_userList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="NM_KOR" type="string" size="50"/>
          <Column id="USER_TEL_NO" type="string" size="4000"/>
          <Column id="USER_HP_NO" type="string" size="4000"/>
          <Column id="USER_FAX_NO" type="string" size="4000"/>
          <Column id="USER_EMAIL" type="string" size="4000"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_class1_S">
        <ColumnInfo>
          <Column id="GROUP_NAME" type="STRING" size="100"/>
          <Column id="GROUP_CODE" type="STRING" size="50"/>
          <Column id="CODE" type="STRING" size="50"/>
          <Column id="CODE_NAME" type="STRING" size="500"/>
          <Column id="CONTENTS" type="STRING" size="300"/>
          <Column id="SORT_SEQ" type="BIGDECIMAL" size="39"/>
          <Column id="SYSTEM_YN" type="STRING" size="1"/>
          <Column id="SET1" type="STRING" size="100"/>
          <Column id="SET2" type="STRING" size="100"/>
          <Column id="SET3" type="STRING" size="100"/>
          <Column id="SET4" type="STRING" size="100"/>
          <Column id="SET5" type="STRING" size="100"/>
          <Column id="REMARK" type="STRING" size="300"/>
          <Column id="USE_YN" type="STRING" size="1"/>
          <Column id="ATTR01" type="STRING" size="300"/>
          <Column id="ATTR02" type="STRING" size="300"/>
          <Column id="ATTR03" type="STRING" size="300"/>
          <Column id="ATTR04" type="STRING" size="300"/>
          <Column id="ATTR05" type="STRING" size="300"/>
          <Column id="ATTR06" type="STRING" size="300"/>
          <Column id="ATTR07" type="STRING" size="300"/>
          <Column id="ATTR08" type="STRING" size="300"/>
          <Column id="ATTR09" type="STRING" size="300"/>
          <Column id="ATTR10" type="STRING" size="300"/>
          <Column id="CUSER" type="STRING" size="20"/>
          <Column id="CDATE" type="DATETIME" size="7"/>
          <Column id="UUSER" type="STRING" size="20"/>
          <Column id="UDATE" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_class0_S">
        <ColumnInfo>
          <Column id="GROUP_NAME" type="STRING" size="100"/>
          <Column id="GROUP_CODE" type="STRING" size="50"/>
          <Column id="CODE" type="STRING" size="50"/>
          <Column id="CODE_NAME" type="STRING" size="500"/>
          <Column id="CONTENTS" type="STRING" size="300"/>
          <Column id="SORT_SEQ" type="BIGDECIMAL" size="39"/>
          <Column id="SYSTEM_YN" type="STRING" size="1"/>
          <Column id="SET1" type="STRING" size="100"/>
          <Column id="SET2" type="STRING" size="100"/>
          <Column id="SET3" type="STRING" size="100"/>
          <Column id="SET4" type="STRING" size="100"/>
          <Column id="SET5" type="STRING" size="100"/>
          <Column id="REMARK" type="STRING" size="300"/>
          <Column id="USE_YN" type="STRING" size="1"/>
          <Column id="ATTR01" type="STRING" size="300"/>
          <Column id="ATTR02" type="STRING" size="300"/>
          <Column id="ATTR03" type="STRING" size="300"/>
          <Column id="ATTR04" type="STRING" size="300"/>
          <Column id="ATTR05" type="STRING" size="300"/>
          <Column id="ATTR06" type="STRING" size="300"/>
          <Column id="ATTR07" type="STRING" size="300"/>
          <Column id="ATTR08" type="STRING" size="300"/>
          <Column id="ATTR09" type="STRING" size="300"/>
          <Column id="ATTR10" type="STRING" size="300"/>
          <Column id="CUSER" type="STRING" size="20"/>
          <Column id="CDATE" type="DATETIME" size="7"/>
          <Column id="UUSER" type="STRING" size="20"/>
          <Column id="UDATE" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_class2_S">
        <ColumnInfo>
          <Column id="GROUP_NAME" type="STRING" size="100"/>
          <Column id="GROUP_CODE" type="STRING" size="50"/>
          <Column id="CODE" type="STRING" size="50"/>
          <Column id="CODE_NAME" type="STRING" size="500"/>
          <Column id="CONTENTS" type="STRING" size="300"/>
          <Column id="SORT_SEQ" type="BIGDECIMAL" size="39"/>
          <Column id="SYSTEM_YN" type="STRING" size="1"/>
          <Column id="SET1" type="STRING" size="100"/>
          <Column id="SET2" type="STRING" size="100"/>
          <Column id="SET3" type="STRING" size="100"/>
          <Column id="SET4" type="STRING" size="100"/>
          <Column id="SET5" type="STRING" size="100"/>
          <Column id="REMARK" type="STRING" size="300"/>
          <Column id="USE_YN" type="STRING" size="1"/>
          <Column id="ATTR01" type="STRING" size="300"/>
          <Column id="ATTR02" type="STRING" size="300"/>
          <Column id="ATTR03" type="STRING" size="300"/>
          <Column id="ATTR04" type="STRING" size="300"/>
          <Column id="ATTR05" type="STRING" size="300"/>
          <Column id="ATTR06" type="STRING" size="300"/>
          <Column id="ATTR07" type="STRING" size="300"/>
          <Column id="ATTR08" type="STRING" size="300"/>
          <Column id="ATTR09" type="STRING" size="300"/>
          <Column id="ATTR10" type="STRING" size="300"/>
          <Column id="CUSER" type="STRING" size="20"/>
          <Column id="CDATE" type="DATETIME" size="7"/>
          <Column id="UUSER" type="STRING" size="20"/>
          <Column id="UDATE" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_class3_S">
        <ColumnInfo>
          <Column id="GROUP_NAME" type="STRING" size="100"/>
          <Column id="GROUP_CODE" type="STRING" size="50"/>
          <Column id="CODE" type="STRING" size="50"/>
          <Column id="CODE_NAME" type="STRING" size="500"/>
          <Column id="CONTENTS" type="STRING" size="300"/>
          <Column id="SORT_SEQ" type="BIGDECIMAL" size="39"/>
          <Column id="SYSTEM_YN" type="STRING" size="1"/>
          <Column id="SET1" type="STRING" size="100"/>
          <Column id="SET2" type="STRING" size="100"/>
          <Column id="SET3" type="STRING" size="100"/>
          <Column id="SET4" type="STRING" size="100"/>
          <Column id="SET5" type="STRING" size="100"/>
          <Column id="REMARK" type="STRING" size="300"/>
          <Column id="USE_YN" type="STRING" size="1"/>
          <Column id="ATTR01" type="STRING" size="300"/>
          <Column id="ATTR02" type="STRING" size="300"/>
          <Column id="ATTR03" type="STRING" size="300"/>
          <Column id="ATTR04" type="STRING" size="300"/>
          <Column id="ATTR05" type="STRING" size="300"/>
          <Column id="ATTR06" type="STRING" size="300"/>
          <Column id="ATTR07" type="STRING" size="300"/>
          <Column id="ATTR08" type="STRING" size="300"/>
          <Column id="ATTR09" type="STRING" size="300"/>
          <Column id="ATTR10" type="STRING" size="300"/>
          <Column id="CUSER" type="STRING" size="20"/>
          <Column id="CDATE" type="DATETIME" size="7"/>
          <Column id="UUSER" type="STRING" size="20"/>
          <Column id="UDATE" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_class4_S">
        <ColumnInfo>
          <Column id="GROUP_NAME" type="STRING" size="100"/>
          <Column id="GROUP_CODE" type="STRING" size="50"/>
          <Column id="CODE" type="STRING" size="50"/>
          <Column id="CODE_NAME" type="STRING" size="500"/>
          <Column id="CONTENTS" type="STRING" size="300"/>
          <Column id="SORT_SEQ" type="BIGDECIMAL" size="39"/>
          <Column id="SYSTEM_YN" type="STRING" size="1"/>
          <Column id="SET1" type="STRING" size="100"/>
          <Column id="SET2" type="STRING" size="100"/>
          <Column id="SET3" type="STRING" size="100"/>
          <Column id="SET4" type="STRING" size="100"/>
          <Column id="SET5" type="STRING" size="100"/>
          <Column id="REMARK" type="STRING" size="300"/>
          <Column id="USE_YN" type="STRING" size="1"/>
          <Column id="ATTR01" type="STRING" size="300"/>
          <Column id="ATTR02" type="STRING" size="300"/>
          <Column id="ATTR03" type="STRING" size="300"/>
          <Column id="ATTR04" type="STRING" size="300"/>
          <Column id="ATTR05" type="STRING" size="300"/>
          <Column id="ATTR06" type="STRING" size="300"/>
          <Column id="ATTR07" type="STRING" size="300"/>
          <Column id="ATTR08" type="STRING" size="300"/>
          <Column id="ATTR09" type="STRING" size="300"/>
          <Column id="ATTR10" type="STRING" size="300"/>
          <Column id="CUSER" type="STRING" size="20"/>
          <Column id="CDATE" type="DATETIME" size="7"/>
          <Column id="UUSER" type="STRING" size="20"/>
          <Column id="UDATE" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Auth_in">
        <ColumnInfo>
          <Column id="SABUN" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="SABUN"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_Auth_out">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item2" compid="div_mainSearch.sta_detail02" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item3" compid="div_mainSearch.sta_detail03" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item4" compid="div_mainSearch.sta_detail04" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item5" compid="div_mainSearch.sta_detail05" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item0" compid="div_mainSearch.sta_detail00" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item1" compid="div_mainSearch.sta_detail01" propid="text" datasetid="ds_view" columnid="D_1"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 기준정보/사업장관리/매출처 정보관리(본부관리자용)
 * 프로그램명   : FMS00100E.XML
 * 기      능   : 매출처 정보관리
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-11-20
 * 수  정  자   : 최영준
 * 수정  일자   : 2015-03-18  
 * 비      고   : 
 *		- ds_input				: [input DS] 조회조건 파라미터 DS
 *		- ds_CustType			: [코드 DS] 고객구분 DS (공통코드 : '고객구분')
 *		- ds_useyn				: [코드 DS] 사용구분 DS
 *		- ds_UPJANG_TYPE		: [코드 DS] 본사/사업장구분 DS
 *		- ds_PWD_CHG			: [코드 DS] 비밀번호 주기 DS
 *		- ds_OtcustType			: [코드 DS] 타거래처 단가업장구분 DS
 *		- ds_CREDITTYPE			: [코드 DS] 관리기준 DS
 *		- ds_FINANCIAL_STATUS	: [코드 DS] 재무상태 DS
 *		- ds_RCV_TYPE			: [코드 DS] 입금유형 DS
 *		- ds_BizGroup			: [코드 DS] 영업군 DS
 *		- ds_list				: 매출처리스트
 *		- ds_main				: [Main DS] 사업장 DS
 *		- ds_cust				: 고객정보
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "lib::sc_comon.js"				// 시스템 공통
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js"		//JAVA 코딩시
//@@컨버터에서 주석처리 #include "LIB::tit_comm_0001.js"		// X-Framework Lib
//@@컨버터에서 주석처리 #include "lib::sc_sql_common.js"		// 공통팝업
//@@컨버터에서 주석처리 #include "lib::fm_common.js"			// FM공통
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var fstrCustinfo;								// 신규입력시 선택된 사업장정보
var fstrSaveUpjang;
var serverSaveDir = "FMM_UPJANG_IMG";			// 파일패스
//var serverSaveDir = "FMM_UPJANG_STAMP";			// 파일패스
var serverSaveUrl;								// 파일패스URL
var vUPJANG;									// 사업장Code
var sccTelNo;									// tal_no ( 영업사원 , CS사원 tal_no )
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, true);

	// 업데이트 DS
	v_ds_check = "ds_main";
	
	// X-Framework : Action 정보 생성 
	fsp_init(this);
	
	// 공통코드조회
	var v_fil_cond;
	var v_ds = fn_common_code("'고객구분','FM0004', 'FM0020', 'FM0021', 'FM0022', 'FM0040'","","","all","Y");
	
	// 고객구분(ds_CustType, GROUP_CODE : '고객구분')
	v_fil_cond = "GROUP_CODE == '고객구분'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_CustType,v_ds.name);	
	
	//rdo_CUST_TYPE.Value = "가맹점";
	ds_input.setColumn(0,"CUST_TYPE",div_mainSearch.rdo_CUST_TYPE.value);						// 고객구분
	
	// 직군(ds_CustType, GROUP_CODE : 'FM0004')
	v_fil_cond = "GROUP_CODE == 'FM0004' && String(CODE).length > 0";	
	v_ds.filter(v_fil_cond);
	CopyF(ds_BizGroup,v_ds.name);	
	
	// 사업군(ds_BizKind, GROUP_CODE : 'FM0020')
	v_fil_cond = "GROUP_CODE == 'FM0020' && String(CODE).length > 0";
	v_ds.filter(v_fil_cond);
	CopyF(ds_BizKind,v_ds.name);	
		
	// 세부직군(ds_BizDetail, GROUP_CODE : 'FM0021')
	v_fil_cond = "GROUP_CODE == 'FM0021' && String(CODE).length > 0";
	v_ds.filter(v_fil_cond);
	CopyF(ds_BizDetail,v_ds.name);	
			
	// 파트코드(ds_PartCode, GROUP_CODE : 'FM0022')
	v_fil_cond = "GROUP_CODE == 'FM0022' && String(CODE).length > 0";
	v_ds.filter(v_fil_cond);
	CopyF(ds_PartCode,v_ds.name);
	
	// 자동계좌처리여부(ds_aotoCnt, GROUP_CODE : 'FM0040')
	v_fil_cond = "GROUP_CODE == 'FM0040'";
	v_ds.filter(v_fil_cond);
	CopyF(ds_aotoCnt,v_ds.name);	
	ds_aotoCnt.updateSortGroup("S:+CODE");
	ds_aotoCnt.setColumn(0,'CODE_NAME','');
			
	var v_rst0 = fn_common_code("'CUSTCLASS0'", "", "", "" , "Y");	
	Copy(ds_class0_S,v_rst0.name);	
	var v_rst1 = fn_common_code("'CUSTCLASS1'", "", "", "" , "Y");	
	Copy(ds_class1_S,v_rst1.name);	
	var v_rst2 = fn_common_code("'CUSTCLASS2'", "", "", "" , "Y");
	Copy(ds_class2_S,v_rst2.name);		
	var v_rst3 = fn_common_code("'CUSTCLASS3'", "", "", "" , "Y");
	Copy(ds_class3_S,v_rst3.name);	
	var v_rst4 = fn_common_code("'CUSTCLASS4'", "", "", "" , "Y");
	Copy(ds_class4_S,v_rst4.name);	
		
	// 초기값 셋팅
	serverSaveUrl = fsp_getServerDir(serverSaveDir);
//	alert(serverSaveUrl);  

	// 내부직원만 보이게...
	/*
	if (application.g_UserGroup <> '리조트')
	{
		grd_list.setFormatColProperty(12,"size",0);
		grd_list.setFormatColProperty(13,"size",0);
	}
	*/
	div_mainSearch.cbo_UseYN.index = 1;//사용여부(사용)
	
	ds_class1_S.filter("0");
	ds_class2_S.filter("0");
	ds_class3_S.filter("0");
	ds_class4_S.filter("0");
	
	
	fn_aaArAuthChk(); // 사고채권유무 권한체크 
	if(ds_Auth_out.getRowCount() > 0) { 
		tab_list.tab3.rdo_AR_DESC_AA_YN.enable = true;
	} else {
		tab_list.tab3.rdo_AR_DESC_AA_YN.enable = false;
	}
}

/*
function frm_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
{
	fn_form_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam);
}
*/

//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_search()
{
	// 조회조건체크
	
	// 초기화
	ds_list.clearData();
	ds_main.clearData();
	ds_input.clearData();
	ds_input.addRow();
	ds_cust.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "ds_input=ds_input";
	outData			= "ds_list=ds_list";
	callBackFnc		= "fn_afterSearchList";
	
	// 파라미터셋팅
	ds_input.setColumn(0,"MAIN_UPJANG_NM",gfn_trim(div_mainSearch.ed_S_MAIN_UPJANG.value));			// 본사코드
	ds_input.setColumn(0,"UPJANG_NM",gfn_trim(div_mainSearch.ed_S_UPJANG.value));					// 사업장코드
	//ds_input.SetColumn(0,"UPJANG_NM",trim(ed_S_UPJANG_NM.Text));				// 사업장명
	ds_input.setColumn(0,"CUST_TYPE",div_mainSearch.rdo_CUST_TYPE.value);						// 고객구분
	ds_input.setColumn(0,"USE_YN",div_mainSearch.cbo_UseYN.value);								// 사용유무
	ds_input.setColumn(0,"EMP_NM",div_mainSearch.ed_empNm.value);								// 영업사원, C/S사원
	ds_input.setColumn(0,"SAUPNO",div_mainSearch.ed_S_SAUPNO.value);							// 사업자번호
	// 2015-11-12 검색 조건 추가
	ds_input.setColumn(0,"TEL_NO",div_mainSearch.ed_S_TEL_NO.value);							// 전화번호 : 검색 추가
	// 2019-07-03 검색 조건 추가
	ds_input.setColumn(0,"MASTERCLASS0_S",div_mainSearch.Cbo_MasterClass0_S.value);							// 고객마스터
	ds_input.setColumn(0,"MASTERCLASS1_S",div_mainSearch.Cbo_MasterClass1_S.value);							// 고객마스터
	ds_input.setColumn(0,"MASTERCLASS2_S",div_mainSearch.Cbo_MasterClass2_S.value);							// 고객마스터
	ds_input.setColumn(0,"MASTERCLASS3_S",div_mainSearch.Cbo_MasterClass3_S.value);							// 고객마스터
	ds_input.setColumn(0,"MASTERCLASS4_S",div_mainSearch.Cbo_MasterClass4_S.value);							// 고객마스터
	ds_input.setColumn(0,"POP_REQ_YN",div_mainSearch.cbo_pop.value);										// POP배송여부
	
	fsp_clear(this); 

	//--------------------------------------------------------//
	// 소속이 남부 지사 이면 무조건 엑셀 Export 할 수 없게..  
	// 2009.11.19 FS 식재 사업팀 요청 by 노규완  (FMS00100E_S003.xml)
	//--------------------------------------------------------//
	if ((gfn_pos(g_Cc_Nm ,"남부")>= 0) && (g_UserGroup) == "식재영업")	
		fsp_addSearch(this, "fm/fms:FMS00100E_S003");									// 조회 (남부)
	else
		fsp_addSearch(this, "fm/fms:FMS00100E_S001");									// 조회 (전체)
	
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Insert()
 * 기      능   : [입력버튼] 입력 시 처리되는 작업
 * 비      고	: 팝업사용
 ******************************************************************************************
 */
function fn_insert()
{
	// 처리변경
	/*
	var nRow;
	
	// 입력체크(1건만 입력가능)
	if(ds_main.GetUpdate()==true)
	{
		if(!g_Confirm("04","변경된 데이터가 있습니다.\n새로운 자료를 입력하시겠습니까?\n(기존에 입력한 자료는 사라집니다.)"))
		{
			return;
		}
	}
	
	fstrCustinfo="";
	
	// 팝업
	fstrCustinfo = gfn_dialog("", "U_FMS::FMS00100P.xml","");
	
	if (length(fstrCustinfo)=0)
	{
		return;
	}
	
	ds_main.ClearData();
	
	nRow = ds_main.addRow();
	
	// 초기값 셋팅
	fn_CustInfoSetting();																// 팝업값셋팅
	ds_main.setColumn(nRow, "CUST_TYPE", rdo_CUST_TYPE.Value);							// 고객구분
	ds_main.setColumn(nRow, "UPJANGNM_DISP", ds_main.GetColumn(nRow,"CUST_NAME"));		// 사업장명(고객용)
	ds_main.setColumn(nRow, "USE_YN", "Y");												// 사용여부
	ds_main.setColumn(nRow, "PWD_CHG_YN", "");											// 비밀번호주기
	ds_main.setColumn(nRow, "CREDIT_TYPE", "관리안함");									// 관리기준
	ds_main.setColumn(nRow, "CONSUM_OP_RATE_YN", "N");				// 소모품운영단가 작업
	ds_main.setColumn(nRow, "OTCUST_OP_RATE_YN", "N");				// 타거래처운영단가작업
	ds_main.setColumn(nRow, "CONSUM_SM_RATE_YN", "N");				// 소모품 제출단가 조정
	ds_main.setColumn(nRow, "OTCUST_SM_RATE_YN", "N");				// 타거래처 제출단가 작업
    ds_main.setColumn(nRow, "CUSER", g_EmpNo);
    ds_main.setColumn(nRow, "UUSER", g_EmpNo);
    
    btn_Copy.Enable = true;
    tab_list.tab1.ed_UPJANG.Enable = true;
    
    Tab_list.TabIndex =0;
    Tab_list.tab1.ed_UPJANG.SetFocus();
    */
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Save()
 * 기      능   : [저장버튼] 저장 시 처리되는 작업
 ******************************************************************************************
 */
function fn_save()
{	
	//첨부파일저장
	fn_FileSaveSafe();
	
	// 변경여부 확인
	//if(gfn_dsIsUpdated(ds_main)==false)
	if(gfn_dsIsUpdated(ds_main)==false && gfn_dsIsUpdated(ds_cust)==false )
	{
		g_Message("EE", "변경된 데이터가 없습니다.");
		return;
	}
	
	if(!fn_SaveCheck())
	{
		return;
	}
	
	// 2016.11.01 이혜은 요청
	//변경한 내용이 사업장중 통합여부를 Y로 바꾼 업장
	if(tab_list.tab1.rdo_UPJANG_TYPE.value == "사업장" && tab_list.tab3.rdo_HEAD_CREDIT_YN.value == "Y")
	{
		//그 업장의 해당 메인업장의 통합여부를 Y로 변경
		fn_changeMainHead(ds_list.getColumn(ds_list.rowposition,"UPJANG"));
	}
	
	//본사로 저장할때 무조건 통합여부는 Y로 저장되도록 변경
	if(tab_list.tab1.rdo_UPJANG_TYPE.value == "본사")
	{
		if ( ds_main.getColumn(ds_main.rowposition,"HEAD_CREDIT_YN") != "Y" ) {
			//alert("본사통합관리여부는 수정이 불가능합니다.");
		}
		ds_main.setColumn(ds_main.rowposition,"HEAD_CREDIT_YN","Y");
	} else if ( tab_list.tab1.rdo_UPJANG_TYPE.value == "사업장" ) {
		//ds_main.setColumn(ds_main.rowposition,"HEAD_CREDIT_YN","N");
	}
	
	fstrSaveUpjang = ds_main.getColumn(ds_main.rowposition,"UPJANG");
	
	fn_checkTransInfo();
	//trace(ds_main.saveXML());
    // 서비스셋팅
    var actionName, cmdName, inData, outData, otherArg, callBackFnc;
    var insertSql, updateSql, deleteSql,saveFlagColumn, keySqlName, keyIncrement, callbackSql;
    
    inData		= "ds_main=ds_main:U ds_input=ds_input ds_cust=ds_cust:U ";
    outData		= "ds_main=ds_main ds_list=ds_list ds_cust=ds_cust ";
    callBackFnc	= "fn_afterSave";
	otherArg 	= "g_EmpNo="+wrapQuote(g_EmpNo);
       
    fsp_clear(this);
    fsp_addSave(this, insertSql, "fm/fms:FMS00100E_U001", deleteSql,saveFlagColumn, keySqlName, -1, "fm/fms:FMS00100E_S001");
    fsp_addSave(this, "fm/fms:FMS00100E_I002", "fm/fms:FMS00100E_U002", "fm/fms:FMS00100E_D002", saveFlagColumn, keySqlName, keyIncrement, callbackSql);
    fsp_addSave(this, "", "fm/fms:FMS00100E_U004", "", saveFlagColumn, keySqlName, keyIncrement, callbackSql);
    fsp_addSave(this, "", "fm/fms:FMS00100E_U005", "", saveFlagColumn, keySqlName, keyIncrement, callbackSql);
    fsp_addSave(this, "", "fm/fms:FMS00100E_U007", "", saveFlagColumn, keySqlName, keyIncrement, callbackSql);	// 구매 배송지 저장
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
   
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Delete()
 * 기      능   : [삭제버튼] 삭제 시 처리되는 작업
 ******************************************************************************************
 */
function fn_delete()
{

	if(ds_main.getRowCount()==0)
	{
		g_Message("EE", "삭제할 데이터가 없습니다.");
		return;
	}
	
	// 삭제 못함. 사용중지로 돌려 이력남김.
	ds_main.setColumn(ds_main.rowposition,"USE_YN","N");
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_Print()
 * 기      능   : [출력버튼] 출력 시 처리되는 작업
 ******************************************************************************************
 */
function fn_print()
{
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function fn_Close()
{
	this.close();
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Help()
 * 기      능   : [도움말버튼] 도움말
 ******************************************************************************************
 */
function fn_help()
{
	// tit_addSearchActionInfo(this, "fm/fms:SCC_MENU_SECT");
	// tit_callService(this, "", "", "ds_cond=ds_cond", "ds_Menu=ds_list", "", "");	
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_SerchSub(nUPJANG)
 * 입      력   : nUPJANG = 조회할 업장코드
 * 반      환   : 없음
 * 기      능   : 사업장 상세정보 조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-11-20  
 * 수  정  자   : 최영준
 * 수정  일자   : 2015-03-18  
 ******************************************************************************************
 */
function fn_SerchSub(nUPJANG)
{
	vUPJANG = nUPJANG;
	
	// 조회조건체크
	
	// 초기화
	ds_main.clearData();
	
	// 조회
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	//inData			= "ds_input=ds_input";
	outData			= "ds_main=ds_main ds_cust=ds_cust ds_Hist=ds_Hist ds_userList=ds_userList";
	callBackFnc		= "fn_afterSearch";
	
	otherArg		=  "UJ_UPJANG="	+ nUPJANG;
	otherArg		+= " FILEURL="	+ serverSaveUrl;
	otherArg		+= " p_MaskAuth="	+ SCAuth.getMaskAuth(this);
		
	// 파라미터셋팅
	ds_input.setColumn(0,"UJ_UPJANG",nUPJANG);						// 사업장코드
	ds_input.setColumn(0,"FILEURL",serverSaveUrl);
	
	fsp_clear(this); 
    fsp_addSearch(this, "fm/fms:FMS00100E_S002");									// 조회 
    fsp_addSearch(this, "fm/fms:FMS00100E_S004");
    fsp_addSearch(this, "fm/fms:FMS00175E_S001");									// 여신내역
    fsp_addSearch(this, "fm/fms:FMS00100E_S007");						// 사용자 정보
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
    
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_SaveCheck()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 저상시 필수입력 체크
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-11-20  
 * 수  정  자   : 최영준
 * 수정  일자   : 2015-03-18  
 ******************************************************************************************
 */
function fn_SaveCheck()
{
	var nFRow,nRow,strValue,btp,strmsg;
	
	nRow = ds_main.rowposition;
	
	// 필수 입력 사항 확인 
	// 사업장코드
	nFRow = ds_main.findRowExpr("gfn_length(gfn_trim(UPJANG))==0");
	if( nFRow !=-1 )
	{
		ds_main.rowposition = nFRow;
		g_Message("EE", "사업장코드를 입력해주십시오.");
		tab_list.tabindex = 0;
		tab_list.tab1.ed_UPJANG.setFocus();
		return false;
	}

	// 고객구분
	nFRow = ds_main.findRowExpr("gfn_length(gfn_trim(CUST_TYPE))==0");
	if( nFRow !=-1 )
	{
		ds_main.rowposition = nFRow;
		g_Message("EE", "고객구분을 입력해주십시오.");
		tab_list.tabindex = 0;
		tab_list.tab1.cbo_CUST_TYPE.setFocus();
		return false;
	}
	
	// 코드구분
	nFRow = ds_main.findRowExpr("gfn_length(gfn_trim(UPJANG_TYPE))==0");
	if( nFRow !=-1 )
	{
		ds_main.rowposition = nFRow;
		g_Message("EE", "코드구분을 입력해주십시오.");
		tab_list.tabindex = 0;
		tab_list.tab1.rdo_UPJANG_TYPE.setFocus();
		return false;
	}
	
	/*
	// 사업장명
	nFRow = ds_main.SearchRow("length(trim(UPJANGNM_DISP))==0");
	if( nFRow !=-1 )
	{
		ds_main.row = nFRow;
		g_Message("EE", "사업장명을 입력해주십시오.");
		tab_list.TabIndex = 0;
		tab_list.tab1.ed_CUST_NAME.SetFocus();
		return false;
	}
	*/
	// 본사그룹
	nFRow = ds_main.findRowExpr("gfn_length(gfn_trim(MAIN_UPJANG))==0");
	if( nFRow !=-1 )
	{
		ds_main.rowposition = nFRow;
		g_Message("EE", "본사그룹을 입력해주십시오.");
		tab_list.tabindex = 0;
		tab_list.tab1.ed_MAIN_UPJANG.setFocus();
		return false;
	}
	/*
	// 사업자번호
	nFRow = ds_main.SearchRow("length(trim(BIZ_NUM))==0");
	if( nFRow !=-1 )
	{
		ds_main.row = nFRow;
		g_Message("EE", "사업자번호를 입력해주십시오.");
		tab_list.TabIndex = 0;
		tab_list.tab1.med_BIZ_NUM.SetFocus();
		return false;
	}
	*/

	// 배송지
	if(ds_main.getColumn(ds_main.rowposition,"ADDR_KEY") == null){
		//ds_main.row = nFRow;
		g_Message("EE", "배송지를 입력해주십시오.");
		tab_list.TabIndex = 0;
		//tab_list.tab1.comp_addr.SetFocus();
		return false;
	}
	
	// 메인여부
	if( ds_cust.getRowCount() != 0 )
	{
		var mainYn = 0;
		//if(ds_cust.getRowCount() != 0)
		for(var i=0; i<ds_cust.getRowCount(); i++)
		{
			if(ds_cust.getColumn(i, 'MAIN_YN')== 'Y')	mainYn++;
		}
		if(mainYn != 1)
		{
			/*if(mainYn < 1)*/	g_Message("EE", "고객정보의 메인여부를 선택해주십시오.");
			return false;
		}
	}
	
	// 영업부서
	nFRow = ds_main.findRowExpr("gfn_length(gfn_trim(DEPT_ID_NM))==0");
	if( nFRow !=-1 )
	{
		ds_main.rowposition = nFRow;
		g_Message("EE", "영업부서을 입력해주십시오.");
		tab_list.tabindex = 0;
		tab_list.tab1.Div00.ed_DEPT_ID_NM.setFocus();
		return false;
	}
	
	// 영업사원
	nFRow = ds_main.findRowExpr("gfn_length(gfn_trim(PART_SALES_SABUN))==0");
	if( nFRow !=-1 )
	{
		ds_main.rowposition = nFRow;
		g_Message("EE", "영업사원을 입력해주십시오.");
		tab_list.tabindex = 0;
		tab_list.tab1.Div00.ed_PART_SALES_SABUN_NM.setFocus();
		return false;
	}

	// 영업사원 연락처
	nFRow = ds_main.findRowExpr("gfn_length(gfn_trim(PART_SALES_TEL_NO))==0");
	if( nFRow !=-1 )
	{
		ds_main.rowposition = nFRow;
		g_Message("EE", "영업사원 연락처를 입력해주십시오.");
		tab_list.tabindex = 0;
		tab_list.tab1.Div00.ed_PART_SALES_TEL_NO.setFocus();
		return false;
	}
	
	// C/S사원
	nFRow = ds_main.findRowExpr("gfn_length(gfn_trim(CS_SABUN))==0");
	if( nFRow !=-1 )
	{
		ds_main.rowposition = nFRow;
		g_Message("EE", "C/S사원을 입력해주십시오.");
		tab_list.tabindex = 0;
		tab_list.tab1.Div00.ed_CS_SABUN_NM.setFocus();
		return false;
	}
	
	// C/S사원 연락처
	nFRow = ds_main.findRowExpr("gfn_length(gfn_trim(CS_TEL_NO))==0");
	if( nFRow !=-1 )
	{
		ds_main.rowposition = nFRow;
		g_Message("EE", "C/S사원 연락처를 입력해주십시오.");
		tab_list.tabindex = 0;
		tab_list.tab1.Div00.ed_CS_TEL_NO.setFocus();
		return false;
	}
/*
	///////////////////////////////////////////////////////////////////////////////////////////////////////////
	// 2010-06-07 사업군,영업군,세부경로,파트코드 입력사항 체크
	// 사업군
	nFRow = ds_main.SearchRow("length(trim(BIZ_KIND))==0");
	if( nFRow !=-1 )
	{
		ds_main.row = nFRow;
		g_Message("EE", "사업군을 입력해주십시오.");
		tab_list.TabIndex = 0;
		tab_list.tab1.BIZ_KIND.SetFocus();
		return false;
	}
	// 직군
	nFRow = ds_main.SearchRow("length(trim(BIZ_GROUP))==0");
	if( nFRow !=-1 )
	{
		ds_main.row = nFRow;
		g_Message("EE", "영업군을 입력해주십시오.");
		tab_list.TabIndex = 0;
		tab_list.tab1.BIZ_GROUP.SetFocus();
		return false;
	}
	// 세부직군
	nFRow = ds_main.SearchRow("length(trim(BIZ_DETAIL))==0");
	if( nFRow !=-1 )
	{
		ds_main.row = nFRow;
		g_Message("EE", "세부경로를 입력해주십시오.");
		tab_list.TabIndex = 0;
		tab_list.tab1.BIZ_DETAIL.SetFocus();
		return false;
	}
	///////////////////////////////////////////////////////////////////////////////////////////////////////////
*/	
	
	// 파트코드
	/*
	nFRow = ds_main.findRowExpr("gfn_length(gfn_trim(PART_CODE))==0");
	if( nFRow !=-1 )
	{
		ds_main.rowposition = nFRow;
		g_Message("EE", "파트코드를 입력해주십시오.");
		tab_list.tabindex = 1;
		tab_list.tab2.cbo_PART_CODE.setFocus();
		return false;
	}
	*/

	// 사용여부
	nFRow = ds_main.findRowExpr("gfn_length(gfn_trim(USE_YN))==0");
	if( nFRow !=-1 )
	{
		ds_main.rowposition = nFRow;
		g_Message("EE", "사용여부를 입력해주십시오.");
		tab_list.tabindex = 0;
		tab_list.tab1.Div00.cbo_USE_YN.setFocus();
		return false;
	}
	
	// 결제라인설정 체크
	// 결제자1
	if (gfn_length(ds_main.getColumn(nRow,"SIGN2"))> 0 || gfn_length(ds_main.getColumn(nRow,"SIGN3"))> 0 || gfn_length(ds_main.getColumn(nRow,"SIGN4"))> 0)
	{
		if (gfn_length(ds_main.getColumn(nRow,"SIGN1"))== 0)
		{
			g_Message("EE", "결제자1을 입력해주십시오.");
			tab_list.tabindex = 1;
			tab_list.tab2.ed_SIGN1.setFocus();
			return false;
		}
	}
	// 결제자2
	if (gfn_length(ds_main.getColumn(nRow,"SIGN3"))> 0 || gfn_length(ds_main.getColumn(nRow,"SIGN4"))> 0)
	{
		if (gfn_length(ds_main.getColumn(nRow,"SIGN2"))== 0)
		{
			g_Message("EE", "결제자2를 입력해주십시오.");
			tab_list.tabindex = 1;
			tab_list.tab2.ed_SIGN2.setFocus();
			return false;
		}
	}
	// 결제자3
	if (gfn_length(ds_main.getColumn(nRow,"SIGN4"))> 0)
	{
		if (gfn_length(ds_main.getColumn(nRow,"SIGN3"))== 0)
		{
			g_Message("EE", "결제자3을 입력해주십시오.");
			tab_list.tabindex = 1;
			tab_list.tab2.ed_SIGN3.setFocus();
			return false;
		}
	}
	
    
    // 여신정보 체크
    // 관리기준이 관리안함인 경우는 체크안함. 여신일,여신액,여신일+여신액인 경우 각 항목의 값이 0이상 인지를 체크
    btp = false;
    strValue = ds_main.getColumn(nRow,"CREDIT_TYPE");

    if (strValue!="관리안함")
    {
		if (strValue!="여신일")
		{
			if (toNumber(ds_main.getColumn(nRow,"CREDIT_AMOUNT"))<=0)
			{
				btp = true;
			}
		}
		
		if (strValue!="여신액")
		{
			if (toNumber(ds_main.getColumn(nRow,"CREDIT_TURN_DAYS"))<=0)
			{
				btp = true;
			}
		}
		
		if (btp)
		{
			strmsg = "설정 및 채권/여신정보를 등록하지 않으셨습니다.\n";
		}
    }
    
    /*
    if ( gfn_isNull(ds_main.getColumn(nRow, "FIRST_NEED_DATE")) ) {
		g_Message("EE", "초도입고일자를 선택하세요.");
		tab_list.tab1.cal_fstNedDt.setFocus();
		return false;
    }
    */
    // 저장확인
	if(!g_Confirm("02",gfn_nvl(strmsg,"")+"그대로 저장하시겠습니까?"))
	{
		return false;
	}
    
    return true;
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_FormSetting()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 조회 후 화면셋팅
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-11-20  
 ******************************************************************************************
 */
function fn_FormSetting()
{
	var nRow,strValue;
	
	nRow = ds_main.rowposition;
	
	// insert인 경우만 true
	if (GetRowType(ds_main,nRow)!="insert")
	{
		tab_list.tab1.ed_UPJANG.enable = false;
		btn_Copy.enable = false;
	}
	
	// 코드구분(고객구분이 일반인 경우 수정불가)
	strValue = ds_main.getColumn(nRow,"CUST_TYPE");
	if (strValue=="일반")
	{
		tab_list.tab1.rdo_UPJANG_TYPE.enable = false;
		tab_list.tab1.btn_pop1.visible = false;
	}
	else
	{
		tab_list.tab1.rdo_UPJANG_TYPE.enable = true;
		tab_list.tab1.btn_pop1.visible = true;
	}
	
	// 대상업장인 경우만 선택팝업 가능
	strValue = ds_main.getColumn(nRow,"OTCUST_UPJANG_TYPE");
	if (strValue == "대상업장")
	{
		tab_list.tab2.btn_pop6.visible = true;
	}
	else
	{
		tab_list.tab2.btn_pop6.visible = false;
	}
	
	// 사업자번호 형식지정
	strValue = ds_main.getColumn(nRow,"BIZ_NUM");
	if(gfn_length(strValue)==10)
	{
		tab_list.tab1.med_BIZ_NUM.mask = "@@@-@@-@@@@@";
	}
	else if(gfn_length(tab_list.tab1.med_BIZ_NUM.value)==13)
	{
		tab_list.tab1.med_BIZ_NUM.mask = "@@@@@@-@@@@@@@";
	}
	else
	{
		tab_list.tab1.med_BIZ_NUM.mask = "";
	}
	
	// 관리기준에 따른 폼셋팅
	strValue = ds_main.getColumn(nRow,"CREDIT_TYPE");
	
	var btp1,btp2,btp3;
	
	if (strValue == "관리안함")
	{
		btp1 = false;
		btp2 = false;
		btp3 = false;
	}
	else if (strValue == "여신일")
	{
		btp1 = true;
		btp2 = true;
		btp3 = false;
	}
	else if (strValue == "여신액")
	{
		btp1 = true;
		btp2 = false;
		btp3 = true;
	}
	else	// 여신일 + 여신액
	{
		btp1 = true;
		btp2 = true;
		btp3 = true;
	}
	
	//tab_list.tab3.rdo_HEAD_CREDIT_YN.Enable 		= btp1;
	//tab_list.tab3.med_CREDIT_TURN_DAYS.Enable 		= btp2;
	//tab_list.tab3.med_CREDIT_EXT_DAYS.Enable 		= btp2;
	//tab_list.tab3.med_CREDIT_AMOUNT.Enable 			= btp3;
	//tab_list.tab3.med_CREDIT_EXT_AMOUNT.Enable 		= btp3;
	//tab_list.tab3.rdo_CREDIT_CONTROL_YN.Enable 		= btp1;
	//tab_list.tab3.med_CREDIT_OVER_AMOUNT.Enable 	= btp1;
	//tab_list.tab3.cal_CREDIT_END.Enable 			= btp1;
	
	// 본사인 경우만 이미지 업로드 다운로드
	strValue = ds_main.getColumn(nRow,"UPJANG_TYPE");
	if (strValue == "본사")
	{
		btp1 = true;
		btp2 = false;
	}
	else
	{
		btp1 = false;
		btp2 = true;
	}
	
	tab_list.tab1.Div00.img_photo.visible 		= btp1;
	tab_list.tab1.Div00.btn_UploadImg.visible 	= btp1;
	tab_list.tab1.Div00.btn_DeleteImg.visible 	= btp1;
	tab_list.tab1.Div00.st_bk1.visible 			= btp1;
	tab_list.tab1.Div00.st_text.visible			= btp1;
	
	//ed_S_MAIN_UPJANG.setFocus();
	
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_CustInfoSetting()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 입력시 사업장정보를 셋팅
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-11-20  
 * 비      고	: 
	- 팝업리턴 값
 		[0] strReturn = 		ds_list.GetColumn(nRow,"CUST_CD");					// 사업자등록번호
		[1] strReturn += "; " + ds_list.GetColumn(nRow,"CUST_NAME");				// 사업장명
		[2] strReturn += "; " + ds_list.GetColumn(nRow,"HILVL_CUST_CD"); 			// 사업자등록번호-본사
		[3] strReturn += "; " + ds_list.GetColumn(nRow,"HILVL_CUST_NAME"); 			// 본사명
		[4] strReturn += "; " + ds_list.GetColumn(nRow,"MAIL_NUM"); 				// 소재지 우편번호
		[5] strReturn += "; " + ds_list.GetColumn(nRow,"ADDR"); 					// 소재지
		[6] strReturn += "; " + ds_list.GetColumn(nRow,"BIZ_TYPE"); 				// 업종
		[7] strReturn += "; " + ds_list.GetColumn(nRow,"BIZ_CAT"); 					// 업태		
		[8] strReturn += "; " + ds_list.GetColumn(nRow,"UPJANG_TYPE"); 				// 업태종류(본사/사업장)
		[9] strReturn += "; " + ds_list.GetColumn(nRow,"HILVL_UPJANG"); 			// 본사 업종코드
		[10] strReturn += "; " + ds_list.GetColumn(nRow,"BIZ_NUM"); 				// 사업자번호
		[11] strReturn += "; " + ds_list.GetColumn(nRow,"UPJANG"); 					// 업장코드
 ******************************************************************************************
 */
function fn_CustInfoSetting()
{
	var nRow;
	
	nRow	= ds_main.rowposition;
	
	strResult	= gfn_split(fstrCustinfo, ";");
	
	ds_main.setColumn(nRow, "CUSTCD", gfn_trim(strResult[0]));			// 사업자번호
	ds_main.setColumn(nRow, "CUST_NAME", gfn_trim(strResult[1]));		// 사업장명
	ds_main.setColumn(nRow, "MAIL_NUM", gfn_trim(strResult[4]));		// 소재지 우편번호
	ds_main.setColumn(nRow, "CUST_ADDR", gfn_trim(strResult[5]));		// 소재지
	ds_main.setColumn(nRow, "BIZ_TYPE", gfn_trim(strResult[6]));		// 업종
	ds_main.setColumn(nRow, "BIZ_CAT", gfn_trim(strResult[7]));			// 업태
	ds_main.setColumn(nRow, "UPJANG_TYPE", gfn_trim(strResult[8]));		// 업태종류(본사/사업장)
	ds_main.setColumn(nRow, "BIZ_NUM", gfn_trim(strResult[10]));		// 사업자번호
	ds_main.setColumn(nRow, "UPJANG", gfn_trim(strResult[11]));			// 업장코드
	
	if (gfn_length(gfn_trim(strResult[9]))>0)
	{
		ds_main.setColumn(nRow, "MAIN_UPJANG", gfn_trim(strResult[9]));			// 본사 업종코드
		ds_main.setColumn(nRow, "MAIN_UPJANG_NM", gfn_trim(strResult[3]));		// 본사명
	}
	
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSearchList()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 리스트 조회 후 실행 함수
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-11-20  
 ******************************************************************************************
 */
function fn_afterSearchList(errCode, errMsg)
{	
	
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오.");

		return;
	}
	else
	{
		//st_titlecnt.Text = "  * 총 [ " + ds_list.CaseCount("USE_YN='Y'") + " ]개의 매출처가 사용";
		
		
		
		if (ds_list.rowcount > 0)
		{
			fn_SerchSub(ds_list.getColumn(ds_list.rowposition,"UPJANG"));
		}

	}
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSearch()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 사업장 조회 후 실행 함수
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-11-20  
 ******************************************************************************************
 */
function fn_afterSearch(errCode, errMsg)
{
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오");
		return;
	}
	else
	{
		fn_FormSetting();
	}
	
	var nCnt = ds_main.getColumn(ds_main.rowposition, "TRANS_CNT");
	var text = "배   송   지";
	//if ( nCnt > 1 ) {
		text += "<fc v='red'><b v='true'>["+nCnt+"]</b></fc>";
	//} else {
	//	text = "";
	//}
	
	if ( tab_list.tab1.url == "U_FMS::FMS00101E.xfdl" ) {
		tab_list.tab1.fn_setTransText(text, {upajng:ds_main.getColumn(ds_main.rowposition, "UPJANG"), cnt:nCnt});
		tab_list.tab1.Combo_Init();
	}
}


/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSave()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   : 저장
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-01-16 
 ******************************************************************************************
 */
function fn_afterSave(errCode, errMsg)
{
	if(errCode==0)
	{
		
		g_Message("02","사업장 정보가 저장되었습니다.");
		var nFRow = ds_list.findRow("UPJANG",fstrSaveUpjang);
		
		if (nFRow >= 0)
		{
			ds_list.rowposition = nFRow;
			//fn_SerchSub(fstrSaveUpjang);
			fn_search();
		}
	}
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_FileSave()
 * 입      력   : nRow : 파일입력할 row
 * 반      환   : true/false : 파일저장이 잘 됬는지 리턴
 * 기      능   : 파일저장
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-24 
 ******************************************************************************************
 */
function fn_FileSave(nRow)
{
	var strFile,strOrgFile;
	
	strFile 	= ds_list.getColumn(nRow,"PHOTO");
	/* GetOrgBuffColumn은 지원되지 않는 메서드입니다.*/ strOrgFile	= ds_list.GetOrgBuffColumn(nRow,"PHOTO");
	
	if (strFile != strOrgFile && gfn_length(strFile)> 0)
	{
		// 파일 서버로 전송 
		var arr = fsp_fileWrite(httpFile, serverSaveDir, ds_list.getColumn(nRow,"PHOTO_URL"), ds_list.getColumn(nRow,"PHOTO"));  
		
		// 처리 결과 확인하기 
		if( arr[0] == "S" ) 	// 성공 
		{
			ds_list.setColumn(nRow,"PHOTO_URL",serverSaveUrl);
			ds_list.setColumn(nRow,"SPHOTO",arr[2]);
		}
		else
		{
			g_Message("EE", "파일저장에 실패하였습니다.");
			return false;
		}
    }
    
	return true;
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_FileDelete()
 * 입      력   : nRow : 파일입력할 row
 * 반      환   : true/false : 파일삭제가 잘 됬는지 리턴
 * 기      능   : 파일삭제
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-24 
 ******************************************************************************************
 */
function fn_FileDelete(nRow)
{
	// 파일 삭제
	btp = fsp_fileDelete(serverSaveDir, ds_list.getColumn(nRow,"SPHOTO"),true);
	
	if (btp)
	{
		ds_list.setColumn(nRow,"PHOTO","");
		ds_list.setColumn(nRow,"SPHOTO","");
	}
	else
	{
		g_Message("EE", "파일삭제에 실패하였습니다.");
		return false;
	}

    
	return true;
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : grd_list_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
 * 기      능   : 사업장 그리드 클릭 시 상세내역 조회
					- 본사명을 클릭한 경우 본사 상세내역 조회, 그외의 경우 해당 사업장 상세내역 조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-11-20  
 * 수  정  자   : 최영준
 * 수정  일자   : 2015-03-18  
 ******************************************************************************************
 */
function grd_list_OnCellClick(obj:Grid, e:GridClickEventInfo)
{

	// 변경여부 확인
	//if(gfn_dsIsUpdated(ds_main)==true)
	if(gfn_dsIsUpdated(ds_main)==true||gfn_dsIsUpdated(ds_cust)==true)
	{
		if(g_Confirm("02","변경된 내역이 있습니다. 변경된 내역을 저장하시겠습니까?"))
		{
			fn_save();
		}
	}
	
	var nUPJANG;
	
	if (e.cell == 3)		// 본사명 클릭 
	{
		nUPJANG = ds_list.getColumn(e.row,"MAIN_UPJANG");
	
	}
	else				// 그외 다른셀 클릭
	{
		nUPJANG = ds_list.getColumn(e.row,"UPJANG");
	}
	
	fn_SerchSub(nUPJANG);
	
	fn_SearchFile(e.row);
}

 /******************************************************************************************
 * 함  수  명   : grd_List_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
 * 기      능   : 그리드헤드 더블클릭시 Sort
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-11-20  
 ******************************************************************************************
 */
function grd_List_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
}

 /******************************************************************************************
 * 함  수  명   : ds_main_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
 * 기      능   : 데이타 변경시 셋팅작업
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-11-20  
 ******************************************************************************************
 */
function ds_main_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	// 고객구분이 일반인 경우 코드구분 본사로 자동셋팅, 그외의 경우는 선택가능해야 함.
	if (e.columnid=="CUST_TYPE" && e.newvalue=="일반")
	{
		ds_main.setColumn(e.row,"UPJANG_TYPE","본사");
		ds_main.setColumn(e.row,"MAIN_UPJANG", ds_main.getColumn(e.row,"UPJANG"));
		ds_main.setColumn(e.row,"MAIN_UPJANG_NM", ds_main.getColumn(e.row,"CUST_NAME"));
	}
	
	// 코드구분이 본사인 경우 본사/본사그룹 자동셋팅
	if (e.columnid=="UPJANG_TYPE" && e.newvalue=="본사")
	{
		ds_main.setColumn(e.row,"MAIN_UPJANG", ds_main.getColumn(e.row,"UPJANG"));
		ds_main.setColumn(e.row,"MAIN_UPJANG_NM", ds_main.getColumn(e.row,"CUST_NAME"));
	}
	
	// 추가
	if (e.columnid=="UPJANG_TYPE" && e.newvalue=="사업장")
	{
		ds_main.setColumn(e.row,"MAIN_UPJANG", "");
		ds_main.setColumn(e.row,"MAIN_UPJANG_NM", "");
		
		ds_main.setColumn(e.row, "HEAD_CREDIT_YN", "N");
	}
	
	// 타거래처단가업장이 대표업장인 경우 타거래단가업장코드 셋팅
	if (e.columnid=="OTCUST_UPJANG_TYPE" && e.newvalue=="대표업장")
	{
		ds_main.setColumn(e.row,"OTCUST_PRICE_UPJANG",ds_main.getColumn(e.row,"UPJANG"));
		ds_main.setColumn(e.row,"OTCUST_PRICE_UPJANG_NM",ds_main.getColumn(e.row,"CUST_NAME"));
	}
	
	// 재직인원변경시 총인원 셋팅
	if (e.columnid=="CLASS1_CNT" || e.columnid=="CLASS2_CNT" || e.columnid=="CLASS3_CNT")
	{
		var nCnt = toNumber(ds_main.getColumn(e.row,"CLASS1_CNT")) + toNumber(ds_main.getColumn(e.row,"CLASS2_CNT")) + toNumber(ds_main.getColumn(e.row,"CLASS3_CNT"));
		ds_main.setColumn(e.row,"TOT_CNT",nCnt);
	}
	
	// 여신관리기준에 따라 여신일,여신액관리 셋팅,여신관리준이 관리안함인 경우 본사통합관리여부안함.
	if (e.columnid=="CREDIT_TYPE")
	{
		if (e.newvalue == "여신일+여신액")
		{
			ds_main.setColumn(e.row,"CREDIT_CONTROL_YN","Y");
			ds_main.setColumn(e.row,"CREDIT_TURN_CONTROL_YN","Y");
			ds_main.setColumn(e.row,"CREDIT_AMOUNT_CONTROL_YN","Y");
		}
		else if (e.newvalue == "여신일")
		{
			ds_main.setColumn(e.row,"CREDIT_CONTROL_YN","Y");
			ds_main.setColumn(e.row,"CREDIT_TURN_CONTROL_YN","Y");
			ds_main.setColumn(e.row,"CREDIT_AMOUNT_CONTROL_YN","N");
		}
		else if (e.newvalue == "여신액")
		{
			ds_main.setColumn(e.row,"CREDIT_CONTROL_YN","Y");
			ds_main.setColumn(e.row,"CREDIT_TURN_CONTROL_YN","N");
			ds_main.setColumn(e.row,"CREDIT_AMOUNT_CONTROL_YN","Y");
		}
		else
		{
			ds_main.setColumn(e.row,"CREDIT_CONTROL_YN","N");
			ds_main.setColumn(e.row,"CREDIT_TURN_CONTROL_YN","N");
			ds_main.setColumn(e.row,"CREDIT_AMOUNT_CONTROL_YN","N");
			ds_main.setColumn(e.row,"HEAD_CREDIT_YN","N");
		}
	}
	if(e.columnid == "PART_SALES_SABUN" || e.columnid == "CS_SABUN"){//영업사원 , SC 사원 변경시 USERINFO 에 TEL_NO 정보를 가져온다.
		sccTelNo = e.columnid;
		fn_getUserinfoTelNo(e.newvalue);
	}
	
	if ( e.columnid == "POP_REQ_YN" ) {
		switch ( e.newvalue  ) {
			case "N" :
				obj.setColumn(e.row, "POP_CNT", 0 );
				break;
				
			case "Y" :
				obj.setColumn(e.row, "POP_CNT", 1 );
				break;
		}
	}
	
	if ( e.columnid == "POP_CNT" ) {
		switch ( e.newvalue ) {
			case 0 :
				obj.setColumn(e.row, "POP_REQ_YN", "N");
				break;
				
			default :
				obj.setColumn(e.row, "POP_REQ_YN", "Y");
				break;
		}
	}
	
	fn_FormSetting();
}



function ds_main_cancolumnchange(obj:Dataset, e:DSColChangeEventInfo)
{
	var rtn = false;
	switch ( e.columnid ) {
		case "ARRIVAL_TIME_FROM" :
		case "ARRIVAL_TIME_TO" :
			if ( !gfn_isTime(e.newvalue+"00") ) {
				g_Message("EE", "입력한 시간이 올바르지 않습니다.\r\n24시간 표기법으로 입력하세요.");
				rtn = false;
			} else {
				if ( !gfn_isNull(obj.getColumn(e.row, "ARRIVAL_TIME_FROM")) ) {
					if ( (parseInt(e.newvalue) - parseInt(obj.getColumn(e.row, "ARRIVAL_TIME_FROM")))<0 ) {
						g_Message("EE", "시간 입력 범위가 올바르지 않습니다.");
						rtn = false;
					} else {
						rtn = true;
					}
				} else {
					rtn = true;
				}
			}
			break;
		default :
			rtn = true;
			break;
	}
	return rtn;
}

 /******************************************************************************************
 * 함  수  명   : btn_Copy_OnClick(obj)
 * 기      능   : 불러오기 - 기존에 입력된 사업장 정보를 조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-11-20 
 ******************************************************************************************
 */
function btn_Copy_OnClick(obj:Button, e:ClickEventInfo)
{	
	// 팝업
	
	var btp = gfn_dialog("", "U_FMS::FMS00104P.xfdl","");
	fn_CustInfoSetting();
	fn_FormSetting();
}

 /******************************************************************************************
 * 함  수  명   : sed_common_OnChar(obj,strPreText,nChar,strPostText,LLParam,HLParam)
 * 기      능   : 검색조건 엔터시 조회
 * 작  성  자   : 박지영
 * 작성  일자   : 2007-11-20 
 ******************************************************************************************
 */
 function ed_S_SAUPNO_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13)	// 엔터
	{
		fn_search();
	}	
}

function ed_empNm_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13)	// 엔터
	{
		fn_search();
	}	
}

// function sed_common_OnChar(obj:Edit, e:CharEventInfo)
// {
// 	if (e.chartext == 13)	// 엔터
// 	{
// 		fn_search();
// 	}
// }




function ds_main_OnRowPosChanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{	
	var v_path="FMS_UPJANG_STAMP";	
	
	if (gfn_length(gfn_trim(ds_main.getColumn(e.newrow,"STAMP_IMG")))== 0) {
		tab_list.tab2.img_photo.image = "";		
	}
	else
	{
		tab_list.tab2.img_photo.image = fsp_getServerDir(v_path, ds_main.getColumn(e.newrow,"STAMP_IMG"));				
	}
	tab_list.tab1.comp_addr.bind();
	tab_list.tab1.comp_custAddr.bind();
}



/*
function ds_list_OnRowPosChanged(obj,nOldRow,nRow)
{

	if (length(trim(ds_list.GetColumn(nRow,"STAMP_IMG"))) == 0) {
		tab_list.tab2.img_photo.ImageID = "";
	}
	else
	{
		tab_list.tab2.img_photo.ImageID=fsp_getServerDir(tab_list.tab1.v_path,ds_list.GetColumn(nRow,"STAMP_IMG"));
	}	
}
*/

/*
 ******************************************************************************************
 * 함  수  명   : fn_SearchFile(nRow)
 * 입      력   : nRow : Master Row
 * 반      환   : 없음
 * 기      능   : 조회 후 실행 함수-파일찾기
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-13  
 ******************************************************************************************
 */
function fn_SearchFile(nRow)
{
	var strFileNm, nARow;
	
	
	tab_list.tab3.ds_file.enableevent = false;
	
	tab_list.tab3.ds_file.clearData();
	
	for(i=1; i<=5 ; i++)
	{
		strFileNm = ds_list.getColumn(nRow,"DOCU_FILE" + i);
		
		if (gfn_length(strFileNm)<= 0) continue;

		nARow = tab_list.tab3.ds_file.addRow();
		tab_list.tab3.ds_file.setColumn(nARow, "FILE_NM", ds_list.getColumn(nRow, "DOCU_FILE" + i ) );
		tab_list.tab3.ds_file.setColumn(nARow, "S_FILE_NM", ds_list.getColumn(nRow, "SDOCU_FILE" + i ) );
		tab_list.tab3.ds_file.setColumn(nARow, "FILE_SIZE", ds_list.getColumn(nRow, "SDOCU_FILE_SIZE" + i ) );
		tab_list.tab3.ds_file.setColumn(nARow, "FLAG", "S");
		tab_list.tab3.ds_file.setColumn(nARow, "SHOW_NM", ds_list.getColumn(nRow, "DOCU_FILE" + i )  
					+ "(" + Math.round((toNumber(ds_list.getColumn(nRow, "SDOCU_FILE_SIZE" + i ))/1024),0) 
					+ "KB)" );
	}
	tab_list.tab3.ds_file.filter("FLAG != 'D'");
	tab_list.tab3.ds_file.applyChange();
	tab_list.tab3.ds_file.enableevent = true;

	// 전체 파일 사이즈 계산 
	tab_list.tab3.med_fileSize.value = Math.round(tab_list.tab3.ds_file.getSum("FILE_SIZE")/1024, 0); 
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_FileSave()
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 첨부파일저장
 * 작  성  자   : 박지영
 * 작성  일자   : 2008-03-03
 ******************************************************************************************
 */
function fn_FileSaveSafe()
{
	// 첨부파일 저장 
    //fn_createWait("첨부파일 저장 중입니다.", this);	As-Is
    setCapture();
    SetWaitCursor(true);
    
    tab_list.tab3.ds_file.enableevent = false;
    tab_list.tab3.ds_file.filter("");
    
    var nRow;
    var isOk = true;
    
    nRow = ds_list.rowposition;
    
    for( var i = 0; i < tab_list.tab3.ds_file.getRowCount(); i++) 
    {
        if ( tab_list.tab3.ds_file.getColumn(i, "FLAG") == "I" ) 
        {
            // 서버로 전송 
            var arr = fsp_fileWrite(httpFile, serverSaveDir
                , tab_list.tab3.ds_file.getColumn(i, "FILE_PATH")
                , tab_list.tab3.ds_file.getColumn(i, "FILE_NM")); 
            if ( arr[0] != "S" ) {
                isOk = "파일 전송 실패\n"+ arr[1];
                break;
            }
            
            tab_list.tab3.ds_file.setColumn(i, "S_FILE_NM", arr[2] ); // 서버 파일명 
        } 
        else if ( tab_list.tab3.ds_file.getColumn(i, "FLAG") == "D" ) 
        {
            // 삭제 
            var isDelete = fsp_fileDelete(serverSaveDir, tab_list.tab3.ds_file.getColumn(i, "S_FILE_NM"), true);
            if ( isDelete == false) {
                isOk = "파일 삭제에 실패했습니다.";
                break;
            }
        }
    }   // end for 
    
    tab_list.tab3.ds_file.filter(" FLAG <> 'D'");
    tab_list.tab3.ds_file.applyChange();
    tab_list.tab3.ds_file.enableevent = true;

	
	//////Master셋팅//////
	//초기화
	for(var i=1; i<=5; i++) 
	{ 
		ds_main.setColumn(0,"DOCU_FILE" + gfn_toString(i), "");
		ds_main.setColumn(0,"SDOCU_FILE" + gfn_toString(i), "");
		ds_main.setColumn(0,"SDOCU_FILE_SIZE" + gfn_toString(i), "");
	}

	//재세팅
	for(var i=0; i<tab_list.tab3.ds_file.getRowCount(); i++) 
	{
		ds_main.setColumn(0,"DOCU_FILE" + gfn_toString(i+1), tab_list.tab3.ds_file.getColumn(i,"FILE_NM"));
		ds_main.setColumn(0,"SDOCU_FILE" + gfn_toString(i+1), tab_list.tab3.ds_file.getColumn(i,"S_FILE_NM"));
		ds_main.setColumn(0,"SDOCU_FILE_SIZE" + gfn_toString(i+1), tab_list.tab3.ds_file.getColumn(i,"FILE_SIZE"));
	}
    //////////////////////
    
    //fn_destroyWait();	As-Is
    releaseCapture();
    SetWaitCursor(false);
    
    // 실패 
    if ( isOk  != true ) {
        gfn_alert( isOk );
        return;
    }
}

function ed_S_MAIN_UPJANG_onkeydown(obj:Edit, e:KeyEventInfo)
{
	 if (e.keycode == 13)	// 엔터
	{
		fn_search();
	}
}

function ed_S_UPJANG_onkeydown(obj:Edit, e:KeyEventInfo)
{
	 if (e.keycode == 13)	// 엔터
	{
		fn_search();
	}
} 

 
function fileDialog_onclick(obj:MPFileDialog,  e:ClickEventInfo)
{
	fn_search();
}

function fileDialog_oninit(obj:MPFileDialog, e:InitEventInfo)
{
	fn_search();
}


/*
 ******************************************************************************************
 * 함  수  명   : ds_cust_onvaluechanged(obj:Dataset,  e:DSColChangeEventInfo)
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : Grid내 라디오 박스 한개만 체크하게 함.
 * 작  성  자   : 최영준
 * 작성  일자   : 2015-03-30
 ******************************************************************************************
 */
function ds_cust_onvaluechanged(obj:Dataset,  e:DSColChangeEventInfo)
{
	if(e.columnid == 'MAIN_YN')
	{
		var mainYn = 0;
		for(i=0; i<ds_cust.getRowCount(); i++)
		{
			if(ds_cust.getColumn(i, 'MAIN_YN') == '1')	ds_cust.setColumn(i, 'MAIN_YN','Y');
			
			if(ds_cust.getColumn(i, 'MAIN_YN') == 'Y')	mainYn++;
			else ds_cust.setColumn(i,'MAIN_YN','N');
		}
		
		if(mainYn > 1)
		{
			for(i=0; i<ds_cust.getRowCount(); i++)
			{
				if(i == e.row)
				{
					ds_cust.setColumn(e.row, 'MAIN_YN', 'Y');
					continue;
				}
				ds_cust.setColumn(i, 'MAIN_YN', 'N');
			}
		}
	}	
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_getUserinfoTelNo(sabun)
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 영업사원,C/S사원 변경시 연락처 SCC_USERINFO 테이블에 TEL_NO를 가져온다.
 * 작  성  자   : 손형민
 * 작성  일자   : 2015-09-09
 ******************************************************************************************
 */
function fn_getUserinfoTelNo(sabun){
	ds_telno.clearData();
	
	var actionName, cmdName, inData, outData, otherArg, callBackFnc;
	
	inData			= "ds_input=ds_input";
	outData			= "ds_telno=ds_telno";
	callBackFnc		= "fn_sabunTelNo";
	otherArg		= "p_MaskAuth="	+ SCAuth.getMaskAuth(this);
	// 파라미터셋팅
	ds_input.setColumn(0,"SABUN",sabun);						//사원코드
	
	fsp_clear(this); 
    fsp_addSearch(this, "fm/fms:FMS00100E_S006");									// 조회 
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출    
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_sabunTelNo(errCode, errMsg)
 * 입      력   : 없음
 * 반      환   : 없음
 * 기      능   : 조회된 TEL_NO를 연락처에 셋팅해 준다.
 * 작  성  자   : 손형민
 * 작성  일자   : 2015-09-09
 ******************************************************************************************
 */
function fn_sabunTelNo(errCode, errMsg)
{	
	
	if(errCode!=0)
	{
		g_Message("EE", "서비스 오류:시스템 관리자에게 문의하십시오.");

		return;
	}
	else
	{
		if (ds_telno.rowcount > 0)
		{
			var tel_no = "";
			if(gfn_length(ds_telno.getColumn(0,"TEL_NO"))== 10){
				if (gfn_left(ds_telno.getColumn(0,"TEL_NO"), 2) == "02") 
					tel_no = gfn_getFormat(ds_telno.getColumn(0,"TEL_NO"), "@@-@@@@-@@@@");
				else 
					tel_no = gfn_getFormat(ds_telno.getColumn(0,"TEL_NO"), "@@@-@@@-@@@@");
			}else if(gfn_length(ds_telno.getColumn(0,"TEL_NO"))== 11){
				tel_no = gfn_getFormat(ds_telno.getColumn(0,"TEL_NO"), "@@@-@@@@-@@@@");
			}else{
				tel_no = ds_telno.getColumn(0,"TEL_NO");
			}

			if(sccTelNo == "PART_SALES_SABUN"){
				ds_main.setColumn(ds_main.rowposition,"PART_SALES_TEL_NO",gfn_getFormat(ds_telno.getColumn(0,"HP_NO"), "@@@-@@@@-@@@@"));
			}else if(sccTelNo == "CS_SABUN"){
				ds_main.setColumn(ds_main.rowposition,"CS_TEL_NO",tel_no);
			}
		}else{
			if(sccTelNo == "PART_SALES_SABUN"){
				ds_main.setColumn(ds_main.rowposition,"PART_SALES_TEL_NO","");
			}else if(sccTelNo == "CS_SABUN"){
				ds_main.setColumn(ds_main.rowposition,"CS_TEL_NO","");
			}
		}
		
	}
}

/*
 전화번호 입력란 검색 기능 추가 : 2015-11-12
*/
function div_mainSearch_ed_S_TEL_NO_onkeydown(obj:Edit, e:KeyEventInfo)
{
	 if (e.keycode == 13)	// 엔터
	{
		fn_search();
	}
}
function div_mainSearch_Button00_onclick(obj:Button,  e:ClickEventInfo)
{
	//trace(tab_list.tab1.rdo_UPJANG_TYPE.value);
	//trace(tab_list.tab3.rdo_HEAD_CREDIT_YN.value);
	
	//변경한 내용이 사업장중 통합여부를 Y로 바꾼 업장
	if(tab_list.tab1.rdo_UPJANG_TYPE.value == "사업장" && tab_list.tab3.rdo_HEAD_CREDIT_YN.value == "Y")
	{
		//그 업장의 해당 메인업장의 통합여부를 Y로 변경
		fn_changeMainHead(ds_list.getColumn(ds_list.rowposition,"UPJANG"));
	}
}

/*특정 업장의 메인업장의 통합여부를 Y로 바꿔주는 함수*/
function fn_changeMainHead(sUpjang)
{
    // 서비스셋팅
    var actionName, cmdName, inData, outData, otherArg, callBackFnc;
    var insertSql, updateSql, deleteSql,saveFlagColumn, keySqlName, keyIncrement, callbackSql;
    
    //trace(ds_main.saveXML());
    
    inData		= "ds_input=ds_main:U";
    outData		= "ds_main=ds_main";
    callBackFnc	= "";
	otherArg 	= "g_EmpNo="+wrapQuote(g_EmpNo);
       
    fsp_clear(this);
    fsp_addSave(this, "", "fm/fms:FMS00100E_U006", "", saveFlagColumn, keySqlName, keyIncrement, callbackSql);
    fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);		// 서비스 호출 
}


// 개인정보 없이 엑셀 출력
function btn_excel_onclick(obj:Button,  e:ClickEventInfo) {
	try {
		grd_list.enableredraw = false;
		grd_list.setFormat("excel");
		grd_list.persinfo = "N";
		gfn_exportExcel(grd_list);
	} catch (e) {
	
	} finally {
		grd_list.setFormat("Default");
		grd_list.persinfo = "Y";
		grd_list.enableredraw = true;
	}
}

function fn_checkTransInfo() {
	if ( gfn_dsIsUpdated(ds_main) == true ) {
		trace("#after#"+ds_main.getColumn(0, "ADDR_INFO"));
		trace("#before#"+ds_main.getOrgColumn(0, "ADDR_INFO"));
		var addrInfo = ds_main.getColumn(0, "ADDR_INFO");
		if ( addrInfo != ds_main.getOrgColumn(0, "ADDR_INFO") ) {
			var oAddrInfo = gfn_jsonStringToObject(addrInfo);
			var key = oAddrInfo.addrClass;
			var transInfo1 = oAddrInfo["baseAddr"+key];
			var transInfo2 = "";
				transInfo2 += oAddrInfo["detailAddr"+key];
				transInfo2 += " " + oAddrInfo["etcAddr"];
				
				ds_main.setColumn(0, "ADDR_TEMP1", transInfo1);
				ds_main.setColumn(0, "ADDR_TEMP2", transInfo2);
				ds_main.setColumn(0, "ZIP_CD", oAddrInfo["zipCode"+key]);
		}
	}
}
 
 

function Combo_OnChanged(obj:Combo, e:ItemChangeEventInfo)
{
	
	var v_cond; 
	switch(obj.name)
	{
		case "Cbo_MasterClass0_S":
			
			//g_Message("EE", gfn_length(gfn_trim(Cbo_MasterClass0.value)) );
			if( gfn_length(gfn_trim(div_mainSearch.Cbo_MasterClass0_S.value))== 0)
			{
				ds_class1_S.filter("0");
				ds_class2_S.filter("0");
				ds_class3_S.filter("0");	
				ds_class4_S.filter("0");				
			}
			else
			{
				v_cond = "gfn_length(gfn_trim(CODE))==0 || gfn_subStr(CODE,0,2)=='" + gfn_trim(div_mainSearch.Cbo_MasterClass0_S.value)+"'";
			//g_Message("EE", v_cond );
				ds_class1_S.filter(v_cond);
				ds_class2_S.filter("0");
				ds_class3_S.filter("0");
			}
			div_mainSearch.Cbo_MasterClass1_S.index = 0;
			div_mainSearch.Cbo_MasterClass2_S.index = 0;
			div_mainSearch.Cbo_MasterClass3_S.index = 0;
			div_mainSearch.Cbo_MasterClass4_S.index = 0;
			break;
		case "Cbo_MasterClass1_S":
			
			//g_Message("EE", Cbo_MasterClass1.value);
			if( gfn_length(gfn_trim(div_mainSearch.Cbo_MasterClass1_S.value))== 0)
			{
				ds_class2_S.filter("0");
				ds_class3_S.filter("0");		
				ds_class4_S.filter("0");			
			}
			else
			{
				v_cond = "gfn_length(gfn_trim(CODE))==0 || gfn_subStr(CODE,0,4)=='" + gfn_trim(div_mainSearch.Cbo_MasterClass1_S.value)+"'";
				ds_class2_S.filter(v_cond);
				ds_class3_S.filter("0");		
				ds_class4_S.filter("0");
			}
			div_mainSearch.Cbo_MasterClass2_S.index = 0;
			div_mainSearch.Cbo_MasterClass3_S.index = 0;
			div_mainSearch.Cbo_MasterClass4_S.index = 0;
			break;
		case "Cbo_MasterClass2_S":
		
			//g_Message("EE", Cbo_MasterClass3.value);
			if( gfn_length(gfn_trim(div_mainSearch.Cbo_MasterClass2_S.value))== 0)
			{
				v_cond = "gfn_length(gfn_trim(CODE))==0 || gfn_subStr(CODE,0,4)=='" + gfn_trim(div_mainSearch.Cbo_MasterClass1_S.value)+"'";				
				ds_class3_S.filter("0");		
				ds_class4_S.filter("0");

			}
			else
			{
				v_cond = "gfn_length(gfn_trim(CODE))==0 || gfn_subStr(CODE,0,6)=='" + gfn_trim(div_mainSearch.Cbo_MasterClass2_S.value)+"'";				
				ds_class3_S.filter(v_cond);		
				ds_class4_S.filter("0");
			}
			div_mainSearch.Cbo_MasterClass3_S.index = 0;	
			div_mainSearch.Cbo_MasterClass4_S.index = 0;		
			break;
		case "Cbo_MasterClass3_S":
		
			//g_Message("EE", Cbo_MasterClass3.value);
			if( gfn_length(gfn_trim(div_mainSearch.Cbo_MasterClass3_S.value))== 0)
			{
				v_cond = "gfn_length(gfn_trim(CODE))==0 || gfn_subStr(CODE,0,6)=='" + gfn_trim(div_mainSearch.Cbo_MasterClass2_S.value)+"'";				
				ds_class4_S.filter("0");

			}
			else
			{
				v_cond = "gfn_length(gfn_trim(CODE))==0 || gfn_subStr(CODE,0,8)=='" + gfn_trim(div_mainSearch.Cbo_MasterClass3_S.value)+"'";				
				ds_class4_S.filter(v_cond);
			}
			div_mainSearch.Cbo_MasterClass4_S.index = 0;	
		    break;
		case "Cbo_MasterClass4_S":
			
		    break;
		default:
			ds_class1_S.filter("");
			ds_class2_S.filter("0");
			ds_class3_S.filter("0");
			ds_class4_S.filter("0");
		    break;
	}
}

function div_mainSearch_ed_empNm_onkeydown(obj:Edit, e:KeyEventInfo) {
	if (e.keycode == 13) {
		fn_search();
	}	
}

/* 사고채권여부 라디오버튼 선택 권한 체크 */
function fn_aaArAuthChk()
{	
	ds_Auth_in.setColumn(0,"SABUN",g_EmpNo); //로그인 사용자 정보(사번으로 권한 체크)
	fsp_clear(this);	
	fsp_addSearch(this, "fm/fms:FMS00175E_S002");
	http.Sync = true;
	fsp_callService(this, "", "", "ds_Auth_in=ds_Auth_in","ds_Auth_out=ds_Auth_out","","");
	http.Sync = false;
}
]]></Script>
  </Form>
</FDL>

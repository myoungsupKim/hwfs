<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="FMM00034E" onkeydown="FMM00034E_OnKeyDown" onload="form_onload" titletext="사업장 레시피관리 Body" position="absolute 0 0 1237 806" scrollbars="none">
    <Layouts>
      <Layout>
        <Button id="btn_RECIPE_ELEMENT" onclick="btn_RECIPE_ELEMENT_OnClick" taborder="22" position="absolute 0 446 112 467" class="btn_WF_Custom" image="" text="레시피영양성분"/>
        <Button id="btn_RATIO" onclick="btn_RATIO_OnClick" taborder="23" position="absolute 114 446 249 467" class="btn_WF_Custom" image="" text="레시피비율일괄변경"/>
        <ImageViewer stretch="fit" id="img_RECIPE_PHOTO" image="URL('theme://convertImages/img_NoImageBig.png')" onloaderror="img_RECIPE_PHOTO_OnLoadError" transparenthittest="false" taborder="29" position="absolute 0 0 143 105"/>
        <Radio codecolumn="CD" columncount="3" datacolumn="NM" id="rdo_FOOTER_GUBUN" index="0" innerdataset="ds_FOOTER_GUBUN" onitemchanged="rdo_FOOTER_GUBUN_OnChanged" taborder="20" position="absolute 129 118 330 134"/>
        <Grid autoenter="select" binddataset="ds_ITEM_LIST" cellmovingtype="col" cellsizingtype="both" readonly="false" enable="true" id="grd_ITEM_LIST" useinputpanel="false" oncellclick="grd_ITEM_LIST_OnCellClick" onheadclick="grd_ITEM_LIST_OnHeadClick" onkeydown="grd_ITEM_LIST_OnKeyDown" onmousemove="grd_ITEM_LIST_OnMouseOver" taborder="21" tabstop="true" usecontextmenu="true" useselcolor="true" visible="true" wheelscrollrow="1" position="absolute 0 136 1227 441" selecttype="row" anchor="left top right" autofittype="col">
          <Formats>
            <Format id="Default">
              <Columns>
                <Column size="20"/>
                <Column size="25"/>
                <Column size="20"/>
                <Column size="80"/>
                <Column size="26"/>
                <Column size="300"/>
                <Column size="180"/>
                <Column size="0"/>
                <Column size="44"/>
                <Column size="0"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="60"/>
                <Column size="162"/>
                <Column size="26"/>
                <Column size="50"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" displaytype="text" class="head_Excel"/>
                <Cell col="1" rowspan="2" displaytype="text" text="상&#10;태"/>
                <Cell col="2" rowspan="2" colspan="3" displaytype="text" text="상품코드"/>
                <Cell col="5" rowspan="2" displaytype="text" text="상 품 명"/>
                <Cell col="6" rowspan="2" displaytype="text" text="규격"/>
                <Cell col="7" rowspan="2" displaytype="text" text="원산지"/>
                <Cell col="8" rowspan="2" displaytype="text" text="단위"/>
                <Cell col="9" rowspan="2" displaytype="text" text="상품&#10;정보"/>
                <Cell col="10" rowspan="2" displaytype="text" text="1인소요량&#10;(g)"/>
                <Cell col="11" rowspan="2" displaytype="text" text="가식부량&#10;(g)"/>
                <Cell col="12" rowspan="2" displaytype="text" text="1인원가&#10;(원)"/>
                <Cell col="13" rowspan="2" colspan="2" displaytype="text" text="커팅규격"/>
                <Cell col="15" rowspan="2" displaytype="text" text="에너지&#10;(kcal)"/>
              </Band>
              <Band id="body">
                <Cell displaytype="text" style="align:center;" expr="expr:currow+1"/>
                <Cell col="1" displaytype="image" style="selectbackground: ;" text="expr:iif(ITEM_CODE!=&quot;010708010198&quot;, iif(RESTRICT_YN==&quot;Y&quot;, &quot;URL('theme://convertImages/img_RC.png')&quot;, &quot;&quot;))"/>
                <Cell col="2" displaytype="image" style="align: ;" text="URL('theme://images/new/grd_WF_ExpandImageX.png')"/>
                <Cell col="3" displaytype="text" style="align:left;" text="bind:ITEM_CODE"/>
                <Cell col="4" displaytype="image" style="align:center;" text="expr:getRowType(currow)==2?&quot;URL('theme://Images/new/grd_WF_ExpandImage.png')&quot;:&quot;&quot;"/>
                <Cell col="5" displaytype="text" style="align:left;" text="bind:ITEM_NAME"/>
                <Cell col="6" displaytype="text" style="align:left;" text="bind:ITEM_SIZE"/>
                <Cell col="7" displaytype="text" style="align:left;" text="bind:ORIGIN_TYPE"/>
                <Cell col="8" displaytype="text" style="align:left;" text="bind:PO_UOM"/>
                <Cell col="9" displaytype="text" style="align:left;" text="bind:FEATURE_NAME" mask="\\"/>
                <Cell col="10" displaytype="number" edittype="text" editfilter="number" style="align:right;background:cornsilk;background2:cornsilk;" text="bind:NEED_QTY"/>
                <Cell col="11" displaytype="number" style="align:right;" text="bind:EDIBLE_QTY"/>
                <Cell col="12" displaytype="number" style="align:right;" text="bind:PERSON_PRICE"/>
                <Cell col="13" displaytype="combo" edittype="combo" style="align:left;" text="bind:CUT_SPEC" combodataset="ds_CUT_SPEC" combocodecol="CODE" combodatacol="CODE_NAME"/>
                <Cell col="14" displaytype="image" edittype="none" style="align:center;" text="URL('theme://Images\new\grd_WF_ExpandImage.png')"/>
                <Cell col="15" displaytype="number" style="align:right;" text="bind:CAL_CALC"/>
              </Band>
              <Band id="summary">
                <Cell colspan="9" displaytype="text" style="align:center;" text="합    계" taborder="undefined"/>
                <Cell col="9" displaytype="text" style="align:center;" text="합    계"/>
                <Cell col="10" displaytype="number" style="align:right;" expr="expr:getSum('NEED_QTY')"/>
                <Cell col="11" displaytype="number" style="align:right;" text="합    계" expr="getSum('EDIBLE_QTY')"/>
                <Cell col="12" displaytype="number" style="align:right;" expr="expr:getSum('PERSON_PRICE')"/>
                <Cell col="13" displaytype="number" style="align:right;"/>
                <Cell col="14" displaytype="text" style="align:right;"/>
                <Cell col="15" displaytype="number" style="align:right;" expr="expr:getSum('CAL_CALC')"/>
                <Cell col="16" displaytype="text" style="align:left;"/>
                <Cell col="17" displaytype="number" style="align:right;" expr="expr:getSum('CAL_CALC')"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Div id="div_Footer" taborder="25" text="Div0" position="absolute 0 472 1227 806" scrollbars="none" anchor="left top right" asyncmode="false">
          <Layouts>
            <Layout width="1227" height="334"/>
          </Layouts>
        </Div>
        <Edit id="ed_RATIO" maxlength="3" inputtype="number" taborder="24" visible="false" position="absolute 251 446 322 467" style="align:right;"/>
        <Static id="st_PERCENT" text="%" visible="false" position="absolute 324 446 339 467"/>
        <Static id="Static1" text="재료구성" position="absolute 0 118 125 138" class="sta_WF_Title01"/>
        <Static id="Static09" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1227 0 1237 677"/>
        <Static id="Static43" class="sta_WFDA_Labelbg" position="absolute 216 52 1227 105" anchor="left top right"/>
        <Static id="Static14" class="sta_WFDA_Labelbg" position="absolute 216 52 1227 79" anchor="left top right"/>
        <Static id="Static01" class="sta_WFDA_Labelbg" position="absolute 274 0 987 53"/>
        <Static id="Static08" class="sta_WFDA_Labelbg" position="absolute 267 26 1227 53" anchor="left top right"/>
        <Static id="Static05" class="sta_WFDA_Labelbg" position="absolute 267 0 1227 27" anchor="left top right"/>
        <Static id="Static02" text="기본&#10;정보" class="sta_WFDA_Label03" position="absolute 144 0 192 53"/>
        <Static id="Static07" text="레시피코드/명" class="sta_WFDA_Label01" position="absolute 191 0 284 27"/>
        <Static id="Static10" text="조 리 법 유 형" class="sta_WFDA_Label01" position="absolute 191 26 284 53"/>
        <Static id="Static11" text="레 시 피 분 류" class="sta_WFDA_Label01" position="absolute 548 0 652 27"/>
        <Static id="Static13" text="대표 영양성분" class="sta_WFDA_Label01" position="absolute 548 26 652 53"/>
        <Static id="Static16" text="레 시 피 유 형" class="sta_WFDA_Label01" position="absolute 858 0 948 27"/>
        <Static id="Static18" text="주  재  료  군" class="sta_WFDA_Label01" position="absolute 858 26 948 53"/>
        <Static id="Static19" text="모양" class="sta_WFDA_Label01" position="absolute 191 52 284 79"/>
        <Static id="Static20" text="질감" class="sta_WFDA_Label01" position="absolute 191 78 284 105"/>
        <Static id="Static21" text="품질&#10;정보" class="sta_WFDA_Label03" position="absolute 144 52 192 105"/>
        <Static id="Static23" text="맛" class="sta_WFDA_Label01" position="absolute 398 52 430 79"/>
        <Static id="Static24" text="색" class="sta_WFDA_Label01" position="absolute 398 78 430 105"/>
        <Static id="Static27" text="제공&#10;정보" class="sta_WFDA_Label03" position="absolute 548 52 588 105"/>
        <Static id="Static29" text="제공온도" class="sta_WFDA_Label01" position="absolute 587 52 652 79"/>
        <Static id="Static30" text="추천계절" class="sta_WFDA_Label01" position="absolute 587 78 652 105"/>
        <Static id="Static32" text="중심온도체크" class="sta_WFDA_Label01" position="absolute 858 52 948 79"/>
        <Static id="Static34" text="PHF" class="sta_WFDA_Label01" position="absolute 858 78 948 105"/>
        <Static id="Static46" text="원  가" class="sta_WFDA_Label01" position="absolute 1029 78 1081 105"/>
        <Static id="Static35" text="찬   기" class="sta_WFDA_Label01" position="absolute 1029 52 1081 79"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="cbo_RECIPE_CLASS" innerdataset="ds_RECIPE_CLASS" taborder="2" position="absolute 654 3 856 24" displayrowcount="15"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="cbo_MAIN_ITEM_CODE" innerdataset="ds_MAIN_ITEM_CODE" taborder="6" position="absolute 950 29 1224 50" displayrowcount="15"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="cbo_RESP_NUT" innerdataset="ds_Nut" taborder="5" position="absolute 654 29 856 50" displayrowcount="15"/>
        <Edit id="ed_MODE" taborder="28" tooltiptext="저장옵션(표준신규:표준수정:업장수정)" visible="false" position="absolute 362 29 376 50"/>
        <Edit id="ed_HALL_CLASS" taborder="27" tooltiptext="식당군" visible="false" position="absolute 338 29 352 50"/>
        <Edit id="ed_UPJANG" taborder="26" tooltiptext="업장" visible="false" position="absolute 319 29 333 50"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="cbo_CUISINE_TYPE" innerdataset="ds_Cuisine" taborder="4" position="absolute 286 29 546 50" displayrowcount="15"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="cbo_RECIPE_SHAPE" innerdataset="@ds_RECIPE_SHAPE" taborder="7" position="absolute 286 55 396 76" displayrowcount="15"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="cbo_RECIPE_TASTE" innerdataset="@ds_RECIPE_TASTE" taborder="8" position="absolute 432 55 546 76" displayrowcount="15"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="cbo_RECIPE_COLOR" innerdataset="@ds_RECIPE_COLOR" taborder="13" position="absolute 432 81 546 102" displayrowcount="15"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="cbo_RECIPE_FEEL" innerdataset="@ds_RECIPE_FEEL" taborder="12" position="absolute 286 81 396 102" displayrowcount="15"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="cbo_RECIPE_TEMPER" innerdataset="@ds_RECIPE_TEMPER" taborder="9" position="absolute 654 55 856 76" displayrowcount="15"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" id="cbo_USE_TOOL" innerdataset="ds_USE_TOOL" taborder="11" position="absolute 1083 55 1225 76" displayrowcount="15"/>
        <Edit enable="false" id="ed_CORE_TEMPER" imemode="native" onkeydown="ed_UPJANG_OnKeyDown" readonly="true" taborder="10" tooltiptext="사업장" position="absolute 950 55 1027 76"/>
        <Edit enable="false" id="ed_PHF" imemode="native" onkeydown="ed_UPJANG_OnKeyDown" readonly="true" taborder="18" tooltiptext="사업장" position="absolute 950 81 1027 102"/>
        <Edit id="ed_RECIPE_NAME" imemode="native" taborder="1" tooltiptext="사업장" position="absolute 358 3 546 24"/>
        <Edit enable="false" id="ed_RECIPE_CD" imemode="native" readonly="true" taborder="0" tooltiptext="사업장" position="absolute 286 3 356 24"/>
        <MaskEdit enable="false" id="ed_RECIPE_COST" mask="#,##0" taborder="19" value="me_RecipeCost" position="absolute 1083 81 1225 102"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" enable="false" id="cbo_RECIPE_TYPE" innerdataset="ds_RECIPE_TYPE" taborder="3" position="absolute 950 3 1224 24" displayrowcount="15"/>
        <CheckBox id="chk_Dtlyn" taborder="14" text="봄" value="N" truevalue="Y" falsevalue="N" enable="false" position="absolute 656 81 693 102"/>
        <CheckBox id="Checkbox0" taborder="15" text="여름" value="N" truevalue="Y" falsevalue="N" enable="false" position="absolute 704 81 748 102"/>
        <CheckBox id="Checkbox1" taborder="16" text="가을" value="N" truevalue="Y" falsevalue="N" enable="false" position="absolute 757 81 801 102"/>
        <CheckBox id="Checkbox2" taborder="17" text="겨울" value="N" truevalue="Y" falsevalue="N" enable="false" position="absolute 810 81 853 102"/>
        <Static id="Static00" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 105 450 118" anchor="left top"/>
        <Static id="Static03" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 131 450 136"/>
        <Static id="Static04" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 441 450 446"/>
        <Static id="Static06" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 467 450 472"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_FOOTER_GUBUN">
        <ColumnInfo>
          <Column id="CD" size="256" type="STRING"/>
          <Column id="NM" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CD">FMM00036E</Col>
            <Col id="NM">조리법</Col>
          </Row>
          <Row>
            <Col id="CD">FMM00037E</Col>
            <Col id="NM">PHF관리</Col>
          </Row>
          <Row>
            <Col id="CD">FMM00038E</Col>
            <Col id="NM">조리공정</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_INPUT">
        <ColumnInfo>
          <Column id="GUBUN" size="256" type="STRING"/>
          <Column id="MAIN_UPJANG" size="256" type="INT"/>
          <Column id="UPJANG" size="256" type="INT"/>
          <Column id="SUBINV_CLASS" size="256" type="STRING"/>
          <Column id="RECIPE_CD" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_RECIPE_INFO"/>
      <Dataset id="ds_RECIPE_SHAPE"/>
      <Dataset id="ds_RECIPE_TASTE"/>
      <Dataset id="ds_RECIPE_FEEL"/>
      <Dataset id="ds_RECIPE_TEMPER"/>
      <Dataset id="ds_USE_TOOL"/>
      <Dataset id="ds_ITEM_LIST" oncolumnchanged="ds_ITEM_LIST_OnColumnChanged"/>
      <Dataset id="ds_RECIPE_COLOR"/>
      <Dataset id="ds_RECIPE_CUISINE"/>
      <Dataset id="ds_RECIPE_PHF" oncolumnchanged="ds_RECIPE_PHF_OnColumnChanged"/>
      <Dataset id="ds_PREFER"/>
      <Dataset id="ds_CUT_SPEC"/>
      <Dataset id="ds_CUISINE_TYPE"/>
      <Dataset id="ds_CUISINE_LIST"/>
      <Dataset id="ds_CHK_RECIPE"/>
    </Objects>
    <Bind>
      <BindItem id="cbo_RECIPE_CLASS_value" compid="cbo_RECIPE_CLASS" propid="value" datasetid="ds_RECIPE_INFO" columnid="RECIPE_CLASS"/>
      <BindItem id="cbo_MAIN_ITEM_CODE_value" compid="cbo_MAIN_ITEM_CODE" propid="value" datasetid="ds_RECIPE_INFO" columnid="MAIN_ITEM_CODE1"/>
      <BindItem id="cbo_RESP_NUT_value" compid="cbo_RESP_NUT" propid="value" datasetid="ds_RECIPE_INFO" columnid="RESP_NUT1"/>
      <BindItem id="cbo_CUISINE_TYPE_value" compid="cbo_CUISINE_TYPE" propid="value" datasetid="ds_RECIPE_INFO" columnid="CUISINE_TYPE"/>
      <BindItem id="cbo_RECIPE_SHAPE_value" compid="cbo_RECIPE_SHAPE" propid="value" datasetid="ds_RECIPE_INFO" columnid="RECIPE_SHAPE"/>
      <BindItem id="cbo_RECIPE_TASTE_value" compid="cbo_RECIPE_TASTE" propid="value" datasetid="ds_RECIPE_INFO" columnid="RECIPE_TASTE"/>
      <BindItem id="cbo_RECIPE_COLOR_value" compid="cbo_RECIPE_COLOR" propid="value" datasetid="ds_RECIPE_INFO" columnid="RECIPE_COLOR"/>
      <BindItem id="cbo_RECIPE_FEEL_value" compid="cbo_RECIPE_FEEL" propid="value" datasetid="ds_RECIPE_INFO" columnid="RECIPE_FEEL"/>
      <BindItem id="cbo_RECIPE_TEMPER_value" compid="cbo_RECIPE_TEMPER" propid="value" datasetid="ds_RECIPE_INFO" columnid="RECIPE_TEMPER"/>
      <BindItem id="cbo_USE_TOOL_value" compid="cbo_USE_TOOL" propid="value" datasetid="ds_RECIPE_INFO" columnid="USE_TOOL"/>
      <BindItem id="ed_CORE_TEMPER_value" compid="ed_CORE_TEMPER" propid="value" datasetid="ds_RECIPE_INFO" columnid="CORE_TEMPER_YN"/>
      <BindItem id="ed_PHF_value" compid="ed_PHF" propid="value" datasetid="ds_RECIPE_INFO" columnid="PHF"/>
      <BindItem id="ed_RECIPE_NAME_value" compid="ed_RECIPE_NAME" propid="value" datasetid="ds_RECIPE_INFO" columnid="RECIPE_NAME"/>
      <BindItem id="ed_RECIPE_CD_value" compid="ed_RECIPE_CD" propid="value" datasetid="ds_RECIPE_INFO" columnid="RECIPE_CD"/>
      <BindItem id="ed_RECIPE_COST_value" compid="ed_RECIPE_COST" propid="value" datasetid="ds_RECIPE_INFO" columnid="RECIPE_COST"/>
      <BindItem id="cbo_RECIPE_TYPE_value" compid="cbo_RECIPE_TYPE" propid="value" datasetid="ds_RECIPE_INFO" columnid="RECIPE_TYPE"/>
      <BindItem id="chk_Dtlyn_value" compid="chk_Dtlyn" propid="value" datasetid="ds_RECIPE_INFO" columnid="SPRING_YN"/>
      <BindItem id="Checkbox0_value" compid="Checkbox0" propid="value" datasetid="ds_RECIPE_INFO" columnid="SUMMER_YN"/>
      <BindItem id="Checkbox1_value" compid="Checkbox1" propid="value" datasetid="ds_RECIPE_INFO" columnid="AUTUMN_YN"/>
      <BindItem id="Checkbox2_value" compid="Checkbox2" propid="value" datasetid="ds_RECIPE_INFO" columnid="WINTER_YN"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
 ******************************************************************************************
 * 시스템구분   : 메뉴관리 > 레시피관리 > 사업장레시피관리
 * 프로그램명   : FMM00034E.XML
 * 기      능   : 사업장레시피 상세정보
 * 작  성  자   : 손 창 덕
 * 작성  일자   : 2008-01-24
 * 비      고   : 
 *		- 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
include "U_lib::lib_conversionCom.xjs";
//@@컨버터에서 주석처리 #include "LIB::sc_comon.js";			// 시스템공통 함수
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js";
//@@컨버터에서 주석처리 #include "LIB::sc_sql_common.js";
//@@컨버터에서 주석처리 #include "LIB::tit_comm_0001.js";		// X-Framework Lib
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	// X-Framework : Action 정보 생성
	fsp_init(this);
	
	// ComboBox Init
	fn_ComboBoxInit();
	
	// img_RECIPE_PHOTO Text Setting
	img_RECIPE_PHOTO.text = "이미지가 없습니다.";
	img_RECIPE_PHOTO.image = "URL('theme://convertImages/img_NoImageBig.png')";
	
	// Div Setting
	div_Footer.url = "U_FMM::FMM00036E.xfdl";
}
//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_Search()
 * 기      능   : [조회버튼] 검색조건에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_search()
{
	
	if(rdo_FOOTER_GUBUN.index==2)
	{
		if(ds_RECIPE_INFO.getRowCount()>0 && cbo_CUISINE_TYPE.index>0  )
		{
			div_Footer.img_JoryMethod.image="";
		}
	}
	img_RECIPE_PHOTO.text = "이미지가 없습니다.";
	img_RECIPE_PHOTO.image = "URL('theme://convertImages/img_NoImageBig.png')";
	ds_RECIPE_INFO.clearData();
	ds_ITEM_LIST.clearData();
	ds_CUISINE_LIST.clearData();
	ds_RECIPE_PHF.clearData();
	
	// Clear ActionInfo
	fsp_clear(this); 
	
	//http.Sync = true;
	// 레시피 상세정보
	fsp_callService(this, "FMM00030E_ACT", "searchRecipeInfo", "ds_INPUT=ds_INPUT", "ds_RECIPE_INFO=ds_RECIPE_INFO", "", "fn_CallBackRecipeInfo");
	// 레시피 재료구성
	fsp_callService(this, "FMM00030E_ACT", "searchItemList", "ds_INPUT=ds_INPUT", "ds_ITEM_LIST=ds_ITEM_LIST", "", "fn_CallBackSearchItemList");
	// 조리법
	fsp_callService(this, "FMM00030E_ACT", "searchCuisineList", "ds_INPUT=ds_INPUT", "ds_CUISINE_LIST=ds_CUISINE_LIST", "", "fn_CallBackSearchCuisineList");
	// PHF관리
	fsp_callService(this, "FMM00030E_ACT", "searchRecipePhf", "ds_INPUT=ds_INPUT", "ds_RECIPE_PHF=ds_RECIPE_PHF", "", "fn_CallBackSearch");
	//http.Sync = false;
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Insert()
 * 기      능   : [등록버튼] 등록 버튼 클릭 시 처리되는 작업
 ******************************************************************************************
 */
function fn_insert()
{
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Save()
 * 기      능   : [저장버튼] 저장 버튼 클릭 시 처리되는 작업
 ******************************************************************************************
 */
function fn_save()
{
	// 저장 전 미입력 조리법 삭제
	for( var i=ds_CUISINE_LIST.getRowCount()-1; i>=0; i-- ) {
		if( gfn_length(gfn_trim(ds_CUISINE_LIST.getColumn(i, "CUISINE_DESC")))== 0 ) {
			ds_CUISINE_LIST.deleteRow(i);
		}
	}
	// 저장 전 미입력 재료구성 삭제
	for( var i=ds_ITEM_LIST.getRowCount()-1; i>=0; i-- ) {
		if( gfn_length(gfn_trim(ds_ITEM_LIST.getColumn(i, "ITEM_CODE")))== 0 && gfn_length(gfn_trim(ds_ITEM_LIST.getColumn(i, "NEED_QTY")))== 0 ) {
			ds_ITEM_LIST.deleteRow(i);
		}
	}
	
	//		//변경체크
	// if( !ds_RECIPE_INFO.GetUpdate() && !ds_ITEM_LIST.GetUpdate() && !ds_CUISINE_LIST.GetUpdate() && !ds_RECIPE_PHF.GetUpdate() ) {
		// g_Message("EE", "변경 내역이 없습니다.");
		// return;
	// }
	
	// 재료구성 입력 체크
	if( ds_ITEM_LIST.getRowCount() == 0 ) {
		g_Message("EE", "적어도 하나 이상의 재료를 등록해 주세요.");
		return;
	} else {
		for( var i=ds_ITEM_LIST.getRowCount()-1; i>=0; i-- ) {
			if( gfn_length(gfn_trim(ds_ITEM_LIST.getColumn(i, "ITEM_CODE")))== 0 ) {
				g_Message("EE", "재료를 선택해 주세요.");
				ds_ITEM_LIST.rowposition = i;
				return;
			}
			if( gfn_length(gfn_trim(ds_ITEM_LIST.getColumn(i, "NEED_QTY")))== 0 ) {
				g_Message("EE", "1인소요량을 선택해 주세요.");
				ds_ITEM_LIST.rowposition = i;
				return;
			}
		}
	}
	
	var sGubun = ds_INPUT.getColumn(0, "GUBUN");
	if( sGubun == "한화" || sGubun == "본사" ) {
		// 신규 사업장레시피 중복체크
		fn_ChkNewRecipe();
	} else {
		if( g_Confirm("02", "사업장레시피를 수정하시겠습니까?") ) {
			fn_RecipeSave("U");
		}
	}
}
/* 
 ******************************************************************************************
 * 함  수  명   : fn_Delete()
 * 기      능   : [삭제버튼] 삭제 시 처리되는 작업
 ******************************************************************************************
 */
function fn_delete(nRow)
{
	if( ds_RECIPE_INFO.getRowCount() != 0 ) {
		var v_Gubun = ds_INPUT.getColumn(0, "GUBUN");
		if( v_Gubun == "한화" || v_Gubun == "본사" ) {
			g_Message("EE", "표준레시피는 삭제할 수 없습니다.");
		} else if( v_Gubun == "업장" ) {
			if( g_Confirm("01", "사업장레시피가 삭제됩니다.삭제하시겠습니까?") ) {
				fn_RecipeSave("D");
			}
		}
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_Print()
 * 기      능   : [출력버튼] 출력 시 처리되는 작업
 ******************************************************************************************
 */
function fn_print()
{
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function fn_close()
{
	return true;
}
//=========================================================================================
// [ PART 5 ]
// Detail Process Event 정의 ( User Define function )
//
//=========================================================================================
/*------------------------------------------------------------
	1. Function    : fn_RecipeSave(arg)
	2. Description : 레시피 저장
	3. Arguments   : arg = "I1" : 신규, "I2" : 재신규, "U" : 수정
	4. History     : 2008. 01. 28 - 최초작성
*------------------------------------------------------------*/
function fn_RecipeSave(arg)
{
	sRecipecd=ds_RECIPE_INFO.getColumn(0,"RECIPE_CD");
	var v_InDataSet  = "ds_INPUT=ds_INPUT:A ds_RECIPE_INFO=ds_RECIPE_INFO:A ds_ITEM_LIST=ds_ITEM_LIST:A ds_CUISINE_LIST=ds_CUISINE_LIST:A ds_RECIPE_PHF=ds_RECIPE_PHF:A";
	var v_OutDataSet = "";
	
	fsp_clear(this);
	
	switch( arg ) {
		case "I1":
			fsp_callService(this, "FMM00030E_ACT", "saveInsert", v_InDataSet, v_OutDataSet, "MODE='I1' EMP_NO="+g_EmpNo, "fn_CallBackSave");
			break;
		case "I2":
			fsp_callService(this, "FMM00030E_ACT", "saveInsert", v_InDataSet, v_OutDataSet, "MODE='I2' EMP_NO="+g_EmpNo, "fn_CallBackSave");
			break;
		case "U":
			// Service Setting
			var actionName, cmdName, inData, outData, otherArg, callBackFnc, keyIncrement, callbackSql, saveFlagColumn;
			var insertSql1, updateSql1, deleteSql1, keySqlName1;
			var insertSql2, updateSql2, deleteSql2, keySqlName2;
			var insertSql3, updateSql3, deleteSql3, keySqlName3;
			
			inData		 = "ds_RECIPE_INFO=ds_RECIPE_INFO:U ds_ITEM_LIST=ds_ITEM_LIST:U ds_CUISINE_LIST=ds_CUISINE_LIST:U";
			outData		 = "";
			callBackFnc	 = "fn_CallBackSave";
			callbackSql	 = "";
			
			insertSql1 	 = "";
			insertSql2 	 = "fm/fmm:FMM00030E_I002";
			insertSql3 	 = "fm/fmm:FMM00030E_I003";

			updateSql1   = "fm/fmm:FMM00030E_U001";
			updateSql2   = "fm/fmm:FMM00030E_U002";
			updateSql3   = "fm/fmm:FMM00030E_U003";
			
			deleteSql1   = "";
			deleteSql2   = "fm/fmm:FMM00030E_D001";
			deleteSql3   = "fm/fmm:FMM00030E_D002";
			
			keySqlName1  = "";
			keySqlName2  = "fm/fmm:FMM00030E_S015";
			keySqlName3  = "fm/fmm:FMM00030E_S016";
			
			fsp_addSave(this, insertSql1, updateSql1, deleteSql1, saveFlagColumn, keySqlName1, -1, callbackSql);
			fsp_addSave(this, insertSql2, updateSql2, deleteSql2, saveFlagColumn, keySqlName2, 1,  callbackSql);
			fsp_addSave(this, insertSql3, updateSql3, deleteSql3, saveFlagColumn, keySqlName3, 1,  callbackSql);
			fsp_callService(this, actionName, cmdName, inData, outData, otherArg, callBackFnc);
			
			break;
		
		case "D":
			fsp_callService(this, "FMM00030E_ACT", "deleteRecipe", "ds_RECIPE_INFO=ds_RECIPE_INFO", "", "", "fn_CallBackDelete");
			break;
			
		default:
			break;
	}
}
/*------------------------------------------------------------
	1. Function    : fn_CallBackDelete(errCode, errMsg)
	2. Description : fn_RecipeSave("D") CallBack Function
	3. Arguments   : errCode, errMsg
	4. History     : 2008. 01. 29 - 최초작성
*------------------------------------------------------------*/
function fn_CallBackDelete(errCode, errMsg)
{
	if( errCode != 0 ) {
		return;
	} else {
		g_Message("01");
		this.parent.div_Header.fn_search();
	}
}
/*------------------------------------------------------------
	1. Function    : fn_CallBackSave(errCode, errMsg)
	2. Description : fn_RecipeSave() CallBack Function
	3. Arguments   : errCode, errMsg
	4. History     : 2008. 01. 28 - 최초작성
*------------------------------------------------------------*/
function fn_CallBackSave(errCode, errMsg)
{
	if( errCode != 0 ) {
		return;
	} else {
		g_Message("02");
		GBN=true;
		this.parent.div_Header.fn_search();
	}
}
/*------------------------------------------------------------
	1. Function    : fn_ChkNewRecipe()
	2. Description : 신규레시피 중복체크
	3. Arguments   : 
	4. History     : 2008. 01. 28 - 최초작성
*------------------------------------------------------------*/
function fn_ChkNewRecipe()
{
	ds_CHK_RECIPE.clearData();
	fsp_callService(this, "FMM00030E_ACT", "searchChkRecipe", "ds_INPUT=ds_INPUT", "ds_CHK_RECIPE=ds_CHK_RECIPE", "", "fn_CallBackChkRecipe");
}
/*------------------------------------------------------------
	1. Function    : fn_CallBackChkRecipe(errCode, errMsg)
	2. Description : fn_ChkNewRecipe() CallBack Function
	3. Arguments   : errCode, errMsg
	4. History     : 2008. 01. 28 - 최초작성
*------------------------------------------------------------*/
function fn_CallBackChkRecipe(errCode, errMsg)
{
	if( errCode != 0 ) {
		return;
	} else {
		if( ds_CHK_RECIPE.getColumn(0, "CNT") == 1 ) {
			if( g_Confirm("02", "이미 사업장레시피가 있습니다.\n표준레시피로 업데이트 하시겠습니까?") ) {
				//사진 존재시 삭제 후 insert하자
				fn_RecipeSave("I2");
				return;
			} else {
				return;
			}
		} else {
			if( g_Confirm("02", "표준레시피를 사업장레시피로 저장하시겠습니까?") ) {
				fn_RecipeSave("I1");
				return;
			}
		}
	}
}
/*------------------------------------------------------------
	1. Function    : fn_CallBackRecipeInfo(errCode, errMsg)
	2. Description : fn_Search() CallBack Function
	3. Arguments   : errCode, errMsg
	4. History     : 2008. 01. 24 - 최초작성
*------------------------------------------------------------*/
function fn_CallBackRecipeInfo(errCode, errMsg)
{
	if( errCode != 0 ) {
		return;
	} else {
		fn_RecipeImageDisplay();
		if(rdo_FOOTER_GUBUN.index==2)
		{
			if(ds_RECIPE_INFO.getRowCount()>0 && cbo_CUISINE_TYPE.index>0  )
			{
				//div_Footer.img_JoryMethod.image=GF_FILE_SERVER_URL+"upload/img/cook_ctrl/"+cbo_CUISINE_TYPE.value+".jpg";
				div_Footer.img_JoryMethod.image = fsp_getServerDir("FSR_CUISINE_IMG", cbo_CUISINE_TYPE.value + ".jpg");
			}
		}		
	}
}
/*------------------------------------------------------------
	1. Function    : fn_CallBackSearch(errCode, errMsg)
	2. Description : fn_Search() CallBack Function
	3. Arguments   : errCode, errMsg
	4. History     : 2008. 01. 24 - 최초작성
*------------------------------------------------------------*/
function fn_CallBackSearch(errCode, errMsg)
{
	if( errCode != 0 ) {
		return;
	} else {
	}
}
/*------------------------------------------------------------
	1. Function    : fn_CallBackSearchItemList(errCode, errMsg)
	2. Description : fn_Search() CallBack Function
	3. Arguments   : errCode, errMsg
	4. History     : 2008. 01. 24 - 최초작성
*------------------------------------------------------------*/
function fn_CallBackSearchItemList(errCode, errMsg)
{
	if( errCode != 0 ) {
		return;
	} else {
		ds_ITEM_LIST.addRow();
	}
}
/*------------------------------------------------------------
	1. Function    : fn_CallBackSearchCuisineList(errCode, errMsg)
	2. Description : fn_Search() CallBack Function
	3. Arguments   : errCode, errMsg
	4. History     : 2008. 01. 24 - 최초작성
*------------------------------------------------------------*/
function fn_CallBackSearchCuisineList(errCode, errMsg)
{
	if( errCode != 0 ) {
		return;
	} else {
		//ds_CUISINE_LIST.AddRow();
	}
}
/*------------------------------------------------------------
	1. Function    : fn_ComboBoxInit()
	2. Description : ComboBox Setting
	3. Arguments   : 
	4. History     : 2008. 01. 25 - 최초작성
*------------------------------------------------------------*/
function fn_ComboBoxInit()
{
	http.Sync = true;
	// 모양
	fsp_callService(this, "FMM00030E_ACT", "searchComboData", "", "ds_RECIPE_SHAPE=ds_RECIPE_SHAPE", "GROUP_CODE='FS0008' RETURN_DATASET='ds_RECIPE_SHAPE' ALL_GUBUN='F'", "fn_CallBackComboData", "", true);
	// 맛
	fsp_callService(this, "FMM00030E_ACT", "searchComboData", "", "ds_RECIPE_TASTE=ds_RECIPE_TASTE", "GROUP_CODE='FS0009' RETURN_DATASET='ds_RECIPE_TASTE' ALL_GUBUN='F'", "fn_CallBackComboData", "", true);
	// 제공온도
	fsp_callService(this, "FMM00030E_ACT", "searchComboData", "", "ds_RECIPE_TEMPER=ds_RECIPE_TEMPER", "GROUP_CODE='FS0011' RETURN_DATASET='ds_RECIPE_TEMPER' ALL_GUBUN='F'", "fn_CallBackComboData", "", true);
	// 찬기
	fsp_callService(this, "FMM00030E_ACT", "searchComboData", "", "ds_USE_TOOL=ds_USE_TOOL", "GROUP_CODE='FS0013' RETURN_DATASET='ds_USE_TOOL' ALL_GUBUN='F'", "fn_CallBackComboData", "", true);
	// 질감
	fsp_callService(this, "FMM00030E_ACT", "searchComboData", "", "ds_RECIPE_FEEL=ds_RECIPE_FEEL", "GROUP_CODE='FS0010' RETURN_DATASET='ds_RECIPE_FEEL' ALL_GUBUN='F'", "fn_CallBackComboData", "", true);
	// 색
	fsp_callService(this, "FMM00030E_ACT", "searchComboData", "", "ds_RECIPE_COLOR=ds_RECIPE_COLOR", "GROUP_CODE='FS0007' RETURN_DATASET='ds_RECIPE_COLOR' ALL_GUBUN='F'", "fn_CallBackComboData", "", true);
	// 선호도
	fsp_callService(this, "FMM00030E_ACT", "searchComboData", "", "ds_PREFER=ds_PREFER", "GROUP_CODE='FS0020' RETURN_DATASET='ds_PREFER' ALL_GUBUN='F'", "fn_CallBackComboData", "", true);
	// 커팅규격
	fsp_callService(this, "FMM00030E_ACT", "searchComboData", "", "ds_CUT_SPEC=ds_CUT_SPEC", "GROUP_CODE='FS0017' RETURN_DATASET='ds_CUT_SPEC' ALL_GUBUN='F'", "fn_CallBackComboData", "", true);
	http.Sync = false;
}
/*------------------------------------------------------------
	1. Function    : fn_CallBackComboData(errCode, errMsg)
	2. Description : fn_ComboBoxInit CallBack Function
	3. Arguments   : errCode, errMsg
	4. History     : 2008. 01. 25 - 최초작성
*------------------------------------------------------------*/
function fn_CallBackComboData(errCode, errMsg)
{
	if( errCode != 0 ) {
		return;
	}
}
/*------------------------------------------------------------
	1. Function    : fn_RecipeImageDisplay()
	2. Description : 레시피 상세정보 조회 후 이미지 로드
	3. Arguments   : 
	4. History     : 2008. 01. 25 - 최초작성
*------------------------------------------------------------*/
function fn_RecipeImageDisplay()
{
	if( gfn_length(gfn_trim(ds_RECIPE_INFO.getColumn(0, "SPHOTO_PATH")))== 0 ) {
		img_RECIPE_PHOTO.text = "이미지가 없습니다.";
		img_RECIPE_PHOTO.image = "URL('theme://convertImages/img_NoImageBig.png')";
	} else {
		img_RECIPE_PHOTO.text = "";
		var v_ServerPath = "";
		
		if( ds_RECIPE_INFO.getColumn(0, "GUBUN") == "한화" ) {
			v_ServerPath = "FSR_STD_RECIPE_MST";
		} else if( ds_RECIPE_INFO.getColumn(0, "GUBUN") == "본사" ) {
			v_ServerPath = "FMM_STD_RECIPE_MST";
		} else if( ds_RECIPE_INFO.getColumn(0, "GUBUN") == "업장" ) {
			var v_CodeLength = gfn_length(ds_RECIPE_INFO.getColumn(0, "RECIPE_CD"));
			if( v_CodeLength == 6 ) {
				v_ServerPath = "FSR_STD_RECIPE_MST";
			} else {
				//v_ServerPath = "FMM_UPJANG_RECIPE_MST";
				v_ServerPath = "FMM_STD_RECIPE_MST";
			}
		}
		img_RECIPE_PHOTO.image = fsp_getServerDir(v_ServerPath, ds_RECIPE_INFO.getColumn(0, "SPHOTO_PATH"));
	}
}
//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
/*------------------------------------------------------------
	1. Function    : img_RECIPE_PHOTO_OnLoadError()
	2. Description : 레시피 이미지 로드 에러
	3. Arguments   : 
	4. History     : 2008. 01. 25 - 최초작성
*------------------------------------------------------------*/
/* 지원하지 않는 이벤트입니다.*/
// function img_RECIPE_PHOTO_OnLoadError(obj,nErrorCode,strErrorMsg)
// {
// 	img_RECIPE_PHOTO.text = "이미지 로드에\n\n실패했습니다.";
// }
/*------------------------------------------------------------
	1. Function    : grd_ITEM_LIST_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
	2. Description : 그리드 더블클릭 이벤트
	3. Arguments   : 
	4. History     : 2008. 01. 25 - 최초작성
*------------------------------------------------------------*/
function grd_ITEM_LIST_OnCellClick(obj:Grid, e:GridClickEventInfo)
{
	var ActionVal    = "";
	var v_rtn        = "";
	var v_result     = "";
	ds_ITEM_LIST.rowposition = e.row;
	
	switch(e.cell)
	{
		case 2:
			if (! g_Confirm("01", '선택하신 데이터를 삭제하시겠습니까?!')) return;
			ds_ITEM_LIST.deleteRow(ds_ITEM_LIST.rowposition);
			break;
		case 4:
			if( GetRowType(ds_ITEM_LIST,e.row)== "insert" ) {
				var arrArgs = {IN_GUBUN:'FMM00030E', IN_UPJANG:gfn_nvl(ds_INPUT.getColumn(0, "UPJANG"))};
				v_rtn = gfn_dialog("", "U_FMM::FMM00014P.xfdl", arrArgs);
				
				if( gfn_length(gfn_trim(v_rtn))!= 0 ) {
					// 0 자재코드 ,1 자재명, 2 규격, 3 단위 ,4 금지, 5 100g에너지, 6 폐기율, 7 g당단가, 8 상품정보 9 1인소요량, 10 단가, 11 비고
					v_result = gfn_split(v_rtn,";");
					if( ds_ITEM_LIST.findRow("ITEM_CODE", v_result[0]) != -1 ) {
						g_Message("EE", "이미 등록된 자재입니다.");
						break;
					}

					ds_ITEM_LIST.setColumn(e.row, "UPJANG",    		ds_RECIPE_INFO.getColumn(0, "UPJANG"));
					ds_ITEM_LIST.setColumn(e.row, "SUBINV_CLASS",    ds_RECIPE_INFO.getColumn(0, "SUBINV_CLASS"));
					ds_ITEM_LIST.setColumn(e.row, "RECIPE_CD",    	ds_RECIPE_INFO.getColumn(0, "RECIPE_CD"));
					
					ds_ITEM_LIST.setColumn(e.row, "ITEM_CODE",    	gfn_trim(v_result[0]));
					ds_ITEM_LIST.setColumn(e.row, "ITEM_NAME",    	gfn_trim(v_result[1]));
					ds_ITEM_LIST.setColumn(e.row, "ITEM_SIZE",    	gfn_trim(v_result[2]));
					ds_ITEM_LIST.setColumn(e.row, "PO_UOM",       	gfn_trim(v_result[3]));
					ds_ITEM_LIST.setColumn(e.row, "CAL", 		  	gfn_trim(v_result[5]));
					ds_ITEM_LIST.setColumn(e.row, "GRAM_PRICE",   	gfn_trim(v_result[7]));
					ds_ITEM_LIST.setColumn(e.row, "FEATURE_NAME", 	gfn_trim(v_result[8]));
					ds_ITEM_LIST.setColumn(e.row, "NEED_QTY",     	gfn_trim(v_result[9]));
					//ds_ITEM_LIST.setColumn(e.row, "MARGIN_PRICE", 	gfn_trim(v_result[10]));
					ds_ITEM_LIST.setColumn(e.row, "REMARK",       	""          );
					
					grd_ITEM_LIST.binddataset = "";
					grd_ITEM_LIST.binddataset = "ds_ITEM_LIST";
					grd_ITEM_LIST.enableredraw      = true;
					
					ds_ITEM_LIST.addRow();
				}
			}
			break;
		case 14:
			v_rtn = gfn_dialog("", "U_FMM::FMM00015P.xfdl","");
			if( gfn_length(gfn_trim(v_rtn))== 0 || gfn_trim(v_rtn)== null ) {
				return;
			}
			v_result = gfn_split(v_rtn,";");	// 0 그룹코드 1 그룹명 2 상세코드 3 상세코드명
			ds_ITEM_LIST.setColumn(e.row, "CUT_SPEC",      v_result[2]);
			//ds_ITEM_LIST.SetColumn(nRow, "CUT_SPEC_NAME", v_result[3]);	
			break;
		default:
			break;
	}	
}
/*------------------------------------------------------------
	1. Function    : grd_ITEM_LIST_OnKeyDown(obj,nChar,bShift,bCtrl,bAlt,nLLParam,nHLParam)
	2. Description : 그리드 KeyDown 이벤트
	3. Arguments   : 
	4. History     : 2008. 01. 25 - 최초작성
*------------------------------------------------------------*/
function grd_ITEM_LIST_OnKeyDown(obj:Grid, e:KeyEventInfo)
{
	if( e.keycode == 13 && ds_RECIPE_INFO.getRowCount() != 0 ) {
		if( ds_ITEM_LIST.findRowExpr("gfn_length(gfn_trim(ITEM_CODE))==0 || gfn_trim(ITEM_CODE)==null") != -1 ) {
			return;
		}
		var nRow = ds_ITEM_LIST.addRow();
		ds_ITEM_LIST.setColumn(nRow, "UPJANG",       ds_INPUT.getColumn(0, "UPJANG")      );
		ds_ITEM_LIST.setColumn(nRow, "SUBINV_CLASS", ds_INPUT.getColumn(0, "SUBINV_CLASS"));
		ds_ITEM_LIST.setColumn(nRow, "RECIPE_CD",    ds_INPUT.getColumn(0, "RECIPE_CD")   );
	}
}
/*------------------------------------------------------------
	1. Function    : ds_ITEM_LIST_OnColumnChanged()
	2. Description : 1인 소요량 입력시 계산
	3. Arguments   : 
	4. History     : 2008. 01. 25 - 최초작성
*------------------------------------------------------------*/
function ds_ITEM_LIST_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	var v_EQ = 0; 	// EDIBLE_QTY		가식부량 1인소요량*폐기율==>NEED_QTY*(100-disuse_rate)
	var v_PP = 0; 	// PERSON_PRICE 	인원가	자재g당단가*1인소요량==>GRAM_PRICE*NEED_QTY
	var v_CC = 0; 	// CAL_CALC			에너지    100g:기본에너지=가식부량:계산할에너지==>CAL_CALC=(CAL*EDIBLE_QTY)/100

	switch( e.columnid )
	{
		case "PERSON_PRICE":
			ed_RECIPE_COST.value = ds_ITEM_LIST.getSum("PERSON_PRICE");
			break;
		case "EDIBLE_QTY":
			v_CC = Math.round((ds_ITEM_LIST.getColumn(e.row,"CAL")*ds_ITEM_LIST.getColumn(e.row,"NEED_QTY")*((100-ds_ITEM_LIST.getColumn(e.row,"DISUSE_RATE"))/100))/100,2);
			ds_ITEM_LIST.setColumn(e.row,"CAL_CALC",v_CC);
			break;
		case "NEED_QTY":	// 1인소요량
			v_PP = Math.round(ds_ITEM_LIST.getColumn(e.row,"GRAM_PRICE")*ds_ITEM_LIST.getColumn(e.row,"NEED_QTY"),0);
			ds_ITEM_LIST.setColumn(e.row,"PERSON_PRICE",v_PP);
			//동시에 변경
			ed_RECIPE_COST.value = ds_ITEM_LIST.getSum("PERSON_PRICE");
			
			v_EQ = Math.round(ds_ITEM_LIST.getColumn(e.row,"NEED_QTY")*((100-ds_ITEM_LIST.getColumn(e.row,"DISUSE_RATE"))/100),2);
			ds_ITEM_LIST.setColumn(e.row,"EDIBLE_QTY",v_EQ);
			//동시에 변경
			v_CC = Math.round((ds_ITEM_LIST.getColumn(e.row,"CAL")*ds_ITEM_LIST.getColumn(e.row,"NEED_QTY")*((100-ds_ITEM_LIST.getColumn(e.row,"DISUSE_RATE"))/100))/100,2);
			ds_ITEM_LIST.setColumn(e.row,"CAL_CALC",v_CC);
			break;
		default:
			break;
	}
}
/*------------------------------------------------------------
	1. Function    : rdo_FOOTER_GUBUN_OnChanged()
	2. Description : div_Footer 라디오 버튼 변경 이벤트
	3. Arguments   : 
	4. History     : 2008. 01. 25 - 최초작성
*------------------------------------------------------------*/
function rdo_FOOTER_GUBUN_OnChanged(obj:Radio, e:ItemChangeEventInfo)
{
	div_Footer.url = "U_FMM::"+e.postvalue+".xfdl";
	if ( obj.index==0) {
		div_Footer.position.height = 334;
	} else if ( obj.index==1) {
		div_Footer.position.height = 334;
	} else if(obj.index==2) {
		div_Footer.position.height = 560;
	
		if(ds_RECIPE_INFO.getRowCount()>0 && cbo_CUISINE_TYPE.index>0  )
		{
			//div_Footer.img_JoryMethod.image=GF_FILE_SERVER_URL+"upload/img/cook_ctrl/"+cbo_CUISINE_TYPE.value+".jpg";
			div_Footer.img_JoryMethod.image = fsp_getServerDir("FSR_CUISINE_IMG", cbo_CUISINE_TYPE.value + ".jpg");
		} else {
			div_Footer.img_JoryMethod.text  = "";
			div_Footer.img_JoryMethod.image = "";
		}
	}	
	this.parent.div_Body.resetScroll();
}
/*------------------------------------------------------------
	1. Function    : ds_RECIPE_PHF_OnColumnChanged()
	2. Description : PHF관리 값 변경시 이벤트
	3. Arguments   : 
	4. History     : 2008. 01. 28 - 최초작성
*------------------------------------------------------------*/
function ds_RECIPE_PHF_OnColumnChanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if( e.columnid == "PHF" ) {
		switch( e.row ) {
			case 0:
				ds_RECIPE_INFO.setColumn(0, "PHF_MGMT1", e.newvalue);
				break;
			case 1:
				ds_RECIPE_INFO.setColumn(0, "PHF_MGMT2", e.newvalue);
				break;
			case 2:
				ds_RECIPE_INFO.setColumn(0, "PHF_MGMT3", e.newvalue);
				break;
			case 3:
				ds_RECIPE_INFO.setColumn(0, "PHF_MGMT4", e.newvalue);
				break;
			case 4:
				ds_RECIPE_INFO.setColumn(0, "PHF_MGMT5", e.newvalue);
				break;
			default:
				break;
		}
		var v_1 = ds_RECIPE_INFO.getColumn(0, "PHF_MGMT1");
		var v_2 = ds_RECIPE_INFO.getColumn(0, "PHF_MGMT2");
		var v_3 = ds_RECIPE_INFO.getColumn(0, "PHF_MGMT3");
		var v_4 = ds_RECIPE_INFO.getColumn(0, "PHF_MGMT4");
		var v_5 = ds_RECIPE_INFO.getColumn(0, "PHF_MGMT5");
		
		if( v_1=="Y" && v_2=="N" ) {
			ds_RECIPE_INFO.setColumn(0, "PHF", "Y");
		} else {
			if( v_1=="Y" || v_2=="N" ) {
				if(v_3=="Y" || v_4=="Y" || v_5=="Y") {
					ds_RECIPE_INFO.setColumn(0, "PHF", "Y");
				} else {
					ds_RECIPE_INFO.setColumn(0, "PHF", "N");
				}
			} else {
				ds_RECIPE_INFO.setColumn(0, "PHF", "N");
			}
		}
	}
}
/*------------------------------------------------------------
	1. Function    : btn_RATIO_OnClick(obj)
	2. Description : 레시피비율일괄변경
	3. Arguments   : 
	4. History     : 2008. 01. 29 - 최초작성
*------------------------------------------------------------*/
function btn_RATIO_OnClick(obj:Button, e:ClickEventInfo)
{
	if( ds_RECIPE_INFO.getRowCount() != 0 && ds_ITEM_LIST.getRowCount() != 0 ) {
		var v_NQ = 0;
		if( ed_RATIO.visible ) {
			//화면에서 가리고 반영하기
			ed_RATIO.visible   = false;
			st_PERCENT.visible = false;
			
			if( gfn_length(gfn_trim(ed_RATIO.value))==0 || gfn_trim(ed_RATIO.value)==null ) {
				return;
			}
			for( i=0; i<ds_ITEM_LIST.getRowCount(); i++ ) {
				v_NQ = Math.round((toNumber(ds_ITEM_LIST.getColumn(i,"NEED_QTY"))*toNumber(ed_RATIO.value))/100,2);
				ds_ITEM_LIST.setColumn(i,"NEED_QTY",v_NQ);
			}
			ed_RATIO.value = "";
		} else {
			ed_RATIO.visible   = true;
			st_PERCENT.visible = true;
			ed_RATIO.setFocus();
		}
	}
}
/*------------------------------------------------------------
	1. Function    : btn_RECIPE_ELEMENT_OnClick(obj)
	2. Description : 레시피영양성분 팝업 호출
	3. Arguments   : 
	4. History     : 2008. 01. 29 - 최초작성
*------------------------------------------------------------*/
function btn_RECIPE_ELEMENT_OnClick(obj:Button, e:ClickEventInfo)
{
	if( ds_RECIPE_INFO.getRowCount() != 0 && ds_ITEM_LIST.getRowCount() != 0 ) {
		var v_Gubun = ds_INPUT.getColumn(0, "GUBUN");
		var v_args = new Array();
		
		if( v_Gubun == "한화" ) {
			v_args["v_gbn"] = 0;
		} else if( v_Gubun == "본사" ) {
			v_args["v_gbn"] = 1;
		} else if( v_Gubun == "업장" ) {
			v_args["v_gbn"] = 2;
		}
		
		v_args["IN_UPJANG"] 		= gfn_nvl(ds_INPUT.getColumn(0, "UPJANG"));
		v_args["IN_SUBINV_CLASS"]	= gfn_nvl(ds_INPUT.getColumn(0, "SUBINV_CLASS"));
		v_args["IN_RECIPE_CD"]		= gfn_nvl(ds_INPUT.getColumn(0, "RECIPE_CD"));
		
		gfn_dialog("", "U_FMM::FMM00012P.xfdl", v_args);
	}
}
/*------------------------------------------------------------
	1. Function    : grd_ITEM_LIST_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
	2. Description : Grid Sort or Excel Export
	3. Arguments   : 
	4. History     : 2008. 04. 21 - 최초작성
*------------------------------------------------------------*/
function grd_ITEM_LIST_OnHeadClick(obj:Grid, e:GridClickEventInfo)
{
	if( e.cell == 0 ) {	// Excel Export
		gfn_exportExcel(obj, "Sheet1");
	} else {
		gfn_gridSort(obj, e); //(eval(obj.binddataset), obj, e.cell);
	}
}
/*------------------------------------------------------------
	1. Function    : FMM00034E_OnKeyDown(obj,objSenderObj,nChar,bShift,bControl,bAlt,nLLParam,nHLParam)
	2. Description : Form Common KeyDown Event
	3. Arguments   : 
	4. History     : 2008. 04. 22 - 최초작성
*------------------------------------------------------------*/
function FMM00034E_OnKeyDown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e); //(obj,e.fromreferenceobject,e.keycode,e.shiftKey,e.ctrlKey,e.altKey,-1,-1);
}
/*------------------------------------------------------------
	1. Function    : grd_ITEM_LIST_OnMouseOver(obj,nPosX,nPosY,nRow,nCell,nPivotIndex)
	2. Description : 상품리스트의 빨간 공(발주제한품목)의 설명 문구 툴팁 적용
	3. Arguments   : 
	4. History     : 2008. 06. 05 - 최초작성
*------------------------------------------------------------*/
function grd_ITEM_LIST_OnMouseOver(obj:Grid, e:GridMouseEventInfo)
{
	if( e.cell == 1 && e.row >= 0 && ds_ITEM_LIST.getColumn(e.row, "RESTRICT_YN") == "Y" ) {
		grd_ITEM_LIST.tooltiptext = "발주 제한 품목입니다.";
	} else if( e.cell == 2 ) {
		grd_ITEM_LIST.tooltiptext = "삭제";
	} else {
		grd_ITEM_LIST.tooltiptext = "";
	}
}
]]></Script>
  </Form>
</FDL>

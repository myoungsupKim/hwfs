<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="../../../default_typedef.xml"/>
  <Form id="SCC80050E" onload="form_onload" titletext="게시물 작성" position="absolute 0 0 800 623" scrollbars="none">
    <Layouts>
      <Layout>
        <Static id="Static04" class="sta_WFDA_Labelbg" position="absolute 15 120 785 147" anchor="left top right"/>
        <Static id="Static05" class="sta_WFDA_Labelbg" position="absolute 15 642 785 712" anchor="left top right" visible="false"/>
        <Static id="Static03" class="sta_WFDA_Labelbg" position="absolute 15 94 785 121" anchor="left top right"/>
        <Static id="Static02" class="sta_WFDA_Labelbg" position="absolute 15 68 785 95" anchor="left top right"/>
        <Static id="Static00" class="sta_WFDA_Labelbg" position="absolute 15 42 785 69" anchor="left top right"/>
        <Static id="Static8" position="absolute 19 645 782 708" class="sta_WFDA_Labelbg" anchor="all" visible="false"/>
        <MPFileDialog id="fileDialog" taborder="31" position="absolute 349 635 373 659"/>
        <MPFile id="tmpFile" taborder="31" position="absolute 383 635 407 659"/>
        <Button id="btn_save" onclick="btn_save_OnClick" taborder="4" text="저장" position="absolute 679 10 731 31" class="btn_WF_Save" image="" style="align:left;" anchor="top right"/>
        <Button id="btn_list" onclick="btn_list_OnClick" taborder="5" text="목록" position="absolute 733 10 785 31" class="btn_WF_List" image="" style="align:left;" anchor="top right"/>
        <Static id="Static13" text="제         목" position="absolute 15 42 96 69" class="sta_WFDA_Label01"/>
        <Static id="Static14" text="작   성   자" position="absolute 15 68 96 95" class="sta_WFDA_Label01"/>
        <Static id="Static16" text="작 성 일 자" position="absolute 375 68 456 95" class="sta_WFDA_Label01"/>
        <Static id="st_Notic" text="중 요 공 지" visible="false" position="absolute 375 94 456 121" class="sta_WFDA_Label01"/>
        <Static id="Static18" text="게시종료일" position="absolute 15 94 96 121" class="sta_WFDA_Label01"/>
        <Static id="Static15" text="게 시 대 상" position="absolute 15 120 96 147" class="sta_WFDA_Label01"/>
        <Static id="st_Popup" text="팝 업 여 부" visible="false" position="absolute 375 120 456 147" class="sta_WFDA_Label01"/>
        <Edit lengthunit="asciii" id="ed_title" imemode="native" maxlength="100" taborder="3" position="absolute 98 45 782 66" class="edt_WF_Essential" anchor="left top right"/>
        <Edit id="ed_writer" readonly="true" taborder="6" tabstop="false" userdata="B" position="absolute 98 71 373 92"/>
        <CheckBox falsevalue="N" id="chk_popup" taborder="9" text="예" truevalue="Y" value="false" visible="false" position="absolute 461 123 495 144" onclick="chk_popup_onclick"/>
        <Button id="btn_pFromDt" onclick="g_CalButton_OnClick" taborder="25" tabstop="false" userdata="med_pFromDt" visible="false" position="absolute 577 123 598 144" class="btn_WF_cal" text="" image=""/>
        <Static id="st_pUnder" text="~" visible="false" position="absolute 606 123 616 144"/>
        <MaskEdit id="med_pToDt" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="23" type="string" visible="false" position="absolute 624 123 701 144" class="msk_WF_Cal" ontextchanged="med_pToDt_ontextchanged" canchange="med_pToDt_canchange" enable="true"/>
        <Button id="btn_pToDt" onclick="g_CalButton_OnClick" taborder="26" tabstop="false" userdata="med_pToDt" visible="false" position="absolute 700 123 721 144" class="btn_WF_cal" text="" image=""/>
        <Button id="btn_selectP" onclick="btn_selectP_OnClick" taborder="30" text="대상선택/보기" position="absolute 98 123 197 144" class="btn_WF_Custom" image=""/>
        <Static id="st_noticEnd" text="까지" visible="false" position="absolute 602 97 628 118"/>
        <Button id="btn_noticDt" onclick="g_CalButton_OnClick" taborder="21" tabstop="false" userdata="med_noticDt" visible="false" position="absolute 577 97 598 118" class="btn_WF_cal" text="" image=""/>
        <CheckBox falsevalue="N" id="chk_notic" taborder="2" text="예" truevalue="Y" value="false" visible="false" position="absolute 461 97 495 118" onclick="chk_notic_onclick"/>
        <Button enable="false" id="btn_eDate" onclick="g_CalButton_OnClick" taborder="29" tabstop="false" userdata="med_eDate" position="absolute 279 97 300 118" class="btn_WF_calEssential" text="" image=""/>
        <MaskEdit enable="false" id="med_eDate" mask="####-##-##" oneditclick="g_Date_OnFocus" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" taborder="28" type="string" userdata="btn_eDate" position="absolute 200 97 280 118" class="msk_WF_EssentialCal"/>
        <Combo codecolumn="CODE" datacolumn="CODE_NAME" displayrowcount="10" id="cbo_endGbn" imemode="none" index="0" innerdataset="ds_endGbnCd" onitemchanged="cbo_endGbn_OnChanged" taborder="1" position="absolute 98 97 198 118" class="cmb_WF_Essential"/>
        <Static id="Static1" position="absolute 15 538 785 608" class="sta_WFDA_Labelbg" anchor="left right bottom"/>
        <Button id="btn_fileDel" onclick="btn_fileDel_OnClick" taborder="15" position="absolute 696 541 783 563" class="btn_WF_fileDel" image="" anchor="right bottom"/>
        <MaskEdit enable="false" id="med_fileSize" mask="###,##0" taborder="17" value="MaskEdit00" position="absolute 700 565 764 586" anchor="right bottom"/>
        <Static id="Static12" text="KB" position="absolute 766 565 783 586" anchor="right bottom"/>
        <Button id="btn_fileAdd" onclick="btn_fileAdd_OnClick" taborder="14" position="absolute 608 541 695 563" class="btn_WF_filePlus" image="" anchor="right bottom"/>
        <Static id="Static10" text="파일사이즈" position="absolute 608 565 698 586" class="sta_WFDA_Label01" anchor="right bottom"/>
        <Static id="Static11" text="※ (최대 5개/10M )" position="absolute 609 586 729 607" anchor="right bottom"/>
        <ListBox codecolumn="SHOW_NM" datacolumn="SHOW_NM" id="lst_file" innerdataset="ds_file" taborder="10" position="absolute 95 541 606 605" anchor="left right bottom"/>
        <Static id="Static9" text="첨 부 파 일" position="absolute 15 538 93 608" class="sta_WFDA_Label01" anchor="left bottom"/>
        <Button id="btn_selectB" onclick="btn_selectB_OnClick" taborder="32" text="    다른 게시판으로 복사" visible="false" position="absolute 98 123 257 144" class="btn_WF_BoardCopy" image=""/>
        <ActiveX progid="{D53F36BF-F63A-4B2F-8B7C-C40B428C3A5D}" id="namoWeb" visible="true" position="absolute 14 157 785 528" anchor="all" windowed="true" popupstyle="true" OnLoadCompleted="namoWeb_OnLoadCompleted"/>
        <MaskEdit id="med_pFromDt" taborder="33" type="string" mask="####-##-##" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" oneditclick="g_Date_OnFocus" visible="false" position="absolute 498 123 578 144" class="msk_WF_Cal" enable="true"/>
        <MaskEdit id="med_noticDt" taborder="34" type="string" mask="####-##-##" onsetfocus="g_Date_OnFocus" onkillfocus="g_Date_OnKillFocus" oneditclick="g_Date_OnFocus" visible="false" position="absolute 498 97 578 118" class="msk_WF_Cal" ontextchanged="med_noticDt_ontextchanged" canchange="med_noticDt_canchange" enable="true"/>
        <Edit id="ed_regDate" taborder="35" tabstop="false" readonly="true" position="absolute 458 71 627 92" userdata="B"/>
        <Static id="st_mobile" text="모바일공지" class="sta_WFDA_Label01" visible="true" position="absolute 629 94 710 121"/>
        <CheckBox id="chk_notic00" taborder="36" text="예" value="N" truevalue="Y" falsevalue="N" visible="true" position="absolute 715 97 749 118" onclick="chk_notic00_onclick"/>
        <Static id="st_order" text="게시순서" class="sta_WFDA_Label01" position="absolute 629 68 710 95"/>
        <Combo id="cbo_order" taborder="37" codecolumn="P_ORDER" datacolumn="P_TEXT" position="absolute 711 71 782 92" index="0" text="선택" displaynulltext="선택" innerdataset="@ds_order" enable="false"/>
        <Combo id="cbo_user" taborder="38" enable="false" position="absolute 754 97 825 118" codecolumn="codecolumn" datacolumn="datacolumn" index="0" value="0" text="전체" visible="false">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">0</Col>
                <Col id="datacolumn">전체</Col>
              </Row>
              <Row>
                <Col id="codecolumn">1</Col>
                <Col id="datacolumn">내부</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2</Col>
                <Col id="datacolumn">외부</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_endGbnCd">
        <ColumnInfo>
          <Column id="CODE" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="CODE">1</Col>
            <Col id="CODE_NAME">1주일</Col>
          </Row>
          <Row>
            <Col id="CODE">2</Col>
            <Col id="CODE_NAME">한달</Col>
          </Row>
          <Row>
            <Col id="CODE">3</Col>
            <Col id="CODE_NAME">사용자지정</Col>
          </Row>
          <Row>
            <Col id="CODE">99991231</Col>
            <Col id="CODE_NAME">보존</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_cond">
        <ColumnInfo>
          <Column id="CURR_PAGE" size="10" type="BIGDECIMAL"/>
          <Column id="TOT_CNT" size="10" type="BIGDECIMAL"/>
          <Column id="PAGE_SIZE" size="10" type="BIGDECIMAL"/>
          <Column id="SEARCH_YN" size="256" type="STRING"/>
          <Column id="ALL_BBS" size="256" type="STRING"/>
          <Column id="S_GBN" size="256" type="STRING"/>
          <Column id="S_WORD" size="256" type="STRING"/>
          <Column id="BBS_ID" size="256" type="STRING"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="ALL_BBS"/>
            <Col id="BBS_ID"/>
            <Col id="CURR_PAGE"/>
            <Col id="PAGE_SIZE">25</Col>
            <Col id="S_GBN"/>
            <Col id="S_WORD"/>
            <Col id="SEARCH_YN"/>
            <Col id="TOT_CNT"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_file">
        <ColumnInfo>
          <Column id="FILE_NM" size="256" type="STRING"/>
          <Column id="S_FILE_NM" size="256" type="STRING"/>
          <Column id="FILE_SIZE" size="256" type="STRING"/>
          <Column id="SHOW_NM" size="256" type="STRING"/>
          <Column id="FLAG" size="256" type="STRING"/>
          <Column id="FILE_PATH" size="256" type="STRING"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_master" oncolumnchanged="ds_master_oncolumnchanged">
        <ColumnInfo>
          <Column id="APPEND1" size="200" type="STRING"/>
          <Column id="APPEND2" size="200" type="STRING"/>
          <Column id="APPEND3" size="200" type="STRING"/>
          <Column id="BBS_ID" size="22" type="BIGDECIMAL"/>
          <Column id="CON_ID" size="22" type="BIGDECIMAL"/>
          <Column id="CONTENTS" size="2000" type="STRING"/>
          <Column id="EDATE" size="8" type="STRING"/>
          <Column id="g_EmpNo" size="255" type="STRING"/>
          <Column id="LEVELS" size="22" type="BIGDECIMAL"/>
          <Column id="NOTICE_EDATE" size="8" type="STRING"/>
          <Column id="NOTICE_YN" size="1" type="STRING"/>
          <Column id="PARENT_CON_ID" size="22" type="BIGDECIMAL"/>
          <Column id="PASSWORD" size="50" type="STRING"/>
          <Column id="REMARK" size="300" type="STRING"/>
          <Column id="SAPPEND1" size="200" type="STRING"/>
          <Column id="SAPPEND2" size="200" type="STRING"/>
          <Column id="SAPPEND3" size="200" type="STRING"/>
          <Column id="SECRET_YN" size="1" type="STRING"/>
          <Column id="TITLE" size="100" type="STRING"/>
          <Column id="UPJANG" size="22" type="BIGDECIMAL"/>
          <Column id="N_CONT" size="256" type="STRING"/>
          <Column id="POPUP_YN" size="256" type="STRING"/>
          <Column id="POPUP_SDATE" size="256" type="STRING"/>
          <Column id="POPUP_EDATE" size="256" type="STRING"/>
          <Column id="ATTR01" size="256" type="STRING"/>
          <Column id="ATTR02" size="256" type="STRING"/>
          <Column id="ATTR03" size="256" type="STRING"/>
          <Column id="WRITE_TIME" size="256" type="STRING"/>
          <Column id="STEP" size="256" type="BIGDECIMAL"/>
          <Column id="WRITE_SABUN" size="256" type="STRING"/>
          <Column id="READ_ALL_YN" size="256" type="STRING"/>
          <Column id="OLD_POPUP_YN" size="256" type="STRING"/>
          <Column id="APPEND4" size="256" type="STRING"/>
          <Column id="APPEND5" size="256" type="STRING"/>
          <Column id="SAPPEND4" size="256" type="STRING"/>
          <Column id="SAPPEND5" size="256" type="STRING"/>
          <Column id="ATTR04" size="256" type="STRING"/>
          <Column id="ATTR05" size="256" type="STRING"/>
          <Column id="HTML_URL" type="STRING" size="256"/>
          <Column id="IS_MOBILE" type="STRING" size="256"/>
          <Column id="ATTR06" type="STRING" size="256"/>
          <Column id="USER_TYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_target" useclientlayout="true">
        <ColumnInfo>
          <Column id="TARGET_CODE" size="256" type="STRING"/>
          <Column id="TARGET_CLASS" size="256" type="STRING"/>
          <Column id="CODE_NAME" size="256" type="STRING"/>
          <Column id="CENTER_CODE" size="256" type="STRING"/>
          <Column id="ROW_NUM" type="STRING" size="256"/>
          <Column id="CUST_TYPE_SRC" type="STRING" size="256"/>
          <Column id="CUST_TYPE" type="STRING" size="256"/>
          <Column id="CENTER_NAME" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_order" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="P_ORDER" type="STRING" size="256"/>
          <Column id="P_TEXT" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="ed_regDate_value" compid="ed_regDate" propid="value" datasetid="ds_master" columnid="WRITE_TIME"/>
      <BindItem id="med_noticDt_value" compid="med_noticDt" propid="value" datasetid="ds_master" columnid="NOTICE_EDATE"/>
      <BindItem id="med_pFromDt_value" compid="med_pFromDt" propid="value" datasetid="ds_master" columnid="POPUP_SDATE"/>
      <BindItem id="ed_title_value" compid="ed_title" propid="value" datasetid="ds_master" columnid="TITLE"/>
      <BindItem id="chk_popup_value" compid="chk_popup" propid="value" datasetid="ds_master" columnid="POPUP_YN"/>
      <BindItem id="med_pToDt_value" compid="med_pToDt" propid="value" datasetid="ds_master" columnid="POPUP_EDATE"/>
      <BindItem id="chk_notic_value" compid="chk_notic" propid="value" datasetid="ds_master" columnid="NOTICE_YN"/>
      <BindItem id="med_eDate_value" compid="med_eDate" propid="value" datasetid="ds_master" columnid="EDATE"/>
      <BindItem id="item0" compid="chk_notic00" propid="value" datasetid="ds_master" columnid="IS_MOBILE"/>
      <BindItem id="item1" compid="cbo_order" propid="value" datasetid="ds_master" columnid="ATTR06"/>
      <BindItem id="item2" compid="cbo_user" propid="value" datasetid="ds_master" columnid="USER_TYPE"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[include "U_lib::lib_conversionCom.xjs";
/*
 ******************************************************************************************
 * 시스템구분   : 게시판 
 * 프로그램명   :  SCC80060V.xml 
 * 기      능   : 게시물 조회 
 * 작  성  자   : 
 * 작성  일자   : 2008-01-24
 * 비      고   : 
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
//=========================================================================================
// [ PART 1 ]
// Form에서 Include 할 내용을 정의
//
//=========================================================================================
//@@컨버터에서 주석처리 #include "LIB::sc_comon.js";
//@@컨버터에서 주석처리 #include "LIB::lib_comm_0001.js";
//@@컨버터에서 주석처리 #include "LIB::tit_comm_0001.js";		// X-Framework Lib
//=========================================================================================
// [ PART 2 ]
// Form에서 사용될 전역변수를 선언
//
//=========================================================================================
var F_CURR_BBS_ID = ""; // 현재 처리하고 있는 게시판 아이디 
var F_IS_AFTER_SAVE = false;   
//=========================================================================================
// [ PART 3 ]
// Form Loading 시 작업 정의
//
//=========================================================================================
function form_onload(obj:Form, e:LoadEventInfo)
{
	gfn_formOnLoad(obj, false);

	//namoWeb.ShowToolbar(0, false);  // 메뉴 감추기 
	//namoWeb.ShowTab(false);  // tab 감추기
	//namoWeb.visible = true;
}
//=========================================================================================
// [ PART 4 ]
// Main Process Event 정의(조회,입력,삭제,저장,인쇄,도움말,form닫기)
//
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : fn_clearDetail()
 * 기      능   : 화면 초기화 처리 
 ******************************************************************************************
 */
function fn_clearDetail(bbsId) {
    F_IS_AFTER_SAVE = false;
    if ( bbsId > 0 ) {
        F_CURR_BBS_ID = bbsId;  // 현재 게시판 ID 
    }
    
    //namoWeb.Value = "<html></html>"; 
    namoWeb.Value = "";  //궂이 필요할까? 어디에서 필요할까?

    ds_master.clearData();
    ds_master.addRow();
    
    ds_file.clearData();
    med_fileSize.value = 0;
    
    // 팝업여부 , 공지여부 ,공지 종료일 - g_AuthLevel = 99 만 가능 
    //var isVisible = (MF_CURR_AUTH >= F_ADMIN_LEVEL);

    var isVisible = false;
    if (g_Board_Mst == "관리자" || g_Board_Mst == "공지자") isVisible = true;
    
    
    st_Notic.visible  = isVisible;
    chk_notic.visible = isVisible;   
    
    st_Popup.visible = isVisible;
    chk_popup.visible = isVisible;
    
    if ( isVisible ) {
		if ( (application.g_EmpNo).indexOf("CS") == 0 ) {
			st_Notic.visible = !isVisible;
			chk_notic.visible = !isVisible;   
			
			if ( bbsId != "22" ) {
				st_Popup.visible = !isVisible;
				chk_popup.visible = !isVisible;
			}
		} 
    }
    
    // 게시 대상 선택 게시판 여부 -> 게시판 자체 존재하며, admin인 경우만 가능 
    btn_selectP.visible = mfn_isPriv(F_CURR_BBS_ID);
    
    if (btn_selectP.visible)
    {
		Static15.text = "게 시 대 상";
    }
    else
    {
		Static15.text = "게시물 복사";
    }
    //Static15.visible    = btn_selectP.visible;
     
    // 복사 게시판 선택 가능 게시판 여부 
    btn_selectB.visible = mfn_isCopy(F_CURR_BBS_ID);
    
    btn_selectP.enable = true;
    btn_selectB.enable = false;
    
    
    //처음작성글일경우 게시대상지정 clear -- 2008.07.10    
    ds_target.clearData();
    
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_init()
 * 기      능   : 현재 게시판 초기화  -> 작성 모드로 들어올 경우 
 ******************************************************************************************
 */
function fn_init(bbsId, parentConId, parentLevel, parentStep) {
	
	//trace(bbsId+":"+ parentConId+":"+ parentLevel+":"+ parentStep);


    // 초기화 
    fn_clearDetail(bbsId);
	fn_selectOrder(bbsId);
	
    if ( MF_SYS_TYPE == F_FOMS ) {  // 협력업체 일 경우 
        ds_master.setColumn(0, "UPJANG", g_CustCd); // upjang 
        // 작성자 명 
        ed_writer.value = g_Name + "/" + g_CustNm;
    } else {
        ds_master.setColumn(0, "UPJANG", g_Upjang); // upjang 
        // 작성자 명 
        ed_writer.value = g_Name + "/" + g_UpjangNm;
    }   
    
    ds_master.setColumn(0, "BBS_ID", bbsId);    // 게시판 id 
    ds_master.setColumn(0, "WRITE_SABUN", g_EmpNo);
    ds_master.setColumn(0, "NOTICE_YN", "N");
    ds_master.setColumn(0, "POPUP_YN", "N");
    ds_master.setColumn(0, "READ_ALL_YN", "Y"); // 게시대상 선택 유무 
    
    cbo_endGbn.value = "2";	
    var curDate = gfn_today();
	med_eDate.value = gfn_addMonth( curDate, 1);
	
	ed_regDate.value = fn_masking(gfn_today());
    chk_notic_OnClick(chk_notic,"N");// 중요 공지 여부 
    chk_popup_OnClick(chk_popup,"N");// 팝업 여부 
    
    var e = new EventInfo();
    e.postvalue = cbo_endGbn.value;
    cbo_endGbn_OnChanged(cbo_endGbn,e); // 게시기간 
    
	// 부모 정보 설정 - 답변 또는 자기 자신 
    ds_master.setColumn(0, "LEVELS", toNumber(parentLevel) + 1);
    if ( toNumber(parentStep) == 0 ) {
        ds_master.setColumn(0, "STEP", 1);
    } else {
        ds_master.setColumn(0, "STEP", toNumber(parentStep));
    }

    if ( parentConId > 0 ) {
        // 답변 모드 임. 
        var dsObj = parent.div_list.ds_list;
        var row = dsObj.findRow("CON_ID", parentConId );
        // 답변이다. 
        ds_master.setColumn(0, "PARENT_CON_ID", dsObj.getColumn(row, "PARENT_CON_ID") );
        ed_title.value = "[RE]" + dsObj.getColumn(row, "TITLE");
        
        // 답변일 경우에는 처리 불가능 
        btn_selectP.enable = false;
        btn_selectB.enable = false;
        
        var isVisible = false;
        st_Notic.visible = isVisible;
        chk_notic.visible = isVisible;
        st_Popup.visible = isVisible;
        chk_popup.visible = isVisible;
    }
    
    if (arguments.length > 4) {
		var mobileYn = arguments[4];
		
		if (mobileYn == "Y") {
			st_mobile.visible = true;
			chk_notic00.visible = true;
			//20220831 김명섭 모바일공지 사용자구분 속성관리 추가
			cbo_user.visible = true;
		}
		else {
			st_mobile.visible = false;
			chk_notic00.visible = false;
			//20220831 김명섭 모바일공지 사용자구분 속성관리 추가
			cbo_user.visible = false;
		}
    }
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_updateInit()
 * 기      능   : 현재 게시판 초기화 
 ******************************************************************************************
 */
function fn_updateInit( bbsId, bbsConId ) {
    // 초기화 
    fn_clearDetail(bbsId);
    
    // 수정 자료 조회 
    fn_select( bbsConId );
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_select()
 * 기      능   : 게시물 번호에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_select(bbsCondId) {
    ds_master.clearData();
    namoWeb.Value = "";    
    fsp_callService(this, "SCC80050E_ACT", "select"
            , ""
            , "ds_master=ds_master ds_target=ds_target"
            , "CON_ID=" + bbsCondId 
            , "fn_afterSelect"
            , true);
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_select()
 * 기      능   : 게시물 번호에 해당하는 정보를 조회
 ******************************************************************************************
 */
function fn_selectOrder(bbsId) {
	ds_order.clearData();
	if ( ds_master.rowcount == 1 && gfn_isNull(ds_master.getColumn(0, "BBS_ID")) && !gfn_isNull(bbsId) ) {
		ds_master.setColumn(0, "BBS_ID", bbsId);
	}
	
	fsp_callService(this, "SCC80050E_ACT", "selectOrder"
            , "ds_master=ds_master:N"
            , "ds_order=ds_order"
            , "BBS_ID=" + bbsId
            , "fn_afterSelectOrder"
            , true);
}

/*
 ******************************************************************************************
 * 함  수  명   : btn_save_OnClick()
 * 입      력   :
 * 반      환   : 없음
 * 기      능   : 저장 버튼 선택 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function btn_save_OnClick(obj:Button, e:ClickEventInfo)
{
	if ( gfn_isNull(ed_title.value) ) {	
        gfn_alert(gfn_msg( SCCW00002, "제목"));
		if (ed_title.enable) ed_title.setFocus();
        return;
    }
    if ( gfn_isNull(cbo_endGbn.value) ) {
		gfn_alert(gfn_msg( SCCW00002, "게시종료일"));
		if (cbo_endGbn.enable) cbo_endGbn.setFocus();
        return;
    }
    if ( gfn_isNull(med_eDate.value) ) {
		gfn_alert(gfn_msg( SCCW00002, "게시종료일"));
		if (med_eDate.enable) med_eDate.setFocus();
        return;
    }
    
    if ( chk_notic.visible == true && chk_notic.value == "Y" ) {
        if ( gfn_isNull(med_noticDt.value) ) {
			gfn_alert(gfn_msg( SCCW00002, "공지종료일"));
			if (med_noticDt.enable) med_noticDt.setFocus();
            return;
        }
        
        if ( toNumber(med_noticDt.value ) < toNumber(gfn_today() ) ) {
            var arr = ["공지종료일", "현재일자"];
            gfn_alert(gfn_msg( SCCW00009, arr));
            med_noticDt.setFocus();
            return;
        }
        
        if ( toNumber(med_noticDt.value ) > toNumber(med_eDate.value ) ) {
            var arr = ["게시종료일", "공지종료일"];
            gfn_alert(gfn_msg( SCCW00009, arr));
            med_eDate.setFocus();
            return;
        }
        
		var day = gfn_getLastDateNum(gfn_today());
		var dayCnt = gfn_getDiffDay(gfn_today(), med_noticDt.value) + 1;
		
		if (dayCnt > day)
		{
			if (g_Board_Mst == "공지자")
			{
				gfn_alert("공지자 권한은 중요공지 기간을 한달 이상 지정할 수 없습니다.");
				med_noticDt.value = "";
				return;
			}
		}     
    }
    
    if ( chk_popup.visible == true && chk_popup.value == "Y" ) {
        if ( gfn_isNull(med_pFromDt.value) ) {
			gfn_alert(gfn_msg( SCCW00002, "팝업시작일"));
			if (med_pFromDt.enable) med_pFromDt.setFocus();
            return;
        }
        if ( gfn_isNull(med_pToDt.value) ) {
			gfn_alert(gfn_msg( SCCW00002, "팝업종료일"));
			if (med_pToDt.enable) med_pToDt.setFocus();
            return;
        }
        
        if ( toNumber(med_pToDt.value ) < toNumber(gfn_today() ) ) {
            var arr = ["팝업종료일", "현재일자"];
            gfn_alert(gfn_msg( SCCW00009, arr));
            med_pToDt.setFocus();
            return;
        }
        
        if ( toNumber(med_pToDt.value ) < toNumber(med_pFromDt.value ) ) {
            var arr = ["팝업종료일", "팝업시작일"];
            gfn_alert(gfn_msg( SCCW00009, arr));
            med_pFromDt.setFocus();
            return;
        }
        
		var dayCnt = gfn_getDiffDay(med_pFromDt.value, med_pToDt.value) + 1;
				
				
		if (g_Board_Mst == "공지자" && (dayCnt > 4))
		{
			gfn_alert("공지자 권한은 팝업 기간을 4일 이상 지정할 수 없습니다.");
			med_pToDt.value = "";
			
			return;
		}
    }
    
    if ( gfn_length(gfn_trim( namoWeb.MIMEValue ))== 0 ) {
        gfn_alert( gfn_msg(SCCW00002, "내용") );
        namoWeb.setFocus();
        return;
    }
    
    if ( gfn_lengthByte( namoWeb.TextValue)> 4000 ) {
        gfn_alert("내용은 최대 한글 2000자/ 영숫자 4000자\n까지만 작성 가능합니다.");
        return;
    }
    
    //contents 필드 maxlength처리################################################################
    
    var str_namoWeb_TextValue;
    str_namoWeb_TextValue = namoWeb.TextValue;
    /*
    str_namoWeb_TextValue = replace(str_namoWeb_TextValue, "  ", " ");
    str_namoWeb_TextValue = replace(str_namoWeb_TextValue, "  ", " ");
    str_namoWeb_TextValue = replace(str_namoWeb_TextValue, "  ", " ");
    str_namoWeb_TextValue = replace(str_namoWeb_TextValue, "  ", " ");
    
    str_namoWeb_TextValue = replace(str_namoWeb_TextValue, "\r", "");
    str_namoWeb_TextValue = replace(str_namoWeb_TextValue, "\n", "");
    */  


    if ( gfn_lengthByte( str_namoWeb_TextValue)> 3900 ) {
        gfn_alert("내용은 최대 한글 2000자/ 영숫자 4000자\n까지만 작성 가능합니다.");
        return;
    }


    if (gfn_lengthByte(str_namoWeb_TextValue)> 1000){

			str_namoWeb_TextValue = MidB(str_namoWeb_TextValue, 0, 1000);

			str_namoWeb_TextValue +=  ":maxlength잘림";

    }


    
    

    //contents 필드 maxlength처리################################################################

        
    // 저장 처리 
    ds_master.setColumn(0, "N_CONT", namoWeb.MIMEValue);   
    ds_master.setColumn(0, "CONTENTS", str_namoWeb_TextValue);
    
    //작성자 처리
    ds_master.setColumn(0, "g_EmpNo", g_EmpNo);   

    
    // 첨부파일 저장 
    //fn_createWait("첨부파일 저장 중입니다.", this);
    setCapture();
    SetWaitCursor(true);
    
    ds_file.enableevent = false;
    ds_file.filter("");
    var isOk = true;
    for( var i = 0; i < ds_file.getRowCount(); i++) {
        if ( ds_file.getColumn(i, "FLAG") == "I" ) {
            // 서버로 전송 
            //var arr = tit_fileWrite(httpFile, MF_FILE_SERVER_DIR //AS_IS
            var arr = fsp_fileWrite(httpFile, MF_FILE_SERVER_DIR
                , ds_file.getColumn(i, "FILE_PATH")
                , ds_file.getColumn(i, "FILE_NM")); 
            if ( arr[0] != "S" ) {
                isOk = "파일 전송 실패\n"+ arr[1];
                break;
            }
            
            ds_file.setColumn(i, "S_FILE_NM", arr[2] ); // 서버 파일명 
        } else if ( ds_file.getColumn(i, "FLAG") == "D" ) {
            // 삭제 
            //var isDelete = tit_fileDelete(MF_FILE_SERVER_DIR, ds_file.getColumn(i, "S_FILE_NM") //AS-IS
            var isDelete = fsp_fileDelete(MF_FILE_SERVER_DIR, ds_file.getColumn(i, "S_FILE_NM")
                , true);
            if ( isDelete == false) {
                isOk = "파일 삭제에 실패했습니다.";
                break;
            }
        }
    }   // end for 
    
    ds_file.filter(" FLAG != 'D'");
    ds_file.enableevent = true;
    
    //fn_destroyWait();
    releaseCapture();
    SetWaitCursor(false);
    
    // 실패 
    if ( isOk  != true ) {
        gfn_alert( isOk );
        return;
    }
    
    var actionNm = "insert";
    if ( ds_master.getColumn(0, "CON_ID") > 0 ) {
        actionNm = "update";
    }

	//압축 통신 설정
	//http.Compress = true;
	//http.CompressMethod = "ZLIB";
	//압축 통신 설정	

    fsp_callService(this, "SCC80050E_ACT", actionNm
            , "ds_master=ds_master:A ds_file=ds_file:A ds_target=ds_target:A"
            , "ds_master=ds_master ds_target=ds_target"
            , "" 
            , "fn_afterSave"
            , false);
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSave()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   :  저장 후 callback 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function fn_afterSave(errCode, errMsg) {
	//압축 통신 해제
	//http.Compress = false;
	//http.CompressMethod = "";
	//압축 통신 해제

	if ( errCode == -100 ) {
		gfn_alert(errMsg);
		return;
	}
	
    F_IS_AFTER_SAVE = true;

    // 파일 처리 
    ds_file.enableevent = false;
    ds_file.filter("");
    for( var i = ds_file.getRowCount()-1; i >= 0 ; i-- ) {
        if ( ds_file.getColumn(i, "FLAG") == "D" ) {
            ds_file.deleteRow(i);
        } else {
            ds_file.setColumn(i, "FLAG", "S");
        }
    }
    ds_file.applyChange();
    ds_file.enableevent = true;
    ds_file.filter(" FLAG <> 'D'");
    
    // 게시판 복사 버튼 
    btn_selectB.enable = true;
    
    g_Message("02");
    
//    btn_list_OnClick(btn_list);
}
/*
 ******************************************************************************************
 * 함  수  명   : fn_afterSelect()
 * 입      력   : errCode 	= 에러코드
				  errMsg	= 에러메세지
 * 반      환   : 없음
 * 기      능   :  조회 후 callback 
 * 작  성  자   : 
 * 작성  일자   : 
 ******************************************************************************************
 */
function fn_afterSelect(errCode, errMsg)
{	
    // 첨부 파일 처리 
    if ( ds_master.getRowCount() == 0 ) {
        gfn_alert("해당하는 게시물이 존재하지 않습니다.");
        return;
    }
    
    // namo 
    namoWeb.MIMEValue = ds_master.getColumn(0, "N_CONT");
    
    // 작성자 명 
    ed_writer.value = ds_master.getColumn(0, "NM_KOR") + "/" 
        + ds_master.getColumn(0, "UPJANGNM");
    
    // 파일 표시 
    mfn_makeFileDs( ds_file, ds_master );
    
    // 전체 파일 사이즈 계산 
    med_fileSize.value = Math.round(ds_file.getSum("FILE_SIZE")/1024, 0); 
       
    if( ds_master.getColumn(0, "EDATE") == "99991231" ) {
        // 보존으로 
        cbo_endGbn.value = "99991231";
    } else {
        // 사용자 지정으로 
        cbo_endGbn.value = "3";
    }
    
    var e = new EventInfo();
    e.postvalue = cbo_endGbn.value;
    cbo_endGbn_OnChanged(cbo_endGbn,e);
    
    if (mfn_getCurrMobileYn() == "Y") {
		st_mobile.visible = true;
		chk_notic00.visible = true;
		//20220831 김명섭 모바일공지 사용자구분 속성관리 추가
		cbo_user.visible = true;
    }
    else {
		st_mobile.visible = false;
		chk_notic00.visible = false;
		//20220831 김명섭 모바일공지 사용자구분 속성관리 추가
		cbo_user.visible = false;
    }
    
    // 중요 공지 여부 
    chk_notic_OnClick(chk_notic,chk_notic.value);
    // 팝업 여부 
    chk_popup_OnClick(chk_popup,chk_popup.value);
    
    // 게시판 복사 버튼 
    btn_selectB.enable = true;
   
    fn_selectOrder(ds_master.getColumn(0, "BBS_ID"));
    
}

function fn_afterSelectOrder(errCode, errMsg) {
	
	ds_order.insertRow(0);
	ds_order.setColumn(0, "P_ORDER", null);
	ds_order.setColumn(0, "P_TEXT", (ds_order.rowcount == 2) ? (ds_master.getColumn(0, "ATTR06") == ds_order.getColumn(1, "P_ORDER") ? "해제" : "선택") : "선택");
	
	if ( ds_master.getColumn(0, "NOTICE_YN") == "Y" ) {
		cbo_order.enable = !( ds_order.rowcount == 1 );
	} else {
		cbo_order.enable = false;
	}
	
}

//=========================================================================================
// [ PART 6 ]
// component Event 정의 ( User Define function )
// --> component Event의 기요,기능,동작 등 상세내용은 MiPlatform 메뉴얼을 참조하시기 바랍니다.
//=========================================================================================
/*
 ******************************************************************************************
 * 함  수  명   : btn_fileAdd_OnClick
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 파일 추가 버튼 선택 
 * 작  성  자   : 조은영
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
var v_ArrFiles          = new Array();
var v_sFileNameSize     = 100;          // Local파일명의 길이 (default는 100 Byte)
var maxFileSize = GF_FILE_UPLOAD_SIZE;
 
function btn_fileAdd_OnClick(obj:Button, e:ClickEventInfo)
{
	if( ds_file.getRowCount() == 5 ) {
        gfn_alert("파일은 최대 5개까지만 첨부할 수 있습니다.");
        return;
	}
		
    //멀트 업로드로 변경(2015-08-31 :: 김재섭)
	var v_objFileDialog = new FileDialog();
    v_objFileDialog.defaultextention = true;
	var v_arrFileList = v_objFileDialog.open("파일 추가", FileDialog.MULTILOAD);
	
	if ( gfn_isNull( v_arrFileList ) ){	return false; }
	// 값이 존재하면
	var v_arrIdx      = v_ArrFiles.length;
	for (var i = 0; i < v_arrFileList.length; i++) {
		var v_nRow = ds_file.findRow("FILE_NM", v_arrFileList[i].filename);
		
		var strFileName = v_arrFileList[i].filename;	// 파일명
		
		if (!fn_fileNameFilter(strFileName))
		{
			return false;
		}
		
		var strFileExt = strFileName.substring(strFileName.lastIndexOf('.')+1, strFileName.length).toLowerCase(); //확장자, 일괄 소문자로 변경       
				
		if (fv_UPLOAD_PROHIBITED_FILE_EXTENTION.indexOf(strFileExt) >= 0) {
			gfn_alert("msg.err.noExtentionFile", fv_UPLOAD_PROHIBITED_FILE_EXTENTION);	// 첨부할 수 없는 형식의 파일입니다.@[.js .jsp .asp .xml .exe .php .css .py .bat .cmd .sql]
			return false;
		}

		if (gfn_lengthByte(v_arrFileList[i].filename) > v_sFileNameSize) {
			gfn_alert("msg.err.filenamelength");	// 파일명 길이가 너무 깁니다. 파일명은 100Byte보다 작어야 합니다.
			return false;
		}
		
		if (v_nRow > -1) {
			gfn_alert("msg.err.dupfilename", v_arrFileList[i].filename);	// 중복되는 파일명( $1)이 있습니다.
		} else {
			if( ds_file.getRowCount() == 5 ) {
				gfn_alert("파일은 최대 5개까지만 첨부할 수 있습니다.");
				return;
			}
			
 			if(fn_addFileRow(v_arrFileList[i])) {            // 파일 정보 Row 생성
 				v_ArrFiles[v_arrIdx] = v_arrFileList[i];    // 파일 배열 생성
 				v_arrIdx++;
 			}
		}
	}
	
// 	fileDialog.Open();
// 	var filePath = fileDialog.FilePath;
// 	var fileName = fileDialog.FileName;
// 	if ( gfn_length( filePath )== 0 || gfn_length( fileName )== 0 ) {
//         return;
// 	}
// 	if ( ds_file.findRow("FILE_NM", fileName ) != -1 ) {
//         gfn_alert("동일한 파일이 이미 존재합니다.");
//         return;
// 	}
// 	
// 	var size = tmpFile.GetLength(filePath + "\\" + fileName);
// 	
// 	var totSize = toNumber(med_fileSize.value) *1024 + size;
// 	if ( totSize > GF_FILE_UPLOAD_SIZE ) {
//         gfn_alert("파일은 총 10M 용량까지만 첨부할 수 있습니다.");
//         return;
// 	}
// 
// 	// 서버로 전송 
// //	var arr = tit_fileWrite(httpFile, MF_FILE_SERVER_DIR, filePath, fileName); 
// //	if ( arr[0] != "S" ) {
// //        gfn_alert( "파일 전송 실패\n"+ arr[1] );
// //        return;
// //	}
// 	
// 	var nRow = ds_file.addRow();
// 	ds_file.setColumn(nRow, "FILE_NM", fileName);
// 	ds_file.setColumn(nRow, "FILE_PATH", filePath);
// 	
// //	ds_file.setColumn(nRow, "S_FILE_NM", arr[2]);
// 	ds_file.setColumn(nRow, "FILE_SIZE", size);
// 	ds_file.setColumn(nRow, "SHOW_NM", fileName + "(" + Math.round((size/1024),0) + "KB)");
// 	ds_file.setColumn(nRow, "FLAG", "I");
// 	
// 	// 전체 사이즈 증가 
// 	med_fileSize.value =  toNumber(med_fileSize.value) + Math.round((size/1024), 0);
}

/*----------------------------------------------------------------------------------------------
 * 설명   : 파일 Row 추가
 *---------------------------------------------------------------------------------------------*/
function fn_addFileRow(v_objVirtualFile) 
{
    var v_sFileName, v_nFileSize, v_sFilePath, v_sExt;
    var bSuccess = v_objVirtualFile.open(VirtualFile.openAppend | VirtualFile.openBinary);
    if(bSuccess == false) {
        gfn_alert("파일이 열려 있습니다. 닫은 후 첨부하세요.");
        v_objVirtualFile.close();
        return false;
    }
    
    //file명을 포함한 전체 경로 가져오기
    v_sFilePath = v_objVirtualFile.fullpath;
    v_sFilePath = v_sFilePath.substring(0, v_sFilePath.lastIndexOf("\\")+1);
    v_sFileName = v_objVirtualFile.filename;
	
    //v_sExt = v_sFilePath.substring(v_sFilePath.lastIndexOf( "." ) + 1, v_sFilePath.length );
    v_nFileSize = v_objVirtualFile.getFileSize();
    v_objVirtualFile.close();
	
	// maxFileSize가 -1일때는 파일용량 체크 안함
    if(maxFileSize != -1 && maxFileSize < v_nFileSize)
    {
		gfn_alert("msg.err.filesize", gfn_numFormat(maxFileSize));	// 첨부 파일의 용량은 최고 $1 MB까지 입니다.
		return false;
    }

    var v_nRow = ds_file.addRow();
    ds_file.setColumn(v_nRow, "FLAG", 		"I");
    ds_file.setColumn(v_nRow, "FILE_PATH", 	v_sFilePath);    // 첨부파일경로명
    ds_file.setColumn(v_nRow, "FILE_NM",  v_sFileName);    // 첨부파일명
    ds_file.setColumn(v_nRow, "FILE_SIZE",     v_nFileSize);    // 첨부파일크기
    ds_file.setColumn(v_nRow, "SHOW_NM", v_sFileName + "(" + Math.round((v_nFileSize/1024),0) + "KB)");
    
    med_fileSize.value =  toNumber(med_fileSize.value) + Math.round((v_nFileSize/1024), 0);
    
    return true;
}

function fn_fileNameFilter(fileName)
{
	var filterChar = /(;)/;
	var rtn = !filterChar.test(fileName);
	
	if (!rtn)
	{
		gfn_alert("특수문자(;)가 포함된 파일은 업로드할 수 없습니다.");
		return rtn;
	}
	
	filterChar = /(&)/;
	rtn = !filterChar.test(fileName);
	
	if (!rtn)
	{
		gfn_alert("특수문자(&)가 포함된 파일은 업로드할 수 없습니다.");
		return rtn;
	}
	
	filterChar = /(')/;
	rtn = !filterChar.test(fileName);
	
	if (!rtn)
	{
		gfn_alert("특수문자(')가 포함된 파일은 업로드할 수 없습니다.");
		return rtn;
	}
	
	filterChar = /(\+)/;
	rtn = !filterChar.test(fileName);
	
	if (!rtn)
	{
		gfn_alert("특수문자(+)가 포함된 파일은 업로드할 수 없습니다.");
		return rtn;
	}
	
		
	return rtn;
}
	

/*
 ******************************************************************************************
 * 함  수  명   : btn_fileDel_OnClick
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 파일 삭제 버튼 선택 
 * 작  성  자   : 조은영
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function btn_fileDel_OnClick(obj:Button, e:ClickEventInfo)
{
	if( ds_file.getRowCount() == 0 || lst_file.index == -1) {
        gfn_alert("삭제할 첨부 파일을 선택하여 주십시오.");
        return;
	}

	var sFileName = ds_file.getColumn(lst_file.index, "S_FILE_NM" );
	if ( gfn_length( sFileName )> 0 ) {
    /*    var isDelete = tit_fileDelete(MF_FILE_SERVER_DIR, sFileName, true);
        if ( isDelete == false) {
            gfn_alert("파일 삭제에 실패했습니다.");
            return;
        }
    */
        ds_file.setColumn(lst_file.index, "FLAG", "D");
    } else {    
        ds_file.deleteRow( lst_file.index );
    }    
    ds_file.filter(" FLAG <> 'D' ");
    med_fileSize.value = Math.round(ds_file.getSum("FILE_SIZE")/1024, 0);
}
/*
 ******************************************************************************************
 * 함  수  명   : cbo_endGbn_OnChanged
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 보존 기간 변경 시 
 * 작  성  자   : 조은영
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function cbo_endGbn_OnChanged(obj:Combo, e)
{
	// 사용자 정의 
    med_eDate.enable = ( e.postvalue == "3" );
    btn_eDate.enable = ( e.postvalue == "3" );
	
	var curDate = gfn_today();
	switch( e.postvalue ) {
        case "1":   // 1주일 
            med_eDate.value = gfn_calDate( curDate, 7,"A");
            break;
        case "2":   // 한달 
            med_eDate.value = gfn_addMonth( curDate, 1 );
            break;
        case "99991231":
            med_eDate.value = "99991231";
            break;
        case "3":
            if( gfn_length(med_eDate.value)== 0 ) {
                med_eDate.value = curDate;
            }    
            break;
        default:
            med_eDate.value = "";
            break;
	}
}
/*
 ******************************************************************************************
 * 함  수  명   : chk_notic_OnClick
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 공지 여부 확인 
 * 작  성  자   : 조은영
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function chk_notic_OnClick(obj, sValue)
{
    med_noticDt.visible = ( sValue == "Y" );
    btn_noticDt.visible = med_noticDt.visible;
    st_noticEnd.visible = med_noticDt.visible;
    
	if ( med_noticDt.visible ) {
        if ( med_noticDt.value == "" ) {
            med_noticDt.value = gfn_calDate( gfn_today(), 7,"A").substr(0,8);
            med_noticDt.setFocus();
        }
	} else {
        med_noticDt.value = "";
	}
}

function chk_notic_onclick(obj:CheckBox,  e:ClickEventInfo)
{
	chk_notic_OnClick(obj, obj.value);
}

/*
 ******************************************************************************************
 * 함  수  명   : chk_popup_OnClick
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 팝업 여부 확인 
 * 작  성  자   : 조은영
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function chk_popup_OnClick(obj, sValue)
{
	var isVisible = (sValue == "Y");
	med_pFromDt.visible = isVisible;
	btn_pFromDt.visible = isVisible;
	st_pUnder.visible = isVisible;
	med_pToDt.visible = isVisible;
	btn_pToDt.visible = isVisible;
	
	if ( isVisible && gfn_length( med_pFromDt.value)> 0 ) {
	
	    if (gfn_length(med_pFromDt.value)== 0)
        med_pFromDt.value = gfn_calDate( gfn_today(), 1,"A");
        
        if (gfn_length(med_pToDt.value)== 0)
        med_pToDt.value = gfn_calDate( med_pFromDt.value, 1,"A");
        
        
	} else {
        med_pFromDt.value = "";
        med_pToDt.value = "";
	}
}

function chk_popup_onclick(obj:CheckBox,  e:ClickEventInfo)
{
	chk_popup_OnClick(obj, obj.value);
}


/*
 ******************************************************************************************
 * 함  수  명   : btn_list_OnClick
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 목록 돌아가기  확인 
 * 작  성  자   : 조은영
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function btn_list_OnClick(obj:Button, e:ClickEventInfo)
{
	if (!fn_validCheck()) return;
	
    mfn_showList(F_IS_AFTER_SAVE);
}

function fn_validCheck()
{
	
	// v_ds_check 미사용시 변경사항 체크
	if (gfn_dsIsUpdated(ds_master) == true) 
	{
		var retValue = gfn_confirm("현재 작성중인 글은 저장되지않습니다.\n계속 진행 하시겠습니까?");
		if (retValue == false) return false;
	}
	
	namoWeb.TextValue = "";
	//ed_title.value = "";
	ds_file.clearData();
	ds_master.clearData();

	return true;
	
// 	var str_namoWeb_TextValue = namoWeb.TextValue;
// 	str_namoWeb_TextValue = replace(str_namoWeb_TextValue, "\r", "");
// 	str_namoWeb_TextValue = replace(str_namoWeb_TextValue, "\n", "");
// 	
// 	if (gfn_isNull(ds_master.getColumn(0, "CON_ID"))) {
// 		// v_ds_check 미사용시 변경사항 체크(입력 프로그램일때 변경되는 Dataset 전체 기술)
// 		if (!gfn_isNull(ed_title.value))
// 		{
// 			// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
// 			if (gfn_confirm("변경된 자료가 있습니다.\n계속하시겠습니까?")) {
// 				namoWeb.TextValue = "";
// 				ed_title.value = "";
// 				ds_file.clearData();
// 				return true;
// 			}
// 			else {
// 				return false;
// 			}
// 		}
// 		
// 		if (!gfn_isNull(str_namoWeb_TextValue))
// 		{
// 			// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
// 			if (gfn_confirm("변경된 자료가 있습니다.\n계속하시겠습니까?")) {
// 				namoWeb.TextValue = "";
// 				ed_title.value = "";
// 				ds_file.clearData();
// 				return true;
// 			}
// 			else {
// 				return false;
// 			}
// 		}
// 		
// 		if (ds_file.getRowCount() > 0)
// 		{
// 			if (gfn_confirm("변경된 자료가 있습니다.\n계속하시겠습니까?")) {
// 				namoWeb.TextValue = "";
// 				ed_title.value = "";
// 				ds_file.clearData();
// 				return true;
// 			}
// 			else {
// 				return false;
// 			}
// 		}
// 	}
// 	else
// 	{
// 		if (gfn_dsIsUpdated(ds_master) == true) 
// 		{
// 			if (gfn_confirm("변경된 자료가 있습니다.\n계속하시겠습니까?"))
// 			{
// 				return true;
// 			}
// 			else
// 			{
// 				return false;
// 			}
// 		}
// 		
// 		if (gfn_dsIsUpdated(ds_file) == true) 
// 		{
// 			if (gfn_confirm("변경된 자료가 있습니다.\n계속하시겠습니까?"))
// 			{
// 				return true;
// 			}
// 			else
// 			{
// 				return false;
// 			}
// 		}
// 	}
//     
//     return true;
}

/*
 ******************************************************************************************
 * 함  수  명   : fn_getNextMonth
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   : 보존 기간 변경 시 - 1한달 일자 구함. 
 * 작  성  자   : 조은영
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function fn_getNextMonth( strDate ) {
    var y = toNumber(gfn_left( strDate, 4 ));
    var m = toNumber( gfn_subStr( strDate, 4, 2 ));
    var d = gfn_right( strDate, 2 );
    m += 1;
    if ( m > 12 ) {
        m = 1;
        y = y+1;
    }
    
    var strM = iif(m < 10, "0", "");
    var newStr = y + strM + m + d;
    return newStr;
}
function fn_masking(strDate) {
    var y = gfn_left( strDate, 4 );
    var m = gfn_subStr( strDate, 4, 2 );
    var d = gfn_right( strDate, 2 );
    return y + "-" + m + "-" + d;
}
/*
 ******************************************************************************************
 * 함  수  명   : btn_selectB_OnClick
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   :  복사할 게시판 선택 
 * 작  성  자   : 조은영
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function btn_selectB_OnClick(obj:Button, e:ClickEventInfo)
{
    var arg = {fa_bbsId:ds_master.getColumn(0, "BBS_ID"), fa_conId:ds_master.getColumn(0, "CON_ID"), MF_CURR_AUTH:MF_CURR_AUTH, F_ADMIN_LEVEL:F_ADMIN_LEVEL};
	gfn_openPopup("U_SCC::SCC80051P.xfdl", true, -1, -1, arg);
}
/*
 ******************************************************************************************
 * 함  수  명   : btn_selectP_OnClick
 * 입      력   : 
 * 반      환   : 없음
 * 기      능   :  복사 대상 선택 
 * 작  성  자   : 조은영
 * 작성  일자   :
 * ----------------------------------------------------------------------------------------
 * HISTORY    :
 ******************************************************************************************
 */
function btn_selectP_OnClick(obj:Button, e:ClickEventInfo)
{
	var arg = {MF_SYS_TYPE:MF_SYS_TYPE, F_FICS:F_FICS, F_FOMS:F_FOMS, ds_target:ds_target, M_GUBUN:"WRITE"};	
	gfn_openPopup("U_SCC::SCC80052P.xfdl", true, -1, -1, arg);
}


function med_pToDt_ontextchanged(obj:MaskEdit,  e:TextChangedEventInfo)
{
/*	
	if (gfn_isNull(med_pFromDt.value))
	{
		gfn_alert("팝업 시작일이 지정되지 않았습니다.");
		med_pToDt.value = "";
		return;
	}

	if (gfn_lengthByte(gfn_trim(med_pToDt.value)) == 8)
	{
		
		var dayCnt = gfn_getDiffDay(med_pFromDt.value, med_pToDt.value) + 1;
		
		if (dayCnt < 0)
		{
			gfn_alert("시작일보다 작은일자는 지정할 수 없습니다.");
			med_pToDt.value = "";
			return;
		}
		
		if (g_Board_Mst == "공지자" && (dayCnt > 4))
		{
			gfn_alert("공지자 권한은 4일 이상은 지정할 수 없습니다.");
			med_pToDt.value = "";
			return;
		}
	}	
*/
}


function med_pToDt_OnChanged()
{

	if (gfn_isNull(med_pFromDt.value))
	{
		gfn_alert("팝업 시작일이 지정되지 않았습니다.");
		med_pToDt.value = "";
		return;
	}

	if (gfn_lengthByte(gfn_trim(med_pToDt.value)) == 8)
	{
		var dayCnt = gfn_getDiffDay(med_pFromDt.value, med_pToDt.value) + 1;
		
		if (dayCnt < 0)
		{
			gfn_alert("시작일보다 작은일자는 지정할 수 없습니다.");
			med_pToDt.value = "";
			return;
		}
		
		if (g_Board_Mst == "공지자" && (dayCnt > 4))
		{
			gfn_alert("공지자 권한은 4일 이상은 지정할 수 없습니다.");
			med_pToDt.value = "";
			return;
		}
	}
	
}

function med_noticDt_ontextchanged(obj:MaskEdit,  e:TextChangedEventInfo)
{
/*	
	if (gfn_lengthByte(gfn_trim(med_noticDt.value)) == 8)
	{
		var day = gfn_getLastDateNum(gfn_today());
		var dayCnt = gfn_getDiffDay(gfn_today(), med_noticDt.value) + 1;
		
		if (dayCnt < 0)
		{
			gfn_alert("현재일자보다 작은일자는 지정할 수 없습니다.");
			med_noticDt.value = "";
			return;
		}
		
		if (dayCnt > day)
		{
			if (g_Board_Mst == "공지자")
			{
				gfn_alert("공지자 권한은 한달 이상은 지정할 수 없습니다.");
				med_noticDt.value = "";
				return;
			}
		}
	}
*/	
}

function med_noticDt_OnChanged()
{

	if (gfn_lengthByte(gfn_trim(med_noticDt.value)) == 8)
	{
		var day = gfn_getLastDateNum(gfn_today());
		var dayCnt = gfn_getDiffDay(gfn_today(), med_noticDt.value) + 1;
		
		if (dayCnt < 0)
		{
			gfn_alert("현재일자보다 작은일자는 지정할 수 없습니다.");
			med_noticDt.value = "";
			return;
		}
		
		if (dayCnt > day)
		{
			if (g_Board_Mst == "공지자")
			{
				gfn_alert("공지자 권한은 한달 이상은 지정할 수 없습니다.");
				med_noticDt.value = "";
				return;
			}
		}
	}
}

function med_noticDt_canchange(obj:MaskEdit,  e:ChangeEventInfo)
{
// 날짜 팝업이 아닌 텍스트 입력 방식일 경우 초기화가 제대로 안되는 문제 발생하여 저장 시점으로 변경함(2016.05.11)
/*
	if (gfn_lengthByte(gfn_trim(med_noticDt.value)) == 8)
	{
		var day = gfn_getLastDateNum(gfn_today());
		var dayCnt = gfn_getDiffDay(gfn_today(), med_noticDt.value) + 1;
		
		if (dayCnt < 0)
		{
			gfn_alert("현재일자보다 작은일자는 지정할 수 없습니다.");
			med_noticDt.value = "";
			return;
		}
		
		if (dayCnt > day)
		{
			if (g_Board_Mst == "공지자")
			{
				gfn_alert("공지자 권한은 한달 이상은 지정할 수 없습니다.");
				med_noticDt.value = "";
				return;
			}
		}
	}	
*/	
}

function med_pToDt_canchange(obj:MaskEdit,  e:ChangeEventInfo)
{
// 날짜 팝업이 아닌 텍스트 입력 방식일 경우 초기화가 제대로 안되는 문제 발생하여 저장 시점으로 변경함(2016.05.11) 
/*
	if (gfn_isNull(med_pFromDt.value))
	{
		gfn_alert("팝업 시작일이 지정되지 않았습니다.");
		med_pToDt.value = "";
		return;
	}

	if (gfn_lengthByte(gfn_trim(med_pToDt.value)) == 8)
	{
		var dayCnt = gfn_getDiffDay(med_pFromDt.value, med_pToDt.value) + 1;
		
		if (dayCnt < 0)
		{
			gfn_alert("시작일보다 작은일자는 지정할 수 없습니다.");
			med_pToDt.value = "";
			return;
		}
		
		if (g_Board_Mst == "공지자" && (dayCnt > 4))
		{
			gfn_alert("공지자 권한은 4일 이상은 지정할 수 없습니다.");
			ds_master.setColumn(0, "POPUP_EDATE", gfn_addDate(med_pFromDt.value, 3));
			med_pToDt.value = gfn_addDate(med_pFromDt.value, 3);
			
			return;
		}
	}
*/	
}

// 2016.06.10 보안점검 조치사항
function namoWeb_OnLoadCompleted(obj:ActiveX)
{
	//return;
	namoWeb.InitFileURL = application.services["svc"].url+"common/As7Init.xml";
	namoWeb.InitFileVer = "-9999"; // 버전 관리 안하고 즉시 반영함
	namoWeb.LoadInitFile();
	namoWeb.ShowToolbar(0, false);  // 메뉴 감추기 
	namoWeb.ShowTab(false);  // tab 감추기
}

function ds_master_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo) {
	switch ( e.columnid ) {
		case "NOTICE_YN" :
			cbo_order.enable = (e.newvalue == "Y");
			break;
	}
}

//20220831 김명섭 모바일공지 사용자구분 속성관리 추가
function chk_notic00_onclick(obj:CheckBox,  e:ClickEventInfo)
{
	chk_notic00_Onclick(obj, obj.value);
}

function chk_notic00_Onclick(obj, sValue)
{
	var isVisible = (sValue == "Y");
	cbo_user.enable = isVisible;
	
	if (isVisible) {
		cbo_user.value = "0";
	} else {
		cbo_user.value = "";
	}
}
]]></Script>
  </Form>
</FDL>

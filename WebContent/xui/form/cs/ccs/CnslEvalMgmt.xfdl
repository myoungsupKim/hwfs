<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="form" classname="sam_MasterDetail" position="absolute 0 0 1252 725" titletext="상담평가관리" onload="form_onload" onkeydown="form_onkeydown">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" visible="false" position="absolute 1237 0 1252 710" class="Guide01_AreaRed" anchor="top right"/>
        <Static id="Static71" visible="false" position="absolute 0 710 1252 725" class="Guide01_AreaRed" text="h15" anchor="left bottom"/>
        <Div id="div_cmnBtn" taborder="9" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" anchor="left top right" position="absolute 0 0 1237 30" positiontype="position"/>
        <Static id="Static22" text="상담이력" position="absolute 0 116 450 134" class="sta_WF_Title01"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 103 450 116"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 129 450 134"/>
        <Static id="Static29" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 103" anchor="left top right"/>
        <Static id="Static34" text="W10" visible="false" position="absolute 74 40 84 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static35" text="W30" visible="false" position="absolute 306 40 336 62" style="background:#ff000055;align:center middle;"/>
        <Static id="Static43" text="W10" visible="false" position="absolute 14 30 277 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static44" text="W10" visible="false" position="absolute 14 92 277 102" style="background:#ff000055;align:center middle;"/>
        <Static id="Static45" text="W15" visible="false" position="absolute 0 30 15 62" style="background:#ff000055;align:center middle;"/>
        <Static id="Static28" text="조회기간" class="sta_WFSA_label" position="absolute 15 40 77 61" anchor="left top"/>
        <Static id="Static00" text="~" position="absolute 190 38 202 63"/>
        <Static id="Static01" text="사업장" class="sta_WFSA_label" position="absolute 335 40 397 61" anchor="left top"/>
        <Static id="Static02" text="W10" visible="false" position="absolute 382 41 392 62" style="background:#ff000055;align:center middle;"/>
        <Static id="Static03" text="W30" visible="false" position="absolute 592 40 622 62" style="background:#ff000055;align:center middle;"/>
        <Static id="Static04" text="W10" visible="false" position="absolute 685 40 695 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static05" text="처리상태" class="sta_WFSA_label" position="absolute 625 40 687 61" anchor="left top"/>
        <Combo id="cbo_cnslProcTypeCd" taborder="3" position="absolute 695 40 810 61" anchor="left top"/>
        <Static id="Static07" text="W30" visible="false" position="absolute 810 40 840 62" style="background:#ff000055;align:center middle;"/>
        <Static id="Static08" text="W10" visible="false" position="absolute 889 40 899 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static09" text="접수자" class="sta_WFSA_label" position="absolute 843 40 905 61" anchor="left top"/>
        <Static id="Static11" text="W10" visible="false" position="absolute 1074 40 1084 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static12" text="처리자" class="sta_WFSA_label" position="absolute 1028 41 1090 62" anchor="left top"/>
        <Static id="Static13" text="상담내용" class="sta_WF_Title01" position="absolute 0 553 450 571" anchor="left bottom"/>
        <Static id="Static14" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 566 450 571" anchor="left bottom"/>
        <Static id="Static17" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 540 450 553" anchor="left bottom"/>
        <Grid id="grd_list" taborder="14" binddataset="ds_ccsCnslAllLog" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 0 134 1237 540" anchor="all" oncellclick="grd_list_oncellclick" onkeyup="grd_list_onkeyup" onlbuttonup="grd_list_onlbuttonup">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="45"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="180"/>
                <Column size="80"/>
                <Column size="220"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="35"/>
                <Column size="0"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="0"/>
                <Column size="130"/>
                <Column size="80"/>
                <Column size="220"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
                <Column size="0"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="상담일자" taborder="undefined"/>
                <Cell col="2" text="상담시각"/>
                <Cell col="3" text="구분"/>
                <Cell col="4" text="사업장명"/>
                <Cell col="5" text="상담유형"/>
                <Cell col="6" text="상담내용"/>
                <Cell col="7" text="접수자"/>
                <Cell col="8" text="전화번호"/>
                <Cell col="9" text="연락번호"/>
                <Cell col="10" text="처리상태"/>
                <Cell col="11" text="처리자"/>
                <Cell col="12" text="고객반응"/>
                <Cell col="13" text="통화시간"/>
                <Cell col="14" text="통화유형"/>
                <Cell col="15" colspan="2" text="청취" taborder="undefined"/>
                <Cell col="17" text="처리일자"/>
                <Cell col="18" text="처리시각"/>
                <Cell col="19" text="녹취ID"/>
                <Cell col="20" text="평가일시"/>
                <Cell col="21" text="평가점수"/>
                <Cell col="22" text="평가내용"/>
                <Cell col="23"/>
                <Cell col="24"/>
                <Cell col="25"/>
                <Cell col="26"/>
                <Cell col="26"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:center middle;" text="bind:cnslStartDateT1"/>
                <Cell col="2" displaytype="text" style="align:center middle;" text="bind:cnslStartDateT2"/>
                <Cell col="3" text="bind:callTypeCd"/>
                <Cell col="4" displaytype="text" style="padding:0 6 0 6;" text="bind:upjangnmDisp"/>
                <Cell col="5" displaytype="text" style="padding:0 6 0 6;" text="bind:cnslTypeCd"/>
                <Cell col="6" displaytype="text" style="align: ;padding:0 6 0 6;" expr="expr:cnslContents.toString().replace(&quot;\r\n&quot;, &quot;&quot;)"/>
                <Cell col="7" displaytype="text" style="padding:0 6 0 6;" text="bind:acceptUser"/>
                <Cell col="8" displaytype="text" style="padding:0 6 0 6;" text="bind:telno"/>
                <Cell col="9" displaytype="text" style="padding:0 6 0 6;" text="bind:cntcTelno"/>
                <Cell col="10" displaytype="text" style="padding:0 6 0 6;" text="bind:cnslProcTypeCd"/>
                <Cell col="11" displaytype="text" style="padding:0 6 0 6;" text="bind:procUser"/>
                <Cell col="12" displaytype="text" style="align:center middle;padding: ;" text="bind:custResponseCd"/>
                <Cell col="13" displaytype="text" style="align:center middle;padding: ;" text="bind:callTimeHhmiss"/>
                <Cell col="14" displaytype="text" style="padding:0 6 0 6;" text="bind:callResultCd"/>
                <Cell col="15" displaytype="button" text="bind:recordStatus"/>
                <Cell col="16" displaytype="button" edittype="button" text="■"/>
                <Cell col="17" displaytype="text" style="align:center middle;" text="bind:procDateT1"/>
                <Cell col="18" displaytype="text" style="align:center middle;" text="bind:procDateT2"/>
                <Cell col="19" displaytype="text" style="padding:0 6 0 6;" text="bind:callId"/>
                <Cell col="20" displaytype="text" style="align:center middle;" expr="expr:CDATE == UDATE ? '' : evalUdate"/>
                <Cell col="21" displaytype="number" edittype="normal" editfilter="integer" style="align: ;" text="bind:evalScore" editlimit="2" editautoselect="true" combodisplay="edit"/>
                <Cell col="22" displaytype="text" edittype="text" style="padding:0 6 0 6;" text="bind:evalContents"/>
                <Cell col="23" displaytype="text" text="bind:cnslStartDate"/>
                <Cell col="24" displaytype="text" text="bind:cnslContents"/>
                <Cell col="25" displaytype="text" text="bind:procUserSabun"/>
                <Cell col="26" displaytype="text" text="bind:acceptUserSabun"/>
                <Cell col="26" displaytype="text" text="bind:evalScoreTmp"/>
              </Band>
            </Format>
            <Format id="default_excel">
              <Columns>
                <Column size="45"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="180"/>
                <Column size="80"/>
                <Column size="220"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="35"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="130"/>
                <Column size="80"/>
                <Column size="220"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="상담일자" taborder="undefined"/>
                <Cell col="2" text="상담시각"/>
                <Cell col="3" text="구분"/>
                <Cell col="4" text="사업장명"/>
                <Cell col="5" text="상담유형"/>
                <Cell col="6" text="상담내용"/>
                <Cell col="7" text="접수자"/>
                <Cell col="8" text="처리상태"/>
                <Cell col="9" text="처리자"/>
                <Cell col="10" text="고객반응"/>
                <Cell col="11" text="통화시간"/>
                <Cell col="12" text="통화유형"/>
                <Cell col="13" text="처리일자"/>
                <Cell col="14" text="처리시각"/>
                <Cell col="15" text="녹취ID"/>
                <Cell col="16" text="평가일시"/>
                <Cell col="17" text="평가점수"/>
                <Cell col="18" text="평가내용"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="align:center middle;" text="bind:cnslStartDateT1"/>
                <Cell col="2" displaytype="text" style="align:center middle;" text="bind:cnslStartDateT2"/>
                <Cell col="3" text="bind:callTypeCd"/>
                <Cell col="4" displaytype="text" style="padding:0 6 0 6;" text="bind:upjangnmDisp"/>
                <Cell col="5" displaytype="text" style="padding:0 6 0 6;" text="bind:cnslTypeCd"/>
                <Cell col="6" displaytype="text" style="align: ;padding:0 6 0 6;" expr="expr:cnslContents.toString().replace(&quot;\r\n&quot;, &quot;&quot;)"/>
                <Cell col="7" displaytype="text" style="padding:0 6 0 6;" text="bind:acceptUser"/>
                <Cell col="8" displaytype="text" style="padding:0 6 0 6;" text="bind:cnslProcTypeCd"/>
                <Cell col="9" displaytype="text" style="padding:0 6 0 6;" text="bind:procUser"/>
                <Cell col="10" displaytype="text" style="align:center middle;padding: ;" text="bind:custResponseCd"/>
                <Cell col="11" displaytype="text" style="align:center middle;padding: ;" text="bind:callTimeHhmiss"/>
                <Cell col="12" displaytype="text" style="padding:0 6 0 6;" text="bind:callResultCd"/>
                <Cell col="13" displaytype="text" style="align:center middle;" text="bind:procDateT1"/>
                <Cell col="14" displaytype="text" style="align:center middle;" text="bind:procDateT2"/>
                <Cell col="15" displaytype="text" style="padding:0 6 0 6;" text="bind:callId"/>
                <Cell col="16" displaytype="text" style="align:center middle;" expr="expr:CDATE == UDATE ? '' : evalUdate"/>
                <Cell col="17" displaytype="number" edittype="normal" editfilter="integer" style="align: ;" text="bind:evalScore" editlimit="2" editautoselect="true" combodisplay="edit"/>
                <Cell col="18" displaytype="text" edittype="text" style="padding:0 6 0 6;" text="bind:evalContents"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_recId" taborder="15" text="청취" class="btn_WF_CRUD" position="absolute 1129 107 1170 130" onclick="btn_recId_onclick" anchor="top right"/>
        <Static id="Static37" text="주요내용" class="sta_WFDA_Label01" position="absolute 0 731 80 758" style="align:left middle;" anchor="left bottom" visible="false"/>
        <Static id="Static39" class="sta_WFDA_Labelbg" position="absolute 79 571 450 710" anchor="left bottom"/>
        <Static id="Static18" text="상담내용" class="sta_WFDA_Label01" position="absolute 0 571 80 710" style="align:left middle;" anchor="left bottom"/>
        <Static id="Static21" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 450 540 460 710" anchor="left bottom"/>
        <Static id="Static20" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 460 566 910 571" anchor="left bottom"/>
        <Static id="Static23" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 460 540 910 553" anchor="left bottom"/>
        <Static id="Static24" text="평가점수" class="sta_WFDA_Label01" position="absolute 460 571 540 598" style="align:left middle;" anchor="left bottom"/>
        <Static id="Static25" text="평가내용" class="sta_WFDA_Label01" position="absolute 460 597 540 710" style="align:left middle;" anchor="left bottom"/>
        <Static id="sta_detail02" class="sta_WFDA_Labelbg" position="absolute 539 597 910 710" anchor="left bottom"/>
        <Static id="sta_detail03" class="sta_WFDA_Labelbg" position="absolute 539 571 910 598" anchor="left bottom"/>
        <Edit id="edt_evalScore" taborder="17" position="absolute 542 574 907 595" anchor="left bottom" inputtype="number"/>
        <Edit id="edt_acceptUser" taborder="4" position="absolute 899 40 975 61" anchor="left top"/>
        <Button id="btn_acceptUser" taborder="7" class="btn_WF_popSearch" position="absolute 974 40 995 61" anchor="left top" onclick="btn_acceptUser_onclick"/>
        <Edit id="edt_procUser" taborder="5" position="absolute 1083 40 1159 61" anchor="left top" onkeydown="edt_procUser_onkeydown"/>
        <Button id="btn_procUser" taborder="8" class="btn_WF_popSearch" position="absolute 1158 40 1179 61" anchor="left top" onclick="btn_procUser_onclick"/>
        <Static id="Static10" text="W30" visible="false" position="absolute 995 40 1025 62" style="background:#ff000055;align:center middle;"/>
        <TextArea id="txt_cnslContents" taborder="22" position="absolute 82 574 447 707" readonly="true" anchor="left bottom"/>
        <TextArea id="txt_evalContents" taborder="23" position="absolute 542 600 907 707" oneditclick="txt_evalContents_oneditclick" anchor="left bottom"/>
        <Button id="btn_upjangPop" taborder="6" onclick="btn_upjangPop_onclick" class="btn_WF_popSearch" position="absolute 571 40 592 61" anchor="left top"/>
        <Edit id="edt_upjangnmDisp" taborder="2" position="absolute 392 40 572 61" anchor="left top"/>
        <ActiveX id="atx_winMediaPlayer" position="absolute 920 571 1238 711" progid="WMPlayer.OCX" windowed="true" useautobitmapcache="1" taborder="29" anchor="left right bottom"/>
        <Button id="btn_recIdCancel" taborder="30" text="청취종료" onclick="btn_recIdCancel_onclick" class="btn_WF_CRUD" position="absolute 1172 107 1237 130" anchor="top right"/>
        <Static id="Static26" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 910 540 920 710" anchor="left bottom"/>
        <Static id="Static27" text="청취" class="sta_WF_Title01" position="absolute 920 553 1238 571" anchor="left right bottom" style="align:left top;"/>
        <Static id="Static30" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 920 566 1237 571" anchor="left bottom"/>
        <Static id="Static31" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 920 540 1237 553" anchor="left bottom"/>
        <Edit id="edt_mainContents" taborder="31" readonly="true" position="absolute 82 734 447 755" anchor="left bottom" style="background:#ecececff;" visible="false"/>
        <Static id="Static19" text="평가내용" class="sta_WF_Title01" position="absolute 460 553 910 571" anchor="left bottom"/>
        <ObjCalendar id="cal_fromDay" titletext="캘린더" taborder="0" text="ObjCalendar00" scrollbars="none" position="absolute 84 40 187 61"/>
        <ObjCalendar id="cal_toDay" titletext="캘린더" taborder="1" text="ObjCalendar00" scrollbars="none" position="absolute 203 40 306 61"/>
        <Combo id="cbo_csMasterUser" taborder="32" position="absolute 1074 75 1189 96" anchor="left top" visible="true"/>
        <Static id="Static32" text="구분" class="sta_WFSA_label" position="absolute 16 71 78 92" anchor="left top"/>
        <Combo id="cbo_callTypeCd" taborder="33" position="absolute 84 71 187 92" anchor="left top" codecolumn="codecolumn" datacolumn="datacolumn" index="0" text="전체">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn"/>
                <Col id="datacolumn">전체</Col>
              </Row>
              <Row>
                <Col id="codecolumn">10</Col>
                <Col id="datacolumn">인바운드</Col>
              </Row>
              <Row>
                <Col id="codecolumn">20</Col>
                <Col id="datacolumn">아웃바운드</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cal_fromDay" type="STRING" size="256"/>
          <Column id="cal_toDay" type="STRING" size="256"/>
          <Column id="upjangnmDisp" type="STRING" size="256"/>
          <Column id="cnslProcTypeCd" type="STRING" size="256"/>
          <Column id="acceptUser" type="STRING" size="256"/>
          <Column id="procUser" type="STRING" size="256"/>
          <Column id="upjangCd" type="STRING" size="256"/>
          <Column id="userSabun" type="STRING" size="256"/>
          <Column id="callTypeCd" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="callTypeCd"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_ccsCnslAllLog" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="cnslStartDateT1" type="DATE" size="255"/>
          <Column id="cnslStartDateT2" type="DATE" size="255"/>
          <Column id="cnslStartDate" type="STRING" size="255"/>
          <Column id="acceptUser" type="STRING" size="255"/>
          <Column id="callEndDate" type="STRING" size="255"/>
          <Column id="callTime" type="STRING" size="255"/>
          <Column id="cnslEndDate" type="STRING" size="255"/>
          <Column id="cnslTime" type="STRING" size="255"/>
          <Column id="cnslTypeCd" type="STRING" size="255"/>
          <Column id="custResponseCd" type="STRING" size="255"/>
          <Column id="callResultCd" type="STRING" size="255"/>
          <Column id="cntcTelno" type="STRING" size="255"/>
          <Column id="cnslProcTypeCd" type="STRING" size="255"/>
          <Column id="procUser" type="STRING" size="255"/>
          <Column id="procDate" type="STRING" size="255"/>
          <Column id="procDateT1" type="DATE" size="255"/>
          <Column id="procDateT2" type="DATE" size="255"/>
          <Column id="upjangRegYn" type="STRING" size="255"/>
          <Column id="upjangCd" type="STRING" size="255"/>
          <Column id="mainContents" type="STRING" size="255"/>
          <Column id="cnslContents" type="STRING" size="255"/>
          <Column id="callId" type="STRING" size="255"/>
          <Column id="callTypeCd" type="STRING" size="255"/>
          <Column id="telno" type="STRING" size="255"/>
          <Column id="dnid" type="STRING" size="255"/>
          <Column id="callTransYn" type="STRING" size="255"/>
          <Column id="callTransId" type="STRING" size="255"/>
          <Column id="callTransTelno" type="STRING" size="255"/>
          <Column id="callTransUpjangcd" type="STRING" size="255"/>
          <Column id="cuser" type="STRING" size="255"/>
          <Column id="cdate" type="STRING" size="255"/>
          <Column id="uuser" type="STRING" size="255"/>
          <Column id="udate" type="STRING" size="255"/>
          <Column id="evalUser" type="STRING" size="255"/>
          <Column id="evalScore" type="STRING" size="255"/>
          <Column id="evalContents" type="STRING" size="255"/>
          <Column id="no" type="STRING" size="256"/>
          <Column id="evalCnslStartDate" type="STRING" size="256"/>
          <Column id="evalCuser" type="STRING" size="256"/>
          <Column id="evalCdate" type="STRING" size="256"/>
          <Column id="evalUuser" type="STRING" size="256"/>
          <Column id="evalUdate" type="STRING" size="256"/>
          <Column id="upjangnmDisp" type="STRING" size="256"/>
          <Column id="callTimeHhmiss" type="STRING" size="256"/>
          <Column id="evalScoreTmp" type="STRING" size="256"/>
          <Column id="recordStatus" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_acceptor" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="acceptorCd" type="STRING" size="256"/>
          <Column id="acceptorNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">Y</Col>
            <Col id="insYn">N</Col>
            <Col id="delYn">Y</Col>
            <Col id="savYn">Y</Col>
            <Col id="prtYn">N</Col>
            <Col id="exlYn">N</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item0" compid="txt_cnslContents" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item2" compid="sta_detail02" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item3" compid="sta_detail03" propid="text" datasetid="ds_view" columnid="D_1"/>
      <BindItem id="item4" compid="cbo_cnslProcTypeCd" propid="value" datasetid="ds_search" columnid="cnslProcTypeCd"/>
      <BindItem id="item5" compid="edt_mainContents" propid="value" datasetid="ds_ccsCnslAllLog" columnid="mainContents"/>
      <BindItem id="item6" compid="txt_cnslContents" propid="value" datasetid="ds_ccsCnslAllLog" columnid="cnslContents"/>
      <BindItem id="item7" compid="edt_evalScore" propid="value" datasetid="ds_ccsCnslAllLog" columnid="evalScore"/>
      <BindItem id="item10" compid="txt_evalContents" propid="value" datasetid="ds_ccsCnslAllLog" columnid="evalContents"/>
      <BindItem id="item1" compid="cbo_callTypeCd" propid="value" datasetid="ds_search" columnid="callTypeCd"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : 상담평가관리
  파 일 명 : CnslEvalMgmt.xfdl
  기    능 : Design 및 Script Template 

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.03.17   이규훈   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "lib::SCCti.xjs";
/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var outJsonResult = "";//CTI IF 처리 결과

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{	
	grd_list.onheadclick.removeHandler(0);
	grd_list.onheadclick.setHandler(0, fn_gridSort);
	
	//조회 조건 날짜 초기값
	cal_fromDay.fn_initMonthCal(this, gfn_today(), "fn_calendarCallBack", ds_search, "cal_fromDay", "Y");
    cal_toDay.fn_initMonthCal(this, gfn_today(), "fn_calendarCallBack", ds_search, "cal_toDay", "Y");
    
	//평가점수, 평가내용 Disable
	edt_mainContents.readonly = true;
	txt_cnslContents.readonly = true;
	//edt_evalScore.readonly = true;
	//txt_evalContents.readonly = true;
		
	//처리결과 Combo
	SCCombo.bind(this, "ComCode", "cbo_cnslProcTypeCd", null, {groupCode:"CNSL_PROC_TYPE_CD", useYn:"Y"},SCCombo.ALL); 
	SCCombo.bind(this, "ComCode", "cbo_csMasterUser", null, {groupCode:"CS_MASTER_USER", useYn:"Y"}, "fn_setAuth"); 
	
	cal_fromDay.setFocus();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 달력 선택 후 callback function
 *---------------------------------------------------------------------------------------------*/
function fn_calendarCallBack(sYearMonth)
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{
	return true;
}

/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
	if (gfn_getDiffDay(cal_fromDay.fn_getValue(), cal_toDay.fn_getValue()) > 31)
	{
		gfn_alert("최대 1개월 단위의 조회만 가능합니다.");
		return;
	}
	if (gfn_isNull(cal_fromDay.fn_getValue()) || gfn_isNull(cal_toDay.fn_getValue()))
	{
		gfn_alert("조회일자를 입력하여 주십시오!");
		return;
	}
	if (cal_fromDay.fn_getValue() > cal_toDay.fn_getValue())
	{
		gfn_alert("시작일이 종료일보다 큽니다.");
		return;
	}
	
	//edt_evalScore.readonly = true;
	//txt_evalContents.readonly = true;

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_list);
		
	ds_search.setColumn(0, "upjangnmDisp", edt_upjangnmDisp.value);
	ds_search.setColumn(0, "cnslProcTypeCd", cbo_cnslProcTypeCd.value);
	ds_search.setColumn(0, "userSabun", g_EmpNo);
	
	if (edt_upjangnmDisp.value == "")
	{
		ds_search.setColumn(0, "upjangCd", "");
	}
	else if (edt_acceptUser.value == "")
	{
		ds_search.setColumn(0, "acceptUser", "");
	}
	else if (edt_procUser.value == "")
	{
		ds_search.setColumn(0, "procUser", "");
	}
	
    var strSvcID    = "selectCnslAllLogList";
    var strURL      = "cs/ccs/cnslMgnt/selectCnslAllLogList.xdo";
    var strInDs     = "ds_search=ds_search";
    var strOutDs    = "ds_ccsCnslAllLog=ds_ccsCnslAllLog";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 입력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert(){}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{
	var nRow = ds_ccsCnslAllLog.rowposition;
	
	if (ds_ccsCnslAllLog.rowposition == -1) 
	{
		gfn_alert("msg.err.grid.noselect", "삭제할 row");	// 선택된 항목이 없습니다.
		return;
	}

	var rtVal = gfn_confirm("confirm.before.delete");	// 선택된 자료를 삭제 하시겠습니까?
	if (rtVal == true) 
	{	
		ds_ccsCnslAllLog.setColumn(nRow, "evalContents", "");
		ds_ccsCnslAllLog.setColumn(nRow, "evalScore", 0);
	}
	else 
	{
		return;
	}
	
	var strSvcID    = "delete";
    var strURL      = "cs/ccs/cnslMgnt/saveCnslEval.xdo";
    var strInDs     = "ds_ccsCnslAllLog=ds_ccsCnslAllLog:U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
	// 변경사항 체크
	if (gfn_dsIsUpdated(ds_ccsCnslAllLog) == false) 
	{
		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
		return;
	}
	
	//if (!gfn_isDigit(ds_ccsCnslAllLog.getColumn(grd_list.currentrow, "evalScore")))
	if (isNumeric(ds_ccsCnslAllLog.getColumn(grd_list.currentrow, "evalScore")))
	{
		gfn_alert("숫자만 입력 가능 합니다.");
		return;
	}
	
	if (ds_ccsCnslAllLog.getColumn(grd_list.currentrow, "evalScore") < 0 || 
		ds_ccsCnslAllLog.getColumn(grd_list.currentrow, "evalScore") > 100)
	{
		gfn_alert("평가점수는 0보다 크거나, 100보다 작아야 합니다.");
		return;
	}
	
	var strSvcID    = "save";
    var strURL      = "cs/ccs/cnslMgnt/saveCnslEval.xdo";
    var strInDs     = "ds_ccsCnslAllLog=ds_ccsCnslAllLog:U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print(){}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help(){}

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 사업장 조회 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_upjangPop_onclick(obj:Button,  e:ClickEventInfo)
{
	var arrParam = new Array();

	arrParam[0] = "histMgmt";	// 전송할 파라미터 1
		
	var rtnVal = gfn_dialog("CnslMgmtPopCustInQuery"			// dialogId
				   , "X_CCS::CnslMgmtPopCustInQuery.xfdl"		// Url
				   , {fv_Contents:arrParam}					// 배열
				   , null, null, null, null, null, false, true, -1);	
	
    if (rtnVal != null)
	{
		//사업자명(보여주기위함)
		edt_upjangnmDisp.value = rtnVal[1];
		
		//업장코드 setting
		if (rtnVal[1] != "")
		{
			ds_search.setColumn(0 ,"upjangCd" ,rtnVal[0]);
		}
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 상담이력 목록의 CELL 클릭
 *---------------------------------------------------------------------------------------------*/
function grd_list_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	/*
	edt_mainContents.value = obj.getCellText(obj.currentrow, 5);
	txt_cnslContents.value = obj.getCellText(obj.currentrow, 21);

	edt_evalScore.value = obj.getCellText(obj.currentrow, 18);
	txt_evalContents.value = obj.getCellText(obj.currentrow, 19);
	*/
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 청취버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_recId_onclick(obj:Button,  e:ClickEventInfo)
{
	var grd_obj = grd_list;	
	var callid = grd_obj.getCellText(grd_obj.currentrow, 17);//callid 	
	var cnslStartDate = grd_obj.getCellText(grd_obj.currentrow, 21);//날짜	
	var callTime = grd_obj.getCellText(grd_obj.currentrow, 13);//통화시간
	
	//통화시간이 0 이상이어야 청취 가능
	/*
	if (callTime == "00:00:00" || 
		callid == null || callid == "" || 
		typeof callid == "undefined" ||
		gfn_subStr(callTime, 6, 2) < 0 || 
	    gfn_subStr(callTime, 6, 3) < 0 || 
	    gfn_subStr(callTime, 3, 2) < 0 || 
	    gfn_subStr(callTime, 3, 3) < 0) {
		gfn_alert("통화시간이 0 이상이어야 녹취가 가능합니다.");
		return false;
	}
	*/
	
	var i, idx = 0;
	for(i = 0; i < cbo_csMasterUser.getCount() ; i++)
	{
		cbo_csMasterUser.index = i;
		
		if(g_EmpNo == cbo_csMasterUser.value)
		{
			idx = i;
		}
	}
	
	cbo_csMasterUser.index = idx;
	//cbo_csMasterUser.index = 0;
	
	
	if (ds_ccsCnslAllLog.getColumn(grd_list.currentrow, "procUserSabun") == g_EmpNo || 
	    ds_ccsCnslAllLog.getColumn(grd_list.currentrow, "acceptUserSabun") == g_EmpNo ||
	    g_EmpNo == cbo_csMasterUser.value)
	{
	/**
		//웹서비스 호출
		var url = "/chnl_calls/getrecid?callid="+callid+"&formatname=json";
		var callParams = url;		
		var strSvcID    = "ctiCall2";
		var strURL      = "sc/cmn/ctiCall.xdo";
		var strInDs     = "";
		var strOutDs    = "";
		var strArg      = "ctiParams=" + wrapQuote(callParams);
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	**/
		var sRecordPath = ds_ccsCnslAllLog.getColumn(ds_ccsCnslAllLog.rowposition, "recordPath");
		if ( gfn_isNull(sRecordPath) ) {
			gfn_alert("녹취파일정보가 없습니다.");
			return;
		} else {
			atx_winMediaPlayer.URL = SCCti.CTI_RECORD_FILE_URL+sRecordPath;
		}
    }
    else 
	{
		gfn_alert("본인이외의 상담을 청취하실 수 없습니다.(마스터제외)");
		return;
	}
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {
        case "selectCnslAllLogList" :    		// 코드분류 조회
            break;
            		
        case "save" :			// 저장
			gfn_alert("msg.save.success");	// 저장 되었습니다.
			fn_search();
            break;
            
        case "delete" :			// 삭제
			gfn_alert("msg.delete.success");	// 삭제 되었습니다.
			fn_search();
            break;    
        
        case "ctiCall2" :			// 청취
			if (outJsonResult == "") { gfn_alert("CTI 오류"); break; }
            
            var tmpCnslStartDate = grd_list.getCellText(grd_list.currentrow, 1);//상담시작일자
            var jsonResult = gfn_jsonStringToObject (outJsonResult);
            var fileUrl = "\\\\172.25.6.252\\Rec\\"+tmpCnslStartDate.replace("-", "")+"\\"+jsonResult.recid + ".wav";
            atx_winMediaPlayer.URL = fileUrl;
 
            break;
    }
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 청취종료 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_recIdCancel_onclick(obj:Button,  e:ClickEventInfo)
{
	atx_winMediaPlayer.close();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 접수자 조회
 *---------------------------------------------------------------------------------------------*/
function btn_acceptUser_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_userPopup("acceptUser");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 처리자 조회
 *---------------------------------------------------------------------------------------------*/
function btn_procUser_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_userPopup("procUser");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 접수자, 처리자 조회 팝업(공통)
 *---------------------------------------------------------------------------------------------*/
function fn_userPopup(param)
{
	//[[Before Event를 정의한다.
	if (!gfn_isNull(this.eventBeforeTrigger))
	{
		var beforeEvent = eval("parent."+this.eventBeforeTrigger);
		var rtn = beforeEvent(this);
		
		if (!rtn) return;
	}
	alert(this.qoMuCd);
	alert(this.qoTmCd);
	//[[팝업창을 호출한다.
	var strId       = "PersonalSearch";
	var strURL      = "cmn::PersonalSearchPop.xfdl";
	var objArgument = {
		P_MU_CD : "",
		P_TM_CD : this.qoTmCd,
		P_TM_NM : this.qoTmNm,
		P_CC_CD : this.qoCcCd,
		P_CC_NM : this.qoCcNm
	};
	var nWidth      = "";
	var nHeight     = "";
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";

	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
	if (arrRtn instanceof Object)
	{
		ds_acceptor.clearData();
		sRow = ds_acceptor.addRow();
		ds_acceptor.setColumn(sRow,"acceptorCd",arrRtn.sabun);
		ds_acceptor.setColumn(sRow,"acceptorNm",arrRtn.nmKor);
		
		if (param == "acceptUser")
		{
			edt_acceptUser.value = ds_acceptor.getColumn(sRow,"acceptorNm");
			ds_search.setColumn(0, "acceptUser", ds_acceptor.getColumn(sRow, "acceptorCd"));
		}
		else if (param == "procUser")
		{
			edt_procUser.value = ds_acceptor.getColumn(sRow,"acceptorNm");
			ds_search.setColumn(0, "procUser", ds_acceptor.getColumn(sRow, "acceptorCd"));
		}
		if (!gfn_isNull(this.eventAfterTrigger))
		{
			var afterEvent = eval("parent."+this.eventAfterTrigger);
			afterEvent(this, arrRtn);
		}
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 엔터입력 시 조회
 *---------------------------------------------------------------------------------------------*/
function edt_procUser_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13)
	{
		fn_search();
	}
}
function grd_list_onkeyup(obj:Grid, e:KeyEventInfo)
{
	if (ds_ccsCnslAllLog.getColumn(obj.currentrow, "evalScore") > 10) {
		gfn_alert("평가점수는 10점 이상 입력할 수 없습니다.");
		ds_ccsCnslAllLog.setColumn(obj.currentrow, "evalScore", ds_ccsCnslAllLog.getColumn(obj.currentrow, "evalScoreTmp"));
		return;
	}
}

function form_onkeydown(obj:Form, e:KeyEventInfo)
{
	gfn_formKeyDown(obj, e);
	if ((e.keycode == 13) && (e.fromreferenceobject.parent == edt_procUser) ) fn_search();
}

function grd_list_onlbuttonup(obj:Grid, e:GridMouseEventInfo) {
	if ( e.cell < 0 || e.col != 15 ) return;
	
	var sRecordPath = ds_ccsCnslAllLog.getColumn(e.row.rowposition, "recordPath");
	if ( gfn_isNull(sRecordPath) ) {
		gfn_alert("녹취파일정보가 없습니다.");
		return;
	}
		
	var status = ds_ccsCnslAllLog.getColumn(e.row, "recordStatus");
	switch ( status ) {
		case "▶" :
			for ( var i = 0; i<ds_ccsCnslAllLog.rowcount; i++ ) {
				if ( i == e.row ) {
					ds_ccsCnslAllLog.setColumn(i, "recordStatus", "■");
				} else {
					ds_ccsCnslAllLog.setColumn(i, "recordStatus", "▶");
				}
			}
			btn_recId.click();
			break;
			
		case "■" :
			for ( var i = 0; i<ds_ccsCnslAllLog.rowcount; i++ ) {
				ds_ccsCnslAllLog.setColumn(i, "recordStatus", "▶");
			}
			btn_recIdCancel.click();
			break;
			
		default :
			break;
	}	
}

function fn_setAuth(objParam) {
	var oDs = this.objects[objParam.datasetName];
	if ( oDs.findRow("code", g_EmpNo) != -1 ) {
		ds_cmnAuth.setColumn(0, "exlYn", "Y");
	}
}

function fn_exportExcel(objGrid, strSheetName, strFileName, strColName, bDirectSave, strExportHead, strAcceptStyle){
	if (!gfn_isExcelInstall()) {
		if (!gfn_confirm("컴퓨터에 Excel이 설치된 경우에는 [확인]버튼을 클릭해 주세요.")) return;
	}
	// 엑셀 File명을 지정하여 저장할지 여부는 true
	if(gfn_isNull(bDirectSave)) bDirectSave = true;

	if(gfn_isNull(strFileName)) strFileName = gfn_replace(gfn_getFormName(),"/","");
	if(gfn_isNull(strSheetName)) strSheetName = gfn_replace(gfn_getFormName(),"/","");
		
    // 엑셀 다운로드시 objGrid에 Dataset등 다른 컴포넌트때문에 오류 발생시 리턴.
    if(objGrid.toString() != '[object Grid]') {
        return application.alert('Grid Component가 없습니다.');
    }
	
	var nRowTotal = objGrid.rowcount;	
	if (nRowTotal == 0) 
	{
        gfn_alert("msg.err.grid.nodata");	// 데이타가 없습니다.
        return;
	}
    
	// FileDialog 후 파일명 입력
	if(!bDirectSave) 
    {
		var fd = new FileDialog();		
		fd.defaultextention = true;
		fd.filter = "Excel 통합문서 (*.xlsx)|*.xlsx|Excel 97 - 2003 통합문서 (*.xls)|*.xls";
		
		var vFile = fd.open("Excel Save", FileDialog.SAVE, "%MyDocument%", strFileName);  
		if (gfn_isNull(vFile)) {
			strFileName = "";
			return;
		} else {
			strFileName = vFile.fullpath;
		}
		vFile.close();
    }
    
    this.setWaitCursor(true, true);

	// cell,area,multiarea,treecell 등 엑셀 export시 내용 삭제되어 추가
	var orgSelecttype  = objGrid.selecttype;
	objGrid.selecttype = "row";
	    	
    var objExport = new ExportObject();
    objExport.exporttype     = ExportTypes.EXCEL;
    objExport.activepagename = strSheetName;
    objExport.exportfilename = strFileName;

	// 엑셀 열기
	if(bDirectSave) 
	{
		objExport.exportopenmode  = "existopen";    	// 엑셀 다운로드 기능시 파일을 생성하지 않고 띄움		
		
// 		// 체크박스 칼럼 확인_컨버팅 요건에 의해 주석처리
//         var nIndex_check = objGrid.getBindCellIndex("body","chk");        
//         if(nIndex_check == -1)
//         {
// 			nIndex_check = objGrid.getBindCellIndex("body","CHK");
//         }
        
		//제외칼럼이 있을 경우 엑셀 export시 칼럼을 제외시킴
		if(!gfn_isNull(strColName))	//nIndex_check > -1 || 
		{
			//1. 탬프그리드 생성.
			var objGridTemp = new Grid("grd_temp", 0, 0, 1, 1);
			this.addChild("grd_temp", objGridTemp);
			
			//2. 원본 그리드 포맷 카피.
			objGridTemp.formats 	= objGrid.getFormatString();
			objGridTemp.formatid    = objGrid.formatid;
			//trace("objGridTemp.formats0 : " + objGridTemp.formats);
			
			var sBand;
			var nIndex;
			var nCol;
			
			//3-1. 특정 칼럼 제거
			if(!gfn_isNull(strColName)) 
			{
				var arrCol = gfn_split(strColName, ",");
				for(x in arrCol)
				{
					//trace("arrCol " + x + " : " + arrCol[x]);
					nIndex = gfn_getColumnCellIdx(objGridTemp, arrCol[x]);
					sBand = objGridTemp.getFormatColProperty(nIndex, "band");
					nCol = objGridTemp.deleteContentsCol(sBand, nIndex, false);
					//trace(arrCol[x] + " - nIndex : " + nIndex + " - sBand : " + sBand + " - nCol : " + nCol);
				}
			}
			
			//4. Dataset동적 바인딩.
			objGridTemp.binddataset = objGrid.binddataset;
			//trace("objGridTemp.formats2 : " + objGridTemp.formats);
			
			//5. 그리드 visible: false, show()
			objGridTemp.visible = false;
			objGridTemp.show();
			objExport.addExportItem(ExportItemTypes.GRID, objGridTemp, strSheetName + "!A1", strExportHead,"","","","","","",strAcceptStyle,"");
			
			objExport.export();
			objExport = null;
			
			//6. temp그리드 삭제.
			this.removeChild("grd_temp");
			objGridTemp.destroy();
			objGridTemp = null;			
		} 
		// Grid원본 export
		else { 
			objExport.addExportItem(ExportItemTypes.GRID, objGrid, strSheetName + "!A1",strExportHead,"","","","","","",strAcceptStyle,"");
			//objExport.addExportItem(ExportItemTypes.GRID, objGrid, strSheetName + "!A1");
			objExport.export();
			objExport = null;
		}

		// 원래 selecttype으로 변경
		objGrid.selecttype = orgSelecttype;
		
		this.setWaitCursor(false, true);
    }
    // 엑셀 File 생성
    else {
		objExport.exportactivemode 	= "noactive";		// 엑셀 익스포트 후 엑셀을 띄울지
		objExport.exportopenmode    = "overwrite";   	// File이 존재여부에 따른 구분
		objExport.exportsavemode    = "save";			// Export시 지정된 File로 Save 할지 여부, exportopenmode를 'overwirte'로 지정해야함.

		objExport.addExportItem(ExportItemTypes.GRID, objGrid, strSheetName + "!A1");
		objExport.export();
	
		// 원래 selecttype으로 변경
		objGrid.selecttype = orgSelecttype;
		
		this.setWaitCursor(false, true);		
		objExport = null;
		
		gfn_alert("msg.filesave.success", strFileName);	// $1 파일로 저장되었습니다.
    }
}
 
function fn_gridSort(obj:Grid, e:GridClickEventInfo) {
	if ( ds_cmnAuth.getColumn(0, "exlYn") == "Y" ) {
		var strHeadClass = obj.getCellProperty("head", e.col,"class");
		if(strHeadClass == "head_Excel")
		{
			obj.enableredraw = false;
			obj.formatid = "default_excel";
			fn_exportExcel(obj);
			obj.formatid = "default";
			obj.enableredraw = true;
			return;
		} else {
			gfn_gridSort(obj, e);
		}
		
	} else {
		gfn_gridSort(obj, e);
	}
}]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="OrderDecision" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="주문결의" scrollbars="autoboth" onload="form_onload" onsize="OrderDecision_onsize">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="17" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30" tabstop="false"/>
        <Static id="Static18" text="주문목록" class="sta_WF_Title01" position="absolute 0 84 450 102" anchor="left top"/>
        <Static id="Static19" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 450 84"/>
        <Static id="Static20" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 97 450 102" anchor="left top"/>
        <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 273 450 288" anchor="left top"/>
        <Grid id="grd_list" taborder="13" binddataset="ds_list" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 0 102 1237 273" anchor="left top right" autofittype="col" oncelldblclick="grd_list_oncelldblclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="143"/>
                <Column size="89"/>
                <Column size="247"/>
                <Column size="117"/>
                <Column size="108"/>
                <Column size="324"/>
                <Column size="40"/>
                <Column size="40"/>
                <Column size="40"/>
                <Column size="121"/>
                <Column size="40"/>
                <Column size="121"/>
                <Column size="121"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                <Cell col="1" text="주문신청번호"/>
                <Cell col="2" text="센터"/>
                <Cell col="3" text="업장"/>
                <Cell col="4" text="신청일자"/>
                <Cell col="5" text="입고일자"/>
                <Cell col="6" text="신청내용"/>
                <Cell col="7" text="0단가"/>
                <Cell col="8" text="불용"/>
                <Cell col="9" text="중지"/>
                <Cell col="10" text="신청금액"/>
                <Cell col="11" displaytype="text" edittype="none" text="선택"/>
                <Cell col="12" text="주문상태"/>
                <Cell col="13" text="CS담당자"/>
              </Band>
              <Band id="body">
                <Cell expr="currow+1"/>
                <Cell col="1" displaytype="text" style="align:center;" text="bind:prNum"/>
                <Cell col="2" displaytype="text" text="bind:centerName"/>
                <Cell col="3" style="align:left middle;" text="bind:upjangnm"/>
                <Cell col="4" displaytype="text" style="align:center middle;" text="bind:prDate"/>
                <Cell col="5" displaytype="text" style="align:center middle;" text="bind:needDate" mask="####-##-##"/>
                <Cell col="6" style="align:left middle;" text="bind:itemName"/>
                <Cell col="7" displaytype="text" style="align:center middle;" text="bind:poNoYn"/>
                <Cell col="8" displaytype="text" style="align:center middle;" text="bind:valUnsYn"/>
                <Cell col="9" displaytype="text" style="align:center middle;" text="bind:valStpYn"/>
                <Cell col="10" displaytype="number" style="align:right middle;" text="bind:itemAmt" mask="#,##0.#0"/>
                <Cell col="11" displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                <Cell col="12" style="align:center middle;" text="bind:soStatusNm"/>
                <Cell col="13" style="align:center middle;" text="bind:csSabunNm" subsumtext="CS_SABUN_NM"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static37" text="주문내역" class="sta_WF_Title01" position="absolute 0 342 450 360" anchor="left top"/>
        <Static id="Static38" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 329 450 342" anchor="left top"/>
        <Static id="Static39" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 355 450 360" anchor="left top"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 93 40" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 93 71" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 83 40 93 61" anchor="left top"/>
        <Static id="Static00" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 308 40 323 61" anchor="left top"/>
        <Static id="Static03" text="입고일자" class="sta_WFSA_label" position="absolute 15 40 84 61" anchor="left top"/>
        <Grid id="grd_sub" taborder="18" binddataset="ds_sub" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 0 360 1237 710" anchor="all" autofittype="none">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="37" band="left"/>
                <Column size="32" band="left"/>
                <Column size="76"/>
                <Column size="224"/>
                <Column size="157"/>
                <Column size="45"/>
                <Column size="74"/>
                <Column size="69"/>
                <Column size="63"/>
                <Column size="62"/>
                <Column size="75"/>
                <Column size="86"/>
                <Column size="211"/>
                <Column size="177"/>
                <Column size="44"/>
                <Column size="61"/>
                <Column size="191"/>
                <Column size="82"/>
                <Column size="72"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                <Cell col="1" displaytype="checkbox" edittype="checkbox"/>
                <Cell col="2" text="자재코드"/>
                <Cell col="3" text="자재명"/>
                <Cell col="4" text="규격"/>
                <Cell col="5" text="단위"/>
                <Cell col="6" text="신청일자"/>
                <Cell col="7" text="입고일자"/>
                <Cell col="8" text="신청량"/>
                <Cell col="9" text="결의량"/>
                <Cell col="10" text="판매단가"/>
                <Cell col="11" text="판매금액"/>
                <Cell col="12" text="신청비고"/>
                <Cell col="13" text="비고"/>
                <Cell col="14" text="배송"/>
                <Cell col="15" text="과세코드"/>
                <Cell col="16" text="창고"/>
                <Cell col="17" text="신청구분"/>
                <Cell col="18" text="구매상태"/>
              </Band>
              <Band id="body">
                <Cell style="background:EXPR(poStatus!='HK'?'darkgray':fmpStatus=='Y'?'olive':poNoStatus=='Y'?'gold':'');background2:EXPR(poStatus!='HK'?'darkgray':fmpStatus=='Y'?'olive':poNoStatus=='Y'?'gold':'');selectbackground:EXPR(poStatus!='HK'?'darkgray':fmpStatus=='Y'?'olive':poNoStatus=='Y'?'gold':'');" expr="currow+1"/>
                <Cell col="1" displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                <Cell col="2" style="background2: ;selectbackground:EXPR(poStatus!='HK'?'darkgray':fmpStatus=='Y'?'olive':poNoStatus=='Y'?'gold':'');" text="bind:itemCode"/>
                <Cell col="3" style="align:left middle;" text="bind:itemName"/>
                <Cell col="4" displaytype="text" text="bind:itemSize"/>
                <Cell col="5" text="bind:itemUnit"/>
                <Cell col="6" displaytype="date" text="bind:prDate"/>
                <Cell col="7" displaytype="date" text="bind:needDate"/>
                <Cell col="8" displaytype="number" style="align:right;" text="bind:prQty" mask="#,##0.#0"/>
                <Cell col="9" displaytype="number" edittype="masknumber" style="align:right middle;color:blue;color2:blue;" text="bind:poQty" mask="#,##0.#0" editautoselect="true"/>
                <Cell col="10" displaytype="number" style="align:right middle;" text="bind:salePrice" mask="#,##0.#0"/>
                <Cell col="11" displaytype="number" style="align:right middle;" text="bind:saleAmt" mask="#,##0.#0"/>
                <Cell col="12" displaytype="text" edittype="text" style="color:blue;color2:blue;" text="bind:prRemark"/>
                <Cell col="13" displaytype="text" edittype="none" style="color:blue;color2:blue;" text="bind:remark"/>
                <Cell col="14" text="bind:centerFlag"/>
                <Cell col="15" text="bind:taxCode"/>
                <Cell col="16" style="align:left middle;" text="bind:subinvName"/>
                <Cell col="17" style="background2: ;" text="bind:docuSource"/>
                <Cell col="18" displaytype="text" edittype="none" style="align:center;color:blue;color2:blue;" text="bind:poLineStatusNm"/>
              </Band>
              <Band id="summary">
                <Cell/>
                <Cell col="1"/>
                <Cell col="2"/>
                <Cell col="3"/>
                <Cell col="4"/>
                <Cell col="5"/>
                <Cell col="6"/>
                <Cell col="7"/>
                <Cell col="8"/>
                <Cell col="9"/>
                <Cell col="10"/>
                <Cell col="11" displaytype="number" style="align:right middle;" text="expr:getSum('amt')" mask="#,##0.#0"/>
                <Cell col="12"/>
                <Cell col="13"/>
                <Cell col="14"/>
                <Cell col="15"/>
                <Cell col="16"/>
                <Cell col="17"/>
                <Cell col="18"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static28" text="센터" class="sta_WFSA_label" position="absolute 564 40 599 61" anchor="left top"/>
        <Static id="Static01" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 711 41 741 62" anchor="left top"/>
        <Static id="Static36" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 380 40 390 61" anchor="left top"/>
        <Static id="Static15" text="구매유형" class="sta_WFSA_label" position="absolute 323 40 385 61" anchor="left top"/>
        <Combo id="cbo_type" taborder="2" innerdataset="@ds_type" codecolumn="poType" datacolumn="typeName" position="absolute 390 40 550 61" anchor="left top" class="cmb_WF_Essential"/>
        <Static id="Static09" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 550 41 565 67" anchor="left top"/>
        <Static id="Static02" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 1144 71 1237 81" anchor="left top"/>
        <Button id="btn_return" taborder="12" text="반려" class="btn_WF_Function" position="absolute 1192 80 1237 100" anchor="top right" onclick="btn_return_onclick"/>
        <Static id="Static21" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1190 80 1192 100" anchor="top right"/>
        <Button id="btn_Edit" taborder="11" text="조정" class="btn_WF_Function" position="absolute 1145 80 1190 100" anchor="top right" onclick="btn_Edit_onclick"/>
        <ObjCalendar id="cal_toDate" titletext="캘린더" taborder="1" text="20150101" scrollbars="none" position="absolute 208 40 308 61"/>
        <Static id="Static26" text="~" position="absolute 194 43 210 62" style="align:center middle;"/>
        <ObjCalendar id="cal_fromDate" titletext="캘린더" taborder="0" text="20150101" scrollbars="none" position="absolute 93 40 193 61"/>
        <Combo id="cbo_centerCode" taborder="16" innerdataset="ds_center" codecolumn="centerCode" datacolumn="centerName" class="cmb_WF_Essential" position="absolute 1268 25 1427 46" anchor="left top" visible="false"/>
        <Combo id="cbo_status" taborder="22" innerdataset="@ds_status" codecolumn="code" datacolumn="codeName" position="absolute 1347 8 1435 29" anchor="left top" visible="false"/>
        <Static id="Static27" text="주문상태" class="sta_WFSA_label" position="absolute 1269 8 1331 29" anchor="left top" visible="false"/>
        <Edit id="ed_bond" taborder="19" tabstop="false" autoselect="true" enable="false" visible="false" position="absolute 1595 50 1705 71" style="align:right; :disabled {background:#ffffffff;color:red;}"/>
        <Static id="st_Bond" text="채권잔액" class="sta_WFDA_Label01" visible="false" position="absolute 1490 50 1585 71" style="align:center middle;"/>
        <Edit id="ed_credit" taborder="20" tabstop="false" autoselect="true" enable="false" visible="false" position="absolute 1370 50 1480 71" style="align:right; :disabled {background:#ffffffff;color:red;}"/>
        <Static id="st_Credit" text="발주가능금액" class="sta_WFDA_Label01" visible="false" position="absolute 1268 50 1360 71"/>
        <Div id="div_return" taborder="21" style="background:#f2eee5ff;border:1 solid #808080ff ;" visible="false" position="absolute 1321 102 1762 186">
          <Layouts>
            <Layout>
              <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 89 15 99 36" anchor="left top"/>
              <Static id="Static48" text="반려사유" class="sta_WFSA_label01" position="absolute 16 49 78 70" anchor="left top"/>
              <Static id="Static49" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 89 48 99 69" anchor="left top"/>
              <Edit id="edt_return_remark" taborder="6" position="absolute 99 48 421 69" anchor="left top"/>
              <Button id="btn_needDateSave" taborder="7" text="저장" class="btn_WF_Function" position="absolute 334 15 379 35" anchor="top right" onclick="div_return_btn_needDateSave_onclick"/>
              <Button id="btn_Close" taborder="8" text="취소" class="btn_WF_Function" position="absolute 381 15 426 35" anchor="top right" onclick="div_return_btn_Close_onclick"/>
              <Static id="Static25" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 -2 15 83" anchor="top right"/>
              <Static id="Static00" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 426 -2 441 83" anchor="top right"/>
              <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 69 441 84" anchor="left bottom"/>
              <Static id="Static01" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 441 15" anchor="left bottom"/>
              <Static id="Static02" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 8 35 449 48" anchor="left bottom"/>
            </Layout>
          </Layouts>
        </Div>
        <Splitter id="sp_line" type="vertical" position="absolute 0 277 1237 285" anchor="left top right" onmove="sp_line_onmove">
          <Formats>
            <Format id="default">
              <SplitterItems id="items">
                <SplitterItem id="item00" position="leftortop" bindtype="resize" componentid="grd_list"/>
                <SplitterItem id="item02" position="rightorbottom" bindtype="resize" componentid="div_center"/>
              </SplitterItems>
            </Format>
          </Formats>
        </Splitter>
        <Div id="div_center" anchor="left top right" taborder="14" style="background:transparent;color:aliceblue;" text="Div00" position="absolute 0 281 1238 331" scrollbars="none">
          <Layouts>
            <Layout width="1238" height="50">
              <Static id="Static41" class="sta_WFSA_Labelbg01" position="absolute 0 4 1237 45" anchor="left top right"/>
              <Static id="Static42" text="신청번호" class="sta_WFSA_label01" position="absolute 15 14 77 35" anchor="left top"/>
              <Static id="Static43" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 4 93 14" anchor="left top"/>
              <Static id="Static44" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 35 93 45" anchor="left top"/>
              <Static id="Static45" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 14 15 35" anchor="left top"/>
              <Static id="Static46" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 75 14 85 35" anchor="left top"/>
              <Static id="Static47" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 192 14 222 35" anchor="left top"/>
              <Edit id="edt_PoNum" taborder="1" readonly="true" position="absolute 85 14 192 35" anchor="left top"/>
              <Static id="Static48" text="신청내용" class="sta_WFSA_label01" position="absolute 473 14 535 35" anchor="left top"/>
              <Static id="Static49" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 532 14 542 35" anchor="left top"/>
              <Edit id="edt_remark" taborder="2" readonly="true" position="absolute 542 14 770 35" anchor="left top"/>
              <Static id="Static50" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 770 14 800 35" anchor="left top"/>
              <Static id="Static51" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 859 13 869 34" anchor="left top"/>
              <Static id="Static52" text="신청금액" class="sta_WFSA_label01" position="absolute 801 13 863 34" anchor="left top"/>
              <Static id="Static17" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1190 14 1192 34" anchor="top right"/>
              <Button id="btn_Save" taborder="3" text="저장" onclick="btn_Save_onclick" class="btn_WF_Function" position="absolute 1143 14 1188 34" anchor="top right"/>
              <Static id="Static32" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1143 14 1145 34" anchor="top right"/>
              <Button id="btn_chNeedDate" taborder="4" text="입고일자 변경" onclick="btn_chNeedDate_onclick" class="btn_WF_Function" position="absolute 1031 14 1141 34" anchor="top right" tooltiptext="구매상태가 발주완료건만 변경할 수 있습니다."/>
              <Static id="Static33" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 1144 5 1237 15" anchor="left top"/>
              <Static id="Static34" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 1144 34 1237 44" anchor="left top"/>
              <Static id="Static12" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 279 13 289 34" anchor="left top"/>
              <Edit id="edt_PoType" taborder="5" readonly="true" position="absolute 289 13 440 34" anchor="left top"/>
              <Static id="Static13" text="구매유형" class="sta_WFSA_label" position="absolute 221 14 282 35" anchor="left top"/>
              <Static id="Static14" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 440 13 470 34" anchor="left top"/>
              <Static id="Static16" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 279 4 372 14" anchor="left top"/>
              <Static id="Static29" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 527 4 620 14" anchor="left top"/>
              <MaskEdit id="mak_Amt" taborder="6" readonly="true" mask="#,##0.#0" position="absolute 868 13 991 34" anchor="default"/>
              <Button id="btn_Return" taborder="7" text="반려" onclick="btn_Return_onclick" class="btn_WF_Function" position="absolute 1191 14 1236 34" anchor="top right"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_tip" taborder="15" text="Div00" position="absolute 419 331 1236 358" style="background:transparent;" scrollbars="none" anchor="left top right">
          <Layouts>
            <Layout>
              <Static id="Static23" text="구매 수발주 제한" class="sta_WF_DiscInfo" position="absolute 8 5 137 23" anchor="top right" visible="false"/>
              <Static id="st_po" text="신청불가능" class="sta_WFDA_Label01" position="absolute 137 3 228 24" anchor="top right" style="background:darkgray;color:white;align:center middle;font:Gulim,9,bold;" visible="false"/>
              <Static id="Static25" text="식재 수발주 제한" class="sta_WF_DiscInfo" position="absolute 239 5 368 23" anchor="top right" style="color:darkred;" visible="false"/>
              <Static id="st_po00" text="신청불가능" class="sta_WFDA_Label01" position="absolute 368 3 459 24" anchor="top right" style="background:olive;color:white;align:center middle;font:Gulim,9,bold;" visible="false"/>
              <Static id="Static24" text="구매 0단가 제한" class="sta_WF_DiscInfo" position="absolute 469 5 598 23" anchor="top right" style="color:limegreen;" visible="false"/>
              <Static id="st_po01" text="신청불가능" class="sta_WFDA_Label01" position="absolute 593 3 684 24" anchor="top right" style="background:gold;color:ivory;align:center middle;font:Gulim,9,bold;" visible="false"/>
              <Button id="btn_etcSave" taborder="1" text="비고저장" class="btn_WF_Function" position="absolute 744 4 815 24" anchor="top right" onclick="div_tip_btn_etcSave_onclick" tooltiptext="신청비고 항목을 저장합니다" visible="true"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_Date" taborder="24" style="background:#f2eee5ff;border:1 solid #808080ff ;" visible="false" position="absolute 1321 200 1762 284">
          <Layouts>
            <Layout>
              <Static id="Static03" text="변경일" class="sta_WFSA_label" position="absolute 16 15 85 36" anchor="left top"/>
              <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 89 15 99 36" anchor="left top"/>
              <ObjCalendar id="cal_needDate" titletext="캘린더" taborder="5" scrollbars="none" position="absolute 99 15 199 36"/>
              <Static id="Static48" text="변경사유" class="sta_WFSA_label01" position="absolute 16 49 78 70" anchor="left top"/>
              <Static id="Static49" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 89 48 99 69" anchor="left top"/>
              <Edit id="edt_remark" taborder="6" position="absolute 99 48 421 69" anchor="left top"/>
              <Button id="btn_needDateSave" taborder="7" text="저장" onclick="div_Date_btn_needDateSave_onclick" class="btn_WF_Function" position="absolute 334 15 379 35" anchor="top right"/>
              <Button id="btn_Close" taborder="8" text="취소" onclick="div_Date_btn_Close_onclick" class="btn_WF_Function" position="absolute 381 15 426 35" anchor="top right"/>
              <Static id="Static25" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 -2 15 83" anchor="top right"/>
              <Static id="Static00" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 426 -2 441 83" anchor="top right"/>
              <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 69 441 84" anchor="left bottom"/>
              <Static id="Static01" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 441 15" anchor="left bottom"/>
              <Static id="Static02" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 8 35 449 48" anchor="left bottom"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_sub_return" taborder="25" style="background:#f2eee5ff;border:1 solid #808080ff ;" visible="false" position="absolute 1321 322 1762 409">
          <Layouts>
            <Layout>
              <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 89 15 99 36" anchor="left top"/>
              <Static id="Static48" text="반려사유" class="sta_WFSA_label01" position="absolute 16 49 78 70" anchor="left top"/>
              <Static id="Static49" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 89 48 99 69" anchor="left top"/>
              <Edit id="edt_return_remark" taborder="15" position="absolute 99 48 421 69" anchor="left top"/>
              <Button id="btn_needDateSave" taborder="16" text="저장" onclick="fn_Subreturn" class="btn_WF_Function" position="absolute 334 15 379 35" anchor="top right"/>
              <Button id="btn_Close" taborder="17" text="취소" onclick="div_sub_return_btn_Close_onclick" class="btn_WF_Function" position="absolute 381 15 426 35" anchor="top right"/>
              <Static id="Static25" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 -2 15 83" anchor="top right"/>
              <Static id="Static00" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 426 -2 441 83" anchor="top right"/>
              <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 69 441 84" anchor="left bottom"/>
              <Static id="Static01" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 441 15" anchor="left bottom"/>
              <Static id="Static02" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 8 35 449 48" anchor="left bottom"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static12" text="C/S담당" class="sta_WFSA_label" position="absolute 818 40 880 61" anchor="left top"/>
        <Static id="Static13" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 877 40 887 61" anchor="left top"/>
        <Edit id="edt_sabunNm" taborder="5" readonly="true" onkeydown="edt_sabunNm_onkeydown" position="absolute 887 41 1015 62" userdata="btn_pop5"/>
        <Button id="btn_pop5" taborder="6" onclick="fn_csSabunPop" class="btn_WF_popSearch" position="absolute 1014 41 1034 62"/>
        <Grid id="Grid00" taborder="26" useinputpanel="false" position="absolute 200 473 1082 549" binddataset="ds_search" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="schGubun"/>
                <Cell col="1" disptype="normal" text="schDate1"/>
                <Cell col="2" disptype="normal" text="schDate2"/>
                <Cell col="3" disptype="normal" text="schType"/>
                <Cell col="4" disptype="normal" text="schTypeNm"/>
                <Cell col="5" disptype="normal" text="schSabun"/>
                <Cell col="6" disptype="normal" text="schUpjang"/>
                <Cell col="7" disptype="normal" text="schChk1"/>
                <Cell col="8" disptype="normal" text="schPrNum"/>
                <Cell col="9" disptype="normal" text="schPrDate"/>
                <Cell col="10" disptype="normal" text="schNeedDate"/>
                <Cell col="11" disptype="normal" text="schFlag"/>
                <Cell col="12" disptype="normal" text="schCenter"/>
                <Cell col="13" disptype="normal" text="schStatus"/>
                <Cell col="14" disptype="normal" text="schSubStatus"/>
                <Cell col="15" disptype="normal" text="schCustcd"/>
                <Cell col="16" disptype="normal" text="schRcUpjang"/>
                <Cell col="17" disptype="normal" text="schHeadCreditYn"/>
                <Cell col="18" disptype="normal" text="schMainUpjang"/>
                <Cell col="19" disptype="normal" text="schChgNeedDate"/>
                <Cell col="20" disptype="normal" text="schSubinvCode"/>
                <Cell col="21" disptype="normal" text="listPrNum"/>
                <Cell col="22" disptype="normal" text="schCsSabun"/>
                <Cell col="23" disptype="normal" text="schCsSabunNm"/>
                <Cell col="24" disptype="normal" text="schCode"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:schGubun"/>
                <Cell col="1" disptype="normal" text="bind:schDate1"/>
                <Cell col="2" disptype="normal" text="bind:schDate2"/>
                <Cell col="3" disptype="normal" text="bind:schType"/>
                <Cell col="4" disptype="normal" text="bind:schTypeNm"/>
                <Cell col="5" disptype="normal" text="bind:schSabun"/>
                <Cell col="6" disptype="normal" text="bind:schUpjang"/>
                <Cell col="7" disptype="normal" text="bind:schChk1"/>
                <Cell col="8" disptype="normal" text="bind:schPrNum"/>
                <Cell col="9" disptype="normal" text="bind:schPrDate"/>
                <Cell col="10" disptype="normal" text="bind:schNeedDate"/>
                <Cell col="11" disptype="normal" text="bind:schFlag"/>
                <Cell col="12" disptype="normal" text="bind:schCenter"/>
                <Cell col="13" disptype="normal" text="bind:schStatus"/>
                <Cell col="14" disptype="normal" text="bind:schSubStatus"/>
                <Cell col="15" disptype="normal" text="bind:schCustcd"/>
                <Cell col="16" disptype="normal" text="bind:schRcUpjang"/>
                <Cell col="17" disptype="normal" text="bind:schHeadCreditYn"/>
                <Cell col="18" disptype="normal" text="bind:schMainUpjang"/>
                <Cell col="19" disptype="normal" text="bind:schChgNeedDate"/>
                <Cell col="20" disptype="normal" text="bind:schSubinvCode"/>
                <Cell col="21" disptype="normal" text="bind:listPrNum"/>
                <Cell col="22" disptype="normal" text="bind:schCsSabun"/>
                <Cell col="23" disptype="normal" text="bind:schCsSabunNm"/>
                <Cell col="24" disptype="normal" text="bind:schCode"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="Grid01" taborder="27" useinputpanel="false" position="absolute 203 550 668 626" binddataset="ds_status" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="groupCode"/>
                <Cell col="1" disptype="normal" text="code"/>
                <Cell col="2" disptype="normal" text="codeName"/>
                <Cell col="3" disptype="normal" text="contents"/>
                <Cell col="4" disptype="normal" text="sortSeq"/>
                <Cell col="5" disptype="normal" text="systemYn"/>
                <Cell col="6" disptype="normal" text="posYn"/>
                <Cell col="7" disptype="normal" text="set1"/>
                <Cell col="8" disptype="normal" text="set2"/>
                <Cell col="9" disptype="normal" text="set3"/>
                <Cell col="10" disptype="normal" text="set4"/>
                <Cell col="11" disptype="normal" text="set5"/>
                <Cell col="12" disptype="normal" text="remark"/>
                <Cell col="13" disptype="normal" text="useYn"/>
                <Cell col="14" disptype="normal" text="attr01"/>
                <Cell col="15" disptype="normal" text="attr02"/>
                <Cell col="16" disptype="normal" text="attr03"/>
                <Cell col="17" disptype="normal" text="attr04"/>
                <Cell col="18" disptype="normal" text="attr05"/>
                <Cell col="19" disptype="normal" text="attr06"/>
                <Cell col="20" disptype="normal" text="attr07"/>
                <Cell col="21" disptype="normal" text="attr08"/>
                <Cell col="22" disptype="normal" text="attr09"/>
                <Cell col="23" disptype="normal" text="attr10"/>
                <Cell col="24" disptype="normal" text="cuser"/>
                <Cell col="25" disptype="normal" text="cdate"/>
                <Cell col="26" disptype="normal" text="uuser"/>
                <Cell col="27" disptype="normal" text="udate"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:groupCode"/>
                <Cell col="1" disptype="normal" text="bind:code"/>
                <Cell col="2" disptype="normal" text="bind:codeName"/>
                <Cell col="3" disptype="normal" text="bind:contents"/>
                <Cell col="4" disptype="normal" text="bind:sortSeq"/>
                <Cell col="5" disptype="normal" text="bind:systemYn"/>
                <Cell col="6" disptype="normal" text="bind:posYn"/>
                <Cell col="7" disptype="normal" text="bind:set1"/>
                <Cell col="8" disptype="normal" text="bind:set2"/>
                <Cell col="9" disptype="normal" text="bind:set3"/>
                <Cell col="10" disptype="normal" text="bind:set4"/>
                <Cell col="11" disptype="normal" text="bind:set5"/>
                <Cell col="12" disptype="normal" text="bind:remark"/>
                <Cell col="13" disptype="normal" text="bind:useYn"/>
                <Cell col="14" disptype="normal" text="bind:attr01"/>
                <Cell col="15" disptype="normal" text="bind:attr02"/>
                <Cell col="16" disptype="normal" text="bind:attr03"/>
                <Cell col="17" disptype="normal" text="bind:attr04"/>
                <Cell col="18" disptype="normal" text="bind:attr05"/>
                <Cell col="19" disptype="normal" text="bind:attr06"/>
                <Cell col="20" disptype="normal" text="bind:attr07"/>
                <Cell col="21" disptype="normal" text="bind:attr08"/>
                <Cell col="22" disptype="normal" text="bind:attr09"/>
                <Cell col="23" disptype="normal" text="bind:attr10"/>
                <Cell col="24" disptype="normal" text="bind:cuser"/>
                <Cell col="25" disptype="normal" text="bind:cdate"/>
                <Cell col="26" disptype="normal" text="bind:uuser"/>
                <Cell col="27" disptype="normal" text="bind:udate"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static14" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1143 80 1145 100" anchor="top right"/>
        <Button id="btn_poCheck" taborder="8" text="결의체크" class="btn_WF_Function" position="absolute 589 78 660 98" anchor="top right" tooltiptext="구매0단가,불용,중지여부를 체크합니다" onclick="btn_poCheck_onclick" visible="false"/>
        <ProgressBar id="pbr_status" taborder="9" text="0단가,불용,중지자재 체크" max="100" min="0" visible="false" position="absolute 684 75 967 99" anchor="top right"/>
        <Grid id="Grid02" taborder="30" useinputpanel="false" position="absolute 687 399 1091 470" binddataset="ds_return" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="prNum"/>
                <Cell col="1" disptype="normal" text="prId"/>
                <Cell col="2" disptype="normal" text="poNoStatus"/>
                <Cell col="3" disptype="normal" text="valUnsCnt"/>
                <Cell col="4" disptype="normal" text="valStpCnt"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:prNum"/>
                <Cell col="1" disptype="normal" text="bind:prId"/>
                <Cell col="2" disptype="normal" text="bind:poNoStatus"/>
                <Cell col="3" disptype="normal" text="bind:valUnsCnt"/>
                <Cell col="4" disptype="normal" text="bind:valStpCnt"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Edit id="edt_centerCode" taborder="3" readonly="true" position="absolute 608 41 784 62" class="edt_WF_Essential"/>
        <Button id="btn_centerCode" taborder="4" tabstop="false" class="btn_WF_popSearch" position="absolute 783 41 804 62" onclick="btn_centerCode_onclick"/>
        <Static id="Static16" text="1,000건씩 선택 " class="sta_WFSA_label" position="absolute 970 78 1075 100" anchor="left top"/>
        <Button id="btn_SELECT" taborder="10" text="선택" class="btn_WF_Function" visible="true" position="absolute 1072 80 1143 100" anchor="top right" onclick="btn_SELECT_onclick"/>
        <Static id="Static10" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 804 39 819 65" anchor="left top"/>
        <Static id="Static17" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 1106 40 1116 61" anchor="left top"/>
        <Combo id="cbo_upjangGbn" taborder="7" position="absolute 1116 40 1236 61" anchor="left top" codecolumn="codecolumn" datacolumn="datacolumn">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn"/>
                <Col id="datacolumn">전체</Col>
              </Row>
              <Row>
                <Col id="codecolumn">BRAND</Col>
                <Col id="datacolumn">브랜드유통</Col>
              </Row>
              <Row>
                <Col id="codecolumn">BRAND_N</Col>
                <Col id="datacolumn">브랜드유통제외</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="Static22" text="업장구분" class="sta_WFSA_label" position="absolute 1049 40 1111 61" anchor="left top"/>
        <Static id="Static23" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1034 40 1049 61" anchor="left top"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item6" compid="cal_fromDate" propid="text" datasetid="ds_search" columnid="schDate1"/>
      <BindItem id="item7" compid="cal_toDate" propid="text" datasetid="ds_search" columnid="schDate2"/>
      <BindItem id="item0" compid="cbo_type" propid="value" datasetid="ds_search" columnid="schType"/>
      <BindItem id="item4" compid="cbo_centerCode" propid="value" datasetid="ds_search" columnid="schCenter"/>
      <BindItem id="item2" compid="cbo_status" propid="value" datasetid="ds_search" columnid="schStatus"/>
      <BindItem id="ed_CS_SABUN_NM_value" compid="edt_sabunNm" propid="value" datasetid="ds_search" columnid="schCsSabunNm"/>
      <BindItem id="item1" compid="cbo_upjangGbn" propid="value" datasetid="ds_search" columnid="schUpjangGbn"/>
    </Bind>
    <Objects>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_list_oncolumnchanged" onrowposchanged="ds_list_onrowposchanged" canrowposchange="ds_list_canrowposchange">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="prNum" type="STRING" size="256"/>
          <Column id="typeName" type="STRING" size="256"/>
          <Column id="upjangnm" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemAmt" type="STRING" size="256"/>
          <Column id="rcUpjang" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="centerName" type="STRING" size="256"/>
          <Column id="prUpjang" type="STRING" size="256"/>
          <Column id="poDeptId" type="STRING" size="256"/>
          <Column id="lineStatus" type="STRING" size="256"/>
          <Column id="lineStatusNm" type="STRING" size="256"/>
          <Column id="custcd" type="STRING" size="256"/>
          <Column id="custnm" type="STRING" size="256"/>
          <Column id="headCreditYn" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="csSabunNm" type="STRING" size="256"/>
          <Column id="reamrk" type="STRING" size="256"/>
          <Column id="soStatus" type="STRING" size="256"/>
          <Column id="soStatusNm" type="STRING" size="256"/>
          <Column id="poNoYn" type="STRING" size="256"/>
          <Column id="valUnsYn" type="STRING" size="256"/>
          <Column id="valStpYn" type="STRING" size="256"/>
          <Column id="csHp" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sub" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" cancolumnchange="ds_sub_cancolumnchange" oncolumnchanged="ds_sub_oncolumnchanged">
        <ColumnInfo>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="taxCode" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="poQty" type="STRING" size="256"/>
          <Column id="amt" type="STRING" size="256"/>
          <Column id="insDeptNm" type="STRING" size="256"/>
          <Column id="lineStatus" type="STRING" size="256"/>
          <Column id="lineStatusNm" type="STRING" size="256"/>
          <Column id="prId" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="poType" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="minOrdQty" type="STRING" size="256"/>
          <Column id="maxOrdQty" type="STRING" size="256"/>
          <Column id="multiplierQty" type="STRING" size="256"/>
          <Column id="pointFlag" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
          <Column id="docuSource" type="STRING" size="256"/>
          <Column id="saleAmt" type="BIGDECIMAL" size="256"/>
          <Column id="csHp" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_search_oncolumnchanged">
        <ColumnInfo>
          <Column id="schGubun" type="STRING" size="256"/>
          <Column id="schDate1" type="STRING" size="256"/>
          <Column id="schDate2" type="STRING" size="256"/>
          <Column id="schType" type="STRING" size="256"/>
          <Column id="schTypeNm" type="STRING" size="256"/>
          <Column id="schSabun" type="STRING" size="256"/>
          <Column id="schUpjang" type="STRING" size="256"/>
          <Column id="schChk1" type="STRING" size="256"/>
          <Column id="schPrNum" type="STRING" size="256"/>
          <Column id="schPrDate" type="STRING" size="256"/>
          <Column id="schNeedDate" type="STRING" size="256"/>
          <Column id="schFlag" type="STRING" size="256"/>
          <Column id="schCenter" type="STRING" size="256"/>
          <Column id="schStatus" type="STRING" size="256"/>
          <Column id="schSubStatus" type="STRING" size="256"/>
          <Column id="schCustcd" type="STRING" size="256"/>
          <Column id="schRcUpjang" type="STRING" size="256"/>
          <Column id="schHeadCreditYn" type="STRING" size="256"/>
          <Column id="schMainUpjang" type="STRING" size="256"/>
          <Column id="schChgNeedDate" type="STRING" size="256"/>
          <Column id="schSubinvCode" type="STRING" size="256"/>
          <Column id="listPrNum" type="STRING" size="256"/>
          <Column id="schCsSabun" type="STRING" size="256"/>
          <Column id="schCsSabunNm" type="STRING" size="256"/>
          <Column id="schCode" type="STRING" size="256"/>
          <Column id="schUpjangGbn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_type" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="poType" type="STRING" size="256"/>
          <Column id="typeName" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_detail" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="taxCode" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="poQty" type="STRING" size="256"/>
          <Column id="amt" type="STRING" size="256"/>
          <Column id="insDeptNm" type="STRING" size="256"/>
          <Column id="lineStatus" type="STRING" size="256"/>
          <Column id="lineStatusNm" type="STRING" size="256"/>
          <Column id="prId" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="poType" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="soStatus" type="STRING" size="256"/>
          <Column id="soStatusNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_center" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="centerName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">0</Col>
            <Col id="delYn">0</Col>
            <Col id="savYn">1</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">0</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_subflag" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" cancolumnchange="ds_sub_cancolumnchange">
        <ColumnInfo>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="taxCode" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="poQty" type="STRING" size="256"/>
          <Column id="amt" type="STRING" size="256"/>
          <Column id="insDeptNm" type="STRING" size="256"/>
          <Column id="lineStatus" type="STRING" size="256"/>
          <Column id="lineStatusNm" type="STRING" size="256"/>
          <Column id="prId" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="poType" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="minOrdQty" type="STRING" size="256"/>
          <Column id="maxOrdQty" type="STRING" size="256"/>
          <Column id="multiplierQty" type="STRING" size="256"/>
          <Column id="pointFlag" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
          <Column id="docuSource" type="STRING" size="256"/>
          <Column id="ordFlag" type="STRING" size="256"/>
          <Column id="ordDaysFlag" type="STRING" size="256"/>
          <Column id="poStatus" type="STRING" size="256"/>
          <Column id="fmpStatus" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_status" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="groupCode" type="STRING" size="50"/>
          <Column id="code" type="STRING" size="50"/>
          <Column id="codeName" type="STRING" size="500"/>
          <Column id="contents" type="STRING" size="300"/>
          <Column id="sortSeq" type="BIGDECIMAL" size="22"/>
          <Column id="systemYn" type="STRING" size="1"/>
          <Column id="posYn" type="STRING" size="1"/>
          <Column id="set1" type="STRING" size="100"/>
          <Column id="set2" type="STRING" size="100"/>
          <Column id="set3" type="STRING" size="100"/>
          <Column id="set4" type="STRING" size="100"/>
          <Column id="set5" type="STRING" size="100"/>
          <Column id="remark" type="STRING" size="300"/>
          <Column id="useYn" type="STRING" size="1"/>
          <Column id="attr01" type="STRING" size="300"/>
          <Column id="attr02" type="STRING" size="300"/>
          <Column id="attr03" type="STRING" size="300"/>
          <Column id="attr04" type="STRING" size="300"/>
          <Column id="attr05" type="STRING" size="300"/>
          <Column id="attr06" type="STRING" size="300"/>
          <Column id="attr07" type="STRING" size="300"/>
          <Column id="attr08" type="STRING" size="300"/>
          <Column id="attr09" type="STRING" size="300"/>
          <Column id="attr10" type="STRING" size="300"/>
          <Column id="cuser" type="STRING" size="20"/>
          <Column id="cdate" type="DATETIME" size="7"/>
          <Column id="uuser" type="STRING" size="20"/>
          <Column id="udate" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_creInfo" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="creditTurnDays" type="STRING" size="256"/>
          <Column id="creditTurnDaysTot" type="STRING" size="256"/>
          <Column id="creditAmount" type="STRING" size="256"/>
          <Column id="creditAmountTot" type="STRING" size="256"/>
          <Column id="creditOverAmount" type="STRING" size="256"/>
          <Column id="rmnAmt" type="STRING" size="256"/>
          <Column id="preAmt" type="STRING" size="256"/>
          <Column id="trAmt" type="STRING" size="256"/>
          <Column id="poAmt" type="STRING" size="256"/>
          <Column id="prAmt" type="STRING" size="256"/>
          <Column id="bondAmt" type="STRING" size="256"/>
          <Column id="creditRmnAmt" type="STRING" size="256"/>
          <Column id="creditAvailAmt" type="STRING" size="256"/>
          <Column id="lBillDate" type="STRING" size="256"/>
          <Column id="lBillDateDisp" type="STRING" size="256"/>
          <Column id="lastTurnCnt" type="STRING" size="256"/>
          <Column id="creditTurnControlYn" type="STRING" size="256"/>
          <Column id="creditAmountControlYn" type="STRING" size="256"/>
          <Column id="creditControlYn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_subinv" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="consumYn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Srow" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="prNum" type="STRING" size="256"/>
          <Column id="typeName" type="STRING" size="256"/>
          <Column id="upjangnm" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemAmt" type="STRING" size="256"/>
          <Column id="rcUpjang" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="chgRemark" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="usrNm" type="STRING" size="256"/>
          <Column id="poType" type="STRING" size="256"/>
          <Column id="prUpjang" type="STRING" size="256"/>
          <Column id="soStatus" type="STRING" size="256"/>
          <Column id="schDate1" type="STRING" size="256"/>
          <Column id="schDate2" type="STRING" size="256"/>
          <Column id="chgneedDate" type="STRING" size="256"/>
          <Column id="custcd" type="STRING" size="256"/>
          <Column id="prSabun" type="STRING" size="256"/>
          <Column id="subinvCode" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ordCtl" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chkType" type="STRING" size="256"/>
          <Column id="ctrlType" type="STRING" size="256"/>
          <Column id="itemType" type="STRING" size="256"/>
          <Column id="mon" type="STRING" size="256"/>
          <Column id="tue" type="STRING" size="256"/>
          <Column id="wed" type="STRING" size="256"/>
          <Column id="thu" type="STRING" size="256"/>
          <Column id="fri" type="STRING" size="256"/>
          <Column id="sat" type="STRING" size="256"/>
          <Column id="sun" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_listflag" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="prNum" type="STRING" size="256"/>
          <Column id="typeName" type="STRING" size="256"/>
          <Column id="upjangnm" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemAmt" type="STRING" size="256"/>
          <Column id="rcUpjang" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="prUpjang" type="STRING" size="256"/>
          <Column id="poDeptId" type="STRING" size="256"/>
          <Column id="lineStatus" type="STRING" size="256"/>
          <Column id="lineStatusNm" type="STRING" size="256"/>
          <Column id="custcd" type="STRING" size="256"/>
          <Column id="custnm" type="STRING" size="256"/>
          <Column id="headCreditYn" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="csSabunNm" type="STRING" size="256"/>
          <Column id="reamrk" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_check" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="prNum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_checkRow" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="prNum" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_return" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="prNum" type="STRING" size="256"/>
          <Column id="prId" type="STRING" size="256"/>
          <Column id="poNoStatus" type="STRING" size="256"/>
          <Column id="valUnsCnt" type="STRING" size="256"/>
          <Column id="valStpCnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codename" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_retnList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="BIGDECIMAL" size="255"/>
          <Column id="prNum" type="STRING" size="255"/>
          <Column id="typeName" type="STRING" size="255"/>
          <Column id="upjangnm" type="STRING" size="255"/>
          <Column id="prDate" type="STRING" size="255"/>
          <Column id="itemName" type="STRING" size="255"/>
          <Column id="itemAmt" type="BIGDECIMAL" size="255"/>
          <Column id="poType" type="STRING" size="255"/>
          <Column id="rcUpjang" type="BIGDECIMAL" size="255"/>
          <Column id="custcd" type="BIGDECIMAL" size="255"/>
          <Column id="custnm" type="STRING" size="255"/>
          <Column id="centerCode" type="STRING" size="255"/>
          <Column id="centerName" type="STRING" size="255"/>
          <Column id="subinvCode" type="STRING" size="255"/>
          <Column id="poDeptId" type="STRING" size="255"/>
          <Column id="lineStatus" type="STRING" size="255"/>
          <Column id="soStatus" type="STRING" size="255"/>
          <Column id="prSabun" type="STRING" size="255"/>
          <Column id="needDate" type="STRING" size="255"/>
          <Column id="headCreditYn" type="STRING" size="255"/>
          <Column id="mainUpjang" type="BIGDECIMAL" size="255"/>
          <Column id="soStatusNm" type="STRING" size="255"/>
          <Column id="csSabun" type="STRING" size="255"/>
          <Column id="csSabunNm" type="STRING" size="255"/>
          <Column id="remark" type="STRING" size="255"/>
          <Column id="schDate1" type="STRING" size="255"/>
          <Column id="schDate2" type="STRING" size="255"/>
          <Column id="custHpNo" type="STRING" size="255"/>
          <Column id="poNoYn" type="STRING" size="255"/>
          <Column id="valUnsYn" type="STRING" size="255"/>
          <Column id="valStpYn" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : OrderDecision
  파 일 명 : OrderDecision.xfdl
  기    능 : 주문을 선택해서 결의한다.

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2014.11.01   김윤기   최초 생성
  2015.11.30   최성연   불용, 중지, 0단가 체크 추가 
  2016.01.11   최성연   센터코드 다중 처리
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "U_lib::lib_conversionCom.xjs";


/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();
var sRow = -1;	//상세 조회 선택 row
var fv_processCnt = 0;			//처리건수

var fv_errorFlag;				//에러발생 여부(Y/N)
var fv_errorMsg;				//에러발생 메시지

// 체크관련 변수
var fv_saveRowCnt;				//체크대상 Row Count
var fv_saveRow;					//체크대상 Row Index
var fv_row;						//체크대상 Row ID
var fv_poNoYn;					//리턴:0단가여부
var fv_valUnsYn;				//리턴:불용자재여부
var fv_valStpYn;				//리턴:중지자재여부

var Txtselect = true;

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	//공통 버튼 제어.
	div_cmnBtn.btn_save.text ="결의";
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	ds_search.addRow();
	
	ds_search.setColumn(0,"schDate1",gfn_addDate(gfn_today(),1));
	ds_search.setColumn(0,"schDate2",gfn_addDate(gfn_today(),1));
	
	cal_fromDate.fn_initMonthCal(this, "", "", ds_search, "schDate1", "Y");
	cal_toDate.fn_initMonthCal(this, "", "", ds_search, "schDate2", "Y");	
	cbo_upjangGbn.index = 0;//[PJT]주문채널통합
	
	v_ds_check = "ds_list";
	
	
	fn_searchType();
	fn_searchCenter();
	
	
	fn_comCode("ds_status","FM0037");//상태값 조회
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{	
//	// v_ds_check 미사용시 변경사항 체크(입력 프로그램일때 변경되는 Dataset 전체 기술)
// 	if (gfn_dsIsUpdated(ds_list) == true) 
// 	{
// 		// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
//         if (!gfn_confirm("confirm.before.movepage")) return false;
//     }
//     
//	// 조회프로그램에도 Return true; 기술해 주세요!
// 	return true;

	// v_ds_check 사용시 변경사항 체크
	if(gfn_length(v_ds_check) != 0)
	{	
		// v_ds_check 설정기준 변경사항 체크
		if (gfn_isDataChange() == true) 
		{		
			// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
			if (!gfn_confirm("confirm.before.movepage")) return false;
		}
	}
    
	// 조회프로그램에도 Return true; 기술해 주세요!
	return true;
}


/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
// 	// v_ds_check 미사용시 변경사항 체크
// 	if (gfn_dsIsUpdated(ds_list) == true) 
// 	{
// 		var retValue = gfn_confirm("confirm.before.search");	// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
// 		if (retValue == false) return;
// 	}

// 	// v_ds_check 사용시 공통버튼에서 변경사항 체크함
// 	// 변경사항 체크
// 	if (gfn_isDataChange() == true) 
// 	{		
// 		var retValue = gfn_confirm("confirm.before.search");	// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
// 		if (retValue == false) return;
// 	}
	div_Date.visible = false;
	ds_sub.clearData();
	Static37.text = "주문내역";
	// ds_listValid Dataset에 Validation할 칼럼별로 구성
	// 항목 추가시에는 ','로 구분
	// 예)title:금액1,required:false,minlength:2,digits:true
	
	// Alert시 칼럼 표시 명칭               - title:아이디(메시지의 치환할 명칭) 
	// 필수체크                              - required:true(체크여부 true/false)
	// size 크기                              - length:7(size 숫자)
	// 최대 size 크기                        - maxlength:7(size 숫자)
	// 최소 size 크기                        - minlength:7(size 숫자)
	// 최대 size 크기(Byte)                  - maxlengthB:7(size 숫자)
	// 최소 size 크기(Byte)                  - minlengthB:7(size 숫자)
	// 숫자 여부                             - digits:true(체크여부 true/false)
	// 해당 숫자 이하                       - min:7(size 숫자)
	// 해당 숫자 이상                       - max:7(size 숫자)
	// 소숫점 자리수 비교                   - declimit:3(size 숫자)
	// 날짜 년월일 체크                     - date:true(체크여부 true/false)
	// 날짜 년월 체크                       - dateym:true(체크여부 true/false)
	// 타 칼럼값보다 큰지 비교             - comparemax:Column4(Dataset 칼럼ID):시작일(비교대상의 메시지 치환할 명칭)
	// 타 칼럼값보다 작은지 비교           - comparemin:Column6(Dataset 칼럼ID):종료일(비교대상의 메시지 치환할 명칭)
	// 타 칼럼값과 같은 값인지 비교        - equalto:Column5(Dataset 칼럼ID):금액1(비교대상의 메시지 치환할 명칭)
	// 사이의 값인지 비교                   - range:40(from 숫자):100(to 숫자)
	// 코드값이 목록내의 값인지 비교       - code:1(목록 숫자):2(목록 숫자):3(목록 숫자)
	// 이메일 여부 체크(함수 체크시 예제)  - isEmail:true(체크여부 true/false)
	
	// 오류시 focus 지정                      - focus:cal_toDate(Componet ID로 form에서부터의 경로)
	
	// 조회시 Validation Check
	//if (gfn_validCheck(ds_search, ds_searchValid, true) == false) return;

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_list);

    var strSvcID    = "search";
    var strURL      = "fm/fmo/orderDecision/selectList.xdo";
    var strInDs     = "ds_search=ds_search";
// [속도개선 Project 시작] 2017. 7. 20. 최범주 주문결의 반려 시 CS담당자 연락처로 송신자번호 셋팅
    var strOutDs    = "ds_list=ds_list";
        strOutDs   += " ds_retnList=ds_list";
// [속도개선 Project   끝] 2017. 7. 20. 최범주
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{	

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *             결의체크 없이 결의 진행함(2015-11-30 이전)
 *---------------------------------------------------------------------------------------------*/
function fn_save_old()
{

	div_Date.visible = false;
	if(ds_list.getRowCount() == 0){
		gfn_alert("결의할 데이터가 없습니다.");
		return;
	}
	
	if(ds_list.findRow("chk" , 1) == -1){
		gfn_alert("결의할 항목을 선택해 주세요.");	// 변경된 내역이 없습니다.
		return;
	}
	
	var schSave = "";
	for(var i=0; i < ds_list.getRowCount();i++){
		if(ds_list.getColumn(i,"chk") == 1){
			schSave += ","+ds_list.getColumn(i,"prNum");
		}
	}
	
	ds_search.setColumn(ds_search.rowposition,"listPrNum",schSave.substr(1,schSave.length));
	
	if(gfn_confirm("결의 하시겠습니까?")){
		var strSvcID    = "save";
		var strURL      = "fm/fmo/orderDecision/saveResol.xdo";
		var strInDs     = "ds_list=ds_list:U";
		var strOutDs    = "";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}
/*
	var strSvcID    = "savechk";
	var strURL      = "fm/fmo/orderDecision/savechk.xdo";
	var strInDs     = "ds_search=ds_search:A";
	var strOutDs    = "ds_listflag=ds_listflag";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
*/
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 * 결의 시 결의체크하여 정상적인 신청건에 대해서만 결의를 진행한다.(2015-11-30)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
	/*시스템 통제 시간 체크 - 특정일자에 사용을 할 수 없게 한다.*/
	mfn_GetSystemWorkCheck("PO");
	if (ds_common.getColumn(0, 0) == "Y")
	{
		g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
		return false; 
	}

	div_Date.visible = false;
	if(ds_list.getRowCount() == 0){
		gfn_alert("결의할 데이터가 없습니다.");
		return;
	}
	
	if(ds_list.findRow("chk" , 1) == -1){
		gfn_alert("결의할 항목을 선택해 주세요.");	// 변경된 내역이 없습니다.
		return;
	}
	
	var sMsg = "자재별 0단가, 불용, 중지자재 여부를 체크합니다.\n계속 진행 하시겠습니까?\n\n";
		sMsg = sMsg + "※ 체크 후 정상적인 자료에 대해 결의를 진행합니다.";
	if (!gfn_confirm(sMsg, "", "C")) return;

	// 체크 프로세스 시작
	fn_processSet();
}



/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
	
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
	
	var arrHeadChk = [1];	// 마감,취소
	for ( var i=0; i<=arrHeadChk.length; i++ ) {
		if ( grd_sub.getCellProperty("head", arrHeadChk[i], "text") == "1" ) {
			grd_sub.setCellProperty("head", arrHeadChk[i], "text", "0");
		}
	}
	
	if ( btn_SELECT.text == "선택취소" ) {
		btn_SELECT.text = "선택";
		Txtselect = true;
	}
		
    switch(strSvcID)
    {
		// 코드분류 조회
        case "search" :
            //trace(ds_list.saveXML());
            break;
            //구매유형정보
        case "searchType" :
            fn_type_init();
            break;            
            
        case "searchDetail" :
// [속도개선 Project 시작] 2017. 7. 20. 최범주 주문결의 반려 시 CS담당자 연락처로 송신자번호 셋팅
            Static37.text = "주문내역 : "+ds_sub.getRowCount()+"건";
//             ds_sub.addColumn("BigDecimal","saleAmt");
            
            //SMS전송을 위한 라인별로 해당업장의 CS의 HP번호 셋팅
//             trace(ds_sub.getRowCount());
//             
//             for(var i=0; i<ds_sub.getRowCount(); i++)
//             {
// 				ds_sub.setColumn(i,"csHp",ds_list.getColumn(ds_list.rowposition,"csHp"));
//             }
//             
//             trace(ds_sub.saveXML());
//             trace(ds_list.getColumn(ds_list.rowposition,"csHp"));
// [속도개선 Project   끝] 2017. 7. 20. 최범주
            break;            
		// 센터 조회
        case "searchCenter" :
            //trace(ds_center.saveXML());
            fn_center_init();
            break;                        
        //subSave
        
        
        // 결의 체크
        case "checkList" :
            if (ds_return.getRowCount() == 0) {
				//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				gfn_loadDatasetInfo (ds_return, fv_objColInfo);
            }
			fn_processStep();
            break;    
        
        case "subSave" :
			if(fv_errorFlag == 'Y'){				//에러발생 여부(Y/N)
				gfn_alert(fv_errorMsg);				//에러발생 메시지
				fv_errorFlag = "";
			}else{
				gfn_alert("msg.save.success");	// 저장 되었습니다.
				//fn_search();
				fn_searchDetail();
			}
            break;    
                  
		//subRemSave
        case "subRemSave" :
			if (fv_processCnt > 0) {
				gfn_alert("msg.save.success");	// 저장 되었습니다.
				//fn_search();
				fn_searchDetail();
			}
            break;    

        case "subRemSave2" :
			if(fv_errorFlag == 'Y'){				//에러발생 여부(Y/N)
				gfn_alert(fv_errorMsg);				//에러발생 메시지
				fv_errorFlag = "";
			}else{
				gfn_alert("msg.save.success");	// 저장 되었습니다.
				//fn_search();
				fn_searchDetail();
			}
            break;    
		
                  
        // 저장(결의)
        case "save" :
			gfn_alert("msg.save.success");	// 저장 되었습니다.
			fn_search();
            break;    
        case "needUpdate" :
			if(fv_errorFlag == 'Y'){				//에러발생 여부(Y/N)
				gfn_alert(fv_errorMsg);				//에러발생 메시지
				fv_errorFlag = "";
			}else{        
				gfn_alert("msg.action.success");	//처리 되었습니다.
				div_Date.cal_needDate.value = "";
				div_Date.edt_remark.value = "";
				div_Date.visible = false;
				ds_Srow.clearData();
				//fn_search();
				fn_searchDetail();
			}
            break;      
		case "returnList" :
			if(fv_errorFlag == 'Y'){				//에러발생 여부(Y/N)
				gfn_alert(fv_errorMsg);				//에러발생 메시지
				fv_errorFlag = "";
			}else{
				gfn_alert("msg.action.success");	//처리 되었습니다.
				div_return.edt_return_remark.value = "";
				div_return.visible = false;
				fn_search();
			}
            break;  
		case "returnSub" :
			if(fv_errorFlag == 'Y'){				//에러발생 여부(Y/N)
				gfn_alert(fv_errorMsg);				//에러발생 메시지
				fv_errorFlag = "";
			}else{
				gfn_alert("msg.action.success");	//처리 되었습니다.
				div_sub_return.edt_return_remark.value = "";
				div_sub_return.visible = false;
				fn_search();
				//fn_searchDetail();
			}
            break;                  
                             
            
        case "searchItemFlag" :
			fn_itemflag();
            break;        
		// 코드분류 조회
        case "status" :
			//상태 콤보 박스 초기화
            ds_status.filter("code == '001'");
            ds_status.insertRow(0);
            ds_status.setColumn(0,"codeName", "전체");
            ds_status.setColumn(0,"code", "");
            cbo_status.index = ds_status.findRow("code","001");
            break;  
        // 여신정보 SELECT : 저장 시
		case "searchCreInfoSave" :						
            if (ds_creInfo.getRowCount() == 0) {
				//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				gfn_loadDatasetInfo (ds_creInfo, fv_objColInfo);
            }
            // 여신정보 SET
            fn_setCrdInfoSave();
            break;                                   
		// 주문통제일자 CHECK
		case "searchOrdCtrlDays" :
			trace("조회건수 : " + fv_processCnt);
			if (fv_processCnt > 0) fv_needFlag = true;
			else fv_needFlag = false;
			// 주문통제 다음 CHECK
			//fn_prCheck2();
			break;	        
		case "savechk" :
			fn_savechk();
			break;
    }
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/

function fn_savechk(){
	var sMsg = "";
	if(ds_listflag.getRowCount() > 0){
		for(var i=0; i < ds_listflag.getRowCount();i++){
					// Dataset이 선택된 것만 CHECK
			// 구매수발주 제한
			/*
			if (ds_listflag.getColumn(i, "poStatus") != "HK") {
				var fRow = ds_list.findRow("prNum",ds_listflag.getColumn(i,"prNum"));
				sMsg = "주문신청번호 : " + ds_list.getColumn(fRow , "prNum") + "\n";
				sMsg = sMsg + ds_listflag.getColumn(i,"poMsg")+"\n";
				sMsg = sMsg + "- 자재명 : (" + ds_listflag.getColumn(i, "itemCode") + ")" + ds_listflag.getColumn(i, "itemName") + "\n"; 
				gfn_alert(sMsg, "", "A");
				ds_list.rowposition = fRow;	// MultiRow 일 경우 rowposition 사용 X
				return;
			}

			// 식재수발주 제한
			if (ds_listflag.getColumn(i, "fmpStatus") != "N") {
				var fRow = ds_list.findRow("prNum",ds_listflag.getColumn(i,"prNum"));
				sMsg = "주문신청번호 : " + ds_list.getColumn(fRow , "prNum") + "\n";
				sMsg = sMsg +"식재 수발주 제한 대상입니다.\n\n";
				sMsg = sMsg + "- 자재명 : (" + ds_listflag.getColumn(i, "itemCode") + ")" + ds_listflag.getColumn(i, "itemName") + "\n"; 
				gfn_alert(sMsg, "", "A");
				ds_list.rowposition = fRow;	// MultiRow 일 경우 rowposition 사용 X
				return;
			}
		

			// 구매0단가 제한
			if (ds_listflag.getColumn(i, "poNoStatus") != "N") {
				var fRow = ds_list.findRow("prNum",ds_listflag.getColumn(i,"prNum"));
				sMsg = "주문신청번호 : " + ds_list.getColumn(fRow , "prNum") + "\n";
				sMsg = sMsg +"구매 계약단가 정보가 존재하지 않습니다.\n\n";
				sMsg = sMsg + "- 자재명 : (" + ds_listflag.getColumn(i, "itemCode") + ")" + ds_listflag.getColumn(i, "itemName") + "\n"; 
				gfn_alert(sMsg, "", "A");
				ds_list.rowposition = fRow;	// MultiRow 일 경우 rowposition 사용 X
				return;
			}
			*/
		}
	}
	
	if(gfn_confirm("결의 하시겠습니까?")){
		var strSvcID    = "save";
		var strURL      = "fm/fmo/orderDecision/saveResol.xdo";
		var strInDs     = "ds_list=ds_list:U";
		var strOutDs    = "";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 상태 콤보 박스 조회
 *---------------------------------------------------------------------------------------------*/
function fn_comCode(dataset,type){
		gfn_transaction(this
						,"status"
						,"sm/cmn/common/selectComCode.xdo"
						,""
						,dataset+"=ds_combo"
						,"groupCode="+wrapQuote(type)+" useYn=Y"
						,"fn_callBack"
						,false);
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 센터정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchCenter()
{
    var strSvcID    = "searchCenter";
    var strURL      = "fm/fms/upriceContractUpjangSet/selectCenter.xdo";
    var strInDs     = "";
    var strOutDs    = "ds_center=ds_center";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 구매유형정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchType()
{
    var strSvcID    = "searchType";
    var strURL      = "fm/fmo/orderRequest/selectType.xdo";
    var strInDs     = "";
    var strOutDs    = "ds_type=ds_type";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 구매유형 COMBO 초기화 
 *---------------------------------------------------------------------------------------------*/
function fn_type_init()
{
	var defVal = "";
	//ds_type.filter("poType == '07'");
	ds_type.insertRow(0);
	ds_type.setColumn(0,"typeName","전체");
	ds_type.setColumn(0,"poType","");
	cbo_type.index = 1;
	//cbo_type.enable = false;
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 센터 COMBO 초기화 
 *---------------------------------------------------------------------------------------------*/
function fn_center_init()
{
	var defVal = "";
	var defValNm = "";
	ds_center.filter("centerCode != '*'");
	// COMBO 에 첫번째 Row에 기본값을 SET
	if (ds_center.getRowCount() > 0) {
		defVal = ds_center.getColumn(0, "centerCode");
		defValNm = ds_center.getColumn(0, "centerName");
	}
	cbo_centerCode.value = defVal;
	
	// 센터코드 다중 COMP SET
	edt_centerCode.value = defValNm;
	edt_centerCode.userdata = defVal;
	ds_search.setColumn(0, "schCode", defVal);	
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 선택한 구매신청서의 상세정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchDetail()
{
	// 선택한 ROW 여부 CHECK
	if(ds_list.rowposition == -1) 
	{
		gfn_alert("msg.noselect", "주문신청정보");	// 주문신청정보를 선택해 주십시오.
		return;
	}
	
	// 조건 SET : 선택한 구매신청번호
	ds_search.setColumn(ds_search.rowposition, "schPrNum", ds_list.getColumn(sRow, "prNum"));	// 구매신청번호
	ds_search.setColumn(ds_search.rowposition, "schSubStatus", ds_list.getColumn(sRow, "soStatus"));	// 구매신청번호
	ds_search.setColumn(ds_search.rowposition, "schCustcd", ds_list.getColumn(sRow, "custcd"));	// 업체 고객사
	ds_search.setColumn(ds_search.rowposition, "schRcUpjang", ds_list.getColumn(sRow, "rcUpjang"));	// 업장 사업장
	
	ds_search.setColumn(ds_search.rowposition, "schUpjang", ds_list.getColumn(sRow, "rcUpjang"));	// 업장 사업장
	ds_search.setColumn(ds_search.rowposition, "schMainUpjang", ds_list.getColumn(sRow, "mainUpjang"));	// 메인 사업장
	ds_search.setColumn(ds_search.rowposition, "schNeedDate", ds_list.getColumn(sRow, "needDate"));	// 메인 사업장
	ds_search.setColumn(ds_search.rowposition, "schHeadCreditYn", ds_list.getColumn(sRow, "headCreditYn"));	// 통합관리여부
    // Grid sort 표시 초기화(필수)
    //gfn_clearSortMark(ds_sub);
    
    //gfn_alert(ds_search.saveXML());

   	//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장 
	//fv_objColInfo = gfn_getDatasetInfo (ds_sub);

    var strSvcID    = "searchDetail";
    var strURL      = "fm/fmo/orderDecision/selectSub.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_sub=ds_sub";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 선택한 구매신청서의 상세정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_SubSave()
{
	// Grid sort 표시 초기화(필수)
    //gfn_clearSortMark(ds_sub);
 // v_ds_check 미사용시 변경사항 체크
 	if (gfn_dsIsUpdated(ds_sub) == false)
 	{
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}
   	//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장 
	//fv_objColInfo = gfn_getDatasetInfo (ds_sub);

    var strSvcID    = "subSave";
    var strURL      = "fm/fmo/orderDecision/saveList.xdo";
    var strInDs     = "ds_sub=ds_sub:U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 상단 리스트 주문건 반려
 *---------------------------------------------------------------------------------------------*/
function fn_Listreturn()
{
	if (gfn_dsIsUpdated(ds_list) == false)
 	{
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}
	if(ds_list.findRow("chk" , 1) == -1){
		gfn_alert("반려할 항목을 선택해 주세요.");	// 변경된 내역이 없습니다.
		return;
	}
	if(div_return.edt_return_remark.text == ""){
		gfn_alert("반려사유를 입력해 주세요.");
		return;
	}
	for(var i=0; i < ds_list.getRowCount();i++){
		if(ds_list.getColumn(i,"chk") == 1){
			if(ds_list.getColumn(i, "soStatus") == "005"){
				gfn_alert("결의반려건은 반려할 수 없습니다.");
				ds_list.setColumn(i,"chk", 0);
				return;
			}
			ds_list.setColumn(i,"remark" , div_return.edt_return_remark.text);
		}
	}
 	if(!gfn_confirm("선택된 항목을 반려 처리 하시겠습니까?"))return;
   	
// [속도개선 Project 시작] 2017. 7. 20. 최범주 주문결의 반려 시 CS담당자 연락처로 송신자번호 셋팅
	///////////////////////////////////////////////////////////////////////////////////////
	// 주문목록중 선택건 데이터셋 복사
	ds_retnList.clearData();
	var iRow = 0;
	for ( var jRow = 0; jRow < ds_list.getRowCount(); jRow++ ) {
		if ( ds_list.getColumn(jRow,"chk") == 1 ) {
			iRow = ds_retnList.addRow();
			ds_retnList.copyRow(iRow, ds_list, jRow);
		}
	}

    var strSvcID    = "returnList";
    var strURL      = "fm/fmo/orderDecision/returnList.xdo";
    var strInDs     = "ds_list=ds_list:U";
        strInDs    += " ds_retnList=ds_retnList:A";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
// [속도개선 Project   끝] 2017. 7. 20. 최범주
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 하단 리스트 주문건 반려
 *---------------------------------------------------------------------------------------------*/
function fn_Subreturn()
{
	if (gfn_dsIsUpdated(ds_sub) == false)
 	{
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}
	if(ds_sub.findRow("chk" , 1) == -1){
		gfn_alert("반려할 항목을 선택해 주세요.");	// 변경된 내역이 없습니다.
		return;
	}
	if(div_sub_return.edt_return_remark.text == ""){
		gfn_alert("반려사유를 입력해 주세요.");
		return;
	}
	for(var i=0; i < ds_sub.getRowCount();i++){
		if(ds_sub.getColumn(i,"chk") == 1){
			if(ds_sub.getColumn(i, "soStatus") == "005"){
				gfn_alert("결의반려건은 반려할 수 없습니다.");
				ds_sub.setColumn(i,"chk", 0);
				return;
			}
			ds_sub.setColumn(i,"remark" , div_sub_return.edt_return_remark.text);
		}
	}
 	if(!gfn_confirm("선택된 항목을 반려 처리 하시겠습니까?"))return;

// [속도개선 Project 시작] 2017. 7. 20. 최범주 주문결의 반려 시 CS담당자 연락처로 송신자번호 셋팅
	///////////////////////////////////////////////////////////////////////////////////////
	// 주문목록중 선택건 데이터셋 복사
	ds_retnList.clearData();
	var iRow = ds_retnList.addRow();
	ds_retnList.copyRow(iRow, ds_list, ds_list.rowposition);
	
    var strSvcID    = "returnSub";
    var strURL      = "fm/fmo/orderDecision/returnSub.xdo";
    var strInDs     = "ds_sub=ds_sub:U";
        strInDs    += " ds_retnList=ds_retnList:A";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
// [속도개선 Project   끝] 2017. 7. 20. 최범주
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 상품별 D-DAY CHECK FUNCTION
 *---------------------------------------------------------------------------------------------*/
function fn_getDayStatus(nDdays, nDtimes , sNeedDate)
{
	fsp_init(this);			// 고도화관련 Frame 관련 SET

	fn_CurrDateWeek();
	
	var sNeedDate = div_Date.cal_needDate.text;		// 입고일자
	
	if (gfn_length(nDtimes)==2) nDtimes = nDtimes + "00";
	
	//무통제면 패스...
	if (gfn_nvl(nDdays, "0")== "0" ) return "2";
	//디데이체크
	if (gfn_addDate(gds_currdate.getColumn(0,"YMD"),nDdays) > sNeedDate )
		return "0";
	else if ( gfn_addDate(gds_currdate.getColumn(0,"YMD"),nDdays) == sNeedDate )
	{
		
		if(nDtimes == "0000") return "2";
		//디타임체크
		if ( gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4)> nDtimes )
			return "0";
		else if ( G_fn_GapTime(0, gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4), nDtimes, "") <= "0030" )
			return "1";
		else
			return "2";
	}
	else
		return "2";
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 자재별 저장 관련 CHECK
 *---------------------------------------------------------------------------------------------*/
function fn_itemCheck()
{
	var nRowCnt = ds_sub.getRowCount();	// DataSet Count
	var v_itemCode = "";
	var sMsg = "";
	
	for (var i = 0 ; i < nRowCnt ; i++)
	{
			
		// 통제가 없는 자재는 제외
		if ( gfn_nvl(ds_sub.getColumn(i,"dDays"), "0")== "0" ) continue;
		if (ds_sub.getColumn(i,"poType") == "07"){
			// D-DAY, D_TIME CHECK   //2015-10-20 제거후 다시 추가 PM
			if (fn_getDayStatus(ds_sub.getColumn(i,"dDays"), ds_sub.getColumn(i,"dTimes"), ds_sub.getColumn(i,"needDate")) == "0")
			{
				ds_sub.rowposition = i;
				sMsg = "[" + ds_sub.getColumn(i,"itemName") + "] 자재는 마감시간(D-Days)을 초과하여 주문이 불가합니다.";
				gfn_alert(sMsg, "", "A");
				return false;
			}
		}
		/* 2015-10-22 PM
		if (ds_sub.getColumn(i,"poType") == "29"){
			// D-DAY, D_TIME CHECK   //2015-10-20 제거후 다시 추가 PM
			if (fn_getDayStatus(ds_sub.getColumn(i,"dDays"), "00", ds_sub.getColumn(i,"needDate")) == "0")
			{
				ds_sub.rowposition = i;
				sMsg = "[" + ds_sub.getColumn(i,"itemName") + "] 자재는 마감시간(D-Days)을 초과하여 주문이 불가합니다.";
				gfn_alert(sMsg, "", "A");
				return false;
			}
		}
		*/

		// 동일한 상품에 대한 최대발주량 CHECK
		if ((ds_sub.getColumn(i,"maxOrdQty") > 0) && ( ds_sub.getCaseSum("itemCode=='"+ds_sub.getColumn(i,"itemCode")+"'&& (soStatus <> '005' && soStatus <> '003') && DOCU_SOURCE <> '01 BO'","PR_QTY") > ds_sub.getColumn(i,"maxOrdQty")))  
		{   
       	    ds_sub.rowposition = i;
			sMsg = "[" + ds_sub.getColumn(i,"itemName") + "] 자재는 최대 결의량" + ds_sub.getColumn(i,"maxOrdQty") + ")를 초과하여 주문이 불가합니다.";
			gfn_alert(sMsg, "", "A");
			return false;
		}		
	}	
	return true;
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 여신정보 조회 (저장용)
 * fn_getCrdInfo 동일
 *---------------------------------------------------------------------------------------------*/
function fn_getCrdInfoSave()
{
   	//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장 
	fv_objColInfo = gfn_getDatasetInfo (ds_creInfo);
    
    // 여신정보 조회
    var strSvcID    = "searchCreInfoSave";
    var strURL      = "fm/fmo/orderRequest/selectCreInfo.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_creInfo=ds_creInfo";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 여신정보를 조회한다 (저장용)
 * fn_setCrdInfo 동일
 *---------------------------------------------------------------------------------------------*/
function fn_setCrdInfoSave()
{
	//trace(ds_creInfo.saveXML());
	
	//여신 표시
	if (ds_creInfo.getRowCount() > 0) {
		if (ds_creInfo.getColumn(ds_creInfo.rowposition,"creditAmountControlYn") == "Y") {
			ed_credit.value = gfn_numFormat(ds_creInfo.getColumn(ds_creInfo.rowposition,"creditRmnAmt"))+ " 원";
			ed_bond.value = gfn_numFormat(ds_creInfo.getColumn(ds_creInfo.rowposition,"bondAmt"))+ " 원";
		} else {
			ed_credit.value = "무 제 한";
		}
	} else {
		var sMsg = "업장여신정보를 확인할 수 없습니다.\n\n";
		sMsg = sMsg + "관리자에게 문의하세요.";
		gfn_alert(sMsg, "", "A");
		return;
	}

	// 여신한도관련 CHECK :  저장 호출
	fn_crdCheck();
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 여신한도 관련 CHECK
 *---------------------------------------------------------------------------------------------*/
function fn_crdCheck()
{
	var sMsg = "";
	
	if (ds_creInfo.rowcount > 0)
	{
		//여신금액
		if (ds_creInfo.getColumn(0,"creditAmountControlYn") == "Y")
		{
			var nAmt = 0;
			for (i = 0; i < ds_sub.getRowCount(); i++){
				nAmt += (Math.round(ds_sub.getColumn(i,"saleAmt"),1.1,1) - Math.round(ds_sub.getColumn(i,"noSaleAmt"),1.1,1));
			}
						

			if (nAmt > toNumber(ds_creInfo.getColumn(0,"creditAvailAmt")))
			{
				sMsg = "주문가능한 여신한도를 초과하여 주문이 불가합니다.\n\n";
				sMsg = sMsg + " - 여신한도 : " + gfn_numFormat(ds_creInfo.getColumn(0,"creditAvailAmt")) + "\n";
				sMsg = sMsg + " - 주문금액(합계) : " + gfn_numFormat(nAmt) + "\n";
				gfn_alert(sMsg, "", "A");
				return;
			}
		}
		//여신회전일
		if (ds_creInfo.getColumn(0,"creditTurnControlYn") == "Y")
		{
			if (toNumber(ds_creInfo.getColumn(0,"lastTurnCnt")) >= 0)
			{
				if (toNumber(ds_creInfo.getColumn(0,"lastTurnCnt")) > toNumber(ds_creInfo.getColumn(0,"creditTurnDaysTot")))
				{
					sMsg = gfn_getFormat(ds_creInfo.getColumn(0,"lBillDate"), "@@@@-@@-@@")  + "에 매출채권이 존재하여 주문이 불가합니다.";
					gfn_alert(sMsg, "", "A");
					return;
				}
			}
		}
	}
	
	// 정상적인 Save 호출
	fn_SubSave();
}
/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Grid 더블클릭시 결의 상세 조회
 *---------------------------------------------------------------------------------------------*/
function grd_list_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	if(e.row < -1) return;
// 	edt_PoNum.value = ds_list.getColumn(e.row, "prNum");
// 	edt_PoType.value = ds_list.getColumn(e.row, "typeName");
// 	edt_remark.value = ds_list.getColumn(e.row, "itemName");
// 	mak_Amt.value = ds_list.getColumn(e.row, "itemAmt");
// 	sRow = e.row;
	
	fn_searchDetail();
	// 주문통제정보 조회
	fn_getOrdCtrl();
	// 창고리스트 조회 : 단일건에 대한 창고정보 조회용도로 변경
	fn_searchSubinv();
	
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 결의상세를 저장한다.
 *---------------------------------------------------------------------------------------------*/
function btn_Save_onclick(obj:Button,  e:ClickEventInfo)
{
	/*시스템 통제 시간 체크 - 특정일자에 사용을 할 수 없게 한다.*/
	mfn_GetSystemWorkCheck("PO");
	if (ds_common.getColumn(0, 0) == "Y")
	{
		g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
		return false; 
	}

	if(ds_sub.getRowCount() == 0){
		gfn_alert("데이터가 없습니다.");
		return;
	
	}
	fn_getCrdInfoSave();
	//fn_SubSave();
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 취소버튼 클릭. 반려를 한다.
 *---------------------------------------------------------------------------------------------*/
function btn_return_onclick(obj:Button,  e:ClickEventInfo)
{
	/*시스템 통제 시간 체크 - 특정일자에 사용을 할 수 없게 한다.*/
	mfn_GetSystemWorkCheck("PO");
	if (ds_common.getColumn(0, 0) == "Y")
	{
		g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
		return false; 
	}
	
	if(ds_list.findRow("chk" , 1) == -1){
		gfn_alert("반려할 항목을 선택해 주세요.");	// 변경된 내역이 없습니다.
		return;
	}

	div_return.position.left = btn_return.position.right - 441;
	div_return.position.width = 441;
	div_return.visible = !div_return.visible;
	//fn_Subreturn();
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 주문상세에 발주량 변경시 자재별 최대 주문 수량 최소 주문 수량체크.
 *---------------------------------------------------------------------------------------------*/
function ds_sub_cancolumnchange(obj:Dataset, e:DSColChangeEventInfo)
{
	// 발주량 0 CHECK
	// - 불가
	if(e.columnid == "poQty"){
		sMsg = "주문수량이 0입니다.";
		
		// 신청수량 < 발주수량 CHECK	
		//  2015-07-17 신청수량 보다 높게 발주 할 수 있음. ( 2015-07-20 ) 다시 막음 . 구매에서 불가.
		if ( (toNumber(obj.getColumn(e.row,"prQty")) < toNumber(e.newvalue)) )
		{
			sMsg = "신청수량을 초과하여 발주할 수 없습니다.";
			gfn_alert(sMsg, "", "A");
			return false;
		}
		
		
		//최소발주량 체크
		/*
		if ( (toNumber(obj.getColumn(e.row,"minOrdQty")) > 0) && (toNumber(obj.getColumn(e.row,"minOrdQty")) > toNumber(e.newvalue)) )
		{
			sMsg = "해당 자재는 최소결의량이 " + obj.getColumn(e.row,"minOrdQty") + " 입니다.";
			gfn_alert(sMsg, "", "A");
			return false;
		}
		*/
		//최대발주량 체크
		if ( (toNumber(obj.getColumn(e.row,"maxOrdQty")) > 0) && (toNumber(obj.getColumn(e.row,"maxOrdQty")) < toNumber(e.newvalue)) )
		{
			sMsg = "해당 자재는 최대결의량이 " + obj.getColumn(e.row,"maxOrdQty") + " 입니다.";
			gfn_alert(sMsg, "", "A");
			return false;
		}
		//소숫점발주여부
		/*	2015-10-02 제거
		if ( (obj.getColumn(e.row,"pointFlag") != "Y") && (Math.ceil(toNumber(e.newvalue)) != toNumber(e.newvalue)) )
		{
			sMsg = "해당 자재는 소숫점 결의가 불가합니다.";
			gfn_alert(sMsg, "", "A");
			return false;
		}
		*/
		//발주승수량	2015-09-21 제거
		/*
		if ( (toNumber(obj.getColumn(e.row,"multiplierQty")) > 0) && ((Math.round(toNumber(e.newvalue) * 1000) % Math.round(toNumber(obj.getColumn(e.row,"multiplierQty")) * 1000)) <> 0) )
		{
			sMsg = "해당 자재는 결의승수량이 " + obj.getColumn(e.row,"multiplierQty") + " 입니다.";
			gfn_alert(sMsg, "", "A");
			return false;
		}
		*/

	}
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 입고일자 변경에 취소 버튼 클릭. 창닫기.
 *---------------------------------------------------------------------------------------------*/
function div_Date_btn_Close_onclick(obj:Button,  e:ClickEventInfo)
{
	div_Date.cal_needDate.value = "";
	div_Date.edt_remark.value = "";
	div_Date.visible = false;
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 입고일자 변경 - 저장 버튼 클릭.
 *---------------------------------------------------------------------------------------------*/
function btn_chNeedDate_onclick(obj:Button,  e:ClickEventInfo)
{
	/*시스템 통제 시간 체크 - 특정일자에 사용을 할 수 없게 한다.*/
	mfn_GetSystemWorkCheck("PO");
	if (ds_common.getColumn(0, 0) == "Y")
	{
		g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
		return false; 
	}
	
	var forCnt = 0; //입고일 변경 가능 한건 체크
	for(var i=0; i < ds_sub.getRowCount();i++){
		if(ds_sub.getColumn(i, "poLineStatusNm") == "발주완료"){
			forCnt ++;
		}
	}
	if(forCnt == 0){
		gfn_alert("발주완료건만 입고일 변경이 가능합니다.");
		return;
	}
	
	fsp_init(this);			// 고도화관련 Frame 관련 SET
	fn_CurrDateWeek();
	var nowTime = gds_currdate.getColumn(0,"YMD_TM");
	
	/* 식재_외식 을 위한 제거 PI 2015-10-20
	if(gfn_subStr(nowTime, 8, 6) > "180000" && gv_webRoot != "http://localhost:8080/"){
		gfn_alert("18:00 이후에는 입고일 변경을 하실 수 없습니다.");
		return;
	}
	*/

	div_Date.position.top = div_center.position.top + 50;
	div_Date.position.left = div_center.btn_chNeedDate.position.right - 441;
	div_Date.position.height = 84;
	div_Date.position.width = 441;
	div_Date.visible = !div_Date.visible;
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 폼 사이즈 변경시 입고일자 변경창 이동.
 *---------------------------------------------------------------------------------------------*/
function OrderDecision_onsize(obj:Form, e:SizeEventInfo)
{
	div_Date.position.left = div_center.btn_chNeedDate.position.right - 441;
	div_Date.position.width = 441;
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 입고일자변경창에 저장 버튼 클릭. -1)
 *---------------------------------------------------------------------------------------------*/
function div_Date_btn_needDateSave_onclick(obj:Button,  e:ClickEventInfo)
{
 	
 	if(sRow == -1 || ds_sub.getRowCount() == 0){
		gfn_alert("변경할 데이터가 없습니다.");
		return;
	}
	
	
 	if(gfn_isNull(div_Date.cal_needDate.text)){
		gfn_alert("변경일을 입력해 주세요.");
		div_Date.cal_needDate.setFocus();
		return;
 	}
 	
 	if(gfn_isNull(div_Date.edt_remark.text)){
		gfn_alert("변경사유를 입력해 주세요.");
		div_Date.edt_remark.setFocus();
		return;
 	}
	
	if(!fn_prCheck1()){
		div_Date.cal_needDate.text = "";
		div_Date.cal_needDate.setFocus();
		return;
	}
 	
 	var sNeedDate = div_Date.cal_needDate.text;		// 화면에서 입력한 입고일
 	
 	var fRow = ds_type.findRow("poType" , ds_list.getColumn(sRow,"poType"));//선택한 row의 poType의 행을 찾는다.
 	
	
 	
 	// 입고일자 기준 CHECK : 구매유형별
	fn_CurrDateWeek();
	if (fn_getDayStatus(ds_type.getColumn(fRow,"dDays"), ds_type.getColumn(fRow,"dTimes"), sNeedDate) == "0")
	{
		var sDate = gds_currdate.getColumn(0, "YMD_TM");
		sDate = gfn_getFormat(gfn_subStr(sDate, 0, 8), "@@@@-@@-@@") + " " + gfn_getFormat(gfn_subStr(sDate, 8, 6), "@@:@@:@@");
	
		sMsg = "▶현재시간 : " + sDate + "\n\n";
		sMsg = sMsg + cbo_type.text + " 구매유형 입고일 기준\n";
		sMsg = sMsg + " => (D_DAY = " + ds_type.getColumn(fRow,"dDays") + "일" + ds_type.getColumn(fRow,"dTimes") + "시)\n"
		sMsg = sMsg + "※ 입고일이 " + gfn_getFormat(gfn_addDate(gds_currdate.getColumn(0,"YMD"),ds_type.getColumn(fRow,"dDays")),"@@@@-@@-@@") + " 이전 날짜로는\n";
		sMsg = sMsg + "  구매신청을 할 수 없습니다.";
		gfn_alert(sMsg, "", "A");
		return;
	}
 	
	if(!fn_itemCheck())return;
	
	ds_subflag.clearData();
	ds_search.setColumn(0,"schChgNeedDate",div_Date.cal_needDate.text);
	
	var strSvcID    = "searchItemFlag";
	var strURL      = "fm/fmo/orderDecision/selectSubFlag.xdo";
	var strInDs     = "ds_search=ds_search:A";
	var strOutDs    = "ds_subflag=ds_subflag";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = true;
		
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 발주가능 CHECK  == 1 STEP 
 *---------------------------------------------------------------------------------------------*/
function fn_prCheck1()
{
	var sMsg = "";
	
	// 창고기본값 선택 시 : 발주마감일자 GET
	// 마감시간 설정 : fn_setTimer() 포함
	//fn_getDays();

	// 주문통제일자 호출
	fn_getNeedDate(false);
	
	// 주문통제일자 CHECK
	if (fv_needFlag) {
		sMsg = "해당일자는 입고통제일 입니다.\r작업을 취소합니다.";
		gfn_alert(sMsg, "", "A");
		return false;
	}

	var sNeedDate = div_Date.cal_needDate.text;
	
	//발주통제일자
// 	if (toNumber(ds_days.getColumn(0,"dOverDays")) > 0)
// 	{
// 		if (sNeedDate > gfn_addDate(gds_currdate.getColumn(0, "YMD"),toNumber(ds_days.getColumn(0,"dOverDays"))))
// 		{
// 			sMsg = ds_days.getColumn(0,"dOverDays") + " 일을 초과하여 입고예정일을 지정할 수 없습니다.\r작업을 취소합니다.";
// 			gfn_alert(sMsg, "", "A");
// 			return false;
// 		}
// 	}
	

	//발주제한일자
// 	if (toNumber(ds_days.getColumn(0,"dDays")) > 0)
// 	{
// 		if (sNeedDate < gfn_addDate(gds_currdate.getColumn(0, "YMD"),toNumber(ds_days.getColumn(0,"dDays"))))
// 		{
// 			sMsg = "발주마감은 " + ds_days.getColumn(0,"days") + " 입니다.\r작업을 취소합니다.";
// 			gfn_alert(sMsg, "", "A");
// 			return false;
// 		}
// 		if (sNeedDate == gfn_addDate(gds_currdate.getColumn(0, "YMD"),toNumber(ds_days.getColumn(0,"dDays"))))
// 		{
// 			if (gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,6)> ds_days.getColumn(0,"dTimes"))
// 			{
// 				sMsg = "발주마감은 " + ds_days.getColumn(0,"days") + " 입니다.\r작업을 취소합니다.";
// 				gfn_alert(sMsg, "", "A");
// 				return false;
// 			}
// 		}
// 	}
	
	//창고가 식재 또는 소모품, 공통 전용창고인 경우 주문통제 점검
	if (!gfn_isNull(ds_subinv.getColumn(ds_subinv.rowposition,"consumYn")))
	{
		//주문통제(주문일자)
		var nRow;
		nRow = ds_ordCtl.findRowExpr("ctrlType=='주문'&&itemType==decode('" + ds_subinv.getColumn(ds_subinv.rowposition,"consumYn") + "','Y','소모품','식자재')");
		if (nRow >= 0)
		{
			if (ds_ordCtl.getColumn(nRow,ToLower(gds_currdate.getColumn(0, "WEEK_ENG"))) == "Y")
			{
				sMsg = gds_currdate.getColumn(0, "WEEK_KOR") + "요일은 주문불가 요일입니다.\r작업을 취소합니다.";
				gfn_alert(sMsg, "", "A");
				return false;
			}
		}
		//주문통제(입고일자)
		nRow = ds_ordCtl.findRowExpr("ctrlType=='입고'&&itemType==decode('" + ds_subinv.getColumn(ds_subinv.rowposition,"consumYn") + "','Y','소모품','식자재')");
		if (nRow >= 0)
		{
			if (ds_ordCtl.getColumn(nRow,ToLower(ffn_DayToWeek(sNeedDate,"1"))) == "Y")
			{
				sMsg = ffn_DayToWeek(sNeedDate) + "요일은 입고불가 요일입니다.\r입고예정일을 변경하세요.";
				gfn_alert(sMsg, "", "A");
				return false;
			}
		}
	} else {
		// 공통창고인 경우
		//주문통제(주문일자)
		var nRow;
		nRow = ds_ordCtl.findRowExpr("ctrlType=='주문'&&itemType=='공통'");
		if (nRow >= 0)
		{
			if (ds_ordCtl.getColumn(nRow,ToLower(gds_currdate.getColumn(0, "WEEK_ENG"))) == "Y")
			{
				sMsg = gds_currdate.getColumn(0, "WEEK_KOR") + "요일은 주문불가 요일입니다.\r작업을 취소합니다.";
				gfn_alert(sMsg, "", "A");
				return false;
			}
		}
		//주문통제(입고일자)
		nRow = ds_ordCtl.findRowExpr("ctrlType=='입고'&&itemType=='공통'");
		if (nRow >= 0)
		{
			if (ds_ordCtl.getColumn(nRow,ToLower(ffn_DayToWeek(sNeedDate,"1"))) == "Y")
			{
				sMsg = ffn_DayToWeek(sNeedDate) + "요일은 입고불가 요일입니다.\r입고예정일을 변경하세요.";
				gfn_alert(sMsg, "", "A");
				return false;
			}
		}
	}
	
	
	return true;
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 사용자에 대한 창고리스트 가져오기
 *---------------------------------------------------------------------------------------------*/
function fn_searchSubinv()
{
   	//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장 
	fv_objColInfo = gfn_getDatasetInfo (ds_subinv);
    
    ds_search.setColumn(ds_search.rowposition, "schSubinvCode", ds_list.getColumn(ds_list.rowposition, "subinvCode"));
    
    var strSvcID    = "searchSubinv";
	var strURL		= "";
	//if (fv_flag == "I")
	//	strURL      = "fm/fmo/orderRequest/selectSubinv.xdo";
	//else
		strURL      = "fm/fmo/orderRequest/selectSubinv2.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_subinv=ds_subinv";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 선택한 업장에 대한 주문통제 정보 표시
 * FMP_ORD_CTRL
 *---------------------------------------------------------------------------------------------*/
function fn_getOrdCtrl()
{
   	//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장 
	fv_objColInfo = gfn_getDatasetInfo (ds_ordCtl);


    // 주문통제 정보 GET
    var strSvcID    = "searchOrdCtrl";
    var strURL      = "fm/fmo/orderRequest/selectOrdCtrl.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_ordCtl=ds_ordCtl";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 주문통제일자 CHECK GET, FMP_ORD_CTRL_DAYS
 * 관련함수  : fn_prCheck에서 호출
 *---------------------------------------------------------------------------------------------*/
function fn_getNeedDate(bAsync)
{
	fv_needFlag = false;

    // 주문통제 CHECK
    var strSvcID    = "searchOrdCtrlDays";
    var strURL      = "fm/fmo/orderRequest/selectOrdCtrlDays.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    //var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 입고일자변경창에 저장 버튼 클릭. -2)
 *---------------------------------------------------------------------------------------------*/
function fn_itemflag(){
	//trace(ds_subflag.saveXML());
	if(ds_subflag.getRowCount() > 0){
		for(var i=0; i < ds_subflag.getRowCount();i++){
			// 1.주문통제요일 CHECK  --> 입고일자 CHECK
			if (ds_subflag.getColumn(i, "ordFlag")=="Y") 
			{
				gfn_alert("주문불가 요일("+gfn_getDayName(ds_subflag.getColumn(i, "needDate"))+") 입니다.");
				div_Date.cal_needDate.setFocus();
				return;
				
			}
			// 2.주문통제일자 CHECK   --> 입고일자 CHECK
			if (ds_subflag.getColumn(i, "ordDaysFlag")=="Y") 
			{
				gfn_alert("입고불가 일자 입니다.");
				div_Date.cal_needDate.setFocus();
				return;
			}
			//============================자재별=============================// 
			// 구매수발주제한 : HK  (제한X)   : --- fn_errorFlag
			if (ds_subflag.getColumn(i,"poStatus")!="HK") {
				sMsg = "해당 자재는 구매수발주 제한이 있습니다.\n";
				sMsg = sMsg + "- 자재명 : (" + ds_subflag.getColumn(i, "itemCode") + ")" + ds_subflag.getColumn(i, "itemName") + "\n"; 
				sMsg = sMsg + ds_subflag.getColumn(i,"poMsg");
				gfn_alert(sMsg);
				ds_sub.rowposition = i;
				return;
			} 
			// 식재수발주제한 : Y (제한)         --- fn_errorFlag
			if (ds_subflag.getColumn(i,"fmpStatus")!="N") {
				gfn_alert("해당 자재는 식재수발주 제한이 있습니다.");
				ds_sub.rowposition = i;
				return;
			}
			
			// 구매수발주제한 : FE(단가업장 수발주 스케쥴에 따른 요일 발주 제한)   : --- fn_errorFlag
			if (ds_subflag.getColumn(i,"poStatus") == "FE") {
				sMsg = "해당 자재는 구매수발주 제한이 있습니다.\n";
				sMsg = sMsg + "- 자재명 : (" + ds_subflag.getColumn(i, "itemCode") + ")" + ds_subflag.getColumn(i, "itemName") + "\n"; 
				sMsg = sMsg + ds_subflag.getColumn(i,"poMsg");
				gfn_alert(sMsg);
				ds_sub.rowposition = i;
				return;
			} 
			
			// 구매0단가 제한
			if (ds_subflag.getColumn(i, "poNoStatus") == "Y") {
				sMsg = "주문신청번호 : " + ds_subflag.getColumn(i,"prNum") + "\n";
				sMsg = sMsg +"구매 계약단가 정보가 존재하지 않습니다.\n\n";
				sMsg = sMsg + "- 자재명 : (" + ds_subflag.getColumn(i, "itemCode") + ")" + ds_subflag.getColumn(i, "itemName") + "\n"; 
				gfn_alert(sMsg, "", "A");
				ds_sub.rowposition = i;	// MultiRow 일 경우 rowposition 사용 X
				return;
			}
			
		}
	}
	fn_chgDate();//입고일자 변경 저장.
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 입고일자변경창에 저장 버튼 클릭. -3)
 *---------------------------------------------------------------------------------------------*/
function fn_chgDate(){
	ds_Srow.addRow();
	ds_Srow.setColumn(0,"chgneedDate", div_Date.cal_needDate.text);
	ds_Srow.setColumn(0,"chgRemark", div_Date.edt_remark.text);
	ds_Srow.setColumn(0,"prNum",	ds_list.getColumn(sRow,"prNum"));		
	ds_Srow.setColumn(0,"centerCode",	ds_list.getColumn(sRow,"centerCode"));
	ds_Srow.setColumn(0,"poType",	ds_list.getColumn(sRow,"poType"));
	ds_Srow.setColumn(0,"rcUpjang",	ds_list.getColumn(sRow,"rcUpjang"));
	ds_Srow.setColumn(0,"soStatus",	"001");
	ds_Srow.setColumn(0,"schDate1",	ds_search.getColumn(0,"schDate1"));
	ds_Srow.setColumn(0,"schDate2",	ds_search.getColumn(0,"schDate2"));
	ds_Srow.setColumn(0,"custcd",	ds_list.getColumn(0,"custcd"));
	ds_Srow.setColumn(0,"prSabun",	ds_list.getColumn(0,"prSabun"));
	ds_Srow.setColumn(0,"subinvCode",	ds_list.getColumn(0,"subinvCode"));



	if(!gfn_confirm("선택된 주문신청번호의 입고일을 일괄로 변경하시겠습니까?"))return;
	/*		
	if(ds_sub.findRow("chk",1) == -1){		
		
	}else{
	

		ds_sub.addColumn("chgneedDate","STRING", 256);
		ds_sub.addColumn("chgRemark","STRING", 256);
		ds_sub.addColumn("usrNm","STRING", 256);
		
		for(var i=0; i < ds_sub.getRowCount();i++){
			if(ds_sub.getColumn(i,"chk") == 1){
				ds_sub.setColumn(i,"chgneedDate", div_Date.cal_needDate.text);
				ds_sub.setColumn(i,"chgRemark", div_Date.edt_remark.text);
			}
		}
		strURL      = "fm/fmo/orderDecision/needupdate.xdo";
		strInDs     = "ds_sub=ds_sub:U";
		if(!gfn_confirm("선택된 자재의 입고일을 변경하시겠습니까?"))return;
	}
	*/
	
	var strSvcID    = "needUpdate";
	var strURL      = "fm/fmo/orderDecision/needupdateall.xdo";
	var strInDs     = "ds_Srow=ds_Srow ds_sub=ds_sub";
	var strOutDs    = "";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조정버튼 클릭시 조정 팝업.
 *---------------------------------------------------------------------------------------------*/
function btn_Edit_onclick(obj:Button,  e:ClickEventInfo)
{
	var iCnt = 0;

	/*시스템 통제 시간 체크 - 특정일자에 사용을 할 수 없게 한다.*/
	mfn_GetSystemWorkCheck("PO");
	if (ds_common.getColumn(0, 0) == "Y")
	{
		g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
		return false; 
	}
	
	var arrArg = new Array();
	arrArg[0]		= ds_search.getColumn(0,"schDate1");
	arrArg[1]		= ds_search.getColumn(0,"schDate2");
	//arrArg[2]		= ds_search.getColumn(0,"schCenter");
	arrArg[2]		= ds_search.getColumn(0,"schCode");
	arrArg[3]		= ds_search.getColumn(0,"schType");
	if(ds_list.getRowCount() > 0){		
		var prNum = "";
		for(var i=0; i < ds_list.getRowCount();i++){
			if(ds_list.getColumn(i,"chk") == 1){
				iCnt++;
				if(ds_list.getColumn(i, "soStatus") == "005"){
					gfn_alert("결의반려건은 조정할 수 없습니다.");
					return;
				}
				if(ds_list.getColumn(i, "soStatus") == "002"){
					gfn_alert("결의승인건은 조정할 수 없습니다.");
					return;
				}
				prNum = prNum + "," + ds_list.getColumn(i,"prNum");
			}
		}
		arrArg[4] = prNum.substr(1,prNum.length);
	}	
	arrArg[5]		= edt_centerCode.value;		// 센터코드 명

 	if(iCnt > 1000){
		gfn_alert("대상건수가 너무 많습니다.\n\n 1,000건 씩 처리가 가능합니다.");
		return;
 	}
		
		var strId       = "OrderRequestConfirmPop";
		var strURL      = "X_FMO::OrderRequestConfirmPop.xfdl";
		var objArgument = {arrSchVal:arrArg}; 
		var nWidth      = -1;
		var nHeight     = -1;
		var strStyle    = "";	
		var nLeft       = -1;
		var nTop        = -1;
		var isModeless  = false;
		var bShowTitle  = true;
		var strAlign    = "-1";
		var bResizable  = true;

		var rtnVal = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign , true);

		if (typeof rtnVal != "undefined" && rtnVal != null) 
		{
			if (rtnVal[0] == "OK")
			{
				fn_search();
			}
		}
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 체크박스에 체크할경우 해당행에 deptid를 넣어준다.
 *---------------------------------------------------------------------------------------------*/
function ds_list_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if(e.columnid == "chk"){
		obj.setColumn(e.row ,"poDeptId" , g_Deptid);
		/*
		ds_list.filter("chk",1);
		var chkCnt = ds_list.getRowCount();
		ds_list.filter("");
		if(chkCnt > 1000){
			for(var i=0; i < ds_list.getRowCount();i++){
			
			}
		}
		*/
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조건 Dataset 변경 시 Clear
 *---------------------------------------------------------------------------------------------*/
function ds_search_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	// 조건 변경 시 DataSet Clear	
	if (e.columnid == "schCenter" || e.columnid == "schDate1" || e.columnid == "schDate2" || e.columnid == "schType" || e.columnid == "schStatus" || e.columnid == "schCsSabun" || e.columnid == "schCode") {
		ds_list.clearData();
		ds_sub.clearData();
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조건 Dataset ROW 변경 시 
 *---------------------------------------------------------------------------------------------*/
function ds_list_onrowposchanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	div_center.edt_PoNum.value = obj.getColumn(obj.rowposition, "prNum");
	div_center.edt_PoType.value = ( obj.getColumn(obj.rowposition, "flag") > 1 ? "전체" : obj.getColumn(obj.rowposition, "typeName") );
	div_center.edt_remark.value = obj.getColumn(obj.rowposition, "itemName");
	div_center.mak_Amt.value = obj.getColumn(obj.rowposition, "itemAmt");
	sRow = obj.rowposition;
	
	// 하위상세내역은 기본적으로 Clear
	ds_sub.clearData();
	Static37.text = "주문내역";
}


function ds_list_canrowposchange(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	// v_ds_check 미사용시 변경사항 체크
 	if (gfn_dsIsUpdated(ds_sub) == true) 
 	{
 		var retValue = gfn_confirm("confirm.before.moveropos");	// 해당 row의 위치를 이동하면 변경된 데이터가 사라집니다.@계속 진행 하시겠습니까?
 		trace(retValue);
 		if (retValue == false) return false;
 	}
}

function div_return_btn_needDateSave_onclick(obj:Button,  e:ClickEventInfo)
{
	
	fn_Listreturn();
}

function btn_Return_onclick(obj:Button,  e:ClickEventInfo)
{
	/*시스템 통제 시간 체크 - 특정일자에 사용을 할 수 없게 한다.*/
	mfn_GetSystemWorkCheck("PO");
	if (ds_common.getColumn(0, 0) == "Y")
	{
		g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
		return false; 
	}
	
	if(ds_sub.getRowCount() == 0){
		gfn_alert("데이터가 없습니다.");
		return;
	}
	if(ds_sub.findRow("chk",1) == -1){
		gfn_alert("반려할 항목을 선택해 주세요.");
		return;
	}
	
	div_sub_return.position.top = div_center.position.top + 50;
	div_sub_return.position.left = div_center.btn_Return.position.right - 441;
	div_sub_return.position.width = 441;
	div_sub_return.visible = !div_sub_return.visible;
	
}

function div_sub_return_btn_Close_onclick(obj:Button,  e:ClickEventInfo)
{
	div_sub_return.edt_return_remark.value = "";
	div_sub_return.visible = false;
}

function div_return_btn_Close_onclick(obj:Button,  e:ClickEventInfo)
{
	div_return.edt_return_remark.value = "";
	div_return.visible = false;
}

function sp_line_onmove(obj:Splitter, e:MoveEventInfo)
{
	div_center.position.top = e.y + 5;
	div_center.position.height = 52;
	div_tip.position.top = e.y + 56;
	div_tip.position.height = 27;
	Static37.position.top = e.y + 66;
	Static37.position.height = 18;
	grd_sub.position.top = e.y + 85;
	
	
	if(div_Date.visible == true){//입고일자 변경
		div_Date.position.top = e.y + 56;
		div_Date.position.height = 84;
	}
	if(div_sub_return.visible == true){//반려내역
		div_sub_return.position.top = e.y + 56;
		div_sub_return.position.height = 84;
	}
}

function ds_list_cancolumnchange(obj:Dataset, e:DSColChangeEventInfo)
{
	if(e.columnid == "chk" && e.newvalue == 1){
		ds_list.filter("chk == 1");
		var Cnt = ds_list.getRowCount();
		ds_list.filter("");
		if(Cnt >= 1000){
			return false;
		}
	}
}


function ds_sub_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if(e.columnid == "poQty"){
		trace(ds_sub.getColumn(e.row,"salePrice") * e.newvalue);
		ds_sub.setColumn(e.row,"saleAmt",ds_sub.getColumn(e.row,"salePrice") * e.newvalue);
	}
}

function edt_sabunNm_onkeydown(obj:Edit, e:KeyEventInfo)
{
	// Del 키
	if(e.keycode == 46) 
	{	
		// 고객사 정보 초기화
		edt_sabunNm.value="";
		edt_sabunNm.userdata="";
		ds_search.setColumn(ds_search.rowposition, "schCsSabun", "");
		ds_search.setColumn(ds_search.rowposition, "schCsSabunNm", "");
	}

	// Enter 키
	if(e.keycode == 13) 
	{		
		fn_csSabunPop();
	}	
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : CS담당 팝업 화면 호출
 *---------------------------------------------------------------------------------------------*/
function fn_csSabunPop()
{
	var strReturn,strResult,nRow;
	var strCodeCol,strNameCol,strTitle,strSerchSvc,strText,arg1,nullyn;
	
	strCodeCol 	= "schCsSabun"; 
	strNameCol 	= "schCsSabunNm";
	strTitle	= "C/S 사원";
	strText		= "SABUN;NM_KOR";

	fn_sql_common_setup( strMAQuery_SABUN
						,strMAQuery_SABUNKeyField
						,strMAQuery_SABUNValueField
						,strMAQuery_SABUNKeyFieldNM
						,strMAQuery_SABUNValueFieldNM
						,""
						,""
						," AND MU_CD = '2004'"
						,strTitle
						,strText
						);

	nRow = ds_search.rowposition;
	
	if(gds_sql_common.getColumn(0, "ret_code") == '')
	{
		return
	}
	
	edt_sabunNm.value = gds_sql_common.getColumn(0, "ret_name");
	edt_sabunNm.userdata = gds_sql_common.getColumn(0, "ret_code");
	
	ds_search.setColumn(nRow,strNameCol,gds_sql_common.getColumn(0, "ret_name"));
	ds_search.setColumn(nRow,strCodeCol,gds_sql_common.getColumn(0, "ret_code"));
}



/*----------------------------------------------------------------------------------------------
 * 설명      : 주문내역의 비고란만 저장
 *---------------------------------------------------------------------------------------------*/
function div_tip_btn_etcSave_onclick(obj:Button,  e:ClickEventInfo)
{
	/*시스템 통제 시간 체크 - 특정일자에 사용을 할 수 없게 한다.*/
	mfn_GetSystemWorkCheck("PO");
	if (ds_common.getColumn(0, 0) == "Y")
	{
		g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
		return false; 
	}
	
	if(ds_sub.getRowCount() == 0){
		gfn_alert("데이터가 없습니다.");
		return;
	}

	if (gfn_dsIsUpdated(ds_sub) == false)
 	{
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}

 	var sMsg = "";
 	sMsg = "주문내역의 신청비고 항목을 수정합니다.\n\n";
 	sMsg = sMsg + "계속 진행하시겠습니까?";
	if(!gfn_confirm(sMsg))return;

    var strSvcID    = "subRemSave2";
    //var strURL      = "fm/fmo/orderDecision/saveRemList.xdo";		// SO_PR에만 저장
    var strURL      = "fm/fmo/orderDecision/saveRemList2.xdo";		// 구매 IF 호출 : 2015-12-14
    var strInDs     = "ds_sub=ds_sub:U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 결의관련 구매자재 제한여부 체크(0단가, 불용, 중지)
 *---------------------------------------------------------------------------------------------*/
function btn_poCheck_onclick(obj:Button,  e:ClickEventInfo)
{
	/*시스템 통제 시간 체크 - 특정일자에 사용을 할 수 없게 한다.*/
	mfn_GetSystemWorkCheck("PO");
	if (ds_common.getColumn(0, 0) == "Y")
	{
		g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
		return false; 
	}
	
	if(ds_list.getRowCount() == 0){
		gfn_alert("결의할 데이터가 없습니다.");
		return;
	}
	
	if(ds_list.findRow("chk" , 1) == -1){
		gfn_alert("결의할 항목을 선택해 주세요.");	// 변경된 내역이 없습니다.
		return;
	}

	var sMsg = "자재별 0단가, 불용, 중지자재 여부를 체크합니다.\n계속 진행 하시겠습니까?";
	    sMsg = sMsg + "※ 체크 후 결의진행 여부를 확인하세요";
	if (!gfn_confirm(sMsg, "", "C")) return;

	// 체크 프로세스 시작
	fn_processSet();
}


/*----------------------------------------------------------------------------------------------
 * 설명      : Progress Bar - 결의체크 용
 *---------------------------------------------------------------------------------------------*/
function fn_processSet()
{
	var nRowCnt = ds_list.getRowCount();	// DataSet Count
	var iCnt = 0;
	var iRow = 0;

  	// 체크시 Progress Bar 표시 창 
 	fn_processInit("1");

	// 체크할 Dataset Clear
	ds_check.clearData();

	// 체크 대상 개수 
	for (var i = 0 ; i < nRowCnt ; i++)
	{
		// 체크한 대상 기준
		if (ds_list.getColumn(i, "chk") == "1") {
			iCnt++;
			// 대상을 ds_check로 복사
			ds_check.addRow();
			iRow = ds_check.rowposition;
			ds_check.setColumn(iRow, "prNum", ds_list.getColumn(i, "prNum"));
		}
	}
	
	// 체크 대상 ROW
	fv_saveRowCnt = iCnt;

	trace("iCnt : " + iCnt);

	//trace("fv_saveRowCnt : " + fv_saveRowCnt);

	if(fv_saveRowCnt>0)
	{
		// progress bar 초기 set
		pbr_status.max = fv_saveRowCnt;
		pbr_status.step = 1;
	
		// 최초 process 실행 호출
		fv_saveRow = 0;
		fn_process(fv_saveRow);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 체크 로직 처리, 1 Row 씩 처리
 * arg : 처리 Index(row id)
 *---------------------------------------------------------------------------------------------*/
function fn_process(arg)
{
	// 최초 실행 시 첫번째 Row
	if (arg=="") arg = 0;

	// 선택 Row 가 최대 Row보다 클 경우 종료
	if ((arg+1) > fv_saveRowCnt) {
		fn_processInit("2");
		// 최종 결의 진행
		fn_saveProcess();
		return;
	}

	//trace("arg : " + arg);
	
	// checkRow Dataset Clear
	ds_checkRow.clearData();
	
	// checkRow Dataset 에 복사 
	var iIdx = ds_checkRow.addRow();
	
	ds_checkRow.copyRow(iIdx, ds_check, arg);
	// Find Row Value 지정
	fv_row = ds_check.getColumn(arg, "prNum");
	
	
	// 리턴 Dataset Clear
	//ds_return.clearData();
	fv_objColInfo = gfn_getDatasetInfo(ds_return);

	// 체크 Transaction
 	var strSvcID    = "checkList";
    var strURL      = "fm/fmo/orderDecision/checkList.xdo";
	var strInDs     = "ds_checkRow=ds_checkRow:A";
    var strOutDs    = "ds_return=ds_return";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
 	
 	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : Callback 후 작업진행 여부 CHECK 및 프로세스 호출
 *---------------------------------------------------------------------------------------------*/
function fn_processStep()
{
	var msg = "";
	
	// 해당 ROW POSITION 위치 : 최종 ROW
	var nRow = ds_list.findRowExpr("prNum=='"+fv_row+"'");
	ds_list.rowposition = nRow;
	
	//trace("fv_row : " + fv_row);
	//trace("nRow : " + nRow);
	//trace(ds_return.saveXML());
	//trace("ds_return.getRowCount() : " + ds_return.getRowCount());
	// 결과Dataset 처리
	if (ds_return.getRowCount() > 0) {
		// O단가 여부, CHECK 해제
		ds_return.filter("poNoStatus == 'Y'");
		//trace("0단가건수 " + ds_return.getRowCount());
		if (ds_return.getRowCount() > 0) {
			//trace("0 단가 ROW " + nRow);
			ds_list.setColumn(nRow, "poNoYn", "Y");
			ds_list.setColumn(nRow, "chk", 0);
		}
		// 불용자재 여부, CHECK 해제
		ds_return.filter("");
		ds_return.filter("valUnsCnt == 'UK'");
		if (ds_return.getRowCount() > 0) {
			ds_list.setColumn(nRow, "valUnsYn", "Y");
			ds_list.setColumn(nRow, "chk", 0);
		}
		// 중지자재 여부, CHECK 해제
		ds_return.filter("");
		ds_return.filter("valStpCnt == 'TK'");
		if (ds_return.getRowCount() > 0) {
			ds_list.setColumn(nRow, "valStpYn", "Y");
			ds_list.setColumn(nRow, "chk", 0);
		}
		// 종료후 초기화
		ds_return.filter("");
	}
	
	// Progress Bar SET
	pbr_status.text = "0단가,불용,중지자재 체크 ("+(fv_saveRow+1)+"/"+ fv_saveRowCnt+")";
	
	pbr_status.pos = fv_saveRow+1;
	pbr_status.stepIt();
	this.updateWindow(); // 이 부분 추가
	//trace("iRow : " + iRow);

	//다음 Transaction 처리 실행
	fv_saveRow++;
		
	//trace("fv_saveRow : " + fv_saveRow); 
	fn_process(fv_saveRow);
}


/*----------------------------------------------------------------------------------------------
 * 설명      : Progress Bar - 저장 용
 *---------------------------------------------------------------------------------------------*/
function fn_processInit(flag)
{
	pbr_status.text = "0단가,불용,중지자재 체크";
	pbr_status.pos = 0;
	if (flag=="1") pbr_status.visible = true;
	else pbr_status.visible = false;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 결의진행  Process 
 *---------------------------------------------------------------------------------------------*/
function fn_saveProcess()
{
	var iCnt = 0;
		
	var schSave = "";
	for(var i=0; i < ds_list.getRowCount();i++){
		if(ds_list.getColumn(i,"chk") == 1){
			iCnt++;
			schSave += ","+ds_list.getColumn(i,"prNum");
		}
	}

	//  체크건수
	if(iCnt == 0){
		gfn_alert("결의할 항목이 없습니다.");	// 변경된 내역이 없습니다.
		return;
	}

	// 체크작업 종료 및 결의진행 여부 체크
	var sMsg = "결의 하시겠습니까.\r";
	sMsg = sMsg + "※ 0단가,불용,중지자재가 포함된 주문건은 제외됩니다.\r\r";
	sMsg = sMsg + "-. 체크건수 : " + fv_saveRowCnt + " 건\r";
	sMsg = sMsg + "-. 대상건수 : " + iCnt + " 건\r";
	
	ds_search.setColumn(ds_search.rowposition,"listPrNum",schSave.substr(1,schSave.length));

	if (!gfn_confirm(sMsg, "", "C")) return;
	
	var strSvcID    = "save";
	var strURL      = "fm/fmo/orderDecision/saveResol.xdo";
	var strInDs     = "ds_list=ds_list:U";
	var strOutDs    = "";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);

}

// 센터코드 클릭
function btn_centerCode_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_centerCodePop();
}

function fn_centerCodePop()
{
	// 팝업창을 호출한다	
	var strId       = "CenterCodePop";
	var strURL      = "X_FMO::CenterCodePop.xfdl";
	var objArgument = {
		P_DATASET : ds_search
	};
	
	var nWidth      = 281;
	var nHeight     = 330;
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	
	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
	
	if (arrRtn instanceof Object)
	{
		// 리턴값 처리
		edt_centerCode.value    = arrRtn["centerName"];
		edt_centerCode.userdata = arrRtn["centerCode"];
		
		// ds_search SET
		ds_search.setColumn(0, "schCode", arrRtn["centerCode"]);
	}
}

function btn_SELECT_onclick(obj:Button,  e:ClickEventInfo)
{
	var error = "N";
	if(ds_list.getRowCount() > 1000){
		for(var i = 0 ; i < 1000;i++){
			if(Txtselect){
				ds_list.setColumn(i,"chk", 1);
				
				if(error == "N" && ds_list.getColumn(i,"soStatus") == "005"){
					error = "Y";
				}
				if(error == "N" && ds_list.getColumn(i,"soStatus") == "002"){
					error = "Y";
				}
			}else{
				ds_list.setColumn(i,"chk", 0);
			}
		}
	}else{
		for(var i = 0 ; i < ds_list.getRowCount();i++){
			if(Txtselect){
				ds_list.setColumn(i,"chk", 1);
			}else{
				ds_list.setColumn(i,"chk", 0);
			}
		}
	}
	
	if(Txtselect == false){
		btn_SELECT.text = "선택";
		Txtselect = true;
	}else{
		btn_SELECT.text = "선택취소";
		Txtselect = false;
	}

	if(error == "Y"){
		alert("결의승인 및 결의반려 대상이 존재 합니다.\n확인 후 작업해 주세요.");
	}	
}
]]></Script>
  </Form>
</FDL>

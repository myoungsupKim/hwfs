<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="OrderDecisionModify" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="주문결의수정" scrollbars="autoboth" onload="form_onload" onsize="OrderDecision_onsize">
    <Layouts>
      <Layout>
        <Combo id="cbo_centerCode" taborder="4" innerdataset="ds_center" codecolumn="centerCode" datacolumn="centerName" class="cmb_WF_Essential" position="absolute 1040 102 1152 123" anchor="left top" visible="false"/>
        <Edit id="ed_bond" taborder="13" tabstop="false" autoselect="true" enable="false" visible="false" position="absolute 914 102 1024 123" style="align:right; :disabled {background:#ffffffff;color:red;}"/>
        <Static id="st_Bond" text="채권잔액" class="sta_WFDA_Label01" visible="false" position="absolute 809 102 904 123" style="align:center middle;"/>
        <Edit id="ed_credit" taborder="14" tabstop="false" autoselect="true" enable="false" visible="false" position="absolute 689 102 799 123" style="align:right; :disabled {background:#ffffffff;color:red;}"/>
        <Static id="st_Credit" text="발주가능금액" class="sta_WFDA_Label01" visible="false" position="absolute 587 102 679 123"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="9" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30" tabstop="false"/>
        <Static id="Static18" text="주문목록" class="sta_WF_Title01" position="absolute 1 111 451 129" anchor="left top"/>
        <Static id="Static19" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 98 450 111"/>
        <Static id="Static20" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 124 450 129" anchor="left top"/>
        <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 305 450 320" anchor="left top"/>
        <Grid id="grd_list" taborder="10" binddataset="ds_list" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 0 129 1237 305" anchor="left top right" autofittype="col" oncelldblclick="grd_list_oncelldblclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="143"/>
                <Column size="82"/>
                <Column size="247"/>
                <Column size="138"/>
                <Column size="356"/>
                <Column size="121"/>
                <Column size="40"/>
                <Column size="121"/>
                <Column size="121"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                <Cell col="1" text="주문신청번호"/>
                <Cell col="2" text="센터"/>
                <Cell col="3" text="업장"/>
                <Cell col="4" text="신청일자"/>
                <Cell col="5" text="신청내용"/>
                <Cell col="6" text="신청금액"/>
                <Cell col="7" displaytype="checkbox" edittype="checkbox"/>
                <Cell col="8" text="주문상태"/>
                <Cell col="9" text="CS담당자"/>
              </Band>
              <Band id="body">
                <Cell expr="currow+1"/>
                <Cell col="1" displaytype="text" style="align:center;" text="bind:prNum"/>
                <Cell col="2" displaytype="text" text="bind:centerName"/>
                <Cell col="3" style="align:left middle;" text="bind:upjangnm"/>
                <Cell col="4" displaytype="text" style="align:center middle;" text="bind:prDate"/>
                <Cell col="5" style="align:left middle;" text="bind:itemName"/>
                <Cell col="6" displaytype="number" style="align:right middle;" text="bind:itemAmt" mask="#,##0.#0"/>
                <Cell col="7" displaytype="expr:iif(soStatus == &quot;007&quot; , &quot;checkbox&quot;, &quot;none&quot;)" edittype="expr:iif(soStatus == &quot;007&quot; , &quot;checkbox&quot;, &quot;none&quot;)" text="bind:chk"/>
                <Cell col="8" style="align:center middle;" text="bind:soStatusNm"/>
                <Cell col="9" style="align:center middle;" text="bind:csSabunNm" subsumtext="CS_SABUN_NM"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static37" text="주문내역" class="sta_WF_Title01" position="absolute 1 374 451 392" anchor="left top"/>
        <Static id="Static38" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 361 450 374" anchor="left top"/>
        <Static id="Static39" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 387 450 392" anchor="left top"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 98" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 93 40" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 120 87 213 97" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 107 40 117 61" anchor="left top"/>
        <Static id="Static00" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 332 40 352 61" anchor="left top"/>
        <Grid id="grd_sub" taborder="8" binddataset="ds_sub" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 0 392 1237 710" anchor="all" autofittype="none">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="37" band="left"/>
                <Column size="37" band="left"/>
                <Column size="82" band="left"/>
                <Column size="236" band="left"/>
                <Column size="180"/>
                <Column size="67"/>
                <Column size="67"/>
                <Column size="101"/>
                <Column size="86"/>
                <Column size="86"/>
                <Column size="81"/>
                <Column size="86"/>
                <Column size="94"/>
                <Column size="112"/>
                <Column size="112"/>
                <Column size="216"/>
                <Column size="204"/>
                <Column size="86"/>
                <Column size="86"/>
                <Column size="86"/>
                <Column size="113"/>
                <Column size="113"/>
                <Column size="84"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                <Cell col="1" displaytype="checkbox" edittype="checkbox"/>
                <Cell col="2" text="자재코드"/>
                <Cell col="3" text="자재명"/>
                <Cell col="4" text="규격"/>
                <Cell col="5" text="단위"/>
                <Cell col="6" text="배송"/>
                <Cell col="7" text="과세코드"/>
                <Cell col="8" text="신청일자"/>
                <Cell col="9" text="입고일자"/>
                <Cell col="10" text="신청량"/>
                <Cell col="11" text="결의량"/>
                <Cell col="12" text="판매단가"/>
                <Cell col="13" text="판매금액"/>
                <Cell col="14" text="판매금액"/>
                <Cell col="15" text="창고"/>
                <Cell col="16" text="신청비고"/>
                <Cell col="17" text="결의일"/>
                <Cell col="18" text="신청구분"/>
                <Cell col="19" text="반려자"/>
                <Cell col="20" text="반려시간"/>
                <Cell col="21" text="반려사유"/>
                <Cell col="22" text="구매상태"/>
                <Cell col="23" text="실발주자"/>
              </Band>
              <Band id="body">
                <Cell displaytype="normal" expr="currow+1"/>
                <Cell col="1" displaytype="expr:iif(soStatus == &quot;007&quot; , &quot;checkbox&quot;, &quot;none&quot;)" edittype="expr:iif(soStatus == &quot;007&quot; , &quot;checkbox&quot;, &quot;none&quot;)" text="bind:chk"/>
                <Cell col="2" text="bind:itemCode"/>
                <Cell col="3" style="align:left middle;" text="bind:itemName"/>
                <Cell col="4" displaytype="text" text="bind:itemSize"/>
                <Cell col="5" text="bind:itemUnit"/>
                <Cell col="6" text="expr:centerFlag=='VC'?'직송':centerFlag"/>
                <Cell col="7" text="expr:iif(taxCode == '100','면세','과세')"/>
                <Cell col="8" displaytype="date" text="bind:prDate"/>
                <Cell col="9" displaytype="date" text="bind:needDate"/>
                <Cell col="10" displaytype="number" style="align:right;" text="bind:prQty" mask="#,##0.#0"/>
                <Cell col="11" displaytype="number" edittype="expr:iif(poLineStatus == &quot;DL&quot; , &quot;none&quot; ,  iif(poLineStatus == &quot;GC&quot; , &quot;none&quot; , iif(poLineStatus == &quot;IV&quot; , &quot;none&quot; , &quot;masknumber&quot;)))" style="align:right middle;color:blue;color2:blue;" text="bind:poQty" mask="#,##0.#0" editautoselect="true"/>
                <Cell col="12" displaytype="number" style="align:right middle;" text="bind:salePrice"/>
                <Cell col="13" displaytype="number" style="align:right middle;" text="bind:amt" mask="#,##0.#0"/>
                <Cell col="14" displaytype="number" style="align:right middle;" text="bind:noAmt" mask="#,##0.#0"/>
                <Cell col="15" style="align:left middle;" text="bind:subinvName"/>
                <Cell col="16" displaytype="text" edittype="expr:iif(poLineStatus == &quot;DL&quot; , &quot;none&quot; ,  iif(poLineStatus == &quot;GC&quot; , &quot;none&quot; , iif(poLineStatus == &quot;IV&quot; , &quot;none&quot; , &quot;text&quot;)))" style="color:blue;color2:blue;" text="bind:prRemark"/>
                <Cell col="17" displaytype="text" edittype="none" style="align:center middle;color2: ;" text="bind:poDate" mask="####-##-##" editautoselect="true"/>
                <Cell col="18" text="bind:docuSource"/>
                <Cell col="19" displaytype="expr:iif(lineStatus == &quot;005&quot; , &quot;normal&quot; , &quot;none&quot;)" text="bind:returnName"/>
                <Cell col="20" displaytype="expr:iif(lineStatus == &quot;005&quot; , &quot;normal&quot; , &quot;none&quot;)" text="bind:returnDate"/>
                <Cell col="21" displaytype="expr:iif(lineStatus == &quot;005&quot; , &quot;normal&quot; , &quot;none&quot;)" style="align:left middle;" text="bind:remark"/>
                <Cell col="22" displaytype="text" style="align:center middle;" text="bind:poLineStatusNm"/>
                <Cell col="23" displaytype="text" edittype="text" text="bind:tOrder"/>
              </Band>
              <Band id="summary">
                <Cell/>
                <Cell col="1"/>
                <Cell col="2"/>
                <Cell col="3"/>
                <Cell col="4"/>
                <Cell col="5"/>
                <Cell col="6"/>
                <Cell col="7"/>
                <Cell col="8"/>
                <Cell col="9"/>
                <Cell col="10"/>
                <Cell col="11"/>
                <Cell col="12"/>
                <Cell col="13" displaytype="number" style="align:right middle;" text="expr:getSum('amt')" mask="#,##0.#0"/>
                <Cell col="14" displaytype="number" style="align:right middle;" text="expr:getSum('amt')" mask="#,##0.#0"/>
                <Cell col="15"/>
                <Cell col="16"/>
                <Cell col="17"/>
                <Cell col="18"/>
                <Cell col="19"/>
                <Cell col="20"/>
                <Cell col="21"/>
                <Cell col="22"/>
                <Cell col="23"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static28" text="센터" class="sta_WFSA_label" position="absolute 641 40 676 61" anchor="left top"/>
        <Static id="Static01" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 859 41 879 62" anchor="left top"/>
        <Static id="Static10" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 681 41 691 62" anchor="left top"/>
        <Static id="Static36" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 409 40 419 61" anchor="left top"/>
        <Static id="Static15" text="구매유형" class="sta_WFSA_label" position="absolute 352 40 414 61" anchor="left top"/>
        <Combo id="cbo_type" taborder="3" innerdataset="@ds_type" codecolumn="poType" datacolumn="typeName" position="absolute 419 40 619 61" anchor="left top" class="cmb_WF_Essential"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 619 39 639 65" anchor="left top"/>
        <Static id="Static02" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 1144 98 1237 108" anchor="left top"/>
        <Button id="btn_return" taborder="11" text="반려" class="btn_WF_Function" position="absolute 1192 107 1237 127" anchor="top right" onclick="btn_return_onclick" visible="true"/>
        <Static id="Static21" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1190 107 1192 127" anchor="top right"/>
        <ObjCalendar id="cal_toDate" titletext="캘린더" taborder="2" text="20150101" scrollbars="none" position="absolute 232 40 332 61"/>
        <Static id="Static26" text="~" position="absolute 218 43 234 62" style="align:center middle;"/>
        <ObjCalendar id="cal_fromDate" titletext="캘린더" taborder="1" text="20150101" scrollbars="none" position="absolute 117 40 217 61"/>
        <Div id="div_Date" taborder="12" position="absolute 1321 200 1762 284" style="background:#f2eee5ff;border:1 solid #808080ff ;" visible="false">
          <Layouts>
            <Layout>
              <Static id="Static03" text="변경일" class="sta_WFSA_label" position="absolute 16 15 85 36" anchor="left top"/>
              <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 89 15 99 36" anchor="left top"/>
              <ObjCalendar id="cal_needDate" titletext="캘린더" taborder="1" scrollbars="none" position="absolute 99 15 199 36" anchor="default"/>
              <Static id="Static48" text="변경사유" class="sta_WFSA_label01" position="absolute 16 49 78 70" anchor="left top"/>
              <Static id="Static49" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 89 48 99 69" anchor="left top"/>
              <Edit id="edt_remark" taborder="2" readonly="false" position="absolute 99 48 421 69" anchor="left top"/>
              <Button id="btn_needDateSave" taborder="3" text="저장" class="btn_WF_Function" position="absolute 334 15 379 35" anchor="top right" onclick="div_Date_btn_needDateSave_onclick"/>
              <Button id="btn_Close" taborder="4" text="취소" class="btn_WF_Function" position="absolute 381 15 426 35" anchor="top right" onclick="div_Date_btn_Close_onclick"/>
              <Static id="Static25" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 -2 15 83" anchor="top right"/>
              <Static id="Static00" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 426 -2 441 83" anchor="top right"/>
              <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 69 441 84" anchor="left bottom"/>
              <Static id="Static01" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 441 15" anchor="left bottom"/>
              <Static id="Static02" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 8 35 449 48" anchor="left bottom"/>
            </Layout>
          </Layouts>
        </Div>
        <Combo id="cbo_status" taborder="5" innerdataset="@ds_status" codecolumn="code" datacolumn="codeName" position="absolute 956 40 1055 61" anchor="left top" visible="true"/>
        <Static id="Static22" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 946 40 956 61" anchor="left top"/>
        <Static id="Static27" text="주문상태" class="sta_WFSA_label" position="absolute 878 40 940 61" anchor="left top" visible="true"/>
        <Div id="div_return" taborder="15" style="background:#f2eee5ff;border:1 solid #808080ff ;" visible="false" position="absolute 1321 112 1762 196">
          <Layouts>
            <Layout>
              <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 89 15 99 36" anchor="left top"/>
              <Static id="Static48" text="반려사유" class="sta_WFSA_label01" position="absolute 16 49 78 70" anchor="left top"/>
              <Static id="Static49" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 89 48 99 69" anchor="left top"/>
              <Edit id="edt_return_remark" taborder="6" position="absolute 99 48 421 69" anchor="left top"/>
              <Button id="btn_needDateSave" taborder="7" text="저장" class="btn_WF_Function" position="absolute 334 15 379 35" anchor="top right" onclick="div_return_btn_needDateSave_onclick"/>
              <Button id="btn_Close" taborder="8" text="취소" class="btn_WF_Function" position="absolute 381 15 426 35" anchor="top right" onclick="div_return_btn_Close_onclick"/>
              <Static id="Static25" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 -2 15 83" anchor="top right"/>
              <Static id="Static00" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 426 -2 441 83" anchor="top right"/>
              <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 69 441 84" anchor="left bottom"/>
              <Static id="Static01" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 441 15" anchor="left bottom"/>
              <Static id="Static02" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 8 35 449 48" anchor="left bottom"/>
            </Layout>
          </Layouts>
        </Div>
        <Radio id="rdo_gubun" taborder="0" columncount="2" rowcount="0" index="0" codecolumn="codecolumn" datacolumn="datacolumn" value="1" position="absolute 15 38 114 66">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">1</Col>
                <Col id="datacolumn">결의</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2</Col>
                <Col id="datacolumn">입고</Col>
              </Row>
            </Rows>
          </Dataset>
        </Radio>
        <Splitter id="sp_line" type="vertical" position="absolute 0 309 1237 317" anchor="left top right" onmove="sp_line_onmove">
          <Formats>
            <Format id="default">
              <SplitterItems id="items">
                <SplitterItem id="item00" position="leftortop" bindtype="resize" componentid="grd_list"/>
                <SplitterItem id="item02" position="rightorbottom" bindtype="resize" componentid="div_detail"/>
              </SplitterItems>
            </Format>
          </Formats>
        </Splitter>
        <Div id="div_center" anchor="left top right" taborder="22" style="background:transparent;color:aliceblue;" text="Div00" scrollbars="none" position="absolute 0 316 1238 366">
          <Layouts>
            <Layout>
              <Static id="Static41" class="sta_WFSA_Labelbg01" position="absolute 0 4 1237 45" anchor="left top right"/>
              <Static id="Static42" text="신청번호" class="sta_WFSA_label01" position="absolute 15 14 77 35" anchor="left top"/>
              <Static id="Static43" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 4 93 14" anchor="left top"/>
              <Static id="Static44" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 35 93 45" anchor="left top"/>
              <Static id="Static45" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 14 15 35" anchor="left top"/>
              <Static id="Static46" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 75 14 85 35" anchor="left top"/>
              <Static id="Static47" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 192 14 222 35" anchor="left top"/>
              <Edit id="edt_PoNum" taborder="8" readonly="true" position="absolute 85 14 192 35" anchor="left top"/>
              <Static id="Static48" text="신청내용" class="sta_WFSA_label01" position="absolute 473 14 535 35" anchor="left top"/>
              <Static id="Static49" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 532 14 542 35" anchor="left top"/>
              <Edit id="edt_remark" taborder="9" readonly="true" position="absolute 542 14 770 35" anchor="left top"/>
              <Static id="Static50" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 770 14 800 35" anchor="left top"/>
              <Static id="Static51" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 859 13 869 34" anchor="left top"/>
              <Static id="Static52" text="신청금액" class="sta_WFSA_label01" position="absolute 801 13 863 34" anchor="left top"/>
              <Static id="Static17" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1190 14 1192 34" anchor="top right"/>
              <Button id="btn_Save" taborder="10" text="저장" onclick="btn_Save_onclick" class="btn_WF_Function" position="absolute 1143 14 1188 34" anchor="top right"/>
              <Static id="Static32" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1143 14 1145 34" anchor="top right"/>
              <Button id="btn_chNeedDate" taborder="11" text="입고일자 변경" onclick="btn_chNeedDate_onclick" class="btn_WF_Function" position="absolute 1030 -11 1140 9" anchor="top right" visible="false"/>
              <Static id="Static33" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 1144 5 1237 15" anchor="left top"/>
              <Static id="Static34" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 1144 34 1237 44" anchor="left top"/>
              <Static id="Static12" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 279 13 289 34" anchor="left top"/>
              <Edit id="edt_PoType" taborder="12" readonly="true" position="absolute 289 13 440 34" anchor="left top"/>
              <Static id="Static13" text="구매유형" class="sta_WFSA_label" position="absolute 221 14 282 35" anchor="left top"/>
              <Static id="Static14" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 440 13 470 34" anchor="left top"/>
              <Static id="Static16" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 279 4 372 14" anchor="left top"/>
              <Static id="Static29" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 527 4 620 14" anchor="left top"/>
              <MaskEdit id="mak_Amt" taborder="13" readonly="true" mask="#,##0.#0" position="absolute 868 13 991 34" anchor="default"/>
              <Button id="btn_Return" taborder="14" text="반려" onclick="btn_Return_onclick" class="btn_WF_Function" position="absolute 1191 14 1236 34" anchor="top right"/>
              <Button id="btn_searchAll" taborder="15" text="전체조회" position="absolute 1083 14 1140 34" onclick="div_center_btn_searchAll_onclick" class="btn_WF_Function" anchor="top right" visible="false"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_sub_return" taborder="23" style="background:#f2eee5ff;border:1 solid #808080ff ;" visible="false" position="absolute 1321 322 1762 406">
          <Layouts>
            <Layout>
              <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 89 15 99 36" anchor="left top"/>
              <Static id="Static48" text="반려사유" class="sta_WFSA_label01" position="absolute 16 49 78 70" anchor="left top"/>
              <Static id="Static49" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 89 48 99 69" anchor="left top"/>
              <Edit id="edt_return_remark" taborder="15" position="absolute 99 48 421 69" anchor="left top"/>
              <Button id="btn_needDateSave" taborder="16" text="저장" onclick="fn_Subreturn" class="btn_WF_Function" position="absolute 334 15 379 35" anchor="top right"/>
              <Button id="btn_Close" taborder="17" text="취소" onclick="div_sub_return_btn_Close_onclick" class="btn_WF_Function" position="absolute 381 15 426 35" anchor="top right"/>
              <Static id="Static25" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 -2 15 83" anchor="top right"/>
              <Static id="Static00" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 426 -2 441 83" anchor="top right"/>
              <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 69 441 84" anchor="left bottom"/>
              <Static id="Static01" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 441 15" anchor="left bottom"/>
              <Static id="Static02" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 8 35 449 48" anchor="left bottom"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static12" text="C/S담당" class="sta_WFSA_label" position="absolute 641 66 703 87" anchor="left top"/>
        <Static id="Static13" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 700 66 710 87" anchor="left top"/>
        <Edit id="edt_sabunNm" taborder="6" readonly="true" onkeydown="edt_sabunNm_onkeydown" position="absolute 709 66 829 87" userdata="btn_pop5"/>
        <Button id="btn_pop5" taborder="7" onclick="fn_csSabunPop" class="btn_WF_popSearch" position="absolute 828 66 848 87"/>
        <Edit id="edt_centerCode" taborder="24" readonly="true" class="edt_WF_Essential" position="absolute 680 40 841 61"/>
        <Button id="btn_centerCode" taborder="25" tabstop="false" onclick="btn_centerCode_onclick" class="btn_WF_popSearch" position="absolute 840 40 861 61"/>
        <Static id="Static51" text="W05." visible="false" position="absolute 118 61 351 66" style="background:#ff000055;align:center middle;"/>
        <UpjangSearchComponent id="comp_upjang" titletext="업장 검색용 Component" taborder="26" text="UpjangSearchComponent00" position="absolute 117 66 332 87" bindDataset="ds_search" bindUpjangCodeColumn="upjang1" bindUpjangNameColumn="" eventBeforeTrigger="" eventAfterTrigger="" roleSetId="FmsUpjang"/>
        <Static id="Static03" text="사업장" class="sta_WFSA_label" position="absolute 15 66 77 87" anchor="left top"/>
        <Static id="Static35" text="결의번호" class="sta_WFSA_label" position="absolute 352 66 415 87" anchor="left top"/>
        <MaskEdit id="msk_poNum" taborder="27" type="string" mask="@@@@@@@@@@@@@" position="absolute 419 66 620 87" style="padding:1 0 0 10;align:left middle;" maskchar=" "/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item6" compid="cal_fromDate" propid="text" datasetid="ds_search" columnid="schDate1"/>
      <BindItem id="item7" compid="cal_toDate" propid="text" datasetid="ds_search" columnid="schDate2"/>
      <BindItem id="item0" compid="cbo_type" propid="value" datasetid="ds_search" columnid="schType"/>
      <BindItem id="item4" compid="cbo_centerCode" propid="value" datasetid="ds_search" columnid="schCenter"/>
      <BindItem id="item2" compid="cbo_status" propid="value" datasetid="ds_search" columnid="schStatus"/>
      <BindItem id="item3" compid="rdo_gubun" propid="value" datasetid="ds_search" columnid="schGubun"/>
      <BindItem id="ed_CS_SABUN_NM_value" compid="edt_sabunNm" propid="value" datasetid="ds_search" columnid="schCsSabunNm"/>
      <BindItem id="item30" compid="msk_poNum" propid="value" datasetid="ds_search" columnid="schPoNum"/>
    </Bind>
    <Objects>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_list_oncolumnchanged" onrowposchanged="ds_list_onrowposchanged" canrowposchange="ds_list_canrowposchange">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="prNum" type="STRING" size="256"/>
          <Column id="typeName" type="STRING" size="256"/>
          <Column id="upjangnm" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemAmt" type="STRING" size="256"/>
          <Column id="rcUpjang" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="centerName" type="STRING" size="256"/>
          <Column id="prUpjang" type="STRING" size="256"/>
          <Column id="poDeptId" type="STRING" size="256"/>
          <Column id="lineStatus" type="STRING" size="256"/>
          <Column id="lineStatusNm" type="STRING" size="256"/>
          <Column id="custcd" type="STRING" size="256"/>
          <Column id="custnm" type="STRING" size="256"/>
          <Column id="headCreditYn" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="csSabunNm" type="STRING" size="256"/>
          <Column id="reamrk" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sub" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" cancolumnchange="ds_sub_cancolumnchange" oncolumnchanged="ds_sub_oncolumnchanged">
        <ColumnInfo>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="taxCode" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="poQty" type="STRING" size="256"/>
          <Column id="amt" type="STRING" size="256"/>
          <Column id="insDeptNm" type="STRING" size="256"/>
          <Column id="lineStatus" type="STRING" size="256"/>
          <Column id="lineStatusNm" type="STRING" size="256"/>
          <Column id="prId" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="poType" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="minOrdQty" type="STRING" size="256"/>
          <Column id="maxOrdQty" type="STRING" size="256"/>
          <Column id="multiplierQty" type="STRING" size="256"/>
          <Column id="pointFlag" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
          <Column id="docuSource" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="256"/>
          <Column id="tOrder" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_search_oncolumnchanged">
        <ColumnInfo>
          <Column id="schGubun" type="STRING" size="256"/>
          <Column id="schDate1" type="STRING" size="256"/>
          <Column id="schDate2" type="STRING" size="256"/>
          <Column id="schType" type="STRING" size="256"/>
          <Column id="schTypeNm" type="STRING" size="256"/>
          <Column id="schSabun" type="STRING" size="256"/>
          <Column id="schUpjang" type="STRING" size="256"/>
          <Column id="schChk1" type="STRING" size="256"/>
          <Column id="schPrNum" type="STRING" size="256"/>
          <Column id="schPrDate" type="STRING" size="256"/>
          <Column id="schNeedDate" type="STRING" size="256"/>
          <Column id="schFlag" type="STRING" size="256"/>
          <Column id="schCenter" type="STRING" size="256"/>
          <Column id="schStatus" type="STRING" size="256"/>
          <Column id="schSubStatus" type="STRING" size="256"/>
          <Column id="schCustcd" type="STRING" size="256"/>
          <Column id="schRcUpjang" type="STRING" size="256"/>
          <Column id="schHeadCreditYn" type="STRING" size="256"/>
          <Column id="schMainUpjang" type="STRING" size="256"/>
          <Column id="schChgNeedDate" type="STRING" size="256"/>
          <Column id="schSubinvCode" type="STRING" size="256"/>
          <Column id="schCsSabun" type="STRING" size="256"/>
          <Column id="schCsSabunNm" type="STRING" size="256"/>
          <Column id="schCode" type="STRING" size="256"/>
          <Column id="schPoNum" type="STRING" size="256"/>
          <Column id="upjang1" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_type" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="poType" type="STRING" size="256"/>
          <Column id="typeName" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_detail" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="taxCode" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="poQty" type="STRING" size="256"/>
          <Column id="amt" type="STRING" size="256"/>
          <Column id="insDeptNm" type="STRING" size="256"/>
          <Column id="lineStatus" type="STRING" size="256"/>
          <Column id="lineStatusNm" type="STRING" size="256"/>
          <Column id="prId" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="poType" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_center" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="centerName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">0</Col>
            <Col id="delYn">0</Col>
            <Col id="savYn">1</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">0</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_subflag" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" cancolumnchange="ds_sub_cancolumnchange">
        <ColumnInfo>
          <Column id="itemCode" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemSize" type="STRING" size="256"/>
          <Column id="itemUnit" type="STRING" size="256"/>
          <Column id="taxCode" type="STRING" size="256"/>
          <Column id="prRemark" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="salePrice" type="STRING" size="256"/>
          <Column id="prQty" type="STRING" size="256"/>
          <Column id="poQty" type="STRING" size="256"/>
          <Column id="amt" type="STRING" size="256"/>
          <Column id="insDeptNm" type="STRING" size="256"/>
          <Column id="lineStatus" type="STRING" size="256"/>
          <Column id="lineStatusNm" type="STRING" size="256"/>
          <Column id="prId" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="poType" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
          <Column id="minOrdQty" type="STRING" size="256"/>
          <Column id="maxOrdQty" type="STRING" size="256"/>
          <Column id="multiplierQty" type="STRING" size="256"/>
          <Column id="pointFlag" type="STRING" size="256"/>
          <Column id="dDays" type="STRING" size="256"/>
          <Column id="dTimes" type="STRING" size="256"/>
          <Column id="docuSource" type="STRING" size="256"/>
          <Column id="ordFlag" type="STRING" size="256"/>
          <Column id="ordDaysFlag" type="STRING" size="256"/>
          <Column id="poStatus" type="STRING" size="256"/>
          <Column id="fmpStatus" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_status" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="groupCode" type="STRING" size="50"/>
          <Column id="code" type="STRING" size="50"/>
          <Column id="codeName" type="STRING" size="500"/>
          <Column id="contents" type="STRING" size="300"/>
          <Column id="sortSeq" type="BIGDECIMAL" size="22"/>
          <Column id="systemYn" type="STRING" size="1"/>
          <Column id="posYn" type="STRING" size="1"/>
          <Column id="set1" type="STRING" size="100"/>
          <Column id="set2" type="STRING" size="100"/>
          <Column id="set3" type="STRING" size="100"/>
          <Column id="set4" type="STRING" size="100"/>
          <Column id="set5" type="STRING" size="100"/>
          <Column id="remark" type="STRING" size="300"/>
          <Column id="useYn" type="STRING" size="1"/>
          <Column id="attr01" type="STRING" size="300"/>
          <Column id="attr02" type="STRING" size="300"/>
          <Column id="attr03" type="STRING" size="300"/>
          <Column id="attr04" type="STRING" size="300"/>
          <Column id="attr05" type="STRING" size="300"/>
          <Column id="attr06" type="STRING" size="300"/>
          <Column id="attr07" type="STRING" size="300"/>
          <Column id="attr08" type="STRING" size="300"/>
          <Column id="attr09" type="STRING" size="300"/>
          <Column id="attr10" type="STRING" size="300"/>
          <Column id="cuser" type="STRING" size="20"/>
          <Column id="cdate" type="DATETIME" size="7"/>
          <Column id="uuser" type="STRING" size="20"/>
          <Column id="udate" type="DATETIME" size="7"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_creInfo" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="creditTurnDays" type="STRING" size="256"/>
          <Column id="creditTurnDaysTot" type="STRING" size="256"/>
          <Column id="creditAmount" type="STRING" size="256"/>
          <Column id="creditAmountTot" type="STRING" size="256"/>
          <Column id="creditOverAmount" type="STRING" size="256"/>
          <Column id="rmnAmt" type="STRING" size="256"/>
          <Column id="preAmt" type="STRING" size="256"/>
          <Column id="trAmt" type="STRING" size="256"/>
          <Column id="poAmt" type="STRING" size="256"/>
          <Column id="prAmt" type="STRING" size="256"/>
          <Column id="bondAmt" type="STRING" size="256"/>
          <Column id="creditRmnAmt" type="STRING" size="256"/>
          <Column id="creditAvailAmt" type="STRING" size="256"/>
          <Column id="lBillDate" type="STRING" size="256"/>
          <Column id="lBillDateDisp" type="STRING" size="256"/>
          <Column id="lastTurnCnt" type="STRING" size="256"/>
          <Column id="creditTurnControlYn" type="STRING" size="256"/>
          <Column id="creditAmountControlYn" type="STRING" size="256"/>
          <Column id="creditControlYn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_subinv" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="subinvCode" type="STRING" size="256"/>
          <Column id="subinvName" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="consumYn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_Srow" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="prNum" type="STRING" size="256"/>
          <Column id="typeName" type="STRING" size="256"/>
          <Column id="upjangnm" type="STRING" size="256"/>
          <Column id="prDate" type="STRING" size="256"/>
          <Column id="itemName" type="STRING" size="256"/>
          <Column id="itemAmt" type="STRING" size="256"/>
          <Column id="rcUpjang" type="STRING" size="256"/>
          <Column id="centerCode" type="STRING" size="256"/>
          <Column id="chgRemark" type="STRING" size="256"/>
          <Column id="needDate" type="STRING" size="256"/>
          <Column id="usrNm" type="STRING" size="256"/>
          <Column id="poType" type="STRING" size="256"/>
          <Column id="prUpjang" type="STRING" size="256"/>
          <Column id="lineStatus" type="STRING" size="256"/>
          <Column id="chgneedDate" type="STRING" size="256"/>
          <Column id="schDate2" type="STRING" size="256"/>
          <Column id="schDate1" type="STRING" size="256"/>
          <Column id="poNum" type="STRING" size="256"/>
          <Column id="prSabun" type="STRING" size="256"/>
          <Column id="soStatus" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_ordCtl" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chkType" type="STRING" size="256"/>
          <Column id="ctrlType" type="STRING" size="256"/>
          <Column id="itemType" type="STRING" size="256"/>
          <Column id="mon" type="STRING" size="256"/>
          <Column id="tue" type="STRING" size="256"/>
          <Column id="wed" type="STRING" size="256"/>
          <Column id="thu" type="STRING" size="256"/>
          <Column id="fri" type="STRING" size="256"/>
          <Column id="sat" type="STRING" size="256"/>
          <Column id="sun" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_common" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codename" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : Template
  파 일 명 : Template.xfdl
  기    능 : Design 및 Script Template 

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2014.11.01   김윤기   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "U_lib::lib_conversionCom.xjs";


/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();
var sRow = -1;	//상세 조회 선택 row

var fv_errorFlag;				//에러발생 여부(Y/N)
var fv_errorMsg;				//에러발생 메시지


/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	//공통 버튼 제어.
	//div_cmnBtn.btn_save.text ="결의";
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	v_ds_check = "ds_list";
	ds_search.addRow();
	fn_searchType();
	fn_searchCenter();
	cal_fromDate.fn_initMonthCal(this, gfn_today(), "", ds_search, "schDate1", "Y");	
	cal_toDate.fn_initMonthCal(this, gfn_today(), "", ds_search, "schDate2", "Y");	
	rdo_gubun.index = 0;
	fn_comCode("ds_status","FM0037");//상태값 조회
	
	comp_upjang.setUpjangCode("");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{	
//	// v_ds_check 미사용시 변경사항 체크(입력 프로그램일때 변경되는 Dataset 전체 기술)
// 	if (gfn_dsIsUpdated(ds_list) == true) 
// 	{
// 		// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
//         if (!gfn_confirm("confirm.before.movepage")) return false;
//     }
//     
//	// 조회프로그램에도 Return true; 기술해 주세요!
// 	return true;

	// v_ds_check 사용시 변경사항 체크
	if(gfn_length(v_ds_check) != 0)
	{	
		// v_ds_check 설정기준 변경사항 체크
		if (gfn_isDataChange() == true) 
		{		
			// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
			if (!gfn_confirm("confirm.before.movepage")) return false;
		}
	}
    
	// 조회프로그램에도 Return true; 기술해 주세요!
	return true;
}


/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
// 	// v_ds_check 미사용시 변경사항 체크
// 	if (gfn_dsIsUpdated(ds_list) == true) 
// 	{
// 		var retValue = gfn_confirm("confirm.before.search");	// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
// 		if (retValue == false) return;
// 	}

// 	// v_ds_check 사용시 공통버튼에서 변경사항 체크함
// 	// 변경사항 체크
// 	if (gfn_isDataChange() == true) 
// 	{		
// 		var retValue = gfn_confirm("confirm.before.search");	// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
// 		if (retValue == false) return;
// 	}
	div_Date.visible = false;
	ds_sub.clearData();
	Static37.text = "결의내역";
	// ds_listValid Dataset에 Validation할 칼럼별로 구성
	// 항목 추가시에는 ','로 구분
	// 예)title:금액1,required:false,minlength:2,digits:true
	
	// Alert시 칼럼 표시 명칭               - title:아이디(메시지의 치환할 명칭) 
	// 필수체크                              - required:true(체크여부 true/false)
	// size 크기                              - length:7(size 숫자)
	// 최대 size 크기                        - maxlength:7(size 숫자)
	// 최소 size 크기                        - minlength:7(size 숫자)
	// 최대 size 크기(Byte)                  - maxlengthB:7(size 숫자)
	// 최소 size 크기(Byte)                  - minlengthB:7(size 숫자)
	// 숫자 여부                             - digits:true(체크여부 true/false)
	// 해당 숫자 이하                       - min:7(size 숫자)
	// 해당 숫자 이상                       - max:7(size 숫자)
	// 소숫점 자리수 비교                   - declimit:3(size 숫자)
	// 날짜 년월일 체크                     - date:true(체크여부 true/false)
	// 날짜 년월 체크                       - dateym:true(체크여부 true/false)
	// 타 칼럼값보다 큰지 비교             - comparemax:Column4(Dataset 칼럼ID):시작일(비교대상의 메시지 치환할 명칭)
	// 타 칼럼값보다 작은지 비교           - comparemin:Column6(Dataset 칼럼ID):종료일(비교대상의 메시지 치환할 명칭)
	// 타 칼럼값과 같은 값인지 비교        - equalto:Column5(Dataset 칼럼ID):금액1(비교대상의 메시지 치환할 명칭)
	// 사이의 값인지 비교                   - range:40(from 숫자):100(to 숫자)
	// 코드값이 목록내의 값인지 비교       - code:1(목록 숫자):2(목록 숫자):3(목록 숫자)
	// 이메일 여부 체크(함수 체크시 예제)  - isEmail:true(체크여부 true/false)
	
	// 오류시 focus 지정                      - focus:cal_toDate(Componet ID로 form에서부터의 경로)
	
	// 조회시 Validation Check
	//if (gfn_validCheck(ds_search, ds_searchValid, true) == false) return;

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_list);
    
    var strSvcID    = "search";
    var strURL      = "fm/fmo/orderDecisionModify/selectList.xdo";
    var strInDs     = "ds_search=ds_search";
    var strOutDs    = "ds_list=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{	

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
	div_Date.visible = false;
	if(ds_list.findRow("chk" , 1) == -1){
		gfn_alert("결의할 항목을 선택해 주세요.");	// 변경된 내역이 없습니다.
		return;
	}
	for(var i=0; i < ds_list.getRowCount();i++){
		if(ds_list.getColumn(i,"chk") == 1){
			if(ds_list.getColumn(i, "soStatus") == "007"){
				gfn_alert("결의승인건은 결의할 수 없습니다.");
				ds_list.setColumn(i,"chk", 0);
				return;
			}
		}
	}

	if(gfn_confirm("결의 하시겠습니까?")){
		var strSvcID    = "save";
		var strURL      = "fm/fmo/orderDecisionModify/saveResol.xdo";
		var strInDs     = "ds_list=ds_list:U";
		var strOutDs    = "";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
	
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {
		// 코드분류 조회
        case "search" :
			ds_list.addColumn("schGubun","STRING");
            break;
            //구매유형정보
        case "searchType" :
            fn_type_init();
            break;            
            
        case "searchDetail" :
            Static37.text = "주문내역 : "+ds_sub.getRowCount()+"건";
            break;            
		// 센터 조회
        case "searchCenter" :
            //trace(ds_center.saveXML());
            fn_center_init();
            break;                        
        //subSave
        case "subSave" :
			if(fv_errorFlag == 'Y'){				//에러발생 여부(Y/N)
				gfn_alert(fv_errorMsg);				//에러발생 메시지
				fv_errorFlag = "";
			}else{        
				gfn_alert("msg.save.success");	// 저장 되었습니다.
				//fn_search();
			}
            break;          
        // 저장
        case "save" :
			if(fv_errorFlag == 'Y'){				//에러발생 여부(Y/N)
				gfn_alert(fv_errorMsg);				//에러발생 메시지
				fv_errorFlag = "";
			}else{
				gfn_alert("msg.save.success");	// 저장 되었습니다.
				fn_search();
			}
            break;    
        case "needUpdate" :
			if(fv_errorFlag == 'Y'){				//에러발생 여부(Y/N)
				gfn_alert(fv_errorMsg);				//에러발생 메시지
				fv_errorFlag = "";
			}else{        
				gfn_alert("msg.action.success");	//처리 되었습니다.
				fn_search();
			}
            break;      
		case "returnList" :
			if(fv_errorFlag == 'Y'){				//에러발생 여부(Y/N)
				gfn_alert(fv_errorMsg);				//에러발생 메시지
				fv_errorFlag = "";
			}else{				
				gfn_alert("msg.action.success");	//처리 되었습니다.
				div_return.visible = false;
				div_return.edt_return_remark.value = "";
				fn_search();
			}
            break;                      
		case "returnSub" :
			if(fv_errorFlag == 'Y'){				//에러발생 여부(Y/N)
				gfn_alert(fv_errorMsg);				//에러발생 메시지
				fv_errorFlag = "";
			}else{
				gfn_alert("msg.action.success");	//처리 되었습니다.
				div_sub_return.edt_return_remark.value = "";
				div_sub_return.visible = false;
				//fn_searchDetail();
				fn_search();
			}
            break;               
            
        case "searchItemFlag" :
			fn_itemflag();
            break;        
		// 코드분류 조회
        case "status" :
			//상태 콤보 박스 초기화
            ds_status.filter("code == '005' || code == '007'");
            ds_status.insertRow(0);
            ds_status.setColumn(0,"codeName", "전체");
            ds_status.setColumn(0,"code", "");
            cbo_status.index = ds_status.findRow("code","007");
            break;  
        // 여신정보 SELECT : 저장 시
		case "searchCreInfoSave" :						
            if (ds_creInfo.getRowCount() == 0) {
				//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				gfn_loadDatasetInfo (ds_creInfo, fv_objColInfo);
            }
            // 여신정보 SET
            fn_setCrdInfoSave();
            break;                                   
    }
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 상태 콤보 박스 조회
 *---------------------------------------------------------------------------------------------*/
function fn_comCode(dataset,type){
		gfn_transaction(this
						,"status"
						,"sm/cmn/common/selectComCode.xdo"
						,""
						,dataset+"=ds_combo"
						,"groupCode="+wrapQuote(type)+" useYn=Y"
						,"fn_callBack"
						,false);
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 센터정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchCenter()
{
    var strSvcID    = "searchCenter";
    var strURL      = "fm/fms/upriceContractUpjangSet/selectCenter.xdo";
    var strInDs     = "";
    var strOutDs    = "ds_center=ds_center";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 구매유형정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchType()
{
    var strSvcID    = "searchType";
    var strURL      = "fm/fmo/orderRequest/selectType.xdo";
    var strInDs     = "";
    var strOutDs    = "ds_type=ds_type";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 구매유형 COMBO 초기화 
 *---------------------------------------------------------------------------------------------*/
function fn_type_init()
{
	var defVal = "";
	//ds_type.filter("poType == '07'");
	ds_type.insertRow(0);
	ds_type.setColumn(0,"typeName","전체");
	ds_type.setColumn(0,"poType","");
	cbo_type.index = 1;
	//cbo_type.enable = false;
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 센터 COMBO 초기화 
 *---------------------------------------------------------------------------------------------*/
function fn_center_init()
{
	var defVal = "";
	var defValNm = "";
	ds_center.filter("centerCode != '*'");
	// COMBO 에 첫번째 Row에 기본값을 SET
	if (ds_center.getRowCount() > 0) {
		defVal = ds_center.getColumn(0, "centerCode");
		defValNm = ds_center.getColumn(0, "centerName");
	}
	cbo_centerCode.value = defVal;
	// 센터코드 다중 COMP SET
	edt_centerCode.value = defValNm;
	edt_centerCode.userdata = defVal;
	ds_search.setColumn(0, "schCode", defVal);	
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 선택한 구매신청서의 상세정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchDetail()
{
	// 선택한 ROW 여부 CHECK
	if(ds_list.rowposition == -1) 
	{
		gfn_alert("msg.noselect", "주문신청정보");	// 주문신청정보를 선택해 주십시오.
		return;
	}
	
	// 조건 SET : 선택한 구매신청번호
	ds_search.setColumn(ds_search.rowposition, "schPrNum", ds_list.getColumn(sRow, "prNum"));	// 구매신청번호
	ds_search.setColumn(ds_search.rowposition, "schSubStatus", ds_list.getColumn(sRow, "soStatus"));	// 상위 상태값
	ds_search.setColumn(ds_search.rowposition, "schCustcd", ds_list.getColumn(sRow, "custcd"));	// 업체 고객사
	ds_search.setColumn(ds_search.rowposition, "schRcUpjang", ds_list.getColumn(sRow, "rcUpjang"));	// 업장 사업장
	
	ds_search.setColumn(ds_search.rowposition, "schUpjang", ds_list.getColumn(sRow, "rcUpjang"));	// 업장 사업장
	ds_search.setColumn(ds_search.rowposition, "schMainUpjang", ds_list.getColumn(sRow, "mainUpjang"));	// 메인 사업장
	ds_search.setColumn(ds_search.rowposition, "schNeedDate", ds_list.getColumn(sRow, "needDate"));	// 메인 사업장
	ds_search.setColumn(ds_search.rowposition, "schHeadCreditYn", ds_list.getColumn(sRow, "headCreditYn"));	// 통합관리여부
    // Grid sort 표시 초기화(필수)
    //gfn_clearSortMark(ds_sub);

   	//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장 
	//fv_objColInfo = gfn_getDatasetInfo (ds_sub);

    var strSvcID    = "searchDetail";
    var strURL      = "fm/fmo/orderDecisionModify/selectSub.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_sub=ds_sub";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 선택한 구매신청서의 상세정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_SubSave()
{
	if (gfn_dsIsUpdated(ds_sub) == false)
 	{
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}
   	
	if(!gfn_confirm("저장 하시겠습니까?"))return;
    var strSvcID    = "subSave";
    var strURL      = "fm/fmo/orderDecisionModify/saveList.xdo";
    var strInDs     = "ds_sub=ds_sub:U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 상단 리스트 주문건 반려
 *---------------------------------------------------------------------------------------------*/
function fn_Listreturn()
{
	if (gfn_dsIsUpdated(ds_list) == false)
 	{
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}
	if(ds_list.findRow("chk" , 1) == -1){
		gfn_alert("반려할 항목을 선택해 주세요.");	// 변경된 내역이 없습니다.
		return;
	}
	if(div_return.edt_return_remark.text == ""){
		gfn_alert("반려사유를 입력해 주세요.");
		return;
	}
	for(var i=0; i < ds_list.getRowCount();i++){
		if(ds_list.getColumn(i,"chk") == 1){
			if(ds_list.getColumn(i, "soStatus") == "005"){
				gfn_alert("결의반려건은 반려할 수 없습니다.");
				ds_list.setColumn(i,"chk", 0);
				return;
			}
			ds_list.setColumn(i,"remark" , div_return.edt_return_remark.text);
			ds_list.setColumn(i,"schDate1" , ds_search.getColumn(0,"schDate1"));
			ds_list.setColumn(i,"schDate2" , ds_search.getColumn(0,"schDate2"));
			ds_list.setColumn(i,"schGubun" , ds_search.getColumn(0,"schGubun"));
		}
	}
 	if(!gfn_confirm("선택된 항목을 반려 처리 하시겠습니까?"))return;

    var strSvcID    = "returnList";
    var strURL      = "fm/fmo/orderDecisionModify/returnList.xdo";
    var strInDs     = "ds_list=ds_list:U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 선택한 구매신청서의 상세정보 조회
 *---------------------------------------------------------------------------------------------*/
function fn_Subreturn()
{
	if (gfn_dsIsUpdated(ds_sub) == false)
 	{
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}
	if(ds_sub.findRow("chk" , 1) == -1){
		gfn_alert("반려할 항목을 선택해 주세요.");	// 변경된 내역이 없습니다.
		return;
	}
	if(div_sub_return.edt_return_remark.text == ""){
		gfn_alert("반려사유를 입력해 주세요.");
		return;
	}
	for(var i=0; i < ds_sub.getRowCount();i++){
		if(ds_sub.getColumn(i,"chk") == 1){
			if(ds_sub.getColumn(i, "soStatus") == "005"){
				gfn_alert("결의반려건은 반려할 수 없습니다.");
				ds_sub.setColumn(i,"chk", 0);
				return;
			}
			ds_sub.setColumn(i,"remark" , div_sub_return.edt_return_remark.text);
		}
	}
 	if(!gfn_confirm("선택된 항목을 반려 처리 하시겠습니까?"))return;
   	
    var strSvcID    = "returnSub";
    var strURL      = "fm/fmo/orderDecisionModify/returnSub.xdo";
    var strInDs     = "ds_sub=ds_sub:U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 상품별 D-DAY CHECK FUNCTION
 *---------------------------------------------------------------------------------------------*/
function fn_getDayStatus(nDdays, nDtimes)
{
	fsp_init(this);			// 고도화관련 Frame 관련 SET

	fn_CurrDateWeek();
	
	var sNeedDate = div_Date.cal_needDate.text;		// 입고일자
	
	if (gfn_length(nDtimes)==2) nDtimes = nDtimes + "00";
	
	//무통제면 패스...
	if (gfn_nvl(nDdays, "0")== "0" ) return "2";
	//디데이체크
	if (gfn_addDate(gds_currdate.getColumn(0,"YMD"),nDdays) > sNeedDate )
		return "0";
	else if ( gfn_addDate(gds_currdate.getColumn(0,"YMD"),nDdays) == sNeedDate )
	{
		//디타임체크
		if ( gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4)> nDtimes )
			return "0";
		else if ( G_fn_GapTime(0, gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,4), nDtimes, "") <= "0030" )
			return "1";
		else
			return "2";
	}
	else
		return "2";
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 자재별 저장 관련 CHECK
 *---------------------------------------------------------------------------------------------*/
function fn_itemCheck()
{
	var nRowCnt = ds_sub.getRowCount();	// DataSet Count
	var v_itemCode = "";
	var sMsg = "";
	
	for (var i = 0 ; i < nRowCnt ; i++)
	{
		
		// 통제가 없는 자재는 제외
		if ( gfn_nvl(ds_sub.getColumn(i,"dDays"), "0")== "0" ) continue;

		// D-DAY, D_TIME CHECK
		/* 2015-10-19 PI요청 제거
		if(cbo_type.value == "07"){
			if (fn_getDayStatus(ds_sub.getColumn(i,"dDays"), ds_sub.getColumn(i,"dTimes")) == "0")
			{
				ds_sub.rowposition = i;
				sMsg = "[" + ds_sub.getColumn(i,"itemName") + "] 자재는 마감시간(D-Days)을 초과하여 주문이 불가합니다.";
				gfn_alert(sMsg, "", "A");
				return false;
			}
		}
		*/
		// 동일한 상품에 대한 최대발주량 CHECK
		if ((ds_sub.getColumn(i,"maxOrdQty") > 0) && ( ds_sub.getCaseSum("itemCode=='"+ds_sub.getColumn(i,"itemCode")+"'&& (soStatus <> '005' && soStatus <> '003') && DOCU_SOURCE <> '01 BO'","PR_QTY") > ds_sub.getColumn(i,"maxOrdQty")))  
		{   
       	    ds_sub.rowposition = i;
			sMsg = "[" + ds_sub.getColumn(i,"itemName") + "] 자재는 최대 결의량" + ds_sub.getColumn(i,"maxOrdQty") + ")를 초과하여 주문이 불가합니다.";
			gfn_alert(sMsg, "", "A");
			return false;
		}		
	}	

	return true;

}
/*----------------------------------------------------------------------------------------------
 * 설명      : 여신정보 조회 (저장용)
 * fn_getCrdInfo 동일
 *---------------------------------------------------------------------------------------------*/
function fn_getCrdInfoSave()
{
   	//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장 
	fv_objColInfo = gfn_getDatasetInfo (ds_creInfo);
    
    // 여신정보 조회
    var strSvcID    = "searchCreInfoSave";
    var strURL      = "fm/fmo/orderRequest/selectCreInfo.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_creInfo=ds_creInfo";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 여신정보를 조회한다 (저장용)
 * fn_setCrdInfo 동일
 *---------------------------------------------------------------------------------------------*/
function fn_setCrdInfoSave()
{
	//여신 표시
	if (ds_creInfo.getRowCount() > 0) {
		if (ds_creInfo.getColumn(ds_creInfo.rowposition,"creditAmountControlYn") == "Y") {
			ed_credit.value = gfn_numFormat(ds_creInfo.getColumn(ds_creInfo.rowposition,"creditRmnAmt"))+ " 원";
			ed_bond.value = gfn_numFormat(ds_creInfo.getColumn(ds_creInfo.rowposition,"bondAmt"))+ " 원";
		} else {
			ed_credit.value = "무 제 한";
		}
	} else {
		var sMsg = "업장여신정보를 확인할 수 없습니다.\n\n";
		sMsg = sMsg + "관리자에게 문의하세요.";
		gfn_alert(sMsg, "", "A");
		return;
	}

	// 여신한도관련 CHECK :  저장 호출
	fn_crdCheck();
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 여신한도 관련 CHECK
 *---------------------------------------------------------------------------------------------*/
function fn_crdCheck()
{
	var sMsg = "";
	
	if (ds_creInfo.rowcount > 0)
	{
		//여신금액
		if (ds_creInfo.getColumn(0,"creditAmountControlYn") == "Y")
		{
			var nAmt = 0;
			for (i = 0; i < ds_sub.getRowCount(); i++){
				nAmt += (Math.round(ds_sub.getColumn(i,"amt"),1.1,1) - Math.round(ds_sub.getColumn(i,"noAmt"),1.1,1));
			}
				//alert("주문금액 : " + nAmt);
				//alert("주문가능금액 : " + toNumber(ds_creInfo.getColumn(0,"creditAvailAmt")));
			if (nAmt > toNumber(ds_creInfo.getColumn(0,"creditAvailAmt")))
			{
				sMsg = "주문가능한 여신한도를 초과하여 주문이 불가합니다.\n\n";
				sMsg = sMsg + " - 여신한도 : " + gfn_numFormat(ds_creInfo.getColumn(0,"creditAvailAmt")) + "\n";
				sMsg = sMsg + " - 주문금액(합계) : " + gfn_numFormat(nAmt) + "\n";
				gfn_alert(sMsg, "", "A");
				return;
			}
		}
		//여신회전일
		if (ds_creInfo.getColumn(0,"creditTurnControlYn") == "Y")
		{
			if (toNumber(ds_creInfo.getColumn(0,"lastTurnCnt")) >= 0)
			{
				if (toNumber(ds_creInfo.getColumn(0,"lastTurnCnt")) > toNumber(ds_creInfo.getColumn(0,"creditTurnDaysTot")))
				{
					sMsg = gfn_getFormat(ds_creInfo.getColumn(0,"lBillDate"), "@@@@-@@-@@")  + "에 매출채권이 존재하여 주문이 불가합니다.";
					gfn_alert(sMsg, "", "A");
					return;
				}
			}
		}
	}
	
	// 정상적인 Save 호출
	fn_SubSave();
}

function btn_cust_onclick(obj:Button,  e:ClickEventInfo)
{
	// 팝업창을 호출한다	
	var strId       = "SaleCustSearch";
	var strURL      = "X_FMS::SalePriceCustSearchPop.xfdl";
	var objArgument = {
		P_DATASET : ds_search
	};
	
	var nWidth      = 513;
	var nHeight     = 495;
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	
	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
	
	if (arrRtn instanceof Object)
	{
		edt_cust.value    = arrRtn["custNm"];
		edt_cust.userdata = arrRtn["custCd"];
		obj.userdata       = arrRtn["custNm"];
		ds_search.setColumn(ds_search.rowposition,"schCust",arrRtn["custCd"]);
	}
}

function edt_cust_onkeydown(obj:Edit, e:KeyEventInfo)
{
		// Del 키
	if(e.keycode == 46) 
	{		
		edt_cust.value="";
		edt_cust.userdata="";
		ds_search.setColumn(ds_search.rowposition, "schCust",	"");
	}
}

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Grid 더블클릭시 결의 상세 조회
 *---------------------------------------------------------------------------------------------*/
function grd_list_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	if(e.row < -1) return;
// 	edt_PoNum.value = ds_list.getColumn(e.row, "prNum");
// 	edt_PoType.value = ds_list.getColumn(e.row, "typeName");
// 	edt_remark.value = ds_list.getColumn(e.row, "itemName");
// 	mak_Amt.value = ds_list.getColumn(e.row, "itemAmt");
// 	sRow = e.row;
	fn_searchDetail();
	// 주문통제정보 조회
	fn_getOrdCtrl();
	// 창고리스트 조회 : 단일건에 대한 창고정보 조회용도로 변경
	fn_searchSubinv();
	
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 결의상세를 저장한다.
 *---------------------------------------------------------------------------------------------*/
function btn_Save_onclick(obj:Button,  e:ClickEventInfo)
{
	/*시스템 통제 시간 체크 - 특정일자에 사용을 할 수 없게 한다.*/
	mfn_GetSystemWorkCheck("PO");
	if (ds_common.getColumn(0, 0) == "Y")
	{
		g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
		return false; 
	}
	
	fn_getCrdInfoSave();
	//fn_SubSave();
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 취소버튼 클릭. 반려를 한다.
 *---------------------------------------------------------------------------------------------*/
function btn_return_onclick(obj:Button,  e:ClickEventInfo)
{
	/*시스템 통제 시간 체크 - 특정일자에 사용을 할 수 없게 한다.*/
	mfn_GetSystemWorkCheck("PO");
	if (ds_common.getColumn(0, 0) == "Y")
	{
		g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
		return false; 
	}
	
	if(ds_list.findRow("chk" , 1) == -1){
		gfn_alert("반려할 항목을 선택해 주세요.");	// 변경된 내역이 없습니다.
		return;
	}

	div_return.position.left = btn_return.position.right - 441;
	div_return.position.width = 441;
	div_return.visible = !div_return.visible;
	//fn_Subreturn();
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 주문상세에 발주량 변경시 자재별 최대 주문 수량 최소 주문 수량체크.
 *---------------------------------------------------------------------------------------------*/
function ds_sub_cancolumnchange(obj:Dataset, e:DSColChangeEventInfo)
{
	// 발주량 0 CHECK
	// - 불가
	if(e.columnid == "poQty"){
		sMsg = "주문수량이 0입니다.";
		
		// 신청수량 < 발주수량 CHECK	
		//  2015-07-17 신청수량 보다 높게 발주 할 수 있음. ( 2015-07-20 ) 다시 막음 . 구매에서 불가.
		if ( (toNumber(obj.getColumn(e.row,"prQty")) < toNumber(e.newvalue)) )
		{
			sMsg = "신청수량을 초과하여 발주할 수 없습니다.";
			gfn_alert(sMsg, "", "A");
			return false;
		}
		
		/*
		//최소발주량 체크
		if ( (toNumber(obj.getColumn(e.row,"minOrdQty")) > 0) && (toNumber(obj.getColumn(e.row,"minOrdQty")) > toNumber(e.newvalue)) )
		{
			sMsg = "해당 자재는 최소결의량이 " + obj.getColumn(e.row,"minOrdQty") + " 입니다.";
			gfn_alert(sMsg, "", "A");
			return false;
		}
		*/
		//최대발주량 체크
		if ( (toNumber(obj.getColumn(e.row,"maxOrdQty")) > 0) && (toNumber(obj.getColumn(e.row,"maxOrdQty")) < toNumber(e.newvalue)) )
		{
			sMsg = "해당 자재는 최대결의량이 " + obj.getColumn(e.row,"maxOrdQty") + " 입니다.";
			gfn_alert(sMsg, "", "A");
			return false;
		}
		//소숫점발주여부
		/*	2015-10-02 제거
		if ( (obj.getColumn(e.row,"pointFlag") != "Y") && (Math.ceil(toNumber(e.newvalue)) != toNumber(e.newvalue)) )
		{
			sMsg = "해당 자재는 소숫점 결의가 불가합니다.";
			gfn_alert(sMsg, "", "A");
			return false;
		}
		*/
		//발주승수량	2015-09-21 제거
		/*
		if ( (toNumber(obj.getColumn(e.row,"multiplierQty")) > 0) && ((Math.round(toNumber(e.newvalue) * 1000) % Math.round(toNumber(obj.getColumn(e.row,"multiplierQty")) * 1000)) <> 0) )
		{
			sMsg = "해당 자재는 결의승수량이 " + obj.getColumn(e.row,"multiplierQty") + " 입니다.";
			gfn_alert(sMsg, "", "A");
			return false;
		}
		*/
	}
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 입고일자 변경에 취소 버튼 클릭. 창닫기.
 *---------------------------------------------------------------------------------------------*/
function div_Date_btn_Close_onclick(obj:Button,  e:ClickEventInfo)
{
	div_Date.cal_needDate.value = "";
	div_Date.edt_remark.value = "";
	div_Date.visible = false;
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 입고일자 변경 - 저장 버튼 클릭.
 *---------------------------------------------------------------------------------------------*/
function btn_chNeedDate_onclick(obj:Button,  e:ClickEventInfo)
{
	/*시스템 통제 시간 체크 - 특정일자에 사용을 할 수 없게 한다.*/
	mfn_GetSystemWorkCheck("PO");
	if (ds_common.getColumn(0, 0) == "Y")
	{
		g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
		return false; 
	}
	
	if(ds_list.getColumn(sRow,"soStatus") == "007"){
		gfn_alert("결의승인건은 입고일자 변경을 할 수 없습니다.");
		return;
	}
	div_Date.position.left = div_center.btn_chNeedDate.position.right - 441;
	div_Date.position.width = 441;
	div_Date.visible = !div_Date.visible;
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 폼 사이즈 변경시 입고일자 변경창 이동.
 *---------------------------------------------------------------------------------------------*/
function OrderDecision_onsize(obj:Form, e:SizeEventInfo)
{
	div_Date.position.left = div_center.btn_chNeedDate.position.right - 441;
	div_Date.position.width = 441;
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 입고일자변경창에 저장 버튼 클릭. -1)
 *---------------------------------------------------------------------------------------------*/
function div_Date_btn_needDateSave_onclick(obj:Button,  e:ClickEventInfo)
{
 	if(sRow == -1 || ds_sub.getRowCount() == 0){
		gfn_alert("변경할 데이터가 없습니다.");
		return;
	}
	
	
	if(gfn_isNull(div_Date.cal_needDate.text)){
		gfn_alert("변경일을 입력해 주세요.");
		div_Date.cal_needDate.setFocus();
		return;
 	}
 	
 	if(gfn_isNull(div_Date.edt_remark.text)){
		gfn_alert("변경사유를 입력해 주세요.");
		div_Date.edt_remark.setFocus();
		return;
 	}
 	
	if(!fn_prCheck1()){
		div_Date.cal_needDate.text = "";
		div_Date.cal_needDate.setFocus();
		return;
	}
 	
 	var sNeedDate = div_Date.cal_needDate.text;		// 화면에서 입력한 입고일
 	
 	var fRow = ds_type.findRow("poType" , ds_list.getColumn(sRow,"poType"));//선택한 row의 poType의 행을 찾는다.
 	

 	
 	// 입고일자 기준 CHECK : 구매유형별
	if (fn_getDayStatus(ds_type.getColumn(fRow,"dDays"), ds_type.getColumn(fRow,"dTimes"), sNeedDate) == "0")
	{
		var sDate = gds_currdate.getColumn(0, "YMD_TM");
		sDate = gfn_getFormat(gfn_subStr(sDate, 0, 8), "@@@@-@@-@@") + " " + gfn_getFormat(gfn_subStr(sDate, 8, 6), "@@:@@:@@");
	
		sMsg = "▶현재시간 : " + sDate + "\n\n";
		sMsg = sMsg + cbo_type.text + " 구매유형 입고일 기준\n";
		sMsg = sMsg + " => (D_DAY = " + ds_type.getColumn(fRow,"dDays") + "일" + ds_type.getColumn(fRow,"dTimes") + "시)\n"
		sMsg = sMsg + "※ 입고일이 " + gfn_getFormat(gfn_addDate(gds_currdate.getColumn(0,"YMD"),ds_type.getColumn(fRow,"dDays")),"@@@@-@@-@@") + " 이전 날짜로는\n";
		sMsg = sMsg + "  구매신청을 할 수 없습니다.";
		gfn_alert(sMsg, "", "A");
		return;
	}
 	
	if(!fn_itemCheck())return;
	
	ds_subflag.clearData();
	ds_search.setColumn(0,"schChgNeedDate",div_Date.cal_needDate.text);
	var strSvcID    = "searchItemFlag";
	var strURL      = "fm/fmo/orderDecision/selectSubFlag.xdo";
	var strInDs     = "ds_search=ds_search:A";
	var strOutDs    = "ds_subflag=ds_subflag";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = true;
		
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 발주가능 CHECK  == 1 STEP 
 *---------------------------------------------------------------------------------------------*/
function fn_prCheck1()
{
	var sMsg = "";
	
	// 창고기본값 선택 시 : 발주마감일자 GET
	// 마감시간 설정 : fn_setTimer() 포함
	//fn_getDays();

	// 주문통제일자 호출
	fn_getNeedDate(false);
	
	// 주문통제일자 CHECK
	if (fv_needFlag) {
		sMsg = "해당일자는 입고통제일 입니다.\r작업을 취소합니다.";
		gfn_alert(sMsg, "", "A");
		return false;
	}

	var sNeedDate = div_Date.cal_needDate.text;
	
	//발주통제일자
// 	if (toNumber(ds_days.getColumn(0,"dOverDays")) > 0)
// 	{
// 		if (sNeedDate > gfn_addDate(gds_currdate.getColumn(0, "YMD"),toNumber(ds_days.getColumn(0,"dOverDays"))))
// 		{
// 			sMsg = ds_days.getColumn(0,"dOverDays") + " 일을 초과하여 입고예정일을 지정할 수 없습니다.\r작업을 취소합니다.";
// 			gfn_alert(sMsg, "", "A");
// 			return false;
// 		}
// 	}
	

	//발주제한일자
// 	if (toNumber(ds_days.getColumn(0,"dDays")) > 0)
// 	{
// 		if (sNeedDate < gfn_addDate(gds_currdate.getColumn(0, "YMD"),toNumber(ds_days.getColumn(0,"dDays"))))
// 		{
// 			sMsg = "발주마감은 " + ds_days.getColumn(0,"days") + " 입니다.\r작업을 취소합니다.";
// 			gfn_alert(sMsg, "", "A");
// 			return false;
// 		}
// 		if (sNeedDate == gfn_addDate(gds_currdate.getColumn(0, "YMD"),toNumber(ds_days.getColumn(0,"dDays"))))
// 		{
// 			if (gfn_subStr(gds_currdate.getColumn(0, "YMD_TM"),8,6)> ds_days.getColumn(0,"dTimes"))
// 			{
// 				sMsg = "발주마감은 " + ds_days.getColumn(0,"days") + " 입니다.\r작업을 취소합니다.";
// 				gfn_alert(sMsg, "", "A");
// 				return false;
// 			}
// 		}
// 	}
	//창고가 식재 또는 소모품, 공통 전용창고인 경우 주문통제 점검
	if (!gfn_isNull(ds_subinv.getColumn(ds_subinv.rowposition,"consumYn")))
	{
		//주문통제(주문일자)
		var nRow;
		nRow = ds_ordCtl.findRowExpr("ctrlType=='주문'&&itemType==decode('" + ds_subinv.getColumn(ds_subinv.rowposition,"consumYn") + "','Y','소모품','식자재')");
		if (nRow >= 0)
		{			
			if (ds_ordCtl.getColumn(nRow,ToLower(gds_currdate.getColumn(0, "WEEK_ENG"))) == "Y")
			{
				sMsg = gds_currdate.getColumn(0, "WEEK_KOR") + "요일은 주문불가 요일입니다.\r작업을 취소합니다.";
				gfn_alert(sMsg, "", "A");
				return false;
			}
		}
		//주문통제(입고일자)
		nRow = ds_ordCtl.findRowExpr("ctrlType=='입고'&&itemType==decode('" + ds_subinv.getColumn(ds_subinv.rowposition,"consumYn") + "','Y','소모품','식자재')");
		if (nRow >= 0)
		{
			if (ds_ordCtl.getColumn(nRow,ToLower(ffn_DayToWeek(sNeedDate,"1"))) == "Y")
			{
				sMsg = ffn_DayToWeek(sNeedDate) + "요일은 입고불가 요일입니다.\r입고예정일을 변경하세요.";
				gfn_alert(sMsg, "", "A");
				return false;
			}
		}
	} else {
		// 공통창고
		// 주문통제(주문일자)
		var nRow;
		nRow = ds_ordCtl.findRowExpr("ctrlType=='주문'&&itemType=='공통'");
		if (nRow >= 0)
		{			
			if (ds_ordCtl.getColumn(nRow,ToLower(gds_currdate.getColumn(0, "WEEK_ENG"))) == "Y")
			{
				sMsg = gds_currdate.getColumn(0, "WEEK_KOR") + "요일은 주문불가 요일입니다.\r작업을 취소합니다.";
				gfn_alert(sMsg, "", "A");
				return false;
			}
		}
		//주문통제(입고일자)
		nRow = ds_ordCtl.findRowExpr("ctrlType=='입고'&&itemType=='공통'");
		if (nRow >= 0)
		{
			if (ds_ordCtl.getColumn(nRow,ToLower(ffn_DayToWeek(sNeedDate,"1"))) == "Y")
			{
				sMsg = ffn_DayToWeek(sNeedDate) + "요일은 입고불가 요일입니다.\r입고예정일을 변경하세요.";
				gfn_alert(sMsg, "", "A");
				return false;
			}
		}
	}
	
	
	return true;
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 사용자에 대한 창고리스트 가져오기
 *---------------------------------------------------------------------------------------------*/
function fn_searchSubinv()
{
   	//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장 
	fv_objColInfo = gfn_getDatasetInfo (ds_subinv);
    
    ds_search.setColumn(ds_search.rowposition, "schSubinvCode", ds_list.getColumn(ds_list.rowposition, "subinvCode"));
    //SubinvCode
    
    var strSvcID    = "searchSubinv";
	var strURL		= "";
	//if (fv_flag == "I")
	//	strURL      = "fm/fmo/orderRequest/selectSubinv.xdo";
	//else
		strURL      = "fm/fmo/orderRequest/selectSubinv2.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_subinv=ds_subinv";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 선택한 업장에 대한 주문통제 정보 표시
 * FMP_ORD_CTRL
 *---------------------------------------------------------------------------------------------*/
function fn_getOrdCtrl()
{
   	//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장 
	fv_objColInfo = gfn_getDatasetInfo (ds_ordCtl);


    // 주문통제 정보 GET
    var strSvcID    = "searchOrdCtrl";
    var strURL      = "fm/fmo/orderRequest/selectOrdCtrl.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_ordCtl=ds_ordCtl";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 주문통제일자 CHECK GET, FMP_ORD_CTRL_DAYS
 * 관련함수  : fn_prCheck에서 호출
 *---------------------------------------------------------------------------------------------*/
function fn_getNeedDate(bAsync)
{
	fv_needFlag = false;

    // 주문통제 CHECK
    var strSvcID    = "searchOrdCtrlDays";
    var strURL      = "fm/fmo/orderRequest/selectOrdCtrlDays.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    //var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 입고일자변경창에 저장 버튼 클릭. -2)
 *---------------------------------------------------------------------------------------------*/
function fn_itemflag(){
	//trace(ds_subflag.saveXML());
	if(ds_subflag.getRowCount() > 0){
		for(var i=0; i < ds_subflag.getRowCount();i++){
			// 1.주문통제요일 CHECK  --> 입고일자 CHECK
			if (ds_subflag.getColumn(i, "ordFlag")=="Y") 
			{
				gfn_alert("주문불가 요일("+gfn_getDayName(ds_subflag.getColumn(i, "needDate"))+") 입니다.");
				div_Date.cal_needDate.setFocus();
				return;
				
			}
			// 2.주문통제일자 CHECK   --> 입고일자 CHECK
			if (ds_subflag.getColumn(i, "ordDaysFlag")=="Y") 
			{
				gfn_alert("입고불가 일자 입니다.");
				div_Date.cal_needDate.setFocus();
				return;
			}
			//============================자재별=============================// 
			// 구매수발주제한 : HK  (제한X)   : --- fn_errorFlag
			if (ds_subflag.getColumn(i,"poStatus")!="HK") {
				gfn_alert("해당 자재는 구매수발주 제한이 있습니다.");
				ds_sub.rowposition = i;
				return;
			} 
			// 식재수발주제한 : Y (제한)         --- fn_errorFlag
			if (ds_subflag.getColumn(i,"fmpStatus")!="N") {
				gfn_alert("해당 자재는 식재수발주 제한이 있습니다.");
				ds_sub.rowposition = i;
				return;
			}
		}
	}
	fn_chgDate();//입고일자 변경 저장.
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 입고일자변경창에 저장 버튼 클릭. -3)
 *---------------------------------------------------------------------------------------------*/
function fn_chgDate(){
 	
	var strURL      = "";
	var strInDs     = "";
	if(ds_sub.findRow("chk",1) == -1){
		ds_Srow.addRow();
		ds_Srow.setColumn(0,"chgneedDate", div_Date.cal_needDate.text);
		ds_Srow.setColumn(0,"chgRemark", div_Date.edt_remark.text);
		ds_Srow.setColumn(0,"prNum",	ds_list.getColumn(sRow,"prNum"));
		ds_Srow.setColumn(0,"poNum",	ds_list.getColumn(sRow,"poNum"));
		ds_Srow.setColumn(0,"centerCode",	ds_list.getColumn(sRow,"centerCode"));
		ds_Srow.setColumn(0,"poType",	ds_list.getColumn(sRow,"poType"));
		ds_Srow.setColumn(0,"rcUpjang",	ds_list.getColumn(sRow,"rcUpjang"));
		ds_Srow.setColumn(0,"lineStatus",	ds_list.getColumn(sRow,"lineStatus"));
		ds_Srow.setColumn(0,"soStatus",	ds_list.getColumn(sRow,"soStatus"));
		ds_Srow.setColumn(0,"prSabun",	ds_list.getColumn(sRow,"prSabun"));
		ds_Srow.setColumn(0,"schDate1",	ds_search.getColumn(0,"schDate1"));
		ds_Srow.setColumn(0,"schDate2",	ds_search.getColumn(0,"schDate2"));
		

	
		strURL      = "fm/fmo/orderDecision/needupdateall.xdo";
		strInDs     = "ds_Srow=ds_Srow:U";
		if(!gfn_confirm("선택된 주문신청번호의 입고일을 일괄로 변경하시겠습니까?"))return;
	}else{
		ds_sub.addColumn("chgneedDate","STRING", 256);
		ds_sub.addColumn("chgRemark","STRING", 256);
		ds_sub.addColumn("usrNm","STRING", 256);
		
		for(var i=0; i < ds_sub.getRowCount();i++){
			if(ds_sub.getColumn(i,"chk") == 1){
				ds_sub.setColumn(i,"chgneedDate", div_Date.cal_needDate.text);
				ds_sub.setColumn(i,"chgRemark", div_Date.edt_remark.text);
			}
		}
		strURL      = "fm/fmo/orderDecision/needupdate.xdo";
		strInDs     = "ds_sub=ds_sub:U";
		if(!gfn_confirm("선택된 자재의 입고일을 변경하시겠습니까?"))return;
	}

	var strSvcID    = "needUpdate";
	var strOutDs    = "";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 체크박스에 체크할경우 해당행에 deptid를 넣어준다.
 *---------------------------------------------------------------------------------------------*/
function ds_list_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if(e.columnid == "chk"){
		obj.setColumn(e.row ,"poDeptId" , g_Deptid);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조건 Dataset 변경 시 Clear
 *---------------------------------------------------------------------------------------------*/
function ds_search_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	// 조건 변경 시 DataSet Clear	
	if (e.columnid == "schCenter" || e.columnid == "schDate1" || e.columnid == "schDate2" || e.columnid == "schType" || e.columnid == "schStatus" || e.columnid == "schCsSabun" || e.columnid == "schCode") {
		ds_list.clearData();
		ds_sub.clearData();
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조건 Dataset ROW 변경 시 
 *---------------------------------------------------------------------------------------------*/
function ds_list_onrowposchanged(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	div_center.edt_PoNum.value = obj.getColumn(obj.rowposition, "prNum");
	div_center.edt_PoType.value = obj.getColumn(obj.rowposition, "typeName");
	div_center.edt_remark.value = obj.getColumn(obj.rowposition, "itemName");
	div_center.mak_Amt.value = obj.getColumn(obj.rowposition, "itemAmt");
	sRow = obj.rowposition;
	
	// 하위상세내역은 기본적으로 Clear
	ds_sub.clearData();
	Static37.text = "주문내역";
}

function OrderDecision_onkeydown(obj:Form, e:KeyEventInfo)
{
	if(e.keycode == 36){
		st_Credit.visible = !st_Credit.visible;
		ed_credit.visible = !ed_credit.visible;
		st_Bond.visible = !st_Bond.visible;
		ed_bond.visible = !ed_bond.visible;
	}
}

function ds_list_canrowposchange(obj:Dataset, e:DSRowPosChangeEventInfo)
{
	// v_ds_check 미사용시 변경사항 체크
 	if (gfn_dsIsUpdated(ds_sub) == true) 
 	{
 		var retValue = gfn_confirm("confirm.before.moveropos");	// 해당 row의 위치를 이동하면 변경된 데이터가 사라집니다.@계속 진행 하시겠습니까?

 		if (retValue == false) return false;
 	}
}

function div_return_btn_needDateSave_onclick(obj:Button,  e:ClickEventInfo)
{
	
	fn_Listreturn();
}

function btn_Return_onclick(obj:Button,  e:ClickEventInfo)
{
	/*시스템 통제 시간 체크 - 특정일자에 사용을 할 수 없게 한다.*/
	mfn_GetSystemWorkCheck("PO");
	if (ds_common.getColumn(0, 0) == "Y")
	{
		g_Message("EE", "시스템 변경 작업중이라 현 화면을 사용할 수 없습니다. \n사용불가시간(" + ds_common.getColumn(0, 1) + " ~ " + ds_common.getColumn(0, 2) + ") ");
		return false; 
	}
	
	if(ds_sub.getRowCount() == 0){
		gfn_alert("데이터가 없습니다.");
		return;
	}
	if(ds_sub.findRow("chk",1) == -1){
		gfn_alert("반려할 항목을 선택해 주세요.");
		return;
	}
	div_sub_return.edt_return_remark.value = "";
	div_sub_return.position.top = div_center.position.top + 50;
	div_sub_return.position.height = 84;
	div_sub_return.position.left = div_center.btn_Return.position.right - 441;
	div_sub_return.position.width = 441;
	div_sub_return.visible = !div_sub_return.visible;
}

function div_return_btn_Close_onclick(obj:Button,  e:ClickEventInfo)
{
	div_return.edt_return_remark.value = "";
	div_return.visible = false;
}

function div_sub_return_btn_Close_onclick(obj:Button,  e:ClickEventInfo)
{
	div_sub_return.edt_return_remark.value = "";
	div_sub_return.visible = false;
}

function sp_line_onmove(obj:Splitter, e:MoveEventInfo)
{
	div_center.position.top = e.y + 5;
	div_center.position.height = 52;
	Static37.position.top = e.y + 66;
	Static37.position.height = 18;
	grd_sub.position.top = e.y + 85;
	
	if(div_Date.visible == true){//입고일자 변경
		div_Date.position.top = e.y + 56;
		div_Date.position.height = 84;
	}
	if(div_sub_return.visible == true){//반려내역
		div_sub_return.position.top = e.y + 56;
		div_sub_return.position.height = 84;
	}
}

function ds_sub_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if(e.columnid == "poQty"){
		trace("수량변경 금액 : " + ds_sub.getColumn(e.row,"salePrice") * e.newvalue);
		ds_sub.setColumn(e.row,"amt",ds_sub.getColumn(e.row,"salePrice") * e.newvalue);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : CS담당 팝업 화면 호출
 *---------------------------------------------------------------------------------------------*/
function fn_csSabunPop()
{
	var strReturn,strResult,nRow;
	var strCodeCol,strNameCol,strTitle,strSerchSvc,strText,arg1,nullyn;
	
	strCodeCol 	= "schCsSabun"; 
	strNameCol 	= "schCsSabunNm";
	strTitle	= "C/S 사원";
	strText		= "SABUN;NM_KOR";

	fn_sql_common_setup( strMAQuery_SABUN
						,strMAQuery_SABUNKeyField
						,strMAQuery_SABUNValueField
						,strMAQuery_SABUNKeyFieldNM
						,strMAQuery_SABUNValueFieldNM
						,""
						,""
						," AND MU_CD = '2004'"
						,strTitle
						,strText
						);

	nRow = ds_search.rowposition;
	
	if(gds_sql_common.getColumn(0, "ret_code") == '')
	{
		return
	}
	
	edt_sabunNm.value = gds_sql_common.getColumn(0, "ret_name");
	edt_sabunNm.userdata = gds_sql_common.getColumn(0, "ret_code");
	
	ds_search.setColumn(nRow,strNameCol,gds_sql_common.getColumn(0, "ret_name"));
	ds_search.setColumn(nRow,strCodeCol,gds_sql_common.getColumn(0, "ret_code"));
}

function edt_sabunNm_onkeydown(obj:Edit, e:KeyEventInfo)
{
	// Del 키
	if(e.keycode == 46) 
	{	
		// 고객사 정보 초기화
		edt_sabunNm.value="";
		edt_sabunNm.userdata="";
		ds_search.setColumn(ds_search.rowposition, "schCsSabun", "");
		ds_search.setColumn(ds_search.rowposition, "schCsSabunNm", "");
	}

	// Enter 키
	if(e.keycode == 13) 
	{		
		fn_csSabunPop();
	}	
}

// 센터코드 클릭
function btn_centerCode_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_centerCodePop();
}

function fn_centerCodePop()
{
	// 팝업창을 호출한다	
	var strId       = "CenterCodePop";
	var strURL      = "X_FMO::CenterCodePop.xfdl";
	var objArgument = {
		P_DATASET : ds_search
	};
	
	var nWidth      = 281;
	var nHeight     = 290;
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	
	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);
	
	if (arrRtn instanceof Object)
	{
		// 리턴값 처리
		edt_centerCode.value    = arrRtn["centerName"];
		edt_centerCode.userdata = arrRtn["centerCode"];
		
		// ds_search SET
		ds_search.setColumn(0, "schCode", arrRtn["centerCode"]);
	}
}




function div_center_btn_searchAll_onclick(obj:Button,  e:ClickEventInfo)
{
	trace(ds_list.rowcount);
	if(ds_list.rowcount == 0)
	{
		gfn_alert("먼저 상단조회를 해주세요");
	}else
	{
		fn_searchAll();
	}
}

function fn_searchAll()
{

// 조건 SET : 선택한 구매신청번호
	ds_search.setColumn(ds_search.rowposition, "schPrNum", ds_list.getColumn(sRow, "prNum"));	// 구매신청번호
	ds_search.setColumn(ds_search.rowposition, "schSubStatus", ds_list.getColumn(sRow, "soStatus"));	// 상위 상태값
	ds_search.setColumn(ds_search.rowposition, "schCustcd", ds_list.getColumn(sRow, "custcd"));	// 업체 고객사
	ds_search.setColumn(ds_search.rowposition, "schRcUpjang", ds_list.getColumn(sRow, "rcUpjang"));	// 업장 사업장
	
	ds_search.setColumn(ds_search.rowposition, "schUpjang", ds_list.getColumn(sRow, "rcUpjang"));	// 업장 사업장
	ds_search.setColumn(ds_search.rowposition, "schMainUpjang", ds_list.getColumn(sRow, "mainUpjang"));	// 메인 사업장
	ds_search.setColumn(ds_search.rowposition, "schNeedDate", ds_list.getColumn(sRow, "needDate"));	// 메인 사업장
	ds_search.setColumn(ds_search.rowposition, "schHeadCreditYn", ds_list.getColumn(sRow, "headCreditYn"));	// 통합관리여부
	
    var strSvcID    = "searchDetailAll";
    var strURL      = "fm/fmo/orderDecisionModify/selectSubAll.xdo";
    var strInDs     = "ds_list=ds_list:A";
    var strOutDs    = "ds_sub=ds_sub";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}]]></Script>
  </Form>
</FDL>

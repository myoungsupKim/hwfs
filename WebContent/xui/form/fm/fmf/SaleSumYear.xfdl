<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="SaleSumYear" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="월별매출집계" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="1" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30" tabstop="false"/>
        <Static id="Static19" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 72 450 85"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 72" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 1260 40" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 93 71" anchor="left top"/>
        <Static id="Static15" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 98 450 113" anchor="left top"/>
        <Static id="Static28" text="관리부서" class="sta_WFSA_label" position="absolute 343 40 405 61" anchor="left top"/>
        <Static id="Static26" text="본사" class="sta_WFSA_label" position="absolute 614 41 676 62" anchor="left top"/>
        <Static id="Static18" text="월별매출집계" class="sta_WF_Title01" position="absolute 0 85 450 103" anchor="left top"/>
        <Static id="Static30" text="영업담당" class="sta_WFSA_label" position="absolute 860 41 920 62" anchor="left top"/>
        <Static id="Static00" text="W10" visible="false" position="absolute 400 40 410 70" style="background:#ff000055;align:center middle;"/>
        <Static id="Static09" text="W30" visible="false" position="absolute 583 40 613 70" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <Static id="Static01" text="W10" visible="false" position="absolute 647 39 657 69" style="background:#ff000055;align:center middle;"/>
        <Static id="Static02" text="W30" visible="false" position="absolute 830 40 860 70" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <Static id="Static11" text="W10" visible="false" position="absolute 919 39 929 69" style="background:#ff000055;align:center middle;"/>
        <Static id="Static16" text="W30" visible="false" position="absolute 310 40 340 70" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <Static id="Static17" text="W10" visible="false" position="absolute 200 40 210 70" style="background:#ff000055;align:center middle;"/>
        <Grid id="grd_list" taborder="33" binddataset="ds_list" autoenter="select" useinputpanel="false" cellsizingtype="col" autofittype="none" position="absolute 0 113 1237 710" anchor="all">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40" band="left"/>
                <Column size="150" band="left"/>
                <Column size="50" band="left"/>
                <Column size="120" band="left"/>
                <Column size="120" band="left"/>
                <Column size="106"/>
                <Column size="103"/>
                <Column size="103"/>
                <Column size="106"/>
                <Column size="103"/>
                <Column size="103"/>
                <Column size="106"/>
                <Column size="103"/>
                <Column size="103"/>
                <Column size="106"/>
                <Column size="103"/>
                <Column size="103"/>
                <Column size="106"/>
                <Column size="103"/>
                <Column size="103"/>
                <Column size="106"/>
                <Column size="103"/>
                <Column size="103"/>
                <Column size="106"/>
                <Column size="103"/>
                <Column size="103"/>
                <Column size="106"/>
                <Column size="103"/>
                <Column size="103"/>
                <Column size="106"/>
                <Column size="103"/>
                <Column size="103"/>
                <Column size="106"/>
                <Column size="103"/>
                <Column size="103"/>
                <Column size="106"/>
                <Column size="103"/>
                <Column size="103"/>
                <Column size="106"/>
                <Column size="103"/>
                <Column size="103"/>
                <Column size="106"/>
                <Column size="103"/>
                <Column size="103"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="26" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel" taborder="undefined"/>
                <Cell col="1" rowspan="2" text="관리부서" taborder="undefined"/>
                <Cell col="2" rowspan="2" text="본사" taborder="undefined"/>
                <Cell col="3" rowspan="2" text="본사명" taborder="undefined"/>
                <Cell col="4" rowspan="2" text="영업사원" taborder="undefined"/>
                <Cell col="5" colspan="3" taborder="undefined"/>
                <Cell col="8" colspan="3" taborder="undefined"/>
                <Cell col="11" colspan="3" taborder="undefined"/>
                <Cell col="14" colspan="3" taborder="undefined"/>
                <Cell col="17" colspan="3" taborder="undefined"/>
                <Cell col="20" colspan="3" taborder="undefined"/>
                <Cell col="23" colspan="3" taborder="undefined"/>
                <Cell col="26" colspan="3" taborder="undefined"/>
                <Cell col="29" colspan="3" taborder="undefined"/>
                <Cell col="32" colspan="3" taborder="undefined"/>
                <Cell col="35" colspan="3" taborder="undefined"/>
                <Cell col="38" colspan="3" taborder="undefined"/>
                <Cell col="41" colspan="3" text="누계" taborder="undefined"/>
                <Cell row="1" col="5" text="매출합(VAT제외)"/>
                <Cell row="1" col="6" text="순수이익액"/>
                <Cell row="1" col="7" text="순수이익율"/>
                <Cell row="1" col="8" text="매출합(VAT제외)"/>
                <Cell row="1" col="9" text="순수이익액"/>
                <Cell row="1" col="10" text="순수이익율"/>
                <Cell row="1" col="11" text="매출합(VAT제외)"/>
                <Cell row="1" col="12" text="순수이익액"/>
                <Cell row="1" col="13" text="순수이익율"/>
                <Cell row="1" col="14" text="매출합(VAT제외)"/>
                <Cell row="1" col="15" text="순수이익액"/>
                <Cell row="1" col="16" text="순수이익율"/>
                <Cell row="1" col="17" text="매출합(VAT제외)"/>
                <Cell row="1" col="18" text="순수이익액"/>
                <Cell row="1" col="19" text="순수이익율"/>
                <Cell row="1" col="20" text="매출합(VAT제외)"/>
                <Cell row="1" col="21" text="순수이익액"/>
                <Cell row="1" col="22" text="순수이익율"/>
                <Cell row="1" col="23" text="매출합(VAT제외)"/>
                <Cell row="1" col="24" text="순수이익액"/>
                <Cell row="1" col="25" text="순수이익율"/>
                <Cell row="1" col="26" text="매출합(VAT제외)"/>
                <Cell row="1" col="27" text="순수이익액"/>
                <Cell row="1" col="28" text="순수이익율"/>
                <Cell row="1" col="29" text="매출합(VAT제외)"/>
                <Cell row="1" col="30" text="순수이익액"/>
                <Cell row="1" col="31" text="순수이익율"/>
                <Cell row="1" col="32" text="매출합(VAT제외)"/>
                <Cell row="1" col="33" text="순수이익액"/>
                <Cell row="1" col="34" text="순수이익율"/>
                <Cell row="1" col="35" text="매출합(VAT제외)"/>
                <Cell row="1" col="36" text="순수이익액"/>
                <Cell row="1" col="37" text="순수이익율"/>
                <Cell row="1" col="38" text="매출합(VAT제외)"/>
                <Cell row="1" col="39" text="순수이익액"/>
                <Cell row="1" col="40" text="순수이익율"/>
                <Cell row="1" col="41" text="매출합(VAT제외)"/>
                <Cell row="1" col="42" text="순수이익액"/>
                <Cell row="1" col="43" text="순수이익율"/>
              </Band>
              <Band id="body">
                <Cell style="background2: ;" text="expr:currow+1"/>
                <Cell col="1" displaytype="text" style="background2: ;" text="bind:ccNm"/>
                <Cell col="2" displaytype="text" style="align:center middle;background2: ;" text="bind:mainUpjang"/>
                <Cell col="3" displaytype="text" style="background2: ;" text="bind:mainUpjangnm"/>
                <Cell col="4" displaytype="text" style="background2: ;" text="bind:partSalesSabun"/>
                <Cell col="5" displaytype="number" style="background2: ;" text="bind:a1" mask="#,##0"/>
                <Cell col="6" displaytype="number" style="background2: ;" text="bind:a2" mask="#,##0"/>
                <Cell col="7" displaytype="number" style="background2: ;" text="bind:a3" mask="#,##0.#0"/>
                <Cell col="8" displaytype="number" style="background2: ;" text="bind:b1" mask="#,##0"/>
                <Cell col="9" displaytype="number" style="background2: ;" text="bind:b2" mask="#,##0"/>
                <Cell col="10" displaytype="number" style="background2: ;" text="bind:b3" mask="#,##0.#0"/>
                <Cell col="11" displaytype="number" style="background2: ;" text="bind:c1" mask="#,##0"/>
                <Cell col="12" displaytype="number" style="background2: ;" text="bind:c2" mask="#,##0"/>
                <Cell col="13" displaytype="number" style="background2: ;" text="bind:c3" mask="#,##0.#0"/>
                <Cell col="14" displaytype="number" style="background2: ;" text="bind:d1" mask="#,##0"/>
                <Cell col="15" displaytype="number" style="background2: ;" text="bind:d2" mask="#,##0"/>
                <Cell col="16" displaytype="number" style="background2: ;" text="bind:d3" mask="#,##0.#0"/>
                <Cell col="17" displaytype="number" style="background2: ;" text="bind:e1" mask="#,##0"/>
                <Cell col="18" displaytype="number" style="background2: ;" text="bind:e2" mask="#,##0"/>
                <Cell col="19" displaytype="number" style="background2: ;" text="bind:e3" mask="#,##0.#0"/>
                <Cell col="20" displaytype="number" style="background2: ;" text="bind:f1" mask="#,##0"/>
                <Cell col="21" displaytype="number" style="background2: ;" text="bind:f2" mask="#,##0"/>
                <Cell col="22" displaytype="number" style="background2: ;" text="bind:f3" mask="#,##0.#0"/>
                <Cell col="23" displaytype="number" style="background2: ;" text="bind:g1" mask="#,##0"/>
                <Cell col="24" displaytype="number" style="background2: ;" text="bind:g2" mask="#,##0"/>
                <Cell col="25" displaytype="number" style="background2: ;" text="bind:g3" mask="#,##0.#0"/>
                <Cell col="26" displaytype="number" style="background2: ;" text="bind:h1" mask="#,##0"/>
                <Cell col="27" displaytype="number" style="background2: ;" text="bind:h2" mask="#,##0"/>
                <Cell col="28" displaytype="number" style="background2: ;" text="bind:h3" mask="#,##0.#0"/>
                <Cell col="29" displaytype="number" style="background2: ;" text="bind:i1" mask="#,##0"/>
                <Cell col="30" displaytype="number" style="background2: ;" text="bind:i2" mask="#,##0"/>
                <Cell col="31" displaytype="number" style="background2: ;" text="bind:i3" mask="#,##0.#0"/>
                <Cell col="32" displaytype="number" style="background2: ;" text="bind:j1" mask="#,##0"/>
                <Cell col="33" displaytype="number" style="background2: ;" text="bind:j2" mask="#,##0"/>
                <Cell col="34" displaytype="number" style="background2: ;" text="bind:j3" mask="#,##0.#0"/>
                <Cell col="35" displaytype="number" style="background2: ;" text="bind:k1" mask="#,##0"/>
                <Cell col="36" displaytype="number" style="background2: ;" text="bind:k2" mask="#,##0"/>
                <Cell col="37" displaytype="number" style="background2: ;" text="bind:k3" mask="#,##0.#0"/>
                <Cell col="38" displaytype="number" style="background2: ;" text="bind:l1" mask="#,##0"/>
                <Cell col="39" displaytype="number" style="background2: ;" text="bind:l2" mask="#,##0"/>
                <Cell col="40" displaytype="number" style="background2: ;" text="bind:l3" mask="#,##0.#0"/>
                <Cell col="41" displaytype="number" style="background2: ;" text="expr:a1+b1+c1+d1+e1+f1+g1+h1+i1+j1+k1+l1" mask="#,##0"/>
                <Cell col="42" displaytype="number" style="background2: ;" text="expr:a2+b2+c2+d2+e2+f2+g2+h2+i2+j2+k2+l2" mask="#,##0"/>
                <Cell col="43" displaytype="number" style="background2: ;" text="expr:(a3+b3+c3+d3+e3+f3+g3+h3+i3+j3+k3+l3) / 12" mask="#,##0.#0%"/>
              </Band>
              <Band id="summary">
                <Cell colspan="5" style="align:right;" text="합계" taborder="undefined"/>
                <Cell col="5" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('a1')"/>
                <Cell col="6" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('a2')"/>
                <Cell col="7" style="align:right;" expr="expr:expr:gfn_round(gfn_parseFloat((ds_list.getSum(&quot;a2&quot;)/ds_list.getSum(&quot;a1&quot;)) * 100),2)"/>
                <Cell col="8" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('b1')"/>
                <Cell col="9" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('b2')"/>
                <Cell col="10" style="align:right;" expr="expr:expr:gfn_round(gfn_parseFloat((ds_list.getSum(&quot;b2&quot;)/ds_list.getSum(&quot;b1&quot;)) * 100),2)"/>
                <Cell col="11" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('c1')"/>
                <Cell col="12" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('c2')"/>
                <Cell col="13" style="align:right;" expr="expr:expr:gfn_round(gfn_parseFloat((ds_list.getSum(&quot;c2&quot;)/ds_list.getSum(&quot;c1&quot;)) * 100),2)"/>
                <Cell col="14" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('d1')"/>
                <Cell col="15" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('d2')"/>
                <Cell col="16" style="align:right;" expr="expr:expr:gfn_round(gfn_parseFloat((ds_list.getSum(&quot;d2&quot;)/ds_list.getSum(&quot;d1&quot;)) * 100),2)"/>
                <Cell col="17" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('e1')"/>
                <Cell col="18" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('e2')"/>
                <Cell col="19" style="align:right;" expr="expr:expr:gfn_round(gfn_parseFloat((ds_list.getSum(&quot;e2&quot;)/ds_list.getSum(&quot;e1&quot;)) * 100),2)"/>
                <Cell col="20" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('f1')"/>
                <Cell col="21" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('f2')"/>
                <Cell col="22" style="align:right;" expr="expr:expr:gfn_round(gfn_parseFloat((ds_list.getSum(&quot;f2&quot;)/ds_list.getSum(&quot;f1&quot;)) * 100),2)"/>
                <Cell col="23" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('g1')"/>
                <Cell col="24" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('g2')"/>
                <Cell col="25" style="align:right;" expr="expr:expr:gfn_round(gfn_parseFloat((ds_list.getSum(&quot;g2&quot;)/ds_list.getSum(&quot;g1&quot;)) * 100),2)"/>
                <Cell col="26" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('h1')"/>
                <Cell col="27" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('h2')"/>
                <Cell col="28" style="align:right;" expr="expr:gfn_round(gfn_parseFloat((ds_list.getSum(&quot;h2&quot;)/ds_list.getSum(&quot;h1&quot;)) * 100),2)"/>
                <Cell col="29" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('i1')"/>
                <Cell col="30" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('i2')"/>
                <Cell col="31" style="align:right;" expr="expr:expr:gfn_round(gfn_parseFloat((ds_list.getSum(&quot;i2&quot;)/ds_list.getSum(&quot;i1&quot;)) * 100),2)"/>
                <Cell col="32" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('j1')"/>
                <Cell col="33" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('j2')"/>
                <Cell col="34" style="align:right;" expr="expr:expr:gfn_round(gfn_parseFloat((ds_list.getSum(&quot;j2&quot;)/ds_list.getSum(&quot;j1&quot;)) * 100),2)"/>
                <Cell col="35" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('k1')"/>
                <Cell col="36" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('k2')"/>
                <Cell col="37" style="align:right;" expr="expr:expr:gfn_round(gfn_parseFloat((ds_list.getSum(&quot;k2&quot;)/ds_list.getSum(&quot;k1&quot;)) * 100),2)"/>
                <Cell col="38" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('l1')"/>
                <Cell col="39" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('l2')"/>
                <Cell col="40" style="align:right;" expr="expr:expr:gfn_round(gfn_parseFloat((ds_list.getSum(&quot;l2&quot;)/ds_list.getSum(&quot;l1&quot;)) * 100),2)"/>
                <Cell col="41" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('a1')+ds_list.getSum('b1')+ds_list.getSum('c1')+ds_list.getSum('d1')+ds_list.getSum('e1')+ds_list.getSum('f1')+ds_list.getSum('g1')+ds_list.getSum('h1')+ds_list.getSum('i1')+ds_list.getSum('j1')+ds_list.getSum('k1')+ds_list.getSum('l1')"/>
                <Cell col="42" displaytype="number" style="align:right;" expr="expr:ds_list.getSum('a2')+ds_list.getSum('b2')+ds_list.getSum('c2')+ds_list.getSum('d2')+ds_list.getSum('e2')+ds_list.getSum('f2')+ds_list.getSum('g2')+ds_list.getSum('h2')+ds_list.getSum('i2')+ds_list.getSum('j2')+ds_list.getSum('k2')+ds_list.getSum('l2')"/>
                <Cell col="43" style="align:right;" expr="expr:toNumber(gfn_round((ds_list.getAvg('a3')+ds_list.getAvg('b3')+ds_list.getAvg('c3')+ds_list.getAvg('d3')+ds_list.getAvg('e3')+ds_list.getAvg('f3')+ds_list.getAvg('g3')+ds_list.getAvg('h3')+ds_list.getAvg('i3')+ds_list.getAvg('j3')+ds_list.getAvg('k3')+ds_list.getAvg('l3')) / 12, 2), 0, 0)"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <MuSearchComponent id="comp_mu" titletext="사업부 선택 Component" taborder="34" text="MuSearchComponent00" class="cmb_WF_Essential" visible="false" position="absolute 1265 154 1367 175" bindDataset="ds_search" bindMuCdColumn="schMu" appendText="NOT" onItemChangedEvent=""/>
        <Button id="btn_date" taborder="35" onclick="g_CalButton_OnClick" class="btn_WF_cal" position="absolute 289 40 310 61" userdata="me_date"/>
        <MaskEdit id="me_date" taborder="36" type="string" mask="####-##" trimtype="both" onkeydown="me_FromDate_OnKeyDown" ontextchanged="me_FromDate_OnChanged" class="msk_WF_Cal" position="absolute 210 40 290 61" style="background:#fff6e9ff URL('theme://images/new/img_WF_EssentialBg.png') left top;border:1 solid #ff864bff ;"/>
        <TmSearchComponent id="comp_tm" titletext="팀 검색용 Component" taborder="37" onkeydown="comp_tm_onkeydown" text="TmSearchComponent00" position="absolute 410 40 583 61" bindDataset="ds_search" bindTmCdColumn="tmCd" bindTmNmColumn="tmNm" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="" eventBeforeTrigger=""/>
        <UpjangSearchComponent id="comp_mainUpjang" titletext="업장 검색용 Component" taborder="38" onkeydown="comp_mainUpjang_onkeydown" text="UpjangSearchComponent00" position="absolute 657 40 830 61" bindDataset="ds_search" bindUpjangCodeColumn="mainUpjang" bindUpjangNameColumn="" eventBeforeTrigger="" eventAfterTrigger="" roleSetId="FmsMainUpjang"/>
        <Static id="Static45" text="W15" visible="false" position="absolute 0 30 14 68" style="background:#ff000055;align:center middle;"/>
        <Combo id="cbo_gubun" taborder="40" value="1" text="거래명세서기준" codecolumn="codecolumn" datacolumn="datacolumn" index="0" position="absolute 83 40 200 61" anchor="left top" class="cmb_WF_Essential">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">1</Col>
                <Col id="datacolumn">거래명세서기준</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2</Col>
                <Col id="datacolumn">회계수정일기준</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="Static03" text="W10" visible="false" position="absolute 73 38 83 68" style="background:#ff000055;align:center middle;"/>
        <Edit id="edt_ORD_SABUNQuery" taborder="42" readonly="false" autoselect="true" onkeydown="edt_sabun_onkeydown" position="absolute 929 40 1085 61"/>
        <Button id="edtBtn_ORD_SABUNQuery" taborder="43" tabstop="false" onclick="edtBtn_ORD_SABUNQuery_onclick" class="btn_WF_popSearch" position="absolute 1084 40 1104 61"/>
        <Static id="st_ORD_SABUNQuery" text="조회기간" class="sta_WFSA_label" position="absolute 14 40 89 61" userdata="strMAQuery_SABUN"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="me_FromDate_value" compid="me_date" propid="value" datasetid="ds_search" columnid="schDate"/>
      <BindItem id="item10" compid="cbo_gubun" propid="value" datasetid="ds_search" columnid="schGubun"/>
      <BindItem id="item0" compid="comp_mainUpjang" propid="bindDataset" datasetid="ds_search"/>
      <BindItem id="item12" compid="edt_ORD_SABUNQuery" propid="value" datasetid="ds_search" columnid="schSabunNm"/>
    </Bind>
    <Objects>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_search_oncolumnchanged" cancolumnchange="ds_search_cancolumnchange">
        <ColumnInfo>
          <Column id="schDate" type="STRING" size="256"/>
          <Column id="schGubun" type="STRING" size="256"/>
          <Column id="schSabun" type="STRING" size="256"/>
          <Column id="schSabunNm" type="STRING" size="256"/>
          <Column id="mainUpjang" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="tmNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" onrowposchanged="ds_list_onrowposchanged">
        <ColumnInfo>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="mainUpjangNm" type="STRING" size="256"/>
          <Column id="partSalesLSabun" type="STRING" size="256"/>
          <Column id="a1" type="STRING" size="256"/>
          <Column id="a2" type="STRING" size="256"/>
          <Column id="a3" type="STRING" size="256"/>
          <Column id="b1" type="STRING" size="256"/>
          <Column id="b2" type="STRING" size="256"/>
          <Column id="b3" type="STRING" size="256"/>
          <Column id="c1" type="STRING" size="256"/>
          <Column id="c2" type="STRING" size="256"/>
          <Column id="c3" type="STRING" size="256"/>
          <Column id="d1" type="STRING" size="256"/>
          <Column id="d2" type="STRING" size="256"/>
          <Column id="d3" type="STRING" size="256"/>
          <Column id="e1" type="STRING" size="256"/>
          <Column id="e2" type="STRING" size="256"/>
          <Column id="e3" type="STRING" size="256"/>
          <Column id="f1" type="STRING" size="256"/>
          <Column id="f2" type="STRING" size="256"/>
          <Column id="f3" type="STRING" size="256"/>
          <Column id="g1" type="STRING" size="256"/>
          <Column id="g2" type="STRING" size="256"/>
          <Column id="g3" type="STRING" size="256"/>
          <Column id="h1" type="STRING" size="256"/>
          <Column id="h2" type="STRING" size="256"/>
          <Column id="h3" type="STRING" size="256"/>
          <Column id="i1" type="STRING" size="256"/>
          <Column id="i2" type="STRING" size="256"/>
          <Column id="i3" type="STRING" size="256"/>
          <Column id="j1" type="STRING" size="256"/>
          <Column id="j2" type="STRING" size="256"/>
          <Column id="j3" type="STRING" size="256"/>
          <Column id="k1" type="STRING" size="256"/>
          <Column id="k2" type="STRING" size="256"/>
          <Column id="k3" type="STRING" size="256"/>
          <Column id="l1" type="STRING" size="256"/>
          <Column id="l2" type="STRING" size="256"/>
          <Column id="l3" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : SaleSumYear
  파 일 명 : SaleSumYear.xfdl
  기    능 : 식재영업 / 매출마감관리 / 월별매출집계

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2017.10.18   유선미  최초 생성
  
  
  1) 공통 버튼 정의
  - 조회, 닫기, 도움말 활성화
  
  2) 검토 사항
*/
/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "U_lib::lib_conversionCom.xjs";
include "lib::lib_com.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_processCnt = 0;			//처리건수
var fv_objColInfo;				//데이터셋 컬럼정보

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	v_ds_check = "";

	//조회조건을 초기화한다.
	var nRow= ds_search.addRow();
	
	ds_search.setColumn(nRow, "schDate", gfn_today().substr(0,6));		//조회기간
	ds_search.setColumn(nRow, "schGubun", 1);							//관리부서
		
	comp_mu.setMuCode('2004')
	
	// 팀 초기화
	comp_tm.applyAuthLevel(comp_mu);
	
	// 본사
	comp_mainUpjang.applyAuthLevel(comp_tm);
	comp_mainUpjang.setMainUpjang(true);
}

/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
	//조회기간 유효성 체크
	if(!gfn_isDate(me_date.value + "01")) {
		gfn_alert("msg.err.validator.dateym", "조회기간");
		return;
	}
	
	//grid header 년월 setting
	for(i = 0; i < 12; i++) {
		var date = gfn_addMonth(me_date.value + "01", i - 11);
		
		grd_list.setCellProperty("head", i + 5, "text", date.substr(0, 4) + "년 " + date.substr(4, 2) + "월");
	}	
	
	//영업담당
	if (ffn_ChkNull(ds_search.getColumn(ds_search.rowposition, "schSabunNm")))
		ds_search.setColumn(ds_search.rowposition,"schSabun", "");
	else
		ds_search.setColumn(ds_search.rowposition,"schSabun", edt_ORD_SABUNQuery.userdata);
	
    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_list);

   	//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장 
	fv_objColInfo = gfn_getDatasetInfo(ds_list);

    var strSvcID    = "search";
	var strURL      = "fm/fmf/saleSumYear/selectList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_list=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{	
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{	
	// v_ds_check 사용시 변경사항 체크
	if(gfn_length(v_ds_check) == 0) 
	{	
		// v_ds_check 설정기준 변경사항 체크
		if (gfn_isDataChange() == true) 
		{		
			// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
			if (!gfn_confirm("confirm.before.movepage")) return false;
		}
	}
    
	return true;
}


/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {
		// 목록 조회
        case "search" :
            if (ds_list.getRowCount() == 0) {
				//서비스 쿼리 결과로 데이터가 없는 경우 데이터셋 컬럼정보 복원
				gfn_loadDatasetInfo(ds_list, fv_objColInfo);
            }
            
            break;
    }
}

/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
function comp_tm_onkeydown(obj:TmSearchComponent, e:KeyEventInfo)
{
	if(e.keycode == 46){
		comp_tm.setTmCode("");
		comp_tm.setTmName("");
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 영업담당 팝업처리
 *---------------------------------------------------------------------------------------------*/
function edtBtn_ORD_SABUNQuery_onclick(obj:Button,  e:ClickEventInfo)
{
	var str_Where = "";
	var str_DeptId = "";

	if (obj.name == "edtBtn_ORD_SABUNQuery") {
		str_Where += "  AND (V.SABUN IN (SELECT PART_SALES_SABUN FROM FMS_UPJANG " + str_DeptId + ")) ";
	}
	
	fn_edtBtn_OnClick(obj, str_Where);
}
]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="BrandBuySaleSum" classname="sam_MasterDetail" position="absolute 0 0 1252 725" titletext="매출현황(브랜드)" onload="form_onload">
    <Layouts>
      <Layout>
        <cmpPageObj id="cmpPageObj" titletext="cmpPageObj" taborder="1" scrollbars="none" class="sta_paging_Bg" position="absolute 0 439 1017 463" anchor="left top right"/>
        <Static id="Static06" text="w15" visible="false" position="absolute 1237 0 1252 710" class="Guide01_AreaRed" anchor="top right"/>
        <Static id="Static71" visible="false" position="absolute 0 710 1252 725" class="Guide01_AreaRed" text="h15" anchor="left bottom"/>
        <Div id="div_cmnBtn" taborder="0" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" anchor="left top right" position="absolute 0 0 1237 30" positiontype="position"/>
        <Static id="Static29" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 123" anchor="left top right"/>
        <Static id="Static43" text="W10" visible="false" position="absolute 14 30 277 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static28" text="관리부서" class="sta_WFSA_label" position="absolute 15 40 77 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 73 40 83 61" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 553 41 583 62" anchor="left top"/>
        <Static id="Static51" text="W05." visible="false" position="absolute 0 61 538 66" style="background:#ff000055;align:center middle;"/>
        <Static id="Static03" text="조회조건" class="sta_WFSA_label" position="absolute 584 42 646 63" anchor="left top"/>
        <Static id="Static00" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 643 41 653 62" anchor="left top"/>
        <Static id="Static01" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 801 40 831 61" anchor="left top"/>
        <Static id="Static02" text="본     사" class="sta_WFSA_label" position="absolute 14 66 76 87" anchor="left top"/>
        <Static id="Static04" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 73 66 83 87" anchor="left top"/>
        <Static id="Static07" text="사업장" class="sta_WFSA_label" position="absolute 285 66 347 87" anchor="left top"/>
        <Static id="Static08" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 344 66 354 87" anchor="left top"/>
        <Static id="Static10" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 553 66 583 87" anchor="left top"/>
        <Static id="Static12" text="판매구분" class="sta_WFSA_label" position="absolute 583 66 645 87" anchor="left top"/>
        <Static id="Static13" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 643 66 653 87" anchor="left top"/>
        <Static id="Static14" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 801 66 831 87" anchor="left top"/>
        <Static id="Static85" text="~" class="sta_WF_Dash" position="absolute 1015 40 1031 61"/>
        <Static id="Static07" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 15 10 596"/>
        <Static id="Static01" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1225 15 1235 560"/>
        <Static id="Static15" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 1 123 1236 138" anchor="left top"/>
        <ObjCalendar id="cal_FDate" titletext="캘린더" taborder="6" onkeydown="cal_saleDate_onkeydown" text="20150101" scrollbars="none" position="absolute 912 41 1012 62"/>
        <ObjCalendar id="cal_TDate" titletext="캘린더" taborder="7" onkeydown="cal_saleDate_onkeydown" text="20150101" scrollbars="none" position="absolute 1028 41 1128 62"/>
        <Combo id="cbo_schCond" taborder="5" position="absolute 653 40 801 61" anchor="left top" enable="true" tabstop="false" codecolumn="codecolumn" datacolumn="datacolumn">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">LINE</Col>
                <Col id="datacolumn">라인별</Col>
              </Row>
              <Row>
                <Col id="codecolumn">ORDER</Col>
                <Col id="datacolumn">주문별</Col>
              </Row>
              <Row>
                <Col id="codecolumn">ITEM</Col>
                <Col id="datacolumn">품목별</Col>
              </Row>
              <Row>
                <Col id="codecolumn">UPJANGITEM</Col>
                <Col id="datacolumn">거래처/품목별</Col>
              </Row>
              <Row>
                <Col id="codecolumn">DATE</Col>
                <Col id="datacolumn">일자별</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <UpjangSearchComponent id="comp_mainUpjang" titletext="업장 검색용 Component" taborder="8" onkeydown="comp_mainUpjang_onkeydown" text="UpjangSearchComponent" position="absolute 83 66 256 87" bindDataset="ds_search" bindUpjangCodeColumn="schMainUpjang" bindUpjangNameColumn="schMainUpjangNm" eventBeforeTrigger="" eventAfterTrigger="fn_mainUpjang" roleSetId="BrandMainUpjang"/>
        <UpjangSearchComponent id="comp_upjang" titletext="업장 검색용 Component" taborder="9" text="UpjangSearchComponent" position="absolute 353 66 553 87" bindDataset="ds_search" bindUpjangCodeColumn="schUpjang" bindUpjangNameColumn="schUpjangNm" eventBeforeTrigger="" eventAfterTrigger="" roleSetId="BrandUpjang"/>
        <Static id="Static21" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 255 40 285 61" anchor="left top"/>
        <Static id="Static22" text="CC" class="sta_WFSA_label" position="absolute 285 41 347 62" anchor="left top" visible="true"/>
        <Static id="Static23" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 344 42 354 63" anchor="left top"/>
        <Edit id="edt_ccCd" taborder="3" readonly="true" position="absolute 353 41 533 62" anchor="left top" onkeydown="edt_ccCd_onkeydown" visible="true"/>
        <Button id="btn_ccCd" taborder="4" class="btn_WF_popSearch" position="absolute 532 41 553 62" visible="true" onclick="btn_ccCd_onclick"/>
        <Edit id="edt_ORD_SABUNQuery" taborder="11" readonly="true" autoselect="true" position="absolute 83 92 239 113" onkeydown="edt_sabun_onkeydown"/>
        <Button id="edtBtn_ORD_SABUNQuery" taborder="12" tabstop="false" class="btn_WF_popSearch" position="absolute 236 92 256 113" onclick="edtBtn_ORD_SABUNQuery_onclick"/>
        <Static id="st_ORD_SABUNQuery" text="영업담당" class="sta_WFSA_label" position="absolute 14 92 89 113" userdata="strMAQuery_SABUN"/>
        <Static id="Static16" text="W10" visible="false" position="absolute 13 112 276 122" style="background:#ff000055;align:center middle;"/>
        <Static id="Static18" text="W05." visible="false" position="absolute 8 87 546 92" style="background:#ff000055;align:center middle;"/>
        <Static id="Static24" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 73 92 83 113" anchor="left top"/>
        <Static id="Static26" text="조회기간" class="sta_WFSA_label" position="absolute 831 42 893 63" anchor="left top"/>
        <Static id="Static27" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 889 41 899 62" anchor="left top"/>
        <Static id="Static32" text="상품검색" class="sta_WFSA_label" position="absolute 286 92 348 113" anchor="left top"/>
        <Static id="Static33" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 344 92 354 113" anchor="left top"/>
        <Combo id="cbo_schItemGbn" taborder="13" displayrowcount="10" position="absolute 353 92 433 113" codecolumn="codecolumn" datacolumn="datacolumn" index="0" onitemchanged="cbo_schItemGbn_onitemchanged">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">88</Col>
                <Col id="datacolumn">바코드</Col>
              </Row>
              <Row>
                <Col id="codecolumn">ITEM_CODE</Col>
                <Col id="datacolumn">자재코드</Col>
              </Row>
              <Row>
                <Col id="codecolumn">ITEM_NAME</Col>
                <Col id="datacolumn">자재명</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="Static34" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 553 91 583 112" anchor="left top"/>
        <Combo id="cbo_schOrderType" taborder="10" tabstop="false" position="absolute 653 66 801 87" anchor="left top" codecolumn="codecolumn" datacolumn="datacolumn">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn"/>
                <Col id="datacolumn">전체</Col>
              </Row>
              <Row>
                <Col id="codecolumn">S</Col>
                <Col id="datacolumn">일반</Col>
              </Row>
              <Row>
                <Col id="codecolumn">5</Col>
                <Col id="datacolumn">반환</Col>
              </Row>
              <Row>
                <Col id="codecolumn">6</Col>
                <Col id="datacolumn">교환</Col>
              </Row>
              <Row>
                <Col id="codecolumn">7</Col>
                <Col id="datacolumn">증정</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Edit id="edt_schItemText" taborder="14" position="absolute 432 92 553 113" style=":disabled {cursor:arrowwait;}" userdata="" onkeydown="edt_schItemText_onkeydown"/>
        <MuSearchComponent id="comp_mu" titletext="사업부 선택 Component" taborder="30" text="MuSearchComponent" class="cmb_WF_Essential" visible="false" position="absolute 1256 32 1358 53" bindDataset="" bindMuCdColumn="" appendText="" onItemChangedEvent=""/>
        <Button id="btn_tm" taborder="2" tabstop="false" onclick="btn_tm_onclick" class="btn_WF_popSearch" position="absolute 234 40 255 61"/>
        <Edit id="edt_tm" taborder="1" readonly="true" class="edt_WF_Essential" position="absolute 83 40 235 61"/>
        <Grid id="grd_list" taborder="15" binddataset="ds_list" autoenter="select" useinputpanel="false" position="absolute 0 134 1237 706" anchor="all" cellsizingtype="col" oncellclick="grd_list_oncellclick" oncelldblclick="grd_list_oncelldblclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="22"/>
                <Column size="88"/>
                <Column size="60"/>
                <Column size="120"/>
                <Column size="70"/>
                <Column size="120"/>
                <Column size="70"/>
                <Column size="120"/>
                <Column size="120"/>
                <Column size="88"/>
                <Column size="88"/>
                <Column size="88"/>
                <Column size="94"/>
                <Column size="100"/>
                <Column size="159"/>
                <Column size="138"/>
                <Column size="63"/>
                <Column size="60"/>
                <Column size="40"/>
                <Column size="132"/>
                <Column size="132"/>
                <Column size="103"/>
                <Column size="88"/>
                <Column size="98"/>
                <Column size="104"/>
                <Column size="96"/>
                <Column size="91"/>
                <Column size="105"/>
                <Column size="115"/>
                <Column size="69"/>
                <Column size="100"/>
                <Column size="125"/>
                <Column size="125"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="일자"/>
                <Cell col="2" text="판매구분"/>
                <Cell col="3" text="관리부서"/>
                <Cell col="4" text="본사"/>
                <Cell col="5" text="본사명"/>
                <Cell col="6" text="사업장"/>
                <Cell col="7" text="사업자등록번호"/>
                <Cell col="8" text="사업장명"/>
                <Cell col="9" text="중분류"/>
                <Cell col="10" text="소분류"/>
                <Cell col="11" text="세분류"/>
                <Cell col="12" text="자재코드"/>
                <Cell col="13" text="바코드"/>
                <Cell col="14" text="자재명"/>
                <Cell col="15" text="규격"/>
                <Cell col="16" text="단위"/>
                <Cell col="17" text="PB구분"/>
                <Cell col="18" text="수량"/>
                <Cell col="19" text="매출단가(부가세별도)"/>
                <Cell col="20" text="매출단가(부가세포함)"/>
                <Cell col="21" text="매출금액"/>
                <Cell col="22" text="매출부가세"/>
                <Cell col="23" text="매출합계"/>
                <Cell col="24" text="매입단가"/>
                <Cell col="25" text="매입금액"/>
                <Cell col="26" text="매입부가세"/>
                <Cell col="27" text="매입합계"/>
                <Cell col="28" text="이익액(VAT별도)"/>
                <Cell col="29" text="이익율"/>
                <Cell col="30" text="주문번호"/>
                <Cell col="31" text="유형(반환,교환,증정)"/>
                <Cell col="32" text="비고"/>
              </Band>
              <Band id="body">
                <Cell text="bind:NO" expr="currow+1"/>
                <Cell col="1" displaytype="text" style="align:center;" text="bind:transDate" mask="@@@@-@@-@@" maskchar="_"/>
                <Cell col="2" text="bind:orderTypeNm"/>
                <Cell col="3" displaytype="text" text="bind:tmNm"/>
                <Cell col="4" displaytype="text" style="align:center middle;" text="bind:mainUpjang"/>
                <Cell col="5" displaytype="text" text="bind:mainUpjangnmDisp"/>
                <Cell col="6" displaytype="text" style="align:center middle;" text="bind:transUpjang"/>
                <Cell col="7" text="bind:saupno"/>
                <Cell col="8" displaytype="text" text="bind:transUpjangnmDisp"/>
                <Cell col="9" displaytype="text" text="bind:classNameCode2"/>
                <Cell col="10" displaytype="text" text="bind:classNameCode3"/>
                <Cell col="11" displaytype="text" text="bind:classNameCode4"/>
                <Cell col="12" displaytype="text" style="align:center middle;" text="bind:itemCode"/>
                <Cell col="13" displaytype="text" style="align:center middle;" text="bind:winItemCd"/>
                <Cell col="14" displaytype="text" edittype="none" style="align:left middle;" text="bind:itemName"/>
                <Cell col="15" displaytype="text" style="align:left middle;" text="bind:itemSize"/>
                <Cell col="16" displaytype="text" style="align:center middle;" text="bind:transUom"/>
                <Cell col="17" displaytype="text" style="align:center middle;" text="bind:pbGbn"/>
                <Cell col="18" style="align:right middle;" text="bind:transQty"/>
                <Cell col="19" style="align:right middle;" text="bind:salePrice"/>
                <Cell col="20" style="align:right middle;" text="bind:salePriceVat"/>
                <Cell col="21" style="align:right middle;" text="bind:saleAmt"/>
                <Cell col="22" style="align:right middle;" text="bind:saleVat"/>
                <Cell col="23" style="align:right middle;" text="bind:saleSum"/>
                <Cell col="24" style="align:right middle;" text="bind:transPrice"/>
                <Cell col="25" style="align:right middle;" text="bind:transAmount"/>
                <Cell col="26" style="align:right middle;" text="bind:transVat"/>
                <Cell col="27" style="align:right middle;" text="bind:transSum"/>
                <Cell col="28" displaytype="number" text="bind:marginAmt"/>
                <Cell col="29" displaytype="number" text="bind:marginRatio"/>
                <Cell col="30" style="align:right middle;" text="bind:prNum"/>
                <Cell col="31" style="align:center;" text="bind:rtnOrdType"/>
                <Cell col="32" displaytype="text" text="bind:prRemark"/>
              </Band>
              <Band id="summary">
                <Cell/>
                <Cell col="1" colspan="19" style="align:right middle;" text="합   계 :" taborder="undefined"/>
                <Cell col="20"/>
                <Cell col="21" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleAmt')"/>
                <Cell col="22" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleVat')"/>
                <Cell col="23" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleSum')"/>
                <Cell col="24"/>
                <Cell col="25" displaytype="number" style="align:right middle;" expr="expr:getSumNF('transAmount')"/>
                <Cell col="26" displaytype="number" style="align:right middle;" expr="expr:getSumNF('transVat')"/>
                <Cell col="27" displaytype="number" style="align:right middle;" expr="expr:getSumNF('transSum')"/>
                <Cell col="28" displaytype="number" expr="expr:getSumNF('marginAmt')"/>
                <Cell col="29" displaytype="number" text="expr:gfn_round(gfn_parseFloat((ds_list.getSum(&quot;marginAmt&quot;)/ds_list.getSum(&quot;saleAmt&quot;)) * 100),2)" mask="#,##0.#0"/>
                <Cell col="30"/>
                <Cell col="31"/>
                <Cell col="32"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static05" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 255 66 285 87" anchor="left top"/>
        <Static id="Static25" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 255 91 285 112" anchor="left top"/>
        <TmSearchComponent id="comp_tm" titletext="팀 검색용 Component" taborder="34" onkeydown="comp_tm_onkeydown" text="TmSearchComponent" position="absolute 1256 59 1429 80" bindDataset="ds_search" bindTmCdColumn="schTm" bindTmNmColumn="schTmNm" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="" eventBeforeTrigger="" visible="false"/>
        <Combo id="cbo_price" taborder="35" value="1" text="매입단가기준" codecolumn="codecolumn" datacolumn="datacolumn" index="0" enable="true" position="absolute 912 66 1029 87" anchor="left top" style=":disabled {background:white;}">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">1</Col>
                <Col id="datacolumn">매입단가기준</Col>
              </Row>
              <Row>
                <Col id="codecolumn">2</Col>
                <Col id="datacolumn">매입원가기준</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="Static30" text="단가구분" class="sta_WFSA_label" position="absolute 831 66 893 87" anchor="left top"/>
        <Static id="stc_pbYn" text="PB구분" class="sta_WFSA_label" visible="true" position="absolute 583 91 645 112" anchor="left top"/>
        <Combo id="cbo_pbYn" taborder="36" codecolumn="codecolumn" datacolumn="datacolumn" position="absolute 653 91 737 112" anchor="left top">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn"/>
                <Col id="datacolumn">전체</Col>
              </Row>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">Y</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">N</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Combo id="cbo_taxYn" taborder="37" codecolumn="codecolumn" datacolumn="datacolumn" position="absolute 912 91 996 112" anchor="left top">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn"/>
                <Col id="datacolumn">전체</Col>
              </Row>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">Y</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">N</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="stc_pbYn00" text="부가세구분" class="sta_WFSA_label" position="absolute 831 91 905 112" anchor="left top"/>
        <Static id="Static17" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 801 90 831 111" anchor="left top"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schTms" type="STRING" size="256"/>
          <Column id="schCc" type="STRING" size="256"/>
          <Column id="schCcNm" type="STRING" size="256"/>
          <Column id="schCond" type="STRING" size="256"/>
          <Column id="schFromDate" type="STRING" size="256"/>
          <Column id="schToDate" type="STRING" size="256"/>
          <Column id="schMainUpjang" type="STRING" size="256"/>
          <Column id="schMainUpjangNm" type="STRING" size="256"/>
          <Column id="schUpjang" type="STRING" size="256"/>
          <Column id="schUpjangNm" type="STRING" size="256"/>
          <Column id="schOrderType" type="STRING" size="256"/>
          <Column id="schSabun" type="STRING" size="256"/>
          <Column id="schSabunNm" type="STRING" size="256"/>
          <Column id="schItemGbn" type="STRING" size="256"/>
          <Column id="schItemText" type="STRING" size="256"/>
          <Column id="schMu" type="STRING" size="256"/>
          <Column id="schTm" type="STRING" size="256"/>
          <Column id="schTmNm" type="STRING" size="256"/>
          <Column id="schPrice" type="STRING" size="256"/>
          <Column id="schPbYn" type="STRING" size="256"/>
          <Column id="schTaxYn" type="STRING" size="256"/>
          <Column id="schType" type="STRING" size="256"/>
          <Column id="schParamType" type="STRING" size="256"/>
          <Column id="schParam" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_searchValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schTms" type="STRING" size="256"/>
          <Column id="schFromDate" type="STRING" size="256"/>
          <Column id="schToDate" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="schTms">title:관리부서,required:true</Col>
            <Col id="schFromDate">title:조회기간[시작일],required:true,comparemin:schToDate:조회기간[종료일],date:true,focus:cal_FDate</Col>
            <Col id="schToDate">title:조회기간[종료일],required:true,comparemax:schFromDate:조회기간[시작일],date:true,focus:cal_TDate</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_searchValid2" useclientlayout="true">
        <ColumnInfo>
          <Column id="schItemText" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="schItemText">title:바코드,minlength:6,focus:edt_schItemText</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_tm" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="255"/>
          <Column id="tmCd" type="STRING" size="255"/>
          <Column id="tmNm" type="STRING" size="255"/>
          <Column id="buCd" type="STRING" size="255"/>
          <Column id="buNm" type="STRING" size="255"/>
          <Column id="muCd" type="STRING" size="255"/>
          <Column id="muNm" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth1" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">0</Col>
            <Col id="delYn">0</Col>
            <Col id="savYn">0</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">0</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="transDate" type="STRING" size="255"/>
          <Column id="transDate2" type="STRING" size="255"/>
          <Column id="itemCode" type="STRING" size="255"/>
          <Column id="itemName" type="STRING" size="255"/>
          <Column id="itemSize" type="STRING" size="255"/>
          <Column id="transUom" type="STRING" size="255"/>
          <Column id="transPrice" type="BIGDECIMAL" size="255"/>
          <Column id="salePrice" type="BIGDECIMAL" size="255"/>
          <Column id="salePriceVat" type="BIGDECIMAL" size="255"/>
          <Column id="saleAmt" type="BIGDECIMAL" size="255"/>
          <Column id="saleVat" type="BIGDECIMAL" size="255"/>
          <Column id="saleSum" type="BIGDECIMAL" size="255"/>
          <Column id="transAmount" type="BIGDECIMAL" size="255"/>
          <Column id="transVat" type="BIGDECIMAL" size="255"/>
          <Column id="transSum" type="BIGDECIMAL" size="255"/>
          <Column id="ckAmt" type="BIGDECIMAL" size="255"/>
          <Column id="ckVat" type="BIGDECIMAL" size="255"/>
          <Column id="ckSum" type="BIGDECIMAL" size="255"/>
          <Column id="jiAmt" type="BIGDECIMAL" size="255"/>
          <Column id="jiVat" type="BIGDECIMAL" size="255"/>
          <Column id="jiSum" type="BIGDECIMAL" size="255"/>
          <Column id="marginAmt" type="BIGDECIMAL" size="255"/>
          <Column id="marginRatio" type="BIGDECIMAL" size="255"/>
          <Column id="transQty" type="BIGDECIMAL" size="255"/>
          <Column id="classCode2" type="STRING" size="255"/>
          <Column id="classCode3" type="STRING" size="255"/>
          <Column id="classCode4" type="STRING" size="255"/>
          <Column id="className2" type="STRING" size="255"/>
          <Column id="className3" type="STRING" size="255"/>
          <Column id="className4" type="STRING" size="255"/>
          <Column id="classNameCode2" type="STRING" size="255"/>
          <Column id="classNameCode3" type="STRING" size="255"/>
          <Column id="classNameCode4" type="STRING" size="255"/>
          <Column id="pbGbn" type="STRING" size="255"/>
          <Column id="orderType" type="STRING" size="255"/>
          <Column id="orderTypeNm" type="STRING" size="255"/>
          <Column id="prRemark" type="STRING" size="255"/>
          <Column id="rtnOrdType" type="STRING" size="255"/>
          <Column id="tmCd" type="STRING" size="255"/>
          <Column id="tmNm" type="STRING" size="255"/>
          <Column id="transUpjang" type="STRING" size="255"/>
          <Column id="transUpjangnmDisp" type="STRING" size="255"/>
          <Column id="mainUpjang" type="STRING" size="255"/>
          <Column id="mainUpjangnmDisp" type="STRING" size="255"/>
          <Column id="winItemCd" type="STRING" size="255"/>
          <Column id="prNum" type="STRING" size="255"/>
          <Column id="srchType" type="STRING" size="255"/>
          <Column id="saupno" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item5" compid="edt_ccCd" propid="value" datasetid="ds_search" columnid="schCcNm"/>
      <BindItem id="item12" compid="edt_ORD_SABUNQuery" propid="value" datasetid="ds_search" columnid="schSabunNm"/>
      <BindItem id="item0" compid="edt_schItemText" propid="userdata" datasetid="ds_search" columnid="GUBUN"/>
      <BindItem id="item1" compid="edt_schItemText" propid="UserData" datasetid="ds_search" columnid="GUBUN"/>
      <BindItem id="item4" compid="cbo_schItemGbn" propid="value" datasetid="ds_search" columnid="schItemGbn"/>
      <BindItem id="item6" compid="edt_schItemText" propid="value" datasetid="ds_search" columnid="schItemText"/>
      <BindItem id="item7" compid="cbo_schCond" propid="value" datasetid="ds_search" columnid="schCond"/>
      <BindItem id="item8" compid="cbo_schOrderType" propid="value" datasetid="ds_search" columnid="schOrderType"/>
      <BindItem id="item11" compid="cbo_price" propid="value" datasetid="ds_search" columnid="schPrice"/>
      <BindItem id="item23" compid="cbo_pbYn" propid="value" datasetid="ds_search" columnid="schPbYn"/>
      <BindItem id="item2" compid="cbo_taxYn" propid="value" datasetid="ds_search" columnid="schTaxYn"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : BrandBuySaleSum
  파 일 명 : BrandBuySaleSum.xfdl
  기    능 : 매출현황조회

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2021.10.13   DEV02   최초 생성
  
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "U_lib::lib_conversionCom.xjs";
include "lib::lib_com.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();
var tabIndex = 0;
var fv_orgHto = application.httptimeout;

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);

	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	ds_search.addRow();
	cal_FDate.fn_initMonthCal(this, gfn_today(), "", ds_search, "schFromDate", "Y");		//검색 시작 일
	cal_TDate.fn_initMonthCal(this, gfn_today(), "", ds_search, "schToDate", "Y");		//검색 종료 일
	SCPopup.bind(this, "CcCode", "edt_ccCd", "btn_ccCd", null, {muCd:"", tmCd:""}, {before:"fn_ccBeforeEvent", after:"fn_ccAfterEvent"});

	comp_mu.setMuCode('2004')

	// 팀 초기화
	comp_tm.setTmCode("");
	comp_tm.applyAuthLevel(comp_mu);

	// 본사
	comp_mainUpjang.applyAuthLevel(comp_tm);
	comp_mainUpjang.setMainUpjang(true);

	// 사업장(식재사업)
	comp_upjang.applyAuthLevel(comp_tm);
	comp_upjang.applyMainUpjang(comp_mainUpjang);

	ds_search.setColumn(0, "schCond", "LINE"); //조회조건 (라인별)
	ds_search.setColumn(0, "schOrderType", ""); //판매구분(전체)
	ds_search.setColumn(0, "schItemGbn", "88"); //상품검색(바코드)
	ds_search.setColumn(0, "schPrice", "1");	 // 단가구분
	ds_search.setColumn(0, "schPbYn", ""); // PB구분
	ds_search.setColumn(0, "schTaxYn", ""); // 부가세구분

	fn_searchTM();
	
	// 공통코드(DATA_SET) 정의 : 구매매입단가조회권한 SET
	//SCDataset.bind(this, "ComCode", "ds_dataSet", {groupCode:"FMS_PRICE_VIEW", code:g_EmpNo, useYn:"Y"}, "fn_priceView");
	
}


/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
	// 조회시 Validation Check
	if (gfn_validCheck(ds_search, ds_searchValid, true) == false) return;

	// 조회시 Validation Check
	if(ds_search.getColumn(0, "schItemGbn") == "88" ){
		//바코드 조회시 6자리 이상 입력
		if (gfn_validCheck(ds_search, ds_searchValid2, true) == false) return;
	}


	if(ds_search.getColumn(0, "schCond") == "UPJANGITEM") {
		if(gfn_getDiffMonth(cal_FDate.text, cal_TDate.text) >= 3 && gfn_getDiffDay(cal_FDate.text, cal_TDate.text) > 92) {
			gfn_alert("거래처/품목별 조회는 최대 3개월까지 가능합니다.");
			return;
		}
		
	} else {
		// 88코드, 아이템코드로 조회 시 조회기간 MAX 90일
		// 그 외 조회기간 MAX 30일
		if ( !ffn_ChkNull(ds_search.getColumn(0, "schItemText")) &&
			( ds_search.getColumn(0, "schItemGbn")=="88" || ds_search.getColumn(0, "schItemGbn")=="ITEM_CODE" ) &&
			ds_search.getColumn(0, "schItemText").length > 5 &&
			gfn_getDiffDay(cal_FDate.text, cal_TDate.text) > 90  ) {
			gfn_alert("최대 조회 기간은 90일 이하로 지정하여 주십시요.");
			cal_TDate.setFocus();
			return;
		} else {
			if(!(!ffn_ChkNull(ds_search.getColumn(0, "schItemText")) &&
			( ds_search.getColumn(0, "schItemGbn")=="88" || ds_search.getColumn(0, "schItemGbn")=="ITEM_CODE" ) &&
			ds_search.getColumn(0, "schItemText").length > 5) && gfn_getDiffDay(cal_FDate.text, cal_TDate.text) > 30 ) {
				gfn_alert("최대 조회 기간은 30일 이하로 지정하여 주십시요.");
				cal_TDate.setFocus();
				return;
			} else {
				//gfn_alert("정상조회");
			}
		}
	}
    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_list);
    ds_list.clearData();

    //
    application.httptimeout = 0;	// 60분

	// 조건 : 영업담당
	if (ffn_ChkNull(ds_search.getColumn(ds_search.rowposition, "schSabunNm")))
		ds_search.setColumn(ds_search.rowposition,"schSabun","");
	else
		ds_search.setColumn(ds_search.rowposition,"schSabun",edt_ORD_SABUNQuery.userdata);

	var strSvcID    = "search";
	var strURL      =  "fm/fmf/brandBuySaleSum/selectList.xdo";
    var strInDs     = "ds_search=ds_search";
    var strOutDs    = "ds_list=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}


/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	application.httptimeout = fv_orgHto;
	
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0)
	{
		//fn_search();
		return;
	}

    switch(strSvcID)
    {
        case "search" :  // 조회
			break;

        case "searchTm" : // 관리부서
            fn_initTm();
            break;
    }
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/

/*----------------------------------------------------------------------------------------------
 * 설명      : 관리부서 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchTM()
{
    var strSvcID    = "searchTm";
    var strURL      = "fm/fmf/brandBuySaleSum/selectBrandTm.xdo";
    var strInDs     = "";
    var strOutDs    = "ds_tm=ds_tm";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = false;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 관리부서 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_tm_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_tmCodePop();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 관리부서 팝업
 *---------------------------------------------------------------------------------------------*/
function fn_tmCodePop()
{
	// 팝업창을 호출한다
	var strId       = "CenterCodePop";
	var strURL      = "X_FMF::BrandTmCodePop.xfdl";
	var objArgument = {
		P_DATASET : ds_search
	};

	var nWidth      = 281;
	var nHeight     = 330;
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";

	// 리턴값을 배열로 받을 경우
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);

	if (arrRtn instanceof Object)
	{
		// 리턴값 처리
		edt_tm.value    = arrRtn["tmNm"];
		edt_tm.userdata = arrRtn["tmCd"];

		// ds_search SET
		ds_search.setColumn(0, "schTms", arrRtn["tmCd"]);
		fn_tmEnable();
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 관리부서 초기화
 *---------------------------------------------------------------------------------------------*/
function fn_initTm()
{
	var defVal = "";
	var defValNm = "";
	// 전체 SET
	for (var i = 0 ; i < ds_tm.getRowCount() ; i++)
	{
		if (i == 0) defVal = ds_tm.getColumn(i, "tmCd");
		else defVal = defVal + "," + ds_tm.getColumn(i, "tmCd");
		if (i == 0) defValNm = ds_tm.getColumn(i, "tmNm");
		else defValNm = defValNm + "," + ds_tm.getColumn(i, "tmNm");
	}
	// 관리부서 다중 COMP SET
	edt_tm.value = defValNm;
	edt_tm.userdata = defVal;
	ds_search.setColumn(0, "schTms", defVal);

	fn_tmEnable();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 관리부서 선택에 따른 component 활성화
 *              관리부서 ; 다중선택이 되어있을 경우 CC, 본사, 사업장 공란 및 비활성화
 *              단수선택시에만 CC, 본사, 사업장 활성화 및 선택한 관리부서 물고 가서 조회되도록
 *---------------------------------------------------------------------------------------------*/
function fn_tmEnable()
{
	
	if(!ffn_ChkNull(edt_tm.userdata) && edt_tm.userdata.split(",").length > 1){
		//CC 초기화
		edt_ccCd.userdata = "";
		edt_ccCd.value    = "";
		edt_ccCd.enable   = false;
		btn_ccCd.enable   = false;

		//메인업장, 업장 값 초기화
		fn_upjangDelete();
		comp_mainUpjang.enable = false;
		comp_upjang.enable     = false;

		//관련부서 초기화
		comp_tm.setTmCode("");
	} else {
		//CC 활성화
		edt_ccCd.enable   = true;
		btn_ccCd.enable   = true;

		//메인업장, 업장 활성화
		comp_mainUpjang.enable = true;
		comp_upjang.enable     = true;

		comp_tm.setTmCode(edt_tm.userdata);
		comp_tm.setTmName(edt_tm.value);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : CC 조회 이벤트 before, after
 *---------------------------------------------------------------------------------------------*/
function fn_ccBeforeEvent(p)
{
	p.option.muCd = ds_search.getColumn(0, "schMu");
	p.option.tmCd = ds_search.getColumn(0, "schTm");
	return true;
}

function fn_ccAfterEvent(p)
{
	ds_search.setColumn(0, "schCc", edt_ccCd.userdata);
	ds_search.setColumn(0, "schCcNm", edt_ccCd.value);
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : CC key 이벤트
 *---------------------------------------------------------------------------------------------*/
function edt_ccCd_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 46){
		fn_upjangDelete();	// 메인업장, 업장 초기화
		ds_search.setColumn(0, "schCc", "");
		ds_search.setColumn(0, "schCcNm", "");
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 메인업장 변경시 업장 값 초기화
 *---------------------------------------------------------------------------------------------*/
function fn_mainUpjang()
{
	comp_upjang.setUpjangCode("");
	comp_upjang.setUpjangName("");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 메인업장 key 이벤트
 *---------------------------------------------------------------------------------------------*/
function comp_mainUpjang_onkeydown(obj:UpjangSearchComponent, e:KeyEventInfo)
{
	if(e.keycode == 46){
		fn_upjangDelete();	// 메인업장, 업장 초기화
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 메인업장, 업장 값 초기화
 *---------------------------------------------------------------------------------------------*/
function fn_upjangDelete()
{
	fn_mainUpjang();
	comp_mainUpjang.setUpjangCode("");
	comp_mainUpjang.setUpjangName("");
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 영업담당 팝업처리
 *---------------------------------------------------------------------------------------------*/
function edtBtn_ORD_SABUNQuery_onclick(obj:Button,  e:ClickEventInfo)
{
	var str_Where = "";
	var str_tmCd  = ds_search.getColumn(0, "schTm");

	var str_DeptId  =  "WHERE X.DEPT_ID IN (  "
	               += " SELECT CC_CD          "
	               += "   FROM HLDC_SC_DEPT_V "
	               += "  WHERE BU_CD = '2000' "
	               += "    AND MU_CD = '2004' "
	               += ffn_ChkNull(str_tmCd) ? ("  AND TM_CD LIKE 'CI%' )" ) : ("  AND TM_CD = '" + str_tmCd + "' )");

	if (obj.name == "edtBtn_ORD_SABUNQuery") {
		str_Where += "  AND (V.SABUN IN (SELECT PART_SALES_SABUN FROM FMS_UPJANG X " + str_DeptId + ")) ";

	}

	fn_edtBtn_OnClick(obj, str_Where);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 영업담당 key 이벤트
 *---------------------------------------------------------------------------------------------*/
function edt_sabun_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 13){
		obj.updateToDataset();
		fn_search();
	}
	if(e.keycode == 46){
		edt_ORD_SABUNQuery.value = "";
		edt_ORD_SABUNQuery.userData = "";
		ds_search.setColumn(0,"schSabun","");
		ds_search.setColumn(0,"schSabunNm","");
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 구분 변경 이벤트
 *---------------------------------------------------------------------------------------------*/
function cbo_schItemGbn_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	//keyword reset
	edt_schItemText.value = "";
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 상품검색 key 이벤트
 *---------------------------------------------------------------------------------------------*/
function edt_schItemText_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 13){
		obj.updateToDataset();
		fn_search();
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 단가조회용 권한
 *---------------------------------------------------------------------------------------------*/
// function fn_priceView(p, ds) 
// {
// 	if (p.oid == "ds_dataSet") {
// 		if (ds.getRowCount() > 0) {
// 			cbo_price.enable = true;
// 			//multiAuth = 1; //팀 멀티Select 권한 2021.12.15 추가
// 		}
// 	}
// }

/*----------------------------------------------------------------------------------------------
 * 설명      : 발주내용 상세보기 팝업
 *---------------------------------------------------------------------------------------------*/
function grd_list_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	// 그리드 내 결과 있는경우, 주문별/일자별의 경우 상세 팝업 호출
	
	if (eval(obj.binddataset).rowcount < 1) return;
 	if (e.row < 0) return;
 	if ( !(eval(obj.binddataset).getColumn(e.row, "srchType") == "ORDER" || eval(obj.binddataset).getColumn(e.row, "srchType") == "DATE") ) return;
 	
 	var param = '';
 	var param2 = eval(obj.binddataset).getColumn(e.row, "srchType");
 	if(eval(obj.binddataset).getColumn(e.row, "srchType") == "ORDER") {
		param = eval(obj.binddataset).getColumn(e.row, "prNum");
 	} else if(eval(obj.binddataset).getColumn(e.row, "srchType") == "DATE") {
		param = eval(obj.binddataset).getColumn(e.row, "transDate");
 	}
 	
	var strId       = "BrandBuySaleSumPop";
	var strURL      = "X_FMF::BrandBuySaleSumPop.xfdl";
	var objArgument = { P_DATASET : ds_search, SEARCH_PARAM : param, SEARCH_TYPE : param2 };
	
 	//var rtnVal = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign, true);
 	var rtnVal = gfn_dialog(strId, strURL, objArgument, 1500, 735, "", -1, -1, false, true, "-1", true);
}
]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="CloseMgntStatus" classname="sam_MasterDetail" position="absolute 0 0 1252 725" titletext="마감관리현황(브랜드)" onload="form_onload">
    <Layouts>
      <Layout>
        <cmpPageObj id="cmpPageObj" titletext="cmpPageObj" taborder="1" scrollbars="none" class="sta_paging_Bg" position="absolute 0 439 1017 463" anchor="left top right"/>
        <Static id="Static06" text="w15" visible="false" position="absolute 1237 0 1252 710" class="Guide01_AreaRed" anchor="top right"/>
        <Static id="Static71" visible="false" position="absolute 0 710 1252 725" class="Guide01_AreaRed" text="h15" anchor="left bottom"/>
        <Div id="div_cmnBtn" taborder="0" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" anchor="left top right" position="absolute 0 0 1237 30" positiontype="position"/>
        <Static id="Static29" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 123" anchor="left top right"/>
        <Static id="Static43" text="W10" visible="false" position="absolute 14 30 277 40" style="background:#ff000055;align:center middle;"/>
        <Static id="Static28" text="관리부서" class="sta_WFSA_label" position="absolute 15 40 77 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 73 40 83 61" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 553 41 583 62" anchor="left top"/>
        <Static id="Static51" text="W05." visible="false" position="absolute 528 61 1066 66" style="background:#ff000055;align:center middle;"/>
        <Static id="Static00" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 643 41 653 62" anchor="left top"/>
        <Static id="Static01" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 801 40 831 61" anchor="left top"/>
        <Static id="Static02" text="본     사" class="sta_WFSA_label" position="absolute 14 66 76 87" anchor="left top"/>
        <Static id="Static04" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 73 66 83 87" anchor="left top"/>
        <Static id="Static07" text="사업장" class="sta_WFSA_label" position="absolute 285 66 347 87" anchor="left top"/>
        <Static id="Static08" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 344 66 354 87" anchor="left top"/>
        <Static id="Static10" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 553 66 583 87" anchor="left top"/>
        <Static id="Static12" text="판매구분" class="sta_WFSA_label" position="absolute 583 40 645 61" anchor="left top"/>
        <Static id="Static13" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 643 66 653 87" anchor="left top"/>
        <Static id="Static14" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 801 66 831 87" anchor="left top"/>
        <Static id="Static85" text="~" class="sta_WF_Dash" position="absolute 1015 40 1031 61"/>
        <Static id="Static07" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 0 15 10 596"/>
        <Static id="Static01" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1225 15 1235 560"/>
        <Static id="Static15" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 1 123 1236 138" anchor="left top"/>
        <ObjCalendar id="cal_FDate" titletext="캘린더" taborder="6" onkeydown="cal_saleDate_onkeydown" text="20150101" scrollbars="none" position="absolute 912 40 1012 61"/>
        <ObjCalendar id="cal_TDate" titletext="캘린더" taborder="7" onkeydown="cal_saleDate_onkeydown" text="20150101" scrollbars="none" position="absolute 1028 40 1128 61"/>
        <UpjangSearchComponent id="comp_mainUpjang" titletext="업장 검색용 Component" taborder="8" onkeydown="comp_mainUpjang_onkeydown" text="UpjangSearchComponent" position="absolute 83 66 256 87" bindDataset="ds_search" bindUpjangCodeColumn="schMainUpjang" bindUpjangNameColumn="schMainUpjangNm" eventBeforeTrigger="" eventAfterTrigger="fn_mainUpjang" roleSetId="BrandMainUpjang"/>
        <UpjangSearchComponent id="comp_upjang" titletext="업장 검색용 Component" taborder="9" text="UpjangSearchComponent" position="absolute 353 66 553 87" bindDataset="ds_search" bindUpjangCodeColumn="schUpjang" bindUpjangNameColumn="schUpjangNm" eventBeforeTrigger="" eventAfterTrigger="" roleSetId="BrandUpjang"/>
        <Static id="Static21" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 255 40 285 61" anchor="left top"/>
        <Static id="Static22" text="CC" class="sta_WFSA_label" position="absolute 285 40 347 61" anchor="left top" visible="true"/>
        <Static id="Static23" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 344 42 354 63" anchor="left top"/>
        <Edit id="edt_ccCd" taborder="3" readonly="true" position="absolute 353 40 533 61" anchor="left top" onkeydown="edt_ccCd_onkeydown" visible="true"/>
        <Button id="btn_ccCd" taborder="4" class="btn_WF_popSearch" position="absolute 532 40 553 61" visible="true" onclick="btn_ccCd_onclick"/>
        <Edit id="edt_ORD_SABUNQuery" taborder="11" readonly="true" autoselect="true" position="absolute 83 92 239 113" onkeydown="edt_sabun_onkeydown"/>
        <Button id="edtBtn_ORD_SABUNQuery" taborder="12" tabstop="false" class="btn_WF_popSearch" position="absolute 236 92 256 113" onclick="edtBtn_ORD_SABUNQuery_onclick"/>
        <Static id="st_ORD_SABUNQuery" text="영업담당" class="sta_WFSA_label" position="absolute 14 92 89 113" userdata="strMAQuery_SABUN"/>
        <Static id="Static16" text="W10" visible="false" position="absolute 5 112 268 122" style="background:#ff000055;align:center middle;"/>
        <Static id="Static18" text="W05." visible="false" position="absolute 512 87 1050 92" style="background:#ff000055;align:center middle;"/>
        <Static id="Static24" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 73 92 83 113" anchor="left top"/>
        <Static id="Static26" text="조회기간" class="sta_WFSA_label" position="absolute 831 40 893 61" anchor="left top"/>
        <Static id="Static27" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 889 41 899 62" anchor="left top"/>
        <Static id="Static32" text="상품검색" class="sta_WFSA_label" position="absolute 286 92 348 113" anchor="left top"/>
        <Static id="Static33" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 344 92 354 113" anchor="left top"/>
        <Combo id="cbo_schItemGbn" taborder="13" displayrowcount="10" position="absolute 353 92 433 113" codecolumn="codecolumn" datacolumn="datacolumn" index="0" onitemchanged="cbo_schItemGbn_onitemchanged">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn">88</Col>
                <Col id="datacolumn">바코드</Col>
              </Row>
              <Row>
                <Col id="codecolumn">ITEM_CODE</Col>
                <Col id="datacolumn">자재코드</Col>
              </Row>
              <Row>
                <Col id="codecolumn">ITEM_NAME</Col>
                <Col id="datacolumn">자재명</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="Static34" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 553 91 583 112" anchor="left top"/>
        <Combo id="cbo_schOrderType" taborder="10" tabstop="false" position="absolute 653 40 801 61" anchor="left top" codecolumn="codecolumn" datacolumn="datacolumn">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn"/>
                <Col id="datacolumn">전체</Col>
              </Row>
              <Row>
                <Col id="codecolumn">S</Col>
                <Col id="datacolumn">일반</Col>
              </Row>
              <Row>
                <Col id="codecolumn">5</Col>
                <Col id="datacolumn">반환</Col>
              </Row>
              <Row>
                <Col id="codecolumn">6</Col>
                <Col id="datacolumn">교환</Col>
              </Row>
              <Row>
                <Col id="codecolumn">7</Col>
                <Col id="datacolumn">증정</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Edit id="edt_schItemText" taborder="14" position="absolute 432 92 553 113" style=":disabled {cursor:arrowwait;}" userdata="" onkeydown="edt_schItemText_onkeydown"/>
        <MuSearchComponent id="comp_mu" titletext="사업부 선택 Component" taborder="30" text="MuSearchComponent" class="cmb_WF_Essential" visible="false" position="absolute 1256 32 1358 53" bindDataset="" bindMuCdColumn="" appendText="" onItemChangedEvent=""/>
        <Button id="btn_tm" taborder="2" tabstop="false" onclick="btn_tm_onclick" class="btn_WF_popSearch" position="absolute 234 40 255 61"/>
        <Edit id="edt_tm" taborder="1" readonly="true" class="edt_WF_Essential" position="absolute 83 40 235 61"/>
        <Grid id="grd_list" taborder="15" binddataset="ds_list" autoenter="select" useinputpanel="false" position="absolute 0 134 1237 706" anchor="all" cellsizingtype="col" oncellclick="grd_list_oncellclick" oncelldblclick="grd_list_oncelldblclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="22"/>
                <Column size="88"/>
                <Column size="100"/>
                <Column size="60"/>
                <Column size="120"/>
                <Column size="70"/>
                <Column size="120"/>
                <Column size="94"/>
                <Column size="100"/>
                <Column size="159"/>
                <Column size="138"/>
                <Column size="63"/>
                <Column size="63"/>
                <Column size="40"/>
                <Column size="40"/>
                <Column size="40"/>
                <Column size="40"/>
                <Column size="132"/>
                <Column size="132"/>
                <Column size="103"/>
                <Column size="88"/>
                <Column size="98"/>
                <Column size="132"/>
                <Column size="132"/>
                <Column size="103"/>
                <Column size="88"/>
                <Column size="98"/>
                <Column size="98"/>
                <Column size="159"/>
                <Column size="159"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="26" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell rowspan="2" class="head_Excel" taborder="undefined"/>
                <Cell col="1" rowspan="2" text="일자" taborder="undefined"/>
                <Cell col="2" rowspan="2" text="주문번호" taborder="undefined"/>
                <Cell col="3" rowspan="2" text="판매구분" taborder="undefined"/>
                <Cell col="4" rowspan="2" text="관리부서" taborder="undefined"/>
                <Cell col="5" rowspan="2" text="사업장" taborder="undefined"/>
                <Cell col="6" rowspan="2" text="사업장명" taborder="undefined"/>
                <Cell col="7" rowspan="2" text="자재코드" taborder="undefined"/>
                <Cell col="8" rowspan="2" text="바코드" taborder="undefined"/>
                <Cell col="9" rowspan="2" text="자재명" taborder="undefined"/>
                <Cell col="10" rowspan="2" text="규격" taborder="undefined"/>
                <Cell col="11" rowspan="2" text="과세구분" taborder="undefined"/>
                <Cell col="12" rowspan="2" text="단위" taborder="undefined"/>
                <Cell col="13" rowspan="2" text="입수" taborder="undefined"/>
                <Cell col="14" rowspan="2" text="박스" taborder="undefined"/>
                <Cell col="15" rowspan="2" text="낱개" taborder="undefined"/>
                <Cell col="16" rowspan="2" text="합계" taborder="undefined"/>
                <Cell col="17" colspan="5" text="매출" taborder="undefined"/>
                <Cell col="22" colspan="6" text="마감" taborder="undefined"/>
                <Cell col="28" rowspan="2" text="입력시간" taborder="undefined"/>
                <Cell col="29" rowspan="2" text="입력자" taborder="undefined"/>
                <Cell row="1" col="17" text="단가(부가세별도)"/>
                <Cell row="1" col="18" text="단가(부가세포함)"/>
                <Cell row="1" col="19" text="공급가"/>
                <Cell row="1" col="20" text="부가세"/>
                <Cell row="1" col="21" text="합계"/>
                <Cell row="1" col="22" text="단가(부가세별도)"/>
                <Cell row="1" col="23" text="단가(부가세포함)"/>
                <Cell row="1" col="24" text="공급가"/>
                <Cell row="1" col="25" text="부가세"/>
                <Cell row="1" col="26" text="합계"/>
                <Cell row="1" col="27" text="차이"/>
              </Band>
              <Band id="body">
                <Cell style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';" text="bind:NO" expr="currow+1"/>
                <Cell col="1" displaytype="text" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:center;" text="bind:transDate" subsumtext="expr:getColumn(currow-1,&quot;transDate&quot;)" mask="@@@@-@@-@@" maskchar="_"/>
                <Cell col="2" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:right middle;" text="bind:prNum"/>
                <Cell col="3" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';" text="bind:orderTypeNm"/>
                <Cell col="4" displaytype="text" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';" text="bind:tmNm"/>
                <Cell col="5" displaytype="text" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:center middle;" text="bind:transUpjang"/>
                <Cell col="6" displaytype="text" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';" text="bind:transUpjangnmDisp"/>
                <Cell col="7" displaytype="text" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:center middle;" text="bind:itemCode"/>
                <Cell col="8" displaytype="text" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:center middle;" text="bind:winItemCd"/>
                <Cell col="9" displaytype="text" edittype="none" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:left middle;" text="bind:itemName"/>
                <Cell col="10" displaytype="text" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:left middle;" text="bind:itemSize"/>
                <Cell col="11" displaytype="text" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:center middle;" text="bind:taxGbn"/>
                <Cell col="12" displaytype="text" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:center middle;" text="bind:transUom"/>
                <Cell col="13" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:right middle;" text="bind:boxQty" subsumtext=" "/>
                <Cell col="14" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:right middle;" text="bind:transBoxQty" subsumtext=" "/>
                <Cell col="15" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:right middle;" text="bind:transPcQty" subsumtext="소계:"/>
                <Cell col="16" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:right middle;" text="bind:transQty"/>
                <Cell col="17" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:right middle;" text="bind:salePrice" subsumtext=" "/>
                <Cell col="18" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:right middle;" text="bind:salePriceVat" subsumtext=" "/>
                <Cell col="19" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:right middle;" text="bind:saleAmt"/>
                <Cell col="20" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:right middle;" text="bind:saleVat"/>
                <Cell col="21" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:right middle;" text="bind:saleSum"/>
                <Cell col="22" displaytype="number" edittype="masknumber" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:right middle;color:expr(salePrice==modSalePrice?'default':'red');color2:expr(salePrice==modSalePrice?'default':'red');" text="bind:modSalePrice" editautoselect="true"/>
                <Cell col="23" displaytype="number" edittype="masknumber" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:right middle;color:expr(salePriceVat==modSalePriceVat?'default':'red');color2:expr(salePriceVat==modSalePriceVat?'default':'red');" text="bind:modSalePriceVat" editautoselect="true"/>
                <Cell col="24" displaytype="number" edittype="masknumber" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:right middle;color:expr(saleAmt==modSaleAmt?'default':'red');color2:expr(saleAmt==modSaleAmt?'default':'red');" text="bind:modSaleAmt" editautoselect="true"/>
                <Cell col="25" displaytype="number" edittype="masknumber" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:right middle;color:expr(saleVat==modSaleVat?'default':'red');color2:expr(saleVat==modSaleVat?'default':'red');" text="bind:modSaleVat" editautoselect="true"/>
                <Cell col="26" displaytype="number" edittype="masknumber" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:right middle;color:expr(saleSum==modSaleSum?'default':'red');color2:expr(saleSum==modSaleSum?'default':'red');" text="bind:modSaleSum" editautoselect="true"/>
                <Cell col="27" displaytype="number" edittype="none" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:right middle;color:expr(saleSum==modSaleSum?'default':'red');color2:expr(saleSum==modSaleSum?'default':'red');" expr="expr:modSaleSum - saleSum"/>
                <Cell col="28" edittype="none" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:center middle;" text="bind:udate" mask="expr:gfn_isNull(udate) ? '' : '####-##-## ##:##:##'"/>
                <Cell col="29" displaytype="text" edittype="none" style="background:expr:getRowLevel(currow)==1?'bisque':'white';background2:expr:getRowLevel(currow)==1?'bisque':'white';align:center middle;" text="bind:uuser"/>
              </Band>
              <Band id="summary">
                <Cell/>
                <Cell col="1" colspan="16" style="align:right middle;" text="합   계 :" taborder="undefined"/>
                <Cell col="17"/>
                <Cell col="18"/>
                <Cell col="19" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleAmt')"/>
                <Cell col="20" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleVat')"/>
                <Cell col="21" displaytype="number" style="align:right middle;" expr="expr:getSumNF('saleSum')"/>
                <Cell col="22"/>
                <Cell col="23"/>
                <Cell col="24" displaytype="number" style="align:right middle;" expr="expr:getSumNF('modSaleAmt')"/>
                <Cell col="25" displaytype="number" style="align:right middle;" expr="expr:getSumNF('modSaleVat')"/>
                <Cell col="26" displaytype="number" style="align:right middle;" expr="expr:getSumNF('modSaleSum')"/>
                <Cell col="27" displaytype="number" style="align:right middle;" expr="expr:getSumNF('modSaleSum - saleSum')"/>
                <Cell col="28"/>
                <Cell col="29"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static05" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 255 66 285 87" anchor="left top"/>
        <Static id="Static25" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 255 91 285 112" anchor="left top"/>
        <TmSearchComponent id="comp_tm" titletext="팀 검색용 Component" taborder="34" onkeydown="comp_tm_onkeydown" text="TmSearchComponent" position="absolute 1256 59 1429 80" bindDataset="ds_search" bindTmCdColumn="schTm" bindTmNmColumn="schTmNm" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="" eventBeforeTrigger="" visible="false"/>
        <Static id="stc_pbYn" text="PB구분" class="sta_WFSA_label" visible="true" position="absolute 583 66 645 87" anchor="left top"/>
        <Combo id="cbo_pbYn" taborder="36" codecolumn="codecolumn" datacolumn="datacolumn" position="absolute 653 66 737 87" anchor="left top">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn"/>
                <Col id="datacolumn">전체</Col>
              </Row>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">Y</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">N</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Combo id="cbo_taxYn" taborder="37" codecolumn="codecolumn" datacolumn="datacolumn" position="absolute 653 92 737 113" anchor="left top">
          <Dataset id="innerdataset">
            <ColumnInfo>
              <Column id="codecolumn" size="256"/>
              <Column id="datacolumn" size="256"/>
            </ColumnInfo>
            <Rows>
              <Row>
                <Col id="codecolumn"/>
                <Col id="datacolumn">전체</Col>
              </Row>
              <Row>
                <Col id="codecolumn">Y</Col>
                <Col id="datacolumn">과세</Col>
              </Row>
              <Row>
                <Col id="codecolumn">N</Col>
                <Col id="datacolumn">면세</Col>
              </Row>
            </Rows>
          </Dataset>
        </Combo>
        <Static id="stc_pbYn00" text="과세구분" class="sta_WFSA_label" position="absolute 583 92 645 113" anchor="left top"/>
        <Static id="Static17" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 801 90 831 111" anchor="left top"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schTms" type="STRING" size="256"/>
          <Column id="schCc" type="STRING" size="256"/>
          <Column id="schCcNm" type="STRING" size="256"/>
          <Column id="schCond" type="STRING" size="256"/>
          <Column id="schFromDate" type="STRING" size="256"/>
          <Column id="schToDate" type="STRING" size="256"/>
          <Column id="schMainUpjang" type="STRING" size="256"/>
          <Column id="schMainUpjangNm" type="STRING" size="256"/>
          <Column id="schUpjang" type="STRING" size="256"/>
          <Column id="schUpjangNm" type="STRING" size="256"/>
          <Column id="schOrderType" type="STRING" size="256"/>
          <Column id="schSabun" type="STRING" size="256"/>
          <Column id="schSabunNm" type="STRING" size="256"/>
          <Column id="schItemGbn" type="STRING" size="256"/>
          <Column id="schItemText" type="STRING" size="256"/>
          <Column id="schMu" type="STRING" size="256"/>
          <Column id="schTm" type="STRING" size="256"/>
          <Column id="schTmNm" type="STRING" size="256"/>
          <Column id="schPrice" type="STRING" size="256"/>
          <Column id="schPbYn" type="STRING" size="256"/>
          <Column id="schTaxYn" type="STRING" size="256"/>
          <Column id="schType" type="STRING" size="256"/>
          <Column id="schParamType" type="STRING" size="256"/>
          <Column id="schParam" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_searchValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="schTms" type="STRING" size="256"/>
          <Column id="schFromDate" type="STRING" size="256"/>
          <Column id="schToDate" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="schTms">title:관리부서,required:true</Col>
            <Col id="schFromDate">title:조회기간[시작일],required:true,comparemin:schToDate:조회기간[종료일],date:true,focus:cal_FDate</Col>
            <Col id="schToDate">title:조회기간[종료일],required:true,comparemax:schFromDate:조회기간[시작일],date:true,focus:cal_TDate</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_searchValid2" useclientlayout="true">
        <ColumnInfo>
          <Column id="schItemText" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="schItemText">title:바코드,minlength:6,focus:edt_schItemText</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_tm" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="255"/>
          <Column id="tmCd" type="STRING" size="255"/>
          <Column id="tmNm" type="STRING" size="255"/>
          <Column id="buCd" type="STRING" size="255"/>
          <Column id="buNm" type="STRING" size="255"/>
          <Column id="muCd" type="STRING" size="255"/>
          <Column id="muNm" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth1" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">0</Col>
            <Col id="delYn">0</Col>
            <Col id="savYn">0</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">0</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" keystring="G:transDate+transUpjang" oncolumnchanged="ds_list_oncolumnchanged" cancolumnchange="ds_list_cancolumnchange">
        <ColumnInfo>
          <Column id="transDate" type="STRING" size="255"/>
          <Column id="transDate2" type="STRING" size="255"/>
          <Column id="itemCode" type="STRING" size="255"/>
          <Column id="itemName" type="STRING" size="255"/>
          <Column id="itemSize" type="STRING" size="255"/>
          <Column id="transUom" type="STRING" size="255"/>
          <Column id="transPrice" type="BIGDECIMAL" size="255"/>
          <Column id="salePrice" type="BIGDECIMAL" size="255"/>
          <Column id="salePriceVat" type="BIGDECIMAL" size="255"/>
          <Column id="saleAmt" type="BIGDECIMAL" size="255"/>
          <Column id="saleVat" type="BIGDECIMAL" size="255"/>
          <Column id="saleSum" type="BIGDECIMAL" size="255"/>
          <Column id="transAmount" type="BIGDECIMAL" size="255"/>
          <Column id="transVat" type="BIGDECIMAL" size="255"/>
          <Column id="transSum" type="BIGDECIMAL" size="255"/>
          <Column id="ckAmt" type="BIGDECIMAL" size="255"/>
          <Column id="ckVat" type="BIGDECIMAL" size="255"/>
          <Column id="ckSum" type="BIGDECIMAL" size="255"/>
          <Column id="jiAmt" type="BIGDECIMAL" size="255"/>
          <Column id="jiVat" type="BIGDECIMAL" size="255"/>
          <Column id="jiSum" type="BIGDECIMAL" size="255"/>
          <Column id="marginAmt" type="BIGDECIMAL" size="255"/>
          <Column id="marginRatio" type="BIGDECIMAL" size="255"/>
          <Column id="transQty" type="BIGDECIMAL" size="255"/>
          <Column id="pbGbn" type="STRING" size="255"/>
          <Column id="orderType" type="STRING" size="255"/>
          <Column id="orderTypeNm" type="STRING" size="255"/>
          <Column id="tmCd" type="STRING" size="255"/>
          <Column id="tmNm" type="STRING" size="255"/>
          <Column id="transUpjang" type="STRING" size="255"/>
          <Column id="transUpjangnmDisp" type="STRING" size="255"/>
          <Column id="mainUpjang" type="STRING" size="255"/>
          <Column id="mainUpjangnmDisp" type="STRING" size="255"/>
          <Column id="winItemCd" type="STRING" size="255"/>
          <Column id="prNum" type="STRING" size="255"/>
          <Column id="srchType" type="STRING" size="255"/>
          <Column id="modSalePrice" type="BIGDECIMAL" size="255"/>
          <Column id="modSalePriceVat" type="BIGDECIMAL" size="255"/>
          <Column id="modSaleAmt" type="BIGDECIMAL" size="255"/>
          <Column id="modSaleVat" type="BIGDECIMAL" size="255"/>
          <Column id="modSaleSum" type="BIGDECIMAL" size="255"/>
          <Column id="taxGbn" type="STRING" size="255"/>
          <Column id="uuser" type="STRING" size="255"/>
          <Column id="udate" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind>
      <BindItem id="item5" compid="edt_ccCd" propid="value" datasetid="ds_search" columnid="schCcNm"/>
      <BindItem id="item12" compid="edt_ORD_SABUNQuery" propid="value" datasetid="ds_search" columnid="schSabunNm"/>
      <BindItem id="item0" compid="edt_schItemText" propid="userdata" datasetid="ds_search" columnid="GUBUN"/>
      <BindItem id="item1" compid="edt_schItemText" propid="UserData" datasetid="ds_search" columnid="GUBUN"/>
      <BindItem id="item4" compid="cbo_schItemGbn" propid="value" datasetid="ds_search" columnid="schItemGbn"/>
      <BindItem id="item6" compid="edt_schItemText" propid="value" datasetid="ds_search" columnid="schItemText"/>
      <BindItem id="item8" compid="cbo_schOrderType" propid="value" datasetid="ds_search" columnid="schOrderType"/>
      <BindItem id="item23" compid="cbo_pbYn" propid="value" datasetid="ds_search" columnid="schPbYn"/>
      <BindItem id="item2" compid="cbo_taxYn" propid="value" datasetid="ds_search" columnid="schTaxYn"/>
    </Bind>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : CloseMgntStatus
  파 일 명 : CloseMgntStatus.xfdl
  기    능 : 마감관리현황조회

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2022.03.10   ksm   최초 생성
  
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "U_lib::lib_conversionCom.xjs";
include "lib::lib_com.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();
var tabIndex = 0;
var fv_orgHto = application.httptimeout;

var nTransQty = 0;
var nSalePrice = 0;
var nSalePriceVat = 0;
var nSaleAmt = 0;
var nSaleVat = 0;
var nSaleSum = 0;
/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);

	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	v_ds_check = "ds_list";

	ds_search.addRow();
	cal_FDate.fn_initMonthCal(this, gfn_today(), "", ds_search, "schFromDate", "Y");		//검색 시작 일
	cal_TDate.fn_initMonthCal(this, gfn_today(), "", ds_search, "schToDate", "Y");		//검색 종료 일
	SCPopup.bind(this, "CcCode", "edt_ccCd", "btn_ccCd", null, {muCd:"", tmCd:""}, {before:"fn_ccBeforeEvent", after:"fn_ccAfterEvent"});

	comp_mu.setMuCode('2004')

	// 팀 초기화
	comp_tm.setTmCode("");
	comp_tm.applyAuthLevel(comp_mu);

	// 본사
	comp_mainUpjang.applyAuthLevel(comp_tm);
	comp_mainUpjang.setMainUpjang(true);

	// 사업장(식재사업)
	comp_upjang.applyAuthLevel(comp_tm);
	comp_upjang.applyMainUpjang(comp_mainUpjang);

	ds_search.setColumn(0, "schCond", "LINE"); //조회조건 (라인별)
	ds_search.setColumn(0, "schOrderType", ""); //판매구분(전체)
	ds_search.setColumn(0, "schItemGbn", "88"); //상품검색(바코드)
	ds_search.setColumn(0, "schPrice", "1");	 // 단가구분
	ds_search.setColumn(0, "schPbYn", ""); // PB구분
	ds_search.setColumn(0, "schTaxYn", ""); // 부가세구분

	fn_searchTM();
	
	// 공통코드(DATA_SET) 정의 : 구매매입단가조회권한 SET
	//SCDataset.bind(this, "ComCode", "ds_dataSet", {groupCode:"FMS_PRICE_VIEW", code:g_EmpNo, useYn:"Y"}, "fn_priceView");
	
}


/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
	// 조회시 Validation Check
	if (gfn_validCheck(ds_search, ds_searchValid, true) == false) return;

	// 조회시 Validation Check
	if(ds_search.getColumn(0, "schItemGbn") == "88" ){
		//바코드 조회시 6자리 이상 입력
		if (gfn_validCheck(ds_search, ds_searchValid2, true) == false) return;
	}

	//조회기간 MAX 30일로 화면제어 필요
	if ( gfn_getDiffDay(cal_FDate.text, cal_TDate.text) > 30  ) {
		gfn_alert("최대 조회 기간은 30일 이하로 지정하여 주십시요.");
		cal_TDate.setFocus();
		return;
	}

    // Grid sort 표시 초기화(필수)
//    gfn_clearSortMark(grd_list);
    ds_list.clearData();

    //
    application.httptimeout = 0;	// 60분

	// 조건 : 영업담당
	if (ffn_ChkNull(ds_search.getColumn(ds_search.rowposition, "schSabunNm")))
		ds_search.setColumn(ds_search.rowposition,"schSabun","");
	else
		ds_search.setColumn(ds_search.rowposition,"schSabun",edt_ORD_SABUNQuery.userdata);

	var strSvcID    = "search";
	var strURL      = "fm/fmf/closeMgntStatus/selectList.xdo";
    var strInDs     = "ds_search=ds_search";
    var strOutDs    = "ds_list=ds_list";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}


/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	application.httptimeout = fv_orgHto;
	
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0)
	{
		//fn_search();
		return;
	}

    switch(strSvcID)
    {
        case "search" :  // 조회
			break;

        case "searchTm" : // 관리부서
            fn_initTm();
            break;
            
        case "saveList" :  // 저장
			gfn_alert("msg.save.success");	// 저장 되었습니다.
			fn_search();
			break;
    }
}


/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/

/*----------------------------------------------------------------------------------------------
 * 설명      : 관리부서 조회
 *---------------------------------------------------------------------------------------------*/
function fn_searchTM()
{
    var strSvcID    = "searchTm";
    var strURL      = "fm/fmf/closeMgntStatus/selectBrandTm.xdo";
    var strInDs     = "";
    var strOutDs    = "ds_tm=ds_tm";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = false;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 관리부서 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_tm_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_tmCodePop();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 관리부서 팝업
 *---------------------------------------------------------------------------------------------*/
function fn_tmCodePop()
{
	// 팝업창을 호출한다
	var strId       = "CenterCodePop";
	var strURL      = "X_FMF::BrandTmCodePop.xfdl";
	var objArgument = {
		P_DATASET : ds_search
	};

	var nWidth      = 281;
	var nHeight     = 330;
	var strStyle    = "";
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";

	// 리턴값을 배열로 받을 경우
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign);

	if (arrRtn instanceof Object)
	{
		// 리턴값 처리
		edt_tm.value    = arrRtn["tmNm"];
		edt_tm.userdata = arrRtn["tmCd"];

		// ds_search SET
		ds_search.setColumn(0, "schTms", arrRtn["tmCd"]);
		fn_tmEnable();
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 관리부서 초기화
 *---------------------------------------------------------------------------------------------*/
function fn_initTm()
{
	var defVal = "";
	var defValNm = "";
	// 전체 SET
	for (var i = 0 ; i < ds_tm.getRowCount() ; i++)
	{
		if (i == 0) defVal = ds_tm.getColumn(i, "tmCd");
		else defVal = defVal + "," + ds_tm.getColumn(i, "tmCd");
		if (i == 0) defValNm = ds_tm.getColumn(i, "tmNm");
		else defValNm = defValNm + "," + ds_tm.getColumn(i, "tmNm");
	}
	// 관리부서 다중 COMP SET
	edt_tm.value = defValNm;
	edt_tm.userdata = defVal;
	ds_search.setColumn(0, "schTms", defVal);

	fn_tmEnable();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 관리부서 선택에 따른 component 활성화
 *              관리부서 ; 다중선택이 되어있을 경우 CC, 본사, 사업장 공란 및 비활성화
 *              단수선택시에만 CC, 본사, 사업장 활성화 및 선택한 관리부서 물고 가서 조회되도록
 *---------------------------------------------------------------------------------------------*/
function fn_tmEnable()
{
	
	if(!ffn_ChkNull(edt_tm.userdata) && edt_tm.userdata.split(",").length > 1){
		//CC 초기화
		edt_ccCd.userdata = "";
		edt_ccCd.value    = "";
		edt_ccCd.enable   = false;
		btn_ccCd.enable   = false;

		//메인업장, 업장 값 초기화
		fn_upjangDelete();
		comp_mainUpjang.enable = false;
		comp_upjang.enable     = false;

		//관련부서 초기화
		comp_tm.setTmCode("");
	} else {
		//CC 활성화
		edt_ccCd.enable   = true;
		btn_ccCd.enable   = true;

		//메인업장, 업장 활성화
		comp_mainUpjang.enable = true;
		comp_upjang.enable     = true;

		comp_tm.setTmCode(edt_tm.userdata);
		comp_tm.setTmName(edt_tm.value);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : CC 조회 이벤트 before, after
 *---------------------------------------------------------------------------------------------*/
function fn_ccBeforeEvent(p)
{
	p.option.muCd = ds_search.getColumn(0, "schMu");
	p.option.tmCd = ds_search.getColumn(0, "schTm");
	return true;
}

function fn_ccAfterEvent(p)
{
	ds_search.setColumn(0, "schCc", edt_ccCd.userdata);
	ds_search.setColumn(0, "schCcNm", edt_ccCd.value);
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : CC key 이벤트
 *---------------------------------------------------------------------------------------------*/
function edt_ccCd_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 46){
		fn_upjangDelete();	// 메인업장, 업장 초기화
		ds_search.setColumn(0, "schCc", "");
		ds_search.setColumn(0, "schCcNm", "");
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 메인업장 변경시 업장 값 초기화
 *---------------------------------------------------------------------------------------------*/
function fn_mainUpjang()
{
	comp_upjang.setUpjangCode("");
	comp_upjang.setUpjangName("");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 메인업장 key 이벤트
 *---------------------------------------------------------------------------------------------*/
function comp_mainUpjang_onkeydown(obj:UpjangSearchComponent, e:KeyEventInfo)
{
	if(e.keycode == 46){
		fn_upjangDelete();	// 메인업장, 업장 초기화
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 메인업장, 업장 값 초기화
 *---------------------------------------------------------------------------------------------*/
function fn_upjangDelete()
{
	fn_mainUpjang();
	comp_mainUpjang.setUpjangCode("");
	comp_mainUpjang.setUpjangName("");
}


/*----------------------------------------------------------------------------------------------
 * 설명      : 영업담당 팝업처리
 *---------------------------------------------------------------------------------------------*/
function edtBtn_ORD_SABUNQuery_onclick(obj:Button,  e:ClickEventInfo)
{
	var str_Where = "";
	var str_tmCd  = ds_search.getColumn(0, "schTm");

	var str_DeptId  =  "WHERE X.DEPT_ID IN (  "
	               += " SELECT CC_CD          "
	               += "   FROM HLDC_SC_DEPT_V "
	               += "  WHERE BU_CD = '2000' "
	               += "    AND MU_CD = '2004' "
	               += ffn_ChkNull(str_tmCd) ? ("  AND TM_CD LIKE 'CI%' )" ) : ("  AND TM_CD = '" + str_tmCd + "' )");

	if (obj.name == "edtBtn_ORD_SABUNQuery") {
		str_Where += "  AND (V.SABUN IN (SELECT PART_SALES_SABUN FROM FMS_UPJANG X " + str_DeptId + ")) ";

	}

	fn_edtBtn_OnClick(obj, str_Where);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 영업담당 key 이벤트
 *---------------------------------------------------------------------------------------------*/
function edt_sabun_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 13){
		obj.updateToDataset();
		fn_search();
	}
	if(e.keycode == 46){
		edt_ORD_SABUNQuery.value = "";
		edt_ORD_SABUNQuery.userData = "";
		ds_search.setColumn(0,"schSabun","");
		ds_search.setColumn(0,"schSabunNm","");
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 구분 변경 이벤트
 *---------------------------------------------------------------------------------------------*/
function cbo_schItemGbn_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
	//keyword reset
	edt_schItemText.value = "";
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 상품검색 key 이벤트
 *---------------------------------------------------------------------------------------------*/
function edt_schItemText_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if(e.keycode == 13){
		obj.updateToDataset();
		fn_search();
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 단가조회용 권한
 *---------------------------------------------------------------------------------------------*/
// function fn_priceView(p, ds) 
// {
// 	if (p.oid == "ds_dataSet") {
// 		if (ds.getRowCount() > 0) {
// 			cbo_price.enable = true;
// 			//multiAuth = 1; //팀 멀티Select 권한 2021.12.15 추가
// 		}
// 	}
// }

/*----------------------------------------------------------------------------------------------
 * 설명      : 발주내용 상세보기 팝업
 *---------------------------------------------------------------------------------------------*/
function grd_list_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	// 그리드 내 결과 있는경우, 주문별/일자별의 경우 상세 팝업 호출
	if (eval(obj.binddataset).rowcount < 1) return;
 	if (e.row < 0) return;
 	if ( !(eval(obj.binddataset).getColumn(e.row, "srchType") == "ORDER" || eval(obj.binddataset).getColumn(e.row, "srchType") == "DATE") ) return;
 	
 	var param = '';
 	if(eval(obj.binddataset).getColumn(e.row, "srchType") == "ORDER") {
		param = eval(obj.binddataset).getColumn(e.row, "prNum");
 	} else if(eval(obj.binddataset).getColumn(e.row, "srchType") == "DATE") {
		param = eval(obj.binddataset).getColumn(e.row, "transDate");
 	}

	var strId       = "BrandBuySaleSumPop";
	var strURL      = "X_FMF::BrandBuySaleSumPop.xfdl";
	var objArgument = { P_DATASET : ds_search, SEARCH_PARAM : param };
	
 	//var rtnVal = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign, true);
 	var rtnVal = gfn_dialog(strId, strURL, objArgument, 1700, 735, "", -1, -1, false, true, "-1", true);
}

function ds_list_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{	
	if(e.columnid == "modSalePrice"){
		// 입수량이 0일경우 경고창 
		if(toNumber(obj.getColumn(e.row, "transQty"), 0) == 0) {
			g_Message("EE", obj.getColumn(e.row, "itemName")+ " 수량이 0입니다.");
			return true;
		}		
		//금액계산
		nTransQty = toNumber(obj.getColumn(e.row, "transQty"));
		nSalePrice = toNumber(obj.getColumn(e.row, "modSalePrice"));
		
		nSaleAmt = nTransQty * nSalePrice;
		if(obj.getColumn(e.row, "taxGbn") == "면세") {
			nSaleVat = 0;
		} else {
			nSaleVat = Math.floor(nSaleAmt / 10);
		}
		nSaleSum = nSaleAmt + nSaleVat;
		nSalePriceVat = Math.ceil(nSaleSum / nTransQty);
		
		obj.setColumn(e.row, "modSalePriceVat", nSalePriceVat);
		obj.setColumn(e.row, "modSaleAmt", nSaleAmt);
		obj.setColumn(e.row, "modSaleVat", nSaleVat);
		obj.setColumn(e.row, "modSaleSum", nSaleSum);
	} else if(e.columnid == "modSalePriceVat") {
		// 입수량이 0일경우 경고창 
		if(toNumber(obj.getColumn(e.row, "transQty"), 0) == 0) {
			g_Message("EE", obj.getColumn(e.row, "itemName")+ " 수량이 0입니다.");
			return true;
		}		
		//금액계산
		nTransQty = toNumber(obj.getColumn(e.row, "transQty"));
		nSalePriceVat = toNumber(obj.getColumn(e.row, "modSalePriceVat"));
		
		nSaleSum = nSalePriceVat * nTransQty;
		if(obj.getColumn(e.row, "taxGbn") == "면세") {
			nSaleVat = 0;
		} else {
			nSaleVat = Math.floor(nSaleSum / 11);
		}
		nSaleAmt = nSaleSum - nSaleVat;
		nSalePrice = Math.ceil(nSaleAmt / nTransQty);
		
		obj.setColumn(e.row, "modSalePrice", nSalePrice);
		obj.setColumn(e.row, "modSaleAmt", nSaleAmt);
		obj.setColumn(e.row, "modSaleVat", nSaleVat);
		obj.setColumn(e.row, "modSaleSum", nSaleSum);
	} else if(e.columnid == "modSaleAmt") {
		// 입수량이 0일경우 경고창 
		if(toNumber(obj.getColumn(e.row, "transQty"), 0) == 0) {
			g_Message("EE", obj.getColumn(e.row, "itemName")+ " 수량이 0입니다.");
			return true;
		}		
		//금액계산
		nTransQty = toNumber(obj.getColumn(e.row, "transQty"));
		nSaleAmt = toNumber(obj.getColumn(e.row, "modSaleAmt"));
		
		if(obj.getColumn(e.row, "taxGbn") == "면세") {
			nSaleVat = 0;
		} else {
			nSaleVat = Math.floor(nSaleAmt / 10);
		}
		nSaleSum = nSaleAmt + nSaleVat;
		nSalePriceVat = Math.ceil(nSaleSum / nTransQty);
		nSalePrice = Math.ceil(nSaleAmt / nTransQty);

		obj.setColumn(e.row, "modSalePrice", nSalePrice);
		obj.setColumn(e.row, "modSalePriceVat", nSalePriceVat);
		obj.setColumn(e.row, "modSaleVat", nSaleVat);
		obj.setColumn(e.row, "modSaleSum", nSaleSum);
	} else if(e.columnid == "modSaleVat") {
		// 면세일 경우 경고창
		if(obj.getColumn(e.row, "taxGbn") == "면세") {
			g_Message("EE", "면세상품입니다.");
			obj.setColumn(e.row, "modSaleVat", e.oldvalue);
			return true;
		}
		//금액계산
		nSaleAmt = toNumber(obj.getColumn(e.row, "modSaleAmt"));
		nSaleVat = toNumber(obj.getColumn(e.row, "modSaleVat"));

		nSaleSum = nSaleAmt + nSaleVat;

		obj.setColumn(e.row, "modSaleSum", nSaleSum);
	} else if(e.columnid == "modSaleSum") {
		// 입수량이 0일경우 경고창 
		if(toNumber(obj.getColumn(e.row, "transQty"), 0) == 0) {
			g_Message("EE", obj.getColumn(e.row, "itemName")+ " 수량이 0입니다.");
			return true;
		}		
		//금액계산
		nTransQty = toNumber(obj.getColumn(e.row, "transQty"));
		nSaleSum = toNumber(obj.getColumn(e.row,"modSaleSum"));
		
		if(obj.getColumn(e.row, "taxGbn") == "면세") {
			nSaleVat = 0;
		} else {
			nSaleVat = Math.floor(nSaleSum / 11);
		}
		nSaleAmt = nSaleSum - nSaleVat;
		nSalePriceVat = Math.ceil(nSaleSum / nTransQty);
		nSalePrice = Math.ceil(nSaleAmt / nTransQty);

		obj.setColumn(e.row, "modSalePrice", nSalePrice);
		obj.setColumn(e.row, "modSalePriceVat", nSalePriceVat);
		obj.setColumn(e.row, "modSaleAmt", nSaleAmt);
		obj.setColumn(e.row, "modSaleVat", nSaleVat);
	}
}

function fn_save(){
	//v_ds_check 미사용시 변경사항 체크
 	if (!gfn_dsIsUpdated(ds_list))
 	{
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}
 	
	var nRowCnt = ds_list.getRowCount();	// DataSet Count
	
	for (var i = 0 ; i < nRowCnt ; i++){
		if (ds_list.getRowType(i)==Dataset.ROWTYPE_UPDATE){
			if(toNumber(ds_list.getColumn(i, "transDate")) < gfn_addDate(gfn_today(),-45)){
				alert(ds_list.getColumn(i, "transDate")+"는 수정할 수 없습니다.");
				ds_list.rowposition = i;
				return false;
			}
		}
	}

    var strSvcID    = "saveList";
    var strURL      = "fm/fmf/closeMgntStatus/saveList.xdo";    
    var strInDs     = "ds_list=ds_list:U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{	
	// v_ds_check 사용시 변경사항 체크
	if(gfn_length(v_ds_check) != 0) 
	{	
		// v_ds_check 설정기준 변경사항 체크
		if (gfn_isDataChange() == true) 
		{		
			// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
			if (!gfn_confirm("confirm.before.movepage")) return false;
		}
	}
    
	// 조회프로그램에도 Return true; 기술해 주세요!
	return true;
}

function ds_list_cancolumnchange(obj:Dataset, e:DSColChangeEventInfo)
{
	if(toNumber(obj.getColumn(e.row, "transDate")) < gfn_addDate(gfn_today(),-45)){
		alert("해당일자는 수정할 수 없습니다.");
		obj.setColumn(e.row, e.columnid, e.oldvalue);
		return false;
	}
}

]]></Script>
  </Form>
</FDL>

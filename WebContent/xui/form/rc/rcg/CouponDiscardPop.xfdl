<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="CouponDiscardPop" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 950 649" titletext="쿠폰 폐기 처리" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 15 129 935 144" anchor="left bottom"/>
        <Static id="Static22" text="쿠폰 배포 내역" class="sta_WF_Title01" position="absolute 15 144 893 162" anchor="left top"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 15 71 935 84" anchor="left top"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 15 157 935 162" anchor="left top"/>
        <Static id="Static09" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 935 0 950 649" anchor="top right"/>
        <Grid id="grd_list" taborder="8" binddataset="ds_list" useinputpanel="false" position="absolute 15 162 935 636" anchor="left top" formats="&lt;Formats&gt;&#10;  &lt;Format id=&quot;default&quot;&gt;&#10;    &lt;Columns&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;    &lt;/Columns&gt;&#10;    &lt;Rows&gt;&#10;      &lt;Row band=&quot;head&quot; size=&quot;24&quot;/&gt;&#10;      &lt;Row band=&quot;body&quot; size=&quot;24&quot;/&gt;&#10;    &lt;/Rows&gt;&#10;    &lt;Band id=&quot;head&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;쿠폰번호&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;쿠폰종류&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;유무상구분&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;발행일자&quot;/&gt;&#10;      &lt;Cell col=&quot;4&quot; disptype=&quot;normal&quot; text=&quot;쿠폰금액&quot;/&gt;&#10;      &lt;Cell col=&quot;5&quot; disptype=&quot;normal&quot; text=&quot;부가세구분&quot;/&gt;&#10;      &lt;Cell col=&quot;6&quot; disptype=&quot;normal&quot; text=&quot;공급가&quot;/&gt;&#10;      &lt;Cell col=&quot;7&quot; disptype=&quot;normal&quot; text=&quot;부가세&quot;/&gt;&#10;    &lt;/Band&gt;&#10;    &lt;Band id=&quot;body&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;bind:쿠폰번호&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;bind:쿠폰종류&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;bind:유무상구분&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;bind:발행일자&quot;/&gt;&#10;      &lt;Cell col=&quot;4&quot; disptype=&quot;normal&quot; text=&quot;bind:쿠폰금액&quot;/&gt;&#10;      &lt;Cell col=&quot;5&quot; disptype=&quot;normal&quot; text=&quot;bind:부가세구분&quot;/&gt;&#10;      &lt;Cell col=&quot;6&quot; disptype=&quot;normal&quot; text=&quot;bind:공급가&quot;/&gt;&#10;      &lt;Cell col=&quot;7&quot; disptype=&quot;normal&quot; text=&quot;bind:부가세&quot;/&gt;&#10;    &lt;/Band&gt;&#10;  &lt;/Format&gt;&#10;&lt;/Formats&gt;&#10;" autofittype="none" autoenter="none">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="30"/>
                <Column size="110"/>
                <Column size="180"/>
                <Column size="91"/>
                <Column size="95"/>
                <Column size="108"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="150"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell displaytype="checkbox" style="align:center middle;" text="0"/>
                <Cell col="1" text="쿠폰번호"/>
                <Cell col="2" text="쿠폰종류"/>
                <Cell col="3" text="사업부"/>
                <Cell col="4" text="팀"/>
                <Cell col="5" text="업장CC"/>
                <Cell col="6" text="유무상구분"/>
                <Cell col="7" text="배포일자"/>
                <Cell col="8" text="쿠폰금액"/>
                <Cell col="9" text="공급가"/>
                <Cell col="10" text="부가세"/>
                <Cell col="11" text="부가세구분"/>
              </Band>
              <Band id="body">
                <Cell displaytype="checkbox" edittype="checkbox" style="align:center middle;" text="bind:chk"/>
                <Cell col="1" style="align:center middle;" text="bind:couponNum"/>
                <Cell col="2" style="align:left middle;" text="bind:couponKindNm"/>
                <Cell col="3" text="bind:muNm"/>
                <Cell col="4" text="bind:tmNm"/>
                <Cell col="5" text="bind:ccNm"/>
                <Cell col="6" style="align:center middle;" text="bind:focClassNm"/>
                <Cell col="7" displaytype="date" style="align:center middle;" text="bind:dplyDate"/>
                <Cell col="8" displaytype="number" text="bind:couponAmt"/>
                <Cell col="9" displaytype="number" text="bind:supplyAmt"/>
                <Cell col="10" displaytype="number" text="bind:vatAmt"/>
                <Cell col="11" style="align:left middle;" text="bind:vatNm"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static29" class="sta_WFSA_Labelbg" position="absolute 15 30 935 72" anchor="default"/>
        <Static id="Static30" text="배포일자" class="sta_WFSA_label" position="absolute 755 40 830 61" anchor="left top"/>
        <Static id="Static31" text="쿠폰종류" class="sta_WFSA_label" position="absolute 30 40 105 61" anchor="left top"/>
        <Static id="Static36" text="W10" visible="false" position="absolute 89 40 99 61" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <Static id="Static44" text="H10" visible="false" position="absolute 15 71 935 81" style="background:#ff000055;align:center middle;"/>
        <Static id="Static45" text="W15" visible="false" position="absolute 15 30 30 97" style="background:#ff000055;align:center middle;"/>
        <Static id="Static04" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 358 40 388 61" anchor="left top"/>
        <Static id="Static01" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 15 649" anchor="top right"/>
        <Button id="btn_search00" taborder="9" text="조회" onclick="fn_search" class="btn_WF_searchCm" position2="absolute l:782 w:59 t:0 h:25" positiontype="position2"/>
        <Button id="btn_close" taborder="10" text="닫기" onclick="fn_close" class="btn_WF_CRUD" position2="absolute l:890 w:45 t:0 h:25" positiontype="position2"/>
        <Button id="btn_save" taborder="11" text="저장" onclick="fn_save" class="btn_WF_CRUD" position2="absolute l:843 w:45 t:0 h:25" positiontype="position2" positionstep="0"/>
        <Static id="sta_title" text="쿠폰폐기처리" onclick="sta_title_onclick" class="sta_WF_Title" position="absolute 14 6 464 25"/>
        <Static id="Static02" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 15 25 935 30" style="background:slateblue;"/>
        <Static id="Static00" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 16 30 936 40" anchor="left top"/>
        <Edit id="edt_couponNumFr" taborder="2" position="absolute 457 40 562 61" anchor="left top"/>
        <Static id="Static03" text="~" position="absolute 587 38 598 63"/>
        <Button id="btn_couponNumFr" taborder="12" onclick="btn_couponNumFr_onclick" class="btn_WF_popSearch" position="absolute 561 40 582 61" anchor="left top"/>
        <Button id="btn_couponNumTo" taborder="13" onclick="btn_couponNumTo_onclick" class="btn_WF_popSearch" position="absolute 704 40 725 61" anchor="left top"/>
        <Edit id="edt_couponNumTo" taborder="3" position="absolute 600 40 705 61" anchor="left top"/>
        <Static id="Static60" text="쿠폰번호" class="sta_WFSA_label" position="absolute 388 40 463 61" anchor="left top"/>
        <Edit id="edt_couponKindCd" taborder="0" position="absolute 99 40 149 61" anchor="left top" class="edt_WF_Essential"/>
        <Button id="btn_couponKind" taborder="14" onclick="btn_couponKind_onclick" class="btn_WF_popSearch" position="absolute 148 40 169 61" anchor="left top"/>
        <Edit id="edt_couponKindNm" taborder="1" readonly="true" autoselect="true" onkeydown="fn_edBtn_OnKeyDown" position="absolute 168 40 358 61" class="edt_WF_Essential"/>
        <ObjCalendar id="cal_dplyDate" titletext="캘린더" taborder="4" scrollbars="none" class="cal_WF_Essential" position="absolute 824 40 919 61"/>
        <Static id="Static26" text="폐기일자" class="sta_WFDA_Label01" position="absolute 15 102 105 129" anchor="left top" style="align:center middle;font:Gulim,9;"/>
        <Static id="Static11" class="sta_WFDA_Labelbg" position="absolute 104 102 935 129" anchor="left top"/>
        <Static id="Static06" text="폐기처리자" class="sta_WFDA_Label01" position="absolute 204 102 294 129" anchor="left top" style="align:center middle;font:Gulim,9;"/>
        <Static id="Static39" text="폐기사유" class="sta_WFDA_Label01" position="absolute 393 102 483 129" anchor="left top" style="align:center middle;"/>
        <ObjCalendar id="cal_disuseDate" titletext="캘린더" taborder="5" scrollbars="none" class="cal_WF_Essential" position="absolute 107 105 202 126" style="align:center middle;"/>
        <PersonalSearchComponent id="edt_disuseProcUserNm" titletext="사원 검색용 Component" taborder="6" class="edt_WF_Essential" position="absolute 296 105 391 127" bindDataset="ds_inputData" bindSabunColumn="disuseProcUser" bindNmKorColumn="disuseProcUserNm" qoMuCd="" qoTmCd="" qoTmNm="" eventAfterTrigger="" eventBeforeTrigger="" qoCcCd="" qoCcNm="" onclick="edt_disuseProcUserNm_onclick"/>
        <Edit id="edt_disuseReason" taborder="7" class="edt_WF_Essential" position="absolute 485 105 932 126" imemode="hangul"/>
        <Static id="Static07" text="W15" visible="false" position="absolute 919 31 934 61" style="background:#ff000055;align:center middle;"/>
        <Static id="Static08" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 725 40 755 61" anchor="left top"/>
        <Static id="Static05" text="쿠폰 폐기 정보" class="sta_WF_Title01" position="absolute 15 84 893 102" anchor="left top"/>
        <Static id="Static10" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 15 636 935 649" anchor="left top"/>
        <Static id="Static12" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 15 97 935 102" anchor="left top"/>
        <Edit id="edt_disuseProcUser" taborder="15" position="absolute 296 128 373 149" visible="false"/>
        <Grid id="Grid00" taborder="16" useinputpanel="false" position="absolute -9 840 812 911" binddataset="ds_search" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="couponNumFr"/>
                <Cell col="1" disptype="normal" text="couponNumTo"/>
                <Cell col="2" disptype="normal" text="couponStatus"/>
                <Cell col="3" disptype="normal" text="couponKindCd"/>
                <Cell col="4" disptype="normal" text="couponKindNm"/>
                <Cell col="5" disptype="normal" text="dplyDate"/>
                <Cell col="6" disptype="normal" text="disuseDate"/>
                <Cell col="7" disptype="normal" text="disuseReason"/>
                <Cell col="8" disptype="normal" text="disuseProcUser"/>
                <Cell col="9" disptype="normal" text="disuseProcUserNm"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:couponNumFr"/>
                <Cell col="1" disptype="normal" text="bind:couponNumTo"/>
                <Cell col="2" disptype="normal" text="bind:couponStatus"/>
                <Cell col="3" disptype="normal" text="bind:couponKindCd"/>
                <Cell col="4" disptype="normal" text="bind:couponKindNm"/>
                <Cell col="5" disptype="normal" text="bind:dplyDate"/>
                <Cell col="6" disptype="normal" text="bind:disuseDate"/>
                <Cell col="7" disptype="normal" text="bind:disuseReason"/>
                <Cell col="8" disptype="normal" text="bind:disuseProcUser"/>
                <Cell col="9" disptype="normal" text="bind:disuseProcUserNm"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="Grid01" taborder="17" useinputpanel="false" position="absolute -5 925 397 997" binddataset="ds_inputData" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="disuseDate"/>
                <Cell col="1" disptype="normal" text="disuseProcUser"/>
                <Cell col="2" disptype="normal" text="disuseProcUserNm"/>
                <Cell col="3" disptype="normal" text="disuseReason"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:disuseDate"/>
                <Cell col="1" disptype="normal" text="bind:disuseProcUser"/>
                <Cell col="2" disptype="normal" text="bind:disuseProcUserNm"/>
                <Cell col="3" disptype="normal" text="bind:disuseReason"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Grid id="Grid02" taborder="18" useinputpanel="false" position="absolute 6 650 895 823" binddataset="ds_list" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
                <Col size="80"/>
              </Columns>
              <Rows>
                <Row band="head" size="24"/>
                <Row band="body" size="24"/>
              </Rows>
              <Band id="head">
                <Cell col="0" disptype="normal" text="couponNum"/>
                <Cell col="1" disptype="normal" text="couponKindCd"/>
                <Cell col="2" disptype="normal" text="couponKindNm"/>
                <Cell col="3" disptype="normal" text="couponAmt"/>
                <Cell col="4" disptype="normal" text="couponNumSeq"/>
                <Cell col="5" disptype="normal" text="startDate"/>
                <Cell col="6" disptype="normal" text="endDate"/>
                <Cell col="7" disptype="normal" text="muCd"/>
                <Cell col="8" disptype="normal" text="muNm"/>
                <Cell col="9" disptype="normal" text="tmCd"/>
                <Cell col="10" disptype="normal" text="tmNm"/>
                <Cell col="11" disptype="normal" text="ccCd"/>
                <Cell col="12" disptype="normal" text="ccNm"/>
                <Cell col="13" disptype="normal" text="acctCd"/>
                <Cell col="14" disptype="normal" text="supplyAmt"/>
                <Cell col="15" disptype="normal" text="vatIncludeYn"/>
                <Cell col="16" disptype="normal" text="vatCd"/>
                <Cell col="17" disptype="normal" text="vatNm"/>
                <Cell col="18" disptype="normal" text="vatAmt"/>
                <Cell col="19" disptype="normal" text="newhghtUpjang"/>
                <Cell col="20" disptype="normal" text="selfBuClassCd"/>
                <Cell col="21" disptype="normal" text="salsVatAcct"/>
                <Cell col="22" disptype="normal" text="advance"/>
                <Cell col="23" disptype="normal" text="focClass"/>
                <Cell col="24" disptype="normal" text="focClassNm"/>
                <Cell col="25" disptype="normal" text="couponType"/>
                <Cell col="26" disptype="normal" text="discntClass"/>
                <Cell col="27" disptype="normal" text="discntType"/>
                <Cell col="28" disptype="normal" text="discntRate"/>
                <Cell col="29" disptype="normal" text="discntAmt"/>
                <Cell col="30" disptype="normal" text="couponClass"/>
                <Cell col="31" disptype="normal" text="couponStatus"/>
                <Cell col="32" disptype="normal" text="disuseStatus"/>
                <Cell col="33" disptype="normal" text="refNum"/>
                <Cell col="34" disptype="normal" text="publishDate"/>
                <Cell col="35" disptype="normal" text="dplyDate"/>
                <Cell col="36" disptype="normal" text="saleDate"/>
                <Cell col="37" disptype="normal" text="useDate"/>
                <Cell col="38" disptype="normal" text="useAmt"/>
                <Cell col="39" disptype="normal" text="refundDate"/>
                <Cell col="40" disptype="normal" text="salsUpjangCd"/>
                <Cell col="41" disptype="normal" text="acctType"/>
                <Cell col="42" disptype="normal" text="couponNumOfTimes"/>
                <Cell col="43" disptype="normal" text="useNumOfTimes"/>
                <Cell col="44" disptype="normal" text="insideUseYn"/>
                <Cell col="45" disptype="normal" text="packageDesc"/>
                <Cell col="46" disptype="normal" text="couponProcNum"/>
                <Cell col="47" disptype="normal" text="advanceNum"/>
                <Cell col="48" disptype="normal" text="couponDisuseBeforeStatus"/>
                <Cell col="49" disptype="normal" text="couponSalAged"/>
                <Cell col="50" disptype="normal" text="disuseDate"/>
                <Cell col="51" disptype="normal" text="disuseReason"/>
                <Cell col="52" disptype="normal" text="disuseProcUser"/>
                <Cell col="53" disptype="normal" text="disuseProcUserNm"/>
                <Cell col="54" disptype="normal" text="useYn"/>
                <Cell col="55" disptype="normal" text="custCd"/>
                <Cell col="56" disptype="normal" text="custNm"/>
              </Band>
              <Band id="body">
                <Cell col="0" disptype="normal" text="bind:couponNum"/>
                <Cell col="1" disptype="normal" text="bind:couponKindCd"/>
                <Cell col="2" disptype="normal" text="bind:couponKindNm"/>
                <Cell col="3" disptype="normal" text="bind:couponAmt"/>
                <Cell col="4" disptype="normal" text="bind:couponNumSeq"/>
                <Cell col="5" disptype="normal" text="bind:startDate"/>
                <Cell col="6" disptype="normal" text="bind:endDate"/>
                <Cell col="7" disptype="normal" text="bind:muCd"/>
                <Cell col="8" disptype="normal" text="bind:muNm"/>
                <Cell col="9" disptype="normal" text="bind:tmCd"/>
                <Cell col="10" disptype="normal" text="bind:tmNm"/>
                <Cell col="11" disptype="normal" text="bind:ccCd"/>
                <Cell col="12" disptype="normal" text="bind:ccNm"/>
                <Cell col="13" disptype="normal" text="bind:acctCd"/>
                <Cell col="14" disptype="normal" text="bind:supplyAmt"/>
                <Cell col="15" disptype="normal" text="bind:vatIncludeYn"/>
                <Cell col="16" disptype="normal" text="bind:vatCd"/>
                <Cell col="17" disptype="normal" text="bind:vatNm"/>
                <Cell col="18" disptype="normal" text="bind:vatAmt"/>
                <Cell col="19" disptype="normal" text="bind:newhghtUpjang"/>
                <Cell col="20" disptype="normal" text="bind:selfBuClassCd"/>
                <Cell col="21" disptype="normal" text="bind:salsVatAcct"/>
                <Cell col="22" disptype="normal" text="bind:advance"/>
                <Cell col="23" disptype="normal" text="bind:focClass"/>
                <Cell col="24" disptype="normal" text="bind:focClassNm"/>
                <Cell col="25" disptype="normal" text="bind:couponType"/>
                <Cell col="26" disptype="normal" text="bind:discntClass"/>
                <Cell col="27" disptype="normal" text="bind:discntType"/>
                <Cell col="28" disptype="normal" text="bind:discntRate"/>
                <Cell col="29" disptype="normal" text="bind:discntAmt"/>
                <Cell col="30" disptype="normal" text="bind:couponClass"/>
                <Cell col="31" disptype="normal" text="bind:couponStatus"/>
                <Cell col="32" disptype="normal" text="bind:disuseStatus"/>
                <Cell col="33" disptype="normal" text="bind:refNum"/>
                <Cell col="34" disptype="normal" text="bind:publishDate"/>
                <Cell col="35" disptype="normal" text="bind:dplyDate"/>
                <Cell col="36" disptype="normal" text="bind:saleDate"/>
                <Cell col="37" disptype="normal" text="bind:useDate"/>
                <Cell col="38" disptype="normal" text="bind:useAmt"/>
                <Cell col="39" disptype="normal" text="bind:refundDate"/>
                <Cell col="40" disptype="normal" text="bind:salsUpjangCd"/>
                <Cell col="41" disptype="normal" text="bind:acctType"/>
                <Cell col="42" disptype="normal" text="bind:couponNumOfTimes"/>
                <Cell col="43" disptype="normal" text="bind:useNumOfTimes"/>
                <Cell col="44" disptype="normal" text="bind:insideUseYn"/>
                <Cell col="45" disptype="normal" text="bind:packageDesc"/>
                <Cell col="46" disptype="normal" text="bind:couponProcNum"/>
                <Cell col="47" disptype="normal" text="bind:advanceNum"/>
                <Cell col="48" disptype="normal" text="bind:couponDisuseBeforeStatus"/>
                <Cell col="49" disptype="normal" text="bind:couponSalAged"/>
                <Cell col="50" disptype="normal" text="bind:disuseDate"/>
                <Cell col="51" disptype="normal" text="bind:disuseReason"/>
                <Cell col="52" disptype="normal" text="bind:disuseProcUser"/>
                <Cell col="53" disptype="normal" text="bind:disuseProcUserNm"/>
                <Cell col="54" disptype="normal" text="bind:useYn"/>
                <Cell col="55" disptype="normal" text="bind:custCd"/>
                <Cell col="56" disptype="normal" text="bind:custNm"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item4" compid="edt_couponNumFr" propid="value" datasetid="ds_search" columnid="couponNumFr"/>
      <BindItem id="item5" compid="edt_couponNumTo" propid="value" datasetid="ds_search" columnid="couponNumTo"/>
      <BindItem id="item0" compid="edt_couponKindCd" propid="value" datasetid="ds_search" columnid="couponKindCd"/>
      <BindItem id="item1" compid="edt_couponKindNm" propid="value" datasetid="ds_search" columnid="couponKindNm"/>
      <BindItem id="item7" compid="cal_dplyDate" propid="text" datasetid="ds_search" columnid="dplyDate"/>
      <BindItem id="item2" compid="edt_disuseProcUser" propid="value" datasetid="ds_inputData" columnid="disuseProcUser"/>
      <BindItem id="item3" compid="cal_disuseDate" propid="text" datasetid="ds_inputData" columnid="disuseDate"/>
      <BindItem id="item6" compid="edt_disuseReason" propid="displaynulltext" datasetid="ds_inputData" columnid="disuseReason"/>
    </Bind>
    <Objects>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="couponNumFr" type="STRING" size="256"/>
          <Column id="couponNumTo" type="STRING" size="256"/>
          <Column id="couponStatus" type="STRING" size="256"/>
          <Column id="couponKindCd" type="STRING" size="256"/>
          <Column id="couponKindNm" type="STRING" size="256"/>
          <Column id="dplyDate" type="STRING" size="256"/>
          <Column id="disuseDate" type="STRING" size="256"/>
          <Column id="disuseReason" type="STRING" size="256"/>
          <Column id="disuseProcUser" type="STRING" size="256"/>
          <Column id="disuseProcUserNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_searchValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="couponKindCd" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="couponKindCd">title:쿠폰종류,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="couponNum" type="STRING" size="256"/>
          <Column id="couponKindCd" type="STRING" size="256"/>
          <Column id="couponKindNm" type="STRING" size="256"/>
          <Column id="couponAmt" type="BIGDECIMAL" size="256"/>
          <Column id="couponNumSeq" type="STRING" size="256"/>
          <Column id="startDate" type="STRING" size="256"/>
          <Column id="endDate" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="tmNm" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="acctCd" type="STRING" size="256"/>
          <Column id="supplyAmt" type="BIGDECIMAL" size="256"/>
          <Column id="vatIncludeYn" type="STRING" size="256"/>
          <Column id="vatCd" type="STRING" size="256"/>
          <Column id="vatNm" type="STRING" size="256"/>
          <Column id="vatAmt" type="BIGDECIMAL" size="256"/>
          <Column id="newhghtUpjang" type="STRING" size="256"/>
          <Column id="selfBuClassCd" type="STRING" size="256"/>
          <Column id="salsVatAcct" type="STRING" size="256"/>
          <Column id="advance" type="BIGDECIMAL" size="256"/>
          <Column id="focClass" type="STRING" size="256"/>
          <Column id="focClassNm" type="STRING" size="256"/>
          <Column id="couponType" type="STRING" size="256"/>
          <Column id="discntClass" type="STRING" size="256"/>
          <Column id="discntType" type="STRING" size="256"/>
          <Column id="discntRate" type="BIGDECIMAL" size="256"/>
          <Column id="discntAmt" type="BIGDECIMAL" size="256"/>
          <Column id="couponClass" type="STRING" size="256"/>
          <Column id="couponStatus" type="STRING" size="256"/>
          <Column id="disuseStatus" type="STRING" size="256"/>
          <Column id="refNum" type="STRING" size="256"/>
          <Column id="publishDate" type="STRING" size="256"/>
          <Column id="dplyDate" type="STRING" size="256"/>
          <Column id="saleDate" type="STRING" size="256"/>
          <Column id="useDate" type="STRING" size="256"/>
          <Column id="useAmt" type="BIGDECIMAL" size="256"/>
          <Column id="refundDate" type="STRING" size="256"/>
          <Column id="salsUpjangCd" type="STRING" size="256"/>
          <Column id="acctType" type="STRING" size="256"/>
          <Column id="couponNumOfTimes" type="INT" size="256"/>
          <Column id="useNumOfTimes" type="INT" size="256"/>
          <Column id="insideUseYn" type="STRING" size="256"/>
          <Column id="packageDesc" type="STRING" size="256"/>
          <Column id="couponProcNum" type="STRING" size="256"/>
          <Column id="advanceNum" type="STRING" size="256"/>
          <Column id="couponDisuseBeforeStatus" type="STRING" size="256"/>
          <Column id="couponSalAged" type="STRING" size="256"/>
          <Column id="disuseDate" type="STRING" size="256"/>
          <Column id="disuseReason" type="STRING" size="256"/>
          <Column id="disuseProcUser" type="STRING" size="256"/>
          <Column id="disuseProcUserNm" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_inputData" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="disuseDate" type="STRING" size="256"/>
          <Column id="disuseProcUser" type="STRING" size="256"/>
          <Column id="disuseProcUserNm" type="STRING" size="256"/>
          <Column id="disuseReason" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : CouponDiscardPop
  파 일 명 : CouponDiscardPop.xfdl
  기    능 : 쿠폰 폐기 처리 팝업

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.06.15   JUN      최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "lib::SMCommon.xjs";	//영업회계 공통 스크립트

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo){
	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);

	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	v_ds_check = "ds_list";

	ds_search.clearData();
	ds_search.addRow();
	ds_search.setColumn(0, "couponStatus", "2");	
	cal_dplyDate.fn_initMonthCal(this, null, null, ds_search, "dplyDate");	
		
		
	ds_inputData.clearData();
	ds_inputData.addRow();
	cal_disuseDate.fn_initMonthCal(this, null, null, ds_inputData, "disuseDate", "Y");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close(){	
	this.close();
}

/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search(){

	// 조회시 Validation Check
	if(gfn_validCheck(ds_search, ds_searchValid, true) == false) return;

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_list);

	//서비스 쿼리결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장
	fv_objColInfo = gfn_getDatasetInfo (ds_list);

    gfn_transaction(this
					,"search"
					,"rc/rcg/couponDiscard/selectList.xdo"
					,"ds_search=ds_search:A"
					,"ds_list=ds_list"
					,""
					,"fn_callBack"
					,true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert(){	

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete(){

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save(){
// 	// v_ds_check 미사용시 변경사항 체크
 	if (gfn_dsIsUpdated(ds_list) == false){
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}

	//쿠폰 폐기처리 Vailidation 체크
	if(!fn_chkSaveInfo()) return;
	
	if(gfn_confirm("쿠폰 폐기처리 하시겠습니까?")){
		gfn_transaction(this
						,"save"
						,"rc/rcg/couponDiscardPop/saveList.xdo"
						,"ds_list=ds_list:U"
						,""
						,""
						,"fn_callBack"
						,true);
	}	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
	
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0){
		return;
	}
	
    switch(strSvcID){
    
		// 조회
        case "search" :
            //trace(ds_list.saveXML());
            break;
        
        // 저장
        case "save" :
			gfn_alert("msg.save.success");	// 저장 되었습니다.
			//fn_search();
			this.opener.fn_search();
			this.close();
            break;    
    }
}

/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 쿠폰 폐기처리 Vailidation 체크
 *---------------------------------------------------------------------------------------------*/
function fn_chkSaveInfo(){
	var cnt = 0;
	if(gfn_isNull(cal_disuseDate.fn_getValue())){
		gfn_alert("msg.noinput", "폐기일자");	// $1 을(를) 입력해 주십시요.
		cal_disuseDate.setFocus();
		return false;
	}
	if (gfn_isNull(edt_disuseProcUserNm.getSabun())){
		gfn_alert("msg.noselect", "폐기처리자");	// $1 을(를) 선택해 주십시요.
		edt_disuseProcUserNm.setFocus();
		return false;
	}
	if(gfn_isNull(edt_disuseReason.value)){
		gfn_alert("msg.noinput", "폐기사유");	// $1 을(를) 입력해 주십시요.
		edt_disuseReason.setFocus();
		return false;
	}
		
	for(var i=0; i<ds_list.rowcount; i++){
		if(ds_list.getColumn(i, "chk") == "1"){
			ds_list.setColumn(i, "disuseDate",		cal_disuseDate.fn_getValue());
			ds_list.setColumn(i, "disuseProcUser",	edt_disuseProcUserNm.getSabun());
			ds_list.setColumn(i, "disuseReason",	edt_disuseReason.value);
			cnt++;
		}
	}
	if(cnt == 0){
		gfn_alert("폐기할 쿠폰번호를 체크하세요.");
		return false;
	}
	return true;
}

/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 쿠폰종류 팝업
 *---------------------------------------------------------------------------------------------*/
function btn_couponKind_onclick(obj:Button,  e:ClickEventInfo){

	var arrRtn = gfn_dialog("CouponSpeciesPopup"
							,"X_RCG::CouponSpeciesPopup.xfdl"
							,{searchWord:edt_couponKindNm.value}	//objArgumentList
							,-1		//Width
							,-1		//Height
							,""		//Style
							,-1		//Left
							,-1		//Top
							,false	//Modeless
							,true	//ShowTitle
							,"-1"	//Align
							,true);	//Resizable

	if(arrRtn instanceof Object){
		ds_search.setColumn(0, "couponKindCd", arrRtn["couponKindCd"]);
		ds_search.setColumn(0, "couponKindNm", arrRtn["couponKindNm"]);
	}
}

/*----------------------------------------------------------------------------------------------
 * 쿠폰번호 팝업 From
 *---------------------------------------------------------------------------------------------*/
function btn_couponNumFr_onclick(obj:Button,  e:ClickEventInfo){
	var strId       = "CouponNumPopup";
	var strURL      = "X_RCG::CouponNumPopup.xfdl";
	var objArgument = {couponKindCd:edt_couponKindCd.value,couponStatus:""};
	var nWidth      = -1;
	var nHeight     = -1;
	var strStyle    = "";	
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	var bResizable  = true;

	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign, bResizable);

	if ( arrRtn instanceof Object ){
		ds_search.setColumn(0, "couponNumFr", arrRtn["couponNum"]);
	}
}

/*----------------------------------------------------------------------------------------------
 * 쿠폰번호 팝업 To
 *---------------------------------------------------------------------------------------------*/
function btn_couponNumTo_onclick(obj:Button,  e:ClickEventInfo){
	var strId       = "CouponNumPopup";
	var strURL      = "X_RCG::CouponNumPopup.xfdl";
	var objArgument = {couponKindCd:edt_couponKindCd.value,couponStatus:""};
	var nWidth      = -1;
	var nHeight     = -1;
	var strStyle    = "";	
	var nLeft       = -1;
	var nTop        = -1;
	var isModeless  = false;
	var bShowTitle  = true;
	var strAlign    = "-1";
	var bResizable  = true;

	// 리턴값을 배열로 받을 경우	
	var arrRtn = gfn_dialog(strId, strURL, objArgument, nWidth, nHeight, strStyle, nLeft, nTop, isModeless, bShowTitle, strAlign, bResizable);

	if ( arrRtn instanceof Object ){
		ds_search.setColumn(0, "couponNumTo", arrRtn["couponNum"]);
	}
}
]]></Script>
  </Form>
</FDL>

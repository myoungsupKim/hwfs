<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="CouponDiscard" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="쿠폰 폐기 처리" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="10" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30" tabstop="false"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 97" anchor="left top right"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 93 40" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static22" text="쿠폰 폐기 내역" class="sta_WF_Title01" position="absolute 0 110 467 128" anchor="left top"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 123 627 128" anchor="left top"/>
        <Grid id="grd_list" taborder="9" binddataset="ds_list" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 0 128 1237 710" anchor="all" formats="&lt;Formats&gt;&#10;  &lt;Format id=&quot;default&quot;&gt;&#10;    &lt;Columns&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;      &lt;Col size=&quot;80&quot;/&gt;&#10;    &lt;/Columns&gt;&#10;    &lt;Rows&gt;&#10;      &lt;Row band=&quot;head&quot; size=&quot;24&quot;/&gt;&#10;      &lt;Row band=&quot;body&quot; size=&quot;24&quot;/&gt;&#10;    &lt;/Rows&gt;&#10;    &lt;Band id=&quot;head&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;쿠폰번호&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;쿠폰종류&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;유무상구분&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;발행일자&quot;/&gt;&#10;      &lt;Cell col=&quot;4&quot; disptype=&quot;normal&quot; text=&quot;쿠폰금액&quot;/&gt;&#10;      &lt;Cell col=&quot;5&quot; disptype=&quot;normal&quot; text=&quot;부가세구분&quot;/&gt;&#10;      &lt;Cell col=&quot;6&quot; disptype=&quot;normal&quot; text=&quot;공급가&quot;/&gt;&#10;      &lt;Cell col=&quot;7&quot; disptype=&quot;normal&quot; text=&quot;부가세&quot;/&gt;&#10;    &lt;/Band&gt;&#10;    &lt;Band id=&quot;body&quot;&gt;&#10;      &lt;Cell col=&quot;0&quot; disptype=&quot;normal&quot; text=&quot;bind:쿠폰번호&quot;/&gt;&#10;      &lt;Cell col=&quot;1&quot; disptype=&quot;normal&quot; text=&quot;bind:쿠폰종류&quot;/&gt;&#10;      &lt;Cell col=&quot;2&quot; disptype=&quot;normal&quot; text=&quot;bind:유무상구분&quot;/&gt;&#10;      &lt;Cell col=&quot;3&quot; disptype=&quot;normal&quot; text=&quot;bind:발행일자&quot;/&gt;&#10;      &lt;Cell col=&quot;4&quot; disptype=&quot;normal&quot; text=&quot;bind:쿠폰금액&quot;/&gt;&#10;      &lt;Cell col=&quot;5&quot; disptype=&quot;normal&quot; text=&quot;bind:부가세구분&quot;/&gt;&#10;      &lt;Cell col=&quot;6&quot; disptype=&quot;normal&quot; text=&quot;bind:공급가&quot;/&gt;&#10;      &lt;Cell col=&quot;7&quot; disptype=&quot;normal&quot; text=&quot;bind:부가세&quot;/&gt;&#10;    &lt;/Band&gt;&#10;  &lt;/Format&gt;&#10;&lt;/Formats&gt;&#10;" onrowposchanged="ds_list_onrowposchanged" autofittype="col">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="40"/>
                <Column size="100"/>
                <Column size="150"/>
                <Column size="100"/>
                <Column size="180"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="90"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="200"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell style="background:#566572ff URL('theme://convertImages/new/img_WF_Excel.png') center middle;" class="head_Excel"/>
                <Cell col="1" displaytype="checkbox" text="0" expandshow="hide"/>
                <Cell col="2" text="사업부"/>
                <Cell col="3" text="업장(CC)"/>
                <Cell col="4" text="쿠폰번호"/>
                <Cell col="5" text="쿠폰종류"/>
                <Cell col="6" text="유무상구분"/>
                <Cell col="7" text="발행일자"/>
                <Cell col="8" text="쿠폰금액"/>
                <Cell col="9" text="폐기일자"/>
                <Cell col="10" text="처리자"/>
                <Cell col="11" text="폐기사유"/>
              </Band>
              <Band id="body">
                <Cell expr="currow+1"/>
                <Cell col="1" displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                <Cell col="2" style="align:left middle;" text="bind:muNm"/>
                <Cell col="3" style="align:left middle;" text="bind:ccNm"/>
                <Cell col="4" style="align:center middle;" text="bind:couponNum"/>
                <Cell col="5" style="align:left middle;" text="bind:couponKindNm"/>
                <Cell col="6" style="align:center middle;" text="bind:focClassNm"/>
                <Cell col="7" displaytype="text" style="align:center middle;" text="bind:publishDate" mask="####-##-##"/>
                <Cell col="8" displaytype="number" text="bind:couponAmt"/>
                <Cell col="9" displaytype="text" style="align:center middle;" text="bind:disuseDate" mask="####-##-##"/>
                <Cell col="10" style="align:center middle;" text="bind:disuseProcUserNm"/>
                <Cell col="11" style="align:left middle;" text="bind:disuseReason"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Button id="btn_discardPop" taborder="8" text="쿠폰폐기" class="btn_WF_CRUD" position="absolute 709 0 780 25" onclick="btn_discardPop_onclick"/>
        <Static id="Static03" text="W05." visible="false" position="absolute 16 61 1221 66" anchor="left top" style="background:#ff000055;align:center middle;"/>
        <Static id="Static56" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1 40 16 87" anchor="left top"/>
        <Static id="Static28" text="폐기일자" class="sta_WFSA_label" position="absolute 325 66 387 87" anchor="left top"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 97 450 110" anchor="left top"/>
        <Static id="Static00" text="고객사" class="sta_WFSA_label" position="absolute 16 66 78 87" anchor="left top" style="align:left middle;"/>
        <Static id="Static24" text="~" position="absolute 499 68 508 87"/>
        <Static id="Static25" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 489 66 499 87" anchor="left top"/>
        <Static id="Static29" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 508 66 518 87" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 1 87 94 97" anchor="left top"/>
        <CustSearchComponent id="CustSearchComponent" titletext="거래처 검색용 Component" taborder="3" text="CustSearchComponent" position="absolute 85 66 295 87" bindDataset="ds_search" eventBeforeTrigger="" eventAfterTrigger="fn_custSchAfter" bindCustCodeColumn="custCd" bindCustNameColumn="custNm"/>
        <ObjCalendar id="cal_disuseDateFr" titletext="캘린더" taborder="4" scrollbars="none" class="cal_WF_Essential" position="absolute 394 66 489 87"/>
        <ObjCalendar id="cal_disuseDateTo" titletext="캘린더" taborder="5" scrollbars="none" class="cal_WF_Essential" position="absolute 518 66 613 87"/>
        <Static id="Static60" text="쿠폰종류" class="sta_WFSA_label" position="absolute 634 66 709 87" anchor="left top"/>
        <Edit id="edt_couponKindCd" taborder="6" position="absolute 709 66 759 87" anchor="left top"/>
        <Button id="btn_couponKind" taborder="11" onclick="btn_couponKind_onclick" class="btn_WF_popSearch" position="absolute 758 66 779 87" anchor="left top"/>
        <Edit id="edt_couponKindNm" taborder="7" readonly="true" autoselect="true" onkeydown="fn_edBtn_OnKeyDown" position="absolute 778 66 979 87"/>
        <Button id="btn_cancelProc" taborder="12" text="폐기취소" onclick="Button86_onclick" class="btn_WF_CRUD" position="absolute 1252 0 1323 25" visible="false"/>
        <Button id="btn_cancel" taborder="13" text="쿠폰취소" onclick="btn_cancel_onclick" class="btn_WF_CRUD" position="absolute 781 0 852 25"/>
        <Static id="Static09" text="사업부" class="sta_WFSA_label" position="absolute 16 40 68 61" anchor="left top"/>
        <MuSearchComponent id="MuSearchComponent01" titletext="사업부 선택 Component" taborder="0" text="MuSearchComponent00" class="cmb_WF_Essential" position="absolute 85 40 295 61" bindDataset="ds_search" bindMuCdColumn="muCd" appendText="" onItemChangedEvent="fn_muCd_changed"/>
        <Static id="Static13" text="부서" class="sta_WFSA_label" position="absolute 325 40 393 61" anchor="left top"/>
        <TmSearchComponent id="TmSearchComponent01" titletext="팀 검색용 Component" taborder="1" text="TmSearchComponent00" class="edt_WF_Essential" position="absolute 394 40 613 61" bindDataset="ds_search" bindTmCdColumn="tmCd" bindTmNmColumn="tmNm" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tmCd_changed" eventBeforeTrigger=""/>
        <Static id="Static26" text="CC" class="sta_WFSA_label" position="absolute 634 40 670 61" anchor="left top"/>
        <UpjangSearchComponent id="UpjangSearchComponent01" titletext="업장 검색용 Component" taborder="2" text="UpjangSearchComponent00" position="absolute 709 40 979 61" bindDataset="ds_search" bindUpjangCodeColumn="ccCd" bindUpjangNameColumn="ccNm" eventBeforeTrigger="" eventAfterTrigger="" roleSetId=""/>
        <Static id="Static01" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 384 66 394 87" anchor="left top"/>
        <Static id="Static02" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 384 40 394 61" anchor="left top"/>
        <Static id="Static10" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 75 40 85 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 75 66 85 87" anchor="left top"/>
        <Static id="Static12" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 699 66 709 87" anchor="left top"/>
        <Static id="Static14" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 699 40 709 61" anchor="left top"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item7" compid="cal_disuseDateFr" propid="text" datasetid="ds_search" columnid="disuseDateFr"/>
      <BindItem id="item8" compid="cal_disuseDateTo" propid="text" datasetid="ds_search" columnid="altDateTo"/>
      <BindItem id="item0" compid="edt_couponKindCd" propid="value" datasetid="ds_search" columnid="couponKindCd"/>
      <BindItem id="item1" compid="edt_couponKindNm" propid="value" datasetid="ds_search" columnid="couponKindNm"/>
    </Bind>
    <Objects>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">1</Col>
            <Col id="insYn">0</Col>
            <Col id="delYn">0</Col>
            <Col id="savYn">0</Col>
            <Col id="prtYn">0</Col>
            <Col id="exlYn">0</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="tmNm" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="disuseDateFr" type="STRING" size="256"/>
          <Column id="disuseDateTo" type="STRING" size="256"/>
          <Column id="couponStatus" type="STRING" size="256"/>
          <Column id="disuseStatus" type="STRING" size="256"/>
          <Column id="couponKindCd" type="STRING" size="256"/>
          <Column id="couponKindNm" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_searchValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="disuseDateFr" type="STRING" size="256"/>
          <Column id="disuseDateTo" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="muCd">title:사업부,required:true</Col>
            <Col id="tmCd">title:팀,required:true</Col>
            <Col id="disuseDateFr">title:폐기시작일자,comparemin:disuseDateTo:폐기종료일자,required:false</Col>
            <Col id="disuseDateTo">title:폐기종료일자,comparemax:disuseDateFr:폐기시작일자,required:false</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_list" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="couponNum" type="STRING" size="256"/>
          <Column id="couponKindCd" type="STRING" size="256"/>
          <Column id="couponKindNm" type="STRING" size="256"/>
          <Column id="couponAmt" type="BIGDECIMAL" size="256"/>
          <Column id="couponNumSeq" type="STRING" size="256"/>
          <Column id="startDate" type="STRING" size="256"/>
          <Column id="endDate" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="muNm" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="tmNm" type="STRING" size="256"/>
          <Column id="ccCd" type="STRING" size="256"/>
          <Column id="ccNm" type="STRING" size="256"/>
          <Column id="acctCd" type="STRING" size="256"/>
          <Column id="supplyAmt" type="BIGDECIMAL" size="256"/>
          <Column id="vatIncludeYn" type="STRING" size="256"/>
          <Column id="vatCd" type="STRING" size="256"/>
          <Column id="vatNm" type="STRING" size="256"/>
          <Column id="vatAmt" type="BIGDECIMAL" size="256"/>
          <Column id="newhghtUpjang" type="STRING" size="256"/>
          <Column id="selfBuClassCd" type="STRING" size="256"/>
          <Column id="salsVatAcct" type="STRING" size="256"/>
          <Column id="advance" type="BIGDECIMAL" size="256"/>
          <Column id="focClass" type="STRING" size="256"/>
          <Column id="focClassNm" type="STRING" size="256"/>
          <Column id="couponType" type="STRING" size="256"/>
          <Column id="discntClass" type="STRING" size="256"/>
          <Column id="discntType" type="STRING" size="256"/>
          <Column id="discntRate" type="BIGDECIMAL" size="256"/>
          <Column id="discntAmt" type="BIGDECIMAL" size="256"/>
          <Column id="couponClass" type="STRING" size="256"/>
          <Column id="couponStatus" type="STRING" size="256"/>
          <Column id="disuseStatus" type="STRING" size="256"/>
          <Column id="refNum" type="STRING" size="256"/>
          <Column id="publishDate" type="STRING" size="256"/>
          <Column id="dplyDate" type="STRING" size="256"/>
          <Column id="saleDate" type="STRING" size="256"/>
          <Column id="useDate" type="STRING" size="256"/>
          <Column id="useAmt" type="BIGDECIMAL" size="256"/>
          <Column id="refundDate" type="STRING" size="256"/>
          <Column id="salsUpjangCd" type="STRING" size="256"/>
          <Column id="acctType" type="STRING" size="256"/>
          <Column id="couponNumOfTimes" type="INT" size="256"/>
          <Column id="useNumOfTimes" type="INT" size="256"/>
          <Column id="insideUseYn" type="STRING" size="256"/>
          <Column id="packageDesc" type="STRING" size="256"/>
          <Column id="couponProcNum" type="STRING" size="256"/>
          <Column id="advanceNum" type="STRING" size="256"/>
          <Column id="couponDisuseBeforeStatus" type="STRING" size="256"/>
          <Column id="couponSalAged" type="STRING" size="256"/>
          <Column id="disuseDate" type="STRING" size="256"/>
          <Column id="disuseReason" type="STRING" size="256"/>
          <Column id="disuseProcUser" type="STRING" size="256"/>
          <Column id="disuseProcUserNm" type="STRING" size="256"/>
          <Column id="useYn" type="STRING" size="256"/>
          <Column id="custCd" type="STRING" size="256"/>
          <Column id="custNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : Template
  파 일 명 : Template.xfdl
  기    능 : Design 및 Script Template 

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2014.11.01   김윤기   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "lib::SMCommon.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo){

	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init(){

	// 업데이트여부를 체크할 DataSet, 여러개 있을 경우 ;로 구분
	v_ds_check = "ds_list";
	
	ds_search.clearData();
	ds_search.addRow();
// 	ds_search.setColumn(0, "muCd", g_Mu_Cd);
// 	ds_search.setColumn(0, "muNm", g_Mu_Nm);
// 	ds_search.setColumn(0, "tmCd", g_Tm_Cd);
// 	ds_search.setColumn(0, "tmNm", g_Tm_Nm);
// 	ds_search.setColumn(0, "ccCd", g_Cc_Cd);
// 	ds_search.setColumn(0, "ccNm", g_Cc_Nm);
    TmSearchComponent01.applyAuthLevel(MuSearchComponent01);
	UpjangSearchComponent01.setForcedRoleSet("CostCenter");
	UpjangSearchComponent01.applyAuthLevel(TmSearchComponent01);
	ds_search.setColumn(0, "couponStatus", "6");	//쿠폰상태 : 폐기
	ds_search.setColumn(0, "disuseStatus", "1");	//폐기상태 : 폐기

	cal_disuseDateFr.fn_initMonthCal(this, null, null, ds_search, "disuseDateFr");
	cal_disuseDateTo.fn_initMonthCal(this, null, null, ds_search, "disuseDateTo");
	
	SCAuth.setUserButton(this, {buttons : [{id:"btn_discardPop", role:"src", ischange:true},{id:"btn_cancel", role:"src", ischange:false}]});
	//SCAuth.setUserButton(this, {buttons : [{id:"btn_cancelProc", role:"src", ischange:true}]});
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 팀(부서)의 팝업을 호출하기 전에 발생되는 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_tmBeforeEvent(obj)
{
	obj.qoMuCd = ds_search.getColumn(0,"muCd");
	obj.qoUseYn = "Y";
	
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 업장의 팝업을 호출하기 전에 발생되는 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_upjangBeforeEvent(obj, cls)
{
	cls.setTmCd(ds_search.getColumn(0, "tmCd"));
	
	return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close(){	
	// v_ds_check 사용시 변경사항 체크
	if(gfn_length(v_ds_check) != 0){	
	
		// v_ds_check 설정기준 변경사항 체크
		if(gfn_isDataChange() == true){
			if(!gfn_confirm("confirm.before.movepage")) return false;	// 변경된 데이터가 있습니다. 현재 화면을 닫겠습니까?
		}
	}
	return true;
}

/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search(){

	// 조회시 Validation Check
	if(gfn_validCheck(ds_search, ds_searchValid, true) == false) return;

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_list);

	//서비스 쿼리결과로 데이터가 없는 경우 데이터셋 컬럼정보가 사라지는 현상을 복원하기 위해 현재 컬럼정보 저장
	fv_objColInfo = gfn_getDatasetInfo (ds_list);

    gfn_transaction(this
					,"search"
					,"rc/rcg/couponDiscard/selectList.xdo"
					,"ds_search=ds_search:A"
					,"ds_list=ds_list"
					,""
					,"fn_callBack"
					,true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert(){	

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete(){

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save(){

}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print(){
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help(){
	
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg){

	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0){
		return;
	}
	
    switch(strSvcID){
    
		// 코드분류 조회
        case "search" :
            //trace(ds_list.saveXML());
            break;
        // 취소
        case "cancle" :
			gfn_alert("msg.save.success");	// 저장 되었습니다.
            break;
    }
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 거래처 콜백(후처리) 함수
 *---------------------------------------------------------------------------------------------*/
function fn_custSchAfter(p, data){
	fn_search();
}

/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 사업부 변경시 부서, CC 초기화 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_muCd_changed(){
    ds_search.setColumn(0, "tmCd",  "");
    ds_search.setColumn(0, "tmNm",  "");
    ds_search.setColumn(0, "ccCd",  "");
    ds_search.setColumn(0, "ccNm",  "");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 부서 변경 시 CC 초기화 이벤트
 *---------------------------------------------------------------------------------------------*/
function fn_tmCd_changed(){
    ds_search.setColumn(0, "ccCd",  "");
    ds_search.setColumn(0, "ccNm",  "");
}
/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 쿠폰폐기처리 팝업
 *---------------------------------------------------------------------------------------------*/
function btn_discardPop_onclick(obj:Button,  e:ClickEventInfo){

	var arrRtn = gfn_dialog("CouponDiscardPop"
							,"X_RCG::CouponDiscardPop.xfdl"
							,null	//objArgumentList
							,-1		//Width
							,-1		//Height
							,""		//Style
							,-1		//Left
							,-1		//Top
							,false	//Modeless
							,true	//ShowTitle
							,"-1"	//Align
							,true);	//Resizable
}

/*----------------------------------------------------------------------------------------------
 * 쿠폰종류 팝업
 *---------------------------------------------------------------------------------------------*/
function btn_couponKind_onclick(obj:Button,  e:ClickEventInfo){

	var arrRtn = gfn_dialog("CouponSpeciesPopup"
							,"X_RCG::CouponSpeciesPopup.xfdl"
							,{searchWord:edt_couponKindNm.value}	//objArgumentList
							,-1		//Width
							,-1		//Height
							,""		//Style
							,-1		//Left
							,-1		//Top
							,false	//Modeless
							,true	//ShowTitle
							,"-1"	//Align
							,true);	//Resizable

	if(arrRtn instanceof Object){
		ds_search.setColumn(0, "couponKindCd", arrRtn["couponKindCd"]);
		ds_search.setColumn(0, "couponKindNm", arrRtn["couponKindNm"]);
	}
}

/*----------------------------------------------------------------------------------------------
 * 쿠폰폐기 취소
 *---------------------------------------------------------------------------------------------*/
function btn_cancel_onclick(obj:Button,  e:ClickEventInfo)
{
	if (gfn_dsIsUpdated(ds_list) == false){
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}

	//쿠폰 폐기취소
	var cnt=0;
	for (var i=0;i<ds_list.rowcount;i++){
	    if (ds_list.getColumn(i,"chk") == "1"){
	       cnt += 1;
	    }
	}
	
	if (cnt == 0){
	    alert("선택한 정보가 없습니다");
	    return;
	}
	
	if(gfn_confirm("쿠폰 폐기취소처리 하시겠습니까?")){
		gfn_transaction(this
						,"cancel"
						,"rc/rcg/couponDiscardPop/cancel.xdo"
						,"ds_list=ds_list:U"
						,""
						,""
						,"fn_callBack"
						,true);
	}
}
]]></Script>
  </Form>
</FDL>

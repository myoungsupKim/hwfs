<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="EndOfDayProc" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="일마감 관리" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static05" class="sta_WFDA_Labelbg" position="absolute 93 253 1237 280" anchor="left top"/>
        <Static id="Static04" class="sta_WFDA_Labelbg" position="absolute 93 201 1237 228" anchor="left top"/>
        <Static id="Static03" class="sta_WFDA_Labelbg" position="absolute 93 175 1237 202" anchor="left top"/>
        <Static id="Static31" class="sta_WFDA_Labelbg" position="absolute 93 87 1237 114" anchor="left top"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="1" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30" tabstop="false"/>
        <Static id="Static22" text="일마감 관리" class="sta_WF_Title01" position="absolute 0 43 450 61" anchor="left top"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 30 450 43" anchor="left top"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 56 450 61" anchor="left top"/>
        <Static id="Static49" class="sta_WFDA_Labelbg" position="absolute 93 61 1237 88" anchor="left top"/>
        <Static id="Static26" text="사 업 장" class="sta_WFDA_Label01" position="absolute 0 61 94 88" anchor="left top"/>
        <Static id="Static27" text="마감 일자" class="sta_WFDA_Label01" position="absolute 0 87 94 114" anchor="left top"/>
        <Static id="Static01" class="sta_WFDA_Labelbg" position="absolute 93 227 1237 254" anchor="left top"/>
        <CheckBox id="chk_cardSales" taborder="60" text="카드 승인 정보 (영업회계)" value="true" class="chk_WF_Essential" position="absolute 96 230 327 250"/>
        <Static id="Static02" text="마감 대상 업무" class="sta_WFDA_Label01" position="absolute 0 123 94 383" anchor="left top"/>
        <CheckBox id="chk_goodsInfo" taborder="62" text="매출 상세 정보 (영업회계)" value="true" class="chk_WF_Essential" position="absolute 96 178 327 198"/>
        <CheckBox id="chk_payInfo" taborder="64" text="매출 지불 정보 (영업회계)" value="true" class="chk_WF_Essential" position="absolute 96 204 327 224"/>
        <CheckBox id="chk_salesSum" taborder="66" text="사업장별 매출 자료 집계" value="true" class="chk_WF_Essential" position="absolute 96 256 327 276"/>
        <MuSearchComponent id="cbo_mu" titletext="사업부 선택 Component" taborder="68" onkeydown="cbo_mu_onkeydown" text="MuSearchComponent00" position="absolute 96 64 245 85" bindDataset="" bindMuCdColumn="" appendText="" onItemChangedEvent="fn_muChange" onclick="cbo_mu_onclick"/>
        <TmSearchComponent id="edt_tm" titletext="팀 검색용 Component" taborder="69" text="TmSearchComponent00" position="absolute 344 64 491 85" bindDataset="" bindTmCdColumn="" bindTmNmColumn="" qoBuCd="" qoMuCd="" qoUseYn="" eventAfterTrigger="fn_tmChange" eventBeforeTrigger=""/>
        <UpjangSearchComponent id="edt_upjang" titletext="업장 검색용 Component" taborder="70" text="UpjangSearchComponent00" position="absolute 594 64 717 85" bindDataset="" bindUpjangCodeColumn="" bindUpjangNameColumn="" eventBeforeTrigger="" eventAfterTrigger="fn_upjangChange" roleSetId=""/>
        <Static id="Static08" text="팀" class="sta_WFDA_Label01" position="absolute 247 61 341 88" anchor="left top"/>
        <Static id="Static09" text="사업장" class="sta_WFDA_Label01" position="absolute 496 61 590 88" anchor="left top"/>
        <ObjCalendar id="cal_salesDt" titletext="캘린더" taborder="71" text="ObjCalendar00" scrollbars="none" position="absolute 96 90 196 111"/>
        <Static id="sta_cardInfo" text="마감완료" position="absolute 309 230 1229 250"/>
        <Static id="sta_goodsInfo" text="마감완료" position="absolute 309 178 1229 198"/>
        <Static id="sta_payInfo" text="마감완료" position="absolute 309 204 1229 224"/>
        <Static id="sta_salesSumInfo" text="마감완료" position="absolute 309 256 1229 276"/>
        <Static id="Static00" class="sta_WFDA_Labelbg" position="absolute 93 279 1237 306" anchor="left top"/>
        <CheckBox id="chk_timeSum" taborder="72" text="시간대별 매출 자료 집계" value="true" class="chk_WF_Essential" position="absolute 96 282 327 302"/>
        <Static id="sta_timeSumInfo" text="마감완료" position="absolute 309 282 1229 302"/>
        <Static id="Static07" class="sta_WFDA_Labelbg" position="absolute 93 305 1237 332" anchor="left top"/>
        <CheckBox id="chk_dscnSum" taborder="73" text="할인 유형별 매출 자료 집계" value="true" class="chk_WF_Essential" position="absolute 96 308 327 328"/>
        <Static id="sta_dscnSumInfo" text="마감완료" position="absolute 309 308 1229 328"/>
        <Static id="Static10" class="sta_WFDA_Labelbg" position="absolute 93 331 1237 358" anchor="left top"/>
        <CheckBox id="chk_menuSum" taborder="74" text="메뉴별 매출 자료 집계" value="true" class="chk_WF_Essential" position="absolute 96 334 327 354"/>
        <Static id="sta_menuSumInfo" text="마감완료" position="absolute 309 334 1229 354"/>
        <Static id="Static11" class="sta_WFDA_Labelbg" position="absolute 93 149 1237 176" anchor="left top"/>
        <CheckBox id="chk_salesInfo" taborder="75" text="매출 정보 (영업회계)" value="true" class="chk_WF_Essential" position="absolute 96 152 327 172"/>
        <Static id="sta_salesInfo" text="마감완료" position="absolute 309 152 1229 172"/>
        <Grid id="grd_sodList" taborder="76" binddataset="ds_sodList" autoenter="select" useinputpanel="false" cellsizingtype="col" cellmovingtype="col" autofittype="col" onheadclick="grd_fnbWeekSell_onheadclick" position="absolute 0 413 1237 710" anchor="all" resizeX="100" resizeY="40" moveX="0" moveY="0" titletext="식음 요일별 매출 현황">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="40"/>
                <Column size="105"/>
                <Column size="71"/>
                <Column size="65"/>
                <Column size="70"/>
                <Column size="115"/>
                <Column size="79"/>
                <Column size="79"/>
                <Column size="115"/>
                <Column size="74"/>
                <Column size="93"/>
                <Column size="100"/>
                <Column size="108"/>
                <Column size="105"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" text="업장명"/>
                <Cell col="2" text="일자"/>
                <Cell col="3" text="POS 번호"/>
                <Cell col="4" text="상태"/>
                <Cell col="5" text="개점일시"/>
                <Cell col="6" text="개점자 ID"/>
                <Cell col="7" text="개점자"/>
                <Cell col="8" text="마감일시"/>
                <Cell col="9" text="마감자 ID"/>
                <Cell col="10" text="마감자"/>
                <Cell col="11" text="POS IP"/>
                <Cell col="12" text="주방 출력 순번"/>
                <Cell col="13" text="고객 대기 순번"/>
              </Band>
              <Band id="body">
                <Cell displaytype="number" text="expr:currow+1"/>
                <Cell col="1" displaytype="normal" edittype="none" style="align:left;" text="bind:outletNm"/>
                <Cell col="2" displaytype="date" edittype="none" style="align:center;" text="bind:salesDate"/>
                <Cell col="3" displaytype="normal" text="bind:posNum"/>
                <Cell col="4" displaytype="normal" text="bind:sodStatus"/>
                <Cell col="5" displaytype="normal" text="bind:sodDdtt"/>
                <Cell col="6" displaytype="normal" text="bind:sodId"/>
                <Cell col="7" displaytype="normal" text="bind:sodNm"/>
                <Cell col="8" displaytype="normal" text="bind:closeDdtt"/>
                <Cell col="9" displaytype="normal" text="bind:closeId"/>
                <Cell col="10" displaytype="normal" text="bind:eodNm"/>
                <Cell col="11" text="bind:posIp"/>
                <Cell col="12" displaytype="normal" text="bind:ktcnPrintSeq"/>
                <Cell col="13" displaytype="normal" text="bind:guestWaitSeq"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static12" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 383 450 396" anchor="left top"/>
        <Static id="Static13" text="업장별 마감 현황" class="sta_WF_Title01" position="absolute 0 396 450 414" anchor="left top"/>
        <Static id="Static14" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 409 450 414" anchor="left top"/>
        <Grid id="grd_sodStat" taborder="77" binddataset="ds_eodList" autoenter="select" useinputpanel="false" cellsizingtype="col" cellmovingtype="col" autofittype="col" onheadclick="grd_fnbWeekSell_onheadclick" position="absolute 735 61 1237 113" resizeX="100" resizeY="40" moveX="0" moveY="0" titletext="식음 요일별 매출 현황" fillareatype="linerow" scrollbars="none">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="105"/>
                <Column size="122"/>
                <Column size="85"/>
                <Column size="70"/>
                <Column size="86"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell text="전채 사업장"/>
                <Cell col="1" text="마감 선택된 사업장"/>
                <Cell col="2" text="선택된POS"/>
                <Cell col="3" text="마감 POS"/>
                <Cell col="4" text="미마감 POS"/>
              </Band>
              <Band id="body">
                <Cell displaytype="number" edittype="none" style="align:center;" text="bind:outletTotcnt"/>
                <Cell col="1" displaytype="number" edittype="none" style="align:center;" text="bind:outletCnt"/>
                <Cell col="2" displaytype="number" style="align:center;" text="bind:posCnt"/>
                <Cell col="3" displaytype="number" style="align:center;" text="bind:posEcnt"/>
                <Cell col="4" displaytype="number" style="align:center;" text="bind:posScnt"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static17" class="sta_WFDA_Labelbg" position="absolute 93 123 1237 150" anchor="left top"/>
        <CheckBox id="chk_fopostrInfo" taborder="78" text="자재 출고 (구매자재)" value="true" class="chk_WF_Essential" position="absolute 96 126 327 146"/>
        <Static id="sta_fopostrInfo" text="마감완료" position="absolute 309 126 1229 146"/>
        <Static id="Static18" class="sta_WFDA_Labelbg" position="absolute 93 357 1237 384" anchor="left top"/>
        <CheckBox id="chk_boSum" taborder="79" text="연세대 interface 처리" value="true" class="chk_WF_Essential" position="absolute 96 360 327 380"/>
        <Static id="sta_boSumInfo" text="마감완료" position="absolute 309 362 1229 382"/>
        <Button id="btn_sendMenu" taborder="80" text="마감현황" onclick="btn_sendMenu_onclick" class="btn_WF_Function" position="absolute 1155 35 1233 55" anchor="top right"/>
        <Div id="div_Pop" taborder="81" position="absolute 0 121 1238 712" style="background:white;" anchor="all" visible="false">
          <Layouts>
            <Layout>
              <Grid id="grd_eodList" taborder="0" binddataset="ds_eodOfDayList" autoenter="select" useinputpanel="false" cellsizingtype="col" cellmovingtype="col" autofittype="col" onheadclick="grd_locbyDscn_onheadclick" position="absolute 7 7 1234 589" anchor="all" resizeX="100" resizeY="40" moveX="0" moveY="0" titletext="식음 요일별 매출 현황">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="40"/>
                      <Column size="52"/>
                      <Column size="120"/>
                      <Column size="65"/>
                      <Column size="150"/>
                      <Column size="150"/>
                      <Column size="150"/>
                      <Column size="150"/>
                      <Column size="150"/>
                      <Column size="120"/>
                      <Column size="120"/>
                    </Columns>
                    <Rows>
                      <Row size="24" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell class="head_Excel" taborder="undefined"/>
                      <Cell col="1" colspan="2" text="업장" taborder="undefined"/>
                      <Cell col="3" text="POS상태"/>
                      <Cell col="4" text="자재마감"/>
                      <Cell col="5" text="매출해더"/>
                      <Cell col="6" text="매출상세"/>
                      <Cell col="7" text="지불내역"/>
                      <Cell col="8" text="카드승인정보"/>
                      <Cell col="9" text="마감시간"/>
                      <Cell col="10" text="수정시간"/>
                    </Band>
                    <Band id="body">
                      <Cell text="expr:currow+1"/>
                      <Cell col="1" text="bind:outletCd"/>
                      <Cell col="2" displaytype="normal" style="align:left;" text="bind:outletNm"/>
                      <Cell col="3" text="bind:sodNm"/>
                      <Cell col="4" displaytype="text" text="bind:oRtnmsgInv"/>
                      <Cell col="5" displaytype="text" text="bind:oRtnmsgInfo"/>
                      <Cell col="6" displaytype="text" text="bind:oRtnmsgGoods"/>
                      <Cell col="7" displaytype="text" text="bind:oRtnmsgPay"/>
                      <Cell col="8" displaytype="text" text="bind:oRtnmsgCard"/>
                      <Cell col="9" displaytype="text" text="bind:cdateInfo"/>
                      <Cell col="10" displaytype="text" text="bind:udateInfo"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
            </Layout>
          </Layouts>
        </Div>
      </Layout>
    </Layouts>
    <Bind/>
    <Objects>
      <Dataset id="ds_paramInfo" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="salesDt" type="STRING" size="256"/>
          <Column id="muCd" type="STRING" size="256"/>
          <Column id="tmCd" type="STRING" size="256"/>
          <Column id="outletCd" type="STRING" size="256"/>
          <Column id="empNo" type="STRING" size="256"/>
          <Column id="frSalesDt" type="STRING" size="256"/>
          <Column id="toSalesDt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_paramInfoValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="salesDt" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="salesDt">title:시작일,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_sumInfo" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="oRtn" type="STRING" size="256"/>
          <Column id="oRtnmsg" type="STRING" size="256"/>
          <Column id="O_RTN" type="STRING" size="256"/>
          <Column id="O_RTNMSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_timeSumInfo" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="oRtn" type="STRING" size="256"/>
          <Column id="oRtnmsg" type="STRING" size="256"/>
          <Column id="O_RTN" type="STRING" size="256"/>
          <Column id="O_RTNMSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_menuSumInfo" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="oRtn" type="STRING" size="256"/>
          <Column id="oRtnmsg" type="STRING" size="256"/>
          <Column id="O_RTN" type="STRING" size="256"/>
          <Column id="O_RTNMSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_discnSumInfo" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="oRtn" type="STRING" size="256"/>
          <Column id="oRtnmsg" type="STRING" size="256"/>
          <Column id="O_RTN" type="STRING" size="256"/>
          <Column id="O_RTNMSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">Y</Col>
            <Col id="insYn">N</Col>
            <Col id="delYn">N</Col>
            <Col id="savYn">Y</Col>
            <Col id="prtYn">N</Col>
            <Col id="exlYn">Y</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_eodList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="salesInfo" type="STRING" size="256"/>
          <Column id="goodsInfo" type="STRING" size="256"/>
          <Column id="payInfo" type="STRING" size="256"/>
          <Column id="cardApproval" type="STRING" size="256"/>
          <Column id="outletSales" type="STRING" size="256"/>
          <Column id="timeSales" type="STRING" size="256"/>
          <Column id="discnSales" type="STRING" size="256"/>
          <Column id="menuSales" type="STRING" size="256"/>
          <Column id="outletCnt" type="STRING" size="256"/>
          <Column id="posScnt" type="STRING" size="256"/>
          <Column id="posEcnt" type="STRING" size="256"/>
          <Column id="posCnt" type="STRING" size="256"/>
          <Column id="outletTotcnt" type="STRING" size="256"/>
          <Column id="boSales" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_salesInfo" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="oRtn" type="STRING" size="256"/>
          <Column id="oRtnmsg" type="STRING" size="256"/>
          <Column id="O_RTN" type="STRING" size="256"/>
          <Column id="O_RTNMSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_salesDetailInfo" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="oRtn" type="STRING" size="256"/>
          <Column id="oRtnmsg" type="STRING" size="256"/>
          <Column id="O_RTN" type="STRING" size="256"/>
          <Column id="O_RTNMSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_salesPaymentInfo" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="oRtn" type="STRING" size="256"/>
          <Column id="oRtnmsg" type="STRING" size="256"/>
          <Column id="O_RTN" type="STRING" size="256"/>
          <Column id="O_RTNMSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="cardApprovalInfo" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="oRtn" type="STRING" size="256"/>
          <Column id="oRtnmsg" type="STRING" size="256"/>
          <Column id="O_RTN" type="STRING" size="256"/>
          <Column id="O_RTNMSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sodList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="salesDate" type="STRING" size="256"/>
          <Column id="posNum" type="STRING" size="256"/>
          <Column id="outletCd" type="STRING" size="256"/>
          <Column id="bcCd" type="STRING" size="256"/>
          <Column id="sodStatus" type="STRING" size="256"/>
          <Column id="sodDdtt" type="STRING" size="256"/>
          <Column id="sodId" type="STRING" size="256"/>
          <Column id="posIp" type="STRING" size="256"/>
          <Column id="closeDdtt" type="STRING" size="256"/>
          <Column id="closeId" type="STRING" size="256"/>
          <Column id="ktcnPrintSeq" type="STRING" size="256"/>
          <Column id="guestWaitSeq" type="STRING" size="256"/>
          <Column id="outletNm" type="STRING" size="256"/>
          <Column id="sodNm" type="STRING" size="256"/>
          <Column id="eodNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_fopostrInfo" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="oRtn" type="STRING" size="256"/>
          <Column id="oRtnmsg" type="STRING" size="256"/>
          <Column id="O_RTN" type="STRING" size="256"/>
          <Column id="O_RTNMSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_boSumInfo" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="oRtn" type="STRING" size="256"/>
          <Column id="oRtnmsg" type="STRING" size="256"/>
          <Column id="O_RTN" type="STRING" size="256"/>
          <Column id="O_RTNMSG" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_eodOfDayList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="outletCd" type="STRING" size="255"/>
          <Column id="outletNm" type="STRING" size="255"/>
          <Column id="sodNm" type="STRING" size="255"/>
          <Column id="eodInv" type="STRING" size="255"/>
          <Column id="oRtnInv" type="STRING" size="255"/>
          <Column id="oRtnmsgInv" type="STRING" size="255"/>
          <Column id="cdateInv" type="STRING" size="255"/>
          <Column id="udateInv" type="STRING" size="255"/>
          <Column id="eodInfo" type="STRING" size="255"/>
          <Column id="oRtnInfo" type="STRING" size="255"/>
          <Column id="oRtnmsgInfo" type="STRING" size="255"/>
          <Column id="cdateInfo" type="STRING" size="255"/>
          <Column id="udateInfo" type="STRING" size="255"/>
          <Column id="eodGoods" type="STRING" size="255"/>
          <Column id="oRtnGoods" type="STRING" size="255"/>
          <Column id="oRtnmsgGoods" type="STRING" size="255"/>
          <Column id="cdateGoods" type="STRING" size="255"/>
          <Column id="udateGoods" type="STRING" size="255"/>
          <Column id="eodPay" type="STRING" size="255"/>
          <Column id="oRtnPay" type="STRING" size="255"/>
          <Column id="oRtnmsgPay" type="STRING" size="255"/>
          <Column id="cdatePay" type="STRING" size="255"/>
          <Column id="udatePay" type="STRING" size="255"/>
          <Column id="eodCard" type="STRING" size="255"/>
          <Column id="oRtnCard" type="STRING" size="255"/>
          <Column id="oRtnmsgCard" type="STRING" size="255"/>
          <Column id="cdateCard" type="STRING" size="255"/>
          <Column id="udateCard" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <InitValue/>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : EndOfDayProc
  파 일 명 : EndOfDayProc.xfdl
  기    능 : 일마감 관리 

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.08.03   박대영   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";


/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_sToday = gfn_today();


/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{	
	// 권한설정
	edt_tm.applyAuthLevel(cbo_mu);
	edt_upjang.applyAuthLevel(edt_tm);
	edt_upjang.setForcedRoleSet("OutletUpjang");
	
	//날자
	cal_salesDt.fn_initMonthCal(this, fv_sToday, "fn_calendarFromCallBack", null, null, "Y");
	
	 
	sta_fopostrInfo.text="";
	sta_salesInfo.text="";
	sta_goodsInfo.text="";
	sta_payInfo.text="";
	sta_cardInfo.text="";
		
	sta_salesSumInfo.text="";
	sta_timeSumInfo.text="";
	sta_dscnSumInfo.text="";
	sta_menuSumInfo.text="";
	
	fn_search();
}
 

/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
	fn_screenClear();
	
	ds_paramInfo.clearData();
	var nIdx = ds_paramInfo.addRow();
	ds_paramInfo.setColumn(nIdx, "salesDt", gfn_nvl(cal_salesDt.fn_getValue(),""));
	ds_paramInfo.setColumn(nIdx, "muCd",  gfn_nvl(cbo_mu.getMuCode(),""));
	ds_paramInfo.setColumn(nIdx, "tmCd",  gfn_nvl(edt_tm.getTmCode(),""));
	ds_paramInfo.setColumn(nIdx, "outletCd",  gfn_nvl(edt_upjang.getUpjangCode(),""));
	ds_paramInfo.setColumn(nIdx, "empNo",  gfn_nvl(g_EmpNo,""));
 	
 	ds_paramInfo.setColumn(nIdx, "frSalesDt", gfn_nvl(cal_salesDt.fn_getValue(),""));
	ds_paramInfo.setColumn(nIdx, "toSalesDt", gfn_nvl(cal_salesDt.fn_getValue(),""));
 	
 	
	if (gfn_validCheck(ds_paramInfo, ds_paramInfoValid) == false)	return;	//기본자료는 꼭 입력되어야 함
	 
	var strSvcID    = "search";
	var strURL      = "rc/sle/eodMgmt/eodList.xdo";
	var strInDs     = "ds_paramInfo=ds_paramInfo:A";
	var strOutDs    = "ds_eodList=ds_eodList";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = true;
	
	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	 
	
	
	// Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_sodList);
	ds_sodList.clearData();
	 
    var strSvcID    = "sodSearch";
	var strURL      = "rc/sle/posSodEodList/selectList.xdo";
	var strInDs     = "ds_paramInfo=ds_paramInfo:A";
	var strOutDs    = "ds_sodList=ds_sodList";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = true;

	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	
	
	
	// Grid sort 표시 초기화(필수)
    gfn_clearSortMark(div_Pop.grd_eodList);
	ds_eodOfDayList.clearData();
	 
    var strSvcID    = "eodOfDayList";
	var strURL      = "rc/sle/eodMgmt/eodOfDayList.xdo";
	var strInDs     = "ds_paramInfo=ds_paramInfo:A";
	var strOutDs    = "ds_eodOfDayList=ds_eodOfDayList";
	var strArg      = "";
	var strCallback = "fn_callBack";
	var bAsync      = true;

	gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 신규 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_insert()
{	
 
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 삭제 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_delete()
{
 
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{

	//선택된 사업장이 없는 경우 개점이 하나도 안된경우
	//일단은 개점이 있는 경우 마감여부 묻기
	 
	if(ds_eodList.rowposition == -1) 
	{
		gfn_alert("마감 작업 할 자료가 없습니다.", "알림");	// 선택된 항목이 없습니다.
		return;
	}
	
	var nCnt = ds_eodList.getColumn(ds_eodList.rowposition,"posScnt")
	
	if (nCnt > 0)
	{
		var rtVal = gfn_confirm("개점된 포스가 있습니다. 마감을 진행 하시겠습니까?");	// 선택된 자료를 삭제 하시겠습니까?
		if (rtVal == false) 
		{	
			return;
		}
	}
	else
	{
		var rtVal = gfn_confirm("마감을 진행 하시겠습니까?");	// 선택된 자료를 삭제 하시겠습니까?
		if (rtVal == false) 
		{	
			return;
		}
	}
	ds_paramInfo.clearData();
	var nIdx = ds_paramInfo.addRow();
	 
 	ds_paramInfo.setColumn(nIdx, "salesDt", gfn_nvl(cal_salesDt.fn_getValue(),""));
	ds_paramInfo.setColumn(nIdx, "muCd",  gfn_nvl(cbo_mu.getMuCode(),""));
	ds_paramInfo.setColumn(nIdx, "tmCd",  gfn_nvl(edt_tm.getTmCode(),""));
	ds_paramInfo.setColumn(nIdx, "outletCd",  gfn_nvl(edt_upjang.getUpjangCode(),""));
	ds_paramInfo.setColumn(nIdx, "empNo",  gfn_nvl(g_EmpNo,""));
 	
 	ds_paramInfo.setColumn(nIdx, "frSalesDt", gfn_nvl(cal_salesDt.fn_getValue(),""));
	ds_paramInfo.setColumn(nIdx, "toSalesDt", gfn_nvl(cal_salesDt.fn_getValue(),""));
 	
 	 
	if (gfn_validCheck(ds_paramInfo, ds_paramInfoValid) == false)	return;	//기본자료는 꼭 입력되어야 함
	
	
	//자재정보 전송
	if (chk_fopostrInfo.value == true)
	{
		sta_fopostrInfo.text = "작업 시작";
		this.updateWindow();
		
		var strSvcID    = "fopostrInfo";
		var strURL      = "rc/sle/eodMgmt/fopostrInfo.xdo";
		var strInDs     = "ds_paramInfo=ds_paramInfo:A";
		var strOutDs    = "ds_fopostrInfo=ds_fopostrInfo";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}
	
	//매출정보 전송
	if (chk_salesInfo.value == true)
	{
	
		sta_salesInfo.text = "작업 시작";
		this.updateWindow();
		
		var strSvcID    = "salesInfo";
		var strURL      = "rc/sle/eodMgmt/salesInfo.xdo";
		var strInDs     = "ds_paramInfo=ds_paramInfo:A";
		var strOutDs    = "ds_salesInfo=ds_salesInfo";
		var strArg      = "";
		var strCallback = "fn_callBack"; 
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}
	
	//매출상세정보 전송
	if (chk_goodsInfo.value == true)
	{
		sta_goodsInfo.text = "작업 시작";
		this.updateWindow();
		
		var strSvcID    = "salesDetailInfo";
		var strURL      = "rc/sle/eodMgmt/salesDetailInfo.xdo";
		var strInDs     = "ds_paramInfo=ds_paramInfo:A";
		var strOutDs    = "ds_salesDetailInfo=ds_salesDetailInfo";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}
	
	//매출결제정보 전송
	if (chk_payInfo.value == true)
	{
		sta_payInfo.text = "작업 시작";
		this.updateWindow();
		
		var strSvcID    = "salesPaymentInfo";
		var strURL      = "rc/sle/eodMgmt/salesPaymentInfo.xdo";
		var strInDs     = "ds_paramInfo=ds_paramInfo:A";
		var strOutDs    = "ds_salesPaymentInfo=ds_salesPaymentInfo";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}
	
	//카드승인내역 전송
	if (chk_cardSales.value == true)
	{
		sta_cardInfo.text = "작업 시작";
		this.updateWindow();
		
		var strSvcID    = "cardApprovalInfo";
		var strURL      = "rc/sle/eodMgmt/cardApprovalInfo.xdo";
		var strInDs     = "ds_paramInfo=ds_paramInfo:A";
		var strOutDs    = "cardApprovalInfo=cardApprovalInfo";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}
	
	//매출집계
	if (chk_salesSum.value == true)
	{
		sta_salesSumInfo.text = "작업 시작";
		this.updateWindow();
		
		var strSvcID    = "salesSum";
		var strURL      = "rc/sle/eodMgmt/salesSum.xdo";
		var strInDs     = "ds_paramInfo=ds_paramInfo:A";
		var strOutDs    = "ds_sumInfo=ds_sumInfo";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}
	
	//시간별집계
	if (chk_timeSum.value == true)
	{
	
		trace(ds_paramInfo.saveXML());
		
		sta_timeSumInfo.text = "작업 시작";
		this.updateWindow();
		
		var strSvcID    = "timeSum";
		var strURL      = "rc/sle/eodMgmt/timeSum.xdo";
		var strInDs     = "ds_paramInfo=ds_paramInfo:A";
		var strOutDs    = "ds_timeSumInfo=ds_timeSumInfo";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}
	
	//할인유형별 집계
	if (chk_dscnSum.value == true)
	{
		sta_dscnSumInfo.text = "작업 시작";
		this.updateWindow();
		
		var strSvcID    = "discnSum";
		var strURL      = "rc/sle/eodMgmt/discnSum.xdo";
		var strInDs     = "ds_paramInfo=ds_paramInfo:A";
		var strOutDs    = "ds_discnSumInfo=ds_discnSumInfo";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}
	
	
	//메뉴별 집계
	if (chk_menuSum.value == true)
	{
		sta_menuSumInfo.text = "작업 시작";
		this.updateWindow();
		
		var strSvcID    = "menuSum";
		var strURL      = "rc/sle/eodMgmt/menuSum.xdo";
		var strInDs     = "ds_paramInfo=ds_paramInfo:A";
		var strOutDs    = "ds_menuSumInfo=ds_menuSumInfo";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}
	
	//boInterface
	if (chk_boSum.value == true)
	{
		sta_boSumInfo.text = "작업 시작";
		this.updateWindow();
		
		var strSvcID    = "boInterface";
		var strURL      = "rc/sle/eodMgmt/boInterface.xdo";
		var strInDs     = "ds_paramInfo=ds_paramInfo:A";
		var strOutDs    = "ds_boSumInfo=ds_boSumInfo";
		var strArg      = "";
		var strCallback = "fn_callBack";
		var bAsync      = true;
		
		gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 출력 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_print()
{
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 도움말 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_help()
{
	
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {
		case "sodSearch":
			 
			break;
        case "search" :
        
            var nRow = ds_eodList.rowposition;
            sta_fopostrInfo.text = ds_eodList.getColumn(nRow,"fopostrInfo");
            sta_cardInfo.text = ds_eodList.getColumn(nRow,"cardInfo");
            sta_salesInfo.text = ds_eodList.getColumn(nRow,"salesInfo");
            sta_goodsInfo.text = ds_eodList.getColumn(nRow,"goodsInfo");
            sta_payInfo.text = ds_eodList.getColumn(nRow,"payInfo");
            
            sta_salesSumInfo.text = ds_eodList.getColumn(nRow,"outletSales");
            sta_timeSumInfo.text = ds_eodList.getColumn(nRow,"timeSales");
            sta_dscnSumInfo.text = ds_eodList.getColumn(nRow,"discnSales");
            sta_menuSumInfo.text = ds_eodList.getColumn(nRow,"menuSales");
            sta_boSumInfo.text = ds_eodList.getColumn(nRow,"boSales");
            
            break;
        
        case "fopostrInfo":
			var nRow = ds_fopostrInfo.rowposition;
			var tmpFlag = ds_fopostrInfo.getColumn(nRow,"O_RTN");
			var tmpMsg = ds_fopostrInfo.getColumn(nRow,"O_RTNMSG");
			if (tmpFlag =="TRUE")
			{
				sta_fopostrInfo.style.background.color = "";
				sta_fopostrInfo.style.color="#444444ff";
				sta_fopostrInfo.text = "정상적으로 작업이 완료 되었습니다.";
			} 
			else
			{
				sta_fopostrInfo.style.background.color = "red";
				sta_fopostrInfo.style.color="yellow";
				sta_fopostrInfo.text = "오류 내역:" +  tmpMsg;
			}
			break;
			
		//매출정보 
        case "salesInfo":
			
			var nRow = ds_salesInfo.rowposition;
			var tmpFlagIf = ds_salesInfo.getColumn(nRow,"oRtn");
			var tmpMsgIf = ds_salesInfo.getColumn(nRow,"oRtnmsg");
			var tmpFlag = ds_salesInfo.getColumn(nRow,"O_RTN");
			var tmpMsg = ds_salesInfo.getColumn(nRow,"O_RTNMSG");
			if ((tmpFlag =="TRUE") && (tmpFlagIf =="TRUE"))
			{
				sta_salesInfo.style.background.color = "";
				sta_salesInfo.style.color="#444444ff";
				sta_salesInfo.text = "정상적으로 작업이 완료 되었습니다.";
			} 
			else
			{
				sta_salesInfo.style.background.color = "red";
				sta_salesInfo.style.color="yellow";
				if (tmpFlagIf !="TRUE") sta_salesInfo.text = "오류 외부:" +  tmpMsgIf;
				if (tmpFlag   !="TRUE") sta_salesInfo.text = "오류 내역:" +  tmpMsg;
			}
			break;
		//매출상세
		case "salesDetailInfo":
			var nRow = ds_salesDetailInfo.rowposition;
			var tmpFlagIf = ds_salesDetailInfo.getColumn(nRow,"oRtn");
			var tmpMsgIf = ds_salesDetailInfo.getColumn(nRow,"oRtnmsg");
			var tmpFlag = ds_salesDetailInfo.getColumn(nRow,"O_RTN");
			var tmpMsg = ds_salesDetailInfo.getColumn(nRow,"O_RTNMSG");
			if ((tmpFlag =="TRUE") && (tmpFlagIf =="TRUE"))
			{
				sta_goodsInfo.style.background.color = "";
				sta_goodsInfo.style.color="#444444ff";
				sta_goodsInfo.text = "정상적으로 작업이 완료 되었습니다.";
			} 
			else
			{
				sta_goodsInfo.style.background.color = "red";
				sta_goodsInfo.style.color="yellow";
				if (tmpFlagIf !="TRUE") sta_goodsInfo.text = "오류 외부:" +  tmpMsgIf;
				if (tmpFlag   !="TRUE") sta_goodsInfo.text = "오류 내역:" +  tmpMsg;
			}
			break;
		//지불내역
		case "salesPaymentInfo":
			var nRow = ds_salesPaymentInfo.rowposition;
			var tmpFlagIf = ds_salesPaymentInfo.getColumn(nRow,"oRtn");
			var tmpMsgIf = ds_salesPaymentInfo.getColumn(nRow,"oRtnmsg");
			var tmpFlag = ds_salesPaymentInfo.getColumn(nRow,"O_RTN");
			var tmpMsg = ds_salesPaymentInfo.getColumn(nRow,"O_RTNMSG");
			if ((tmpFlag =="TRUE") && (tmpFlagIf =="TRUE"))
			{
				sta_payInfo.style.background.color = "";
				sta_payInfo.style.color="#444444ff";
				sta_payInfo.text = "정상적으로 작업이 완료 되었습니다.";
			} 
			else
			{
				sta_payInfo.style.background.color = "red";
				sta_payInfo.style.color="yellow";
				if (tmpFlagIf !="TRUE") sta_payInfo.text = "오류 외부:" +  tmpMsgIf;
				if (tmpFlag   !="TRUE") sta_payInfo.text = "오류 내역:" +  tmpMsg;
			}
			break;
		//카드승인내역	
		case "cardApprovalInfo":
			var nRow = cardApprovalInfo.rowposition;
			var tmpFlagIf = cardApprovalInfo.getColumn(nRow,"oRtn");
			var tmpMsgIf = cardApprovalInfo.getColumn(nRow,"oRtnmsg");
			var tmpFlag = cardApprovalInfo.getColumn(nRow,"O_RTN");
			var tmpMsg = cardApprovalInfo.getColumn(nRow,"O_RTNMSG");
			if ((tmpFlag =="TRUE") && (tmpFlagIf =="TRUE"))
			{
				sta_cardInfo.style.background.color = "";
				sta_cardInfo.style.color="#444444ff";
				sta_cardInfo.text = "정상적으로 작업이 완료 되었습니다.";
			} 
			else
			{
				sta_cardInfo.style.background.color = "red";
				sta_cardInfo.style.color="yellow";
				if (tmpFlagIf !="TRUE") sta_cardInfo.text = "오류 외부:" +  tmpMsgIf;
				if (tmpFlag   !="TRUE") sta_cardInfo.text = "오류 내역:" +  tmpMsg;
			}
			break;
		//매출집계	
        case "salesSum" :
			var nRow = ds_sumInfo.rowposition;
			var tmpFlagIf = ds_sumInfo.getColumn(nRow,"oRtn");
			var tmpMsgIf = ds_sumInfo.getColumn(nRow,"oRtnmsg");
			var tmpFlag = ds_sumInfo.getColumn(nRow,"O_RTN");
			var tmpMsg = ds_sumInfo.getColumn(nRow,"O_RTNMSG");
			if ((tmpFlag =="TRUE") && (tmpFlagIf =="TRUE"))
			{
				sta_salesSumInfo.style.background.color = "";
				sta_salesSumInfo.style.color="#444444ff";
				sta_salesSumInfo.text = "정상적으로 작업이 완료 되었습니다.";
			} 
			else
			{
				sta_salesSumInfo.style.background.color = "red";
				sta_salesSumInfo.style.color="yellow";
				if (tmpFlagIf !="TRUE") sta_salesSumInfo.text = "오류 외부:" +  tmpMsgIf;
				if (tmpFlag   !="TRUE") sta_salesSumInfo.text = "오류 내역:" +  tmpMsg;
			}
            break; 
         //시간대별집계
		 case "timeSum" :
			
			var nRow = ds_timeSumInfo.rowposition;
			var tmpFlagIf = ds_timeSumInfo.getColumn(nRow,"oRtn");
			var tmpMsgIf = ds_timeSumInfo.getColumn(nRow,"oRtnmsg");
			var tmpFlag = ds_timeSumInfo.getColumn(nRow,"O_RTN");
			var tmpMsg = ds_timeSumInfo.getColumn(nRow,"O_RTNMSG");
			if ((tmpFlag =="TRUE") && (tmpFlagIf =="TRUE"))
			{
				sta_timeSumInfo.style.background.color = "";
				sta_timeSumInfo.style.color="#444444ff";
				sta_timeSumInfo.text = "정상적으로 작업이 완료 되었습니다.";
			} 
			else
			{
				sta_timeSumInfo.style.background.color = "red";
				sta_timeSumInfo.style.color="yellow";
				if (tmpFlagIf !="TRUE") sta_timeSumInfo.text = "오류 외부:" +  tmpMsgIf;
				if (tmpFlag   !="TRUE") sta_timeSumInfo.text = "오류 내역:" +  tmpMsg;
			}
            break;
        //메뉴별집계    
		case "menuSum" :
			 
			var nRow = ds_menuSumInfo.rowposition;
			var tmpFlagIf = ds_menuSumInfo.getColumn(nRow,"oRtn");
			var tmpMsgIf = ds_menuSumInfo.getColumn(nRow,"oRtnmsg");
			var tmpFlag = ds_menuSumInfo.getColumn(nRow,"O_RTN");
			var tmpMsg = ds_menuSumInfo.getColumn(nRow,"O_RTNMSG");
			if ((tmpFlag =="TRUE") && (tmpFlagIf =="TRUE"))
			{
				sta_menuSumInfo.style.background.color = "";
				sta_menuSumInfo.style.color="#444444ff";	
				sta_menuSumInfo.text = "정상적으로 작업이 완료 되었습니다.";
			} 
			else
			{
				sta_menuSumInfo.style.background.color = "red";
				sta_menuSumInfo.style.color="yellow";
				if (tmpFlagIf !="TRUE") sta_menuSumInfo.text = "오류 외부:" +  tmpMsgIf;
				if (tmpFlag   !="TRUE") sta_menuSumInfo.text = "오류 내역:" +  tmpMsg;
			}
            break;
        //할인유형별 집계    
		case "discnSum" :
			
			var nRow = ds_discnSumInfo.rowposition;
			var tmpFlag = ds_discnSumInfo.getColumn(nRow,"O_RTN");
			var tmpMsg = ds_discnSumInfo.getColumn(nRow,"O_RTNMSG");
			if (tmpFlag =="TRUE")
			{
				sta_dscnSumInfo.style.background.color = "";
				sta_dscnSumInfo.style.color="#444444ff";
				sta_dscnSumInfo.text = "정상적으로 작업이 완료 되었습니다.";
			} 
			else
			{
				sta_dscnSumInfo.style.background.color = "red";
				sta_dscnSumInfo.style.color="yellow";
				sta_dscnSumInfo.text = "오류 내역:" +  tmpMsg;
			}
            break;
            
		//연세대 인터페이스  
		case "boInterface" :
			
			var nRow = ds_boSumInfo.rowposition;
			var tmpFlag = ds_boSumInfo.getColumn(nRow,"O_RTN");
			var tmpMsg = ds_boSumInfo.getColumn(nRow,"O_RTNMSG");
			if (tmpFlag =="TRUE")
			{
				sta_boSumInfo.style.background.color = "";
				sta_boSumInfo.style.color="#444444ff";
				sta_boSumInfo.text = "정상적으로 작업이 완료 되었습니다.";
			} 
			else
			{
				sta_boSumInfo.style.background.color = "red";
				sta_boSumInfo.style.color="yellow";
				sta_boSumInfo.text = "오류 내역:" +  tmpMsg;
			}
            break;
		case "eodOfDayList":
			break;
    }
}

   
	
function fn_calendarFromCallBack()
{
	fn_screenClear();
}

/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/


/************************************************************************************************
 * 각 COMPONENT 별 EVENT 영역 (필수)
************************************************************************************************/

/*----------------------------------------------------------------------------------------------
 * 설명      : 사업부 변경되는 경우
 *---------------------------------------------------------------------------------------------*/
function fn_muChange(obj, event)
{
	edt_tm.setTmCode("");
	edt_upjang.setUpjangCode("");
	fn_screenClear();
	 
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 팀(운영부서) 변경되는 경우
 *---------------------------------------------------------------------------------------------*/
 
//팀(운영부서) 변경되는 경우
function fn_tmChange(obj, data)
{
	edt_upjang.setUpjangCode("");
	fn_screenClear();
	 
}
/*----------------------------------------------------------------------------------------------
 * 설명      : 업장(사업장) 변경되는 경우
 *---------------------------------------------------------------------------------------------*/
function fn_upjangChange(obj,data)
{
	fn_screenClear();
}  


function fn_screenClear()
{
	ds_sodList.clearData();
	ds_eodList.clearData();
	
	sta_fopostrInfo.text="";
	sta_salesInfo.text="";
	sta_goodsInfo.text="";
	sta_payInfo.text="";
	sta_cardInfo.text="";

	sta_salesSumInfo.text="";
	sta_timeSumInfo.text="";
	sta_dscnSumInfo.text="";
	sta_menuSumInfo.text="";
	sta_boSumInfo.text="";
	
	sta_fopostrInfo.style.background.color = "";
	sta_fopostrInfo.style.color="#444444ff";
	sta_salesInfo.style.background.color = "";
	sta_salesInfo.style.color="#444444ff";
	sta_goodsInfo.style.background.color = "";
	sta_goodsInfo.style.color="#444444ff";
	sta_payInfo.style.background.color = "";
	sta_payInfo.style.color="#444444ff";
	sta_cardInfo.style.background.color = "";
	sta_cardInfo.style.color="#444444ff";
	sta_salesSumInfo.style.background.color = "";
	sta_salesSumInfo.style.color="#444444ff";
	sta_timeSumInfo.style.background.color = "";
	sta_timeSumInfo.style.color="#444444ff";
	sta_dscnSumInfo.style.background.color = "";
	sta_dscnSumInfo.style.color="#444444ff";
	sta_menuSumInfo.style.background.color = "";
	sta_menuSumInfo.style.color="#444444ff";
	
	sta_boSumInfo.style.background.color = "";
	sta_boSumInfo.style.color="#444444ff";
	
}

 
function btn_sendMenu_onclick(obj:Button,  e:ClickEventInfo)
{
	if (div_Pop.visible == true)
	{
		div_Pop.visible = false;
	}
	else
	{
		div_Pop.visible = true;
	}
}
]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="SpecmTypeArticleMgmtExcel" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 725" titletext="검체유형항목관리" scrollbars="autoboth" onload="form_onload">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 710 1252 725" anchor="left bottom"/>
        <Div id="div_cmnBtn" anchor="left top right" taborder="16" url="cmn::CmnBtn.xfdl" text="Div00" scrollbars="none" position="absolute 0 0 1237 30"/>
        <Static id="Static22" text="검체유형 대분류" class="sta_WF_Title01" position="absolute 0 84 223 102" anchor="left top"/>
        <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 71 330 84" anchor="left top"/>
        <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 0 97 330 102" anchor="left top"/>
        <Static id="Static25" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 302 97 386 102" anchor="top right"/>
        <Static id="Static26" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 298 71 382 77" anchor="top right"/>
        <Static id="Static08" class="sta_WFSA_Labelbg" position="absolute 0 30 1237 71" anchor="left top right"/>
        <Static id="Static28" text="공전유형" class="sta_WFSA_label" position="absolute 15 40 101 61" anchor="left top"/>
        <Static id="Static04" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 30 93 40" anchor="left top"/>
        <Static id="Static05" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 0 61 93 71" anchor="left top"/>
        <Static id="Static07" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 40 15 61" anchor="left top"/>
        <Static id="Static11" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 73 40 83 61" anchor="left top"/>
        <Static id="Static09" text="w30" class="Guide01_AreaRed" visible="false" position="absolute 243 40 273 61" anchor="left top"/>
        <Combo id="cbo_specmTypeCd" taborder="0" position="absolute 83 40 243 61" anchor="left top" innerdataset="ds_cboSpecmTypeCd" datacolumn="codeName" codecolumn="code" index="-1" onitemchanged="cbo_specmTypeCd_onitemchanged" class="cmb_WF_Essential" tabstop="true"/>
        <Static id="Static03" text="대분류" class="sta_WFSA_label" position="absolute 273 40 335 61" anchor="left top"/>
        <Static id="Static10" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 318 40 328 61" anchor="left top"/>
        <Edit id="edt_search" taborder="1" position="absolute 328 40 488 61" anchor="left top" imemode="hangul" onkeydown="edt_search_onkeydown" tabstop="true"/>
        <Button id="btn_addMgrp" taborder="3" class="btn_WF_GrdPlus" position="absolute 334 77 352 97" anchor="left top" tooltiptext="추가" onclick="btn_addMgrp_onclick"/>
        <Button id="btn_delMgrp" taborder="4" class="btn_WF_GrdMinus" position="absolute 354 77 372 97" anchor="left top" tooltiptext="삭제" onclick="btn_delMgrp_onclick"/>
        <Static id="Static23" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 352 77 354 97" anchor="top right"/>
        <Static id="Static24" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 372 77 374 97" anchor="top right"/>
        <Grid id="grd_mgrpList" taborder="2" binddataset="ds_mgrpList" autoenter="select" useinputpanel="false" cellsizingtype="col" autofittype="col" position="absolute 0 102 392 398" anchor="left top" selecttype="row" cellclickbound="control" fillareatype="none" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" oncelldblclick="grd_mgrpList_oncelldblclick" onheadclick="grd_mgrpList_onheadclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="44"/>
                <Column size="90"/>
                <Column size="195"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" edittype="text" class="grd_WF_Essential" text="대분류코드"/>
                <Cell col="2" class="grd_WF_Essential" text="대분류명"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" edittype="none" style="align:center;" text="bind:mgrpCd"/>
                <Cell col="2" displaytype="text" edittype="text" style="align: ;" text="bind:mgrpNm"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static00" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 332 77 334 97" anchor="top right"/>
        <Static id="sta_mgrpCnt" text="총건수 : 0건" position="absolute 141 85 272 99"/>
        <Button id="btn_saveMgrp" taborder="5" class="btn_WF_GrdSave" position="absolute 374 77 392 97" anchor="left top" tooltiptext="저장" onclick="btn_saveMgrp_onclick"/>
        <Static id="Static01" text="검체유형 중분류" class="sta_WF_Title01" position="absolute 402 84 625 102" anchor="left top"/>
        <Static id="Static02" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 402 71 732 84" anchor="left top"/>
        <Static id="Static12" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 402 97 732 102" anchor="left top"/>
        <Static id="Static13" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 728 97 812 102" anchor="top right"/>
        <Static id="Static14" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 728 71 812 77" anchor="top right"/>
        <Button id="btn_addMcalss" taborder="7" class="btn_WF_GrdPlus" position="absolute 758 77 776 97" anchor="left top" tooltiptext="추가" onclick="btn_addMcalss_onclick"/>
        <Button id="btn_delMcalss" taborder="8" class="btn_WF_GrdMinus" position="absolute 778 77 796 97" anchor="left top" tooltiptext="삭제" onclick="btn_delMcalss_onclick"/>
        <Static id="Static17" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 776 77 778 97" anchor="top right"/>
        <Static id="Static18" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 796 77 798 97" anchor="top right"/>
        <Static id="Static19" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 756 77 758 97" anchor="top right"/>
        <Static id="sta_mcalssCnt" text="총건수 : 0건" position="absolute 544 85 675 99"/>
        <Button id="btn_saveMcalss" taborder="9" class="btn_WF_GrdSave" position="absolute 798 77 816 97" anchor="left top" tooltiptext="저장" onclick="btn_saveMcalss_onclick"/>
        <Grid id="grd_mcalssList" taborder="6" binddataset="ds_mcalssList" useinputpanel="false" selecttype="row" cellsizingtype="col" autofittype="col" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" position="absolute 402 102 816 398" anchor="left top" autoenter="select" oncelldblclick="grd_mcalssList_oncelldblclick" onheadclick="grd_mcalssList_onheadclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="44"/>
                <Column size="90"/>
                <Column size="161"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" edittype="text" class="grd_WF_Essential" text="중분류코드"/>
                <Cell col="2" class="grd_WF_Essential" text="중분류명"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" edittype="none" style="align:center;" text="bind:mcalssCd"/>
                <Cell col="2" displaytype="text" edittype="text" style="align: ;" text="bind:mcalssNm"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static20" text="검체유형 소분류" class="sta_WF_Title01" position="absolute 830 84 1053 102" anchor="left top"/>
        <Static id="Static21" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 830 71 1160 84" anchor="left top"/>
        <Static id="Static27" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 830 97 1160 102" anchor="left top"/>
        <Static id="Static29" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 1149 97 1233 102" anchor="top right"/>
        <Static id="Static30" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1149 71 1233 77" anchor="top right"/>
        <Button id="btn_addSclass" taborder="11" class="btn_WF_GrdPlus" position="absolute 1179 77 1197 97" anchor="top right" tooltiptext="추가" onclick="btn_addSclass_onclick"/>
        <Button id="btn_delSclass" taborder="12" class="btn_WF_GrdMinus" position="absolute 1199 77 1217 97" anchor="top right" tooltiptext="삭제" onclick="btn_delSclass_onclick"/>
        <Static id="Static31" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1197 77 1199 97" anchor="top right"/>
        <Static id="Static32" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1217 77 1219 97" anchor="top right"/>
        <Static id="Static33" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1177 77 1179 97" anchor="top right"/>
        <Static id="sta_sclassCnt" text="총건수 : 0건" position="absolute 971 85 1102 99"/>
        <Button id="btn_saveSclass" taborder="13" class="btn_WF_GrdSave" position="absolute 1219 77 1237 97" anchor="top right" tooltiptext="저장" onclick="btn_saveSclass_onclick"/>
        <Grid id="grd_sclassList" taborder="10" binddataset="ds_sclassList" useinputpanel="false" selecttype="row" cellsizingtype="col" autofittype="col" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" position="absolute 826 102 1237 398" anchor="left top right" autoenter="select" onheadclick="grd_sclassList_onheadclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="44"/>
                <Column size="90"/>
                <Column size="161"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" edittype="text" class="grd_WF_Essential" text="소분류코드"/>
                <Cell col="2" class="grd_WF_Essential" text="소분류명"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" edittype="none" style="align:center;" text="bind:sclassCd"/>
                <Cell col="2" displaytype="text" edittype="text" style="align: ;" text="bind:sclassNm"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static34" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 392 71 402 375"/>
        <Static id="Static35" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 816 71 826 375"/>
        <Grid id="grd_specmTypeArticleList" taborder="15" binddataset="ds_specmTypeArticleList" useinputpanel="false" selecttype="row" cellsizingtype="col" autofittype="col" nodataimage="URL('theme://images/grd_WF_NoDataImg.png')" position="absolute 0 483 1237 710" anchor="all" tabstop="false" onheadclick="grd_specmTypeArticleList_onheadclick">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="44"/>
                <Column size="134"/>
                <Column size="161"/>
                <Column size="128"/>
                <Column size="229"/>
                <Column size="121"/>
                <Column size="196"/>
              </Columns>
              <Rows>
                <Row size="26" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell class="head_Excel"/>
                <Cell col="1" edittype="text" class="grd_WF_Essential" text="대분류코드"/>
                <Cell col="2" class="grd_WF_Essential" text="대분류명"/>
                <Cell col="3" class="grd_WF_Essential" text="중분류코드"/>
                <Cell col="4" class="grd_WF_Essential" text="중분류명"/>
                <Cell col="5" class="grd_WF_Essential" text="소분류코드"/>
                <Cell col="6" class="grd_WF_Essential" text="소분류명"/>
              </Band>
              <Band id="body">
                <Cell text="expr:currow+1"/>
                <Cell col="1" edittype="none" style="align:center;" text="bind:mgrpCd"/>
                <Cell col="2" displaytype="text" edittype="none" style="align:left;" text="bind:mgrpNm"/>
                <Cell col="3" text="bind:mcalssCd"/>
                <Cell col="4" displaytype="text" edittype="none" style="align:left;" text="bind:mcalssNm"/>
                <Cell col="5" text="bind:sclassCd"/>
                <Cell col="6" displaytype="text" edittype="none" style="align:left;" text="bind:sclassNm"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static36" text="공전유형별 전체정보" class="sta_WF_Title01" position="absolute 2 465 144 483" anchor="left top"/>
        <Static id="Static37" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 2 452 124 465" anchor="left top"/>
        <Static id="Static38" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 2 478 540 483" anchor="left top"/>
        <Static id="Static39" text="h05" class="Guide01_AreaRed" visible="false" position="absolute 1153 478 1237 483" anchor="top right"/>
        <Static id="Static40" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 1153 452 1237 458" anchor="top right"/>
        <Button id="btn_excelUpload" taborder="38" text="엑셀업로드" class="btn_WF_Function" position="absolute 1136 458 1217 478" anchor="top right" onclick="btn_excelUpload_onclick" visible="false"/>
        <Static id="sta_specmTypeArticleCnt" text="총건수 : 0건" position="absolute 173 467 304 481"/>
        <Static id="Static41" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1217 459 1219 479" anchor="top right"/>
        <Button id="btn_saveSpecm" taborder="39" class="btn_WF_GrdSave" position="absolute 1219 458 1237 478" anchor="top right" tooltiptext="저장" onclick="btn_saveSpecm_onclick" visible="false"/>
        <Button id="btn_delAll" taborder="40" text="전체삭제" class="btn_WF_Function" position="absolute 1069 458 1134 478" anchor="top right" onclick="btn_delAll_onclick" visible="false"/>
        <Static id="Static42" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 1134 459 1136 479" anchor="top right"/>
        <Static id="Static45" class="sta_WFSA_Labelbg01" position="absolute 0 411 1237 452" anchor="left top right"/>
        <Static id="Static46" text="중분류" class="sta_WFSA_label01" position="absolute 15 421 77 442" anchor="left top"/>
        <Static id="Static47" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 0 398 450 411" anchor="left top"/>
        <Static id="Static43" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 60 421 70 442" anchor="left top"/>
        <Edit id="edt_sclassSearch" taborder="14" imemode="hangul" position="absolute 70 421 230 442" anchor="left top" onkeydown="edt_sclassSearch_onkeydown" tabstop="false"/>
        <Static id="Static44" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 230 421 240 442" anchor="left top"/>
        <Button id="btn_search" taborder="41" text="조회" onclick="btn_search_onclick" class="btn_WF_Function" position="absolute 240 421 305 441" anchor="left top"/>
        <Static id="Static48" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 419 15 440" anchor="left top"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item0" compid="edt_search" propid="value" datasetid="ds_search" columnid="edtSearch"/>
      <BindItem id="item1" compid="cbo_specmTypeCd" propid="value" datasetid="ds_search" columnid="specmType"/>
      <BindItem id="item2" compid="edt_sclassSearch" propid="value" datasetid="ds_search" columnid="mcalssNm"/>
    </Bind>
    <Objects>
      <Dataset id="ds_mgrpList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="specmType" type="STRING" size="255"/>
          <Column id="mgrpCd" type="STRING" size="255"/>
          <Column id="mgrpNm" type="STRING" size="255"/>
          <Column id="cuser" type="STRING" size="255"/>
          <Column id="cdate" type="STRING" size="255"/>
          <Column id="uuser" type="STRING" size="255"/>
          <Column id="udate" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cboSpecmTypeCd" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="codeName" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_mcalssList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="specmType" type="STRING" size="255"/>
          <Column id="mgrpCd" type="STRING" size="255"/>
          <Column id="mcalssCd" type="STRING" size="255"/>
          <Column id="mcalssNm" type="STRING" size="255"/>
          <Column id="cuser" type="STRING" size="255"/>
          <Column id="cdate" type="STRING" size="255"/>
          <Column id="uuser" type="STRING" size="255"/>
          <Column id="udate" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sclassList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="specmType" type="STRING" size="255"/>
          <Column id="mgrpCd" type="STRING" size="255"/>
          <Column id="mcalssCd" type="STRING" size="255"/>
          <Column id="sclassCd" type="STRING" size="255"/>
          <Column id="sclassNm" type="STRING" size="255"/>
          <Column id="cuser" type="STRING" size="255"/>
          <Column id="cdate" type="STRING" size="255"/>
          <Column id="uuser" type="STRING" size="255"/>
          <Column id="udate" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmnAuth" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="srcYn" type="STRING" size="256"/>
          <Column id="insYn" type="STRING" size="256"/>
          <Column id="delYn" type="STRING" size="256"/>
          <Column id="savYn" type="STRING" size="256"/>
          <Column id="prtYn" type="STRING" size="256"/>
          <Column id="exlYn" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="srcYn">Y</Col>
            <Col id="insYn">N</Col>
            <Col id="delYn">N</Col>
            <Col id="savYn">N</Col>
            <Col id="prtYn">N</Col>
            <Col id="exlYn">N</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="specmType" type="STRING" size="256"/>
          <Column id="mgrpCd" type="STRING" size="256"/>
          <Column id="mcalssCd" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="256"/>
          <Column id="edtSearch" type="STRING" size="256"/>
          <Column id="mcalssNm" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_mgrpListValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="specmType" type="STRING" size="255"/>
          <Column id="mgrpNm" type="STRING" size="255"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="specmType">title:공전유형,required:true</Col>
            <Col id="mgrpNm">title:대분류명,required:truetitle:기준규격,required:true,maxlengthB:100</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_mcalssListValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="specmType" type="STRING" size="255"/>
          <Column id="mcalssNm" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="specmType">title:공전유형,required:true</Col>
            <Col id="mcalssNm">title:중분류명,required:true,maxlengthB:100</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_sclassListValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_groupList_oncolumnchanged">
        <ColumnInfo>
          <Column id="specmType" type="STRING" size="255"/>
          <Column id="sclassNm" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="specmType">title:공전유형,required:true</Col>
            <Col id="sclassNm">title:소분류명,required:true,maxlengthB:200</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_specmTypeArticleList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="specmType" type="STRING" size="255"/>
          <Column id="mgrpCd" type="STRING" size="255"/>
          <Column id="mgrpNm" type="STRING" size="256"/>
          <Column id="mcalssCd" type="STRING" size="255"/>
          <Column id="mcalssNm" type="STRING" size="256"/>
          <Column id="sclassCd" type="STRING" size="255"/>
          <Column id="sclassNm" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_specmTypeArticleListValid" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="mgrpNm" type="STRING" size="256"/>
          <Column id="mcalssNm" type="STRING" size="256"/>
          <Column id="sclassNm" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="sclassNm">title:소분류명,required:true</Col>
            <Col id="mcalssNm">title:중분류명,required:true</Col>
            <Col id="mgrpNm">title:대분류명,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : SpecmTypeArticleMgmt
  파 일 명 : SpecmTypeArticleMgmt.xfdl
  기    능 : 검체유형항목관리

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.03.03   jshoon   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "lib::LimsUtil.xjs";

/****************************************************************************************
 * FORM 변수 선언 영역
 ****************************************************************************************/
var fv_iProcessCnt = 0;  	// 저장건수를 저장한다.(Controller Class에서만 할당함.)

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{
    // Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
    gfn_formOnLoad(this, false);
    // 소분류 엔터키 제어를 위해 공통함수를 이용하여 수정 사용
    this.onkeydown.addHandler(fn_formKeyDown);

    // 초기값 셋팅
    fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
    // 화면의 Combo 처리
    SCCombo.bind(this, "ComCode", "ds_cboSpecmTypeCd", ds_cboSpecmTypeCd, {groupCode:"SPECM_TYPE", useYn:"Y"}, "fn_setComboSpecmTypeCallback");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 공전유형코드 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_setComboSpecmTypeCallback()
{
    cbo_specmTypeCd.index = 0;
    ds_search.setColumn(0, "specmType", cbo_specmTypeCd.value);
}

/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
    fn_doMgrpSearch();	// 대분류코드 조회
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
    // 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
    if (nErrorCode < 0)
    {
        return;
    }

    switch(strSvcID)
    {
        // 전체 조회
        case "selectList" :
            sta_specmTypeArticleCnt.text = "총건수 : " + gfn_numFormat(ds_specmTypeArticleList.rowcount) + "건";
            break;
        // 대분류 조회
        case "selectMgrpList" :
            sta_mgrpCnt.text = "총건수 : " + gfn_numFormat(ds_mgrpList.rowcount) + "건";
            sta_mcalssCnt.text = "총건수 : 0건";
            sta_sclassCnt.text = "총건수 : 0건";
            break;
        // 중분류 조회
        case "selectMcalssList" :
            sta_mcalssCnt.text = "총건수 : " + gfn_numFormat(ds_mcalssList.rowcount) + "건";
            sta_sclassCnt.text = "총건수 : 0건";
            break;
        // 소분류 조회
        case "selectSclassList" :
            sta_sclassCnt.text = "총건수 : " + gfn_numFormat(ds_sclassList.rowcount) + "건";
            break;
        // 전체 저장
        case "saveList" :
            if (fv_iProcessCnt > 0) gfn_alert("msg.save.success");	// 저장 되었습니다.
            fn_doMgrpSearch();
            break;
        // 전체 삭제 저장
        case "saveDelAllList" :
            if (fv_iProcessCnt > 0) gfn_alert("msg.save.success");	// 저장 되었습니다.
            fn_doMgrpSearch();
            break;
        // 대분류 저장
        case "saveMgrpList" :
            if (fv_iProcessCnt > 0) gfn_alert("msg.save.success");	// 저장 되었습니다.
            fn_doMgrpSearch();
            break;
        // 중분류 저장
        case "saveMcalssList" :
            if (fv_iProcessCnt > 0) gfn_alert("msg.save.success");	// 저장 되었습니다.
            fn_doMcalssSearch();
            break;
        // 소분류 저장
        case "saveSclassList" :
            if (fv_iProcessCnt > 0) gfn_alert("msg.save.success");	// 저장 되었습니다.
            fn_doSclassSearch();
            break;
    }

    // 전체 조회
    if (strSvcID == "selectMgrpList" ||
        strSvcID == "saveList" ||
        strSvcID == "saveMgrpList" ||
        strSvcID == "saveMcalssList" ||
        strSvcID == "saveSclassList")
    {
        fn_doSearch();
    }
}

/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 대분류 조회 처리
 *---------------------------------------------------------------------------------------------*/
function fn_doSearch()
{
    // v_ds_check 미사용시 변경사항 체크
    if (gfn_dsIsUpdated(ds_specmTypeArticleList))
    {
       // 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
        var retValue = gfn_confirm("confirm.before.search");
        if (retValue == false) return;
    }

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_specmTypeArticleList);

    //코드목록을 초기화한다.
    ds_specmTypeArticleList.clearData();
    
    ds_search.setColumn(0, "mgrpCd", "");
    ds_search.setColumn(0, "mcalssCd", "");
    ds_search.setColumn(0, "sclassCd", "");

    var strSvcID    = "selectList";
    var strURL      = "ls/lcm/specmTypeArticleMgmt/selectList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_specmTypeArticleList=ds_specmTypeArticleList";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 공전유형 변경 시 대분류 코드 조회
 *---------------------------------------------------------------------------------------------*/
function cbo_specmTypeCd_onitemchanged(obj:Combo, e:ItemChangeEventInfo)
{
    fn_doMgrpSearch();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 대분류 조회 처리
 *---------------------------------------------------------------------------------------------*/
function fn_doMgrpSearch()
{
    // v_ds_check 미사용시 변경사항 체크
    if (gfn_dsIsUpdated(ds_mgrpList) || gfn_dsIsUpdated(ds_mcalssList) || gfn_dsIsUpdated(ds_sclassList))
    {
       // 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
        var retValue = gfn_confirm("confirm.before.search");
        if (retValue == false) return;
    }

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_mgrpList);
    gfn_clearSortMark(grd_mcalssList);
    gfn_clearSortMark(grd_sclassList);

    //코드목록을 초기화한다.
    ds_mgrpList.clearData();
    ds_mcalssList.clearData();
    ds_sclassList.clearData();

    var strSvcID    = "selectMgrpList";
    var strURL      = "ls/lcm/specmTypeArticleMgmt/selectMgrpList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_mgrpList=ds_mgrpList";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 중분류 조회 처리
 *---------------------------------------------------------------------------------------------*/
function fn_doMcalssSearch()
{
    // v_ds_check 미사용시 변경사항 체크
    if (gfn_dsIsUpdated(ds_mgrpList) || gfn_dsIsUpdated(ds_mcalssList) || gfn_dsIsUpdated(ds_sclassList))
    {
       // 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
        var retValue = gfn_confirm("confirm.before.search");
        if (retValue == false) return;
    }

    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_mcalssList);
    gfn_clearSortMark(grd_sclassList);

    //코드목록을 초기화한다.
    ds_mcalssList.clearData();
    ds_sclassList.clearData();

    ds_search.setColumn(0, "mgrpCd", ds_mgrpList.getColumn(ds_mgrpList.rowposition, "mgrpCd"));

    var strSvcID    = "selectMcalssList";
    var strURL      = "ls/lcm/specmTypeArticleMgmt/selectMcalssList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_mcalssList=ds_mcalssList";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 소분류 조회 처리
 *---------------------------------------------------------------------------------------------*/
function fn_doSclassSearch()
{
    // v_ds_check 미사용시 변경사항 체크
     if (gfn_dsIsUpdated(ds_mgrpList) || gfn_dsIsUpdated(ds_mcalssList) || gfn_dsIsUpdated(ds_sclassList))
     {
        // 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
         var retValue = gfn_confirm("confirm.before.search");
         if (retValue == false) return;
     }

     // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(grd_sclassList);

    //코드목록을 초기화한다.
     ds_sclassList.clearData();

     ds_search.setColumn(0, "mgrpCd", ds_mgrpList.getColumn(ds_mgrpList.rowposition, "mgrpCd"));
     ds_search.setColumn(0, "mcalssCd", ds_mcalssList.getColumn(ds_mcalssList.rowposition, "mcalssCd"));

    var strSvcID    = "selectSclassList";
    var strURL      = "ls/lcm/specmTypeArticleMgmt/selectSclassList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_sclassList=ds_sclassList";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 대분류 추가 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_addMgrp_onclick(obj:Button,  e:ClickEventInfo)
{
    if (!fn_dsUpdateCheck("mgrp"))
    {
        return;
    }
    var nRow = ds_mgrpList.addRow();
    ds_mgrpList.setColumn(nRow, "specmType", ds_search.getColumn(0, "specmType"));
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 대분류 삭제 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_delMgrp_onclick(obj:Button,  e:ClickEventInfo)
{
    if (!fn_dsUpdateCheck("mgrp"))
    {
        return;
    }
    ds_mgrpList.deleteRow(ds_mgrpList.rowposition);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 대분류 저장 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_saveMgrp_onclick(obj:Button,  e:ClickEventInfo)
{
    if (!fn_dsUpdateCheck("mgrp"))
    {
        return;
    }
    if (!gfn_dsIsUpdated(ds_mgrpList))
    {
        gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
        return;
    }

    if (gfn_validCheck(ds_mgrpList, ds_mgrpListValid) == false)	return;
    
    // 자료를 저장 하시겠습니까?
	if (!gfn_confirm("confirm.before.save")) return false;

    var strSvcID    = "saveMgrpList";
    var strURL      = "ls/lcm/specmTypeArticleMgmt/saveMgrpList.xdo";
    var strInDs     = "ds_search=ds_search:A ds_mgrpList=ds_mgrpList:U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 중분류 추가 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_addMcalss_onclick(obj:Button,  e:ClickEventInfo)
{
    if (!fn_dsUpdateCheck("mcalss"))
    {
        return;
    }

    var nRow = ds_mcalssList.addRow();
    ds_mcalssList.setColumn(nRow, "mgrpCd", ds_mgrpList.getColumn(ds_mgrpList.rowposition, "mgrpCd"));
    ds_mcalssList.setColumn(nRow, "specmType", ds_search.getColumn(0, "specmType"));
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 중분류 삭제 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_delMcalss_onclick(obj:Button,  e:ClickEventInfo)
{
    if (!fn_dsUpdateCheck("mcalss"))
    {
        return;
    }

    ds_mcalssList.deleteRow(ds_mcalssList.rowposition);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 중분류 저장 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_saveMcalss_onclick(obj:Button,  e:ClickEventInfo)
{
    if (!fn_dsUpdateCheck("mcalss"))
    {
        return;
    }
    if (!gfn_dsIsUpdated(ds_mcalssList))
    {
        gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
        return;
    }

    if (gfn_validCheck(ds_mcalssList, ds_mcalssListValid) == false)	return;
    
    // 자료를 저장 하시겠습니까?
	if (!gfn_confirm("confirm.before.save")) return false;

    var strSvcID    = "saveMcalssList";
    var strURL      = "ls/lcm/specmTypeArticleMgmt/saveMcalssList.xdo";
    var strInDs     = "ds_search=ds_search:A ds_mcalssList=ds_mcalssList:U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 소분류 추가 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_addSclass_onclick(obj:Button,  e:ClickEventInfo)
{
    if (!fn_dsUpdateCheck("sclass"))
    {
        return;
    }

    var nRow = ds_sclassList.addRow();
    ds_sclassList.setColumn(nRow, "mgrpCd", ds_mgrpList.getColumn(ds_mgrpList.rowposition, "mgrpCd"));
    ds_sclassList.setColumn(nRow, "mcalssCd", ds_mcalssList.getColumn(ds_mcalssList.rowposition, "mcalssCd"));
    ds_sclassList.setColumn(nRow, "specmType", ds_search.getColumn(0, "specmType"));
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 소분류 삭제 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_delSclass_onclick(obj:Button,  e:ClickEventInfo)
{
    if (!fn_dsUpdateCheck("sclass"))
    {
        return;
    }

    ds_sclassList.deleteRow(ds_sclassList.rowposition);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 소분류 저장 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_saveSclass_onclick(obj:Button,  e:ClickEventInfo)
{
    if (!fn_dsUpdateCheck("sclass"))
    {
        return;
    }
    if (!gfn_dsIsUpdated(ds_sclassList))
    {
        gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
        return;
    }

    if (gfn_validCheck(ds_sclassList, ds_sclassListValid) == false)	return;
    
    // 자료를 저장 하시겠습니까?
	if (!gfn_confirm("confirm.before.save")) return false;

    var strSvcID    = "saveSclassList";
    var strURL      = "ls/lcm/specmTypeArticleMgmt/saveSclassList.xdo";
    var strInDs     = "ds_search=ds_search:A ds_sclassList=ds_sclassList:U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 대분류 코드 더블 클릭
 *---------------------------------------------------------------------------------------------*/
function grd_mgrpList_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
    fn_doMcalssSearch();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 중분류 코드 더블 클릭
 *---------------------------------------------------------------------------------------------*/
function grd_mcalssList_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
    fn_doSclassSearch();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조회조건 엔터 클릭
 *---------------------------------------------------------------------------------------------*/
function edt_search_onkeydown(obj:Edit, e:KeyEventInfo)
{
    if (e.keycode == 13)
    {
        fn_doMgrpSearch();
    }
}

/*----------------------------------------------------------------------------------------------
 * 설명      : DataSet Update 체크
 *---------------------------------------------------------------------------------------------*/
function fn_dsUpdateCheck(sGubun)
{
    if (sGubun == "mgrp")
    {
        if (gfn_dsIsUpdated(ds_mcalssList))
        {
            gfn_alert("중분류 코드를 저장하여 주십시오.");
            return false;
        }
        if (gfn_dsIsUpdated(ds_sclassList))
        {
            gfn_alert("소분류 코드를 저장하여 주십시오.");
            return false;
        }
    }
    else if (sGubun == "mcalss")
    {
        if (gfn_dsIsUpdated(ds_mgrpList))
        {
            gfn_alert("대분류 코드를 저장하여 주십시오.");
            return false;
        }
        if (gfn_dsIsUpdated(ds_sclassList))
        {
            gfn_alert("소분류 코드를 저장하여 주십시오.");
            return false;
        }
    }
    else if (sGubun == "sclass")
    {
        if (gfn_dsIsUpdated(ds_mgrpList))
        {
            gfn_alert("대분류 코드를 저장하여 주십시오.");
            return false;
        }
        if (gfn_dsIsUpdated(ds_mcalssList))
        {
            gfn_alert("중분류 코드를 저장하여 주십시오.");
            return false;
        }
    }
    return true;
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 엑셀업로드 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_excelUpload_onclick(obj:Button,  e:ClickEventInfo)
{
    this.setWaitCursor(true, true);

    // 파일 선택
    var strFileName = gfn_excelFileDialog("LOAD", "EXCEL");

    if (strFileName.length == 0)
    {
        this.setWaitCursor(false, true);
        return;
    }

    var rtn = gfn_importExcel(strFileName, "ds_specmTypeArticleList", 2, 1);

    sta_specmTypeArticleCnt.text = "총건수 : " + gfn_numFormat(ds_specmTypeArticleList.rowcount) + "건";

    this.setWaitCursor(false, true);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 엑셀업로드 저장 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_saveSpecm_onclick(obj:Button,  e:ClickEventInfo)
{
    var sMsg = "중복 등록에 주의하시기 바랍니다.\n로드된 엑셀데이터를 저장 하시겠습니까?";
    if (!gfn_confirm(sMsg, "", "C")) return;

    // 엑셀 업로드는 상태가 Normal이라서 임의로 변경 한다.
    ds_specmTypeArticleList.updatecontrol = false;
    for (var i = 0; i < ds_specmTypeArticleList.rowcount; i++)
    {
        ds_specmTypeArticleList.setRowType(i, Dataset.ROWTYPE_INSERT);
    }
    ds_specmTypeArticleList.updatecontrol = true;

    if (!gfn_dsIsUpdated(ds_specmTypeArticleList))
    {
        gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
        return;
    }

    if (gfn_validCheck(ds_specmTypeArticleList, ds_specmTypeArticleListValid) == false)	return;

    var strSvcID    = "saveList";
    var strURL      = "ls/lcm/specmTypeArticleMgmt/saveList.xdo";
    var strInDs     = "ds_search=ds_search:A ds_specmTypeArticleList=ds_specmTypeArticleList:U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    //trace(ds_specmTypeArticleList.saveXML("ds_specmTypeArticleList", "A"));

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 전체삭제 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_delAll_onclick(obj:Button,  e:ClickEventInfo)
{
    var sMsg = "검체유형항목 전체를 삭제 하시겠습니까?";
    if (!gfn_confirm(sMsg, "", "C")) return;

    var strSvcID    = "saveDelAllList";
    var strURL      = "ls/lcm/specmTypeArticleMgmt/saveDelAllList.xdo";
    var strInDs     = "ds_search=ds_search:A ds_specmTypeArticleList=ds_specmTypeArticleList:U";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 소분류 입력 시 해당 내용으로 포커스 이동
 *---------------------------------------------------------------------------------------------*/
function edt_sclassSearch_ontextchanged(obj:Edit, e:TextChangedEventInfo)
{
    LimsUtil.setFindDataPosition(ds_specmTypeArticleList, "sclassNm", edt_sclassSearch.text, edt_sclassSearch, 0);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 소분류 Enter 입력 시 해당 내용으로 포커스 이동
 *---------------------------------------------------------------------------------------------*/
function edt_sclassSearch_onkeydown(obj:Edit, e:KeyEventInfo)
{
	if (e.keycode == 13) {
		//LimsUtil.setFindDataPosition(ds_specmTypeArticleList, "sclassNm", edt_sclassSearch.text, edt_sclassSearch);
		//edt_sclassSearch.setFocus();
		fn_doSearch();
	}
}

/**
 * @class form에서 Key Down시 단축키들 지정
 *  소분류 엔터키 제어를 위해 공통함수를 이용하여 수정 사용
 * @param obj - obj
 * @param e - event 객체
 * @return 없음
 */
function fn_formKeyDown(obj, e)
{
    var obj = getFocus();
    var componentType = gfn_getObjType(obj);
    var strCssclass = obj.class;					// CSS Class

    var objNextComponent = getNextComponent(obj);
    var nextComponentType = gfn_getObjType(objNextComponent);

    if (componentType == "Grid")
    {
        // Ctrl + P	: Grid 인쇄
        if (e.ctrlKey == true && e.keycode == 80)
        {
            application.alert("준비중입니다.");
        }
        // Ctrl + C	: Cell clipboard 복사
        else if (e.ctrlKey == true && e.keycode == 67)
        {
            var v_clip = obj.getCellText(obj.currentrow, obj.currentcol);
            system.clearClipboard();
            system.setClipboard("CF_TEXT",v_clip);
        }
        // Ctrl + L	: Line clipboard 복사
        else if (e.ctrlKey == true && e.keycode == 76) {
            var v_clip = "";
            for ( var i = 0; i < obj.getCellCount("Body"); i++ )
            {
                v_clip += ", " + obj.getCellText(obj.currentrow, i);
            }
            system.clearClipboard();
            system.setClipboard("CF_TEXT",gfn_subStr(v_clip,2));
        }
        // Ctrl + A	: 전체 clipboard 복사
        else if (e.ctrlKey == true && e.keycode == 65) {
            system.clearClipboard();
            system.setClipboard("CF_TEXT",obj.getCsvData(false));
        }
        // Ctrl + V	: Paste
        else if (e.ctrlKey == true && e.keycode == 86) {
            gfn_gridPaste(obj, e);
        }
        // Ctrl + E	: 엑셀 다운로드
        else if (e.ctrlKey == true && e.keycode == 69) {
            gfn_exportExcel(obj);
        }
        // Ctrl + M	: Multi Sort
        else if (e.ctrlKey == true && e.keycode == 77) {
            gfn_gridMultiSort(obj);
        }
        // Ctrl + F	: Find
        else if (e.ctrlKey == true && e.keycode == 70) {
            gfn_gridFind(this, obj);
        }
        // Ctrl + T	: Filter
        else if (e.ctrlKey == true && e.keycode == 84) {
            gfn_gridFilter(this, obj);
        }
        // Enter 키
        else if (e.keycode == 13) {
            var bSuccess = obj.moveToNextCell();	// 수정이 가능한 다음 셀로 이동
            if (!bSuccess) objNextComponent.setFocus();	// 수정이 가능한 다음 셀 없을때 Next Comp로 이동
        }
    }

    // Enter 키
    if (e.keycode == 13 && componentType != "Grid")
    {
        // 현재 Component 기준
        if (componentType == "TextArea")
        {
            return;
        }
        else if (componentType == "Tab") {
            var objTemp = obj.components[tabindex];
            objTemp.setFocus();
        }
        // Next Component 기준
        else if (nextComponentType == "Tab") {		// Tab은 필요할지 확인 필요
            var objTemp = objNextComponent.components[objNextComponent.tabindex];
            objTemp.setFocus();
        }
        else if (nextComponentType == "Combo") {
            objNextComponent.setFocus();
            objNextComponent.dropdown();
        }
        else {
			//objNextComponent.setFocus();	// 본 화면에서 소분류 엔터키 제어를 위해 주석처리 한다.
        }
    }

    // 팝업에서 ESC 키 시 창닫기
    var objOpener = opener;
    if (e.keycode == 27 && gfn_isNull(objOpener) == false)
    {
        this.close();
    }
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 대분류 그리드 헤더 클릭
 *---------------------------------------------------------------------------------------------*/
function grd_mgrpList_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	if (obj.readonly == true) return;
    gfn_gridSort(obj, e);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 중분류 그리드 헤더 클릭
 *---------------------------------------------------------------------------------------------*/
function grd_mcalssList_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	if (obj.readonly == true) return;
    gfn_gridSort(obj, e);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 소분류 그리드 헤더 클릭
 *---------------------------------------------------------------------------------------------*/
function grd_sclassList_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	if (obj.readonly == true) return;
    gfn_gridSort(obj, e);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 전체정보 그리드 헤더 클릭
 *---------------------------------------------------------------------------------------------*/
function grd_specmTypeArticleList_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	if (obj.readonly == true) return;
    gfn_gridSort(obj, e);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 중분류 조회 버튼 클릭
 *---------------------------------------------------------------------------------------------*/
function btn_search_onclick(obj:Button,  e:ClickEventInfo)
{
	fn_doSearch();
}
]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="DmtPoOrderDtl" classname="COMP_GUIDE_13" inheritanceid="" position="absolute 0 0 1252 859" titletext="구매주문 작성 (내수)" scrollbars="autoboth" onload="form_onload" onclose="DmtPoOrderDtl_onclose">
    <Layouts>
      <Layout>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 1237 0 1252 710" anchor="top right"/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 844 1252 859" anchor="left bottom"/>
        <Static id="Static31" class="sta_WFDA_Labelbg" position="absolute 16 56 1237 83" anchor="left top"/>
        <Static id="Static67" class="sta_WFDA_Labelbg" position="absolute 16 82 1237 109" anchor="left top"/>
        <Static id="Static60" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 213 450 228" anchor="left top"/>
        <Static id="Static27" text="제목" class="sta_WFDA_Label01" position="absolute 50 56 144 83" anchor="left top"/>
        <Static id="Static03" text="기안자" class="sta_WFDA_Label01" position="absolute 355 82 449 109" anchor="left top"/>
        <Tab id="Tab00" taborder="25" tabindex="0" scrollbars="autoboth" position="absolute 15 228 1237 845" style="showextrabutton:false;" anchor="left top right">
          <Tabpages>
            <Tabpage id="tabpage1" text="품목">
              <Layouts>
                <Layout>
                  <Grid id="grd_itemList" taborder="3" binddataset="ds_itemList" autoenter="select" useinputpanel="false" cellsizingtype="col" position="absolute 10 31 1210 579" anchor="all" autofittype="none" onexpandup="grd_itemList_onexpandup">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="37"/>
                          <Column size="115"/>
                          <Column size="210"/>
                          <Column size="68"/>
                          <Column size="77"/>
                          <Column size="87"/>
                          <Column size="88"/>
                          <Column size="65"/>
                          <Column size="71"/>
                          <Column size="85"/>
                          <Column size="81"/>
                          <Column size="123"/>
                          <Column size="131"/>
                          <Column size="137"/>
                          <Column size="146"/>
                          <Column size="71"/>
                          <Column size="84"/>
                          <Column size="95"/>
                          <Column size="96"/>
                          <Column size="90"/>
                          <Column size="87"/>
                          <Column size="276"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" class="grd_WF_Essential" text="품목코드"/>
                          <Cell col="2" text="품목명"/>
                          <Cell col="3" class="grd_WF_Essential" text="단위"/>
                          <Cell col="4" class="grd_WF_Essential" text="수량"/>
                          <Cell col="5" text="단가"/>
                          <Cell col="6" class="grd_WF_Essential" text="원물금액"/>
                          <Cell col="7" class="grd_WF_Essential" text="중량"/>
                          <Cell col="8" class="grd_WF_Essential" text="과세여부"/>
                          <Cell col="9" text="최초입고일"/>
                          <Cell col="10" text="실입고일"/>
                          <Cell col="11" class="grd_WF_Essential1" text="B/L번호"/>
                          <Cell col="12" text="수입유통식별번호"/>
                          <Cell col="13" class="grd_WF_Essential1" taborder="undefined">
                            <Cell text="원산지"/>
                          </Cell>
                          <Cell col="14" taborder="undefined">
                            <Cell text="창고명"/>
                          </Cell>
                          <Cell col="15" text="보관료"/>
                          <Cell col="16" text="입출고비"/>
                          <Cell col="17" text="작성자"/>
                          <Cell col="18" text="작성일자"/>
                          <Cell col="19" text="수정자"/>
                          <Cell col="20" text="수정일자"/>
                          <Cell col="21" text="비고"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="currow+1"/>
                          <Cell col="1" displaytype="text" edittype="expand" text="bind:itemCd" expandshow="show" expandsize="21"/>
                          <Cell col="2" displaytype="normal" edittype="none" style="align:left;" text="bind:itemNm"/>
                          <Cell col="3" displaytype="combo" edittype="combo" text="bind:unit"/>
                          <Cell col="4" displaytype="number" edittype="masknumber" text="bind:quantity" mask="#,##0.##"/>
                          <Cell col="5" displaytype="number" edittype="masknumber" class="grd_WF_Essential" text="bind:uprice" mask="#,##0.##"/>
                          <Cell col="6" displaytype="number" edittype="masknumber" text="bind:wonwtrAmt" mask="#,##0"/>
                          <Cell col="7" displaytype="number" edittype="masknumber" text="bind:wgt" mask="#,##0.00"/>
                          <Cell col="8" displaytype="combo" edittype="combo" text="bind:taxYn"/>
                          <Cell col="9" displaytype="date" edittype="date" text="bind:firstDeliverDate" calendardisplaynulltype="none"/>
                          <Cell col="10" displaytype="date" edittype="date" text="bind:currentWhDeliverDate" calendardisplaynulltype="none"/>
                          <Cell col="11" displaytype="text" edittype="text" text="bind:itemBlNum"/>
                          <Cell col="12" displaytype="text" edittype="text" text="bind:incomeDtrDsctNum"/>
                          <Cell col="13" displaytype="text" edittype="text" text="bind:originNm" expandshow="show" expandsize="21"/>
                          <Cell col="14" displaytype="text" edittype="expand" text="bind:whNm" expandshow="show" expandsize="21"/>
                          <Cell col="15" displaytype="number" edittype="masknumber" text="bind:chargCost" mask="#,##0.00"/>
                          <Cell col="16" displaytype="number" edittype="masknumber" text="bind:ioutCost" mask="#,##0.00"/>
                          <Cell col="17" text="bind:cuser"/>
                          <Cell col="18" displaytype="date" text="bind:cdate" calendardisplaynulltype="none"/>
                          <Cell col="19" text="bind:uuser"/>
                          <Cell col="20" displaytype="date" text="bind:udate" calendardisplaynulltype="none"/>
                          <Cell col="21" displaytype="text" edittype="text" text="bind:remark"/>
                        </Band>
                        <Band id="summary">
                          <Cell/>
                          <Cell col="1"/>
                          <Cell col="2"/>
                          <Cell col="3"/>
                          <Cell col="4" displaytype="number" edittype="masknumber" text="expr:getSum('quantity')" mask="#,##0.##"/>
                          <Cell col="5" displaytype="number" edittype="masknumber" text="expr:Math.round(getAvg('uprice'), 0)" mask="#,##0.00"/>
                          <Cell col="6" displaytype="number" edittype="masknumber" text="expr:getSum('wonwtrAmt')" mask="#,##0.00"/>
                          <Cell col="7" displaytype="number" edittype="masknumber" text="expr:getSum('wgt')" mask="#,##0.00"/>
                          <Cell col="8"/>
                          <Cell col="9"/>
                          <Cell col="10"/>
                          <Cell col="11"/>
                          <Cell col="12"/>
                          <Cell col="13"/>
                          <Cell col="14"/>
                          <Cell col="15"/>
                          <Cell col="16"/>
                          <Cell col="17"/>
                          <Cell col="18"/>
                          <Cell col="19"/>
                          <Cell col="20"/>
                          <Cell col="21"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 10 0 460 13" anchor="left top"/>
                  <Static id="Static22" text="Item 정보" class="sta_WF_Title01" position="absolute 10 13 460 31" anchor="left top"/>
                  <Static id="Static16" text="글자기준간격 h05" class="Guide01_AreaRed" visible="false" position="absolute 10 26 460 31" anchor="left top"/>
                  <Button id="btn_deliver" taborder="4" text="입고" class="btn_WF_Function" position="absolute 977 7 1072 27" anchor="top right" onclick="btn_deliver_onclick"/>
                  <Button id="btn_deliverCancel" taborder="5" text="입고 취소" class="btn_WF_Function" position="absolute 1074 7 1169 27" anchor="top right" onclick="btn_deliverCancel_onclick"/>
                  <Button id="Button00" taborder="6" onclick="fn_addRow1" class="btn_WF_GrdPlus" position="absolute 1172 7 1190 27" anchor="top right"/>
                  <Button id="Button01" taborder="7" onclick="fn_deleteRow1" class="btn_WF_GrdMinus" position="absolute 1192 7 1210 27" anchor="top right"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage3" text="지불조건">
              <Layouts>
                <Layout>
                  <Grid id="grd_payList" taborder="0" binddataset="ds_payList" autoenter="select" useinputpanel="false" cellsizingtype="col" autofittype="col" position="absolute 10 31 1210 579" anchor="all">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="40"/>
                          <Column size="198"/>
                          <Column size="176"/>
                          <Column size="77"/>
                          <Column size="84"/>
                          <Column size="78"/>
                          <Column size="85"/>
                        </Columns>
                        <Rows>
                          <Row size="24" band="head"/>
                          <Row size="24"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell class="head_Excel"/>
                          <Cell col="1" class="grd_WF_Essential" text="지불조건명"/>
                          <Cell col="2" class="grd_WF_Essential" text="지불금액"/>
                          <Cell col="3" text="작성자"/>
                          <Cell col="4" text="작성일자"/>
                          <Cell col="5" text="수정자"/>
                          <Cell col="6" text="수정일자"/>
                        </Band>
                        <Band id="body">
                          <Cell expr="expr:currow+1"/>
                          <Cell col="1" displaytype="combo" edittype="combo" text="bind:payCondCd"/>
                          <Cell col="2" displaytype="number" edittype="masknumber" text="bind:payAmt" mask="#,##0"/>
                          <Cell col="3" text="bind:cuser"/>
                          <Cell col="4" displaytype="date" text="bind:cdate" calendardisplaynulltype="none"/>
                          <Cell col="5" text="bind:uuser"/>
                          <Cell col="6" displaytype="date" text="bind:udate" calendardisplaynulltype="none"/>
                        </Band>
                        <Band id="summary">
                          <Cell/>
                          <Cell col="1"/>
                          <Cell col="2" displaytype="number" edittype="masknumber" text="expr:getSum('payAmt')" mask="#,##0.00"/>
                          <Cell col="3"/>
                          <Cell col="4"/>
                          <Cell col="5"/>
                          <Cell col="6"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static22" text="Payment Agreement 정보" class="sta_WF_Title01" position="absolute 10 13 460 31" anchor="left top"/>
                  <Static id="Static15" text="h13" class="Guide01_AreaRed" visible="false" position="absolute 10 0 460 13" anchor="left top"/>
                  <Button id="Button02" taborder="1" onclick="fn_addRow2" class="btn_WF_GrdPlus" position="absolute 1172 7 1190 27" anchor="top right"/>
                  <Button id="Button03" taborder="2" onclick="fn_deleteRow2" class="btn_WF_GrdMinus" position="absolute 1192 7 1210 27" anchor="top right"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage2" text="첨부파일">
              <Layouts>
                <Layout>
                  <ObjAtchFile id="ObjAtchFile" anchor="all" titletext="Attach File Object" taborder="0" onclick="ObjAtchFile_onclick" position="absolute 10 -4 1210 579"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Static id="Static63" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1 515 11 830"/>
        <Static id="Static44" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1226 515 1236 830"/>
        <Static id="Static64" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 11 834 1226 844"/>
        <Static id="Static48" text="품의승인일자" class="sta_WFDA_Label01" position="absolute 635 56 729 83" anchor="left top"/>
        <Static id="Static50" text="주문등록일자" class="sta_WFDA_Label01" position="absolute 939 56 1033 83" anchor="left top"/>
        <Static id="Static00" class="sta_WFDA_Labelbg" position="absolute 16 134 636 161" anchor="left top"/>
        <Static id="Static16" class="sta_WFDA_Labelbg" position="absolute 16 108 1237 135" anchor="left top"/>
        <Static id="Static10" text="매출처" class="sta_WFDA_Label01" position="absolute 50 108 144 135" anchor="left top"/>
        <Static id="Static11" text="매입처" class="sta_WFDA_Label01" position="absolute 50 134 144 161" anchor="left top"/>
        <Static id="Static01" text="구매형태" class="sta_WFDA_Label01" position="absolute 50 82 144 109" anchor="left top"/>
        <Static id="Static30" text="판매유형" class="sta_WFDA_Label01" position="absolute 635 108 729 135" anchor="left top"/>
        <Static id="Static59" text="판매종료일자" class="sta_WFDA_Label01" position="absolute 939 82 1033 109" anchor="left top"/>
        <Static id="Static14" class="sta_WFDA_Labelbg" position="absolute 16 160 636 187" anchor="left top"/>
        <Static id="Static25" class="sta_WFDA_Labelbg" position="absolute 16 186 636 213" anchor="left top"/>
        <Static id="Static38" class="sta_WFDA_Labelbg" position="absolute 728 134 1237 213" anchor="left top"/>
        <Static id="Static05" class="sta_WFDA_Label01" position="absolute 635 82 729 109" anchor="left top" text="인수일자"/>
        <Static id="Static37" text="REMARK" class="sta_WFDA_Label01" position="absolute 635 134 729 213" anchor="left top"/>
        <Static id="Static56" text="총수량" class="sta_WFDA_Label01" position="absolute 50 186 144 213" anchor="left top"/>
        <Static id="Static57" text="총중량" class="sta_WFDA_Label01" position="absolute 355 186 449 213" anchor="left top"/>
        <Static id="Static55" text="구매금액" class="sta_WFDA_Label01" position="absolute 355 160 449 187" anchor="left top"/>
        <Static id="Static35" text="귀속부서" class="sta_WFDA_Label01" position="absolute 50 160 144 187" anchor="left top"/>
        <Static id="Static49" class="sta_WFDA_Labelbg" position="absolute 16 30 1237 57" anchor="left top"/>
        <Static id="Static26" text="구매주문번호" class="sta_WFDA_Label01" position="absolute 50 30 144 57" anchor="left top"/>
        <Edit id="edt_poOrderNum" taborder="193" enable="true" position="absolute 146 33 263 54" anchor="left top" readonly="true" style="background:#ecececff;"/>
        <Static id="Static46" text="품의서번호" class="sta_WFDA_Label01" position="absolute 355 30 449 57" anchor="left top"/>
        <Edit id="edt_poProposalNum" taborder="194" enable="true" position="absolute 451 33 568 54" anchor="left top" readonly="true" style="background:#ecececff; :disabled {background:#ecececff;}"/>
        <Button id="btn_callProposal" taborder="195" text="불러오기" onclick="btn_callProposal_onclick" class="btn_WF_Function" position="absolute 570 33 632 53" anchor="top right"/>
        <Static id="Static45" text="상태" class="sta_WFDA_Label01" position="absolute 635 30 729 57" anchor="left top"/>
        <Edit id="edt_poProposalStatusNm" taborder="196" enable="true" position="absolute 731 33 848 54" anchor="left top" style="background:#ecececff; :disabled {background:#ecececff;}" readonly="true"/>
        <Static id="Static04" text="P/O 진행상태" class="sta_WFDA_Label01" position="absolute 939 30 1033 57" anchor="left top"/>
        <Edit id="edt_poProgressStatusNm" taborder="197" enable="true" position="absolute 1035 33 1152 54" anchor="left top" readonly="true" style="background:#ecececff; :disabled {background:#ecececff;}"/>
        <Static id="Static41" text="구매정보" onclick="Static41_onclick" class="sta_WFDA_Label03" position="absolute 15 30 51 213" anchor="left top"/>
        <Edit id="edt_proposalTitle" taborder="198" enable="true" position="absolute 146 59 633 80" anchor="left top" readonly="true" style="background:#ecececff; :disabled {background:#ecececff;}"/>
        <Edit id="edt_drafterNm" taborder="201" enable="true" position="absolute 451 85 568 106" anchor="left top" readonly="true" style="background:#ecececff; :disabled {background:#ecececff;}"/>
        <Combo id="cbo_poType" taborder="202" readonly="true" position="absolute 146 85 296 106" enable="true" style=":disabled {background:#ecececff;}"/>
        <ObjCalendar id="cal_arrivDate" titletext="캘린더" taborder="1" text="ObjCalendar00" scrollbars="none" position="absolute 731 85 867 106"/>
        <ObjCalendar id="cal_saleEdate" titletext="캘린더" taborder="2" text="ObjCalendar00" scrollbars="none" position="absolute 1035 85 1171 106" onclick="cal_saleEdate_onclick"/>
        <Edit id="edt_salsplceNm" taborder="3" onkeydown="edt_gubun_onkeydown" class="edt_WF_Essential" position="absolute 146 111 613 132" style=":disabled {cursor:arrowwait;}" userdata="" enable="false"/>
        <Edit id="edt_splrNm" taborder="6" onkeydown="edt_gubun_onkeydown" class="edt_WF_Essential" position="absolute 146 137 613 158" style=":disabled {cursor:arrowwait;}" userdata="" enable="false"/>
        <Button id="btn_salsplceNm" taborder="4" tabstop="false" class="btn_WF_popSearchEssential" position="absolute 612 111 633 132" onclick="btn_salsplceNm_onclick"/>
        <Button id="btn_splrNm" taborder="7" tabstop="false" class="btn_WF_popSearchEssential" position="absolute 612 137 633 158" onclick="btn_splrNm_onclick"/>
        <Combo id="cbo_saleType" taborder="5" class="cmb_WF_Essential" position="absolute 731 111 867 132" anchor="left top"/>
        <Combo id="cbo_attachDept" taborder="210" readonly="true" position="absolute 146 163 296 184" enable="true" style=":disabled {background:#ecececff;}"/>
        <MaskEdit id="edt_proposalAmt00" taborder="211" mask="#,##0.##" enable="true" position="absolute 451 163 568 184" anchor="left top" style=":disabled {background:#ecececff;align:right middle;}" readonly="true"/>
        <Combo id="cbo_amountUnit" taborder="212" class="cmb_WF_Essential" position="absolute 570 163 633 184" anchor="left top" enable="true" readonly="true" style=":disabled {background:#ecececff;}"/>
        <MaskEdit id="edt_totQuantity" taborder="213" mask="#,##0.##" enable="true" position="absolute 146 189 282 210" anchor="left top" style=":disabled {background:#ecececff;align:right middle;}" readonly="true"/>
        <MaskEdit id="edt_totWgt" taborder="214" mask="#,##0.00" enable="true" position="absolute 451 189 600 210" anchor="left top" style=":disabled {background:#ecececff;align:right middle;}" readonly="true"/>
        <TextArea id="edt_remark" taborder="8" scrollbars="fixedvert" wordwrap="word" position="absolute 731 137 1234 210" anchor="left top"/>
        <ObjCalendar id="cal_poOrderDate" titletext="캘린더" taborder="0" text="ObjCalendar00" scrollbars="none" position="absolute 1035 59 1171 80"/>
        <Button id="btn_search" taborder="217" text="조회" onclick="fn_search" class="btn_WF_searchCm" position2="absolute r:147 w:59 t:3 h:25" positiontype="position2" visible="false"/>
        <Button id="btn_save" taborder="218" text="저장" onclick="fn_save" class="btn_WF_CRUD" position2="absolute r:100 w:45 t:3 h:25" positiontype="position2"/>
        <Button id="btn_delete" taborder="219" text="삭제" onclick="fn_save" class="btn_WF_CRUD" position2="absolute r:53 w:45 t:3 h:25" positiontype="position2"/>
        <Button id="btn_close" taborder="220" text="닫기" onclick="fn_close" class="btn_WF_CRUD" position2="absolute r:6 w:45 t:3 h:25" positiontype="position2"/>
        <Static id="Static02" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 15 710" anchor="top right"/>
        <MaskEdit id="edt_proposalApprvDate" taborder="221" readonly="true" type="string" mask="####-##-##" position="absolute 731 59 848 80" anchor="left top" style="align:center middle; :disabled {align:center middle;}"/>
      </Layout>
    </Layouts>
    <Bind>
      <BindItem id="item1" compid="edt_poOrderNum" propid="value" datasetid="ds_poOrderInfo" columnid="poOrderNum"/>
      <BindItem id="item3" compid="edt_poProposalNum" propid="value" datasetid="ds_poOrderInfo" columnid="poProposalNum"/>
      <BindItem id="item8" compid="edt_poProposalStatusNm" propid="value" datasetid="ds_poOrderInfo" columnid="poOrderStatusNm"/>
      <BindItem id="item9" compid="edt_poProgressStatusNm" propid="value" datasetid="ds_poOrderInfo" columnid="poProgressStatusNm"/>
      <BindItem id="item10" compid="edt_proposalTitle" propid="value" datasetid="ds_poOrderInfo" columnid="proposalTitle"/>
      <BindItem id="item14" compid="edt_drafterNm" propid="value" datasetid="ds_poOrderInfo" columnid="drafterNm"/>
      <BindItem id="item13" compid="cbo_poType" propid="value" datasetid="ds_poOrderInfo" columnid="poType"/>
      <BindItem id="item41" compid="cal_arrivDate" propid="text" datasetid="ds_poOrderInfo" columnid="arrivDate"/>
      <BindItem id="item42" compid="cal_arrivDate" propid="titletext" datasetid="ds_poOrderInfo" columnid="arrivDate"/>
      <BindItem id="item17" compid="cal_saleEdate" propid="titletext" datasetid="ds_poOrderInfo" columnid="saleEdate"/>
      <BindItem id="item18" compid="cal_saleEdate" propid="text" datasetid="ds_poOrderInfo" columnid="saleEdate"/>
      <BindItem id="item0" compid="edt_salsplceNm" propid="userdata" datasetid="ds_search" columnid="GUBUN"/>
      <BindItem id="item2" compid="edt_salsplceNm" propid="UserData" datasetid="ds_search" columnid="GUBUN"/>
      <BindItem id="item16" compid="edt_salsplceNm" propid="value" datasetid="ds_poOrderInfo" columnid="salsplceNm"/>
      <BindItem id="item4" compid="edt_splrNm" propid="userdata" datasetid="ds_search" columnid="GUBUN"/>
      <BindItem id="item5" compid="edt_splrNm" propid="UserData" datasetid="ds_search" columnid="GUBUN"/>
      <BindItem id="item20" compid="edt_splrNm" propid="value" datasetid="ds_poOrderInfo" columnid="splrNm"/>
      <BindItem id="item21" compid="cbo_saleType" propid="value" datasetid="ds_poOrderInfo" columnid="saleType"/>
      <BindItem id="item23" compid="cbo_attachDept" propid="value" datasetid="ds_poOrderInfo" columnid="attachDept"/>
      <BindItem id="item27" compid="edt_proposalAmt00" propid="value" datasetid="ds_poOrderInfo" columnid="totWonwtrAmt"/>
      <BindItem id="item25" compid="cbo_amountUnit" propid="value" datasetid="ds_poOrderInfo" columnid="amountUnit"/>
      <BindItem id="item62" compid="edt_totQuantity" propid="value" datasetid="ds_poOrderInfo" columnid="totQuantity"/>
      <BindItem id="item26" compid="edt_totWgt" propid="value" datasetid="ds_poOrderInfo" columnid="totWgt"/>
      <BindItem id="item61" compid="edt_remark" propid="value" datasetid="ds_poOrderInfo" columnid="remark"/>
      <BindItem id="item31" compid="cal_poOrderDate" propid="text" datasetid="ds_poOrderInfo" columnid="exchangeRateDate"/>
      <BindItem id="item32" compid="cal_poOrderDate" propid="titletext" datasetid="ds_poOrderInfo" columnid="exchangeRateDate"/>
      <BindItem id="item6" compid="edt_proposalApprvDate" propid="value" datasetid="ds_poOrderInfo" columnid="proposalApprvDate"/>
    </Bind>
    <Objects>
      <Dataset id="ds_poOrderInfo" useclientlayout="true">
        <ColumnInfo>
          <column id="poOrderNum" type="STRING" size="255"/>
          <column id="poProposalNum" type="STRING" size="255"/>
          <column id="poOrderStatus" type="STRING" size="255"/>
          <column id="poOrderStatusNm" type="STRING" size="255"/>
          <column id="poProgressStatus" type="STRING" size="255"/>
          <column id="poProgressStatusNm" type="STRING" size="255"/>
          <column id="proposalTitle" type="STRING" size="255"/>
          <column id="proposalApprvDate" type="STRING" size="255"/>
          <column id="poOrderDate" type="STRING" size="255"/>
          <column id="poType" type="STRING" size="255"/>
          <column id="poTypeNm" type="STRING" size="255"/>
          <column id="drafterId" type="STRING" size="255"/>
          <column id="drafterNm" type="STRING" size="255"/>
          <column id="payCondCd" type="STRING" size="255"/>
          <column id="salsplceCd" type="STRING" size="255"/>
          <column id="salsplceNm" type="STRING" size="255"/>
          <column id="saleEdate" type="STRING" size="255"/>
          <column id="incomeType" type="STRING" size="255"/>
          <column id="splrCd" type="STRING" size="255"/>
          <column id="splrNm" type="STRING" size="255"/>
          <column id="saleType" type="STRING" size="255"/>
          <column id="saleTypeNm" type="STRING" size="255"/>
          <column id="incoterms" type="STRING" size="255"/>
          <column id="incotermsNm" type="STRING" size="255"/>
          <column id="attachDept" type="STRING" size="255"/>
          <column id="attachDeptNm" type="STRING" size="255"/>
          <column id="totWonwtrAmt" type="STRING" size="255"/>
          <column id="totQuantity" type="STRING" size="255"/>
          <column id="totWgt" type="STRING" size="255"/>
          <column id="amountUnit" type="STRING" size="255"/>
          <column id="blNum" type="STRING" size="255"/>
          <column id="blAcceptDate" type="STRING" size="255"/>
          <column id="exchangeRateDate" type="STRING" size="255"/>
          <column id="exchangeRate" type="STRING" size="255"/>
          <column id="shipper" type="STRING" size="255"/>
          <column id="transportType" type="STRING" size="255"/>
          <column id="lgYn" type="STRING" size="255"/>
          <column id="lshipDate" type="STRING" size="255"/>
          <column id="startingDate" type="STRING" size="255"/>
          <column id="arrivDate" type="STRING" size="255"/>
          <column id="originNationcd" type="STRING" size="255"/>
          <column id="originNationNm" type="STRING" size="255"/>
          <column id="lshipNationCd" type="STRING" size="255"/>
          <column id="lshipNationNm" type="STRING" size="255"/>
          <column id="lshipPortPortCd" type="STRING" size="255"/>
          <column id="lshipPortPortNm" type="STRING" size="255"/>
          <column id="arrivNationCd" type="STRING" size="255"/>
          <column id="arrivNationNm" type="STRING" size="255"/>
          <column id="arrivPortPortCd" type="STRING" size="255"/>
          <column id="arrivPortPortNm" type="STRING" size="255"/>
          <column id="inscNum" type="STRING" size="255"/>
          <column id="insurEntDate" type="STRING" size="255"/>
          <column id="insurEntAmt" type="STRING" size="255"/>
          <column id="insurEntBalAmt" type="STRING" size="255"/>
          <column id="lcNum" type="STRING" size="255"/>
          <column id="divideLshipAllowYn" type="STRING" size="255"/>
          <column id="lcIssuingDate" type="STRING" size="255"/>
          <column id="transhipmentAllowYn" type="STRING" size="255"/>
          <column id="lcIssuingAmt" type="STRING" size="255"/>
          <column id="lcIssuingBalAmt" type="STRING" size="255"/>
          <column id="prtgPayamtMethod" type="STRING" size="255"/>
          <column id="remark" type="STRING" size="255"/>
          <column id="proposalWriteDate" type="STRING" size="255"/>
          <column id="amountUnitNm" type="STRING" size="255"/>
          <column id="amountKrw" type="STRING" size="255"/>
          <column id="amountUsd" type="STRING" size="255"/>
          <column id="poAfterstatus" type="STRING" size="255"/>
          <column id="delYn" type="STRING" size="255"/>
          <Column id="fileRefSrlNum" type="STRING" size="256"/>
          <column id="cuser" type="STRING" size="255"/>
          <column id="cdate" type="STRING" size="255"/>
          <column id="uuser" type="STRING" size="255"/>
          <column id="udate" type="STRING" size="255"/>
          <Column id="intRate" type="STRING" size="256"/>
          <Column id="whChargAmt" type="STRING" size="256"/>
          <Column id="ioutAmt" type="STRING" size="256"/>
          <Column id="slipApprCnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_itemList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_itemList_oncolumnchanged">
        <ColumnInfo>
          <Column id="poProposalNum" type="STRING" size="256"/>
          <Column id="poOrderNum" type="STRING" size="255"/>
          <Column id="itemSeq" type="STRING" size="255"/>
          <Column id="itemCd" type="STRING" size="255"/>
          <Column id="itemNm" type="STRING" size="255"/>
          <Column id="unit" type="STRING" size="255"/>
          <Column id="quantity" type="BIGDECIMAL" size="255"/>
          <Column id="uprice" type="BIGDECIMAL" size="255"/>
          <Column id="wonwtrAmt" type="BIGDECIMAL" size="255"/>
          <Column id="wgt" type="BIGDECIMAL" size="255"/>
          <Column id="taxYn" type="STRING" size="255"/>
          <Column id="hsCd" type="STRING" size="255"/>
          <Column id="itemBlNum" type="STRING" size="255"/>
          <Column id="incomeDtrDsctNum" type="STRING" size="255"/>
          <Column id="estNo" type="STRING" size="255"/>
          <Column id="whCd" type="STRING" size="255"/>
          <Column id="whNm" type="STRING" size="256"/>
          <Column id="origin" type="STRING" size="255"/>
          <Column id="originNm" type="STRING" size="256"/>
          <Column id="remark" type="STRING" size="255"/>
          <Column id="entryEndQuantity" type="STRING" size="255"/>
          <Column id="deliverCnt" type="BIGDECIMAL" size="256"/>
          <Column id="cuser" type="STRING" size="255"/>
          <Column id="cdate" type="STRING" size="255"/>
          <Column id="uuser" type="STRING" size="255"/>
          <Column id="udate" type="STRING" size="255"/>
          <Column id="set1" type="STRING" size="256"/>
          <Column id="chargCost" type="STRING" size="256"/>
          <Column id="ioutCost" type="STRING" size="256"/>
          <Column id="firstDeliverDate" type="STRING" size="256"/>
          <Column id="currentWhDeliverDate" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="flag" type="STRING" size="256"/>
          <Column id="poOrderNum" type="STRING" size="256"/>
          <Column id="poProposalNum" type="STRING" size="256"/>
          <Column id="unit" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_itemListValid" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="itemCd" type="STRING" size="255"/>
          <Column id="itemNm" type="STRING" size="255"/>
          <Column id="unit" type="STRING" size="256"/>
          <Column id="quantity" type="STRING" size="256"/>
          <Column id="uprice" type="STRING" size="256"/>
          <Column id="wonwtrAmt" type="STRING" size="256"/>
          <Column id="wgt" type="STRING" size="256"/>
          <Column id="whCd" type="STRING" size="256"/>
          <Column id="taxYn" type="STRING" size="256"/>
          <Column id="chargCost" type="STRING" size="256"/>
          <Column id="ioutCost" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="itemCd">title:품목코드,required:true</Col>
            <Col id="itemNm">title:품목명,required:true</Col>
            <Col id="unit">title:단위,required:true</Col>
            <Col id="quantity">title:수량,required:true</Col>
            <Col id="uprice">title:단가,required:true</Col>
            <Col id="wonwtrAmt">title:원물금액,required:true</Col>
            <Col id="wgt">title:중량,required:true</Col>
            <Col id="taxYn">title:과세여부,required:true</Col>
            <Col id="chargCost">title:보관료,required:true</Col>
            <Col id="ioutCost">title:입출고비용,required:true</Col>
            <Col id="whCd">title:창고,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_file" preload="true" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep">
        <ColumnInfo>
          <Column id="refSeq" type="STRING" size="256"/>
          <Column id="appendSeq" type="STRING" size="256"/>
          <Column id="orgnlPath" type="STRING" size="256"/>
          <Column id="orgnlFileNm" type="STRING" size="256"/>
          <Column id="saveFileNm" type="STRING" size="256"/>
          <Column id="relPath" type="STRING" size="256"/>
          <Column id="fileSize" type="STRING" size="256"/>
          <Column id="fileExt" type="STRING" size="256"/>
          <Column id="encYn" type="STRING" size="256"/>
          <Column id="fileDesc" type="STRING" size="256"/>
          <Column id="fileUploadNm" type="STRING" size="256"/>
          <Column id="chk" type="INT" size="1"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_poOrderInfoValid" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="poOrderDate" type="STRING" size="256"/>
          <column id="salsplceCd" type="STRING" size="255"/>
          <column id="splrCd" type="STRING" size="255"/>
          <column id="saleType" type="STRING" size="255"/>
          <Column id="amountUnit" type="STRING" size="256"/>
          <Column id="arrivDate" type="STRING" size="256"/>
          <Column id="saleEdate" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="salsplceCd">title:매출처,required:true,focus:edt_salsplceNm</Col>
            <Col id="splrCd">title:매입처,required:true,focus:splrNm</Col>
            <Col id="saleType">title:판매유형,required:true,focus:saleType</Col>
            <Col id="amountUnit">title:화폐단위,required:true,focus:cbo_amountUnit</Col>
            <Col id="arrivDate">title:인수일자,required:true,focus:cal_arrivDate</Col>
            <Col id="saleEdate">title:판매종료일자,required:true,focus:cal_saleEdate</Col>
            <Col id="poOrderDate">title:주문등록일자,required:true,focus:cal_poOrderDate</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_payList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_payList_oncolumnchanged">
        <ColumnInfo>
          <Column id="poOrderNum" type="STRING" size="255"/>
          <Column id="orgPayCondClass" type="STRING" size="256"/>
          <Column id="payCondClass" type="STRING" size="256"/>
          <Column id="payCondSeq" type="STRING" size="255"/>
          <Column id="payCondCd" type="STRING" size="255"/>
          <Column id="payAmt" type="BIGDECIMAL" size="255"/>
          <Column id="cuser" type="STRING" size="255"/>
          <Column id="cdate" type="STRING" size="255"/>
          <Column id="uuser" type="STRING" size="255"/>
          <Column id="udate" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_payListValid" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" oncolumnchanged="ds_groupList_oncolumnchanged">
        <ColumnInfo>
          <Column id="payCondCd" type="STRING" size="255"/>
          <Column id="payAmt" type="STRING" size="255"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="payCondCd">title:지불조건,required:true</Col>
            <Col id="payAmt">title:지불금액,required:true</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : 구매주문(내수) 작성
  파 일 명 : DmtPoOrderDtl.xfdl
  기    능 : Design 및 Script Template 

    수정일    수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.01.12   kjj   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "lib::FTCommon.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_iProcessCnt = 0; //저장에 대한 처리건수를 저장한다.(AuthMgmtController에서 할당함.)
var fv_poProposalNum;
var fv_poOrderNum;
var fv_otherAmtSeq
var fv_flag;
var fv_focFlag;
var fv_tabFlag = false;	  //기타선급금정산 탭 이동 구분자
var fv_commAmt;		//기타선급금 수수료 합계
var fv_set1;	//실단위
var fv_currRow;

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : Form Load (필수)
 *---------------------------------------------------------------------------------------------*/
function form_onload(obj:Form, e:LoadEventInfo)
{	
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
	gfn_formOnLoad(this);
	
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	// Grid내의 input field를 자동 선택 제어 함수
	FTCommon.setGridAutoSelect (this, true);
	
	ds_search.addRow();
	
	SCCombo.bind2(this, "ComCode", "cbo_poType", null, {groupCode:"PO_TYPE", useYn:"Y", defVal:""}, SCCombo.ALL);	 	 //구매형태
	SCCombo.bind2(this, "ComCode", "cbo_saleType", null, {groupCode:"SALE_TYPE", useYn:"Y", defVal:""}, SCCombo.ALL);	 //판매유형 
	SCCombo.bind2(this, "ComCode", "cbo_attachDept", null, {groupCode:"ATTACH_DEPT", useYn:"Y", defVal:""}, SCCombo.ALL);	 	  //귀속부서
	SCCombo.bind2(this, "ComCode", "cbo_amountUnit", null, {groupCode:"AMOUNT_UNIT", useYn:"Y", defVal:""}, SCCombo.ALL);  //화폐 단위
	//SCCombo.bind(this, "ComCode", "cbo_incomeType", null, {groupCode:"INCOME_TYPE", useYn:"Y", defVal:""}, SCCombo.ALL);	 	  //수입 유형
	
	SCCombo.bind2(this, "ComCode", "Tab00.tabpage1.grd_itemList.unit", null, {groupCode:"ITEM_UNIT", useYn:"Y", defVal:""}, SCCombo.CHOOSE);		//단위
	SCCombo.bind2(this, "ComCode", "Tab00.tabpage1.grd_itemList.taxYn", null, {groupCode:"TAX_YN", useYn:"Y", defVal:""}, SCCombo.CHOOSE);			//과세여부

	SCCombo.bind2(this, "ComCode", "Tab00.tabpage3.grd_payList.payCondCd", null, {groupCode:"PAY_TERMS_CD", useYn:"Y", defVal:""}, SCCombo.CHOOSE);	//지불조건
	SCCombo.bind2(this, "ComCode", "Tab00.tabpage3.grd_payList.payCondClass", null, {groupCode:"PAY_COND_CLASS", useYn:"Y", defVal:"", isLast:true, lastEvent:"fn_doSearch"}, SCCombo.CHOOSE);	//지불조건구분 : 매입처,매출처

	SCPopup.bind(this, "ComCode", "Tab00.tabpage1.grd_itemList.originNm", "GRID:originNm", null, {groupCode:"NATION_CD", useYn:"Y",  design:{title:"국가조회",label:"국가",labelWidth:100,columns:[{text:"국가코드",width:100},{text:"국가명",width:200}]}} , {after:"fn_setNationNm", isExpandUp:false});	//그리드 국가 팝업

	fv_poOrderNum = gfn_nvl(poOrderNum, "");
	fv_flag = gfn_nvl(flag, "");
	fv_focFlag = gfn_nvl(flag, "");
	cal_saleEdate.fn_initMonthCal(this, "", "fn_calendarCallBack", ds_poOrderInfo, "saleEdate","Y");	//판매종료일자	
	cal_arrivDate.fn_initMonthCal(this, "", "fn_calendarCallBack", ds_poOrderInfo, "arrivDate","Y");	//도착예정일자
	cal_poOrderDate.fn_initMonthCal(this, "", "fn_calendarCallBack", ds_poOrderInfo, "poOrderDate","Y");	//구매주문일
	
	Tab00.tabpage2.ObjAtchFile.setDataset("ds_file");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 콤보코드 최종 callback 함수
 *---------------------------------------------------------------------------------------------*/
function fn_doSearch()
{
	if ( fv_poOrderNum == "" ) { 
		ds_poOrderInfo.insertRow(0); 
		ds_poOrderInfo.setColumn(0, "poOrderDate", gfn_today());
		
		cal_poOrderDate.setFocus();
	} else {
		fn_search();
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
 	// v_ds_check 미사용시 변경사항 체크
 	if (gfn_dsIsUpdated(ds_itemList) || gfn_dsIsUpdated(ds_file) ) 
 	{
		// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
 		var retValue = gfn_confirm("confirm.before.search");
 		if (retValue == false) return;
 	}
    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(Tab00.tabpage1.grd_itemList);
    
    //코드목록을 초기화한다.
    ds_itemList.clearData();
    ds_file.clearData();

	ds_search.setColumn(0, "poOrderNum", fv_poOrderNum);
	ds_search.setColumn(0, "flag", fv_flag);
	
    var strSvcID    = "selectPoOrderDtl";
    var strURL      = "ft/ftp/poOrderMst/selectPoOrderDtl.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_search=ds_search ds_poOrderInfo=ds_poOrderInfo ds_itemList=ds_itemList ds_payList=ds_payList ds_file=ds_file";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search2()
{
 	// v_ds_check 미사용시 변경사항 체크
 	if (gfn_dsIsUpdated(ds_itemList) ) 
 	{
		// 검색을 진행하면 변경된 데이터가 사라집니다. 계속 진행 하시겠습니까?
 		var retValue = gfn_confirm("confirm.before.search");
 		if (retValue == false) return;
 	}
    // Grid sort 표시 초기화(필수)
    gfn_clearSortMark(Tab00.tabpage1.grd_itemList);
    
    //코드목록을 초기화한다.
    ds_itemList.clearData();

	ds_search.setColumn(0, "poProposalNum", fv_poProposalNum);
	ds_search.setColumn(0, "flag", fv_flag);
	
    var strSvcID    = "selectProposalDtl";
    var strURL      = "ft/ftp/selectProposalDtl.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_search=ds_search ds_poOrderInfo=ds_poOrderInfo ds_itemList=ds_itemList ds_payList=ds_payList";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 저장 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_save()
{

	if ( fv_flag == "CALL" ) {	 //불러오기
		ds_poOrderInfo.updatecontrol = false;
		bSucc = ds_poOrderInfo.setRowType(0, Dataset.ROWTYPE_INSERT);
		ds_poOrderInfo.updatecontrol = true;

		ds_itemList.updatecontrol = false;
		for ( var i=0; i<ds_itemList.getRowCount(); i++ ) {
			bSucc = ds_itemList.setRowType(i, Dataset.ROWTYPE_INSERT);
		}
		ds_itemList.updatecontrol = true;

		ds_payList.updatecontrol = false;
		for ( var i=0; i<ds_payList.getRowCount(); i++ ) {
			bSucc = ds_payList.setRowType(i, Dataset.ROWTYPE_INSERT);
		}
		ds_payList.updatecontrol = true

		ds_file.updatecontrol = false;
		for ( var i=0; i<ds_file.getRowCount(); i++ ) {
			bSucc = ds_file.setRowType(i, Dataset.ROWTYPE_INSERT);
		}
		ds_file.updatecontrol = true;

	} 
	
	//v_ds_check 미사용시 변경사항 체크
 	if ( !gfn_dsIsUpdated(ds_poOrderInfo) && !gfn_dsIsUpdated(ds_itemList) && !gfn_dsIsUpdated(ds_payList)  && !gfn_dsIsUpdated(ds_file) )
 	{
 		gfn_alert("msg.save.nochange");	// 변경된 내역이 없습니다.
 		return;
 	}
	
	// 저장시 Validation Check
	if (gfn_validCheck(ds_poOrderInfo, ds_poOrderInfoValid) == false)	return;

	if (gfn_validCheck(Tab00.tabpage1.grd_itemList, ds_itemListValid) == false)	{
		Tab00.tabindex = 0;
		return;
	}
	if (gfn_validCheck(Tab00.tabpage3.grd_payList, ds_payListValid) == false) {
		Tab00.tabindex = 1;
		return;
	}
	
	var salsplceCd = gfn_nvl(ds_poOrderInfo.getColumn(0, "salsplceCd"), "");	// 매출처코드
	var splrCd = gfn_nvl(ds_poOrderInfo.getColumn(0, "splrCd"), "");			// 매입처코드
	if ( salsplceCd !="" && splrCd !="" ) 
	{
		if ( salsplceCd == splrCd ) 
		{
			gfn_alert("ftp.validator.nodeal");	// 자전거래(매출처와 매입처가 같은)는 할 수 없습니다.
			return;
		}
	}
	
	// 첨부 파일 추가가 있을때만
	if(Tab00.tabpage2.ObjAtchFile.fn_countDs("insert") > 0)
	{	
		var rtn = Tab00.tabpage2.ObjAtchFile.fn_uploadFile();		
		if (rtn < 0)	return;
	}	
	
	if ( gfn_dsIsUpdated(ds_file) )
	{
		if ( fv_flag == "CALL" ) {	 //불러오기
			ds_poOrderInfo.updatecontrol = false;
			bSucc = ds_poOrderInfo.setRowType(0, Dataset.ROWTYPE_INSERT);
			ds_poOrderInfo.updatecontrol = true;
		} else {
			ds_poOrderInfo.updatecontrol = false;
			bSucc = ds_poOrderInfo.setRowType(0, Dataset.ROWTYPE_UPDATE);
			ds_poOrderInfo.updatecontrol = true;
		}
		
	}
	ds_payList.getCaseSum();
	
	//alert(ds_itemList.getSum("wonwtrAmt") +"//"+ ds_payList.getSum("payAmt")+"//"+ds_payList.getCaseSum("payCondClass=='B'","payAmt"));
	//품목의 매입액 합계 [ $1 ] 와 지불조건의 지불예정금 합계[ $2 ] 같게 체크 : 물품대금시 지불금액으로 지불
	if ( ds_itemList.getSum("wonwtrAmt") != ds_payList.getCaseSum("payCondClass=='B'","payAmt") ) 
	{
		gfn_alert("ftp.validator.no.same", gfn_numFormat(ds_itemList.getSum("wonwtrAmt"))+"^"+gfn_numFormat(ds_payList.getCaseSum("payCondClass=='B'","payAmt")));	//품목의 매입액 합계 [ $1 ] 와 지불조건의 지불예정금 합계[ $2 ] 은 같아야 합니다.
		return;
	}
	
	
	// 품의번호[ $1 ]에 대하여 저장 하시겠습니까?
	if (!gfn_confirm("confirm.before.save")) return false;
	
	//ds_search.setColumn(0, "flag", fv_flag);
    var strSvcID    = "save";
    var strURL      = "ft/ftp/poOrderMst/saveDmtPoOrderDtl.xdo";
    var strInDs     = "ds_search=ds_search ds_poOrderInfo=ds_poOrderInfo:U ds_itemList=ds_itemList:A ds_payList=ds_payList:U ds_file=ds_file:A";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0) 
	{
		return;
	}
	
    switch(strSvcID)
    {
		//품의 조회
        case "selectPoOrderDtl" :
			if ( ds_poOrderInfo.getColumn(ds_poOrderInfo.rowposition, "poOrderStatus") == "C" ) 	  //po확정상태 확정이면 저장,삭제 안되게
			{	
				btn_save.enable = false;
				btn_delete.enable = false;
			}
			if ( ds_poOrderInfo.getColumn(ds_poOrderInfo.rowposition, "amountUnit") != "" )
			{
				cbo_amountUnit.enable = false;	//환율단위 disabled
			}
			
			cal_poOrderDate.setFocus();
            break;
        case "selectProposalDtl" :	
			ds_poOrderInfo.setColumn(0, "amountUnit", "KRW");
			cbo_amountUnit.enable = false;	//환율단위 disabled
			//ds_poOrderInfo.setColumn(0, "poOrderDate", gfn_today());
			
			cal_poOrderDate.setFocus();
            break;
        // 저장
        case "save" :
			if (fv_iProcessCnt > 0) {
				gfn_alert("msg.save.success");	// 저장 되었습니다.
				//alert("품의서 번호["+fv_poProposalNum+"]가 생성되었습니다.");
				fv_flag = "UPDATE";
				fn_search();
			} 
            break;
        //입고
        case "deliver" :
			if (fv_iProcessCnt > 0) {
				gfn_alert("msg.save.success");	// 저장 되었습니다.
				fv_flag = "UPDATE";
				fn_search();
			} 
            break;
        //입고취소
        case "delete" :
			if (fv_iProcessCnt > 0) {
				gfn_alert("msg.save.success");	// 저장 되었습니다.
				fv_flag = "UPDATE";
				fn_search();
			} 
            break;
        case "getUnitInfo":
			if ( fv_set1 != "" )
			{
				var quantity = gfn_nvl(ds_itemList.getColumn(fv_currRow, "quantity"));
				var wgt = gfn_nvl(ds_itemList.getColumn(fv_currRow, "wgt"));
				var uprice = gfn_nvl(ds_itemList.getColumn(fv_currRow, "uprice"));
				if ( fv_set1 == "KG") 
				{
					ds_itemList.setColumn(fv_currRow, "wonwtrAmt", wgt * uprice);
				} 
				else 
				{
					ds_itemList.setColumn(fv_currRow, "wonwtrAmt", quantity * uprice);
				}
			}
			break;		            
    }
    
}

function fn_calendarCallBack() {
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 그리드 국가코드 선택시 세팅
 *---------------------------------------------------------------------------------------------*/
function fn_setNationNm(p, data)
{
	if (p.oid == "Tab00.tabpage1.grd_itemList.originNm") 
	{
		ds_itemList.setColumn(ds_itemList.rowposition, "origin", data.code);
		ds_itemList.setColumn(ds_itemList.rowposition, "originNm", data.codeName);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 품목 행추가
 *---------------------------------------------------------------------------------------------*/
function fn_addRow1(obj:Button,  e:ClickEventInfo)
{
	var insRow = ds_itemList.insertRow(ds_itemList.getRowCount()+1);
	if ( edt_poOrderNum.value != "" ) {	 
		ds_itemList.setColumn(insRow, "poProposalNum", edt_poProposalNum.value  );
		ds_itemList.setColumn(insRow, "poOrderNum", edt_poOrderNum.value  );
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 품목 행삭제
 *---------------------------------------------------------------------------------------------*/
function fn_deleteRow1(obj:Button,  e:ClickEventInfo)
{
	var bSucc = ds_itemList.deleteRow(ds_itemList.rowposition);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 지불조건 행추가
 *---------------------------------------------------------------------------------------------*/
function fn_addRow2(obj:Button,  e:ClickEventInfo)
{
	var insRow = ds_payList.insertRow(ds_payList.getRowCount()+1);
	ds_payList.setColumn(insRow, "payCondClass", "B");
	if ( edt_poProposalNum.value != "" ) {	 
		ds_payList.setColumn(insRow, "poOrderNum", edt_poOrderNum.value  );
		ds_payList.setColumn(insRow, "payCondCd", "3AB"  );	  //내수송금 세팅
		
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 지불조건 행삭제
 *---------------------------------------------------------------------------------------------*/
function fn_deleteRow2(obj:Button,  e:ClickEventInfo)
{
	var bSucc = ds_payList.deleteRow(ds_payList.rowposition);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 품목 그리드 값 변경시
 *---------------------------------------------------------------------------------------------*/
function ds_itemList_oncolumnchanged(obj:Dataset, e:DSColChangeEventInfo)
{
	if(e.columnid == "quantity" || e.columnid == "wgt" || e.columnid == "uprice" || e.columnid == "unit") 
	{
		fv_currRow = e.row;
		fn_getUnitInfo( gfn_nvl(ds_itemList.getColumn(e.row, "unit")) );
	}
	// 원물금액이 변경되면 지불조건탭의 지급금액에 합계를 넣어준다.
	// 지불조건택의 지급금액에 합계를 넣는다.
	for (var i = 0; i < ds_payList.getRowCount(); i++) {
		ds_payList.setColumn(i, "payAmt", ds_itemList.getSum("wonwtrAmt")  );
	}
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      :단위변경시 단위에 해당하는 실단위 가져오기
 *---------------------------------------------------------------------------------------------*/
function fn_getUnitInfo(unit)
{
	ds_search.setColumn(0, "unit", unit);
    var strSvcID    = "getUnitInfo";
    var strURL      = "ft/ftp/getUnitInfo.xdo";
    var strInDs     = "ds_search=ds_search";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 불러오기 버튼 클릭시
 *---------------------------------------------------------------------------------------------*/
function btn_callProposal_onclick(obj:Button,  e:ClickEventInfo)
{
	if ( fv_poOrderNum != "" ) { 
		gfn_alert("이미 품의서번호가 생성되었습니다.");
		return;
	}
	
	var arrParam = new Array();
	arrParam[0] = "20";	// 전송할 파라미터 1 (내수)

	var  arrRtn = gfn_dialog("ProposalSearchPop"				// dialogId
					   , "X_FTP::ProposalSearchPop.xfdl"		// 품의서검색 팝업
					   , {fv_Contents:arrParam}			// 배열
					   , null, null, null, null, null, false, true, -1);

	if ( arrRtn instanceof Object )
	{
		fv_poProposalNum = arrRtn["poProposalNum"];
		ds_poOrderInfo.setColumn(0, "poProposalNum", arrRtn["poProposalNum"]  );
		fv_flag = "CALL";
		fn_search2();		
	}	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 품목 그리드 품목 팝업 expand시
 *---------------------------------------------------------------------------------------------*/
function grd_itemList_onexpandup(obj:Grid, e:GridMouseEventInfo)
{
	if(e.row <= -1) return;
    var sColumn = gfn_getCellColId(obj, e.col);

	//품목명클릭시
	if (sColumn == "itemCd")
	{
		//gfn_alert((e.row+1) + "번째 row의 Expand 버튼을 Click 했습니다.");
		var arrParam = new Array();
		arrParam[0] = gfn_nvl(ds_itemList.getColumn(ds_itemList.rowposition, "itemCd"), "");	// 전송할 파라미터 1
		var  arrRtn = gfn_dialog("ItemSearchPop"				// dialogId
						   , "X_FSI::ItemSearchPop.xfdl"			// 품목찾기 팝업 호출
						   , {fv_Contents:arrParam}			// 배열
						   , null, null, null, null, null, false, true, -1);
		if ( arrRtn instanceof Object )
		{
			ds_itemList.setColumn(ds_itemList.rowposition, "itemCd", arrRtn["itemCode"]  );
			ds_itemList.setColumn(ds_itemList.rowposition, "itemNm", arrRtn["itemName"]  );	
		}
	} 
	//창고명 클릭시
	else if (sColumn == "whNm")
	{
		/*
		var arrParam = new Array();
		arrParam[0] = gfn_nvl(ds_itemList.getColumn(e.row, "whCd"), "");		// 전송할 파라미터 1
		arrParam[1] = gfn_nvl(ds_itemList.getColumn(e.row, "whNm"), "");		// 전송할 파라미터 2
		arrParam[2] = "50";	// 창고
		var  arrRtn = gfn_dialog("ContrtPop"				// dialogId
						   , "X_FSI::ContrtPop.xfdl"		// 매출처 팝업 호출
						   , {fv_Contents:arrParam}			// 배열
						   , null, null, null, null, null, false, true, -1);
		if ( arrRtn instanceof Object )
		{
			ds_itemList.setColumn(ds_itemList.rowposition, "whCd", arrRtn["vdCd"]  );
			ds_itemList.setColumn(ds_itemList.rowposition, "whNm", arrRtn["vdNmLoc"]  );	
		}
	   */
		var arrParam = new Array();
		arrParam[1] = gfn_nvl(ds_itemList.getColumn(e.row, "whNm"), "");	// 전송할 파라미터 2
		arrParam[3] = gfn_nvl(ds_itemList.getColumn(e.row, "itemNm"), "");	// 전송할 파라미터 2
		var  arrRtn = gfn_dialog("WhItemChargAmtPop"				// dialogId
						   , "X_FSI::WhItemChargAmtPop.xfdl"		// 국가/공항 팝업 호출
						   , {fv_Contents:arrParam}			// 배열
						   , null, null, null, null, null, false, true, -1);
		if ( arrRtn instanceof Object )
		{
			ds_itemList.setColumn(ds_itemList.rowposition, "whCd", arrRtn["whCd"]  ); 
			ds_itemList.setColumn(ds_itemList.rowposition, "whNm", arrRtn["whNm"]  );	
			ds_itemList.setColumn(ds_itemList.rowposition, "chargCost", arrRtn["chargCost"]  );	
			ds_itemList.setColumn(ds_itemList.rowposition, "ioutCost", arrRtn["ioutCost"]  );	
		}
	   
						
						
	}
	else
	{
		SCPopup.doProcessGridPopupEvent(obj, e);
	}
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 입고버튼 클릭시
 *---------------------------------------------------------------------------------------------*/
function btn_deliver_onclick(obj:Button,  e:ClickEventInfo)
{
	if ( ds_poOrderInfo.getColumn(ds_poOrderInfo.rowposition, "poOrderStatus") != "C" ) 	  //po확정상태 확정상태가 아니면 입고 차단
	{
		gfn_alert("확정 상태에서 입고 가능합니다.");
		return;	 
	}
	for ( var i=0; i<ds_itemList.rowcount; i++ ) 
	{
	    
	    
		if ( fv_poOrderNum =="" )	  //저장안하고 입고시
		{
			gfn_alert("저장 후 입고 가능합니다." );
			return;
		}
	    
		if ( ds_itemList.getColumn(i, "deliverCnt") > 0 )	  //입고된 내역이 있으면
		{
			gfn_alert("품목 :"+ds_itemList.getColumn(i, "itemNm")+"은 이미 입고되어 있습니다." );
			ds_itemList.rowposition = i;
			return;
		}

		if ( gfn_nvl(ds_itemList.getColumn(i, "firstDeliverDate"),"") == "" )	
		{
			gfn_alert("최초입고일은 필수 입력 항목입니다.");
			ds_itemList.rowposition = i;
			Tab00.tabpage1.grd_itemList.setCellPos(Tab00.tabpage1.grd_itemList.getBindCellIndex("Body", "firstDeliverDate")); 
			Tab00.tabpage1.grd_itemList.setFocus();
			Tab00.tabpage1.grd_itemList.showEditor(); 
			
			return;
		}			
	
		if ( gfn_nvl(ds_itemList.getColumn(i, "currentWhDeliverDate"),"") == "" )	  //축산
		{
			gfn_alert("실입고일는 필수 입력 항목입니다.");
			ds_itemList.rowposition = i;
			Tab00.tabpage1.grd_itemList.setCellPos(Tab00.tabpage1.grd_itemList.getBindCellIndex("Body", "currentWhDeliverDate")); 
			Tab00.tabpage1.grd_itemList.setFocus();
			Tab00.tabpage1.grd_itemList.showEditor(); 
			
			return;
		}

		if ( ds_poOrderInfo.getColumn(0, "attachDept") == "10" && gfn_nvl(ds_itemList.getColumn(i, "incomeDtrDsctNum"),"") == "" )	  //축산
		{
			gfn_alert("축산의 수입유통식별번호는 필수 입력 항목입니다.");
			ds_itemList.rowposition = i;
			Tab00.tabpage1.grd_itemList.setCellPos(Tab00.tabpage1.grd_itemList.getBindCellIndex("Body", "incomeDtrDsctNum")); 
			Tab00.tabpage1.grd_itemList.setFocus();
			Tab00.tabpage1.grd_itemList.showEditor(); 
			
			return;
		}			

		if ( gfn_nvl(ds_itemList.getColumn(i, "whCd"),"") == "" )	  //창고
		{
			gfn_alert("창고는 필수 입력 항목입니다.");
			ds_itemList.rowposition = i;
			Tab00.tabpage1.grd_itemList.setCellPos(Tab00.tabpage1.grd_itemList.getBindCellIndex("Body", "whNm")); 
			Tab00.tabpage1.grd_itemList.setFocus();
			Tab00.tabpage1.grd_itemList.showEditor(); 
			
			return;
		}
		/*
		if ( gfn_nvl(ds_itemList.getColumn(i, "chargCost"),"0") == "0" )	  //보관료
		{
			gfn_alert("보관료는 필수 입력 항목입니다.");
			ds_itemList.rowposition = i;
			Tab00.tabpage1.grd_itemList.setCellPos(Tab00.tabpage1.grd_itemList.getBindCellIndex("Body", "chargCost")); 
			Tab00.tabpage1.grd_itemList.setFocus();
			Tab00.tabpage1.grd_itemList.showEditor(); 
			
			return;
		}
		if ( gfn_nvl(ds_itemList.getColumn(i, "ioutCost"),"0") == "0" )	  //입출고비
		{
			gfn_alert("입출고비는 필수 입력 항목입니다.");
			ds_itemList.rowposition = i;
			Tab00.tabpage1.grd_itemList.setCellPos(Tab00.tabpage1.grd_itemList.getBindCellIndex("Body", "ioutCost")); 
			Tab00.tabpage1.grd_itemList.setFocus();
			Tab00.tabpage1.grd_itemList.showEditor(); 
			
			return;
		}
		*/
	}	
	
	
	
	if (!gfn_confirm("입고 하시겠습니까?")) return false;
	
    var strSvcID    = "deliver";
    var strURL      = "ft/fdm/inventoryMgmtDeliver/saveDmtDeliver.xdo";
    var strInDs     = "ds_search=ds_search ds_poOrderInfo=ds_poOrderInfo:A ds_itemList=ds_itemList:A";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);	
	
	
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 입고취소버튼 클릭시
 *---------------------------------------------------------------------------------------------*/
function btn_deliverCancel_onclick(obj:Button,  e:ClickEventInfo)
{

	for ( var i=0; i<ds_itemList.rowcount; i++ ) 
	{
		if ( ds_itemList.getColumn(i, "deliverCnt") <= 0 )	  //입고된 내역이 있으면
		{
			gfn_alert("품목 "+ds_itemList.getColumn(i, "itemNm")+"는 입고된 내역이 없습니다. 입고 후 취소 가능합니다." );
			ds_itemList.rowposition = i;
			return;
		}
	}	

	var slipApprCnt = toNumber(ds_poOrderInfo.getColumn(0, "slipApprCnt"));	//물품대금 전표승인 건수
	
	if ( slipApprCnt > 0 ) 
	{
		gfn_alert("이미 물품대금(내수)에서 전표처리 되었습니다.\n입고 취소 불가합니다." );
		return;
	}
	
	
	if (!gfn_confirm("입고취소 하시겠습니까?")) return false;
	
    var strSvcID    = "delete";
    var strURL      = "ft/fdm/inventoryMgmtDeliver/deleteDmtDeliver.xdo";
    var strInDs     = "ds_search=ds_search ds_poOrderInfo=ds_poOrderInfo:A ds_itemList=ds_itemList:A";
    var strOutDs    = "";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;
    
    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync);	
}


/*
 ******************************************************************************************
 * 함  수  명   : fn_Close()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function fn_close(obj:Button, e:ClickEventInfo)
{

	if ( fv_focFlag == "NEW" ) 
	{
		this.parent.opener.fv_popIProcessCnt  = fv_iProcessCnt;
		this.parent.close();
	}
	else
	{
		this.parent.opener.fv_popIProcessCnt  = fv_iProcessCnt;
		this.parent.close();
	}
	return;
}

/*
 ******************************************************************************************
 * 함  수  명   : DmtPoOrderDtl_onclose()
 * 기      능   : [닫기버튼] 화면을 닫을때 처리되는 작업
 ******************************************************************************************
 */
function DmtPoOrderDtl_onclose(obj:Form, e:CloseEventInfo)
{
	if ( fv_iProcessCnt > 0 )	//변경사항 있을시 부모창 재조회
	{
		if ( fv_focFlag == "NEW" ) 
		{
			opener.parent.fv_popIProcessCnt  = fv_iProcessCnt;
		}
		else
		{
			this.opener.fv_popIProcessCnt  = fv_iProcessCnt;
		}
		return;
	} 
	this.close();
}

/*----------------------------------------------------------------------------------------------
 * 설명      :매출처 팝업 클릭시
 *---------------------------------------------------------------------------------------------*/
function btn_salsplceNm_onclick(obj:Button,  e:ClickEventInfo)
{
	var arrParam = new Array();
	arrParam[0] = gfn_nvl(ds_poOrderInfo.getColumn(e.row, "salsplceCd"), "");	// 전송할 파라미터 1
	arrParam[1] = gfn_nvl(ds_poOrderInfo.getColumn(e.row, "salsplceNm"), "");	// 전송할 파라미터 2
	var  arrRtn = gfn_dialog("SalesCustPop"				// dialogId
					   , "X_FSI::SalesCustPop.xfdl"		// 매출처 팝업 호출
					   , {fv_Contents:arrParam}			// 배열
					   , null, null, null, null, null, false, true, -1);
	if ( arrRtn instanceof Object )
	{
		ds_poOrderInfo.setColumn(0, "salsplceCd", arrRtn["salsplceCd"]  );
		ds_poOrderInfo.setColumn(0, "salsplceNm", arrRtn["salsplceNm"]  );	
		
	}	
}

/*----------------------------------------------------------------------------------------------
 * 설명      :매입처 팝업 클릭시
 *---------------------------------------------------------------------------------------------*/
function btn_splrNm_onclick(obj:Button,  e:ClickEventInfo)
{
	var arrParam = new Array();
	arrParam[0] = gfn_nvl(ds_poOrderInfo.getColumn(e.row, "splrCd"), "");		// 전송할 파라미터 1
	arrParam[1] = gfn_nvl(ds_poOrderInfo.getColumn(e.row, "splrNm"), "");		// 전송할 파라미터 2
	arrParam[2] = "10";	// 국내거래처
	var  arrRtn = gfn_dialog("ContrtPop"				// dialogId
					   , "X_FSI::ContrtPop.xfdl"		// 매출처 팝업 호출
					   , {fv_Contents:arrParam}			// 배열
					   , null, null, null, null, null, false, true, -1);
	if ( arrRtn instanceof Object )
	{
		ds_poOrderInfo.setColumn(0, "splrCd", arrRtn["vdCd"]  );
		ds_poOrderInfo.setColumn(0, "splrNm", arrRtn["vdNmLoc"]  );	
		
	}	
}

function cal_saleEdate_onclick(obj:ObjCalendar,  e:ClickEventInfo)
{
	
}
]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.4">
  <TypeDefinition url="..\default_typedef.xml"/>
  <Form id="IntroFrameLims" classname="MainArea" inheritanceid="" position="absolute 0 0 1267 740" onload="IntroFrame_onload" style="border:0 none #808080ff ;" scrollbars="none" class="sta_MAIN_Team" titletext="LIMS" ontimer="IntroFrameLims_ontimer" text="LIMS System" onbeforeclose="IntroFrameLims_onbeforeclose">
    <Layouts>
      <Layout>
        <resizeObject id="resizeObject00" text="resizeObject00" visible="false" position="absolute 13 9 29 29" style="background:#009999ff; border:1 solid #808080ff ; "/>
        <Static id="Static71" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 0 1267 15"/>
        <Static id="Static01" text="h15" class="Guide01_AreaRed" visible="false" position="absolute 0 725 1267 740"/>
        <Static id="Static00" text="15" class="Guide01_AreaRed" visible="false" position="absolute 1252 0 1267 725"/>
        <Static id="Static04" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 249 15 259 740"/>
        <Static id="Static09" text="w10" class="Guide01_AreaRed" visible="false" position="absolute 1241 15 1251 730"/>
        <Static id="Static06" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 0 15 15 740"/>
        <Div id="Div00" taborder="12" class="div_MAIN_InfoBg" position="absolute 15 15 249 201">
          <Layouts>
            <Layout>
              <Static id="sta_currDate" class="sta_MAIN_Date" position="absolute 0 0 232 36" anchor="default"/>
              <Button id="btn_pwdChg" taborder="3" class="btn_MAIN_Rock" position="absolute 196 0 232 36" anchor="default" onclick="Div00_btn_pwdChg_onclick" tooltiptext="비밀번호 변경"/>
              <Static id="sta_deptNm" class="sta_MAIN_Team" position="absolute 0 36 232 75" anchor="default"/>
              <Static id="Static02" class="sta_MAIN_Mydesk" position="absolute 0 75 232 110" anchor="default"/>
              <Static id="sta_apprvCnt" text="승인 : 0" class="sta_MAIN_MydeskInput" position="absolute 17 126 110 146" anchor="default"/>
              <Static id="sta_apprvNoActionCnt" text="미승인 : 0" class="sta_MAIN_MydeskInput" position="absolute 133 126 226 146" anchor="default"/>
              <Static id="sta_apprvRejectCnt" text="반려 : 0" class="sta_MAIN_MydeskInput" position="absolute 17 147 110 167" style="color:#637081ff;" anchor="default"/>
              <Button id="btn_psnlChg" taborder="4" onclick="Div00_btn_psnlChg_onclick" position="absolute 157 -1 197 35" tooltiptext="개인정보 변경" class="btn_MAIN_Modify"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static02" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 15 201 249 211"/>
        <Static id="Static03" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 15 367 249 377"/>
        <Div id="Div01" taborder="13" class="div_MAIN_ChecklistBg" position="absolute 15 211 249 366">
          <Layouts>
            <Layout>
              <Static id="Static02" class="sta_MAIN_CheckList" position="absolute 0 0 232 32" anchor="default"/>
              <Static id="Static04" text="h12" class="Guide01_AreaRed" visible="false" position="absolute 0 32 232 44" anchor="default"/>
              <Static id="Static00" text="w14" class="Guide01_AreaRed" visible="false" position="absolute 0 36 14 145" anchor="default"/>
              <Static id="Static01" text="h12" class="Guide01_AreaRed" visible="false" position="absolute 0 141 232 153" anchor="default"/>
              <Static id="Static03" text="w14" class="Guide01_AreaRed" visible="false" position="absolute 218 36 232 145" anchor="default"/>
              <Grid id="grd_checkList" class="grd_MAIN_Notice" taborder="6" binddataset="ds_checkList" useinputpanel="false" position="absolute 14 44 218 141" anchor="default" oncelldblclick="Div01_grd_checkList_oncelldblclick">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="17"/>
                      <Column size="176"/>
                    </Columns>
                    <Rows>
                      <Row size="0" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="img"/>
                      <Cell col="1" text="Column1"/>
                    </Band>
                    <Band id="body">
                      <Cell style="background:BIND(img);background2:BIND(img);selectbackground:BIND(img);"/>
                      <Cell col="1" text="bind:checklist"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Static id="Static05" text="(전체)" position="absolute 113 4 162 28" style="font:arial,9,bold;" anchor="left top"/>
              <Button id="Button00" taborder="7" class="btn_MAIN_Map" position="absolute 200 0 232 32" visible="false"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_quickList" taborder="14" class="div_MAIN_ChecklistBg" position="absolute 15 377 249 725" anchor="left top bottom">
          <Layouts>
            <Layout>
              <Static id="Static04" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 0 0 232 6" anchor="default"/>
              <Static id="Static00" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 0 290 232 296" anchor="left top bottom"/>
              <Static id="Static01" text="w04" class="Guide01_AreaRed" visible="false" position="absolute 0 6 6 347" anchor="default"/>
              <Static id="Static02" text="w04" class="Guide01_AreaRed" visible="false" position="absolute 226 6 232 352" anchor="default"/>
              <Static id="Static03" text="h04" class="Guide01_AreaRed" visible="false" position="absolute 0 50 232 54" anchor="default"/>
              <Static id="Static05" text="h04" class="Guide01_AreaRed" visible="false" position="absolute 0 98 232 102" anchor="default"/>
              <Static id="Static06" text="h04" class="Guide01_AreaRed" visible="false" position="absolute 0 146 232 150" anchor="default"/>
              <Static id="Static07" text="h04" class="Guide01_AreaRed" visible="false" position="absolute 0 194 232 198" anchor="default"/>
              <Static id="Static08" text="h04" class="Guide01_AreaRed" visible="false" position="absolute 0 242 232 246" anchor="default"/>
              <Static id="Static09" text="h06" class="Guide01_AreaRed" visible="false" position="absolute 0 340 232 346" anchor="left top bottom"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="Div04" anchor="left top right" taborder="15" position="absolute 260 15 1242 359" style="border:1 solid #b7c4d1ff ;" onsize="Div04_onsize" class="div_MAIN_NoticeBg">
          <Layouts>
            <Layout>
              <ActiveX id="atx_chart2" progid="ShockwaveFlash.ShockwaveFlash.10" windowed="true" useautobitmapcache="1" taborder="0" FSCommand="atx_chart_FSCommand" anchor="all" position="absolute -2 39 979 342" AllowFullScreen="false" AllowFullScreenInteractive="false" positiontype="position"/>
              <Static id="Static01" text="월별검사현황(실시간)" class="sta_MAIN_GraphTitle" position="absolute 0 0 216 38" anchor="default"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="Div07" anchor="top right" taborder="17" position="absolute 1291 19 1617 349" class="div_MAIN_NoticeBg" enable="false" visible="false">
          <Layouts>
            <Layout>
              <Static id="Static01" text="사후처리 내역 (당해년도)" class="sta_MAIN_NoticeTitle3" position="absolute 0 0 324 36" anchor="default" enable="false" visible="false"/>
              <Grid id="grd_afterProcessHistory" taborder="11" binddataset="ds_afterProcessHistory" scrollbars="autoboth" useinputpanel="false" autofittype="none" position="absolute -1 36 324 328" anchor="all" cellsizingtype="col" onheadclick="Div07_grd_afterProcessHistory_onheadclick" useselcolor="true" oncelldblclick="Div07_grd_afterProcessHistory_oncelldblclick" enable="false" visible="false">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="40"/>
                      <Column size="82"/>
                      <Column size="156"/>
                      <Column size="124"/>
                      <Column size="82"/>
                      <Column size="128"/>
                      <Column size="115"/>
                      <Column size="118"/>
                      <Column size="150"/>
                    </Columns>
                    <Rows>
                      <Row size="28" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell class="head_Excel"/>
                      <Cell col="1" text="의뢰일"/>
                      <Cell col="2" text="접수명"/>
                      <Cell col="3" text="업장명"/>
                      <Cell col="4" text="접수일"/>
                      <Cell col="5" text="검체명"/>
                      <Cell col="6" style="align:center middle;" text="업장 부적합&#13;&#10;의뢰건수"/>
                      <Cell col="7" text="검사결과"/>
                      <Cell col="8" text="사후처리"/>
                    </Band>
                    <Band id="body">
                      <Cell style="background:#ffffffff;background2:#ffffff;" text="expr:currow+1"/>
                      <Cell col="1" displaytype="date" style="background:#ffffffff;background2:#ffffff;" text="bind:reqDate"/>
                      <Cell col="2" displaytype="text" style="background:#ffffffff;background2:#ffffff;" text="bind:acceptnm"/>
                      <Cell col="3" displaytype="text" style="background:#ffffffff;background2:#ffffff;" text="bind:upjangNm"/>
                      <Cell col="4" displaytype="date" style="background:#ffffffff;background2:#ffffff;" text="bind:acceptdd"/>
                      <Cell col="5" displaytype="text" style="background:#ffffffff;background2:#ffffff;" text="bind:specmNm"/>
                      <Cell col="6" displaytype="number" style="background:#ffffffff;background2:#ffffff;" text="bind:notFitCnt"/>
                      <Cell col="7" style="background:#ffffffff;background2:#ffffff;" text="bind:notFitClsfiNm"/>
                      <Cell col="8" displaytype="text" style="background:#ffffffff;background2:#ffffff;" text="bind:materialSendInfo"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Static id="sta_afterProcTotCnt" text=" : 0건" position="absolute 189 11 249 25" enable="false" visible="false"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static08" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 1286 349 1622 359" enable="false"/>
        <Static id="Static05" text="검사원별 월간 진행현황" class="sta_MAIN_GraphTitle2" position="absolute 264 358 474 405"/>
        <Grid id="grd_monthIng" taborder="20" binddataset="ds_monthIng" scrollbars="autoboth" useinputpanel="false" autofittype="col" position="absolute 260 418 1241 725" anchor="all" cellsizingtype="col" summarytype="default" fillareatype="none">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="65"/>
                <Column size="81"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
              </Columns>
              <Rows>
                <Row size="27" band="head"/>
                <Row size="24"/>
                <Row size="24" band="summ"/>
              </Rows>
              <Band id="head">
                <Cell colspan="2" text="구분" taborder="undefined"/>
                <Cell col="2" text="총건수"/>
                <Cell col="3" text="진행&#13;&#10;검체건수"/>
                <Cell col="4" text="완료검체건수&#13;&#10;(당일/월누계)"/>
                <Cell col="5" text="진행&#13;&#10;항목수"/>
                <Cell col="6" text="완료항목수&#13;&#10;(당일/월누계)"/>
                <Cell col="7" text="금주완료예정수&#13;&#10;(당일/주누계)"/>
                <Cell col="8" text="부적합&#13;&#10;항목수"/>
              </Band>
              <Band id="body">
                <Cell displaytype="normal" style="background:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' : '#ffffff');background2:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' :  '#ffffff');" text="bind:insptFldNm" expr="expr:getRowLevel(currow) == 1 ? '소계' : insptFldNm" suppress="1"/>
                <Cell col="1" style="background:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' : (useYn=='Y'? '#ffffff' : 'pink'));background2:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' : (useYn=='Y'? '#ffffff' : 'pink'));" text="bind:userNm"/>
                <Cell col="2" displaytype="number" style="background:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' : (useYn=='Y'? '#ffffff' : 'pink'));background2:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' : (useYn=='Y'? '#ffffff' : 'pink'));" text="bind:totCnt" mask="@,@@@"/>
                <Cell col="3" displaytype="number" style="background:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' : (useYn=='Y'? '#ffffff' : 'pink'));background2:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' : (useYn=='Y'? '#ffffff' : 'pink'));" text="bind:ingCnt" mask="@,@@@"/>
                <Cell col="4" displaytype="number" style="background:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' : (useYn=='Y'? '#ffffff' : 'pink'));background2:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' : (useYn=='Y'? '#ffffff' : 'pink'));" text="bind:completeCnt" expr="expr:currCompleteCnt+'('+completeCnt+')'" mask="@,@@@"/>
                <Cell col="5" displaytype="number" style="background:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' : (useYn=='Y'? '#ffffff' : 'pink'));background2:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' : (useYn=='Y'? '#ffffff' : 'pink'));" text="bind:ingTestCnt" mask="@,@@@"/>
                <Cell col="6" displaytype="number" style="background:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' : (useYn=='Y'? '#ffffff' : 'pink'));background2:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' : (useYn=='Y'? '#ffffff' : 'pink'));" text="bind:completeTestCnt" expr="expr:currCompleteTestCnt + '(' + completeTestCnt + ')'" mask="@,@@@"/>
                <Cell col="7" displaytype="number" style="background:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' : (useYn=='Y'? '#ffffff' : 'pink'));background2:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' : (useYn=='Y'? '#ffffff' : 'pink'));" text="bind:weekCompleteScheCnt" expr="expr:currWeekCompleteScheCnt + '(' + weekCompleteScheCnt + ')'" mask="@,@@@"/>
                <Cell col="8" displaytype="number" style="background:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' : (useYn=='Y'? '#ffffff' : 'pink'));background2:EXPR(getRowLevel(currow) == 1 ? '#e7e7ffff' : (useYn=='Y'? '#ffffff' : 'pink'));" text="bind:notFitCnt" mask="@,@@@"/>
              </Band>
              <Band id="summary">
                <Cell colspan="2" displaytype="text" text="합계" taborder="undefined"/>
                <Cell col="2" displaytype="number" expr="expr:getSum(&quot;totCnt&quot;)" mask="@,@@@"/>
                <Cell col="3" displaytype="number" expr="expr:getSum(&quot;ingCnt&quot;)" mask="@,@@@"/>
                <Cell col="4" displaytype="number" expr="expr:getSum(&quot;currCompleteCnt&quot;) + '(' + getSum(&quot;completeCnt&quot;) +')'" mask="@,@@@"/>
                <Cell col="5" displaytype="number" expr="expr:getSum(&quot;ingTestCnt&quot;)" mask="@,@@@"/>
                <Cell col="6" displaytype="number" expr="expr:getSum(&quot;currCompleteTestCnt&quot;) + '(' + getSum(&quot;completeTestCnt&quot;) + ')'" mask="@,@@@"/>
                <Cell col="7" displaytype="number" expr="expr:getSum(&quot;currWeekCompleteScheCnt&quot;) + '(' + getSum(&quot;weekCompleteScheCnt&quot;) + ')'" mask="@,@@@"/>
                <Cell col="8" displaytype="number" expr="expr:getSum(&quot;notFitCnt&quot;)" mask="@,@@@"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static07" text="W107" class="Guide01_AreaRed" visible="false" position="absolute 264 367 371 376"/>
        <Div id="Div03" anchor="top right" taborder="21" class="div_MAIN_NoticeBg" position="absolute 1291 359 1617 538" enable="false" visible="false">
          <Layouts>
            <Layout>
              <Static id="Static01" text="접수 대기현황" class="sta_MAIN_NoticeTitle2" position="absolute 0 0 324 36" anchor="default" enable="false" visible="false"/>
              <Button id="btn_testAccept" taborder="12" class="btn_MAIN_Add" position="absolute 288 1 323 36" anchor="top right" onclick="Div03_btn_testAccept_onclick" tooltiptext="시험등록조회/취소 화면으로 이동" enable="false" visible="false"/>
              <Grid id="grd_testAcceptList" taborder="13" binddataset="ds_testAcceptList" scrollbars="autoboth" useinputpanel="false" autofittype="none" position="absolute -1 36 324 177" anchor="all" cellsizingtype="col" oncellclick="Div03_grd_testAcceptList_oncellclick" autosizebandtype="body" useselcolor="true" oncelldblclick="Div03_grd_testAcceptList_oncelldblclick" enable="false" visible="false">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="40"/>
                      <Column size="82"/>
                      <Column size="106"/>
                      <Column size="56"/>
                      <Column size="209"/>
                    </Columns>
                    <Rows>
                      <Row size="26" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="No."/>
                      <Cell col="1" displaytype="normal" text="의뢰일"/>
                      <Cell col="2" text="의뢰자"/>
                      <Cell col="3" text="검체수"/>
                      <Cell col="4" text="업장"/>
                    </Band>
                    <Band id="body">
                      <Cell style="background:#ffffffff;background2:#ffffff;" text="expr:currow+1"/>
                      <Cell col="1" displaytype="date" style="background:#ffffffff;background2:#ffffff;" text="bind:reqDate"/>
                      <Cell col="2" style="background:#ffffffff;background2:#ffffff;" text="bind:reqUserNm"/>
                      <Cell col="3" displaytype="number" style="background:#ffffffff;background2:#ffffff;" text="bind:specmCnt"/>
                      <Cell col="4" displaytype="text" style="background:#ffffffff;background2:#ffffff;" text="bind:upjangNm"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Static id="sta_testAcceptTotCnt" text=" : 0건" position="absolute 121 11 181 25" enable="false" visible="false"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="Div05" anchor="top right bottom" taborder="22" class="div_MAIN_NoticeBg" position="absolute 1292 547 1618 727" enable="false" visible="false">
          <Layouts>
            <Layout>
              <Static id="Static01" text="결재 대기현황" class="sta_MAIN_NoticeTitle5" position="absolute 365 4 689 40" anchor="default" enable="false" visible="false"/>
              <Button id="btn_testApprv" taborder="12" class="btn_MAIN_Add" position="absolute 653 5 688 40" anchor="top right" onclick="Div05_btn_testApprv_onclick" tooltiptext="각 승인 화면으로 이동" enable="false" visible="false"/>
              <Grid id="grd_testApprvList" taborder="13" binddataset="ds_testApprvList" scrollbars="autoboth" useinputpanel="false" autofittype="none" position="absolute 364 40 689 182" anchor="all" cellsizingtype="col" oncellclick="Div05_grd_testApprvList_oncellclick" useselcolor="true" oncelldblclick="Div05_grd_testApprvList_oncelldblclick" enable="false" visible="false">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="40"/>
                      <Column size="82"/>
                      <Column size="106"/>
                      <Column size="56"/>
                      <Column size="209"/>
                      <Column size="100"/>
                    </Columns>
                    <Rows>
                      <Row size="26" band="head"/>
                      <Row size="24"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="No."/>
                      <Cell col="1" displaytype="normal" text="의뢰일"/>
                      <Cell col="2" text="의뢰자"/>
                      <Cell col="3" text="검체수"/>
                      <Cell col="4" text="업장"/>
                      <Cell col="5" text="대기상태"/>
                    </Band>
                    <Band id="body">
                      <Cell style="background:#ffffffff;background2:#ffffff;" text="expr:currow+1"/>
                      <Cell col="1" displaytype="date" style="background:#ffffffff;background2:#ffffff;" text="bind:reqDate"/>
                      <Cell col="2" style="background:#ffffffff;background2:#ffffff;" text="bind:reqUserNm"/>
                      <Cell col="3" displaytype="number" style="background:#ffffffff;background2:#ffffff;" text="bind:specmCnt"/>
                      <Cell col="4" displaytype="text" style="background:#ffffffff;background2:#ffffff;" text="bind:upjangNm"/>
                      <Cell col="5" style="background:#ffffffff;background2:#ffffff;" text="bind:progressStatusNm"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Static id="sta_testApprvTotCnt" text=" : 0건" position="absolute 486 15 546 29" enable="false" visible="false" anchor="default"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static11" text="H12" class="Guide01_AreaRed" visible="false" position="absolute 396 390 406 402"/>
        <Static id="Static12" text="h10" class="Guide01_AreaRed" visible="false" position="absolute 1289 538 1625 548" enable="false"/>
        <Static id="Static89" text="20분마다 재조회 됩니다." class="sta_WF_DiscInfo" position="absolute 1060 28 1240 43" anchor="top right" visible="true"/>
        <Static id="Static13" text="w15" class="Guide01_AreaRed" visible="false" position="absolute 521 373 536 394" anchor="left top"/>
        <Static id="Static14" text="글자간격기준 w10" class="Guide01_AreaRed" visible="false" position="absolute 568 373 578 394" anchor="left top"/>
        <Static id="Static15" text="년월" class="sta_WFSA_label" position="absolute 536 373 597 394" anchor="left top"/>
        <ObjCalMonth id="cal_yearMonth" titletext="월력" taborder="23" text="ObjCalMonth00" scrollbars="none" position="absolute 578 373 662 394"/>
        <Static id="Static42" text="w02" class="Guide01_AreaRed" visible="false" position="absolute 662 373 664 393" anchor="top right"/>
        <Button id="btn_searchMonthIng" taborder="24" text="조회" class="btn_WF_Function" position="absolute 664 373 713 393" anchor="left top" onclick="btn_searchMonthIng_onclick"/>
        <Static id="sta_notice" onclick="sta_notice_onclick" class="sta_WF_DiscInfo" position="absolute 269 400 921 414" anchor="default" style="border:0 none #808080ff ;color:limegreen;" text="금주완료예정수는 접수승인이후 누적 건수 입니다."/>
        <Static id="sta_resize00" text="전체공지의 폭과 구매공지사항의 폭, 위생공지사항의 폭을 합한 사이즈(resize처리용도)-절대로 지우지 말아 주세요." visible="false" position="absolute 304 15 344 713" anchor="top bottom" style="border:1 solid #808080ff ;align:center middle;" onsize="sta_resize00_onsize"/>
        <Static id="sta_specmCnt" text="금일접수검체수 : 0&#13;&#10;1달 누계검체수 : 0" class="sta_MAIN_MydeskInput" position="absolute 774 370 929 397" style="color:royalblue;"/>
        <Button id="btn_static" taborder="25" text="팀장님용" class="btn_WF_Function" position="absolute 1168 375 1233 395" anchor="top right" onclick="btn_static_onclick"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_afterProcessHistory" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="reqNum" type="STRING" size="256"/>
          <Column id="reqDate" type="STRING" size="256"/>
          <Column id="acceptnm" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="upjangNm" type="STRING" size="256"/>
          <Column id="acceptdd" type="STRING" size="256"/>
          <Column id="specmCd" type="STRING" size="256"/>
          <Column id="specmNm" type="STRING" size="256"/>
          <Column id="notFitCnt" type="STRING" size="256"/>
          <Column id="notFitClsfiNm" type="STRING" size="256"/>
          <Column id="materialSendInfo" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_monthIng" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false" keystring="G:insptFldNm">
        <ColumnInfo>
          <Column id="insptFld" type="STRING" size="255"/>
          <Column id="insptFldNm" type="STRING" size="255"/>
          <Column id="sabun" type="STRING" size="255"/>
          <Column id="userNm" type="STRING" size="255"/>
          <Column id="totCnt" type="INT" size="256"/>
          <Column id="ingCnt" type="INT" size="255"/>
          <Column id="completeCnt" type="INT" size="255"/>
          <Column id="currCompleteCnt" type="INT" size="256"/>
          <Column id="ingTestCnt" type="INT" size="255"/>
          <Column id="completeTestCnt" type="INT" size="255"/>
          <Column id="currCompleteTestCnt" type="INT" size="256"/>
          <Column id="weekCompleteScheCnt" type="INT" size="255"/>
          <Column id="currWeekCompleteScheCnt" type="INT" size="256"/>
          <Column id="notFitCnt" type="INT" size="255"/>
          <Column id="useYn" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_testAcceptList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="reqNum" type="STRING" size="256"/>
          <Column id="reqDate" type="STRING" size="256"/>
          <Column id="reqUserNm" type="STRING" size="256"/>
          <Column id="specmCnt" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="upjangNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_testApprvList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="reqNum" type="STRING" size="256"/>
          <Column id="reqDate" type="STRING" size="256"/>
          <Column id="reqUserNm" type="STRING" size="256"/>
          <Column id="specmCnt" type="STRING" size="256"/>
          <Column id="upjang" type="STRING" size="256"/>
          <Column id="upjangNm" type="STRING" size="256"/>
          <Column id="progressStatusNm" type="STRING" size="256"/>
          <Column id="progressStatus" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset enableevent="true" id="ds_graph" loadstatus="false" preload="false" updatecontrol="true" useclientlayout="true">
        <ColumnInfo>
          <Column id="label" size="256" type="STRING"/>
          <Column id="totCnt" size="256" type="STRING"/>
          <Column id="testCnt" type="STRING" size="256"/>
          <Column id="notFitCnt" type="STRING" size="256"/>
          <Column id="code" type="STRING" size="256"/>
          <Column id="specmCnt" type="STRING" size="256"/>
          <Column id="testSpecmCnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_search" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="yymm" type="STRING" size="256"/>
          <Column id="edtSearch" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_retval" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="currDate" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_apprvActionList" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="apprvCnt" type="STRING" size="256"/>
          <Column id="apprvRejectCnt" type="STRING" size="256"/>
          <Column id="apprvNoActionCnt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_checkList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="img" type="STRING" size="256"/>
          <Column id="checklist" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
          <Row/>
          <Row/>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_checkListValue" firefirstcount="0" firenextcount="0" useclientlayout="true" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="checklist1" type="STRING" size="256"/>
          <Column id="checklist2" type="STRING" size="256"/>
          <Column id="checklist3" type="STRING" size="256"/>
          <Column id="checklist4" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <TransitionAnimation id="TranAni" direction="bottom" duration="1000" starttime="0" onend="TranAni_onend" onstart="TranAni_onstart" interpolation="Interpolation.expoIn" targetcomp="sta_notice" type="slide">
        <TransitionPropItems id="items">
          <TransitionPropItem id="" propid="1"/>
        </TransitionPropItems>
      </TransitionAnimation>
      <Dataset id="ds_notice" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="atclTit" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="atclTit">진행검체건수는 담당자별로 중복 집계 되어 질 수 있습니다.</Col>
          </Row>
          <Row>
            <Col id="atclTit">금주완료예정수는 접수승인이후 누적 건수 입니다.</Col>
          </Row>
          <Row>
            <Col id="atclTit">소요기간이 0인 시험항목은 건수에서 제외 됩니다.</Col>
          </Row>
          <Row>
            <Col id="atclTit">접수/결재 대기현황 및 사후처리내역을 더블 클릭 시 통합조회 화면으로 이동합니다.</Col>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_quickList" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="code" type="STRING" size="255"/>
          <Column id="codeName" type="STRING" size="255"/>
          <Column id="set1" type="STRING" size="255"/>
          <Column id="set2" type="STRING" size="255"/>
          <Column id="set3" type="STRING" size="255"/>
          <Column id="set4" type="STRING" size="255"/>
          <Column id="set5" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_specmCnt" firefirstcount="0" firenextcount="0" useclientlayout="false" updatecontrol="true" enableevent="true" loadkeymode="keep" loadfiltermode="keep" reversesubsum="false">
        <ColumnInfo>
          <Column id="currDaySpecmCnt" type="STRING" size="255"/>
          <Column id="sumSpecmCnt" type="STRING" size="255"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Bind/>
    <Script type="xscript4.0"><![CDATA[/*
  화 면 명 : LIMS INTRO 화면
  파 일 명 : IntroFrameLims.xfdl
  기    능 : LIMS Main화면

    수정일      수정자                  수정내용
  ----------   -------  --------------------------------------------------
  2015.04.20   jshoon   최초 생성
*/

/************************************************************************************************
 * 공통 라이브러리 INCLUDE 영역 (필수)
************************************************************************************************/
include "lib::lib_com.xjs";
include "lib::LimsUtil.xjs";
include "frame::IntroFrameCmn.xjs";

/************************************************************************************************
 * FORM 변수 선언 영역 (필수)
************************************************************************************************/
var fv_timerCnt = 0;		// Noti Count
var fv_notiCnt = 0;		// Noti Search Count
var fv_timerInt = 4000;

/************************************************************************************************
 * FORM EVENT 영역 (필수)
************************************************************************************************/
/*-----------------------------------------------------------------------
 * 설명            : Form Load
 *-----------------------------------------------------------------------*/
function IntroFrame_onload(obj:Form, e:LoadEventInfo) 
{
	// Form Load 시 공통 기능 처리(obj:Form, bCreateEvent:이벤트 생성 여부)
    gfn_formOnLoad(this, false);
    
	// 초기값 셋팅
	fn_init();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 초기값 셋팅
 *---------------------------------------------------------------------------------------------*/
function fn_init()
{
	cal_yearMonth.fn_initMonthCal(this, gfn_getYearMonth(gfn_today()), "fn_calendarCallBack", ds_search, "yymm", "Y");
	
	//전체 데이터 60분마다 refresh
    setTimer(1, ((1000 * 60) * 20));
    
    // 주의사항 timer start
    fv_notiCnt = ds_notice.rowcount; 
    setTimer(11, fv_timerInt);		// 주의사항
    
	fn_search();
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 달력 선택 후 callback function
 *---------------------------------------------------------------------------------------------*/
function fn_calendarCallBack(sYearMonth)
{
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 화면 닫기 전 변경 유무 체크 (필수-Frame에서 창 닫힐때 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_close()
{
	// 조회프로그램에도 Return true; 기술해 주세요!
	return true;
}

/************************************************************************************************
 * 공통기능 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회 버튼 클릭 시 (필수-공통버튼에서 호출됨)
 *---------------------------------------------------------------------------------------------*/
function fn_search()
{
	fn_doSearch();
}

/************************************************************************************************
 * TRANSACTION 및 CallBack 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 트랜잭션 콜백 함수 (필수)
 *---------------------------------------------------------------------------------------------*/
function fn_callBack(strSvcID, nErrorCode, strErrorMsg)
{
	// 에러시 gfn_callBack에서 메시지 제공, 화면별 특정 에러 발생시에만 사용하세요.
	if (nErrorCode < 0)
	{
		return;
	}

    switch(strSvcID)
    {
		// 조회
        case "selectList" :
			// Chart 세팅
			fn_fusionChart();
			
			Div00.sta_currDate.text = ds_retval.getColumn(0, "currDate");	// 오늘날짜
			//trace(g_Mu_Nm + " , " + g_DeptNm + " , " + g_Sc_Nm + " , " + g_Tm_Nm + " , " + g_UserGroup);
			Div00.sta_deptNm.text = g_Tm_Nm;	// 팀명
			
			// 금일검체수 : 0, 1달누계검체수 : 0
			fn_specmCnt();
			
			// My Desk 세팅
			Div00.sta_apprvCnt.text = "승인 : " + ds_apprvActionList.getColumn(ds_apprvActionList.rowposition, "apprvCnt");
			Div00.sta_apprvNoActionCnt.text = "미승인 : " + ds_apprvActionList.getColumn(ds_apprvActionList.rowposition, "apprvNoActionCnt");
			Div00.sta_apprvRejectCnt.text = "반려 : " + ds_apprvActionList.getColumn(ds_apprvActionList.rowposition, "apprvRejectCnt");
			// 반려건수가 0보다 크면 붉은색 표시
			if (Number(ds_apprvActionList.getColumn(ds_apprvActionList.rowposition, "apprvRejectCnt")) > 0) {
				Div00.sta_apprvRejectCnt.color = "palevioletred";
			} else {
				Div00.sta_apprvRejectCnt.color = "#637081ff";
			}
			
			// [[ Check List 세팅
			// Count가 0보다 크면 빨간색, 0이면 초록색 표시
			ds_checkList.setColumn(0, "img", Number(ds_checkListValue.getColumn(0, "checklist1"))>0?"URL('theme://images/new/grd_MAIN_ChceklistR.png') left middle":"URL('theme://images/new/grd_MAIN_ChceklistG.png') left middle");
			ds_checkList.setColumn(1, "img", Number(ds_checkListValue.getColumn(0, "checklist2"))>0?"URL('theme://images/new/grd_MAIN_ChceklistR.png') left middle":"URL('theme://images/new/grd_MAIN_ChceklistG.png') left middle");
			ds_checkList.setColumn(2, "img", Number(ds_checkListValue.getColumn(0, "checklist3"))>0?"URL('theme://images/new/grd_MAIN_ChceklistR.png') left middle":"URL('theme://images/new/grd_MAIN_ChceklistG.png') left middle");
			ds_checkList.setColumn(3, "img", Number(ds_checkListValue.getColumn(0, "checklist4"))>0?"URL('theme://images/new/grd_MAIN_ChceklistR.png') left middle":"URL('theme://images/new/grd_MAIN_ChceklistG.png') left middle");
			
			ds_checkList.setColumn(0, "checklist", "금일의뢰건수 ("+ds_checkListValue.getColumn(0, "checklist1")+")");
			ds_checkList.setColumn(1, "checklist", "일지입력대기 ("+ds_checkListValue.getColumn(0, "checklist2")+")");
			ds_checkList.setColumn(2, "checklist", "결과입력대기 ("+ds_checkListValue.getColumn(0, "checklist3")+")");
			ds_checkList.setColumn(3, "checklist", "결과결재대기 ("+ds_checkListValue.getColumn(0, "checklist4")+")");
			// Check List 세팅 ]] 
			
			// 조회 건수 표시
			Div07.sta_afterProcTotCnt.text = " : " + ds_afterProcessHistory.rowcount + "건";	// 사후처리내역 건수 표시
			Div03.sta_testAcceptTotCnt.text = " : " + ds_testAcceptList.rowcount + "건";	// 접수대기 건수 표시
			Div05.sta_testApprvTotCnt.text = " : " + ds_testApprvList.rowcount + "건";	// 결재대기 건수 표시
			
			//trace(gds_limsAuthLevels.saveXML());
			
			// [[ 좌측 QuickMenu세팅
			// 공통코드(IntroFrame_lims)에서 데이터 조회 후 세팅
			var top = 6;
			var bottom = 50;
			var left = 6;
			var right = 226;
			var space = 4;
			var height = 44;
			//trace(ds_quickList.saveXML());
			if (this.all["btn_quickList0"] == "undefined" || this.all["btn_quickList0"] == null) {
				for (var i=0,len=ds_quickList.getRowCount(); i<len; i++)
				{
					var btn = new Button("btn_quickList"+i, left, top, right, bottom);
					btn.padding = "1 0 0 43";
					btn.class = ds_quickList.getColumn(i, "set1");
					btn.border = "1 solid #c8d5e1ff";
					btn.background.image = ds_quickList.getColumn(i, "set2");
					btn.background.color = "#ffffffff";
					btn.text = ds_quickList.getColumn(i, "codeName");
					btn.image = "theme://images/new/btn_MAIN_QuickBgN.png";
					btn.imagealign = "right middle";
					btn.align = "left middle";
					btn.font = "굴림,9,bold";
					btn.color = "#5a6779ff";
					btn.gradation = "linear 0,0 #ffffffff 0,100 #f3f3f3ff";
					btn.bordertype = "normal 0 0";
					btn.focusborder = "0 none #808080";
					btn.shadow = "drop 0 0 gray";
					btn.userMenuName = ds_quickList.getColumn(i, "codeName");
					btn.userMenuId = ds_quickList.getColumn(i, "set3");
					btn.userMenuId2 = ds_quickList.getColumn(i, "set4");
					//btn.userCallParameter = ds_quickList.getColumn(i, "set4");
					
					//이벤트를 발생한다.
					btn.onclick.addHandler(function (o, e) {
						if (o.userMenuId != "") {
							gfn_openMenu(o.userMenuId, null);
						} else {
							gfn_alert("설정된 메뉴(ID)가 없습니다.");
						}
					});
					
					btn.show();
					
					div_quickList.addChild("btn_quickList"+i, btn);
					top = top + space + height;
					bottom = top + height;
				}
			}
			// 좌측 QuickMenu세팅 ]]
			
            break;
        // 검사원별 월간 진행현황 조회
        case "selectMonthIngList" :
// 			for (var i = 0; i < ds_monthIng.getRowCount(); i++) {	
// 				trace(ds_monthIng.getColumn(i, "insptFld") + " , " + ds_monthIng.getColumn(i, "insptFld") + " , " + ds_monthIng.getRowLevel(i));
// 			}
			fn_specmCnt();
			break;
    }
}

/************************************************************************************************
 * 사용자 FUNCTION 영역 (필수)
************************************************************************************************/
/*----------------------------------------------------------------------------------------------
 * 설명      : 조회
 *---------------------------------------------------------------------------------------------*/
function fn_doSearch()
{
    // Grid sort 표시 초기화(필수)
    //gfn_clearSortMark(grd_monthIng);

    // Dataset을 초기화한다.
    //ds_graph.clearData();
    //ds_monthIng.clearData();
    
    // quickList를 clear한다.
    for (var i=0,len=ds_quickList.getRowCount(); i<len; i++)
	{
		div_quickList.removeChild("btn_quickList"+i);
	}

    var strSvcID    = "selectList";
    var strURL      = "ls/lcm/introFrameLims/selectList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    //2018.06.05 김명섭 LIMS개선: 사후처리내역, 접수대기현황, 결재대기현황 Disp제외
    //var strOutDs    = "ds_quickList=ds_quickList ds_graph=ds_graph ds_monthIng=ds_monthIng ds_testAcceptList=ds_testAcceptList ds_testApprvList=ds_testApprvList ds_retval=ds_retval ds_apprvActionList=ds_apprvActionList ds_checkListValue=ds_checkListValue ds_afterProcessHistory=ds_afterProcessHistory gds_limsAuthLevels=gds_limsAuthLevels ds_specmCnt=ds_specmCnt";
    var strOutDs    = "ds_quickList=ds_quickList ds_graph=ds_graph ds_monthIng=ds_monthIng ds_retval=ds_retval ds_apprvActionList=ds_apprvActionList ds_checkListValue=ds_checkListValue gds_limsAuthLevels=gds_limsAuthLevels ds_specmCnt=ds_specmCnt";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync, false);
}

function fn_specmCnt()
{
	// 금일검체수 : 0, 1달누계검체수 : 0
	sta_specmCnt.text = "금일접수검체수 : " + ds_specmCnt.getColumn(0, "currDaySpecmCnt") + String.fromCharCode(13, 10) + "1달 누계검체수 : " + ds_specmCnt.getColumn(0, "sumSpecmCnt");
}

/*----------------------------------------------------------------------------------------------
 * 설명      : 차트 출력
 *---------------------------------------------------------------------------------------------*/
function fn_fusionChart()
{
	var arrArg,arrSer;
	
	//---------------------------------------------
	// arrArg : 차트속성
	// caption		- 차트제목
	// PYAxisName	- 왼쪽 Y축의 명
	// yAxisName	- 오늘쪽쪽 Y축의 명
	// showValues	- 0 : 차트에 값 표시 안함
	//---------------------------------------------
	arrArg = ["caption", "월별검사현황", "PYAxisName", "Revenue", "SYAxisName", "Quantity", "showValues", "1", "numberPrefix", ""];
	
	//---------------------------------------------
	// arrSer : 그룹속성(3개씩 셋트)
	// [그룹명,Y축값컬럼명,그룹속성, ...]
	// 다중차트는 그룹속성을 설정안함.
	//---------------------------------------------
	//arrSer = ["건수", "totCnt", "", "항목수", "testCnt", "", "부적합수", "notFitCnt", "parentYAxis='S'", "년간계획검사시료수", "specmCnt", "parentYAxis='S'", "년간계획검사건수", "testSpecmCnt", "parentYAxis='S'"];
	arrSer = ["건수", "totCnt", "", "항목수", "testCnt", "", "년간계획검사시료수", "specmCnt", "parentYAxis='S'", "년간계획검사건수", "testSpecmCnt", "parentYAxis='S'"];
	
	gfn_MultiChart(Div04.atx_chart2, "MSCombi2D", ds_graph, "label", arrSer, arrArg, "", []);
}

/*----------------------------------------------------------------------------------------------
 * 설명      : Chart Div size 변경 시 챠트 size 변경
 *---------------------------------------------------------------------------------------------*/
function Div04_onsize(obj:Div, e:SizeEventInfo)
{
	Div04.atx_chart2.Rewind(); 
	Div04.atx_chart2.Stop();
	Div04.atx_chart2.Play();
}

/***************************************************************************
 * 설명   : 검체건수 항목 클릭 시 검체목록 LayerPopup 출력
 ***************************************************************************/
function Div03_grd_testAcceptList_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	fn_specmAcceptListPop(obj, e, 3);
}

/***************************************************************************
 * 설명   : 검체건수 항목 클릭 시 검체목록 LayerPopup 출력
 ***************************************************************************/
function Div05_grd_testApprvList_oncellclick(obj:Grid, e:GridClickEventInfo)
{
	fn_specmAcceptListPop(obj, e, 3);
}

/***************************************************************************
 * 설명   : 검체건수 LayerPopup 출력
 ***************************************************************************/
function fn_specmAcceptListPop(obj, e, cellPosition)
{
	var objDataSet = eval(obj.binddataset);
	if (e.cell == cellPosition) 
	{
		// LayerPopup으로 넘겨줄 변수
		var objArg = {
			sParam1 : objDataSet.getColumn(e.row, "reqNum")
		};
        var sPlayerPopup = {
			 objGrd	       : obj
			,evtGrid       : e
			,nPwidth       : 546
			,nPheight      : 221
			,sPpopupDivNm  : 'SpecmAcceptListInqueryPop'
			,sPopupUrl     : 'X_LRM::SpecmAcceptListInqueryPop.xfdl'
			,objArg        : objArg
			,objForm       : this
		};
		LimsUtil.gridLayerPopup(sPlayerPopup);
    } 
}

/************************************************************************************************
 * 설명		: CHECK LIST 클릭
 ************************************************************************************************/
function Div01_grd_checkList_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	var arrParam = new Array();
	if (e.row == 0) {
		fn_menuGoAction("1764", arrParam);	// 시험등록조회/취소
	} else if (e.row == 1) {
		fn_menuGoAction("1766", arrParam);	// 시험진행및결과조회
	} else if (e.row == 2) {
		fn_menuGoAction("1768", arrParam);	// 시험결과등록 - 시험항목별
	} else if (e.row == 3) {
		fn_menuGoAction("1769", arrParam);	// 시험진행및결과조회
	}
}

/***************************************************************************
 * 설명   : 접수대기현황 More 클릭
 ***************************************************************************/
function Div03_btn_testAccept_onclick(obj:Button,  e:ClickEventInfo)
{
	var arrParam = new Array();
	fn_menuGoAction("1764", arrParam);	// 시험등록조회/취소
}

/***************************************************************************
 * 설명   : 접수대기(시험등록조회) 화면으로 이동
 ***************************************************************************/
function fn_menuGoAction(menuId, arrParam)
{
	var strMenuID = menuId;	// 인터페이스 할 메뉴ID
	// 다른업무화면 호출 - MENUID,
	gfn_openMenu(strMenuID, arrParam);
}

/***************************************************************************
 * 설명   : 승인관련 화면으로 이동
 ***************************************************************************/
function Div05_btn_testApprv_onclick(obj:Button,  e:ClickEventInfo)
{
	var strMenuID = "";
	var arrParam = new Array();
	if (ds_testApprvList.getColumn(ds_testApprvList.rowposition, "progressStatus") == "130")
	{
		strMenuID = "1765";	// 접수승인
// 		gfn_openMenuForm("TestAcceptApprv.xfdl"
// 						,"X_LRM"
// 						,arrParam
// 						,"시험접수승인");
	}
	else if (ds_testApprvList.getColumn(ds_testApprvList.rowposition, "progressStatus") == "180")
	{
		strMenuID = "1769";	// 시험완료승인
// 		gfn_openMenuForm("TestEndApprv.xfdl"
// 						,"X_LTM"
// 						,arrParam
// 						,"시험완료승인");
	}
	else if (ds_testApprvList.getColumn(ds_testApprvList.rowposition, "progressStatus") == "210" ||
	         ds_testApprvList.getColumn(ds_testApprvList.rowposition, "progressStatus") == "250")
	{
		strMenuID = "1771";	// 성적서발급승인
// 		gfn_openMenuForm("InspectRptIssueApprv.xfdl"
// 						,"X_LEM"
// 						,arrParam
// 						,"성적서발급승인");
	}
	
	fn_menuGoAction(strMenuID, arrParam);
}

/************************************************************************************************
 * 설명		: 사후처리내역 더블 클릭
 ************************************************************************************************/
function Div07_grd_afterProcessHistory_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	fn_intergInqueryMove(obj, e);
}

/************************************************************************************************
 * 설명		: 접수대기현황 더블 클릭
 ************************************************************************************************/
function Div03_grd_testAcceptList_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	fn_intergInqueryMove(obj, e, 3);
}

/************************************************************************************************
 * 설명		: 결재대기현황 더블 클릭
 ************************************************************************************************/
function Div05_grd_testApprvList_oncelldblclick(obj:Grid, e:GridClickEventInfo)
{
	fn_intergInqueryMove(obj, e, 3);
}

/************************************************************************************************
 * 설명		: 통합조회 화면으로 이동
 ************************************************************************************************/
function fn_intergInqueryMove(obj, e, skipCellPosition)
{
	//trace(e.cell + " , " + skipCellPosition);
	if (skipCellPosition != undefined) {
		if (e.cell == skipCellPosition) return;
	}
	
	var objDataSet = eval(obj.binddataset);
	
	var arrParam = new Array();
	arrParam[0] = objDataSet.getColumn(objDataSet.rowposition, "reqNum");
	arrParam[1] = objDataSet.getColumn(objDataSet.rowposition, "reqDate");
	arrParam[2] = objDataSet.getColumn(objDataSet.rowposition, "upjang");
	arrParam[3] = objDataSet.getColumn(objDataSet.rowposition, "upjangNm");
	if (skipCellPosition != undefined) {
		arrParam[4] = "Y";
	}
	
	gfn_openMenu("2537", arrParam);	// 업장기간별금액조회 화면 호출
}

/***************************************************************************
 * 설명   : 검사원별 월간 진행현황 조회
 ***************************************************************************/
function btn_searchMonthIng_onclick(obj:Button,  e:ClickEventInfo)
{
	if (gfn_isNull(cal_yearMonth.fn_getValue()))
    {
        gfn_alert("조회 년월을 입력하여 주십시오!");
        cal_yearMonth.fn_setValue(gfn_getYearMonth(gfn_today()));
        return;
    }
	
	var strSvcID    = "selectMonthIngList";
    var strURL      = "ls/lcm/introFrameLims/selectMonthIngList.xdo";
    var strInDs     = "ds_search=ds_search:A";
    var strOutDs    = "ds_monthIng=ds_monthIng ds_specmCnt=ds_specmCnt";
    var strArg      = "";
    var strCallback = "fn_callBack";
    var bAsync      = true;

    gfn_transaction(this, strSvcID, strURL, strInDs, strOutDs, strArg, strCallback, bAsync, false);
}

/***************************************************************************
 * 설명   : 60분에 한번씩 전체 데이터를 조회 한다.
 ***************************************************************************/
function IntroFrameLims_ontimer(obj:Form, e:TimerEventInfo)
{
	if (e.timerid == 1) 
	{
		fn_doSearch();
	}
	else if (e.timerid == 11) 	// 주의사항 Ani
	{
		fn_notiAni();
	}
}

/************************************************************************************************
 * 설명		: 주의사항 TranAni
 ************************************************************************************************/
function TranAni_onstart(obj:TransitionAnimation, e:AnimationEventInfo)
{
	sta_notice.text = ds_notice.getColumn(fv_timerCnt, "atclTit");
}

/************************************************************************************************
 * 설명		: 주의사항 TranAni
 ************************************************************************************************/
function TranAni_onend(obj:TransitionAnimation, e:AnimationEventInfo)
{
	fv_timerCnt++;

	if ( fv_timerCnt == fv_notiCnt ) fv_timerCnt = 0;
	TranAni.endTransition();
}

/************************************************************************************************
 * 설명		: 사후처리내역 엑셀 icon 클릭
 ************************************************************************************************/
function Div07_grd_afterProcessHistory_onheadclick(obj:Grid, e:GridClickEventInfo)
{
	// 엑셀 아이콘시에 엑셀 다운로드
    var strHeadClass = obj.getCellProperty("head", e.col, "class");
    if (strHeadClass == "head_Excel")
    {
		gfn_exportExcel(obj);
		return;
    }
}

/************************************************************************************************
 * 설명		: notice TranAni Stop
 ************************************************************************************************/
function fn_notiAni()
{
 	TranAni.beginTransition();
	TranAni.run();
}

/************************************************************************************************
 * 설명		: IntroFrameLims 종료 전에 Timer를 죽인다.
 ************************************************************************************************/
function IntroFrameLims_onbeforeclose(obj:Form, e:CloseEventInfo)
{
	Div04.atx_chart2.Stop();
	killTimer(1);
	killTimer(11);
}

/************************************************************************************************
 * 설명		: 화면의 세로길이 변경 시 우측 그리드의 크기 변환
 ************************************************************************************************/
function sta_resize00_onsize(obj:Static, e:SizeEventInfo)
{
	// 사후처리 내역
	Div07.position.height = (e.cy-245)/2-5;
	
	// 접수 대기 현황
	Div03.position.y = (Div07.position.bottom) + 11;
	Div03.position.height = (e.cy-245)/2-5;
	
	// 결재 대기 현황
 	Div05.position.y = (Div03.position.bottom) + 11;
 	Div05.position.bottom = grd_monthIng.position.bottom;
}

/************************************************************************************************
 * 설명		: 비밀번호 변경 클릭
 ************************************************************************************************/
function Div00_btn_pwdChg_onclick(obj:Button,  e:ClickEventInfo)
{
	IntroFrameCmn.changePassword();
}

/************************************************************************************************
 * 설명		: 사용자 정보 변경 클릭
 ************************************************************************************************/
function Div00_btn_psnlChg_onclick(obj:Button,  e:ClickEventInfo)
{
	IntroFrameCmn.changePersonal();
}

/************************************************************************************************
 * 설명		: 김희선팀장용 팝업
 ************************************************************************************************/
function btn_static_onclick(obj:Button,  e:ClickEventInfo)
{
	var objArg = {
	};
	
    var rtnVal = gfn_dialog("SpecmTestInfoIntroPop"				// dialogId
                       , "X_LCM::SpecmTestInfoIntroPop.xfdl"			// Url
                       , objArg			// 배열
                       , null, null, null, null, null, false, true, -1);
}
]]></Script>
  </Form>
</FDL>

<?xml version="1.0" encoding="euc-kr"?>
<query>
	<type>select</type>
	<description><![CDATA[]]></description>
	<reload>true</reload>
	<monitoring>true</monitoring>
	<result-count>1</result-count>
	<statement>
<![CDATA[
SELECT  A.UPJANG, A.SUBINV_CODE, A.MENU_DATE, MAX(NVL(B.GOAL_COST_RATE,0)) GOAL_COST_RATE
FROM
        (
        SELECT  #UPJANG# UPJANG, #SUBINV_CODE# SUBINV_CODE, TO_CHAR(TO_DATE(#MENU_SDATE#,'YYYYMMDD')+0,'YYYYMMDD') MENU_DATE, 0 GOAL_COST_RATE
        FROM    DUAL
        UNION ALL
        SELECT  #UPJANG# UPJANG, #SUBINV_CODE# SUBINV_CODE, TO_CHAR(TO_DATE(#MENU_SDATE#,'YYYYMMDD')+1,'YYYYMMDD') MENU_DATE, 0 GOAL_COST_RATE
        FROM    DUAL
        UNION ALL
        SELECT  #UPJANG# UPJANG, #SUBINV_CODE# SUBINV_CODE, TO_CHAR(TO_DATE(#MENU_SDATE#,'YYYYMMDD')+2,'YYYYMMDD') MENU_DATE, 0 GOAL_COST_RATE
        FROM    DUAL
        UNION ALL
        SELECT  #UPJANG# UPJANG, #SUBINV_CODE# SUBINV_CODE, TO_CHAR(TO_DATE(#MENU_SDATE#,'YYYYMMDD')+3,'YYYYMMDD') MENU_DATE, 0 GOAL_COST_RATE
        FROM    DUAL
        UNION ALL
        SELECT  #UPJANG# UPJANG, #SUBINV_CODE# SUBINV_CODE, TO_CHAR(TO_DATE(#MENU_SDATE#,'YYYYMMDD')+4,'YYYYMMDD') MENU_DATE, 0 GOAL_COST_RATE
        FROM    DUAL
        UNION ALL
        SELECT  #UPJANG# UPJANG, #SUBINV_CODE# SUBINV_CODE, TO_CHAR(TO_DATE(#MENU_SDATE#,'YYYYMMDD')+5,'YYYYMMDD') MENU_DATE, 0 GOAL_COST_RATE
        FROM    DUAL
        UNION ALL
        SELECT  #UPJANG# UPJANG, #SUBINV_CODE# SUBINV_CODE, TO_CHAR(TO_DATE(#MENU_SDATE#,'YYYYMMDD')+6,'YYYYMMDD') MENU_DATE, 0 GOAL_COST_RATE
        FROM    DUAL
        ) A,
        (
        SELECT  UPJANG, SUBINV_CODE, MENU_DATE, GOAL_COST_RATE
        FROM    FMM_GOAL_COST_RATE
        WHERE   UPJANG  = #UPJANG#
        AND     SUBINV_CODE = #SUBINV_CODE#
        AND     MENU_DATE BETWEEN #MENU_SDATE# AND TO_CHAR(TO_DATE(#MENU_SDATE#, 'YYYYMMDD')+6,'YYYYMMDD')
        ) B
WHERE   A.UPJANG  = B.UPJANG (+)  
AND     A.SUBINV_CODE = B.SUBINV_CODE (+)
GROUP BY A.UPJANG, A.SUBINV_CODE, A.MENU_DATE	]]></statement>
	<input default-name="ds_input">
	</input>
	<output default-name="ds_sikrate">
	</output>
</query>
